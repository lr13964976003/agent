digraph LayerWiseDeployment {
    rankdir=TB;
    bgcolor=white;
    
    // Input node
    subgraph cluster_input {
        label="Input Layer";
        color=black;
        input [label="Input\nInput: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden_size=8192]", shape=parallelogram, style=filled, fillcolor=lightblue];
    }
    
    // Output node
    subgraph cluster_output {
        label="Output Layer";
        color=black;
        output [label="Output\nInput: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden_size=8192]", shape=parallelogram, style=filled, fillcolor=lightblue];
    }
    
    // Layer 1 (GPU 0)
    subgraph cluster_layer_1 {
        label="Layer 1 (GPU 0)";
        color=blue;
        ln1_1 [label="Layer Norm 1\nInput: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden_size=8192]", style=filled, fillcolor=lightyellow];
        q_proj_1 [label="Q Projection\nInput: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, heads=16, d_k=512]", style=filled, fillcolor=lightgreen];
        k_proj_1 [label="K Projection\nInput: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, heads=16, d_k=512]", style=filled, fillcolor=lightgreen];
        v_proj_1 [label="V Projection\nInput: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, heads=16, d_k=512]", style=filled, fillcolor=lightgreen];
        scaled_dot_attn_1 [label="Scaled Dot-Product Attention\nQ: [batch_size=1024, seq_len=10000, heads=16, d_k=512]\nK: [batch_size=1024, seq_len=10000, heads=16, d_k=512]\nV: [batch_size=1024, seq_len=10000, heads=16, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, heads=16, d_k=512]", style=filled, fillcolor=lightcoral];
        concat_1 [label="Concat & Reshape\nInput: [batch_size=1024, seq_len=10000, heads=16, d_k=512]\nOutput: [batch_size=1024, seq_len=10000, hidden_size=8192]", style=filled, fillcolor=lightcyan];
        o_proj_1 [label="O Projection\nInput: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden_size=8192]", style=filled, fillcolor=lightgreen];
        residual1_1 [label="Residual Add 1\nInput 1: [batch_size=1024, seq_len=10000, hidden_size=8192]\nInput 2: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden_size=8192]", style=filled, fillcolor=lightpink, shape=ellipse];
        ln2_1 [label="Layer Norm 2\nInput: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden_size=8192]", style=filled, fillcolor=lightyellow];
        mlp_up_1 [label="MLP Up Projection\nInput: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, ffn_hidden=32768]", style=filled, fillcolor=lightgreen];
        gelu_1 [label="GELU Activation\nInput: [batch_size=1024, seq_len=10000, ffn_hidden=32768]\nOutput: [batch_size=1024, seq_len=10000, ffn_hidden=32768]", style=filled, fillcolor=lightorange];
        mlp_down_1 [label="MLP Down Projection\nInput: [batch_size=1024, seq_len=10000, ffn_hidden=32768]\nOutput: [batch_size=1024, seq_len=10000, hidden_size=8192]", style=filled, fillcolor=lightgreen];
        residual2_1 [label="Residual Add 2\nInput 1: [batch_size=1024, seq_len=10000, hidden_size=8192]\nInput 2: [batch_size=1024, seq_len=10000, hidden_size=8192]\nOutput: [batch_size=1024, seq_len=10000, hidden_size=8192]", style=filled, fillcolor=lightpink, shape=ellipse];
    }
    
    // Add remaining layers 2-16 in abbreviated format
    ''')