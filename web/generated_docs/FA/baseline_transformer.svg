<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_transformer Pages: 1 -->
<svg width="1160pt" height="4716pt"
 viewBox="0.00 0.00 1160.00 4716.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 4712.33)">
<title>baseline_transformer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4712.33 1156,-4712.33 1156,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="68,-2506.17 68,-4604.17 1084,-4604.17 1084,-2506.17 68,-2506.17"/>
<text text-anchor="middle" x="576" y="-4588.97" font-family="Times,serif" font-size="14.00">Stage 0 &#45; GPUs [0&#45;7]</text>
<text text-anchor="middle" x="576" y="-4573.97" font-family="Times,serif" font-size="14.00">TP=8, Partition=512</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-124.17 8,-2498.17 1144,-2498.17 1144,-124.17 8,-124.17"/>
<text text-anchor="middle" x="576" y="-2482.97" font-family="Times,serif" font-size="14.00">Stage 1 &#45; GPUs [8&#45;15]</text>
<text text-anchor="middle" x="576" y="-2467.97" font-family="Times,serif" font-size="14.00">TP=8, Partition=512</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="721" cy="-4660.25" rx="381.68" ry="48.17"/>
<text text-anchor="middle" x="721" y="-4679.05" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="721" y="-4664.05" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7], [8&#45;15]</text>
<text text-anchor="middle" x="721" y="-4649.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096]</text>
<text text-anchor="middle" x="721" y="-4634.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_rmsnorm -->
<g id="node2" class="node">
<title>layer0_rmsnorm</title>
<polygon fill="lightblue" stroke="black" points="827,-4558.17 287,-4558.17 287,-4490.17 827,-4490.17 827,-4558.17"/>
<text text-anchor="middle" x="557" y="-4542.97" font-family="Times,serif" font-size="14.00">Layer 0 RMSNorm</text>
<text text-anchor="middle" x="557" y="-4527.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="557" y="-4512.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="557" y="-4497.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- input&#45;&gt;layer0_rmsnorm -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer0_rmsnorm</title>
<path fill="none" stroke="black" d="M583.08,-4615.31C583.08,-4615.31 583.08,-4568.28 583.08,-4568.28"/>
<polygon fill="black" stroke="black" points="586.58,-4568.28 583.08,-4558.28 579.58,-4568.28 586.58,-4568.28"/>
</g>
<!-- layer0_res_add1 -->
<g id="node7" class="node">
<title>layer0_res_add1</title>
<polygon fill="lightblue" stroke="black" points="1076.5,-4038.17 75.5,-4038.17 75.5,-3970.17 1076.5,-3970.17 1076.5,-4038.17"/>
<text text-anchor="middle" x="576" y="-4022.97" font-family="Times,serif" font-size="14.00">Layer 0 Residual Add 1</text>
<text text-anchor="middle" x="576" y="-4007.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="576" y="-3992.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512], [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="576" y="-3977.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- input&#45;&gt;layer0_res_add1 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;layer0_res_add1</title>
<path fill="none" stroke="black" d="M953,-4621.66C953,-4621.66 953,-4048.3 953,-4048.3"/>
<polygon fill="black" stroke="black" points="956.5,-4048.3 953,-4038.3 949.5,-4048.3 956.5,-4048.3"/>
</g>
<!-- layer0_attn_qkv -->
<g id="node3" class="node">
<title>layer0_attn_qkv</title>
<polygon fill="lightblue" stroke="black" points="784,-4454.17 230,-4454.17 230,-4386.17 784,-4386.17 784,-4454.17"/>
<text text-anchor="middle" x="507" y="-4438.97" font-family="Times,serif" font-size="14.00">Layer 0 QKV Projection</text>
<text text-anchor="middle" x="507" y="-4423.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="507" y="-4408.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="507" y="-4393.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128, partition=512]</text>
</g>
<!-- layer0_rmsnorm&#45;&gt;layer0_attn_qkv -->
<g id="edge2" class="edge">
<title>layer0_rmsnorm&#45;&gt;layer0_attn_qkv</title>
<path fill="none" stroke="black" d="M535.5,-4490.11C535.5,-4490.11 535.5,-4464.3 535.5,-4464.3"/>
<polygon fill="black" stroke="black" points="539,-4464.3 535.5,-4454.3 532,-4464.3 539,-4464.3"/>
</g>
<!-- layer0_attn_scores -->
<g id="node4" class="node">
<title>layer0_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="705.5,-4350.17 262.5,-4350.17 262.5,-4282.17 705.5,-4282.17 705.5,-4350.17"/>
<text text-anchor="middle" x="484" y="-4334.97" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores</text>
<text text-anchor="middle" x="484" y="-4319.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="484" y="-4304.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
<text text-anchor="middle" x="484" y="-4289.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv&#45;&gt;layer0_attn_scores -->
<g id="edge3" class="edge">
<title>layer0_attn_qkv&#45;&gt;layer0_attn_scores</title>
<path fill="none" stroke="black" d="M484,-4386.11C484,-4386.11 484,-4360.3 484,-4360.3"/>
<polygon fill="black" stroke="black" points="487.5,-4360.3 484,-4350.3 480.5,-4360.3 487.5,-4360.3"/>
</g>
<!-- layer0_attn_weighted -->
<g id="node5" class="node">
<title>layer0_attn_weighted</title>
<polygon fill="lightblue" stroke="black" points="829.5,-4246.17 92.5,-4246.17 92.5,-4178.17 829.5,-4178.17 829.5,-4246.17"/>
<text text-anchor="middle" x="461" y="-4230.97" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum</text>
<text text-anchor="middle" x="461" y="-4215.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="461" y="-4200.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="461" y="-4185.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores&#45;&gt;layer0_attn_weighted -->
<g id="edge4" class="edge">
<title>layer0_attn_scores&#45;&gt;layer0_attn_weighted</title>
<path fill="none" stroke="black" d="M484,-4282.11C484,-4282.11 484,-4256.3 484,-4256.3"/>
<polygon fill="black" stroke="black" points="487.5,-4256.3 484,-4246.3 480.5,-4256.3 487.5,-4256.3"/>
</g>
<!-- layer0_attn_out -->
<g id="node6" class="node">
<title>layer0_attn_out</title>
<polygon fill="lightblue" stroke="black" points="781,-4142.17 241,-4142.17 241,-4074.17 781,-4074.17 781,-4142.17"/>
<text text-anchor="middle" x="511" y="-4126.97" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output</text>
<text text-anchor="middle" x="511" y="-4111.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="511" y="-4096.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
<text text-anchor="middle" x="511" y="-4081.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted&#45;&gt;layer0_attn_out -->
<g id="edge5" class="edge">
<title>layer0_attn_weighted&#45;&gt;layer0_attn_out</title>
<path fill="none" stroke="black" d="M511,-4178.11C511,-4178.11 511,-4152.3 511,-4152.3"/>
<polygon fill="black" stroke="black" points="514.5,-4152.3 511,-4142.3 507.5,-4152.3 514.5,-4152.3"/>
</g>
<!-- layer0_attn_out&#45;&gt;layer0_res_add1 -->
<g id="edge6" class="edge">
<title>layer0_attn_out&#45;&gt;layer0_res_add1</title>
<path fill="none" stroke="black" d="M511,-4074.11C511,-4074.11 511,-4048.3 511,-4048.3"/>
<polygon fill="black" stroke="black" points="514.5,-4048.3 511,-4038.3 507.5,-4048.3 514.5,-4048.3"/>
</g>
<!-- layer0_ffn1 -->
<g id="node8" class="node">
<title>layer0_ffn1</title>
<polygon fill="lightblue" stroke="black" points="736,-3934.17 186,-3934.17 186,-3866.17 736,-3866.17 736,-3934.17"/>
<text text-anchor="middle" x="461" y="-3918.97" font-family="Times,serif" font-size="14.00">Layer 0 FFN Up</text>
<text text-anchor="middle" x="461" y="-3903.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="461" y="-3888.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="461" y="-3873.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
</g>
<!-- layer0_res_add1&#45;&gt;layer0_ffn1 -->
<g id="edge8" class="edge">
<title>layer0_res_add1&#45;&gt;layer0_ffn1</title>
<path fill="none" stroke="black" d="M461,-3970.11C461,-3970.11 461,-3944.3 461,-3944.3"/>
<polygon fill="black" stroke="black" points="464.5,-3944.3 461,-3934.3 457.5,-3944.3 464.5,-3944.3"/>
</g>
<!-- layer0_res_add2 -->
<g id="node11" class="node">
<title>layer0_res_add2</title>
<polygon fill="lightblue" stroke="black" points="1076.5,-3622.17 75.5,-3622.17 75.5,-3554.17 1076.5,-3554.17 1076.5,-3622.17"/>
<text text-anchor="middle" x="576" y="-3606.97" font-family="Times,serif" font-size="14.00">Layer 0 Residual Add 2</text>
<text text-anchor="middle" x="576" y="-3591.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="576" y="-3576.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512], [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="576" y="-3561.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_res_add1&#45;&gt;layer0_res_add2 -->
<g id="edge12" class="edge">
<title>layer0_res_add1&#45;&gt;layer0_res_add2</title>
<path fill="none" stroke="black" d="M130.75,-3970.12C130.75,-3970.12 130.75,-3632.39 130.75,-3632.39"/>
<polygon fill="black" stroke="black" points="134.25,-3632.39 130.75,-3622.39 127.25,-3632.39 134.25,-3632.39"/>
</g>
<!-- layer0_gelu -->
<g id="node9" class="node">
<title>layer0_gelu</title>
<polygon fill="lightblue" stroke="black" points="736,-3830.17 186,-3830.17 186,-3762.17 736,-3762.17 736,-3830.17"/>
<text text-anchor="middle" x="461" y="-3814.97" font-family="Times,serif" font-size="14.00">Layer 0 GELU</text>
<text text-anchor="middle" x="461" y="-3799.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="461" y="-3784.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
<text text-anchor="middle" x="461" y="-3769.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
</g>
<!-- layer0_ffn1&#45;&gt;layer0_gelu -->
<g id="edge9" class="edge">
<title>layer0_ffn1&#45;&gt;layer0_gelu</title>
<path fill="none" stroke="black" d="M461,-3866.11C461,-3866.11 461,-3840.3 461,-3840.3"/>
<polygon fill="black" stroke="black" points="464.5,-3840.3 461,-3830.3 457.5,-3840.3 464.5,-3840.3"/>
</g>
<!-- layer0_ffn2 -->
<g id="node10" class="node">
<title>layer0_ffn2</title>
<polygon fill="lightblue" stroke="black" points="734,-3726.17 194,-3726.17 194,-3658.17 734,-3658.17 734,-3726.17"/>
<text text-anchor="middle" x="464" y="-3710.97" font-family="Times,serif" font-size="14.00">Layer 0 FFN Down</text>
<text text-anchor="middle" x="464" y="-3695.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="464" y="-3680.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
<text text-anchor="middle" x="464" y="-3665.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_gelu&#45;&gt;layer0_ffn2 -->
<g id="edge10" class="edge">
<title>layer0_gelu&#45;&gt;layer0_ffn2</title>
<path fill="none" stroke="black" d="M464,-3762.11C464,-3762.11 464,-3736.3 464,-3736.3"/>
<polygon fill="black" stroke="black" points="467.5,-3736.3 464,-3726.3 460.5,-3736.3 467.5,-3736.3"/>
</g>
<!-- layer0_ffn2&#45;&gt;layer0_res_add2 -->
<g id="edge11" class="edge">
<title>layer0_ffn2&#45;&gt;layer0_res_add2</title>
<path fill="none" stroke="black" d="M464,-3658.11C464,-3658.11 464,-3632.3 464,-3632.3"/>
<polygon fill="black" stroke="black" points="467.5,-3632.3 464,-3622.3 460.5,-3632.3 467.5,-3632.3"/>
</g>
<!-- layer1_rmsnorm -->
<g id="node12" class="node">
<title>layer1_rmsnorm</title>
<polygon fill="lightblue" stroke="black" points="827,-3518.17 287,-3518.17 287,-3450.17 827,-3450.17 827,-3518.17"/>
<text text-anchor="middle" x="557" y="-3502.97" font-family="Times,serif" font-size="14.00">Layer 1 RMSNorm</text>
<text text-anchor="middle" x="557" y="-3487.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="557" y="-3472.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="557" y="-3457.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_res_add2&#45;&gt;layer1_rmsnorm -->
<g id="edge13" class="edge">
<title>layer0_res_add2&#45;&gt;layer1_rmsnorm</title>
<path fill="none" stroke="black" d="M557,-3554.11C557,-3554.11 557,-3528.3 557,-3528.3"/>
<polygon fill="black" stroke="black" points="560.5,-3528.3 557,-3518.3 553.5,-3528.3 560.5,-3528.3"/>
</g>
<!-- layer1_res_add1 -->
<g id="node17" class="node">
<title>layer1_res_add1</title>
<polygon fill="lightblue" stroke="black" points="1076.5,-2998.17 75.5,-2998.17 75.5,-2930.17 1076.5,-2930.17 1076.5,-2998.17"/>
<text text-anchor="middle" x="576" y="-2982.97" font-family="Times,serif" font-size="14.00">Layer 1 Residual Add 1</text>
<text text-anchor="middle" x="576" y="-2967.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="576" y="-2952.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512], [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="576" y="-2937.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_res_add2&#45;&gt;layer1_res_add1 -->
<g id="edge19" class="edge">
<title>layer0_res_add2&#45;&gt;layer1_res_add1</title>
<path fill="none" stroke="black" d="M953,-3553.73C953,-3553.73 953,-3008.5 953,-3008.5"/>
<polygon fill="black" stroke="black" points="956.5,-3008.5 953,-2998.5 949.5,-3008.5 956.5,-3008.5"/>
</g>
<!-- layer1_attn_qkv -->
<g id="node13" class="node">
<title>layer1_attn_qkv</title>
<polygon fill="lightblue" stroke="black" points="784,-3414.17 230,-3414.17 230,-3346.17 784,-3346.17 784,-3414.17"/>
<text text-anchor="middle" x="507" y="-3398.97" font-family="Times,serif" font-size="14.00">Layer 1 QKV Projection</text>
<text text-anchor="middle" x="507" y="-3383.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="507" y="-3368.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="507" y="-3353.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128, partition=512]</text>
</g>
<!-- layer1_rmsnorm&#45;&gt;layer1_attn_qkv -->
<g id="edge14" class="edge">
<title>layer1_rmsnorm&#45;&gt;layer1_attn_qkv</title>
<path fill="none" stroke="black" d="M535.5,-3450.11C535.5,-3450.11 535.5,-3424.3 535.5,-3424.3"/>
<polygon fill="black" stroke="black" points="539,-3424.3 535.5,-3414.3 532,-3424.3 539,-3424.3"/>
</g>
<!-- layer1_attn_scores -->
<g id="node14" class="node">
<title>layer1_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="705.5,-3310.17 262.5,-3310.17 262.5,-3242.17 705.5,-3242.17 705.5,-3310.17"/>
<text text-anchor="middle" x="484" y="-3294.97" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores</text>
<text text-anchor="middle" x="484" y="-3279.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="484" y="-3264.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
<text text-anchor="middle" x="484" y="-3249.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv&#45;&gt;layer1_attn_scores -->
<g id="edge15" class="edge">
<title>layer1_attn_qkv&#45;&gt;layer1_attn_scores</title>
<path fill="none" stroke="black" d="M484,-3346.11C484,-3346.11 484,-3320.3 484,-3320.3"/>
<polygon fill="black" stroke="black" points="487.5,-3320.3 484,-3310.3 480.5,-3320.3 487.5,-3320.3"/>
</g>
<!-- layer1_attn_weighted -->
<g id="node15" class="node">
<title>layer1_attn_weighted</title>
<polygon fill="lightblue" stroke="black" points="829.5,-3206.17 92.5,-3206.17 92.5,-3138.17 829.5,-3138.17 829.5,-3206.17"/>
<text text-anchor="middle" x="461" y="-3190.97" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum</text>
<text text-anchor="middle" x="461" y="-3175.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="461" y="-3160.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="461" y="-3145.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores&#45;&gt;layer1_attn_weighted -->
<g id="edge16" class="edge">
<title>layer1_attn_scores&#45;&gt;layer1_attn_weighted</title>
<path fill="none" stroke="black" d="M484,-3242.11C484,-3242.11 484,-3216.3 484,-3216.3"/>
<polygon fill="black" stroke="black" points="487.5,-3216.3 484,-3206.3 480.5,-3216.3 487.5,-3216.3"/>
</g>
<!-- layer1_attn_out -->
<g id="node16" class="node">
<title>layer1_attn_out</title>
<polygon fill="lightblue" stroke="black" points="781,-3102.17 241,-3102.17 241,-3034.17 781,-3034.17 781,-3102.17"/>
<text text-anchor="middle" x="511" y="-3086.97" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output</text>
<text text-anchor="middle" x="511" y="-3071.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="511" y="-3056.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
<text text-anchor="middle" x="511" y="-3041.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted&#45;&gt;layer1_attn_out -->
<g id="edge17" class="edge">
<title>layer1_attn_weighted&#45;&gt;layer1_attn_out</title>
<path fill="none" stroke="black" d="M511,-3138.11C511,-3138.11 511,-3112.3 511,-3112.3"/>
<polygon fill="black" stroke="black" points="514.5,-3112.3 511,-3102.3 507.5,-3112.3 514.5,-3112.3"/>
</g>
<!-- layer1_attn_out&#45;&gt;layer1_res_add1 -->
<g id="edge18" class="edge">
<title>layer1_attn_out&#45;&gt;layer1_res_add1</title>
<path fill="none" stroke="black" d="M511,-3034.11C511,-3034.11 511,-3008.3 511,-3008.3"/>
<polygon fill="black" stroke="black" points="514.5,-3008.3 511,-2998.3 507.5,-3008.3 514.5,-3008.3"/>
</g>
<!-- layer1_ffn1 -->
<g id="node18" class="node">
<title>layer1_ffn1</title>
<polygon fill="lightblue" stroke="black" points="736,-2894.17 186,-2894.17 186,-2826.17 736,-2826.17 736,-2894.17"/>
<text text-anchor="middle" x="461" y="-2878.97" font-family="Times,serif" font-size="14.00">Layer 1 FFN Up</text>
<text text-anchor="middle" x="461" y="-2863.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="461" y="-2848.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="461" y="-2833.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
</g>
<!-- layer1_res_add1&#45;&gt;layer1_ffn1 -->
<g id="edge20" class="edge">
<title>layer1_res_add1&#45;&gt;layer1_ffn1</title>
<path fill="none" stroke="black" d="M461,-2930.11C461,-2930.11 461,-2904.3 461,-2904.3"/>
<polygon fill="black" stroke="black" points="464.5,-2904.3 461,-2894.3 457.5,-2904.3 464.5,-2904.3"/>
</g>
<!-- layer1_res_add2 -->
<g id="node21" class="node">
<title>layer1_res_add2</title>
<polygon fill="lightblue" stroke="black" points="1076.5,-2582.17 75.5,-2582.17 75.5,-2514.17 1076.5,-2514.17 1076.5,-2582.17"/>
<text text-anchor="middle" x="576" y="-2566.97" font-family="Times,serif" font-size="14.00">Layer 1 Residual Add 2</text>
<text text-anchor="middle" x="576" y="-2551.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="576" y="-2536.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512], [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="576" y="-2521.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_res_add1&#45;&gt;layer1_res_add2 -->
<g id="edge24" class="edge">
<title>layer1_res_add1&#45;&gt;layer1_res_add2</title>
<path fill="none" stroke="black" d="M906.25,-2930.12C906.25,-2930.12 906.25,-2592.39 906.25,-2592.39"/>
<polygon fill="black" stroke="black" points="909.75,-2592.39 906.25,-2582.39 902.75,-2592.39 909.75,-2592.39"/>
</g>
<!-- layer1_gelu -->
<g id="node19" class="node">
<title>layer1_gelu</title>
<polygon fill="lightblue" stroke="black" points="736,-2790.17 186,-2790.17 186,-2722.17 736,-2722.17 736,-2790.17"/>
<text text-anchor="middle" x="461" y="-2774.97" font-family="Times,serif" font-size="14.00">Layer 1 GELU</text>
<text text-anchor="middle" x="461" y="-2759.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="461" y="-2744.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
<text text-anchor="middle" x="461" y="-2729.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
</g>
<!-- layer1_ffn1&#45;&gt;layer1_gelu -->
<g id="edge21" class="edge">
<title>layer1_ffn1&#45;&gt;layer1_gelu</title>
<path fill="none" stroke="black" d="M461,-2826.11C461,-2826.11 461,-2800.3 461,-2800.3"/>
<polygon fill="black" stroke="black" points="464.5,-2800.3 461,-2790.3 457.5,-2800.3 464.5,-2800.3"/>
</g>
<!-- layer1_ffn2 -->
<g id="node20" class="node">
<title>layer1_ffn2</title>
<polygon fill="lightblue" stroke="black" points="734,-2686.17 194,-2686.17 194,-2618.17 734,-2618.17 734,-2686.17"/>
<text text-anchor="middle" x="464" y="-2670.97" font-family="Times,serif" font-size="14.00">Layer 1 FFN Down</text>
<text text-anchor="middle" x="464" y="-2655.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="464" y="-2640.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
<text text-anchor="middle" x="464" y="-2625.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_gelu&#45;&gt;layer1_ffn2 -->
<g id="edge22" class="edge">
<title>layer1_gelu&#45;&gt;layer1_ffn2</title>
<path fill="none" stroke="black" d="M464,-2722.11C464,-2722.11 464,-2696.3 464,-2696.3"/>
<polygon fill="black" stroke="black" points="467.5,-2696.3 464,-2686.3 460.5,-2696.3 467.5,-2696.3"/>
</g>
<!-- layer1_ffn2&#45;&gt;layer1_res_add2 -->
<g id="edge23" class="edge">
<title>layer1_ffn2&#45;&gt;layer1_res_add2</title>
<path fill="none" stroke="black" d="M464,-2618.11C464,-2618.11 464,-2592.3 464,-2592.3"/>
<polygon fill="black" stroke="black" points="467.5,-2592.3 464,-2582.3 460.5,-2592.3 467.5,-2592.3"/>
</g>
<!-- pipeline_comm_1 -->
<g id="node22" class="node">
<title>pipeline_comm_1</title>
<polygon fill="yellow" stroke="black" points="1135.69,-2452.17 245.35,-2452.17 16.31,-2316.17 906.65,-2316.17 1135.69,-2452.17"/>
<text text-anchor="middle" x="576" y="-2402.97" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="576" y="-2387.97" font-family="Times,serif" font-size="14.00">GPU: [7] → [8]</text>
<text text-anchor="middle" x="576" y="-2372.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="576" y="-2357.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_res_add2&#45;&gt;pipeline_comm_1 -->
<g id="edge25" class="edge">
<title>layer1_res_add2&#45;&gt;pipeline_comm_1</title>
<path fill="none" stroke="black" d="M576,-2513.79C576,-2513.79 576,-2462.31 576,-2462.31"/>
<polygon fill="black" stroke="black" points="579.5,-2462.31 576,-2452.31 572.5,-2462.31 579.5,-2462.31"/>
</g>
<!-- layer2_rmsnorm -->
<g id="node23" class="node">
<title>layer2_rmsnorm</title>
<polygon fill="lightblue" stroke="black" points="798,-2280.17 258,-2280.17 258,-2212.17 798,-2212.17 798,-2280.17"/>
<text text-anchor="middle" x="528" y="-2264.97" font-family="Times,serif" font-size="14.00">Layer 2 RMSNorm</text>
<text text-anchor="middle" x="528" y="-2249.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="528" y="-2234.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="528" y="-2219.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- pipeline_comm_1&#45;&gt;layer2_rmsnorm -->
<g id="edge26" class="edge">
<title>pipeline_comm_1&#45;&gt;layer2_rmsnorm</title>
<path fill="none" stroke="black" d="M528,-2315.98C528,-2315.98 528,-2290.38 528,-2290.38"/>
<polygon fill="black" stroke="black" points="531.5,-2290.38 528,-2280.38 524.5,-2290.38 531.5,-2290.38"/>
</g>
<!-- layer2_res_add1 -->
<g id="node28" class="node">
<title>layer2_res_add1</title>
<polygon fill="lightblue" stroke="black" points="1059.5,-1760.17 58.5,-1760.17 58.5,-1692.17 1059.5,-1692.17 1059.5,-1760.17"/>
<text text-anchor="middle" x="559" y="-1744.97" font-family="Times,serif" font-size="14.00">Layer 2 Residual Add 1</text>
<text text-anchor="middle" x="559" y="-1729.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="559" y="-1714.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512], [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="559" y="-1699.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- pipeline_comm_1&#45;&gt;layer2_res_add1 -->
<g id="edge32" class="edge">
<title>pipeline_comm_1&#45;&gt;layer2_res_add1</title>
<path fill="none" stroke="black" d="M930,-2329.76C930,-2329.76 930,-1770.43 930,-1770.43"/>
<polygon fill="black" stroke="black" points="933.5,-1770.43 930,-1760.43 926.5,-1770.43 933.5,-1770.43"/>
</g>
<!-- layer2_attn_qkv -->
<g id="node24" class="node">
<title>layer2_attn_qkv</title>
<polygon fill="lightblue" stroke="black" points="755,-2176.17 201,-2176.17 201,-2108.17 755,-2108.17 755,-2176.17"/>
<text text-anchor="middle" x="478" y="-2160.97" font-family="Times,serif" font-size="14.00">Layer 2 QKV Projection</text>
<text text-anchor="middle" x="478" y="-2145.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="478" y="-2130.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="478" y="-2115.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128, partition=512]</text>
</g>
<!-- layer2_rmsnorm&#45;&gt;layer2_attn_qkv -->
<g id="edge27" class="edge">
<title>layer2_rmsnorm&#45;&gt;layer2_attn_qkv</title>
<path fill="none" stroke="black" d="M506.5,-2212.11C506.5,-2212.11 506.5,-2186.3 506.5,-2186.3"/>
<polygon fill="black" stroke="black" points="510,-2186.3 506.5,-2176.3 503,-2186.3 510,-2186.3"/>
</g>
<!-- layer2_attn_scores -->
<g id="node25" class="node">
<title>layer2_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="676.5,-2072.17 233.5,-2072.17 233.5,-2004.17 676.5,-2004.17 676.5,-2072.17"/>
<text text-anchor="middle" x="455" y="-2056.97" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores</text>
<text text-anchor="middle" x="455" y="-2041.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="455" y="-2026.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
<text text-anchor="middle" x="455" y="-2011.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv&#45;&gt;layer2_attn_scores -->
<g id="edge28" class="edge">
<title>layer2_attn_qkv&#45;&gt;layer2_attn_scores</title>
<path fill="none" stroke="black" d="M455,-2108.11C455,-2108.11 455,-2082.3 455,-2082.3"/>
<polygon fill="black" stroke="black" points="458.5,-2082.3 455,-2072.3 451.5,-2082.3 458.5,-2082.3"/>
</g>
<!-- layer2_attn_weighted -->
<g id="node26" class="node">
<title>layer2_attn_weighted</title>
<polygon fill="lightblue" stroke="black" points="800.5,-1968.17 63.5,-1968.17 63.5,-1900.17 800.5,-1900.17 800.5,-1968.17"/>
<text text-anchor="middle" x="432" y="-1952.97" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum</text>
<text text-anchor="middle" x="432" y="-1937.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="432" y="-1922.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="432" y="-1907.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores&#45;&gt;layer2_attn_weighted -->
<g id="edge29" class="edge">
<title>layer2_attn_scores&#45;&gt;layer2_attn_weighted</title>
<path fill="none" stroke="black" d="M455,-2004.11C455,-2004.11 455,-1978.3 455,-1978.3"/>
<polygon fill="black" stroke="black" points="458.5,-1978.3 455,-1968.3 451.5,-1978.3 458.5,-1978.3"/>
</g>
<!-- layer2_attn_out -->
<g id="node27" class="node">
<title>layer2_attn_out</title>
<polygon fill="lightblue" stroke="black" points="751,-1864.17 211,-1864.17 211,-1796.17 751,-1796.17 751,-1864.17"/>
<text text-anchor="middle" x="481" y="-1848.97" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output</text>
<text text-anchor="middle" x="481" y="-1833.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="481" y="-1818.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
<text text-anchor="middle" x="481" y="-1803.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted&#45;&gt;layer2_attn_out -->
<g id="edge30" class="edge">
<title>layer2_attn_weighted&#45;&gt;layer2_attn_out</title>
<path fill="none" stroke="black" d="M481,-1900.11C481,-1900.11 481,-1874.3 481,-1874.3"/>
<polygon fill="black" stroke="black" points="484.5,-1874.3 481,-1864.3 477.5,-1874.3 484.5,-1874.3"/>
</g>
<!-- layer2_attn_out&#45;&gt;layer2_res_add1 -->
<g id="edge31" class="edge">
<title>layer2_attn_out&#45;&gt;layer2_res_add1</title>
<path fill="none" stroke="black" d="M481,-1796.11C481,-1796.11 481,-1770.3 481,-1770.3"/>
<polygon fill="black" stroke="black" points="484.5,-1770.3 481,-1760.3 477.5,-1770.3 484.5,-1770.3"/>
</g>
<!-- layer2_ffn1 -->
<g id="node29" class="node">
<title>layer2_ffn1</title>
<polygon fill="lightblue" stroke="black" points="678,-1656.17 128,-1656.17 128,-1588.17 678,-1588.17 678,-1656.17"/>
<text text-anchor="middle" x="403" y="-1640.97" font-family="Times,serif" font-size="14.00">Layer 2 FFN Up</text>
<text text-anchor="middle" x="403" y="-1625.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="403" y="-1610.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="403" y="-1595.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
</g>
<!-- layer2_res_add1&#45;&gt;layer2_ffn1 -->
<g id="edge33" class="edge">
<title>layer2_res_add1&#45;&gt;layer2_ffn1</title>
<path fill="none" stroke="black" d="M403,-1692.11C403,-1692.11 403,-1666.3 403,-1666.3"/>
<polygon fill="black" stroke="black" points="406.5,-1666.3 403,-1656.3 399.5,-1666.3 406.5,-1666.3"/>
</g>
<!-- layer2_res_add2 -->
<g id="node32" class="node">
<title>layer2_res_add2</title>
<polygon fill="lightblue" stroke="black" points="1076.5,-1344.17 75.5,-1344.17 75.5,-1276.17 1076.5,-1276.17 1076.5,-1344.17"/>
<text text-anchor="middle" x="576" y="-1328.97" font-family="Times,serif" font-size="14.00">Layer 2 Residual Add 2</text>
<text text-anchor="middle" x="576" y="-1313.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="576" y="-1298.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512], [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="576" y="-1283.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_res_add1&#45;&gt;layer2_res_add2 -->
<g id="edge37" class="edge">
<title>layer2_res_add1&#45;&gt;layer2_res_add2</title>
<path fill="none" stroke="black" d="M868.75,-1692.12C868.75,-1692.12 868.75,-1354.39 868.75,-1354.39"/>
<polygon fill="black" stroke="black" points="872.25,-1354.39 868.75,-1344.39 865.25,-1354.39 872.25,-1354.39"/>
</g>
<!-- layer2_gelu -->
<g id="node30" class="node">
<title>layer2_gelu</title>
<polygon fill="lightblue" stroke="black" points="678,-1552.17 128,-1552.17 128,-1484.17 678,-1484.17 678,-1552.17"/>
<text text-anchor="middle" x="403" y="-1536.97" font-family="Times,serif" font-size="14.00">Layer 2 GELU</text>
<text text-anchor="middle" x="403" y="-1521.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="403" y="-1506.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
<text text-anchor="middle" x="403" y="-1491.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
</g>
<!-- layer2_ffn1&#45;&gt;layer2_gelu -->
<g id="edge34" class="edge">
<title>layer2_ffn1&#45;&gt;layer2_gelu</title>
<path fill="none" stroke="black" d="M403,-1588.11C403,-1588.11 403,-1562.3 403,-1562.3"/>
<polygon fill="black" stroke="black" points="406.5,-1562.3 403,-1552.3 399.5,-1562.3 406.5,-1562.3"/>
</g>
<!-- layer2_ffn2 -->
<g id="node31" class="node">
<title>layer2_ffn2</title>
<polygon fill="lightblue" stroke="black" points="675,-1448.17 135,-1448.17 135,-1380.17 675,-1380.17 675,-1448.17"/>
<text text-anchor="middle" x="405" y="-1432.97" font-family="Times,serif" font-size="14.00">Layer 2 FFN Down</text>
<text text-anchor="middle" x="405" y="-1417.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="405" y="-1402.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
<text text-anchor="middle" x="405" y="-1387.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_gelu&#45;&gt;layer2_ffn2 -->
<g id="edge35" class="edge">
<title>layer2_gelu&#45;&gt;layer2_ffn2</title>
<path fill="none" stroke="black" d="M405,-1484.11C405,-1484.11 405,-1458.3 405,-1458.3"/>
<polygon fill="black" stroke="black" points="408.5,-1458.3 405,-1448.3 401.5,-1458.3 408.5,-1458.3"/>
</g>
<!-- layer2_ffn2&#45;&gt;layer2_res_add2 -->
<g id="edge36" class="edge">
<title>layer2_ffn2&#45;&gt;layer2_res_add2</title>
<path fill="none" stroke="black" d="M405,-1380.11C405,-1380.11 405,-1354.3 405,-1354.3"/>
<polygon fill="black" stroke="black" points="408.5,-1354.3 405,-1344.3 401.5,-1354.3 408.5,-1354.3"/>
</g>
<!-- layer3_rmsnorm -->
<g id="node33" class="node">
<title>layer3_rmsnorm</title>
<polygon fill="lightblue" stroke="black" points="792,-1240.17 252,-1240.17 252,-1172.17 792,-1172.17 792,-1240.17"/>
<text text-anchor="middle" x="522" y="-1224.97" font-family="Times,serif" font-size="14.00">Layer 3 RMSNorm</text>
<text text-anchor="middle" x="522" y="-1209.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="522" y="-1194.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="522" y="-1179.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_res_add2&#45;&gt;layer3_rmsnorm -->
<g id="edge38" class="edge">
<title>layer2_res_add2&#45;&gt;layer3_rmsnorm</title>
<path fill="none" stroke="black" d="M522,-1276.11C522,-1276.11 522,-1250.3 522,-1250.3"/>
<polygon fill="black" stroke="black" points="525.5,-1250.3 522,-1240.3 518.5,-1250.3 525.5,-1250.3"/>
</g>
<!-- layer3_res_add1 -->
<g id="node38" class="node">
<title>layer3_res_add1</title>
<polygon fill="lightblue" stroke="black" points="1059.5,-720.17 58.5,-720.17 58.5,-652.17 1059.5,-652.17 1059.5,-720.17"/>
<text text-anchor="middle" x="559" y="-704.97" font-family="Times,serif" font-size="14.00">Layer 3 Residual Add 1</text>
<text text-anchor="middle" x="559" y="-689.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="559" y="-674.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512], [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="559" y="-659.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_res_add2&#45;&gt;layer3_res_add1 -->
<g id="edge44" class="edge">
<title>layer2_res_add2&#45;&gt;layer3_res_add1</title>
<path fill="none" stroke="black" d="M939,-1275.73C939,-1275.73 939,-730.5 939,-730.5"/>
<polygon fill="black" stroke="black" points="942.5,-730.5 939,-720.5 935.5,-730.5 942.5,-730.5"/>
</g>
<!-- layer3_attn_qkv -->
<g id="node34" class="node">
<title>layer3_attn_qkv</title>
<polygon fill="lightblue" stroke="black" points="773,-1136.17 219,-1136.17 219,-1068.17 773,-1068.17 773,-1136.17"/>
<text text-anchor="middle" x="496" y="-1120.97" font-family="Times,serif" font-size="14.00">Layer 3 QKV Projection</text>
<text text-anchor="middle" x="496" y="-1105.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="496" y="-1090.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="496" y="-1075.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128, partition=512]</text>
</g>
<!-- layer3_rmsnorm&#45;&gt;layer3_attn_qkv -->
<g id="edge39" class="edge">
<title>layer3_rmsnorm&#45;&gt;layer3_attn_qkv</title>
<path fill="none" stroke="black" d="M512.5,-1172.11C512.5,-1172.11 512.5,-1146.3 512.5,-1146.3"/>
<polygon fill="black" stroke="black" points="516,-1146.3 512.5,-1136.3 509,-1146.3 516,-1146.3"/>
</g>
<!-- layer3_attn_scores -->
<g id="node35" class="node">
<title>layer3_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="694.5,-1032.17 251.5,-1032.17 251.5,-964.17 694.5,-964.17 694.5,-1032.17"/>
<text text-anchor="middle" x="473" y="-1016.97" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores</text>
<text text-anchor="middle" x="473" y="-1001.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="473" y="-986.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
<text text-anchor="middle" x="473" y="-971.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv&#45;&gt;layer3_attn_scores -->
<g id="edge40" class="edge">
<title>layer3_attn_qkv&#45;&gt;layer3_attn_scores</title>
<path fill="none" stroke="black" d="M473,-1068.11C473,-1068.11 473,-1042.3 473,-1042.3"/>
<polygon fill="black" stroke="black" points="476.5,-1042.3 473,-1032.3 469.5,-1042.3 476.5,-1042.3"/>
</g>
<!-- layer3_attn_weighted -->
<g id="node36" class="node">
<title>layer3_attn_weighted</title>
<polygon fill="lightblue" stroke="black" points="818.5,-928.17 81.5,-928.17 81.5,-860.17 818.5,-860.17 818.5,-928.17"/>
<text text-anchor="middle" x="450" y="-912.97" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum</text>
<text text-anchor="middle" x="450" y="-897.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="450" y="-882.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="450" y="-867.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores&#45;&gt;layer3_attn_weighted -->
<g id="edge41" class="edge">
<title>layer3_attn_scores&#45;&gt;layer3_attn_weighted</title>
<path fill="none" stroke="black" d="M473,-964.11C473,-964.11 473,-938.3 473,-938.3"/>
<polygon fill="black" stroke="black" points="476.5,-938.3 473,-928.3 469.5,-938.3 476.5,-938.3"/>
</g>
<!-- layer3_attn_out -->
<g id="node37" class="node">
<title>layer3_attn_out</title>
<polygon fill="lightblue" stroke="black" points="769,-824.17 229,-824.17 229,-756.17 769,-756.17 769,-824.17"/>
<text text-anchor="middle" x="499" y="-808.97" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output</text>
<text text-anchor="middle" x="499" y="-793.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="499" y="-778.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, heads=32, d_k=128]</text>
<text text-anchor="middle" x="499" y="-763.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted&#45;&gt;layer3_attn_out -->
<g id="edge42" class="edge">
<title>layer3_attn_weighted&#45;&gt;layer3_attn_out</title>
<path fill="none" stroke="black" d="M499,-860.11C499,-860.11 499,-834.3 499,-834.3"/>
<polygon fill="black" stroke="black" points="502.5,-834.3 499,-824.3 495.5,-834.3 502.5,-834.3"/>
</g>
<!-- layer3_attn_out&#45;&gt;layer3_res_add1 -->
<g id="edge43" class="edge">
<title>layer3_attn_out&#45;&gt;layer3_res_add1</title>
<path fill="none" stroke="black" d="M499,-756.11C499,-756.11 499,-730.3 499,-730.3"/>
<polygon fill="black" stroke="black" points="502.5,-730.3 499,-720.3 495.5,-730.3 502.5,-730.3"/>
</g>
<!-- layer3_ffn1 -->
<g id="node39" class="node">
<title>layer3_ffn1</title>
<polygon fill="lightblue" stroke="black" points="678,-616.17 128,-616.17 128,-548.17 678,-548.17 678,-616.17"/>
<text text-anchor="middle" x="403" y="-600.97" font-family="Times,serif" font-size="14.00">Layer 3 FFN Up</text>
<text text-anchor="middle" x="403" y="-585.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="403" y="-570.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="403" y="-555.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
</g>
<!-- layer3_res_add1&#45;&gt;layer3_ffn1 -->
<g id="edge45" class="edge">
<title>layer3_res_add1&#45;&gt;layer3_ffn1</title>
<path fill="none" stroke="black" d="M403,-652.11C403,-652.11 403,-626.3 403,-626.3"/>
<polygon fill="black" stroke="black" points="406.5,-626.3 403,-616.3 399.5,-626.3 406.5,-626.3"/>
</g>
<!-- layer3_res_add2 -->
<g id="node42" class="node">
<title>layer3_res_add2</title>
<polygon fill="lightblue" stroke="black" points="1076.5,-304.17 75.5,-304.17 75.5,-236.17 1076.5,-236.17 1076.5,-304.17"/>
<text text-anchor="middle" x="576" y="-288.97" font-family="Times,serif" font-size="14.00">Layer 3 Residual Add 2</text>
<text text-anchor="middle" x="576" y="-273.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="576" y="-258.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512], [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="576" y="-243.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_res_add1&#45;&gt;layer3_res_add2 -->
<g id="edge49" class="edge">
<title>layer3_res_add1&#45;&gt;layer3_res_add2</title>
<path fill="none" stroke="black" d="M101.75,-652.12C101.75,-652.12 101.75,-314.39 101.75,-314.39"/>
<polygon fill="black" stroke="black" points="105.25,-314.39 101.75,-304.39 98.25,-314.39 105.25,-314.39"/>
</g>
<!-- layer3_gelu -->
<g id="node40" class="node">
<title>layer3_gelu</title>
<polygon fill="lightblue" stroke="black" points="678,-512.17 128,-512.17 128,-444.17 678,-444.17 678,-512.17"/>
<text text-anchor="middle" x="403" y="-496.97" font-family="Times,serif" font-size="14.00">Layer 3 GELU</text>
<text text-anchor="middle" x="403" y="-481.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="403" y="-466.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
<text text-anchor="middle" x="403" y="-451.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
</g>
<!-- layer3_ffn1&#45;&gt;layer3_gelu -->
<g id="edge46" class="edge">
<title>layer3_ffn1&#45;&gt;layer3_gelu</title>
<path fill="none" stroke="black" d="M403,-548.11C403,-548.11 403,-522.3 403,-522.3"/>
<polygon fill="black" stroke="black" points="406.5,-522.3 403,-512.3 399.5,-522.3 406.5,-522.3"/>
</g>
<!-- layer3_ffn2 -->
<g id="node41" class="node">
<title>layer3_ffn2</title>
<polygon fill="lightblue" stroke="black" points="675,-408.17 135,-408.17 135,-340.17 675,-340.17 675,-408.17"/>
<text text-anchor="middle" x="405" y="-392.97" font-family="Times,serif" font-size="14.00">Layer 3 FFN Down</text>
<text text-anchor="middle" x="405" y="-377.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="405" y="-362.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_hidden=16384, partition=2048]</text>
<text text-anchor="middle" x="405" y="-347.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_gelu&#45;&gt;layer3_ffn2 -->
<g id="edge47" class="edge">
<title>layer3_gelu&#45;&gt;layer3_ffn2</title>
<path fill="none" stroke="black" d="M405,-444.11C405,-444.11 405,-418.3 405,-418.3"/>
<polygon fill="black" stroke="black" points="408.5,-418.3 405,-408.3 401.5,-418.3 408.5,-418.3"/>
</g>
<!-- layer3_ffn2&#45;&gt;layer3_res_add2 -->
<g id="edge48" class="edge">
<title>layer3_ffn2&#45;&gt;layer3_res_add2</title>
<path fill="none" stroke="black" d="M405,-340.11C405,-340.11 405,-314.3 405,-314.3"/>
<polygon fill="black" stroke="black" points="408.5,-314.3 405,-304.3 401.5,-314.3 408.5,-314.3"/>
</g>
<!-- output_proj -->
<g id="node43" class="node">
<title>output_proj</title>
<polygon fill="lightblue" stroke="black" points="840,-200.17 312,-200.17 312,-132.17 840,-132.17 840,-200.17"/>
<text text-anchor="middle" x="576" y="-184.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="576" y="-169.97" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="576" y="-154.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="576" y="-139.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=?, partition=?]</text>
</g>
<!-- layer3_res_add2&#45;&gt;output_proj -->
<g id="edge50" class="edge">
<title>layer3_res_add2&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M576,-236.11C576,-236.11 576,-210.3 576,-210.3"/>
<polygon fill="black" stroke="black" points="579.5,-210.3 576,-200.3 572.5,-210.3 579.5,-210.3"/>
</g>
<!-- output -->
<g id="node44" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="576" cy="-48.08" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="576" y="-66.88" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="576" y="-51.88" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="576" y="-36.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, vocab_size=?, partition=?]</text>
<text text-anchor="middle" x="576" y="-21.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=?]</text>
</g>
<!-- output_proj&#45;&gt;output -->
<g id="edge51" class="edge">
<title>output_proj&#45;&gt;output</title>
<path fill="none" stroke="black" d="M576,-132.01C576,-132.01 576,-106.21 576,-106.21"/>
<polygon fill="black" stroke="black" points="579.5,-106.21 576,-96.21 572.5,-106.21 579.5,-106.21"/>
</g>
</g>
</svg>
