<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: fa_pool_transformer Pages: 1 -->
<svg width="12638pt" height="2396pt"
 viewBox="0.00 0.00 12638.00 2396.17" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2392.17)">
<title>fa_pool_transformer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2392.17 12634,-2392.17 12634,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_base</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="3901,-1059 3901,-1319 6173,-1319 6173,-1059 3901,-1059"/>
<text text-anchor="middle" x="5037" y="-1303.8" font-family="Times,serif" font-size="14.00">Base Layer &#45; GPUs [0&#45;7]</text>
<text text-anchor="middle" x="5037" y="-1288.8" font-family="Times,serif" font-size="14.00">FFN Operations Only</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0_attn_0</title>
<polygon fill="none" stroke="black" points="2128,-1663 2128,-2112 2914,-2112 2914,-1663 2128,-1663"/>
<text text-anchor="middle" x="2521" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 0</text>
<text text-anchor="middle" x="2521" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2521" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;820</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer0_attn_1</title>
<polygon fill="none" stroke="black" points="2934,-1663 2934,-2112 3748,-2112 3748,-1663 2934,-1663"/>
<text text-anchor="middle" x="3341" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 1</text>
<text text-anchor="middle" x="3341" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="3341" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 820&#45;1640</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer0_attn_2</title>
<polygon fill="none" stroke="black" points="3768,-1663 3768,-2112 4590,-2112 4590,-1663 3768,-1663"/>
<text text-anchor="middle" x="4179" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 2</text>
<text text-anchor="middle" x="4179" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4179" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 1640&#45;2460</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer0_attn_3</title>
<polygon fill="none" stroke="black" points="4610,-1663 4610,-2112 5432,-2112 5432,-1663 4610,-1663"/>
<text text-anchor="middle" x="5021" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 3</text>
<text text-anchor="middle" x="5021" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="5021" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 2460&#45;3280</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer0_attn_4</title>
<polygon fill="none" stroke="black" points="5452,-1663 5452,-2112 6274,-2112 6274,-1663 5452,-1663"/>
<text text-anchor="middle" x="5863" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 4</text>
<text text-anchor="middle" x="5863" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="5863" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 3280&#45;4097</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer1_attn_0</title>
<polygon fill="none" stroke="black" points="3368,-370 3368,-853 4154,-853 4154,-370 3368,-370"/>
<text text-anchor="middle" x="3761" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 0</text>
<text text-anchor="middle" x="3761" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3761" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;820</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer1_attn_1</title>
<polygon fill="none" stroke="black" points="8,-370 8,-853 822,-853 822,-370 8,-370"/>
<text text-anchor="middle" x="415" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 1</text>
<text text-anchor="middle" x="415" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="415" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 820&#45;1640</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer1_attn_2</title>
<polygon fill="none" stroke="black" points="842,-370 842,-853 1664,-853 1664,-370 842,-370"/>
<text text-anchor="middle" x="1253" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 2</text>
<text text-anchor="middle" x="1253" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="1253" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 1640&#45;2460</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer1_attn_3</title>
<polygon fill="none" stroke="black" points="1684,-370 1684,-853 2506,-853 2506,-370 1684,-370"/>
<text text-anchor="middle" x="2095" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 3</text>
<text text-anchor="middle" x="2095" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2095" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 2460&#45;3280</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer1_attn_4</title>
<polygon fill="none" stroke="black" points="2526,-370 2526,-853 3348,-853 3348,-370 2526,-370"/>
<text text-anchor="middle" x="2937" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 4</text>
<text text-anchor="middle" x="2937" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2937" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 3280&#45;4097</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer2_attn_0</title>
<polygon fill="none" stroke="black" points="6688,-508 6688,-1024 7474,-1024 7474,-508 6688,-508"/>
<text text-anchor="middle" x="7081" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 0</text>
<text text-anchor="middle" x="7081" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7081" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;820</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer2_attn_1</title>
<polygon fill="none" stroke="black" points="7494,-508 7494,-1024 8308,-1024 8308,-508 7494,-508"/>
<text text-anchor="middle" x="7901" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 1</text>
<text text-anchor="middle" x="7901" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7901" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 820&#45;1640</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer2_attn_2</title>
<polygon fill="none" stroke="black" points="4162,-508 4162,-1024 4984,-1024 4984,-508 4162,-508"/>
<text text-anchor="middle" x="4573" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 2</text>
<text text-anchor="middle" x="4573" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4573" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 1640&#45;2460</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer2_attn_3</title>
<polygon fill="none" stroke="black" points="5004,-508 5004,-1024 5826,-1024 5826,-508 5004,-508"/>
<text text-anchor="middle" x="5415" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 3</text>
<text text-anchor="middle" x="5415" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="5415" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 2460&#45;3280</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer2_attn_4</title>
<polygon fill="none" stroke="black" points="5846,-508 5846,-1024 6668,-1024 6668,-508 5846,-508"/>
<text text-anchor="middle" x="6257" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 4</text>
<text text-anchor="middle" x="6257" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6257" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 3280&#45;4097</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_layer3_attn_0</title>
<polygon fill="none" stroke="black" points="11002,-508 11002,-1024 11788,-1024 11788,-508 11002,-508"/>
<text text-anchor="middle" x="11395" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 0</text>
<text text-anchor="middle" x="11395" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="11395" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;820</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_layer3_attn_1</title>
<polygon fill="none" stroke="black" points="11808,-508 11808,-1024 12622,-1024 12622,-508 11808,-508"/>
<text text-anchor="middle" x="12215" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 1</text>
<text text-anchor="middle" x="12215" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="12215" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 820&#45;1640</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_layer3_attn_2</title>
<polygon fill="none" stroke="black" points="8476,-508 8476,-1024 9298,-1024 9298,-508 8476,-508"/>
<text text-anchor="middle" x="8887" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 2</text>
<text text-anchor="middle" x="8887" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8887" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 1640&#45;2460</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_layer3_attn_3</title>
<polygon fill="none" stroke="black" points="9318,-508 9318,-1024 10140,-1024 10140,-508 9318,-508"/>
<text text-anchor="middle" x="9729" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 3</text>
<text text-anchor="middle" x="9729" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9729" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 2460&#45;3280</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_layer3_attn_4</title>
<polygon fill="none" stroke="black" points="10160,-508 10160,-1024 10982,-1024 10982,-508 10160,-508"/>
<text text-anchor="middle" x="10571" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 4</text>
<text text-anchor="middle" x="10571" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10571" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 3280&#45;4097</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="4179" cy="-2340.08" rx="381.68" ry="48.17"/>
<text text-anchor="middle" x="4179" y="-2358.88" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="4179" y="-2343.88" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="4179" y="-2328.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096]</text>
<text text-anchor="middle" x="4179" y="-2313.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- send_to_pool -->
<g id="node7" class="node">
<title>send_to_pool</title>
<polygon fill="yellow" stroke="black" points="4738.69,-2256 3848.35,-2256 3619.31,-2120 4509.65,-2120 4738.69,-2256"/>
<text text-anchor="middle" x="4179" y="-2206.8" font-family="Times,serif" font-size="14.00">Send to Attention Pool</text>
<text text-anchor="middle" x="4179" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;{7+attention_pool_gpus}]</text>
<text text-anchor="middle" x="4179" y="-2176.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4179" y="-2161.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- input&#45;&gt;send_to_pool -->
<g id="edge1" class="edge">
<title>input&#45;&gt;send_to_pool</title>
<path fill="none" stroke="black" d="M4179,-2291.96C4179,-2291.96 4179,-2266.09 4179,-2266.09"/>
<polygon fill="black" stroke="black" points="4182.5,-2266.09 4179,-2256.09 4175.5,-2266.09 4182.5,-2266.09"/>
</g>
<!-- layer0_ffn_start -->
<g id="node2" class="node">
<title>layer0_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="4449,-1273 3909,-1273 3909,-1205 4449,-1205 4449,-1273"/>
<text text-anchor="middle" x="4179" y="-1257.8" font-family="Times,serif" font-size="14.00">Layer 0 FFN Start</text>
<text text-anchor="middle" x="4179" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="4179" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4179" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_ffn_start -->
<g id="node3" class="node">
<title>layer1_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="4449,-1135 3909,-1135 3909,-1067 4449,-1067 4449,-1135"/>
<text text-anchor="middle" x="4179" y="-1119.8" font-family="Times,serif" font-size="14.00">Layer 1 FFN Start</text>
<text text-anchor="middle" x="4179" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="4179" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4179" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_ffn_start&#45;&gt;layer1_ffn_start -->
<g id="edge29" class="edge">
<title>layer0_ffn_start&#45;&gt;layer1_ffn_start</title>
<path fill="none" stroke="black" d="M4179,-1204.89C4179,-1204.89 4179,-1145.2 4179,-1145.2"/>
<polygon fill="black" stroke="black" points="4182.5,-1145.2 4179,-1135.2 4175.5,-1145.2 4182.5,-1145.2"/>
</g>
<!-- send_to_pool_1 -->
<g id="node30" class="node">
<title>send_to_pool_1</title>
<polygon fill="yellow" stroke="black" points="3075.69,-997 2185.35,-997 1956.31,-861 2846.65,-861 3075.69,-997"/>
<text text-anchor="middle" x="2516" y="-947.8" font-family="Times,serif" font-size="14.00">Send Layer 1 to Pool</text>
<text text-anchor="middle" x="2516" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;12]</text>
<text text-anchor="middle" x="2516" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="2516" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_ffn_start&#45;&gt;send_to_pool_1 -->
<g id="edge30" class="edge">
<title>layer1_ffn_start&#45;&gt;send_to_pool_1</title>
<path fill="none" stroke="black" d="M3958.75,-1066.97C3958.75,-1029.35 3958.75,-974 3958.75,-974 3958.75,-974 3047.12,-974 3047.12,-974"/>
<polygon fill="black" stroke="black" points="3047.12,-970.5 3037.12,-974 3047.12,-977.5 3047.12,-970.5"/>
</g>
<!-- layer2_ffn_start -->
<g id="node4" class="node">
<title>layer2_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="5589,-1273 5049,-1273 5049,-1205 5589,-1205 5589,-1273"/>
<text text-anchor="middle" x="5319" y="-1257.8" font-family="Times,serif" font-size="14.00">Layer 2 FFN Start</text>
<text text-anchor="middle" x="5319" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="5319" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="5319" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- send_to_pool_2 -->
<g id="node53" class="node">
<title>send_to_pool_2</title>
<polygon fill="yellow" stroke="black" points="8004.69,-1169 7114.35,-1169 6885.31,-1033 7775.65,-1033 8004.69,-1169"/>
<text text-anchor="middle" x="7445" y="-1119.8" font-family="Times,serif" font-size="14.00">Send Layer 2 to Pool</text>
<text text-anchor="middle" x="7445" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;12]</text>
<text text-anchor="middle" x="7445" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7445" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_ffn_start&#45;&gt;send_to_pool_2 -->
<g id="edge58" class="edge">
<title>layer2_ffn_start&#45;&gt;send_to_pool_2</title>
<path fill="none" stroke="black" d="M5442.5,-1204.61C5442.5,-1182.93 5442.5,-1159 5442.5,-1159 5442.5,-1159 7087.33,-1159 7087.33,-1159"/>
<polygon fill="black" stroke="black" points="7087.33,-1162.5 7097.33,-1159 7087.33,-1155.5 7087.33,-1162.5"/>
</g>
<!-- layer3_ffn_start -->
<g id="node5" class="node">
<title>layer3_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="6165,-1273 5625,-1273 5625,-1205 6165,-1205 6165,-1273"/>
<text text-anchor="middle" x="5895" y="-1257.8" font-family="Times,serif" font-size="14.00">Layer 3 FFN Start</text>
<text text-anchor="middle" x="5895" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="5895" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="5895" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- send_to_pool_3 -->
<g id="node76" class="node">
<title>send_to_pool_3</title>
<polygon fill="yellow" stroke="black" points="10709.69,-1169 9819.35,-1169 9590.31,-1033 10480.65,-1033 10709.69,-1169"/>
<text text-anchor="middle" x="10150" y="-1119.8" font-family="Times,serif" font-size="14.00">Send Layer 3 to Pool</text>
<text text-anchor="middle" x="10150" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;12]</text>
<text text-anchor="middle" x="10150" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="10150" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_ffn_start&#45;&gt;send_to_pool_3 -->
<g id="edge86" class="edge">
<title>layer3_ffn_start&#45;&gt;send_to_pool_3</title>
<path fill="none" stroke="black" d="M6165.21,-1239C7101.49,-1239 10150,-1239 10150,-1239 10150,-1239 10150,-1179.19 10150,-1179.19"/>
<polygon fill="black" stroke="black" points="10153.5,-1179.19 10150,-1169.19 10146.5,-1179.19 10153.5,-1179.19"/>
</g>
<!-- output_proj -->
<g id="node6" class="node">
<title>output_proj</title>
<polygon fill="lightblue" stroke="black" points="5013,-1273 4485,-1273 4485,-1205 5013,-1205 5013,-1273"/>
<text text-anchor="middle" x="4749" y="-1257.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4749" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="4749" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4749" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=?, partition=?]</text>
</g>
<!-- output -->
<g id="node99" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="6515" cy="-1101" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="6515" y="-1119.8" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="6515" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="6515" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, vocab_size=?, partition=?]</text>
<text text-anchor="middle" x="6515" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=?]</text>
</g>
<!-- output_proj&#45;&gt;output -->
<g id="edge114" class="edge">
<title>output_proj&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5000,-1204.8C5000,-1176.87 5000,-1142 5000,-1142 5000,-1142 6330.1,-1142 6330.1,-1142"/>
<polygon fill="black" stroke="black" points="6330.1,-1145.5 6340.1,-1142 6330.1,-1138.5 6330.1,-1145.5"/>
</g>
<!-- layer0_attn_qkv_0 -->
<g id="node9" class="node">
<title>layer0_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="2883.5,-2051 2296.5,-2051 2296.5,-1983 2883.5,-1983 2883.5,-2051"/>
<text text-anchor="middle" x="2590" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 0</text>
<text text-anchor="middle" x="2590" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2590" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="2590" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_0 -->
<g id="edge2" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_0</title>
<path fill="none" stroke="black" d="M3733.73,-2188C3263.67,-2188 2590,-2188 2590,-2188 2590,-2188 2590,-2061.19 2590,-2061.19"/>
<polygon fill="black" stroke="black" points="2593.5,-2061.19 2590,-2051.19 2586.5,-2061.19 2593.5,-2061.19"/>
</g>
<!-- layer0_attn_qkv_1 -->
<g id="node13" class="node">
<title>layer0_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="3694,-2051 3080,-2051 3080,-1983 3694,-1983 3694,-2051"/>
<text text-anchor="middle" x="3387" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 1</text>
<text text-anchor="middle" x="3387" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="3387" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="3387" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_1 -->
<g id="edge7" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_1</title>
<path fill="none" stroke="black" d="M3656.58,-2187.88C3656.58,-2187.88 3656.58,-2061.06 3656.58,-2061.06"/>
<polygon fill="black" stroke="black" points="3660.08,-2061.06 3656.58,-2051.06 3653.08,-2061.06 3660.08,-2061.06"/>
</g>
<!-- layer0_attn_qkv_2 -->
<g id="node17" class="node">
<title>layer0_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="4490.5,-2051 3867.5,-2051 3867.5,-1983 4490.5,-1983 4490.5,-2051"/>
<text text-anchor="middle" x="4179" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 2</text>
<text text-anchor="middle" x="4179" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4179" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4179" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_2 -->
<g id="edge12" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_2</title>
<path fill="none" stroke="black" d="M4179,-2119.92C4179,-2119.92 4179,-2061.04 4179,-2061.04"/>
<polygon fill="black" stroke="black" points="4182.5,-2061.04 4179,-2051.04 4175.5,-2061.04 4182.5,-2061.04"/>
</g>
<!-- layer0_attn_qkv_3 -->
<g id="node21" class="node">
<title>layer0_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="5286.5,-2051 4663.5,-2051 4663.5,-1983 5286.5,-1983 5286.5,-2051"/>
<text text-anchor="middle" x="4975" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 3</text>
<text text-anchor="middle" x="4975" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4975" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4975" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_3 -->
<g id="edge17" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_3</title>
<path fill="none" stroke="black" d="M4701.17,-2187.88C4701.17,-2187.88 4701.17,-2061.06 4701.17,-2061.06"/>
<polygon fill="black" stroke="black" points="4704.67,-2061.06 4701.17,-2051.06 4697.67,-2061.06 4704.67,-2061.06"/>
</g>
<!-- layer0_attn_qkv_4 -->
<g id="node25" class="node">
<title>layer0_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="6128.5,-2051 5505.5,-2051 5505.5,-1983 6128.5,-1983 6128.5,-2051"/>
<text text-anchor="middle" x="5817" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 4</text>
<text text-anchor="middle" x="5817" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="5817" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="5817" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_4 -->
<g id="edge22" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_4</title>
<path fill="none" stroke="black" d="M4624.43,-2188C5109.47,-2188 5817,-2188 5817,-2188 5817,-2188 5817,-2061.19 5817,-2061.19"/>
<polygon fill="black" stroke="black" points="5820.5,-2061.19 5817,-2051.19 5813.5,-2061.19 5820.5,-2061.19"/>
</g>
<!-- recv_from_pool -->
<g id="node8" class="node">
<title>recv_from_pool</title>
<polygon fill="yellow" stroke="black" points="4738.69,-1463 3848.35,-1463 3619.31,-1327 4509.65,-1327 4738.69,-1463"/>
<text text-anchor="middle" x="4179" y="-1413.8" font-family="Times,serif" font-size="14.00">Receive from Attention Pool</text>
<text text-anchor="middle" x="4179" y="-1398.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;{7+attention_pool_gpus}] → [0&#45;7]</text>
<text text-anchor="middle" x="4179" y="-1383.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4179" y="-1368.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- recv_from_pool&#45;&gt;layer0_ffn_start -->
<g id="edge28" class="edge">
<title>recv_from_pool&#45;&gt;layer0_ffn_start</title>
<path fill="none" stroke="black" d="M4179,-1326.58C4179,-1326.58 4179,-1283.13 4179,-1283.13"/>
<polygon fill="black" stroke="black" points="4182.5,-1283.13 4179,-1273.13 4175.5,-1283.13 4182.5,-1283.13"/>
</g>
<!-- layer0_attn_scores_0 -->
<g id="node10" class="node">
<title>layer0_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="2782,-1947 2306,-1947 2306,-1879 2782,-1879 2782,-1947"/>
<text text-anchor="middle" x="2544" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 0</text>
<text text-anchor="middle" x="2544" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2544" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2544" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_0&#45;&gt;layer0_attn_scores_0 -->
<g id="edge3" class="edge">
<title>layer0_attn_qkv_0&#45;&gt;layer0_attn_scores_0</title>
<path fill="none" stroke="black" d="M2544,-1982.95C2544,-1982.95 2544,-1957.13 2544,-1957.13"/>
<polygon fill="black" stroke="black" points="2547.5,-1957.13 2544,-1947.13 2540.5,-1957.13 2547.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_0 -->
<g id="node11" class="node">
<title>layer0_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="2906,-1843 2136,-1843 2136,-1775 2906,-1775 2906,-1843"/>
<text text-anchor="middle" x="2521" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 0</text>
<text text-anchor="middle" x="2521" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2521" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="2521" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_0&#45;&gt;layer0_attn_weighted_0 -->
<g id="edge4" class="edge">
<title>layer0_attn_scores_0&#45;&gt;layer0_attn_weighted_0</title>
<path fill="none" stroke="black" d="M2544,-1878.95C2544,-1878.95 2544,-1853.13 2544,-1853.13"/>
<polygon fill="black" stroke="black" points="2547.5,-1853.13 2544,-1843.13 2540.5,-1853.13 2547.5,-1853.13"/>
</g>
<!-- layer0_attn_out_0 -->
<g id="node12" class="node">
<title>layer0_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="2856.5,-1739 2283.5,-1739 2283.5,-1671 2856.5,-1671 2856.5,-1739"/>
<text text-anchor="middle" x="2570" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 0</text>
<text text-anchor="middle" x="2570" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2570" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2570" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_0&#45;&gt;layer0_attn_out_0 -->
<g id="edge5" class="edge">
<title>layer0_attn_weighted_0&#45;&gt;layer0_attn_out_0</title>
<path fill="none" stroke="black" d="M2570,-1774.95C2570,-1774.95 2570,-1749.13 2570,-1749.13"/>
<polygon fill="black" stroke="black" points="2573.5,-1749.13 2570,-1739.13 2566.5,-1749.13 2573.5,-1749.13"/>
</g>
<!-- layer0_attn_aggregate -->
<g id="node29" class="node">
<title>layer0_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="4848.99,-1635 3783.19,-1635 3509.01,-1499 4574.81,-1499 4848.99,-1635"/>
<text text-anchor="middle" x="4179" y="-1585.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Aggregation</text>
<text text-anchor="middle" x="4179" y="-1570.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="4179" y="-1555.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="4179" y="-1540.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_out_0&#45;&gt;layer0_attn_aggregate -->
<g id="edge6" class="edge">
<title>layer0_attn_out_0&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M2570,-1670.89C2570,-1630.02 2570,-1567 2570,-1567 2570,-1567 3636.02,-1567 3636.02,-1567"/>
<polygon fill="black" stroke="black" points="3636.02,-1570.5 3646.02,-1567 3636.02,-1563.5 3636.02,-1570.5"/>
</g>
<!-- layer0_attn_scores_1 -->
<g id="node14" class="node">
<title>layer0_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="3615.5,-1947 3112.5,-1947 3112.5,-1879 3615.5,-1879 3615.5,-1947"/>
<text text-anchor="middle" x="3364" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 1</text>
<text text-anchor="middle" x="3364" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="3364" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3364" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_1&#45;&gt;layer0_attn_scores_1 -->
<g id="edge8" class="edge">
<title>layer0_attn_qkv_1&#45;&gt;layer0_attn_scores_1</title>
<path fill="none" stroke="black" d="M3364,-1982.95C3364,-1982.95 3364,-1957.13 3364,-1957.13"/>
<polygon fill="black" stroke="black" points="3367.5,-1957.13 3364,-1947.13 3360.5,-1957.13 3367.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_1 -->
<g id="node15" class="node">
<title>layer0_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="3739.5,-1843 2942.5,-1843 2942.5,-1775 3739.5,-1775 3739.5,-1843"/>
<text text-anchor="middle" x="3341" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 1</text>
<text text-anchor="middle" x="3341" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="3341" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="3341" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_1&#45;&gt;layer0_attn_weighted_1 -->
<g id="edge9" class="edge">
<title>layer0_attn_scores_1&#45;&gt;layer0_attn_weighted_1</title>
<path fill="none" stroke="black" d="M3364,-1878.95C3364,-1878.95 3364,-1853.13 3364,-1853.13"/>
<polygon fill="black" stroke="black" points="3367.5,-1853.13 3364,-1843.13 3360.5,-1853.13 3367.5,-1853.13"/>
</g>
<!-- layer0_attn_out_1 -->
<g id="node16" class="node">
<title>layer0_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="3691,-1739 3091,-1739 3091,-1671 3691,-1671 3691,-1739"/>
<text text-anchor="middle" x="3391" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 1</text>
<text text-anchor="middle" x="3391" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="3391" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3391" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_1&#45;&gt;layer0_attn_out_1 -->
<g id="edge10" class="edge">
<title>layer0_attn_weighted_1&#45;&gt;layer0_attn_out_1</title>
<path fill="none" stroke="black" d="M3391,-1774.95C3391,-1774.95 3391,-1749.13 3391,-1749.13"/>
<polygon fill="black" stroke="black" points="3394.5,-1749.13 3391,-1739.13 3387.5,-1749.13 3394.5,-1749.13"/>
</g>
<!-- layer0_attn_out_1&#45;&gt;layer0_attn_aggregate -->
<g id="edge11" class="edge">
<title>layer0_attn_out_1&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M3600.13,-1670.89C3600.13,-1670.89 3600.13,-1577.05 3600.13,-1577.05"/>
<polygon fill="black" stroke="black" points="3603.63,-1577.05 3600.13,-1567.05 3596.63,-1577.05 3603.63,-1577.05"/>
</g>
<!-- layer0_attn_scores_2 -->
<g id="node18" class="node">
<title>layer0_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="4435,-1947 3923,-1947 3923,-1879 4435,-1879 4435,-1947"/>
<text text-anchor="middle" x="4179" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 2</text>
<text text-anchor="middle" x="4179" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4179" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4179" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_2&#45;&gt;layer0_attn_scores_2 -->
<g id="edge13" class="edge">
<title>layer0_attn_qkv_2&#45;&gt;layer0_attn_scores_2</title>
<path fill="none" stroke="black" d="M4179,-1982.95C4179,-1982.95 4179,-1957.13 4179,-1957.13"/>
<polygon fill="black" stroke="black" points="4182.5,-1957.13 4179,-1947.13 4175.5,-1957.13 4182.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_2 -->
<g id="node19" class="node">
<title>layer0_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="4582,-1843 3776,-1843 3776,-1775 4582,-1775 4582,-1843"/>
<text text-anchor="middle" x="4179" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 2</text>
<text text-anchor="middle" x="4179" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4179" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="4179" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_2&#45;&gt;layer0_attn_weighted_2 -->
<g id="edge14" class="edge">
<title>layer0_attn_scores_2&#45;&gt;layer0_attn_weighted_2</title>
<path fill="none" stroke="black" d="M4179,-1878.95C4179,-1878.95 4179,-1853.13 4179,-1853.13"/>
<polygon fill="black" stroke="black" points="4182.5,-1853.13 4179,-1843.13 4175.5,-1853.13 4182.5,-1853.13"/>
</g>
<!-- layer0_attn_out_2 -->
<g id="node20" class="node">
<title>layer0_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="4483.5,-1739 3874.5,-1739 3874.5,-1671 4483.5,-1671 4483.5,-1739"/>
<text text-anchor="middle" x="4179" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 2</text>
<text text-anchor="middle" x="4179" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4179" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4179" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_2&#45;&gt;layer0_attn_out_2 -->
<g id="edge15" class="edge">
<title>layer0_attn_weighted_2&#45;&gt;layer0_attn_out_2</title>
<path fill="none" stroke="black" d="M4179,-1774.95C4179,-1774.95 4179,-1749.13 4179,-1749.13"/>
<polygon fill="black" stroke="black" points="4182.5,-1749.13 4179,-1739.13 4175.5,-1749.13 4182.5,-1749.13"/>
</g>
<!-- layer0_attn_out_2&#45;&gt;layer0_attn_aggregate -->
<g id="edge16" class="edge">
<title>layer0_attn_out_2&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M4179,-1670.89C4179,-1670.89 4179,-1645.23 4179,-1645.23"/>
<polygon fill="black" stroke="black" points="4182.5,-1645.23 4179,-1635.23 4175.5,-1645.23 4182.5,-1645.23"/>
</g>
<!-- layer0_attn_scores_3 -->
<g id="node22" class="node">
<title>layer0_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="5254,-1947 4742,-1947 4742,-1879 5254,-1879 5254,-1947"/>
<text text-anchor="middle" x="4998" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 3</text>
<text text-anchor="middle" x="4998" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4998" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4998" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_3&#45;&gt;layer0_attn_scores_3 -->
<g id="edge18" class="edge">
<title>layer0_attn_qkv_3&#45;&gt;layer0_attn_scores_3</title>
<path fill="none" stroke="black" d="M4998,-1982.95C4998,-1982.95 4998,-1957.13 4998,-1957.13"/>
<polygon fill="black" stroke="black" points="5001.5,-1957.13 4998,-1947.13 4994.5,-1957.13 5001.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_3 -->
<g id="node23" class="node">
<title>layer0_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="5424,-1843 4618,-1843 4618,-1775 5424,-1775 5424,-1843"/>
<text text-anchor="middle" x="5021" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 3</text>
<text text-anchor="middle" x="5021" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="5021" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="5021" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_3&#45;&gt;layer0_attn_weighted_3 -->
<g id="edge19" class="edge">
<title>layer0_attn_scores_3&#45;&gt;layer0_attn_weighted_3</title>
<path fill="none" stroke="black" d="M4998,-1878.95C4998,-1878.95 4998,-1853.13 4998,-1853.13"/>
<polygon fill="black" stroke="black" points="5001.5,-1853.13 4998,-1843.13 4994.5,-1853.13 5001.5,-1853.13"/>
</g>
<!-- layer0_attn_out_3 -->
<g id="node24" class="node">
<title>layer0_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="5275.5,-1739 4666.5,-1739 4666.5,-1671 5275.5,-1671 5275.5,-1739"/>
<text text-anchor="middle" x="4971" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 3</text>
<text text-anchor="middle" x="4971" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4971" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4971" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_3&#45;&gt;layer0_attn_out_3 -->
<g id="edge20" class="edge">
<title>layer0_attn_weighted_3&#45;&gt;layer0_attn_out_3</title>
<path fill="none" stroke="black" d="M4971,-1774.95C4971,-1774.95 4971,-1749.13 4971,-1749.13"/>
<polygon fill="black" stroke="black" points="4974.5,-1749.13 4971,-1739.13 4967.5,-1749.13 4974.5,-1749.13"/>
</g>
<!-- layer0_attn_out_3&#45;&gt;layer0_attn_aggregate -->
<g id="edge21" class="edge">
<title>layer0_attn_out_3&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M4757.62,-1670.89C4757.62,-1670.89 4757.62,-1645.23 4757.62,-1645.23"/>
<polygon fill="black" stroke="black" points="4761.12,-1645.23 4757.62,-1635.23 4754.12,-1645.23 4761.12,-1645.23"/>
</g>
<!-- layer0_attn_scores_4 -->
<g id="node26" class="node">
<title>layer0_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="6096,-1947 5584,-1947 5584,-1879 6096,-1879 6096,-1947"/>
<text text-anchor="middle" x="5840" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 4</text>
<text text-anchor="middle" x="5840" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="5840" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5840" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_4&#45;&gt;layer0_attn_scores_4 -->
<g id="edge23" class="edge">
<title>layer0_attn_qkv_4&#45;&gt;layer0_attn_scores_4</title>
<path fill="none" stroke="black" d="M5840,-1982.95C5840,-1982.95 5840,-1957.13 5840,-1957.13"/>
<polygon fill="black" stroke="black" points="5843.5,-1957.13 5840,-1947.13 5836.5,-1957.13 5843.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_4 -->
<g id="node27" class="node">
<title>layer0_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="6266,-1843 5460,-1843 5460,-1775 6266,-1775 6266,-1843"/>
<text text-anchor="middle" x="5863" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 4</text>
<text text-anchor="middle" x="5863" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="5863" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="5863" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_4&#45;&gt;layer0_attn_weighted_4 -->
<g id="edge24" class="edge">
<title>layer0_attn_scores_4&#45;&gt;layer0_attn_weighted_4</title>
<path fill="none" stroke="black" d="M5840,-1878.95C5840,-1878.95 5840,-1853.13 5840,-1853.13"/>
<polygon fill="black" stroke="black" points="5843.5,-1853.13 5840,-1843.13 5836.5,-1853.13 5843.5,-1853.13"/>
</g>
<!-- layer0_attn_out_4 -->
<g id="node28" class="node">
<title>layer0_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="6117.5,-1739 5508.5,-1739 5508.5,-1671 6117.5,-1671 6117.5,-1739"/>
<text text-anchor="middle" x="5813" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 4</text>
<text text-anchor="middle" x="5813" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="5813" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5813" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_4&#45;&gt;layer0_attn_out_4 -->
<g id="edge25" class="edge">
<title>layer0_attn_weighted_4&#45;&gt;layer0_attn_out_4</title>
<path fill="none" stroke="black" d="M5813,-1774.95C5813,-1774.95 5813,-1749.13 5813,-1749.13"/>
<polygon fill="black" stroke="black" points="5816.5,-1749.13 5813,-1739.13 5809.5,-1749.13 5816.5,-1749.13"/>
</g>
<!-- layer0_attn_out_4&#45;&gt;layer0_attn_aggregate -->
<g id="edge26" class="edge">
<title>layer0_attn_out_4&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M5548.75,-1670.89C5548.75,-1630.02 5548.75,-1567 5548.75,-1567 5548.75,-1567 4722.01,-1567 4722.01,-1567"/>
<polygon fill="black" stroke="black" points="4722.01,-1563.5 4712.01,-1567 4722.01,-1570.5 4722.01,-1563.5"/>
</g>
<!-- layer0_attn_aggregate&#45;&gt;recv_from_pool -->
<g id="edge27" class="edge">
<title>layer0_attn_aggregate&#45;&gt;recv_from_pool</title>
<path fill="none" stroke="black" d="M4179,-1498.53C4179,-1498.53 4179,-1473.24 4179,-1473.24"/>
<polygon fill="black" stroke="black" points="4182.5,-1473.24 4179,-1463.24 4175.5,-1473.24 4182.5,-1473.24"/>
</g>
<!-- layer1_attn_qkv_0 -->
<g id="node31" class="node">
<title>layer1_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="4008.5,-792 3421.5,-792 3421.5,-724 4008.5,-724 4008.5,-792"/>
<text text-anchor="middle" x="3715" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 0</text>
<text text-anchor="middle" x="3715" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3715" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="3715" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_0 -->
<g id="edge31" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_0</title>
<path fill="none" stroke="black" d="M2875.6,-878C3144.31,-878 3465.38,-878 3465.38,-878 3465.38,-878 3465.38,-802.07 3465.38,-802.07"/>
<polygon fill="black" stroke="black" points="3468.88,-802.07 3465.38,-792.07 3461.88,-802.07 3468.88,-802.07"/>
</g>
<!-- layer1_attn_qkv_1 -->
<g id="node35" class="node">
<title>layer1_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="791,-792 177,-792 177,-724 791,-724 791,-792"/>
<text text-anchor="middle" x="484" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 1</text>
<text text-anchor="middle" x="484" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="484" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="484" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_1 -->
<g id="edge36" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_1</title>
<path fill="none" stroke="black" d="M2107.85,-951C1514.57,-951 484,-951 484,-951 484,-951 484,-802.06 484,-802.06"/>
<polygon fill="black" stroke="black" points="487.5,-802.06 484,-792.06 480.5,-802.06 487.5,-802.06"/>
</g>
<!-- layer1_attn_qkv_2 -->
<g id="node39" class="node">
<title>layer1_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="1633.5,-792 1010.5,-792 1010.5,-724 1633.5,-724 1633.5,-792"/>
<text text-anchor="middle" x="1322" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 2</text>
<text text-anchor="middle" x="1322" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="1322" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="1322" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_2 -->
<g id="edge41" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_2</title>
<path fill="none" stroke="black" d="M2032.08,-906C1701.1,-906 1322,-906 1322,-906 1322,-906 1322,-802.33 1322,-802.33"/>
<polygon fill="black" stroke="black" points="1325.5,-802.33 1322,-792.33 1318.5,-802.33 1325.5,-802.33"/>
</g>
<!-- layer1_attn_qkv_3 -->
<g id="node43" class="node">
<title>layer1_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="2474.5,-792 1851.5,-792 1851.5,-724 2474.5,-724 2474.5,-792"/>
<text text-anchor="middle" x="2163" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 3</text>
<text text-anchor="middle" x="2163" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2163" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="2163" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_3 -->
<g id="edge46" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_3</title>
<path fill="none" stroke="black" d="M2215.33,-860.92C2215.33,-860.92 2215.33,-802.04 2215.33,-802.04"/>
<polygon fill="black" stroke="black" points="2218.83,-802.04 2215.33,-792.04 2211.83,-802.04 2218.83,-802.04"/>
</g>
<!-- layer1_attn_qkv_4 -->
<g id="node47" class="node">
<title>layer1_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="3202.5,-792 2579.5,-792 2579.5,-724 3202.5,-724 3202.5,-792"/>
<text text-anchor="middle" x="2891" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 4</text>
<text text-anchor="middle" x="2891" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2891" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="2891" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_4 -->
<g id="edge51" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_4</title>
<path fill="none" stroke="black" d="M2827.67,-860.92C2827.67,-860.92 2827.67,-802.04 2827.67,-802.04"/>
<polygon fill="black" stroke="black" points="2831.17,-802.04 2827.67,-792.04 2824.17,-802.04 2831.17,-802.04"/>
</g>
<!-- layer1_attn_scores_0 -->
<g id="node32" class="node">
<title>layer1_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="3976,-688 3500,-688 3500,-620 3976,-620 3976,-688"/>
<text text-anchor="middle" x="3738" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 0</text>
<text text-anchor="middle" x="3738" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3738" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3738" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_0&#45;&gt;layer1_attn_scores_0 -->
<g id="edge32" class="edge">
<title>layer1_attn_qkv_0&#45;&gt;layer1_attn_scores_0</title>
<path fill="none" stroke="black" d="M3738,-723.95C3738,-723.95 3738,-698.13 3738,-698.13"/>
<polygon fill="black" stroke="black" points="3741.5,-698.13 3738,-688.13 3734.5,-698.13 3741.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_0 -->
<g id="node33" class="node">
<title>layer1_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="4146,-584 3376,-584 3376,-516 4146,-516 4146,-584"/>
<text text-anchor="middle" x="3761" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 0</text>
<text text-anchor="middle" x="3761" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3761" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="3761" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_0&#45;&gt;layer1_attn_weighted_0 -->
<g id="edge33" class="edge">
<title>layer1_attn_scores_0&#45;&gt;layer1_attn_weighted_0</title>
<path fill="none" stroke="black" d="M3738,-619.95C3738,-619.95 3738,-594.13 3738,-594.13"/>
<polygon fill="black" stroke="black" points="3741.5,-594.13 3738,-584.13 3734.5,-594.13 3741.5,-594.13"/>
</g>
<!-- layer1_attn_out_0 -->
<g id="node34" class="node">
<title>layer1_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="3998.5,-446 3425.5,-446 3425.5,-378 3998.5,-378 3998.5,-446"/>
<text text-anchor="middle" x="3712" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 0</text>
<text text-anchor="middle" x="3712" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3712" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3712" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_0&#45;&gt;layer1_attn_out_0 -->
<g id="edge34" class="edge">
<title>layer1_attn_weighted_0&#45;&gt;layer1_attn_out_0</title>
<path fill="none" stroke="black" d="M3712,-515.89C3712,-515.89 3712,-456.2 3712,-456.2"/>
<polygon fill="black" stroke="black" points="3715.5,-456.2 3712,-446.2 3708.5,-456.2 3715.5,-456.2"/>
</g>
<!-- layer1_attn_aggregate -->
<g id="node51" class="node">
<title>layer1_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="3160.99,-308 2095.19,-308 1821.01,-172 2886.81,-172 3160.99,-308"/>
<text text-anchor="middle" x="2491" y="-258.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Aggregation</text>
<text text-anchor="middle" x="2491" y="-243.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="2491" y="-228.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="2491" y="-213.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_out_0&#45;&gt;layer1_attn_aggregate -->
<g id="edge35" class="edge">
<title>layer1_attn_out_0&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M3712,-377.61C3712,-327.41 3712,-240 3712,-240 3712,-240 3034.33,-240 3034.33,-240"/>
<polygon fill="black" stroke="black" points="3034.33,-236.5 3024.33,-240 3034.33,-243.5 3034.33,-236.5"/>
</g>
<!-- layer1_attn_scores_1 -->
<g id="node36" class="node">
<title>layer1_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="689.5,-688 186.5,-688 186.5,-620 689.5,-620 689.5,-688"/>
<text text-anchor="middle" x="438" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 1</text>
<text text-anchor="middle" x="438" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="438" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
<text text-anchor="middle" x="438" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_1&#45;&gt;layer1_attn_scores_1 -->
<g id="edge37" class="edge">
<title>layer1_attn_qkv_1&#45;&gt;layer1_attn_scores_1</title>
<path fill="none" stroke="black" d="M438,-723.95C438,-723.95 438,-698.13 438,-698.13"/>
<polygon fill="black" stroke="black" points="441.5,-698.13 438,-688.13 434.5,-698.13 441.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_1 -->
<g id="node37" class="node">
<title>layer1_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="813.5,-584 16.5,-584 16.5,-516 813.5,-516 813.5,-584"/>
<text text-anchor="middle" x="415" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 1</text>
<text text-anchor="middle" x="415" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="415" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="415" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_1&#45;&gt;layer1_attn_weighted_1 -->
<g id="edge38" class="edge">
<title>layer1_attn_scores_1&#45;&gt;layer1_attn_weighted_1</title>
<path fill="none" stroke="black" d="M438,-619.95C438,-619.95 438,-594.13 438,-594.13"/>
<polygon fill="black" stroke="black" points="441.5,-594.13 438,-584.13 434.5,-594.13 441.5,-594.13"/>
</g>
<!-- layer1_attn_out_1 -->
<g id="node38" class="node">
<title>layer1_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="764,-446 164,-446 164,-378 764,-378 764,-446"/>
<text text-anchor="middle" x="464" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 1</text>
<text text-anchor="middle" x="464" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="464" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
<text text-anchor="middle" x="464" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_1&#45;&gt;layer1_attn_out_1 -->
<g id="edge39" class="edge">
<title>layer1_attn_weighted_1&#45;&gt;layer1_attn_out_1</title>
<path fill="none" stroke="black" d="M464,-515.89C464,-515.89 464,-456.2 464,-456.2"/>
<polygon fill="black" stroke="black" points="467.5,-456.2 464,-446.2 460.5,-456.2 467.5,-456.2"/>
</g>
<!-- layer1_attn_out_1&#45;&gt;layer1_attn_aggregate -->
<g id="edge40" class="edge">
<title>layer1_attn_out_1&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M464,-377.61C464,-327.41 464,-240 464,-240 464,-240 1948.1,-240 1948.1,-240"/>
<polygon fill="black" stroke="black" points="1948.1,-243.5 1958.1,-240 1948.1,-236.5 1948.1,-243.5"/>
</g>
<!-- layer1_attn_scores_2 -->
<g id="node40" class="node">
<title>layer1_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="1532,-688 1020,-688 1020,-620 1532,-620 1532,-688"/>
<text text-anchor="middle" x="1276" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 2</text>
<text text-anchor="middle" x="1276" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="1276" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1276" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_2&#45;&gt;layer1_attn_scores_2 -->
<g id="edge42" class="edge">
<title>layer1_attn_qkv_2&#45;&gt;layer1_attn_scores_2</title>
<path fill="none" stroke="black" d="M1276,-723.95C1276,-723.95 1276,-698.13 1276,-698.13"/>
<polygon fill="black" stroke="black" points="1279.5,-698.13 1276,-688.13 1272.5,-698.13 1279.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_2 -->
<g id="node41" class="node">
<title>layer1_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="1656,-584 850,-584 850,-516 1656,-516 1656,-584"/>
<text text-anchor="middle" x="1253" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 2</text>
<text text-anchor="middle" x="1253" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="1253" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="1253" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_2&#45;&gt;layer1_attn_weighted_2 -->
<g id="edge43" class="edge">
<title>layer1_attn_scores_2&#45;&gt;layer1_attn_weighted_2</title>
<path fill="none" stroke="black" d="M1276,-619.95C1276,-619.95 1276,-594.13 1276,-594.13"/>
<polygon fill="black" stroke="black" points="1279.5,-594.13 1276,-584.13 1272.5,-594.13 1279.5,-594.13"/>
</g>
<!-- layer1_attn_out_2 -->
<g id="node42" class="node">
<title>layer1_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="1607.5,-446 998.5,-446 998.5,-378 1607.5,-378 1607.5,-446"/>
<text text-anchor="middle" x="1303" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 2</text>
<text text-anchor="middle" x="1303" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="1303" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1303" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_2&#45;&gt;layer1_attn_out_2 -->
<g id="edge44" class="edge">
<title>layer1_attn_weighted_2&#45;&gt;layer1_attn_out_2</title>
<path fill="none" stroke="black" d="M1303,-515.89C1303,-515.89 1303,-456.2 1303,-456.2"/>
<polygon fill="black" stroke="black" points="1306.5,-456.2 1303,-446.2 1299.5,-456.2 1306.5,-456.2"/>
</g>
<!-- layer1_attn_out_2&#45;&gt;layer1_attn_aggregate -->
<g id="edge45" class="edge">
<title>layer1_attn_out_2&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M1607.87,-412C1724.65,-412 1830.38,-412 1830.38,-412 1830.38,-412 1830.38,-250.12 1830.38,-250.12"/>
<polygon fill="black" stroke="black" points="1833.88,-250.12 1830.38,-240.12 1826.88,-250.12 1833.88,-250.12"/>
</g>
<!-- layer1_attn_scores_3 -->
<g id="node44" class="node">
<title>layer1_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="2374,-688 1862,-688 1862,-620 2374,-620 2374,-688"/>
<text text-anchor="middle" x="2118" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 3</text>
<text text-anchor="middle" x="2118" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2118" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2118" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_3&#45;&gt;layer1_attn_scores_3 -->
<g id="edge47" class="edge">
<title>layer1_attn_qkv_3&#45;&gt;layer1_attn_scores_3</title>
<path fill="none" stroke="black" d="M2118,-723.95C2118,-723.95 2118,-698.13 2118,-698.13"/>
<polygon fill="black" stroke="black" points="2121.5,-698.13 2118,-688.13 2114.5,-698.13 2121.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_3 -->
<g id="node45" class="node">
<title>layer1_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="2498,-584 1692,-584 1692,-516 2498,-516 2498,-584"/>
<text text-anchor="middle" x="2095" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 3</text>
<text text-anchor="middle" x="2095" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2095" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="2095" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_3&#45;&gt;layer1_attn_weighted_3 -->
<g id="edge48" class="edge">
<title>layer1_attn_scores_3&#45;&gt;layer1_attn_weighted_3</title>
<path fill="none" stroke="black" d="M2118,-619.95C2118,-619.95 2118,-594.13 2118,-594.13"/>
<polygon fill="black" stroke="black" points="2121.5,-594.13 2118,-584.13 2114.5,-594.13 2121.5,-594.13"/>
</g>
<!-- layer1_attn_out_3 -->
<g id="node46" class="node">
<title>layer1_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="2448.5,-446 1839.5,-446 1839.5,-378 2448.5,-378 2448.5,-446"/>
<text text-anchor="middle" x="2144" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 3</text>
<text text-anchor="middle" x="2144" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2144" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2144" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_3&#45;&gt;layer1_attn_out_3 -->
<g id="edge49" class="edge">
<title>layer1_attn_weighted_3&#45;&gt;layer1_attn_out_3</title>
<path fill="none" stroke="black" d="M2144,-515.89C2144,-515.89 2144,-456.2 2144,-456.2"/>
<polygon fill="black" stroke="black" points="2147.5,-456.2 2144,-446.2 2140.5,-456.2 2147.5,-456.2"/>
</g>
<!-- layer1_attn_out_3&#45;&gt;layer1_attn_aggregate -->
<g id="edge50" class="edge">
<title>layer1_attn_out_3&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M2144,-377.61C2144,-377.61 2144,-318.12 2144,-318.12"/>
<polygon fill="black" stroke="black" points="2147.5,-318.12 2144,-308.12 2140.5,-318.12 2147.5,-318.12"/>
</g>
<!-- layer1_attn_scores_4 -->
<g id="node48" class="node">
<title>layer1_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="3170,-688 2658,-688 2658,-620 3170,-620 3170,-688"/>
<text text-anchor="middle" x="2914" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 4</text>
<text text-anchor="middle" x="2914" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2914" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2914" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_4&#45;&gt;layer1_attn_scores_4 -->
<g id="edge52" class="edge">
<title>layer1_attn_qkv_4&#45;&gt;layer1_attn_scores_4</title>
<path fill="none" stroke="black" d="M2914,-723.95C2914,-723.95 2914,-698.13 2914,-698.13"/>
<polygon fill="black" stroke="black" points="2917.5,-698.13 2914,-688.13 2910.5,-698.13 2917.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_4 -->
<g id="node49" class="node">
<title>layer1_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="3340,-584 2534,-584 2534,-516 3340,-516 3340,-584"/>
<text text-anchor="middle" x="2937" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 4</text>
<text text-anchor="middle" x="2937" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2937" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="2937" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_4&#45;&gt;layer1_attn_weighted_4 -->
<g id="edge53" class="edge">
<title>layer1_attn_scores_4&#45;&gt;layer1_attn_weighted_4</title>
<path fill="none" stroke="black" d="M2914,-619.95C2914,-619.95 2914,-594.13 2914,-594.13"/>
<polygon fill="black" stroke="black" points="2917.5,-594.13 2914,-584.13 2910.5,-594.13 2917.5,-594.13"/>
</g>
<!-- layer1_attn_out_4 -->
<g id="node50" class="node">
<title>layer1_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="3191.5,-446 2582.5,-446 2582.5,-378 3191.5,-378 3191.5,-446"/>
<text text-anchor="middle" x="2887" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 4</text>
<text text-anchor="middle" x="2887" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2887" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2887" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_4&#45;&gt;layer1_attn_out_4 -->
<g id="edge54" class="edge">
<title>layer1_attn_weighted_4&#45;&gt;layer1_attn_out_4</title>
<path fill="none" stroke="black" d="M2887,-515.89C2887,-515.89 2887,-456.2 2887,-456.2"/>
<polygon fill="black" stroke="black" points="2890.5,-456.2 2887,-446.2 2883.5,-456.2 2890.5,-456.2"/>
</g>
<!-- layer1_attn_out_4&#45;&gt;layer1_attn_aggregate -->
<g id="edge55" class="edge">
<title>layer1_attn_out_4&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M2871.62,-377.61C2871.62,-377.61 2871.62,-318.12 2871.62,-318.12"/>
<polygon fill="black" stroke="black" points="2875.12,-318.12 2871.62,-308.12 2868.12,-318.12 2875.12,-318.12"/>
</g>
<!-- recv_from_pool_1 -->
<g id="node52" class="node">
<title>recv_from_pool_1</title>
<polygon fill="yellow" stroke="black" points="7941.69,-136 7051.35,-136 6822.31,0 7712.65,0 7941.69,-136"/>
<text text-anchor="middle" x="7382" y="-86.8" font-family="Times,serif" font-size="14.00">Receive Layer 1 from Pool</text>
<text text-anchor="middle" x="7382" y="-71.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;12] → [0&#45;7]</text>
<text text-anchor="middle" x="7382" y="-56.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7382" y="-41.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_aggregate&#45;&gt;recv_from_pool_1 -->
<g id="edge56" class="edge">
<title>layer1_attn_aggregate&#45;&gt;recv_from_pool_1</title>
<path fill="none" stroke="black" d="M2955.54,-206C3179.71,-206 3400.75,-206 3400.75,-206 3400.75,-206 3400.75,-45 3400.75,-45 3400.75,-45 6887.8,-45 6887.8,-45"/>
<polygon fill="black" stroke="black" points="6887.8,-48.5 6897.8,-45 6887.8,-41.5 6887.8,-48.5"/>
</g>
<!-- recv_from_pool_1&#45;&gt;layer2_ffn_start -->
<g id="edge57" class="edge">
<title>recv_from_pool_1&#45;&gt;layer2_ffn_start</title>
<path fill="none" stroke="black" d="M6973.72,-90C6513.9,-90 5830,-90 5830,-90 5830,-90 5830,-985 5830,-985 5830,-985 5296,-985 5296,-985 5296,-985 5296,-1194.74 5296,-1194.74"/>
<polygon fill="black" stroke="black" points="5292.5,-1194.74 5296,-1204.74 5299.5,-1194.74 5292.5,-1194.74"/>
</g>
<!-- layer2_attn_qkv_0 -->
<g id="node54" class="node">
<title>layer2_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="7443.5,-963 6856.5,-963 6856.5,-895 7443.5,-895 7443.5,-963"/>
<text text-anchor="middle" x="7150" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 0</text>
<text text-anchor="middle" x="7150" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7150" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7150" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_0 -->
<g id="edge59" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_0</title>
<path fill="none" stroke="black" d="M7164.33,-1032.53C7164.33,-1032.53 7164.33,-973.24 7164.33,-973.24"/>
<polygon fill="black" stroke="black" points="7167.83,-973.24 7164.33,-963.24 7160.83,-973.24 7167.83,-973.24"/>
</g>
<!-- layer2_attn_qkv_1 -->
<g id="node58" class="node">
<title>layer2_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="8162,-963 7548,-963 7548,-895 8162,-895 8162,-963"/>
<text text-anchor="middle" x="7855" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 1</text>
<text text-anchor="middle" x="7855" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7855" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7855" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_1 -->
<g id="edge64" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_1</title>
<path fill="none" stroke="black" d="M7776.42,-1033.02C7776.42,-1033.02 7776.42,-973.45 7776.42,-973.45"/>
<polygon fill="black" stroke="black" points="7779.92,-973.45 7776.42,-963.45 7772.92,-973.45 7779.92,-973.45"/>
</g>
<!-- layer2_attn_qkv_2 -->
<g id="node62" class="node">
<title>layer2_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="4953.5,-963 4330.5,-963 4330.5,-895 4953.5,-895 4953.5,-963"/>
<text text-anchor="middle" x="4642" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 2</text>
<text text-anchor="middle" x="4642" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4642" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4642" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_2 -->
<g id="edge69" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_2</title>
<path fill="none" stroke="black" d="M6908.51,-1047C6114.49,-1047 4719.25,-1047 4719.25,-1047 4719.25,-1047 4719.25,-973.13 4719.25,-973.13"/>
<polygon fill="black" stroke="black" points="4722.75,-973.13 4719.25,-963.13 4715.75,-973.13 4722.75,-973.13"/>
</g>
<!-- layer2_attn_qkv_3 -->
<g id="node66" class="node">
<title>layer2_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="5772.5,-963 5149.5,-963 5149.5,-895 5772.5,-895 5772.5,-963"/>
<text text-anchor="middle" x="5461" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 3</text>
<text text-anchor="middle" x="5461" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="5461" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="5461" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_3 -->
<g id="edge74" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_3</title>
<path fill="none" stroke="black" d="M6900.26,-1042C6387.82,-1042 5698.75,-1042 5698.75,-1042 5698.75,-1042 5698.75,-973.21 5698.75,-973.21"/>
<polygon fill="black" stroke="black" points="5702.25,-973.21 5698.75,-963.21 5695.25,-973.21 5702.25,-973.21"/>
</g>
<!-- layer2_attn_qkv_4 -->
<g id="node70" class="node">
<title>layer2_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="6614.5,-963 5991.5,-963 5991.5,-895 6614.5,-895 6614.5,-963"/>
<text text-anchor="middle" x="6303" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 4</text>
<text text-anchor="middle" x="6303" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6303" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6303" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_4 -->
<g id="edge79" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_4</title>
<path fill="none" stroke="black" d="M6891.74,-1037C6640.07,-1037 6397.52,-1037 6397.52,-1037 6397.52,-1037 6397.52,-973.17 6397.52,-973.17"/>
<polygon fill="black" stroke="black" points="6401.02,-973.17 6397.52,-963.17 6394.02,-973.17 6401.02,-973.17"/>
</g>
<!-- layer2_attn_scores_0 -->
<g id="node55" class="node">
<title>layer2_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="7342,-792 6866,-792 6866,-724 7342,-724 7342,-792"/>
<text text-anchor="middle" x="7104" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 0</text>
<text text-anchor="middle" x="7104" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7104" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7104" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_0&#45;&gt;layer2_attn_scores_0 -->
<g id="edge60" class="edge">
<title>layer2_attn_qkv_0&#45;&gt;layer2_attn_scores_0</title>
<path fill="none" stroke="black" d="M7104,-894.81C7104,-894.81 7104,-802.13 7104,-802.13"/>
<polygon fill="black" stroke="black" points="7107.5,-802.13 7104,-792.13 7100.5,-802.13 7107.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_0 -->
<g id="node56" class="node">
<title>layer2_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="7466,-688 6696,-688 6696,-620 7466,-620 7466,-688"/>
<text text-anchor="middle" x="7081" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 0</text>
<text text-anchor="middle" x="7081" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7081" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="7081" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_0&#45;&gt;layer2_attn_weighted_0 -->
<g id="edge61" class="edge">
<title>layer2_attn_scores_0&#45;&gt;layer2_attn_weighted_0</title>
<path fill="none" stroke="black" d="M7104,-723.95C7104,-723.95 7104,-698.13 7104,-698.13"/>
<polygon fill="black" stroke="black" points="7107.5,-698.13 7104,-688.13 7100.5,-698.13 7107.5,-698.13"/>
</g>
<!-- layer2_attn_out_0 -->
<g id="node57" class="node">
<title>layer2_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="7318.5,-584 6745.5,-584 6745.5,-516 7318.5,-516 7318.5,-584"/>
<text text-anchor="middle" x="7032" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 0</text>
<text text-anchor="middle" x="7032" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7032" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7032" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_0&#45;&gt;layer2_attn_out_0 -->
<g id="edge62" class="edge">
<title>layer2_attn_weighted_0&#45;&gt;layer2_attn_out_0</title>
<path fill="none" stroke="black" d="M7032,-619.95C7032,-619.95 7032,-594.13 7032,-594.13"/>
<polygon fill="black" stroke="black" points="7035.5,-594.13 7032,-584.13 7028.5,-594.13 7035.5,-594.13"/>
</g>
<!-- layer2_attn_aggregate -->
<g id="node74" class="node">
<title>layer2_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="7362.99,-480 6297.19,-480 6023.01,-344 7088.81,-344 7362.99,-480"/>
<text text-anchor="middle" x="6693" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Aggregation</text>
<text text-anchor="middle" x="6693" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="6693" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="6693" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_out_0&#45;&gt;layer2_attn_aggregate -->
<g id="edge63" class="edge">
<title>layer2_attn_out_0&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M7032,-515.89C7032,-515.89 7032,-490.23 7032,-490.23"/>
<polygon fill="black" stroke="black" points="7035.5,-490.23 7032,-480.23 7028.5,-490.23 7035.5,-490.23"/>
</g>
<!-- layer2_attn_scores_1 -->
<g id="node59" class="node">
<title>layer2_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="8129.5,-792 7626.5,-792 7626.5,-724 8129.5,-724 8129.5,-792"/>
<text text-anchor="middle" x="7878" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 1</text>
<text text-anchor="middle" x="7878" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7878" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7878" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_1&#45;&gt;layer2_attn_scores_1 -->
<g id="edge65" class="edge">
<title>layer2_attn_qkv_1&#45;&gt;layer2_attn_scores_1</title>
<path fill="none" stroke="black" d="M7878,-894.81C7878,-894.81 7878,-802.13 7878,-802.13"/>
<polygon fill="black" stroke="black" points="7881.5,-802.13 7878,-792.13 7874.5,-802.13 7881.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_1 -->
<g id="node60" class="node">
<title>layer2_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="8299.5,-688 7502.5,-688 7502.5,-620 8299.5,-620 8299.5,-688"/>
<text text-anchor="middle" x="7901" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 1</text>
<text text-anchor="middle" x="7901" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7901" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="7901" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_1&#45;&gt;layer2_attn_weighted_1 -->
<g id="edge66" class="edge">
<title>layer2_attn_scores_1&#45;&gt;layer2_attn_weighted_1</title>
<path fill="none" stroke="black" d="M7878,-723.95C7878,-723.95 7878,-698.13 7878,-698.13"/>
<polygon fill="black" stroke="black" points="7881.5,-698.13 7878,-688.13 7874.5,-698.13 7881.5,-698.13"/>
</g>
<!-- layer2_attn_out_1 -->
<g id="node61" class="node">
<title>layer2_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="8151,-584 7551,-584 7551,-516 8151,-516 8151,-584"/>
<text text-anchor="middle" x="7851" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 1</text>
<text text-anchor="middle" x="7851" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7851" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7851" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_1&#45;&gt;layer2_attn_out_1 -->
<g id="edge67" class="edge">
<title>layer2_attn_weighted_1&#45;&gt;layer2_attn_out_1</title>
<path fill="none" stroke="black" d="M7851,-619.95C7851,-619.95 7851,-594.13 7851,-594.13"/>
<polygon fill="black" stroke="black" points="7854.5,-594.13 7851,-584.13 7847.5,-594.13 7854.5,-594.13"/>
</g>
<!-- layer2_attn_out_1&#45;&gt;layer2_attn_aggregate -->
<g id="edge68" class="edge">
<title>layer2_attn_out_1&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M7550.79,-550C7439.84,-550 7340.62,-550 7340.62,-550 7340.62,-550 7340.62,-422.1 7340.62,-422.1"/>
<polygon fill="black" stroke="black" points="7344.12,-422.1 7340.62,-412.1 7337.12,-422.1 7344.12,-422.1"/>
</g>
<!-- layer2_attn_scores_2 -->
<g id="node63" class="node">
<title>layer2_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="4852,-792 4340,-792 4340,-724 4852,-724 4852,-792"/>
<text text-anchor="middle" x="4596" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 2</text>
<text text-anchor="middle" x="4596" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4596" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4596" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_2&#45;&gt;layer2_attn_scores_2 -->
<g id="edge70" class="edge">
<title>layer2_attn_qkv_2&#45;&gt;layer2_attn_scores_2</title>
<path fill="none" stroke="black" d="M4596,-894.81C4596,-894.81 4596,-802.13 4596,-802.13"/>
<polygon fill="black" stroke="black" points="4599.5,-802.13 4596,-792.13 4592.5,-802.13 4599.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_2 -->
<g id="node64" class="node">
<title>layer2_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="4976,-688 4170,-688 4170,-620 4976,-620 4976,-688"/>
<text text-anchor="middle" x="4573" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 2</text>
<text text-anchor="middle" x="4573" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4573" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="4573" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_2&#45;&gt;layer2_attn_weighted_2 -->
<g id="edge71" class="edge">
<title>layer2_attn_scores_2&#45;&gt;layer2_attn_weighted_2</title>
<path fill="none" stroke="black" d="M4596,-723.95C4596,-723.95 4596,-698.13 4596,-698.13"/>
<polygon fill="black" stroke="black" points="4599.5,-698.13 4596,-688.13 4592.5,-698.13 4599.5,-698.13"/>
</g>
<!-- layer2_attn_out_2 -->
<g id="node65" class="node">
<title>layer2_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="4926.5,-584 4317.5,-584 4317.5,-516 4926.5,-516 4926.5,-584"/>
<text text-anchor="middle" x="4622" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 2</text>
<text text-anchor="middle" x="4622" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="4622" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4622" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_2&#45;&gt;layer2_attn_out_2 -->
<g id="edge72" class="edge">
<title>layer2_attn_weighted_2&#45;&gt;layer2_attn_out_2</title>
<path fill="none" stroke="black" d="M4622,-619.95C4622,-619.95 4622,-594.13 4622,-594.13"/>
<polygon fill="black" stroke="black" points="4625.5,-594.13 4622,-584.13 4618.5,-594.13 4625.5,-594.13"/>
</g>
<!-- layer2_attn_out_2&#45;&gt;layer2_attn_aggregate -->
<g id="edge73" class="edge">
<title>layer2_attn_out_2&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M4622,-515.9C4622,-489.36 4622,-457 4622,-457 4622,-457 6240.62,-457 6240.62,-457"/>
<polygon fill="black" stroke="black" points="6240.62,-460.5 6250.62,-457 6240.62,-453.5 6240.62,-460.5"/>
</g>
<!-- layer2_attn_scores_3 -->
<g id="node67" class="node">
<title>layer2_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="5694,-792 5182,-792 5182,-724 5694,-724 5694,-792"/>
<text text-anchor="middle" x="5438" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 3</text>
<text text-anchor="middle" x="5438" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="5438" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5438" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_3&#45;&gt;layer2_attn_scores_3 -->
<g id="edge75" class="edge">
<title>layer2_attn_qkv_3&#45;&gt;layer2_attn_scores_3</title>
<path fill="none" stroke="black" d="M5438,-894.81C5438,-894.81 5438,-802.13 5438,-802.13"/>
<polygon fill="black" stroke="black" points="5441.5,-802.13 5438,-792.13 5434.5,-802.13 5441.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_3 -->
<g id="node68" class="node">
<title>layer2_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="5818,-688 5012,-688 5012,-620 5818,-620 5818,-688"/>
<text text-anchor="middle" x="5415" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 3</text>
<text text-anchor="middle" x="5415" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="5415" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="5415" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_3&#45;&gt;layer2_attn_weighted_3 -->
<g id="edge76" class="edge">
<title>layer2_attn_scores_3&#45;&gt;layer2_attn_weighted_3</title>
<path fill="none" stroke="black" d="M5438,-723.95C5438,-723.95 5438,-698.13 5438,-698.13"/>
<polygon fill="black" stroke="black" points="5441.5,-698.13 5438,-688.13 5434.5,-698.13 5441.5,-698.13"/>
</g>
<!-- layer2_attn_out_3 -->
<g id="node69" class="node">
<title>layer2_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="5768.5,-584 5159.5,-584 5159.5,-516 5768.5,-516 5768.5,-584"/>
<text text-anchor="middle" x="5464" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 3</text>
<text text-anchor="middle" x="5464" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="5464" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5464" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_3&#45;&gt;layer2_attn_out_3 -->
<g id="edge77" class="edge">
<title>layer2_attn_weighted_3&#45;&gt;layer2_attn_out_3</title>
<path fill="none" stroke="black" d="M5464,-619.95C5464,-619.95 5464,-594.13 5464,-594.13"/>
<polygon fill="black" stroke="black" points="5467.5,-594.13 5464,-584.13 5460.5,-594.13 5467.5,-594.13"/>
</g>
<!-- layer2_attn_out_3&#45;&gt;layer2_attn_aggregate -->
<g id="edge78" class="edge">
<title>layer2_attn_out_3&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M5464,-515.7C5464,-493.23 5464,-468 5464,-468 5464,-468 6262.63,-468 6262.63,-468"/>
<polygon fill="black" stroke="black" points="6262.63,-471.5 6272.63,-468 6262.63,-464.5 6262.63,-471.5"/>
</g>
<!-- layer2_attn_scores_4 -->
<g id="node71" class="node">
<title>layer2_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="6536,-792 6024,-792 6024,-724 6536,-724 6536,-792"/>
<text text-anchor="middle" x="6280" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 4</text>
<text text-anchor="middle" x="6280" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6280" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6280" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_4&#45;&gt;layer2_attn_scores_4 -->
<g id="edge80" class="edge">
<title>layer2_attn_qkv_4&#45;&gt;layer2_attn_scores_4</title>
<path fill="none" stroke="black" d="M6280,-894.81C6280,-894.81 6280,-802.13 6280,-802.13"/>
<polygon fill="black" stroke="black" points="6283.5,-802.13 6280,-792.13 6276.5,-802.13 6283.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_4 -->
<g id="node72" class="node">
<title>layer2_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="6660,-688 5854,-688 5854,-620 6660,-620 6660,-688"/>
<text text-anchor="middle" x="6257" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 4</text>
<text text-anchor="middle" x="6257" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6257" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="6257" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_4&#45;&gt;layer2_attn_weighted_4 -->
<g id="edge81" class="edge">
<title>layer2_attn_scores_4&#45;&gt;layer2_attn_weighted_4</title>
<path fill="none" stroke="black" d="M6280,-723.95C6280,-723.95 6280,-698.13 6280,-698.13"/>
<polygon fill="black" stroke="black" points="6283.5,-698.13 6280,-688.13 6276.5,-698.13 6283.5,-698.13"/>
</g>
<!-- layer2_attn_out_4 -->
<g id="node73" class="node">
<title>layer2_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="6610.5,-584 6001.5,-584 6001.5,-516 6610.5,-516 6610.5,-584"/>
<text text-anchor="middle" x="6306" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 4</text>
<text text-anchor="middle" x="6306" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6306" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6306" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_4&#45;&gt;layer2_attn_out_4 -->
<g id="edge82" class="edge">
<title>layer2_attn_weighted_4&#45;&gt;layer2_attn_out_4</title>
<path fill="none" stroke="black" d="M6306,-619.95C6306,-619.95 6306,-594.13 6306,-594.13"/>
<polygon fill="black" stroke="black" points="6309.5,-594.13 6306,-584.13 6302.5,-594.13 6309.5,-594.13"/>
</g>
<!-- layer2_attn_out_4&#45;&gt;layer2_attn_aggregate -->
<g id="edge83" class="edge">
<title>layer2_attn_out_4&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M6316.88,-515.89C6316.88,-515.89 6316.88,-490.23 6316.88,-490.23"/>
<polygon fill="black" stroke="black" points="6320.38,-490.23 6316.88,-480.23 6313.38,-490.23 6320.38,-490.23"/>
</g>
<!-- recv_from_pool_2 -->
<g id="node75" class="node">
<title>recv_from_pool_2</title>
<polygon fill="yellow" stroke="black" points="7505.69,-308 6615.35,-308 6386.31,-172 7276.65,-172 7505.69,-308"/>
<text text-anchor="middle" x="6946" y="-258.8" font-family="Times,serif" font-size="14.00">Receive Layer 2 from Pool</text>
<text text-anchor="middle" x="6946" y="-243.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;12] → [0&#45;7]</text>
<text text-anchor="middle" x="6946" y="-228.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6946" y="-213.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_aggregate&#45;&gt;recv_from_pool_2 -->
<g id="edge84" class="edge">
<title>layer2_attn_aggregate&#45;&gt;recv_from_pool_2</title>
<path fill="none" stroke="black" d="M6874.45,-343.53C6874.45,-343.53 6874.45,-318.24 6874.45,-318.24"/>
<polygon fill="black" stroke="black" points="6877.95,-318.24 6874.45,-308.24 6870.95,-318.24 6877.95,-318.24"/>
</g>
<!-- recv_from_pool_2&#45;&gt;layer3_ffn_start -->
<g id="edge85" class="edge">
<title>recv_from_pool_2&#45;&gt;layer3_ffn_start</title>
<path fill="none" stroke="black" d="M6557.94,-274C6239.89,-274 5842,-274 5842,-274 5842,-274 5842,-1194.94 5842,-1194.94"/>
<polygon fill="black" stroke="black" points="5838.5,-1194.94 5842,-1204.94 5845.5,-1194.94 5838.5,-1194.94"/>
</g>
<!-- layer3_attn_qkv_0 -->
<g id="node77" class="node">
<title>layer3_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="11642.5,-963 11055.5,-963 11055.5,-895 11642.5,-895 11642.5,-963"/>
<text text-anchor="middle" x="11349" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 0</text>
<text text-anchor="middle" x="11349" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="11349" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="11349" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_0 -->
<g id="edge87" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_0</title>
<path fill="none" stroke="black" d="M10556.76,-1078C10904.48,-1078 11349,-1078 11349,-1078 11349,-1078 11349,-973.18 11349,-973.18"/>
<polygon fill="black" stroke="black" points="11352.5,-973.18 11349,-963.18 11345.5,-973.18 11352.5,-973.18"/>
</g>
<!-- layer3_attn_qkv_1 -->
<g id="node81" class="node">
<title>layer3_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="12476,-963 11862,-963 11862,-895 12476,-895 12476,-963"/>
<text text-anchor="middle" x="12169" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 1</text>
<text text-anchor="middle" x="12169" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="12169" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="12169" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_1 -->
<g id="edge92" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_1</title>
<path fill="none" stroke="black" d="M10632.32,-1123C11229.56,-1123 12169,-1123 12169,-1123 12169,-1123 12169,-973.24 12169,-973.24"/>
<polygon fill="black" stroke="black" points="12172.5,-973.24 12169,-963.24 12165.5,-973.24 12172.5,-973.24"/>
</g>
<!-- layer3_attn_qkv_2 -->
<g id="node85" class="node">
<title>layer3_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="9267.5,-963 8644.5,-963 8644.5,-895 9267.5,-895 9267.5,-963"/>
<text text-anchor="middle" x="8956" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 2</text>
<text text-anchor="middle" x="8956" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8956" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="8956" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_2 -->
<g id="edge97" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_2</title>
<path fill="none" stroke="black" d="M9704.55,-1101C9365.24,-1101 8956,-1101 8956,-1101 8956,-1101 8956,-973.39 8956,-973.39"/>
<polygon fill="black" stroke="black" points="8959.5,-973.39 8956,-963.39 8952.5,-973.39 8959.5,-973.39"/>
</g>
<!-- layer3_attn_qkv_3 -->
<g id="node89" class="node">
<title>layer3_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="10109.5,-963 9486.5,-963 9486.5,-895 10109.5,-895 10109.5,-963"/>
<text text-anchor="middle" x="9798" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 3</text>
<text text-anchor="middle" x="9798" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9798" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="9798" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_3 -->
<g id="edge102" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_3</title>
<path fill="none" stroke="black" d="M9849.83,-1032.53C9849.83,-1032.53 9849.83,-973.24 9849.83,-973.24"/>
<polygon fill="black" stroke="black" points="9853.33,-973.24 9849.83,-963.24 9846.33,-973.24 9853.33,-973.24"/>
</g>
<!-- layer3_attn_qkv_4 -->
<g id="node93" class="node">
<title>layer3_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="10813.5,-963 10190.5,-963 10190.5,-895 10813.5,-895 10813.5,-963"/>
<text text-anchor="middle" x="10502" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 4</text>
<text text-anchor="middle" x="10502" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10502" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="10502" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_4 -->
<g id="edge107" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_4</title>
<path fill="none" stroke="black" d="M10450.17,-1032.53C10450.17,-1032.53 10450.17,-973.24 10450.17,-973.24"/>
<polygon fill="black" stroke="black" points="10453.67,-973.24 10450.17,-963.24 10446.67,-973.24 10453.67,-973.24"/>
</g>
<!-- layer3_attn_scores_0 -->
<g id="node78" class="node">
<title>layer3_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="11610,-792 11134,-792 11134,-724 11610,-724 11610,-792"/>
<text text-anchor="middle" x="11372" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 0</text>
<text text-anchor="middle" x="11372" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="11372" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11372" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_0&#45;&gt;layer3_attn_scores_0 -->
<g id="edge88" class="edge">
<title>layer3_attn_qkv_0&#45;&gt;layer3_attn_scores_0</title>
<path fill="none" stroke="black" d="M11372,-894.81C11372,-894.81 11372,-802.13 11372,-802.13"/>
<polygon fill="black" stroke="black" points="11375.5,-802.13 11372,-792.13 11368.5,-802.13 11375.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_0 -->
<g id="node79" class="node">
<title>layer3_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="11780,-688 11010,-688 11010,-620 11780,-620 11780,-688"/>
<text text-anchor="middle" x="11395" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 0</text>
<text text-anchor="middle" x="11395" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="11395" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="11395" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_0&#45;&gt;layer3_attn_weighted_0 -->
<g id="edge89" class="edge">
<title>layer3_attn_scores_0&#45;&gt;layer3_attn_weighted_0</title>
<path fill="none" stroke="black" d="M11372,-723.95C11372,-723.95 11372,-698.13 11372,-698.13"/>
<polygon fill="black" stroke="black" points="11375.5,-698.13 11372,-688.13 11368.5,-698.13 11375.5,-698.13"/>
</g>
<!-- layer3_attn_out_0 -->
<g id="node80" class="node">
<title>layer3_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="11632.5,-584 11059.5,-584 11059.5,-516 11632.5,-516 11632.5,-584"/>
<text text-anchor="middle" x="11346" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 0</text>
<text text-anchor="middle" x="11346" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="11346" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;820, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11346" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;820, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_0&#45;&gt;layer3_attn_out_0 -->
<g id="edge90" class="edge">
<title>layer3_attn_weighted_0&#45;&gt;layer3_attn_out_0</title>
<path fill="none" stroke="black" d="M11346,-619.95C11346,-619.95 11346,-594.13 11346,-594.13"/>
<polygon fill="black" stroke="black" points="11349.5,-594.13 11346,-584.13 11342.5,-594.13 11349.5,-594.13"/>
</g>
<!-- layer3_attn_aggregate -->
<g id="node97" class="node">
<title>layer3_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="10843.99,-480 9778.19,-480 9504.01,-344 10569.81,-344 10843.99,-480"/>
<text text-anchor="middle" x="10174" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Aggregation</text>
<text text-anchor="middle" x="10174" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="10174" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="10174" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_out_0&#45;&gt;layer3_attn_aggregate -->
<g id="edge91" class="edge">
<title>layer3_attn_out_0&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M11059.29,-550C10942.58,-550 10834.62,-550 10834.62,-550 10834.62,-550 10834.62,-422.1 10834.62,-422.1"/>
<polygon fill="black" stroke="black" points="10838.12,-422.1 10834.62,-412.1 10831.12,-422.1 10838.12,-422.1"/>
</g>
<!-- layer3_attn_scores_1 -->
<g id="node82" class="node">
<title>layer3_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="12443.5,-792 11940.5,-792 11940.5,-724 12443.5,-724 12443.5,-792"/>
<text text-anchor="middle" x="12192" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 1</text>
<text text-anchor="middle" x="12192" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="12192" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12192" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_1&#45;&gt;layer3_attn_scores_1 -->
<g id="edge93" class="edge">
<title>layer3_attn_qkv_1&#45;&gt;layer3_attn_scores_1</title>
<path fill="none" stroke="black" d="M12192,-894.81C12192,-894.81 12192,-802.13 12192,-802.13"/>
<polygon fill="black" stroke="black" points="12195.5,-802.13 12192,-792.13 12188.5,-802.13 12195.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_1 -->
<g id="node83" class="node">
<title>layer3_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="12613.5,-688 11816.5,-688 11816.5,-620 12613.5,-620 12613.5,-688"/>
<text text-anchor="middle" x="12215" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 1</text>
<text text-anchor="middle" x="12215" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="12215" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="12215" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_1&#45;&gt;layer3_attn_weighted_1 -->
<g id="edge94" class="edge">
<title>layer3_attn_scores_1&#45;&gt;layer3_attn_weighted_1</title>
<path fill="none" stroke="black" d="M12192,-723.95C12192,-723.95 12192,-698.13 12192,-698.13"/>
<polygon fill="black" stroke="black" points="12195.5,-698.13 12192,-688.13 12188.5,-698.13 12195.5,-698.13"/>
</g>
<!-- layer3_attn_out_1 -->
<g id="node84" class="node">
<title>layer3_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="12465,-584 11865,-584 11865,-516 12465,-516 12465,-584"/>
<text text-anchor="middle" x="12165" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 1</text>
<text text-anchor="middle" x="12165" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="12165" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=820&#45;1640, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12165" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=820&#45;1640, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_1&#45;&gt;layer3_attn_out_1 -->
<g id="edge95" class="edge">
<title>layer3_attn_weighted_1&#45;&gt;layer3_attn_out_1</title>
<path fill="none" stroke="black" d="M12165,-619.95C12165,-619.95 12165,-594.13 12165,-594.13"/>
<polygon fill="black" stroke="black" points="12168.5,-594.13 12165,-584.13 12161.5,-594.13 12168.5,-594.13"/>
</g>
<!-- layer3_attn_out_1&#45;&gt;layer3_attn_aggregate -->
<g id="edge96" class="edge">
<title>layer3_attn_out_1&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M12165,-515.89C12165,-475.02 12165,-412 12165,-412 12165,-412 10717.22,-412 10717.22,-412"/>
<polygon fill="black" stroke="black" points="10717.22,-408.5 10707.22,-412 10717.22,-415.5 10717.22,-408.5"/>
</g>
<!-- layer3_attn_scores_2 -->
<g id="node86" class="node">
<title>layer3_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="9166,-792 8654,-792 8654,-724 9166,-724 9166,-792"/>
<text text-anchor="middle" x="8910" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 2</text>
<text text-anchor="middle" x="8910" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8910" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8910" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_2&#45;&gt;layer3_attn_scores_2 -->
<g id="edge98" class="edge">
<title>layer3_attn_qkv_2&#45;&gt;layer3_attn_scores_2</title>
<path fill="none" stroke="black" d="M8910,-894.81C8910,-894.81 8910,-802.13 8910,-802.13"/>
<polygon fill="black" stroke="black" points="8913.5,-802.13 8910,-792.13 8906.5,-802.13 8913.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_2 -->
<g id="node87" class="node">
<title>layer3_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="9290,-688 8484,-688 8484,-620 9290,-620 9290,-688"/>
<text text-anchor="middle" x="8887" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 2</text>
<text text-anchor="middle" x="8887" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8887" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="8887" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_2&#45;&gt;layer3_attn_weighted_2 -->
<g id="edge99" class="edge">
<title>layer3_attn_scores_2&#45;&gt;layer3_attn_weighted_2</title>
<path fill="none" stroke="black" d="M8910,-723.95C8910,-723.95 8910,-698.13 8910,-698.13"/>
<polygon fill="black" stroke="black" points="8913.5,-698.13 8910,-688.13 8906.5,-698.13 8913.5,-698.13"/>
</g>
<!-- layer3_attn_out_2 -->
<g id="node88" class="node">
<title>layer3_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="9240.5,-584 8631.5,-584 8631.5,-516 9240.5,-516 9240.5,-584"/>
<text text-anchor="middle" x="8936" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 2</text>
<text text-anchor="middle" x="8936" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8936" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1640&#45;2460, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8936" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1640&#45;2460, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_2&#45;&gt;layer3_attn_out_2 -->
<g id="edge100" class="edge">
<title>layer3_attn_weighted_2&#45;&gt;layer3_attn_out_2</title>
<path fill="none" stroke="black" d="M8936,-619.95C8936,-619.95 8936,-594.13 8936,-594.13"/>
<polygon fill="black" stroke="black" points="8939.5,-594.13 8936,-584.13 8932.5,-594.13 8939.5,-594.13"/>
</g>
<!-- layer3_attn_out_2&#45;&gt;layer3_attn_aggregate -->
<g id="edge101" class="edge">
<title>layer3_attn_out_2&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M9061.72,-515.89C9061.72,-475.02 9061.72,-412 9061.72,-412 9061.72,-412 9631.07,-412 9631.07,-412"/>
<polygon fill="black" stroke="black" points="9631.07,-415.5 9641.07,-412 9631.07,-408.5 9631.07,-415.5"/>
</g>
<!-- layer3_attn_scores_3 -->
<g id="node90" class="node">
<title>layer3_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="10019,-792 9507,-792 9507,-724 10019,-724 10019,-792"/>
<text text-anchor="middle" x="9763" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 3</text>
<text text-anchor="middle" x="9763" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9763" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9763" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_3&#45;&gt;layer3_attn_scores_3 -->
<g id="edge103" class="edge">
<title>layer3_attn_qkv_3&#45;&gt;layer3_attn_scores_3</title>
<path fill="none" stroke="black" d="M9763,-894.81C9763,-894.81 9763,-802.13 9763,-802.13"/>
<polygon fill="black" stroke="black" points="9766.5,-802.13 9763,-792.13 9759.5,-802.13 9766.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_3 -->
<g id="node91" class="node">
<title>layer3_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="10132,-688 9326,-688 9326,-620 10132,-620 10132,-688"/>
<text text-anchor="middle" x="9729" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 3</text>
<text text-anchor="middle" x="9729" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9729" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="9729" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_3&#45;&gt;layer3_attn_weighted_3 -->
<g id="edge104" class="edge">
<title>layer3_attn_scores_3&#45;&gt;layer3_attn_weighted_3</title>
<path fill="none" stroke="black" d="M9763,-723.95C9763,-723.95 9763,-698.13 9763,-698.13"/>
<polygon fill="black" stroke="black" points="9766.5,-698.13 9763,-688.13 9759.5,-698.13 9766.5,-698.13"/>
</g>
<!-- layer3_attn_out_3 -->
<g id="node92" class="node">
<title>layer3_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="10082.5,-584 9473.5,-584 9473.5,-516 10082.5,-516 10082.5,-584"/>
<text text-anchor="middle" x="9778" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 3</text>
<text text-anchor="middle" x="9778" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9778" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2460&#45;3280, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9778" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2460&#45;3280, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_3&#45;&gt;layer3_attn_out_3 -->
<g id="edge105" class="edge">
<title>layer3_attn_weighted_3&#45;&gt;layer3_attn_out_3</title>
<path fill="none" stroke="black" d="M9778,-619.95C9778,-619.95 9778,-594.13 9778,-594.13"/>
<polygon fill="black" stroke="black" points="9781.5,-594.13 9778,-584.13 9774.5,-594.13 9781.5,-594.13"/>
</g>
<!-- layer3_attn_out_3&#45;&gt;layer3_attn_aggregate -->
<g id="edge106" class="edge">
<title>layer3_attn_out_3&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M9793.38,-515.89C9793.38,-515.89 9793.38,-490.23 9793.38,-490.23"/>
<polygon fill="black" stroke="black" points="9796.88,-490.23 9793.38,-480.23 9789.88,-490.23 9796.88,-490.23"/>
</g>
<!-- layer3_attn_scores_4 -->
<g id="node94" class="node">
<title>layer3_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="10792,-792 10280,-792 10280,-724 10792,-724 10792,-792"/>
<text text-anchor="middle" x="10536" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 4</text>
<text text-anchor="middle" x="10536" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10536" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10536" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_4&#45;&gt;layer3_attn_scores_4 -->
<g id="edge108" class="edge">
<title>layer3_attn_qkv_4&#45;&gt;layer3_attn_scores_4</title>
<path fill="none" stroke="black" d="M10536,-894.81C10536,-894.81 10536,-802.13 10536,-802.13"/>
<polygon fill="black" stroke="black" points="10539.5,-802.13 10536,-792.13 10532.5,-802.13 10539.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_4 -->
<g id="node95" class="node">
<title>layer3_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="10974,-688 10168,-688 10168,-620 10974,-620 10974,-688"/>
<text text-anchor="middle" x="10571" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 4</text>
<text text-anchor="middle" x="10571" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10571" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="10571" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_4&#45;&gt;layer3_attn_weighted_4 -->
<g id="edge109" class="edge">
<title>layer3_attn_scores_4&#45;&gt;layer3_attn_weighted_4</title>
<path fill="none" stroke="black" d="M10536,-723.95C10536,-723.95 10536,-698.13 10536,-698.13"/>
<polygon fill="black" stroke="black" points="10539.5,-698.13 10536,-688.13 10532.5,-698.13 10539.5,-698.13"/>
</g>
<!-- layer3_attn_out_4 -->
<g id="node96" class="node">
<title>layer3_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="10825.5,-584 10216.5,-584 10216.5,-516 10825.5,-516 10825.5,-584"/>
<text text-anchor="middle" x="10521" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 4</text>
<text text-anchor="middle" x="10521" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10521" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3280&#45;4097, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10521" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3280&#45;4097, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_4&#45;&gt;layer3_attn_out_4 -->
<g id="edge110" class="edge">
<title>layer3_attn_weighted_4&#45;&gt;layer3_attn_out_4</title>
<path fill="none" stroke="black" d="M10521,-619.95C10521,-619.95 10521,-594.13 10521,-594.13"/>
<polygon fill="black" stroke="black" points="10524.5,-594.13 10521,-584.13 10517.5,-594.13 10524.5,-594.13"/>
</g>
<!-- layer3_attn_out_4&#45;&gt;layer3_attn_aggregate -->
<g id="edge111" class="edge">
<title>layer3_attn_out_4&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M10521,-515.89C10521,-515.89 10521,-490.23 10521,-490.23"/>
<polygon fill="black" stroke="black" points="10524.5,-490.23 10521,-480.23 10517.5,-490.23 10524.5,-490.23"/>
</g>
<!-- recv_from_pool_3 -->
<g id="node98" class="node">
<title>recv_from_pool_3</title>
<polygon fill="yellow" stroke="black" points="9823.69,-308 8933.35,-308 8704.31,-172 9594.65,-172 9823.69,-308"/>
<text text-anchor="middle" x="9264" y="-258.8" font-family="Times,serif" font-size="14.00">Receive Layer 3 from Pool</text>
<text text-anchor="middle" x="9264" y="-243.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;12] → [0&#45;7]</text>
<text text-anchor="middle" x="9264" y="-228.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="9264" y="-213.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_aggregate&#45;&gt;recv_from_pool_3 -->
<g id="edge112" class="edge">
<title>layer3_attn_aggregate&#45;&gt;recv_from_pool_3</title>
<path fill="none" stroke="black" d="M9664.05,-343.53C9664.05,-343.53 9664.05,-318.24 9664.05,-318.24"/>
<polygon fill="black" stroke="black" points="9667.55,-318.24 9664.05,-308.24 9660.55,-318.24 9667.55,-318.24"/>
</g>
<!-- recv_from_pool_3&#45;&gt;output_proj -->
<g id="edge113" class="edge">
<title>recv_from_pool_3&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M8882.94,-278.22C8882.94,-301.19 8882.94,-326 8882.94,-326 8882.94,-326 4988,-326 4988,-326 4988,-326 4988,-1194.88 4988,-1194.88"/>
<polygon fill="black" stroke="black" points="4984.5,-1194.88 4988,-1204.88 4991.5,-1194.88 4984.5,-1194.88"/>
</g>
</g>
</svg>
