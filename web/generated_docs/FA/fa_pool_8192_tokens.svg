<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: fa_pool_transformer Pages: 1 -->
<svg width="20208pt" height="2396pt"
 viewBox="0.00 0.00 20208.00 2396.17" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2392.17)">
<title>fa_pool_transformer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2392.17 20204,-2392.17 20204,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_base</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="6142,-1059 6142,-1319 8414,-1319 8414,-1059 6142,-1059"/>
<text text-anchor="middle" x="7278" y="-1303.8" font-family="Times,serif" font-size="14.00">Base Layer &#45; GPUs [0&#45;7]</text>
<text text-anchor="middle" x="7278" y="-1288.8" font-family="Times,serif" font-size="14.00">FFN Operations Only</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0_attn_0</title>
<polygon fill="none" stroke="black" points="3113,-1663 3113,-2112 3909,-2112 3909,-1663 3113,-1663"/>
<text text-anchor="middle" x="3511" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 0</text>
<text text-anchor="middle" x="3511" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3511" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;1024</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer0_attn_1</title>
<polygon fill="none" stroke="black" points="3929,-1663 3929,-2112 4751,-2112 4751,-1663 3929,-1663"/>
<text text-anchor="middle" x="4340" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 1</text>
<text text-anchor="middle" x="4340" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="4340" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 1024&#45;2048</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer0_attn_2</title>
<polygon fill="none" stroke="black" points="4771,-1663 4771,-2112 5593,-2112 5593,-1663 4771,-1663"/>
<text text-anchor="middle" x="5182" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 2</text>
<text text-anchor="middle" x="5182" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="5182" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 2048&#45;3072</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer0_attn_3</title>
<polygon fill="none" stroke="black" points="5613,-1663 5613,-2112 6435,-2112 6435,-1663 5613,-1663"/>
<text text-anchor="middle" x="6024" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 3</text>
<text text-anchor="middle" x="6024" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="6024" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 3072&#45;4096</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer0_attn_4</title>
<polygon fill="none" stroke="black" points="6455,-1663 6455,-2112 7277,-2112 7277,-1663 6455,-1663"/>
<text text-anchor="middle" x="6866" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 4</text>
<text text-anchor="middle" x="6866" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6866" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 4096&#45;5120</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer0_attn_5</title>
<polygon fill="none" stroke="black" points="7297,-1663 7297,-2112 8119,-2112 8119,-1663 7297,-1663"/>
<text text-anchor="middle" x="7708" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 5</text>
<text text-anchor="middle" x="7708" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="7708" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 5120&#45;6144</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer0_attn_6</title>
<polygon fill="none" stroke="black" points="8139,-1663 8139,-2112 8961,-2112 8961,-1663 8139,-1663"/>
<text text-anchor="middle" x="8550" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 6</text>
<text text-anchor="middle" x="8550" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="8550" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 6144&#45;7168</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer0_attn_7</title>
<polygon fill="none" stroke="black" points="8981,-1663 8981,-2112 9803,-2112 9803,-1663 8981,-1663"/>
<text text-anchor="middle" x="9392" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 7</text>
<text text-anchor="middle" x="9392" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="9392" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 7168&#45;8192</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer1_attn_0</title>
<polygon fill="none" stroke="black" points="1692,-370 1692,-853 2488,-853 2488,-370 1692,-370"/>
<text text-anchor="middle" x="2090" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 0</text>
<text text-anchor="middle" x="2090" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2090" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;1024</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer1_attn_1</title>
<polygon fill="none" stroke="black" points="2508,-370 2508,-853 3330,-853 3330,-370 2508,-370"/>
<text text-anchor="middle" x="2919" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 1</text>
<text text-anchor="middle" x="2919" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2919" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 1024&#45;2048</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer1_attn_2</title>
<polygon fill="none" stroke="black" points="3350,-370 3350,-853 4172,-853 4172,-370 3350,-370"/>
<text text-anchor="middle" x="3761" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 2</text>
<text text-anchor="middle" x="3761" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="3761" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 2048&#45;3072</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer1_attn_3</title>
<polygon fill="none" stroke="black" points="4192,-370 4192,-853 5014,-853 5014,-370 4192,-370"/>
<text text-anchor="middle" x="4603" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 3</text>
<text text-anchor="middle" x="4603" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4603" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 3072&#45;4096</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer1_attn_4</title>
<polygon fill="none" stroke="black" points="5034,-370 5034,-853 5856,-853 5856,-370 5034,-370"/>
<text text-anchor="middle" x="5445" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 4</text>
<text text-anchor="middle" x="5445" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="5445" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 4096&#45;5120</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer1_attn_5</title>
<polygon fill="none" stroke="black" points="5876,-370 5876,-853 6698,-853 6698,-370 5876,-370"/>
<text text-anchor="middle" x="6287" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 5</text>
<text text-anchor="middle" x="6287" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="6287" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 5120&#45;6144</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer1_attn_6</title>
<polygon fill="none" stroke="black" points="8,-370 8,-853 830,-853 830,-370 8,-370"/>
<text text-anchor="middle" x="419" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 6</text>
<text text-anchor="middle" x="419" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="419" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 6144&#45;7168</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_layer1_attn_7</title>
<polygon fill="none" stroke="black" points="850,-370 850,-853 1672,-853 1672,-370 850,-370"/>
<text text-anchor="middle" x="1261" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 7</text>
<text text-anchor="middle" x="1261" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="1261" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 7168&#45;8192</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_layer2_attn_0</title>
<polygon fill="none" stroke="black" points="7634,-508 7634,-1024 8430,-1024 8430,-508 7634,-508"/>
<text text-anchor="middle" x="8032" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 0</text>
<text text-anchor="middle" x="8032" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8032" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;1024</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_layer2_attn_1</title>
<polygon fill="none" stroke="black" points="8450,-508 8450,-1024 9272,-1024 9272,-508 8450,-508"/>
<text text-anchor="middle" x="8861" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 1</text>
<text text-anchor="middle" x="8861" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="8861" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 1024&#45;2048</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_layer2_attn_2</title>
<polygon fill="none" stroke="black" points="9292,-508 9292,-1024 10114,-1024 10114,-508 9292,-508"/>
<text text-anchor="middle" x="9703" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 2</text>
<text text-anchor="middle" x="9703" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9703" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 2048&#45;3072</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_layer2_attn_3</title>
<polygon fill="none" stroke="black" points="10134,-508 10134,-1024 10956,-1024 10956,-508 10134,-508"/>
<text text-anchor="middle" x="10545" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 3</text>
<text text-anchor="middle" x="10545" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10545" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 3072&#45;4096</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_layer2_attn_4</title>
<polygon fill="none" stroke="black" points="10976,-508 10976,-1024 11798,-1024 11798,-508 10976,-508"/>
<text text-anchor="middle" x="11387" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 4</text>
<text text-anchor="middle" x="11387" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11387" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 4096&#45;5120</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_layer2_attn_5</title>
<polygon fill="none" stroke="black" points="11818,-508 11818,-1024 12640,-1024 12640,-508 11818,-508"/>
<text text-anchor="middle" x="12229" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 5</text>
<text text-anchor="middle" x="12229" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12229" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 5120&#45;6144</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_layer2_attn_6</title>
<polygon fill="none" stroke="black" points="12660,-508 12660,-1024 13482,-1024 13482,-508 12660,-508"/>
<text text-anchor="middle" x="13071" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 6</text>
<text text-anchor="middle" x="13071" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13071" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 6144&#45;7168</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_layer2_attn_7</title>
<polygon fill="none" stroke="black" points="6792,-508 6792,-1024 7614,-1024 7614,-508 6792,-508"/>
<text text-anchor="middle" x="7203" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 7</text>
<text text-anchor="middle" x="7203" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="7203" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 7168&#45;8192</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_layer3_attn_0</title>
<polygon fill="none" stroke="black" points="14344,-508 14344,-1024 15140,-1024 15140,-508 14344,-508"/>
<text text-anchor="middle" x="14742" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 0</text>
<text text-anchor="middle" x="14742" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14742" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;1024</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_layer3_attn_1</title>
<polygon fill="none" stroke="black" points="15160,-508 15160,-1024 15982,-1024 15982,-508 15160,-508"/>
<text text-anchor="middle" x="15571" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 1</text>
<text text-anchor="middle" x="15571" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15571" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 1024&#45;2048</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_layer3_attn_2</title>
<polygon fill="none" stroke="black" points="16002,-508 16002,-1024 16824,-1024 16824,-508 16002,-508"/>
<text text-anchor="middle" x="16413" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 2</text>
<text text-anchor="middle" x="16413" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16413" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 2048&#45;3072</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_layer3_attn_3</title>
<polygon fill="none" stroke="black" points="16844,-508 16844,-1024 17666,-1024 17666,-508 16844,-508"/>
<text text-anchor="middle" x="17255" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 3</text>
<text text-anchor="middle" x="17255" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="17255" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 3072&#45;4096</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_layer3_attn_4</title>
<polygon fill="none" stroke="black" points="17686,-508 17686,-1024 18508,-1024 18508,-508 17686,-508"/>
<text text-anchor="middle" x="18097" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 4</text>
<text text-anchor="middle" x="18097" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="18097" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 4096&#45;5120</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_layer3_attn_5</title>
<polygon fill="none" stroke="black" points="18528,-508 18528,-1024 19350,-1024 19350,-508 18528,-508"/>
<text text-anchor="middle" x="18939" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 5</text>
<text text-anchor="middle" x="18939" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="18939" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 5120&#45;6144</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_layer3_attn_6</title>
<polygon fill="none" stroke="black" points="19370,-508 19370,-1024 20192,-1024 20192,-508 19370,-508"/>
<text text-anchor="middle" x="19781" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 6</text>
<text text-anchor="middle" x="19781" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="19781" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 6144&#45;7168</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_layer3_attn_7</title>
<polygon fill="none" stroke="black" points="13502,-508 13502,-1024 14324,-1024 14324,-508 13502,-508"/>
<text text-anchor="middle" x="13913" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 7</text>
<text text-anchor="middle" x="13913" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="13913" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 7168&#45;8192</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="6468" cy="-2340.08" rx="381.68" ry="48.17"/>
<text text-anchor="middle" x="6468" y="-2358.88" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="6468" y="-2343.88" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="6468" y="-2328.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096]</text>
<text text-anchor="middle" x="6468" y="-2313.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- send_to_pool -->
<g id="node7" class="node">
<title>send_to_pool</title>
<polygon fill="yellow" stroke="black" points="7027.69,-2256 6137.35,-2256 5908.31,-2120 6798.65,-2120 7027.69,-2256"/>
<text text-anchor="middle" x="6468" y="-2206.8" font-family="Times,serif" font-size="14.00">Send to Attention Pool</text>
<text text-anchor="middle" x="6468" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;{7+attention_pool_gpus}]</text>
<text text-anchor="middle" x="6468" y="-2176.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6468" y="-2161.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- input&#45;&gt;send_to_pool -->
<g id="edge1" class="edge">
<title>input&#45;&gt;send_to_pool</title>
<path fill="none" stroke="black" d="M6468,-2291.96C6468,-2291.96 6468,-2266.09 6468,-2266.09"/>
<polygon fill="black" stroke="black" points="6471.5,-2266.09 6468,-2256.09 6464.5,-2266.09 6471.5,-2266.09"/>
</g>
<!-- layer0_ffn_start -->
<g id="node2" class="node">
<title>layer0_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="6690,-1273 6150,-1273 6150,-1205 6690,-1205 6690,-1273"/>
<text text-anchor="middle" x="6420" y="-1257.8" font-family="Times,serif" font-size="14.00">Layer 0 FFN Start</text>
<text text-anchor="middle" x="6420" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="6420" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6420" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_ffn_start -->
<g id="node3" class="node">
<title>layer1_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="6690,-1135 6150,-1135 6150,-1067 6690,-1067 6690,-1135"/>
<text text-anchor="middle" x="6420" y="-1119.8" font-family="Times,serif" font-size="14.00">Layer 1 FFN Start</text>
<text text-anchor="middle" x="6420" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="6420" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6420" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_ffn_start&#45;&gt;layer1_ffn_start -->
<g id="edge44" class="edge">
<title>layer0_ffn_start&#45;&gt;layer1_ffn_start</title>
<path fill="none" stroke="black" d="M6420,-1204.89C6420,-1204.89 6420,-1145.2 6420,-1145.2"/>
<polygon fill="black" stroke="black" points="6423.5,-1145.2 6420,-1135.2 6416.5,-1145.2 6423.5,-1145.2"/>
</g>
<!-- send_to_pool_1 -->
<g id="node42" class="node">
<title>send_to_pool_1</title>
<polygon fill="yellow" stroke="black" points="4320.69,-997 3430.35,-997 3201.31,-861 4091.65,-861 4320.69,-997"/>
<text text-anchor="middle" x="3761" y="-947.8" font-family="Times,serif" font-size="14.00">Send Layer 1 to Pool</text>
<text text-anchor="middle" x="3761" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;15]</text>
<text text-anchor="middle" x="3761" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="3761" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_ffn_start&#45;&gt;send_to_pool_1 -->
<g id="edge45" class="edge">
<title>layer1_ffn_start&#45;&gt;send_to_pool_1</title>
<path fill="none" stroke="black" d="M6149.78,-1101C5558.56,-1101 4202.67,-1101 4202.67,-1101 4202.67,-1101 4202.67,-1007.47 4202.67,-1007.47"/>
<polygon fill="black" stroke="black" points="4206.17,-1007.47 4202.67,-997.47 4199.17,-1007.47 4206.17,-1007.47"/>
</g>
<!-- layer2_ffn_start -->
<g id="node4" class="node">
<title>layer2_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="8406,-1273 7866,-1273 7866,-1205 8406,-1205 8406,-1273"/>
<text text-anchor="middle" x="8136" y="-1257.8" font-family="Times,serif" font-size="14.00">Layer 2 FFN Start</text>
<text text-anchor="middle" x="8136" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="8136" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="8136" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- send_to_pool_2 -->
<g id="node77" class="node">
<title>send_to_pool_2</title>
<polygon fill="yellow" stroke="black" points="10262.69,-1169 9372.35,-1169 9143.31,-1033 10033.65,-1033 10262.69,-1169"/>
<text text-anchor="middle" x="9703" y="-1119.8" font-family="Times,serif" font-size="14.00">Send Layer 2 to Pool</text>
<text text-anchor="middle" x="9703" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;15]</text>
<text text-anchor="middle" x="9703" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="9703" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_ffn_start&#45;&gt;send_to_pool_2 -->
<g id="edge88" class="edge">
<title>layer2_ffn_start&#45;&gt;send_to_pool_2</title>
<path fill="none" stroke="black" d="M8391,-1204.61C8391,-1182.93 8391,-1159 8391,-1159 8391,-1159 9345.28,-1159 9345.28,-1159"/>
<polygon fill="black" stroke="black" points="9345.28,-1162.5 9355.28,-1159 9345.28,-1155.5 9345.28,-1162.5"/>
</g>
<!-- layer3_ffn_start -->
<g id="node5" class="node">
<title>layer3_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="7266,-1273 6726,-1273 6726,-1205 7266,-1205 7266,-1273"/>
<text text-anchor="middle" x="6996" y="-1257.8" font-family="Times,serif" font-size="14.00">Layer 3 FFN Start</text>
<text text-anchor="middle" x="6996" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="6996" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6996" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- send_to_pool_3 -->
<g id="node112" class="node">
<title>send_to_pool_3</title>
<polygon fill="yellow" stroke="black" points="16972.69,-1169 16082.35,-1169 15853.31,-1033 16743.65,-1033 16972.69,-1169"/>
<text text-anchor="middle" x="16413" y="-1119.8" font-family="Times,serif" font-size="14.00">Send Layer 3 to Pool</text>
<text text-anchor="middle" x="16413" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;15]</text>
<text text-anchor="middle" x="16413" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="16413" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_ffn_start&#45;&gt;send_to_pool_3 -->
<g id="edge131" class="edge">
<title>layer3_ffn_start&#45;&gt;send_to_pool_3</title>
<path fill="none" stroke="black" d="M7101.75,-1204.98C7101.75,-1142.32 7101.75,-1015 7101.75,-1015 7101.75,-1015 15878.27,-1015 15878.27,-1015 15878.27,-1015 15878.27,-1090.94 15878.27,-1090.94"/>
<polygon fill="black" stroke="black" points="15874.77,-1090.94 15878.27,-1100.94 15881.77,-1090.94 15874.77,-1090.94"/>
</g>
<!-- output_proj -->
<g id="node6" class="node">
<title>output_proj</title>
<polygon fill="lightblue" stroke="black" points="7830,-1273 7302,-1273 7302,-1205 7830,-1205 7830,-1273"/>
<text text-anchor="middle" x="7566" y="-1257.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7566" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="7566" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7566" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=?, partition=?]</text>
</g>
<!-- output -->
<g id="node147" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="8756" cy="-1101" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="8756" y="-1119.8" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="8756" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="8756" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, vocab_size=?, partition=?]</text>
<text text-anchor="middle" x="8756" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=?]</text>
</g>
<!-- output_proj&#45;&gt;output -->
<g id="edge174" class="edge">
<title>output_proj&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7805,-1204.8C7805,-1176.87 7805,-1142 7805,-1142 7805,-1142 8571.02,-1142 8571.02,-1142"/>
<polygon fill="black" stroke="black" points="8571.02,-1145.5 8581.02,-1142 8571.02,-1138.5 8571.02,-1145.5"/>
</g>
<!-- layer0_attn_qkv_0 -->
<g id="node9" class="node">
<title>layer0_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="3878,-2051 3282,-2051 3282,-1983 3878,-1983 3878,-2051"/>
<text text-anchor="middle" x="3580" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 0</text>
<text text-anchor="middle" x="3580" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3580" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="3580" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_0 -->
<g id="edge2" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_0</title>
<path fill="none" stroke="black" d="M6080.01,-2222C5292.38,-2222 3580,-2222 3580,-2222 3580,-2222 3580,-2061.31 3580,-2061.31"/>
<polygon fill="black" stroke="black" points="3583.5,-2061.31 3580,-2051.31 3576.5,-2061.31 3583.5,-2061.31"/>
</g>
<!-- layer0_attn_qkv_1 -->
<g id="node13" class="node">
<title>layer0_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="4697.5,-2051 4074.5,-2051 4074.5,-1983 4697.5,-1983 4697.5,-2051"/>
<text text-anchor="middle" x="4386" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 1</text>
<text text-anchor="middle" x="4386" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="4386" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4386" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_1 -->
<g id="edge7" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_1</title>
<path fill="none" stroke="black" d="M6022.64,-2188C5411.02,-2188 4386,-2188 4386,-2188 4386,-2188 4386,-2061.19 4386,-2061.19"/>
<polygon fill="black" stroke="black" points="4389.5,-2061.19 4386,-2051.19 4382.5,-2061.19 4389.5,-2061.19"/>
</g>
<!-- layer0_attn_qkv_2 -->
<g id="node17" class="node">
<title>layer0_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="5562.5,-2051 4939.5,-2051 4939.5,-1983 5562.5,-1983 5562.5,-2051"/>
<text text-anchor="middle" x="5251" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 2</text>
<text text-anchor="middle" x="5251" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="5251" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="5251" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_2 -->
<g id="edge12" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_2</title>
<path fill="none" stroke="black" d="M5965.53,-2154C5630.4,-2154 5251,-2154 5251,-2154 5251,-2154 5251,-2061.22 5251,-2061.22"/>
<polygon fill="black" stroke="black" points="5254.5,-2061.22 5251,-2051.22 5247.5,-2061.22 5254.5,-2061.22"/>
</g>
<!-- layer0_attn_qkv_3 -->
<g id="node21" class="node">
<title>layer0_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="6404.5,-2051 5781.5,-2051 5781.5,-1983 6404.5,-1983 6404.5,-2051"/>
<text text-anchor="middle" x="6093" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 3</text>
<text text-anchor="middle" x="6093" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="6093" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6093" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_3 -->
<g id="edge17" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_3</title>
<path fill="none" stroke="black" d="M6156.33,-2119.92C6156.33,-2119.92 6156.33,-2061.04 6156.33,-2061.04"/>
<polygon fill="black" stroke="black" points="6159.83,-2061.04 6156.33,-2051.04 6152.83,-2061.04 6159.83,-2061.04"/>
</g>
<!-- layer0_attn_qkv_4 -->
<g id="node25" class="node">
<title>layer0_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="7131.5,-2051 6508.5,-2051 6508.5,-1983 7131.5,-1983 7131.5,-2051"/>
<text text-anchor="middle" x="6820" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 4</text>
<text text-anchor="middle" x="6820" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6820" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6820" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_4 -->
<g id="edge22" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_4</title>
<path fill="none" stroke="black" d="M6768.17,-2119.92C6768.17,-2119.92 6768.17,-2061.04 6768.17,-2061.04"/>
<polygon fill="black" stroke="black" points="6771.67,-2061.04 6768.17,-2051.04 6764.67,-2061.04 6771.67,-2061.04"/>
</g>
<!-- layer0_attn_qkv_5 -->
<g id="node29" class="node">
<title>layer0_attn_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="7973.5,-2051 7350.5,-2051 7350.5,-1983 7973.5,-1983 7973.5,-2051"/>
<text text-anchor="middle" x="7662" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 5</text>
<text text-anchor="middle" x="7662" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="7662" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7662" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_5 -->
<g id="edge27" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_5</title>
<path fill="none" stroke="black" d="M6856.07,-2154C7204.66,-2154 7662,-2154 7662,-2154 7662,-2154 7662,-2061.22 7662,-2061.22"/>
<polygon fill="black" stroke="black" points="7665.5,-2061.22 7662,-2051.22 7658.5,-2061.22 7665.5,-2061.22"/>
</g>
<!-- layer0_attn_qkv_6 -->
<g id="node33" class="node">
<title>layer0_attn_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="8815.5,-2051 8192.5,-2051 8192.5,-1983 8815.5,-1983 8815.5,-2051"/>
<text text-anchor="middle" x="8504" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 6</text>
<text text-anchor="middle" x="8504" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="8504" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="8504" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_6 -->
<g id="edge32" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_6</title>
<path fill="none" stroke="black" d="M6913.24,-2188C7512.41,-2188 8504,-2188 8504,-2188 8504,-2188 8504,-2061.19 8504,-2061.19"/>
<polygon fill="black" stroke="black" points="8507.5,-2061.19 8504,-2051.19 8500.5,-2061.19 8507.5,-2061.19"/>
</g>
<!-- layer0_attn_qkv_7 -->
<g id="node37" class="node">
<title>layer0_attn_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="9657.5,-2051 9034.5,-2051 9034.5,-1983 9657.5,-1983 9657.5,-2051"/>
<text text-anchor="middle" x="9346" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 7</text>
<text text-anchor="middle" x="9346" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="9346" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="9346" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_7 -->
<g id="edge37" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_7</title>
<path fill="none" stroke="black" d="M6970.54,-2222C7795.42,-2222 9346,-2222 9346,-2222 9346,-2222 9346,-2061.31 9346,-2061.31"/>
<polygon fill="black" stroke="black" points="9349.5,-2061.31 9346,-2051.31 9342.5,-2061.31 9349.5,-2061.31"/>
</g>
<!-- recv_from_pool -->
<g id="node8" class="node">
<title>recv_from_pool</title>
<polygon fill="yellow" stroke="black" points="6979.69,-1463 6089.35,-1463 5860.31,-1327 6750.65,-1327 6979.69,-1463"/>
<text text-anchor="middle" x="6420" y="-1413.8" font-family="Times,serif" font-size="14.00">Receive from Attention Pool</text>
<text text-anchor="middle" x="6420" y="-1398.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;{7+attention_pool_gpus}] → [0&#45;7]</text>
<text text-anchor="middle" x="6420" y="-1383.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6420" y="-1368.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- recv_from_pool&#45;&gt;layer0_ffn_start -->
<g id="edge43" class="edge">
<title>recv_from_pool&#45;&gt;layer0_ffn_start</title>
<path fill="none" stroke="black" d="M6420,-1326.58C6420,-1326.58 6420,-1283.13 6420,-1283.13"/>
<polygon fill="black" stroke="black" points="6423.5,-1283.13 6420,-1273.13 6416.5,-1283.13 6423.5,-1283.13"/>
</g>
<!-- layer0_attn_scores_0 -->
<g id="node10" class="node">
<title>layer0_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="3776.5,-1947 3291.5,-1947 3291.5,-1879 3776.5,-1879 3776.5,-1947"/>
<text text-anchor="middle" x="3534" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 0</text>
<text text-anchor="middle" x="3534" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3534" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3534" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_0&#45;&gt;layer0_attn_scores_0 -->
<g id="edge3" class="edge">
<title>layer0_attn_qkv_0&#45;&gt;layer0_attn_scores_0</title>
<path fill="none" stroke="black" d="M3534,-1982.95C3534,-1982.95 3534,-1957.13 3534,-1957.13"/>
<polygon fill="black" stroke="black" points="3537.5,-1957.13 3534,-1947.13 3530.5,-1957.13 3537.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_0 -->
<g id="node11" class="node">
<title>layer0_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="3900.5,-1843 3121.5,-1843 3121.5,-1775 3900.5,-1775 3900.5,-1843"/>
<text text-anchor="middle" x="3511" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 0</text>
<text text-anchor="middle" x="3511" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3511" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="3511" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_0&#45;&gt;layer0_attn_weighted_0 -->
<g id="edge4" class="edge">
<title>layer0_attn_scores_0&#45;&gt;layer0_attn_weighted_0</title>
<path fill="none" stroke="black" d="M3534,-1878.95C3534,-1878.95 3534,-1853.13 3534,-1853.13"/>
<polygon fill="black" stroke="black" points="3537.5,-1853.13 3534,-1843.13 3530.5,-1853.13 3537.5,-1853.13"/>
</g>
<!-- layer0_attn_out_0 -->
<g id="node12" class="node">
<title>layer0_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="3851,-1739 3269,-1739 3269,-1671 3851,-1671 3851,-1739"/>
<text text-anchor="middle" x="3560" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 0</text>
<text text-anchor="middle" x="3560" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="3560" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3560" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_0&#45;&gt;layer0_attn_out_0 -->
<g id="edge5" class="edge">
<title>layer0_attn_weighted_0&#45;&gt;layer0_attn_out_0</title>
<path fill="none" stroke="black" d="M3560,-1774.95C3560,-1774.95 3560,-1749.13 3560,-1749.13"/>
<polygon fill="black" stroke="black" points="3563.5,-1749.13 3560,-1739.13 3556.5,-1749.13 3563.5,-1749.13"/>
</g>
<!-- layer0_attn_aggregate -->
<g id="node41" class="node">
<title>layer0_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="7089.99,-1635 6024.19,-1635 5750.01,-1499 6815.81,-1499 7089.99,-1635"/>
<text text-anchor="middle" x="6420" y="-1585.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Aggregation</text>
<text text-anchor="middle" x="6420" y="-1570.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="6420" y="-1555.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="6420" y="-1540.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_out_0&#45;&gt;layer0_attn_aggregate -->
<g id="edge6" class="edge">
<title>layer0_attn_out_0&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M3560,-1670.86C3560,-1623.6 3560,-1544 3560,-1544 3560,-1544 5830.38,-1544 5830.38,-1544"/>
<polygon fill="black" stroke="black" points="5830.38,-1547.5 5840.38,-1544 5830.38,-1540.5 5830.38,-1547.5"/>
</g>
<!-- layer0_attn_scores_1 -->
<g id="node14" class="node">
<title>layer0_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="4619,-1947 4107,-1947 4107,-1879 4619,-1879 4619,-1947"/>
<text text-anchor="middle" x="4363" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 1</text>
<text text-anchor="middle" x="4363" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="4363" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4363" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_1&#45;&gt;layer0_attn_scores_1 -->
<g id="edge8" class="edge">
<title>layer0_attn_qkv_1&#45;&gt;layer0_attn_scores_1</title>
<path fill="none" stroke="black" d="M4363,-1982.95C4363,-1982.95 4363,-1957.13 4363,-1957.13"/>
<polygon fill="black" stroke="black" points="4366.5,-1957.13 4363,-1947.13 4359.5,-1957.13 4366.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_1 -->
<g id="node15" class="node">
<title>layer0_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="4743,-1843 3937,-1843 3937,-1775 4743,-1775 4743,-1843"/>
<text text-anchor="middle" x="4340" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 1</text>
<text text-anchor="middle" x="4340" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="4340" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="4340" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_1&#45;&gt;layer0_attn_weighted_1 -->
<g id="edge9" class="edge">
<title>layer0_attn_scores_1&#45;&gt;layer0_attn_weighted_1</title>
<path fill="none" stroke="black" d="M4363,-1878.95C4363,-1878.95 4363,-1853.13 4363,-1853.13"/>
<polygon fill="black" stroke="black" points="4366.5,-1853.13 4363,-1843.13 4359.5,-1853.13 4366.5,-1853.13"/>
</g>
<!-- layer0_attn_out_1 -->
<g id="node16" class="node">
<title>layer0_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="4693.5,-1739 4084.5,-1739 4084.5,-1671 4693.5,-1671 4693.5,-1739"/>
<text text-anchor="middle" x="4389" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 1</text>
<text text-anchor="middle" x="4389" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="4389" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4389" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_1&#45;&gt;layer0_attn_out_1 -->
<g id="edge10" class="edge">
<title>layer0_attn_weighted_1&#45;&gt;layer0_attn_out_1</title>
<path fill="none" stroke="black" d="M4389,-1774.95C4389,-1774.95 4389,-1749.13 4389,-1749.13"/>
<polygon fill="black" stroke="black" points="4392.5,-1749.13 4389,-1739.13 4385.5,-1749.13 4392.5,-1749.13"/>
</g>
<!-- layer0_attn_out_1&#45;&gt;layer0_attn_aggregate -->
<g id="edge11" class="edge">
<title>layer0_attn_out_1&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M4507.17,-1670.82C4507.17,-1636.61 4507.17,-1589 4507.17,-1589 4507.17,-1589 5921.43,-1589 5921.43,-1589"/>
<polygon fill="black" stroke="black" points="5921.43,-1592.5 5931.43,-1589 5921.43,-1585.5 5921.43,-1592.5"/>
</g>
<!-- layer0_attn_scores_2 -->
<g id="node18" class="node">
<title>layer0_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="5461,-1947 4949,-1947 4949,-1879 5461,-1879 5461,-1947"/>
<text text-anchor="middle" x="5205" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 2</text>
<text text-anchor="middle" x="5205" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="5205" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5205" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_2&#45;&gt;layer0_attn_scores_2 -->
<g id="edge13" class="edge">
<title>layer0_attn_qkv_2&#45;&gt;layer0_attn_scores_2</title>
<path fill="none" stroke="black" d="M5205,-1982.95C5205,-1982.95 5205,-1957.13 5205,-1957.13"/>
<polygon fill="black" stroke="black" points="5208.5,-1957.13 5205,-1947.13 5201.5,-1957.13 5208.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_2 -->
<g id="node19" class="node">
<title>layer0_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="5585,-1843 4779,-1843 4779,-1775 5585,-1775 5585,-1843"/>
<text text-anchor="middle" x="5182" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 2</text>
<text text-anchor="middle" x="5182" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="5182" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="5182" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_2&#45;&gt;layer0_attn_weighted_2 -->
<g id="edge14" class="edge">
<title>layer0_attn_scores_2&#45;&gt;layer0_attn_weighted_2</title>
<path fill="none" stroke="black" d="M5205,-1878.95C5205,-1878.95 5205,-1853.13 5205,-1853.13"/>
<polygon fill="black" stroke="black" points="5208.5,-1853.13 5205,-1843.13 5201.5,-1853.13 5208.5,-1853.13"/>
</g>
<!-- layer0_attn_out_2 -->
<g id="node20" class="node">
<title>layer0_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="5535.5,-1739 4926.5,-1739 4926.5,-1671 5535.5,-1671 5535.5,-1739"/>
<text text-anchor="middle" x="5231" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 2</text>
<text text-anchor="middle" x="5231" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="5231" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5231" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_2&#45;&gt;layer0_attn_out_2 -->
<g id="edge15" class="edge">
<title>layer0_attn_weighted_2&#45;&gt;layer0_attn_out_2</title>
<path fill="none" stroke="black" d="M5231,-1774.95C5231,-1774.95 5231,-1749.13 5231,-1749.13"/>
<polygon fill="black" stroke="black" points="5234.5,-1749.13 5231,-1739.13 5227.5,-1749.13 5234.5,-1749.13"/>
</g>
<!-- layer0_attn_out_2&#45;&gt;layer0_attn_aggregate -->
<g id="edge16" class="edge">
<title>layer0_attn_out_2&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M5535.68,-1705C5652.98,-1705 5759.38,-1705 5759.38,-1705 5759.38,-1705 5759.38,-1577.1 5759.38,-1577.1"/>
<polygon fill="black" stroke="black" points="5762.88,-1577.1 5759.38,-1567.1 5755.88,-1577.1 5762.88,-1577.1"/>
</g>
<!-- layer0_attn_scores_3 -->
<g id="node22" class="node">
<title>layer0_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="6303,-1947 5791,-1947 5791,-1879 6303,-1879 6303,-1947"/>
<text text-anchor="middle" x="6047" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 3</text>
<text text-anchor="middle" x="6047" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="6047" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6047" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_3&#45;&gt;layer0_attn_scores_3 -->
<g id="edge18" class="edge">
<title>layer0_attn_qkv_3&#45;&gt;layer0_attn_scores_3</title>
<path fill="none" stroke="black" d="M6047,-1982.95C6047,-1982.95 6047,-1957.13 6047,-1957.13"/>
<polygon fill="black" stroke="black" points="6050.5,-1957.13 6047,-1947.13 6043.5,-1957.13 6050.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_3 -->
<g id="node23" class="node">
<title>layer0_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="6427,-1843 5621,-1843 5621,-1775 6427,-1775 6427,-1843"/>
<text text-anchor="middle" x="6024" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 3</text>
<text text-anchor="middle" x="6024" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="6024" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="6024" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_3&#45;&gt;layer0_attn_weighted_3 -->
<g id="edge19" class="edge">
<title>layer0_attn_scores_3&#45;&gt;layer0_attn_weighted_3</title>
<path fill="none" stroke="black" d="M6047,-1878.95C6047,-1878.95 6047,-1853.13 6047,-1853.13"/>
<polygon fill="black" stroke="black" points="6050.5,-1853.13 6047,-1843.13 6043.5,-1853.13 6050.5,-1853.13"/>
</g>
<!-- layer0_attn_out_3 -->
<g id="node24" class="node">
<title>layer0_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="6377.5,-1739 5768.5,-1739 5768.5,-1671 6377.5,-1671 6377.5,-1739"/>
<text text-anchor="middle" x="6073" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 3</text>
<text text-anchor="middle" x="6073" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="6073" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6073" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_3&#45;&gt;layer0_attn_out_3 -->
<g id="edge20" class="edge">
<title>layer0_attn_weighted_3&#45;&gt;layer0_attn_out_3</title>
<path fill="none" stroke="black" d="M6073,-1774.95C6073,-1774.95 6073,-1749.13 6073,-1749.13"/>
<polygon fill="black" stroke="black" points="6076.5,-1749.13 6073,-1739.13 6069.5,-1749.13 6076.5,-1749.13"/>
</g>
<!-- layer0_attn_out_3&#45;&gt;layer0_attn_aggregate -->
<g id="edge21" class="edge">
<title>layer0_attn_out_3&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M6073,-1670.89C6073,-1670.89 6073,-1645.23 6073,-1645.23"/>
<polygon fill="black" stroke="black" points="6076.5,-1645.23 6073,-1635.23 6069.5,-1645.23 6076.5,-1645.23"/>
</g>
<!-- layer0_attn_scores_4 -->
<g id="node26" class="node">
<title>layer0_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="7099,-1947 6587,-1947 6587,-1879 7099,-1879 7099,-1947"/>
<text text-anchor="middle" x="6843" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 4</text>
<text text-anchor="middle" x="6843" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6843" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6843" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_4&#45;&gt;layer0_attn_scores_4 -->
<g id="edge23" class="edge">
<title>layer0_attn_qkv_4&#45;&gt;layer0_attn_scores_4</title>
<path fill="none" stroke="black" d="M6843,-1982.95C6843,-1982.95 6843,-1957.13 6843,-1957.13"/>
<polygon fill="black" stroke="black" points="6846.5,-1957.13 6843,-1947.13 6839.5,-1957.13 6846.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_4 -->
<g id="node27" class="node">
<title>layer0_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="7269,-1843 6463,-1843 6463,-1775 7269,-1775 7269,-1843"/>
<text text-anchor="middle" x="6866" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 4</text>
<text text-anchor="middle" x="6866" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6866" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="6866" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_4&#45;&gt;layer0_attn_weighted_4 -->
<g id="edge24" class="edge">
<title>layer0_attn_scores_4&#45;&gt;layer0_attn_weighted_4</title>
<path fill="none" stroke="black" d="M6843,-1878.95C6843,-1878.95 6843,-1853.13 6843,-1853.13"/>
<polygon fill="black" stroke="black" points="6846.5,-1853.13 6843,-1843.13 6839.5,-1853.13 6846.5,-1853.13"/>
</g>
<!-- layer0_attn_out_4 -->
<g id="node28" class="node">
<title>layer0_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="7120.5,-1739 6511.5,-1739 6511.5,-1671 7120.5,-1671 7120.5,-1739"/>
<text text-anchor="middle" x="6816" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 4</text>
<text text-anchor="middle" x="6816" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="6816" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6816" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_4&#45;&gt;layer0_attn_out_4 -->
<g id="edge25" class="edge">
<title>layer0_attn_weighted_4&#45;&gt;layer0_attn_out_4</title>
<path fill="none" stroke="black" d="M6816,-1774.95C6816,-1774.95 6816,-1749.13 6816,-1749.13"/>
<polygon fill="black" stroke="black" points="6819.5,-1749.13 6816,-1739.13 6812.5,-1749.13 6819.5,-1749.13"/>
</g>
<!-- layer0_attn_out_4&#45;&gt;layer0_attn_aggregate -->
<g id="edge26" class="edge">
<title>layer0_attn_out_4&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M6800.62,-1670.89C6800.62,-1670.89 6800.62,-1645.23 6800.62,-1645.23"/>
<polygon fill="black" stroke="black" points="6804.12,-1645.23 6800.62,-1635.23 6797.12,-1645.23 6804.12,-1645.23"/>
</g>
<!-- layer0_attn_scores_5 -->
<g id="node30" class="node">
<title>layer0_attn_scores_5</title>
<polygon fill="lightblue" stroke="black" points="7941,-1947 7429,-1947 7429,-1879 7941,-1879 7941,-1947"/>
<text text-anchor="middle" x="7685" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 5</text>
<text text-anchor="middle" x="7685" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="7685" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7685" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_5&#45;&gt;layer0_attn_scores_5 -->
<g id="edge28" class="edge">
<title>layer0_attn_qkv_5&#45;&gt;layer0_attn_scores_5</title>
<path fill="none" stroke="black" d="M7685,-1982.95C7685,-1982.95 7685,-1957.13 7685,-1957.13"/>
<polygon fill="black" stroke="black" points="7688.5,-1957.13 7685,-1947.13 7681.5,-1957.13 7688.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_5 -->
<g id="node31" class="node">
<title>layer0_attn_weighted_5</title>
<polygon fill="lightblue" stroke="black" points="8111,-1843 7305,-1843 7305,-1775 8111,-1775 8111,-1843"/>
<text text-anchor="middle" x="7708" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 5</text>
<text text-anchor="middle" x="7708" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="7708" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="7708" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_5&#45;&gt;layer0_attn_weighted_5 -->
<g id="edge29" class="edge">
<title>layer0_attn_scores_5&#45;&gt;layer0_attn_weighted_5</title>
<path fill="none" stroke="black" d="M7685,-1878.95C7685,-1878.95 7685,-1853.13 7685,-1853.13"/>
<polygon fill="black" stroke="black" points="7688.5,-1853.13 7685,-1843.13 7681.5,-1853.13 7688.5,-1853.13"/>
</g>
<!-- layer0_attn_out_5 -->
<g id="node32" class="node">
<title>layer0_attn_out_5</title>
<polygon fill="lightblue" stroke="black" points="7962.5,-1739 7353.5,-1739 7353.5,-1671 7962.5,-1671 7962.5,-1739"/>
<text text-anchor="middle" x="7658" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 5</text>
<text text-anchor="middle" x="7658" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="7658" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7658" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_5&#45;&gt;layer0_attn_out_5 -->
<g id="edge30" class="edge">
<title>layer0_attn_weighted_5&#45;&gt;layer0_attn_out_5</title>
<path fill="none" stroke="black" d="M7658,-1774.95C7658,-1774.95 7658,-1749.13 7658,-1749.13"/>
<polygon fill="black" stroke="black" points="7661.5,-1749.13 7658,-1739.13 7654.5,-1749.13 7661.5,-1749.13"/>
</g>
<!-- layer0_attn_out_5&#45;&gt;layer0_attn_aggregate -->
<g id="edge31" class="edge">
<title>layer0_attn_out_5&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M7591.75,-1670.95C7591.75,-1640.62 7591.75,-1601 7591.75,-1601 7591.75,-1601 7031.75,-1601 7031.75,-1601"/>
<polygon fill="black" stroke="black" points="7031.75,-1597.5 7021.75,-1601 7031.75,-1604.5 7031.75,-1597.5"/>
</g>
<!-- layer0_attn_scores_6 -->
<g id="node34" class="node">
<title>layer0_attn_scores_6</title>
<polygon fill="lightblue" stroke="black" points="8783,-1947 8271,-1947 8271,-1879 8783,-1879 8783,-1947"/>
<text text-anchor="middle" x="8527" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 6</text>
<text text-anchor="middle" x="8527" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="8527" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8527" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_6&#45;&gt;layer0_attn_scores_6 -->
<g id="edge33" class="edge">
<title>layer0_attn_qkv_6&#45;&gt;layer0_attn_scores_6</title>
<path fill="none" stroke="black" d="M8527,-1982.95C8527,-1982.95 8527,-1957.13 8527,-1957.13"/>
<polygon fill="black" stroke="black" points="8530.5,-1957.13 8527,-1947.13 8523.5,-1957.13 8530.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_6 -->
<g id="node35" class="node">
<title>layer0_attn_weighted_6</title>
<polygon fill="lightblue" stroke="black" points="8953,-1843 8147,-1843 8147,-1775 8953,-1775 8953,-1843"/>
<text text-anchor="middle" x="8550" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 6</text>
<text text-anchor="middle" x="8550" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="8550" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="8550" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_6&#45;&gt;layer0_attn_weighted_6 -->
<g id="edge34" class="edge">
<title>layer0_attn_scores_6&#45;&gt;layer0_attn_weighted_6</title>
<path fill="none" stroke="black" d="M8527,-1878.95C8527,-1878.95 8527,-1853.13 8527,-1853.13"/>
<polygon fill="black" stroke="black" points="8530.5,-1853.13 8527,-1843.13 8523.5,-1853.13 8530.5,-1853.13"/>
</g>
<!-- layer0_attn_out_6 -->
<g id="node36" class="node">
<title>layer0_attn_out_6</title>
<polygon fill="lightblue" stroke="black" points="8804.5,-1739 8195.5,-1739 8195.5,-1671 8804.5,-1671 8804.5,-1739"/>
<text text-anchor="middle" x="8500" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 6</text>
<text text-anchor="middle" x="8500" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="8500" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8500" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_6&#45;&gt;layer0_attn_out_6 -->
<g id="edge35" class="edge">
<title>layer0_attn_weighted_6&#45;&gt;layer0_attn_out_6</title>
<path fill="none" stroke="black" d="M8500,-1774.95C8500,-1774.95 8500,-1749.13 8500,-1749.13"/>
<polygon fill="black" stroke="black" points="8503.5,-1749.13 8500,-1739.13 8496.5,-1749.13 8503.5,-1749.13"/>
</g>
<!-- layer0_attn_out_6&#45;&gt;layer0_attn_aggregate -->
<g id="edge36" class="edge">
<title>layer0_attn_out_6&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M8300.75,-1670.89C8300.75,-1630.02 8300.75,-1567 8300.75,-1567 8300.75,-1567 6962.97,-1567 6962.97,-1567"/>
<polygon fill="black" stroke="black" points="6962.97,-1563.5 6952.97,-1567 6962.97,-1570.5 6962.97,-1563.5"/>
</g>
<!-- layer0_attn_scores_7 -->
<g id="node38" class="node">
<title>layer0_attn_scores_7</title>
<polygon fill="lightblue" stroke="black" points="9625,-1947 9113,-1947 9113,-1879 9625,-1879 9625,-1947"/>
<text text-anchor="middle" x="9369" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 7</text>
<text text-anchor="middle" x="9369" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="9369" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9369" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_7&#45;&gt;layer0_attn_scores_7 -->
<g id="edge38" class="edge">
<title>layer0_attn_qkv_7&#45;&gt;layer0_attn_scores_7</title>
<path fill="none" stroke="black" d="M9369,-1982.95C9369,-1982.95 9369,-1957.13 9369,-1957.13"/>
<polygon fill="black" stroke="black" points="9372.5,-1957.13 9369,-1947.13 9365.5,-1957.13 9372.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_7 -->
<g id="node39" class="node">
<title>layer0_attn_weighted_7</title>
<polygon fill="lightblue" stroke="black" points="9795,-1843 8989,-1843 8989,-1775 9795,-1775 9795,-1843"/>
<text text-anchor="middle" x="9392" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 7</text>
<text text-anchor="middle" x="9392" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="9392" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="9392" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_7&#45;&gt;layer0_attn_weighted_7 -->
<g id="edge39" class="edge">
<title>layer0_attn_scores_7&#45;&gt;layer0_attn_weighted_7</title>
<path fill="none" stroke="black" d="M9369,-1878.95C9369,-1878.95 9369,-1853.13 9369,-1853.13"/>
<polygon fill="black" stroke="black" points="9372.5,-1853.13 9369,-1843.13 9365.5,-1853.13 9372.5,-1853.13"/>
</g>
<!-- layer0_attn_out_7 -->
<g id="node40" class="node">
<title>layer0_attn_out_7</title>
<polygon fill="lightblue" stroke="black" points="9646.5,-1739 9037.5,-1739 9037.5,-1671 9646.5,-1671 9646.5,-1739"/>
<text text-anchor="middle" x="9342" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 7</text>
<text text-anchor="middle" x="9342" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="9342" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9342" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_7&#45;&gt;layer0_attn_out_7 -->
<g id="edge40" class="edge">
<title>layer0_attn_weighted_7&#45;&gt;layer0_attn_out_7</title>
<path fill="none" stroke="black" d="M9342,-1774.95C9342,-1774.95 9342,-1749.13 9342,-1749.13"/>
<polygon fill="black" stroke="black" points="9345.5,-1749.13 9342,-1739.13 9338.5,-1749.13 9345.5,-1749.13"/>
</g>
<!-- layer0_attn_out_7&#45;&gt;layer0_attn_aggregate -->
<g id="edge41" class="edge">
<title>layer0_attn_out_7&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M9063.98,-1670.61C9063.98,-1620.41 9063.98,-1533 9063.98,-1533 9063.98,-1533 6894.71,-1533 6894.71,-1533"/>
<polygon fill="black" stroke="black" points="6894.71,-1529.5 6884.71,-1533 6894.71,-1536.5 6894.71,-1529.5"/>
</g>
<!-- layer0_attn_aggregate&#45;&gt;recv_from_pool -->
<g id="edge42" class="edge">
<title>layer0_attn_aggregate&#45;&gt;recv_from_pool</title>
<path fill="none" stroke="black" d="M6420,-1498.53C6420,-1498.53 6420,-1473.24 6420,-1473.24"/>
<polygon fill="black" stroke="black" points="6423.5,-1473.24 6420,-1463.24 6416.5,-1473.24 6423.5,-1473.24"/>
</g>
<!-- layer1_attn_qkv_0 -->
<g id="node43" class="node">
<title>layer1_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="2457,-792 1861,-792 1861,-724 2457,-724 2457,-792"/>
<text text-anchor="middle" x="2159" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 0</text>
<text text-anchor="middle" x="2159" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2159" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="2159" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_0 -->
<g id="edge46" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_0</title>
<path fill="none" stroke="black" d="M3258.51,-895C2788.7,-895 2159,-895 2159,-895 2159,-895 2159,-802.22 2159,-802.22"/>
<polygon fill="black" stroke="black" points="2162.5,-802.22 2159,-792.22 2155.5,-802.22 2162.5,-802.22"/>
</g>
<!-- layer1_attn_qkv_1 -->
<g id="node47" class="node">
<title>layer1_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="3276.5,-792 2653.5,-792 2653.5,-724 3276.5,-724 3276.5,-792"/>
<text text-anchor="middle" x="2965" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 1</text>
<text text-anchor="middle" x="2965" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2965" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="2965" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_1 -->
<g id="edge51" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_1</title>
<path fill="none" stroke="black" d="M3238.83,-928.88C3238.83,-928.88 3238.83,-802.06 3238.83,-802.06"/>
<polygon fill="black" stroke="black" points="3242.33,-802.06 3238.83,-792.06 3235.33,-802.06 3242.33,-802.06"/>
</g>
<!-- layer1_attn_qkv_2 -->
<g id="node51" class="node">
<title>layer1_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="4072.5,-792 3449.5,-792 3449.5,-724 4072.5,-724 4072.5,-792"/>
<text text-anchor="middle" x="3761" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 2</text>
<text text-anchor="middle" x="3761" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="3761" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="3761" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_2 -->
<g id="edge56" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_2</title>
<path fill="none" stroke="black" d="M3761,-860.92C3761,-860.92 3761,-802.04 3761,-802.04"/>
<polygon fill="black" stroke="black" points="3764.5,-802.04 3761,-792.04 3757.5,-802.04 3764.5,-802.04"/>
</g>
<!-- layer1_attn_qkv_3 -->
<g id="node55" class="node">
<title>layer1_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="4868.5,-792 4245.5,-792 4245.5,-724 4868.5,-724 4868.5,-792"/>
<text text-anchor="middle" x="4557" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 3</text>
<text text-anchor="middle" x="4557" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4557" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4557" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_3 -->
<g id="edge61" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_3</title>
<path fill="none" stroke="black" d="M4283.17,-928.88C4283.17,-928.88 4283.17,-802.06 4283.17,-802.06"/>
<polygon fill="black" stroke="black" points="4286.67,-802.06 4283.17,-792.06 4279.67,-802.06 4286.67,-802.06"/>
</g>
<!-- layer1_attn_qkv_4 -->
<g id="node59" class="node">
<title>layer1_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="5710.5,-792 5087.5,-792 5087.5,-724 5710.5,-724 5710.5,-792"/>
<text text-anchor="middle" x="5399" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 4</text>
<text text-anchor="middle" x="5399" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="5399" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="5399" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_4 -->
<g id="edge66" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_4</title>
<path fill="none" stroke="black" d="M4110.41,-872C4567.68,-872 5311.5,-872 5311.5,-872 5311.5,-872 5311.5,-802.2 5311.5,-802.2"/>
<polygon fill="black" stroke="black" points="5315,-802.2 5311.5,-792.2 5308,-802.2 5315,-802.2"/>
</g>
<!-- layer1_attn_qkv_5 -->
<g id="node63" class="node">
<title>layer1_attn_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="6552.5,-792 5929.5,-792 5929.5,-724 6552.5,-724 6552.5,-792"/>
<text text-anchor="middle" x="6241" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 5</text>
<text text-anchor="middle" x="6241" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="6241" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6241" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_5 -->
<g id="edge71" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_5</title>
<path fill="none" stroke="black" d="M4129.02,-883C4773.76,-883 6039.75,-883 6039.75,-883 6039.75,-883 6039.75,-802.16 6039.75,-802.16"/>
<polygon fill="black" stroke="black" points="6043.25,-802.16 6039.75,-792.16 6036.25,-802.16 6043.25,-802.16"/>
</g>
<!-- layer1_attn_qkv_6 -->
<g id="node67" class="node">
<title>layer1_attn_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="799.5,-792 176.5,-792 176.5,-724 799.5,-724 799.5,-792"/>
<text text-anchor="middle" x="488" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 6</text>
<text text-anchor="middle" x="488" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="488" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="488" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_6 -->
<g id="edge76" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_6</title>
<path fill="none" stroke="black" d="M3372.69,-963C2505.71,-963 488,-963 488,-963 488,-963 488,-802.31 488,-802.31"/>
<polygon fill="black" stroke="black" points="491.5,-802.31 488,-792.31 484.5,-802.31 491.5,-802.31"/>
</g>
<!-- layer1_attn_qkv_7 -->
<g id="node71" class="node">
<title>layer1_attn_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="1618.5,-792 995.5,-792 995.5,-724 1618.5,-724 1618.5,-792"/>
<text text-anchor="middle" x="1307" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 7</text>
<text text-anchor="middle" x="1307" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="1307" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="1307" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_7 -->
<g id="edge81" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_7</title>
<path fill="none" stroke="black" d="M3315.53,-929C2608.11,-929 1307,-929 1307,-929 1307,-929 1307,-802.19 1307,-802.19"/>
<polygon fill="black" stroke="black" points="1310.5,-802.19 1307,-792.19 1303.5,-802.19 1310.5,-802.19"/>
</g>
<!-- layer1_attn_scores_0 -->
<g id="node44" class="node">
<title>layer1_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="2355.5,-688 1870.5,-688 1870.5,-620 2355.5,-620 2355.5,-688"/>
<text text-anchor="middle" x="2113" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 0</text>
<text text-anchor="middle" x="2113" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2113" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2113" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_0&#45;&gt;layer1_attn_scores_0 -->
<g id="edge47" class="edge">
<title>layer1_attn_qkv_0&#45;&gt;layer1_attn_scores_0</title>
<path fill="none" stroke="black" d="M2113,-723.95C2113,-723.95 2113,-698.13 2113,-698.13"/>
<polygon fill="black" stroke="black" points="2116.5,-698.13 2113,-688.13 2109.5,-698.13 2116.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_0 -->
<g id="node45" class="node">
<title>layer1_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="2479.5,-584 1700.5,-584 1700.5,-516 2479.5,-516 2479.5,-584"/>
<text text-anchor="middle" x="2090" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 0</text>
<text text-anchor="middle" x="2090" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2090" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="2090" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_0&#45;&gt;layer1_attn_weighted_0 -->
<g id="edge48" class="edge">
<title>layer1_attn_scores_0&#45;&gt;layer1_attn_weighted_0</title>
<path fill="none" stroke="black" d="M2113,-619.95C2113,-619.95 2113,-594.13 2113,-594.13"/>
<polygon fill="black" stroke="black" points="2116.5,-594.13 2113,-584.13 2109.5,-594.13 2116.5,-594.13"/>
</g>
<!-- layer1_attn_out_0 -->
<g id="node46" class="node">
<title>layer1_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="2430,-446 1848,-446 1848,-378 2430,-378 2430,-446"/>
<text text-anchor="middle" x="2139" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 0</text>
<text text-anchor="middle" x="2139" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="2139" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2139" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_0&#45;&gt;layer1_attn_out_0 -->
<g id="edge49" class="edge">
<title>layer1_attn_weighted_0&#45;&gt;layer1_attn_out_0</title>
<path fill="none" stroke="black" d="M2139,-515.89C2139,-515.89 2139,-456.2 2139,-456.2"/>
<polygon fill="black" stroke="black" points="2142.5,-456.2 2139,-446.2 2135.5,-456.2 2142.5,-456.2"/>
</g>
<!-- layer1_attn_aggregate -->
<g id="node75" class="node">
<title>layer1_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="4430.99,-308 3365.19,-308 3091.01,-172 4156.81,-172 4430.99,-308"/>
<text text-anchor="middle" x="3761" y="-258.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Aggregation</text>
<text text-anchor="middle" x="3761" y="-243.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="3761" y="-228.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="3761" y="-213.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_out_0&#45;&gt;layer1_attn_aggregate -->
<g id="edge50" class="edge">
<title>layer1_attn_out_0&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M2139,-377.89C2139,-337.02 2139,-274 2139,-274 2139,-274 3286.47,-274 3286.47,-274"/>
<polygon fill="black" stroke="black" points="3286.47,-277.5 3296.47,-274 3286.47,-270.5 3286.47,-277.5"/>
</g>
<!-- layer1_attn_scores_1 -->
<g id="node48" class="node">
<title>layer1_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="3198,-688 2686,-688 2686,-620 3198,-620 3198,-688"/>
<text text-anchor="middle" x="2942" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 1</text>
<text text-anchor="middle" x="2942" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2942" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2942" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_1&#45;&gt;layer1_attn_scores_1 -->
<g id="edge52" class="edge">
<title>layer1_attn_qkv_1&#45;&gt;layer1_attn_scores_1</title>
<path fill="none" stroke="black" d="M2942,-723.95C2942,-723.95 2942,-698.13 2942,-698.13"/>
<polygon fill="black" stroke="black" points="2945.5,-698.13 2942,-688.13 2938.5,-698.13 2945.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_1 -->
<g id="node49" class="node">
<title>layer1_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="3322,-584 2516,-584 2516,-516 3322,-516 3322,-584"/>
<text text-anchor="middle" x="2919" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 1</text>
<text text-anchor="middle" x="2919" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2919" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="2919" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_1&#45;&gt;layer1_attn_weighted_1 -->
<g id="edge53" class="edge">
<title>layer1_attn_scores_1&#45;&gt;layer1_attn_weighted_1</title>
<path fill="none" stroke="black" d="M2942,-619.95C2942,-619.95 2942,-594.13 2942,-594.13"/>
<polygon fill="black" stroke="black" points="2945.5,-594.13 2942,-584.13 2938.5,-594.13 2945.5,-594.13"/>
</g>
<!-- layer1_attn_out_1 -->
<g id="node50" class="node">
<title>layer1_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="3272.5,-446 2663.5,-446 2663.5,-378 3272.5,-378 3272.5,-446"/>
<text text-anchor="middle" x="2968" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 1</text>
<text text-anchor="middle" x="2968" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2968" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2968" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_1&#45;&gt;layer1_attn_out_1 -->
<g id="edge54" class="edge">
<title>layer1_attn_weighted_1&#45;&gt;layer1_attn_out_1</title>
<path fill="none" stroke="black" d="M2968,-515.89C2968,-515.89 2968,-456.2 2968,-456.2"/>
<polygon fill="black" stroke="black" points="2971.5,-456.2 2968,-446.2 2964.5,-456.2 2971.5,-456.2"/>
</g>
<!-- layer1_attn_out_1&#45;&gt;layer1_attn_aggregate -->
<g id="edge55" class="edge">
<title>layer1_attn_out_1&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M3181.88,-377.61C3181.88,-377.61 3181.88,-250.06 3181.88,-250.06"/>
<polygon fill="black" stroke="black" points="3185.38,-250.06 3181.88,-240.06 3178.38,-250.06 3185.38,-250.06"/>
</g>
<!-- layer1_attn_scores_2 -->
<g id="node52" class="node">
<title>layer1_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="4017,-688 3505,-688 3505,-620 4017,-620 4017,-688"/>
<text text-anchor="middle" x="3761" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 2</text>
<text text-anchor="middle" x="3761" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="3761" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3761" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_2&#45;&gt;layer1_attn_scores_2 -->
<g id="edge57" class="edge">
<title>layer1_attn_qkv_2&#45;&gt;layer1_attn_scores_2</title>
<path fill="none" stroke="black" d="M3761,-723.95C3761,-723.95 3761,-698.13 3761,-698.13"/>
<polygon fill="black" stroke="black" points="3764.5,-698.13 3761,-688.13 3757.5,-698.13 3764.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_2 -->
<g id="node53" class="node">
<title>layer1_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="4164,-584 3358,-584 3358,-516 4164,-516 4164,-584"/>
<text text-anchor="middle" x="3761" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 2</text>
<text text-anchor="middle" x="3761" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="3761" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="3761" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_2&#45;&gt;layer1_attn_weighted_2 -->
<g id="edge58" class="edge">
<title>layer1_attn_scores_2&#45;&gt;layer1_attn_weighted_2</title>
<path fill="none" stroke="black" d="M3761,-619.95C3761,-619.95 3761,-594.13 3761,-594.13"/>
<polygon fill="black" stroke="black" points="3764.5,-594.13 3761,-584.13 3757.5,-594.13 3764.5,-594.13"/>
</g>
<!-- layer1_attn_out_2 -->
<g id="node54" class="node">
<title>layer1_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="4065.5,-446 3456.5,-446 3456.5,-378 4065.5,-378 4065.5,-446"/>
<text text-anchor="middle" x="3761" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 2</text>
<text text-anchor="middle" x="3761" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="3761" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3761" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_2&#45;&gt;layer1_attn_out_2 -->
<g id="edge59" class="edge">
<title>layer1_attn_weighted_2&#45;&gt;layer1_attn_out_2</title>
<path fill="none" stroke="black" d="M3761,-515.89C3761,-515.89 3761,-456.2 3761,-456.2"/>
<polygon fill="black" stroke="black" points="3764.5,-456.2 3761,-446.2 3757.5,-456.2 3764.5,-456.2"/>
</g>
<!-- layer1_attn_out_2&#45;&gt;layer1_attn_aggregate -->
<g id="edge60" class="edge">
<title>layer1_attn_out_2&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M3761,-377.61C3761,-377.61 3761,-318.12 3761,-318.12"/>
<polygon fill="black" stroke="black" points="3764.5,-318.12 3761,-308.12 3757.5,-318.12 3764.5,-318.12"/>
</g>
<!-- layer1_attn_scores_3 -->
<g id="node56" class="node">
<title>layer1_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="4836,-688 4324,-688 4324,-620 4836,-620 4836,-688"/>
<text text-anchor="middle" x="4580" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 3</text>
<text text-anchor="middle" x="4580" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4580" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4580" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_3&#45;&gt;layer1_attn_scores_3 -->
<g id="edge62" class="edge">
<title>layer1_attn_qkv_3&#45;&gt;layer1_attn_scores_3</title>
<path fill="none" stroke="black" d="M4580,-723.95C4580,-723.95 4580,-698.13 4580,-698.13"/>
<polygon fill="black" stroke="black" points="4583.5,-698.13 4580,-688.13 4576.5,-698.13 4583.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_3 -->
<g id="node57" class="node">
<title>layer1_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="5006,-584 4200,-584 4200,-516 5006,-516 5006,-584"/>
<text text-anchor="middle" x="4603" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 3</text>
<text text-anchor="middle" x="4603" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4603" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="4603" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_3&#45;&gt;layer1_attn_weighted_3 -->
<g id="edge63" class="edge">
<title>layer1_attn_scores_3&#45;&gt;layer1_attn_weighted_3</title>
<path fill="none" stroke="black" d="M4580,-619.95C4580,-619.95 4580,-594.13 4580,-594.13"/>
<polygon fill="black" stroke="black" points="4583.5,-594.13 4580,-584.13 4576.5,-594.13 4583.5,-594.13"/>
</g>
<!-- layer1_attn_out_3 -->
<g id="node58" class="node">
<title>layer1_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="4857.5,-446 4248.5,-446 4248.5,-378 4857.5,-378 4857.5,-446"/>
<text text-anchor="middle" x="4553" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 3</text>
<text text-anchor="middle" x="4553" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="4553" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4553" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_3&#45;&gt;layer1_attn_out_3 -->
<g id="edge64" class="edge">
<title>layer1_attn_weighted_3&#45;&gt;layer1_attn_out_3</title>
<path fill="none" stroke="black" d="M4553,-515.89C4553,-515.89 4553,-456.2 4553,-456.2"/>
<polygon fill="black" stroke="black" points="4556.5,-456.2 4553,-446.2 4549.5,-456.2 4556.5,-456.2"/>
</g>
<!-- layer1_attn_out_3&#45;&gt;layer1_attn_aggregate -->
<g id="edge65" class="edge">
<title>layer1_attn_out_3&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M4339.62,-377.61C4339.62,-377.61 4339.62,-318.12 4339.62,-318.12"/>
<polygon fill="black" stroke="black" points="4343.12,-318.12 4339.62,-308.12 4336.12,-318.12 4343.12,-318.12"/>
</g>
<!-- layer1_attn_scores_4 -->
<g id="node60" class="node">
<title>layer1_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="5678,-688 5166,-688 5166,-620 5678,-620 5678,-688"/>
<text text-anchor="middle" x="5422" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 4</text>
<text text-anchor="middle" x="5422" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="5422" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5422" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_4&#45;&gt;layer1_attn_scores_4 -->
<g id="edge67" class="edge">
<title>layer1_attn_qkv_4&#45;&gt;layer1_attn_scores_4</title>
<path fill="none" stroke="black" d="M5422,-723.95C5422,-723.95 5422,-698.13 5422,-698.13"/>
<polygon fill="black" stroke="black" points="5425.5,-698.13 5422,-688.13 5418.5,-698.13 5425.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_4 -->
<g id="node61" class="node">
<title>layer1_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="5848,-584 5042,-584 5042,-516 5848,-516 5848,-584"/>
<text text-anchor="middle" x="5445" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 4</text>
<text text-anchor="middle" x="5445" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="5445" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="5445" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_4&#45;&gt;layer1_attn_weighted_4 -->
<g id="edge68" class="edge">
<title>layer1_attn_scores_4&#45;&gt;layer1_attn_weighted_4</title>
<path fill="none" stroke="black" d="M5422,-619.95C5422,-619.95 5422,-594.13 5422,-594.13"/>
<polygon fill="black" stroke="black" points="5425.5,-594.13 5422,-584.13 5418.5,-594.13 5425.5,-594.13"/>
</g>
<!-- layer1_attn_out_4 -->
<g id="node62" class="node">
<title>layer1_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="5699.5,-446 5090.5,-446 5090.5,-378 5699.5,-378 5699.5,-446"/>
<text text-anchor="middle" x="5395" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 4</text>
<text text-anchor="middle" x="5395" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="5395" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5395" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_4&#45;&gt;layer1_attn_out_4 -->
<g id="edge69" class="edge">
<title>layer1_attn_weighted_4&#45;&gt;layer1_attn_out_4</title>
<path fill="none" stroke="black" d="M5395,-515.89C5395,-515.89 5395,-456.2 5395,-456.2"/>
<polygon fill="black" stroke="black" points="5398.5,-456.2 5395,-446.2 5391.5,-456.2 5398.5,-456.2"/>
</g>
<!-- layer1_attn_out_4&#45;&gt;layer1_attn_aggregate -->
<g id="edge70" class="edge">
<title>layer1_attn_out_4&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M5496.5,-377.66C5496.5,-338.55 5496.5,-280 5496.5,-280 5496.5,-280 4384.7,-280 4384.7,-280"/>
<polygon fill="black" stroke="black" points="4384.7,-276.5 4374.7,-280 4384.7,-283.5 4384.7,-276.5"/>
</g>
<!-- layer1_attn_scores_5 -->
<g id="node64" class="node">
<title>layer1_attn_scores_5</title>
<polygon fill="lightblue" stroke="black" points="6520,-688 6008,-688 6008,-620 6520,-620 6520,-688"/>
<text text-anchor="middle" x="6264" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 5</text>
<text text-anchor="middle" x="6264" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="6264" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6264" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_5&#45;&gt;layer1_attn_scores_5 -->
<g id="edge72" class="edge">
<title>layer1_attn_qkv_5&#45;&gt;layer1_attn_scores_5</title>
<path fill="none" stroke="black" d="M6264,-723.95C6264,-723.95 6264,-698.13 6264,-698.13"/>
<polygon fill="black" stroke="black" points="6267.5,-698.13 6264,-688.13 6260.5,-698.13 6267.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_5 -->
<g id="node65" class="node">
<title>layer1_attn_weighted_5</title>
<polygon fill="lightblue" stroke="black" points="6690,-584 5884,-584 5884,-516 6690,-516 6690,-584"/>
<text text-anchor="middle" x="6287" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 5</text>
<text text-anchor="middle" x="6287" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="6287" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="6287" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_5&#45;&gt;layer1_attn_weighted_5 -->
<g id="edge73" class="edge">
<title>layer1_attn_scores_5&#45;&gt;layer1_attn_weighted_5</title>
<path fill="none" stroke="black" d="M6264,-619.95C6264,-619.95 6264,-594.13 6264,-594.13"/>
<polygon fill="black" stroke="black" points="6267.5,-594.13 6264,-584.13 6260.5,-594.13 6267.5,-594.13"/>
</g>
<!-- layer1_attn_out_5 -->
<g id="node66" class="node">
<title>layer1_attn_out_5</title>
<polygon fill="lightblue" stroke="black" points="6541.5,-446 5932.5,-446 5932.5,-378 6541.5,-378 6541.5,-446"/>
<text text-anchor="middle" x="6237" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 5</text>
<text text-anchor="middle" x="6237" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="6237" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6237" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_5&#45;&gt;layer1_attn_out_5 -->
<g id="edge74" class="edge">
<title>layer1_attn_weighted_5&#45;&gt;layer1_attn_out_5</title>
<path fill="none" stroke="black" d="M6237,-515.89C6237,-515.89 6237,-456.2 6237,-456.2"/>
<polygon fill="black" stroke="black" points="6240.5,-456.2 6237,-446.2 6233.5,-456.2 6240.5,-456.2"/>
</g>
<!-- layer1_attn_out_5&#45;&gt;layer1_attn_aggregate -->
<g id="edge75" class="edge">
<title>layer1_attn_out_5&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M6237,-377.89C6237,-331.17 6237,-253 6237,-253 6237,-253 4330.14,-253 4330.14,-253"/>
<polygon fill="black" stroke="black" points="4330.14,-249.5 4320.14,-253 4330.14,-256.5 4330.14,-249.5"/>
</g>
<!-- layer1_attn_scores_6 -->
<g id="node68" class="node">
<title>layer1_attn_scores_6</title>
<polygon fill="lightblue" stroke="black" points="698,-688 186,-688 186,-620 698,-620 698,-688"/>
<text text-anchor="middle" x="442" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 6</text>
<text text-anchor="middle" x="442" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="442" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="442" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_6&#45;&gt;layer1_attn_scores_6 -->
<g id="edge77" class="edge">
<title>layer1_attn_qkv_6&#45;&gt;layer1_attn_scores_6</title>
<path fill="none" stroke="black" d="M442,-723.95C442,-723.95 442,-698.13 442,-698.13"/>
<polygon fill="black" stroke="black" points="445.5,-698.13 442,-688.13 438.5,-698.13 445.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_6 -->
<g id="node69" class="node">
<title>layer1_attn_weighted_6</title>
<polygon fill="lightblue" stroke="black" points="822,-584 16,-584 16,-516 822,-516 822,-584"/>
<text text-anchor="middle" x="419" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 6</text>
<text text-anchor="middle" x="419" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="419" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="419" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_6&#45;&gt;layer1_attn_weighted_6 -->
<g id="edge78" class="edge">
<title>layer1_attn_scores_6&#45;&gt;layer1_attn_weighted_6</title>
<path fill="none" stroke="black" d="M442,-619.95C442,-619.95 442,-594.13 442,-594.13"/>
<polygon fill="black" stroke="black" points="445.5,-594.13 442,-584.13 438.5,-594.13 445.5,-594.13"/>
</g>
<!-- layer1_attn_out_6 -->
<g id="node70" class="node">
<title>layer1_attn_out_6</title>
<polygon fill="lightblue" stroke="black" points="772.5,-446 163.5,-446 163.5,-378 772.5,-378 772.5,-446"/>
<text text-anchor="middle" x="468" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 6</text>
<text text-anchor="middle" x="468" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="468" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="468" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_6&#45;&gt;layer1_attn_out_6 -->
<g id="edge79" class="edge">
<title>layer1_attn_weighted_6&#45;&gt;layer1_attn_out_6</title>
<path fill="none" stroke="black" d="M468,-515.89C468,-515.89 468,-456.2 468,-456.2"/>
<polygon fill="black" stroke="black" points="471.5,-456.2 468,-446.2 464.5,-456.2 471.5,-456.2"/>
</g>
<!-- layer1_attn_out_6&#45;&gt;layer1_attn_aggregate -->
<g id="edge80" class="edge">
<title>layer1_attn_out_6&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M468,-377.98C468,-319.47 468,-206 468,-206 468,-206 3149.41,-206 3149.41,-206"/>
<polygon fill="black" stroke="black" points="3149.41,-209.5 3159.41,-206 3149.41,-202.5 3149.41,-209.5"/>
</g>
<!-- layer1_attn_scores_7 -->
<g id="node72" class="node">
<title>layer1_attn_scores_7</title>
<polygon fill="lightblue" stroke="black" points="1540,-688 1028,-688 1028,-620 1540,-620 1540,-688"/>
<text text-anchor="middle" x="1284" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 7</text>
<text text-anchor="middle" x="1284" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="1284" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1284" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_7&#45;&gt;layer1_attn_scores_7 -->
<g id="edge82" class="edge">
<title>layer1_attn_qkv_7&#45;&gt;layer1_attn_scores_7</title>
<path fill="none" stroke="black" d="M1284,-723.95C1284,-723.95 1284,-698.13 1284,-698.13"/>
<polygon fill="black" stroke="black" points="1287.5,-698.13 1284,-688.13 1280.5,-698.13 1287.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_7 -->
<g id="node73" class="node">
<title>layer1_attn_weighted_7</title>
<polygon fill="lightblue" stroke="black" points="1664,-584 858,-584 858,-516 1664,-516 1664,-584"/>
<text text-anchor="middle" x="1261" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 7</text>
<text text-anchor="middle" x="1261" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="1261" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="1261" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_7&#45;&gt;layer1_attn_weighted_7 -->
<g id="edge83" class="edge">
<title>layer1_attn_scores_7&#45;&gt;layer1_attn_weighted_7</title>
<path fill="none" stroke="black" d="M1284,-619.95C1284,-619.95 1284,-594.13 1284,-594.13"/>
<polygon fill="black" stroke="black" points="1287.5,-594.13 1284,-584.13 1280.5,-594.13 1287.5,-594.13"/>
</g>
<!-- layer1_attn_out_7 -->
<g id="node74" class="node">
<title>layer1_attn_out_7</title>
<polygon fill="lightblue" stroke="black" points="1614.5,-446 1005.5,-446 1005.5,-378 1614.5,-378 1614.5,-446"/>
<text text-anchor="middle" x="1310" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 7</text>
<text text-anchor="middle" x="1310" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="1310" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1310" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_7&#45;&gt;layer1_attn_out_7 -->
<g id="edge84" class="edge">
<title>layer1_attn_weighted_7&#45;&gt;layer1_attn_out_7</title>
<path fill="none" stroke="black" d="M1310,-515.89C1310,-515.89 1310,-456.2 1310,-456.2"/>
<polygon fill="black" stroke="black" points="1313.5,-456.2 1310,-446.2 1306.5,-456.2 1313.5,-456.2"/>
</g>
<!-- layer1_attn_out_7&#45;&gt;layer1_attn_aggregate -->
<g id="edge85" class="edge">
<title>layer1_attn_out_7&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M1310,-377.61C1310,-327.41 1310,-240 1310,-240 1310,-240 3218.04,-240 3218.04,-240"/>
<polygon fill="black" stroke="black" points="3218.04,-243.5 3228.04,-240 3218.04,-236.5 3218.04,-243.5"/>
</g>
<!-- recv_from_pool_1 -->
<g id="node76" class="node">
<title>recv_from_pool_1</title>
<polygon fill="yellow" stroke="black" points="12596.69,-136 11706.35,-136 11477.31,0 12367.65,0 12596.69,-136"/>
<text text-anchor="middle" x="12037" y="-86.8" font-family="Times,serif" font-size="14.00">Receive Layer 1 from Pool</text>
<text text-anchor="middle" x="12037" y="-71.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15] → [0&#45;7]</text>
<text text-anchor="middle" x="12037" y="-56.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="12037" y="-41.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_aggregate&#45;&gt;recv_from_pool_1 -->
<g id="edge86" class="edge">
<title>layer1_attn_aggregate&#45;&gt;recv_from_pool_1</title>
<path fill="none" stroke="black" d="M4265.72,-226C4712.28,-226 5293.5,-226 5293.5,-226 5293.5,-226 5293.5,-68 5293.5,-68 5293.5,-68 11581.61,-68 11581.61,-68"/>
<polygon fill="black" stroke="black" points="11581.61,-71.5 11591.61,-68 11581.61,-64.5 11581.61,-71.5"/>
</g>
<!-- recv_from_pool_1&#45;&gt;layer2_ffn_start -->
<g id="edge87" class="edge">
<title>recv_from_pool_1&#45;&gt;layer2_ffn_start</title>
<path fill="none" stroke="black" d="M11808,-136.02C11808,-385.94 11808,-1239 11808,-1239 11808,-1239 8416.01,-1239 8416.01,-1239"/>
<polygon fill="black" stroke="black" points="8416.01,-1235.5 8406.01,-1239 8416.01,-1242.5 8416.01,-1235.5"/>
</g>
<!-- layer2_attn_qkv_0 -->
<g id="node78" class="node">
<title>layer2_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="8376,-963 7780,-963 7780,-895 8376,-895 8376,-963"/>
<text text-anchor="middle" x="8078" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 0</text>
<text text-anchor="middle" x="8078" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8078" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="8078" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_0 -->
<g id="edge89" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_0</title>
<path fill="none" stroke="black" d="M9153.3,-1039C8696.51,-1039 8121,-1039 8121,-1039 8121,-1039 8121,-973.2 8121,-973.2"/>
<polygon fill="black" stroke="black" points="8124.5,-973.2 8121,-963.2 8117.5,-973.2 8124.5,-973.2"/>
</g>
<!-- layer2_attn_qkv_1 -->
<g id="node82" class="node">
<title>layer2_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="9218.5,-963 8595.5,-963 8595.5,-895 9218.5,-895 9218.5,-963"/>
<text text-anchor="middle" x="8907" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 1</text>
<text text-anchor="middle" x="8907" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="8907" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="8907" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_1 -->
<g id="edge94" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_1</title>
<path fill="none" stroke="black" d="M9180.83,-1100.88C9180.83,-1100.88 9180.83,-973.26 9180.83,-973.26"/>
<polygon fill="black" stroke="black" points="9184.33,-973.26 9180.83,-963.26 9177.33,-973.26 9184.33,-973.26"/>
</g>
<!-- layer2_attn_qkv_2 -->
<g id="node86" class="node">
<title>layer2_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="10014.5,-963 9391.5,-963 9391.5,-895 10014.5,-895 10014.5,-963"/>
<text text-anchor="middle" x="9703" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 2</text>
<text text-anchor="middle" x="9703" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9703" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="9703" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_2 -->
<g id="edge99" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_2</title>
<path fill="none" stroke="black" d="M9703,-1032.53C9703,-1032.53 9703,-973.24 9703,-973.24"/>
<polygon fill="black" stroke="black" points="9706.5,-973.24 9703,-963.24 9699.5,-973.24 9706.5,-973.24"/>
</g>
<!-- layer2_attn_qkv_3 -->
<g id="node90" class="node">
<title>layer2_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="10810.5,-963 10187.5,-963 10187.5,-895 10810.5,-895 10810.5,-963"/>
<text text-anchor="middle" x="10499" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 3</text>
<text text-anchor="middle" x="10499" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10499" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="10499" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_3 -->
<g id="edge104" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_3</title>
<path fill="none" stroke="black" d="M10225.17,-1100.88C10225.17,-1100.88 10225.17,-973.26 10225.17,-973.26"/>
<polygon fill="black" stroke="black" points="10228.67,-973.26 10225.17,-963.26 10221.67,-973.26 10228.67,-973.26"/>
</g>
<!-- layer2_attn_qkv_4 -->
<g id="node94" class="node">
<title>layer2_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="11652.5,-963 11029.5,-963 11029.5,-895 11652.5,-895 11652.5,-963"/>
<text text-anchor="middle" x="11341" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 4</text>
<text text-anchor="middle" x="11341" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11341" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="11341" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_4 -->
<g id="edge109" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_4</title>
<path fill="none" stroke="black" d="M10109.48,-1078C10594.58,-1078 11341,-1078 11341,-1078 11341,-1078 11341,-973.18 11341,-973.18"/>
<polygon fill="black" stroke="black" points="11344.5,-973.18 11341,-963.18 11337.5,-973.18 11344.5,-973.18"/>
</g>
<!-- layer2_attn_qkv_5 -->
<g id="node98" class="node">
<title>layer2_attn_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="12494.5,-963 11871.5,-963 11871.5,-895 12494.5,-895 12494.5,-963"/>
<text text-anchor="middle" x="12183" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 5</text>
<text text-anchor="middle" x="12183" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12183" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="12183" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_5 -->
<g id="edge114" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_5</title>
<path fill="none" stroke="black" d="M10185.58,-1123C10907.04,-1123 12183,-1123 12183,-1123 12183,-1123 12183,-973.24 12183,-973.24"/>
<polygon fill="black" stroke="black" points="12186.5,-973.24 12183,-963.24 12179.5,-973.24 12186.5,-973.24"/>
</g>
<!-- layer2_attn_qkv_6 -->
<g id="node102" class="node">
<title>layer2_attn_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="13336.5,-963 12713.5,-963 12713.5,-895 13336.5,-895 13336.5,-963"/>
<text text-anchor="middle" x="13025" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 6</text>
<text text-anchor="middle" x="13025" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13025" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="13025" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_6 -->
<g id="edge119" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_6</title>
<path fill="none" stroke="black" d="M10224.35,-1146C11159.42,-1146 13025,-1146 13025,-1146 13025,-1146 13025,-973.38 13025,-973.38"/>
<polygon fill="black" stroke="black" points="13028.5,-973.38 13025,-963.38 13021.5,-973.38 13028.5,-973.38"/>
</g>
<!-- layer2_attn_qkv_7 -->
<g id="node106" class="node">
<title>layer2_attn_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="7560.5,-963 6937.5,-963 6937.5,-895 7560.5,-895 7560.5,-963"/>
<text text-anchor="middle" x="7249" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 7</text>
<text text-anchor="middle" x="7249" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="7249" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7249" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_7 -->
<g id="edge124" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_7</title>
<path fill="none" stroke="black" d="M9164.99,-1046C8493.22,-1046 7431.25,-1046 7431.25,-1046 7431.25,-1046 7431.25,-973.16 7431.25,-973.16"/>
<polygon fill="black" stroke="black" points="7434.75,-973.16 7431.25,-963.16 7427.75,-973.16 7434.75,-973.16"/>
</g>
<!-- layer2_attn_scores_0 -->
<g id="node79" class="node">
<title>layer2_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="8297.5,-792 7812.5,-792 7812.5,-724 8297.5,-724 8297.5,-792"/>
<text text-anchor="middle" x="8055" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 0</text>
<text text-anchor="middle" x="8055" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8055" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8055" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_0&#45;&gt;layer2_attn_scores_0 -->
<g id="edge90" class="edge">
<title>layer2_attn_qkv_0&#45;&gt;layer2_attn_scores_0</title>
<path fill="none" stroke="black" d="M8055,-894.81C8055,-894.81 8055,-802.13 8055,-802.13"/>
<polygon fill="black" stroke="black" points="8058.5,-802.13 8055,-792.13 8051.5,-802.13 8058.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_0 -->
<g id="node80" class="node">
<title>layer2_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="8421.5,-688 7642.5,-688 7642.5,-620 8421.5,-620 8421.5,-688"/>
<text text-anchor="middle" x="8032" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 0</text>
<text text-anchor="middle" x="8032" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8032" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="8032" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_0&#45;&gt;layer2_attn_weighted_0 -->
<g id="edge91" class="edge">
<title>layer2_attn_scores_0&#45;&gt;layer2_attn_weighted_0</title>
<path fill="none" stroke="black" d="M8055,-723.95C8055,-723.95 8055,-698.13 8055,-698.13"/>
<polygon fill="black" stroke="black" points="8058.5,-698.13 8055,-688.13 8051.5,-698.13 8058.5,-698.13"/>
</g>
<!-- layer2_attn_out_0 -->
<g id="node81" class="node">
<title>layer2_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="8373,-584 7791,-584 7791,-516 8373,-516 8373,-584"/>
<text text-anchor="middle" x="8082" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 0</text>
<text text-anchor="middle" x="8082" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8082" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8082" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_0&#45;&gt;layer2_attn_out_0 -->
<g id="edge92" class="edge">
<title>layer2_attn_weighted_0&#45;&gt;layer2_attn_out_0</title>
<path fill="none" stroke="black" d="M8082,-619.95C8082,-619.95 8082,-594.13 8082,-594.13"/>
<polygon fill="black" stroke="black" points="8085.5,-594.13 8082,-584.13 8078.5,-594.13 8085.5,-594.13"/>
</g>
<!-- layer2_attn_aggregate -->
<g id="node110" class="node">
<title>layer2_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="10372.99,-480 9307.19,-480 9033.01,-344 10098.81,-344 10372.99,-480"/>
<text text-anchor="middle" x="9703" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Aggregation</text>
<text text-anchor="middle" x="9703" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="9703" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="9703" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_out_0&#45;&gt;layer2_attn_aggregate -->
<g id="edge93" class="edge">
<title>layer2_attn_out_0&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M8082,-515.7C8082,-493.23 8082,-468 8082,-468 8082,-468 9272.92,-468 9272.92,-468"/>
<polygon fill="black" stroke="black" points="9272.92,-471.5 9282.92,-468 9272.92,-464.5 9272.92,-471.5"/>
</g>
<!-- layer2_attn_scores_1 -->
<g id="node83" class="node">
<title>layer2_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="9140,-792 8628,-792 8628,-724 9140,-724 9140,-792"/>
<text text-anchor="middle" x="8884" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 1</text>
<text text-anchor="middle" x="8884" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="8884" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8884" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_1&#45;&gt;layer2_attn_scores_1 -->
<g id="edge95" class="edge">
<title>layer2_attn_qkv_1&#45;&gt;layer2_attn_scores_1</title>
<path fill="none" stroke="black" d="M8884,-894.81C8884,-894.81 8884,-802.13 8884,-802.13"/>
<polygon fill="black" stroke="black" points="8887.5,-802.13 8884,-792.13 8880.5,-802.13 8887.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_1 -->
<g id="node84" class="node">
<title>layer2_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="9264,-688 8458,-688 8458,-620 9264,-620 9264,-688"/>
<text text-anchor="middle" x="8861" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 1</text>
<text text-anchor="middle" x="8861" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="8861" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="8861" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_1&#45;&gt;layer2_attn_weighted_1 -->
<g id="edge96" class="edge">
<title>layer2_attn_scores_1&#45;&gt;layer2_attn_weighted_1</title>
<path fill="none" stroke="black" d="M8884,-723.95C8884,-723.95 8884,-698.13 8884,-698.13"/>
<polygon fill="black" stroke="black" points="8887.5,-698.13 8884,-688.13 8880.5,-698.13 8887.5,-698.13"/>
</g>
<!-- layer2_attn_out_1 -->
<g id="node85" class="node">
<title>layer2_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="9214.5,-584 8605.5,-584 8605.5,-516 9214.5,-516 9214.5,-584"/>
<text text-anchor="middle" x="8910" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 1</text>
<text text-anchor="middle" x="8910" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="8910" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8910" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_1&#45;&gt;layer2_attn_out_1 -->
<g id="edge97" class="edge">
<title>layer2_attn_weighted_1&#45;&gt;layer2_attn_out_1</title>
<path fill="none" stroke="black" d="M8910,-619.95C8910,-619.95 8910,-594.13 8910,-594.13"/>
<polygon fill="black" stroke="black" points="8913.5,-594.13 8910,-584.13 8906.5,-594.13 8913.5,-594.13"/>
</g>
<!-- layer2_attn_out_1&#45;&gt;layer2_attn_aggregate -->
<g id="edge98" class="edge">
<title>layer2_attn_out_1&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M9123.88,-515.89C9123.88,-515.89 9123.88,-422.05 9123.88,-422.05"/>
<polygon fill="black" stroke="black" points="9127.38,-422.05 9123.88,-412.05 9120.38,-422.05 9127.38,-422.05"/>
</g>
<!-- layer2_attn_scores_2 -->
<g id="node87" class="node">
<title>layer2_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="9959,-792 9447,-792 9447,-724 9959,-724 9959,-792"/>
<text text-anchor="middle" x="9703" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 2</text>
<text text-anchor="middle" x="9703" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9703" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9703" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_2&#45;&gt;layer2_attn_scores_2 -->
<g id="edge100" class="edge">
<title>layer2_attn_qkv_2&#45;&gt;layer2_attn_scores_2</title>
<path fill="none" stroke="black" d="M9703,-894.81C9703,-894.81 9703,-802.13 9703,-802.13"/>
<polygon fill="black" stroke="black" points="9706.5,-802.13 9703,-792.13 9699.5,-802.13 9706.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_2 -->
<g id="node88" class="node">
<title>layer2_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="10106,-688 9300,-688 9300,-620 10106,-620 10106,-688"/>
<text text-anchor="middle" x="9703" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 2</text>
<text text-anchor="middle" x="9703" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9703" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="9703" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_2&#45;&gt;layer2_attn_weighted_2 -->
<g id="edge101" class="edge">
<title>layer2_attn_scores_2&#45;&gt;layer2_attn_weighted_2</title>
<path fill="none" stroke="black" d="M9703,-723.95C9703,-723.95 9703,-698.13 9703,-698.13"/>
<polygon fill="black" stroke="black" points="9706.5,-698.13 9703,-688.13 9699.5,-698.13 9706.5,-698.13"/>
</g>
<!-- layer2_attn_out_2 -->
<g id="node89" class="node">
<title>layer2_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="10007.5,-584 9398.5,-584 9398.5,-516 10007.5,-516 10007.5,-584"/>
<text text-anchor="middle" x="9703" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 2</text>
<text text-anchor="middle" x="9703" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9703" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9703" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_2&#45;&gt;layer2_attn_out_2 -->
<g id="edge102" class="edge">
<title>layer2_attn_weighted_2&#45;&gt;layer2_attn_out_2</title>
<path fill="none" stroke="black" d="M9703,-619.95C9703,-619.95 9703,-594.13 9703,-594.13"/>
<polygon fill="black" stroke="black" points="9706.5,-594.13 9703,-584.13 9699.5,-594.13 9706.5,-594.13"/>
</g>
<!-- layer2_attn_out_2&#45;&gt;layer2_attn_aggregate -->
<g id="edge103" class="edge">
<title>layer2_attn_out_2&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M9703,-515.89C9703,-515.89 9703,-490.23 9703,-490.23"/>
<polygon fill="black" stroke="black" points="9706.5,-490.23 9703,-480.23 9699.5,-490.23 9706.5,-490.23"/>
</g>
<!-- layer2_attn_scores_3 -->
<g id="node91" class="node">
<title>layer2_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="10778,-792 10266,-792 10266,-724 10778,-724 10778,-792"/>
<text text-anchor="middle" x="10522" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 3</text>
<text text-anchor="middle" x="10522" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10522" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10522" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_3&#45;&gt;layer2_attn_scores_3 -->
<g id="edge105" class="edge">
<title>layer2_attn_qkv_3&#45;&gt;layer2_attn_scores_3</title>
<path fill="none" stroke="black" d="M10522,-894.81C10522,-894.81 10522,-802.13 10522,-802.13"/>
<polygon fill="black" stroke="black" points="10525.5,-802.13 10522,-792.13 10518.5,-802.13 10525.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_3 -->
<g id="node92" class="node">
<title>layer2_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="10948,-688 10142,-688 10142,-620 10948,-620 10948,-688"/>
<text text-anchor="middle" x="10545" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 3</text>
<text text-anchor="middle" x="10545" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10545" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="10545" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_3&#45;&gt;layer2_attn_weighted_3 -->
<g id="edge106" class="edge">
<title>layer2_attn_scores_3&#45;&gt;layer2_attn_weighted_3</title>
<path fill="none" stroke="black" d="M10522,-723.95C10522,-723.95 10522,-698.13 10522,-698.13"/>
<polygon fill="black" stroke="black" points="10525.5,-698.13 10522,-688.13 10518.5,-698.13 10525.5,-698.13"/>
</g>
<!-- layer2_attn_out_3 -->
<g id="node93" class="node">
<title>layer2_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="10799.5,-584 10190.5,-584 10190.5,-516 10799.5,-516 10799.5,-584"/>
<text text-anchor="middle" x="10495" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 3</text>
<text text-anchor="middle" x="10495" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10495" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10495" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_3&#45;&gt;layer2_attn_out_3 -->
<g id="edge107" class="edge">
<title>layer2_attn_weighted_3&#45;&gt;layer2_attn_out_3</title>
<path fill="none" stroke="black" d="M10495,-619.95C10495,-619.95 10495,-594.13 10495,-594.13"/>
<polygon fill="black" stroke="black" points="10498.5,-594.13 10495,-584.13 10491.5,-594.13 10498.5,-594.13"/>
</g>
<!-- layer2_attn_out_3&#45;&gt;layer2_attn_aggregate -->
<g id="edge108" class="edge">
<title>layer2_attn_out_3&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M10281.62,-515.89C10281.62,-515.89 10281.62,-490.23 10281.62,-490.23"/>
<polygon fill="black" stroke="black" points="10285.12,-490.23 10281.62,-480.23 10278.12,-490.23 10285.12,-490.23"/>
</g>
<!-- layer2_attn_scores_4 -->
<g id="node95" class="node">
<title>layer2_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="11620,-792 11108,-792 11108,-724 11620,-724 11620,-792"/>
<text text-anchor="middle" x="11364" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 4</text>
<text text-anchor="middle" x="11364" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11364" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11364" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_4&#45;&gt;layer2_attn_scores_4 -->
<g id="edge110" class="edge">
<title>layer2_attn_qkv_4&#45;&gt;layer2_attn_scores_4</title>
<path fill="none" stroke="black" d="M11364,-894.81C11364,-894.81 11364,-802.13 11364,-802.13"/>
<polygon fill="black" stroke="black" points="11367.5,-802.13 11364,-792.13 11360.5,-802.13 11367.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_4 -->
<g id="node96" class="node">
<title>layer2_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="11790,-688 10984,-688 10984,-620 11790,-620 11790,-688"/>
<text text-anchor="middle" x="11387" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 4</text>
<text text-anchor="middle" x="11387" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11387" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="11387" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_4&#45;&gt;layer2_attn_weighted_4 -->
<g id="edge111" class="edge">
<title>layer2_attn_scores_4&#45;&gt;layer2_attn_weighted_4</title>
<path fill="none" stroke="black" d="M11364,-723.95C11364,-723.95 11364,-698.13 11364,-698.13"/>
<polygon fill="black" stroke="black" points="11367.5,-698.13 11364,-688.13 11360.5,-698.13 11367.5,-698.13"/>
</g>
<!-- layer2_attn_out_4 -->
<g id="node97" class="node">
<title>layer2_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="11641.5,-584 11032.5,-584 11032.5,-516 11641.5,-516 11641.5,-584"/>
<text text-anchor="middle" x="11337" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 4</text>
<text text-anchor="middle" x="11337" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11337" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11337" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_4&#45;&gt;layer2_attn_out_4 -->
<g id="edge112" class="edge">
<title>layer2_attn_weighted_4&#45;&gt;layer2_attn_out_4</title>
<path fill="none" stroke="black" d="M11337,-619.95C11337,-619.95 11337,-594.13 11337,-594.13"/>
<polygon fill="black" stroke="black" points="11340.5,-594.13 11337,-584.13 11333.5,-594.13 11340.5,-594.13"/>
</g>
<!-- layer2_attn_out_4&#45;&gt;layer2_attn_aggregate -->
<g id="edge113" class="edge">
<title>layer2_attn_out_4&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M11254.83,-515.67C11254.83,-471.95 11254.83,-402 11254.83,-402 11254.83,-402 10225.97,-402 10225.97,-402"/>
<polygon fill="black" stroke="black" points="10225.97,-398.5 10215.97,-402 10225.96,-405.5 10225.97,-398.5"/>
</g>
<!-- layer2_attn_scores_5 -->
<g id="node99" class="node">
<title>layer2_attn_scores_5</title>
<polygon fill="lightblue" stroke="black" points="12462,-792 11950,-792 11950,-724 12462,-724 12462,-792"/>
<text text-anchor="middle" x="12206" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 5</text>
<text text-anchor="middle" x="12206" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12206" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12206" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_5&#45;&gt;layer2_attn_scores_5 -->
<g id="edge115" class="edge">
<title>layer2_attn_qkv_5&#45;&gt;layer2_attn_scores_5</title>
<path fill="none" stroke="black" d="M12206,-894.81C12206,-894.81 12206,-802.13 12206,-802.13"/>
<polygon fill="black" stroke="black" points="12209.5,-802.13 12206,-792.13 12202.5,-802.13 12209.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_5 -->
<g id="node100" class="node">
<title>layer2_attn_weighted_5</title>
<polygon fill="lightblue" stroke="black" points="12632,-688 11826,-688 11826,-620 12632,-620 12632,-688"/>
<text text-anchor="middle" x="12229" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 5</text>
<text text-anchor="middle" x="12229" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12229" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="12229" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_5&#45;&gt;layer2_attn_weighted_5 -->
<g id="edge116" class="edge">
<title>layer2_attn_scores_5&#45;&gt;layer2_attn_weighted_5</title>
<path fill="none" stroke="black" d="M12206,-723.95C12206,-723.95 12206,-698.13 12206,-698.13"/>
<polygon fill="black" stroke="black" points="12209.5,-698.13 12206,-688.13 12202.5,-698.13 12209.5,-698.13"/>
</g>
<!-- layer2_attn_out_5 -->
<g id="node101" class="node">
<title>layer2_attn_out_5</title>
<polygon fill="lightblue" stroke="black" points="12483.5,-584 11874.5,-584 11874.5,-516 12483.5,-516 12483.5,-584"/>
<text text-anchor="middle" x="12179" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 5</text>
<text text-anchor="middle" x="12179" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12179" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12179" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_5&#45;&gt;layer2_attn_out_5 -->
<g id="edge117" class="edge">
<title>layer2_attn_weighted_5&#45;&gt;layer2_attn_out_5</title>
<path fill="none" stroke="black" d="M12179,-619.95C12179,-619.95 12179,-594.13 12179,-594.13"/>
<polygon fill="black" stroke="black" points="12182.5,-594.13 12179,-584.13 12175.5,-594.13 12182.5,-594.13"/>
</g>
<!-- layer2_attn_out_5&#45;&gt;layer2_attn_aggregate -->
<g id="edge118" class="edge">
<title>layer2_attn_out_5&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M12179,-515.6C12179,-466.45 12179,-382 12179,-382 12179,-382 10185.64,-382 10185.64,-382"/>
<polygon fill="black" stroke="black" points="10185.64,-378.5 10175.64,-382 10185.64,-385.5 10185.64,-378.5"/>
</g>
<!-- layer2_attn_scores_6 -->
<g id="node103" class="node">
<title>layer2_attn_scores_6</title>
<polygon fill="lightblue" stroke="black" points="13304,-792 12792,-792 12792,-724 13304,-724 13304,-792"/>
<text text-anchor="middle" x="13048" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 6</text>
<text text-anchor="middle" x="13048" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13048" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13048" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_6&#45;&gt;layer2_attn_scores_6 -->
<g id="edge120" class="edge">
<title>layer2_attn_qkv_6&#45;&gt;layer2_attn_scores_6</title>
<path fill="none" stroke="black" d="M13048,-894.81C13048,-894.81 13048,-802.13 13048,-802.13"/>
<polygon fill="black" stroke="black" points="13051.5,-802.13 13048,-792.13 13044.5,-802.13 13051.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_6 -->
<g id="node104" class="node">
<title>layer2_attn_weighted_6</title>
<polygon fill="lightblue" stroke="black" points="13474,-688 12668,-688 12668,-620 13474,-620 13474,-688"/>
<text text-anchor="middle" x="13071" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 6</text>
<text text-anchor="middle" x="13071" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13071" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="13071" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_6&#45;&gt;layer2_attn_weighted_6 -->
<g id="edge121" class="edge">
<title>layer2_attn_scores_6&#45;&gt;layer2_attn_weighted_6</title>
<path fill="none" stroke="black" d="M13048,-723.95C13048,-723.95 13048,-698.13 13048,-698.13"/>
<polygon fill="black" stroke="black" points="13051.5,-698.13 13048,-688.13 13044.5,-698.13 13051.5,-698.13"/>
</g>
<!-- layer2_attn_out_6 -->
<g id="node105" class="node">
<title>layer2_attn_out_6</title>
<polygon fill="lightblue" stroke="black" points="13325.5,-584 12716.5,-584 12716.5,-516 13325.5,-516 13325.5,-584"/>
<text text-anchor="middle" x="13021" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 6</text>
<text text-anchor="middle" x="13021" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13021" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13021" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_6&#45;&gt;layer2_attn_out_6 -->
<g id="edge122" class="edge">
<title>layer2_attn_weighted_6&#45;&gt;layer2_attn_out_6</title>
<path fill="none" stroke="black" d="M13021,-619.95C13021,-619.95 13021,-594.13 13021,-594.13"/>
<polygon fill="black" stroke="black" points="13024.5,-594.13 13021,-584.13 13017.5,-594.13 13024.5,-594.13"/>
</g>
<!-- layer2_attn_out_6&#45;&gt;layer2_attn_aggregate -->
<g id="edge123" class="edge">
<title>layer2_attn_out_6&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M13021,-515.7C13021,-461.72 13021,-363 13021,-363 13021,-363 10147.2,-363 10147.2,-363"/>
<polygon fill="black" stroke="black" points="10147.2,-359.5 10137.2,-363 10147.2,-366.5 10147.2,-359.5"/>
</g>
<!-- layer2_attn_scores_7 -->
<g id="node107" class="node">
<title>layer2_attn_scores_7</title>
<polygon fill="lightblue" stroke="black" points="7482,-792 6970,-792 6970,-724 7482,-724 7482,-792"/>
<text text-anchor="middle" x="7226" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 7</text>
<text text-anchor="middle" x="7226" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="7226" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7226" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_7&#45;&gt;layer2_attn_scores_7 -->
<g id="edge125" class="edge">
<title>layer2_attn_qkv_7&#45;&gt;layer2_attn_scores_7</title>
<path fill="none" stroke="black" d="M7226,-894.81C7226,-894.81 7226,-802.13 7226,-802.13"/>
<polygon fill="black" stroke="black" points="7229.5,-802.13 7226,-792.13 7222.5,-802.13 7229.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_7 -->
<g id="node108" class="node">
<title>layer2_attn_weighted_7</title>
<polygon fill="lightblue" stroke="black" points="7606,-688 6800,-688 6800,-620 7606,-620 7606,-688"/>
<text text-anchor="middle" x="7203" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 7</text>
<text text-anchor="middle" x="7203" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="7203" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="7203" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_7&#45;&gt;layer2_attn_weighted_7 -->
<g id="edge126" class="edge">
<title>layer2_attn_scores_7&#45;&gt;layer2_attn_weighted_7</title>
<path fill="none" stroke="black" d="M7226,-723.95C7226,-723.95 7226,-698.13 7226,-698.13"/>
<polygon fill="black" stroke="black" points="7229.5,-698.13 7226,-688.13 7222.5,-698.13 7229.5,-698.13"/>
</g>
<!-- layer2_attn_out_7 -->
<g id="node109" class="node">
<title>layer2_attn_out_7</title>
<polygon fill="lightblue" stroke="black" points="7556.5,-584 6947.5,-584 6947.5,-516 7556.5,-516 7556.5,-584"/>
<text text-anchor="middle" x="7252" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 7</text>
<text text-anchor="middle" x="7252" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="7252" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7252" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_7&#45;&gt;layer2_attn_out_7 -->
<g id="edge127" class="edge">
<title>layer2_attn_weighted_7&#45;&gt;layer2_attn_out_7</title>
<path fill="none" stroke="black" d="M7252,-619.95C7252,-619.95 7252,-594.13 7252,-594.13"/>
<polygon fill="black" stroke="black" points="7255.5,-594.13 7252,-584.13 7248.5,-594.13 7255.5,-594.13"/>
</g>
<!-- layer2_attn_out_7&#45;&gt;layer2_attn_aggregate -->
<g id="edge128" class="edge">
<title>layer2_attn_out_7&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M7252,-515.9C7252,-489.36 7252,-457 7252,-457 7252,-457 9250.56,-457 9250.56,-457"/>
<polygon fill="black" stroke="black" points="9250.56,-460.5 9260.56,-457 9250.56,-453.5 9250.56,-460.5"/>
</g>
<!-- recv_from_pool_2 -->
<g id="node111" class="node">
<title>recv_from_pool_2</title>
<polygon fill="yellow" stroke="black" points="8783.69,-308 7893.35,-308 7664.31,-172 8554.65,-172 8783.69,-308"/>
<text text-anchor="middle" x="8224" y="-258.8" font-family="Times,serif" font-size="14.00">Receive Layer 2 from Pool</text>
<text text-anchor="middle" x="8224" y="-243.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15] → [0&#45;7]</text>
<text text-anchor="middle" x="8224" y="-228.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="8224" y="-213.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_aggregate&#45;&gt;recv_from_pool_2 -->
<g id="edge129" class="edge">
<title>layer2_attn_aggregate&#45;&gt;recv_from_pool_2</title>
<path fill="none" stroke="black" d="M9067.27,-361C8865.92,-361 8694.67,-361 8694.67,-361 8694.67,-361 8694.67,-318.28 8694.67,-318.28"/>
<polygon fill="black" stroke="black" points="8698.17,-318.28 8694.67,-308.28 8691.17,-318.28 8698.17,-318.28"/>
</g>
<!-- recv_from_pool_2&#45;&gt;layer3_ffn_start -->
<g id="edge130" class="edge">
<title>recv_from_pool_2&#45;&gt;layer3_ffn_start</title>
<path fill="none" stroke="black" d="M7709.68,-199C7288.92,-199 6763,-199 6763,-199 6763,-199 6763,-1194.99 6763,-1194.99"/>
<polygon fill="black" stroke="black" points="6759.5,-1194.99 6763,-1204.99 6766.5,-1194.99 6759.5,-1194.99"/>
</g>
<!-- layer3_attn_qkv_0 -->
<g id="node113" class="node">
<title>layer3_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="15109,-963 14513,-963 14513,-895 15109,-895 15109,-963"/>
<text text-anchor="middle" x="14811" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 0</text>
<text text-anchor="middle" x="14811" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14811" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="14811" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_0 -->
<g id="edge132" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_0</title>
<path fill="none" stroke="black" d="M15890.11,-1055C15422.68,-1055 14811,-1055 14811,-1055 14811,-1055 14811,-973.1 14811,-973.1"/>
<polygon fill="black" stroke="black" points="14814.5,-973.1 14811,-963.1 14807.5,-973.1 14814.5,-973.1"/>
</g>
<!-- layer3_attn_qkv_1 -->
<g id="node117" class="node">
<title>layer3_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="15928.5,-963 15305.5,-963 15305.5,-895 15928.5,-895 15928.5,-963"/>
<text text-anchor="middle" x="15617" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 1</text>
<text text-anchor="middle" x="15617" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15617" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="15617" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_1 -->
<g id="edge137" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_1</title>
<path fill="none" stroke="black" d="M15903.38,-1100.88C15903.38,-1100.88 15903.38,-973.26 15903.38,-973.26"/>
<polygon fill="black" stroke="black" points="15906.88,-973.26 15903.38,-963.26 15899.88,-973.26 15906.88,-973.26"/>
</g>
<!-- layer3_attn_qkv_2 -->
<g id="node121" class="node">
<title>layer3_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="16724.5,-963 16101.5,-963 16101.5,-895 16724.5,-895 16724.5,-963"/>
<text text-anchor="middle" x="16413" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 2</text>
<text text-anchor="middle" x="16413" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16413" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="16413" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_2 -->
<g id="edge142" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_2</title>
<path fill="none" stroke="black" d="M16413,-1032.53C16413,-1032.53 16413,-973.24 16413,-973.24"/>
<polygon fill="black" stroke="black" points="16416.5,-973.24 16413,-963.24 16409.5,-973.24 16416.5,-973.24"/>
</g>
<!-- layer3_attn_qkv_3 -->
<g id="node125" class="node">
<title>layer3_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="17520.5,-963 16897.5,-963 16897.5,-895 17520.5,-895 17520.5,-963"/>
<text text-anchor="middle" x="17209" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 3</text>
<text text-anchor="middle" x="17209" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="17209" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="17209" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_3 -->
<g id="edge147" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_3</title>
<path fill="none" stroke="black" d="M16935.17,-1100.88C16935.17,-1100.88 16935.17,-973.26 16935.17,-973.26"/>
<polygon fill="black" stroke="black" points="16938.67,-973.26 16935.17,-963.26 16931.67,-973.26 16938.67,-973.26"/>
</g>
<!-- layer3_attn_qkv_4 -->
<g id="node129" class="node">
<title>layer3_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="18362.5,-963 17739.5,-963 17739.5,-895 18362.5,-895 18362.5,-963"/>
<text text-anchor="middle" x="18051" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 4</text>
<text text-anchor="middle" x="18051" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="18051" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="18051" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_4 -->
<g id="edge152" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_4</title>
<path fill="none" stroke="black" d="M16800.92,-1067C17285.29,-1067 18051,-1067 18051,-1067 18051,-1067 18051,-973.11 18051,-973.11"/>
<polygon fill="black" stroke="black" points="18054.5,-973.11 18051,-963.11 18047.5,-973.11 18054.5,-973.11"/>
</g>
<!-- layer3_attn_qkv_5 -->
<g id="node133" class="node">
<title>layer3_attn_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="19204.5,-963 18581.5,-963 18581.5,-895 19204.5,-895 19204.5,-963"/>
<text text-anchor="middle" x="18893" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 5</text>
<text text-anchor="middle" x="18893" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="18893" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="18893" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_5 -->
<g id="edge157" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_5</title>
<path fill="none" stroke="black" d="M16858.52,-1101C17572.36,-1101 18893,-1101 18893,-1101 18893,-1101 18893,-973.39 18893,-973.39"/>
<polygon fill="black" stroke="black" points="18896.5,-973.39 18893,-963.39 18889.5,-973.39 18896.5,-973.39"/>
</g>
<!-- layer3_attn_qkv_6 -->
<g id="node137" class="node">
<title>layer3_attn_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="20046.5,-963 19423.5,-963 19423.5,-895 20046.5,-895 20046.5,-963"/>
<text text-anchor="middle" x="19735" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 6</text>
<text text-anchor="middle" x="19735" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="19735" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="19735" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_6 -->
<g id="edge162" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_6</title>
<path fill="none" stroke="black" d="M16915.74,-1135C17844.41,-1135 19735,-1135 19735,-1135 19735,-1135 19735,-973.02 19735,-973.02"/>
<polygon fill="black" stroke="black" points="19738.5,-973.02 19735,-963.02 19731.5,-973.02 19738.5,-973.02"/>
</g>
<!-- layer3_attn_qkv_7 -->
<g id="node141" class="node">
<title>layer3_attn_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="14270.5,-963 13647.5,-963 13647.5,-895 14270.5,-895 14270.5,-963"/>
<text text-anchor="middle" x="13959" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 7</text>
<text text-anchor="middle" x="13959" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="13959" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="13959" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_7 -->
<g id="edge167" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_7</title>
<path fill="none" stroke="black" d="M15967.53,-1101C15260.11,-1101 13959,-1101 13959,-1101 13959,-1101 13959,-973.39 13959,-973.39"/>
<polygon fill="black" stroke="black" points="13962.5,-973.39 13959,-963.39 13955.5,-973.39 13962.5,-973.39"/>
</g>
<!-- layer3_attn_scores_0 -->
<g id="node114" class="node">
<title>layer3_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="15007.5,-792 14522.5,-792 14522.5,-724 15007.5,-724 15007.5,-792"/>
<text text-anchor="middle" x="14765" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 0</text>
<text text-anchor="middle" x="14765" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14765" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14765" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_0&#45;&gt;layer3_attn_scores_0 -->
<g id="edge133" class="edge">
<title>layer3_attn_qkv_0&#45;&gt;layer3_attn_scores_0</title>
<path fill="none" stroke="black" d="M14765,-894.81C14765,-894.81 14765,-802.13 14765,-802.13"/>
<polygon fill="black" stroke="black" points="14768.5,-802.13 14765,-792.13 14761.5,-802.13 14768.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_0 -->
<g id="node115" class="node">
<title>layer3_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="15131.5,-688 14352.5,-688 14352.5,-620 15131.5,-620 15131.5,-688"/>
<text text-anchor="middle" x="14742" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 0</text>
<text text-anchor="middle" x="14742" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14742" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="14742" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_0&#45;&gt;layer3_attn_weighted_0 -->
<g id="edge134" class="edge">
<title>layer3_attn_scores_0&#45;&gt;layer3_attn_weighted_0</title>
<path fill="none" stroke="black" d="M14765,-723.95C14765,-723.95 14765,-698.13 14765,-698.13"/>
<polygon fill="black" stroke="black" points="14768.5,-698.13 14765,-688.13 14761.5,-698.13 14768.5,-698.13"/>
</g>
<!-- layer3_attn_out_0 -->
<g id="node116" class="node">
<title>layer3_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="15082,-584 14500,-584 14500,-516 15082,-516 15082,-584"/>
<text text-anchor="middle" x="14791" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 0</text>
<text text-anchor="middle" x="14791" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14791" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14791" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_0&#45;&gt;layer3_attn_out_0 -->
<g id="edge135" class="edge">
<title>layer3_attn_weighted_0&#45;&gt;layer3_attn_out_0</title>
<path fill="none" stroke="black" d="M14791,-619.95C14791,-619.95 14791,-594.13 14791,-594.13"/>
<polygon fill="black" stroke="black" points="14794.5,-594.13 14791,-584.13 14787.5,-594.13 14794.5,-594.13"/>
</g>
<!-- layer3_attn_aggregate -->
<g id="node145" class="node">
<title>layer3_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="17924.99,-480 16859.19,-480 16585.01,-344 17650.81,-344 17924.99,-480"/>
<text text-anchor="middle" x="17255" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Aggregation</text>
<text text-anchor="middle" x="17255" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="17255" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="17255" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_out_0&#45;&gt;layer3_attn_aggregate -->
<g id="edge136" class="edge">
<title>layer3_attn_out_0&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M14791,-515.81C14791,-483.84 14791,-441 14791,-441 14791,-441 16770.28,-441 16770.28,-441"/>
<polygon fill="black" stroke="black" points="16770.28,-444.5 16780.28,-441 16770.28,-437.5 16770.28,-444.5"/>
</g>
<!-- layer3_attn_scores_1 -->
<g id="node118" class="node">
<title>layer3_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="15850,-792 15338,-792 15338,-724 15850,-724 15850,-792"/>
<text text-anchor="middle" x="15594" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 1</text>
<text text-anchor="middle" x="15594" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15594" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15594" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_1&#45;&gt;layer3_attn_scores_1 -->
<g id="edge138" class="edge">
<title>layer3_attn_qkv_1&#45;&gt;layer3_attn_scores_1</title>
<path fill="none" stroke="black" d="M15594,-894.81C15594,-894.81 15594,-802.13 15594,-802.13"/>
<polygon fill="black" stroke="black" points="15597.5,-802.13 15594,-792.13 15590.5,-802.13 15597.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_1 -->
<g id="node119" class="node">
<title>layer3_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="15974,-688 15168,-688 15168,-620 15974,-620 15974,-688"/>
<text text-anchor="middle" x="15571" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 1</text>
<text text-anchor="middle" x="15571" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15571" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="15571" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_1&#45;&gt;layer3_attn_weighted_1 -->
<g id="edge139" class="edge">
<title>layer3_attn_scores_1&#45;&gt;layer3_attn_weighted_1</title>
<path fill="none" stroke="black" d="M15594,-723.95C15594,-723.95 15594,-698.13 15594,-698.13"/>
<polygon fill="black" stroke="black" points="15597.5,-698.13 15594,-688.13 15590.5,-698.13 15597.5,-698.13"/>
</g>
<!-- layer3_attn_out_1 -->
<g id="node120" class="node">
<title>layer3_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="15924.5,-584 15315.5,-584 15315.5,-516 15924.5,-516 15924.5,-584"/>
<text text-anchor="middle" x="15620" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 1</text>
<text text-anchor="middle" x="15620" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15620" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15620" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_1&#45;&gt;layer3_attn_out_1 -->
<g id="edge140" class="edge">
<title>layer3_attn_weighted_1&#45;&gt;layer3_attn_out_1</title>
<path fill="none" stroke="black" d="M15620,-619.95C15620,-619.95 15620,-594.13 15620,-594.13"/>
<polygon fill="black" stroke="black" points="15623.5,-594.13 15620,-584.13 15616.5,-594.13 15623.5,-594.13"/>
</g>
<!-- layer3_attn_out_1&#45;&gt;layer3_attn_aggregate -->
<g id="edge141" class="edge">
<title>layer3_attn_out_1&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M15620,-515.97C15620,-490.49 15620,-460 15620,-460 15620,-460 16808.73,-460 16808.73,-460"/>
<polygon fill="black" stroke="black" points="16808.73,-463.5 16818.73,-460 16808.73,-456.5 16808.73,-463.5"/>
</g>
<!-- layer3_attn_scores_2 -->
<g id="node122" class="node">
<title>layer3_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="16669,-792 16157,-792 16157,-724 16669,-724 16669,-792"/>
<text text-anchor="middle" x="16413" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 2</text>
<text text-anchor="middle" x="16413" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16413" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16413" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_2&#45;&gt;layer3_attn_scores_2 -->
<g id="edge143" class="edge">
<title>layer3_attn_qkv_2&#45;&gt;layer3_attn_scores_2</title>
<path fill="none" stroke="black" d="M16413,-894.81C16413,-894.81 16413,-802.13 16413,-802.13"/>
<polygon fill="black" stroke="black" points="16416.5,-802.13 16413,-792.13 16409.5,-802.13 16416.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_2 -->
<g id="node123" class="node">
<title>layer3_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="16816,-688 16010,-688 16010,-620 16816,-620 16816,-688"/>
<text text-anchor="middle" x="16413" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 2</text>
<text text-anchor="middle" x="16413" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16413" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="16413" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_2&#45;&gt;layer3_attn_weighted_2 -->
<g id="edge144" class="edge">
<title>layer3_attn_scores_2&#45;&gt;layer3_attn_weighted_2</title>
<path fill="none" stroke="black" d="M16413,-723.95C16413,-723.95 16413,-698.13 16413,-698.13"/>
<polygon fill="black" stroke="black" points="16416.5,-698.13 16413,-688.13 16409.5,-698.13 16416.5,-698.13"/>
</g>
<!-- layer3_attn_out_2 -->
<g id="node124" class="node">
<title>layer3_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="16766.5,-584 16157.5,-584 16157.5,-516 16766.5,-516 16766.5,-584"/>
<text text-anchor="middle" x="16462" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 2</text>
<text text-anchor="middle" x="16462" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16462" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16462" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_2&#45;&gt;layer3_attn_out_2 -->
<g id="edge145" class="edge">
<title>layer3_attn_weighted_2&#45;&gt;layer3_attn_out_2</title>
<path fill="none" stroke="black" d="M16462,-619.95C16462,-619.95 16462,-594.13 16462,-594.13"/>
<polygon fill="black" stroke="black" points="16465.5,-594.13 16462,-584.13 16458.5,-594.13 16465.5,-594.13"/>
</g>
<!-- layer3_attn_out_2&#45;&gt;layer3_attn_aggregate -->
<g id="edge146" class="edge">
<title>layer3_attn_out_2&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M16675.88,-515.89C16675.88,-515.89 16675.88,-422.05 16675.88,-422.05"/>
<polygon fill="black" stroke="black" points="16679.38,-422.05 16675.88,-412.05 16672.38,-422.05 16679.38,-422.05"/>
</g>
<!-- layer3_attn_scores_3 -->
<g id="node126" class="node">
<title>layer3_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="17488,-792 16976,-792 16976,-724 17488,-724 17488,-792"/>
<text text-anchor="middle" x="17232" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 3</text>
<text text-anchor="middle" x="17232" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="17232" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17232" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_3&#45;&gt;layer3_attn_scores_3 -->
<g id="edge148" class="edge">
<title>layer3_attn_qkv_3&#45;&gt;layer3_attn_scores_3</title>
<path fill="none" stroke="black" d="M17232,-894.81C17232,-894.81 17232,-802.13 17232,-802.13"/>
<polygon fill="black" stroke="black" points="17235.5,-802.13 17232,-792.13 17228.5,-802.13 17235.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_3 -->
<g id="node127" class="node">
<title>layer3_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="17658,-688 16852,-688 16852,-620 17658,-620 17658,-688"/>
<text text-anchor="middle" x="17255" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 3</text>
<text text-anchor="middle" x="17255" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="17255" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="17255" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_3&#45;&gt;layer3_attn_weighted_3 -->
<g id="edge149" class="edge">
<title>layer3_attn_scores_3&#45;&gt;layer3_attn_weighted_3</title>
<path fill="none" stroke="black" d="M17232,-723.95C17232,-723.95 17232,-698.13 17232,-698.13"/>
<polygon fill="black" stroke="black" points="17235.5,-698.13 17232,-688.13 17228.5,-698.13 17235.5,-698.13"/>
</g>
<!-- layer3_attn_out_3 -->
<g id="node128" class="node">
<title>layer3_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="17559.5,-584 16950.5,-584 16950.5,-516 17559.5,-516 17559.5,-584"/>
<text text-anchor="middle" x="17255" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 3</text>
<text text-anchor="middle" x="17255" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="17255" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17255" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_3&#45;&gt;layer3_attn_out_3 -->
<g id="edge150" class="edge">
<title>layer3_attn_weighted_3&#45;&gt;layer3_attn_out_3</title>
<path fill="none" stroke="black" d="M17255,-619.95C17255,-619.95 17255,-594.13 17255,-594.13"/>
<polygon fill="black" stroke="black" points="17258.5,-594.13 17255,-584.13 17251.5,-594.13 17258.5,-594.13"/>
</g>
<!-- layer3_attn_out_3&#45;&gt;layer3_attn_aggregate -->
<g id="edge151" class="edge">
<title>layer3_attn_out_3&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M17255,-515.89C17255,-515.89 17255,-490.23 17255,-490.23"/>
<polygon fill="black" stroke="black" points="17258.5,-490.23 17255,-480.23 17251.5,-490.23 17258.5,-490.23"/>
</g>
<!-- layer3_attn_scores_4 -->
<g id="node130" class="node">
<title>layer3_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="18330,-792 17818,-792 17818,-724 18330,-724 18330,-792"/>
<text text-anchor="middle" x="18074" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 4</text>
<text text-anchor="middle" x="18074" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="18074" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="18074" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_4&#45;&gt;layer3_attn_scores_4 -->
<g id="edge153" class="edge">
<title>layer3_attn_qkv_4&#45;&gt;layer3_attn_scores_4</title>
<path fill="none" stroke="black" d="M18074,-894.81C18074,-894.81 18074,-802.13 18074,-802.13"/>
<polygon fill="black" stroke="black" points="18077.5,-802.13 18074,-792.13 18070.5,-802.13 18077.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_4 -->
<g id="node131" class="node">
<title>layer3_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="18500,-688 17694,-688 17694,-620 18500,-620 18500,-688"/>
<text text-anchor="middle" x="18097" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 4</text>
<text text-anchor="middle" x="18097" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="18097" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="18097" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_4&#45;&gt;layer3_attn_weighted_4 -->
<g id="edge154" class="edge">
<title>layer3_attn_scores_4&#45;&gt;layer3_attn_weighted_4</title>
<path fill="none" stroke="black" d="M18074,-723.95C18074,-723.95 18074,-698.13 18074,-698.13"/>
<polygon fill="black" stroke="black" points="18077.5,-698.13 18074,-688.13 18070.5,-698.13 18077.5,-698.13"/>
</g>
<!-- layer3_attn_out_4 -->
<g id="node132" class="node">
<title>layer3_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="18351.5,-584 17742.5,-584 17742.5,-516 18351.5,-516 18351.5,-584"/>
<text text-anchor="middle" x="18047" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 4</text>
<text text-anchor="middle" x="18047" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="18047" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="18047" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_4&#45;&gt;layer3_attn_out_4 -->
<g id="edge155" class="edge">
<title>layer3_attn_weighted_4&#45;&gt;layer3_attn_out_4</title>
<path fill="none" stroke="black" d="M18047,-619.95C18047,-619.95 18047,-594.13 18047,-594.13"/>
<polygon fill="black" stroke="black" points="18050.5,-594.13 18047,-584.13 18043.5,-594.13 18050.5,-594.13"/>
</g>
<!-- layer3_attn_out_4&#45;&gt;layer3_attn_aggregate -->
<g id="edge156" class="edge">
<title>layer3_attn_out_4&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M17833.62,-515.89C17833.62,-515.89 17833.62,-490.23 17833.62,-490.23"/>
<polygon fill="black" stroke="black" points="17837.12,-490.23 17833.62,-480.23 17830.12,-490.23 17837.12,-490.23"/>
</g>
<!-- layer3_attn_scores_5 -->
<g id="node134" class="node">
<title>layer3_attn_scores_5</title>
<polygon fill="lightblue" stroke="black" points="19172,-792 18660,-792 18660,-724 19172,-724 19172,-792"/>
<text text-anchor="middle" x="18916" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 5</text>
<text text-anchor="middle" x="18916" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="18916" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="18916" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_5&#45;&gt;layer3_attn_scores_5 -->
<g id="edge158" class="edge">
<title>layer3_attn_qkv_5&#45;&gt;layer3_attn_scores_5</title>
<path fill="none" stroke="black" d="M18916,-894.81C18916,-894.81 18916,-802.13 18916,-802.13"/>
<polygon fill="black" stroke="black" points="18919.5,-802.13 18916,-792.13 18912.5,-802.13 18919.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_5 -->
<g id="node135" class="node">
<title>layer3_attn_weighted_5</title>
<polygon fill="lightblue" stroke="black" points="19342,-688 18536,-688 18536,-620 19342,-620 19342,-688"/>
<text text-anchor="middle" x="18939" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 5</text>
<text text-anchor="middle" x="18939" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="18939" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="18939" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_5&#45;&gt;layer3_attn_weighted_5 -->
<g id="edge159" class="edge">
<title>layer3_attn_scores_5&#45;&gt;layer3_attn_weighted_5</title>
<path fill="none" stroke="black" d="M18916,-723.95C18916,-723.95 18916,-698.13 18916,-698.13"/>
<polygon fill="black" stroke="black" points="18919.5,-698.13 18916,-688.13 18912.5,-698.13 18919.5,-698.13"/>
</g>
<!-- layer3_attn_out_5 -->
<g id="node136" class="node">
<title>layer3_attn_out_5</title>
<polygon fill="lightblue" stroke="black" points="19193.5,-584 18584.5,-584 18584.5,-516 19193.5,-516 19193.5,-584"/>
<text text-anchor="middle" x="18889" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 5</text>
<text text-anchor="middle" x="18889" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="18889" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="18889" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_5&#45;&gt;layer3_attn_out_5 -->
<g id="edge160" class="edge">
<title>layer3_attn_weighted_5&#45;&gt;layer3_attn_out_5</title>
<path fill="none" stroke="black" d="M18889,-619.95C18889,-619.95 18889,-594.13 18889,-594.13"/>
<polygon fill="black" stroke="black" points="18892.5,-594.13 18889,-584.13 18885.5,-594.13 18892.5,-594.13"/>
</g>
<!-- layer3_attn_out_5&#45;&gt;layer3_attn_aggregate -->
<g id="edge161" class="edge">
<title>layer3_attn_out_5&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M18810.17,-515.82C18810.17,-481.61 18810.17,-434 18810.17,-434 18810.17,-434 17842.43,-434 17842.43,-434"/>
<polygon fill="black" stroke="black" points="17842.43,-430.5 17832.43,-434 17842.43,-437.5 17842.43,-430.5"/>
</g>
<!-- layer3_attn_scores_6 -->
<g id="node138" class="node">
<title>layer3_attn_scores_6</title>
<polygon fill="lightblue" stroke="black" points="20014,-792 19502,-792 19502,-724 20014,-724 20014,-792"/>
<text text-anchor="middle" x="19758" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 6</text>
<text text-anchor="middle" x="19758" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="19758" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="19758" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_6&#45;&gt;layer3_attn_scores_6 -->
<g id="edge163" class="edge">
<title>layer3_attn_qkv_6&#45;&gt;layer3_attn_scores_6</title>
<path fill="none" stroke="black" d="M19758,-894.81C19758,-894.81 19758,-802.13 19758,-802.13"/>
<polygon fill="black" stroke="black" points="19761.5,-802.13 19758,-792.13 19754.5,-802.13 19761.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_6 -->
<g id="node139" class="node">
<title>layer3_attn_weighted_6</title>
<polygon fill="lightblue" stroke="black" points="20184,-688 19378,-688 19378,-620 20184,-620 20184,-688"/>
<text text-anchor="middle" x="19781" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 6</text>
<text text-anchor="middle" x="19781" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="19781" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="19781" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_6&#45;&gt;layer3_attn_weighted_6 -->
<g id="edge164" class="edge">
<title>layer3_attn_scores_6&#45;&gt;layer3_attn_weighted_6</title>
<path fill="none" stroke="black" d="M19758,-723.95C19758,-723.95 19758,-698.13 19758,-698.13"/>
<polygon fill="black" stroke="black" points="19761.5,-698.13 19758,-688.13 19754.5,-698.13 19761.5,-698.13"/>
</g>
<!-- layer3_attn_out_6 -->
<g id="node140" class="node">
<title>layer3_attn_out_6</title>
<polygon fill="lightblue" stroke="black" points="20035.5,-584 19426.5,-584 19426.5,-516 20035.5,-516 20035.5,-584"/>
<text text-anchor="middle" x="19731" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 6</text>
<text text-anchor="middle" x="19731" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="19731" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="19731" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_6&#45;&gt;layer3_attn_out_6 -->
<g id="edge165" class="edge">
<title>layer3_attn_weighted_6&#45;&gt;layer3_attn_out_6</title>
<path fill="none" stroke="black" d="M19731,-619.95C19731,-619.95 19731,-594.13 19731,-594.13"/>
<polygon fill="black" stroke="black" points="19734.5,-594.13 19731,-584.13 19727.5,-594.13 19734.5,-594.13"/>
</g>
<!-- layer3_attn_out_6&#45;&gt;layer3_attn_aggregate -->
<g id="edge166" class="edge">
<title>layer3_attn_out_6&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M19731,-515.86C19731,-468.6 19731,-389 19731,-389 19731,-389 17751.59,-389 17751.59,-389"/>
<polygon fill="black" stroke="black" points="17751.59,-385.5 17741.59,-389 17751.59,-392.5 17751.59,-385.5"/>
</g>
<!-- layer3_attn_scores_7 -->
<g id="node142" class="node">
<title>layer3_attn_scores_7</title>
<polygon fill="lightblue" stroke="black" points="14192,-792 13680,-792 13680,-724 14192,-724 14192,-792"/>
<text text-anchor="middle" x="13936" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 7</text>
<text text-anchor="middle" x="13936" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="13936" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13936" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_7&#45;&gt;layer3_attn_scores_7 -->
<g id="edge168" class="edge">
<title>layer3_attn_qkv_7&#45;&gt;layer3_attn_scores_7</title>
<path fill="none" stroke="black" d="M13936,-894.81C13936,-894.81 13936,-802.13 13936,-802.13"/>
<polygon fill="black" stroke="black" points="13939.5,-802.13 13936,-792.13 13932.5,-802.13 13939.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_7 -->
<g id="node143" class="node">
<title>layer3_attn_weighted_7</title>
<polygon fill="lightblue" stroke="black" points="14316,-688 13510,-688 13510,-620 14316,-620 14316,-688"/>
<text text-anchor="middle" x="13913" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 7</text>
<text text-anchor="middle" x="13913" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="13913" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="13913" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_7&#45;&gt;layer3_attn_weighted_7 -->
<g id="edge169" class="edge">
<title>layer3_attn_scores_7&#45;&gt;layer3_attn_weighted_7</title>
<path fill="none" stroke="black" d="M13936,-723.95C13936,-723.95 13936,-698.13 13936,-698.13"/>
<polygon fill="black" stroke="black" points="13939.5,-698.13 13936,-688.13 13932.5,-698.13 13939.5,-698.13"/>
</g>
<!-- layer3_attn_out_7 -->
<g id="node144" class="node">
<title>layer3_attn_out_7</title>
<polygon fill="lightblue" stroke="black" points="14266.5,-584 13657.5,-584 13657.5,-516 14266.5,-516 14266.5,-584"/>
<text text-anchor="middle" x="13962" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 7</text>
<text text-anchor="middle" x="13962" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="13962" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13962" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_7&#45;&gt;layer3_attn_out_7 -->
<g id="edge170" class="edge">
<title>layer3_attn_weighted_7&#45;&gt;layer3_attn_out_7</title>
<path fill="none" stroke="black" d="M13962,-619.95C13962,-619.95 13962,-594.13 13962,-594.13"/>
<polygon fill="black" stroke="black" points="13965.5,-594.13 13962,-584.13 13958.5,-594.13 13965.5,-594.13"/>
</g>
<!-- layer3_attn_out_7&#45;&gt;layer3_attn_aggregate -->
<g id="edge171" class="edge">
<title>layer3_attn_out_7&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M13962,-515.77C13962,-477.55 13962,-421 13962,-421 13962,-421 16730.02,-421 16730.02,-421"/>
<polygon fill="black" stroke="black" points="16730.02,-424.5 16740.02,-421 16730.02,-417.5 16730.02,-424.5"/>
</g>
<!-- recv_from_pool_3 -->
<g id="node146" class="node">
<title>recv_from_pool_3</title>
<polygon fill="yellow" stroke="black" points="19035.69,-308 18145.35,-308 17916.31,-172 18806.65,-172 19035.69,-308"/>
<text text-anchor="middle" x="18476" y="-258.8" font-family="Times,serif" font-size="14.00">Receive Layer 3 from Pool</text>
<text text-anchor="middle" x="18476" y="-243.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15] → [0&#45;7]</text>
<text text-anchor="middle" x="18476" y="-228.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="18476" y="-213.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_aggregate&#45;&gt;recv_from_pool_3 -->
<g id="edge172" class="edge">
<title>layer3_attn_aggregate&#45;&gt;recv_from_pool_3</title>
<path fill="none" stroke="black" d="M17921.88,-411.88C17921.88,-411.88 17921.88,-250.12 17921.88,-250.12"/>
<polygon fill="black" stroke="black" points="17925.38,-250.12 17921.88,-240.12 17918.38,-250.12 17925.38,-250.12"/>
</g>
<!-- recv_from_pool_3&#45;&gt;output_proj -->
<g id="edge173" class="edge">
<title>recv_from_pool_3&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M17919.02,-240.06C17919.02,-242.67 17919.02,-326 17919.02,-326 17919.02,-326 7624.25,-326 7624.25,-326 7624.25,-326 7624.25,-1194.88 7624.25,-1194.88"/>
<polygon fill="black" stroke="black" points="7620.75,-1194.88 7624.25,-1204.88 7627.75,-1194.88 7620.75,-1194.88"/>
</g>
</g>
</svg>
