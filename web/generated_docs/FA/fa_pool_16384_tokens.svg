<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: fa_pool_transformer Pages: 1 -->
<svg width="40770pt" height="2396pt"
 viewBox="0.00 0.00 40770.00 2396.17" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2392.17)">
<title>fa_pool_transformer</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2392.17 40766,-2392.17 40766,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_base</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="12996,-1059 12996,-1319 15268,-1319 15268,-1059 12996,-1059"/>
<text text-anchor="middle" x="14132" y="-1303.8" font-family="Times,serif" font-size="14.00">Base Layer &#45; GPUs [0&#45;7]</text>
<text text-anchor="middle" x="14132" y="-1288.8" font-family="Times,serif" font-size="14.00">FFN Operations Only</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0_attn_0</title>
<polygon fill="none" stroke="black" points="6599,-1663 6599,-2112 7395,-2112 7395,-1663 6599,-1663"/>
<text text-anchor="middle" x="6997" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 0</text>
<text text-anchor="middle" x="6997" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="6997" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;1024</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer0_attn_1</title>
<polygon fill="none" stroke="black" points="7415,-1663 7415,-2112 8237,-2112 8237,-1663 7415,-1663"/>
<text text-anchor="middle" x="7826" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 1</text>
<text text-anchor="middle" x="7826" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7826" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 1024&#45;2048</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer0_attn_2</title>
<polygon fill="none" stroke="black" points="8257,-1663 8257,-2112 9079,-2112 9079,-1663 8257,-1663"/>
<text text-anchor="middle" x="8668" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 2</text>
<text text-anchor="middle" x="8668" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8668" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 2048&#45;3072</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer0_attn_3</title>
<polygon fill="none" stroke="black" points="9099,-1663 9099,-2112 9921,-2112 9921,-1663 9099,-1663"/>
<text text-anchor="middle" x="9510" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 3</text>
<text text-anchor="middle" x="9510" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9510" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 3072&#45;4096</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer0_attn_4</title>
<polygon fill="none" stroke="black" points="9941,-1663 9941,-2112 10763,-2112 10763,-1663 9941,-1663"/>
<text text-anchor="middle" x="10352" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 4</text>
<text text-anchor="middle" x="10352" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10352" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 4096&#45;5120</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer0_attn_5</title>
<polygon fill="none" stroke="black" points="10783,-1663 10783,-2112 11605,-2112 11605,-1663 10783,-1663"/>
<text text-anchor="middle" x="11194" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 5</text>
<text text-anchor="middle" x="11194" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="11194" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 5120&#45;6144</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer0_attn_6</title>
<polygon fill="none" stroke="black" points="11625,-1663 11625,-2112 12447,-2112 12447,-1663 11625,-1663"/>
<text text-anchor="middle" x="12036" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 6</text>
<text text-anchor="middle" x="12036" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="12036" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 6144&#45;7168</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer0_attn_7</title>
<polygon fill="none" stroke="black" points="12467,-1663 12467,-2112 13289,-2112 13289,-1663 12467,-1663"/>
<text text-anchor="middle" x="12878" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 7</text>
<text text-anchor="middle" x="12878" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="12878" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 7168&#45;8192</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer0_attn_8</title>
<polygon fill="none" stroke="black" points="13309,-1663 13309,-2112 14131,-2112 14131,-1663 13309,-1663"/>
<text text-anchor="middle" x="13720" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 8</text>
<text text-anchor="middle" x="13720" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="13720" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 8192&#45;9216</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer0_attn_9</title>
<polygon fill="none" stroke="black" points="14151,-1663 14151,-2112 14983,-2112 14983,-1663 14151,-1663"/>
<text text-anchor="middle" x="14567" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 9</text>
<text text-anchor="middle" x="14567" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="14567" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 9216&#45;10240</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer0_attn_10</title>
<polygon fill="none" stroke="black" points="15003,-1663 15003,-2112 15843,-2112 15843,-1663 15003,-1663"/>
<text text-anchor="middle" x="15423" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 10</text>
<text text-anchor="middle" x="15423" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="15423" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 10240&#45;11264</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer0_attn_11</title>
<polygon fill="none" stroke="black" points="15863,-1663 15863,-2112 16703,-2112 16703,-1663 15863,-1663"/>
<text text-anchor="middle" x="16283" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 11</text>
<text text-anchor="middle" x="16283" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="16283" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 11264&#45;12288</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer0_attn_12</title>
<polygon fill="none" stroke="black" points="16723,-1663 16723,-2112 17563,-2112 17563,-1663 16723,-1663"/>
<text text-anchor="middle" x="17143" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 12</text>
<text text-anchor="middle" x="17143" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="17143" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 12288&#45;13312</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer0_attn_13</title>
<polygon fill="none" stroke="black" points="17583,-1663 17583,-2112 18423,-2112 18423,-1663 17583,-1663"/>
<text text-anchor="middle" x="18003" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 13</text>
<text text-anchor="middle" x="18003" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="18003" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 13312&#45;14336</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer0_attn_14</title>
<polygon fill="none" stroke="black" points="18443,-1663 18443,-2112 19283,-2112 19283,-1663 18443,-1663"/>
<text text-anchor="middle" x="18863" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 14</text>
<text text-anchor="middle" x="18863" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="18863" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 14336&#45;15360</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_layer0_attn_15</title>
<polygon fill="none" stroke="black" points="19303,-1663 19303,-2112 20143,-2112 20143,-1663 19303,-1663"/>
<text text-anchor="middle" x="19723" y="-2096.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Block 15</text>
<text text-anchor="middle" x="19723" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="19723" y="-2066.8" font-family="Times,serif" font-size="14.00">Seq: 15360&#45;16384</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_layer1_attn_0</title>
<polygon fill="none" stroke="black" points="8546,-370 8546,-853 9342,-853 9342,-370 8546,-370"/>
<text text-anchor="middle" x="8944" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 0</text>
<text text-anchor="middle" x="8944" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8944" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;1024</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_layer1_attn_1</title>
<polygon fill="none" stroke="black" points="9362,-370 9362,-853 10184,-853 10184,-370 9362,-370"/>
<text text-anchor="middle" x="9773" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 1</text>
<text text-anchor="middle" x="9773" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9773" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 1024&#45;2048</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_layer1_attn_2</title>
<polygon fill="none" stroke="black" points="10204,-370 10204,-853 11026,-853 11026,-370 10204,-370"/>
<text text-anchor="middle" x="10615" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 2</text>
<text text-anchor="middle" x="10615" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10615" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 2048&#45;3072</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_layer1_attn_3</title>
<polygon fill="none" stroke="black" points="11046,-370 11046,-853 11868,-853 11868,-370 11046,-370"/>
<text text-anchor="middle" x="11457" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 3</text>
<text text-anchor="middle" x="11457" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11457" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 3072&#45;4096</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_layer1_attn_4</title>
<polygon fill="none" stroke="black" points="11888,-370 11888,-853 12710,-853 12710,-370 11888,-370"/>
<text text-anchor="middle" x="12299" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 4</text>
<text text-anchor="middle" x="12299" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12299" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 4096&#45;5120</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_layer1_attn_5</title>
<polygon fill="none" stroke="black" points="12730,-370 12730,-853 13552,-853 13552,-370 12730,-370"/>
<text text-anchor="middle" x="13141" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 5</text>
<text text-anchor="middle" x="13141" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="13141" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 5120&#45;6144</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_layer1_attn_6</title>
<polygon fill="none" stroke="black" points="8,-370 8,-853 830,-853 830,-370 8,-370"/>
<text text-anchor="middle" x="419" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 6</text>
<text text-anchor="middle" x="419" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="419" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 6144&#45;7168</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_layer1_attn_7</title>
<polygon fill="none" stroke="black" points="850,-370 850,-853 1672,-853 1672,-370 850,-370"/>
<text text-anchor="middle" x="1261" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 7</text>
<text text-anchor="middle" x="1261" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="1261" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 7168&#45;8192</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_layer1_attn_8</title>
<polygon fill="none" stroke="black" points="1692,-370 1692,-853 2514,-853 2514,-370 1692,-370"/>
<text text-anchor="middle" x="2103" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 8</text>
<text text-anchor="middle" x="2103" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="2103" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 8192&#45;9216</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_layer1_attn_9</title>
<polygon fill="none" stroke="black" points="2534,-370 2534,-853 3366,-853 3366,-370 2534,-370"/>
<text text-anchor="middle" x="2950" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 9</text>
<text text-anchor="middle" x="2950" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="2950" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 9216&#45;10240</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_layer1_attn_10</title>
<polygon fill="none" stroke="black" points="3386,-370 3386,-853 4226,-853 4226,-370 3386,-370"/>
<text text-anchor="middle" x="3806" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 10</text>
<text text-anchor="middle" x="3806" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="3806" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 10240&#45;11264</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_layer1_attn_11</title>
<polygon fill="none" stroke="black" points="4246,-370 4246,-853 5086,-853 5086,-370 4246,-370"/>
<text text-anchor="middle" x="4666" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 11</text>
<text text-anchor="middle" x="4666" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="4666" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 11264&#45;12288</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_layer1_attn_12</title>
<polygon fill="none" stroke="black" points="5106,-370 5106,-853 5946,-853 5946,-370 5106,-370"/>
<text text-anchor="middle" x="5526" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 12</text>
<text text-anchor="middle" x="5526" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="5526" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 12288&#45;13312</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_layer1_attn_13</title>
<polygon fill="none" stroke="black" points="5966,-370 5966,-853 6806,-853 6806,-370 5966,-370"/>
<text text-anchor="middle" x="6386" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 13</text>
<text text-anchor="middle" x="6386" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="6386" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 13312&#45;14336</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_layer1_attn_14</title>
<polygon fill="none" stroke="black" points="6826,-370 6826,-853 7666,-853 7666,-370 6826,-370"/>
<text text-anchor="middle" x="7246" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 14</text>
<text text-anchor="middle" x="7246" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="7246" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 14336&#45;15360</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_layer1_attn_15</title>
<polygon fill="none" stroke="black" points="7686,-370 7686,-853 8526,-853 8526,-370 7686,-370"/>
<text text-anchor="middle" x="8106" y="-837.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Block 15</text>
<text text-anchor="middle" x="8106" y="-822.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="8106" y="-807.8" font-family="Times,serif" font-size="14.00">Seq: 15360&#45;16384</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_layer2_attn_0</title>
<polygon fill="none" stroke="black" points="21342,-508 21342,-1024 22138,-1024 22138,-508 21342,-508"/>
<text text-anchor="middle" x="21740" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 0</text>
<text text-anchor="middle" x="21740" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="21740" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;1024</text>
</g>
<g id="clust35" class="cluster">
<title>cluster_layer2_attn_1</title>
<polygon fill="none" stroke="black" points="22158,-508 22158,-1024 22980,-1024 22980,-508 22158,-508"/>
<text text-anchor="middle" x="22569" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 1</text>
<text text-anchor="middle" x="22569" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="22569" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 1024&#45;2048</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_layer2_attn_2</title>
<polygon fill="none" stroke="black" points="23000,-508 23000,-1024 23822,-1024 23822,-508 23000,-508"/>
<text text-anchor="middle" x="23411" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 2</text>
<text text-anchor="middle" x="23411" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="23411" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 2048&#45;3072</text>
</g>
<g id="clust37" class="cluster">
<title>cluster_layer2_attn_3</title>
<polygon fill="none" stroke="black" points="23842,-508 23842,-1024 24664,-1024 24664,-508 23842,-508"/>
<text text-anchor="middle" x="24253" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 3</text>
<text text-anchor="middle" x="24253" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="24253" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 3072&#45;4096</text>
</g>
<g id="clust38" class="cluster">
<title>cluster_layer2_attn_4</title>
<polygon fill="none" stroke="black" points="24684,-508 24684,-1024 25506,-1024 25506,-508 24684,-508"/>
<text text-anchor="middle" x="25095" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 4</text>
<text text-anchor="middle" x="25095" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="25095" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 4096&#45;5120</text>
</g>
<g id="clust39" class="cluster">
<title>cluster_layer2_attn_5</title>
<polygon fill="none" stroke="black" points="25526,-508 25526,-1024 26348,-1024 26348,-508 25526,-508"/>
<text text-anchor="middle" x="25937" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 5</text>
<text text-anchor="middle" x="25937" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="25937" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 5120&#45;6144</text>
</g>
<g id="clust40" class="cluster">
<title>cluster_layer2_attn_6</title>
<polygon fill="none" stroke="black" points="26368,-508 26368,-1024 27190,-1024 27190,-508 26368,-508"/>
<text text-anchor="middle" x="26779" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 6</text>
<text text-anchor="middle" x="26779" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="26779" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 6144&#45;7168</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_layer2_attn_7</title>
<polygon fill="none" stroke="black" points="13646,-508 13646,-1024 14468,-1024 14468,-508 13646,-508"/>
<text text-anchor="middle" x="14057" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 7</text>
<text text-anchor="middle" x="14057" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14057" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 7168&#45;8192</text>
</g>
<g id="clust42" class="cluster">
<title>cluster_layer2_attn_8</title>
<polygon fill="none" stroke="black" points="14488,-508 14488,-1024 15310,-1024 15310,-508 14488,-508"/>
<text text-anchor="middle" x="14899" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 8</text>
<text text-anchor="middle" x="14899" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="14899" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 8192&#45;9216</text>
</g>
<g id="clust43" class="cluster">
<title>cluster_layer2_attn_9</title>
<polygon fill="none" stroke="black" points="15330,-508 15330,-1024 16162,-1024 16162,-508 15330,-508"/>
<text text-anchor="middle" x="15746" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 9</text>
<text text-anchor="middle" x="15746" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="15746" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 9216&#45;10240</text>
</g>
<g id="clust44" class="cluster">
<title>cluster_layer2_attn_10</title>
<polygon fill="none" stroke="black" points="16182,-508 16182,-1024 17022,-1024 17022,-508 16182,-508"/>
<text text-anchor="middle" x="16602" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 10</text>
<text text-anchor="middle" x="16602" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="16602" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 10240&#45;11264</text>
</g>
<g id="clust45" class="cluster">
<title>cluster_layer2_attn_11</title>
<polygon fill="none" stroke="black" points="17042,-508 17042,-1024 17882,-1024 17882,-508 17042,-508"/>
<text text-anchor="middle" x="17462" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 11</text>
<text text-anchor="middle" x="17462" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="17462" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 11264&#45;12288</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_layer2_attn_12</title>
<polygon fill="none" stroke="black" points="17902,-508 17902,-1024 18742,-1024 18742,-508 17902,-508"/>
<text text-anchor="middle" x="18322" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 12</text>
<text text-anchor="middle" x="18322" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="18322" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 12288&#45;13312</text>
</g>
<g id="clust47" class="cluster">
<title>cluster_layer2_attn_13</title>
<polygon fill="none" stroke="black" points="18762,-508 18762,-1024 19602,-1024 19602,-508 18762,-508"/>
<text text-anchor="middle" x="19182" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 13</text>
<text text-anchor="middle" x="19182" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="19182" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 13312&#45;14336</text>
</g>
<g id="clust48" class="cluster">
<title>cluster_layer2_attn_14</title>
<polygon fill="none" stroke="black" points="19622,-508 19622,-1024 20462,-1024 20462,-508 19622,-508"/>
<text text-anchor="middle" x="20042" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 14</text>
<text text-anchor="middle" x="20042" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="20042" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 14336&#45;15360</text>
</g>
<g id="clust49" class="cluster">
<title>cluster_layer2_attn_15</title>
<polygon fill="none" stroke="black" points="20482,-508 20482,-1024 21322,-1024 21322,-508 20482,-508"/>
<text text-anchor="middle" x="20902" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Block 15</text>
<text text-anchor="middle" x="20902" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="20902" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 15360&#45;16384</text>
</g>
<g id="clust50" class="cluster">
<title>cluster_layer3_attn_0</title>
<polygon fill="none" stroke="black" points="34906,-508 34906,-1024 35702,-1024 35702,-508 34906,-508"/>
<text text-anchor="middle" x="35304" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 0</text>
<text text-anchor="middle" x="35304" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="35304" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 0&#45;1024</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_layer3_attn_1</title>
<polygon fill="none" stroke="black" points="35722,-508 35722,-1024 36544,-1024 36544,-508 35722,-508"/>
<text text-anchor="middle" x="36133" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 1</text>
<text text-anchor="middle" x="36133" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="36133" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 1024&#45;2048</text>
</g>
<g id="clust52" class="cluster">
<title>cluster_layer3_attn_2</title>
<polygon fill="none" stroke="black" points="36564,-508 36564,-1024 37386,-1024 37386,-508 36564,-508"/>
<text text-anchor="middle" x="36975" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 2</text>
<text text-anchor="middle" x="36975" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="36975" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 2048&#45;3072</text>
</g>
<g id="clust53" class="cluster">
<title>cluster_layer3_attn_3</title>
<polygon fill="none" stroke="black" points="37406,-508 37406,-1024 38228,-1024 38228,-508 37406,-508"/>
<text text-anchor="middle" x="37817" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 3</text>
<text text-anchor="middle" x="37817" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="37817" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 3072&#45;4096</text>
</g>
<g id="clust54" class="cluster">
<title>cluster_layer3_attn_4</title>
<polygon fill="none" stroke="black" points="38248,-508 38248,-1024 39070,-1024 39070,-508 38248,-508"/>
<text text-anchor="middle" x="38659" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 4</text>
<text text-anchor="middle" x="38659" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="38659" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 4096&#45;5120</text>
</g>
<g id="clust55" class="cluster">
<title>cluster_layer3_attn_5</title>
<polygon fill="none" stroke="black" points="39090,-508 39090,-1024 39912,-1024 39912,-508 39090,-508"/>
<text text-anchor="middle" x="39501" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 5</text>
<text text-anchor="middle" x="39501" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="39501" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 5120&#45;6144</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_layer3_attn_6</title>
<polygon fill="none" stroke="black" points="39932,-508 39932,-1024 40754,-1024 40754,-508 39932,-508"/>
<text text-anchor="middle" x="40343" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 6</text>
<text text-anchor="middle" x="40343" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="40343" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 6144&#45;7168</text>
</g>
<g id="clust57" class="cluster">
<title>cluster_layer3_attn_7</title>
<polygon fill="none" stroke="black" points="27210,-508 27210,-1024 28032,-1024 28032,-508 27210,-508"/>
<text text-anchor="middle" x="27621" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 7</text>
<text text-anchor="middle" x="27621" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="27621" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 7168&#45;8192</text>
</g>
<g id="clust58" class="cluster">
<title>cluster_layer3_attn_8</title>
<polygon fill="none" stroke="black" points="28052,-508 28052,-1024 28874,-1024 28874,-508 28052,-508"/>
<text text-anchor="middle" x="28463" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 8</text>
<text text-anchor="middle" x="28463" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="28463" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 8192&#45;9216</text>
</g>
<g id="clust59" class="cluster">
<title>cluster_layer3_attn_9</title>
<polygon fill="none" stroke="black" points="28894,-508 28894,-1024 29726,-1024 29726,-508 28894,-508"/>
<text text-anchor="middle" x="29310" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 9</text>
<text text-anchor="middle" x="29310" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="29310" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 9216&#45;10240</text>
</g>
<g id="clust60" class="cluster">
<title>cluster_layer3_attn_10</title>
<polygon fill="none" stroke="black" points="29746,-508 29746,-1024 30586,-1024 30586,-508 29746,-508"/>
<text text-anchor="middle" x="30166" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 10</text>
<text text-anchor="middle" x="30166" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="30166" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 10240&#45;11264</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_layer3_attn_11</title>
<polygon fill="none" stroke="black" points="30606,-508 30606,-1024 31446,-1024 31446,-508 30606,-508"/>
<text text-anchor="middle" x="31026" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 11</text>
<text text-anchor="middle" x="31026" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="31026" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 11264&#45;12288</text>
</g>
<g id="clust62" class="cluster">
<title>cluster_layer3_attn_12</title>
<polygon fill="none" stroke="black" points="31466,-508 31466,-1024 32306,-1024 32306,-508 31466,-508"/>
<text text-anchor="middle" x="31886" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 12</text>
<text text-anchor="middle" x="31886" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="31886" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 12288&#45;13312</text>
</g>
<g id="clust63" class="cluster">
<title>cluster_layer3_attn_13</title>
<polygon fill="none" stroke="black" points="32326,-508 32326,-1024 33166,-1024 33166,-508 32326,-508"/>
<text text-anchor="middle" x="32746" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 13</text>
<text text-anchor="middle" x="32746" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="32746" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 13312&#45;14336</text>
</g>
<g id="clust64" class="cluster">
<title>cluster_layer3_attn_14</title>
<polygon fill="none" stroke="black" points="33186,-508 33186,-1024 34026,-1024 34026,-508 33186,-508"/>
<text text-anchor="middle" x="33606" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 14</text>
<text text-anchor="middle" x="33606" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="33606" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 14336&#45;15360</text>
</g>
<g id="clust65" class="cluster">
<title>cluster_layer3_attn_15</title>
<polygon fill="none" stroke="black" points="34046,-508 34046,-1024 34886,-1024 34886,-508 34046,-508"/>
<text text-anchor="middle" x="34466" y="-1008.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Block 15</text>
<text text-anchor="middle" x="34466" y="-993.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="34466" y="-978.8" font-family="Times,serif" font-size="14.00">Seq: 15360&#45;16384</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="13322" cy="-2340.08" rx="381.68" ry="48.17"/>
<text text-anchor="middle" x="13322" y="-2358.88" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="13322" y="-2343.88" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="13322" y="-2328.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096]</text>
<text text-anchor="middle" x="13322" y="-2313.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- send_to_pool -->
<g id="node7" class="node">
<title>send_to_pool</title>
<polygon fill="yellow" stroke="black" points="13881.69,-2256 12991.35,-2256 12762.31,-2120 13652.65,-2120 13881.69,-2256"/>
<text text-anchor="middle" x="13322" y="-2206.8" font-family="Times,serif" font-size="14.00">Send to Attention Pool</text>
<text text-anchor="middle" x="13322" y="-2191.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;{7+attention_pool_gpus}]</text>
<text text-anchor="middle" x="13322" y="-2176.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="13322" y="-2161.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- input&#45;&gt;send_to_pool -->
<g id="edge1" class="edge">
<title>input&#45;&gt;send_to_pool</title>
<path fill="none" stroke="black" d="M13322,-2291.96C13322,-2291.96 13322,-2266.09 13322,-2266.09"/>
<polygon fill="black" stroke="black" points="13325.5,-2266.09 13322,-2256.09 13318.5,-2266.09 13325.5,-2266.09"/>
</g>
<!-- layer0_ffn_start -->
<g id="node2" class="node">
<title>layer0_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="13544,-1273 13004,-1273 13004,-1205 13544,-1205 13544,-1273"/>
<text text-anchor="middle" x="13274" y="-1257.8" font-family="Times,serif" font-size="14.00">Layer 0 FFN Start</text>
<text text-anchor="middle" x="13274" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="13274" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="13274" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_ffn_start -->
<g id="node3" class="node">
<title>layer1_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="13544,-1135 13004,-1135 13004,-1067 13544,-1067 13544,-1135"/>
<text text-anchor="middle" x="13274" y="-1119.8" font-family="Times,serif" font-size="14.00">Layer 1 FFN Start</text>
<text text-anchor="middle" x="13274" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="13274" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="13274" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_ffn_start&#45;&gt;layer1_ffn_start -->
<g id="edge84" class="edge">
<title>layer0_ffn_start&#45;&gt;layer1_ffn_start</title>
<path fill="none" stroke="black" d="M13274,-1204.89C13274,-1204.89 13274,-1145.2 13274,-1145.2"/>
<polygon fill="black" stroke="black" points="13277.5,-1145.2 13274,-1135.2 13270.5,-1145.2 13277.5,-1145.2"/>
</g>
<!-- send_to_pool_1 -->
<g id="node74" class="node">
<title>send_to_pool_1</title>
<polygon fill="yellow" stroke="black" points="7805.69,-997 6915.35,-997 6686.31,-861 7576.65,-861 7805.69,-997"/>
<text text-anchor="middle" x="7246" y="-947.8" font-family="Times,serif" font-size="14.00">Send Layer 1 to Pool</text>
<text text-anchor="middle" x="7246" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;23]</text>
<text text-anchor="middle" x="7246" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7246" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_ffn_start&#45;&gt;send_to_pool_1 -->
<g id="edge85" class="edge">
<title>layer1_ffn_start&#45;&gt;send_to_pool_1</title>
<path fill="none" stroke="black" d="M13003.67,-1101C11886.55,-1101 7688.67,-1101 7688.67,-1101 7688.67,-1101 7688.67,-1007.47 7688.67,-1007.47"/>
<polygon fill="black" stroke="black" points="7692.17,-1007.47 7688.67,-997.47 7685.17,-1007.47 7692.17,-1007.47"/>
</g>
<!-- layer2_ffn_start -->
<g id="node4" class="node">
<title>layer2_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="15260,-1273 14720,-1273 14720,-1205 15260,-1205 15260,-1273"/>
<text text-anchor="middle" x="14990" y="-1257.8" font-family="Times,serif" font-size="14.00">Layer 2 FFN Start</text>
<text text-anchor="middle" x="14990" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="14990" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="14990" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- send_to_pool_2 -->
<g id="node141" class="node">
<title>send_to_pool_2</title>
<polygon fill="yellow" stroke="black" points="20601.69,-1169 19711.35,-1169 19482.31,-1033 20372.65,-1033 20601.69,-1169"/>
<text text-anchor="middle" x="20042" y="-1119.8" font-family="Times,serif" font-size="14.00">Send Layer 2 to Pool</text>
<text text-anchor="middle" x="20042" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;23]</text>
<text text-anchor="middle" x="20042" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="20042" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_ffn_start&#45;&gt;send_to_pool_2 -->
<g id="edge168" class="edge">
<title>layer2_ffn_start&#45;&gt;send_to_pool_2</title>
<path fill="none" stroke="black" d="M15077.67,-1204.61C15077.67,-1182.93 15077.67,-1159 15077.67,-1159 15077.67,-1159 19684.4,-1159 19684.4,-1159"/>
<polygon fill="black" stroke="black" points="19684.4,-1162.5 19694.4,-1159 19684.4,-1155.5 19684.4,-1162.5"/>
</g>
<!-- layer3_ffn_start -->
<g id="node5" class="node">
<title>layer3_ffn_start</title>
<polygon fill="lightblue" stroke="black" points="14120,-1273 13580,-1273 13580,-1205 14120,-1205 14120,-1273"/>
<text text-anchor="middle" x="13850" y="-1257.8" font-family="Times,serif" font-size="14.00">Layer 3 FFN Start</text>
<text text-anchor="middle" x="13850" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="13850" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="13850" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- send_to_pool_3 -->
<g id="node208" class="node">
<title>send_to_pool_3</title>
<polygon fill="yellow" stroke="black" points="34165.69,-1169 33275.35,-1169 33046.31,-1033 33936.65,-1033 34165.69,-1169"/>
<text text-anchor="middle" x="33606" y="-1119.8" font-family="Times,serif" font-size="14.00">Send Layer 3 to Pool</text>
<text text-anchor="middle" x="33606" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7] → [8&#45;23]</text>
<text text-anchor="middle" x="33606" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="33606" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_ffn_start&#45;&gt;send_to_pool_3 -->
<g id="edge251" class="edge">
<title>layer3_ffn_start&#45;&gt;send_to_pool_3</title>
<path fill="none" stroke="black" d="M13967.25,-1204.98C13967.25,-1142.32 13967.25,-1015 13967.25,-1015 13967.25,-1015 33068.27,-1015 33068.27,-1015 33068.27,-1015 33068.27,-1090.94 33068.27,-1090.94"/>
<polygon fill="black" stroke="black" points="33064.77,-1090.94 33068.27,-1100.94 33071.77,-1090.94 33064.77,-1090.94"/>
</g>
<!-- output_proj -->
<g id="node6" class="node">
<title>output_proj</title>
<polygon fill="lightblue" stroke="black" points="14684,-1273 14156,-1273 14156,-1205 14684,-1205 14684,-1273"/>
<text text-anchor="middle" x="14420" y="-1257.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14420" y="-1242.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="14420" y="-1227.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="14420" y="-1212.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=?, partition=?]</text>
</g>
<!-- output -->
<g id="node275" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="15610" cy="-1101" rx="334.42" ry="48.17"/>
<text text-anchor="middle" x="15610" y="-1119.8" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="15610" y="-1104.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="15610" y="-1089.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, vocab_size=?, partition=?]</text>
<text text-anchor="middle" x="15610" y="-1074.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=?]</text>
</g>
<!-- output_proj&#45;&gt;output -->
<g id="edge334" class="edge">
<title>output_proj&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14658.75,-1204.8C14658.75,-1176.87 14658.75,-1142 14658.75,-1142 14658.75,-1142 15425.25,-1142 15425.25,-1142"/>
<polygon fill="black" stroke="black" points="15425.25,-1145.5 15435.25,-1142 15425.25,-1138.5 15425.25,-1145.5"/>
</g>
<!-- layer0_attn_qkv_0 -->
<g id="node9" class="node">
<title>layer0_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="7341,-2051 6745,-2051 6745,-1983 7341,-1983 7341,-2051"/>
<text text-anchor="middle" x="7043" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 0</text>
<text text-anchor="middle" x="7043" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7043" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7043" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_0 -->
<g id="edge2" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_0</title>
<path fill="none" stroke="black" d="M12962.43,-2239C11628.97,-2239 7043,-2239 7043,-2239 7043,-2239 7043,-2061.2 7043,-2061.2"/>
<polygon fill="black" stroke="black" points="7046.5,-2061.2 7043,-2051.2 7039.5,-2061.2 7046.5,-2061.2"/>
</g>
<!-- layer0_attn_qkv_1 -->
<g id="node13" class="node">
<title>layer0_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="8183.5,-2051 7560.5,-2051 7560.5,-1983 8183.5,-1983 8183.5,-2051"/>
<text text-anchor="middle" x="7872" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 1</text>
<text text-anchor="middle" x="7872" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7872" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7872" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_1 -->
<g id="edge7" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_1</title>
<path fill="none" stroke="black" d="M12933.87,-2222C11688.2,-2222 7872,-2222 7872,-2222 7872,-2222 7872,-2061.31 7872,-2061.31"/>
<polygon fill="black" stroke="black" points="7875.5,-2061.31 7872,-2051.31 7868.5,-2061.31 7875.5,-2061.31"/>
</g>
<!-- layer0_attn_qkv_2 -->
<g id="node17" class="node">
<title>layer0_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="9025.5,-2051 8402.5,-2051 8402.5,-1983 9025.5,-1983 9025.5,-2051"/>
<text text-anchor="middle" x="8714" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 2</text>
<text text-anchor="middle" x="8714" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8714" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="8714" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_2 -->
<g id="edge12" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_2</title>
<path fill="none" stroke="black" d="M12905.45,-2205C11771.56,-2205 8714,-2205 8714,-2205 8714,-2205 8714,-2061.05 8714,-2061.05"/>
<polygon fill="black" stroke="black" points="8717.5,-2061.05 8714,-2051.05 8710.5,-2061.05 8717.5,-2061.05"/>
</g>
<!-- layer0_attn_qkv_3 -->
<g id="node21" class="node">
<title>layer0_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="9867.5,-2051 9244.5,-2051 9244.5,-1983 9867.5,-1983 9867.5,-2051"/>
<text text-anchor="middle" x="9556" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 3</text>
<text text-anchor="middle" x="9556" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9556" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="9556" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_3 -->
<g id="edge17" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_3</title>
<path fill="none" stroke="black" d="M12876.6,-2188C11879.79,-2188 9556,-2188 9556,-2188 9556,-2188 9556,-2061.19 9556,-2061.19"/>
<polygon fill="black" stroke="black" points="9559.5,-2061.19 9556,-2051.19 9552.5,-2061.19 9559.5,-2061.19"/>
</g>
<!-- layer0_attn_qkv_4 -->
<g id="node25" class="node">
<title>layer0_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="10709.5,-2051 10086.5,-2051 10086.5,-1983 10709.5,-1983 10709.5,-2051"/>
<text text-anchor="middle" x="10398" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 4</text>
<text text-anchor="middle" x="10398" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10398" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="10398" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_4 -->
<g id="edge22" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_4</title>
<path fill="none" stroke="black" d="M12848.15,-2171C12020.34,-2171 10398,-2171 10398,-2171 10398,-2171 10398,-2061.18 10398,-2061.18"/>
<polygon fill="black" stroke="black" points="10401.5,-2061.18 10398,-2051.18 10394.5,-2061.18 10401.5,-2061.18"/>
</g>
<!-- layer0_attn_qkv_5 -->
<g id="node29" class="node">
<title>layer0_attn_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="11551.5,-2051 10928.5,-2051 10928.5,-1983 11551.5,-1983 11551.5,-2051"/>
<text text-anchor="middle" x="11240" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 5</text>
<text text-anchor="middle" x="11240" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="11240" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="11240" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_5 -->
<g id="edge27" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_5</title>
<path fill="none" stroke="black" d="M12819.33,-2154C12203.21,-2154 11240,-2154 11240,-2154 11240,-2154 11240,-2061.22 11240,-2061.22"/>
<polygon fill="black" stroke="black" points="11243.5,-2061.22 11240,-2051.22 11236.5,-2061.22 11243.5,-2061.22"/>
</g>
<!-- layer0_attn_qkv_6 -->
<g id="node33" class="node">
<title>layer0_attn_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="12416.5,-2051 11793.5,-2051 11793.5,-1983 12416.5,-1983 12416.5,-2051"/>
<text text-anchor="middle" x="12105" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 6</text>
<text text-anchor="middle" x="12105" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="12105" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="12105" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_6 -->
<g id="edge32" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_6</title>
<path fill="none" stroke="black" d="M12790.86,-2137C12463.14,-2137 12105,-2137 12105,-2137 12105,-2137 12105,-2061.07 12105,-2061.07"/>
<polygon fill="black" stroke="black" points="12108.5,-2061.07 12105,-2051.07 12101.5,-2061.07 12108.5,-2061.07"/>
</g>
<!-- layer0_attn_qkv_7 -->
<g id="node37" class="node">
<title>layer0_attn_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="13258.5,-2051 12635.5,-2051 12635.5,-1983 13258.5,-1983 13258.5,-2051"/>
<text text-anchor="middle" x="12947" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 7</text>
<text text-anchor="middle" x="12947" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="12947" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="12947" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_7 -->
<g id="edge37" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_7</title>
<path fill="none" stroke="black" d="M13010.33,-2119.92C13010.33,-2119.92 13010.33,-2061.04 13010.33,-2061.04"/>
<polygon fill="black" stroke="black" points="13013.83,-2061.04 13010.33,-2051.04 13006.83,-2061.04 13013.83,-2061.04"/>
</g>
<!-- layer0_attn_qkv_8 -->
<g id="node41" class="node">
<title>layer0_attn_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="13985.5,-2051 13362.5,-2051 13362.5,-1983 13985.5,-1983 13985.5,-2051"/>
<text text-anchor="middle" x="13674" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 8</text>
<text text-anchor="middle" x="13674" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="13674" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="13674" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_8 -->
<g id="edge42" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_8</title>
<path fill="none" stroke="black" d="M13622.17,-2119.92C13622.17,-2119.92 13622.17,-2061.04 13622.17,-2061.04"/>
<polygon fill="black" stroke="black" points="13625.67,-2061.04 13622.17,-2051.04 13618.67,-2061.04 13625.67,-2061.04"/>
</g>
<!-- layer0_attn_qkv_9 -->
<g id="node45" class="node">
<title>layer0_attn_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="14837,-2051 14205,-2051 14205,-1983 14837,-1983 14837,-2051"/>
<text text-anchor="middle" x="14521" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 9</text>
<text text-anchor="middle" x="14521" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="14521" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="14521" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_9 -->
<g id="edge47" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_9</title>
<path fill="none" stroke="black" d="M13681.33,-2137C14034.54,-2137 14521,-2137 14521,-2137 14521,-2137 14521,-2061.07 14521,-2061.07"/>
<polygon fill="black" stroke="black" points="14524.5,-2061.07 14521,-2051.07 14517.5,-2061.07 14524.5,-2061.07"/>
</g>
<!-- layer0_attn_qkv_10 -->
<g id="node49" class="node">
<title>layer0_attn_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="15697.5,-2051 15056.5,-2051 15056.5,-1983 15697.5,-1983 15697.5,-2051"/>
<text text-anchor="middle" x="15377" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 10</text>
<text text-anchor="middle" x="15377" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="15377" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="15377" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_10 -->
<g id="edge52" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_10</title>
<path fill="none" stroke="black" d="M13710.04,-2154C14305.63,-2154 15377,-2154 15377,-2154 15377,-2154 15377,-2061.22 15377,-2061.22"/>
<polygon fill="black" stroke="black" points="15380.5,-2061.22 15377,-2051.22 15373.5,-2061.22 15380.5,-2061.22"/>
</g>
<!-- layer0_attn_qkv_11 -->
<g id="node53" class="node">
<title>layer0_attn_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="16557.5,-2051 15916.5,-2051 15916.5,-1983 16557.5,-1983 16557.5,-2051"/>
<text text-anchor="middle" x="16237" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 11</text>
<text text-anchor="middle" x="16237" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="16237" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="16237" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_11 -->
<g id="edge57" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_11</title>
<path fill="none" stroke="black" d="M13738.87,-2171C14544.59,-2171 16237,-2171 16237,-2171 16237,-2171 16237,-2061.18 16237,-2061.18"/>
<polygon fill="black" stroke="black" points="16240.5,-2061.18 16237,-2051.18 16233.5,-2061.18 16240.5,-2061.18"/>
</g>
<!-- layer0_attn_qkv_12 -->
<g id="node57" class="node">
<title>layer0_attn_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="17417.5,-2051 16776.5,-2051 16776.5,-1983 17417.5,-1983 17417.5,-2051"/>
<text text-anchor="middle" x="17097" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 12</text>
<text text-anchor="middle" x="17097" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="17097" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="17097" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_12 -->
<g id="edge62" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_12</title>
<path fill="none" stroke="black" d="M13767.54,-2188C14766.2,-2188 17097,-2188 17097,-2188 17097,-2188 17097,-2061.19 17097,-2061.19"/>
<polygon fill="black" stroke="black" points="17100.5,-2061.19 17097,-2051.19 17093.5,-2061.19 17100.5,-2061.19"/>
</g>
<!-- layer0_attn_qkv_13 -->
<g id="node61" class="node">
<title>layer0_attn_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="18277.5,-2051 17636.5,-2051 17636.5,-1983 18277.5,-1983 18277.5,-2051"/>
<text text-anchor="middle" x="17957" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 13</text>
<text text-anchor="middle" x="17957" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="17957" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="17957" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_13 -->
<g id="edge67" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_13</title>
<path fill="none" stroke="black" d="M13795.97,-2205C14977.1,-2205 17957,-2205 17957,-2205 17957,-2205 17957,-2061.05 17957,-2061.05"/>
<polygon fill="black" stroke="black" points="17960.5,-2061.05 17957,-2051.05 17953.5,-2061.05 17960.5,-2061.05"/>
</g>
<!-- layer0_attn_qkv_14 -->
<g id="node65" class="node">
<title>layer0_attn_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="19137.5,-2051 18496.5,-2051 18496.5,-1983 19137.5,-1983 19137.5,-2051"/>
<text text-anchor="middle" x="18817" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 14</text>
<text text-anchor="middle" x="18817" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="18817" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="18817" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_14 -->
<g id="edge72" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_14</title>
<path fill="none" stroke="black" d="M13824.52,-2222C15181.26,-2222 18817,-2222 18817,-2222 18817,-2222 18817,-2061.31 18817,-2061.31"/>
<polygon fill="black" stroke="black" points="18820.5,-2061.31 18817,-2051.31 18813.5,-2061.31 18820.5,-2061.31"/>
</g>
<!-- layer0_attn_qkv_15 -->
<g id="node69" class="node">
<title>layer0_attn_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="19997.5,-2051 19356.5,-2051 19356.5,-1983 19997.5,-1983 19997.5,-2051"/>
<text text-anchor="middle" x="19677" y="-2035.8" font-family="Times,serif" font-size="14.00">Layer 0 QKV Block 15</text>
<text text-anchor="middle" x="19677" y="-2020.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="19677" y="-2005.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="19677" y="-1990.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool&#45;&gt;layer0_attn_qkv_15 -->
<g id="edge77" class="edge">
<title>send_to_pool&#45;&gt;layer0_attn_qkv_15</title>
<path fill="none" stroke="black" d="M13853.23,-2239C15380.89,-2239 19677,-2239 19677,-2239 19677,-2239 19677,-2061.2 19677,-2061.2"/>
<polygon fill="black" stroke="black" points="19680.5,-2061.2 19677,-2051.2 19673.5,-2061.2 19680.5,-2061.2"/>
</g>
<!-- recv_from_pool -->
<g id="node8" class="node">
<title>recv_from_pool</title>
<polygon fill="yellow" stroke="black" points="13833.69,-1463 12943.35,-1463 12714.31,-1327 13604.65,-1327 13833.69,-1463"/>
<text text-anchor="middle" x="13274" y="-1413.8" font-family="Times,serif" font-size="14.00">Receive from Attention Pool</text>
<text text-anchor="middle" x="13274" y="-1398.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;{7+attention_pool_gpus}] → [0&#45;7]</text>
<text text-anchor="middle" x="13274" y="-1383.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="13274" y="-1368.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- recv_from_pool&#45;&gt;layer0_ffn_start -->
<g id="edge83" class="edge">
<title>recv_from_pool&#45;&gt;layer0_ffn_start</title>
<path fill="none" stroke="black" d="M13274,-1326.58C13274,-1326.58 13274,-1283.13 13274,-1283.13"/>
<polygon fill="black" stroke="black" points="13277.5,-1283.13 13274,-1273.13 13270.5,-1283.13 13277.5,-1283.13"/>
</g>
<!-- layer0_attn_scores_0 -->
<g id="node10" class="node">
<title>layer0_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="7262.5,-1947 6777.5,-1947 6777.5,-1879 7262.5,-1879 7262.5,-1947"/>
<text text-anchor="middle" x="7020" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 0</text>
<text text-anchor="middle" x="7020" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7020" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7020" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_0&#45;&gt;layer0_attn_scores_0 -->
<g id="edge3" class="edge">
<title>layer0_attn_qkv_0&#45;&gt;layer0_attn_scores_0</title>
<path fill="none" stroke="black" d="M7020,-1982.95C7020,-1982.95 7020,-1957.13 7020,-1957.13"/>
<polygon fill="black" stroke="black" points="7023.5,-1957.13 7020,-1947.13 7016.5,-1957.13 7023.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_0 -->
<g id="node11" class="node">
<title>layer0_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="7386.5,-1843 6607.5,-1843 6607.5,-1775 7386.5,-1775 7386.5,-1843"/>
<text text-anchor="middle" x="6997" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 0</text>
<text text-anchor="middle" x="6997" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="6997" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="6997" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_0&#45;&gt;layer0_attn_weighted_0 -->
<g id="edge4" class="edge">
<title>layer0_attn_scores_0&#45;&gt;layer0_attn_weighted_0</title>
<path fill="none" stroke="black" d="M7020,-1878.95C7020,-1878.95 7020,-1853.13 7020,-1853.13"/>
<polygon fill="black" stroke="black" points="7023.5,-1853.13 7020,-1843.13 7016.5,-1853.13 7023.5,-1853.13"/>
</g>
<!-- layer0_attn_out_0 -->
<g id="node12" class="node">
<title>layer0_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="7337,-1739 6755,-1739 6755,-1671 7337,-1671 7337,-1739"/>
<text text-anchor="middle" x="7046" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 0</text>
<text text-anchor="middle" x="7046" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7046" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7046" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_0&#45;&gt;layer0_attn_out_0 -->
<g id="edge5" class="edge">
<title>layer0_attn_weighted_0&#45;&gt;layer0_attn_out_0</title>
<path fill="none" stroke="black" d="M7046,-1774.95C7046,-1774.95 7046,-1749.13 7046,-1749.13"/>
<polygon fill="black" stroke="black" points="7049.5,-1749.13 7046,-1739.13 7042.5,-1749.13 7049.5,-1749.13"/>
</g>
<!-- layer0_attn_aggregate -->
<g id="node73" class="node">
<title>layer0_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="13943.99,-1635 12878.19,-1635 12604.01,-1499 13669.81,-1499 13943.99,-1635"/>
<text text-anchor="middle" x="13274" y="-1585.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Aggregation</text>
<text text-anchor="middle" x="13274" y="-1570.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="13274" y="-1555.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="13274" y="-1540.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_out_0&#45;&gt;layer0_attn_aggregate -->
<g id="edge6" class="edge">
<title>layer0_attn_out_0&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M7046,-1670.7C7046,-1616.72 7046,-1518 7046,-1518 7046,-1518 12632.19,-1518 12632.19,-1518"/>
<polygon fill="black" stroke="black" points="12632.19,-1521.5 12642.19,-1518 12632.19,-1514.5 12632.19,-1521.5"/>
</g>
<!-- layer0_attn_scores_1 -->
<g id="node14" class="node">
<title>layer0_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="8105,-1947 7593,-1947 7593,-1879 8105,-1879 8105,-1947"/>
<text text-anchor="middle" x="7849" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 1</text>
<text text-anchor="middle" x="7849" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7849" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7849" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_1&#45;&gt;layer0_attn_scores_1 -->
<g id="edge8" class="edge">
<title>layer0_attn_qkv_1&#45;&gt;layer0_attn_scores_1</title>
<path fill="none" stroke="black" d="M7849,-1982.95C7849,-1982.95 7849,-1957.13 7849,-1957.13"/>
<polygon fill="black" stroke="black" points="7852.5,-1957.13 7849,-1947.13 7845.5,-1957.13 7852.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_1 -->
<g id="node15" class="node">
<title>layer0_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="8229,-1843 7423,-1843 7423,-1775 8229,-1775 8229,-1843"/>
<text text-anchor="middle" x="7826" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 1</text>
<text text-anchor="middle" x="7826" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7826" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="7826" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_1&#45;&gt;layer0_attn_weighted_1 -->
<g id="edge9" class="edge">
<title>layer0_attn_scores_1&#45;&gt;layer0_attn_weighted_1</title>
<path fill="none" stroke="black" d="M7849,-1878.95C7849,-1878.95 7849,-1853.13 7849,-1853.13"/>
<polygon fill="black" stroke="black" points="7852.5,-1853.13 7849,-1843.13 7845.5,-1853.13 7852.5,-1853.13"/>
</g>
<!-- layer0_attn_out_1 -->
<g id="node16" class="node">
<title>layer0_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="8180.5,-1739 7571.5,-1739 7571.5,-1671 8180.5,-1671 8180.5,-1739"/>
<text text-anchor="middle" x="7876" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 1</text>
<text text-anchor="middle" x="7876" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="7876" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7876" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_1&#45;&gt;layer0_attn_out_1 -->
<g id="edge10" class="edge">
<title>layer0_attn_weighted_1&#45;&gt;layer0_attn_out_1</title>
<path fill="none" stroke="black" d="M7876,-1774.95C7876,-1774.95 7876,-1749.13 7876,-1749.13"/>
<polygon fill="black" stroke="black" points="7879.5,-1749.13 7876,-1739.13 7872.5,-1749.13 7879.5,-1749.13"/>
</g>
<!-- layer0_attn_out_1&#45;&gt;layer0_attn_aggregate -->
<g id="edge11" class="edge">
<title>layer0_attn_out_1&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M7993.17,-1670.6C7993.17,-1621.45 7993.17,-1537 7993.17,-1537 7993.17,-1537 12670.4,-1537 12670.4,-1537"/>
<polygon fill="black" stroke="black" points="12670.4,-1540.5 12680.4,-1537 12670.4,-1533.5 12670.4,-1540.5"/>
</g>
<!-- layer0_attn_scores_2 -->
<g id="node18" class="node">
<title>layer0_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="8947,-1947 8435,-1947 8435,-1879 8947,-1879 8947,-1947"/>
<text text-anchor="middle" x="8691" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 2</text>
<text text-anchor="middle" x="8691" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8691" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8691" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_2&#45;&gt;layer0_attn_scores_2 -->
<g id="edge13" class="edge">
<title>layer0_attn_qkv_2&#45;&gt;layer0_attn_scores_2</title>
<path fill="none" stroke="black" d="M8691,-1982.95C8691,-1982.95 8691,-1957.13 8691,-1957.13"/>
<polygon fill="black" stroke="black" points="8694.5,-1957.13 8691,-1947.13 8687.5,-1957.13 8694.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_2 -->
<g id="node19" class="node">
<title>layer0_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="9071,-1843 8265,-1843 8265,-1775 9071,-1775 9071,-1843"/>
<text text-anchor="middle" x="8668" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 2</text>
<text text-anchor="middle" x="8668" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8668" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="8668" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_2&#45;&gt;layer0_attn_weighted_2 -->
<g id="edge14" class="edge">
<title>layer0_attn_scores_2&#45;&gt;layer0_attn_weighted_2</title>
<path fill="none" stroke="black" d="M8691,-1878.95C8691,-1878.95 8691,-1853.13 8691,-1853.13"/>
<polygon fill="black" stroke="black" points="8694.5,-1853.13 8691,-1843.13 8687.5,-1853.13 8694.5,-1853.13"/>
</g>
<!-- layer0_attn_out_2 -->
<g id="node20" class="node">
<title>layer0_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="9021.5,-1739 8412.5,-1739 8412.5,-1671 9021.5,-1671 9021.5,-1739"/>
<text text-anchor="middle" x="8717" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 2</text>
<text text-anchor="middle" x="8717" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="8717" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8717" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_2&#45;&gt;layer0_attn_out_2 -->
<g id="edge15" class="edge">
<title>layer0_attn_weighted_2&#45;&gt;layer0_attn_out_2</title>
<path fill="none" stroke="black" d="M8717,-1774.95C8717,-1774.95 8717,-1749.13 8717,-1749.13"/>
<polygon fill="black" stroke="black" points="8720.5,-1749.13 8717,-1739.13 8713.5,-1749.13 8720.5,-1749.13"/>
</g>
<!-- layer0_attn_out_2&#45;&gt;layer0_attn_aggregate -->
<g id="edge16" class="edge">
<title>layer0_attn_out_2&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M8740.5,-1670.67C8740.5,-1626.95 8740.5,-1557 8740.5,-1557 8740.5,-1557 12710.94,-1557 12710.94,-1557"/>
<polygon fill="black" stroke="black" points="12710.94,-1560.5 12720.94,-1557 12710.94,-1553.5 12710.94,-1560.5"/>
</g>
<!-- layer0_attn_scores_3 -->
<g id="node22" class="node">
<title>layer0_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="9789,-1947 9277,-1947 9277,-1879 9789,-1879 9789,-1947"/>
<text text-anchor="middle" x="9533" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 3</text>
<text text-anchor="middle" x="9533" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9533" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9533" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_3&#45;&gt;layer0_attn_scores_3 -->
<g id="edge18" class="edge">
<title>layer0_attn_qkv_3&#45;&gt;layer0_attn_scores_3</title>
<path fill="none" stroke="black" d="M9533,-1982.95C9533,-1982.95 9533,-1957.13 9533,-1957.13"/>
<polygon fill="black" stroke="black" points="9536.5,-1957.13 9533,-1947.13 9529.5,-1957.13 9536.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_3 -->
<g id="node23" class="node">
<title>layer0_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="9913,-1843 9107,-1843 9107,-1775 9913,-1775 9913,-1843"/>
<text text-anchor="middle" x="9510" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 3</text>
<text text-anchor="middle" x="9510" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9510" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="9510" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_3&#45;&gt;layer0_attn_weighted_3 -->
<g id="edge19" class="edge">
<title>layer0_attn_scores_3&#45;&gt;layer0_attn_weighted_3</title>
<path fill="none" stroke="black" d="M9533,-1878.95C9533,-1878.95 9533,-1853.13 9533,-1853.13"/>
<polygon fill="black" stroke="black" points="9536.5,-1853.13 9533,-1843.13 9529.5,-1853.13 9536.5,-1853.13"/>
</g>
<!-- layer0_attn_out_3 -->
<g id="node24" class="node">
<title>layer0_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="9864.5,-1739 9255.5,-1739 9255.5,-1671 9864.5,-1671 9864.5,-1739"/>
<text text-anchor="middle" x="9560" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 3</text>
<text text-anchor="middle" x="9560" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="9560" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9560" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_3&#45;&gt;layer0_attn_out_3 -->
<g id="edge20" class="edge">
<title>layer0_attn_weighted_3&#45;&gt;layer0_attn_out_3</title>
<path fill="none" stroke="black" d="M9560,-1774.95C9560,-1774.95 9560,-1749.13 9560,-1749.13"/>
<polygon fill="black" stroke="black" points="9563.5,-1749.13 9560,-1739.13 9556.5,-1749.13 9563.5,-1749.13"/>
</g>
<!-- layer0_attn_out_3&#45;&gt;layer0_attn_aggregate -->
<g id="edge21" class="edge">
<title>layer0_attn_out_3&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M9565.17,-1670.77C9565.17,-1632.55 9565.17,-1576 9565.17,-1576 9565.17,-1576 12748.79,-1576 12748.79,-1576"/>
<polygon fill="black" stroke="black" points="12748.79,-1579.5 12758.79,-1576 12748.79,-1572.5 12748.79,-1579.5"/>
</g>
<!-- layer0_attn_scores_4 -->
<g id="node26" class="node">
<title>layer0_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="10631,-1947 10119,-1947 10119,-1879 10631,-1879 10631,-1947"/>
<text text-anchor="middle" x="10375" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 4</text>
<text text-anchor="middle" x="10375" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10375" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10375" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_4&#45;&gt;layer0_attn_scores_4 -->
<g id="edge23" class="edge">
<title>layer0_attn_qkv_4&#45;&gt;layer0_attn_scores_4</title>
<path fill="none" stroke="black" d="M10375,-1982.95C10375,-1982.95 10375,-1957.13 10375,-1957.13"/>
<polygon fill="black" stroke="black" points="10378.5,-1957.13 10375,-1947.13 10371.5,-1957.13 10378.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_4 -->
<g id="node27" class="node">
<title>layer0_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="10755,-1843 9949,-1843 9949,-1775 10755,-1775 10755,-1843"/>
<text text-anchor="middle" x="10352" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 4</text>
<text text-anchor="middle" x="10352" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10352" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="10352" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_4&#45;&gt;layer0_attn_weighted_4 -->
<g id="edge24" class="edge">
<title>layer0_attn_scores_4&#45;&gt;layer0_attn_weighted_4</title>
<path fill="none" stroke="black" d="M10375,-1878.95C10375,-1878.95 10375,-1853.13 10375,-1853.13"/>
<polygon fill="black" stroke="black" points="10378.5,-1853.13 10375,-1843.13 10371.5,-1853.13 10378.5,-1853.13"/>
</g>
<!-- layer0_attn_out_4 -->
<g id="node28" class="node">
<title>layer0_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="10705.5,-1739 10096.5,-1739 10096.5,-1671 10705.5,-1671 10705.5,-1739"/>
<text text-anchor="middle" x="10401" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 4</text>
<text text-anchor="middle" x="10401" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="10401" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10401" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_4&#45;&gt;layer0_attn_out_4 -->
<g id="edge25" class="edge">
<title>layer0_attn_weighted_4&#45;&gt;layer0_attn_out_4</title>
<path fill="none" stroke="black" d="M10401,-1774.95C10401,-1774.95 10401,-1749.13 10401,-1749.13"/>
<polygon fill="black" stroke="black" points="10404.5,-1749.13 10401,-1739.13 10397.5,-1749.13 10404.5,-1749.13"/>
</g>
<!-- layer0_attn_out_4&#45;&gt;layer0_attn_aggregate -->
<g id="edge26" class="edge">
<title>layer0_attn_out_4&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M10556.17,-1670.81C10556.17,-1638.84 10556.17,-1596 10556.17,-1596 10556.17,-1596 12789.42,-1596 12789.42,-1596"/>
<polygon fill="black" stroke="black" points="12789.42,-1599.5 12799.42,-1596 12789.42,-1592.5 12789.42,-1599.5"/>
</g>
<!-- layer0_attn_scores_5 -->
<g id="node30" class="node">
<title>layer0_attn_scores_5</title>
<polygon fill="lightblue" stroke="black" points="11473,-1947 10961,-1947 10961,-1879 11473,-1879 11473,-1947"/>
<text text-anchor="middle" x="11217" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 5</text>
<text text-anchor="middle" x="11217" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="11217" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11217" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_5&#45;&gt;layer0_attn_scores_5 -->
<g id="edge28" class="edge">
<title>layer0_attn_qkv_5&#45;&gt;layer0_attn_scores_5</title>
<path fill="none" stroke="black" d="M11217,-1982.95C11217,-1982.95 11217,-1957.13 11217,-1957.13"/>
<polygon fill="black" stroke="black" points="11220.5,-1957.13 11217,-1947.13 11213.5,-1957.13 11220.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_5 -->
<g id="node31" class="node">
<title>layer0_attn_weighted_5</title>
<polygon fill="lightblue" stroke="black" points="11597,-1843 10791,-1843 10791,-1775 11597,-1775 11597,-1843"/>
<text text-anchor="middle" x="11194" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 5</text>
<text text-anchor="middle" x="11194" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="11194" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="11194" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_5&#45;&gt;layer0_attn_weighted_5 -->
<g id="edge29" class="edge">
<title>layer0_attn_scores_5&#45;&gt;layer0_attn_weighted_5</title>
<path fill="none" stroke="black" d="M11217,-1878.95C11217,-1878.95 11217,-1853.13 11217,-1853.13"/>
<polygon fill="black" stroke="black" points="11220.5,-1853.13 11217,-1843.13 11213.5,-1853.13 11220.5,-1853.13"/>
</g>
<!-- layer0_attn_out_5 -->
<g id="node32" class="node">
<title>layer0_attn_out_5</title>
<polygon fill="lightblue" stroke="black" points="11548.5,-1739 10939.5,-1739 10939.5,-1671 11548.5,-1671 11548.5,-1739"/>
<text text-anchor="middle" x="11244" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 5</text>
<text text-anchor="middle" x="11244" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="11244" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11244" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_5&#45;&gt;layer0_attn_out_5 -->
<g id="edge30" class="edge">
<title>layer0_attn_weighted_5&#45;&gt;layer0_attn_out_5</title>
<path fill="none" stroke="black" d="M11244,-1774.95C11244,-1774.95 11244,-1749.13 11244,-1749.13"/>
<polygon fill="black" stroke="black" points="11247.5,-1749.13 11244,-1739.13 11240.5,-1749.13 11247.5,-1749.13"/>
</g>
<!-- layer0_attn_out_5&#45;&gt;layer0_attn_aggregate -->
<g id="edge31" class="edge">
<title>layer0_attn_out_5&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M11398.83,-1670.97C11398.83,-1645.49 11398.83,-1615 11398.83,-1615 11398.83,-1615 12827.61,-1615 12827.61,-1615"/>
<polygon fill="black" stroke="black" points="12827.61,-1618.5 12837.61,-1615 12827.61,-1611.5 12827.61,-1618.5"/>
</g>
<!-- layer0_attn_scores_6 -->
<g id="node34" class="node">
<title>layer0_attn_scores_6</title>
<polygon fill="lightblue" stroke="black" points="12315,-1947 11803,-1947 11803,-1879 12315,-1879 12315,-1947"/>
<text text-anchor="middle" x="12059" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 6</text>
<text text-anchor="middle" x="12059" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="12059" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12059" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_6&#45;&gt;layer0_attn_scores_6 -->
<g id="edge33" class="edge">
<title>layer0_attn_qkv_6&#45;&gt;layer0_attn_scores_6</title>
<path fill="none" stroke="black" d="M12059,-1982.95C12059,-1982.95 12059,-1957.13 12059,-1957.13"/>
<polygon fill="black" stroke="black" points="12062.5,-1957.13 12059,-1947.13 12055.5,-1957.13 12062.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_6 -->
<g id="node35" class="node">
<title>layer0_attn_weighted_6</title>
<polygon fill="lightblue" stroke="black" points="12439,-1843 11633,-1843 11633,-1775 12439,-1775 12439,-1843"/>
<text text-anchor="middle" x="12036" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 6</text>
<text text-anchor="middle" x="12036" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="12036" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="12036" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_6&#45;&gt;layer0_attn_weighted_6 -->
<g id="edge34" class="edge">
<title>layer0_attn_scores_6&#45;&gt;layer0_attn_weighted_6</title>
<path fill="none" stroke="black" d="M12059,-1878.95C12059,-1878.95 12059,-1853.13 12059,-1853.13"/>
<polygon fill="black" stroke="black" points="12062.5,-1853.13 12059,-1843.13 12055.5,-1853.13 12062.5,-1853.13"/>
</g>
<!-- layer0_attn_out_6 -->
<g id="node36" class="node">
<title>layer0_attn_out_6</title>
<polygon fill="lightblue" stroke="black" points="12389.5,-1739 11780.5,-1739 11780.5,-1671 12389.5,-1671 12389.5,-1739"/>
<text text-anchor="middle" x="12085" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 6</text>
<text text-anchor="middle" x="12085" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="12085" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12085" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_6&#45;&gt;layer0_attn_out_6 -->
<g id="edge35" class="edge">
<title>layer0_attn_weighted_6&#45;&gt;layer0_attn_out_6</title>
<path fill="none" stroke="black" d="M12085,-1774.95C12085,-1774.95 12085,-1749.13 12085,-1749.13"/>
<polygon fill="black" stroke="black" points="12088.5,-1749.13 12085,-1739.13 12081.5,-1749.13 12088.5,-1749.13"/>
</g>
<!-- layer0_attn_out_6&#45;&gt;layer0_attn_aggregate -->
<g id="edge36" class="edge">
<title>layer0_attn_out_6&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M12389.68,-1705C12506.98,-1705 12613.38,-1705 12613.38,-1705 12613.38,-1705 12613.38,-1577.1 12613.38,-1577.1"/>
<polygon fill="black" stroke="black" points="12616.88,-1577.1 12613.38,-1567.1 12609.88,-1577.1 12616.88,-1577.1"/>
</g>
<!-- layer0_attn_scores_7 -->
<g id="node38" class="node">
<title>layer0_attn_scores_7</title>
<polygon fill="lightblue" stroke="black" points="13157,-1947 12645,-1947 12645,-1879 13157,-1879 13157,-1947"/>
<text text-anchor="middle" x="12901" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 7</text>
<text text-anchor="middle" x="12901" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="12901" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12901" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_7&#45;&gt;layer0_attn_scores_7 -->
<g id="edge38" class="edge">
<title>layer0_attn_qkv_7&#45;&gt;layer0_attn_scores_7</title>
<path fill="none" stroke="black" d="M12901,-1982.95C12901,-1982.95 12901,-1957.13 12901,-1957.13"/>
<polygon fill="black" stroke="black" points="12904.5,-1957.13 12901,-1947.13 12897.5,-1957.13 12904.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_7 -->
<g id="node39" class="node">
<title>layer0_attn_weighted_7</title>
<polygon fill="lightblue" stroke="black" points="13281,-1843 12475,-1843 12475,-1775 13281,-1775 13281,-1843"/>
<text text-anchor="middle" x="12878" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 7</text>
<text text-anchor="middle" x="12878" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="12878" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="12878" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_7&#45;&gt;layer0_attn_weighted_7 -->
<g id="edge39" class="edge">
<title>layer0_attn_scores_7&#45;&gt;layer0_attn_weighted_7</title>
<path fill="none" stroke="black" d="M12901,-1878.95C12901,-1878.95 12901,-1853.13 12901,-1853.13"/>
<polygon fill="black" stroke="black" points="12904.5,-1853.13 12901,-1843.13 12897.5,-1853.13 12904.5,-1853.13"/>
</g>
<!-- layer0_attn_out_7 -->
<g id="node40" class="node">
<title>layer0_attn_out_7</title>
<polygon fill="lightblue" stroke="black" points="13231.5,-1739 12622.5,-1739 12622.5,-1671 13231.5,-1671 13231.5,-1739"/>
<text text-anchor="middle" x="12927" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 7</text>
<text text-anchor="middle" x="12927" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="12927" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12927" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_7&#45;&gt;layer0_attn_out_7 -->
<g id="edge40" class="edge">
<title>layer0_attn_weighted_7&#45;&gt;layer0_attn_out_7</title>
<path fill="none" stroke="black" d="M12927,-1774.95C12927,-1774.95 12927,-1749.13 12927,-1749.13"/>
<polygon fill="black" stroke="black" points="12930.5,-1749.13 12927,-1739.13 12923.5,-1749.13 12930.5,-1749.13"/>
</g>
<!-- layer0_attn_out_7&#45;&gt;layer0_attn_aggregate -->
<g id="edge41" class="edge">
<title>layer0_attn_out_7&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M12927,-1670.89C12927,-1670.89 12927,-1645.23 12927,-1645.23"/>
<polygon fill="black" stroke="black" points="12930.5,-1645.23 12927,-1635.23 12923.5,-1645.23 12930.5,-1645.23"/>
</g>
<!-- layer0_attn_scores_8 -->
<g id="node42" class="node">
<title>layer0_attn_scores_8</title>
<polygon fill="lightblue" stroke="black" points="13953,-1947 13441,-1947 13441,-1879 13953,-1879 13953,-1947"/>
<text text-anchor="middle" x="13697" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 8</text>
<text text-anchor="middle" x="13697" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="13697" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13697" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_8&#45;&gt;layer0_attn_scores_8 -->
<g id="edge43" class="edge">
<title>layer0_attn_qkv_8&#45;&gt;layer0_attn_scores_8</title>
<path fill="none" stroke="black" d="M13697,-1982.95C13697,-1982.95 13697,-1957.13 13697,-1957.13"/>
<polygon fill="black" stroke="black" points="13700.5,-1957.13 13697,-1947.13 13693.5,-1957.13 13700.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_8 -->
<g id="node43" class="node">
<title>layer0_attn_weighted_8</title>
<polygon fill="lightblue" stroke="black" points="14123,-1843 13317,-1843 13317,-1775 14123,-1775 14123,-1843"/>
<text text-anchor="middle" x="13720" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 8</text>
<text text-anchor="middle" x="13720" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="13720" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="13720" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_8&#45;&gt;layer0_attn_weighted_8 -->
<g id="edge44" class="edge">
<title>layer0_attn_scores_8&#45;&gt;layer0_attn_weighted_8</title>
<path fill="none" stroke="black" d="M13697,-1878.95C13697,-1878.95 13697,-1853.13 13697,-1853.13"/>
<polygon fill="black" stroke="black" points="13700.5,-1853.13 13697,-1843.13 13693.5,-1853.13 13700.5,-1853.13"/>
</g>
<!-- layer0_attn_out_8 -->
<g id="node44" class="node">
<title>layer0_attn_out_8</title>
<polygon fill="lightblue" stroke="black" points="13974.5,-1739 13365.5,-1739 13365.5,-1671 13974.5,-1671 13974.5,-1739"/>
<text text-anchor="middle" x="13670" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 8</text>
<text text-anchor="middle" x="13670" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="13670" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13670" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_8&#45;&gt;layer0_attn_out_8 -->
<g id="edge45" class="edge">
<title>layer0_attn_weighted_8&#45;&gt;layer0_attn_out_8</title>
<path fill="none" stroke="black" d="M13670,-1774.95C13670,-1774.95 13670,-1749.13 13670,-1749.13"/>
<polygon fill="black" stroke="black" points="13673.5,-1749.13 13670,-1739.13 13666.5,-1749.13 13673.5,-1749.13"/>
</g>
<!-- layer0_attn_out_8&#45;&gt;layer0_attn_aggregate -->
<g id="edge46" class="edge">
<title>layer0_attn_out_8&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M13654.62,-1670.89C13654.62,-1670.89 13654.62,-1645.23 13654.62,-1645.23"/>
<polygon fill="black" stroke="black" points="13658.12,-1645.23 13654.62,-1635.23 13651.12,-1645.23 13658.12,-1645.23"/>
</g>
<!-- layer0_attn_scores_9 -->
<g id="node46" class="node">
<title>layer0_attn_scores_9</title>
<polygon fill="lightblue" stroke="black" points="14804.5,-1947 14283.5,-1947 14283.5,-1879 14804.5,-1879 14804.5,-1947"/>
<text text-anchor="middle" x="14544" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 9</text>
<text text-anchor="middle" x="14544" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="14544" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14544" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_9&#45;&gt;layer0_attn_scores_9 -->
<g id="edge48" class="edge">
<title>layer0_attn_qkv_9&#45;&gt;layer0_attn_scores_9</title>
<path fill="none" stroke="black" d="M14544,-1982.95C14544,-1982.95 14544,-1957.13 14544,-1957.13"/>
<polygon fill="black" stroke="black" points="14547.5,-1957.13 14544,-1947.13 14540.5,-1957.13 14547.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_9 -->
<g id="node47" class="node">
<title>layer0_attn_weighted_9</title>
<polygon fill="lightblue" stroke="black" points="14974.5,-1843 14159.5,-1843 14159.5,-1775 14974.5,-1775 14974.5,-1843"/>
<text text-anchor="middle" x="14567" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 9</text>
<text text-anchor="middle" x="14567" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="14567" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="14567" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_9&#45;&gt;layer0_attn_weighted_9 -->
<g id="edge49" class="edge">
<title>layer0_attn_scores_9&#45;&gt;layer0_attn_weighted_9</title>
<path fill="none" stroke="black" d="M14544,-1878.95C14544,-1878.95 14544,-1853.13 14544,-1853.13"/>
<polygon fill="black" stroke="black" points="14547.5,-1853.13 14544,-1843.13 14540.5,-1853.13 14547.5,-1853.13"/>
</g>
<!-- layer0_attn_out_9 -->
<g id="node48" class="node">
<title>layer0_attn_out_9</title>
<polygon fill="lightblue" stroke="black" points="14826,-1739 14208,-1739 14208,-1671 14826,-1671 14826,-1739"/>
<text text-anchor="middle" x="14517" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 9</text>
<text text-anchor="middle" x="14517" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="14517" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14517" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_9&#45;&gt;layer0_attn_out_9 -->
<g id="edge50" class="edge">
<title>layer0_attn_weighted_9&#45;&gt;layer0_attn_out_9</title>
<path fill="none" stroke="black" d="M14517,-1774.95C14517,-1774.95 14517,-1749.13 14517,-1749.13"/>
<polygon fill="black" stroke="black" points="14520.5,-1749.13 14517,-1739.13 14513.5,-1749.13 14520.5,-1749.13"/>
</g>
<!-- layer0_attn_out_9&#45;&gt;layer0_attn_aggregate -->
<g id="edge51" class="edge">
<title>layer0_attn_out_9&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M14446,-1670.62C14446,-1646.3 14446,-1618 14446,-1618 14446,-1618 13919.73,-1618 13919.73,-1618"/>
<polygon fill="black" stroke="black" points="13919.73,-1614.5 13909.73,-1618 13919.73,-1621.5 13919.73,-1614.5"/>
</g>
<!-- layer0_attn_scores_10 -->
<g id="node50" class="node">
<title>layer0_attn_scores_10</title>
<polygon fill="lightblue" stroke="black" points="15665,-1947 15135,-1947 15135,-1879 15665,-1879 15665,-1947"/>
<text text-anchor="middle" x="15400" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 10</text>
<text text-anchor="middle" x="15400" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="15400" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15400" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_10&#45;&gt;layer0_attn_scores_10 -->
<g id="edge53" class="edge">
<title>layer0_attn_qkv_10&#45;&gt;layer0_attn_scores_10</title>
<path fill="none" stroke="black" d="M15400,-1982.95C15400,-1982.95 15400,-1957.13 15400,-1957.13"/>
<polygon fill="black" stroke="black" points="15403.5,-1957.13 15400,-1947.13 15396.5,-1957.13 15403.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_10 -->
<g id="node51" class="node">
<title>layer0_attn_weighted_10</title>
<polygon fill="lightblue" stroke="black" points="15835,-1843 15011,-1843 15011,-1775 15835,-1775 15835,-1843"/>
<text text-anchor="middle" x="15423" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 10</text>
<text text-anchor="middle" x="15423" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="15423" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="15423" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_10&#45;&gt;layer0_attn_weighted_10 -->
<g id="edge54" class="edge">
<title>layer0_attn_scores_10&#45;&gt;layer0_attn_weighted_10</title>
<path fill="none" stroke="black" d="M15400,-1878.95C15400,-1878.95 15400,-1853.13 15400,-1853.13"/>
<polygon fill="black" stroke="black" points="15403.5,-1853.13 15400,-1843.13 15396.5,-1853.13 15403.5,-1853.13"/>
</g>
<!-- layer0_attn_out_10 -->
<g id="node52" class="node">
<title>layer0_attn_out_10</title>
<polygon fill="lightblue" stroke="black" points="15686.5,-1739 15059.5,-1739 15059.5,-1671 15686.5,-1671 15686.5,-1739"/>
<text text-anchor="middle" x="15373" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 10</text>
<text text-anchor="middle" x="15373" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="15373" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15373" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_10&#45;&gt;layer0_attn_out_10 -->
<g id="edge55" class="edge">
<title>layer0_attn_weighted_10&#45;&gt;layer0_attn_out_10</title>
<path fill="none" stroke="black" d="M15373,-1774.95C15373,-1774.95 15373,-1749.13 15373,-1749.13"/>
<polygon fill="black" stroke="black" points="15376.5,-1749.13 15373,-1739.13 15369.5,-1749.13 15376.5,-1749.13"/>
</g>
<!-- layer0_attn_out_10&#45;&gt;layer0_attn_aggregate -->
<g id="edge56" class="edge">
<title>layer0_attn_out_10&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M15159.75,-1670.95C15159.75,-1640.62 15159.75,-1601 15159.75,-1601 15159.75,-1601 13885.52,-1601 13885.52,-1601"/>
<polygon fill="black" stroke="black" points="13885.52,-1597.5 13875.52,-1601 13885.52,-1604.5 13885.52,-1597.5"/>
</g>
<!-- layer0_attn_scores_11 -->
<g id="node54" class="node">
<title>layer0_attn_scores_11</title>
<polygon fill="lightblue" stroke="black" points="16525,-1947 15995,-1947 15995,-1879 16525,-1879 16525,-1947"/>
<text text-anchor="middle" x="16260" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 11</text>
<text text-anchor="middle" x="16260" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="16260" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16260" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_11&#45;&gt;layer0_attn_scores_11 -->
<g id="edge58" class="edge">
<title>layer0_attn_qkv_11&#45;&gt;layer0_attn_scores_11</title>
<path fill="none" stroke="black" d="M16260,-1982.95C16260,-1982.95 16260,-1957.13 16260,-1957.13"/>
<polygon fill="black" stroke="black" points="16263.5,-1957.13 16260,-1947.13 16256.5,-1957.13 16263.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_11 -->
<g id="node55" class="node">
<title>layer0_attn_weighted_11</title>
<polygon fill="lightblue" stroke="black" points="16695,-1843 15871,-1843 15871,-1775 16695,-1775 16695,-1843"/>
<text text-anchor="middle" x="16283" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 11</text>
<text text-anchor="middle" x="16283" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="16283" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="16283" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_11&#45;&gt;layer0_attn_weighted_11 -->
<g id="edge59" class="edge">
<title>layer0_attn_scores_11&#45;&gt;layer0_attn_weighted_11</title>
<path fill="none" stroke="black" d="M16260,-1878.95C16260,-1878.95 16260,-1853.13 16260,-1853.13"/>
<polygon fill="black" stroke="black" points="16263.5,-1853.13 16260,-1843.13 16256.5,-1853.13 16263.5,-1853.13"/>
</g>
<!-- layer0_attn_out_11 -->
<g id="node56" class="node">
<title>layer0_attn_out_11</title>
<polygon fill="lightblue" stroke="black" points="16546.5,-1739 15919.5,-1739 15919.5,-1671 16546.5,-1671 16546.5,-1739"/>
<text text-anchor="middle" x="16233" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 11</text>
<text text-anchor="middle" x="16233" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="16233" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16233" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_11&#45;&gt;layer0_attn_out_11 -->
<g id="edge60" class="edge">
<title>layer0_attn_weighted_11&#45;&gt;layer0_attn_out_11</title>
<path fill="none" stroke="black" d="M16233,-1774.95C16233,-1774.95 16233,-1749.13 16233,-1749.13"/>
<polygon fill="black" stroke="black" points="16236.5,-1749.13 16233,-1739.13 16229.5,-1749.13 16236.5,-1749.13"/>
</g>
<!-- layer0_attn_out_11&#45;&gt;layer0_attn_aggregate -->
<g id="edge61" class="edge">
<title>layer0_attn_out_11&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M15931.98,-1670.97C15931.98,-1635.18 15931.98,-1584 15931.98,-1584 15931.98,-1584 13851.35,-1584 13851.35,-1584"/>
<polygon fill="black" stroke="black" points="13851.35,-1580.5 13841.35,-1584 13851.35,-1587.5 13851.35,-1580.5"/>
</g>
<!-- layer0_attn_scores_12 -->
<g id="node58" class="node">
<title>layer0_attn_scores_12</title>
<polygon fill="lightblue" stroke="black" points="17385,-1947 16855,-1947 16855,-1879 17385,-1879 17385,-1947"/>
<text text-anchor="middle" x="17120" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 12</text>
<text text-anchor="middle" x="17120" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="17120" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17120" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_12&#45;&gt;layer0_attn_scores_12 -->
<g id="edge63" class="edge">
<title>layer0_attn_qkv_12&#45;&gt;layer0_attn_scores_12</title>
<path fill="none" stroke="black" d="M17120,-1982.95C17120,-1982.95 17120,-1957.13 17120,-1957.13"/>
<polygon fill="black" stroke="black" points="17123.5,-1957.13 17120,-1947.13 17116.5,-1957.13 17123.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_12 -->
<g id="node59" class="node">
<title>layer0_attn_weighted_12</title>
<polygon fill="lightblue" stroke="black" points="17555,-1843 16731,-1843 16731,-1775 17555,-1775 17555,-1843"/>
<text text-anchor="middle" x="17143" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 12</text>
<text text-anchor="middle" x="17143" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="17143" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="17143" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_12&#45;&gt;layer0_attn_weighted_12 -->
<g id="edge64" class="edge">
<title>layer0_attn_scores_12&#45;&gt;layer0_attn_weighted_12</title>
<path fill="none" stroke="black" d="M17120,-1878.95C17120,-1878.95 17120,-1853.13 17120,-1853.13"/>
<polygon fill="black" stroke="black" points="17123.5,-1853.13 17120,-1843.13 17116.5,-1853.13 17123.5,-1853.13"/>
</g>
<!-- layer0_attn_out_12 -->
<g id="node60" class="node">
<title>layer0_attn_out_12</title>
<polygon fill="lightblue" stroke="black" points="17406.5,-1739 16779.5,-1739 16779.5,-1671 17406.5,-1671 17406.5,-1739"/>
<text text-anchor="middle" x="17093" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 12</text>
<text text-anchor="middle" x="17093" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="17093" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17093" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_12&#45;&gt;layer0_attn_out_12 -->
<g id="edge65" class="edge">
<title>layer0_attn_weighted_12&#45;&gt;layer0_attn_out_12</title>
<path fill="none" stroke="black" d="M17093,-1774.95C17093,-1774.95 17093,-1749.13 17093,-1749.13"/>
<polygon fill="black" stroke="black" points="17096.5,-1749.13 17093,-1739.13 17089.5,-1749.13 17096.5,-1749.13"/>
</g>
<!-- layer0_attn_out_12&#45;&gt;layer0_attn_aggregate -->
<g id="edge66" class="edge">
<title>layer0_attn_out_12&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M16842.5,-1670.89C16842.5,-1630.02 16842.5,-1567 16842.5,-1567 16842.5,-1567 13817.28,-1567 13817.28,-1567"/>
<polygon fill="black" stroke="black" points="13817.28,-1563.5 13807.28,-1567 13817.28,-1570.5 13817.28,-1563.5"/>
</g>
<!-- layer0_attn_scores_13 -->
<g id="node62" class="node">
<title>layer0_attn_scores_13</title>
<polygon fill="lightblue" stroke="black" points="18245,-1947 17715,-1947 17715,-1879 18245,-1879 18245,-1947"/>
<text text-anchor="middle" x="17980" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 13</text>
<text text-anchor="middle" x="17980" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="17980" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17980" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_13&#45;&gt;layer0_attn_scores_13 -->
<g id="edge68" class="edge">
<title>layer0_attn_qkv_13&#45;&gt;layer0_attn_scores_13</title>
<path fill="none" stroke="black" d="M17980,-1982.95C17980,-1982.95 17980,-1957.13 17980,-1957.13"/>
<polygon fill="black" stroke="black" points="17983.5,-1957.13 17980,-1947.13 17976.5,-1957.13 17983.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_13 -->
<g id="node63" class="node">
<title>layer0_attn_weighted_13</title>
<polygon fill="lightblue" stroke="black" points="18415,-1843 17591,-1843 17591,-1775 18415,-1775 18415,-1843"/>
<text text-anchor="middle" x="18003" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 13</text>
<text text-anchor="middle" x="18003" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="18003" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="18003" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_13&#45;&gt;layer0_attn_weighted_13 -->
<g id="edge69" class="edge">
<title>layer0_attn_scores_13&#45;&gt;layer0_attn_weighted_13</title>
<path fill="none" stroke="black" d="M17980,-1878.95C17980,-1878.95 17980,-1853.13 17980,-1853.13"/>
<polygon fill="black" stroke="black" points="17983.5,-1853.13 17980,-1843.13 17976.5,-1853.13 17983.5,-1853.13"/>
</g>
<!-- layer0_attn_out_13 -->
<g id="node64" class="node">
<title>layer0_attn_out_13</title>
<polygon fill="lightblue" stroke="black" points="18266.5,-1739 17639.5,-1739 17639.5,-1671 18266.5,-1671 18266.5,-1739"/>
<text text-anchor="middle" x="17953" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 13</text>
<text text-anchor="middle" x="17953" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="17953" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17953" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_13&#45;&gt;layer0_attn_out_13 -->
<g id="edge70" class="edge">
<title>layer0_attn_weighted_13&#45;&gt;layer0_attn_out_13</title>
<path fill="none" stroke="black" d="M17953,-1774.95C17953,-1774.95 17953,-1749.13 17953,-1749.13"/>
<polygon fill="black" stroke="black" points="17956.5,-1749.13 17953,-1739.13 17949.5,-1749.13 17956.5,-1749.13"/>
</g>
<!-- layer0_attn_out_13&#45;&gt;layer0_attn_aggregate -->
<g id="edge71" class="edge">
<title>layer0_attn_out_13&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M17710.17,-1670.98C17710.17,-1625.36 17710.17,-1550 17710.17,-1550 17710.17,-1550 13782.65,-1550 13782.65,-1550"/>
<polygon fill="black" stroke="black" points="13782.65,-1546.5 13772.65,-1550 13782.65,-1553.5 13782.65,-1546.5"/>
</g>
<!-- layer0_attn_scores_14 -->
<g id="node66" class="node">
<title>layer0_attn_scores_14</title>
<polygon fill="lightblue" stroke="black" points="19105,-1947 18575,-1947 18575,-1879 19105,-1879 19105,-1947"/>
<text text-anchor="middle" x="18840" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 14</text>
<text text-anchor="middle" x="18840" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="18840" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
<text text-anchor="middle" x="18840" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_14&#45;&gt;layer0_attn_scores_14 -->
<g id="edge73" class="edge">
<title>layer0_attn_qkv_14&#45;&gt;layer0_attn_scores_14</title>
<path fill="none" stroke="black" d="M18840,-1982.95C18840,-1982.95 18840,-1957.13 18840,-1957.13"/>
<polygon fill="black" stroke="black" points="18843.5,-1957.13 18840,-1947.13 18836.5,-1957.13 18843.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_14 -->
<g id="node67" class="node">
<title>layer0_attn_weighted_14</title>
<polygon fill="lightblue" stroke="black" points="19275,-1843 18451,-1843 18451,-1775 19275,-1775 19275,-1843"/>
<text text-anchor="middle" x="18863" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 14</text>
<text text-anchor="middle" x="18863" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="18863" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="18863" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_14&#45;&gt;layer0_attn_weighted_14 -->
<g id="edge74" class="edge">
<title>layer0_attn_scores_14&#45;&gt;layer0_attn_weighted_14</title>
<path fill="none" stroke="black" d="M18840,-1878.95C18840,-1878.95 18840,-1853.13 18840,-1853.13"/>
<polygon fill="black" stroke="black" points="18843.5,-1853.13 18840,-1843.13 18836.5,-1853.13 18843.5,-1853.13"/>
</g>
<!-- layer0_attn_out_14 -->
<g id="node68" class="node">
<title>layer0_attn_out_14</title>
<polygon fill="lightblue" stroke="black" points="19126.5,-1739 18499.5,-1739 18499.5,-1671 19126.5,-1671 19126.5,-1739"/>
<text text-anchor="middle" x="18813" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 14</text>
<text text-anchor="middle" x="18813" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="18813" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
<text text-anchor="middle" x="18813" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_14&#45;&gt;layer0_attn_out_14 -->
<g id="edge75" class="edge">
<title>layer0_attn_weighted_14&#45;&gt;layer0_attn_out_14</title>
<path fill="none" stroke="black" d="M18813,-1774.95C18813,-1774.95 18813,-1749.13 18813,-1749.13"/>
<polygon fill="black" stroke="black" points="18816.5,-1749.13 18813,-1739.13 18809.5,-1749.13 18816.5,-1749.13"/>
</g>
<!-- layer0_attn_out_14&#45;&gt;layer0_attn_aggregate -->
<g id="edge76" class="edge">
<title>layer0_attn_out_14&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M18562.5,-1670.61C18562.5,-1620.41 18562.5,-1533 18562.5,-1533 18562.5,-1533 13748.4,-1533 13748.4,-1533"/>
<polygon fill="black" stroke="black" points="13748.4,-1529.5 13738.4,-1533 13748.39,-1536.5 13748.4,-1529.5"/>
</g>
<!-- layer0_attn_scores_15 -->
<g id="node70" class="node">
<title>layer0_attn_scores_15</title>
<polygon fill="lightblue" stroke="black" points="19965,-1947 19435,-1947 19435,-1879 19965,-1879 19965,-1947"/>
<text text-anchor="middle" x="19700" y="-1931.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Scores Block 15</text>
<text text-anchor="middle" x="19700" y="-1916.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="19700" y="-1901.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
<text text-anchor="middle" x="19700" y="-1886.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_qkv_15&#45;&gt;layer0_attn_scores_15 -->
<g id="edge78" class="edge">
<title>layer0_attn_qkv_15&#45;&gt;layer0_attn_scores_15</title>
<path fill="none" stroke="black" d="M19700,-1982.95C19700,-1982.95 19700,-1957.13 19700,-1957.13"/>
<polygon fill="black" stroke="black" points="19703.5,-1957.13 19700,-1947.13 19696.5,-1957.13 19703.5,-1957.13"/>
</g>
<!-- layer0_attn_weighted_15 -->
<g id="node71" class="node">
<title>layer0_attn_weighted_15</title>
<polygon fill="lightblue" stroke="black" points="20135,-1843 19311,-1843 19311,-1775 20135,-1775 20135,-1843"/>
<text text-anchor="middle" x="19723" y="-1827.8" font-family="Times,serif" font-size="14.00">Layer 0 Weighted Sum Block 15</text>
<text text-anchor="middle" x="19723" y="-1812.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="19723" y="-1797.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="19723" y="-1782.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
</g>
<!-- layer0_attn_scores_15&#45;&gt;layer0_attn_weighted_15 -->
<g id="edge79" class="edge">
<title>layer0_attn_scores_15&#45;&gt;layer0_attn_weighted_15</title>
<path fill="none" stroke="black" d="M19700,-1878.95C19700,-1878.95 19700,-1853.13 19700,-1853.13"/>
<polygon fill="black" stroke="black" points="19703.5,-1853.13 19700,-1843.13 19696.5,-1853.13 19703.5,-1853.13"/>
</g>
<!-- layer0_attn_out_15 -->
<g id="node72" class="node">
<title>layer0_attn_out_15</title>
<polygon fill="lightblue" stroke="black" points="19986.5,-1739 19359.5,-1739 19359.5,-1671 19986.5,-1671 19986.5,-1739"/>
<text text-anchor="middle" x="19673" y="-1723.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention Output Block 15</text>
<text text-anchor="middle" x="19673" y="-1708.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="19673" y="-1693.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
<text text-anchor="middle" x="19673" y="-1678.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer0_attn_weighted_15&#45;&gt;layer0_attn_out_15 -->
<g id="edge80" class="edge">
<title>layer0_attn_weighted_15&#45;&gt;layer0_attn_out_15</title>
<path fill="none" stroke="black" d="M19673,-1774.95C19673,-1774.95 19673,-1749.13 19673,-1749.13"/>
<polygon fill="black" stroke="black" points="19676.5,-1749.13 19673,-1739.13 19669.5,-1749.13 19676.5,-1749.13"/>
</g>
<!-- layer0_attn_out_15&#45;&gt;layer0_attn_aggregate -->
<g id="edge81" class="edge">
<title>layer0_attn_out_15&#45;&gt;layer0_attn_aggregate</title>
<path fill="none" stroke="black" d="M19420.83,-1670.77C19420.83,-1616.31 19420.83,-1516 19420.83,-1516 19420.83,-1516 13714.09,-1516 13714.09,-1516"/>
<polygon fill="black" stroke="black" points="13714.09,-1512.5 13704.09,-1516 13714.09,-1519.5 13714.09,-1512.5"/>
</g>
<!-- layer0_attn_aggregate&#45;&gt;recv_from_pool -->
<g id="edge82" class="edge">
<title>layer0_attn_aggregate&#45;&gt;recv_from_pool</title>
<path fill="none" stroke="black" d="M13274,-1498.53C13274,-1498.53 13274,-1473.24 13274,-1473.24"/>
<polygon fill="black" stroke="black" points="13277.5,-1473.24 13274,-1463.24 13270.5,-1473.24 13277.5,-1473.24"/>
</g>
<!-- layer1_attn_qkv_0 -->
<g id="node75" class="node">
<title>layer1_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="9196,-792 8600,-792 8600,-724 9196,-724 9196,-792"/>
<text text-anchor="middle" x="8898" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 0</text>
<text text-anchor="middle" x="8898" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8898" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="8898" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_0 -->
<g id="edge86" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_0</title>
<path fill="none" stroke="black" d="M7583.78,-865C8062.55,-865 8881,-865 8881,-865 8881,-865 8881,-802.15 8881,-802.15"/>
<polygon fill="black" stroke="black" points="8884.5,-802.15 8881,-792.15 8877.5,-802.15 8884.5,-802.15"/>
</g>
<!-- layer1_attn_qkv_1 -->
<g id="node79" class="node">
<title>layer1_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="10038.5,-792 9415.5,-792 9415.5,-724 10038.5,-724 10038.5,-792"/>
<text text-anchor="middle" x="9727" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 1</text>
<text text-anchor="middle" x="9727" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9727" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="9727" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_1 -->
<g id="edge91" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_1</title>
<path fill="none" stroke="black" d="M7591.88,-870C8271.34,-870 9714.83,-870 9714.83,-870 9714.83,-870 9714.83,-802.21 9714.83,-802.21"/>
<polygon fill="black" stroke="black" points="9718.33,-802.21 9714.83,-792.21 9711.33,-802.21 9718.33,-802.21"/>
</g>
<!-- layer1_attn_qkv_2 -->
<g id="node83" class="node">
<title>layer1_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="10880.5,-792 10257.5,-792 10257.5,-724 10880.5,-724 10880.5,-792"/>
<text text-anchor="middle" x="10569" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 2</text>
<text text-anchor="middle" x="10569" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10569" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="10569" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_2 -->
<g id="edge96" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_2</title>
<path fill="none" stroke="black" d="M7600.53,-875C8426.03,-875 10406.83,-875 10406.83,-875 10406.83,-875 10406.83,-802.16 10406.83,-802.16"/>
<polygon fill="black" stroke="black" points="10410.33,-802.16 10406.83,-792.16 10403.33,-802.16 10410.33,-802.16"/>
</g>
<!-- layer1_attn_qkv_3 -->
<g id="node87" class="node">
<title>layer1_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="11722.5,-792 11099.5,-792 11099.5,-724 11722.5,-724 11722.5,-792"/>
<text text-anchor="middle" x="11411" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 3</text>
<text text-anchor="middle" x="11411" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11411" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="11411" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_3 -->
<g id="edge101" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_3</title>
<path fill="none" stroke="black" d="M7608.76,-880C8594.53,-880 11249.17,-880 11249.17,-880 11249.17,-880 11249.17,-802.31 11249.17,-802.31"/>
<polygon fill="black" stroke="black" points="11252.67,-802.31 11249.17,-792.31 11245.67,-802.31 11252.67,-802.31"/>
</g>
<!-- layer1_attn_qkv_4 -->
<g id="node91" class="node">
<title>layer1_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="12564.5,-792 11941.5,-792 11941.5,-724 12564.5,-724 12564.5,-792"/>
<text text-anchor="middle" x="12253" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 4</text>
<text text-anchor="middle" x="12253" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12253" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="12253" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_4 -->
<g id="edge106" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_4</title>
<path fill="none" stroke="black" d="M7617.27,-885C8762.85,-885 12165.5,-885 12165.5,-885 12165.5,-885 12165.5,-802.03 12165.5,-802.03"/>
<polygon fill="black" stroke="black" points="12169,-802.03 12165.5,-792.03 12162,-802.03 12169,-802.03"/>
</g>
<!-- layer1_attn_qkv_5 -->
<g id="node95" class="node">
<title>layer1_attn_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="13406.5,-792 12783.5,-792 12783.5,-724 13406.5,-724 13406.5,-792"/>
<text text-anchor="middle" x="13095" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 5</text>
<text text-anchor="middle" x="13095" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="13095" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="13095" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_5 -->
<g id="edge111" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_5</title>
<path fill="none" stroke="black" d="M7625.61,-890C8892.21,-890 12893.75,-890 12893.75,-890 12893.75,-890 12893.75,-802.34 12893.75,-802.34"/>
<polygon fill="black" stroke="black" points="12897.25,-802.34 12893.75,-792.34 12890.25,-802.34 12897.25,-802.34"/>
</g>
<!-- layer1_attn_qkv_6 -->
<g id="node99" class="node">
<title>layer1_attn_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="776.5,-792 153.5,-792 153.5,-724 776.5,-724 776.5,-792"/>
<text text-anchor="middle" x="465" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 6</text>
<text text-anchor="middle" x="465" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="465" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="465" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_6 -->
<g id="edge116" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_6</title>
<path fill="none" stroke="black" d="M6886.51,-980C5485.04,-980 465,-980 465,-980 465,-980 465,-802.2 465,-802.2"/>
<polygon fill="black" stroke="black" points="468.5,-802.2 465,-792.2 461.5,-802.2 468.5,-802.2"/>
</g>
<!-- layer1_attn_qkv_7 -->
<g id="node103" class="node">
<title>layer1_attn_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="1641.5,-792 1018.5,-792 1018.5,-724 1641.5,-724 1641.5,-792"/>
<text text-anchor="middle" x="1330" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 7</text>
<text text-anchor="middle" x="1330" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="1330" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="1330" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_7 -->
<g id="edge121" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_7</title>
<path fill="none" stroke="black" d="M6857.83,-963C5541.68,-963 1330,-963 1330,-963 1330,-963 1330,-802.31 1330,-802.31"/>
<polygon fill="black" stroke="black" points="1333.5,-802.31 1330,-792.31 1326.5,-802.31 1333.5,-802.31"/>
</g>
<!-- layer1_attn_qkv_8 -->
<g id="node107" class="node">
<title>layer1_attn_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="2460.5,-792 1837.5,-792 1837.5,-724 2460.5,-724 2460.5,-792"/>
<text text-anchor="middle" x="2149" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 8</text>
<text text-anchor="middle" x="2149" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="2149" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="2149" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_8 -->
<g id="edge126" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_8</title>
<path fill="none" stroke="black" d="M6829.43,-946C5612.6,-946 2149,-946 2149,-946 2149,-946 2149,-802.05 2149,-802.05"/>
<polygon fill="black" stroke="black" points="2152.5,-802.05 2149,-792.05 2145.5,-802.05 2152.5,-802.05"/>
</g>
<!-- layer1_attn_qkv_9 -->
<g id="node111" class="node">
<title>layer1_attn_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="3335,-792 2703,-792 2703,-724 3335,-724 3335,-792"/>
<text text-anchor="middle" x="3019" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 9</text>
<text text-anchor="middle" x="3019" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="3019" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="3019" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_9 -->
<g id="edge131" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_9</title>
<path fill="none" stroke="black" d="M6800.63,-929C5714.71,-929 3019,-929 3019,-929 3019,-929 3019,-802.19 3019,-802.19"/>
<polygon fill="black" stroke="black" points="3022.5,-802.19 3019,-792.19 3015.5,-802.19 3022.5,-802.19"/>
</g>
<!-- layer1_attn_qkv_10 -->
<g id="node115" class="node">
<title>layer1_attn_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="4172.5,-792 3531.5,-792 3531.5,-724 4172.5,-724 4172.5,-792"/>
<text text-anchor="middle" x="3852" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 10</text>
<text text-anchor="middle" x="3852" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="3852" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="3852" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_10 -->
<g id="edge136" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_10</title>
<path fill="none" stroke="black" d="M6771.85,-912C5838.33,-912 3852,-912 3852,-912 3852,-912 3852,-802.18 3852,-802.18"/>
<polygon fill="black" stroke="black" points="3855.5,-802.18 3852,-792.18 3848.5,-802.18 3855.5,-802.18"/>
</g>
<!-- layer1_attn_qkv_11 -->
<g id="node119" class="node">
<title>layer1_attn_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="5055.5,-792 4414.5,-792 4414.5,-724 5055.5,-724 5055.5,-792"/>
<text text-anchor="middle" x="4735" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 11</text>
<text text-anchor="middle" x="4735" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="4735" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="4735" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_11 -->
<g id="edge141" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_11</title>
<path fill="none" stroke="black" d="M6743.52,-895C6010.69,-895 4735,-895 4735,-895 4735,-895 4735,-802.22 4735,-802.22"/>
<polygon fill="black" stroke="black" points="4738.5,-802.22 4735,-792.22 4731.5,-802.22 4738.5,-802.22"/>
</g>
<!-- layer1_attn_qkv_12 -->
<g id="node123" class="node">
<title>layer1_attn_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="5892.5,-792 5251.5,-792 5251.5,-724 5892.5,-724 5892.5,-792"/>
<text text-anchor="middle" x="5572" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 12</text>
<text text-anchor="middle" x="5572" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="5572" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="5572" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_12 -->
<g id="edge146" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_12</title>
<path fill="none" stroke="black" d="M6714.9,-878C6224.63,-878 5572,-878 5572,-878 5572,-878 5572,-802.07 5572,-802.07"/>
<polygon fill="black" stroke="black" points="5575.5,-802.07 5572,-792.07 5568.5,-802.07 5575.5,-802.07"/>
</g>
<!-- layer1_attn_qkv_13 -->
<g id="node127" class="node">
<title>layer1_attn_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="6775.5,-792 6134.5,-792 6134.5,-724 6775.5,-724 6775.5,-792"/>
<text text-anchor="middle" x="6455" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 13</text>
<text text-anchor="middle" x="6455" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="6455" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="6455" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_13 -->
<g id="edge151" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_13</title>
<path fill="none" stroke="black" d="M6730.83,-928.88C6730.83,-928.88 6730.83,-802.06 6730.83,-802.06"/>
<polygon fill="black" stroke="black" points="6734.33,-802.06 6730.83,-792.06 6727.33,-802.06 6734.33,-802.06"/>
</g>
<!-- layer1_attn_qkv_14 -->
<g id="node131" class="node">
<title>layer1_attn_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="7566.5,-792 6925.5,-792 6925.5,-724 7566.5,-724 7566.5,-792"/>
<text text-anchor="middle" x="7246" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 14</text>
<text text-anchor="middle" x="7246" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="7246" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="7246" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_14 -->
<g id="edge156" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_14</title>
<path fill="none" stroke="black" d="M7246,-860.92C7246,-860.92 7246,-802.04 7246,-802.04"/>
<polygon fill="black" stroke="black" points="7249.5,-802.04 7246,-792.04 7242.5,-802.04 7249.5,-802.04"/>
</g>
<!-- layer1_attn_qkv_15 -->
<g id="node135" class="node">
<title>layer1_attn_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="8380.5,-792 7739.5,-792 7739.5,-724 8380.5,-724 8380.5,-792"/>
<text text-anchor="middle" x="8060" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 1 QKV Block 15</text>
<text text-anchor="middle" x="8060" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="8060" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="8060" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_1&#45;&gt;layer1_attn_qkv_15 -->
<g id="edge161" class="edge">
<title>send_to_pool_1&#45;&gt;layer1_attn_qkv_15</title>
<path fill="none" stroke="black" d="M7772.67,-928.88C7772.67,-928.88 7772.67,-802.06 7772.67,-802.06"/>
<polygon fill="black" stroke="black" points="7776.17,-802.06 7772.67,-792.06 7769.17,-802.06 7776.17,-802.06"/>
</g>
<!-- layer1_attn_scores_0 -->
<g id="node76" class="node">
<title>layer1_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="9163.5,-688 8678.5,-688 8678.5,-620 9163.5,-620 9163.5,-688"/>
<text text-anchor="middle" x="8921" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 0</text>
<text text-anchor="middle" x="8921" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8921" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8921" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_0&#45;&gt;layer1_attn_scores_0 -->
<g id="edge87" class="edge">
<title>layer1_attn_qkv_0&#45;&gt;layer1_attn_scores_0</title>
<path fill="none" stroke="black" d="M8921,-723.95C8921,-723.95 8921,-698.13 8921,-698.13"/>
<polygon fill="black" stroke="black" points="8924.5,-698.13 8921,-688.13 8917.5,-698.13 8924.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_0 -->
<g id="node77" class="node">
<title>layer1_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="9333.5,-584 8554.5,-584 8554.5,-516 9333.5,-516 9333.5,-584"/>
<text text-anchor="middle" x="8944" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 0</text>
<text text-anchor="middle" x="8944" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8944" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="8944" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_0&#45;&gt;layer1_attn_weighted_0 -->
<g id="edge88" class="edge">
<title>layer1_attn_scores_0&#45;&gt;layer1_attn_weighted_0</title>
<path fill="none" stroke="black" d="M8921,-619.95C8921,-619.95 8921,-594.13 8921,-594.13"/>
<polygon fill="black" stroke="black" points="8924.5,-594.13 8921,-584.13 8917.5,-594.13 8924.5,-594.13"/>
</g>
<!-- layer1_attn_out_0 -->
<g id="node78" class="node">
<title>layer1_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="9185,-446 8603,-446 8603,-378 9185,-378 9185,-446"/>
<text text-anchor="middle" x="8894" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 0</text>
<text text-anchor="middle" x="8894" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8894" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8894" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_0&#45;&gt;layer1_attn_out_0 -->
<g id="edge89" class="edge">
<title>layer1_attn_weighted_0&#45;&gt;layer1_attn_out_0</title>
<path fill="none" stroke="black" d="M8894,-515.89C8894,-515.89 8894,-456.2 8894,-456.2"/>
<polygon fill="black" stroke="black" points="8897.5,-456.2 8894,-446.2 8890.5,-456.2 8897.5,-456.2"/>
</g>
<!-- layer1_attn_aggregate -->
<g id="node139" class="node">
<title>layer1_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="7915.99,-308 6850.19,-308 6576.01,-172 7641.81,-172 7915.99,-308"/>
<text text-anchor="middle" x="7246" y="-258.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Aggregation</text>
<text text-anchor="middle" x="7246" y="-243.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="7246" y="-228.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="7246" y="-213.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_out_0&#45;&gt;layer1_attn_aggregate -->
<g id="edge90" class="edge">
<title>layer1_attn_out_0&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M8894,-377.96C8894,-333.71 8894,-262 8894,-262 8894,-262 7833.26,-262 7833.26,-262"/>
<polygon fill="black" stroke="black" points="7833.26,-258.5 7823.26,-262 7833.26,-265.5 7833.26,-258.5"/>
</g>
<!-- layer1_attn_scores_1 -->
<g id="node80" class="node">
<title>layer1_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="10006,-688 9494,-688 9494,-620 10006,-620 10006,-688"/>
<text text-anchor="middle" x="9750" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 1</text>
<text text-anchor="middle" x="9750" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9750" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9750" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_1&#45;&gt;layer1_attn_scores_1 -->
<g id="edge92" class="edge">
<title>layer1_attn_qkv_1&#45;&gt;layer1_attn_scores_1</title>
<path fill="none" stroke="black" d="M9750,-723.95C9750,-723.95 9750,-698.13 9750,-698.13"/>
<polygon fill="black" stroke="black" points="9753.5,-698.13 9750,-688.13 9746.5,-698.13 9753.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_1 -->
<g id="node81" class="node">
<title>layer1_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="10176,-584 9370,-584 9370,-516 10176,-516 10176,-584"/>
<text text-anchor="middle" x="9773" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 1</text>
<text text-anchor="middle" x="9773" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9773" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="9773" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_1&#45;&gt;layer1_attn_weighted_1 -->
<g id="edge93" class="edge">
<title>layer1_attn_scores_1&#45;&gt;layer1_attn_weighted_1</title>
<path fill="none" stroke="black" d="M9750,-619.95C9750,-619.95 9750,-594.13 9750,-594.13"/>
<polygon fill="black" stroke="black" points="9753.5,-594.13 9750,-584.13 9746.5,-594.13 9753.5,-594.13"/>
</g>
<!-- layer1_attn_out_1 -->
<g id="node82" class="node">
<title>layer1_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="10027.5,-446 9418.5,-446 9418.5,-378 10027.5,-378 10027.5,-446"/>
<text text-anchor="middle" x="9723" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 1</text>
<text text-anchor="middle" x="9723" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9723" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="9723" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_1&#45;&gt;layer1_attn_out_1 -->
<g id="edge94" class="edge">
<title>layer1_attn_weighted_1&#45;&gt;layer1_attn_out_1</title>
<path fill="none" stroke="black" d="M9723,-515.89C9723,-515.89 9723,-456.2 9723,-456.2"/>
<polygon fill="black" stroke="black" points="9726.5,-456.2 9723,-446.2 9719.5,-456.2 9726.5,-456.2"/>
</g>
<!-- layer1_attn_out_1&#45;&gt;layer1_attn_aggregate -->
<g id="edge95" class="edge">
<title>layer1_attn_out_1&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M9723,-377.81C9723,-329.48 9723,-247 9723,-247 9723,-247 7803.04,-247 7803.04,-247"/>
<polygon fill="black" stroke="black" points="7803.04,-243.5 7793.04,-247 7803.04,-250.5 7803.04,-243.5"/>
</g>
<!-- layer1_attn_scores_2 -->
<g id="node84" class="node">
<title>layer1_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="10848,-688 10336,-688 10336,-620 10848,-620 10848,-688"/>
<text text-anchor="middle" x="10592" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 2</text>
<text text-anchor="middle" x="10592" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10592" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10592" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_2&#45;&gt;layer1_attn_scores_2 -->
<g id="edge97" class="edge">
<title>layer1_attn_qkv_2&#45;&gt;layer1_attn_scores_2</title>
<path fill="none" stroke="black" d="M10592,-723.95C10592,-723.95 10592,-698.13 10592,-698.13"/>
<polygon fill="black" stroke="black" points="10595.5,-698.13 10592,-688.13 10588.5,-698.13 10595.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_2 -->
<g id="node85" class="node">
<title>layer1_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="11018,-584 10212,-584 10212,-516 11018,-516 11018,-584"/>
<text text-anchor="middle" x="10615" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 2</text>
<text text-anchor="middle" x="10615" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10615" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="10615" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_2&#45;&gt;layer1_attn_weighted_2 -->
<g id="edge98" class="edge">
<title>layer1_attn_scores_2&#45;&gt;layer1_attn_weighted_2</title>
<path fill="none" stroke="black" d="M10592,-619.95C10592,-619.95 10592,-594.13 10592,-594.13"/>
<polygon fill="black" stroke="black" points="10595.5,-594.13 10592,-584.13 10588.5,-594.13 10595.5,-594.13"/>
</g>
<!-- layer1_attn_out_2 -->
<g id="node86" class="node">
<title>layer1_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="10869.5,-446 10260.5,-446 10260.5,-378 10869.5,-378 10869.5,-446"/>
<text text-anchor="middle" x="10565" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 2</text>
<text text-anchor="middle" x="10565" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10565" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="10565" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_2&#45;&gt;layer1_attn_out_2 -->
<g id="edge99" class="edge">
<title>layer1_attn_weighted_2&#45;&gt;layer1_attn_out_2</title>
<path fill="none" stroke="black" d="M10565,-515.89C10565,-515.89 10565,-456.2 10565,-456.2"/>
<polygon fill="black" stroke="black" points="10568.5,-456.2 10565,-446.2 10561.5,-456.2 10568.5,-456.2"/>
</g>
<!-- layer1_attn_out_2&#45;&gt;layer1_attn_aggregate -->
<g id="edge100" class="edge">
<title>layer1_attn_out_2&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M10565,-377.72C10565,-325.49 10565,-232 10565,-232 10565,-232 7772.77,-232 7772.77,-232"/>
<polygon fill="black" stroke="black" points="7772.77,-228.5 7762.77,-232 7772.77,-235.5 7772.77,-228.5"/>
</g>
<!-- layer1_attn_scores_3 -->
<g id="node88" class="node">
<title>layer1_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="11690,-688 11178,-688 11178,-620 11690,-620 11690,-688"/>
<text text-anchor="middle" x="11434" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 3</text>
<text text-anchor="middle" x="11434" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11434" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11434" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_3&#45;&gt;layer1_attn_scores_3 -->
<g id="edge102" class="edge">
<title>layer1_attn_qkv_3&#45;&gt;layer1_attn_scores_3</title>
<path fill="none" stroke="black" d="M11434,-723.95C11434,-723.95 11434,-698.13 11434,-698.13"/>
<polygon fill="black" stroke="black" points="11437.5,-698.13 11434,-688.13 11430.5,-698.13 11437.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_3 -->
<g id="node89" class="node">
<title>layer1_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="11860,-584 11054,-584 11054,-516 11860,-516 11860,-584"/>
<text text-anchor="middle" x="11457" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 3</text>
<text text-anchor="middle" x="11457" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11457" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="11457" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_3&#45;&gt;layer1_attn_weighted_3 -->
<g id="edge103" class="edge">
<title>layer1_attn_scores_3&#45;&gt;layer1_attn_weighted_3</title>
<path fill="none" stroke="black" d="M11434,-619.95C11434,-619.95 11434,-594.13 11434,-594.13"/>
<polygon fill="black" stroke="black" points="11437.5,-594.13 11434,-584.13 11430.5,-594.13 11437.5,-594.13"/>
</g>
<!-- layer1_attn_out_3 -->
<g id="node90" class="node">
<title>layer1_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="11711.5,-446 11102.5,-446 11102.5,-378 11711.5,-378 11711.5,-446"/>
<text text-anchor="middle" x="11407" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 3</text>
<text text-anchor="middle" x="11407" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11407" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="11407" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_3&#45;&gt;layer1_attn_out_3 -->
<g id="edge104" class="edge">
<title>layer1_attn_weighted_3&#45;&gt;layer1_attn_out_3</title>
<path fill="none" stroke="black" d="M11407,-515.89C11407,-515.89 11407,-456.2 11407,-456.2"/>
<polygon fill="black" stroke="black" points="11410.5,-456.2 11407,-446.2 11403.5,-456.2 11410.5,-456.2"/>
</g>
<!-- layer1_attn_out_3&#45;&gt;layer1_attn_aggregate -->
<g id="edge105" class="edge">
<title>layer1_attn_out_3&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M11407,-377.59C11407,-321.61 11407,-217 11407,-217 11407,-217 7742.74,-217 7742.74,-217"/>
<polygon fill="black" stroke="black" points="7742.74,-213.5 7732.74,-217 7742.74,-220.5 7742.74,-213.5"/>
</g>
<!-- layer1_attn_scores_4 -->
<g id="node92" class="node">
<title>layer1_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="12532,-688 12020,-688 12020,-620 12532,-620 12532,-688"/>
<text text-anchor="middle" x="12276" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 4</text>
<text text-anchor="middle" x="12276" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12276" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12276" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_4&#45;&gt;layer1_attn_scores_4 -->
<g id="edge107" class="edge">
<title>layer1_attn_qkv_4&#45;&gt;layer1_attn_scores_4</title>
<path fill="none" stroke="black" d="M12276,-723.95C12276,-723.95 12276,-698.13 12276,-698.13"/>
<polygon fill="black" stroke="black" points="12279.5,-698.13 12276,-688.13 12272.5,-698.13 12279.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_4 -->
<g id="node93" class="node">
<title>layer1_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="12702,-584 11896,-584 11896,-516 12702,-516 12702,-584"/>
<text text-anchor="middle" x="12299" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 4</text>
<text text-anchor="middle" x="12299" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12299" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="12299" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_4&#45;&gt;layer1_attn_weighted_4 -->
<g id="edge108" class="edge">
<title>layer1_attn_scores_4&#45;&gt;layer1_attn_weighted_4</title>
<path fill="none" stroke="black" d="M12276,-619.95C12276,-619.95 12276,-594.13 12276,-594.13"/>
<polygon fill="black" stroke="black" points="12279.5,-594.13 12276,-584.13 12272.5,-594.13 12279.5,-594.13"/>
</g>
<!-- layer1_attn_out_4 -->
<g id="node94" class="node">
<title>layer1_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="12553.5,-446 11944.5,-446 11944.5,-378 12553.5,-378 12553.5,-446"/>
<text text-anchor="middle" x="12249" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 4</text>
<text text-anchor="middle" x="12249" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12249" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="12249" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_4&#45;&gt;layer1_attn_out_4 -->
<g id="edge109" class="edge">
<title>layer1_attn_weighted_4&#45;&gt;layer1_attn_out_4</title>
<path fill="none" stroke="black" d="M12249,-515.89C12249,-515.89 12249,-456.2 12249,-456.2"/>
<polygon fill="black" stroke="black" points="12252.5,-456.2 12249,-446.2 12245.5,-456.2 12252.5,-456.2"/>
</g>
<!-- layer1_attn_out_4&#45;&gt;layer1_attn_aggregate -->
<g id="edge110" class="edge">
<title>layer1_attn_out_4&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M12249,-377.79C12249,-318.29 12249,-202 12249,-202 12249,-202 7712.41,-202 7712.41,-202"/>
<polygon fill="black" stroke="black" points="7712.41,-198.5 7702.41,-202 7712.41,-205.5 7712.41,-198.5"/>
</g>
<!-- layer1_attn_scores_5 -->
<g id="node96" class="node">
<title>layer1_attn_scores_5</title>
<polygon fill="lightblue" stroke="black" points="13374,-688 12862,-688 12862,-620 13374,-620 13374,-688"/>
<text text-anchor="middle" x="13118" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 5</text>
<text text-anchor="middle" x="13118" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="13118" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13118" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_5&#45;&gt;layer1_attn_scores_5 -->
<g id="edge112" class="edge">
<title>layer1_attn_qkv_5&#45;&gt;layer1_attn_scores_5</title>
<path fill="none" stroke="black" d="M13118,-723.95C13118,-723.95 13118,-698.13 13118,-698.13"/>
<polygon fill="black" stroke="black" points="13121.5,-698.13 13118,-688.13 13114.5,-698.13 13121.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_5 -->
<g id="node97" class="node">
<title>layer1_attn_weighted_5</title>
<polygon fill="lightblue" stroke="black" points="13544,-584 12738,-584 12738,-516 13544,-516 13544,-584"/>
<text text-anchor="middle" x="13141" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 5</text>
<text text-anchor="middle" x="13141" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="13141" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="13141" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_5&#45;&gt;layer1_attn_weighted_5 -->
<g id="edge113" class="edge">
<title>layer1_attn_scores_5&#45;&gt;layer1_attn_weighted_5</title>
<path fill="none" stroke="black" d="M13118,-619.95C13118,-619.95 13118,-594.13 13118,-594.13"/>
<polygon fill="black" stroke="black" points="13121.5,-594.13 13118,-584.13 13114.5,-594.13 13121.5,-594.13"/>
</g>
<!-- layer1_attn_out_5 -->
<g id="node98" class="node">
<title>layer1_attn_out_5</title>
<polygon fill="lightblue" stroke="black" points="13395.5,-446 12786.5,-446 12786.5,-378 13395.5,-378 13395.5,-446"/>
<text text-anchor="middle" x="13091" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 5</text>
<text text-anchor="middle" x="13091" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="13091" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="13091" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_5&#45;&gt;layer1_attn_out_5 -->
<g id="edge114" class="edge">
<title>layer1_attn_weighted_5&#45;&gt;layer1_attn_out_5</title>
<path fill="none" stroke="black" d="M13091,-515.89C13091,-515.89 13091,-456.2 13091,-456.2"/>
<polygon fill="black" stroke="black" points="13094.5,-456.2 13091,-446.2 13087.5,-456.2 13094.5,-456.2"/>
</g>
<!-- layer1_attn_out_5&#45;&gt;layer1_attn_aggregate -->
<g id="edge115" class="edge">
<title>layer1_attn_out_5&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M13091,-377.83C13091,-314.88 13091,-187 13091,-187 13091,-187 7682.25,-187 7682.25,-187"/>
<polygon fill="black" stroke="black" points="7682.25,-183.5 7672.25,-187 7682.25,-190.5 7682.25,-183.5"/>
</g>
<!-- layer1_attn_scores_6 -->
<g id="node100" class="node">
<title>layer1_attn_scores_6</title>
<polygon fill="lightblue" stroke="black" points="698,-688 186,-688 186,-620 698,-620 698,-688"/>
<text text-anchor="middle" x="442" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 6</text>
<text text-anchor="middle" x="442" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="442" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="442" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_6&#45;&gt;layer1_attn_scores_6 -->
<g id="edge117" class="edge">
<title>layer1_attn_qkv_6&#45;&gt;layer1_attn_scores_6</title>
<path fill="none" stroke="black" d="M442,-723.95C442,-723.95 442,-698.13 442,-698.13"/>
<polygon fill="black" stroke="black" points="445.5,-698.13 442,-688.13 438.5,-698.13 445.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_6 -->
<g id="node101" class="node">
<title>layer1_attn_weighted_6</title>
<polygon fill="lightblue" stroke="black" points="822,-584 16,-584 16,-516 822,-516 822,-584"/>
<text text-anchor="middle" x="419" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 6</text>
<text text-anchor="middle" x="419" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="419" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="419" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_6&#45;&gt;layer1_attn_weighted_6 -->
<g id="edge118" class="edge">
<title>layer1_attn_scores_6&#45;&gt;layer1_attn_weighted_6</title>
<path fill="none" stroke="black" d="M442,-619.95C442,-619.95 442,-594.13 442,-594.13"/>
<polygon fill="black" stroke="black" points="445.5,-594.13 442,-584.13 438.5,-594.13 445.5,-594.13"/>
</g>
<!-- layer1_attn_out_6 -->
<g id="node102" class="node">
<title>layer1_attn_out_6</title>
<polygon fill="lightblue" stroke="black" points="772.5,-446 163.5,-446 163.5,-378 772.5,-378 772.5,-446"/>
<text text-anchor="middle" x="468" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 6</text>
<text text-anchor="middle" x="468" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="468" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="468" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_6&#45;&gt;layer1_attn_out_6 -->
<g id="edge119" class="edge">
<title>layer1_attn_weighted_6&#45;&gt;layer1_attn_out_6</title>
<path fill="none" stroke="black" d="M468,-515.89C468,-515.89 468,-456.2 468,-456.2"/>
<polygon fill="black" stroke="black" points="471.5,-456.2 468,-446.2 464.5,-456.2 471.5,-456.2"/>
</g>
<!-- layer1_attn_out_6&#45;&gt;layer1_attn_aggregate -->
<g id="edge120" class="edge">
<title>layer1_attn_out_6&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M468,-377.64C468,-315.09 468,-189 468,-189 468,-189 6600.25,-189 6600.25,-189"/>
<polygon fill="black" stroke="black" points="6600.25,-192.5 6610.25,-189 6600.25,-185.5 6600.25,-192.5"/>
</g>
<!-- layer1_attn_scores_7 -->
<g id="node104" class="node">
<title>layer1_attn_scores_7</title>
<polygon fill="lightblue" stroke="black" points="1540,-688 1028,-688 1028,-620 1540,-620 1540,-688"/>
<text text-anchor="middle" x="1284" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 7</text>
<text text-anchor="middle" x="1284" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="1284" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1284" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_7&#45;&gt;layer1_attn_scores_7 -->
<g id="edge122" class="edge">
<title>layer1_attn_qkv_7&#45;&gt;layer1_attn_scores_7</title>
<path fill="none" stroke="black" d="M1284,-723.95C1284,-723.95 1284,-698.13 1284,-698.13"/>
<polygon fill="black" stroke="black" points="1287.5,-698.13 1284,-688.13 1280.5,-698.13 1287.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_7 -->
<g id="node105" class="node">
<title>layer1_attn_weighted_7</title>
<polygon fill="lightblue" stroke="black" points="1664,-584 858,-584 858,-516 1664,-516 1664,-584"/>
<text text-anchor="middle" x="1261" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 7</text>
<text text-anchor="middle" x="1261" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="1261" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="1261" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_7&#45;&gt;layer1_attn_weighted_7 -->
<g id="edge123" class="edge">
<title>layer1_attn_scores_7&#45;&gt;layer1_attn_weighted_7</title>
<path fill="none" stroke="black" d="M1284,-619.95C1284,-619.95 1284,-594.13 1284,-594.13"/>
<polygon fill="black" stroke="black" points="1287.5,-594.13 1284,-584.13 1280.5,-594.13 1287.5,-594.13"/>
</g>
<!-- layer1_attn_out_7 -->
<g id="node106" class="node">
<title>layer1_attn_out_7</title>
<polygon fill="lightblue" stroke="black" points="1614.5,-446 1005.5,-446 1005.5,-378 1614.5,-378 1614.5,-446"/>
<text text-anchor="middle" x="1310" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 7</text>
<text text-anchor="middle" x="1310" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="1310" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1310" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_7&#45;&gt;layer1_attn_out_7 -->
<g id="edge124" class="edge">
<title>layer1_attn_weighted_7&#45;&gt;layer1_attn_out_7</title>
<path fill="none" stroke="black" d="M1310,-515.89C1310,-515.89 1310,-456.2 1310,-456.2"/>
<polygon fill="black" stroke="black" points="1313.5,-456.2 1310,-446.2 1306.5,-456.2 1313.5,-456.2"/>
</g>
<!-- layer1_attn_out_7&#45;&gt;layer1_attn_aggregate -->
<g id="edge125" class="edge">
<title>layer1_attn_out_7&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M1310,-377.98C1310,-319.47 1310,-206 1310,-206 1310,-206 6634.5,-206 6634.5,-206"/>
<polygon fill="black" stroke="black" points="6634.5,-209.5 6644.5,-206 6634.5,-202.5 6634.5,-209.5"/>
</g>
<!-- layer1_attn_scores_8 -->
<g id="node108" class="node">
<title>layer1_attn_scores_8</title>
<polygon fill="lightblue" stroke="black" points="2382,-688 1870,-688 1870,-620 2382,-620 2382,-688"/>
<text text-anchor="middle" x="2126" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 8</text>
<text text-anchor="middle" x="2126" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="2126" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2126" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_8&#45;&gt;layer1_attn_scores_8 -->
<g id="edge127" class="edge">
<title>layer1_attn_qkv_8&#45;&gt;layer1_attn_scores_8</title>
<path fill="none" stroke="black" d="M2126,-723.95C2126,-723.95 2126,-698.13 2126,-698.13"/>
<polygon fill="black" stroke="black" points="2129.5,-698.13 2126,-688.13 2122.5,-698.13 2129.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_8 -->
<g id="node109" class="node">
<title>layer1_attn_weighted_8</title>
<polygon fill="lightblue" stroke="black" points="2506,-584 1700,-584 1700,-516 2506,-516 2506,-584"/>
<text text-anchor="middle" x="2103" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 8</text>
<text text-anchor="middle" x="2103" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="2103" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="2103" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_8&#45;&gt;layer1_attn_weighted_8 -->
<g id="edge128" class="edge">
<title>layer1_attn_scores_8&#45;&gt;layer1_attn_weighted_8</title>
<path fill="none" stroke="black" d="M2126,-619.95C2126,-619.95 2126,-594.13 2126,-594.13"/>
<polygon fill="black" stroke="black" points="2129.5,-594.13 2126,-584.13 2122.5,-594.13 2129.5,-594.13"/>
</g>
<!-- layer1_attn_out_8 -->
<g id="node110" class="node">
<title>layer1_attn_out_8</title>
<polygon fill="lightblue" stroke="black" points="2456.5,-446 1847.5,-446 1847.5,-378 2456.5,-378 2456.5,-446"/>
<text text-anchor="middle" x="2152" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 8</text>
<text text-anchor="middle" x="2152" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="2152" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2152" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_8&#45;&gt;layer1_attn_out_8 -->
<g id="edge129" class="edge">
<title>layer1_attn_weighted_8&#45;&gt;layer1_attn_out_8</title>
<path fill="none" stroke="black" d="M2152,-515.89C2152,-515.89 2152,-456.2 2152,-456.2"/>
<polygon fill="black" stroke="black" points="2155.5,-456.2 2152,-446.2 2148.5,-456.2 2155.5,-456.2"/>
</g>
<!-- layer1_attn_out_8&#45;&gt;layer1_attn_aggregate -->
<g id="edge130" class="edge">
<title>layer1_attn_out_8&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M2152,-377.77C2152,-323.31 2152,-223 2152,-223 2152,-223 6668.63,-223 6668.63,-223"/>
<polygon fill="black" stroke="black" points="6668.63,-226.5 6678.63,-223 6668.63,-219.5 6668.63,-226.5"/>
</g>
<!-- layer1_attn_scores_9 -->
<g id="node112" class="node">
<title>layer1_attn_scores_9</title>
<polygon fill="lightblue" stroke="black" points="3233.5,-688 2712.5,-688 2712.5,-620 3233.5,-620 3233.5,-688"/>
<text text-anchor="middle" x="2973" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 9</text>
<text text-anchor="middle" x="2973" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="2973" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2973" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_9&#45;&gt;layer1_attn_scores_9 -->
<g id="edge132" class="edge">
<title>layer1_attn_qkv_9&#45;&gt;layer1_attn_scores_9</title>
<path fill="none" stroke="black" d="M2973,-723.95C2973,-723.95 2973,-698.13 2973,-698.13"/>
<polygon fill="black" stroke="black" points="2976.5,-698.13 2973,-688.13 2969.5,-698.13 2976.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_9 -->
<g id="node113" class="node">
<title>layer1_attn_weighted_9</title>
<polygon fill="lightblue" stroke="black" points="3357.5,-584 2542.5,-584 2542.5,-516 3357.5,-516 3357.5,-584"/>
<text text-anchor="middle" x="2950" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 9</text>
<text text-anchor="middle" x="2950" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="2950" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="2950" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_9&#45;&gt;layer1_attn_weighted_9 -->
<g id="edge133" class="edge">
<title>layer1_attn_scores_9&#45;&gt;layer1_attn_weighted_9</title>
<path fill="none" stroke="black" d="M2973,-619.95C2973,-619.95 2973,-594.13 2973,-594.13"/>
<polygon fill="black" stroke="black" points="2976.5,-594.13 2973,-584.13 2969.5,-594.13 2976.5,-594.13"/>
</g>
<!-- layer1_attn_out_9 -->
<g id="node114" class="node">
<title>layer1_attn_out_9</title>
<polygon fill="lightblue" stroke="black" points="3308,-446 2690,-446 2690,-378 3308,-378 3308,-446"/>
<text text-anchor="middle" x="2999" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 9</text>
<text text-anchor="middle" x="2999" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="2999" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2999" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_9&#45;&gt;layer1_attn_out_9 -->
<g id="edge134" class="edge">
<title>layer1_attn_weighted_9&#45;&gt;layer1_attn_out_9</title>
<path fill="none" stroke="black" d="M2999,-515.89C2999,-515.89 2999,-456.2 2999,-456.2"/>
<polygon fill="black" stroke="black" points="3002.5,-456.2 2999,-446.2 2995.5,-456.2 3002.5,-456.2"/>
</g>
<!-- layer1_attn_out_9&#45;&gt;layer1_attn_aggregate -->
<g id="edge135" class="edge">
<title>layer1_attn_out_9&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M2999,-377.61C2999,-327.41 2999,-240 2999,-240 2999,-240 6702.95,-240 6702.95,-240"/>
<polygon fill="black" stroke="black" points="6702.95,-243.5 6712.95,-240 6702.95,-236.5 6702.95,-243.5"/>
</g>
<!-- layer1_attn_scores_10 -->
<g id="node116" class="node">
<title>layer1_attn_scores_10</title>
<polygon fill="lightblue" stroke="black" points="4094,-688 3564,-688 3564,-620 4094,-620 4094,-688"/>
<text text-anchor="middle" x="3829" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 10</text>
<text text-anchor="middle" x="3829" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="3829" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3829" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_10&#45;&gt;layer1_attn_scores_10 -->
<g id="edge137" class="edge">
<title>layer1_attn_qkv_10&#45;&gt;layer1_attn_scores_10</title>
<path fill="none" stroke="black" d="M3829,-723.95C3829,-723.95 3829,-698.13 3829,-698.13"/>
<polygon fill="black" stroke="black" points="3832.5,-698.13 3829,-688.13 3825.5,-698.13 3832.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_10 -->
<g id="node117" class="node">
<title>layer1_attn_weighted_10</title>
<polygon fill="lightblue" stroke="black" points="4218,-584 3394,-584 3394,-516 4218,-516 4218,-584"/>
<text text-anchor="middle" x="3806" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 10</text>
<text text-anchor="middle" x="3806" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="3806" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="3806" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_10&#45;&gt;layer1_attn_weighted_10 -->
<g id="edge138" class="edge">
<title>layer1_attn_scores_10&#45;&gt;layer1_attn_weighted_10</title>
<path fill="none" stroke="black" d="M3829,-619.95C3829,-619.95 3829,-594.13 3829,-594.13"/>
<polygon fill="black" stroke="black" points="3832.5,-594.13 3829,-584.13 3825.5,-594.13 3832.5,-594.13"/>
</g>
<!-- layer1_attn_out_10 -->
<g id="node118" class="node">
<title>layer1_attn_out_10</title>
<polygon fill="lightblue" stroke="black" points="4168.5,-446 3541.5,-446 3541.5,-378 4168.5,-378 4168.5,-446"/>
<text text-anchor="middle" x="3855" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 10</text>
<text text-anchor="middle" x="3855" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="3855" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3855" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_10&#45;&gt;layer1_attn_out_10 -->
<g id="edge139" class="edge">
<title>layer1_attn_weighted_10&#45;&gt;layer1_attn_out_10</title>
<path fill="none" stroke="black" d="M3855,-515.89C3855,-515.89 3855,-456.2 3855,-456.2"/>
<polygon fill="black" stroke="black" points="3858.5,-456.2 3855,-446.2 3851.5,-456.2 3858.5,-456.2"/>
</g>
<!-- layer1_attn_out_10&#45;&gt;layer1_attn_aggregate -->
<g id="edge140" class="edge">
<title>layer1_attn_out_10&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M3855,-377.98C3855,-332.36 3855,-257 3855,-257 3855,-257 6737.01,-257 6737.01,-257"/>
<polygon fill="black" stroke="black" points="6737.01,-260.5 6747.01,-257 6737.01,-253.5 6737.01,-260.5"/>
</g>
<!-- layer1_attn_scores_11 -->
<g id="node120" class="node">
<title>layer1_attn_scores_11</title>
<polygon fill="lightblue" stroke="black" points="4954,-688 4424,-688 4424,-620 4954,-620 4954,-688"/>
<text text-anchor="middle" x="4689" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 11</text>
<text text-anchor="middle" x="4689" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="4689" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4689" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_11&#45;&gt;layer1_attn_scores_11 -->
<g id="edge142" class="edge">
<title>layer1_attn_qkv_11&#45;&gt;layer1_attn_scores_11</title>
<path fill="none" stroke="black" d="M4689,-723.95C4689,-723.95 4689,-698.13 4689,-698.13"/>
<polygon fill="black" stroke="black" points="4692.5,-698.13 4689,-688.13 4685.5,-698.13 4692.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_11 -->
<g id="node121" class="node">
<title>layer1_attn_weighted_11</title>
<polygon fill="lightblue" stroke="black" points="5078,-584 4254,-584 4254,-516 5078,-516 5078,-584"/>
<text text-anchor="middle" x="4666" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 11</text>
<text text-anchor="middle" x="4666" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="4666" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="4666" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_11&#45;&gt;layer1_attn_weighted_11 -->
<g id="edge143" class="edge">
<title>layer1_attn_scores_11&#45;&gt;layer1_attn_weighted_11</title>
<path fill="none" stroke="black" d="M4689,-619.95C4689,-619.95 4689,-594.13 4689,-594.13"/>
<polygon fill="black" stroke="black" points="4692.5,-594.13 4689,-584.13 4685.5,-594.13 4692.5,-594.13"/>
</g>
<!-- layer1_attn_out_11 -->
<g id="node122" class="node">
<title>layer1_attn_out_11</title>
<polygon fill="lightblue" stroke="black" points="5028.5,-446 4401.5,-446 4401.5,-378 5028.5,-378 5028.5,-446"/>
<text text-anchor="middle" x="4715" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 11</text>
<text text-anchor="middle" x="4715" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="4715" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4715" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_11&#45;&gt;layer1_attn_out_11 -->
<g id="edge144" class="edge">
<title>layer1_attn_weighted_11&#45;&gt;layer1_attn_out_11</title>
<path fill="none" stroke="black" d="M4715,-515.89C4715,-515.89 4715,-456.2 4715,-456.2"/>
<polygon fill="black" stroke="black" points="4718.5,-456.2 4715,-446.2 4711.5,-456.2 4718.5,-456.2"/>
</g>
<!-- layer1_attn_out_11&#45;&gt;layer1_attn_aggregate -->
<g id="edge145" class="edge">
<title>layer1_attn_out_11&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M4715,-377.89C4715,-337.02 4715,-274 4715,-274 4715,-274 6771.41,-274 6771.41,-274"/>
<polygon fill="black" stroke="black" points="6771.41,-277.5 6781.41,-274 6771.41,-270.5 6771.41,-277.5"/>
</g>
<!-- layer1_attn_scores_12 -->
<g id="node124" class="node">
<title>layer1_attn_scores_12</title>
<polygon fill="lightblue" stroke="black" points="5814,-688 5284,-688 5284,-620 5814,-620 5814,-688"/>
<text text-anchor="middle" x="5549" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 12</text>
<text text-anchor="middle" x="5549" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="5549" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5549" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_12&#45;&gt;layer1_attn_scores_12 -->
<g id="edge147" class="edge">
<title>layer1_attn_qkv_12&#45;&gt;layer1_attn_scores_12</title>
<path fill="none" stroke="black" d="M5549,-723.95C5549,-723.95 5549,-698.13 5549,-698.13"/>
<polygon fill="black" stroke="black" points="5552.5,-698.13 5549,-688.13 5545.5,-698.13 5552.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_12 -->
<g id="node125" class="node">
<title>layer1_attn_weighted_12</title>
<polygon fill="lightblue" stroke="black" points="5938,-584 5114,-584 5114,-516 5938,-516 5938,-584"/>
<text text-anchor="middle" x="5526" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 12</text>
<text text-anchor="middle" x="5526" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="5526" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="5526" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_12&#45;&gt;layer1_attn_weighted_12 -->
<g id="edge148" class="edge">
<title>layer1_attn_scores_12&#45;&gt;layer1_attn_weighted_12</title>
<path fill="none" stroke="black" d="M5549,-619.95C5549,-619.95 5549,-594.13 5549,-594.13"/>
<polygon fill="black" stroke="black" points="5552.5,-594.13 5549,-584.13 5545.5,-594.13 5552.5,-594.13"/>
</g>
<!-- layer1_attn_out_12 -->
<g id="node126" class="node">
<title>layer1_attn_out_12</title>
<polygon fill="lightblue" stroke="black" points="5888.5,-446 5261.5,-446 5261.5,-378 5888.5,-378 5888.5,-446"/>
<text text-anchor="middle" x="5575" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 12</text>
<text text-anchor="middle" x="5575" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="5575" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5575" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_12&#45;&gt;layer1_attn_out_12 -->
<g id="edge149" class="edge">
<title>layer1_attn_weighted_12&#45;&gt;layer1_attn_out_12</title>
<path fill="none" stroke="black" d="M5575,-515.89C5575,-515.89 5575,-456.2 5575,-456.2"/>
<polygon fill="black" stroke="black" points="5578.5,-456.2 5575,-446.2 5571.5,-456.2 5578.5,-456.2"/>
</g>
<!-- layer1_attn_out_12&#45;&gt;layer1_attn_aggregate -->
<g id="edge150" class="edge">
<title>layer1_attn_out_12&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M5575,-377.97C5575,-342.18 5575,-291 5575,-291 5575,-291 6805.68,-291 6805.68,-291"/>
<polygon fill="black" stroke="black" points="6805.68,-294.5 6815.68,-291 6805.68,-287.5 6805.68,-294.5"/>
</g>
<!-- layer1_attn_scores_13 -->
<g id="node128" class="node">
<title>layer1_attn_scores_13</title>
<polygon fill="lightblue" stroke="black" points="6674,-688 6144,-688 6144,-620 6674,-620 6674,-688"/>
<text text-anchor="middle" x="6409" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 13</text>
<text text-anchor="middle" x="6409" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="6409" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6409" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_13&#45;&gt;layer1_attn_scores_13 -->
<g id="edge152" class="edge">
<title>layer1_attn_qkv_13&#45;&gt;layer1_attn_scores_13</title>
<path fill="none" stroke="black" d="M6409,-723.95C6409,-723.95 6409,-698.13 6409,-698.13"/>
<polygon fill="black" stroke="black" points="6412.5,-698.13 6409,-688.13 6405.5,-698.13 6412.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_13 -->
<g id="node129" class="node">
<title>layer1_attn_weighted_13</title>
<polygon fill="lightblue" stroke="black" points="6798,-584 5974,-584 5974,-516 6798,-516 6798,-584"/>
<text text-anchor="middle" x="6386" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 13</text>
<text text-anchor="middle" x="6386" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="6386" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="6386" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_13&#45;&gt;layer1_attn_weighted_13 -->
<g id="edge153" class="edge">
<title>layer1_attn_scores_13&#45;&gt;layer1_attn_weighted_13</title>
<path fill="none" stroke="black" d="M6409,-619.95C6409,-619.95 6409,-594.13 6409,-594.13"/>
<polygon fill="black" stroke="black" points="6412.5,-594.13 6409,-584.13 6405.5,-594.13 6412.5,-594.13"/>
</g>
<!-- layer1_attn_out_13 -->
<g id="node130" class="node">
<title>layer1_attn_out_13</title>
<polygon fill="lightblue" stroke="black" points="6748.5,-446 6121.5,-446 6121.5,-378 6748.5,-378 6748.5,-446"/>
<text text-anchor="middle" x="6435" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 13</text>
<text text-anchor="middle" x="6435" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="6435" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
<text text-anchor="middle" x="6435" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_13&#45;&gt;layer1_attn_out_13 -->
<g id="edge154" class="edge">
<title>layer1_attn_weighted_13&#45;&gt;layer1_attn_out_13</title>
<path fill="none" stroke="black" d="M6435,-515.89C6435,-515.89 6435,-456.2 6435,-456.2"/>
<polygon fill="black" stroke="black" points="6438.5,-456.2 6435,-446.2 6431.5,-456.2 6438.5,-456.2"/>
</g>
<!-- layer1_attn_out_13&#45;&gt;layer1_attn_aggregate -->
<g id="edge155" class="edge">
<title>layer1_attn_out_13&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M6662.38,-377.61C6662.38,-377.61 6662.38,-250.06 6662.38,-250.06"/>
<polygon fill="black" stroke="black" points="6665.88,-250.06 6662.38,-240.06 6658.88,-250.06 6665.88,-250.06"/>
</g>
<!-- layer1_attn_scores_14 -->
<g id="node132" class="node">
<title>layer1_attn_scores_14</title>
<polygon fill="lightblue" stroke="black" points="7511,-688 6981,-688 6981,-620 7511,-620 7511,-688"/>
<text text-anchor="middle" x="7246" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 14</text>
<text text-anchor="middle" x="7246" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="7246" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7246" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_14&#45;&gt;layer1_attn_scores_14 -->
<g id="edge157" class="edge">
<title>layer1_attn_qkv_14&#45;&gt;layer1_attn_scores_14</title>
<path fill="none" stroke="black" d="M7246,-723.95C7246,-723.95 7246,-698.13 7246,-698.13"/>
<polygon fill="black" stroke="black" points="7249.5,-698.13 7246,-688.13 7242.5,-698.13 7249.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_14 -->
<g id="node133" class="node">
<title>layer1_attn_weighted_14</title>
<polygon fill="lightblue" stroke="black" points="7658,-584 6834,-584 6834,-516 7658,-516 7658,-584"/>
<text text-anchor="middle" x="7246" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 14</text>
<text text-anchor="middle" x="7246" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="7246" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="7246" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_14&#45;&gt;layer1_attn_weighted_14 -->
<g id="edge158" class="edge">
<title>layer1_attn_scores_14&#45;&gt;layer1_attn_weighted_14</title>
<path fill="none" stroke="black" d="M7246,-619.95C7246,-619.95 7246,-594.13 7246,-594.13"/>
<polygon fill="black" stroke="black" points="7249.5,-594.13 7246,-584.13 7242.5,-594.13 7249.5,-594.13"/>
</g>
<!-- layer1_attn_out_14 -->
<g id="node134" class="node">
<title>layer1_attn_out_14</title>
<polygon fill="lightblue" stroke="black" points="7559.5,-446 6932.5,-446 6932.5,-378 7559.5,-378 7559.5,-446"/>
<text text-anchor="middle" x="7246" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 14</text>
<text text-anchor="middle" x="7246" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="7246" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
<text text-anchor="middle" x="7246" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_14&#45;&gt;layer1_attn_out_14 -->
<g id="edge159" class="edge">
<title>layer1_attn_weighted_14&#45;&gt;layer1_attn_out_14</title>
<path fill="none" stroke="black" d="M7246,-515.89C7246,-515.89 7246,-456.2 7246,-456.2"/>
<polygon fill="black" stroke="black" points="7249.5,-456.2 7246,-446.2 7242.5,-456.2 7249.5,-456.2"/>
</g>
<!-- layer1_attn_out_14&#45;&gt;layer1_attn_aggregate -->
<g id="edge160" class="edge">
<title>layer1_attn_out_14&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M7246,-377.61C7246,-377.61 7246,-318.12 7246,-318.12"/>
<polygon fill="black" stroke="black" points="7249.5,-318.12 7246,-308.12 7242.5,-318.12 7249.5,-318.12"/>
</g>
<!-- layer1_attn_scores_15 -->
<g id="node136" class="node">
<title>layer1_attn_scores_15</title>
<polygon fill="lightblue" stroke="black" points="8348,-688 7818,-688 7818,-620 8348,-620 8348,-688"/>
<text text-anchor="middle" x="8083" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Scores Block 15</text>
<text text-anchor="middle" x="8083" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="8083" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8083" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_qkv_15&#45;&gt;layer1_attn_scores_15 -->
<g id="edge162" class="edge">
<title>layer1_attn_qkv_15&#45;&gt;layer1_attn_scores_15</title>
<path fill="none" stroke="black" d="M8083,-723.95C8083,-723.95 8083,-698.13 8083,-698.13"/>
<polygon fill="black" stroke="black" points="8086.5,-698.13 8083,-688.13 8079.5,-698.13 8086.5,-698.13"/>
</g>
<!-- layer1_attn_weighted_15 -->
<g id="node137" class="node">
<title>layer1_attn_weighted_15</title>
<polygon fill="lightblue" stroke="black" points="8518,-584 7694,-584 7694,-516 8518,-516 8518,-584"/>
<text text-anchor="middle" x="8106" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 1 Weighted Sum Block 15</text>
<text text-anchor="middle" x="8106" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="8106" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="8106" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
</g>
<!-- layer1_attn_scores_15&#45;&gt;layer1_attn_weighted_15 -->
<g id="edge163" class="edge">
<title>layer1_attn_scores_15&#45;&gt;layer1_attn_weighted_15</title>
<path fill="none" stroke="black" d="M8083,-619.95C8083,-619.95 8083,-594.13 8083,-594.13"/>
<polygon fill="black" stroke="black" points="8086.5,-594.13 8083,-584.13 8079.5,-594.13 8086.5,-594.13"/>
</g>
<!-- layer1_attn_out_15 -->
<g id="node138" class="node">
<title>layer1_attn_out_15</title>
<polygon fill="lightblue" stroke="black" points="8369.5,-446 7742.5,-446 7742.5,-378 8369.5,-378 8369.5,-446"/>
<text text-anchor="middle" x="8056" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 1 Attention Output Block 15</text>
<text text-anchor="middle" x="8056" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="8056" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
<text text-anchor="middle" x="8056" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_weighted_15&#45;&gt;layer1_attn_out_15 -->
<g id="edge164" class="edge">
<title>layer1_attn_weighted_15&#45;&gt;layer1_attn_out_15</title>
<path fill="none" stroke="black" d="M8056,-515.89C8056,-515.89 8056,-456.2 8056,-456.2"/>
<polygon fill="black" stroke="black" points="8059.5,-456.2 8056,-446.2 8052.5,-456.2 8059.5,-456.2"/>
</g>
<!-- layer1_attn_out_15&#45;&gt;layer1_attn_aggregate -->
<g id="edge165" class="edge">
<title>layer1_attn_out_15&#45;&gt;layer1_attn_aggregate</title>
<path fill="none" stroke="black" d="M7829.12,-377.61C7829.12,-377.61 7829.12,-318.12 7829.12,-318.12"/>
<polygon fill="black" stroke="black" points="7832.62,-318.12 7829.12,-308.12 7825.62,-318.12 7832.62,-318.12"/>
</g>
<!-- recv_from_pool_1 -->
<g id="node140" class="node">
<title>recv_from_pool_1</title>
<polygon fill="yellow" stroke="black" points="24619.69,-136 23729.35,-136 23500.31,0 24390.65,0 24619.69,-136"/>
<text text-anchor="middle" x="24060" y="-86.8" font-family="Times,serif" font-size="14.00">Receive Layer 1 from Pool</text>
<text text-anchor="middle" x="24060" y="-71.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;23] → [0&#45;7]</text>
<text text-anchor="middle" x="24060" y="-56.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="24060" y="-41.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer1_attn_aggregate&#45;&gt;recv_from_pool_1 -->
<g id="edge166" class="edge">
<title>layer1_attn_aggregate&#45;&gt;recv_from_pool_1</title>
<path fill="none" stroke="black" d="M7883.88,-292C8029.64,-292 8142.62,-292 8142.62,-292 8142.62,-292 8142.62,-68 8142.62,-68 8142.62,-68 23604.79,-68 23604.79,-68"/>
<polygon fill="black" stroke="black" points="23604.79,-71.5 23614.79,-68 23604.79,-64.5 23604.79,-71.5"/>
</g>
<!-- recv_from_pool_1&#45;&gt;layer2_ffn_start -->
<g id="edge167" class="edge">
<title>recv_from_pool_1&#45;&gt;layer2_ffn_start</title>
<path fill="none" stroke="black" d="M23832,-136.02C23832,-385.94 23832,-1239 23832,-1239 23832,-1239 15270.06,-1239 15270.06,-1239"/>
<polygon fill="black" stroke="black" points="15270.06,-1235.5 15260.06,-1239 15270.06,-1242.5 15270.06,-1235.5"/>
</g>
<!-- layer2_attn_qkv_0 -->
<g id="node142" class="node">
<title>layer2_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="21992,-963 21396,-963 21396,-895 21992,-895 21992,-963"/>
<text text-anchor="middle" x="21694" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 0</text>
<text text-anchor="middle" x="21694" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="21694" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="21694" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_0 -->
<g id="edge169" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_0</title>
<path fill="none" stroke="black" d="M20388.06,-1042C20872.45,-1042 21694,-1042 21694,-1042 21694,-1042 21694,-973.21 21694,-973.21"/>
<polygon fill="black" stroke="black" points="21697.5,-973.21 21694,-963.21 21690.5,-973.21 21697.5,-973.21"/>
</g>
<!-- layer2_attn_qkv_1 -->
<g id="node146" class="node">
<title>layer2_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="22834.5,-963 22211.5,-963 22211.5,-895 22834.5,-895 22834.5,-963"/>
<text text-anchor="middle" x="22523" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 1</text>
<text text-anchor="middle" x="22523" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="22523" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="22523" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_1 -->
<g id="edge174" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_1</title>
<path fill="none" stroke="black" d="M20421.51,-1062C21116.51,-1062 22523,-1062 22523,-1062 22523,-1062 22523,-973.25 22523,-973.25"/>
<polygon fill="black" stroke="black" points="22526.5,-973.25 22523,-963.25 22519.5,-973.25 22526.5,-973.25"/>
</g>
<!-- layer2_attn_qkv_2 -->
<g id="node150" class="node">
<title>layer2_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="23676.5,-963 23053.5,-963 23053.5,-895 23676.5,-895 23676.5,-963"/>
<text text-anchor="middle" x="23365" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 2</text>
<text text-anchor="middle" x="23365" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="23365" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="23365" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_2 -->
<g id="edge179" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_2</title>
<path fill="none" stroke="black" d="M20453.63,-1081C21343.13,-1081 23365,-1081 23365,-1081 23365,-1081 23365,-973.11 23365,-973.11"/>
<polygon fill="black" stroke="black" points="23368.5,-973.11 23365,-963.11 23361.5,-973.11 23368.5,-973.11"/>
</g>
<!-- layer2_attn_qkv_3 -->
<g id="node154" class="node">
<title>layer2_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="24518.5,-963 23895.5,-963 23895.5,-895 24518.5,-895 24518.5,-963"/>
<text text-anchor="middle" x="24207" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 3</text>
<text text-anchor="middle" x="24207" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="24207" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="24207" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_3 -->
<g id="edge184" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_3</title>
<path fill="none" stroke="black" d="M20487.23,-1101C21561.37,-1101 24207,-1101 24207,-1101 24207,-1101 24207,-973.39 24207,-973.39"/>
<polygon fill="black" stroke="black" points="24210.5,-973.39 24207,-963.39 24203.5,-973.39 24210.5,-973.39"/>
</g>
<!-- layer2_attn_qkv_4 -->
<g id="node158" class="node">
<title>layer2_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="25360.5,-963 24737.5,-963 24737.5,-895 25360.5,-895 25360.5,-963"/>
<text text-anchor="middle" x="25049" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 4</text>
<text text-anchor="middle" x="25049" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="25049" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="25049" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_4 -->
<g id="edge189" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_4</title>
<path fill="none" stroke="black" d="M20519.26,-1120C21770.36,-1120 25049,-1120 25049,-1120 25049,-1120 25049,-973.15 25049,-973.15"/>
<polygon fill="black" stroke="black" points="25052.5,-973.15 25049,-963.15 25045.5,-973.15 25052.5,-973.15"/>
</g>
<!-- layer2_attn_qkv_5 -->
<g id="node162" class="node">
<title>layer2_attn_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="26202.5,-963 25579.5,-963 25579.5,-895 26202.5,-895 26202.5,-963"/>
<text text-anchor="middle" x="25891" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 5</text>
<text text-anchor="middle" x="25891" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="25891" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="25891" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_5 -->
<g id="edge194" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_5</title>
<path fill="none" stroke="black" d="M20551.47,-1139C21975.02,-1139 25891,-1139 25891,-1139 25891,-1139 25891,-973.21 25891,-973.21"/>
<polygon fill="black" stroke="black" points="25894.5,-973.21 25891,-963.21 25887.5,-973.21 25894.5,-973.21"/>
</g>
<!-- layer2_attn_qkv_6 -->
<g id="node166" class="node">
<title>layer2_attn_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="27044.5,-963 26421.5,-963 26421.5,-895 27044.5,-895 27044.5,-963"/>
<text text-anchor="middle" x="26733" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 6</text>
<text text-anchor="middle" x="26733" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="26733" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="26733" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_6 -->
<g id="edge199" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_6</title>
<path fill="none" stroke="black" d="M20584.95,-1159C22178.8,-1159 26733,-1159 26733,-1159 26733,-1159 26733,-973.43 26733,-973.43"/>
<polygon fill="black" stroke="black" points="26736.5,-973.43 26733,-963.43 26729.5,-973.43 26736.5,-973.43"/>
</g>
<!-- layer2_attn_qkv_7 -->
<g id="node170" class="node">
<title>layer2_attn_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="14437.5,-963 13814.5,-963 13814.5,-895 14437.5,-895 14437.5,-963"/>
<text text-anchor="middle" x="14126" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 7</text>
<text text-anchor="middle" x="14126" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14126" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="14126" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_7 -->
<g id="edge204" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_7</title>
<path fill="none" stroke="black" d="M19510.84,-1050C18087.8,-1050 14296.75,-1050 14296.75,-1050 14296.75,-1050 14296.75,-973.03 14296.75,-973.03"/>
<polygon fill="black" stroke="black" points="14300.25,-973.03 14296.75,-963.03 14293.25,-973.03 14300.25,-973.03"/>
</g>
<!-- layer2_attn_qkv_8 -->
<g id="node174" class="node">
<title>layer2_attn_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="15256.5,-963 14633.5,-963 14633.5,-895 15256.5,-895 15256.5,-963"/>
<text text-anchor="middle" x="14945" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 8</text>
<text text-anchor="middle" x="14945" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="14945" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="14945" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_8 -->
<g id="edge209" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_8</title>
<path fill="none" stroke="black" d="M19505.84,-1047C18188.35,-1047 14898.83,-1047 14898.83,-1047 14898.83,-1047 14898.83,-973.13 14898.83,-973.13"/>
<polygon fill="black" stroke="black" points="14902.33,-973.13 14898.83,-963.13 14895.33,-973.13 14902.33,-973.13"/>
</g>
<!-- layer2_attn_qkv_9 -->
<g id="node178" class="node">
<title>layer2_attn_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="16131,-963 15499,-963 15499,-895 16131,-895 16131,-963"/>
<text text-anchor="middle" x="15815" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 9</text>
<text text-anchor="middle" x="15815" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="15815" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="15815" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_9 -->
<g id="edge214" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_9</title>
<path fill="none" stroke="black" d="M19500.67,-1044C18407.09,-1044 16037.73,-1044 16037.73,-1044 16037.73,-1044 16037.73,-973.19 16037.73,-973.19"/>
<polygon fill="black" stroke="black" points="16041.23,-973.19 16037.73,-963.19 16034.23,-973.19 16041.23,-973.19"/>
</g>
<!-- layer2_attn_qkv_10 -->
<g id="node182" class="node">
<title>layer2_attn_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="16968.5,-963 16327.5,-963 16327.5,-895 16968.5,-895 16968.5,-963"/>
<text text-anchor="middle" x="16648" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 10</text>
<text text-anchor="middle" x="16648" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="16648" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="16648" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_10 -->
<g id="edge219" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_10</title>
<path fill="none" stroke="black" d="M19495.66,-1041C18597.04,-1041 16905.5,-1041 16905.5,-1041 16905.5,-1041 16905.5,-973.21 16905.5,-973.21"/>
<polygon fill="black" stroke="black" points="16909,-973.21 16905.5,-963.21 16902,-973.21 16909,-973.21"/>
</g>
<!-- layer2_attn_qkv_11 -->
<g id="node186" class="node">
<title>layer2_attn_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="17851.5,-963 17210.5,-963 17210.5,-895 17851.5,-895 17851.5,-963"/>
<text text-anchor="middle" x="17531" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 11</text>
<text text-anchor="middle" x="17531" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="17531" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="17531" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_11 -->
<g id="edge224" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_11</title>
<path fill="none" stroke="black" d="M19490.66,-1038C18821.31,-1038 17780.83,-1038 17780.83,-1038 17780.83,-1038 17780.83,-973.19 17780.83,-973.19"/>
<polygon fill="black" stroke="black" points="17784.33,-973.19 17780.83,-963.19 17777.33,-973.19 17784.33,-973.19"/>
</g>
<!-- layer2_attn_qkv_12 -->
<g id="node190" class="node">
<title>layer2_attn_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="18688.5,-963 18047.5,-963 18047.5,-895 18688.5,-895 18688.5,-963"/>
<text text-anchor="middle" x="18368" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 12</text>
<text text-anchor="middle" x="18368" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="18368" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="18368" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_12 -->
<g id="edge229" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_12</title>
<path fill="none" stroke="black" d="M19485.47,-1035C19088.79,-1035 18625.5,-1035 18625.5,-1035 18625.5,-1035 18625.5,-973.12 18625.5,-973.12"/>
<polygon fill="black" stroke="black" points="18629,-973.12 18625.5,-963.12 18622,-973.12 18629,-973.12"/>
</g>
<!-- layer2_attn_qkv_13 -->
<g id="node194" class="node">
<title>layer2_attn_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="19571.5,-963 18930.5,-963 18930.5,-895 19571.5,-895 19571.5,-963"/>
<text text-anchor="middle" x="19251" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 13</text>
<text text-anchor="middle" x="19251" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="19251" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="19251" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_13 -->
<g id="edge234" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_13</title>
<path fill="none" stroke="black" d="M19526.83,-1100.88C19526.83,-1100.88 19526.83,-973.26 19526.83,-973.26"/>
<polygon fill="black" stroke="black" points="19530.33,-973.26 19526.83,-963.26 19523.33,-973.26 19530.33,-973.26"/>
</g>
<!-- layer2_attn_qkv_14 -->
<g id="node198" class="node">
<title>layer2_attn_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="20362.5,-963 19721.5,-963 19721.5,-895 20362.5,-895 20362.5,-963"/>
<text text-anchor="middle" x="20042" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 14</text>
<text text-anchor="middle" x="20042" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="20042" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="20042" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_14 -->
<g id="edge239" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_14</title>
<path fill="none" stroke="black" d="M20042,-1032.53C20042,-1032.53 20042,-973.24 20042,-973.24"/>
<polygon fill="black" stroke="black" points="20045.5,-973.24 20042,-963.24 20038.5,-973.24 20045.5,-973.24"/>
</g>
<!-- layer2_attn_qkv_15 -->
<g id="node202" class="node">
<title>layer2_attn_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="21176.5,-963 20535.5,-963 20535.5,-895 21176.5,-895 21176.5,-963"/>
<text text-anchor="middle" x="20856" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 2 QKV Block 15</text>
<text text-anchor="middle" x="20856" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="20856" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="20856" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_2&#45;&gt;layer2_attn_qkv_15 -->
<g id="edge244" class="edge">
<title>send_to_pool_2&#45;&gt;layer2_attn_qkv_15</title>
<path fill="none" stroke="black" d="M20568.67,-1100.88C20568.67,-1100.88 20568.67,-973.26 20568.67,-973.26"/>
<polygon fill="black" stroke="black" points="20572.17,-973.26 20568.67,-963.26 20565.17,-973.26 20572.17,-973.26"/>
</g>
<!-- layer2_attn_scores_0 -->
<g id="node143" class="node">
<title>layer2_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="21959.5,-792 21474.5,-792 21474.5,-724 21959.5,-724 21959.5,-792"/>
<text text-anchor="middle" x="21717" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 0</text>
<text text-anchor="middle" x="21717" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="21717" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="21717" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_0&#45;&gt;layer2_attn_scores_0 -->
<g id="edge170" class="edge">
<title>layer2_attn_qkv_0&#45;&gt;layer2_attn_scores_0</title>
<path fill="none" stroke="black" d="M21717,-894.81C21717,-894.81 21717,-802.13 21717,-802.13"/>
<polygon fill="black" stroke="black" points="21720.5,-802.13 21717,-792.13 21713.5,-802.13 21720.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_0 -->
<g id="node144" class="node">
<title>layer2_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="22129.5,-688 21350.5,-688 21350.5,-620 22129.5,-620 22129.5,-688"/>
<text text-anchor="middle" x="21740" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 0</text>
<text text-anchor="middle" x="21740" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="21740" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="21740" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_0&#45;&gt;layer2_attn_weighted_0 -->
<g id="edge171" class="edge">
<title>layer2_attn_scores_0&#45;&gt;layer2_attn_weighted_0</title>
<path fill="none" stroke="black" d="M21717,-723.95C21717,-723.95 21717,-698.13 21717,-698.13"/>
<polygon fill="black" stroke="black" points="21720.5,-698.13 21717,-688.13 21713.5,-698.13 21720.5,-698.13"/>
</g>
<!-- layer2_attn_out_0 -->
<g id="node145" class="node">
<title>layer2_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="21981,-584 21399,-584 21399,-516 21981,-516 21981,-584"/>
<text text-anchor="middle" x="21690" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 0</text>
<text text-anchor="middle" x="21690" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="21690" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="21690" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_0&#45;&gt;layer2_attn_out_0 -->
<g id="edge172" class="edge">
<title>layer2_attn_weighted_0&#45;&gt;layer2_attn_out_0</title>
<path fill="none" stroke="black" d="M21690,-619.95C21690,-619.95 21690,-594.13 21690,-594.13"/>
<polygon fill="black" stroke="black" points="21693.5,-594.13 21690,-584.13 21686.5,-594.13 21693.5,-594.13"/>
</g>
<!-- layer2_attn_aggregate -->
<g id="node206" class="node">
<title>layer2_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="20711.99,-480 19646.19,-480 19372.01,-344 20437.81,-344 20711.99,-480"/>
<text text-anchor="middle" x="20042" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Aggregation</text>
<text text-anchor="middle" x="20042" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="20042" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="20042" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_out_0&#45;&gt;layer2_attn_aggregate -->
<g id="edge173" class="edge">
<title>layer2_attn_out_0&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M21690,-515.75C21690,-473.44 21690,-407 21690,-407 21690,-407 20574.85,-407 20574.85,-407"/>
<polygon fill="black" stroke="black" points="20574.85,-403.5 20564.85,-407 20574.85,-410.5 20574.85,-403.5"/>
</g>
<!-- layer2_attn_scores_1 -->
<g id="node147" class="node">
<title>layer2_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="22802,-792 22290,-792 22290,-724 22802,-724 22802,-792"/>
<text text-anchor="middle" x="22546" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 1</text>
<text text-anchor="middle" x="22546" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="22546" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="22546" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_1&#45;&gt;layer2_attn_scores_1 -->
<g id="edge175" class="edge">
<title>layer2_attn_qkv_1&#45;&gt;layer2_attn_scores_1</title>
<path fill="none" stroke="black" d="M22546,-894.81C22546,-894.81 22546,-802.13 22546,-802.13"/>
<polygon fill="black" stroke="black" points="22549.5,-802.13 22546,-792.13 22542.5,-802.13 22549.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_1 -->
<g id="node148" class="node">
<title>layer2_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="22972,-688 22166,-688 22166,-620 22972,-620 22972,-688"/>
<text text-anchor="middle" x="22569" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 1</text>
<text text-anchor="middle" x="22569" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="22569" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="22569" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_1&#45;&gt;layer2_attn_weighted_1 -->
<g id="edge176" class="edge">
<title>layer2_attn_scores_1&#45;&gt;layer2_attn_weighted_1</title>
<path fill="none" stroke="black" d="M22546,-723.95C22546,-723.95 22546,-698.13 22546,-698.13"/>
<polygon fill="black" stroke="black" points="22549.5,-698.13 22546,-688.13 22542.5,-698.13 22549.5,-698.13"/>
</g>
<!-- layer2_attn_out_1 -->
<g id="node149" class="node">
<title>layer2_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="22823.5,-584 22214.5,-584 22214.5,-516 22823.5,-516 22823.5,-584"/>
<text text-anchor="middle" x="22519" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 1</text>
<text text-anchor="middle" x="22519" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="22519" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="22519" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_1&#45;&gt;layer2_attn_out_1 -->
<g id="edge177" class="edge">
<title>layer2_attn_weighted_1&#45;&gt;layer2_attn_out_1</title>
<path fill="none" stroke="black" d="M22519,-619.95C22519,-619.95 22519,-594.13 22519,-594.13"/>
<polygon fill="black" stroke="black" points="22522.5,-594.13 22519,-584.13 22515.5,-594.13 22522.5,-594.13"/>
</g>
<!-- layer2_attn_out_1&#45;&gt;layer2_attn_aggregate -->
<g id="edge178" class="edge">
<title>layer2_attn_out_1&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M22519,-515.89C22519,-471.07 22519,-398 22519,-398 22519,-398 20556.99,-398 20556.99,-398"/>
<polygon fill="black" stroke="black" points="20556.99,-394.5 20546.99,-398 20556.99,-401.5 20556.99,-394.5"/>
</g>
<!-- layer2_attn_scores_2 -->
<g id="node151" class="node">
<title>layer2_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="23644,-792 23132,-792 23132,-724 23644,-724 23644,-792"/>
<text text-anchor="middle" x="23388" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 2</text>
<text text-anchor="middle" x="23388" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="23388" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="23388" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_2&#45;&gt;layer2_attn_scores_2 -->
<g id="edge180" class="edge">
<title>layer2_attn_qkv_2&#45;&gt;layer2_attn_scores_2</title>
<path fill="none" stroke="black" d="M23388,-894.81C23388,-894.81 23388,-802.13 23388,-802.13"/>
<polygon fill="black" stroke="black" points="23391.5,-802.13 23388,-792.13 23384.5,-802.13 23391.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_2 -->
<g id="node152" class="node">
<title>layer2_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="23814,-688 23008,-688 23008,-620 23814,-620 23814,-688"/>
<text text-anchor="middle" x="23411" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 2</text>
<text text-anchor="middle" x="23411" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="23411" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="23411" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_2&#45;&gt;layer2_attn_weighted_2 -->
<g id="edge181" class="edge">
<title>layer2_attn_scores_2&#45;&gt;layer2_attn_weighted_2</title>
<path fill="none" stroke="black" d="M23388,-723.95C23388,-723.95 23388,-698.13 23388,-698.13"/>
<polygon fill="black" stroke="black" points="23391.5,-698.13 23388,-688.13 23384.5,-698.13 23391.5,-698.13"/>
</g>
<!-- layer2_attn_out_2 -->
<g id="node153" class="node">
<title>layer2_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="23665.5,-584 23056.5,-584 23056.5,-516 23665.5,-516 23665.5,-584"/>
<text text-anchor="middle" x="23361" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 2</text>
<text text-anchor="middle" x="23361" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="23361" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="23361" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_2&#45;&gt;layer2_attn_out_2 -->
<g id="edge182" class="edge">
<title>layer2_attn_weighted_2&#45;&gt;layer2_attn_out_2</title>
<path fill="none" stroke="black" d="M23361,-619.95C23361,-619.95 23361,-594.13 23361,-594.13"/>
<polygon fill="black" stroke="black" points="23364.5,-594.13 23361,-584.13 23357.5,-594.13 23364.5,-594.13"/>
</g>
<!-- layer2_attn_out_2&#45;&gt;layer2_attn_aggregate -->
<g id="edge183" class="edge">
<title>layer2_attn_out_2&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M23278.33,-515.86C23278.33,-468.6 23278.33,-389 23278.33,-389 23278.33,-389 20538.7,-389 20538.7,-389"/>
<polygon fill="black" stroke="black" points="20538.7,-385.5 20528.7,-389 20538.7,-392.5 20538.7,-385.5"/>
</g>
<!-- layer2_attn_scores_3 -->
<g id="node155" class="node">
<title>layer2_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="24486,-792 23974,-792 23974,-724 24486,-724 24486,-792"/>
<text text-anchor="middle" x="24230" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 3</text>
<text text-anchor="middle" x="24230" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="24230" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="24230" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_3&#45;&gt;layer2_attn_scores_3 -->
<g id="edge185" class="edge">
<title>layer2_attn_qkv_3&#45;&gt;layer2_attn_scores_3</title>
<path fill="none" stroke="black" d="M24230,-894.81C24230,-894.81 24230,-802.13 24230,-802.13"/>
<polygon fill="black" stroke="black" points="24233.5,-802.13 24230,-792.13 24226.5,-802.13 24233.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_3 -->
<g id="node156" class="node">
<title>layer2_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="24656,-688 23850,-688 23850,-620 24656,-620 24656,-688"/>
<text text-anchor="middle" x="24253" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 3</text>
<text text-anchor="middle" x="24253" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="24253" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="24253" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_3&#45;&gt;layer2_attn_weighted_3 -->
<g id="edge186" class="edge">
<title>layer2_attn_scores_3&#45;&gt;layer2_attn_weighted_3</title>
<path fill="none" stroke="black" d="M24230,-723.95C24230,-723.95 24230,-698.13 24230,-698.13"/>
<polygon fill="black" stroke="black" points="24233.5,-698.13 24230,-688.13 24226.5,-698.13 24233.5,-698.13"/>
</g>
<!-- layer2_attn_out_3 -->
<g id="node157" class="node">
<title>layer2_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="24507.5,-584 23898.5,-584 23898.5,-516 24507.5,-516 24507.5,-584"/>
<text text-anchor="middle" x="24203" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 3</text>
<text text-anchor="middle" x="24203" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="24203" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="24203" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_3&#45;&gt;layer2_attn_out_3 -->
<g id="edge187" class="edge">
<title>layer2_attn_weighted_3&#45;&gt;layer2_attn_out_3</title>
<path fill="none" stroke="black" d="M24203,-619.95C24203,-619.95 24203,-594.13 24203,-594.13"/>
<polygon fill="black" stroke="black" points="24206.5,-594.13 24203,-584.13 24199.5,-594.13 24206.5,-594.13"/>
</g>
<!-- layer2_attn_out_3&#45;&gt;layer2_attn_aggregate -->
<g id="edge188" class="edge">
<title>layer2_attn_out_3&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M24203,-515.6C24203,-465.92 24203,-380 24203,-380 24203,-380 20520.48,-380 20520.48,-380"/>
<polygon fill="black" stroke="black" points="20520.48,-376.5 20510.48,-380 20520.48,-383.5 20520.48,-376.5"/>
</g>
<!-- layer2_attn_scores_4 -->
<g id="node159" class="node">
<title>layer2_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="25328,-792 24816,-792 24816,-724 25328,-724 25328,-792"/>
<text text-anchor="middle" x="25072" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 4</text>
<text text-anchor="middle" x="25072" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="25072" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="25072" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_4&#45;&gt;layer2_attn_scores_4 -->
<g id="edge190" class="edge">
<title>layer2_attn_qkv_4&#45;&gt;layer2_attn_scores_4</title>
<path fill="none" stroke="black" d="M25072,-894.81C25072,-894.81 25072,-802.13 25072,-802.13"/>
<polygon fill="black" stroke="black" points="25075.5,-802.13 25072,-792.13 25068.5,-802.13 25075.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_4 -->
<g id="node160" class="node">
<title>layer2_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="25498,-688 24692,-688 24692,-620 25498,-620 25498,-688"/>
<text text-anchor="middle" x="25095" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 4</text>
<text text-anchor="middle" x="25095" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="25095" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="25095" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_4&#45;&gt;layer2_attn_weighted_4 -->
<g id="edge191" class="edge">
<title>layer2_attn_scores_4&#45;&gt;layer2_attn_weighted_4</title>
<path fill="none" stroke="black" d="M25072,-723.95C25072,-723.95 25072,-698.13 25072,-698.13"/>
<polygon fill="black" stroke="black" points="25075.5,-698.13 25072,-688.13 25068.5,-698.13 25075.5,-698.13"/>
</g>
<!-- layer2_attn_out_4 -->
<g id="node161" class="node">
<title>layer2_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="25349.5,-584 24740.5,-584 24740.5,-516 25349.5,-516 25349.5,-584"/>
<text text-anchor="middle" x="25045" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 4</text>
<text text-anchor="middle" x="25045" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="25045" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="25045" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_4&#45;&gt;layer2_attn_out_4 -->
<g id="edge192" class="edge">
<title>layer2_attn_weighted_4&#45;&gt;layer2_attn_out_4</title>
<path fill="none" stroke="black" d="M25045,-619.95C25045,-619.95 25045,-594.13 25045,-594.13"/>
<polygon fill="black" stroke="black" points="25048.5,-594.13 25045,-584.13 25041.5,-594.13 25048.5,-594.13"/>
</g>
<!-- layer2_attn_out_4&#45;&gt;layer2_attn_aggregate -->
<g id="edge193" class="edge">
<title>layer2_attn_out_4&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M25045,-515.91C25045,-463.97 25045,-371 25045,-371 25045,-371 20502.32,-371 20502.32,-371"/>
<polygon fill="black" stroke="black" points="20502.32,-367.5 20492.32,-371 20502.32,-374.5 20502.32,-367.5"/>
</g>
<!-- layer2_attn_scores_5 -->
<g id="node163" class="node">
<title>layer2_attn_scores_5</title>
<polygon fill="lightblue" stroke="black" points="26170,-792 25658,-792 25658,-724 26170,-724 26170,-792"/>
<text text-anchor="middle" x="25914" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 5</text>
<text text-anchor="middle" x="25914" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="25914" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="25914" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_5&#45;&gt;layer2_attn_scores_5 -->
<g id="edge195" class="edge">
<title>layer2_attn_qkv_5&#45;&gt;layer2_attn_scores_5</title>
<path fill="none" stroke="black" d="M25914,-894.81C25914,-894.81 25914,-802.13 25914,-802.13"/>
<polygon fill="black" stroke="black" points="25917.5,-802.13 25914,-792.13 25910.5,-802.13 25917.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_5 -->
<g id="node164" class="node">
<title>layer2_attn_weighted_5</title>
<polygon fill="lightblue" stroke="black" points="26340,-688 25534,-688 25534,-620 26340,-620 26340,-688"/>
<text text-anchor="middle" x="25937" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 5</text>
<text text-anchor="middle" x="25937" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="25937" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="25937" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_5&#45;&gt;layer2_attn_weighted_5 -->
<g id="edge196" class="edge">
<title>layer2_attn_scores_5&#45;&gt;layer2_attn_weighted_5</title>
<path fill="none" stroke="black" d="M25914,-723.95C25914,-723.95 25914,-698.13 25914,-698.13"/>
<polygon fill="black" stroke="black" points="25917.5,-698.13 25914,-688.13 25910.5,-698.13 25917.5,-698.13"/>
</g>
<!-- layer2_attn_out_5 -->
<g id="node165" class="node">
<title>layer2_attn_out_5</title>
<polygon fill="lightblue" stroke="black" points="26191.5,-584 25582.5,-584 25582.5,-516 26191.5,-516 26191.5,-584"/>
<text text-anchor="middle" x="25887" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 5</text>
<text text-anchor="middle" x="25887" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="25887" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="25887" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_5&#45;&gt;layer2_attn_out_5 -->
<g id="edge197" class="edge">
<title>layer2_attn_weighted_5&#45;&gt;layer2_attn_out_5</title>
<path fill="none" stroke="black" d="M25887,-619.95C25887,-619.95 25887,-594.13 25887,-594.13"/>
<polygon fill="black" stroke="black" points="25890.5,-594.13 25887,-584.13 25883.5,-594.13 25890.5,-594.13"/>
</g>
<!-- layer2_attn_out_5&#45;&gt;layer2_attn_aggregate -->
<g id="edge198" class="edge">
<title>layer2_attn_out_5&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M25887,-515.95C25887,-461.78 25887,-362 25887,-362 25887,-362 20484.17,-362 20484.17,-362"/>
<polygon fill="black" stroke="black" points="20484.17,-358.5 20474.17,-362 20484.17,-365.5 20484.17,-358.5"/>
</g>
<!-- layer2_attn_scores_6 -->
<g id="node167" class="node">
<title>layer2_attn_scores_6</title>
<polygon fill="lightblue" stroke="black" points="27012,-792 26500,-792 26500,-724 27012,-724 27012,-792"/>
<text text-anchor="middle" x="26756" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 6</text>
<text text-anchor="middle" x="26756" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="26756" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="26756" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_6&#45;&gt;layer2_attn_scores_6 -->
<g id="edge200" class="edge">
<title>layer2_attn_qkv_6&#45;&gt;layer2_attn_scores_6</title>
<path fill="none" stroke="black" d="M26756,-894.81C26756,-894.81 26756,-802.13 26756,-802.13"/>
<polygon fill="black" stroke="black" points="26759.5,-802.13 26756,-792.13 26752.5,-802.13 26759.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_6 -->
<g id="node168" class="node">
<title>layer2_attn_weighted_6</title>
<polygon fill="lightblue" stroke="black" points="27182,-688 26376,-688 26376,-620 27182,-620 27182,-688"/>
<text text-anchor="middle" x="26779" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 6</text>
<text text-anchor="middle" x="26779" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="26779" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="26779" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_6&#45;&gt;layer2_attn_weighted_6 -->
<g id="edge201" class="edge">
<title>layer2_attn_scores_6&#45;&gt;layer2_attn_weighted_6</title>
<path fill="none" stroke="black" d="M26756,-723.95C26756,-723.95 26756,-698.13 26756,-698.13"/>
<polygon fill="black" stroke="black" points="26759.5,-698.13 26756,-688.13 26752.5,-698.13 26759.5,-698.13"/>
</g>
<!-- layer2_attn_out_6 -->
<g id="node169" class="node">
<title>layer2_attn_out_6</title>
<polygon fill="lightblue" stroke="black" points="27033.5,-584 26424.5,-584 26424.5,-516 27033.5,-516 27033.5,-584"/>
<text text-anchor="middle" x="26729" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 6</text>
<text text-anchor="middle" x="26729" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="26729" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="26729" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_6&#45;&gt;layer2_attn_out_6 -->
<g id="edge202" class="edge">
<title>layer2_attn_weighted_6&#45;&gt;layer2_attn_out_6</title>
<path fill="none" stroke="black" d="M26729,-619.95C26729,-619.95 26729,-594.13 26729,-594.13"/>
<polygon fill="black" stroke="black" points="26732.5,-594.13 26729,-584.13 26725.5,-594.13 26732.5,-594.13"/>
</g>
<!-- layer2_attn_out_6&#45;&gt;layer2_attn_aggregate -->
<g id="edge203" class="edge">
<title>layer2_attn_out_6&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M26729,-515.69C26729,-459.24 26729,-353 26729,-353 26729,-353 20466.2,-353 20466.2,-353"/>
<polygon fill="black" stroke="black" points="20466.2,-349.5 20456.2,-353 20466.2,-356.5 20466.2,-349.5"/>
</g>
<!-- layer2_attn_scores_7 -->
<g id="node171" class="node">
<title>layer2_attn_scores_7</title>
<polygon fill="lightblue" stroke="black" points="14336,-792 13824,-792 13824,-724 14336,-724 14336,-792"/>
<text text-anchor="middle" x="14080" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 7</text>
<text text-anchor="middle" x="14080" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14080" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14080" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_7&#45;&gt;layer2_attn_scores_7 -->
<g id="edge205" class="edge">
<title>layer2_attn_qkv_7&#45;&gt;layer2_attn_scores_7</title>
<path fill="none" stroke="black" d="M14080,-894.81C14080,-894.81 14080,-802.13 14080,-802.13"/>
<polygon fill="black" stroke="black" points="14083.5,-802.13 14080,-792.13 14076.5,-802.13 14083.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_7 -->
<g id="node172" class="node">
<title>layer2_attn_weighted_7</title>
<polygon fill="lightblue" stroke="black" points="14460,-688 13654,-688 13654,-620 14460,-620 14460,-688"/>
<text text-anchor="middle" x="14057" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 7</text>
<text text-anchor="middle" x="14057" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14057" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="14057" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_7&#45;&gt;layer2_attn_weighted_7 -->
<g id="edge206" class="edge">
<title>layer2_attn_scores_7&#45;&gt;layer2_attn_weighted_7</title>
<path fill="none" stroke="black" d="M14080,-723.95C14080,-723.95 14080,-698.13 14080,-698.13"/>
<polygon fill="black" stroke="black" points="14083.5,-698.13 14080,-688.13 14076.5,-698.13 14083.5,-698.13"/>
</g>
<!-- layer2_attn_out_7 -->
<g id="node173" class="node">
<title>layer2_attn_out_7</title>
<polygon fill="lightblue" stroke="black" points="14410.5,-584 13801.5,-584 13801.5,-516 14410.5,-516 14410.5,-584"/>
<text text-anchor="middle" x="14106" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 7</text>
<text text-anchor="middle" x="14106" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14106" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14106" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_7&#45;&gt;layer2_attn_out_7 -->
<g id="edge207" class="edge">
<title>layer2_attn_weighted_7&#45;&gt;layer2_attn_out_7</title>
<path fill="none" stroke="black" d="M14106,-619.95C14106,-619.95 14106,-594.13 14106,-594.13"/>
<polygon fill="black" stroke="black" points="14109.5,-594.13 14106,-584.13 14102.5,-594.13 14109.5,-594.13"/>
</g>
<!-- layer2_attn_out_7&#45;&gt;layer2_attn_aggregate -->
<g id="edge208" class="edge">
<title>layer2_attn_out_7&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M14106,-515.87C14106,-486.9 14106,-450 14106,-450 14106,-450 19575.46,-450 19575.46,-450"/>
<polygon fill="black" stroke="black" points="19575.46,-453.5 19585.46,-450 19575.46,-446.5 19575.46,-453.5"/>
</g>
<!-- layer2_attn_scores_8 -->
<g id="node175" class="node">
<title>layer2_attn_scores_8</title>
<polygon fill="lightblue" stroke="black" points="15178,-792 14666,-792 14666,-724 15178,-724 15178,-792"/>
<text text-anchor="middle" x="14922" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 8</text>
<text text-anchor="middle" x="14922" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="14922" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14922" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_8&#45;&gt;layer2_attn_scores_8 -->
<g id="edge210" class="edge">
<title>layer2_attn_qkv_8&#45;&gt;layer2_attn_scores_8</title>
<path fill="none" stroke="black" d="M14922,-894.81C14922,-894.81 14922,-802.13 14922,-802.13"/>
<polygon fill="black" stroke="black" points="14925.5,-802.13 14922,-792.13 14918.5,-802.13 14925.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_8 -->
<g id="node176" class="node">
<title>layer2_attn_weighted_8</title>
<polygon fill="lightblue" stroke="black" points="15302,-688 14496,-688 14496,-620 15302,-620 15302,-688"/>
<text text-anchor="middle" x="14899" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 8</text>
<text text-anchor="middle" x="14899" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="14899" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="14899" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_8&#45;&gt;layer2_attn_weighted_8 -->
<g id="edge211" class="edge">
<title>layer2_attn_scores_8&#45;&gt;layer2_attn_weighted_8</title>
<path fill="none" stroke="black" d="M14922,-723.95C14922,-723.95 14922,-698.13 14922,-698.13"/>
<polygon fill="black" stroke="black" points="14925.5,-698.13 14922,-688.13 14918.5,-698.13 14925.5,-698.13"/>
</g>
<!-- layer2_attn_out_8 -->
<g id="node177" class="node">
<title>layer2_attn_out_8</title>
<polygon fill="lightblue" stroke="black" points="15252.5,-584 14643.5,-584 14643.5,-516 15252.5,-516 15252.5,-584"/>
<text text-anchor="middle" x="14948" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 8</text>
<text text-anchor="middle" x="14948" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="14948" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
<text text-anchor="middle" x="14948" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_8&#45;&gt;layer2_attn_out_8 -->
<g id="edge212" class="edge">
<title>layer2_attn_weighted_8&#45;&gt;layer2_attn_out_8</title>
<path fill="none" stroke="black" d="M14948,-619.95C14948,-619.95 14948,-594.13 14948,-594.13"/>
<polygon fill="black" stroke="black" points="14951.5,-594.13 14948,-584.13 14944.5,-594.13 14951.5,-594.13"/>
</g>
<!-- layer2_attn_out_8&#45;&gt;layer2_attn_aggregate -->
<g id="edge213" class="edge">
<title>layer2_attn_out_8&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M14948,-515.97C14948,-488.71 14948,-455 14948,-455 14948,-455 19585.52,-455 19585.52,-455"/>
<polygon fill="black" stroke="black" points="19585.52,-458.5 19595.52,-455 19585.52,-451.5 19585.52,-458.5"/>
</g>
<!-- layer2_attn_scores_9 -->
<g id="node179" class="node">
<title>layer2_attn_scores_9</title>
<polygon fill="lightblue" stroke="black" points="16029.5,-792 15508.5,-792 15508.5,-724 16029.5,-724 16029.5,-792"/>
<text text-anchor="middle" x="15769" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 9</text>
<text text-anchor="middle" x="15769" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="15769" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15769" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_9&#45;&gt;layer2_attn_scores_9 -->
<g id="edge215" class="edge">
<title>layer2_attn_qkv_9&#45;&gt;layer2_attn_scores_9</title>
<path fill="none" stroke="black" d="M15769,-894.81C15769,-894.81 15769,-802.13 15769,-802.13"/>
<polygon fill="black" stroke="black" points="15772.5,-802.13 15769,-792.13 15765.5,-802.13 15772.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_9 -->
<g id="node180" class="node">
<title>layer2_attn_weighted_9</title>
<polygon fill="lightblue" stroke="black" points="16153.5,-688 15338.5,-688 15338.5,-620 16153.5,-620 16153.5,-688"/>
<text text-anchor="middle" x="15746" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 9</text>
<text text-anchor="middle" x="15746" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="15746" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="15746" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_9&#45;&gt;layer2_attn_weighted_9 -->
<g id="edge216" class="edge">
<title>layer2_attn_scores_9&#45;&gt;layer2_attn_weighted_9</title>
<path fill="none" stroke="black" d="M15769,-723.95C15769,-723.95 15769,-698.13 15769,-698.13"/>
<polygon fill="black" stroke="black" points="15772.5,-698.13 15769,-688.13 15765.5,-698.13 15772.5,-698.13"/>
</g>
<!-- layer2_attn_out_9 -->
<g id="node181" class="node">
<title>layer2_attn_out_9</title>
<polygon fill="lightblue" stroke="black" points="16104,-584 15486,-584 15486,-516 16104,-516 16104,-584"/>
<text text-anchor="middle" x="15795" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 9</text>
<text text-anchor="middle" x="15795" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="15795" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
<text text-anchor="middle" x="15795" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_9&#45;&gt;layer2_attn_out_9 -->
<g id="edge217" class="edge">
<title>layer2_attn_weighted_9&#45;&gt;layer2_attn_out_9</title>
<path fill="none" stroke="black" d="M15795,-619.95C15795,-619.95 15795,-594.13 15795,-594.13"/>
<polygon fill="black" stroke="black" points="15798.5,-594.13 15795,-584.13 15791.5,-594.13 15798.5,-594.13"/>
</g>
<!-- layer2_attn_out_9&#45;&gt;layer2_attn_aggregate -->
<g id="edge218" class="edge">
<title>layer2_attn_out_9&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M15795,-515.97C15795,-490.49 15795,-460 15795,-460 15795,-460 19595.48,-460 19595.48,-460"/>
<polygon fill="black" stroke="black" points="19595.48,-463.5 19605.48,-460 19595.48,-456.5 19595.48,-463.5"/>
</g>
<!-- layer2_attn_scores_10 -->
<g id="node183" class="node">
<title>layer2_attn_scores_10</title>
<polygon fill="lightblue" stroke="black" points="16890,-792 16360,-792 16360,-724 16890,-724 16890,-792"/>
<text text-anchor="middle" x="16625" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 10</text>
<text text-anchor="middle" x="16625" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="16625" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16625" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_10&#45;&gt;layer2_attn_scores_10 -->
<g id="edge220" class="edge">
<title>layer2_attn_qkv_10&#45;&gt;layer2_attn_scores_10</title>
<path fill="none" stroke="black" d="M16625,-894.81C16625,-894.81 16625,-802.13 16625,-802.13"/>
<polygon fill="black" stroke="black" points="16628.5,-802.13 16625,-792.13 16621.5,-802.13 16628.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_10 -->
<g id="node184" class="node">
<title>layer2_attn_weighted_10</title>
<polygon fill="lightblue" stroke="black" points="17014,-688 16190,-688 16190,-620 17014,-620 17014,-688"/>
<text text-anchor="middle" x="16602" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 10</text>
<text text-anchor="middle" x="16602" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="16602" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="16602" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_10&#45;&gt;layer2_attn_weighted_10 -->
<g id="edge221" class="edge">
<title>layer2_attn_scores_10&#45;&gt;layer2_attn_weighted_10</title>
<path fill="none" stroke="black" d="M16625,-723.95C16625,-723.95 16625,-698.13 16625,-698.13"/>
<polygon fill="black" stroke="black" points="16628.5,-698.13 16625,-688.13 16621.5,-698.13 16628.5,-698.13"/>
</g>
<!-- layer2_attn_out_10 -->
<g id="node185" class="node">
<title>layer2_attn_out_10</title>
<polygon fill="lightblue" stroke="black" points="16965.5,-584 16338.5,-584 16338.5,-516 16965.5,-516 16965.5,-584"/>
<text text-anchor="middle" x="16652" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 10</text>
<text text-anchor="middle" x="16652" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="16652" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
<text text-anchor="middle" x="16652" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_10&#45;&gt;layer2_attn_out_10 -->
<g id="edge222" class="edge">
<title>layer2_attn_weighted_10&#45;&gt;layer2_attn_out_10</title>
<path fill="none" stroke="black" d="M16652,-619.95C16652,-619.95 16652,-594.13 16652,-594.13"/>
<polygon fill="black" stroke="black" points="16655.5,-594.13 16652,-584.13 16648.5,-594.13 16655.5,-594.13"/>
</g>
<!-- layer2_attn_out_10&#45;&gt;layer2_attn_aggregate -->
<g id="edge223" class="edge">
<title>layer2_attn_out_10&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M16652,-515.92C16652,-492.27 16652,-465 16652,-465 16652,-465 19605.66,-465 19605.66,-465"/>
<polygon fill="black" stroke="black" points="19605.66,-468.5 19615.66,-465 19605.66,-461.5 19605.66,-468.5"/>
</g>
<!-- layer2_attn_scores_11 -->
<g id="node187" class="node">
<title>layer2_attn_scores_11</title>
<polygon fill="lightblue" stroke="black" points="17750,-792 17220,-792 17220,-724 17750,-724 17750,-792"/>
<text text-anchor="middle" x="17485" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 11</text>
<text text-anchor="middle" x="17485" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="17485" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17485" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_11&#45;&gt;layer2_attn_scores_11 -->
<g id="edge225" class="edge">
<title>layer2_attn_qkv_11&#45;&gt;layer2_attn_scores_11</title>
<path fill="none" stroke="black" d="M17485,-894.81C17485,-894.81 17485,-802.13 17485,-802.13"/>
<polygon fill="black" stroke="black" points="17488.5,-802.13 17485,-792.13 17481.5,-802.13 17488.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_11 -->
<g id="node188" class="node">
<title>layer2_attn_weighted_11</title>
<polygon fill="lightblue" stroke="black" points="17874,-688 17050,-688 17050,-620 17874,-620 17874,-688"/>
<text text-anchor="middle" x="17462" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 11</text>
<text text-anchor="middle" x="17462" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="17462" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="17462" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_11&#45;&gt;layer2_attn_weighted_11 -->
<g id="edge226" class="edge">
<title>layer2_attn_scores_11&#45;&gt;layer2_attn_weighted_11</title>
<path fill="none" stroke="black" d="M17485,-723.95C17485,-723.95 17485,-698.13 17485,-698.13"/>
<polygon fill="black" stroke="black" points="17488.5,-698.13 17485,-688.13 17481.5,-698.13 17488.5,-698.13"/>
</g>
<!-- layer2_attn_out_11 -->
<g id="node189" class="node">
<title>layer2_attn_out_11</title>
<polygon fill="lightblue" stroke="black" points="17824.5,-584 17197.5,-584 17197.5,-516 17824.5,-516 17824.5,-584"/>
<text text-anchor="middle" x="17511" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 11</text>
<text text-anchor="middle" x="17511" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="17511" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
<text text-anchor="middle" x="17511" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_11&#45;&gt;layer2_attn_out_11 -->
<g id="edge227" class="edge">
<title>layer2_attn_weighted_11&#45;&gt;layer2_attn_out_11</title>
<path fill="none" stroke="black" d="M17511,-619.95C17511,-619.95 17511,-594.13 17511,-594.13"/>
<polygon fill="black" stroke="black" points="17514.5,-594.13 17511,-584.13 17507.5,-594.13 17514.5,-594.13"/>
</g>
<!-- layer2_attn_out_11&#45;&gt;layer2_attn_aggregate -->
<g id="edge228" class="edge">
<title>layer2_attn_out_11&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M17602.17,-515.61C17602.17,-493.93 17602.17,-470 17602.17,-470 17602.17,-470 19615.7,-470 19615.7,-470"/>
<polygon fill="black" stroke="black" points="19615.7,-473.5 19625.7,-470 19615.7,-466.5 19615.7,-473.5"/>
</g>
<!-- layer2_attn_scores_12 -->
<g id="node191" class="node">
<title>layer2_attn_scores_12</title>
<polygon fill="lightblue" stroke="black" points="18610,-792 18080,-792 18080,-724 18610,-724 18610,-792"/>
<text text-anchor="middle" x="18345" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 12</text>
<text text-anchor="middle" x="18345" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="18345" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
<text text-anchor="middle" x="18345" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_12&#45;&gt;layer2_attn_scores_12 -->
<g id="edge230" class="edge">
<title>layer2_attn_qkv_12&#45;&gt;layer2_attn_scores_12</title>
<path fill="none" stroke="black" d="M18345,-894.81C18345,-894.81 18345,-802.13 18345,-802.13"/>
<polygon fill="black" stroke="black" points="18348.5,-802.13 18345,-792.13 18341.5,-802.13 18348.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_12 -->
<g id="node192" class="node">
<title>layer2_attn_weighted_12</title>
<polygon fill="lightblue" stroke="black" points="18734,-688 17910,-688 17910,-620 18734,-620 18734,-688"/>
<text text-anchor="middle" x="18322" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 12</text>
<text text-anchor="middle" x="18322" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="18322" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="18322" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_12&#45;&gt;layer2_attn_weighted_12 -->
<g id="edge231" class="edge">
<title>layer2_attn_scores_12&#45;&gt;layer2_attn_weighted_12</title>
<path fill="none" stroke="black" d="M18345,-723.95C18345,-723.95 18345,-698.13 18345,-698.13"/>
<polygon fill="black" stroke="black" points="18348.5,-698.13 18345,-688.13 18341.5,-698.13 18348.5,-698.13"/>
</g>
<!-- layer2_attn_out_12 -->
<g id="node193" class="node">
<title>layer2_attn_out_12</title>
<polygon fill="lightblue" stroke="black" points="18684.5,-584 18057.5,-584 18057.5,-516 18684.5,-516 18684.5,-584"/>
<text text-anchor="middle" x="18371" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 12</text>
<text text-anchor="middle" x="18371" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="18371" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
<text text-anchor="middle" x="18371" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_12&#45;&gt;layer2_attn_out_12 -->
<g id="edge232" class="edge">
<title>layer2_attn_weighted_12&#45;&gt;layer2_attn_out_12</title>
<path fill="none" stroke="black" d="M18371,-619.95C18371,-619.95 18371,-594.13 18371,-594.13"/>
<polygon fill="black" stroke="black" points="18374.5,-594.13 18371,-584.13 18367.5,-594.13 18374.5,-594.13"/>
</g>
<!-- layer2_attn_out_12&#45;&gt;layer2_attn_aggregate -->
<g id="edge233" class="edge">
<title>layer2_attn_out_12&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M18371,-515.57C18371,-495.86 18371,-475 18371,-475 18371,-475 19625.9,-475 19625.9,-475"/>
<polygon fill="black" stroke="black" points="19625.9,-478.5 19635.9,-475 19625.9,-471.5 19625.9,-478.5"/>
</g>
<!-- layer2_attn_scores_13 -->
<g id="node195" class="node">
<title>layer2_attn_scores_13</title>
<polygon fill="lightblue" stroke="black" points="19470,-792 18940,-792 18940,-724 19470,-724 19470,-792"/>
<text text-anchor="middle" x="19205" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 13</text>
<text text-anchor="middle" x="19205" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="19205" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
<text text-anchor="middle" x="19205" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_13&#45;&gt;layer2_attn_scores_13 -->
<g id="edge235" class="edge">
<title>layer2_attn_qkv_13&#45;&gt;layer2_attn_scores_13</title>
<path fill="none" stroke="black" d="M19205,-894.81C19205,-894.81 19205,-802.13 19205,-802.13"/>
<polygon fill="black" stroke="black" points="19208.5,-802.13 19205,-792.13 19201.5,-802.13 19208.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_13 -->
<g id="node196" class="node">
<title>layer2_attn_weighted_13</title>
<polygon fill="lightblue" stroke="black" points="19594,-688 18770,-688 18770,-620 19594,-620 19594,-688"/>
<text text-anchor="middle" x="19182" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 13</text>
<text text-anchor="middle" x="19182" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="19182" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="19182" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_13&#45;&gt;layer2_attn_weighted_13 -->
<g id="edge236" class="edge">
<title>layer2_attn_scores_13&#45;&gt;layer2_attn_weighted_13</title>
<path fill="none" stroke="black" d="M19205,-723.95C19205,-723.95 19205,-698.13 19205,-698.13"/>
<polygon fill="black" stroke="black" points="19208.5,-698.13 19205,-688.13 19201.5,-698.13 19208.5,-698.13"/>
</g>
<!-- layer2_attn_out_13 -->
<g id="node197" class="node">
<title>layer2_attn_out_13</title>
<polygon fill="lightblue" stroke="black" points="19544.5,-584 18917.5,-584 18917.5,-516 19544.5,-516 19544.5,-584"/>
<text text-anchor="middle" x="19231" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 13</text>
<text text-anchor="middle" x="19231" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="19231" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
<text text-anchor="middle" x="19231" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_13&#45;&gt;layer2_attn_out_13 -->
<g id="edge237" class="edge">
<title>layer2_attn_weighted_13&#45;&gt;layer2_attn_out_13</title>
<path fill="none" stroke="black" d="M19231,-619.95C19231,-619.95 19231,-594.13 19231,-594.13"/>
<polygon fill="black" stroke="black" points="19234.5,-594.13 19231,-584.13 19227.5,-594.13 19234.5,-594.13"/>
</g>
<!-- layer2_attn_out_13&#45;&gt;layer2_attn_aggregate -->
<g id="edge238" class="edge">
<title>layer2_attn_out_13&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M19458.38,-515.89C19458.38,-515.89 19458.38,-422.05 19458.38,-422.05"/>
<polygon fill="black" stroke="black" points="19461.88,-422.05 19458.38,-412.05 19454.88,-422.05 19461.88,-422.05"/>
</g>
<!-- layer2_attn_scores_14 -->
<g id="node199" class="node">
<title>layer2_attn_scores_14</title>
<polygon fill="lightblue" stroke="black" points="20307,-792 19777,-792 19777,-724 20307,-724 20307,-792"/>
<text text-anchor="middle" x="20042" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 14</text>
<text text-anchor="middle" x="20042" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="20042" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
<text text-anchor="middle" x="20042" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_14&#45;&gt;layer2_attn_scores_14 -->
<g id="edge240" class="edge">
<title>layer2_attn_qkv_14&#45;&gt;layer2_attn_scores_14</title>
<path fill="none" stroke="black" d="M20042,-894.81C20042,-894.81 20042,-802.13 20042,-802.13"/>
<polygon fill="black" stroke="black" points="20045.5,-802.13 20042,-792.13 20038.5,-802.13 20045.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_14 -->
<g id="node200" class="node">
<title>layer2_attn_weighted_14</title>
<polygon fill="lightblue" stroke="black" points="20454,-688 19630,-688 19630,-620 20454,-620 20454,-688"/>
<text text-anchor="middle" x="20042" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 14</text>
<text text-anchor="middle" x="20042" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="20042" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="20042" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_14&#45;&gt;layer2_attn_weighted_14 -->
<g id="edge241" class="edge">
<title>layer2_attn_scores_14&#45;&gt;layer2_attn_weighted_14</title>
<path fill="none" stroke="black" d="M20042,-723.95C20042,-723.95 20042,-698.13 20042,-698.13"/>
<polygon fill="black" stroke="black" points="20045.5,-698.13 20042,-688.13 20038.5,-698.13 20045.5,-698.13"/>
</g>
<!-- layer2_attn_out_14 -->
<g id="node201" class="node">
<title>layer2_attn_out_14</title>
<polygon fill="lightblue" stroke="black" points="20355.5,-584 19728.5,-584 19728.5,-516 20355.5,-516 20355.5,-584"/>
<text text-anchor="middle" x="20042" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 14</text>
<text text-anchor="middle" x="20042" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="20042" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
<text text-anchor="middle" x="20042" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_14&#45;&gt;layer2_attn_out_14 -->
<g id="edge242" class="edge">
<title>layer2_attn_weighted_14&#45;&gt;layer2_attn_out_14</title>
<path fill="none" stroke="black" d="M20042,-619.95C20042,-619.95 20042,-594.13 20042,-594.13"/>
<polygon fill="black" stroke="black" points="20045.5,-594.13 20042,-584.13 20038.5,-594.13 20045.5,-594.13"/>
</g>
<!-- layer2_attn_out_14&#45;&gt;layer2_attn_aggregate -->
<g id="edge243" class="edge">
<title>layer2_attn_out_14&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M20042,-515.89C20042,-515.89 20042,-490.23 20042,-490.23"/>
<polygon fill="black" stroke="black" points="20045.5,-490.23 20042,-480.23 20038.5,-490.23 20045.5,-490.23"/>
</g>
<!-- layer2_attn_scores_15 -->
<g id="node203" class="node">
<title>layer2_attn_scores_15</title>
<polygon fill="lightblue" stroke="black" points="21144,-792 20614,-792 20614,-724 21144,-724 21144,-792"/>
<text text-anchor="middle" x="20879" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Scores Block 15</text>
<text text-anchor="middle" x="20879" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="20879" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
<text text-anchor="middle" x="20879" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_qkv_15&#45;&gt;layer2_attn_scores_15 -->
<g id="edge245" class="edge">
<title>layer2_attn_qkv_15&#45;&gt;layer2_attn_scores_15</title>
<path fill="none" stroke="black" d="M20879,-894.81C20879,-894.81 20879,-802.13 20879,-802.13"/>
<polygon fill="black" stroke="black" points="20882.5,-802.13 20879,-792.13 20875.5,-802.13 20882.5,-802.13"/>
</g>
<!-- layer2_attn_weighted_15 -->
<g id="node204" class="node">
<title>layer2_attn_weighted_15</title>
<polygon fill="lightblue" stroke="black" points="21314,-688 20490,-688 20490,-620 21314,-620 21314,-688"/>
<text text-anchor="middle" x="20902" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 2 Weighted Sum Block 15</text>
<text text-anchor="middle" x="20902" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="20902" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="20902" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
</g>
<!-- layer2_attn_scores_15&#45;&gt;layer2_attn_weighted_15 -->
<g id="edge246" class="edge">
<title>layer2_attn_scores_15&#45;&gt;layer2_attn_weighted_15</title>
<path fill="none" stroke="black" d="M20879,-723.95C20879,-723.95 20879,-698.13 20879,-698.13"/>
<polygon fill="black" stroke="black" points="20882.5,-698.13 20879,-688.13 20875.5,-698.13 20882.5,-698.13"/>
</g>
<!-- layer2_attn_out_15 -->
<g id="node205" class="node">
<title>layer2_attn_out_15</title>
<polygon fill="lightblue" stroke="black" points="21165.5,-584 20538.5,-584 20538.5,-516 21165.5,-516 21165.5,-584"/>
<text text-anchor="middle" x="20852" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 2 Attention Output Block 15</text>
<text text-anchor="middle" x="20852" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="20852" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
<text text-anchor="middle" x="20852" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_weighted_15&#45;&gt;layer2_attn_out_15 -->
<g id="edge247" class="edge">
<title>layer2_attn_weighted_15&#45;&gt;layer2_attn_out_15</title>
<path fill="none" stroke="black" d="M20852,-619.95C20852,-619.95 20852,-594.13 20852,-594.13"/>
<polygon fill="black" stroke="black" points="20855.5,-594.13 20852,-584.13 20848.5,-594.13 20855.5,-594.13"/>
</g>
<!-- layer2_attn_out_15&#45;&gt;layer2_attn_aggregate -->
<g id="edge248" class="edge">
<title>layer2_attn_out_15&#45;&gt;layer2_attn_aggregate</title>
<path fill="none" stroke="black" d="M20625.12,-515.89C20625.12,-515.89 20625.12,-490.23 20625.12,-490.23"/>
<polygon fill="black" stroke="black" points="20628.62,-490.23 20625.12,-480.23 20621.62,-490.23 20628.62,-490.23"/>
</g>
<!-- recv_from_pool_2 -->
<g id="node207" class="node">
<title>recv_from_pool_2</title>
<polygon fill="yellow" stroke="black" points="17379.69,-308 16489.35,-308 16260.31,-172 17150.65,-172 17379.69,-308"/>
<text text-anchor="middle" x="16820" y="-258.8" font-family="Times,serif" font-size="14.00">Receive Layer 2 from Pool</text>
<text text-anchor="middle" x="16820" y="-243.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;23] → [0&#45;7]</text>
<text text-anchor="middle" x="16820" y="-228.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="16820" y="-213.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer2_attn_aggregate&#45;&gt;recv_from_pool_2 -->
<g id="edge249" class="edge">
<title>layer2_attn_aggregate&#45;&gt;recv_from_pool_2</title>
<path fill="none" stroke="black" d="M19406.01,-361C18592.82,-361 17288.67,-361 17288.67,-361 17288.67,-361 17288.67,-318.28 17288.67,-318.28"/>
<polygon fill="black" stroke="black" points="17292.17,-318.28 17288.67,-308.28 17285.17,-318.28 17292.17,-318.28"/>
</g>
<!-- recv_from_pool_2&#45;&gt;layer3_ffn_start -->
<g id="edge250" class="edge">
<title>recv_from_pool_2&#45;&gt;layer3_ffn_start</title>
<path fill="none" stroke="black" d="M16436.82,-277C15586.65,-277 13617,-277 13617,-277 13617,-277 13617,-1194.76 13617,-1194.76"/>
<polygon fill="black" stroke="black" points="13613.5,-1194.76 13617,-1204.76 13620.5,-1194.76 13613.5,-1194.76"/>
</g>
<!-- layer3_attn_qkv_0 -->
<g id="node209" class="node">
<title>layer3_attn_qkv_0</title>
<polygon fill="lightblue" stroke="black" points="35556,-963 34960,-963 34960,-895 35556,-895 35556,-963"/>
<text text-anchor="middle" x="35258" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 0</text>
<text text-anchor="middle" x="35258" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="35258" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="35258" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_0 -->
<g id="edge252" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_0</title>
<path fill="none" stroke="black" d="M33965.48,-1050C34451.45,-1050 35258,-1050 35258,-1050 35258,-1050 35258,-973.03 35258,-973.03"/>
<polygon fill="black" stroke="black" points="35261.5,-973.03 35258,-963.03 35254.5,-973.03 35261.5,-973.03"/>
</g>
<!-- layer3_attn_qkv_1 -->
<g id="node213" class="node">
<title>layer3_attn_qkv_1</title>
<polygon fill="lightblue" stroke="black" points="36398.5,-963 35775.5,-963 35775.5,-895 36398.5,-895 36398.5,-963"/>
<text text-anchor="middle" x="36087" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 1</text>
<text text-anchor="middle" x="36087" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="36087" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="36087" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_1 -->
<g id="edge257" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_1</title>
<path fill="none" stroke="black" d="M33994,-1067C34691.89,-1067 36087,-1067 36087,-1067 36087,-1067 36087,-973.11 36087,-973.11"/>
<polygon fill="black" stroke="black" points="36090.5,-973.11 36087,-963.11 36083.5,-973.11 36090.5,-973.11"/>
</g>
<!-- layer3_attn_qkv_2 -->
<g id="node217" class="node">
<title>layer3_attn_qkv_2</title>
<polygon fill="lightblue" stroke="black" points="37240.5,-963 36617.5,-963 36617.5,-895 37240.5,-895 37240.5,-963"/>
<text text-anchor="middle" x="36929" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 2</text>
<text text-anchor="middle" x="36929" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="36929" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="36929" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_2 -->
<g id="edge262" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_2</title>
<path fill="none" stroke="black" d="M34022.66,-1084C34914.72,-1084 36929,-1084 36929,-1084 36929,-1084 36929,-973.02 36929,-973.02"/>
<polygon fill="black" stroke="black" points="36932.5,-973.02 36929,-963.02 36925.5,-973.02 36932.5,-973.02"/>
</g>
<!-- layer3_attn_qkv_3 -->
<g id="node221" class="node">
<title>layer3_attn_qkv_3</title>
<polygon fill="lightblue" stroke="black" points="38082.5,-963 37459.5,-963 37459.5,-895 38082.5,-895 38082.5,-963"/>
<text text-anchor="middle" x="37771" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 3</text>
<text text-anchor="middle" x="37771" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="37771" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="37771" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_3 -->
<g id="edge267" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_3</title>
<path fill="none" stroke="black" d="M34051.23,-1101C35125.37,-1101 37771,-1101 37771,-1101 37771,-1101 37771,-973.39 37771,-973.39"/>
<polygon fill="black" stroke="black" points="37774.5,-973.39 37771,-963.39 37767.5,-973.39 37774.5,-973.39"/>
</g>
<!-- layer3_attn_qkv_4 -->
<g id="node225" class="node">
<title>layer3_attn_qkv_4</title>
<polygon fill="lightblue" stroke="black" points="38924.5,-963 38301.5,-963 38301.5,-895 38924.5,-895 38924.5,-963"/>
<text text-anchor="middle" x="38613" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 4</text>
<text text-anchor="middle" x="38613" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="38613" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="38613" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_4 -->
<g id="edge272" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_4</title>
<path fill="none" stroke="black" d="M34079.87,-1118C35328.42,-1118 38613,-1118 38613,-1118 38613,-1118 38613,-973.23 38613,-973.23"/>
<polygon fill="black" stroke="black" points="38616.5,-973.23 38613,-963.23 38609.5,-973.23 38616.5,-973.23"/>
</g>
<!-- layer3_attn_qkv_5 -->
<g id="node229" class="node">
<title>layer3_attn_qkv_5</title>
<polygon fill="lightblue" stroke="black" points="39766.5,-963 39143.5,-963 39143.5,-895 39766.5,-895 39766.5,-963"/>
<text text-anchor="middle" x="39455" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 5</text>
<text text-anchor="middle" x="39455" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="39455" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="39455" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_5 -->
<g id="edge277" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_5</title>
<path fill="none" stroke="black" d="M34108.48,-1135C35526.16,-1135 39455,-1135 39455,-1135 39455,-1135 39455,-973.02 39455,-973.02"/>
<polygon fill="black" stroke="black" points="39458.5,-973.02 39455,-963.02 39451.5,-973.02 39458.5,-973.02"/>
</g>
<!-- layer3_attn_qkv_6 -->
<g id="node233" class="node">
<title>layer3_attn_qkv_6</title>
<polygon fill="lightblue" stroke="black" points="40608.5,-963 39985.5,-963 39985.5,-895 40608.5,-895 40608.5,-963"/>
<text text-anchor="middle" x="40297" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 6</text>
<text text-anchor="middle" x="40297" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="40297" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="40297" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_6 -->
<g id="edge282" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_6</title>
<path fill="none" stroke="black" d="M34137.33,-1152C35720.54,-1152 40297,-1152 40297,-1152 40297,-1152 40297,-973.36 40297,-973.36"/>
<polygon fill="black" stroke="black" points="40300.5,-973.36 40297,-963.36 40293.5,-973.36 40300.5,-973.36"/>
</g>
<!-- layer3_attn_qkv_7 -->
<g id="node237" class="node">
<title>layer3_attn_qkv_7</title>
<polygon fill="lightblue" stroke="black" points="27978.5,-963 27355.5,-963 27355.5,-895 27978.5,-895 27978.5,-963"/>
<text text-anchor="middle" x="27667" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 7</text>
<text text-anchor="middle" x="27667" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="27667" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="27667" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_7 -->
<g id="edge287" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_7</title>
<path fill="none" stroke="black" d="M33241.48,-1149C31949.67,-1149 27667,-1149 27667,-1149 27667,-1149 27667,-973.38 27667,-973.38"/>
<polygon fill="black" stroke="black" points="27670.5,-973.37 27667,-963.38 27663.5,-973.38 27670.5,-973.37"/>
</g>
<!-- layer3_attn_qkv_8 -->
<g id="node241" class="node">
<title>layer3_attn_qkv_8</title>
<polygon fill="lightblue" stroke="black" points="28843.5,-963 28220.5,-963 28220.5,-895 28843.5,-895 28843.5,-963"/>
<text text-anchor="middle" x="28532" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 8</text>
<text text-anchor="middle" x="28532" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="28532" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="28532" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_8 -->
<g id="edge292" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_8</title>
<path fill="none" stroke="black" d="M33209.44,-1130C32014.78,-1130 28532,-1130 28532,-1130 28532,-1130 28532,-973.1 28532,-973.1"/>
<polygon fill="black" stroke="black" points="28535.5,-973.1 28532,-963.1 28528.5,-973.1 28535.5,-973.1"/>
</g>
<!-- layer3_attn_qkv_9 -->
<g id="node245" class="node">
<title>layer3_attn_qkv_9</title>
<polygon fill="lightblue" stroke="black" points="29672,-963 29040,-963 29040,-895 29672,-895 29672,-963"/>
<text text-anchor="middle" x="29356" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 9</text>
<text text-anchor="middle" x="29356" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="29356" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="29356" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_9 -->
<g id="edge297" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_9</title>
<path fill="none" stroke="black" d="M33175.59,-1110C32095.46,-1110 29356,-1110 29356,-1110 29356,-1110 29356,-973.04 29356,-973.04"/>
<polygon fill="black" stroke="black" points="29359.5,-973.04 29356,-963.04 29352.5,-973.04 29359.5,-973.04"/>
</g>
<!-- layer3_attn_qkv_10 -->
<g id="node249" class="node">
<title>layer3_attn_qkv_10</title>
<polygon fill="lightblue" stroke="black" points="30555.5,-963 29914.5,-963 29914.5,-895 30555.5,-895 30555.5,-963"/>
<text text-anchor="middle" x="30235" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 10</text>
<text text-anchor="middle" x="30235" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="30235" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="30235" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_10 -->
<g id="edge302" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_10</title>
<path fill="none" stroke="black" d="M33143.9,-1091C32220.48,-1091 30235,-1091 30235,-1091 30235,-1091 30235,-973.36 30235,-973.36"/>
<polygon fill="black" stroke="black" points="30238.5,-973.36 30235,-963.36 30231.5,-973.36 30238.5,-973.36"/>
</g>
<!-- layer3_attn_qkv_11 -->
<g id="node253" class="node">
<title>layer3_attn_qkv_11</title>
<polygon fill="lightblue" stroke="black" points="31392.5,-963 30751.5,-963 30751.5,-895 31392.5,-895 31392.5,-963"/>
<text text-anchor="middle" x="31072" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 11</text>
<text text-anchor="middle" x="31072" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="31072" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="31072" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_11 -->
<g id="edge307" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_11</title>
<path fill="none" stroke="black" d="M33110.27,-1071C32372.63,-1071 31072,-1071 31072,-1071 31072,-1071 31072,-973.01 31072,-973.01"/>
<polygon fill="black" stroke="black" points="31075.5,-973.01 31072,-963.01 31068.5,-973.01 31075.5,-973.01"/>
</g>
<!-- layer3_attn_qkv_12 -->
<g id="node257" class="node">
<title>layer3_attn_qkv_12</title>
<polygon fill="lightblue" stroke="black" points="32252.5,-963 31611.5,-963 31611.5,-895 32252.5,-895 32252.5,-963"/>
<text text-anchor="middle" x="31932" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 12</text>
<text text-anchor="middle" x="31932" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="31932" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="31932" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_12 -->
<g id="edge312" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_12</title>
<path fill="none" stroke="black" d="M33078.06,-1052C32587.44,-1052 31932,-1052 31932,-1052 31932,-1052 31932,-973.26 31932,-973.26"/>
<polygon fill="black" stroke="black" points="31935.5,-973.26 31932,-963.26 31928.5,-973.26 31935.5,-973.26"/>
</g>
<!-- layer3_attn_qkv_13 -->
<g id="node261" class="node">
<title>layer3_attn_qkv_13</title>
<polygon fill="lightblue" stroke="black" points="33112.5,-963 32471.5,-963 32471.5,-895 33112.5,-895 33112.5,-963"/>
<text text-anchor="middle" x="32792" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 13</text>
<text text-anchor="middle" x="32792" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="32792" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="32792" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_13 -->
<g id="edge317" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_13</title>
<path fill="none" stroke="black" d="M33090.38,-1100.88C33090.38,-1100.88 33090.38,-973.26 33090.38,-973.26"/>
<polygon fill="black" stroke="black" points="33093.88,-973.26 33090.38,-963.26 33086.88,-973.26 33093.88,-973.26"/>
</g>
<!-- layer3_attn_qkv_14 -->
<g id="node265" class="node">
<title>layer3_attn_qkv_14</title>
<polygon fill="lightblue" stroke="black" points="33926.5,-963 33285.5,-963 33285.5,-895 33926.5,-895 33926.5,-963"/>
<text text-anchor="middle" x="33606" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 14</text>
<text text-anchor="middle" x="33606" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="33606" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="33606" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_14 -->
<g id="edge322" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_14</title>
<path fill="none" stroke="black" d="M33606,-1032.53C33606,-1032.53 33606,-973.24 33606,-973.24"/>
<polygon fill="black" stroke="black" points="33609.5,-973.24 33606,-963.24 33602.5,-973.24 33609.5,-973.24"/>
</g>
<!-- layer3_attn_qkv_15 -->
<g id="node269" class="node">
<title>layer3_attn_qkv_15</title>
<polygon fill="lightblue" stroke="black" points="34740.5,-963 34099.5,-963 34099.5,-895 34740.5,-895 34740.5,-963"/>
<text text-anchor="middle" x="34420" y="-947.8" font-family="Times,serif" font-size="14.00">Layer 3 QKV Block 15</text>
<text text-anchor="middle" x="34420" y="-932.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="34420" y="-917.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="34420" y="-902.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128, partition=512]</text>
</g>
<!-- send_to_pool_3&#45;&gt;layer3_attn_qkv_15 -->
<g id="edge327" class="edge">
<title>send_to_pool_3&#45;&gt;layer3_attn_qkv_15</title>
<path fill="none" stroke="black" d="M34132.67,-1100.88C34132.67,-1100.88 34132.67,-973.26 34132.67,-973.26"/>
<polygon fill="black" stroke="black" points="34136.17,-973.26 34132.67,-963.26 34129.17,-973.26 34136.17,-973.26"/>
</g>
<!-- layer3_attn_scores_0 -->
<g id="node210" class="node">
<title>layer3_attn_scores_0</title>
<polygon fill="lightblue" stroke="black" points="35523.5,-792 35038.5,-792 35038.5,-724 35523.5,-724 35523.5,-792"/>
<text text-anchor="middle" x="35281" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 0</text>
<text text-anchor="middle" x="35281" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="35281" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="35281" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_0&#45;&gt;layer3_attn_scores_0 -->
<g id="edge253" class="edge">
<title>layer3_attn_qkv_0&#45;&gt;layer3_attn_scores_0</title>
<path fill="none" stroke="black" d="M35281,-894.81C35281,-894.81 35281,-802.13 35281,-802.13"/>
<polygon fill="black" stroke="black" points="35284.5,-802.13 35281,-792.13 35277.5,-802.13 35284.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_0 -->
<g id="node211" class="node">
<title>layer3_attn_weighted_0</title>
<polygon fill="lightblue" stroke="black" points="35693.5,-688 34914.5,-688 34914.5,-620 35693.5,-620 35693.5,-688"/>
<text text-anchor="middle" x="35304" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 0</text>
<text text-anchor="middle" x="35304" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="35304" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="35304" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_0&#45;&gt;layer3_attn_weighted_0 -->
<g id="edge254" class="edge">
<title>layer3_attn_scores_0&#45;&gt;layer3_attn_weighted_0</title>
<path fill="none" stroke="black" d="M35281,-723.95C35281,-723.95 35281,-698.13 35281,-698.13"/>
<polygon fill="black" stroke="black" points="35284.5,-698.13 35281,-688.13 35277.5,-698.13 35284.5,-698.13"/>
</g>
<!-- layer3_attn_out_0 -->
<g id="node212" class="node">
<title>layer3_attn_out_0</title>
<polygon fill="lightblue" stroke="black" points="35545,-584 34963,-584 34963,-516 35545,-516 35545,-584"/>
<text text-anchor="middle" x="35254" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 0</text>
<text text-anchor="middle" x="35254" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="35254" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=0&#45;1024, heads=32, d_k=128]</text>
<text text-anchor="middle" x="35254" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=0&#45;1024, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_0&#45;&gt;layer3_attn_out_0 -->
<g id="edge255" class="edge">
<title>layer3_attn_weighted_0&#45;&gt;layer3_attn_out_0</title>
<path fill="none" stroke="black" d="M35254,-619.95C35254,-619.95 35254,-594.13 35254,-594.13"/>
<polygon fill="black" stroke="black" points="35257.5,-594.13 35254,-584.13 35250.5,-594.13 35257.5,-594.13"/>
</g>
<!-- layer3_attn_aggregate -->
<g id="node273" class="node">
<title>layer3_attn_aggregate</title>
<polygon fill="orange" stroke="black" points="35135.99,-480 34070.19,-480 33796.01,-344 34861.81,-344 35135.99,-480"/>
<text text-anchor="middle" x="34466" y="-430.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Aggregation</text>
<text text-anchor="middle" x="34466" y="-415.8" font-family="Times,serif" font-size="14.00">GPU: All Pool GPUs</text>
<text text-anchor="middle" x="34466" y="-400.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512] from each block</text>
<text text-anchor="middle" x="34466" y="-385.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_out_0&#45;&gt;layer3_attn_aggregate -->
<g id="edge256" class="edge">
<title>layer3_attn_out_0&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M35049.37,-515.89C35049.37,-515.89 35049.37,-490.23 35049.37,-490.23"/>
<polygon fill="black" stroke="black" points="35052.87,-490.23 35049.37,-480.23 35045.87,-490.23 35052.87,-490.23"/>
</g>
<!-- layer3_attn_scores_1 -->
<g id="node214" class="node">
<title>layer3_attn_scores_1</title>
<polygon fill="lightblue" stroke="black" points="36366,-792 35854,-792 35854,-724 36366,-724 36366,-792"/>
<text text-anchor="middle" x="36110" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 1</text>
<text text-anchor="middle" x="36110" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="36110" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="36110" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_1&#45;&gt;layer3_attn_scores_1 -->
<g id="edge258" class="edge">
<title>layer3_attn_qkv_1&#45;&gt;layer3_attn_scores_1</title>
<path fill="none" stroke="black" d="M36110,-894.81C36110,-894.81 36110,-802.13 36110,-802.13"/>
<polygon fill="black" stroke="black" points="36113.5,-802.13 36110,-792.13 36106.5,-802.13 36113.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_1 -->
<g id="node215" class="node">
<title>layer3_attn_weighted_1</title>
<polygon fill="lightblue" stroke="black" points="36536,-688 35730,-688 35730,-620 36536,-620 36536,-688"/>
<text text-anchor="middle" x="36133" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 1</text>
<text text-anchor="middle" x="36133" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="36133" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="36133" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_1&#45;&gt;layer3_attn_weighted_1 -->
<g id="edge259" class="edge">
<title>layer3_attn_scores_1&#45;&gt;layer3_attn_weighted_1</title>
<path fill="none" stroke="black" d="M36110,-723.95C36110,-723.95 36110,-698.13 36110,-698.13"/>
<polygon fill="black" stroke="black" points="36113.5,-698.13 36110,-688.13 36106.5,-698.13 36113.5,-698.13"/>
</g>
<!-- layer3_attn_out_1 -->
<g id="node216" class="node">
<title>layer3_attn_out_1</title>
<polygon fill="lightblue" stroke="black" points="36387.5,-584 35778.5,-584 35778.5,-516 36387.5,-516 36387.5,-584"/>
<text text-anchor="middle" x="36083" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 1</text>
<text text-anchor="middle" x="36083" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="36083" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=1024&#45;2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="36083" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=1024&#45;2048, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_1&#45;&gt;layer3_attn_out_1 -->
<g id="edge260" class="edge">
<title>layer3_attn_weighted_1&#45;&gt;layer3_attn_out_1</title>
<path fill="none" stroke="black" d="M36083,-619.95C36083,-619.95 36083,-594.13 36083,-594.13"/>
<polygon fill="black" stroke="black" points="36086.5,-594.13 36083,-584.13 36079.5,-594.13 36086.5,-594.13"/>
</g>
<!-- layer3_attn_out_1&#45;&gt;layer3_attn_aggregate -->
<g id="edge261" class="edge">
<title>layer3_attn_out_1&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M36083,-515.62C36083,-491.3 36083,-463 36083,-463 36083,-463 35111.89,-463 35111.89,-463"/>
<polygon fill="black" stroke="black" points="35111.89,-459.5 35101.89,-463 35111.89,-466.5 35111.89,-459.5"/>
</g>
<!-- layer3_attn_scores_2 -->
<g id="node218" class="node">
<title>layer3_attn_scores_2</title>
<polygon fill="lightblue" stroke="black" points="37208,-792 36696,-792 36696,-724 37208,-724 37208,-792"/>
<text text-anchor="middle" x="36952" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 2</text>
<text text-anchor="middle" x="36952" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="36952" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="36952" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_2&#45;&gt;layer3_attn_scores_2 -->
<g id="edge263" class="edge">
<title>layer3_attn_qkv_2&#45;&gt;layer3_attn_scores_2</title>
<path fill="none" stroke="black" d="M36952,-894.81C36952,-894.81 36952,-802.13 36952,-802.13"/>
<polygon fill="black" stroke="black" points="36955.5,-802.13 36952,-792.13 36948.5,-802.13 36955.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_2 -->
<g id="node219" class="node">
<title>layer3_attn_weighted_2</title>
<polygon fill="lightblue" stroke="black" points="37378,-688 36572,-688 36572,-620 37378,-620 37378,-688"/>
<text text-anchor="middle" x="36975" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 2</text>
<text text-anchor="middle" x="36975" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="36975" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="36975" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_2&#45;&gt;layer3_attn_weighted_2 -->
<g id="edge264" class="edge">
<title>layer3_attn_scores_2&#45;&gt;layer3_attn_weighted_2</title>
<path fill="none" stroke="black" d="M36952,-723.95C36952,-723.95 36952,-698.13 36952,-698.13"/>
<polygon fill="black" stroke="black" points="36955.5,-698.13 36952,-688.13 36948.5,-698.13 36955.5,-698.13"/>
</g>
<!-- layer3_attn_out_2 -->
<g id="node220" class="node">
<title>layer3_attn_out_2</title>
<polygon fill="lightblue" stroke="black" points="37229.5,-584 36620.5,-584 36620.5,-516 37229.5,-516 37229.5,-584"/>
<text text-anchor="middle" x="36925" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 2</text>
<text text-anchor="middle" x="36925" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="36925" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=2048&#45;3072, heads=32, d_k=128]</text>
<text text-anchor="middle" x="36925" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=2048&#45;3072, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_2&#45;&gt;layer3_attn_out_2 -->
<g id="edge265" class="edge">
<title>layer3_attn_weighted_2&#45;&gt;layer3_attn_out_2</title>
<path fill="none" stroke="black" d="M36925,-619.95C36925,-619.95 36925,-594.13 36925,-594.13"/>
<polygon fill="black" stroke="black" points="36928.5,-594.13 36925,-584.13 36921.5,-594.13 36928.5,-594.13"/>
</g>
<!-- layer3_attn_out_2&#45;&gt;layer3_attn_aggregate -->
<g id="edge266" class="edge">
<title>layer3_attn_out_2&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M36711.83,-515.95C36711.83,-485.62 36711.83,-446 36711.83,-446 36711.83,-446 35077.47,-446 35077.47,-446"/>
<polygon fill="black" stroke="black" points="35077.47,-442.5 35067.47,-446 35077.47,-449.5 35077.47,-442.5"/>
</g>
<!-- layer3_attn_scores_3 -->
<g id="node222" class="node">
<title>layer3_attn_scores_3</title>
<polygon fill="lightblue" stroke="black" points="38050,-792 37538,-792 37538,-724 38050,-724 38050,-792"/>
<text text-anchor="middle" x="37794" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 3</text>
<text text-anchor="middle" x="37794" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="37794" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="37794" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_3&#45;&gt;layer3_attn_scores_3 -->
<g id="edge268" class="edge">
<title>layer3_attn_qkv_3&#45;&gt;layer3_attn_scores_3</title>
<path fill="none" stroke="black" d="M37794,-894.81C37794,-894.81 37794,-802.13 37794,-802.13"/>
<polygon fill="black" stroke="black" points="37797.5,-802.13 37794,-792.13 37790.5,-802.13 37797.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_3 -->
<g id="node223" class="node">
<title>layer3_attn_weighted_3</title>
<polygon fill="lightblue" stroke="black" points="38220,-688 37414,-688 37414,-620 38220,-620 38220,-688"/>
<text text-anchor="middle" x="37817" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 3</text>
<text text-anchor="middle" x="37817" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="37817" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="37817" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_3&#45;&gt;layer3_attn_weighted_3 -->
<g id="edge269" class="edge">
<title>layer3_attn_scores_3&#45;&gt;layer3_attn_weighted_3</title>
<path fill="none" stroke="black" d="M37794,-723.95C37794,-723.95 37794,-698.13 37794,-698.13"/>
<polygon fill="black" stroke="black" points="37797.5,-698.13 37794,-688.13 37790.5,-698.13 37797.5,-698.13"/>
</g>
<!-- layer3_attn_out_3 -->
<g id="node224" class="node">
<title>layer3_attn_out_3</title>
<polygon fill="lightblue" stroke="black" points="38071.5,-584 37462.5,-584 37462.5,-516 38071.5,-516 38071.5,-584"/>
<text text-anchor="middle" x="37767" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 3</text>
<text text-anchor="middle" x="37767" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="37767" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=3072&#45;4096, heads=32, d_k=128]</text>
<text text-anchor="middle" x="37767" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=3072&#45;4096, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_3&#45;&gt;layer3_attn_out_3 -->
<g id="edge270" class="edge">
<title>layer3_attn_weighted_3&#45;&gt;layer3_attn_out_3</title>
<path fill="none" stroke="black" d="M37767,-619.95C37767,-619.95 37767,-594.13 37767,-594.13"/>
<polygon fill="black" stroke="black" points="37770.5,-594.13 37767,-584.13 37763.5,-594.13 37770.5,-594.13"/>
</g>
<!-- layer3_attn_out_3&#45;&gt;layer3_attn_aggregate -->
<g id="edge271" class="edge">
<title>layer3_attn_out_3&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M37692.67,-515.97C37692.67,-480.18 37692.67,-429 37692.67,-429 37692.67,-429 35043.59,-429 35043.59,-429"/>
<polygon fill="black" stroke="black" points="35043.59,-425.5 35033.59,-429 35043.59,-432.5 35043.59,-425.5"/>
</g>
<!-- layer3_attn_scores_4 -->
<g id="node226" class="node">
<title>layer3_attn_scores_4</title>
<polygon fill="lightblue" stroke="black" points="38892,-792 38380,-792 38380,-724 38892,-724 38892,-792"/>
<text text-anchor="middle" x="38636" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 4</text>
<text text-anchor="middle" x="38636" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="38636" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="38636" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_4&#45;&gt;layer3_attn_scores_4 -->
<g id="edge273" class="edge">
<title>layer3_attn_qkv_4&#45;&gt;layer3_attn_scores_4</title>
<path fill="none" stroke="black" d="M38636,-894.81C38636,-894.81 38636,-802.13 38636,-802.13"/>
<polygon fill="black" stroke="black" points="38639.5,-802.13 38636,-792.13 38632.5,-802.13 38639.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_4 -->
<g id="node227" class="node">
<title>layer3_attn_weighted_4</title>
<polygon fill="lightblue" stroke="black" points="39062,-688 38256,-688 38256,-620 39062,-620 39062,-688"/>
<text text-anchor="middle" x="38659" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 4</text>
<text text-anchor="middle" x="38659" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="38659" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="38659" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_4&#45;&gt;layer3_attn_weighted_4 -->
<g id="edge274" class="edge">
<title>layer3_attn_scores_4&#45;&gt;layer3_attn_weighted_4</title>
<path fill="none" stroke="black" d="M38636,-723.95C38636,-723.95 38636,-698.13 38636,-698.13"/>
<polygon fill="black" stroke="black" points="38639.5,-698.13 38636,-688.13 38632.5,-698.13 38639.5,-698.13"/>
</g>
<!-- layer3_attn_out_4 -->
<g id="node228" class="node">
<title>layer3_attn_out_4</title>
<polygon fill="lightblue" stroke="black" points="38913.5,-584 38304.5,-584 38304.5,-516 38913.5,-516 38913.5,-584"/>
<text text-anchor="middle" x="38609" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 4</text>
<text text-anchor="middle" x="38609" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="38609" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=4096&#45;5120, heads=32, d_k=128]</text>
<text text-anchor="middle" x="38609" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=4096&#45;5120, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_4&#45;&gt;layer3_attn_out_4 -->
<g id="edge275" class="edge">
<title>layer3_attn_weighted_4&#45;&gt;layer3_attn_out_4</title>
<path fill="none" stroke="black" d="M38609,-619.95C38609,-619.95 38609,-594.13 38609,-594.13"/>
<polygon fill="black" stroke="black" points="38612.5,-594.13 38609,-584.13 38605.5,-594.13 38612.5,-594.13"/>
</g>
<!-- layer3_attn_out_4&#45;&gt;layer3_attn_aggregate -->
<g id="edge276" class="edge">
<title>layer3_attn_out_4&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M38609,-515.89C38609,-475.02 38609,-412 38609,-412 38609,-412 35009.14,-412 35009.14,-412"/>
<polygon fill="black" stroke="black" points="35009.14,-408.5 34999.14,-412 35009.14,-415.5 35009.14,-408.5"/>
</g>
<!-- layer3_attn_scores_5 -->
<g id="node230" class="node">
<title>layer3_attn_scores_5</title>
<polygon fill="lightblue" stroke="black" points="39734,-792 39222,-792 39222,-724 39734,-724 39734,-792"/>
<text text-anchor="middle" x="39478" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 5</text>
<text text-anchor="middle" x="39478" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="39478" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="39478" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_5&#45;&gt;layer3_attn_scores_5 -->
<g id="edge278" class="edge">
<title>layer3_attn_qkv_5&#45;&gt;layer3_attn_scores_5</title>
<path fill="none" stroke="black" d="M39478,-894.81C39478,-894.81 39478,-802.13 39478,-802.13"/>
<polygon fill="black" stroke="black" points="39481.5,-802.13 39478,-792.13 39474.5,-802.13 39481.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_5 -->
<g id="node231" class="node">
<title>layer3_attn_weighted_5</title>
<polygon fill="lightblue" stroke="black" points="39904,-688 39098,-688 39098,-620 39904,-620 39904,-688"/>
<text text-anchor="middle" x="39501" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 5</text>
<text text-anchor="middle" x="39501" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="39501" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="39501" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_5&#45;&gt;layer3_attn_weighted_5 -->
<g id="edge279" class="edge">
<title>layer3_attn_scores_5&#45;&gt;layer3_attn_weighted_5</title>
<path fill="none" stroke="black" d="M39478,-723.95C39478,-723.95 39478,-698.13 39478,-698.13"/>
<polygon fill="black" stroke="black" points="39481.5,-698.13 39478,-688.13 39474.5,-698.13 39481.5,-698.13"/>
</g>
<!-- layer3_attn_out_5 -->
<g id="node232" class="node">
<title>layer3_attn_out_5</title>
<polygon fill="lightblue" stroke="black" points="39755.5,-584 39146.5,-584 39146.5,-516 39755.5,-516 39755.5,-584"/>
<text text-anchor="middle" x="39451" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 5</text>
<text text-anchor="middle" x="39451" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="39451" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=5120&#45;6144, heads=32, d_k=128]</text>
<text text-anchor="middle" x="39451" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=5120&#45;6144, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_5&#45;&gt;layer3_attn_out_5 -->
<g id="edge280" class="edge">
<title>layer3_attn_weighted_5&#45;&gt;layer3_attn_out_5</title>
<path fill="none" stroke="black" d="M39451,-619.95C39451,-619.95 39451,-594.13 39451,-594.13"/>
<polygon fill="black" stroke="black" points="39454.5,-594.13 39451,-584.13 39447.5,-594.13 39454.5,-594.13"/>
</g>
<!-- layer3_attn_out_5&#45;&gt;layer3_attn_aggregate -->
<g id="edge281" class="edge">
<title>layer3_attn_out_5&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M39451,-515.98C39451,-470.36 39451,-395 39451,-395 39451,-395 34974.79,-395 34974.79,-395"/>
<polygon fill="black" stroke="black" points="34974.79,-391.5 34964.79,-395 34974.79,-398.5 34974.79,-391.5"/>
</g>
<!-- layer3_attn_scores_6 -->
<g id="node234" class="node">
<title>layer3_attn_scores_6</title>
<polygon fill="lightblue" stroke="black" points="40576,-792 40064,-792 40064,-724 40576,-724 40576,-792"/>
<text text-anchor="middle" x="40320" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 6</text>
<text text-anchor="middle" x="40320" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="40320" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="40320" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_6&#45;&gt;layer3_attn_scores_6 -->
<g id="edge283" class="edge">
<title>layer3_attn_qkv_6&#45;&gt;layer3_attn_scores_6</title>
<path fill="none" stroke="black" d="M40320,-894.81C40320,-894.81 40320,-802.13 40320,-802.13"/>
<polygon fill="black" stroke="black" points="40323.5,-802.13 40320,-792.13 40316.5,-802.13 40323.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_6 -->
<g id="node235" class="node">
<title>layer3_attn_weighted_6</title>
<polygon fill="lightblue" stroke="black" points="40746,-688 39940,-688 39940,-620 40746,-620 40746,-688"/>
<text text-anchor="middle" x="40343" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 6</text>
<text text-anchor="middle" x="40343" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="40343" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="40343" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_6&#45;&gt;layer3_attn_weighted_6 -->
<g id="edge284" class="edge">
<title>layer3_attn_scores_6&#45;&gt;layer3_attn_weighted_6</title>
<path fill="none" stroke="black" d="M40320,-723.95C40320,-723.95 40320,-698.13 40320,-698.13"/>
<polygon fill="black" stroke="black" points="40323.5,-698.13 40320,-688.13 40316.5,-698.13 40323.5,-698.13"/>
</g>
<!-- layer3_attn_out_6 -->
<g id="node236" class="node">
<title>layer3_attn_out_6</title>
<polygon fill="lightblue" stroke="black" points="40597.5,-584 39988.5,-584 39988.5,-516 40597.5,-516 40597.5,-584"/>
<text text-anchor="middle" x="40293" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 6</text>
<text text-anchor="middle" x="40293" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="40293" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=6144&#45;7168, heads=32, d_k=128]</text>
<text text-anchor="middle" x="40293" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=6144&#45;7168, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_6&#45;&gt;layer3_attn_out_6 -->
<g id="edge285" class="edge">
<title>layer3_attn_weighted_6&#45;&gt;layer3_attn_out_6</title>
<path fill="none" stroke="black" d="M40293,-619.95C40293,-619.95 40293,-594.13 40293,-594.13"/>
<polygon fill="black" stroke="black" points="40296.5,-594.13 40293,-584.13 40289.5,-594.13 40296.5,-594.13"/>
</g>
<!-- layer3_attn_out_6&#45;&gt;layer3_attn_aggregate -->
<g id="edge286" class="edge">
<title>layer3_attn_out_6&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M40293,-515.61C40293,-465.41 40293,-378 40293,-378 40293,-378 34940.55,-378 34940.55,-378"/>
<polygon fill="black" stroke="black" points="34940.55,-374.5 34930.55,-378 34940.55,-381.5 34940.55,-374.5"/>
</g>
<!-- layer3_attn_scores_7 -->
<g id="node238" class="node">
<title>layer3_attn_scores_7</title>
<polygon fill="lightblue" stroke="black" points="27900,-792 27388,-792 27388,-724 27900,-724 27900,-792"/>
<text text-anchor="middle" x="27644" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 7</text>
<text text-anchor="middle" x="27644" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="27644" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="27644" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_7&#45;&gt;layer3_attn_scores_7 -->
<g id="edge288" class="edge">
<title>layer3_attn_qkv_7&#45;&gt;layer3_attn_scores_7</title>
<path fill="none" stroke="black" d="M27644,-894.81C27644,-894.81 27644,-802.13 27644,-802.13"/>
<polygon fill="black" stroke="black" points="27647.5,-802.13 27644,-792.13 27640.5,-802.13 27647.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_7 -->
<g id="node239" class="node">
<title>layer3_attn_weighted_7</title>
<polygon fill="lightblue" stroke="black" points="28024,-688 27218,-688 27218,-620 28024,-620 28024,-688"/>
<text text-anchor="middle" x="27621" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 7</text>
<text text-anchor="middle" x="27621" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="27621" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="27621" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_7&#45;&gt;layer3_attn_weighted_7 -->
<g id="edge289" class="edge">
<title>layer3_attn_scores_7&#45;&gt;layer3_attn_weighted_7</title>
<path fill="none" stroke="black" d="M27644,-723.95C27644,-723.95 27644,-698.13 27644,-698.13"/>
<polygon fill="black" stroke="black" points="27647.5,-698.13 27644,-688.13 27640.5,-698.13 27647.5,-698.13"/>
</g>
<!-- layer3_attn_out_7 -->
<g id="node240" class="node">
<title>layer3_attn_out_7</title>
<polygon fill="lightblue" stroke="black" points="27974.5,-584 27365.5,-584 27365.5,-516 27974.5,-516 27974.5,-584"/>
<text text-anchor="middle" x="27670" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 7</text>
<text text-anchor="middle" x="27670" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="27670" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=7168&#45;8192, heads=32, d_k=128]</text>
<text text-anchor="middle" x="27670" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=7168&#45;8192, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_7&#45;&gt;layer3_attn_out_7 -->
<g id="edge290" class="edge">
<title>layer3_attn_weighted_7&#45;&gt;layer3_attn_out_7</title>
<path fill="none" stroke="black" d="M27670,-619.95C27670,-619.95 27670,-594.13 27670,-594.13"/>
<polygon fill="black" stroke="black" points="27673.5,-594.13 27670,-584.13 27666.5,-594.13 27673.5,-594.13"/>
</g>
<!-- layer3_attn_out_7&#45;&gt;layer3_attn_aggregate -->
<g id="edge291" class="edge">
<title>layer3_attn_out_7&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M27670,-515.84C27670,-476.14 27670,-416 27670,-416 27670,-416 33930.85,-416 33930.85,-416"/>
<polygon fill="black" stroke="black" points="33930.85,-419.5 33940.85,-416 33930.85,-412.5 33930.85,-419.5"/>
</g>
<!-- layer3_attn_scores_8 -->
<g id="node242" class="node">
<title>layer3_attn_scores_8</title>
<polygon fill="lightblue" stroke="black" points="28742,-792 28230,-792 28230,-724 28742,-724 28742,-792"/>
<text text-anchor="middle" x="28486" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 8</text>
<text text-anchor="middle" x="28486" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="28486" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
<text text-anchor="middle" x="28486" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_8&#45;&gt;layer3_attn_scores_8 -->
<g id="edge293" class="edge">
<title>layer3_attn_qkv_8&#45;&gt;layer3_attn_scores_8</title>
<path fill="none" stroke="black" d="M28486,-894.81C28486,-894.81 28486,-802.13 28486,-802.13"/>
<polygon fill="black" stroke="black" points="28489.5,-802.13 28486,-792.13 28482.5,-802.13 28489.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_8 -->
<g id="node243" class="node">
<title>layer3_attn_weighted_8</title>
<polygon fill="lightblue" stroke="black" points="28866,-688 28060,-688 28060,-620 28866,-620 28866,-688"/>
<text text-anchor="middle" x="28463" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 8</text>
<text text-anchor="middle" x="28463" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="28463" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="28463" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_8&#45;&gt;layer3_attn_weighted_8 -->
<g id="edge294" class="edge">
<title>layer3_attn_scores_8&#45;&gt;layer3_attn_weighted_8</title>
<path fill="none" stroke="black" d="M28486,-723.95C28486,-723.95 28486,-698.13 28486,-698.13"/>
<polygon fill="black" stroke="black" points="28489.5,-698.13 28486,-688.13 28482.5,-698.13 28489.5,-698.13"/>
</g>
<!-- layer3_attn_out_8 -->
<g id="node244" class="node">
<title>layer3_attn_out_8</title>
<polygon fill="lightblue" stroke="black" points="28816.5,-584 28207.5,-584 28207.5,-516 28816.5,-516 28816.5,-584"/>
<text text-anchor="middle" x="28512" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 8</text>
<text text-anchor="middle" x="28512" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 16</text>
<text text-anchor="middle" x="28512" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=8192&#45;9216, heads=32, d_k=128]</text>
<text text-anchor="middle" x="28512" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=8192&#45;9216, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_8&#45;&gt;layer3_attn_out_8 -->
<g id="edge295" class="edge">
<title>layer3_attn_weighted_8&#45;&gt;layer3_attn_out_8</title>
<path fill="none" stroke="black" d="M28512,-619.95C28512,-619.95 28512,-594.13 28512,-594.13"/>
<polygon fill="black" stroke="black" points="28515.5,-594.13 28512,-584.13 28508.5,-594.13 28515.5,-594.13"/>
</g>
<!-- layer3_attn_out_8&#45;&gt;layer3_attn_aggregate -->
<g id="edge296" class="edge">
<title>layer3_attn_out_8&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M28512,-515.84C28512,-478.83 28512,-425 28512,-425 28512,-425 33949.01,-425 33949.01,-425"/>
<polygon fill="black" stroke="black" points="33949.01,-428.5 33959.01,-425 33949.01,-421.5 33949.01,-428.5"/>
</g>
<!-- layer3_attn_scores_9 -->
<g id="node246" class="node">
<title>layer3_attn_scores_9</title>
<polygon fill="lightblue" stroke="black" points="29593.5,-792 29072.5,-792 29072.5,-724 29593.5,-724 29593.5,-792"/>
<text text-anchor="middle" x="29333" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 9</text>
<text text-anchor="middle" x="29333" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="29333" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
<text text-anchor="middle" x="29333" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_9&#45;&gt;layer3_attn_scores_9 -->
<g id="edge298" class="edge">
<title>layer3_attn_qkv_9&#45;&gt;layer3_attn_scores_9</title>
<path fill="none" stroke="black" d="M29333,-894.81C29333,-894.81 29333,-802.13 29333,-802.13"/>
<polygon fill="black" stroke="black" points="29336.5,-802.13 29333,-792.13 29329.5,-802.13 29336.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_9 -->
<g id="node247" class="node">
<title>layer3_attn_weighted_9</title>
<polygon fill="lightblue" stroke="black" points="29717.5,-688 28902.5,-688 28902.5,-620 29717.5,-620 29717.5,-688"/>
<text text-anchor="middle" x="29310" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 9</text>
<text text-anchor="middle" x="29310" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="29310" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="29310" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_9&#45;&gt;layer3_attn_weighted_9 -->
<g id="edge299" class="edge">
<title>layer3_attn_scores_9&#45;&gt;layer3_attn_weighted_9</title>
<path fill="none" stroke="black" d="M29333,-723.95C29333,-723.95 29333,-698.13 29333,-698.13"/>
<polygon fill="black" stroke="black" points="29336.5,-698.13 29333,-688.13 29329.5,-698.13 29336.5,-698.13"/>
</g>
<!-- layer3_attn_out_9 -->
<g id="node248" class="node">
<title>layer3_attn_out_9</title>
<polygon fill="lightblue" stroke="black" points="29668,-584 29050,-584 29050,-516 29668,-516 29668,-584"/>
<text text-anchor="middle" x="29359" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 9</text>
<text text-anchor="middle" x="29359" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 17</text>
<text text-anchor="middle" x="29359" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=9216&#45;10240, heads=32, d_k=128]</text>
<text text-anchor="middle" x="29359" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=9216&#45;10240, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_9&#45;&gt;layer3_attn_out_9 -->
<g id="edge300" class="edge">
<title>layer3_attn_weighted_9&#45;&gt;layer3_attn_out_9</title>
<path fill="none" stroke="black" d="M29359,-619.95C29359,-619.95 29359,-594.13 29359,-594.13"/>
<polygon fill="black" stroke="black" points="29362.5,-594.13 29359,-584.13 29355.5,-594.13 29362.5,-594.13"/>
</g>
<!-- layer3_attn_out_9&#45;&gt;layer3_attn_aggregate -->
<g id="edge301" class="edge">
<title>layer3_attn_out_9&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M29359,-515.82C29359,-481.61 29359,-434 29359,-434 29359,-434 33967.19,-434 33967.19,-434"/>
<polygon fill="black" stroke="black" points="33967.19,-437.5 33977.19,-434 33967.19,-430.5 33967.19,-437.5"/>
</g>
<!-- layer3_attn_scores_10 -->
<g id="node250" class="node">
<title>layer3_attn_scores_10</title>
<polygon fill="lightblue" stroke="black" points="30454,-792 29924,-792 29924,-724 30454,-724 30454,-792"/>
<text text-anchor="middle" x="30189" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 10</text>
<text text-anchor="middle" x="30189" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="30189" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
<text text-anchor="middle" x="30189" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_10&#45;&gt;layer3_attn_scores_10 -->
<g id="edge303" class="edge">
<title>layer3_attn_qkv_10&#45;&gt;layer3_attn_scores_10</title>
<path fill="none" stroke="black" d="M30189,-894.81C30189,-894.81 30189,-802.13 30189,-802.13"/>
<polygon fill="black" stroke="black" points="30192.5,-802.13 30189,-792.13 30185.5,-802.13 30192.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_10 -->
<g id="node251" class="node">
<title>layer3_attn_weighted_10</title>
<polygon fill="lightblue" stroke="black" points="30578,-688 29754,-688 29754,-620 30578,-620 30578,-688"/>
<text text-anchor="middle" x="30166" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 10</text>
<text text-anchor="middle" x="30166" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="30166" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="30166" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_10&#45;&gt;layer3_attn_weighted_10 -->
<g id="edge304" class="edge">
<title>layer3_attn_scores_10&#45;&gt;layer3_attn_weighted_10</title>
<path fill="none" stroke="black" d="M30189,-723.95C30189,-723.95 30189,-698.13 30189,-698.13"/>
<polygon fill="black" stroke="black" points="30192.5,-698.13 30189,-688.13 30185.5,-698.13 30192.5,-698.13"/>
</g>
<!-- layer3_attn_out_10 -->
<g id="node252" class="node">
<title>layer3_attn_out_10</title>
<polygon fill="lightblue" stroke="black" points="30528.5,-584 29901.5,-584 29901.5,-516 30528.5,-516 30528.5,-584"/>
<text text-anchor="middle" x="30215" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 10</text>
<text text-anchor="middle" x="30215" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 18</text>
<text text-anchor="middle" x="30215" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10240&#45;11264, heads=32, d_k=128]</text>
<text text-anchor="middle" x="30215" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10240&#45;11264, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_10&#45;&gt;layer3_attn_out_10 -->
<g id="edge305" class="edge">
<title>layer3_attn_weighted_10&#45;&gt;layer3_attn_out_10</title>
<path fill="none" stroke="black" d="M30215,-619.95C30215,-619.95 30215,-594.13 30215,-594.13"/>
<polygon fill="black" stroke="black" points="30218.5,-594.13 30215,-584.13 30211.5,-594.13 30218.5,-594.13"/>
</g>
<!-- layer3_attn_out_10&#45;&gt;layer3_attn_aggregate -->
<g id="edge306" class="edge">
<title>layer3_attn_out_10&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M30215,-515.85C30215,-484.54 30215,-443 30215,-443 30215,-443 33985.59,-443 33985.59,-443"/>
<polygon fill="black" stroke="black" points="33985.59,-446.5 33995.59,-443 33985.59,-439.5 33985.59,-446.5"/>
</g>
<!-- layer3_attn_scores_11 -->
<g id="node254" class="node">
<title>layer3_attn_scores_11</title>
<polygon fill="lightblue" stroke="black" points="31314,-792 30784,-792 30784,-724 31314,-724 31314,-792"/>
<text text-anchor="middle" x="31049" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 11</text>
<text text-anchor="middle" x="31049" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="31049" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
<text text-anchor="middle" x="31049" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_11&#45;&gt;layer3_attn_scores_11 -->
<g id="edge308" class="edge">
<title>layer3_attn_qkv_11&#45;&gt;layer3_attn_scores_11</title>
<path fill="none" stroke="black" d="M31049,-894.81C31049,-894.81 31049,-802.13 31049,-802.13"/>
<polygon fill="black" stroke="black" points="31052.5,-802.13 31049,-792.13 31045.5,-802.13 31052.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_11 -->
<g id="node255" class="node">
<title>layer3_attn_weighted_11</title>
<polygon fill="lightblue" stroke="black" points="31438,-688 30614,-688 30614,-620 31438,-620 31438,-688"/>
<text text-anchor="middle" x="31026" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 11</text>
<text text-anchor="middle" x="31026" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="31026" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="31026" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_11&#45;&gt;layer3_attn_weighted_11 -->
<g id="edge309" class="edge">
<title>layer3_attn_scores_11&#45;&gt;layer3_attn_weighted_11</title>
<path fill="none" stroke="black" d="M31049,-723.95C31049,-723.95 31049,-698.13 31049,-698.13"/>
<polygon fill="black" stroke="black" points="31052.5,-698.13 31049,-688.13 31045.5,-698.13 31052.5,-698.13"/>
</g>
<!-- layer3_attn_out_11 -->
<g id="node256" class="node">
<title>layer3_attn_out_11</title>
<polygon fill="lightblue" stroke="black" points="31388.5,-584 30761.5,-584 30761.5,-516 31388.5,-516 31388.5,-584"/>
<text text-anchor="middle" x="31075" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 11</text>
<text text-anchor="middle" x="31075" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 19</text>
<text text-anchor="middle" x="31075" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=11264&#45;12288, heads=32, d_k=128]</text>
<text text-anchor="middle" x="31075" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=11264&#45;12288, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_11&#45;&gt;layer3_attn_out_11 -->
<g id="edge310" class="edge">
<title>layer3_attn_weighted_11&#45;&gt;layer3_attn_out_11</title>
<path fill="none" stroke="black" d="M31075,-619.95C31075,-619.95 31075,-594.13 31075,-594.13"/>
<polygon fill="black" stroke="black" points="31078.5,-594.13 31075,-584.13 31071.5,-594.13 31078.5,-594.13"/>
</g>
<!-- layer3_attn_out_11&#45;&gt;layer3_attn_aggregate -->
<g id="edge311" class="edge">
<title>layer3_attn_out_11&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M31075,-516C31075,-487.69 31075,-452 31075,-452 31075,-452 34003.51,-452 34003.51,-452"/>
<polygon fill="black" stroke="black" points="34003.51,-455.5 34013.51,-452 34003.51,-448.5 34003.51,-455.5"/>
</g>
<!-- layer3_attn_scores_12 -->
<g id="node258" class="node">
<title>layer3_attn_scores_12</title>
<polygon fill="lightblue" stroke="black" points="32174,-792 31644,-792 31644,-724 32174,-724 32174,-792"/>
<text text-anchor="middle" x="31909" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 12</text>
<text text-anchor="middle" x="31909" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="31909" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
<text text-anchor="middle" x="31909" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_12&#45;&gt;layer3_attn_scores_12 -->
<g id="edge313" class="edge">
<title>layer3_attn_qkv_12&#45;&gt;layer3_attn_scores_12</title>
<path fill="none" stroke="black" d="M31909,-894.81C31909,-894.81 31909,-802.13 31909,-802.13"/>
<polygon fill="black" stroke="black" points="31912.5,-802.13 31909,-792.13 31905.5,-802.13 31912.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_12 -->
<g id="node259" class="node">
<title>layer3_attn_weighted_12</title>
<polygon fill="lightblue" stroke="black" points="32298,-688 31474,-688 31474,-620 32298,-620 32298,-688"/>
<text text-anchor="middle" x="31886" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 12</text>
<text text-anchor="middle" x="31886" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="31886" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="31886" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_12&#45;&gt;layer3_attn_weighted_12 -->
<g id="edge314" class="edge">
<title>layer3_attn_scores_12&#45;&gt;layer3_attn_weighted_12</title>
<path fill="none" stroke="black" d="M31909,-723.95C31909,-723.95 31909,-698.13 31909,-698.13"/>
<polygon fill="black" stroke="black" points="31912.5,-698.13 31909,-688.13 31905.5,-698.13 31912.5,-698.13"/>
</g>
<!-- layer3_attn_out_12 -->
<g id="node260" class="node">
<title>layer3_attn_out_12</title>
<polygon fill="lightblue" stroke="black" points="32248.5,-584 31621.5,-584 31621.5,-516 32248.5,-516 32248.5,-584"/>
<text text-anchor="middle" x="31935" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 12</text>
<text text-anchor="middle" x="31935" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 20</text>
<text text-anchor="middle" x="31935" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=12288&#45;13312, heads=32, d_k=128]</text>
<text text-anchor="middle" x="31935" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=12288&#45;13312, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_12&#45;&gt;layer3_attn_out_12 -->
<g id="edge315" class="edge">
<title>layer3_attn_weighted_12&#45;&gt;layer3_attn_out_12</title>
<path fill="none" stroke="black" d="M31935,-619.95C31935,-619.95 31935,-594.13 31935,-594.13"/>
<polygon fill="black" stroke="black" points="31938.5,-594.13 31935,-584.13 31931.5,-594.13 31938.5,-594.13"/>
</g>
<!-- layer3_attn_out_12&#45;&gt;layer3_attn_aggregate -->
<g id="edge316" class="edge">
<title>layer3_attn_out_12&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M31935,-515.84C31935,-490.75 31935,-461 31935,-461 31935,-461 34021.63,-461 34021.63,-461"/>
<polygon fill="black" stroke="black" points="34021.63,-464.5 34031.63,-461 34021.63,-457.5 34021.63,-464.5"/>
</g>
<!-- layer3_attn_scores_13 -->
<g id="node262" class="node">
<title>layer3_attn_scores_13</title>
<polygon fill="lightblue" stroke="black" points="33034,-792 32504,-792 32504,-724 33034,-724 33034,-792"/>
<text text-anchor="middle" x="32769" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 13</text>
<text text-anchor="middle" x="32769" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="32769" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
<text text-anchor="middle" x="32769" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_13&#45;&gt;layer3_attn_scores_13 -->
<g id="edge318" class="edge">
<title>layer3_attn_qkv_13&#45;&gt;layer3_attn_scores_13</title>
<path fill="none" stroke="black" d="M32769,-894.81C32769,-894.81 32769,-802.13 32769,-802.13"/>
<polygon fill="black" stroke="black" points="32772.5,-802.13 32769,-792.13 32765.5,-802.13 32772.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_13 -->
<g id="node263" class="node">
<title>layer3_attn_weighted_13</title>
<polygon fill="lightblue" stroke="black" points="33158,-688 32334,-688 32334,-620 33158,-620 33158,-688"/>
<text text-anchor="middle" x="32746" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 13</text>
<text text-anchor="middle" x="32746" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="32746" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="32746" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_13&#45;&gt;layer3_attn_weighted_13 -->
<g id="edge319" class="edge">
<title>layer3_attn_scores_13&#45;&gt;layer3_attn_weighted_13</title>
<path fill="none" stroke="black" d="M32769,-723.95C32769,-723.95 32769,-698.13 32769,-698.13"/>
<polygon fill="black" stroke="black" points="32772.5,-698.13 32769,-688.13 32765.5,-698.13 32772.5,-698.13"/>
</g>
<!-- layer3_attn_out_13 -->
<g id="node264" class="node">
<title>layer3_attn_out_13</title>
<polygon fill="lightblue" stroke="black" points="33108.5,-584 32481.5,-584 32481.5,-516 33108.5,-516 33108.5,-584"/>
<text text-anchor="middle" x="32795" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 13</text>
<text text-anchor="middle" x="32795" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 21</text>
<text text-anchor="middle" x="32795" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=13312&#45;14336, heads=32, d_k=128]</text>
<text text-anchor="middle" x="32795" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=13312&#45;14336, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_13&#45;&gt;layer3_attn_out_13 -->
<g id="edge320" class="edge">
<title>layer3_attn_weighted_13&#45;&gt;layer3_attn_out_13</title>
<path fill="none" stroke="black" d="M32795,-619.95C32795,-619.95 32795,-594.13 32795,-594.13"/>
<polygon fill="black" stroke="black" points="32798.5,-594.13 32795,-584.13 32791.5,-594.13 32798.5,-594.13"/>
</g>
<!-- layer3_attn_out_13&#45;&gt;layer3_attn_aggregate -->
<g id="edge321" class="edge">
<title>layer3_attn_out_13&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M32795,-515.61C32795,-493.93 32795,-470 32795,-470 32795,-470 34039.99,-470 34039.99,-470"/>
<polygon fill="black" stroke="black" points="34039.99,-473.5 34049.99,-470 34039.99,-466.5 34039.99,-473.5"/>
</g>
<!-- layer3_attn_scores_14 -->
<g id="node266" class="node">
<title>layer3_attn_scores_14</title>
<polygon fill="lightblue" stroke="black" points="33871,-792 33341,-792 33341,-724 33871,-724 33871,-792"/>
<text text-anchor="middle" x="33606" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 14</text>
<text text-anchor="middle" x="33606" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="33606" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
<text text-anchor="middle" x="33606" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_14&#45;&gt;layer3_attn_scores_14 -->
<g id="edge323" class="edge">
<title>layer3_attn_qkv_14&#45;&gt;layer3_attn_scores_14</title>
<path fill="none" stroke="black" d="M33606,-894.81C33606,-894.81 33606,-802.13 33606,-802.13"/>
<polygon fill="black" stroke="black" points="33609.5,-802.13 33606,-792.13 33602.5,-802.13 33609.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_14 -->
<g id="node267" class="node">
<title>layer3_attn_weighted_14</title>
<polygon fill="lightblue" stroke="black" points="34018,-688 33194,-688 33194,-620 34018,-620 34018,-688"/>
<text text-anchor="middle" x="33606" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 14</text>
<text text-anchor="middle" x="33606" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="33606" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="33606" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_14&#45;&gt;layer3_attn_weighted_14 -->
<g id="edge324" class="edge">
<title>layer3_attn_scores_14&#45;&gt;layer3_attn_weighted_14</title>
<path fill="none" stroke="black" d="M33606,-723.95C33606,-723.95 33606,-698.13 33606,-698.13"/>
<polygon fill="black" stroke="black" points="33609.5,-698.13 33606,-688.13 33602.5,-698.13 33609.5,-698.13"/>
</g>
<!-- layer3_attn_out_14 -->
<g id="node268" class="node">
<title>layer3_attn_out_14</title>
<polygon fill="lightblue" stroke="black" points="33968.5,-584 33341.5,-584 33341.5,-516 33968.5,-516 33968.5,-584"/>
<text text-anchor="middle" x="33655" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 14</text>
<text text-anchor="middle" x="33655" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 22</text>
<text text-anchor="middle" x="33655" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=14336&#45;15360, heads=32, d_k=128]</text>
<text text-anchor="middle" x="33655" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=14336&#45;15360, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_14&#45;&gt;layer3_attn_out_14 -->
<g id="edge325" class="edge">
<title>layer3_attn_weighted_14&#45;&gt;layer3_attn_out_14</title>
<path fill="none" stroke="black" d="M33655,-619.95C33655,-619.95 33655,-594.13 33655,-594.13"/>
<polygon fill="black" stroke="black" points="33658.5,-594.13 33655,-584.13 33651.5,-594.13 33658.5,-594.13"/>
</g>
<!-- layer3_attn_out_14&#45;&gt;layer3_attn_aggregate -->
<g id="edge326" class="edge">
<title>layer3_attn_out_14&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M33882.38,-515.89C33882.38,-515.89 33882.38,-422.05 33882.38,-422.05"/>
<polygon fill="black" stroke="black" points="33885.88,-422.05 33882.38,-412.05 33878.88,-422.05 33885.88,-422.05"/>
</g>
<!-- layer3_attn_scores_15 -->
<g id="node270" class="node">
<title>layer3_attn_scores_15</title>
<polygon fill="lightblue" stroke="black" points="34708,-792 34178,-792 34178,-724 34708,-724 34708,-792"/>
<text text-anchor="middle" x="34443" y="-776.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Scores Block 15</text>
<text text-anchor="middle" x="34443" y="-761.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="34443" y="-746.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
<text text-anchor="middle" x="34443" y="-731.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_qkv_15&#45;&gt;layer3_attn_scores_15 -->
<g id="edge328" class="edge">
<title>layer3_attn_qkv_15&#45;&gt;layer3_attn_scores_15</title>
<path fill="none" stroke="black" d="M34443,-894.81C34443,-894.81 34443,-802.13 34443,-802.13"/>
<polygon fill="black" stroke="black" points="34446.5,-802.13 34443,-792.13 34439.5,-802.13 34446.5,-802.13"/>
</g>
<!-- layer3_attn_weighted_15 -->
<g id="node271" class="node">
<title>layer3_attn_weighted_15</title>
<polygon fill="lightblue" stroke="black" points="34878,-688 34054,-688 34054,-620 34878,-620 34878,-688"/>
<text text-anchor="middle" x="34466" y="-672.8" font-family="Times,serif" font-size="14.00">Layer 3 Weighted Sum Block 15</text>
<text text-anchor="middle" x="34466" y="-657.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="34466" y="-642.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128], [batch_size=1024, seq_len=?, seq_len=?]</text>
<text text-anchor="middle" x="34466" y="-627.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
</g>
<!-- layer3_attn_scores_15&#45;&gt;layer3_attn_weighted_15 -->
<g id="edge329" class="edge">
<title>layer3_attn_scores_15&#45;&gt;layer3_attn_weighted_15</title>
<path fill="none" stroke="black" d="M34443,-723.95C34443,-723.95 34443,-698.13 34443,-698.13"/>
<polygon fill="black" stroke="black" points="34446.5,-698.13 34443,-688.13 34439.5,-698.13 34446.5,-698.13"/>
</g>
<!-- layer3_attn_out_15 -->
<g id="node272" class="node">
<title>layer3_attn_out_15</title>
<polygon fill="lightblue" stroke="black" points="34779.5,-584 34152.5,-584 34152.5,-516 34779.5,-516 34779.5,-584"/>
<text text-anchor="middle" x="34466" y="-568.8" font-family="Times,serif" font-size="14.00">Layer 3 Attention Output Block 15</text>
<text text-anchor="middle" x="34466" y="-553.8" font-family="Times,serif" font-size="14.00">GPU: 23</text>
<text text-anchor="middle" x="34466" y="-538.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=15360&#45;16384, heads=32, d_k=128]</text>
<text text-anchor="middle" x="34466" y="-523.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=15360&#45;16384, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_weighted_15&#45;&gt;layer3_attn_out_15 -->
<g id="edge330" class="edge">
<title>layer3_attn_weighted_15&#45;&gt;layer3_attn_out_15</title>
<path fill="none" stroke="black" d="M34466,-619.95C34466,-619.95 34466,-594.13 34466,-594.13"/>
<polygon fill="black" stroke="black" points="34469.5,-594.13 34466,-584.13 34462.5,-594.13 34469.5,-594.13"/>
</g>
<!-- layer3_attn_out_15&#45;&gt;layer3_attn_aggregate -->
<g id="edge331" class="edge">
<title>layer3_attn_out_15&#45;&gt;layer3_attn_aggregate</title>
<path fill="none" stroke="black" d="M34466,-515.89C34466,-515.89 34466,-490.23 34466,-490.23"/>
<polygon fill="black" stroke="black" points="34469.5,-490.23 34466,-480.23 34462.5,-490.23 34469.5,-490.23"/>
</g>
<!-- recv_from_pool_3 -->
<g id="node274" class="node">
<title>recv_from_pool_3</title>
<polygon fill="yellow" stroke="black" points="37922.69,-308 37032.35,-308 36803.31,-172 37693.65,-172 37922.69,-308"/>
<text text-anchor="middle" x="37363" y="-258.8" font-family="Times,serif" font-size="14.00">Receive Layer 3 from Pool</text>
<text text-anchor="middle" x="37363" y="-243.8" font-family="Times,serif" font-size="14.00">GPU: [8&#45;23] → [0&#45;7]</text>
<text text-anchor="middle" x="37363" y="-228.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
<text text-anchor="middle" x="37363" y="-213.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, hidden_dim=4096, partition=512]</text>
</g>
<!-- layer3_attn_aggregate&#45;&gt;recv_from_pool_3 -->
<g id="edge332" class="edge">
<title>layer3_attn_aggregate&#45;&gt;recv_from_pool_3</title>
<path fill="none" stroke="black" d="M34896.09,-361C35605.96,-361 36945.27,-361 36945.27,-361 36945.27,-361 36945.27,-266.32 36945.27,-266.32"/>
<polygon fill="black" stroke="black" points="36948.77,-266.32 36945.27,-256.32 36941.77,-266.32 36948.77,-266.32"/>
</g>
<!-- recv_from_pool_3&#45;&gt;output_proj -->
<g id="edge333" class="edge">
<title>recv_from_pool_3&#45;&gt;output_proj</title>
<path fill="none" stroke="black" d="M37087.38,-308.12C37087.38,-384.56 37087.38,-498 37087.38,-498 37087.38,-498 14478,-498 14478,-498 14478,-498 14478,-1194.75 14478,-1194.75"/>
<polygon fill="black" stroke="black" points="14474.5,-1194.75 14478,-1204.75 14481.5,-1194.75 14474.5,-1194.75"/>
</g>
</g>
</svg>
