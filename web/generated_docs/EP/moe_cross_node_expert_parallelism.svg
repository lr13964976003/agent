<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Cross_Node_Expert_Parallelism Pages: 1 -->
<svg width="1440pt" height="529pt"
 viewBox="0.00 0.00 1440.00 529.02" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.07 0.07) rotate(0) translate(4 7355.48)">
<title>MoE_Cross_Node_Expert_Parallelism</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-7355.48 20028.5,-7355.48 20028.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="7102.5" cy="-7324.61" rx="322.38" ry="26.74"/>
<text text-anchor="middle" x="7102.5" y="-7328.41" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="7102.5" y="-7313.41" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
</g>
<!-- layer_0_input -->
<g id="node2" class="node">
<title>layer_0_input</title>
<polygon fill="lightyellow" stroke="black" points="7575.02,-7261.74 6823.35,-7261.74 6629.98,-7155.74 7381.65,-7155.74 7575.02,-7261.74"/>
<text text-anchor="middle" x="7102.5" y="-7220.04" font-family="Times,serif" font-size="14.00">Layer 0 Input</text>
<text text-anchor="middle" x="7102.5" y="-7205.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="7102.5" y="-7190.04" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input&#45;&gt;layer_0_input -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_input</title>
<path fill="none" stroke="black" d="M7102.5,-7297.49C7102.5,-7289.76 7102.5,-7280.95 7102.5,-7271.96"/>
<polygon fill="black" stroke="black" points="7106,-7271.78 7102.5,-7261.78 7099,-7271.78 7106,-7271.78"/>
</g>
<!-- layer_0_mha_qkv -->
<g id="node3" class="node">
<title>layer_0_mha_qkv</title>
<polygon fill="lightgreen" stroke="black" points="7209,-7119.74 6728,-7119.74 6728,-7051.74 7209,-7051.74 7209,-7119.74"/>
<text text-anchor="middle" x="6968.5" y="-7104.54" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="6968.5" y="-7089.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="6968.5" y="-7074.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="6968.5" y="-7059.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_input&#45;&gt;layer_0_mha_qkv -->
<g id="edge2" class="edge">
<title>layer_0_input&#45;&gt;layer_0_mha_qkv</title>
<path fill="none" stroke="black" d="M7044.89,-7155.72C7034.15,-7146.02 7023.09,-7136.03 7012.82,-7126.76"/>
<polygon fill="black" stroke="black" points="7014.92,-7123.94 7005.15,-7119.83 7010.23,-7129.13 7014.92,-7123.94"/>
</g>
<!-- layer_0_mha_residual -->
<g id="node6" class="node">
<title>layer_0_mha_residual</title>
<polygon fill="lightcoral" stroke="black" points="7338.5,-6807.74 6870.5,-6807.74 6870.5,-6739.74 7338.5,-6739.74 7338.5,-6807.74"/>
<text text-anchor="middle" x="7104.5" y="-6792.54" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="7104.5" y="-6777.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="7104.5" y="-6762.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="7104.5" y="-6747.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_input&#45;&gt;layer_0_mha_residual -->
<g id="edge5" class="edge">
<title>layer_0_input&#45;&gt;layer_0_mha_residual</title>
<path fill="none" stroke="black" d="M7190.04,-7155.5C7201.12,-7145.08 7210.88,-7133.15 7217.5,-7119.74 7239.43,-7075.35 7282.09,-6960.53 7216.5,-6843.74 7209.99,-6832.16 7200.66,-6822.27 7190.12,-6813.92"/>
<polygon fill="black" stroke="black" points="7191.98,-6810.94 7181.86,-6807.82 7187.83,-6816.58 7191.98,-6810.94"/>
</g>
<!-- layer_0_mha_attention -->
<g id="node4" class="node">
<title>layer_0_mha_attention</title>
<polygon fill="lightgreen" stroke="black" points="7206,-7015.74 6737,-7015.74 6737,-6947.74 7206,-6947.74 7206,-7015.74"/>
<text text-anchor="middle" x="6971.5" y="-7000.54" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="6971.5" y="-6985.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="6971.5" y="-6970.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="6971.5" y="-6955.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_mha_qkv&#45;&gt;layer_0_mha_attention -->
<g id="edge3" class="edge">
<title>layer_0_mha_qkv&#45;&gt;layer_0_mha_attention</title>
<path fill="none" stroke="black" d="M6969.47,-7051.62C6969.71,-7043.52 6969.97,-7034.72 6970.22,-7026.21"/>
<polygon fill="black" stroke="black" points="6973.73,-7026.14 6970.52,-7016.04 6966.73,-7025.93 6973.73,-7026.14"/>
</g>
<!-- layer_0_mha_proj -->
<g id="node5" class="node">
<title>layer_0_mha_proj</title>
<polygon fill="lightgreen" stroke="black" points="7207.5,-6911.74 6739.5,-6911.74 6739.5,-6843.74 7207.5,-6843.74 7207.5,-6911.74"/>
<text text-anchor="middle" x="6973.5" y="-6896.54" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="6973.5" y="-6881.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="6973.5" y="-6866.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="6973.5" y="-6851.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_mha_attention&#45;&gt;layer_0_mha_proj -->
<g id="edge4" class="edge">
<title>layer_0_mha_attention&#45;&gt;layer_0_mha_proj</title>
<path fill="none" stroke="black" d="M6972.15,-6947.62C6972.31,-6939.52 6972.48,-6930.72 6972.65,-6922.21"/>
<polygon fill="black" stroke="black" points="6976.15,-6922.11 6972.85,-6912.04 6969.15,-6921.97 6976.15,-6922.11"/>
</g>
<!-- layer_0_mha_proj&#45;&gt;layer_0_mha_residual -->
<g id="edge6" class="edge">
<title>layer_0_mha_proj&#45;&gt;layer_0_mha_residual</title>
<path fill="none" stroke="black" d="M7016.03,-6843.62C7028.04,-6834.27 7041.24,-6824 7053.68,-6814.31"/>
<polygon fill="black" stroke="black" points="7055.99,-6816.94 7061.73,-6808.04 7051.69,-6811.42 7055.99,-6816.94"/>
</g>
<!-- layer_0_mha_layernorm -->
<g id="node7" class="node">
<title>layer_0_mha_layernorm</title>
<polygon fill="lightgray" stroke="black" points="7338.5,-6703.74 6870.5,-6703.74 6870.5,-6635.74 7338.5,-6635.74 7338.5,-6703.74"/>
<text text-anchor="middle" x="7104.5" y="-6688.54" font-family="Times,serif" font-size="14.00">Layer Norm (Post&#45;MHA)</text>
<text text-anchor="middle" x="7104.5" y="-6673.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="7104.5" y="-6658.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="7104.5" y="-6643.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_mha_residual&#45;&gt;layer_0_mha_layernorm -->
<g id="edge7" class="edge">
<title>layer_0_mha_residual&#45;&gt;layer_0_mha_layernorm</title>
<path fill="none" stroke="black" d="M7104.5,-6739.62C7104.5,-6731.52 7104.5,-6722.72 7104.5,-6714.21"/>
<polygon fill="black" stroke="black" points="7108,-6714.04 7104.5,-6704.04 7101,-6714.04 7108,-6714.04"/>
</g>
<!-- layer_0_gate -->
<g id="node8" class="node">
<title>layer_0_gate</title>
<polygon fill="orange" stroke="black" points="7076.02,-6599.74 6324.35,-6599.74 6130.98,-6463.74 6882.65,-6463.74 7076.02,-6599.74"/>
<text text-anchor="middle" x="6603.5" y="-6550.54" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="6603.5" y="-6535.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="6603.5" y="-6520.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, k=2]</text>
<text text-anchor="middle" x="6603.5" y="-6505.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_mha_layernorm&#45;&gt;layer_0_gate -->
<g id="edge8" class="edge">
<title>layer_0_mha_layernorm&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" d="M6982.9,-6635.73C6945.61,-6625.61 6903.08,-6614.06 6860.3,-6602.45"/>
<polygon fill="black" stroke="black" points="6861.16,-6599.06 6850.6,-6599.82 6859.33,-6605.81 6861.16,-6599.06"/>
</g>
<!-- layer_0_token_split -->
<g id="node9" class="node">
<title>layer_0_token_split</title>
<polygon fill="lightyellow" stroke="black" points="7076.02,-6427.74 6324.35,-6427.74 6130.98,-6291.74 6882.65,-6291.74 7076.02,-6427.74"/>
<text text-anchor="middle" x="6603.5" y="-6378.54" font-family="Times,serif" font-size="14.00">Token Split by Expert</text>
<text text-anchor="middle" x="6603.5" y="-6363.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="6603.5" y="-6348.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192] per expert</text>
<text text-anchor="middle" x="6603.5" y="-6333.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_mha_layernorm&#45;&gt;layer_0_token_split -->
<g id="edge9" class="edge">
<title>layer_0_mha_layernorm&#45;&gt;layer_0_token_split</title>
<path fill="none" stroke="black" d="M7112.19,-6635.73C7120.52,-6590.93 7127.52,-6511.04 7085.5,-6463.74 7074.84,-6451.74 7056.95,-6441.04 7034.18,-6431.53"/>
<polygon fill="black" stroke="black" points="7035.44,-6428.26 7024.86,-6427.8 7032.84,-6434.76 7035.44,-6428.26"/>
</g>
<!-- layer_0_expert_residual -->
<g id="node91" class="node">
<title>layer_0_expert_residual</title>
<polygon fill="lightcoral" stroke="black" points="9856.5,-5667.74 9388.5,-5667.74 9388.5,-5599.74 9856.5,-5599.74 9856.5,-5667.74"/>
<text text-anchor="middle" x="9622.5" y="-5652.54" font-family="Times,serif" font-size="14.00">Expert Residual Add</text>
<text text-anchor="middle" x="9622.5" y="-5637.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9622.5" y="-5622.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9622.5" y="-5607.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_mha_layernorm&#45;&gt;layer_0_expert_residual -->
<g id="edge123" class="edge">
<title>layer_0_mha_layernorm&#45;&gt;layer_0_expert_residual</title>
<path fill="none" stroke="black" d="M7338.86,-6667.7C8370.77,-6661.61 12458.5,-6621.07 12458.5,-6360.74 12458.5,-6360.74 12458.5,-6360.74 12458.5,-5908.74 12458.5,-5779.05 10554.62,-5677.94 9866.73,-5645.64"/>
<polygon fill="black" stroke="black" points="9866.85,-5642.14 9856.69,-5645.17 9866.52,-5649.13 9866.85,-5642.14"/>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_token_split -->
<g id="edge10" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_token_split</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6603.5,-6463.55C6603.5,-6455.24 6603.5,-6446.69 6603.5,-6438.23"/>
<polygon fill="black" stroke="black" points="6607,-6438 6603.5,-6428 6600,-6438 6607,-6438"/>
</g>
<!-- layer_0_expert_0 -->
<g id="node10" class="node">
<title>layer_0_expert_0</title>
<polygon fill="lightcyan" stroke="black" points="760,-6255.74 389,-6255.74 389,-6187.74 760,-6187.74 760,-6255.74"/>
<text text-anchor="middle" x="574.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="574.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="574.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="574.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_0 -->
<g id="edge11" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_0</title>
<path fill="none" stroke="black" d="M6222.89,-6356.47C5335.2,-6350.08 3058.69,-6327.5 1157.5,-6255.74 1028.43,-6250.87 883.43,-6242.67 770.33,-6235.67"/>
<polygon fill="black" stroke="black" points="770.38,-6232.16 760.18,-6235.04 769.94,-6239.15 770.38,-6232.16"/>
</g>
<!-- layer_0_expert_1 -->
<g id="node15" class="node">
<title>layer_0_expert_1</title>
<polygon fill="lightcyan" stroke="black" points="1538,-6255.74 1167,-6255.74 1167,-6187.74 1538,-6187.74 1538,-6255.74"/>
<text text-anchor="middle" x="1352.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1352.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="1352.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="1352.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_1 -->
<g id="edge18" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_1</title>
<path fill="none" stroke="black" d="M6220.26,-6354.76C5422.61,-6345.48 3525.86,-6318.28 1935.5,-6255.74 1806.44,-6250.67 1661.44,-6242.47 1548.34,-6235.51"/>
<polygon fill="black" stroke="black" points="1548.38,-6232.01 1538.18,-6234.89 1547.95,-6239 1548.38,-6232.01"/>
</g>
<!-- layer_0_expert_2 -->
<g id="node20" class="node">
<title>layer_0_expert_2</title>
<polygon fill="lightcyan" stroke="black" points="2316,-6255.74 1945,-6255.74 1945,-6187.74 2316,-6187.74 2316,-6255.74"/>
<text text-anchor="middle" x="2130.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2130.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="2130.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="2130.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_2 -->
<g id="edge25" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_2</title>
<path fill="none" stroke="black" d="M6216.88,-6352.35C5517.57,-6339.94 3996,-6309 2713.5,-6255.74 2584.45,-6250.38 2439.45,-6242.18 2326.34,-6235.3"/>
<polygon fill="black" stroke="black" points="2326.39,-6231.79 2316.19,-6234.68 2325.96,-6238.78 2326.39,-6231.79"/>
</g>
<!-- layer_0_expert_3 -->
<g id="node25" class="node">
<title>layer_0_expert_3</title>
<polygon fill="lightcyan" stroke="black" points="3094,-6255.74 2723,-6255.74 2723,-6187.74 3094,-6187.74 3094,-6255.74"/>
<text text-anchor="middle" x="2908.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2908.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="2908.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="2908.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_3 -->
<g id="edge32" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_3</title>
<path fill="none" stroke="black" d="M6211.91,-6348.73C5621.88,-6332.97 4469.8,-6299.61 3491.5,-6255.74 3362.47,-6249.95 3217.47,-6241.75 3104.36,-6234.98"/>
<polygon fill="black" stroke="black" points="3104.4,-6231.47 3094.21,-6234.37 3103.98,-6238.46 3104.4,-6231.47"/>
</g>
<!-- layer_0_expert_4 -->
<g id="node30" class="node">
<title>layer_0_expert_4</title>
<polygon fill="lightcyan" stroke="black" points="3872,-6255.74 3501,-6255.74 3501,-6187.74 3872,-6187.74 3872,-6255.74"/>
<text text-anchor="middle" x="3686.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3686.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3686.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3686.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_4 -->
<g id="edge39" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_4</title>
<path fill="none" stroke="black" d="M6203.08,-6342.59C5738.13,-6323.48 4948.15,-6289.92 4269.5,-6255.74 4140.5,-6249.24 3995.51,-6241.04 3882.38,-6234.44"/>
<polygon fill="black" stroke="black" points="3882.42,-6230.93 3872.23,-6233.84 3882.01,-6237.92 3882.42,-6230.93"/>
</g>
<!-- layer_0_expert_5 -->
<g id="node35" class="node">
<title>layer_0_expert_5</title>
<polygon fill="lightcyan" stroke="black" points="4650,-6255.74 4279,-6255.74 4279,-6187.74 4650,-6187.74 4650,-6255.74"/>
<text text-anchor="middle" x="4464.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4464.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="4464.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="4464.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_5 -->
<g id="edge46" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_5</title>
<path fill="none" stroke="black" d="M6188.54,-6332.36C5728.23,-6303.09 5005.07,-6257.11 4660.16,-6235.18"/>
<polygon fill="black" stroke="black" points="4660.27,-6231.68 4650.07,-6234.54 4659.82,-6238.67 4660.27,-6231.68"/>
</g>
<!-- layer_0_expert_6 -->
<g id="node40" class="node">
<title>layer_0_expert_6</title>
<polygon fill="lightcyan" stroke="black" points="5428,-6255.74 5057,-6255.74 5057,-6187.74 5428,-6187.74 5428,-6255.74"/>
<text text-anchor="middle" x="5242.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5242.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5242.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5242.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_6 -->
<g id="edge53" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_6</title>
<path fill="none" stroke="black" d="M6163.5,-6314.77C5918.97,-6290.34 5626.88,-6261.15 5438.21,-6242.3"/>
<polygon fill="black" stroke="black" points="5438.48,-6238.81 5428.18,-6241.29 5437.79,-6245.77 5438.48,-6238.81"/>
</g>
<!-- layer_0_expert_7 -->
<g id="node45" class="node">
<title>layer_0_expert_7</title>
<polygon fill="lightcyan" stroke="black" points="6206,-6255.74 5835,-6255.74 5835,-6187.74 6206,-6187.74 6206,-6255.74"/>
<text text-anchor="middle" x="6020.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6020.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6020.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6020.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_7 -->
<g id="edge60" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_7</title>
<path fill="none" stroke="black" d="M6316.27,-6291.74C6266.43,-6280.11 6216.43,-6268.45 6172.09,-6258.1"/>
<polygon fill="black" stroke="black" points="6172.67,-6254.64 6162.13,-6255.78 6171.08,-6261.46 6172.67,-6254.64"/>
</g>
<!-- layer_0_expert_8 -->
<g id="node50" class="node">
<title>layer_0_expert_8</title>
<polygon fill="lightcyan" stroke="black" points="6789,-6255.74 6418,-6255.74 6418,-6187.74 6789,-6187.74 6789,-6255.74"/>
<text text-anchor="middle" x="6603.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="6603.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6603.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6603.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_8 -->
<g id="edge67" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_8</title>
<path fill="none" stroke="black" d="M6603.5,-6291.54C6603.5,-6282.78 6603.5,-6274.02 6603.5,-6265.81"/>
<polygon fill="black" stroke="black" points="6607,-6265.76 6603.5,-6255.76 6600,-6265.76 6607,-6265.76"/>
</g>
<!-- layer_0_expert_9 -->
<g id="node55" class="node">
<title>layer_0_expert_9</title>
<polygon fill="lightcyan" stroke="black" points="7373,-6255.74 7002,-6255.74 7002,-6187.74 7373,-6187.74 7373,-6255.74"/>
<text text-anchor="middle" x="7187.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7187.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7187.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7187.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_9 -->
<g id="edge74" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_9</title>
<path fill="none" stroke="black" d="M6884.81,-6293.23C6936.87,-6281.11 6989.38,-6268.88 7035.71,-6258.09"/>
<polygon fill="black" stroke="black" points="7036.56,-6261.48 7045.51,-6255.81 7034.97,-6254.67 7036.56,-6261.48"/>
</g>
<!-- layer_0_expert_10 -->
<g id="node60" class="node">
<title>layer_0_expert_10</title>
<polygon fill="lightcyan" stroke="black" points="8151,-6255.74 7780,-6255.74 7780,-6187.74 8151,-6187.74 8151,-6255.74"/>
<text text-anchor="middle" x="7965.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="7965.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7965.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7965.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_10 -->
<g id="edge81" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_10</title>
<path fill="none" stroke="black" d="M6931.47,-6325.99C7193.1,-6299.87 7550.84,-6264.15 7769.62,-6242.3"/>
<polygon fill="black" stroke="black" points="7770.01,-6245.78 7779.61,-6241.3 7769.31,-6238.81 7770.01,-6245.78"/>
</g>
<!-- layer_0_expert_11 -->
<g id="node65" class="node">
<title>layer_0_expert_11</title>
<polygon fill="lightcyan" stroke="black" points="8929,-6255.74 8558,-6255.74 8558,-6187.74 8929,-6187.74 8929,-6255.74"/>
<text text-anchor="middle" x="8743.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="8743.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8743.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8743.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_11 -->
<g id="edge88" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_11</title>
<path fill="none" stroke="black" d="M6947.03,-6336.91C7400.55,-6308.09 8183.97,-6258.3 8547.59,-6235.19"/>
<polygon fill="black" stroke="black" points="8547.93,-6238.68 8557.69,-6234.55 8547.49,-6231.69 8547.93,-6238.68"/>
</g>
<!-- layer_0_expert_12 -->
<g id="node70" class="node">
<title>layer_0_expert_12</title>
<polygon fill="lightcyan" stroke="black" points="9707,-6255.74 9336,-6255.74 9336,-6187.74 9707,-6187.74 9707,-6255.74"/>
<text text-anchor="middle" x="9521.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="9521.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9521.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9521.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_12 -->
<g id="edge95" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_12</title>
<path fill="none" stroke="black" d="M6958.11,-6344.47C7415.75,-6325.75 8236.64,-6291.08 8938.5,-6255.74 9067.5,-6249.24 9212.49,-6241.04 9325.62,-6234.44"/>
<polygon fill="black" stroke="black" points="9325.99,-6237.92 9335.77,-6233.84 9325.58,-6230.93 9325.99,-6237.92"/>
</g>
<!-- layer_0_expert_13 -->
<g id="node75" class="node">
<title>layer_0_expert_13</title>
<polygon fill="lightcyan" stroke="black" points="10485,-6255.74 10114,-6255.74 10114,-6187.74 10485,-6187.74 10485,-6255.74"/>
<text text-anchor="middle" x="10299.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10299.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10299.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10299.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_13 -->
<g id="edge102" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_13</title>
<path fill="none" stroke="black" d="M6964.89,-6349.54C7545.22,-6334.13 8720.84,-6300.38 9716.5,-6255.74 9845.53,-6249.95 9990.53,-6241.75 10103.64,-6234.98"/>
<polygon fill="black" stroke="black" points="10104.02,-6238.46 10113.79,-6234.37 10103.6,-6231.47 10104.02,-6238.46"/>
</g>
<!-- layer_0_expert_14 -->
<g id="node80" class="node">
<title>layer_0_expert_14</title>
<polygon fill="lightcyan" stroke="black" points="11263,-6255.74 10892,-6255.74 10892,-6187.74 11263,-6187.74 11263,-6255.74"/>
<text text-anchor="middle" x="11077.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="11077.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11077.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11077.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_14 -->
<g id="edge109" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_14</title>
<path fill="none" stroke="black" d="M6969.42,-6352.72C7659.15,-6340.56 9198.8,-6309.55 10494.5,-6255.74 10623.55,-6250.38 10768.55,-6242.18 10881.66,-6235.3"/>
<polygon fill="black" stroke="black" points="10882.04,-6238.78 10891.81,-6234.68 10881.61,-6231.79 10882.04,-6238.78"/>
</g>
<!-- layer_0_expert_15 -->
<g id="node85" class="node">
<title>layer_0_expert_15</title>
<polygon fill="lightcyan" stroke="black" points="12041,-6255.74 11670,-6255.74 11670,-6187.74 12041,-6187.74 12041,-6255.74"/>
<text text-anchor="middle" x="11855.5" y="-6240.54" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="11855.5" y="-6225.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11855.5" y="-6210.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11855.5" y="-6195.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_token_split&#45;&gt;layer_0_expert_15 -->
<g id="edge116" class="edge">
<title>layer_0_token_split&#45;&gt;layer_0_expert_15</title>
<path fill="none" stroke="black" d="M6972.84,-6354.92C7762.29,-6345.8 9672.43,-6318.66 11272.5,-6255.74 11401.56,-6250.67 11546.56,-6242.47 11659.66,-6235.51"/>
<polygon fill="black" stroke="black" points="11660.05,-6239 11669.82,-6234.89 11659.62,-6232.01 11660.05,-6239"/>
</g>
<!-- layer_0_expert_0_gate_proj -->
<g id="node11" class="node">
<title>layer_0_expert_0_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="371,-6151.74 0,-6151.74 0,-6083.74 371,-6083.74 371,-6151.74"/>
<text text-anchor="middle" x="185.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 0 Gate Proj</text>
<text text-anchor="middle" x="185.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="185.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="185.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_expert_0&#45;&gt;layer_0_expert_0_gate_proj -->
<g id="edge12" class="edge">
<title>layer_0_expert_0&#45;&gt;layer_0_expert_0_gate_proj</title>
<path fill="none" stroke="black" d="M448.47,-6187.69C407.9,-6177.05 362.76,-6165.22 321.51,-6154.4"/>
<polygon fill="black" stroke="black" points="322.22,-6150.97 311.66,-6151.82 320.45,-6157.74 322.22,-6150.97"/>
</g>
<!-- layer_0_expert_0_up_proj -->
<g id="node12" class="node">
<title>layer_0_expert_0_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="760,-6151.74 389,-6151.74 389,-6083.74 760,-6083.74 760,-6151.74"/>
<text text-anchor="middle" x="574.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 0 Up Proj</text>
<text text-anchor="middle" x="574.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="574.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="574.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_expert_0&#45;&gt;layer_0_expert_0_up_proj -->
<g id="edge14" class="edge">
<title>layer_0_expert_0&#45;&gt;layer_0_expert_0_up_proj</title>
<path fill="none" stroke="black" d="M574.5,-6187.62C574.5,-6179.52 574.5,-6170.72 574.5,-6162.21"/>
<polygon fill="black" stroke="black" points="578,-6162.04 574.5,-6152.04 571,-6162.04 578,-6162.04"/>
</g>
<!-- layer_0_expert_0_activation -->
<g id="node13" class="node">
<title>layer_0_expert_0_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="760,-6047.74 389,-6047.74 389,-5979.74 760,-5979.74 760,-6047.74"/>
<text text-anchor="middle" x="574.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="574.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="574.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="574.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_expert_0_gate_proj&#45;&gt;layer_0_expert_0_activation -->
<g id="edge13" class="edge">
<title>layer_0_expert_0_gate_proj&#45;&gt;layer_0_expert_0_activation</title>
<path fill="none" stroke="black" d="M311.53,-6083.69C352.1,-6073.05 397.24,-6061.22 438.49,-6050.4"/>
<polygon fill="black" stroke="black" points="439.55,-6053.74 448.34,-6047.82 437.78,-6046.97 439.55,-6053.74"/>
</g>
<!-- layer_0_expert_0_up_proj&#45;&gt;layer_0_expert_0_activation -->
<g id="edge15" class="edge">
<title>layer_0_expert_0_up_proj&#45;&gt;layer_0_expert_0_activation</title>
<path fill="none" stroke="black" d="M574.5,-6083.62C574.5,-6075.52 574.5,-6066.72 574.5,-6058.21"/>
<polygon fill="black" stroke="black" points="578,-6058.04 574.5,-6048.04 571,-6058.04 578,-6058.04"/>
</g>
<!-- layer_0_expert_0_down_proj -->
<g id="node14" class="node">
<title>layer_0_expert_0_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="767,-5943.74 396,-5943.74 396,-5875.74 767,-5875.74 767,-5943.74"/>
<text text-anchor="middle" x="581.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 0 Down Proj</text>
<text text-anchor="middle" x="581.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="581.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="581.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_0_expert_0_activation&#45;&gt;layer_0_expert_0_down_proj -->
<g id="edge16" class="edge">
<title>layer_0_expert_0_activation&#45;&gt;layer_0_expert_0_down_proj</title>
<path fill="none" stroke="black" d="M576.77,-5979.62C577.33,-5971.52 577.93,-5962.72 578.52,-5954.21"/>
<polygon fill="black" stroke="black" points="582.02,-5954.26 579.21,-5944.04 575.04,-5953.78 582.02,-5954.26"/>
</g>
<!-- layer_0_expert_agg -->
<g id="node90" class="node">
<title>layer_0_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="7287.06,-5839.74 6500.32,-5839.74 6297.94,-5703.74 7084.68,-5703.74 7287.06,-5839.74"/>
<text text-anchor="middle" x="6792.5" y="-5790.54" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="6792.5" y="-5775.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192] from all experts</text>
<text text-anchor="middle" x="6792.5" y="-5760.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="6792.5" y="-5745.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_expert_0_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge17" class="edge">
<title>layer_0_expert_0_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M767.38,-5904.67C1624.94,-5885.89 5208.14,-5807.43 6402.9,-5781.27"/>
<polygon fill="black" stroke="black" points="6403.02,-5784.77 6412.94,-5781.05 6402.86,-5777.77 6403.02,-5784.77"/>
</g>
<!-- layer_0_expert_1_gate_proj -->
<g id="node16" class="node">
<title>layer_0_expert_1_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="1149,-6151.74 778,-6151.74 778,-6083.74 1149,-6083.74 1149,-6151.74"/>
<text text-anchor="middle" x="963.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 1 Gate Proj</text>
<text text-anchor="middle" x="963.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="963.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="963.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_expert_1&#45;&gt;layer_0_expert_1_gate_proj -->
<g id="edge19" class="edge">
<title>layer_0_expert_1&#45;&gt;layer_0_expert_1_gate_proj</title>
<path fill="none" stroke="black" d="M1226.47,-6187.69C1185.9,-6177.05 1140.76,-6165.22 1099.51,-6154.4"/>
<polygon fill="black" stroke="black" points="1100.22,-6150.97 1089.66,-6151.82 1098.45,-6157.74 1100.22,-6150.97"/>
</g>
<!-- layer_0_expert_1_up_proj -->
<g id="node17" class="node">
<title>layer_0_expert_1_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="1538,-6151.74 1167,-6151.74 1167,-6083.74 1538,-6083.74 1538,-6151.74"/>
<text text-anchor="middle" x="1352.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 1 Up Proj</text>
<text text-anchor="middle" x="1352.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="1352.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="1352.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_expert_1&#45;&gt;layer_0_expert_1_up_proj -->
<g id="edge21" class="edge">
<title>layer_0_expert_1&#45;&gt;layer_0_expert_1_up_proj</title>
<path fill="none" stroke="black" d="M1352.5,-6187.62C1352.5,-6179.52 1352.5,-6170.72 1352.5,-6162.21"/>
<polygon fill="black" stroke="black" points="1356,-6162.04 1352.5,-6152.04 1349,-6162.04 1356,-6162.04"/>
</g>
<!-- layer_0_expert_1_activation -->
<g id="node18" class="node">
<title>layer_0_expert_1_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="1538,-6047.74 1167,-6047.74 1167,-5979.74 1538,-5979.74 1538,-6047.74"/>
<text text-anchor="middle" x="1352.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="1352.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="1352.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="1352.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_expert_1_gate_proj&#45;&gt;layer_0_expert_1_activation -->
<g id="edge20" class="edge">
<title>layer_0_expert_1_gate_proj&#45;&gt;layer_0_expert_1_activation</title>
<path fill="none" stroke="black" d="M1089.53,-6083.69C1130.1,-6073.05 1175.24,-6061.22 1216.49,-6050.4"/>
<polygon fill="black" stroke="black" points="1217.55,-6053.74 1226.34,-6047.82 1215.78,-6046.97 1217.55,-6053.74"/>
</g>
<!-- layer_0_expert_1_up_proj&#45;&gt;layer_0_expert_1_activation -->
<g id="edge22" class="edge">
<title>layer_0_expert_1_up_proj&#45;&gt;layer_0_expert_1_activation</title>
<path fill="none" stroke="black" d="M1352.5,-6083.62C1352.5,-6075.52 1352.5,-6066.72 1352.5,-6058.21"/>
<polygon fill="black" stroke="black" points="1356,-6058.04 1352.5,-6048.04 1349,-6058.04 1356,-6058.04"/>
</g>
<!-- layer_0_expert_1_down_proj -->
<g id="node19" class="node">
<title>layer_0_expert_1_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="2712,-5943.74 2341,-5943.74 2341,-5875.74 2712,-5875.74 2712,-5943.74"/>
<text text-anchor="middle" x="2526.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 1 Down Proj</text>
<text text-anchor="middle" x="2526.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2526.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="2526.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_0_expert_1_activation&#45;&gt;layer_0_expert_1_down_proj -->
<g id="edge23" class="edge">
<title>layer_0_expert_1_activation&#45;&gt;layer_0_expert_1_down_proj</title>
<path fill="none" stroke="black" d="M1538.2,-5996.61C1754.47,-5977.82 2110.17,-5946.91 2330.68,-5927.75"/>
<polygon fill="black" stroke="black" points="2331.09,-5931.23 2340.75,-5926.88 2330.49,-5924.26 2331.09,-5931.23"/>
</g>
<!-- layer_0_expert_1_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge24" class="edge">
<title>layer_0_expert_1_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M2712.38,-5902.28C2908,-5895.52 3224.9,-5884.66 3498.5,-5875.74 4550.66,-5841.43 5791.95,-5803.23 6407,-5784.46"/>
<polygon fill="black" stroke="black" points="6407.47,-5787.95 6417.36,-5784.14 6407.26,-5780.95 6407.47,-5787.95"/>
</g>
<!-- layer_0_expert_2_gate_proj -->
<g id="node21" class="node">
<title>layer_0_expert_2_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="1927,-6151.74 1556,-6151.74 1556,-6083.74 1927,-6083.74 1927,-6151.74"/>
<text text-anchor="middle" x="1741.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 2 Gate Proj</text>
<text text-anchor="middle" x="1741.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="1741.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="1741.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_expert_2&#45;&gt;layer_0_expert_2_gate_proj -->
<g id="edge26" class="edge">
<title>layer_0_expert_2&#45;&gt;layer_0_expert_2_gate_proj</title>
<path fill="none" stroke="black" d="M2004.47,-6187.69C1963.9,-6177.05 1918.76,-6165.22 1877.51,-6154.4"/>
<polygon fill="black" stroke="black" points="1878.22,-6150.97 1867.66,-6151.82 1876.45,-6157.74 1878.22,-6150.97"/>
</g>
<!-- layer_0_expert_2_up_proj -->
<g id="node22" class="node">
<title>layer_0_expert_2_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="2316,-6151.74 1945,-6151.74 1945,-6083.74 2316,-6083.74 2316,-6151.74"/>
<text text-anchor="middle" x="2130.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 2 Up Proj</text>
<text text-anchor="middle" x="2130.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="2130.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2130.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_expert_2&#45;&gt;layer_0_expert_2_up_proj -->
<g id="edge28" class="edge">
<title>layer_0_expert_2&#45;&gt;layer_0_expert_2_up_proj</title>
<path fill="none" stroke="black" d="M2130.5,-6187.62C2130.5,-6179.52 2130.5,-6170.72 2130.5,-6162.21"/>
<polygon fill="black" stroke="black" points="2134,-6162.04 2130.5,-6152.04 2127,-6162.04 2134,-6162.04"/>
</g>
<!-- layer_0_expert_2_activation -->
<g id="node23" class="node">
<title>layer_0_expert_2_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="2316,-6047.74 1945,-6047.74 1945,-5979.74 2316,-5979.74 2316,-6047.74"/>
<text text-anchor="middle" x="2130.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="2130.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2130.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2130.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_expert_2_gate_proj&#45;&gt;layer_0_expert_2_activation -->
<g id="edge27" class="edge">
<title>layer_0_expert_2_gate_proj&#45;&gt;layer_0_expert_2_activation</title>
<path fill="none" stroke="black" d="M1867.53,-6083.69C1908.1,-6073.05 1953.24,-6061.22 1994.49,-6050.4"/>
<polygon fill="black" stroke="black" points="1995.55,-6053.74 2004.34,-6047.82 1993.78,-6046.97 1995.55,-6053.74"/>
</g>
<!-- layer_0_expert_2_up_proj&#45;&gt;layer_0_expert_2_activation -->
<g id="edge29" class="edge">
<title>layer_0_expert_2_up_proj&#45;&gt;layer_0_expert_2_activation</title>
<path fill="none" stroke="black" d="M2130.5,-6083.62C2130.5,-6075.52 2130.5,-6066.72 2130.5,-6058.21"/>
<polygon fill="black" stroke="black" points="2134,-6058.04 2130.5,-6048.04 2127,-6058.04 2134,-6058.04"/>
</g>
<!-- layer_0_expert_2_down_proj -->
<g id="node24" class="node">
<title>layer_0_expert_2_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="3879,-5943.74 3508,-5943.74 3508,-5875.74 3879,-5875.74 3879,-5943.74"/>
<text text-anchor="middle" x="3693.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 2 Down Proj</text>
<text text-anchor="middle" x="3693.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3693.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3693.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_0_expert_2_activation&#45;&gt;layer_0_expert_2_down_proj -->
<g id="edge30" class="edge">
<title>layer_0_expert_2_activation&#45;&gt;layer_0_expert_2_down_proj</title>
<path fill="none" stroke="black" d="M2316.32,-6000.61C2613.71,-5981.21 3193.91,-5943.34 3497.57,-5923.53"/>
<polygon fill="black" stroke="black" points="3498.06,-5927 3507.81,-5922.86 3497.6,-5920.02 3498.06,-5927"/>
</g>
<!-- layer_0_expert_2_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge31" class="edge">
<title>layer_0_expert_2_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M3879.22,-5897.49C3993.73,-5890.73 4143.6,-5882.22 4276.5,-5875.74 5032.71,-5838.86 5917.21,-5804.74 6410.35,-5786.53"/>
<polygon fill="black" stroke="black" points="6410.62,-5790.02 6420.48,-5786.15 6410.36,-5783.02 6410.62,-5790.02"/>
</g>
<!-- layer_0_expert_3_gate_proj -->
<g id="node26" class="node">
<title>layer_0_expert_3_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="2705,-6151.74 2334,-6151.74 2334,-6083.74 2705,-6083.74 2705,-6151.74"/>
<text text-anchor="middle" x="2519.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 3 Gate Proj</text>
<text text-anchor="middle" x="2519.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="2519.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2519.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_expert_3&#45;&gt;layer_0_expert_3_gate_proj -->
<g id="edge33" class="edge">
<title>layer_0_expert_3&#45;&gt;layer_0_expert_3_gate_proj</title>
<path fill="none" stroke="black" d="M2782.47,-6187.69C2741.9,-6177.05 2696.76,-6165.22 2655.51,-6154.4"/>
<polygon fill="black" stroke="black" points="2656.22,-6150.97 2645.66,-6151.82 2654.45,-6157.74 2656.22,-6150.97"/>
</g>
<!-- layer_0_expert_3_up_proj -->
<g id="node27" class="node">
<title>layer_0_expert_3_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="3094,-6151.74 2723,-6151.74 2723,-6083.74 3094,-6083.74 3094,-6151.74"/>
<text text-anchor="middle" x="2908.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 3 Up Proj</text>
<text text-anchor="middle" x="2908.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="2908.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2908.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_expert_3&#45;&gt;layer_0_expert_3_up_proj -->
<g id="edge35" class="edge">
<title>layer_0_expert_3&#45;&gt;layer_0_expert_3_up_proj</title>
<path fill="none" stroke="black" d="M2908.5,-6187.62C2908.5,-6179.52 2908.5,-6170.72 2908.5,-6162.21"/>
<polygon fill="black" stroke="black" points="2912,-6162.04 2908.5,-6152.04 2905,-6162.04 2912,-6162.04"/>
</g>
<!-- layer_0_expert_3_activation -->
<g id="node28" class="node">
<title>layer_0_expert_3_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="3094,-6047.74 2723,-6047.74 2723,-5979.74 3094,-5979.74 3094,-6047.74"/>
<text text-anchor="middle" x="2908.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="2908.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2908.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2908.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_expert_3_gate_proj&#45;&gt;layer_0_expert_3_activation -->
<g id="edge34" class="edge">
<title>layer_0_expert_3_gate_proj&#45;&gt;layer_0_expert_3_activation</title>
<path fill="none" stroke="black" d="M2645.53,-6083.69C2686.1,-6073.05 2731.24,-6061.22 2772.49,-6050.4"/>
<polygon fill="black" stroke="black" points="2773.55,-6053.74 2782.34,-6047.82 2771.78,-6046.97 2773.55,-6053.74"/>
</g>
<!-- layer_0_expert_3_up_proj&#45;&gt;layer_0_expert_3_activation -->
<g id="edge36" class="edge">
<title>layer_0_expert_3_up_proj&#45;&gt;layer_0_expert_3_activation</title>
<path fill="none" stroke="black" d="M2908.5,-6083.62C2908.5,-6075.52 2908.5,-6066.72 2908.5,-6058.21"/>
<polygon fill="black" stroke="black" points="2912,-6058.04 2908.5,-6048.04 2905,-6058.04 2912,-6058.04"/>
</g>
<!-- layer_0_expert_3_down_proj -->
<g id="node29" class="node">
<title>layer_0_expert_3_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="4657,-5943.74 4286,-5943.74 4286,-5875.74 4657,-5875.74 4657,-5943.74"/>
<text text-anchor="middle" x="4471.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 3 Down Proj</text>
<text text-anchor="middle" x="4471.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="4471.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="4471.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_0_expert_3_activation&#45;&gt;layer_0_expert_3_down_proj -->
<g id="edge37" class="edge">
<title>layer_0_expert_3_activation&#45;&gt;layer_0_expert_3_down_proj</title>
<path fill="none" stroke="black" d="M3094.32,-6000.61C3391.71,-5981.21 3971.91,-5943.34 4275.57,-5923.53"/>
<polygon fill="black" stroke="black" points="4276.06,-5927 4285.81,-5922.86 4275.6,-5920.02 4276.06,-5927"/>
</g>
<!-- layer_0_expert_3_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge38" class="edge">
<title>layer_0_expert_3_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M4657.42,-5891.73C4721.42,-5886.19 4793.57,-5880.3 4859.5,-5875.74 5399.24,-5838.42 6024.57,-5807.3 6414.39,-5789.35"/>
<polygon fill="black" stroke="black" points="6414.59,-5792.84 6424.42,-5788.89 6414.27,-5785.85 6414.59,-5792.84"/>
</g>
<!-- layer_0_expert_4_gate_proj -->
<g id="node31" class="node">
<title>layer_0_expert_4_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="3483,-6151.74 3112,-6151.74 3112,-6083.74 3483,-6083.74 3483,-6151.74"/>
<text text-anchor="middle" x="3297.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 4 Gate Proj</text>
<text text-anchor="middle" x="3297.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3297.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3297.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_expert_4&#45;&gt;layer_0_expert_4_gate_proj -->
<g id="edge40" class="edge">
<title>layer_0_expert_4&#45;&gt;layer_0_expert_4_gate_proj</title>
<path fill="none" stroke="black" d="M3560.47,-6187.69C3519.9,-6177.05 3474.76,-6165.22 3433.51,-6154.4"/>
<polygon fill="black" stroke="black" points="3434.22,-6150.97 3423.66,-6151.82 3432.45,-6157.74 3434.22,-6150.97"/>
</g>
<!-- layer_0_expert_4_up_proj -->
<g id="node32" class="node">
<title>layer_0_expert_4_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="3872,-6151.74 3501,-6151.74 3501,-6083.74 3872,-6083.74 3872,-6151.74"/>
<text text-anchor="middle" x="3686.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 4 Up Proj</text>
<text text-anchor="middle" x="3686.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3686.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3686.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_expert_4&#45;&gt;layer_0_expert_4_up_proj -->
<g id="edge42" class="edge">
<title>layer_0_expert_4&#45;&gt;layer_0_expert_4_up_proj</title>
<path fill="none" stroke="black" d="M3686.5,-6187.62C3686.5,-6179.52 3686.5,-6170.72 3686.5,-6162.21"/>
<polygon fill="black" stroke="black" points="3690,-6162.04 3686.5,-6152.04 3683,-6162.04 3690,-6162.04"/>
</g>
<!-- layer_0_expert_4_activation -->
<g id="node33" class="node">
<title>layer_0_expert_4_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="3872,-6047.74 3501,-6047.74 3501,-5979.74 3872,-5979.74 3872,-6047.74"/>
<text text-anchor="middle" x="3686.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 4 GELU Activation</text>
<text text-anchor="middle" x="3686.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3686.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3686.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_expert_4_gate_proj&#45;&gt;layer_0_expert_4_activation -->
<g id="edge41" class="edge">
<title>layer_0_expert_4_gate_proj&#45;&gt;layer_0_expert_4_activation</title>
<path fill="none" stroke="black" d="M3423.53,-6083.69C3464.1,-6073.05 3509.24,-6061.22 3550.49,-6050.4"/>
<polygon fill="black" stroke="black" points="3551.55,-6053.74 3560.34,-6047.82 3549.78,-6046.97 3551.55,-6053.74"/>
</g>
<!-- layer_0_expert_4_up_proj&#45;&gt;layer_0_expert_4_activation -->
<g id="edge43" class="edge">
<title>layer_0_expert_4_up_proj&#45;&gt;layer_0_expert_4_activation</title>
<path fill="none" stroke="black" d="M3686.5,-6083.62C3686.5,-6075.52 3686.5,-6066.72 3686.5,-6058.21"/>
<polygon fill="black" stroke="black" points="3690,-6058.04 3686.5,-6048.04 3683,-6058.04 3690,-6058.04"/>
</g>
<!-- layer_0_expert_4_down_proj -->
<g id="node34" class="node">
<title>layer_0_expert_4_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="5240,-5943.74 4869,-5943.74 4869,-5875.74 5240,-5875.74 5240,-5943.74"/>
<text text-anchor="middle" x="5054.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 4 Down Proj</text>
<text text-anchor="middle" x="5054.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5054.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5054.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_0_expert_4_activation&#45;&gt;layer_0_expert_4_down_proj -->
<g id="edge44" class="edge">
<title>layer_0_expert_4_activation&#45;&gt;layer_0_expert_4_down_proj</title>
<path fill="none" stroke="black" d="M3872.42,-6000.43C4069.39,-5987.2 4389.45,-5965.18 4665.5,-5943.74 4728.23,-5938.87 4796.62,-5933.19 4858.31,-5927.93"/>
<polygon fill="black" stroke="black" points="4858.88,-5931.4 4868.55,-5927.06 4858.29,-5924.42 4858.88,-5931.4"/>
</g>
<!-- layer_0_expert_4_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge45" class="edge">
<title>layer_0_expert_4_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M5240.28,-5886.5C5275.21,-5882.65 5311.45,-5878.88 5345.5,-5875.74 5711.07,-5842.02 6129.49,-5813.3 6422.04,-5794.83"/>
<polygon fill="black" stroke="black" points="6422.63,-5798.3 6432.39,-5794.17 6422.19,-5791.31 6422.63,-5798.3"/>
</g>
<!-- layer_0_expert_5_gate_proj -->
<g id="node36" class="node">
<title>layer_0_expert_5_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="4261,-6151.74 3890,-6151.74 3890,-6083.74 4261,-6083.74 4261,-6151.74"/>
<text text-anchor="middle" x="4075.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 5 Gate Proj</text>
<text text-anchor="middle" x="4075.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="4075.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="4075.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_expert_5&#45;&gt;layer_0_expert_5_gate_proj -->
<g id="edge47" class="edge">
<title>layer_0_expert_5&#45;&gt;layer_0_expert_5_gate_proj</title>
<path fill="none" stroke="black" d="M4338.47,-6187.69C4297.9,-6177.05 4252.76,-6165.22 4211.51,-6154.4"/>
<polygon fill="black" stroke="black" points="4212.22,-6150.97 4201.66,-6151.82 4210.45,-6157.74 4212.22,-6150.97"/>
</g>
<!-- layer_0_expert_5_up_proj -->
<g id="node37" class="node">
<title>layer_0_expert_5_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="4650,-6151.74 4279,-6151.74 4279,-6083.74 4650,-6083.74 4650,-6151.74"/>
<text text-anchor="middle" x="4464.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 5 Up Proj</text>
<text text-anchor="middle" x="4464.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="4464.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="4464.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_expert_5&#45;&gt;layer_0_expert_5_up_proj -->
<g id="edge49" class="edge">
<title>layer_0_expert_5&#45;&gt;layer_0_expert_5_up_proj</title>
<path fill="none" stroke="black" d="M4464.5,-6187.62C4464.5,-6179.52 4464.5,-6170.72 4464.5,-6162.21"/>
<polygon fill="black" stroke="black" points="4468,-6162.04 4464.5,-6152.04 4461,-6162.04 4468,-6162.04"/>
</g>
<!-- layer_0_expert_5_activation -->
<g id="node38" class="node">
<title>layer_0_expert_5_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="4650,-6047.74 4279,-6047.74 4279,-5979.74 4650,-5979.74 4650,-6047.74"/>
<text text-anchor="middle" x="4464.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 5 GELU Activation</text>
<text text-anchor="middle" x="4464.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="4464.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="4464.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_expert_5_gate_proj&#45;&gt;layer_0_expert_5_activation -->
<g id="edge48" class="edge">
<title>layer_0_expert_5_gate_proj&#45;&gt;layer_0_expert_5_activation</title>
<path fill="none" stroke="black" d="M4201.53,-6083.69C4242.1,-6073.05 4287.24,-6061.22 4328.49,-6050.4"/>
<polygon fill="black" stroke="black" points="4329.55,-6053.74 4338.34,-6047.82 4327.78,-6046.97 4329.55,-6053.74"/>
</g>
<!-- layer_0_expert_5_up_proj&#45;&gt;layer_0_expert_5_activation -->
<g id="edge50" class="edge">
<title>layer_0_expert_5_up_proj&#45;&gt;layer_0_expert_5_activation</title>
<path fill="none" stroke="black" d="M4464.5,-6083.62C4464.5,-6075.52 4464.5,-6066.72 4464.5,-6058.21"/>
<polygon fill="black" stroke="black" points="4468,-6058.04 4464.5,-6048.04 4461,-6058.04 4468,-6058.04"/>
</g>
<!-- layer_0_expert_5_down_proj -->
<g id="node39" class="node">
<title>layer_0_expert_5_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="5726,-5943.74 5355,-5943.74 5355,-5875.74 5726,-5875.74 5726,-5943.74"/>
<text text-anchor="middle" x="5540.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 5 Down Proj</text>
<text text-anchor="middle" x="5540.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5540.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5540.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_0_expert_5_activation&#45;&gt;layer_0_expert_5_down_proj -->
<g id="edge51" class="edge">
<title>layer_0_expert_5_activation&#45;&gt;layer_0_expert_5_down_proj</title>
<path fill="none" stroke="black" d="M4650.35,-5997.69C4809.29,-5984.5 5044.06,-5964.29 5248.5,-5943.74 5279.67,-5940.61 5312.68,-5937.08 5344.86,-5933.53"/>
<polygon fill="black" stroke="black" points="5345.27,-5937 5354.82,-5932.42 5344.49,-5930.05 5345.27,-5937"/>
</g>
<!-- layer_0_expert_5_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge52" class="edge">
<title>layer_0_expert_5_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M5726.16,-5882.88C5745.51,-5880.38 5764.9,-5877.95 5783.5,-5875.74 6000.69,-5849.91 6244.67,-5824.9 6438.3,-5805.99"/>
<polygon fill="black" stroke="black" points="6438.74,-5809.47 6448.36,-5805.01 6438.06,-5802.5 6438.74,-5809.47"/>
</g>
<!-- layer_0_expert_6_gate_proj -->
<g id="node41" class="node">
<title>layer_0_expert_6_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="5039,-6151.74 4668,-6151.74 4668,-6083.74 5039,-6083.74 5039,-6151.74"/>
<text text-anchor="middle" x="4853.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 6 Gate Proj</text>
<text text-anchor="middle" x="4853.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="4853.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="4853.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_expert_6&#45;&gt;layer_0_expert_6_gate_proj -->
<g id="edge54" class="edge">
<title>layer_0_expert_6&#45;&gt;layer_0_expert_6_gate_proj</title>
<path fill="none" stroke="black" d="M5116.47,-6187.69C5075.9,-6177.05 5030.76,-6165.22 4989.51,-6154.4"/>
<polygon fill="black" stroke="black" points="4990.22,-6150.97 4979.66,-6151.82 4988.45,-6157.74 4990.22,-6150.97"/>
</g>
<!-- layer_0_expert_6_up_proj -->
<g id="node42" class="node">
<title>layer_0_expert_6_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="5428,-6151.74 5057,-6151.74 5057,-6083.74 5428,-6083.74 5428,-6151.74"/>
<text text-anchor="middle" x="5242.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 6 Up Proj</text>
<text text-anchor="middle" x="5242.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5242.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5242.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_expert_6&#45;&gt;layer_0_expert_6_up_proj -->
<g id="edge56" class="edge">
<title>layer_0_expert_6&#45;&gt;layer_0_expert_6_up_proj</title>
<path fill="none" stroke="black" d="M5242.5,-6187.62C5242.5,-6179.52 5242.5,-6170.72 5242.5,-6162.21"/>
<polygon fill="black" stroke="black" points="5246,-6162.04 5242.5,-6152.04 5239,-6162.04 5246,-6162.04"/>
</g>
<!-- layer_0_expert_6_activation -->
<g id="node43" class="node">
<title>layer_0_expert_6_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="5428,-6047.74 5057,-6047.74 5057,-5979.74 5428,-5979.74 5428,-6047.74"/>
<text text-anchor="middle" x="5242.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 6 GELU Activation</text>
<text text-anchor="middle" x="5242.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5242.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5242.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_expert_6_gate_proj&#45;&gt;layer_0_expert_6_activation -->
<g id="edge55" class="edge">
<title>layer_0_expert_6_gate_proj&#45;&gt;layer_0_expert_6_activation</title>
<path fill="none" stroke="black" d="M4979.53,-6083.69C5020.1,-6073.05 5065.24,-6061.22 5106.49,-6050.4"/>
<polygon fill="black" stroke="black" points="5107.55,-6053.74 5116.34,-6047.82 5105.78,-6046.97 5107.55,-6053.74"/>
</g>
<!-- layer_0_expert_6_up_proj&#45;&gt;layer_0_expert_6_activation -->
<g id="edge57" class="edge">
<title>layer_0_expert_6_up_proj&#45;&gt;layer_0_expert_6_activation</title>
<path fill="none" stroke="black" d="M5242.5,-6083.62C5242.5,-6075.52 5242.5,-6066.72 5242.5,-6058.21"/>
<polygon fill="black" stroke="black" points="5246,-6058.04 5242.5,-6048.04 5239,-6058.04 5246,-6058.04"/>
</g>
<!-- layer_0_expert_6_down_proj -->
<g id="node44" class="node">
<title>layer_0_expert_6_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6164,-5943.74 5793,-5943.74 5793,-5875.74 6164,-5875.74 6164,-5943.74"/>
<text text-anchor="middle" x="5978.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 6 Down Proj</text>
<text text-anchor="middle" x="5978.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5978.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5978.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_0_expert_6_activation&#45;&gt;layer_0_expert_6_down_proj -->
<g id="edge58" class="edge">
<title>layer_0_expert_6_activation&#45;&gt;layer_0_expert_6_down_proj</title>
<path fill="none" stroke="black" d="M5428.22,-5987C5536.42,-5972.01 5672.74,-5953.12 5782.62,-5937.89"/>
<polygon fill="black" stroke="black" points="5783.41,-5941.31 5792.84,-5936.47 5782.45,-5934.38 5783.41,-5941.31"/>
</g>
<!-- layer_0_expert_6_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge59" class="edge">
<title>layer_0_expert_6_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M6164.23,-5877.71C6254.23,-5862.67 6364.98,-5844.17 6468.29,-5826.91"/>
<polygon fill="black" stroke="black" points="6468.98,-5830.34 6478.26,-5825.24 6467.82,-5823.44 6468.98,-5830.34"/>
</g>
<!-- layer_0_expert_7_gate_proj -->
<g id="node46" class="node">
<title>layer_0_expert_7_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="5817,-6151.74 5446,-6151.74 5446,-6083.74 5817,-6083.74 5817,-6151.74"/>
<text text-anchor="middle" x="5631.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 7 Gate Proj</text>
<text text-anchor="middle" x="5631.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5631.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5631.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_expert_7&#45;&gt;layer_0_expert_7_gate_proj -->
<g id="edge61" class="edge">
<title>layer_0_expert_7&#45;&gt;layer_0_expert_7_gate_proj</title>
<path fill="none" stroke="black" d="M5894.47,-6187.69C5853.9,-6177.05 5808.76,-6165.22 5767.51,-6154.4"/>
<polygon fill="black" stroke="black" points="5768.22,-6150.97 5757.66,-6151.82 5766.45,-6157.74 5768.22,-6150.97"/>
</g>
<!-- layer_0_expert_7_up_proj -->
<g id="node47" class="node">
<title>layer_0_expert_7_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6206,-6151.74 5835,-6151.74 5835,-6083.74 6206,-6083.74 6206,-6151.74"/>
<text text-anchor="middle" x="6020.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 7 Up Proj</text>
<text text-anchor="middle" x="6020.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6020.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6020.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_expert_7&#45;&gt;layer_0_expert_7_up_proj -->
<g id="edge63" class="edge">
<title>layer_0_expert_7&#45;&gt;layer_0_expert_7_up_proj</title>
<path fill="none" stroke="black" d="M6020.5,-6187.62C6020.5,-6179.52 6020.5,-6170.72 6020.5,-6162.21"/>
<polygon fill="black" stroke="black" points="6024,-6162.04 6020.5,-6152.04 6017,-6162.04 6024,-6162.04"/>
</g>
<!-- layer_0_expert_7_activation -->
<g id="node48" class="node">
<title>layer_0_expert_7_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="6206,-6047.74 5835,-6047.74 5835,-5979.74 6206,-5979.74 6206,-6047.74"/>
<text text-anchor="middle" x="6020.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 7 GELU Activation</text>
<text text-anchor="middle" x="6020.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6020.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6020.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_expert_7_gate_proj&#45;&gt;layer_0_expert_7_activation -->
<g id="edge62" class="edge">
<title>layer_0_expert_7_gate_proj&#45;&gt;layer_0_expert_7_activation</title>
<path fill="none" stroke="black" d="M5757.53,-6083.69C5798.1,-6073.05 5843.24,-6061.22 5884.49,-6050.4"/>
<polygon fill="black" stroke="black" points="5885.55,-6053.74 5894.34,-6047.82 5883.78,-6046.97 5885.55,-6053.74"/>
</g>
<!-- layer_0_expert_7_up_proj&#45;&gt;layer_0_expert_7_activation -->
<g id="edge64" class="edge">
<title>layer_0_expert_7_up_proj&#45;&gt;layer_0_expert_7_activation</title>
<path fill="none" stroke="black" d="M6020.5,-6083.62C6020.5,-6075.52 6020.5,-6066.72 6020.5,-6058.21"/>
<polygon fill="black" stroke="black" points="6024,-6058.04 6020.5,-6048.04 6017,-6058.04 6024,-6058.04"/>
</g>
<!-- layer_0_expert_7_down_proj -->
<g id="node49" class="node">
<title>layer_0_expert_7_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6577,-5943.74 6206,-5943.74 6206,-5875.74 6577,-5875.74 6577,-5943.74"/>
<text text-anchor="middle" x="6391.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 7 Down Proj</text>
<text text-anchor="middle" x="6391.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6391.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6391.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_0_expert_7_activation&#45;&gt;layer_0_expert_7_down_proj -->
<g id="edge65" class="edge">
<title>layer_0_expert_7_activation&#45;&gt;layer_0_expert_7_down_proj</title>
<path fill="none" stroke="black" d="M6140.7,-5979.69C6179.23,-5969.1 6222.07,-5957.32 6261.29,-5946.54"/>
<polygon fill="black" stroke="black" points="6262.46,-5949.85 6271.18,-5943.82 6260.61,-5943.1 6262.46,-5949.85"/>
</g>
<!-- layer_0_expert_7_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge66" class="edge">
<title>layer_0_expert_7_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M6488.83,-5875.73C6518.17,-5865.78 6551.57,-5854.45 6585.23,-5843.04"/>
<polygon fill="black" stroke="black" points="6586.38,-5846.34 6594.72,-5839.82 6584.13,-5839.71 6586.38,-5846.34"/>
</g>
<!-- layer_0_expert_8_gate_proj -->
<g id="node51" class="node">
<title>layer_0_expert_8_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6595,-6151.74 6224,-6151.74 6224,-6083.74 6595,-6083.74 6595,-6151.74"/>
<text text-anchor="middle" x="6409.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 8 Gate Proj</text>
<text text-anchor="middle" x="6409.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6409.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6409.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_expert_8&#45;&gt;layer_0_expert_8_gate_proj -->
<g id="edge68" class="edge">
<title>layer_0_expert_8&#45;&gt;layer_0_expert_8_gate_proj</title>
<path fill="none" stroke="black" d="M6540.51,-6187.62C6521.7,-6177.73 6500.93,-6166.81 6481.58,-6156.64"/>
<polygon fill="black" stroke="black" points="6482.98,-6153.42 6472.5,-6151.86 6479.72,-6159.62 6482.98,-6153.42"/>
</g>
<!-- layer_0_expert_8_up_proj -->
<g id="node52" class="node">
<title>layer_0_expert_8_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6984,-6151.74 6613,-6151.74 6613,-6083.74 6984,-6083.74 6984,-6151.74"/>
<text text-anchor="middle" x="6798.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 8 Up Proj</text>
<text text-anchor="middle" x="6798.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6798.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6798.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_expert_8&#45;&gt;layer_0_expert_8_up_proj -->
<g id="edge70" class="edge">
<title>layer_0_expert_8&#45;&gt;layer_0_expert_8_up_proj</title>
<path fill="none" stroke="black" d="M6666.81,-6187.62C6685.72,-6177.73 6706.6,-6166.81 6726.05,-6156.64"/>
<polygon fill="black" stroke="black" points="6727.93,-6159.6 6735.17,-6151.86 6724.69,-6153.4 6727.93,-6159.6"/>
</g>
<!-- layer_0_expert_8_activation -->
<g id="node53" class="node">
<title>layer_0_expert_8_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="6978,-6047.74 6607,-6047.74 6607,-5979.74 6978,-5979.74 6978,-6047.74"/>
<text text-anchor="middle" x="6792.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 8 GELU Activation</text>
<text text-anchor="middle" x="6792.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6792.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6792.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_expert_8_gate_proj&#45;&gt;layer_0_expert_8_activation -->
<g id="edge69" class="edge">
<title>layer_0_expert_8_gate_proj&#45;&gt;layer_0_expert_8_activation</title>
<path fill="none" stroke="black" d="M6533.58,-6083.69C6573.53,-6073.05 6617.97,-6061.22 6658.59,-6050.4"/>
<polygon fill="black" stroke="black" points="6659.52,-6053.78 6668.28,-6047.82 6657.72,-6047.01 6659.52,-6053.78"/>
</g>
<!-- layer_0_expert_8_up_proj&#45;&gt;layer_0_expert_8_activation -->
<g id="edge71" class="edge">
<title>layer_0_expert_8_up_proj&#45;&gt;layer_0_expert_8_activation</title>
<path fill="none" stroke="black" d="M6796.55,-6083.62C6796.08,-6075.52 6795.56,-6066.72 6795.06,-6058.21"/>
<polygon fill="black" stroke="black" points="6798.54,-6057.82 6794.46,-6048.04 6791.55,-6058.23 6798.54,-6057.82"/>
</g>
<!-- layer_0_expert_8_down_proj -->
<g id="node54" class="node">
<title>layer_0_expert_8_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6978,-5943.74 6607,-5943.74 6607,-5875.74 6978,-5875.74 6978,-5943.74"/>
<text text-anchor="middle" x="6792.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 8 Down Proj</text>
<text text-anchor="middle" x="6792.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6792.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6792.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_0_expert_8_activation&#45;&gt;layer_0_expert_8_down_proj -->
<g id="edge72" class="edge">
<title>layer_0_expert_8_activation&#45;&gt;layer_0_expert_8_down_proj</title>
<path fill="none" stroke="black" d="M6792.5,-5979.62C6792.5,-5971.52 6792.5,-5962.72 6792.5,-5954.21"/>
<polygon fill="black" stroke="black" points="6796,-5954.04 6792.5,-5944.04 6789,-5954.04 6796,-5954.04"/>
</g>
<!-- layer_0_expert_8_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge73" class="edge">
<title>layer_0_expert_8_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M6792.5,-5875.47C6792.5,-5867.64 6792.5,-5858.98 6792.5,-5850.09"/>
<polygon fill="black" stroke="black" points="6796,-5850 6792.5,-5840 6789,-5850 6796,-5850"/>
</g>
<!-- layer_0_expert_9_gate_proj -->
<g id="node56" class="node">
<title>layer_0_expert_9_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7373,-6151.74 7002,-6151.74 7002,-6083.74 7373,-6083.74 7373,-6151.74"/>
<text text-anchor="middle" x="7187.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 9 Gate Proj</text>
<text text-anchor="middle" x="7187.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7187.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7187.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_expert_9&#45;&gt;layer_0_expert_9_gate_proj -->
<g id="edge75" class="edge">
<title>layer_0_expert_9&#45;&gt;layer_0_expert_9_gate_proj</title>
<path fill="none" stroke="black" d="M7187.5,-6187.62C7187.5,-6179.52 7187.5,-6170.72 7187.5,-6162.21"/>
<polygon fill="black" stroke="black" points="7191,-6162.04 7187.5,-6152.04 7184,-6162.04 7191,-6162.04"/>
</g>
<!-- layer_0_expert_9_up_proj -->
<g id="node57" class="node">
<title>layer_0_expert_9_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7762,-6151.74 7391,-6151.74 7391,-6083.74 7762,-6083.74 7762,-6151.74"/>
<text text-anchor="middle" x="7576.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 9 Up Proj</text>
<text text-anchor="middle" x="7576.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7576.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7576.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_expert_9&#45;&gt;layer_0_expert_9_up_proj -->
<g id="edge77" class="edge">
<title>layer_0_expert_9&#45;&gt;layer_0_expert_9_up_proj</title>
<path fill="none" stroke="black" d="M7313.53,-6187.69C7354.1,-6177.05 7399.24,-6165.22 7440.49,-6154.4"/>
<polygon fill="black" stroke="black" points="7441.55,-6157.74 7450.34,-6151.82 7439.78,-6150.97 7441.55,-6157.74"/>
</g>
<!-- layer_0_expert_9_activation -->
<g id="node58" class="node">
<title>layer_0_expert_9_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="7373,-6047.74 7002,-6047.74 7002,-5979.74 7373,-5979.74 7373,-6047.74"/>
<text text-anchor="middle" x="7187.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 9 GELU Activation</text>
<text text-anchor="middle" x="7187.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7187.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7187.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_expert_9_gate_proj&#45;&gt;layer_0_expert_9_activation -->
<g id="edge76" class="edge">
<title>layer_0_expert_9_gate_proj&#45;&gt;layer_0_expert_9_activation</title>
<path fill="none" stroke="black" d="M7187.5,-6083.62C7187.5,-6075.52 7187.5,-6066.72 7187.5,-6058.21"/>
<polygon fill="black" stroke="black" points="7191,-6058.04 7187.5,-6048.04 7184,-6058.04 7191,-6058.04"/>
</g>
<!-- layer_0_expert_9_up_proj&#45;&gt;layer_0_expert_9_activation -->
<g id="edge78" class="edge">
<title>layer_0_expert_9_up_proj&#45;&gt;layer_0_expert_9_activation</title>
<path fill="none" stroke="black" d="M7450.47,-6083.69C7409.9,-6073.05 7364.76,-6061.22 7323.51,-6050.4"/>
<polygon fill="black" stroke="black" points="7324.22,-6046.97 7313.66,-6047.82 7322.45,-6053.74 7324.22,-6046.97"/>
</g>
<!-- layer_0_expert_9_down_proj -->
<g id="node59" class="node">
<title>layer_0_expert_9_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7367,-5943.74 6996,-5943.74 6996,-5875.74 7367,-5875.74 7367,-5943.74"/>
<text text-anchor="middle" x="7181.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 9 Down Proj</text>
<text text-anchor="middle" x="7181.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7181.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7181.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_0_expert_9_activation&#45;&gt;layer_0_expert_9_down_proj -->
<g id="edge79" class="edge">
<title>layer_0_expert_9_activation&#45;&gt;layer_0_expert_9_down_proj</title>
<path fill="none" stroke="black" d="M7185.55,-5979.62C7185.08,-5971.52 7184.56,-5962.72 7184.06,-5954.21"/>
<polygon fill="black" stroke="black" points="7187.54,-5953.82 7183.46,-5944.04 7180.55,-5954.23 7187.54,-5953.82"/>
</g>
<!-- layer_0_expert_9_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge80" class="edge">
<title>layer_0_expert_9_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M7086.84,-5875.64C7058.49,-5865.73 7026.26,-5854.46 6993.77,-5843.11"/>
<polygon fill="black" stroke="black" points="6994.74,-5839.74 6984.15,-5839.74 6992.43,-5846.35 6994.74,-5839.74"/>
</g>
<!-- layer_0_expert_10_gate_proj -->
<g id="node61" class="node">
<title>layer_0_expert_10_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8151,-6151.74 7780,-6151.74 7780,-6083.74 8151,-6083.74 8151,-6151.74"/>
<text text-anchor="middle" x="7965.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 10 Gate Proj</text>
<text text-anchor="middle" x="7965.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7965.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7965.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_expert_10&#45;&gt;layer_0_expert_10_gate_proj -->
<g id="edge82" class="edge">
<title>layer_0_expert_10&#45;&gt;layer_0_expert_10_gate_proj</title>
<path fill="none" stroke="black" d="M7965.5,-6187.62C7965.5,-6179.52 7965.5,-6170.72 7965.5,-6162.21"/>
<polygon fill="black" stroke="black" points="7969,-6162.04 7965.5,-6152.04 7962,-6162.04 7969,-6162.04"/>
</g>
<!-- layer_0_expert_10_up_proj -->
<g id="node62" class="node">
<title>layer_0_expert_10_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8540,-6151.74 8169,-6151.74 8169,-6083.74 8540,-6083.74 8540,-6151.74"/>
<text text-anchor="middle" x="8354.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 10 Up Proj</text>
<text text-anchor="middle" x="8354.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8354.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8354.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_expert_10&#45;&gt;layer_0_expert_10_up_proj -->
<g id="edge84" class="edge">
<title>layer_0_expert_10&#45;&gt;layer_0_expert_10_up_proj</title>
<path fill="none" stroke="black" d="M8091.53,-6187.69C8132.1,-6177.05 8177.24,-6165.22 8218.49,-6154.4"/>
<polygon fill="black" stroke="black" points="8219.55,-6157.74 8228.34,-6151.82 8217.78,-6150.97 8219.55,-6157.74"/>
</g>
<!-- layer_0_expert_10_activation -->
<g id="node63" class="node">
<title>layer_0_expert_10_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="8151,-6047.74 7780,-6047.74 7780,-5979.74 8151,-5979.74 8151,-6047.74"/>
<text text-anchor="middle" x="7965.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 10 GELU Activation</text>
<text text-anchor="middle" x="7965.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7965.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7965.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_expert_10_gate_proj&#45;&gt;layer_0_expert_10_activation -->
<g id="edge83" class="edge">
<title>layer_0_expert_10_gate_proj&#45;&gt;layer_0_expert_10_activation</title>
<path fill="none" stroke="black" d="M7965.5,-6083.62C7965.5,-6075.52 7965.5,-6066.72 7965.5,-6058.21"/>
<polygon fill="black" stroke="black" points="7969,-6058.04 7965.5,-6048.04 7962,-6058.04 7969,-6058.04"/>
</g>
<!-- layer_0_expert_10_up_proj&#45;&gt;layer_0_expert_10_activation -->
<g id="edge85" class="edge">
<title>layer_0_expert_10_up_proj&#45;&gt;layer_0_expert_10_activation</title>
<path fill="none" stroke="black" d="M8228.47,-6083.69C8187.9,-6073.05 8142.76,-6061.22 8101.51,-6050.4"/>
<polygon fill="black" stroke="black" points="8102.22,-6046.97 8091.66,-6047.82 8100.45,-6053.74 8102.22,-6046.97"/>
</g>
<!-- layer_0_expert_10_down_proj -->
<g id="node64" class="node">
<title>layer_0_expert_10_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7954,-5943.74 7583,-5943.74 7583,-5875.74 7954,-5875.74 7954,-5943.74"/>
<text text-anchor="middle" x="7768.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 10 Down Proj</text>
<text text-anchor="middle" x="7768.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7768.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7768.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_0_expert_10_activation&#45;&gt;layer_0_expert_10_down_proj -->
<g id="edge86" class="edge">
<title>layer_0_expert_10_activation&#45;&gt;layer_0_expert_10_down_proj</title>
<path fill="none" stroke="black" d="M7901.54,-5979.62C7882.35,-5969.69 7861.15,-5958.71 7841.42,-5948.5"/>
<polygon fill="black" stroke="black" points="7842.97,-5945.35 7832.48,-5943.86 7839.75,-5951.57 7842.97,-5945.35"/>
</g>
<!-- layer_0_expert_10_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge87" class="edge">
<title>layer_0_expert_10_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M7582.91,-5882.88C7496.91,-5870.9 7390.23,-5856.03 7283.37,-5841.14"/>
<polygon fill="black" stroke="black" points="7283.75,-5837.66 7273.36,-5839.75 7282.78,-5844.59 7283.75,-5837.66"/>
</g>
<!-- layer_0_expert_11_gate_proj -->
<g id="node66" class="node">
<title>layer_0_expert_11_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8929,-6151.74 8558,-6151.74 8558,-6083.74 8929,-6083.74 8929,-6151.74"/>
<text text-anchor="middle" x="8743.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 11 Gate Proj</text>
<text text-anchor="middle" x="8743.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8743.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8743.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_expert_11&#45;&gt;layer_0_expert_11_gate_proj -->
<g id="edge89" class="edge">
<title>layer_0_expert_11&#45;&gt;layer_0_expert_11_gate_proj</title>
<path fill="none" stroke="black" d="M8743.5,-6187.62C8743.5,-6179.52 8743.5,-6170.72 8743.5,-6162.21"/>
<polygon fill="black" stroke="black" points="8747,-6162.04 8743.5,-6152.04 8740,-6162.04 8747,-6162.04"/>
</g>
<!-- layer_0_expert_11_up_proj -->
<g id="node67" class="node">
<title>layer_0_expert_11_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9318,-6151.74 8947,-6151.74 8947,-6083.74 9318,-6083.74 9318,-6151.74"/>
<text text-anchor="middle" x="9132.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 11 Up Proj</text>
<text text-anchor="middle" x="9132.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9132.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9132.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_expert_11&#45;&gt;layer_0_expert_11_up_proj -->
<g id="edge91" class="edge">
<title>layer_0_expert_11&#45;&gt;layer_0_expert_11_up_proj</title>
<path fill="none" stroke="black" d="M8869.53,-6187.69C8910.1,-6177.05 8955.24,-6165.22 8996.49,-6154.4"/>
<polygon fill="black" stroke="black" points="8997.55,-6157.74 9006.34,-6151.82 8995.78,-6150.97 8997.55,-6157.74"/>
</g>
<!-- layer_0_expert_11_activation -->
<g id="node68" class="node">
<title>layer_0_expert_11_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="8929,-6047.74 8558,-6047.74 8558,-5979.74 8929,-5979.74 8929,-6047.74"/>
<text text-anchor="middle" x="8743.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 11 GELU Activation</text>
<text text-anchor="middle" x="8743.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8743.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8743.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_expert_11_gate_proj&#45;&gt;layer_0_expert_11_activation -->
<g id="edge90" class="edge">
<title>layer_0_expert_11_gate_proj&#45;&gt;layer_0_expert_11_activation</title>
<path fill="none" stroke="black" d="M8743.5,-6083.62C8743.5,-6075.52 8743.5,-6066.72 8743.5,-6058.21"/>
<polygon fill="black" stroke="black" points="8747,-6058.04 8743.5,-6048.04 8740,-6058.04 8747,-6058.04"/>
</g>
<!-- layer_0_expert_11_up_proj&#45;&gt;layer_0_expert_11_activation -->
<g id="edge92" class="edge">
<title>layer_0_expert_11_up_proj&#45;&gt;layer_0_expert_11_activation</title>
<path fill="none" stroke="black" d="M9006.47,-6083.69C8965.9,-6073.05 8920.76,-6061.22 8879.51,-6050.4"/>
<polygon fill="black" stroke="black" points="8880.22,-6046.97 8869.66,-6047.82 8878.45,-6053.74 8880.22,-6046.97"/>
</g>
<!-- layer_0_expert_11_down_proj -->
<g id="node69" class="node">
<title>layer_0_expert_11_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8636,-5943.74 8265,-5943.74 8265,-5875.74 8636,-5875.74 8636,-5943.74"/>
<text text-anchor="middle" x="8450.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 11 Down Proj</text>
<text text-anchor="middle" x="8450.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8450.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8450.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_0_expert_11_activation&#45;&gt;layer_0_expert_11_down_proj -->
<g id="edge93" class="edge">
<title>layer_0_expert_11_activation&#45;&gt;layer_0_expert_11_down_proj</title>
<path fill="none" stroke="black" d="M8648.37,-5979.62C8618.59,-5969.26 8585.57,-5957.76 8555.17,-5947.18"/>
<polygon fill="black" stroke="black" points="8556,-5943.76 8545.4,-5943.78 8553.7,-5950.37 8556,-5943.76"/>
</g>
<!-- layer_0_expert_11_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge94" class="edge">
<title>layer_0_expert_11_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M8264.73,-5893.5C8021.53,-5873.55 7586.92,-5837.9 7252.73,-5810.49"/>
<polygon fill="black" stroke="black" points="7252.63,-5806.97 7242.37,-5809.64 7252.05,-5813.95 7252.63,-5806.97"/>
</g>
<!-- layer_0_expert_12_gate_proj -->
<g id="node71" class="node">
<title>layer_0_expert_12_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9707,-6151.74 9336,-6151.74 9336,-6083.74 9707,-6083.74 9707,-6151.74"/>
<text text-anchor="middle" x="9521.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 12 Gate Proj</text>
<text text-anchor="middle" x="9521.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9521.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9521.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_expert_12&#45;&gt;layer_0_expert_12_gate_proj -->
<g id="edge96" class="edge">
<title>layer_0_expert_12&#45;&gt;layer_0_expert_12_gate_proj</title>
<path fill="none" stroke="black" d="M9521.5,-6187.62C9521.5,-6179.52 9521.5,-6170.72 9521.5,-6162.21"/>
<polygon fill="black" stroke="black" points="9525,-6162.04 9521.5,-6152.04 9518,-6162.04 9525,-6162.04"/>
</g>
<!-- layer_0_expert_12_up_proj -->
<g id="node72" class="node">
<title>layer_0_expert_12_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10096,-6151.74 9725,-6151.74 9725,-6083.74 10096,-6083.74 10096,-6151.74"/>
<text text-anchor="middle" x="9910.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 12 Up Proj</text>
<text text-anchor="middle" x="9910.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9910.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9910.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_expert_12&#45;&gt;layer_0_expert_12_up_proj -->
<g id="edge98" class="edge">
<title>layer_0_expert_12&#45;&gt;layer_0_expert_12_up_proj</title>
<path fill="none" stroke="black" d="M9647.53,-6187.69C9688.1,-6177.05 9733.24,-6165.22 9774.49,-6154.4"/>
<polygon fill="black" stroke="black" points="9775.55,-6157.74 9784.34,-6151.82 9773.78,-6150.97 9775.55,-6157.74"/>
</g>
<!-- layer_0_expert_12_activation -->
<g id="node73" class="node">
<title>layer_0_expert_12_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="9707,-6047.74 9336,-6047.74 9336,-5979.74 9707,-5979.74 9707,-6047.74"/>
<text text-anchor="middle" x="9521.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 12 GELU Activation</text>
<text text-anchor="middle" x="9521.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9521.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9521.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_expert_12_gate_proj&#45;&gt;layer_0_expert_12_activation -->
<g id="edge97" class="edge">
<title>layer_0_expert_12_gate_proj&#45;&gt;layer_0_expert_12_activation</title>
<path fill="none" stroke="black" d="M9521.5,-6083.62C9521.5,-6075.52 9521.5,-6066.72 9521.5,-6058.21"/>
<polygon fill="black" stroke="black" points="9525,-6058.04 9521.5,-6048.04 9518,-6058.04 9525,-6058.04"/>
</g>
<!-- layer_0_expert_12_up_proj&#45;&gt;layer_0_expert_12_activation -->
<g id="edge99" class="edge">
<title>layer_0_expert_12_up_proj&#45;&gt;layer_0_expert_12_activation</title>
<path fill="none" stroke="black" d="M9784.47,-6083.69C9743.9,-6073.05 9698.76,-6061.22 9657.51,-6050.4"/>
<polygon fill="black" stroke="black" points="9658.22,-6046.97 9647.66,-6047.82 9656.45,-6053.74 9658.22,-6046.97"/>
</g>
<!-- layer_0_expert_12_down_proj -->
<g id="node74" class="node">
<title>layer_0_expert_12_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9366,-5943.74 8995,-5943.74 8995,-5875.74 9366,-5875.74 9366,-5943.74"/>
<text text-anchor="middle" x="9180.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 12 Down Proj</text>
<text text-anchor="middle" x="9180.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9180.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9180.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_0_expert_12_activation&#45;&gt;layer_0_expert_12_down_proj -->
<g id="edge100" class="edge">
<title>layer_0_expert_12_activation&#45;&gt;layer_0_expert_12_down_proj</title>
<path fill="none" stroke="black" d="M9410.79,-5979.62C9375.68,-5969.12 9336.7,-5957.46 9300.94,-5946.77"/>
<polygon fill="black" stroke="black" points="9301.53,-5943.29 9290.95,-5943.78 9299.53,-5950 9301.53,-5943.29"/>
</g>
<!-- layer_0_expert_12_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge101" class="edge">
<title>layer_0_expert_12_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M8994.82,-5897.01C8891.9,-5890.58 8761.62,-5882.55 8645.5,-5875.74 8162.21,-5847.4 7607.9,-5816.85 7232.42,-5796.44"/>
<polygon fill="black" stroke="black" points="7232.37,-5792.93 7222.2,-5795.88 7231.99,-5799.92 7232.37,-5792.93"/>
</g>
<!-- layer_0_expert_13_gate_proj -->
<g id="node76" class="node">
<title>layer_0_expert_13_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10485,-6151.74 10114,-6151.74 10114,-6083.74 10485,-6083.74 10485,-6151.74"/>
<text text-anchor="middle" x="10299.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 13 Gate Proj</text>
<text text-anchor="middle" x="10299.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10299.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10299.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_expert_13&#45;&gt;layer_0_expert_13_gate_proj -->
<g id="edge103" class="edge">
<title>layer_0_expert_13&#45;&gt;layer_0_expert_13_gate_proj</title>
<path fill="none" stroke="black" d="M10299.5,-6187.62C10299.5,-6179.52 10299.5,-6170.72 10299.5,-6162.21"/>
<polygon fill="black" stroke="black" points="10303,-6162.04 10299.5,-6152.04 10296,-6162.04 10303,-6162.04"/>
</g>
<!-- layer_0_expert_13_up_proj -->
<g id="node77" class="node">
<title>layer_0_expert_13_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10874,-6151.74 10503,-6151.74 10503,-6083.74 10874,-6083.74 10874,-6151.74"/>
<text text-anchor="middle" x="10688.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 13 Up Proj</text>
<text text-anchor="middle" x="10688.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10688.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10688.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_expert_13&#45;&gt;layer_0_expert_13_up_proj -->
<g id="edge105" class="edge">
<title>layer_0_expert_13&#45;&gt;layer_0_expert_13_up_proj</title>
<path fill="none" stroke="black" d="M10425.53,-6187.69C10466.1,-6177.05 10511.24,-6165.22 10552.49,-6154.4"/>
<polygon fill="black" stroke="black" points="10553.55,-6157.74 10562.34,-6151.82 10551.78,-6150.97 10553.55,-6157.74"/>
</g>
<!-- layer_0_expert_13_activation -->
<g id="node78" class="node">
<title>layer_0_expert_13_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="10485,-6047.74 10114,-6047.74 10114,-5979.74 10485,-5979.74 10485,-6047.74"/>
<text text-anchor="middle" x="10299.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 13 GELU Activation</text>
<text text-anchor="middle" x="10299.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10299.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10299.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_expert_13_gate_proj&#45;&gt;layer_0_expert_13_activation -->
<g id="edge104" class="edge">
<title>layer_0_expert_13_gate_proj&#45;&gt;layer_0_expert_13_activation</title>
<path fill="none" stroke="black" d="M10299.5,-6083.62C10299.5,-6075.52 10299.5,-6066.72 10299.5,-6058.21"/>
<polygon fill="black" stroke="black" points="10303,-6058.04 10299.5,-6048.04 10296,-6058.04 10303,-6058.04"/>
</g>
<!-- layer_0_expert_13_up_proj&#45;&gt;layer_0_expert_13_activation -->
<g id="edge106" class="edge">
<title>layer_0_expert_13_up_proj&#45;&gt;layer_0_expert_13_activation</title>
<path fill="none" stroke="black" d="M10562.47,-6083.69C10521.9,-6073.05 10476.76,-6061.22 10435.51,-6050.4"/>
<polygon fill="black" stroke="black" points="10436.22,-6046.97 10425.66,-6047.82 10434.45,-6053.74 10436.22,-6046.97"/>
</g>
<!-- layer_0_expert_13_down_proj -->
<g id="node79" class="node">
<title>layer_0_expert_13_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10120,-5943.74 9749,-5943.74 9749,-5875.74 10120,-5875.74 10120,-5943.74"/>
<text text-anchor="middle" x="9934.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 13 Down Proj</text>
<text text-anchor="middle" x="9934.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9934.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9934.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_0_expert_13_activation&#45;&gt;layer_0_expert_13_down_proj -->
<g id="edge107" class="edge">
<title>layer_0_expert_13_activation&#45;&gt;layer_0_expert_13_down_proj</title>
<path fill="none" stroke="black" d="M10181.25,-5979.69C10143.34,-5969.1 10101.19,-5957.32 10062.6,-5946.54"/>
<polygon fill="black" stroke="black" points="10063.45,-5943.14 10052.88,-5943.82 10061.57,-5949.88 10063.45,-5943.14"/>
</g>
<!-- layer_0_expert_13_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge108" class="edge">
<title>layer_0_expert_13_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M9748.85,-5896.89C9640.08,-5890.17 9500.03,-5881.9 9375.5,-5875.74 8616.28,-5838.2 7730.99,-5805.24 7218.81,-5787.24"/>
<polygon fill="black" stroke="black" points="7218.78,-5783.74 7208.66,-5786.89 7218.53,-5790.74 7218.78,-5783.74"/>
</g>
<!-- layer_0_expert_14_gate_proj -->
<g id="node81" class="node">
<title>layer_0_expert_14_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11263,-6151.74 10892,-6151.74 10892,-6083.74 11263,-6083.74 11263,-6151.74"/>
<text text-anchor="middle" x="11077.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 14 Gate Proj</text>
<text text-anchor="middle" x="11077.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11077.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11077.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_expert_14&#45;&gt;layer_0_expert_14_gate_proj -->
<g id="edge110" class="edge">
<title>layer_0_expert_14&#45;&gt;layer_0_expert_14_gate_proj</title>
<path fill="none" stroke="black" d="M11077.5,-6187.62C11077.5,-6179.52 11077.5,-6170.72 11077.5,-6162.21"/>
<polygon fill="black" stroke="black" points="11081,-6162.04 11077.5,-6152.04 11074,-6162.04 11081,-6162.04"/>
</g>
<!-- layer_0_expert_14_up_proj -->
<g id="node82" class="node">
<title>layer_0_expert_14_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11652,-6151.74 11281,-6151.74 11281,-6083.74 11652,-6083.74 11652,-6151.74"/>
<text text-anchor="middle" x="11466.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 14 Up Proj</text>
<text text-anchor="middle" x="11466.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11466.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11466.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_expert_14&#45;&gt;layer_0_expert_14_up_proj -->
<g id="edge112" class="edge">
<title>layer_0_expert_14&#45;&gt;layer_0_expert_14_up_proj</title>
<path fill="none" stroke="black" d="M11203.53,-6187.69C11244.1,-6177.05 11289.24,-6165.22 11330.49,-6154.4"/>
<polygon fill="black" stroke="black" points="11331.55,-6157.74 11340.34,-6151.82 11329.78,-6150.97 11331.55,-6157.74"/>
</g>
<!-- layer_0_expert_14_activation -->
<g id="node83" class="node">
<title>layer_0_expert_14_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="11263,-6047.74 10892,-6047.74 10892,-5979.74 11263,-5979.74 11263,-6047.74"/>
<text text-anchor="middle" x="11077.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 14 GELU Activation</text>
<text text-anchor="middle" x="11077.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11077.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11077.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_expert_14_gate_proj&#45;&gt;layer_0_expert_14_activation -->
<g id="edge111" class="edge">
<title>layer_0_expert_14_gate_proj&#45;&gt;layer_0_expert_14_activation</title>
<path fill="none" stroke="black" d="M11077.5,-6083.62C11077.5,-6075.52 11077.5,-6066.72 11077.5,-6058.21"/>
<polygon fill="black" stroke="black" points="11081,-6058.04 11077.5,-6048.04 11074,-6058.04 11081,-6058.04"/>
</g>
<!-- layer_0_expert_14_up_proj&#45;&gt;layer_0_expert_14_activation -->
<g id="edge113" class="edge">
<title>layer_0_expert_14_up_proj&#45;&gt;layer_0_expert_14_activation</title>
<path fill="none" stroke="black" d="M11340.47,-6083.69C11299.9,-6073.05 11254.76,-6061.22 11213.51,-6050.4"/>
<polygon fill="black" stroke="black" points="11214.22,-6046.97 11203.66,-6047.82 11212.45,-6053.74 11214.22,-6046.97"/>
</g>
<!-- layer_0_expert_14_down_proj -->
<g id="node84" class="node">
<title>layer_0_expert_14_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10886,-5943.74 10515,-5943.74 10515,-5875.74 10886,-5875.74 10886,-5943.74"/>
<text text-anchor="middle" x="10700.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 14 Down Proj</text>
<text text-anchor="middle" x="10700.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10700.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10700.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_0_expert_14_activation&#45;&gt;layer_0_expert_14_down_proj -->
<g id="edge114" class="edge">
<title>layer_0_expert_14_activation&#45;&gt;layer_0_expert_14_down_proj</title>
<path fill="none" stroke="black" d="M10955.36,-5979.69C10916.12,-5969.08 10872.48,-5957.27 10832.56,-5946.47"/>
<polygon fill="black" stroke="black" points="10833.34,-5943.05 10822.77,-5943.82 10831.51,-5949.81 10833.34,-5943.05"/>
</g>
<!-- layer_0_expert_14_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge115" class="edge">
<title>layer_0_expert_14_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M10514.77,-5896.74C10403.13,-5889.84 10258.21,-5881.44 10129.5,-5875.74 9079.85,-5829.22 7843.55,-5796.94 7211.22,-5782.05"/>
<polygon fill="black" stroke="black" points="7211.1,-5778.55 7201.02,-5781.81 7210.94,-5785.55 7211.1,-5778.55"/>
</g>
<!-- layer_0_expert_15_gate_proj -->
<g id="node86" class="node">
<title>layer_0_expert_15_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12041,-6151.74 11670,-6151.74 11670,-6083.74 12041,-6083.74 12041,-6151.74"/>
<text text-anchor="middle" x="11855.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 15 Gate Proj</text>
<text text-anchor="middle" x="11855.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11855.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11855.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_expert_15&#45;&gt;layer_0_expert_15_gate_proj -->
<g id="edge117" class="edge">
<title>layer_0_expert_15&#45;&gt;layer_0_expert_15_gate_proj</title>
<path fill="none" stroke="black" d="M11855.5,-6187.62C11855.5,-6179.52 11855.5,-6170.72 11855.5,-6162.21"/>
<polygon fill="black" stroke="black" points="11859,-6162.04 11855.5,-6152.04 11852,-6162.04 11859,-6162.04"/>
</g>
<!-- layer_0_expert_15_up_proj -->
<g id="node87" class="node">
<title>layer_0_expert_15_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12430,-6151.74 12059,-6151.74 12059,-6083.74 12430,-6083.74 12430,-6151.74"/>
<text text-anchor="middle" x="12244.5" y="-6136.54" font-family="Times,serif" font-size="14.00">Expert 15 Up Proj</text>
<text text-anchor="middle" x="12244.5" y="-6121.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12244.5" y="-6106.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12244.5" y="-6091.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_expert_15&#45;&gt;layer_0_expert_15_up_proj -->
<g id="edge119" class="edge">
<title>layer_0_expert_15&#45;&gt;layer_0_expert_15_up_proj</title>
<path fill="none" stroke="black" d="M11981.53,-6187.69C12022.1,-6177.05 12067.24,-6165.22 12108.49,-6154.4"/>
<polygon fill="black" stroke="black" points="12109.55,-6157.74 12118.34,-6151.82 12107.78,-6150.97 12109.55,-6157.74"/>
</g>
<!-- layer_0_expert_15_activation -->
<g id="node88" class="node">
<title>layer_0_expert_15_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="12041,-6047.74 11670,-6047.74 11670,-5979.74 12041,-5979.74 12041,-6047.74"/>
<text text-anchor="middle" x="11855.5" y="-6032.54" font-family="Times,serif" font-size="14.00">Expert 15 GELU Activation</text>
<text text-anchor="middle" x="11855.5" y="-6017.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11855.5" y="-6002.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11855.5" y="-5987.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_expert_15_gate_proj&#45;&gt;layer_0_expert_15_activation -->
<g id="edge118" class="edge">
<title>layer_0_expert_15_gate_proj&#45;&gt;layer_0_expert_15_activation</title>
<path fill="none" stroke="black" d="M11855.5,-6083.62C11855.5,-6075.52 11855.5,-6066.72 11855.5,-6058.21"/>
<polygon fill="black" stroke="black" points="11859,-6058.04 11855.5,-6048.04 11852,-6058.04 11859,-6058.04"/>
</g>
<!-- layer_0_expert_15_up_proj&#45;&gt;layer_0_expert_15_activation -->
<g id="edge120" class="edge">
<title>layer_0_expert_15_up_proj&#45;&gt;layer_0_expert_15_activation</title>
<path fill="none" stroke="black" d="M12118.47,-6083.69C12077.9,-6073.05 12032.76,-6061.22 11991.51,-6050.4"/>
<polygon fill="black" stroke="black" points="11992.22,-6046.97 11981.66,-6047.82 11990.45,-6053.74 11992.22,-6046.97"/>
</g>
<!-- layer_0_expert_15_down_proj -->
<g id="node89" class="node">
<title>layer_0_expert_15_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11658,-5943.74 11287,-5943.74 11287,-5875.74 11658,-5875.74 11658,-5943.74"/>
<text text-anchor="middle" x="11472.5" y="-5928.54" font-family="Times,serif" font-size="14.00">Expert 15 Down Proj</text>
<text text-anchor="middle" x="11472.5" y="-5913.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11472.5" y="-5898.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11472.5" y="-5883.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_0_expert_15_activation&#45;&gt;layer_0_expert_15_down_proj -->
<g id="edge121" class="edge">
<title>layer_0_expert_15_activation&#45;&gt;layer_0_expert_15_down_proj</title>
<path fill="none" stroke="black" d="M11731.42,-5979.69C11691.47,-5969.05 11647.03,-5957.22 11606.41,-5946.4"/>
<polygon fill="black" stroke="black" points="11607.28,-5943.01 11596.72,-5943.82 11605.48,-5949.78 11607.28,-5943.01"/>
</g>
<!-- layer_0_expert_15_down_proj&#45;&gt;layer_0_expert_agg -->
<g id="edge122" class="edge">
<title>layer_0_expert_15_down_proj&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M11286.78,-5896.6C11173.71,-5889.59 11026.33,-5881.12 10895.5,-5875.74 9546.47,-5820.24 7946.62,-5790.47 7206.32,-5778.75"/>
<polygon fill="black" stroke="black" points="7206.35,-5775.25 7196.3,-5778.59 7206.24,-5782.25 7206.35,-5775.25"/>
</g>
<!-- layer_0_expert_agg&#45;&gt;layer_0_expert_residual -->
<g id="edge124" class="edge">
<title>layer_0_expert_agg&#45;&gt;layer_0_expert_residual</title>
<path fill="none" stroke="black" d="M7158.49,-5753.15C7744.98,-5724.97 8879.92,-5670.43 9378.05,-5646.49"/>
<polygon fill="black" stroke="black" points="9378.43,-5649.97 9388.25,-5646 9378.09,-5642.98 9378.43,-5649.97"/>
</g>
<!-- layer_0_expert_layernorm -->
<g id="node92" class="node">
<title>layer_0_expert_layernorm</title>
<polygon fill="lightgray" stroke="black" points="9856.5,-5563.74 9388.5,-5563.74 9388.5,-5495.74 9856.5,-5495.74 9856.5,-5563.74"/>
<text text-anchor="middle" x="9622.5" y="-5548.54" font-family="Times,serif" font-size="14.00">Layer Norm (Post&#45;Experts)</text>
<text text-anchor="middle" x="9622.5" y="-5533.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9622.5" y="-5518.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9622.5" y="-5503.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_expert_residual&#45;&gt;layer_0_expert_layernorm -->
<g id="edge125" class="edge">
<title>layer_0_expert_residual&#45;&gt;layer_0_expert_layernorm</title>
<path fill="none" stroke="black" d="M9622.5,-5599.62C9622.5,-5591.52 9622.5,-5582.72 9622.5,-5574.21"/>
<polygon fill="black" stroke="black" points="9626,-5574.04 9622.5,-5564.04 9619,-5574.04 9626,-5574.04"/>
</g>
<!-- layer_1_input -->
<g id="node93" class="node">
<title>layer_1_input</title>
<polygon fill="lightyellow" stroke="black" points="10095.02,-5459.74 9343.35,-5459.74 9149.98,-5353.74 9901.65,-5353.74 10095.02,-5459.74"/>
<text text-anchor="middle" x="9622.5" y="-5418.04" font-family="Times,serif" font-size="14.00">Layer 1 Input</text>
<text text-anchor="middle" x="9622.5" y="-5403.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9622.5" y="-5388.04" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_expert_layernorm&#45;&gt;layer_1_input -->
<g id="edge126" class="edge">
<title>layer_0_expert_layernorm&#45;&gt;layer_1_input</title>
<path fill="none" stroke="black" d="M9622.5,-5495.68C9622.5,-5487.64 9622.5,-5478.79 9622.5,-5469.89"/>
<polygon fill="black" stroke="black" points="9626,-5469.87 9622.5,-5459.87 9619,-5469.87 9626,-5469.87"/>
</g>
<!-- layer_1_mha_qkv -->
<g id="node94" class="node">
<title>layer_1_mha_qkv</title>
<polygon fill="lightgreen" stroke="black" points="9729,-5317.74 9248,-5317.74 9248,-5249.74 9729,-5249.74 9729,-5317.74"/>
<text text-anchor="middle" x="9488.5" y="-5302.54" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="9488.5" y="-5287.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9488.5" y="-5272.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="9488.5" y="-5257.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_input&#45;&gt;layer_1_mha_qkv -->
<g id="edge127" class="edge">
<title>layer_1_input&#45;&gt;layer_1_mha_qkv</title>
<path fill="none" stroke="black" d="M9564.89,-5353.72C9554.15,-5344.02 9543.09,-5334.03 9532.82,-5324.76"/>
<polygon fill="black" stroke="black" points="9534.92,-5321.94 9525.15,-5317.83 9530.23,-5327.13 9534.92,-5321.94"/>
</g>
<!-- layer_1_mha_residual -->
<g id="node97" class="node">
<title>layer_1_mha_residual</title>
<polygon fill="lightcoral" stroke="black" points="9860.5,-5005.74 9392.5,-5005.74 9392.5,-4937.74 9860.5,-4937.74 9860.5,-5005.74"/>
<text text-anchor="middle" x="9626.5" y="-4990.54" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="9626.5" y="-4975.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9626.5" y="-4960.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9626.5" y="-4945.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_input&#45;&gt;layer_1_mha_residual -->
<g id="edge130" class="edge">
<title>layer_1_input&#45;&gt;layer_1_mha_residual</title>
<path fill="none" stroke="black" d="M9710.79,-5353.6C9721.96,-5343.17 9731.81,-5331.21 9738.5,-5317.74 9793.06,-5207.87 9798.31,-5148.84 9738.5,-5041.74 9732.02,-5030.14 9722.71,-5020.25 9712.17,-5011.89"/>
<polygon fill="black" stroke="black" points="9714.04,-5008.91 9703.91,-5005.79 9709.88,-5014.55 9714.04,-5008.91"/>
</g>
<!-- layer_1_mha_attention -->
<g id="node95" class="node">
<title>layer_1_mha_attention</title>
<polygon fill="lightgreen" stroke="black" points="9726,-5213.74 9257,-5213.74 9257,-5145.74 9726,-5145.74 9726,-5213.74"/>
<text text-anchor="middle" x="9491.5" y="-5198.54" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="9491.5" y="-5183.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="9491.5" y="-5168.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9491.5" y="-5153.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_mha_qkv&#45;&gt;layer_1_mha_attention -->
<g id="edge128" class="edge">
<title>layer_1_mha_qkv&#45;&gt;layer_1_mha_attention</title>
<path fill="none" stroke="black" d="M9489.47,-5249.62C9489.71,-5241.52 9489.97,-5232.72 9490.22,-5224.21"/>
<polygon fill="black" stroke="black" points="9493.73,-5224.14 9490.52,-5214.04 9486.73,-5223.93 9493.73,-5224.14"/>
</g>
<!-- layer_1_mha_proj -->
<g id="node96" class="node">
<title>layer_1_mha_proj</title>
<polygon fill="lightgreen" stroke="black" points="9729.5,-5109.74 9261.5,-5109.74 9261.5,-5041.74 9729.5,-5041.74 9729.5,-5109.74"/>
<text text-anchor="middle" x="9495.5" y="-5094.54" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="9495.5" y="-5079.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9495.5" y="-5064.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9495.5" y="-5049.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_mha_attention&#45;&gt;layer_1_mha_proj -->
<g id="edge129" class="edge">
<title>layer_1_mha_attention&#45;&gt;layer_1_mha_proj</title>
<path fill="none" stroke="black" d="M9492.8,-5145.62C9493.12,-5137.52 9493.46,-5128.72 9493.8,-5120.21"/>
<polygon fill="black" stroke="black" points="9497.3,-5120.17 9494.19,-5110.04 9490.3,-5119.89 9497.3,-5120.17"/>
</g>
<!-- layer_1_mha_proj&#45;&gt;layer_1_mha_residual -->
<g id="edge131" class="edge">
<title>layer_1_mha_proj&#45;&gt;layer_1_mha_residual</title>
<path fill="none" stroke="black" d="M9538.03,-5041.62C9550.04,-5032.27 9563.24,-5022 9575.68,-5012.31"/>
<polygon fill="black" stroke="black" points="9577.99,-5014.94 9583.73,-5006.04 9573.69,-5009.42 9577.99,-5014.94"/>
</g>
<!-- layer_1_mha_layernorm -->
<g id="node98" class="node">
<title>layer_1_mha_layernorm</title>
<polygon fill="lightgray" stroke="black" points="9860.5,-4901.74 9392.5,-4901.74 9392.5,-4833.74 9860.5,-4833.74 9860.5,-4901.74"/>
<text text-anchor="middle" x="9626.5" y="-4886.54" font-family="Times,serif" font-size="14.00">Layer Norm (Post&#45;MHA)</text>
<text text-anchor="middle" x="9626.5" y="-4871.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9626.5" y="-4856.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9626.5" y="-4841.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_mha_residual&#45;&gt;layer_1_mha_layernorm -->
<g id="edge132" class="edge">
<title>layer_1_mha_residual&#45;&gt;layer_1_mha_layernorm</title>
<path fill="none" stroke="black" d="M9626.5,-4937.62C9626.5,-4929.52 9626.5,-4920.72 9626.5,-4912.21"/>
<polygon fill="black" stroke="black" points="9630,-4912.04 9626.5,-4902.04 9623,-4912.04 9630,-4912.04"/>
</g>
<!-- layer_1_gate -->
<g id="node99" class="node">
<title>layer_1_gate</title>
<polygon fill="orange" stroke="black" points="9598.02,-4797.74 8846.35,-4797.74 8652.98,-4661.74 9404.65,-4661.74 9598.02,-4797.74"/>
<text text-anchor="middle" x="9125.5" y="-4748.54" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="9125.5" y="-4733.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9125.5" y="-4718.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, k=2]</text>
<text text-anchor="middle" x="9125.5" y="-4703.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_mha_layernorm&#45;&gt;layer_1_gate -->
<g id="edge133" class="edge">
<title>layer_1_mha_layernorm&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" d="M9504.9,-4833.73C9467.61,-4823.61 9425.08,-4812.06 9382.3,-4800.45"/>
<polygon fill="black" stroke="black" points="9383.16,-4797.06 9372.6,-4797.82 9381.33,-4803.81 9383.16,-4797.06"/>
</g>
<!-- layer_1_token_split -->
<g id="node100" class="node">
<title>layer_1_token_split</title>
<polygon fill="lightyellow" stroke="black" points="9598.02,-4625.74 8846.35,-4625.74 8652.98,-4489.74 9404.65,-4489.74 9598.02,-4625.74"/>
<text text-anchor="middle" x="9125.5" y="-4576.54" font-family="Times,serif" font-size="14.00">Token Split by Expert</text>
<text text-anchor="middle" x="9125.5" y="-4561.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9125.5" y="-4546.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192] per expert</text>
<text text-anchor="middle" x="9125.5" y="-4531.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_mha_layernorm&#45;&gt;layer_1_token_split -->
<g id="edge134" class="edge">
<title>layer_1_mha_layernorm&#45;&gt;layer_1_token_split</title>
<path fill="none" stroke="black" d="M9634.19,-4833.73C9642.52,-4788.93 9649.52,-4709.04 9607.5,-4661.74 9596.84,-4649.74 9578.95,-4639.04 9556.18,-4629.53"/>
<polygon fill="black" stroke="black" points="9557.44,-4626.26 9546.86,-4625.8 9554.84,-4632.76 9557.44,-4626.26"/>
</g>
<!-- layer_1_expert_residual -->
<g id="node182" class="node">
<title>layer_1_expert_residual</title>
<polygon fill="lightcoral" stroke="black" points="12378.5,-3865.74 11910.5,-3865.74 11910.5,-3797.74 12378.5,-3797.74 12378.5,-3865.74"/>
<text text-anchor="middle" x="12144.5" y="-3850.54" font-family="Times,serif" font-size="14.00">Expert Residual Add</text>
<text text-anchor="middle" x="12144.5" y="-3835.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12144.5" y="-3820.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12144.5" y="-3805.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_mha_layernorm&#45;&gt;layer_1_expert_residual -->
<g id="edge248" class="edge">
<title>layer_1_mha_layernorm&#45;&gt;layer_1_expert_residual</title>
<path fill="none" stroke="black" d="M9860.86,-4865.7C10892.77,-4859.61 14980.5,-4819.07 14980.5,-4558.74 14980.5,-4558.74 14980.5,-4558.74 14980.5,-4106.74 14980.5,-3977.05 13076.62,-3875.94 12388.73,-3843.64"/>
<polygon fill="black" stroke="black" points="12388.85,-3840.14 12378.69,-3843.17 12388.52,-3847.13 12388.85,-3840.14"/>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_token_split -->
<g id="edge135" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_token_split</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9125.5,-4661.55C9125.5,-4653.24 9125.5,-4644.69 9125.5,-4636.23"/>
<polygon fill="black" stroke="black" points="9129,-4636 9125.5,-4626 9122,-4636 9129,-4636"/>
</g>
<!-- layer_1_expert_0 -->
<g id="node101" class="node">
<title>layer_1_expert_0</title>
<polygon fill="lightcyan" stroke="black" points="3282,-4453.74 2911,-4453.74 2911,-4385.74 3282,-4385.74 3282,-4453.74"/>
<text text-anchor="middle" x="3096.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3096.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3096.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3096.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_0 -->
<g id="edge136" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_0</title>
<path fill="none" stroke="black" d="M8744.89,-4554.47C7857.2,-4548.08 5580.69,-4525.5 3679.5,-4453.74 3550.43,-4448.87 3405.43,-4440.67 3292.33,-4433.67"/>
<polygon fill="black" stroke="black" points="3292.38,-4430.16 3282.18,-4433.04 3291.94,-4437.15 3292.38,-4430.16"/>
</g>
<!-- layer_1_expert_1 -->
<g id="node106" class="node">
<title>layer_1_expert_1</title>
<polygon fill="lightcyan" stroke="black" points="4060,-4453.74 3689,-4453.74 3689,-4385.74 4060,-4385.74 4060,-4453.74"/>
<text text-anchor="middle" x="3874.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3874.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3874.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3874.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_1 -->
<g id="edge143" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_1</title>
<path fill="none" stroke="black" d="M8742.26,-4552.76C7944.61,-4543.48 6047.86,-4516.28 4457.5,-4453.74 4328.44,-4448.67 4183.44,-4440.47 4070.34,-4433.51"/>
<polygon fill="black" stroke="black" points="4070.38,-4430.01 4060.18,-4432.89 4069.95,-4437 4070.38,-4430.01"/>
</g>
<!-- layer_1_expert_2 -->
<g id="node111" class="node">
<title>layer_1_expert_2</title>
<polygon fill="lightcyan" stroke="black" points="4838,-4453.74 4467,-4453.74 4467,-4385.74 4838,-4385.74 4838,-4453.74"/>
<text text-anchor="middle" x="4652.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4652.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="4652.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="4652.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_2 -->
<g id="edge150" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_2</title>
<path fill="none" stroke="black" d="M8738.88,-4550.35C8039.57,-4537.94 6518,-4507 5235.5,-4453.74 5106.45,-4448.38 4961.45,-4440.18 4848.34,-4433.3"/>
<polygon fill="black" stroke="black" points="4848.39,-4429.79 4838.19,-4432.68 4847.96,-4436.78 4848.39,-4429.79"/>
</g>
<!-- layer_1_expert_3 -->
<g id="node116" class="node">
<title>layer_1_expert_3</title>
<polygon fill="lightcyan" stroke="black" points="5616,-4453.74 5245,-4453.74 5245,-4385.74 5616,-4385.74 5616,-4453.74"/>
<text text-anchor="middle" x="5430.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5430.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5430.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5430.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_3 -->
<g id="edge157" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_3</title>
<path fill="none" stroke="black" d="M8733.91,-4546.73C8143.88,-4530.97 6991.8,-4497.61 6013.5,-4453.74 5884.47,-4447.95 5739.47,-4439.75 5626.36,-4432.98"/>
<polygon fill="black" stroke="black" points="5626.4,-4429.47 5616.21,-4432.37 5625.98,-4436.46 5626.4,-4429.47"/>
</g>
<!-- layer_1_expert_4 -->
<g id="node121" class="node">
<title>layer_1_expert_4</title>
<polygon fill="lightcyan" stroke="black" points="6394,-4453.74 6023,-4453.74 6023,-4385.74 6394,-4385.74 6394,-4453.74"/>
<text text-anchor="middle" x="6208.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="6208.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6208.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6208.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_4 -->
<g id="edge164" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_4</title>
<path fill="none" stroke="black" d="M8725.08,-4540.59C8260.13,-4521.48 7470.15,-4487.92 6791.5,-4453.74 6662.5,-4447.24 6517.51,-4439.04 6404.38,-4432.44"/>
<polygon fill="black" stroke="black" points="6404.42,-4428.93 6394.23,-4431.84 6404.01,-4435.92 6404.42,-4428.93"/>
</g>
<!-- layer_1_expert_5 -->
<g id="node126" class="node">
<title>layer_1_expert_5</title>
<polygon fill="lightcyan" stroke="black" points="7172,-4453.74 6801,-4453.74 6801,-4385.74 7172,-4385.74 7172,-4453.74"/>
<text text-anchor="middle" x="6986.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="6986.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6986.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6986.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_5 -->
<g id="edge171" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_5</title>
<path fill="none" stroke="black" d="M8710.54,-4530.36C8250.23,-4501.09 7527.07,-4455.11 7182.16,-4433.18"/>
<polygon fill="black" stroke="black" points="7182.27,-4429.68 7172.07,-4432.54 7181.82,-4436.67 7182.27,-4429.68"/>
</g>
<!-- layer_1_expert_6 -->
<g id="node131" class="node">
<title>layer_1_expert_6</title>
<polygon fill="lightcyan" stroke="black" points="7950,-4453.74 7579,-4453.74 7579,-4385.74 7950,-4385.74 7950,-4453.74"/>
<text text-anchor="middle" x="7764.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="7764.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7764.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7764.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_6 -->
<g id="edge178" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_6</title>
<path fill="none" stroke="black" d="M8685.5,-4512.77C8440.97,-4488.34 8148.88,-4459.15 7960.21,-4440.3"/>
<polygon fill="black" stroke="black" points="7960.48,-4436.81 7950.18,-4439.29 7959.79,-4443.77 7960.48,-4436.81"/>
</g>
<!-- layer_1_expert_7 -->
<g id="node136" class="node">
<title>layer_1_expert_7</title>
<polygon fill="lightcyan" stroke="black" points="8728,-4453.74 8357,-4453.74 8357,-4385.74 8728,-4385.74 8728,-4453.74"/>
<text text-anchor="middle" x="8542.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="8542.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8542.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8542.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_7 -->
<g id="edge185" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_7</title>
<path fill="none" stroke="black" d="M8838.27,-4489.74C8788.43,-4478.11 8738.43,-4466.45 8694.09,-4456.1"/>
<polygon fill="black" stroke="black" points="8694.67,-4452.64 8684.13,-4453.78 8693.08,-4459.46 8694.67,-4452.64"/>
</g>
<!-- layer_1_expert_8 -->
<g id="node141" class="node">
<title>layer_1_expert_8</title>
<polygon fill="lightcyan" stroke="black" points="9311,-4453.74 8940,-4453.74 8940,-4385.74 9311,-4385.74 9311,-4453.74"/>
<text text-anchor="middle" x="9125.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="9125.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9125.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9125.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_8 -->
<g id="edge192" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_8</title>
<path fill="none" stroke="black" d="M9125.5,-4489.54C9125.5,-4480.78 9125.5,-4472.02 9125.5,-4463.81"/>
<polygon fill="black" stroke="black" points="9129,-4463.76 9125.5,-4453.76 9122,-4463.76 9129,-4463.76"/>
</g>
<!-- layer_1_expert_9 -->
<g id="node146" class="node">
<title>layer_1_expert_9</title>
<polygon fill="lightcyan" stroke="black" points="9895,-4453.74 9524,-4453.74 9524,-4385.74 9895,-4385.74 9895,-4453.74"/>
<text text-anchor="middle" x="9709.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="9709.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9709.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9709.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_9 -->
<g id="edge199" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_9</title>
<path fill="none" stroke="black" d="M9406.81,-4491.23C9458.87,-4479.11 9511.38,-4466.88 9557.71,-4456.09"/>
<polygon fill="black" stroke="black" points="9558.56,-4459.48 9567.51,-4453.81 9556.97,-4452.67 9558.56,-4459.48"/>
</g>
<!-- layer_1_expert_10 -->
<g id="node151" class="node">
<title>layer_1_expert_10</title>
<polygon fill="lightcyan" stroke="black" points="10673,-4453.74 10302,-4453.74 10302,-4385.74 10673,-4385.74 10673,-4453.74"/>
<text text-anchor="middle" x="10487.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="10487.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10487.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10487.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_10 -->
<g id="edge206" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_10</title>
<path fill="none" stroke="black" d="M9453.47,-4523.99C9715.1,-4497.87 10072.84,-4462.15 10291.62,-4440.3"/>
<polygon fill="black" stroke="black" points="10292.01,-4443.78 10301.61,-4439.3 10291.31,-4436.81 10292.01,-4443.78"/>
</g>
<!-- layer_1_expert_11 -->
<g id="node156" class="node">
<title>layer_1_expert_11</title>
<polygon fill="lightcyan" stroke="black" points="11451,-4453.74 11080,-4453.74 11080,-4385.74 11451,-4385.74 11451,-4453.74"/>
<text text-anchor="middle" x="11265.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="11265.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11265.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11265.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_11 -->
<g id="edge213" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_11</title>
<path fill="none" stroke="black" d="M9469.03,-4534.91C9922.55,-4506.09 10705.97,-4456.3 11069.59,-4433.19"/>
<polygon fill="black" stroke="black" points="11069.93,-4436.68 11079.69,-4432.55 11069.49,-4429.69 11069.93,-4436.68"/>
</g>
<!-- layer_1_expert_12 -->
<g id="node161" class="node">
<title>layer_1_expert_12</title>
<polygon fill="lightcyan" stroke="black" points="12229,-4453.74 11858,-4453.74 11858,-4385.74 12229,-4385.74 12229,-4453.74"/>
<text text-anchor="middle" x="12043.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="12043.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12043.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12043.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_12 -->
<g id="edge220" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_12</title>
<path fill="none" stroke="black" d="M9480.11,-4542.47C9937.75,-4523.75 10758.64,-4489.08 11460.5,-4453.74 11589.5,-4447.24 11734.49,-4439.04 11847.62,-4432.44"/>
<polygon fill="black" stroke="black" points="11847.99,-4435.92 11857.77,-4431.84 11847.58,-4428.93 11847.99,-4435.92"/>
</g>
<!-- layer_1_expert_13 -->
<g id="node166" class="node">
<title>layer_1_expert_13</title>
<polygon fill="lightcyan" stroke="black" points="13007,-4453.74 12636,-4453.74 12636,-4385.74 13007,-4385.74 13007,-4453.74"/>
<text text-anchor="middle" x="12821.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="12821.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12821.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12821.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_13 -->
<g id="edge227" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_13</title>
<path fill="none" stroke="black" d="M9486.89,-4547.54C10067.22,-4532.13 11242.84,-4498.38 12238.5,-4453.74 12367.53,-4447.95 12512.53,-4439.75 12625.64,-4432.98"/>
<polygon fill="black" stroke="black" points="12626.02,-4436.46 12635.79,-4432.37 12625.6,-4429.47 12626.02,-4436.46"/>
</g>
<!-- layer_1_expert_14 -->
<g id="node171" class="node">
<title>layer_1_expert_14</title>
<polygon fill="lightcyan" stroke="black" points="13785,-4453.74 13414,-4453.74 13414,-4385.74 13785,-4385.74 13785,-4453.74"/>
<text text-anchor="middle" x="13599.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="13599.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13599.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13599.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_14 -->
<g id="edge234" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_14</title>
<path fill="none" stroke="black" d="M9491.42,-4550.72C10181.15,-4538.56 11720.8,-4507.55 13016.5,-4453.74 13145.55,-4448.38 13290.55,-4440.18 13403.66,-4433.3"/>
<polygon fill="black" stroke="black" points="13404.04,-4436.78 13413.81,-4432.68 13403.61,-4429.79 13404.04,-4436.78"/>
</g>
<!-- layer_1_expert_15 -->
<g id="node176" class="node">
<title>layer_1_expert_15</title>
<polygon fill="lightcyan" stroke="black" points="14563,-4453.74 14192,-4453.74 14192,-4385.74 14563,-4385.74 14563,-4453.74"/>
<text text-anchor="middle" x="14377.5" y="-4438.54" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="14377.5" y="-4423.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14377.5" y="-4408.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14377.5" y="-4393.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_token_split&#45;&gt;layer_1_expert_15 -->
<g id="edge241" class="edge">
<title>layer_1_token_split&#45;&gt;layer_1_expert_15</title>
<path fill="none" stroke="black" d="M9494.84,-4552.92C10284.29,-4543.8 12194.43,-4516.66 13794.5,-4453.74 13923.56,-4448.67 14068.56,-4440.47 14181.66,-4433.51"/>
<polygon fill="black" stroke="black" points="14182.05,-4437 14191.82,-4432.89 14181.62,-4430.01 14182.05,-4437"/>
</g>
<!-- layer_1_expert_0_gate_proj -->
<g id="node102" class="node">
<title>layer_1_expert_0_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="2893,-4349.74 2522,-4349.74 2522,-4281.74 2893,-4281.74 2893,-4349.74"/>
<text text-anchor="middle" x="2707.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 0 Gate Proj</text>
<text text-anchor="middle" x="2707.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="2707.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="2707.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_expert_0&#45;&gt;layer_1_expert_0_gate_proj -->
<g id="edge137" class="edge">
<title>layer_1_expert_0&#45;&gt;layer_1_expert_0_gate_proj</title>
<path fill="none" stroke="black" d="M2970.47,-4385.69C2929.9,-4375.05 2884.76,-4363.22 2843.51,-4352.4"/>
<polygon fill="black" stroke="black" points="2844.22,-4348.97 2833.66,-4349.82 2842.45,-4355.74 2844.22,-4348.97"/>
</g>
<!-- layer_1_expert_0_up_proj -->
<g id="node103" class="node">
<title>layer_1_expert_0_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="3282,-4349.74 2911,-4349.74 2911,-4281.74 3282,-4281.74 3282,-4349.74"/>
<text text-anchor="middle" x="3096.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 0 Up Proj</text>
<text text-anchor="middle" x="3096.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3096.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3096.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_expert_0&#45;&gt;layer_1_expert_0_up_proj -->
<g id="edge139" class="edge">
<title>layer_1_expert_0&#45;&gt;layer_1_expert_0_up_proj</title>
<path fill="none" stroke="black" d="M3096.5,-4385.62C3096.5,-4377.52 3096.5,-4368.72 3096.5,-4360.21"/>
<polygon fill="black" stroke="black" points="3100,-4360.04 3096.5,-4350.04 3093,-4360.04 3100,-4360.04"/>
</g>
<!-- layer_1_expert_0_activation -->
<g id="node104" class="node">
<title>layer_1_expert_0_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="3282,-4245.74 2911,-4245.74 2911,-4177.74 3282,-4177.74 3282,-4245.74"/>
<text text-anchor="middle" x="3096.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="3096.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3096.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3096.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_expert_0_gate_proj&#45;&gt;layer_1_expert_0_activation -->
<g id="edge138" class="edge">
<title>layer_1_expert_0_gate_proj&#45;&gt;layer_1_expert_0_activation</title>
<path fill="none" stroke="black" d="M2833.53,-4281.69C2874.1,-4271.05 2919.24,-4259.22 2960.49,-4248.4"/>
<polygon fill="black" stroke="black" points="2961.55,-4251.74 2970.34,-4245.82 2959.78,-4244.97 2961.55,-4251.74"/>
</g>
<!-- layer_1_expert_0_up_proj&#45;&gt;layer_1_expert_0_activation -->
<g id="edge140" class="edge">
<title>layer_1_expert_0_up_proj&#45;&gt;layer_1_expert_0_activation</title>
<path fill="none" stroke="black" d="M3096.5,-4281.62C3096.5,-4273.52 3096.5,-4264.72 3096.5,-4256.21"/>
<polygon fill="black" stroke="black" points="3100,-4256.04 3096.5,-4246.04 3093,-4256.04 3100,-4256.04"/>
</g>
<!-- layer_1_expert_0_down_proj -->
<g id="node105" class="node">
<title>layer_1_expert_0_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="3289,-4141.74 2918,-4141.74 2918,-4073.74 3289,-4073.74 3289,-4141.74"/>
<text text-anchor="middle" x="3103.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 0 Down Proj</text>
<text text-anchor="middle" x="3103.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3103.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3103.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_1_expert_0_activation&#45;&gt;layer_1_expert_0_down_proj -->
<g id="edge141" class="edge">
<title>layer_1_expert_0_activation&#45;&gt;layer_1_expert_0_down_proj</title>
<path fill="none" stroke="black" d="M3098.77,-4177.62C3099.33,-4169.52 3099.93,-4160.72 3100.52,-4152.21"/>
<polygon fill="black" stroke="black" points="3104.02,-4152.26 3101.21,-4142.04 3097.04,-4151.78 3104.02,-4152.26"/>
</g>
<!-- layer_1_expert_agg -->
<g id="node181" class="node">
<title>layer_1_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="9809.06,-4037.74 9022.32,-4037.74 8819.94,-3901.74 9606.68,-3901.74 9809.06,-4037.74"/>
<text text-anchor="middle" x="9314.5" y="-3988.54" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="9314.5" y="-3973.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192] from all experts</text>
<text text-anchor="middle" x="9314.5" y="-3958.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="9314.5" y="-3943.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_expert_0_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge142" class="edge">
<title>layer_1_expert_0_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M3289.38,-4102.67C4146.94,-4083.89 7730.14,-4005.43 8924.9,-3979.27"/>
<polygon fill="black" stroke="black" points="8925.02,-3982.77 8934.94,-3979.05 8924.86,-3975.77 8925.02,-3982.77"/>
</g>
<!-- layer_1_expert_1_gate_proj -->
<g id="node107" class="node">
<title>layer_1_expert_1_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="3671,-4349.74 3300,-4349.74 3300,-4281.74 3671,-4281.74 3671,-4349.74"/>
<text text-anchor="middle" x="3485.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 1 Gate Proj</text>
<text text-anchor="middle" x="3485.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3485.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3485.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_expert_1&#45;&gt;layer_1_expert_1_gate_proj -->
<g id="edge144" class="edge">
<title>layer_1_expert_1&#45;&gt;layer_1_expert_1_gate_proj</title>
<path fill="none" stroke="black" d="M3748.47,-4385.69C3707.9,-4375.05 3662.76,-4363.22 3621.51,-4352.4"/>
<polygon fill="black" stroke="black" points="3622.22,-4348.97 3611.66,-4349.82 3620.45,-4355.74 3622.22,-4348.97"/>
</g>
<!-- layer_1_expert_1_up_proj -->
<g id="node108" class="node">
<title>layer_1_expert_1_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="4060,-4349.74 3689,-4349.74 3689,-4281.74 4060,-4281.74 4060,-4349.74"/>
<text text-anchor="middle" x="3874.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 1 Up Proj</text>
<text text-anchor="middle" x="3874.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="3874.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3874.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_expert_1&#45;&gt;layer_1_expert_1_up_proj -->
<g id="edge146" class="edge">
<title>layer_1_expert_1&#45;&gt;layer_1_expert_1_up_proj</title>
<path fill="none" stroke="black" d="M3874.5,-4385.62C3874.5,-4377.52 3874.5,-4368.72 3874.5,-4360.21"/>
<polygon fill="black" stroke="black" points="3878,-4360.04 3874.5,-4350.04 3871,-4360.04 3878,-4360.04"/>
</g>
<!-- layer_1_expert_1_activation -->
<g id="node109" class="node">
<title>layer_1_expert_1_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="4060,-4245.74 3689,-4245.74 3689,-4177.74 4060,-4177.74 4060,-4245.74"/>
<text text-anchor="middle" x="3874.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="3874.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3874.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="3874.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_expert_1_gate_proj&#45;&gt;layer_1_expert_1_activation -->
<g id="edge145" class="edge">
<title>layer_1_expert_1_gate_proj&#45;&gt;layer_1_expert_1_activation</title>
<path fill="none" stroke="black" d="M3611.53,-4281.69C3652.1,-4271.05 3697.24,-4259.22 3738.49,-4248.4"/>
<polygon fill="black" stroke="black" points="3739.55,-4251.74 3748.34,-4245.82 3737.78,-4244.97 3739.55,-4251.74"/>
</g>
<!-- layer_1_expert_1_up_proj&#45;&gt;layer_1_expert_1_activation -->
<g id="edge147" class="edge">
<title>layer_1_expert_1_up_proj&#45;&gt;layer_1_expert_1_activation</title>
<path fill="none" stroke="black" d="M3874.5,-4281.62C3874.5,-4273.52 3874.5,-4264.72 3874.5,-4256.21"/>
<polygon fill="black" stroke="black" points="3878,-4256.04 3874.5,-4246.04 3871,-4256.04 3878,-4256.04"/>
</g>
<!-- layer_1_expert_1_down_proj -->
<g id="node110" class="node">
<title>layer_1_expert_1_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="5234,-4141.74 4863,-4141.74 4863,-4073.74 5234,-4073.74 5234,-4141.74"/>
<text text-anchor="middle" x="5048.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 1 Down Proj</text>
<text text-anchor="middle" x="5048.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5048.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5048.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_1_expert_1_activation&#45;&gt;layer_1_expert_1_down_proj -->
<g id="edge148" class="edge">
<title>layer_1_expert_1_activation&#45;&gt;layer_1_expert_1_down_proj</title>
<path fill="none" stroke="black" d="M4060.2,-4194.61C4276.47,-4175.82 4632.17,-4144.91 4852.68,-4125.75"/>
<polygon fill="black" stroke="black" points="4853.09,-4129.23 4862.75,-4124.88 4852.49,-4122.26 4853.09,-4129.23"/>
</g>
<!-- layer_1_expert_1_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge149" class="edge">
<title>layer_1_expert_1_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M5234.38,-4100.28C5430,-4093.52 5746.9,-4082.66 6020.5,-4073.74 7072.66,-4039.43 8313.95,-4001.23 8929,-3982.46"/>
<polygon fill="black" stroke="black" points="8929.47,-3985.95 8939.36,-3982.14 8929.26,-3978.95 8929.47,-3985.95"/>
</g>
<!-- layer_1_expert_2_gate_proj -->
<g id="node112" class="node">
<title>layer_1_expert_2_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="4449,-4349.74 4078,-4349.74 4078,-4281.74 4449,-4281.74 4449,-4349.74"/>
<text text-anchor="middle" x="4263.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 2 Gate Proj</text>
<text text-anchor="middle" x="4263.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="4263.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="4263.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_expert_2&#45;&gt;layer_1_expert_2_gate_proj -->
<g id="edge151" class="edge">
<title>layer_1_expert_2&#45;&gt;layer_1_expert_2_gate_proj</title>
<path fill="none" stroke="black" d="M4526.47,-4385.69C4485.9,-4375.05 4440.76,-4363.22 4399.51,-4352.4"/>
<polygon fill="black" stroke="black" points="4400.22,-4348.97 4389.66,-4349.82 4398.45,-4355.74 4400.22,-4348.97"/>
</g>
<!-- layer_1_expert_2_up_proj -->
<g id="node113" class="node">
<title>layer_1_expert_2_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="4838,-4349.74 4467,-4349.74 4467,-4281.74 4838,-4281.74 4838,-4349.74"/>
<text text-anchor="middle" x="4652.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 2 Up Proj</text>
<text text-anchor="middle" x="4652.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="4652.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="4652.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_expert_2&#45;&gt;layer_1_expert_2_up_proj -->
<g id="edge153" class="edge">
<title>layer_1_expert_2&#45;&gt;layer_1_expert_2_up_proj</title>
<path fill="none" stroke="black" d="M4652.5,-4385.62C4652.5,-4377.52 4652.5,-4368.72 4652.5,-4360.21"/>
<polygon fill="black" stroke="black" points="4656,-4360.04 4652.5,-4350.04 4649,-4360.04 4656,-4360.04"/>
</g>
<!-- layer_1_expert_2_activation -->
<g id="node114" class="node">
<title>layer_1_expert_2_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="4838,-4245.74 4467,-4245.74 4467,-4177.74 4838,-4177.74 4838,-4245.74"/>
<text text-anchor="middle" x="4652.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="4652.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="4652.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="4652.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_expert_2_gate_proj&#45;&gt;layer_1_expert_2_activation -->
<g id="edge152" class="edge">
<title>layer_1_expert_2_gate_proj&#45;&gt;layer_1_expert_2_activation</title>
<path fill="none" stroke="black" d="M4389.53,-4281.69C4430.1,-4271.05 4475.24,-4259.22 4516.49,-4248.4"/>
<polygon fill="black" stroke="black" points="4517.55,-4251.74 4526.34,-4245.82 4515.78,-4244.97 4517.55,-4251.74"/>
</g>
<!-- layer_1_expert_2_up_proj&#45;&gt;layer_1_expert_2_activation -->
<g id="edge154" class="edge">
<title>layer_1_expert_2_up_proj&#45;&gt;layer_1_expert_2_activation</title>
<path fill="none" stroke="black" d="M4652.5,-4281.62C4652.5,-4273.52 4652.5,-4264.72 4652.5,-4256.21"/>
<polygon fill="black" stroke="black" points="4656,-4256.04 4652.5,-4246.04 4649,-4256.04 4656,-4256.04"/>
</g>
<!-- layer_1_expert_2_down_proj -->
<g id="node115" class="node">
<title>layer_1_expert_2_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6401,-4141.74 6030,-4141.74 6030,-4073.74 6401,-4073.74 6401,-4141.74"/>
<text text-anchor="middle" x="6215.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 2 Down Proj</text>
<text text-anchor="middle" x="6215.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6215.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6215.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_1_expert_2_activation&#45;&gt;layer_1_expert_2_down_proj -->
<g id="edge155" class="edge">
<title>layer_1_expert_2_activation&#45;&gt;layer_1_expert_2_down_proj</title>
<path fill="none" stroke="black" d="M4838.32,-4198.61C5135.71,-4179.21 5715.91,-4141.34 6019.57,-4121.53"/>
<polygon fill="black" stroke="black" points="6020.06,-4125 6029.81,-4120.86 6019.6,-4118.02 6020.06,-4125"/>
</g>
<!-- layer_1_expert_2_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge156" class="edge">
<title>layer_1_expert_2_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M6401.22,-4095.49C6515.73,-4088.73 6665.6,-4080.22 6798.5,-4073.74 7554.71,-4036.86 8439.21,-4002.74 8932.35,-3984.53"/>
<polygon fill="black" stroke="black" points="8932.62,-3988.02 8942.48,-3984.15 8932.36,-3981.02 8932.62,-3988.02"/>
</g>
<!-- layer_1_expert_3_gate_proj -->
<g id="node117" class="node">
<title>layer_1_expert_3_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="5227,-4349.74 4856,-4349.74 4856,-4281.74 5227,-4281.74 5227,-4349.74"/>
<text text-anchor="middle" x="5041.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 3 Gate Proj</text>
<text text-anchor="middle" x="5041.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5041.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5041.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_expert_3&#45;&gt;layer_1_expert_3_gate_proj -->
<g id="edge158" class="edge">
<title>layer_1_expert_3&#45;&gt;layer_1_expert_3_gate_proj</title>
<path fill="none" stroke="black" d="M5304.47,-4385.69C5263.9,-4375.05 5218.76,-4363.22 5177.51,-4352.4"/>
<polygon fill="black" stroke="black" points="5178.22,-4348.97 5167.66,-4349.82 5176.45,-4355.74 5178.22,-4348.97"/>
</g>
<!-- layer_1_expert_3_up_proj -->
<g id="node118" class="node">
<title>layer_1_expert_3_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="5616,-4349.74 5245,-4349.74 5245,-4281.74 5616,-4281.74 5616,-4349.74"/>
<text text-anchor="middle" x="5430.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 3 Up Proj</text>
<text text-anchor="middle" x="5430.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5430.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5430.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_expert_3&#45;&gt;layer_1_expert_3_up_proj -->
<g id="edge160" class="edge">
<title>layer_1_expert_3&#45;&gt;layer_1_expert_3_up_proj</title>
<path fill="none" stroke="black" d="M5430.5,-4385.62C5430.5,-4377.52 5430.5,-4368.72 5430.5,-4360.21"/>
<polygon fill="black" stroke="black" points="5434,-4360.04 5430.5,-4350.04 5427,-4360.04 5434,-4360.04"/>
</g>
<!-- layer_1_expert_3_activation -->
<g id="node119" class="node">
<title>layer_1_expert_3_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="5616,-4245.74 5245,-4245.74 5245,-4177.74 5616,-4177.74 5616,-4245.74"/>
<text text-anchor="middle" x="5430.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="5430.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5430.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5430.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_expert_3_gate_proj&#45;&gt;layer_1_expert_3_activation -->
<g id="edge159" class="edge">
<title>layer_1_expert_3_gate_proj&#45;&gt;layer_1_expert_3_activation</title>
<path fill="none" stroke="black" d="M5167.53,-4281.69C5208.1,-4271.05 5253.24,-4259.22 5294.49,-4248.4"/>
<polygon fill="black" stroke="black" points="5295.55,-4251.74 5304.34,-4245.82 5293.78,-4244.97 5295.55,-4251.74"/>
</g>
<!-- layer_1_expert_3_up_proj&#45;&gt;layer_1_expert_3_activation -->
<g id="edge161" class="edge">
<title>layer_1_expert_3_up_proj&#45;&gt;layer_1_expert_3_activation</title>
<path fill="none" stroke="black" d="M5430.5,-4281.62C5430.5,-4273.52 5430.5,-4264.72 5430.5,-4256.21"/>
<polygon fill="black" stroke="black" points="5434,-4256.04 5430.5,-4246.04 5427,-4256.04 5434,-4256.04"/>
</g>
<!-- layer_1_expert_3_down_proj -->
<g id="node120" class="node">
<title>layer_1_expert_3_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7179,-4141.74 6808,-4141.74 6808,-4073.74 7179,-4073.74 7179,-4141.74"/>
<text text-anchor="middle" x="6993.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 3 Down Proj</text>
<text text-anchor="middle" x="6993.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6993.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6993.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_1_expert_3_activation&#45;&gt;layer_1_expert_3_down_proj -->
<g id="edge162" class="edge">
<title>layer_1_expert_3_activation&#45;&gt;layer_1_expert_3_down_proj</title>
<path fill="none" stroke="black" d="M5616.32,-4198.61C5913.71,-4179.21 6493.91,-4141.34 6797.57,-4121.53"/>
<polygon fill="black" stroke="black" points="6798.06,-4125 6807.81,-4120.86 6797.6,-4118.02 6798.06,-4125"/>
</g>
<!-- layer_1_expert_3_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge163" class="edge">
<title>layer_1_expert_3_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M7179.4,-4089.77C7243.7,-4084.22 7316.24,-4078.32 7382.5,-4073.74 7921.96,-4036.49 8546.97,-4005.36 8936.59,-3987.38"/>
<polygon fill="black" stroke="black" points="8936.78,-3990.87 8946.61,-3986.92 8936.46,-3983.88 8936.78,-3990.87"/>
</g>
<!-- layer_1_expert_4_gate_proj -->
<g id="node122" class="node">
<title>layer_1_expert_4_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6005,-4349.74 5634,-4349.74 5634,-4281.74 6005,-4281.74 6005,-4349.74"/>
<text text-anchor="middle" x="5819.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 4 Gate Proj</text>
<text text-anchor="middle" x="5819.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5819.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5819.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_expert_4&#45;&gt;layer_1_expert_4_gate_proj -->
<g id="edge165" class="edge">
<title>layer_1_expert_4&#45;&gt;layer_1_expert_4_gate_proj</title>
<path fill="none" stroke="black" d="M6082.47,-4385.69C6041.9,-4375.05 5996.76,-4363.22 5955.51,-4352.4"/>
<polygon fill="black" stroke="black" points="5956.22,-4348.97 5945.66,-4349.82 5954.45,-4355.74 5956.22,-4348.97"/>
</g>
<!-- layer_1_expert_4_up_proj -->
<g id="node123" class="node">
<title>layer_1_expert_4_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6394,-4349.74 6023,-4349.74 6023,-4281.74 6394,-4281.74 6394,-4349.74"/>
<text text-anchor="middle" x="6208.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 4 Up Proj</text>
<text text-anchor="middle" x="6208.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6208.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6208.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_expert_4&#45;&gt;layer_1_expert_4_up_proj -->
<g id="edge167" class="edge">
<title>layer_1_expert_4&#45;&gt;layer_1_expert_4_up_proj</title>
<path fill="none" stroke="black" d="M6208.5,-4385.62C6208.5,-4377.52 6208.5,-4368.72 6208.5,-4360.21"/>
<polygon fill="black" stroke="black" points="6212,-4360.04 6208.5,-4350.04 6205,-4360.04 6212,-4360.04"/>
</g>
<!-- layer_1_expert_4_activation -->
<g id="node124" class="node">
<title>layer_1_expert_4_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="6394,-4245.74 6023,-4245.74 6023,-4177.74 6394,-4177.74 6394,-4245.74"/>
<text text-anchor="middle" x="6208.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 4 GELU Activation</text>
<text text-anchor="middle" x="6208.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6208.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6208.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_expert_4_gate_proj&#45;&gt;layer_1_expert_4_activation -->
<g id="edge166" class="edge">
<title>layer_1_expert_4_gate_proj&#45;&gt;layer_1_expert_4_activation</title>
<path fill="none" stroke="black" d="M5945.53,-4281.69C5986.1,-4271.05 6031.24,-4259.22 6072.49,-4248.4"/>
<polygon fill="black" stroke="black" points="6073.55,-4251.74 6082.34,-4245.82 6071.78,-4244.97 6073.55,-4251.74"/>
</g>
<!-- layer_1_expert_4_up_proj&#45;&gt;layer_1_expert_4_activation -->
<g id="edge168" class="edge">
<title>layer_1_expert_4_up_proj&#45;&gt;layer_1_expert_4_activation</title>
<path fill="none" stroke="black" d="M6208.5,-4281.62C6208.5,-4273.52 6208.5,-4264.72 6208.5,-4256.21"/>
<polygon fill="black" stroke="black" points="6212,-4256.04 6208.5,-4246.04 6205,-4256.04 6212,-4256.04"/>
</g>
<!-- layer_1_expert_4_down_proj -->
<g id="node125" class="node">
<title>layer_1_expert_4_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7762,-4141.74 7391,-4141.74 7391,-4073.74 7762,-4073.74 7762,-4141.74"/>
<text text-anchor="middle" x="7576.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 4 Down Proj</text>
<text text-anchor="middle" x="7576.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7576.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7576.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_1_expert_4_activation&#45;&gt;layer_1_expert_4_down_proj -->
<g id="edge169" class="edge">
<title>layer_1_expert_4_activation&#45;&gt;layer_1_expert_4_down_proj</title>
<path fill="none" stroke="black" d="M6394.42,-4198.43C6591.39,-4185.2 6911.45,-4163.18 7187.5,-4141.74 7250.23,-4136.87 7318.62,-4131.19 7380.31,-4125.93"/>
<polygon fill="black" stroke="black" points="7380.88,-4129.4 7390.55,-4125.06 7380.29,-4122.42 7380.88,-4129.4"/>
</g>
<!-- layer_1_expert_4_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge170" class="edge">
<title>layer_1_expert_4_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M7762.14,-4084.59C7797.43,-4080.71 7834.08,-4076.91 7868.5,-4073.74 8233.67,-4040.11 8651.6,-4011.4 8943.93,-3992.9"/>
<polygon fill="black" stroke="black" points="8944.51,-3996.37 8954.27,-3992.24 8944.07,-3989.38 8944.51,-3996.37"/>
</g>
<!-- layer_1_expert_5_gate_proj -->
<g id="node127" class="node">
<title>layer_1_expert_5_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6783,-4349.74 6412,-4349.74 6412,-4281.74 6783,-4281.74 6783,-4349.74"/>
<text text-anchor="middle" x="6597.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 5 Gate Proj</text>
<text text-anchor="middle" x="6597.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6597.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6597.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_expert_5&#45;&gt;layer_1_expert_5_gate_proj -->
<g id="edge172" class="edge">
<title>layer_1_expert_5&#45;&gt;layer_1_expert_5_gate_proj</title>
<path fill="none" stroke="black" d="M6860.47,-4385.69C6819.9,-4375.05 6774.76,-4363.22 6733.51,-4352.4"/>
<polygon fill="black" stroke="black" points="6734.22,-4348.97 6723.66,-4349.82 6732.45,-4355.74 6734.22,-4348.97"/>
</g>
<!-- layer_1_expert_5_up_proj -->
<g id="node128" class="node">
<title>layer_1_expert_5_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7172,-4349.74 6801,-4349.74 6801,-4281.74 7172,-4281.74 7172,-4349.74"/>
<text text-anchor="middle" x="6986.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 5 Up Proj</text>
<text text-anchor="middle" x="6986.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6986.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6986.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_expert_5&#45;&gt;layer_1_expert_5_up_proj -->
<g id="edge174" class="edge">
<title>layer_1_expert_5&#45;&gt;layer_1_expert_5_up_proj</title>
<path fill="none" stroke="black" d="M6986.5,-4385.62C6986.5,-4377.52 6986.5,-4368.72 6986.5,-4360.21"/>
<polygon fill="black" stroke="black" points="6990,-4360.04 6986.5,-4350.04 6983,-4360.04 6990,-4360.04"/>
</g>
<!-- layer_1_expert_5_activation -->
<g id="node129" class="node">
<title>layer_1_expert_5_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="7172,-4245.74 6801,-4245.74 6801,-4177.74 7172,-4177.74 7172,-4245.74"/>
<text text-anchor="middle" x="6986.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 5 GELU Activation</text>
<text text-anchor="middle" x="6986.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6986.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6986.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_expert_5_gate_proj&#45;&gt;layer_1_expert_5_activation -->
<g id="edge173" class="edge">
<title>layer_1_expert_5_gate_proj&#45;&gt;layer_1_expert_5_activation</title>
<path fill="none" stroke="black" d="M6723.53,-4281.69C6764.1,-4271.05 6809.24,-4259.22 6850.49,-4248.4"/>
<polygon fill="black" stroke="black" points="6851.55,-4251.74 6860.34,-4245.82 6849.78,-4244.97 6851.55,-4251.74"/>
</g>
<!-- layer_1_expert_5_up_proj&#45;&gt;layer_1_expert_5_activation -->
<g id="edge175" class="edge">
<title>layer_1_expert_5_up_proj&#45;&gt;layer_1_expert_5_activation</title>
<path fill="none" stroke="black" d="M6986.5,-4281.62C6986.5,-4273.52 6986.5,-4264.72 6986.5,-4256.21"/>
<polygon fill="black" stroke="black" points="6990,-4256.04 6986.5,-4246.04 6983,-4256.04 6990,-4256.04"/>
</g>
<!-- layer_1_expert_5_down_proj -->
<g id="node130" class="node">
<title>layer_1_expert_5_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8248,-4141.74 7877,-4141.74 7877,-4073.74 8248,-4073.74 8248,-4141.74"/>
<text text-anchor="middle" x="8062.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 5 Down Proj</text>
<text text-anchor="middle" x="8062.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8062.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8062.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_1_expert_5_activation&#45;&gt;layer_1_expert_5_down_proj -->
<g id="edge176" class="edge">
<title>layer_1_expert_5_activation&#45;&gt;layer_1_expert_5_down_proj</title>
<path fill="none" stroke="black" d="M7172.2,-4195.75C7331.34,-4182.58 7566.64,-4162.36 7771.5,-4141.74 7802.2,-4138.65 7834.69,-4135.17 7866.41,-4131.66"/>
<polygon fill="black" stroke="black" points="7867.13,-4135.1 7876.68,-4130.52 7866.35,-4128.15 7867.13,-4135.1"/>
</g>
<!-- layer_1_expert_5_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge177" class="edge">
<title>layer_1_expert_5_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M8248.26,-4080.98C8267.91,-4078.44 8287.61,-4075.98 8306.5,-4073.74 8523.49,-4047.99 8767.22,-4022.98 8960.66,-4004.05"/>
<polygon fill="black" stroke="black" points="8961.09,-4007.52 8970.7,-4003.07 8960.41,-4000.56 8961.09,-4007.52"/>
</g>
<!-- layer_1_expert_6_gate_proj -->
<g id="node132" class="node">
<title>layer_1_expert_6_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7561,-4349.74 7190,-4349.74 7190,-4281.74 7561,-4281.74 7561,-4349.74"/>
<text text-anchor="middle" x="7375.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 6 Gate Proj</text>
<text text-anchor="middle" x="7375.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7375.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7375.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_expert_6&#45;&gt;layer_1_expert_6_gate_proj -->
<g id="edge179" class="edge">
<title>layer_1_expert_6&#45;&gt;layer_1_expert_6_gate_proj</title>
<path fill="none" stroke="black" d="M7638.47,-4385.69C7597.9,-4375.05 7552.76,-4363.22 7511.51,-4352.4"/>
<polygon fill="black" stroke="black" points="7512.22,-4348.97 7501.66,-4349.82 7510.45,-4355.74 7512.22,-4348.97"/>
</g>
<!-- layer_1_expert_6_up_proj -->
<g id="node133" class="node">
<title>layer_1_expert_6_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7950,-4349.74 7579,-4349.74 7579,-4281.74 7950,-4281.74 7950,-4349.74"/>
<text text-anchor="middle" x="7764.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 6 Up Proj</text>
<text text-anchor="middle" x="7764.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7764.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7764.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_expert_6&#45;&gt;layer_1_expert_6_up_proj -->
<g id="edge181" class="edge">
<title>layer_1_expert_6&#45;&gt;layer_1_expert_6_up_proj</title>
<path fill="none" stroke="black" d="M7764.5,-4385.62C7764.5,-4377.52 7764.5,-4368.72 7764.5,-4360.21"/>
<polygon fill="black" stroke="black" points="7768,-4360.04 7764.5,-4350.04 7761,-4360.04 7768,-4360.04"/>
</g>
<!-- layer_1_expert_6_activation -->
<g id="node134" class="node">
<title>layer_1_expert_6_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="7950,-4245.74 7579,-4245.74 7579,-4177.74 7950,-4177.74 7950,-4245.74"/>
<text text-anchor="middle" x="7764.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 6 GELU Activation</text>
<text text-anchor="middle" x="7764.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7764.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7764.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_expert_6_gate_proj&#45;&gt;layer_1_expert_6_activation -->
<g id="edge180" class="edge">
<title>layer_1_expert_6_gate_proj&#45;&gt;layer_1_expert_6_activation</title>
<path fill="none" stroke="black" d="M7501.53,-4281.69C7542.1,-4271.05 7587.24,-4259.22 7628.49,-4248.4"/>
<polygon fill="black" stroke="black" points="7629.55,-4251.74 7638.34,-4245.82 7627.78,-4244.97 7629.55,-4251.74"/>
</g>
<!-- layer_1_expert_6_up_proj&#45;&gt;layer_1_expert_6_activation -->
<g id="edge182" class="edge">
<title>layer_1_expert_6_up_proj&#45;&gt;layer_1_expert_6_activation</title>
<path fill="none" stroke="black" d="M7764.5,-4281.62C7764.5,-4273.52 7764.5,-4264.72 7764.5,-4256.21"/>
<polygon fill="black" stroke="black" points="7768,-4256.04 7764.5,-4246.04 7761,-4256.04 7768,-4256.04"/>
</g>
<!-- layer_1_expert_6_down_proj -->
<g id="node135" class="node">
<title>layer_1_expert_6_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8686,-4141.74 8315,-4141.74 8315,-4073.74 8686,-4073.74 8686,-4141.74"/>
<text text-anchor="middle" x="8500.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 6 Down Proj</text>
<text text-anchor="middle" x="8500.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8500.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8500.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_1_expert_6_activation&#45;&gt;layer_1_expert_6_down_proj -->
<g id="edge183" class="edge">
<title>layer_1_expert_6_activation&#45;&gt;layer_1_expert_6_down_proj</title>
<path fill="none" stroke="black" d="M7950.22,-4185C8058.42,-4170.01 8194.74,-4151.12 8304.62,-4135.89"/>
<polygon fill="black" stroke="black" points="8305.41,-4139.31 8314.84,-4134.47 8304.45,-4132.38 8305.41,-4139.31"/>
</g>
<!-- layer_1_expert_6_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge184" class="edge">
<title>layer_1_expert_6_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M8686.23,-4075.71C8776.23,-4060.67 8886.98,-4042.17 8990.29,-4024.91"/>
<polygon fill="black" stroke="black" points="8990.98,-4028.34 9000.26,-4023.24 8989.82,-4021.44 8990.98,-4028.34"/>
</g>
<!-- layer_1_expert_7_gate_proj -->
<g id="node137" class="node">
<title>layer_1_expert_7_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8339,-4349.74 7968,-4349.74 7968,-4281.74 8339,-4281.74 8339,-4349.74"/>
<text text-anchor="middle" x="8153.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 7 Gate Proj</text>
<text text-anchor="middle" x="8153.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8153.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8153.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_expert_7&#45;&gt;layer_1_expert_7_gate_proj -->
<g id="edge186" class="edge">
<title>layer_1_expert_7&#45;&gt;layer_1_expert_7_gate_proj</title>
<path fill="none" stroke="black" d="M8416.47,-4385.69C8375.9,-4375.05 8330.76,-4363.22 8289.51,-4352.4"/>
<polygon fill="black" stroke="black" points="8290.22,-4348.97 8279.66,-4349.82 8288.45,-4355.74 8290.22,-4348.97"/>
</g>
<!-- layer_1_expert_7_up_proj -->
<g id="node138" class="node">
<title>layer_1_expert_7_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8728,-4349.74 8357,-4349.74 8357,-4281.74 8728,-4281.74 8728,-4349.74"/>
<text text-anchor="middle" x="8542.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 7 Up Proj</text>
<text text-anchor="middle" x="8542.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8542.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8542.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_expert_7&#45;&gt;layer_1_expert_7_up_proj -->
<g id="edge188" class="edge">
<title>layer_1_expert_7&#45;&gt;layer_1_expert_7_up_proj</title>
<path fill="none" stroke="black" d="M8542.5,-4385.62C8542.5,-4377.52 8542.5,-4368.72 8542.5,-4360.21"/>
<polygon fill="black" stroke="black" points="8546,-4360.04 8542.5,-4350.04 8539,-4360.04 8546,-4360.04"/>
</g>
<!-- layer_1_expert_7_activation -->
<g id="node139" class="node">
<title>layer_1_expert_7_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="8728,-4245.74 8357,-4245.74 8357,-4177.74 8728,-4177.74 8728,-4245.74"/>
<text text-anchor="middle" x="8542.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 7 GELU Activation</text>
<text text-anchor="middle" x="8542.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8542.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8542.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_expert_7_gate_proj&#45;&gt;layer_1_expert_7_activation -->
<g id="edge187" class="edge">
<title>layer_1_expert_7_gate_proj&#45;&gt;layer_1_expert_7_activation</title>
<path fill="none" stroke="black" d="M8279.53,-4281.69C8320.1,-4271.05 8365.24,-4259.22 8406.49,-4248.4"/>
<polygon fill="black" stroke="black" points="8407.55,-4251.74 8416.34,-4245.82 8405.78,-4244.97 8407.55,-4251.74"/>
</g>
<!-- layer_1_expert_7_up_proj&#45;&gt;layer_1_expert_7_activation -->
<g id="edge189" class="edge">
<title>layer_1_expert_7_up_proj&#45;&gt;layer_1_expert_7_activation</title>
<path fill="none" stroke="black" d="M8542.5,-4281.62C8542.5,-4273.52 8542.5,-4264.72 8542.5,-4256.21"/>
<polygon fill="black" stroke="black" points="8546,-4256.04 8542.5,-4246.04 8539,-4256.04 8546,-4256.04"/>
</g>
<!-- layer_1_expert_7_down_proj -->
<g id="node140" class="node">
<title>layer_1_expert_7_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9099,-4141.74 8728,-4141.74 8728,-4073.74 9099,-4073.74 9099,-4141.74"/>
<text text-anchor="middle" x="8913.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 7 Down Proj</text>
<text text-anchor="middle" x="8913.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8913.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8913.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_1_expert_7_activation&#45;&gt;layer_1_expert_7_down_proj -->
<g id="edge190" class="edge">
<title>layer_1_expert_7_activation&#45;&gt;layer_1_expert_7_down_proj</title>
<path fill="none" stroke="black" d="M8662.7,-4177.69C8701.23,-4167.1 8744.07,-4155.32 8783.29,-4144.54"/>
<polygon fill="black" stroke="black" points="8784.46,-4147.85 8793.18,-4141.82 8782.61,-4141.1 8784.46,-4147.85"/>
</g>
<!-- layer_1_expert_7_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge191" class="edge">
<title>layer_1_expert_7_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M9010.83,-4073.73C9040.17,-4063.78 9073.57,-4052.45 9107.23,-4041.04"/>
<polygon fill="black" stroke="black" points="9108.38,-4044.34 9116.72,-4037.82 9106.13,-4037.71 9108.38,-4044.34"/>
</g>
<!-- layer_1_expert_8_gate_proj -->
<g id="node142" class="node">
<title>layer_1_expert_8_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9117,-4349.74 8746,-4349.74 8746,-4281.74 9117,-4281.74 9117,-4349.74"/>
<text text-anchor="middle" x="8931.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 8 Gate Proj</text>
<text text-anchor="middle" x="8931.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8931.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8931.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_expert_8&#45;&gt;layer_1_expert_8_gate_proj -->
<g id="edge193" class="edge">
<title>layer_1_expert_8&#45;&gt;layer_1_expert_8_gate_proj</title>
<path fill="none" stroke="black" d="M9062.51,-4385.62C9043.7,-4375.73 9022.93,-4364.81 9003.58,-4354.64"/>
<polygon fill="black" stroke="black" points="9004.98,-4351.42 8994.5,-4349.86 9001.72,-4357.62 9004.98,-4351.42"/>
</g>
<!-- layer_1_expert_8_up_proj -->
<g id="node143" class="node">
<title>layer_1_expert_8_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9506,-4349.74 9135,-4349.74 9135,-4281.74 9506,-4281.74 9506,-4349.74"/>
<text text-anchor="middle" x="9320.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 8 Up Proj</text>
<text text-anchor="middle" x="9320.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9320.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9320.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_expert_8&#45;&gt;layer_1_expert_8_up_proj -->
<g id="edge195" class="edge">
<title>layer_1_expert_8&#45;&gt;layer_1_expert_8_up_proj</title>
<path fill="none" stroke="black" d="M9188.81,-4385.62C9207.72,-4375.73 9228.6,-4364.81 9248.05,-4354.64"/>
<polygon fill="black" stroke="black" points="9249.93,-4357.6 9257.17,-4349.86 9246.69,-4351.4 9249.93,-4357.6"/>
</g>
<!-- layer_1_expert_8_activation -->
<g id="node144" class="node">
<title>layer_1_expert_8_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="9500,-4245.74 9129,-4245.74 9129,-4177.74 9500,-4177.74 9500,-4245.74"/>
<text text-anchor="middle" x="9314.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 8 GELU Activation</text>
<text text-anchor="middle" x="9314.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9314.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9314.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_expert_8_gate_proj&#45;&gt;layer_1_expert_8_activation -->
<g id="edge194" class="edge">
<title>layer_1_expert_8_gate_proj&#45;&gt;layer_1_expert_8_activation</title>
<path fill="none" stroke="black" d="M9055.58,-4281.69C9095.53,-4271.05 9139.97,-4259.22 9180.59,-4248.4"/>
<polygon fill="black" stroke="black" points="9181.52,-4251.78 9190.28,-4245.82 9179.72,-4245.01 9181.52,-4251.78"/>
</g>
<!-- layer_1_expert_8_up_proj&#45;&gt;layer_1_expert_8_activation -->
<g id="edge196" class="edge">
<title>layer_1_expert_8_up_proj&#45;&gt;layer_1_expert_8_activation</title>
<path fill="none" stroke="black" d="M9318.55,-4281.62C9318.08,-4273.52 9317.56,-4264.72 9317.06,-4256.21"/>
<polygon fill="black" stroke="black" points="9320.54,-4255.82 9316.46,-4246.04 9313.55,-4256.23 9320.54,-4255.82"/>
</g>
<!-- layer_1_expert_8_down_proj -->
<g id="node145" class="node">
<title>layer_1_expert_8_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9500,-4141.74 9129,-4141.74 9129,-4073.74 9500,-4073.74 9500,-4141.74"/>
<text text-anchor="middle" x="9314.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 8 Down Proj</text>
<text text-anchor="middle" x="9314.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9314.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9314.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_1_expert_8_activation&#45;&gt;layer_1_expert_8_down_proj -->
<g id="edge197" class="edge">
<title>layer_1_expert_8_activation&#45;&gt;layer_1_expert_8_down_proj</title>
<path fill="none" stroke="black" d="M9314.5,-4177.62C9314.5,-4169.52 9314.5,-4160.72 9314.5,-4152.21"/>
<polygon fill="black" stroke="black" points="9318,-4152.04 9314.5,-4142.04 9311,-4152.04 9318,-4152.04"/>
</g>
<!-- layer_1_expert_8_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge198" class="edge">
<title>layer_1_expert_8_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M9314.5,-4073.47C9314.5,-4065.64 9314.5,-4056.98 9314.5,-4048.09"/>
<polygon fill="black" stroke="black" points="9318,-4048 9314.5,-4038 9311,-4048 9318,-4048"/>
</g>
<!-- layer_1_expert_9_gate_proj -->
<g id="node147" class="node">
<title>layer_1_expert_9_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9895,-4349.74 9524,-4349.74 9524,-4281.74 9895,-4281.74 9895,-4349.74"/>
<text text-anchor="middle" x="9709.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 9 Gate Proj</text>
<text text-anchor="middle" x="9709.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9709.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9709.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_expert_9&#45;&gt;layer_1_expert_9_gate_proj -->
<g id="edge200" class="edge">
<title>layer_1_expert_9&#45;&gt;layer_1_expert_9_gate_proj</title>
<path fill="none" stroke="black" d="M9709.5,-4385.62C9709.5,-4377.52 9709.5,-4368.72 9709.5,-4360.21"/>
<polygon fill="black" stroke="black" points="9713,-4360.04 9709.5,-4350.04 9706,-4360.04 9713,-4360.04"/>
</g>
<!-- layer_1_expert_9_up_proj -->
<g id="node148" class="node">
<title>layer_1_expert_9_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10284,-4349.74 9913,-4349.74 9913,-4281.74 10284,-4281.74 10284,-4349.74"/>
<text text-anchor="middle" x="10098.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 9 Up Proj</text>
<text text-anchor="middle" x="10098.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10098.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10098.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_expert_9&#45;&gt;layer_1_expert_9_up_proj -->
<g id="edge202" class="edge">
<title>layer_1_expert_9&#45;&gt;layer_1_expert_9_up_proj</title>
<path fill="none" stroke="black" d="M9835.53,-4385.69C9876.1,-4375.05 9921.24,-4363.22 9962.49,-4352.4"/>
<polygon fill="black" stroke="black" points="9963.55,-4355.74 9972.34,-4349.82 9961.78,-4348.97 9963.55,-4355.74"/>
</g>
<!-- layer_1_expert_9_activation -->
<g id="node149" class="node">
<title>layer_1_expert_9_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="9895,-4245.74 9524,-4245.74 9524,-4177.74 9895,-4177.74 9895,-4245.74"/>
<text text-anchor="middle" x="9709.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 9 GELU Activation</text>
<text text-anchor="middle" x="9709.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9709.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9709.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_expert_9_gate_proj&#45;&gt;layer_1_expert_9_activation -->
<g id="edge201" class="edge">
<title>layer_1_expert_9_gate_proj&#45;&gt;layer_1_expert_9_activation</title>
<path fill="none" stroke="black" d="M9709.5,-4281.62C9709.5,-4273.52 9709.5,-4264.72 9709.5,-4256.21"/>
<polygon fill="black" stroke="black" points="9713,-4256.04 9709.5,-4246.04 9706,-4256.04 9713,-4256.04"/>
</g>
<!-- layer_1_expert_9_up_proj&#45;&gt;layer_1_expert_9_activation -->
<g id="edge203" class="edge">
<title>layer_1_expert_9_up_proj&#45;&gt;layer_1_expert_9_activation</title>
<path fill="none" stroke="black" d="M9972.47,-4281.69C9931.9,-4271.05 9886.76,-4259.22 9845.51,-4248.4"/>
<polygon fill="black" stroke="black" points="9846.22,-4244.97 9835.66,-4245.82 9844.45,-4251.74 9846.22,-4244.97"/>
</g>
<!-- layer_1_expert_9_down_proj -->
<g id="node150" class="node">
<title>layer_1_expert_9_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9889,-4141.74 9518,-4141.74 9518,-4073.74 9889,-4073.74 9889,-4141.74"/>
<text text-anchor="middle" x="9703.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 9 Down Proj</text>
<text text-anchor="middle" x="9703.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9703.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9703.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_1_expert_9_activation&#45;&gt;layer_1_expert_9_down_proj -->
<g id="edge204" class="edge">
<title>layer_1_expert_9_activation&#45;&gt;layer_1_expert_9_down_proj</title>
<path fill="none" stroke="black" d="M9707.55,-4177.62C9707.08,-4169.52 9706.56,-4160.72 9706.06,-4152.21"/>
<polygon fill="black" stroke="black" points="9709.54,-4151.82 9705.46,-4142.04 9702.55,-4152.23 9709.54,-4151.82"/>
</g>
<!-- layer_1_expert_9_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge205" class="edge">
<title>layer_1_expert_9_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M9608.84,-4073.64C9580.49,-4063.73 9548.26,-4052.46 9515.77,-4041.11"/>
<polygon fill="black" stroke="black" points="9516.74,-4037.74 9506.15,-4037.74 9514.43,-4044.35 9516.74,-4037.74"/>
</g>
<!-- layer_1_expert_10_gate_proj -->
<g id="node152" class="node">
<title>layer_1_expert_10_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10673,-4349.74 10302,-4349.74 10302,-4281.74 10673,-4281.74 10673,-4349.74"/>
<text text-anchor="middle" x="10487.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 10 Gate Proj</text>
<text text-anchor="middle" x="10487.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10487.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10487.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_expert_10&#45;&gt;layer_1_expert_10_gate_proj -->
<g id="edge207" class="edge">
<title>layer_1_expert_10&#45;&gt;layer_1_expert_10_gate_proj</title>
<path fill="none" stroke="black" d="M10487.5,-4385.62C10487.5,-4377.52 10487.5,-4368.72 10487.5,-4360.21"/>
<polygon fill="black" stroke="black" points="10491,-4360.04 10487.5,-4350.04 10484,-4360.04 10491,-4360.04"/>
</g>
<!-- layer_1_expert_10_up_proj -->
<g id="node153" class="node">
<title>layer_1_expert_10_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11062,-4349.74 10691,-4349.74 10691,-4281.74 11062,-4281.74 11062,-4349.74"/>
<text text-anchor="middle" x="10876.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 10 Up Proj</text>
<text text-anchor="middle" x="10876.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10876.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10876.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_expert_10&#45;&gt;layer_1_expert_10_up_proj -->
<g id="edge209" class="edge">
<title>layer_1_expert_10&#45;&gt;layer_1_expert_10_up_proj</title>
<path fill="none" stroke="black" d="M10613.53,-4385.69C10654.1,-4375.05 10699.24,-4363.22 10740.49,-4352.4"/>
<polygon fill="black" stroke="black" points="10741.55,-4355.74 10750.34,-4349.82 10739.78,-4348.97 10741.55,-4355.74"/>
</g>
<!-- layer_1_expert_10_activation -->
<g id="node154" class="node">
<title>layer_1_expert_10_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="10673,-4245.74 10302,-4245.74 10302,-4177.74 10673,-4177.74 10673,-4245.74"/>
<text text-anchor="middle" x="10487.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 10 GELU Activation</text>
<text text-anchor="middle" x="10487.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10487.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10487.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_expert_10_gate_proj&#45;&gt;layer_1_expert_10_activation -->
<g id="edge208" class="edge">
<title>layer_1_expert_10_gate_proj&#45;&gt;layer_1_expert_10_activation</title>
<path fill="none" stroke="black" d="M10487.5,-4281.62C10487.5,-4273.52 10487.5,-4264.72 10487.5,-4256.21"/>
<polygon fill="black" stroke="black" points="10491,-4256.04 10487.5,-4246.04 10484,-4256.04 10491,-4256.04"/>
</g>
<!-- layer_1_expert_10_up_proj&#45;&gt;layer_1_expert_10_activation -->
<g id="edge210" class="edge">
<title>layer_1_expert_10_up_proj&#45;&gt;layer_1_expert_10_activation</title>
<path fill="none" stroke="black" d="M10750.47,-4281.69C10709.9,-4271.05 10664.76,-4259.22 10623.51,-4248.4"/>
<polygon fill="black" stroke="black" points="10624.22,-4244.97 10613.66,-4245.82 10622.45,-4251.74 10624.22,-4244.97"/>
</g>
<!-- layer_1_expert_10_down_proj -->
<g id="node155" class="node">
<title>layer_1_expert_10_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10476,-4141.74 10105,-4141.74 10105,-4073.74 10476,-4073.74 10476,-4141.74"/>
<text text-anchor="middle" x="10290.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 10 Down Proj</text>
<text text-anchor="middle" x="10290.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10290.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10290.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_1_expert_10_activation&#45;&gt;layer_1_expert_10_down_proj -->
<g id="edge211" class="edge">
<title>layer_1_expert_10_activation&#45;&gt;layer_1_expert_10_down_proj</title>
<path fill="none" stroke="black" d="M10423.54,-4177.62C10404.35,-4167.69 10383.15,-4156.71 10363.42,-4146.5"/>
<polygon fill="black" stroke="black" points="10364.97,-4143.35 10354.48,-4141.86 10361.75,-4149.57 10364.97,-4143.35"/>
</g>
<!-- layer_1_expert_10_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge212" class="edge">
<title>layer_1_expert_10_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M10104.91,-4080.88C10018.91,-4068.9 9912.23,-4054.03 9805.37,-4039.14"/>
<polygon fill="black" stroke="black" points="9805.75,-4035.66 9795.36,-4037.75 9804.78,-4042.59 9805.75,-4035.66"/>
</g>
<!-- layer_1_expert_11_gate_proj -->
<g id="node157" class="node">
<title>layer_1_expert_11_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11451,-4349.74 11080,-4349.74 11080,-4281.74 11451,-4281.74 11451,-4349.74"/>
<text text-anchor="middle" x="11265.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 11 Gate Proj</text>
<text text-anchor="middle" x="11265.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11265.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11265.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_expert_11&#45;&gt;layer_1_expert_11_gate_proj -->
<g id="edge214" class="edge">
<title>layer_1_expert_11&#45;&gt;layer_1_expert_11_gate_proj</title>
<path fill="none" stroke="black" d="M11265.5,-4385.62C11265.5,-4377.52 11265.5,-4368.72 11265.5,-4360.21"/>
<polygon fill="black" stroke="black" points="11269,-4360.04 11265.5,-4350.04 11262,-4360.04 11269,-4360.04"/>
</g>
<!-- layer_1_expert_11_up_proj -->
<g id="node158" class="node">
<title>layer_1_expert_11_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11840,-4349.74 11469,-4349.74 11469,-4281.74 11840,-4281.74 11840,-4349.74"/>
<text text-anchor="middle" x="11654.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 11 Up Proj</text>
<text text-anchor="middle" x="11654.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11654.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11654.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_expert_11&#45;&gt;layer_1_expert_11_up_proj -->
<g id="edge216" class="edge">
<title>layer_1_expert_11&#45;&gt;layer_1_expert_11_up_proj</title>
<path fill="none" stroke="black" d="M11391.53,-4385.69C11432.1,-4375.05 11477.24,-4363.22 11518.49,-4352.4"/>
<polygon fill="black" stroke="black" points="11519.55,-4355.74 11528.34,-4349.82 11517.78,-4348.97 11519.55,-4355.74"/>
</g>
<!-- layer_1_expert_11_activation -->
<g id="node159" class="node">
<title>layer_1_expert_11_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="11451,-4245.74 11080,-4245.74 11080,-4177.74 11451,-4177.74 11451,-4245.74"/>
<text text-anchor="middle" x="11265.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 11 GELU Activation</text>
<text text-anchor="middle" x="11265.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11265.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11265.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_expert_11_gate_proj&#45;&gt;layer_1_expert_11_activation -->
<g id="edge215" class="edge">
<title>layer_1_expert_11_gate_proj&#45;&gt;layer_1_expert_11_activation</title>
<path fill="none" stroke="black" d="M11265.5,-4281.62C11265.5,-4273.52 11265.5,-4264.72 11265.5,-4256.21"/>
<polygon fill="black" stroke="black" points="11269,-4256.04 11265.5,-4246.04 11262,-4256.04 11269,-4256.04"/>
</g>
<!-- layer_1_expert_11_up_proj&#45;&gt;layer_1_expert_11_activation -->
<g id="edge217" class="edge">
<title>layer_1_expert_11_up_proj&#45;&gt;layer_1_expert_11_activation</title>
<path fill="none" stroke="black" d="M11528.47,-4281.69C11487.9,-4271.05 11442.76,-4259.22 11401.51,-4248.4"/>
<polygon fill="black" stroke="black" points="11402.22,-4244.97 11391.66,-4245.82 11400.45,-4251.74 11402.22,-4244.97"/>
</g>
<!-- layer_1_expert_11_down_proj -->
<g id="node160" class="node">
<title>layer_1_expert_11_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11158,-4141.74 10787,-4141.74 10787,-4073.74 11158,-4073.74 11158,-4141.74"/>
<text text-anchor="middle" x="10972.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 11 Down Proj</text>
<text text-anchor="middle" x="10972.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10972.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10972.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_1_expert_11_activation&#45;&gt;layer_1_expert_11_down_proj -->
<g id="edge218" class="edge">
<title>layer_1_expert_11_activation&#45;&gt;layer_1_expert_11_down_proj</title>
<path fill="none" stroke="black" d="M11170.37,-4177.62C11140.59,-4167.26 11107.57,-4155.76 11077.17,-4145.18"/>
<polygon fill="black" stroke="black" points="11078,-4141.76 11067.4,-4141.78 11075.7,-4148.37 11078,-4141.76"/>
</g>
<!-- layer_1_expert_11_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge219" class="edge">
<title>layer_1_expert_11_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M10786.73,-4091.5C10543.53,-4071.55 10108.92,-4035.9 9774.73,-4008.49"/>
<polygon fill="black" stroke="black" points="9774.63,-4004.97 9764.37,-4007.64 9774.05,-4011.95 9774.63,-4004.97"/>
</g>
<!-- layer_1_expert_12_gate_proj -->
<g id="node162" class="node">
<title>layer_1_expert_12_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12229,-4349.74 11858,-4349.74 11858,-4281.74 12229,-4281.74 12229,-4349.74"/>
<text text-anchor="middle" x="12043.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 12 Gate Proj</text>
<text text-anchor="middle" x="12043.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12043.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12043.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_expert_12&#45;&gt;layer_1_expert_12_gate_proj -->
<g id="edge221" class="edge">
<title>layer_1_expert_12&#45;&gt;layer_1_expert_12_gate_proj</title>
<path fill="none" stroke="black" d="M12043.5,-4385.62C12043.5,-4377.52 12043.5,-4368.72 12043.5,-4360.21"/>
<polygon fill="black" stroke="black" points="12047,-4360.04 12043.5,-4350.04 12040,-4360.04 12047,-4360.04"/>
</g>
<!-- layer_1_expert_12_up_proj -->
<g id="node163" class="node">
<title>layer_1_expert_12_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12618,-4349.74 12247,-4349.74 12247,-4281.74 12618,-4281.74 12618,-4349.74"/>
<text text-anchor="middle" x="12432.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 12 Up Proj</text>
<text text-anchor="middle" x="12432.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12432.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12432.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_expert_12&#45;&gt;layer_1_expert_12_up_proj -->
<g id="edge223" class="edge">
<title>layer_1_expert_12&#45;&gt;layer_1_expert_12_up_proj</title>
<path fill="none" stroke="black" d="M12169.53,-4385.69C12210.1,-4375.05 12255.24,-4363.22 12296.49,-4352.4"/>
<polygon fill="black" stroke="black" points="12297.55,-4355.74 12306.34,-4349.82 12295.78,-4348.97 12297.55,-4355.74"/>
</g>
<!-- layer_1_expert_12_activation -->
<g id="node164" class="node">
<title>layer_1_expert_12_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="12229,-4245.74 11858,-4245.74 11858,-4177.74 12229,-4177.74 12229,-4245.74"/>
<text text-anchor="middle" x="12043.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 12 GELU Activation</text>
<text text-anchor="middle" x="12043.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12043.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12043.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_expert_12_gate_proj&#45;&gt;layer_1_expert_12_activation -->
<g id="edge222" class="edge">
<title>layer_1_expert_12_gate_proj&#45;&gt;layer_1_expert_12_activation</title>
<path fill="none" stroke="black" d="M12043.5,-4281.62C12043.5,-4273.52 12043.5,-4264.72 12043.5,-4256.21"/>
<polygon fill="black" stroke="black" points="12047,-4256.04 12043.5,-4246.04 12040,-4256.04 12047,-4256.04"/>
</g>
<!-- layer_1_expert_12_up_proj&#45;&gt;layer_1_expert_12_activation -->
<g id="edge224" class="edge">
<title>layer_1_expert_12_up_proj&#45;&gt;layer_1_expert_12_activation</title>
<path fill="none" stroke="black" d="M12306.47,-4281.69C12265.9,-4271.05 12220.76,-4259.22 12179.51,-4248.4"/>
<polygon fill="black" stroke="black" points="12180.22,-4244.97 12169.66,-4245.82 12178.45,-4251.74 12180.22,-4244.97"/>
</g>
<!-- layer_1_expert_12_down_proj -->
<g id="node165" class="node">
<title>layer_1_expert_12_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11888,-4141.74 11517,-4141.74 11517,-4073.74 11888,-4073.74 11888,-4141.74"/>
<text text-anchor="middle" x="11702.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 12 Down Proj</text>
<text text-anchor="middle" x="11702.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11702.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11702.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_1_expert_12_activation&#45;&gt;layer_1_expert_12_down_proj -->
<g id="edge225" class="edge">
<title>layer_1_expert_12_activation&#45;&gt;layer_1_expert_12_down_proj</title>
<path fill="none" stroke="black" d="M11932.79,-4177.62C11897.68,-4167.12 11858.7,-4155.46 11822.94,-4144.77"/>
<polygon fill="black" stroke="black" points="11823.53,-4141.29 11812.95,-4141.78 11821.53,-4148 11823.53,-4141.29"/>
</g>
<!-- layer_1_expert_12_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge226" class="edge">
<title>layer_1_expert_12_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M11516.82,-4095.01C11413.9,-4088.58 11283.62,-4080.55 11167.5,-4073.74 10684.21,-4045.4 10129.9,-4014.85 9754.42,-3994.44"/>
<polygon fill="black" stroke="black" points="9754.37,-3990.93 9744.2,-3993.88 9753.99,-3997.92 9754.37,-3990.93"/>
</g>
<!-- layer_1_expert_13_gate_proj -->
<g id="node167" class="node">
<title>layer_1_expert_13_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13007,-4349.74 12636,-4349.74 12636,-4281.74 13007,-4281.74 13007,-4349.74"/>
<text text-anchor="middle" x="12821.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 13 Gate Proj</text>
<text text-anchor="middle" x="12821.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12821.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12821.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_expert_13&#45;&gt;layer_1_expert_13_gate_proj -->
<g id="edge228" class="edge">
<title>layer_1_expert_13&#45;&gt;layer_1_expert_13_gate_proj</title>
<path fill="none" stroke="black" d="M12821.5,-4385.62C12821.5,-4377.52 12821.5,-4368.72 12821.5,-4360.21"/>
<polygon fill="black" stroke="black" points="12825,-4360.04 12821.5,-4350.04 12818,-4360.04 12825,-4360.04"/>
</g>
<!-- layer_1_expert_13_up_proj -->
<g id="node168" class="node">
<title>layer_1_expert_13_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13396,-4349.74 13025,-4349.74 13025,-4281.74 13396,-4281.74 13396,-4349.74"/>
<text text-anchor="middle" x="13210.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 13 Up Proj</text>
<text text-anchor="middle" x="13210.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13210.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13210.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_expert_13&#45;&gt;layer_1_expert_13_up_proj -->
<g id="edge230" class="edge">
<title>layer_1_expert_13&#45;&gt;layer_1_expert_13_up_proj</title>
<path fill="none" stroke="black" d="M12947.53,-4385.69C12988.1,-4375.05 13033.24,-4363.22 13074.49,-4352.4"/>
<polygon fill="black" stroke="black" points="13075.55,-4355.74 13084.34,-4349.82 13073.78,-4348.97 13075.55,-4355.74"/>
</g>
<!-- layer_1_expert_13_activation -->
<g id="node169" class="node">
<title>layer_1_expert_13_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="13007,-4245.74 12636,-4245.74 12636,-4177.74 13007,-4177.74 13007,-4245.74"/>
<text text-anchor="middle" x="12821.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 13 GELU Activation</text>
<text text-anchor="middle" x="12821.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12821.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12821.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_expert_13_gate_proj&#45;&gt;layer_1_expert_13_activation -->
<g id="edge229" class="edge">
<title>layer_1_expert_13_gate_proj&#45;&gt;layer_1_expert_13_activation</title>
<path fill="none" stroke="black" d="M12821.5,-4281.62C12821.5,-4273.52 12821.5,-4264.72 12821.5,-4256.21"/>
<polygon fill="black" stroke="black" points="12825,-4256.04 12821.5,-4246.04 12818,-4256.04 12825,-4256.04"/>
</g>
<!-- layer_1_expert_13_up_proj&#45;&gt;layer_1_expert_13_activation -->
<g id="edge231" class="edge">
<title>layer_1_expert_13_up_proj&#45;&gt;layer_1_expert_13_activation</title>
<path fill="none" stroke="black" d="M13084.47,-4281.69C13043.9,-4271.05 12998.76,-4259.22 12957.51,-4248.4"/>
<polygon fill="black" stroke="black" points="12958.22,-4244.97 12947.66,-4245.82 12956.45,-4251.74 12958.22,-4244.97"/>
</g>
<!-- layer_1_expert_13_down_proj -->
<g id="node170" class="node">
<title>layer_1_expert_13_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12642,-4141.74 12271,-4141.74 12271,-4073.74 12642,-4073.74 12642,-4141.74"/>
<text text-anchor="middle" x="12456.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 13 Down Proj</text>
<text text-anchor="middle" x="12456.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12456.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12456.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_1_expert_13_activation&#45;&gt;layer_1_expert_13_down_proj -->
<g id="edge232" class="edge">
<title>layer_1_expert_13_activation&#45;&gt;layer_1_expert_13_down_proj</title>
<path fill="none" stroke="black" d="M12703.25,-4177.69C12665.34,-4167.1 12623.19,-4155.32 12584.6,-4144.54"/>
<polygon fill="black" stroke="black" points="12585.45,-4141.14 12574.88,-4141.82 12583.57,-4147.88 12585.45,-4141.14"/>
</g>
<!-- layer_1_expert_13_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge233" class="edge">
<title>layer_1_expert_13_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M12270.85,-4094.89C12162.08,-4088.17 12022.03,-4079.9 11897.5,-4073.74 11138.28,-4036.2 10252.99,-4003.24 9740.81,-3985.24"/>
<polygon fill="black" stroke="black" points="9740.78,-3981.74 9730.66,-3984.89 9740.53,-3988.74 9740.78,-3981.74"/>
</g>
<!-- layer_1_expert_14_gate_proj -->
<g id="node172" class="node">
<title>layer_1_expert_14_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13785,-4349.74 13414,-4349.74 13414,-4281.74 13785,-4281.74 13785,-4349.74"/>
<text text-anchor="middle" x="13599.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 14 Gate Proj</text>
<text text-anchor="middle" x="13599.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13599.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13599.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_expert_14&#45;&gt;layer_1_expert_14_gate_proj -->
<g id="edge235" class="edge">
<title>layer_1_expert_14&#45;&gt;layer_1_expert_14_gate_proj</title>
<path fill="none" stroke="black" d="M13599.5,-4385.62C13599.5,-4377.52 13599.5,-4368.72 13599.5,-4360.21"/>
<polygon fill="black" stroke="black" points="13603,-4360.04 13599.5,-4350.04 13596,-4360.04 13603,-4360.04"/>
</g>
<!-- layer_1_expert_14_up_proj -->
<g id="node173" class="node">
<title>layer_1_expert_14_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14174,-4349.74 13803,-4349.74 13803,-4281.74 14174,-4281.74 14174,-4349.74"/>
<text text-anchor="middle" x="13988.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 14 Up Proj</text>
<text text-anchor="middle" x="13988.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13988.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13988.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_expert_14&#45;&gt;layer_1_expert_14_up_proj -->
<g id="edge237" class="edge">
<title>layer_1_expert_14&#45;&gt;layer_1_expert_14_up_proj</title>
<path fill="none" stroke="black" d="M13725.53,-4385.69C13766.1,-4375.05 13811.24,-4363.22 13852.49,-4352.4"/>
<polygon fill="black" stroke="black" points="13853.55,-4355.74 13862.34,-4349.82 13851.78,-4348.97 13853.55,-4355.74"/>
</g>
<!-- layer_1_expert_14_activation -->
<g id="node174" class="node">
<title>layer_1_expert_14_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="13785,-4245.74 13414,-4245.74 13414,-4177.74 13785,-4177.74 13785,-4245.74"/>
<text text-anchor="middle" x="13599.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 14 GELU Activation</text>
<text text-anchor="middle" x="13599.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13599.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13599.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_expert_14_gate_proj&#45;&gt;layer_1_expert_14_activation -->
<g id="edge236" class="edge">
<title>layer_1_expert_14_gate_proj&#45;&gt;layer_1_expert_14_activation</title>
<path fill="none" stroke="black" d="M13599.5,-4281.62C13599.5,-4273.52 13599.5,-4264.72 13599.5,-4256.21"/>
<polygon fill="black" stroke="black" points="13603,-4256.04 13599.5,-4246.04 13596,-4256.04 13603,-4256.04"/>
</g>
<!-- layer_1_expert_14_up_proj&#45;&gt;layer_1_expert_14_activation -->
<g id="edge238" class="edge">
<title>layer_1_expert_14_up_proj&#45;&gt;layer_1_expert_14_activation</title>
<path fill="none" stroke="black" d="M13862.47,-4281.69C13821.9,-4271.05 13776.76,-4259.22 13735.51,-4248.4"/>
<polygon fill="black" stroke="black" points="13736.22,-4244.97 13725.66,-4245.82 13734.45,-4251.74 13736.22,-4244.97"/>
</g>
<!-- layer_1_expert_14_down_proj -->
<g id="node175" class="node">
<title>layer_1_expert_14_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13408,-4141.74 13037,-4141.74 13037,-4073.74 13408,-4073.74 13408,-4141.74"/>
<text text-anchor="middle" x="13222.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 14 Down Proj</text>
<text text-anchor="middle" x="13222.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13222.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13222.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_1_expert_14_activation&#45;&gt;layer_1_expert_14_down_proj -->
<g id="edge239" class="edge">
<title>layer_1_expert_14_activation&#45;&gt;layer_1_expert_14_down_proj</title>
<path fill="none" stroke="black" d="M13477.36,-4177.69C13438.12,-4167.08 13394.48,-4155.27 13354.56,-4144.47"/>
<polygon fill="black" stroke="black" points="13355.34,-4141.05 13344.77,-4141.82 13353.51,-4147.81 13355.34,-4141.05"/>
</g>
<!-- layer_1_expert_14_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge240" class="edge">
<title>layer_1_expert_14_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M13036.77,-4094.74C12925.13,-4087.84 12780.21,-4079.44 12651.5,-4073.74 11601.85,-4027.22 10365.55,-3994.94 9733.22,-3980.05"/>
<polygon fill="black" stroke="black" points="9733.1,-3976.55 9723.02,-3979.81 9732.94,-3983.55 9733.1,-3976.55"/>
</g>
<!-- layer_1_expert_15_gate_proj -->
<g id="node177" class="node">
<title>layer_1_expert_15_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14563,-4349.74 14192,-4349.74 14192,-4281.74 14563,-4281.74 14563,-4349.74"/>
<text text-anchor="middle" x="14377.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 15 Gate Proj</text>
<text text-anchor="middle" x="14377.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14377.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14377.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_expert_15&#45;&gt;layer_1_expert_15_gate_proj -->
<g id="edge242" class="edge">
<title>layer_1_expert_15&#45;&gt;layer_1_expert_15_gate_proj</title>
<path fill="none" stroke="black" d="M14377.5,-4385.62C14377.5,-4377.52 14377.5,-4368.72 14377.5,-4360.21"/>
<polygon fill="black" stroke="black" points="14381,-4360.04 14377.5,-4350.04 14374,-4360.04 14381,-4360.04"/>
</g>
<!-- layer_1_expert_15_up_proj -->
<g id="node178" class="node">
<title>layer_1_expert_15_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14952,-4349.74 14581,-4349.74 14581,-4281.74 14952,-4281.74 14952,-4349.74"/>
<text text-anchor="middle" x="14766.5" y="-4334.54" font-family="Times,serif" font-size="14.00">Expert 15 Up Proj</text>
<text text-anchor="middle" x="14766.5" y="-4319.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14766.5" y="-4304.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14766.5" y="-4289.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_expert_15&#45;&gt;layer_1_expert_15_up_proj -->
<g id="edge244" class="edge">
<title>layer_1_expert_15&#45;&gt;layer_1_expert_15_up_proj</title>
<path fill="none" stroke="black" d="M14503.53,-4385.69C14544.1,-4375.05 14589.24,-4363.22 14630.49,-4352.4"/>
<polygon fill="black" stroke="black" points="14631.55,-4355.74 14640.34,-4349.82 14629.78,-4348.97 14631.55,-4355.74"/>
</g>
<!-- layer_1_expert_15_activation -->
<g id="node179" class="node">
<title>layer_1_expert_15_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="14563,-4245.74 14192,-4245.74 14192,-4177.74 14563,-4177.74 14563,-4245.74"/>
<text text-anchor="middle" x="14377.5" y="-4230.54" font-family="Times,serif" font-size="14.00">Expert 15 GELU Activation</text>
<text text-anchor="middle" x="14377.5" y="-4215.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14377.5" y="-4200.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14377.5" y="-4185.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_expert_15_gate_proj&#45;&gt;layer_1_expert_15_activation -->
<g id="edge243" class="edge">
<title>layer_1_expert_15_gate_proj&#45;&gt;layer_1_expert_15_activation</title>
<path fill="none" stroke="black" d="M14377.5,-4281.62C14377.5,-4273.52 14377.5,-4264.72 14377.5,-4256.21"/>
<polygon fill="black" stroke="black" points="14381,-4256.04 14377.5,-4246.04 14374,-4256.04 14381,-4256.04"/>
</g>
<!-- layer_1_expert_15_up_proj&#45;&gt;layer_1_expert_15_activation -->
<g id="edge245" class="edge">
<title>layer_1_expert_15_up_proj&#45;&gt;layer_1_expert_15_activation</title>
<path fill="none" stroke="black" d="M14640.47,-4281.69C14599.9,-4271.05 14554.76,-4259.22 14513.51,-4248.4"/>
<polygon fill="black" stroke="black" points="14514.22,-4244.97 14503.66,-4245.82 14512.45,-4251.74 14514.22,-4244.97"/>
</g>
<!-- layer_1_expert_15_down_proj -->
<g id="node180" class="node">
<title>layer_1_expert_15_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13991,-4141.74 13620,-4141.74 13620,-4073.74 13991,-4073.74 13991,-4141.74"/>
<text text-anchor="middle" x="13805.5" y="-4126.54" font-family="Times,serif" font-size="14.00">Expert 15 Down Proj</text>
<text text-anchor="middle" x="13805.5" y="-4111.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13805.5" y="-4096.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13805.5" y="-4081.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_1_expert_15_activation&#45;&gt;layer_1_expert_15_down_proj -->
<g id="edge246" class="edge">
<title>layer_1_expert_15_activation&#45;&gt;layer_1_expert_15_down_proj</title>
<path fill="none" stroke="black" d="M14192.18,-4177.69C14131.01,-4166.79 14062.79,-4154.62 14000.89,-4143.58"/>
<polygon fill="black" stroke="black" points="14001.47,-4140.13 13991.01,-4141.82 14000.24,-4147.02 14001.47,-4140.13"/>
</g>
<!-- layer_1_expert_15_down_proj&#45;&gt;layer_1_expert_agg -->
<g id="edge247" class="edge">
<title>layer_1_expert_15_down_proj&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M13619.65,-4088.66C13555.65,-4083.04 13483.48,-4077.37 13417.5,-4073.74 12065.99,-3999.37 10461.07,-3978.66 9722.96,-3972.92"/>
<polygon fill="black" stroke="black" points="9722.72,-3969.42 9712.7,-3972.84 9722.67,-3976.42 9722.72,-3969.42"/>
</g>
<!-- layer_1_expert_agg&#45;&gt;layer_1_expert_residual -->
<g id="edge249" class="edge">
<title>layer_1_expert_agg&#45;&gt;layer_1_expert_residual</title>
<path fill="none" stroke="black" d="M9680.49,-3951.15C10266.98,-3922.97 11401.92,-3868.43 11900.05,-3844.49"/>
<polygon fill="black" stroke="black" points="11900.43,-3847.97 11910.25,-3844 11900.09,-3840.98 11900.43,-3847.97"/>
</g>
<!-- layer_1_expert_layernorm -->
<g id="node183" class="node">
<title>layer_1_expert_layernorm</title>
<polygon fill="lightgray" stroke="black" points="12378.5,-3761.74 11910.5,-3761.74 11910.5,-3693.74 12378.5,-3693.74 12378.5,-3761.74"/>
<text text-anchor="middle" x="12144.5" y="-3746.54" font-family="Times,serif" font-size="14.00">Layer Norm (Post&#45;Experts)</text>
<text text-anchor="middle" x="12144.5" y="-3731.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12144.5" y="-3716.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12144.5" y="-3701.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_expert_residual&#45;&gt;layer_1_expert_layernorm -->
<g id="edge250" class="edge">
<title>layer_1_expert_residual&#45;&gt;layer_1_expert_layernorm</title>
<path fill="none" stroke="black" d="M12144.5,-3797.62C12144.5,-3789.52 12144.5,-3780.72 12144.5,-3772.21"/>
<polygon fill="black" stroke="black" points="12148,-3772.04 12144.5,-3762.04 12141,-3772.04 12148,-3772.04"/>
</g>
<!-- layer_2_input -->
<g id="node184" class="node">
<title>layer_2_input</title>
<polygon fill="lightyellow" stroke="black" points="12617.02,-3657.74 11865.35,-3657.74 11671.98,-3551.74 12423.65,-3551.74 12617.02,-3657.74"/>
<text text-anchor="middle" x="12144.5" y="-3616.04" font-family="Times,serif" font-size="14.00">Layer 2 Input</text>
<text text-anchor="middle" x="12144.5" y="-3601.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12144.5" y="-3586.04" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_expert_layernorm&#45;&gt;layer_2_input -->
<g id="edge251" class="edge">
<title>layer_1_expert_layernorm&#45;&gt;layer_2_input</title>
<path fill="none" stroke="black" d="M12144.5,-3693.68C12144.5,-3685.64 12144.5,-3676.79 12144.5,-3667.89"/>
<polygon fill="black" stroke="black" points="12148,-3667.87 12144.5,-3657.87 12141,-3667.87 12148,-3667.87"/>
</g>
<!-- layer_2_mha_qkv -->
<g id="node185" class="node">
<title>layer_2_mha_qkv</title>
<polygon fill="lightgreen" stroke="black" points="12251,-3515.74 11770,-3515.74 11770,-3447.74 12251,-3447.74 12251,-3515.74"/>
<text text-anchor="middle" x="12010.5" y="-3500.54" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="12010.5" y="-3485.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12010.5" y="-3470.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="12010.5" y="-3455.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_input&#45;&gt;layer_2_mha_qkv -->
<g id="edge252" class="edge">
<title>layer_2_input&#45;&gt;layer_2_mha_qkv</title>
<path fill="none" stroke="black" d="M12086.89,-3551.72C12076.15,-3542.02 12065.09,-3532.03 12054.82,-3522.76"/>
<polygon fill="black" stroke="black" points="12056.92,-3519.94 12047.15,-3515.83 12052.23,-3525.13 12056.92,-3519.94"/>
</g>
<!-- layer_2_mha_residual -->
<g id="node188" class="node">
<title>layer_2_mha_residual</title>
<polygon fill="lightcoral" stroke="black" points="12378.5,-3203.74 11910.5,-3203.74 11910.5,-3135.74 12378.5,-3135.74 12378.5,-3203.74"/>
<text text-anchor="middle" x="12144.5" y="-3188.54" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="12144.5" y="-3173.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12144.5" y="-3158.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12144.5" y="-3143.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_input&#45;&gt;layer_2_mha_residual -->
<g id="edge255" class="edge">
<title>layer_2_input&#45;&gt;layer_2_mha_residual</title>
<path fill="none" stroke="black" d="M12232.79,-3551.6C12243.96,-3541.17 12253.81,-3529.21 12260.5,-3515.74 12283.34,-3469.74 12320.46,-3351.73 12256.5,-3239.74 12249.91,-3228.2 12240.53,-3218.35 12229.97,-3210"/>
<polygon fill="black" stroke="black" points="12231.83,-3207.02 12221.7,-3203.91 12227.68,-3212.66 12231.83,-3207.02"/>
</g>
<!-- layer_2_mha_attention -->
<g id="node186" class="node">
<title>layer_2_mha_attention</title>
<polygon fill="lightgreen" stroke="black" points="12248,-3411.74 11779,-3411.74 11779,-3343.74 12248,-3343.74 12248,-3411.74"/>
<text text-anchor="middle" x="12013.5" y="-3396.54" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="12013.5" y="-3381.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="12013.5" y="-3366.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12013.5" y="-3351.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_mha_qkv&#45;&gt;layer_2_mha_attention -->
<g id="edge253" class="edge">
<title>layer_2_mha_qkv&#45;&gt;layer_2_mha_attention</title>
<path fill="none" stroke="black" d="M12011.47,-3447.62C12011.71,-3439.52 12011.97,-3430.72 12012.22,-3422.21"/>
<polygon fill="black" stroke="black" points="12015.73,-3422.14 12012.52,-3412.04 12008.73,-3421.93 12015.73,-3422.14"/>
</g>
<!-- layer_2_mha_proj -->
<g id="node187" class="node">
<title>layer_2_mha_proj</title>
<polygon fill="lightgreen" stroke="black" points="12247.5,-3307.74 11779.5,-3307.74 11779.5,-3239.74 12247.5,-3239.74 12247.5,-3307.74"/>
<text text-anchor="middle" x="12013.5" y="-3292.54" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="12013.5" y="-3277.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12013.5" y="-3262.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12013.5" y="-3247.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_mha_attention&#45;&gt;layer_2_mha_proj -->
<g id="edge254" class="edge">
<title>layer_2_mha_attention&#45;&gt;layer_2_mha_proj</title>
<path fill="none" stroke="black" d="M12013.5,-3343.62C12013.5,-3335.52 12013.5,-3326.72 12013.5,-3318.21"/>
<polygon fill="black" stroke="black" points="12017,-3318.04 12013.5,-3308.04 12010,-3318.04 12017,-3318.04"/>
</g>
<!-- layer_2_mha_proj&#45;&gt;layer_2_mha_residual -->
<g id="edge256" class="edge">
<title>layer_2_mha_proj&#45;&gt;layer_2_mha_residual</title>
<path fill="none" stroke="black" d="M12056.03,-3239.62C12068.04,-3230.27 12081.24,-3220 12093.68,-3210.31"/>
<polygon fill="black" stroke="black" points="12095.99,-3212.94 12101.73,-3204.04 12091.69,-3207.42 12095.99,-3212.94"/>
</g>
<!-- layer_2_mha_layernorm -->
<g id="node189" class="node">
<title>layer_2_mha_layernorm</title>
<polygon fill="lightgray" stroke="black" points="12378.5,-3099.74 11910.5,-3099.74 11910.5,-3031.74 12378.5,-3031.74 12378.5,-3099.74"/>
<text text-anchor="middle" x="12144.5" y="-3084.54" font-family="Times,serif" font-size="14.00">Layer Norm (Post&#45;MHA)</text>
<text text-anchor="middle" x="12144.5" y="-3069.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12144.5" y="-3054.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="12144.5" y="-3039.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_mha_residual&#45;&gt;layer_2_mha_layernorm -->
<g id="edge257" class="edge">
<title>layer_2_mha_residual&#45;&gt;layer_2_mha_layernorm</title>
<path fill="none" stroke="black" d="M12144.5,-3135.62C12144.5,-3127.52 12144.5,-3118.72 12144.5,-3110.21"/>
<polygon fill="black" stroke="black" points="12148,-3110.04 12144.5,-3100.04 12141,-3110.04 12148,-3110.04"/>
</g>
<!-- layer_2_gate -->
<g id="node190" class="node">
<title>layer_2_gate</title>
<polygon fill="orange" stroke="black" points="12116.02,-2995.74 11364.35,-2995.74 11170.98,-2859.74 11922.65,-2859.74 12116.02,-2995.74"/>
<text text-anchor="middle" x="11643.5" y="-2946.54" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="11643.5" y="-2931.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="11643.5" y="-2916.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, k=2]</text>
<text text-anchor="middle" x="11643.5" y="-2901.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_mha_layernorm&#45;&gt;layer_2_gate -->
<g id="edge258" class="edge">
<title>layer_2_mha_layernorm&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" d="M12022.9,-3031.73C11985.61,-3021.61 11943.08,-3010.06 11900.3,-2998.45"/>
<polygon fill="black" stroke="black" points="11901.16,-2995.06 11890.6,-2995.82 11899.33,-3001.81 11901.16,-2995.06"/>
</g>
<!-- layer_2_token_split -->
<g id="node191" class="node">
<title>layer_2_token_split</title>
<polygon fill="lightyellow" stroke="black" points="12116.02,-2823.74 11364.35,-2823.74 11170.98,-2687.74 11922.65,-2687.74 12116.02,-2823.74"/>
<text text-anchor="middle" x="11643.5" y="-2774.54" font-family="Times,serif" font-size="14.00">Token Split by Expert</text>
<text text-anchor="middle" x="11643.5" y="-2759.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="11643.5" y="-2744.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192] per expert</text>
<text text-anchor="middle" x="11643.5" y="-2729.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_mha_layernorm&#45;&gt;layer_2_token_split -->
<g id="edge259" class="edge">
<title>layer_2_mha_layernorm&#45;&gt;layer_2_token_split</title>
<path fill="none" stroke="black" d="M12152.19,-3031.73C12160.52,-2986.93 12167.52,-2907.04 12125.5,-2859.74 12114.84,-2847.74 12096.95,-2837.04 12074.18,-2827.53"/>
<polygon fill="black" stroke="black" points="12075.44,-2824.26 12064.86,-2823.8 12072.84,-2830.76 12075.44,-2824.26"/>
</g>
<!-- layer_2_expert_residual -->
<g id="node273" class="node">
<title>layer_2_expert_residual</title>
<polygon fill="lightcoral" stroke="black" points="14901.5,-2063.74 14433.5,-2063.74 14433.5,-1995.74 14901.5,-1995.74 14901.5,-2063.74"/>
<text text-anchor="middle" x="14667.5" y="-2048.54" font-family="Times,serif" font-size="14.00">Expert Residual Add</text>
<text text-anchor="middle" x="14667.5" y="-2033.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14667.5" y="-2018.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14667.5" y="-2003.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_mha_layernorm&#45;&gt;layer_2_expert_residual -->
<g id="edge373" class="edge">
<title>layer_2_mha_layernorm&#45;&gt;layer_2_expert_residual</title>
<path fill="none" stroke="black" d="M12378.86,-3063.7C13410.77,-3057.61 17498.5,-3017.07 17498.5,-2756.74 17498.5,-2756.74 17498.5,-2756.74 17498.5,-2304.74 17498.5,-2175.29 15598.54,-2074.05 14911.61,-2041.67"/>
<polygon fill="black" stroke="black" points="14911.73,-2038.18 14901.58,-2041.2 14911.41,-2045.17 14911.73,-2038.18"/>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_token_split -->
<g id="edge260" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_token_split</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11643.5,-2859.55C11643.5,-2851.24 11643.5,-2842.69 11643.5,-2834.23"/>
<polygon fill="black" stroke="black" points="11647,-2834 11643.5,-2824 11640,-2834 11647,-2834"/>
</g>
<!-- layer_2_expert_0 -->
<g id="node192" class="node">
<title>layer_2_expert_0</title>
<polygon fill="lightcyan" stroke="black" points="5800,-2651.74 5429,-2651.74 5429,-2583.74 5800,-2583.74 5800,-2651.74"/>
<text text-anchor="middle" x="5614.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5614.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5614.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5614.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_0 -->
<g id="edge261" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_0</title>
<path fill="none" stroke="black" d="M11262.89,-2752.47C10375.2,-2746.08 8098.69,-2723.5 6197.5,-2651.74 6068.43,-2646.87 5923.43,-2638.67 5810.33,-2631.67"/>
<polygon fill="black" stroke="black" points="5810.38,-2628.16 5800.18,-2631.04 5809.94,-2635.15 5810.38,-2628.16"/>
</g>
<!-- layer_2_expert_1 -->
<g id="node197" class="node">
<title>layer_2_expert_1</title>
<polygon fill="lightcyan" stroke="black" points="6578,-2651.74 6207,-2651.74 6207,-2583.74 6578,-2583.74 6578,-2651.74"/>
<text text-anchor="middle" x="6392.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6392.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6392.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6392.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_1 -->
<g id="edge268" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_1</title>
<path fill="none" stroke="black" d="M11260.26,-2750.76C10462.61,-2741.48 8565.86,-2714.28 6975.5,-2651.74 6846.44,-2646.67 6701.44,-2638.47 6588.34,-2631.51"/>
<polygon fill="black" stroke="black" points="6588.38,-2628.01 6578.18,-2630.89 6587.95,-2635 6588.38,-2628.01"/>
</g>
<!-- layer_2_expert_2 -->
<g id="node202" class="node">
<title>layer_2_expert_2</title>
<polygon fill="lightcyan" stroke="black" points="7356,-2651.74 6985,-2651.74 6985,-2583.74 7356,-2583.74 7356,-2651.74"/>
<text text-anchor="middle" x="7170.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7170.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7170.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7170.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_2 -->
<g id="edge275" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_2</title>
<path fill="none" stroke="black" d="M11256.98,-2748.34C10557.85,-2735.9 9036.68,-2704.93 7754.5,-2651.74 7625.11,-2646.37 7479.71,-2638.16 7366.36,-2631.28"/>
<polygon fill="black" stroke="black" points="7366.38,-2627.77 7356.18,-2630.66 7365.95,-2634.76 7366.38,-2627.77"/>
</g>
<!-- layer_2_expert_3 -->
<g id="node207" class="node">
<title>layer_2_expert_3</title>
<polygon fill="lightcyan" stroke="black" points="8134,-2651.74 7763,-2651.74 7763,-2583.74 8134,-2583.74 8134,-2651.74"/>
<text text-anchor="middle" x="7948.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7948.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7948.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7948.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_3 -->
<g id="edge282" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_3</title>
<path fill="none" stroke="black" d="M11251.73,-2744.7C10661.8,-2728.93 9510.32,-2695.55 8532.5,-2651.74 8403.13,-2645.94 8257.73,-2637.73 8144.37,-2630.95"/>
<polygon fill="black" stroke="black" points="8144.39,-2627.45 8134.2,-2630.34 8143.97,-2634.43 8144.39,-2627.45"/>
</g>
<!-- layer_2_expert_4 -->
<g id="node212" class="node">
<title>layer_2_expert_4</title>
<polygon fill="lightcyan" stroke="black" points="8912,-2651.74 8541,-2651.74 8541,-2583.74 8912,-2583.74 8912,-2651.74"/>
<text text-anchor="middle" x="8726.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8726.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8726.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8726.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_4 -->
<g id="edge289" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_4</title>
<path fill="none" stroke="black" d="M11243.25,-2738.57C10778.5,-2719.45 9988.86,-2685.88 9310.5,-2651.74 9181.16,-2645.23 9035.76,-2637.02 8922.4,-2630.41"/>
<polygon fill="black" stroke="black" points="8922.41,-2626.91 8912.22,-2629.82 8922,-2633.9 8922.41,-2626.91"/>
</g>
<!-- layer_2_expert_5 -->
<g id="node217" class="node">
<title>layer_2_expert_5</title>
<polygon fill="lightcyan" stroke="black" points="9690,-2651.74 9319,-2651.74 9319,-2583.74 9690,-2583.74 9690,-2651.74"/>
<text text-anchor="middle" x="9504.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="9504.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9504.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9504.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_5 -->
<g id="edge296" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_5</title>
<path fill="none" stroke="black" d="M11228.54,-2728.36C10768.23,-2699.09 10045.07,-2653.11 9700.16,-2631.18"/>
<polygon fill="black" stroke="black" points="9700.27,-2627.68 9690.07,-2630.54 9699.82,-2634.67 9700.27,-2627.68"/>
</g>
<!-- layer_2_expert_6 -->
<g id="node222" class="node">
<title>layer_2_expert_6</title>
<polygon fill="lightcyan" stroke="black" points="10468,-2651.74 10097,-2651.74 10097,-2583.74 10468,-2583.74 10468,-2651.74"/>
<text text-anchor="middle" x="10282.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10282.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10282.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10282.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_6 -->
<g id="edge303" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_6</title>
<path fill="none" stroke="black" d="M11203.5,-2710.77C10958.97,-2686.34 10666.88,-2657.15 10478.21,-2638.3"/>
<polygon fill="black" stroke="black" points="10478.48,-2634.81 10468.18,-2637.29 10477.79,-2641.77 10478.48,-2634.81"/>
</g>
<!-- layer_2_expert_7 -->
<g id="node227" class="node">
<title>layer_2_expert_7</title>
<polygon fill="lightcyan" stroke="black" points="11246,-2651.74 10875,-2651.74 10875,-2583.74 11246,-2583.74 11246,-2651.74"/>
<text text-anchor="middle" x="11060.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="11060.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11060.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11060.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_7 -->
<g id="edge310" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_7</title>
<path fill="none" stroke="black" d="M11356.27,-2687.74C11306.43,-2676.11 11256.43,-2664.45 11212.09,-2654.1"/>
<polygon fill="black" stroke="black" points="11212.67,-2650.64 11202.13,-2651.78 11211.08,-2657.46 11212.67,-2650.64"/>
</g>
<!-- layer_2_expert_8 -->
<g id="node232" class="node">
<title>layer_2_expert_8</title>
<polygon fill="lightcyan" stroke="black" points="11829,-2651.74 11458,-2651.74 11458,-2583.74 11829,-2583.74 11829,-2651.74"/>
<text text-anchor="middle" x="11643.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="11643.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11643.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11643.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_8 -->
<g id="edge317" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_8</title>
<path fill="none" stroke="black" d="M11643.5,-2687.54C11643.5,-2678.78 11643.5,-2670.02 11643.5,-2661.81"/>
<polygon fill="black" stroke="black" points="11647,-2661.76 11643.5,-2651.76 11640,-2661.76 11647,-2661.76"/>
</g>
<!-- layer_2_expert_9 -->
<g id="node237" class="node">
<title>layer_2_expert_9</title>
<polygon fill="lightcyan" stroke="black" points="12413,-2651.74 12042,-2651.74 12042,-2583.74 12413,-2583.74 12413,-2651.74"/>
<text text-anchor="middle" x="12227.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="12227.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12227.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12227.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_9 -->
<g id="edge324" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_9</title>
<path fill="none" stroke="black" d="M11924.81,-2689.23C11976.87,-2677.11 12029.38,-2664.88 12075.71,-2654.09"/>
<polygon fill="black" stroke="black" points="12076.56,-2657.48 12085.51,-2651.81 12074.97,-2650.67 12076.56,-2657.48"/>
</g>
<!-- layer_2_expert_10 -->
<g id="node242" class="node">
<title>layer_2_expert_10</title>
<polygon fill="lightcyan" stroke="black" points="13191,-2651.74 12820,-2651.74 12820,-2583.74 13191,-2583.74 13191,-2651.74"/>
<text text-anchor="middle" x="13005.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="13005.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13005.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13005.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_10 -->
<g id="edge331" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_10</title>
<path fill="none" stroke="black" d="M11971.47,-2721.99C12233.1,-2695.87 12590.84,-2660.15 12809.62,-2638.3"/>
<polygon fill="black" stroke="black" points="12810.01,-2641.78 12819.61,-2637.3 12809.31,-2634.81 12810.01,-2641.78"/>
</g>
<!-- layer_2_expert_11 -->
<g id="node247" class="node">
<title>layer_2_expert_11</title>
<polygon fill="lightcyan" stroke="black" points="13969,-2651.74 13598,-2651.74 13598,-2583.74 13969,-2583.74 13969,-2651.74"/>
<text text-anchor="middle" x="13783.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="13783.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13783.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13783.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_11 -->
<g id="edge338" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_11</title>
<path fill="none" stroke="black" d="M11987.03,-2732.91C12440.55,-2704.09 13223.97,-2654.3 13587.59,-2631.19"/>
<polygon fill="black" stroke="black" points="13587.93,-2634.68 13597.69,-2630.55 13587.49,-2627.69 13587.93,-2634.68"/>
</g>
<!-- layer_2_expert_12 -->
<g id="node252" class="node">
<title>layer_2_expert_12</title>
<polygon fill="lightcyan" stroke="black" points="14747,-2651.74 14376,-2651.74 14376,-2583.74 14747,-2583.74 14747,-2651.74"/>
<text text-anchor="middle" x="14561.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="14561.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14561.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14561.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_12 -->
<g id="edge345" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_12</title>
<path fill="none" stroke="black" d="M11998.11,-2740.47C12455.75,-2721.75 13276.64,-2687.08 13978.5,-2651.74 14107.5,-2645.24 14252.49,-2637.04 14365.62,-2630.44"/>
<polygon fill="black" stroke="black" points="14365.99,-2633.92 14375.77,-2629.84 14365.58,-2626.93 14365.99,-2633.92"/>
</g>
<!-- layer_2_expert_13 -->
<g id="node257" class="node">
<title>layer_2_expert_13</title>
<polygon fill="lightcyan" stroke="black" points="15525,-2651.74 15154,-2651.74 15154,-2583.74 15525,-2583.74 15525,-2651.74"/>
<text text-anchor="middle" x="15339.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="15339.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15339.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15339.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_13 -->
<g id="edge352" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_13</title>
<path fill="none" stroke="black" d="M12004.89,-2745.54C12585.22,-2730.13 13760.84,-2696.38 14756.5,-2651.74 14885.53,-2645.95 15030.53,-2637.75 15143.64,-2630.98"/>
<polygon fill="black" stroke="black" points="15144.02,-2634.46 15153.79,-2630.37 15143.6,-2627.47 15144.02,-2634.46"/>
</g>
<!-- layer_2_expert_14 -->
<g id="node262" class="node">
<title>layer_2_expert_14</title>
<polygon fill="lightcyan" stroke="black" points="16303,-2651.74 15932,-2651.74 15932,-2583.74 16303,-2583.74 16303,-2651.74"/>
<text text-anchor="middle" x="16117.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="16117.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16117.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16117.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_14 -->
<g id="edge359" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_14</title>
<path fill="none" stroke="black" d="M12009.42,-2748.72C12699.15,-2736.56 14238.8,-2705.55 15534.5,-2651.74 15663.55,-2646.38 15808.55,-2638.18 15921.66,-2631.3"/>
<polygon fill="black" stroke="black" points="15922.04,-2634.78 15931.81,-2630.68 15921.61,-2627.79 15922.04,-2634.78"/>
</g>
<!-- layer_2_expert_15 -->
<g id="node267" class="node">
<title>layer_2_expert_15</title>
<polygon fill="lightcyan" stroke="black" points="17081,-2651.74 16710,-2651.74 16710,-2583.74 17081,-2583.74 17081,-2651.74"/>
<text text-anchor="middle" x="16895.5" y="-2636.54" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="16895.5" y="-2621.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16895.5" y="-2606.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16895.5" y="-2591.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_token_split&#45;&gt;layer_2_expert_15 -->
<g id="edge366" class="edge">
<title>layer_2_token_split&#45;&gt;layer_2_expert_15</title>
<path fill="none" stroke="black" d="M12012.84,-2750.92C12802.29,-2741.8 14712.43,-2714.66 16312.5,-2651.74 16441.56,-2646.67 16586.56,-2638.47 16699.66,-2631.51"/>
<polygon fill="black" stroke="black" points="16700.05,-2635 16709.82,-2630.89 16699.62,-2628.01 16700.05,-2635"/>
</g>
<!-- layer_2_expert_0_gate_proj -->
<g id="node193" class="node">
<title>layer_2_expert_0_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="5411,-2547.74 5040,-2547.74 5040,-2479.74 5411,-2479.74 5411,-2547.74"/>
<text text-anchor="middle" x="5225.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 0 Gate Proj</text>
<text text-anchor="middle" x="5225.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5225.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5225.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_expert_0&#45;&gt;layer_2_expert_0_gate_proj -->
<g id="edge262" class="edge">
<title>layer_2_expert_0&#45;&gt;layer_2_expert_0_gate_proj</title>
<path fill="none" stroke="black" d="M5488.47,-2583.69C5447.9,-2573.05 5402.76,-2561.22 5361.51,-2550.4"/>
<polygon fill="black" stroke="black" points="5362.22,-2546.97 5351.66,-2547.82 5360.45,-2553.74 5362.22,-2546.97"/>
</g>
<!-- layer_2_expert_0_up_proj -->
<g id="node194" class="node">
<title>layer_2_expert_0_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="5800,-2547.74 5429,-2547.74 5429,-2479.74 5800,-2479.74 5800,-2547.74"/>
<text text-anchor="middle" x="5614.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 0 Up Proj</text>
<text text-anchor="middle" x="5614.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="5614.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5614.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_expert_0&#45;&gt;layer_2_expert_0_up_proj -->
<g id="edge264" class="edge">
<title>layer_2_expert_0&#45;&gt;layer_2_expert_0_up_proj</title>
<path fill="none" stroke="black" d="M5614.5,-2583.62C5614.5,-2575.52 5614.5,-2566.72 5614.5,-2558.21"/>
<polygon fill="black" stroke="black" points="5618,-2558.04 5614.5,-2548.04 5611,-2558.04 5618,-2558.04"/>
</g>
<!-- layer_2_expert_0_activation -->
<g id="node195" class="node">
<title>layer_2_expert_0_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="5800,-2443.74 5429,-2443.74 5429,-2375.74 5800,-2375.74 5800,-2443.74"/>
<text text-anchor="middle" x="5614.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="5614.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5614.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="5614.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_expert_0_gate_proj&#45;&gt;layer_2_expert_0_activation -->
<g id="edge263" class="edge">
<title>layer_2_expert_0_gate_proj&#45;&gt;layer_2_expert_0_activation</title>
<path fill="none" stroke="black" d="M5351.53,-2479.69C5392.1,-2469.05 5437.24,-2457.22 5478.49,-2446.4"/>
<polygon fill="black" stroke="black" points="5479.55,-2449.74 5488.34,-2443.82 5477.78,-2442.97 5479.55,-2449.74"/>
</g>
<!-- layer_2_expert_0_up_proj&#45;&gt;layer_2_expert_0_activation -->
<g id="edge265" class="edge">
<title>layer_2_expert_0_up_proj&#45;&gt;layer_2_expert_0_activation</title>
<path fill="none" stroke="black" d="M5614.5,-2479.62C5614.5,-2471.52 5614.5,-2462.72 5614.5,-2454.21"/>
<polygon fill="black" stroke="black" points="5618,-2454.04 5614.5,-2444.04 5611,-2454.04 5618,-2454.04"/>
</g>
<!-- layer_2_expert_0_down_proj -->
<g id="node196" class="node">
<title>layer_2_expert_0_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6310,-2339.74 5939,-2339.74 5939,-2271.74 6310,-2271.74 6310,-2339.74"/>
<text text-anchor="middle" x="6124.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 0 Down Proj</text>
<text text-anchor="middle" x="6124.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6124.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6124.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_2_expert_0_activation&#45;&gt;layer_2_expert_0_down_proj -->
<g id="edge266" class="edge">
<title>layer_2_expert_0_activation&#45;&gt;layer_2_expert_0_down_proj</title>
<path fill="none" stroke="black" d="M5779.73,-2375.69C5833.94,-2364.85 5894.35,-2352.77 5949.27,-2341.79"/>
<polygon fill="black" stroke="black" points="5949.98,-2345.21 5959.1,-2339.82 5948.6,-2338.35 5949.98,-2345.21"/>
</g>
<!-- layer_2_expert_agg -->
<g id="node272" class="node">
<title>layer_2_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="12138.06,-2235.74 11351.32,-2235.74 11148.94,-2099.74 11935.68,-2099.74 12138.06,-2235.74"/>
<text text-anchor="middle" x="11643.5" y="-2186.54" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="11643.5" y="-2171.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192] from all experts</text>
<text text-anchor="middle" x="11643.5" y="-2156.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="11643.5" y="-2141.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_expert_0_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge267" class="edge">
<title>layer_2_expert_0_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M6310.11,-2295.78C6467.49,-2288.43 6699.25,-2278.23 6901.5,-2271.74 8514.36,-2219.98 10436.64,-2187.11 11249.54,-2174.54"/>
<polygon fill="black" stroke="black" points="11249.7,-2178.04 11259.65,-2174.38 11249.6,-2171.04 11249.7,-2178.04"/>
</g>
<!-- layer_2_expert_1_gate_proj -->
<g id="node198" class="node">
<title>layer_2_expert_1_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6189,-2547.74 5818,-2547.74 5818,-2479.74 6189,-2479.74 6189,-2547.74"/>
<text text-anchor="middle" x="6003.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 1 Gate Proj</text>
<text text-anchor="middle" x="6003.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6003.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6003.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_expert_1&#45;&gt;layer_2_expert_1_gate_proj -->
<g id="edge269" class="edge">
<title>layer_2_expert_1&#45;&gt;layer_2_expert_1_gate_proj</title>
<path fill="none" stroke="black" d="M6266.47,-2583.69C6225.9,-2573.05 6180.76,-2561.22 6139.51,-2550.4"/>
<polygon fill="black" stroke="black" points="6140.22,-2546.97 6129.66,-2547.82 6138.45,-2553.74 6140.22,-2546.97"/>
</g>
<!-- layer_2_expert_1_up_proj -->
<g id="node199" class="node">
<title>layer_2_expert_1_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6578,-2547.74 6207,-2547.74 6207,-2479.74 6578,-2479.74 6578,-2547.74"/>
<text text-anchor="middle" x="6392.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 1 Up Proj</text>
<text text-anchor="middle" x="6392.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6392.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6392.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_expert_1&#45;&gt;layer_2_expert_1_up_proj -->
<g id="edge271" class="edge">
<title>layer_2_expert_1&#45;&gt;layer_2_expert_1_up_proj</title>
<path fill="none" stroke="black" d="M6392.5,-2583.62C6392.5,-2575.52 6392.5,-2566.72 6392.5,-2558.21"/>
<polygon fill="black" stroke="black" points="6396,-2558.04 6392.5,-2548.04 6389,-2558.04 6396,-2558.04"/>
</g>
<!-- layer_2_expert_1_activation -->
<g id="node200" class="node">
<title>layer_2_expert_1_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="6578,-2443.74 6207,-2443.74 6207,-2375.74 6578,-2375.74 6578,-2443.74"/>
<text text-anchor="middle" x="6392.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="6392.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6392.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6392.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_expert_1_gate_proj&#45;&gt;layer_2_expert_1_activation -->
<g id="edge270" class="edge">
<title>layer_2_expert_1_gate_proj&#45;&gt;layer_2_expert_1_activation</title>
<path fill="none" stroke="black" d="M6129.53,-2479.69C6170.1,-2469.05 6215.24,-2457.22 6256.49,-2446.4"/>
<polygon fill="black" stroke="black" points="6257.55,-2449.74 6266.34,-2443.82 6255.78,-2442.97 6257.55,-2449.74"/>
</g>
<!-- layer_2_expert_1_up_proj&#45;&gt;layer_2_expert_1_activation -->
<g id="edge272" class="edge">
<title>layer_2_expert_1_up_proj&#45;&gt;layer_2_expert_1_activation</title>
<path fill="none" stroke="black" d="M6392.5,-2479.62C6392.5,-2471.52 6392.5,-2462.72 6392.5,-2454.21"/>
<polygon fill="black" stroke="black" points="6396,-2454.04 6392.5,-2444.04 6389,-2454.04 6396,-2454.04"/>
</g>
<!-- layer_2_expert_1_down_proj -->
<g id="node201" class="node">
<title>layer_2_expert_1_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7282,-2339.74 6911,-2339.74 6911,-2271.74 7282,-2271.74 7282,-2339.74"/>
<text text-anchor="middle" x="7096.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 1 Down Proj</text>
<text text-anchor="middle" x="7096.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7096.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7096.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_2_expert_1_activation&#45;&gt;layer_2_expert_1_down_proj -->
<g id="edge273" class="edge">
<title>layer_2_expert_1_activation&#45;&gt;layer_2_expert_1_down_proj</title>
<path fill="none" stroke="black" d="M6578.39,-2381.81C6677.74,-2367.41 6799.99,-2349.7 6900.79,-2335.1"/>
<polygon fill="black" stroke="black" points="6901.4,-2338.54 6910.79,-2333.65 6900.39,-2331.62 6901.4,-2338.54"/>
</g>
<!-- layer_2_expert_1_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge274" class="edge">
<title>layer_2_expert_1_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M7282.27,-2290.3C7373.05,-2283.72 7483.93,-2276.37 7583.5,-2271.74 8926.46,-2209.23 10521.21,-2182.7 11247.65,-2173.23"/>
<polygon fill="black" stroke="black" points="11247.8,-2176.73 11257.75,-2173.1 11247.71,-2169.73 11247.8,-2176.73"/>
</g>
<!-- layer_2_expert_2_gate_proj -->
<g id="node203" class="node">
<title>layer_2_expert_2_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="6967,-2547.74 6596,-2547.74 6596,-2479.74 6967,-2479.74 6967,-2547.74"/>
<text text-anchor="middle" x="6781.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 2 Gate Proj</text>
<text text-anchor="middle" x="6781.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="6781.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="6781.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_expert_2&#45;&gt;layer_2_expert_2_gate_proj -->
<g id="edge276" class="edge">
<title>layer_2_expert_2&#45;&gt;layer_2_expert_2_gate_proj</title>
<path fill="none" stroke="black" d="M7044.47,-2583.69C7003.9,-2573.05 6958.76,-2561.22 6917.51,-2550.4"/>
<polygon fill="black" stroke="black" points="6918.22,-2546.97 6907.66,-2547.82 6916.45,-2553.74 6918.22,-2546.97"/>
</g>
<!-- layer_2_expert_2_up_proj -->
<g id="node204" class="node">
<title>layer_2_expert_2_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7356,-2547.74 6985,-2547.74 6985,-2479.74 7356,-2479.74 7356,-2547.74"/>
<text text-anchor="middle" x="7170.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 2 Up Proj</text>
<text text-anchor="middle" x="7170.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7170.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7170.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_expert_2&#45;&gt;layer_2_expert_2_up_proj -->
<g id="edge278" class="edge">
<title>layer_2_expert_2&#45;&gt;layer_2_expert_2_up_proj</title>
<path fill="none" stroke="black" d="M7170.5,-2583.62C7170.5,-2575.52 7170.5,-2566.72 7170.5,-2558.21"/>
<polygon fill="black" stroke="black" points="7174,-2558.04 7170.5,-2548.04 7167,-2558.04 7174,-2558.04"/>
</g>
<!-- layer_2_expert_2_activation -->
<g id="node205" class="node">
<title>layer_2_expert_2_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="7356,-2443.74 6985,-2443.74 6985,-2375.74 7356,-2375.74 7356,-2443.74"/>
<text text-anchor="middle" x="7170.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="7170.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7170.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7170.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_expert_2_gate_proj&#45;&gt;layer_2_expert_2_activation -->
<g id="edge277" class="edge">
<title>layer_2_expert_2_gate_proj&#45;&gt;layer_2_expert_2_activation</title>
<path fill="none" stroke="black" d="M6907.53,-2479.69C6948.1,-2469.05 6993.24,-2457.22 7034.49,-2446.4"/>
<polygon fill="black" stroke="black" points="7035.55,-2449.74 7044.34,-2443.82 7033.78,-2442.97 7035.55,-2449.74"/>
</g>
<!-- layer_2_expert_2_up_proj&#45;&gt;layer_2_expert_2_activation -->
<g id="edge279" class="edge">
<title>layer_2_expert_2_up_proj&#45;&gt;layer_2_expert_2_activation</title>
<path fill="none" stroke="black" d="M7170.5,-2479.62C7170.5,-2471.52 7170.5,-2462.72 7170.5,-2454.21"/>
<polygon fill="black" stroke="black" points="7174,-2454.04 7170.5,-2444.04 7167,-2454.04 7174,-2454.04"/>
</g>
<!-- layer_2_expert_2_down_proj -->
<g id="node206" class="node">
<title>layer_2_expert_2_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7963,-2339.74 7592,-2339.74 7592,-2271.74 7963,-2271.74 7963,-2339.74"/>
<text text-anchor="middle" x="7777.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 2 Down Proj</text>
<text text-anchor="middle" x="7777.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7777.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7777.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_2_expert_2_activation&#45;&gt;layer_2_expert_2_down_proj -->
<g id="edge280" class="edge">
<title>layer_2_expert_2_activation&#45;&gt;layer_2_expert_2_down_proj</title>
<path fill="none" stroke="black" d="M7356.33,-2377.51C7427.74,-2365.51 7509.44,-2351.79 7581.75,-2339.63"/>
<polygon fill="black" stroke="black" points="7582.61,-2343.04 7591.89,-2337.93 7581.45,-2336.14 7582.61,-2343.04"/>
</g>
<!-- layer_2_expert_2_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge281" class="edge">
<title>layer_2_expert_2_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M7963.15,-2284.49C8013.5,-2279.62 8068.04,-2274.92 8118.5,-2271.74 9251.28,-2200.46 10592.01,-2178.4 11245.44,-2171.66"/>
<polygon fill="black" stroke="black" points="11245.53,-2175.16 11255.49,-2171.55 11245.45,-2168.16 11245.53,-2175.16"/>
</g>
<!-- layer_2_expert_3_gate_proj -->
<g id="node208" class="node">
<title>layer_2_expert_3_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7745,-2547.74 7374,-2547.74 7374,-2479.74 7745,-2479.74 7745,-2547.74"/>
<text text-anchor="middle" x="7559.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 3 Gate Proj</text>
<text text-anchor="middle" x="7559.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7559.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7559.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_expert_3&#45;&gt;layer_2_expert_3_gate_proj -->
<g id="edge283" class="edge">
<title>layer_2_expert_3&#45;&gt;layer_2_expert_3_gate_proj</title>
<path fill="none" stroke="black" d="M7822.47,-2583.69C7781.9,-2573.05 7736.76,-2561.22 7695.51,-2550.4"/>
<polygon fill="black" stroke="black" points="7696.22,-2546.97 7685.66,-2547.82 7694.45,-2553.74 7696.22,-2546.97"/>
</g>
<!-- layer_2_expert_3_up_proj -->
<g id="node209" class="node">
<title>layer_2_expert_3_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8134,-2547.74 7763,-2547.74 7763,-2479.74 8134,-2479.74 8134,-2547.74"/>
<text text-anchor="middle" x="7948.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 3 Up Proj</text>
<text text-anchor="middle" x="7948.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7948.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7948.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_expert_3&#45;&gt;layer_2_expert_3_up_proj -->
<g id="edge285" class="edge">
<title>layer_2_expert_3&#45;&gt;layer_2_expert_3_up_proj</title>
<path fill="none" stroke="black" d="M7948.5,-2583.62C7948.5,-2575.52 7948.5,-2566.72 7948.5,-2558.21"/>
<polygon fill="black" stroke="black" points="7952,-2558.04 7948.5,-2548.04 7945,-2558.04 7952,-2558.04"/>
</g>
<!-- layer_2_expert_3_activation -->
<g id="node210" class="node">
<title>layer_2_expert_3_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="8134,-2443.74 7763,-2443.74 7763,-2375.74 8134,-2375.74 8134,-2443.74"/>
<text text-anchor="middle" x="7948.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="7948.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7948.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7948.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_expert_3_gate_proj&#45;&gt;layer_2_expert_3_activation -->
<g id="edge284" class="edge">
<title>layer_2_expert_3_gate_proj&#45;&gt;layer_2_expert_3_activation</title>
<path fill="none" stroke="black" d="M7685.53,-2479.69C7726.1,-2469.05 7771.24,-2457.22 7812.49,-2446.4"/>
<polygon fill="black" stroke="black" points="7813.55,-2449.74 7822.34,-2443.82 7811.78,-2442.97 7813.55,-2449.74"/>
</g>
<!-- layer_2_expert_3_up_proj&#45;&gt;layer_2_expert_3_activation -->
<g id="edge286" class="edge">
<title>layer_2_expert_3_up_proj&#45;&gt;layer_2_expert_3_activation</title>
<path fill="none" stroke="black" d="M7948.5,-2479.62C7948.5,-2471.52 7948.5,-2462.72 7948.5,-2454.21"/>
<polygon fill="black" stroke="black" points="7952,-2454.04 7948.5,-2444.04 7945,-2454.04 7952,-2454.04"/>
</g>
<!-- layer_2_expert_3_down_proj -->
<g id="node211" class="node">
<title>layer_2_expert_3_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8498,-2339.74 8127,-2339.74 8127,-2271.74 8498,-2271.74 8498,-2339.74"/>
<text text-anchor="middle" x="8312.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 3 Down Proj</text>
<text text-anchor="middle" x="8312.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8312.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8312.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_2_expert_3_activation&#45;&gt;layer_2_expert_3_down_proj -->
<g id="edge287" class="edge">
<title>layer_2_expert_3_activation&#45;&gt;layer_2_expert_3_down_proj</title>
<path fill="none" stroke="black" d="M8066.43,-2375.69C8104.24,-2365.1 8146.27,-2353.32 8184.75,-2342.54"/>
<polygon fill="black" stroke="black" points="8185.76,-2345.89 8194.45,-2339.82 8183.87,-2339.15 8185.76,-2345.89"/>
</g>
<!-- layer_2_expert_3_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge288" class="edge">
<title>layer_2_expert_3_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M8498.16,-2292.79C8607.16,-2286.02 8747.62,-2277.74 8872.5,-2271.74 9723.73,-2230.84 10722.74,-2197.25 11258.1,-2180.42"/>
<polygon fill="black" stroke="black" points="11258.42,-2183.91 11268.3,-2180.1 11258.2,-2176.92 11258.42,-2183.91"/>
</g>
<!-- layer_2_expert_4_gate_proj -->
<g id="node213" class="node">
<title>layer_2_expert_4_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8523,-2547.74 8152,-2547.74 8152,-2479.74 8523,-2479.74 8523,-2547.74"/>
<text text-anchor="middle" x="8337.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 4 Gate Proj</text>
<text text-anchor="middle" x="8337.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8337.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8337.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_expert_4&#45;&gt;layer_2_expert_4_gate_proj -->
<g id="edge290" class="edge">
<title>layer_2_expert_4&#45;&gt;layer_2_expert_4_gate_proj</title>
<path fill="none" stroke="black" d="M8600.47,-2583.69C8559.9,-2573.05 8514.76,-2561.22 8473.51,-2550.4"/>
<polygon fill="black" stroke="black" points="8474.22,-2546.97 8463.66,-2547.82 8472.45,-2553.74 8474.22,-2546.97"/>
</g>
<!-- layer_2_expert_4_up_proj -->
<g id="node214" class="node">
<title>layer_2_expert_4_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8912,-2547.74 8541,-2547.74 8541,-2479.74 8912,-2479.74 8912,-2547.74"/>
<text text-anchor="middle" x="8726.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 4 Up Proj</text>
<text text-anchor="middle" x="8726.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8726.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8726.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_expert_4&#45;&gt;layer_2_expert_4_up_proj -->
<g id="edge292" class="edge">
<title>layer_2_expert_4&#45;&gt;layer_2_expert_4_up_proj</title>
<path fill="none" stroke="black" d="M8726.5,-2583.62C8726.5,-2575.52 8726.5,-2566.72 8726.5,-2558.21"/>
<polygon fill="black" stroke="black" points="8730,-2558.04 8726.5,-2548.04 8723,-2558.04 8730,-2558.04"/>
</g>
<!-- layer_2_expert_4_activation -->
<g id="node215" class="node">
<title>layer_2_expert_4_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="8912,-2443.74 8541,-2443.74 8541,-2375.74 8912,-2375.74 8912,-2443.74"/>
<text text-anchor="middle" x="8726.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 4 GELU Activation</text>
<text text-anchor="middle" x="8726.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8726.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8726.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_expert_4_gate_proj&#45;&gt;layer_2_expert_4_activation -->
<g id="edge291" class="edge">
<title>layer_2_expert_4_gate_proj&#45;&gt;layer_2_expert_4_activation</title>
<path fill="none" stroke="black" d="M8463.53,-2479.69C8504.1,-2469.05 8549.24,-2457.22 8590.49,-2446.4"/>
<polygon fill="black" stroke="black" points="8591.55,-2449.74 8600.34,-2443.82 8589.78,-2442.97 8591.55,-2449.74"/>
</g>
<!-- layer_2_expert_4_up_proj&#45;&gt;layer_2_expert_4_activation -->
<g id="edge293" class="edge">
<title>layer_2_expert_4_up_proj&#45;&gt;layer_2_expert_4_activation</title>
<path fill="none" stroke="black" d="M8726.5,-2479.62C8726.5,-2471.52 8726.5,-2462.72 8726.5,-2454.21"/>
<polygon fill="black" stroke="black" points="8730,-2454.04 8726.5,-2444.04 8723,-2454.04 8730,-2454.04"/>
</g>
<!-- layer_2_expert_4_down_proj -->
<g id="node216" class="node">
<title>layer_2_expert_4_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9252,-2339.74 8881,-2339.74 8881,-2271.74 9252,-2271.74 9252,-2339.74"/>
<text text-anchor="middle" x="9066.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 4 Down Proj</text>
<text text-anchor="middle" x="9066.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9066.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9066.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_2_expert_4_activation&#45;&gt;layer_2_expert_4_down_proj -->
<g id="edge294" class="edge">
<title>layer_2_expert_4_activation&#45;&gt;layer_2_expert_4_down_proj</title>
<path fill="none" stroke="black" d="M8836.89,-2375.62C8871.89,-2365.12 8910.76,-2353.46 8946.41,-2342.77"/>
<polygon fill="black" stroke="black" points="8947.8,-2346 8956.37,-2339.78 8945.79,-2339.3 8947.8,-2346"/>
</g>
<!-- layer_2_expert_4_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge295" class="edge">
<title>layer_2_expert_4_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M9252.09,-2294.95C9673.6,-2272.7 10709.83,-2218.01 11269.85,-2188.46"/>
<polygon fill="black" stroke="black" points="11270.31,-2191.94 11280.11,-2187.92 11269.94,-2184.95 11270.31,-2191.94"/>
</g>
<!-- layer_2_expert_5_gate_proj -->
<g id="node218" class="node">
<title>layer_2_expert_5_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9301,-2547.74 8930,-2547.74 8930,-2479.74 9301,-2479.74 9301,-2547.74"/>
<text text-anchor="middle" x="9115.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 5 Gate Proj</text>
<text text-anchor="middle" x="9115.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9115.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9115.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_expert_5&#45;&gt;layer_2_expert_5_gate_proj -->
<g id="edge297" class="edge">
<title>layer_2_expert_5&#45;&gt;layer_2_expert_5_gate_proj</title>
<path fill="none" stroke="black" d="M9378.47,-2583.69C9337.9,-2573.05 9292.76,-2561.22 9251.51,-2550.4"/>
<polygon fill="black" stroke="black" points="9252.22,-2546.97 9241.66,-2547.82 9250.45,-2553.74 9252.22,-2546.97"/>
</g>
<!-- layer_2_expert_5_up_proj -->
<g id="node219" class="node">
<title>layer_2_expert_5_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9690,-2547.74 9319,-2547.74 9319,-2479.74 9690,-2479.74 9690,-2547.74"/>
<text text-anchor="middle" x="9504.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 5 Up Proj</text>
<text text-anchor="middle" x="9504.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9504.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9504.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_expert_5&#45;&gt;layer_2_expert_5_up_proj -->
<g id="edge299" class="edge">
<title>layer_2_expert_5&#45;&gt;layer_2_expert_5_up_proj</title>
<path fill="none" stroke="black" d="M9504.5,-2583.62C9504.5,-2575.52 9504.5,-2566.72 9504.5,-2558.21"/>
<polygon fill="black" stroke="black" points="9508,-2558.04 9504.5,-2548.04 9501,-2558.04 9508,-2558.04"/>
</g>
<!-- layer_2_expert_5_activation -->
<g id="node220" class="node">
<title>layer_2_expert_5_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="9690,-2443.74 9319,-2443.74 9319,-2375.74 9690,-2375.74 9690,-2443.74"/>
<text text-anchor="middle" x="9504.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 5 GELU Activation</text>
<text text-anchor="middle" x="9504.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9504.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9504.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_expert_5_gate_proj&#45;&gt;layer_2_expert_5_activation -->
<g id="edge298" class="edge">
<title>layer_2_expert_5_gate_proj&#45;&gt;layer_2_expert_5_activation</title>
<path fill="none" stroke="black" d="M9241.53,-2479.69C9282.1,-2469.05 9327.24,-2457.22 9368.49,-2446.4"/>
<polygon fill="black" stroke="black" points="9369.55,-2449.74 9378.34,-2443.82 9367.78,-2442.97 9369.55,-2449.74"/>
</g>
<!-- layer_2_expert_5_up_proj&#45;&gt;layer_2_expert_5_activation -->
<g id="edge300" class="edge">
<title>layer_2_expert_5_up_proj&#45;&gt;layer_2_expert_5_activation</title>
<path fill="none" stroke="black" d="M9504.5,-2479.62C9504.5,-2471.52 9504.5,-2462.72 9504.5,-2454.21"/>
<polygon fill="black" stroke="black" points="9508,-2454.04 9504.5,-2444.04 9501,-2454.04 9508,-2454.04"/>
</g>
<!-- layer_2_expert_5_down_proj -->
<g id="node221" class="node">
<title>layer_2_expert_5_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10224,-2339.74 9853,-2339.74 9853,-2271.74 10224,-2271.74 10224,-2339.74"/>
<text text-anchor="middle" x="10038.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 5 Down Proj</text>
<text text-anchor="middle" x="10038.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10038.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10038.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_2_expert_5_activation&#45;&gt;layer_2_expert_5_down_proj -->
<g id="edge301" class="edge">
<title>layer_2_expert_5_activation&#45;&gt;layer_2_expert_5_down_proj</title>
<path fill="none" stroke="black" d="M9677.51,-2375.69C9734.38,-2364.83 9797.78,-2352.72 9855.38,-2341.72"/>
<polygon fill="black" stroke="black" points="9856.15,-2345.14 9865.31,-2339.82 9854.83,-2338.26 9856.15,-2345.14"/>
</g>
<!-- layer_2_expert_5_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge302" class="edge">
<title>layer_2_expert_5_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M10224.18,-2289.01C10482.77,-2267.09 10956.53,-2226.95 11285.18,-2199.1"/>
<polygon fill="black" stroke="black" points="11285.68,-2202.57 11295.35,-2198.24 11285.09,-2195.6 11285.68,-2202.57"/>
</g>
<!-- layer_2_expert_6_gate_proj -->
<g id="node223" class="node">
<title>layer_2_expert_6_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10079,-2547.74 9708,-2547.74 9708,-2479.74 10079,-2479.74 10079,-2547.74"/>
<text text-anchor="middle" x="9893.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 6 Gate Proj</text>
<text text-anchor="middle" x="9893.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9893.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9893.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_expert_6&#45;&gt;layer_2_expert_6_gate_proj -->
<g id="edge304" class="edge">
<title>layer_2_expert_6&#45;&gt;layer_2_expert_6_gate_proj</title>
<path fill="none" stroke="black" d="M10156.47,-2583.69C10115.9,-2573.05 10070.76,-2561.22 10029.51,-2550.4"/>
<polygon fill="black" stroke="black" points="10030.22,-2546.97 10019.66,-2547.82 10028.45,-2553.74 10030.22,-2546.97"/>
</g>
<!-- layer_2_expert_6_up_proj -->
<g id="node224" class="node">
<title>layer_2_expert_6_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10468,-2547.74 10097,-2547.74 10097,-2479.74 10468,-2479.74 10468,-2547.74"/>
<text text-anchor="middle" x="10282.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 6 Up Proj</text>
<text text-anchor="middle" x="10282.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10282.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10282.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_expert_6&#45;&gt;layer_2_expert_6_up_proj -->
<g id="edge306" class="edge">
<title>layer_2_expert_6&#45;&gt;layer_2_expert_6_up_proj</title>
<path fill="none" stroke="black" d="M10282.5,-2583.62C10282.5,-2575.52 10282.5,-2566.72 10282.5,-2558.21"/>
<polygon fill="black" stroke="black" points="10286,-2558.04 10282.5,-2548.04 10279,-2558.04 10286,-2558.04"/>
</g>
<!-- layer_2_expert_6_activation -->
<g id="node225" class="node">
<title>layer_2_expert_6_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="10468,-2443.74 10097,-2443.74 10097,-2375.74 10468,-2375.74 10468,-2443.74"/>
<text text-anchor="middle" x="10282.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 6 GELU Activation</text>
<text text-anchor="middle" x="10282.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10282.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10282.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_expert_6_gate_proj&#45;&gt;layer_2_expert_6_activation -->
<g id="edge305" class="edge">
<title>layer_2_expert_6_gate_proj&#45;&gt;layer_2_expert_6_activation</title>
<path fill="none" stroke="black" d="M10019.53,-2479.69C10060.1,-2469.05 10105.24,-2457.22 10146.49,-2446.4"/>
<polygon fill="black" stroke="black" points="10147.55,-2449.74 10156.34,-2443.82 10145.78,-2442.97 10147.55,-2449.74"/>
</g>
<!-- layer_2_expert_6_up_proj&#45;&gt;layer_2_expert_6_activation -->
<g id="edge307" class="edge">
<title>layer_2_expert_6_up_proj&#45;&gt;layer_2_expert_6_activation</title>
<path fill="none" stroke="black" d="M10282.5,-2479.62C10282.5,-2471.52 10282.5,-2462.72 10282.5,-2454.21"/>
<polygon fill="black" stroke="black" points="10286,-2454.04 10282.5,-2444.04 10279,-2454.04 10286,-2454.04"/>
</g>
<!-- layer_2_expert_6_down_proj -->
<g id="node226" class="node">
<title>layer_2_expert_6_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10905,-2339.74 10534,-2339.74 10534,-2271.74 10905,-2271.74 10905,-2339.74"/>
<text text-anchor="middle" x="10719.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 6 Down Proj</text>
<text text-anchor="middle" x="10719.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10719.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10719.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_2_expert_6_activation&#45;&gt;layer_2_expert_6_down_proj -->
<g id="edge308" class="edge">
<title>layer_2_expert_6_activation&#45;&gt;layer_2_expert_6_down_proj</title>
<path fill="none" stroke="black" d="M10424.08,-2375.69C10470.05,-2364.97 10521.22,-2353.02 10567.89,-2342.13"/>
<polygon fill="black" stroke="black" points="10568.83,-2345.5 10577.77,-2339.82 10567.24,-2338.69 10568.83,-2345.5"/>
</g>
<!-- layer_2_expert_6_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge309" class="edge">
<title>layer_2_expert_6_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M10905.1,-2277.42C11021.4,-2260.3 11174.66,-2237.75 11311.4,-2217.62"/>
<polygon fill="black" stroke="black" points="11312.25,-2221.03 11321.63,-2216.12 11311.23,-2214.11 11312.25,-2221.03"/>
</g>
<!-- layer_2_expert_7_gate_proj -->
<g id="node228" class="node">
<title>layer_2_expert_7_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10857,-2547.74 10486,-2547.74 10486,-2479.74 10857,-2479.74 10857,-2547.74"/>
<text text-anchor="middle" x="10671.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 7 Gate Proj</text>
<text text-anchor="middle" x="10671.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10671.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10671.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_expert_7&#45;&gt;layer_2_expert_7_gate_proj -->
<g id="edge311" class="edge">
<title>layer_2_expert_7&#45;&gt;layer_2_expert_7_gate_proj</title>
<path fill="none" stroke="black" d="M10934.47,-2583.69C10893.9,-2573.05 10848.76,-2561.22 10807.51,-2550.4"/>
<polygon fill="black" stroke="black" points="10808.22,-2546.97 10797.66,-2547.82 10806.45,-2553.74 10808.22,-2546.97"/>
</g>
<!-- layer_2_expert_7_up_proj -->
<g id="node229" class="node">
<title>layer_2_expert_7_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11246,-2547.74 10875,-2547.74 10875,-2479.74 11246,-2479.74 11246,-2547.74"/>
<text text-anchor="middle" x="11060.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 7 Up Proj</text>
<text text-anchor="middle" x="11060.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11060.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11060.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_expert_7&#45;&gt;layer_2_expert_7_up_proj -->
<g id="edge313" class="edge">
<title>layer_2_expert_7&#45;&gt;layer_2_expert_7_up_proj</title>
<path fill="none" stroke="black" d="M11060.5,-2583.62C11060.5,-2575.52 11060.5,-2566.72 11060.5,-2558.21"/>
<polygon fill="black" stroke="black" points="11064,-2558.04 11060.5,-2548.04 11057,-2558.04 11064,-2558.04"/>
</g>
<!-- layer_2_expert_7_activation -->
<g id="node230" class="node">
<title>layer_2_expert_7_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="11246,-2443.74 10875,-2443.74 10875,-2375.74 11246,-2375.74 11246,-2443.74"/>
<text text-anchor="middle" x="11060.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 7 GELU Activation</text>
<text text-anchor="middle" x="11060.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11060.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11060.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_expert_7_gate_proj&#45;&gt;layer_2_expert_7_activation -->
<g id="edge312" class="edge">
<title>layer_2_expert_7_gate_proj&#45;&gt;layer_2_expert_7_activation</title>
<path fill="none" stroke="black" d="M10797.53,-2479.69C10838.1,-2469.05 10883.24,-2457.22 10924.49,-2446.4"/>
<polygon fill="black" stroke="black" points="10925.55,-2449.74 10934.34,-2443.82 10923.78,-2442.97 10925.55,-2449.74"/>
</g>
<!-- layer_2_expert_7_up_proj&#45;&gt;layer_2_expert_7_activation -->
<g id="edge314" class="edge">
<title>layer_2_expert_7_up_proj&#45;&gt;layer_2_expert_7_activation</title>
<path fill="none" stroke="black" d="M11060.5,-2479.62C11060.5,-2471.52 11060.5,-2462.72 11060.5,-2454.21"/>
<polygon fill="black" stroke="black" points="11064,-2454.04 11060.5,-2444.04 11057,-2454.04 11064,-2454.04"/>
</g>
<!-- layer_2_expert_7_down_proj -->
<g id="node231" class="node">
<title>layer_2_expert_7_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11440,-2339.74 11069,-2339.74 11069,-2271.74 11440,-2271.74 11440,-2339.74"/>
<text text-anchor="middle" x="11254.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 7 Down Proj</text>
<text text-anchor="middle" x="11254.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11254.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11254.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_2_expert_7_activation&#45;&gt;layer_2_expert_7_down_proj -->
<g id="edge315" class="edge">
<title>layer_2_expert_7_activation&#45;&gt;layer_2_expert_7_down_proj</title>
<path fill="none" stroke="black" d="M11123.49,-2375.62C11142.3,-2365.73 11163.07,-2354.81 11182.42,-2344.64"/>
<polygon fill="black" stroke="black" points="11184.28,-2347.62 11191.5,-2339.86 11181.02,-2341.42 11184.28,-2347.62"/>
</g>
<!-- layer_2_expert_7_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge316" class="edge">
<title>layer_2_expert_7_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M11349.16,-2271.64C11377.51,-2261.73 11409.74,-2250.46 11442.23,-2239.11"/>
<polygon fill="black" stroke="black" points="11443.57,-2242.35 11451.85,-2235.74 11441.26,-2235.74 11443.57,-2242.35"/>
</g>
<!-- layer_2_expert_8_gate_proj -->
<g id="node233" class="node">
<title>layer_2_expert_8_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11635,-2547.74 11264,-2547.74 11264,-2479.74 11635,-2479.74 11635,-2547.74"/>
<text text-anchor="middle" x="11449.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 8 Gate Proj</text>
<text text-anchor="middle" x="11449.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11449.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11449.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_expert_8&#45;&gt;layer_2_expert_8_gate_proj -->
<g id="edge318" class="edge">
<title>layer_2_expert_8&#45;&gt;layer_2_expert_8_gate_proj</title>
<path fill="none" stroke="black" d="M11580.51,-2583.62C11561.7,-2573.73 11540.93,-2562.81 11521.58,-2552.64"/>
<polygon fill="black" stroke="black" points="11522.98,-2549.42 11512.5,-2547.86 11519.72,-2555.62 11522.98,-2549.42"/>
</g>
<!-- layer_2_expert_8_up_proj -->
<g id="node234" class="node">
<title>layer_2_expert_8_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12024,-2547.74 11653,-2547.74 11653,-2479.74 12024,-2479.74 12024,-2547.74"/>
<text text-anchor="middle" x="11838.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 8 Up Proj</text>
<text text-anchor="middle" x="11838.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11838.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11838.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_expert_8&#45;&gt;layer_2_expert_8_up_proj -->
<g id="edge320" class="edge">
<title>layer_2_expert_8&#45;&gt;layer_2_expert_8_up_proj</title>
<path fill="none" stroke="black" d="M11706.81,-2583.62C11725.72,-2573.73 11746.6,-2562.81 11766.05,-2552.64"/>
<polygon fill="black" stroke="black" points="11767.93,-2555.6 11775.17,-2547.86 11764.69,-2549.4 11767.93,-2555.6"/>
</g>
<!-- layer_2_expert_8_activation -->
<g id="node235" class="node">
<title>layer_2_expert_8_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="11829,-2443.74 11458,-2443.74 11458,-2375.74 11829,-2375.74 11829,-2443.74"/>
<text text-anchor="middle" x="11643.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 8 GELU Activation</text>
<text text-anchor="middle" x="11643.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11643.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11643.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_expert_8_gate_proj&#45;&gt;layer_2_expert_8_activation -->
<g id="edge319" class="edge">
<title>layer_2_expert_8_gate_proj&#45;&gt;layer_2_expert_8_activation</title>
<path fill="none" stroke="black" d="M11512.49,-2479.62C11531.3,-2469.73 11552.07,-2458.81 11571.42,-2448.64"/>
<polygon fill="black" stroke="black" points="11573.28,-2451.62 11580.5,-2443.86 11570.02,-2445.42 11573.28,-2451.62"/>
</g>
<!-- layer_2_expert_8_up_proj&#45;&gt;layer_2_expert_8_activation -->
<g id="edge321" class="edge">
<title>layer_2_expert_8_up_proj&#45;&gt;layer_2_expert_8_activation</title>
<path fill="none" stroke="black" d="M11775.19,-2479.62C11756.28,-2469.73 11735.4,-2458.81 11715.95,-2448.64"/>
<polygon fill="black" stroke="black" points="11717.31,-2445.4 11706.83,-2443.86 11714.07,-2451.6 11717.31,-2445.4"/>
</g>
<!-- layer_2_expert_8_down_proj -->
<g id="node236" class="node">
<title>layer_2_expert_8_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11829,-2339.74 11458,-2339.74 11458,-2271.74 11829,-2271.74 11829,-2339.74"/>
<text text-anchor="middle" x="11643.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 8 Down Proj</text>
<text text-anchor="middle" x="11643.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11643.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11643.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_2_expert_8_activation&#45;&gt;layer_2_expert_8_down_proj -->
<g id="edge322" class="edge">
<title>layer_2_expert_8_activation&#45;&gt;layer_2_expert_8_down_proj</title>
<path fill="none" stroke="black" d="M11643.5,-2375.62C11643.5,-2367.52 11643.5,-2358.72 11643.5,-2350.21"/>
<polygon fill="black" stroke="black" points="11647,-2350.04 11643.5,-2340.04 11640,-2350.04 11647,-2350.04"/>
</g>
<!-- layer_2_expert_8_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge323" class="edge">
<title>layer_2_expert_8_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M11643.5,-2271.47C11643.5,-2263.64 11643.5,-2254.98 11643.5,-2246.09"/>
<polygon fill="black" stroke="black" points="11647,-2246 11643.5,-2236 11640,-2246 11647,-2246"/>
</g>
<!-- layer_2_expert_9_gate_proj -->
<g id="node238" class="node">
<title>layer_2_expert_9_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12413,-2547.74 12042,-2547.74 12042,-2479.74 12413,-2479.74 12413,-2547.74"/>
<text text-anchor="middle" x="12227.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 9 Gate Proj</text>
<text text-anchor="middle" x="12227.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12227.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12227.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_expert_9&#45;&gt;layer_2_expert_9_gate_proj -->
<g id="edge325" class="edge">
<title>layer_2_expert_9&#45;&gt;layer_2_expert_9_gate_proj</title>
<path fill="none" stroke="black" d="M12227.5,-2583.62C12227.5,-2575.52 12227.5,-2566.72 12227.5,-2558.21"/>
<polygon fill="black" stroke="black" points="12231,-2558.04 12227.5,-2548.04 12224,-2558.04 12231,-2558.04"/>
</g>
<!-- layer_2_expert_9_up_proj -->
<g id="node239" class="node">
<title>layer_2_expert_9_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12802,-2547.74 12431,-2547.74 12431,-2479.74 12802,-2479.74 12802,-2547.74"/>
<text text-anchor="middle" x="12616.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 9 Up Proj</text>
<text text-anchor="middle" x="12616.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12616.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12616.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_expert_9&#45;&gt;layer_2_expert_9_up_proj -->
<g id="edge327" class="edge">
<title>layer_2_expert_9&#45;&gt;layer_2_expert_9_up_proj</title>
<path fill="none" stroke="black" d="M12353.53,-2583.69C12394.1,-2573.05 12439.24,-2561.22 12480.49,-2550.4"/>
<polygon fill="black" stroke="black" points="12481.55,-2553.74 12490.34,-2547.82 12479.78,-2546.97 12481.55,-2553.74"/>
</g>
<!-- layer_2_expert_9_activation -->
<g id="node240" class="node">
<title>layer_2_expert_9_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="12413,-2443.74 12042,-2443.74 12042,-2375.74 12413,-2375.74 12413,-2443.74"/>
<text text-anchor="middle" x="12227.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 9 GELU Activation</text>
<text text-anchor="middle" x="12227.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12227.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12227.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_expert_9_gate_proj&#45;&gt;layer_2_expert_9_activation -->
<g id="edge326" class="edge">
<title>layer_2_expert_9_gate_proj&#45;&gt;layer_2_expert_9_activation</title>
<path fill="none" stroke="black" d="M12227.5,-2479.62C12227.5,-2471.52 12227.5,-2462.72 12227.5,-2454.21"/>
<polygon fill="black" stroke="black" points="12231,-2454.04 12227.5,-2444.04 12224,-2454.04 12231,-2454.04"/>
</g>
<!-- layer_2_expert_9_up_proj&#45;&gt;layer_2_expert_9_activation -->
<g id="edge328" class="edge">
<title>layer_2_expert_9_up_proj&#45;&gt;layer_2_expert_9_activation</title>
<path fill="none" stroke="black" d="M12490.47,-2479.69C12449.9,-2469.05 12404.76,-2457.22 12363.51,-2446.4"/>
<polygon fill="black" stroke="black" points="12364.22,-2442.97 12353.66,-2443.82 12362.45,-2449.74 12364.22,-2442.97"/>
</g>
<!-- layer_2_expert_9_down_proj -->
<g id="node241" class="node">
<title>layer_2_expert_9_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12316,-2339.74 11945,-2339.74 11945,-2271.74 12316,-2271.74 12316,-2339.74"/>
<text text-anchor="middle" x="12130.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 9 Down Proj</text>
<text text-anchor="middle" x="12130.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12130.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12130.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_2_expert_9_activation&#45;&gt;layer_2_expert_9_down_proj -->
<g id="edge329" class="edge">
<title>layer_2_expert_9_activation&#45;&gt;layer_2_expert_9_down_proj</title>
<path fill="none" stroke="black" d="M12196.01,-2375.62C12187.45,-2366.63 12178.09,-2356.78 12169.18,-2347.42"/>
<polygon fill="black" stroke="black" points="12171.59,-2344.87 12162.17,-2340.04 12166.52,-2349.7 12171.59,-2344.87"/>
</g>
<!-- layer_2_expert_9_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge330" class="edge">
<title>layer_2_expert_9_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M12012.3,-2271.73C11976.13,-2261.63 11934.88,-2250.11 11893.39,-2238.52"/>
<polygon fill="black" stroke="black" points="11894.26,-2235.13 11883.69,-2235.82 11892.38,-2241.88 11894.26,-2235.13"/>
</g>
<!-- layer_2_expert_10_gate_proj -->
<g id="node243" class="node">
<title>layer_2_expert_10_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13191,-2547.74 12820,-2547.74 12820,-2479.74 13191,-2479.74 13191,-2547.74"/>
<text text-anchor="middle" x="13005.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 10 Gate Proj</text>
<text text-anchor="middle" x="13005.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13005.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13005.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_expert_10&#45;&gt;layer_2_expert_10_gate_proj -->
<g id="edge332" class="edge">
<title>layer_2_expert_10&#45;&gt;layer_2_expert_10_gate_proj</title>
<path fill="none" stroke="black" d="M13005.5,-2583.62C13005.5,-2575.52 13005.5,-2566.72 13005.5,-2558.21"/>
<polygon fill="black" stroke="black" points="13009,-2558.04 13005.5,-2548.04 13002,-2558.04 13009,-2558.04"/>
</g>
<!-- layer_2_expert_10_up_proj -->
<g id="node244" class="node">
<title>layer_2_expert_10_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13580,-2547.74 13209,-2547.74 13209,-2479.74 13580,-2479.74 13580,-2547.74"/>
<text text-anchor="middle" x="13394.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 10 Up Proj</text>
<text text-anchor="middle" x="13394.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13394.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13394.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_expert_10&#45;&gt;layer_2_expert_10_up_proj -->
<g id="edge334" class="edge">
<title>layer_2_expert_10&#45;&gt;layer_2_expert_10_up_proj</title>
<path fill="none" stroke="black" d="M13131.53,-2583.69C13172.1,-2573.05 13217.24,-2561.22 13258.49,-2550.4"/>
<polygon fill="black" stroke="black" points="13259.55,-2553.74 13268.34,-2547.82 13257.78,-2546.97 13259.55,-2553.74"/>
</g>
<!-- layer_2_expert_10_activation -->
<g id="node245" class="node">
<title>layer_2_expert_10_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="13191,-2443.74 12820,-2443.74 12820,-2375.74 13191,-2375.74 13191,-2443.74"/>
<text text-anchor="middle" x="13005.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 10 GELU Activation</text>
<text text-anchor="middle" x="13005.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13005.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13005.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_expert_10_gate_proj&#45;&gt;layer_2_expert_10_activation -->
<g id="edge333" class="edge">
<title>layer_2_expert_10_gate_proj&#45;&gt;layer_2_expert_10_activation</title>
<path fill="none" stroke="black" d="M13005.5,-2479.62C13005.5,-2471.52 13005.5,-2462.72 13005.5,-2454.21"/>
<polygon fill="black" stroke="black" points="13009,-2454.04 13005.5,-2444.04 13002,-2454.04 13009,-2454.04"/>
</g>
<!-- layer_2_expert_10_up_proj&#45;&gt;layer_2_expert_10_activation -->
<g id="edge335" class="edge">
<title>layer_2_expert_10_up_proj&#45;&gt;layer_2_expert_10_activation</title>
<path fill="none" stroke="black" d="M13268.47,-2479.69C13227.9,-2469.05 13182.76,-2457.22 13141.51,-2446.4"/>
<polygon fill="black" stroke="black" points="13142.22,-2442.97 13131.66,-2443.82 13140.45,-2449.74 13142.22,-2442.97"/>
</g>
<!-- layer_2_expert_10_down_proj -->
<g id="node246" class="node">
<title>layer_2_expert_10_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12948,-2339.74 12577,-2339.74 12577,-2271.74 12948,-2271.74 12948,-2339.74"/>
<text text-anchor="middle" x="12762.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 10 Down Proj</text>
<text text-anchor="middle" x="12762.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12762.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12762.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_2_expert_10_activation&#45;&gt;layer_2_expert_10_down_proj -->
<g id="edge336" class="edge">
<title>layer_2_expert_10_activation&#45;&gt;layer_2_expert_10_down_proj</title>
<path fill="none" stroke="black" d="M12926.6,-2375.62C12902.4,-2365.46 12875.6,-2354.22 12850.81,-2343.81"/>
<polygon fill="black" stroke="black" points="12851.99,-2340.51 12841.41,-2339.86 12849.28,-2346.96 12851.99,-2340.51"/>
</g>
<!-- layer_2_expert_10_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge337" class="edge">
<title>layer_2_expert_10_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M12576.78,-2282.17C12456.03,-2267.49 12292.46,-2247.61 12136,-2228.6"/>
<polygon fill="black" stroke="black" points="12136.05,-2225.08 12125.7,-2227.35 12135.2,-2232.03 12136.05,-2225.08"/>
</g>
<!-- layer_2_expert_11_gate_proj -->
<g id="node248" class="node">
<title>layer_2_expert_11_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13969,-2547.74 13598,-2547.74 13598,-2479.74 13969,-2479.74 13969,-2547.74"/>
<text text-anchor="middle" x="13783.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 11 Gate Proj</text>
<text text-anchor="middle" x="13783.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13783.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13783.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_expert_11&#45;&gt;layer_2_expert_11_gate_proj -->
<g id="edge339" class="edge">
<title>layer_2_expert_11&#45;&gt;layer_2_expert_11_gate_proj</title>
<path fill="none" stroke="black" d="M13783.5,-2583.62C13783.5,-2575.52 13783.5,-2566.72 13783.5,-2558.21"/>
<polygon fill="black" stroke="black" points="13787,-2558.04 13783.5,-2548.04 13780,-2558.04 13787,-2558.04"/>
</g>
<!-- layer_2_expert_11_up_proj -->
<g id="node249" class="node">
<title>layer_2_expert_11_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14358,-2547.74 13987,-2547.74 13987,-2479.74 14358,-2479.74 14358,-2547.74"/>
<text text-anchor="middle" x="14172.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 11 Up Proj</text>
<text text-anchor="middle" x="14172.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14172.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14172.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_expert_11&#45;&gt;layer_2_expert_11_up_proj -->
<g id="edge341" class="edge">
<title>layer_2_expert_11&#45;&gt;layer_2_expert_11_up_proj</title>
<path fill="none" stroke="black" d="M13909.53,-2583.69C13950.1,-2573.05 13995.24,-2561.22 14036.49,-2550.4"/>
<polygon fill="black" stroke="black" points="14037.55,-2553.74 14046.34,-2547.82 14035.78,-2546.97 14037.55,-2553.74"/>
</g>
<!-- layer_2_expert_11_activation -->
<g id="node250" class="node">
<title>layer_2_expert_11_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="13969,-2443.74 13598,-2443.74 13598,-2375.74 13969,-2375.74 13969,-2443.74"/>
<text text-anchor="middle" x="13783.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 11 GELU Activation</text>
<text text-anchor="middle" x="13783.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13783.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13783.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_expert_11_gate_proj&#45;&gt;layer_2_expert_11_activation -->
<g id="edge340" class="edge">
<title>layer_2_expert_11_gate_proj&#45;&gt;layer_2_expert_11_activation</title>
<path fill="none" stroke="black" d="M13783.5,-2479.62C13783.5,-2471.52 13783.5,-2462.72 13783.5,-2454.21"/>
<polygon fill="black" stroke="black" points="13787,-2454.04 13783.5,-2444.04 13780,-2454.04 13787,-2454.04"/>
</g>
<!-- layer_2_expert_11_up_proj&#45;&gt;layer_2_expert_11_activation -->
<g id="edge342" class="edge">
<title>layer_2_expert_11_up_proj&#45;&gt;layer_2_expert_11_activation</title>
<path fill="none" stroke="black" d="M14046.47,-2479.69C14005.9,-2469.05 13960.76,-2457.22 13919.51,-2446.4"/>
<polygon fill="black" stroke="black" points="13920.22,-2442.97 13909.66,-2443.82 13918.45,-2449.74 13920.22,-2442.97"/>
</g>
<!-- layer_2_expert_11_down_proj -->
<g id="node251" class="node">
<title>layer_2_expert_11_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13653,-2339.74 13282,-2339.74 13282,-2271.74 13653,-2271.74 13653,-2339.74"/>
<text text-anchor="middle" x="13467.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 11 Down Proj</text>
<text text-anchor="middle" x="13467.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13467.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13467.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_2_expert_11_activation&#45;&gt;layer_2_expert_11_down_proj -->
<g id="edge343" class="edge">
<title>layer_2_expert_11_activation&#45;&gt;layer_2_expert_11_down_proj</title>
<path fill="none" stroke="black" d="M13680.9,-2375.62C13648.51,-2365.17 13612.56,-2353.56 13579.54,-2342.9"/>
<polygon fill="black" stroke="black" points="13580.44,-2339.52 13569.85,-2339.78 13578.29,-2346.18 13580.44,-2339.52"/>
</g>
<!-- layer_2_expert_11_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge344" class="edge">
<title>layer_2_expert_11_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M13281.72,-2290.89C13005.88,-2270.32 12479.58,-2231.08 12097.77,-2202.61"/>
<polygon fill="black" stroke="black" points="12097.88,-2199.11 12087.65,-2201.86 12097.36,-2206.09 12097.88,-2199.11"/>
</g>
<!-- layer_2_expert_12_gate_proj -->
<g id="node253" class="node">
<title>layer_2_expert_12_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14747,-2547.74 14376,-2547.74 14376,-2479.74 14747,-2479.74 14747,-2547.74"/>
<text text-anchor="middle" x="14561.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 12 Gate Proj</text>
<text text-anchor="middle" x="14561.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14561.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14561.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_expert_12&#45;&gt;layer_2_expert_12_gate_proj -->
<g id="edge346" class="edge">
<title>layer_2_expert_12&#45;&gt;layer_2_expert_12_gate_proj</title>
<path fill="none" stroke="black" d="M14561.5,-2583.62C14561.5,-2575.52 14561.5,-2566.72 14561.5,-2558.21"/>
<polygon fill="black" stroke="black" points="14565,-2558.04 14561.5,-2548.04 14558,-2558.04 14565,-2558.04"/>
</g>
<!-- layer_2_expert_12_up_proj -->
<g id="node254" class="node">
<title>layer_2_expert_12_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="15136,-2547.74 14765,-2547.74 14765,-2479.74 15136,-2479.74 15136,-2547.74"/>
<text text-anchor="middle" x="14950.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 12 Up Proj</text>
<text text-anchor="middle" x="14950.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14950.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14950.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_expert_12&#45;&gt;layer_2_expert_12_up_proj -->
<g id="edge348" class="edge">
<title>layer_2_expert_12&#45;&gt;layer_2_expert_12_up_proj</title>
<path fill="none" stroke="black" d="M14687.53,-2583.69C14728.1,-2573.05 14773.24,-2561.22 14814.49,-2550.4"/>
<polygon fill="black" stroke="black" points="14815.55,-2553.74 14824.34,-2547.82 14813.78,-2546.97 14815.55,-2553.74"/>
</g>
<!-- layer_2_expert_12_activation -->
<g id="node255" class="node">
<title>layer_2_expert_12_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="14747,-2443.74 14376,-2443.74 14376,-2375.74 14747,-2375.74 14747,-2443.74"/>
<text text-anchor="middle" x="14561.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 12 GELU Activation</text>
<text text-anchor="middle" x="14561.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14561.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14561.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_expert_12_gate_proj&#45;&gt;layer_2_expert_12_activation -->
<g id="edge347" class="edge">
<title>layer_2_expert_12_gate_proj&#45;&gt;layer_2_expert_12_activation</title>
<path fill="none" stroke="black" d="M14561.5,-2479.62C14561.5,-2471.52 14561.5,-2462.72 14561.5,-2454.21"/>
<polygon fill="black" stroke="black" points="14565,-2454.04 14561.5,-2444.04 14558,-2454.04 14565,-2454.04"/>
</g>
<!-- layer_2_expert_12_up_proj&#45;&gt;layer_2_expert_12_activation -->
<g id="edge349" class="edge">
<title>layer_2_expert_12_up_proj&#45;&gt;layer_2_expert_12_activation</title>
<path fill="none" stroke="black" d="M14824.47,-2479.69C14783.9,-2469.05 14738.76,-2457.22 14697.51,-2446.4"/>
<polygon fill="black" stroke="black" points="14698.22,-2442.97 14687.66,-2443.82 14696.45,-2449.74 14698.22,-2442.97"/>
</g>
<!-- layer_2_expert_12_down_proj -->
<g id="node256" class="node">
<title>layer_2_expert_12_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14395,-2339.74 14024,-2339.74 14024,-2271.74 14395,-2271.74 14395,-2339.74"/>
<text text-anchor="middle" x="14209.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 12 Down Proj</text>
<text text-anchor="middle" x="14209.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14209.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14209.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_2_expert_12_activation&#45;&gt;layer_2_expert_12_down_proj -->
<g id="edge350" class="edge">
<title>layer_2_expert_12_activation&#45;&gt;layer_2_expert_12_down_proj</title>
<path fill="none" stroke="black" d="M14447.22,-2375.62C14410.82,-2365.08 14370.39,-2353.36 14333.36,-2342.63"/>
<polygon fill="black" stroke="black" points="14334.09,-2339.2 14323.51,-2339.78 14332.14,-2345.92 14334.09,-2339.2"/>
</g>
<!-- layer_2_expert_12_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge351" class="edge">
<title>layer_2_expert_12_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M14023.75,-2293.1C13917.9,-2286.58 13782.78,-2278.44 13662.5,-2271.74 13116.89,-2241.37 12488.13,-2209.84 12079.18,-2189.8"/>
<polygon fill="black" stroke="black" points="12079.12,-2186.29 12068.96,-2189.3 12078.77,-2193.28 12079.12,-2186.29"/>
</g>
<!-- layer_2_expert_13_gate_proj -->
<g id="node258" class="node">
<title>layer_2_expert_13_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="15525,-2547.74 15154,-2547.74 15154,-2479.74 15525,-2479.74 15525,-2547.74"/>
<text text-anchor="middle" x="15339.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 13 Gate Proj</text>
<text text-anchor="middle" x="15339.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15339.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15339.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_expert_13&#45;&gt;layer_2_expert_13_gate_proj -->
<g id="edge353" class="edge">
<title>layer_2_expert_13&#45;&gt;layer_2_expert_13_gate_proj</title>
<path fill="none" stroke="black" d="M15339.5,-2583.62C15339.5,-2575.52 15339.5,-2566.72 15339.5,-2558.21"/>
<polygon fill="black" stroke="black" points="15343,-2558.04 15339.5,-2548.04 15336,-2558.04 15343,-2558.04"/>
</g>
<!-- layer_2_expert_13_up_proj -->
<g id="node259" class="node">
<title>layer_2_expert_13_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="15914,-2547.74 15543,-2547.74 15543,-2479.74 15914,-2479.74 15914,-2547.74"/>
<text text-anchor="middle" x="15728.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 13 Up Proj</text>
<text text-anchor="middle" x="15728.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15728.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15728.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_expert_13&#45;&gt;layer_2_expert_13_up_proj -->
<g id="edge355" class="edge">
<title>layer_2_expert_13&#45;&gt;layer_2_expert_13_up_proj</title>
<path fill="none" stroke="black" d="M15465.53,-2583.69C15506.1,-2573.05 15551.24,-2561.22 15592.49,-2550.4"/>
<polygon fill="black" stroke="black" points="15593.55,-2553.74 15602.34,-2547.82 15591.78,-2546.97 15593.55,-2553.74"/>
</g>
<!-- layer_2_expert_13_activation -->
<g id="node260" class="node">
<title>layer_2_expert_13_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="15525,-2443.74 15154,-2443.74 15154,-2375.74 15525,-2375.74 15525,-2443.74"/>
<text text-anchor="middle" x="15339.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 13 GELU Activation</text>
<text text-anchor="middle" x="15339.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15339.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15339.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_expert_13_gate_proj&#45;&gt;layer_2_expert_13_activation -->
<g id="edge354" class="edge">
<title>layer_2_expert_13_gate_proj&#45;&gt;layer_2_expert_13_activation</title>
<path fill="none" stroke="black" d="M15339.5,-2479.62C15339.5,-2471.52 15339.5,-2462.72 15339.5,-2454.21"/>
<polygon fill="black" stroke="black" points="15343,-2454.04 15339.5,-2444.04 15336,-2454.04 15343,-2454.04"/>
</g>
<!-- layer_2_expert_13_up_proj&#45;&gt;layer_2_expert_13_activation -->
<g id="edge356" class="edge">
<title>layer_2_expert_13_up_proj&#45;&gt;layer_2_expert_13_activation</title>
<path fill="none" stroke="black" d="M15602.47,-2479.69C15561.9,-2469.05 15516.76,-2457.22 15475.51,-2446.4"/>
<polygon fill="black" stroke="black" points="15476.22,-2442.97 15465.66,-2443.82 15474.45,-2449.74 15476.22,-2442.97"/>
</g>
<!-- layer_2_expert_13_down_proj -->
<g id="node261" class="node">
<title>layer_2_expert_13_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="15155,-2339.74 14784,-2339.74 14784,-2271.74 15155,-2271.74 15155,-2339.74"/>
<text text-anchor="middle" x="14969.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 13 Down Proj</text>
<text text-anchor="middle" x="14969.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14969.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14969.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_2_expert_13_activation&#45;&gt;layer_2_expert_13_down_proj -->
<g id="edge357" class="edge">
<title>layer_2_expert_13_activation&#45;&gt;layer_2_expert_13_down_proj</title>
<path fill="none" stroke="black" d="M15219.63,-2375.69C15181.2,-2365.1 15138.47,-2353.32 15099.36,-2342.54"/>
<polygon fill="black" stroke="black" points="15100.07,-2339.1 15089.5,-2339.82 15098.21,-2345.85 15100.07,-2339.1"/>
</g>
<!-- layer_2_expert_13_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge358" class="edge">
<title>layer_2_expert_13_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M14783.79,-2292.91C14673.58,-2286.13 14531.11,-2277.8 14404.5,-2271.74 13577.15,-2232.15 12609.73,-2199.11 12067.63,-2181.79"/>
<polygon fill="black" stroke="black" points="12067.4,-2178.28 12057.29,-2181.46 12067.18,-2185.28 12067.4,-2178.28"/>
</g>
<!-- layer_2_expert_14_gate_proj -->
<g id="node263" class="node">
<title>layer_2_expert_14_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="16303,-2547.74 15932,-2547.74 15932,-2479.74 16303,-2479.74 16303,-2547.74"/>
<text text-anchor="middle" x="16117.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 14 Gate Proj</text>
<text text-anchor="middle" x="16117.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16117.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16117.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_expert_14&#45;&gt;layer_2_expert_14_gate_proj -->
<g id="edge360" class="edge">
<title>layer_2_expert_14&#45;&gt;layer_2_expert_14_gate_proj</title>
<path fill="none" stroke="black" d="M16117.5,-2583.62C16117.5,-2575.52 16117.5,-2566.72 16117.5,-2558.21"/>
<polygon fill="black" stroke="black" points="16121,-2558.04 16117.5,-2548.04 16114,-2558.04 16121,-2558.04"/>
</g>
<!-- layer_2_expert_14_up_proj -->
<g id="node264" class="node">
<title>layer_2_expert_14_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="16692,-2547.74 16321,-2547.74 16321,-2479.74 16692,-2479.74 16692,-2547.74"/>
<text text-anchor="middle" x="16506.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 14 Up Proj</text>
<text text-anchor="middle" x="16506.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16506.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16506.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_expert_14&#45;&gt;layer_2_expert_14_up_proj -->
<g id="edge362" class="edge">
<title>layer_2_expert_14&#45;&gt;layer_2_expert_14_up_proj</title>
<path fill="none" stroke="black" d="M16243.53,-2583.69C16284.1,-2573.05 16329.24,-2561.22 16370.49,-2550.4"/>
<polygon fill="black" stroke="black" points="16371.55,-2553.74 16380.34,-2547.82 16369.78,-2546.97 16371.55,-2553.74"/>
</g>
<!-- layer_2_expert_14_activation -->
<g id="node265" class="node">
<title>layer_2_expert_14_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="16303,-2443.74 15932,-2443.74 15932,-2375.74 16303,-2375.74 16303,-2443.74"/>
<text text-anchor="middle" x="16117.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 14 GELU Activation</text>
<text text-anchor="middle" x="16117.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16117.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16117.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_expert_14_gate_proj&#45;&gt;layer_2_expert_14_activation -->
<g id="edge361" class="edge">
<title>layer_2_expert_14_gate_proj&#45;&gt;layer_2_expert_14_activation</title>
<path fill="none" stroke="black" d="M16117.5,-2479.62C16117.5,-2471.52 16117.5,-2462.72 16117.5,-2454.21"/>
<polygon fill="black" stroke="black" points="16121,-2454.04 16117.5,-2444.04 16114,-2454.04 16121,-2454.04"/>
</g>
<!-- layer_2_expert_14_up_proj&#45;&gt;layer_2_expert_14_activation -->
<g id="edge363" class="edge">
<title>layer_2_expert_14_up_proj&#45;&gt;layer_2_expert_14_activation</title>
<path fill="none" stroke="black" d="M16380.47,-2479.69C16339.9,-2469.05 16294.76,-2457.22 16253.51,-2446.4"/>
<polygon fill="black" stroke="black" points="16254.22,-2442.97 16243.66,-2443.82 16252.45,-2449.74 16254.22,-2442.97"/>
</g>
<!-- layer_2_expert_14_down_proj -->
<g id="node266" class="node">
<title>layer_2_expert_14_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="15738,-2339.74 15367,-2339.74 15367,-2271.74 15738,-2271.74 15738,-2339.74"/>
<text text-anchor="middle" x="15552.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 14 Down Proj</text>
<text text-anchor="middle" x="15552.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15552.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15552.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_2_expert_14_activation&#45;&gt;layer_2_expert_14_down_proj -->
<g id="edge364" class="edge">
<title>layer_2_expert_14_activation&#45;&gt;layer_2_expert_14_down_proj</title>
<path fill="none" stroke="black" d="M15934.45,-2375.69C15874.15,-2364.81 15806.92,-2352.67 15745.88,-2341.65"/>
<polygon fill="black" stroke="black" points="15746.2,-2338.15 15735.74,-2339.82 15744.96,-2345.04 15746.2,-2338.15"/>
</g>
<!-- layer_2_expert_14_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge365" class="edge">
<title>layer_2_expert_14_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M15366.64,-2286.82C15302.64,-2281.21 15230.48,-2275.51 15164.5,-2271.74 14040.77,-2207.57 12712.88,-2182.43 12055.24,-2173.37"/>
<polygon fill="black" stroke="black" points="12055.17,-2169.87 12045.13,-2173.23 12055.08,-2176.87 12055.17,-2169.87"/>
</g>
<!-- layer_2_expert_15_gate_proj -->
<g id="node268" class="node">
<title>layer_2_expert_15_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="17081,-2547.74 16710,-2547.74 16710,-2479.74 17081,-2479.74 17081,-2547.74"/>
<text text-anchor="middle" x="16895.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 15 Gate Proj</text>
<text text-anchor="middle" x="16895.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16895.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16895.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_expert_15&#45;&gt;layer_2_expert_15_gate_proj -->
<g id="edge367" class="edge">
<title>layer_2_expert_15&#45;&gt;layer_2_expert_15_gate_proj</title>
<path fill="none" stroke="black" d="M16895.5,-2583.62C16895.5,-2575.52 16895.5,-2566.72 16895.5,-2558.21"/>
<polygon fill="black" stroke="black" points="16899,-2558.04 16895.5,-2548.04 16892,-2558.04 16899,-2558.04"/>
</g>
<!-- layer_2_expert_15_up_proj -->
<g id="node269" class="node">
<title>layer_2_expert_15_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="17470,-2547.74 17099,-2547.74 17099,-2479.74 17470,-2479.74 17470,-2547.74"/>
<text text-anchor="middle" x="17284.5" y="-2532.54" font-family="Times,serif" font-size="14.00">Expert 15 Up Proj</text>
<text text-anchor="middle" x="17284.5" y="-2517.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="17284.5" y="-2502.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="17284.5" y="-2487.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_expert_15&#45;&gt;layer_2_expert_15_up_proj -->
<g id="edge369" class="edge">
<title>layer_2_expert_15&#45;&gt;layer_2_expert_15_up_proj</title>
<path fill="none" stroke="black" d="M17021.53,-2583.69C17062.1,-2573.05 17107.24,-2561.22 17148.49,-2550.4"/>
<polygon fill="black" stroke="black" points="17149.55,-2553.74 17158.34,-2547.82 17147.78,-2546.97 17149.55,-2553.74"/>
</g>
<!-- layer_2_expert_15_activation -->
<g id="node270" class="node">
<title>layer_2_expert_15_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="17081,-2443.74 16710,-2443.74 16710,-2375.74 17081,-2375.74 17081,-2443.74"/>
<text text-anchor="middle" x="16895.5" y="-2428.54" font-family="Times,serif" font-size="14.00">Expert 15 GELU Activation</text>
<text text-anchor="middle" x="16895.5" y="-2413.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16895.5" y="-2398.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16895.5" y="-2383.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_expert_15_gate_proj&#45;&gt;layer_2_expert_15_activation -->
<g id="edge368" class="edge">
<title>layer_2_expert_15_gate_proj&#45;&gt;layer_2_expert_15_activation</title>
<path fill="none" stroke="black" d="M16895.5,-2479.62C16895.5,-2471.52 16895.5,-2462.72 16895.5,-2454.21"/>
<polygon fill="black" stroke="black" points="16899,-2454.04 16895.5,-2444.04 16892,-2454.04 16899,-2454.04"/>
</g>
<!-- layer_2_expert_15_up_proj&#45;&gt;layer_2_expert_15_activation -->
<g id="edge370" class="edge">
<title>layer_2_expert_15_up_proj&#45;&gt;layer_2_expert_15_activation</title>
<path fill="none" stroke="black" d="M17158.47,-2479.69C17117.9,-2469.05 17072.76,-2457.22 17031.51,-2446.4"/>
<polygon fill="black" stroke="black" points="17032.22,-2442.97 17021.66,-2443.82 17030.45,-2449.74 17032.22,-2442.97"/>
</g>
<!-- layer_2_expert_15_down_proj -->
<g id="node271" class="node">
<title>layer_2_expert_15_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="16604,-2339.74 16233,-2339.74 16233,-2271.74 16604,-2271.74 16604,-2339.74"/>
<text text-anchor="middle" x="16418.5" y="-2324.54" font-family="Times,serif" font-size="14.00">Expert 15 Down Proj</text>
<text text-anchor="middle" x="16418.5" y="-2309.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16418.5" y="-2294.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16418.5" y="-2279.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_2_expert_15_activation&#45;&gt;layer_2_expert_15_down_proj -->
<g id="edge371" class="edge">
<title>layer_2_expert_15_activation&#45;&gt;layer_2_expert_15_down_proj</title>
<path fill="none" stroke="black" d="M16740.96,-2375.69C16690.47,-2364.9 16634.23,-2352.87 16583.03,-2341.92"/>
<polygon fill="black" stroke="black" points="16583.71,-2338.49 16573.2,-2339.82 16582.25,-2345.33 16583.71,-2338.49"/>
</g>
<!-- layer_2_expert_15_down_proj&#45;&gt;layer_2_expert_agg -->
<g id="edge372" class="edge">
<title>layer_2_expert_15_down_proj&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M16232.71,-2294.4C16098.04,-2287.2 15911.55,-2277.83 15747.5,-2271.74 14398.82,-2221.66 12799.89,-2189.31 12058.84,-2175.86"/>
<polygon fill="black" stroke="black" points="12058.87,-2172.36 12048.81,-2175.68 12058.74,-2179.36 12058.87,-2172.36"/>
</g>
<!-- layer_2_expert_agg&#45;&gt;layer_2_expert_residual -->
<g id="edge374" class="edge">
<title>layer_2_expert_agg&#45;&gt;layer_2_expert_residual</title>
<path fill="none" stroke="black" d="M12010.9,-2150.22C12636.75,-2122.07 13893.25,-2065.56 14423.03,-2041.73"/>
<polygon fill="black" stroke="black" points="14423.26,-2045.23 14433.09,-2041.28 14422.95,-2038.24 14423.26,-2045.23"/>
</g>
<!-- layer_2_expert_layernorm -->
<g id="node274" class="node">
<title>layer_2_expert_layernorm</title>
<polygon fill="lightgray" stroke="black" points="14901.5,-1959.74 14433.5,-1959.74 14433.5,-1891.74 14901.5,-1891.74 14901.5,-1959.74"/>
<text text-anchor="middle" x="14667.5" y="-1944.54" font-family="Times,serif" font-size="14.00">Layer Norm (Post&#45;Experts)</text>
<text text-anchor="middle" x="14667.5" y="-1929.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14667.5" y="-1914.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14667.5" y="-1899.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_expert_residual&#45;&gt;layer_2_expert_layernorm -->
<g id="edge375" class="edge">
<title>layer_2_expert_residual&#45;&gt;layer_2_expert_layernorm</title>
<path fill="none" stroke="black" d="M14667.5,-1995.62C14667.5,-1987.52 14667.5,-1978.72 14667.5,-1970.21"/>
<polygon fill="black" stroke="black" points="14671,-1970.04 14667.5,-1960.04 14664,-1970.04 14671,-1970.04"/>
</g>
<!-- layer_3_input -->
<g id="node275" class="node">
<title>layer_3_input</title>
<polygon fill="lightyellow" stroke="black" points="15140.02,-1855.74 14388.35,-1855.74 14194.98,-1749.74 14946.65,-1749.74 15140.02,-1855.74"/>
<text text-anchor="middle" x="14667.5" y="-1814.04" font-family="Times,serif" font-size="14.00">Layer 3 Input</text>
<text text-anchor="middle" x="14667.5" y="-1799.04" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14667.5" y="-1784.04" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_expert_layernorm&#45;&gt;layer_3_input -->
<g id="edge376" class="edge">
<title>layer_2_expert_layernorm&#45;&gt;layer_3_input</title>
<path fill="none" stroke="black" d="M14667.5,-1891.68C14667.5,-1883.64 14667.5,-1874.79 14667.5,-1865.89"/>
<polygon fill="black" stroke="black" points="14671,-1865.87 14667.5,-1855.87 14664,-1865.87 14671,-1865.87"/>
</g>
<!-- layer_3_mha_qkv -->
<g id="node276" class="node">
<title>layer_3_mha_qkv</title>
<polygon fill="lightgreen" stroke="black" points="14774,-1713.74 14293,-1713.74 14293,-1645.74 14774,-1645.74 14774,-1713.74"/>
<text text-anchor="middle" x="14533.5" y="-1698.54" font-family="Times,serif" font-size="14.00">MHA QKV Projection</text>
<text text-anchor="middle" x="14533.5" y="-1683.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14533.5" y="-1668.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="14533.5" y="-1653.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_input&#45;&gt;layer_3_mha_qkv -->
<g id="edge377" class="edge">
<title>layer_3_input&#45;&gt;layer_3_mha_qkv</title>
<path fill="none" stroke="black" d="M14609.89,-1749.72C14599.15,-1740.02 14588.09,-1730.03 14577.82,-1720.76"/>
<polygon fill="black" stroke="black" points="14579.92,-1717.94 14570.15,-1713.83 14575.23,-1723.13 14579.92,-1717.94"/>
</g>
<!-- layer_3_mha_residual -->
<g id="node279" class="node">
<title>layer_3_mha_residual</title>
<polygon fill="lightcoral" stroke="black" points="14905.5,-1401.74 14437.5,-1401.74 14437.5,-1333.74 14905.5,-1333.74 14905.5,-1401.74"/>
<text text-anchor="middle" x="14671.5" y="-1386.54" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="14671.5" y="-1371.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14671.5" y="-1356.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14671.5" y="-1341.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_input&#45;&gt;layer_3_mha_residual -->
<g id="edge380" class="edge">
<title>layer_3_input&#45;&gt;layer_3_mha_residual</title>
<path fill="none" stroke="black" d="M14755.79,-1749.6C14766.96,-1739.17 14776.81,-1727.21 14783.5,-1713.74 14838.06,-1603.87 14843.31,-1544.84 14783.5,-1437.74 14777.02,-1426.14 14767.71,-1416.25 14757.17,-1407.89"/>
<polygon fill="black" stroke="black" points="14759.04,-1404.91 14748.91,-1401.79 14754.88,-1410.55 14759.04,-1404.91"/>
</g>
<!-- layer_3_mha_attention -->
<g id="node277" class="node">
<title>layer_3_mha_attention</title>
<polygon fill="lightgreen" stroke="black" points="14771,-1609.74 14302,-1609.74 14302,-1541.74 14771,-1541.74 14771,-1609.74"/>
<text text-anchor="middle" x="14536.5" y="-1594.54" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="14536.5" y="-1579.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]</text>
<text text-anchor="middle" x="14536.5" y="-1564.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14536.5" y="-1549.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_mha_qkv&#45;&gt;layer_3_mha_attention -->
<g id="edge378" class="edge">
<title>layer_3_mha_qkv&#45;&gt;layer_3_mha_attention</title>
<path fill="none" stroke="black" d="M14534.47,-1645.62C14534.71,-1637.52 14534.97,-1628.72 14535.22,-1620.21"/>
<polygon fill="black" stroke="black" points="14538.73,-1620.14 14535.52,-1610.04 14531.73,-1619.93 14538.73,-1620.14"/>
</g>
<!-- layer_3_mha_proj -->
<g id="node278" class="node">
<title>layer_3_mha_proj</title>
<polygon fill="lightgreen" stroke="black" points="14774.5,-1505.74 14306.5,-1505.74 14306.5,-1437.74 14774.5,-1437.74 14774.5,-1505.74"/>
<text text-anchor="middle" x="14540.5" y="-1490.54" font-family="Times,serif" font-size="14.00">MHA Output Projection</text>
<text text-anchor="middle" x="14540.5" y="-1475.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14540.5" y="-1460.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14540.5" y="-1445.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_mha_attention&#45;&gt;layer_3_mha_proj -->
<g id="edge379" class="edge">
<title>layer_3_mha_attention&#45;&gt;layer_3_mha_proj</title>
<path fill="none" stroke="black" d="M14537.8,-1541.62C14538.12,-1533.52 14538.46,-1524.72 14538.8,-1516.21"/>
<polygon fill="black" stroke="black" points="14542.3,-1516.17 14539.19,-1506.04 14535.3,-1515.89 14542.3,-1516.17"/>
</g>
<!-- layer_3_mha_proj&#45;&gt;layer_3_mha_residual -->
<g id="edge381" class="edge">
<title>layer_3_mha_proj&#45;&gt;layer_3_mha_residual</title>
<path fill="none" stroke="black" d="M14583.03,-1437.62C14595.04,-1428.27 14608.24,-1418 14620.68,-1408.31"/>
<polygon fill="black" stroke="black" points="14622.99,-1410.94 14628.73,-1402.04 14618.69,-1405.42 14622.99,-1410.94"/>
</g>
<!-- layer_3_mha_layernorm -->
<g id="node280" class="node">
<title>layer_3_mha_layernorm</title>
<polygon fill="lightgray" stroke="black" points="14905.5,-1297.74 14437.5,-1297.74 14437.5,-1229.74 14905.5,-1229.74 14905.5,-1297.74"/>
<text text-anchor="middle" x="14671.5" y="-1282.54" font-family="Times,serif" font-size="14.00">Layer Norm (Post&#45;MHA)</text>
<text text-anchor="middle" x="14671.5" y="-1267.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14671.5" y="-1252.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14671.5" y="-1237.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_mha_residual&#45;&gt;layer_3_mha_layernorm -->
<g id="edge382" class="edge">
<title>layer_3_mha_residual&#45;&gt;layer_3_mha_layernorm</title>
<path fill="none" stroke="black" d="M14671.5,-1333.62C14671.5,-1325.52 14671.5,-1316.72 14671.5,-1308.21"/>
<polygon fill="black" stroke="black" points="14675,-1308.04 14671.5,-1298.04 14668,-1308.04 14675,-1308.04"/>
</g>
<!-- layer_3_gate -->
<g id="node281" class="node">
<title>layer_3_gate</title>
<polygon fill="orange" stroke="black" points="14643.02,-1193.74 13891.35,-1193.74 13697.98,-1057.74 14449.65,-1057.74 14643.02,-1193.74"/>
<text text-anchor="middle" x="14170.5" y="-1144.54" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="14170.5" y="-1129.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14170.5" y="-1114.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, k=2]</text>
<text text-anchor="middle" x="14170.5" y="-1099.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_mha_layernorm&#45;&gt;layer_3_gate -->
<g id="edge383" class="edge">
<title>layer_3_mha_layernorm&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" d="M14549.9,-1229.73C14512.61,-1219.61 14470.08,-1208.06 14427.3,-1196.45"/>
<polygon fill="black" stroke="black" points="14428.16,-1193.06 14417.6,-1193.82 14426.33,-1199.81 14428.16,-1193.06"/>
</g>
<!-- layer_3_token_split -->
<g id="node282" class="node">
<title>layer_3_token_split</title>
<polygon fill="lightyellow" stroke="black" points="14643.02,-1021.74 13891.35,-1021.74 13697.98,-885.74 14449.65,-885.74 14643.02,-1021.74"/>
<text text-anchor="middle" x="14170.5" y="-972.54" font-family="Times,serif" font-size="14.00">Token Split by Expert</text>
<text text-anchor="middle" x="14170.5" y="-957.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14170.5" y="-942.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192] per expert</text>
<text text-anchor="middle" x="14170.5" y="-927.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_mha_layernorm&#45;&gt;layer_3_token_split -->
<g id="edge384" class="edge">
<title>layer_3_mha_layernorm&#45;&gt;layer_3_token_split</title>
<path fill="none" stroke="black" d="M14679.19,-1229.73C14687.52,-1184.93 14694.52,-1105.04 14652.5,-1057.74 14641.84,-1045.74 14623.95,-1035.04 14601.18,-1025.53"/>
<polygon fill="black" stroke="black" points="14602.44,-1022.26 14591.86,-1021.8 14599.84,-1028.76 14602.44,-1022.26"/>
</g>
<!-- layer_3_expert_residual -->
<g id="node364" class="node">
<title>layer_3_expert_residual</title>
<polygon fill="lightcoral" stroke="black" points="17422.5,-261.74 16954.5,-261.74 16954.5,-193.74 17422.5,-193.74 17422.5,-261.74"/>
<text text-anchor="middle" x="17188.5" y="-246.54" font-family="Times,serif" font-size="14.00">Expert Residual Add</text>
<text text-anchor="middle" x="17188.5" y="-231.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="17188.5" y="-216.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="17188.5" y="-201.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_mha_layernorm&#45;&gt;layer_3_expert_residual -->
<g id="edge498" class="edge">
<title>layer_3_mha_layernorm&#45;&gt;layer_3_expert_residual</title>
<path fill="none" stroke="black" d="M14905.82,-1261.7C15937.54,-1255.6 20024.5,-1215.02 20024.5,-954.74 20024.5,-954.74 20024.5,-954.74 20024.5,-502.74 20024.5,-373.05 18120.62,-271.94 17432.73,-239.64"/>
<polygon fill="black" stroke="black" points="17432.85,-236.14 17422.69,-239.17 17432.52,-243.13 17432.85,-236.14"/>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_token_split -->
<g id="edge385" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_token_split</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14170.5,-1057.55C14170.5,-1049.24 14170.5,-1040.69 14170.5,-1032.23"/>
<polygon fill="black" stroke="black" points="14174,-1032 14170.5,-1022 14167,-1032 14174,-1032"/>
</g>
<!-- layer_3_expert_0 -->
<g id="node283" class="node">
<title>layer_3_expert_0</title>
<polygon fill="lightcyan" stroke="black" points="8326,-849.74 7955,-849.74 7955,-781.74 8326,-781.74 8326,-849.74"/>
<text text-anchor="middle" x="8140.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8140.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8140.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8140.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_0 -->
<g id="edge386" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_0</title>
<path fill="none" stroke="black" d="M13789.89,-950.45C12902.2,-944.05 10625.69,-921.41 8724.5,-849.74 8595.09,-844.86 8449.69,-836.65 8336.34,-829.65"/>
<polygon fill="black" stroke="black" points="8336.37,-826.14 8326.17,-829.01 8335.93,-833.13 8336.37,-826.14"/>
</g>
<!-- layer_3_expert_1 -->
<g id="node288" class="node">
<title>layer_3_expert_1</title>
<polygon fill="lightcyan" stroke="black" points="9104,-849.74 8733,-849.74 8733,-781.74 9104,-781.74 9104,-849.74"/>
<text text-anchor="middle" x="8918.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8918.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8918.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8918.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_1 -->
<g id="edge393" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_1</title>
<path fill="none" stroke="black" d="M13787.26,-948.74C12989.61,-939.44 11092.86,-912.2 9502.5,-849.74 9373.1,-844.66 9227.7,-836.45 9114.35,-829.49"/>
<polygon fill="black" stroke="black" points="9114.37,-825.99 9104.17,-828.87 9113.94,-832.97 9114.37,-825.99"/>
</g>
<!-- layer_3_expert_2 -->
<g id="node293" class="node">
<title>layer_3_expert_2</title>
<polygon fill="lightcyan" stroke="black" points="9882,-849.74 9511,-849.74 9511,-781.74 9882,-781.74 9882,-849.74"/>
<text text-anchor="middle" x="9696.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9696.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9696.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9696.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_2 -->
<g id="edge400" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_2</title>
<path fill="none" stroke="black" d="M13783.88,-946.34C13084.57,-933.91 11563.01,-902.94 10280.5,-849.74 10151.11,-844.37 10005.71,-836.16 9892.36,-829.28"/>
<polygon fill="black" stroke="black" points="9892.38,-825.77 9882.18,-828.66 9891.95,-832.76 9892.38,-825.77"/>
</g>
<!-- layer_3_expert_3 -->
<g id="node298" class="node">
<title>layer_3_expert_3</title>
<polygon fill="lightcyan" stroke="black" points="10660,-849.74 10289,-849.74 10289,-781.74 10660,-781.74 10660,-849.74"/>
<text text-anchor="middle" x="10474.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10474.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10474.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10474.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_3 -->
<g id="edge407" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_3</title>
<path fill="none" stroke="black" d="M13778.91,-942.71C13188.88,-926.94 12036.8,-893.56 11058.5,-849.74 10929.13,-843.94 10783.73,-835.73 10670.37,-828.95"/>
<polygon fill="black" stroke="black" points="10670.39,-825.45 10660.2,-828.34 10669.97,-832.44 10670.39,-825.45"/>
</g>
<!-- layer_3_expert_4 -->
<g id="node303" class="node">
<title>layer_3_expert_4</title>
<polygon fill="lightcyan" stroke="black" points="11438,-849.74 11067,-849.74 11067,-781.74 11438,-781.74 11438,-849.74"/>
<text text-anchor="middle" x="11252.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="11252.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11252.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11252.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_4 -->
<g id="edge414" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_4</title>
<path fill="none" stroke="black" d="M13770.08,-936.57C13305.13,-917.45 12515.15,-883.89 11836.5,-849.74 11707.16,-843.23 11561.76,-835.02 11448.4,-828.41"/>
<polygon fill="black" stroke="black" points="11448.41,-824.91 11438.22,-827.82 11448,-831.9 11448.41,-824.91"/>
</g>
<!-- layer_3_expert_5 -->
<g id="node308" class="node">
<title>layer_3_expert_5</title>
<polygon fill="lightcyan" stroke="black" points="12216,-849.74 11845,-849.74 11845,-781.74 12216,-781.74 12216,-849.74"/>
<text text-anchor="middle" x="12030.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="12030.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12030.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12030.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_5 -->
<g id="edge421" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_5</title>
<path fill="none" stroke="black" d="M13755.67,-926.38C13295.18,-897.11 12571.49,-851.12 12226.31,-829.18"/>
<polygon fill="black" stroke="black" points="12226.41,-825.68 12216.21,-828.54 12225.97,-832.67 12226.41,-825.68"/>
</g>
<!-- layer_3_expert_6 -->
<g id="node313" class="node">
<title>layer_3_expert_6</title>
<polygon fill="lightcyan" stroke="black" points="12994,-849.74 12623,-849.74 12623,-781.74 12994,-781.74 12994,-849.74"/>
<text text-anchor="middle" x="12808.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12808.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12808.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12808.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_6 -->
<g id="edge428" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_6</title>
<path fill="none" stroke="black" d="M13730.65,-908.82C13485.71,-884.36 13192.97,-855.13 13004.05,-836.27"/>
<polygon fill="black" stroke="black" points="13004.31,-832.78 12994.01,-835.26 13003.61,-839.74 13004.31,-832.78"/>
</g>
<!-- layer_3_expert_7 -->
<g id="node318" class="node">
<title>layer_3_expert_7</title>
<polygon fill="lightcyan" stroke="black" points="13772,-849.74 13401,-849.74 13401,-781.74 13772,-781.74 13772,-849.74"/>
<text text-anchor="middle" x="13586.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="13586.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13586.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13586.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_7 -->
<g id="edge435" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_7</title>
<path fill="none" stroke="black" d="M13882.78,-885.74C13832.86,-874.11 13782.77,-862.45 13738.35,-852.1"/>
<polygon fill="black" stroke="black" points="13738.91,-848.64 13728.38,-849.78 13737.32,-855.46 13738.91,-848.64"/>
</g>
<!-- layer_3_expert_8 -->
<g id="node323" class="node">
<title>layer_3_expert_8</title>
<polygon fill="lightcyan" stroke="black" points="14356,-849.74 13985,-849.74 13985,-781.74 14356,-781.74 14356,-849.74"/>
<text text-anchor="middle" x="14170.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="14170.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14170.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14170.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_8 -->
<g id="edge442" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_8</title>
<path fill="none" stroke="black" d="M14170.5,-885.54C14170.5,-876.78 14170.5,-868.02 14170.5,-859.81"/>
<polygon fill="black" stroke="black" points="14174,-859.76 14170.5,-849.76 14167,-859.76 14174,-859.76"/>
</g>
<!-- layer_3_expert_9 -->
<g id="node328" class="node">
<title>layer_3_expert_9</title>
<polygon fill="lightcyan" stroke="black" points="14939,-849.74 14568,-849.74 14568,-781.74 14939,-781.74 14939,-849.74"/>
<text text-anchor="middle" x="14753.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="14753.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14753.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14753.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_9 -->
<g id="edge449" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_9</title>
<path fill="none" stroke="black" d="M14451.75,-887.13C14503.68,-875.02 14556.03,-862.8 14602.22,-852.03"/>
<polygon fill="black" stroke="black" points="14603.04,-855.43 14611.98,-849.75 14601.45,-848.62 14603.04,-855.43"/>
</g>
<!-- layer_3_expert_10 -->
<g id="node333" class="node">
<title>layer_3_expert_10</title>
<polygon fill="lightcyan" stroke="black" points="15717,-849.74 15346,-849.74 15346,-781.74 15717,-781.74 15717,-849.74"/>
<text text-anchor="middle" x="15531.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="15531.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15531.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15531.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_10 -->
<g id="edge456" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_10</title>
<path fill="none" stroke="black" d="M14498.66,-919.95C14760.12,-893.82 15117.4,-858.12 15335.9,-836.29"/>
<polygon fill="black" stroke="black" points="15336.27,-839.77 15345.87,-835.29 15335.57,-832.8 15336.27,-839.77"/>
</g>
<!-- layer_3_expert_11 -->
<g id="node338" class="node">
<title>layer_3_expert_11</title>
<polygon fill="lightcyan" stroke="black" points="16495,-849.74 16124,-849.74 16124,-781.74 16495,-781.74 16495,-849.74"/>
<text text-anchor="middle" x="16309.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="16309.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16309.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16309.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_11 -->
<g id="edge463" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_11</title>
<path fill="none" stroke="black" d="M14514.17,-930.89C14967.54,-902.06 15750.4,-852.29 16113.74,-829.19"/>
<polygon fill="black" stroke="black" points="16114.08,-832.67 16123.83,-828.54 16113.63,-825.69 16114.08,-832.67"/>
</g>
<!-- layer_3_expert_12 -->
<g id="node343" class="node">
<title>layer_3_expert_12</title>
<polygon fill="lightcyan" stroke="black" points="17273,-849.74 16902,-849.74 16902,-781.74 17273,-781.74 17273,-849.74"/>
<text text-anchor="middle" x="17087.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="17087.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="17087.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="17087.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_12 -->
<g id="edge470" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_12</title>
<path fill="none" stroke="black" d="M14524.96,-938.47C14982.4,-919.74 15802.94,-885.07 16504.5,-849.74 16633.5,-843.24 16778.49,-835.04 16891.62,-828.44"/>
<polygon fill="black" stroke="black" points="16891.99,-831.92 16901.77,-827.84 16891.58,-824.93 16891.99,-831.92"/>
</g>
<!-- layer_3_expert_13 -->
<g id="node348" class="node">
<title>layer_3_expert_13</title>
<polygon fill="lightcyan" stroke="black" points="18051,-849.74 17680,-849.74 17680,-781.74 18051,-781.74 18051,-849.74"/>
<text text-anchor="middle" x="17865.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="17865.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="17865.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="17865.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_13 -->
<g id="edge477" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_13</title>
<path fill="none" stroke="black" d="M14532.06,-943.53C15112.32,-928.12 16287.32,-894.37 17282.5,-849.74 17411.53,-843.95 17556.53,-835.75 17669.64,-828.98"/>
<polygon fill="black" stroke="black" points="17670.02,-832.46 17679.79,-828.37 17669.6,-825.47 17670.02,-832.46"/>
</g>
<!-- layer_3_expert_14 -->
<g id="node353" class="node">
<title>layer_3_expert_14</title>
<polygon fill="lightcyan" stroke="black" points="18829,-849.74 18458,-849.74 18458,-781.74 18829,-781.74 18829,-849.74"/>
<text text-anchor="middle" x="18643.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="18643.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="18643.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="18643.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_14 -->
<g id="edge484" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_14</title>
<path fill="none" stroke="black" d="M14536.66,-946.71C15226.38,-934.55 16765.34,-903.53 18060.5,-849.74 18189.55,-844.38 18334.55,-836.18 18447.66,-829.3"/>
<polygon fill="black" stroke="black" points="18448.04,-832.78 18457.81,-828.68 18447.61,-825.79 18448.04,-832.78"/>
</g>
<!-- layer_3_expert_15 -->
<g id="node358" class="node">
<title>layer_3_expert_15</title>
<polygon fill="lightcyan" stroke="black" points="19607,-849.74 19236,-849.74 19236,-781.74 19607,-781.74 19607,-849.74"/>
<text text-anchor="middle" x="19421.5" y="-834.54" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="19421.5" y="-819.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="19421.5" y="-804.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="19421.5" y="-789.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_token_split&#45;&gt;layer_3_expert_15 -->
<g id="edge491" class="edge">
<title>layer_3_token_split&#45;&gt;layer_3_expert_15</title>
<path fill="none" stroke="black" d="M14539.76,-948.92C15329.04,-939.79 17238.77,-912.65 18838.5,-849.74 18967.56,-844.67 19112.56,-836.47 19225.66,-829.51"/>
<polygon fill="black" stroke="black" points="19226.05,-833 19235.82,-828.89 19225.62,-826.01 19226.05,-833"/>
</g>
<!-- layer_3_expert_0_gate_proj -->
<g id="node284" class="node">
<title>layer_3_expert_0_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="7937,-745.74 7566,-745.74 7566,-677.74 7937,-677.74 7937,-745.74"/>
<text text-anchor="middle" x="7751.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 0 Gate Proj</text>
<text text-anchor="middle" x="7751.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="7751.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="7751.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_expert_0&#45;&gt;layer_3_expert_0_gate_proj -->
<g id="edge387" class="edge">
<title>layer_3_expert_0&#45;&gt;layer_3_expert_0_gate_proj</title>
<path fill="none" stroke="black" d="M8014.47,-781.69C7973.9,-771.05 7928.76,-759.22 7887.51,-748.4"/>
<polygon fill="black" stroke="black" points="7888.22,-744.97 7877.66,-745.82 7886.45,-751.74 7888.22,-744.97"/>
</g>
<!-- layer_3_expert_0_up_proj -->
<g id="node285" class="node">
<title>layer_3_expert_0_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8326,-745.74 7955,-745.74 7955,-677.74 8326,-677.74 8326,-745.74"/>
<text text-anchor="middle" x="8140.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 0 Up Proj</text>
<text text-anchor="middle" x="8140.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8140.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8140.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_expert_0&#45;&gt;layer_3_expert_0_up_proj -->
<g id="edge389" class="edge">
<title>layer_3_expert_0&#45;&gt;layer_3_expert_0_up_proj</title>
<path fill="none" stroke="black" d="M8140.5,-781.62C8140.5,-773.52 8140.5,-764.72 8140.5,-756.21"/>
<polygon fill="black" stroke="black" points="8144,-756.04 8140.5,-746.04 8137,-756.04 8144,-756.04"/>
</g>
<!-- layer_3_expert_0_activation -->
<g id="node286" class="node">
<title>layer_3_expert_0_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="8326,-641.74 7955,-641.74 7955,-573.74 8326,-573.74 8326,-641.74"/>
<text text-anchor="middle" x="8140.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 0 GELU Activation</text>
<text text-anchor="middle" x="8140.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8140.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8140.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_expert_0_gate_proj&#45;&gt;layer_3_expert_0_activation -->
<g id="edge388" class="edge">
<title>layer_3_expert_0_gate_proj&#45;&gt;layer_3_expert_0_activation</title>
<path fill="none" stroke="black" d="M7877.53,-677.69C7918.1,-667.05 7963.24,-655.22 8004.49,-644.4"/>
<polygon fill="black" stroke="black" points="8005.55,-647.74 8014.34,-641.82 8003.78,-640.97 8005.55,-647.74"/>
</g>
<!-- layer_3_expert_0_up_proj&#45;&gt;layer_3_expert_0_activation -->
<g id="edge390" class="edge">
<title>layer_3_expert_0_up_proj&#45;&gt;layer_3_expert_0_activation</title>
<path fill="none" stroke="black" d="M8140.5,-677.62C8140.5,-669.52 8140.5,-660.72 8140.5,-652.21"/>
<polygon fill="black" stroke="black" points="8144,-652.04 8140.5,-642.04 8137,-652.04 8144,-652.04"/>
</g>
<!-- layer_3_expert_0_down_proj -->
<g id="node287" class="node">
<title>layer_3_expert_0_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8333,-537.74 7962,-537.74 7962,-469.74 8333,-469.74 8333,-537.74"/>
<text text-anchor="middle" x="8147.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 0 Down Proj</text>
<text text-anchor="middle" x="8147.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8147.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8147.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_3_expert_0_activation&#45;&gt;layer_3_expert_0_down_proj -->
<g id="edge391" class="edge">
<title>layer_3_expert_0_activation&#45;&gt;layer_3_expert_0_down_proj</title>
<path fill="none" stroke="black" d="M8142.77,-573.62C8143.33,-565.52 8143.93,-556.72 8144.52,-548.21"/>
<polygon fill="black" stroke="black" points="8148.02,-548.26 8145.21,-538.04 8141.04,-547.78 8148.02,-548.26"/>
</g>
<!-- layer_3_expert_agg -->
<g id="node363" class="node">
<title>layer_3_expert_agg</title>
<polygon fill="lightyellow" stroke="black" points="14853.06,-433.74 14066.32,-433.74 13863.94,-297.74 14650.68,-297.74 14853.06,-433.74"/>
<text text-anchor="middle" x="14358.5" y="-384.54" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="14358.5" y="-369.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192] from all experts</text>
<text text-anchor="middle" x="14358.5" y="-354.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="14358.5" y="-339.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_expert_0_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge392" class="edge">
<title>layer_3_expert_0_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M8333.38,-498.67C9190.94,-479.89 12774.14,-401.43 13968.9,-375.27"/>
<polygon fill="black" stroke="black" points="13969.02,-378.77 13978.94,-375.05 13968.86,-371.77 13969.02,-378.77"/>
</g>
<!-- layer_3_expert_1_gate_proj -->
<g id="node289" class="node">
<title>layer_3_expert_1_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="8715,-745.74 8344,-745.74 8344,-677.74 8715,-677.74 8715,-745.74"/>
<text text-anchor="middle" x="8529.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 1 Gate Proj</text>
<text text-anchor="middle" x="8529.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8529.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8529.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_expert_1&#45;&gt;layer_3_expert_1_gate_proj -->
<g id="edge394" class="edge">
<title>layer_3_expert_1&#45;&gt;layer_3_expert_1_gate_proj</title>
<path fill="none" stroke="black" d="M8792.47,-781.69C8751.9,-771.05 8706.76,-759.22 8665.51,-748.4"/>
<polygon fill="black" stroke="black" points="8666.22,-744.97 8655.66,-745.82 8664.45,-751.74 8666.22,-744.97"/>
</g>
<!-- layer_3_expert_1_up_proj -->
<g id="node290" class="node">
<title>layer_3_expert_1_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9104,-745.74 8733,-745.74 8733,-677.74 9104,-677.74 9104,-745.74"/>
<text text-anchor="middle" x="8918.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 1 Up Proj</text>
<text text-anchor="middle" x="8918.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="8918.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8918.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_expert_1&#45;&gt;layer_3_expert_1_up_proj -->
<g id="edge396" class="edge">
<title>layer_3_expert_1&#45;&gt;layer_3_expert_1_up_proj</title>
<path fill="none" stroke="black" d="M8918.5,-781.62C8918.5,-773.52 8918.5,-764.72 8918.5,-756.21"/>
<polygon fill="black" stroke="black" points="8922,-756.04 8918.5,-746.04 8915,-756.04 8922,-756.04"/>
</g>
<!-- layer_3_expert_1_activation -->
<g id="node291" class="node">
<title>layer_3_expert_1_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="9104,-641.74 8733,-641.74 8733,-573.74 9104,-573.74 9104,-641.74"/>
<text text-anchor="middle" x="8918.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 1 GELU Activation</text>
<text text-anchor="middle" x="8918.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8918.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="8918.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_expert_1_gate_proj&#45;&gt;layer_3_expert_1_activation -->
<g id="edge395" class="edge">
<title>layer_3_expert_1_gate_proj&#45;&gt;layer_3_expert_1_activation</title>
<path fill="none" stroke="black" d="M8655.53,-677.69C8696.1,-667.05 8741.24,-655.22 8782.49,-644.4"/>
<polygon fill="black" stroke="black" points="8783.55,-647.74 8792.34,-641.82 8781.78,-640.97 8783.55,-647.74"/>
</g>
<!-- layer_3_expert_1_up_proj&#45;&gt;layer_3_expert_1_activation -->
<g id="edge397" class="edge">
<title>layer_3_expert_1_up_proj&#45;&gt;layer_3_expert_1_activation</title>
<path fill="none" stroke="black" d="M8918.5,-677.62C8918.5,-669.52 8918.5,-660.72 8918.5,-652.21"/>
<polygon fill="black" stroke="black" points="8922,-652.04 8918.5,-642.04 8915,-652.04 8922,-652.04"/>
</g>
<!-- layer_3_expert_1_down_proj -->
<g id="node292" class="node">
<title>layer_3_expert_1_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10278,-537.74 9907,-537.74 9907,-469.74 10278,-469.74 10278,-537.74"/>
<text text-anchor="middle" x="10092.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 1 Down Proj</text>
<text text-anchor="middle" x="10092.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10092.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10092.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_3_expert_1_activation&#45;&gt;layer_3_expert_1_down_proj -->
<g id="edge398" class="edge">
<title>layer_3_expert_1_activation&#45;&gt;layer_3_expert_1_down_proj</title>
<path fill="none" stroke="black" d="M9104.2,-590.61C9320.47,-571.82 9676.17,-540.91 9896.68,-521.75"/>
<polygon fill="black" stroke="black" points="9897.09,-525.23 9906.75,-520.88 9896.49,-518.26 9897.09,-525.23"/>
</g>
<!-- layer_3_expert_1_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge399" class="edge">
<title>layer_3_expert_1_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M10278.12,-496.3C10473.91,-489.54 10791.41,-478.67 11065.5,-469.74 12117.34,-435.45 13358.25,-397.25 13973.12,-378.47"/>
<polygon fill="black" stroke="black" points="13973.58,-381.95 13983.47,-378.15 13973.37,-374.96 13973.58,-381.95"/>
</g>
<!-- layer_3_expert_2_gate_proj -->
<g id="node294" class="node">
<title>layer_3_expert_2_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9493,-745.74 9122,-745.74 9122,-677.74 9493,-677.74 9493,-745.74"/>
<text text-anchor="middle" x="9307.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 2 Gate Proj</text>
<text text-anchor="middle" x="9307.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9307.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9307.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_expert_2&#45;&gt;layer_3_expert_2_gate_proj -->
<g id="edge401" class="edge">
<title>layer_3_expert_2&#45;&gt;layer_3_expert_2_gate_proj</title>
<path fill="none" stroke="black" d="M9570.47,-781.69C9529.9,-771.05 9484.76,-759.22 9443.51,-748.4"/>
<polygon fill="black" stroke="black" points="9444.22,-744.97 9433.66,-745.82 9442.45,-751.74 9444.22,-744.97"/>
</g>
<!-- layer_3_expert_2_up_proj -->
<g id="node295" class="node">
<title>layer_3_expert_2_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="9882,-745.74 9511,-745.74 9511,-677.74 9882,-677.74 9882,-745.74"/>
<text text-anchor="middle" x="9696.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 2 Up Proj</text>
<text text-anchor="middle" x="9696.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="9696.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9696.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_expert_2&#45;&gt;layer_3_expert_2_up_proj -->
<g id="edge403" class="edge">
<title>layer_3_expert_2&#45;&gt;layer_3_expert_2_up_proj</title>
<path fill="none" stroke="black" d="M9696.5,-781.62C9696.5,-773.52 9696.5,-764.72 9696.5,-756.21"/>
<polygon fill="black" stroke="black" points="9700,-756.04 9696.5,-746.04 9693,-756.04 9700,-756.04"/>
</g>
<!-- layer_3_expert_2_activation -->
<g id="node296" class="node">
<title>layer_3_expert_2_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="9882,-641.74 9511,-641.74 9511,-573.74 9882,-573.74 9882,-641.74"/>
<text text-anchor="middle" x="9696.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 2 GELU Activation</text>
<text text-anchor="middle" x="9696.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9696.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="9696.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_expert_2_gate_proj&#45;&gt;layer_3_expert_2_activation -->
<g id="edge402" class="edge">
<title>layer_3_expert_2_gate_proj&#45;&gt;layer_3_expert_2_activation</title>
<path fill="none" stroke="black" d="M9433.53,-677.69C9474.1,-667.05 9519.24,-655.22 9560.49,-644.4"/>
<polygon fill="black" stroke="black" points="9561.55,-647.74 9570.34,-641.82 9559.78,-640.97 9561.55,-647.74"/>
</g>
<!-- layer_3_expert_2_up_proj&#45;&gt;layer_3_expert_2_activation -->
<g id="edge404" class="edge">
<title>layer_3_expert_2_up_proj&#45;&gt;layer_3_expert_2_activation</title>
<path fill="none" stroke="black" d="M9696.5,-677.62C9696.5,-669.52 9696.5,-660.72 9696.5,-652.21"/>
<polygon fill="black" stroke="black" points="9700,-652.04 9696.5,-642.04 9693,-652.04 9700,-652.04"/>
</g>
<!-- layer_3_expert_2_down_proj -->
<g id="node297" class="node">
<title>layer_3_expert_2_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11445,-537.74 11074,-537.74 11074,-469.74 11445,-469.74 11445,-537.74"/>
<text text-anchor="middle" x="11259.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 2 Down Proj</text>
<text text-anchor="middle" x="11259.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11259.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11259.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_3_expert_2_activation&#45;&gt;layer_3_expert_2_down_proj -->
<g id="edge405" class="edge">
<title>layer_3_expert_2_activation&#45;&gt;layer_3_expert_2_down_proj</title>
<path fill="none" stroke="black" d="M9882.32,-594.61C10179.71,-575.21 10759.91,-537.34 11063.57,-517.53"/>
<polygon fill="black" stroke="black" points="11064.06,-521 11073.81,-516.86 11063.6,-514.02 11064.06,-521"/>
</g>
<!-- layer_3_expert_2_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge406" class="edge">
<title>layer_3_expert_2_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M11445.21,-491.51C11559.96,-484.75 11710.25,-476.23 11843.5,-469.74 12599.27,-432.91 13483.24,-398.78 13976.24,-380.55"/>
<polygon fill="black" stroke="black" points="13976.5,-384.04 13986.36,-380.18 13976.24,-377.05 13976.5,-384.04"/>
</g>
<!-- layer_3_expert_3_gate_proj -->
<g id="node299" class="node">
<title>layer_3_expert_3_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10271,-745.74 9900,-745.74 9900,-677.74 10271,-677.74 10271,-745.74"/>
<text text-anchor="middle" x="10085.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 3 Gate Proj</text>
<text text-anchor="middle" x="10085.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10085.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10085.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_expert_3&#45;&gt;layer_3_expert_3_gate_proj -->
<g id="edge408" class="edge">
<title>layer_3_expert_3&#45;&gt;layer_3_expert_3_gate_proj</title>
<path fill="none" stroke="black" d="M10348.47,-781.69C10307.9,-771.05 10262.76,-759.22 10221.51,-748.4"/>
<polygon fill="black" stroke="black" points="10222.22,-744.97 10211.66,-745.82 10220.45,-751.74 10222.22,-744.97"/>
</g>
<!-- layer_3_expert_3_up_proj -->
<g id="node300" class="node">
<title>layer_3_expert_3_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="10660,-745.74 10289,-745.74 10289,-677.74 10660,-677.74 10660,-745.74"/>
<text text-anchor="middle" x="10474.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 3 Up Proj</text>
<text text-anchor="middle" x="10474.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10474.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10474.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_expert_3&#45;&gt;layer_3_expert_3_up_proj -->
<g id="edge410" class="edge">
<title>layer_3_expert_3&#45;&gt;layer_3_expert_3_up_proj</title>
<path fill="none" stroke="black" d="M10474.5,-781.62C10474.5,-773.52 10474.5,-764.72 10474.5,-756.21"/>
<polygon fill="black" stroke="black" points="10478,-756.04 10474.5,-746.04 10471,-756.04 10478,-756.04"/>
</g>
<!-- layer_3_expert_3_activation -->
<g id="node301" class="node">
<title>layer_3_expert_3_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="10660,-641.74 10289,-641.74 10289,-573.74 10660,-573.74 10660,-641.74"/>
<text text-anchor="middle" x="10474.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 3 GELU Activation</text>
<text text-anchor="middle" x="10474.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10474.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10474.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_expert_3_gate_proj&#45;&gt;layer_3_expert_3_activation -->
<g id="edge409" class="edge">
<title>layer_3_expert_3_gate_proj&#45;&gt;layer_3_expert_3_activation</title>
<path fill="none" stroke="black" d="M10211.53,-677.69C10252.1,-667.05 10297.24,-655.22 10338.49,-644.4"/>
<polygon fill="black" stroke="black" points="10339.55,-647.74 10348.34,-641.82 10337.78,-640.97 10339.55,-647.74"/>
</g>
<!-- layer_3_expert_3_up_proj&#45;&gt;layer_3_expert_3_activation -->
<g id="edge411" class="edge">
<title>layer_3_expert_3_up_proj&#45;&gt;layer_3_expert_3_activation</title>
<path fill="none" stroke="black" d="M10474.5,-677.62C10474.5,-669.52 10474.5,-660.72 10474.5,-652.21"/>
<polygon fill="black" stroke="black" points="10478,-652.04 10474.5,-642.04 10471,-652.04 10478,-652.04"/>
</g>
<!-- layer_3_expert_3_down_proj -->
<g id="node302" class="node">
<title>layer_3_expert_3_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12223,-537.74 11852,-537.74 11852,-469.74 12223,-469.74 12223,-537.74"/>
<text text-anchor="middle" x="12037.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 3 Down Proj</text>
<text text-anchor="middle" x="12037.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12037.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12037.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_3_expert_3_activation&#45;&gt;layer_3_expert_3_down_proj -->
<g id="edge412" class="edge">
<title>layer_3_expert_3_activation&#45;&gt;layer_3_expert_3_down_proj</title>
<path fill="none" stroke="black" d="M10660.32,-594.61C10957.71,-575.21 11537.91,-537.34 11841.57,-517.53"/>
<polygon fill="black" stroke="black" points="11842.06,-521 11851.81,-516.86 11841.6,-514.02 11842.06,-521"/>
</g>
<!-- layer_3_expert_3_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge413" class="edge">
<title>layer_3_expert_3_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M12223.4,-485.77C12287.7,-480.22 12360.24,-474.32 12426.5,-469.74 12965.96,-432.49 13590.97,-401.36 13980.59,-383.38"/>
<polygon fill="black" stroke="black" points="13980.78,-386.87 13990.61,-382.92 13980.46,-379.88 13980.78,-386.87"/>
</g>
<!-- layer_3_expert_4_gate_proj -->
<g id="node304" class="node">
<title>layer_3_expert_4_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11049,-745.74 10678,-745.74 10678,-677.74 11049,-677.74 11049,-745.74"/>
<text text-anchor="middle" x="10863.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 4 Gate Proj</text>
<text text-anchor="middle" x="10863.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="10863.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="10863.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_expert_4&#45;&gt;layer_3_expert_4_gate_proj -->
<g id="edge415" class="edge">
<title>layer_3_expert_4&#45;&gt;layer_3_expert_4_gate_proj</title>
<path fill="none" stroke="black" d="M11126.47,-781.69C11085.9,-771.05 11040.76,-759.22 10999.51,-748.4"/>
<polygon fill="black" stroke="black" points="11000.22,-744.97 10989.66,-745.82 10998.45,-751.74 11000.22,-744.97"/>
</g>
<!-- layer_3_expert_4_up_proj -->
<g id="node305" class="node">
<title>layer_3_expert_4_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11438,-745.74 11067,-745.74 11067,-677.74 11438,-677.74 11438,-745.74"/>
<text text-anchor="middle" x="11252.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 4 Up Proj</text>
<text text-anchor="middle" x="11252.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11252.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11252.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_expert_4&#45;&gt;layer_3_expert_4_up_proj -->
<g id="edge417" class="edge">
<title>layer_3_expert_4&#45;&gt;layer_3_expert_4_up_proj</title>
<path fill="none" stroke="black" d="M11252.5,-781.62C11252.5,-773.52 11252.5,-764.72 11252.5,-756.21"/>
<polygon fill="black" stroke="black" points="11256,-756.04 11252.5,-746.04 11249,-756.04 11256,-756.04"/>
</g>
<!-- layer_3_expert_4_activation -->
<g id="node306" class="node">
<title>layer_3_expert_4_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="11438,-641.74 11067,-641.74 11067,-573.74 11438,-573.74 11438,-641.74"/>
<text text-anchor="middle" x="11252.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 4 GELU Activation</text>
<text text-anchor="middle" x="11252.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11252.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11252.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_expert_4_gate_proj&#45;&gt;layer_3_expert_4_activation -->
<g id="edge416" class="edge">
<title>layer_3_expert_4_gate_proj&#45;&gt;layer_3_expert_4_activation</title>
<path fill="none" stroke="black" d="M10989.53,-677.69C11030.1,-667.05 11075.24,-655.22 11116.49,-644.4"/>
<polygon fill="black" stroke="black" points="11117.55,-647.74 11126.34,-641.82 11115.78,-640.97 11117.55,-647.74"/>
</g>
<!-- layer_3_expert_4_up_proj&#45;&gt;layer_3_expert_4_activation -->
<g id="edge418" class="edge">
<title>layer_3_expert_4_up_proj&#45;&gt;layer_3_expert_4_activation</title>
<path fill="none" stroke="black" d="M11252.5,-677.62C11252.5,-669.52 11252.5,-660.72 11252.5,-652.21"/>
<polygon fill="black" stroke="black" points="11256,-652.04 11252.5,-642.04 11249,-652.04 11256,-652.04"/>
</g>
<!-- layer_3_expert_4_down_proj -->
<g id="node307" class="node">
<title>layer_3_expert_4_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12806,-537.74 12435,-537.74 12435,-469.74 12806,-469.74 12806,-537.74"/>
<text text-anchor="middle" x="12620.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 4 Down Proj</text>
<text text-anchor="middle" x="12620.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12620.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12620.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_3_expert_4_activation&#45;&gt;layer_3_expert_4_down_proj -->
<g id="edge419" class="edge">
<title>layer_3_expert_4_activation&#45;&gt;layer_3_expert_4_down_proj</title>
<path fill="none" stroke="black" d="M11438.15,-594.48C11635.29,-581.26 11955.96,-559.23 12232.5,-537.74 12294.91,-532.89 12362.93,-527.23 12424.34,-521.98"/>
<polygon fill="black" stroke="black" points="12424.87,-525.45 12434.54,-521.11 12424.28,-518.48 12424.87,-525.45"/>
</g>
<!-- layer_3_expert_4_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge420" class="edge">
<title>layer_3_expert_4_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M12806.14,-480.59C12841.43,-476.71 12878.08,-472.91 12912.5,-469.74 13277.67,-436.11 13695.6,-407.4 13987.93,-388.9"/>
<polygon fill="black" stroke="black" points="13988.51,-392.37 13998.27,-388.24 13988.07,-385.38 13988.51,-392.37"/>
</g>
<!-- layer_3_expert_5_gate_proj -->
<g id="node309" class="node">
<title>layer_3_expert_5_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="11827,-745.74 11456,-745.74 11456,-677.74 11827,-677.74 11827,-745.74"/>
<text text-anchor="middle" x="11641.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 5 Gate Proj</text>
<text text-anchor="middle" x="11641.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="11641.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="11641.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_expert_5&#45;&gt;layer_3_expert_5_gate_proj -->
<g id="edge422" class="edge">
<title>layer_3_expert_5&#45;&gt;layer_3_expert_5_gate_proj</title>
<path fill="none" stroke="black" d="M11904.47,-781.69C11863.9,-771.05 11818.76,-759.22 11777.51,-748.4"/>
<polygon fill="black" stroke="black" points="11778.22,-744.97 11767.66,-745.82 11776.45,-751.74 11778.22,-744.97"/>
</g>
<!-- layer_3_expert_5_up_proj -->
<g id="node310" class="node">
<title>layer_3_expert_5_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12216,-745.74 11845,-745.74 11845,-677.74 12216,-677.74 12216,-745.74"/>
<text text-anchor="middle" x="12030.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 5 Up Proj</text>
<text text-anchor="middle" x="12030.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12030.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12030.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_expert_5&#45;&gt;layer_3_expert_5_up_proj -->
<g id="edge424" class="edge">
<title>layer_3_expert_5&#45;&gt;layer_3_expert_5_up_proj</title>
<path fill="none" stroke="black" d="M12030.5,-781.62C12030.5,-773.52 12030.5,-764.72 12030.5,-756.21"/>
<polygon fill="black" stroke="black" points="12034,-756.04 12030.5,-746.04 12027,-756.04 12034,-756.04"/>
</g>
<!-- layer_3_expert_5_activation -->
<g id="node311" class="node">
<title>layer_3_expert_5_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="12216,-641.74 11845,-641.74 11845,-573.74 12216,-573.74 12216,-641.74"/>
<text text-anchor="middle" x="12030.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 5 GELU Activation</text>
<text text-anchor="middle" x="12030.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12030.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12030.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_expert_5_gate_proj&#45;&gt;layer_3_expert_5_activation -->
<g id="edge423" class="edge">
<title>layer_3_expert_5_gate_proj&#45;&gt;layer_3_expert_5_activation</title>
<path fill="none" stroke="black" d="M11767.53,-677.69C11808.1,-667.05 11853.24,-655.22 11894.49,-644.4"/>
<polygon fill="black" stroke="black" points="11895.55,-647.74 11904.34,-641.82 11893.78,-640.97 11895.55,-647.74"/>
</g>
<!-- layer_3_expert_5_up_proj&#45;&gt;layer_3_expert_5_activation -->
<g id="edge425" class="edge">
<title>layer_3_expert_5_up_proj&#45;&gt;layer_3_expert_5_activation</title>
<path fill="none" stroke="black" d="M12030.5,-677.62C12030.5,-669.52 12030.5,-660.72 12030.5,-652.21"/>
<polygon fill="black" stroke="black" points="12034,-652.04 12030.5,-642.04 12027,-652.04 12034,-652.04"/>
</g>
<!-- layer_3_expert_5_down_proj -->
<g id="node312" class="node">
<title>layer_3_expert_5_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13292,-537.74 12921,-537.74 12921,-469.74 13292,-469.74 13292,-537.74"/>
<text text-anchor="middle" x="13106.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 5 Down Proj</text>
<text text-anchor="middle" x="13106.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13106.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13106.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_3_expert_5_activation&#45;&gt;layer_3_expert_5_down_proj -->
<g id="edge426" class="edge">
<title>layer_3_expert_5_activation&#45;&gt;layer_3_expert_5_down_proj</title>
<path fill="none" stroke="black" d="M12216.2,-591.75C12375.34,-578.58 12610.64,-558.36 12815.5,-537.74 12846.2,-534.65 12878.69,-531.17 12910.41,-527.66"/>
<polygon fill="black" stroke="black" points="12911.13,-531.1 12920.68,-526.52 12910.35,-524.15 12911.13,-531.1"/>
</g>
<!-- layer_3_expert_5_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge427" class="edge">
<title>layer_3_expert_5_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M13292.26,-476.98C13311.91,-474.44 13331.61,-471.98 13350.5,-469.74 13567.49,-443.99 13811.22,-418.98 14004.66,-400.05"/>
<polygon fill="black" stroke="black" points="14005.09,-403.52 14014.7,-399.07 14004.41,-396.56 14005.09,-403.52"/>
</g>
<!-- layer_3_expert_6_gate_proj -->
<g id="node314" class="node">
<title>layer_3_expert_6_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12605,-745.74 12234,-745.74 12234,-677.74 12605,-677.74 12605,-745.74"/>
<text text-anchor="middle" x="12419.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 6 Gate Proj</text>
<text text-anchor="middle" x="12419.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12419.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12419.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_expert_6&#45;&gt;layer_3_expert_6_gate_proj -->
<g id="edge429" class="edge">
<title>layer_3_expert_6&#45;&gt;layer_3_expert_6_gate_proj</title>
<path fill="none" stroke="black" d="M12682.47,-781.69C12641.9,-771.05 12596.76,-759.22 12555.51,-748.4"/>
<polygon fill="black" stroke="black" points="12556.22,-744.97 12545.66,-745.82 12554.45,-751.74 12556.22,-744.97"/>
</g>
<!-- layer_3_expert_6_up_proj -->
<g id="node315" class="node">
<title>layer_3_expert_6_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="12994,-745.74 12623,-745.74 12623,-677.74 12994,-677.74 12994,-745.74"/>
<text text-anchor="middle" x="12808.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 6 Up Proj</text>
<text text-anchor="middle" x="12808.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="12808.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12808.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_expert_6&#45;&gt;layer_3_expert_6_up_proj -->
<g id="edge431" class="edge">
<title>layer_3_expert_6&#45;&gt;layer_3_expert_6_up_proj</title>
<path fill="none" stroke="black" d="M12808.5,-781.62C12808.5,-773.52 12808.5,-764.72 12808.5,-756.21"/>
<polygon fill="black" stroke="black" points="12812,-756.04 12808.5,-746.04 12805,-756.04 12812,-756.04"/>
</g>
<!-- layer_3_expert_6_activation -->
<g id="node316" class="node">
<title>layer_3_expert_6_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="12994,-641.74 12623,-641.74 12623,-573.74 12994,-573.74 12994,-641.74"/>
<text text-anchor="middle" x="12808.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 6 GELU Activation</text>
<text text-anchor="middle" x="12808.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12808.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="12808.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_expert_6_gate_proj&#45;&gt;layer_3_expert_6_activation -->
<g id="edge430" class="edge">
<title>layer_3_expert_6_gate_proj&#45;&gt;layer_3_expert_6_activation</title>
<path fill="none" stroke="black" d="M12545.53,-677.69C12586.1,-667.05 12631.24,-655.22 12672.49,-644.4"/>
<polygon fill="black" stroke="black" points="12673.55,-647.74 12682.34,-641.82 12671.78,-640.97 12673.55,-647.74"/>
</g>
<!-- layer_3_expert_6_up_proj&#45;&gt;layer_3_expert_6_activation -->
<g id="edge432" class="edge">
<title>layer_3_expert_6_up_proj&#45;&gt;layer_3_expert_6_activation</title>
<path fill="none" stroke="black" d="M12808.5,-677.62C12808.5,-669.52 12808.5,-660.72 12808.5,-652.21"/>
<polygon fill="black" stroke="black" points="12812,-652.04 12808.5,-642.04 12805,-652.04 12812,-652.04"/>
</g>
<!-- layer_3_expert_6_down_proj -->
<g id="node317" class="node">
<title>layer_3_expert_6_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13730,-537.74 13359,-537.74 13359,-469.74 13730,-469.74 13730,-537.74"/>
<text text-anchor="middle" x="13544.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 6 Down Proj</text>
<text text-anchor="middle" x="13544.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13544.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13544.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_3_expert_6_activation&#45;&gt;layer_3_expert_6_down_proj -->
<g id="edge433" class="edge">
<title>layer_3_expert_6_activation&#45;&gt;layer_3_expert_6_down_proj</title>
<path fill="none" stroke="black" d="M12994.22,-581C13102.42,-566.01 13238.74,-547.12 13348.62,-531.89"/>
<polygon fill="black" stroke="black" points="13349.41,-535.31 13358.84,-530.47 13348.45,-528.38 13349.41,-535.31"/>
</g>
<!-- layer_3_expert_6_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge434" class="edge">
<title>layer_3_expert_6_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M13730.23,-471.71C13820.23,-456.67 13930.98,-438.17 14034.29,-420.91"/>
<polygon fill="black" stroke="black" points="14034.98,-424.34 14044.26,-419.24 14033.82,-417.44 14034.98,-424.34"/>
</g>
<!-- layer_3_expert_7_gate_proj -->
<g id="node319" class="node">
<title>layer_3_expert_7_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13383,-745.74 13012,-745.74 13012,-677.74 13383,-677.74 13383,-745.74"/>
<text text-anchor="middle" x="13197.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 7 Gate Proj</text>
<text text-anchor="middle" x="13197.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13197.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13197.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_expert_7&#45;&gt;layer_3_expert_7_gate_proj -->
<g id="edge436" class="edge">
<title>layer_3_expert_7&#45;&gt;layer_3_expert_7_gate_proj</title>
<path fill="none" stroke="black" d="M13460.47,-781.69C13419.9,-771.05 13374.76,-759.22 13333.51,-748.4"/>
<polygon fill="black" stroke="black" points="13334.22,-744.97 13323.66,-745.82 13332.45,-751.74 13334.22,-744.97"/>
</g>
<!-- layer_3_expert_7_up_proj -->
<g id="node320" class="node">
<title>layer_3_expert_7_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="13772,-745.74 13401,-745.74 13401,-677.74 13772,-677.74 13772,-745.74"/>
<text text-anchor="middle" x="13586.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 7 Up Proj</text>
<text text-anchor="middle" x="13586.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13586.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13586.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_expert_7&#45;&gt;layer_3_expert_7_up_proj -->
<g id="edge438" class="edge">
<title>layer_3_expert_7&#45;&gt;layer_3_expert_7_up_proj</title>
<path fill="none" stroke="black" d="M13586.5,-781.62C13586.5,-773.52 13586.5,-764.72 13586.5,-756.21"/>
<polygon fill="black" stroke="black" points="13590,-756.04 13586.5,-746.04 13583,-756.04 13590,-756.04"/>
</g>
<!-- layer_3_expert_7_activation -->
<g id="node321" class="node">
<title>layer_3_expert_7_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="13772,-641.74 13401,-641.74 13401,-573.74 13772,-573.74 13772,-641.74"/>
<text text-anchor="middle" x="13586.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 7 GELU Activation</text>
<text text-anchor="middle" x="13586.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13586.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13586.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_expert_7_gate_proj&#45;&gt;layer_3_expert_7_activation -->
<g id="edge437" class="edge">
<title>layer_3_expert_7_gate_proj&#45;&gt;layer_3_expert_7_activation</title>
<path fill="none" stroke="black" d="M13323.53,-677.69C13364.1,-667.05 13409.24,-655.22 13450.49,-644.4"/>
<polygon fill="black" stroke="black" points="13451.55,-647.74 13460.34,-641.82 13449.78,-640.97 13451.55,-647.74"/>
</g>
<!-- layer_3_expert_7_up_proj&#45;&gt;layer_3_expert_7_activation -->
<g id="edge439" class="edge">
<title>layer_3_expert_7_up_proj&#45;&gt;layer_3_expert_7_activation</title>
<path fill="none" stroke="black" d="M13586.5,-677.62C13586.5,-669.52 13586.5,-660.72 13586.5,-652.21"/>
<polygon fill="black" stroke="black" points="13590,-652.04 13586.5,-642.04 13583,-652.04 13590,-652.04"/>
</g>
<!-- layer_3_expert_7_down_proj -->
<g id="node322" class="node">
<title>layer_3_expert_7_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14143,-537.74 13772,-537.74 13772,-469.74 14143,-469.74 14143,-537.74"/>
<text text-anchor="middle" x="13957.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 7 Down Proj</text>
<text text-anchor="middle" x="13957.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13957.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13957.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_3_expert_7_activation&#45;&gt;layer_3_expert_7_down_proj -->
<g id="edge440" class="edge">
<title>layer_3_expert_7_activation&#45;&gt;layer_3_expert_7_down_proj</title>
<path fill="none" stroke="black" d="M13706.7,-573.69C13745.23,-563.1 13788.07,-551.32 13827.29,-540.54"/>
<polygon fill="black" stroke="black" points="13828.46,-543.85 13837.18,-537.82 13826.61,-537.1 13828.46,-543.85"/>
</g>
<!-- layer_3_expert_7_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge441" class="edge">
<title>layer_3_expert_7_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M14054.83,-469.73C14084.17,-459.78 14117.57,-448.45 14151.23,-437.04"/>
<polygon fill="black" stroke="black" points="14152.38,-440.34 14160.72,-433.82 14150.13,-433.71 14152.38,-440.34"/>
</g>
<!-- layer_3_expert_8_gate_proj -->
<g id="node324" class="node">
<title>layer_3_expert_8_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14161,-745.74 13790,-745.74 13790,-677.74 14161,-677.74 14161,-745.74"/>
<text text-anchor="middle" x="13975.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 8 Gate Proj</text>
<text text-anchor="middle" x="13975.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="13975.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="13975.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_expert_8&#45;&gt;layer_3_expert_8_gate_proj -->
<g id="edge443" class="edge">
<title>layer_3_expert_8&#45;&gt;layer_3_expert_8_gate_proj</title>
<path fill="none" stroke="black" d="M14107.19,-781.62C14088.28,-771.73 14067.4,-760.81 14047.95,-750.64"/>
<polygon fill="black" stroke="black" points="14049.31,-747.4 14038.83,-745.86 14046.07,-753.6 14049.31,-747.4"/>
</g>
<!-- layer_3_expert_8_up_proj -->
<g id="node325" class="node">
<title>layer_3_expert_8_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14550,-745.74 14179,-745.74 14179,-677.74 14550,-677.74 14550,-745.74"/>
<text text-anchor="middle" x="14364.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 8 Up Proj</text>
<text text-anchor="middle" x="14364.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14364.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14364.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_expert_8&#45;&gt;layer_3_expert_8_up_proj -->
<g id="edge445" class="edge">
<title>layer_3_expert_8&#45;&gt;layer_3_expert_8_up_proj</title>
<path fill="none" stroke="black" d="M14233.49,-781.62C14252.3,-771.73 14273.07,-760.81 14292.42,-750.64"/>
<polygon fill="black" stroke="black" points="14294.28,-753.62 14301.5,-745.86 14291.02,-747.42 14294.28,-753.62"/>
</g>
<!-- layer_3_expert_8_activation -->
<g id="node326" class="node">
<title>layer_3_expert_8_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="14544,-641.74 14173,-641.74 14173,-573.74 14544,-573.74 14544,-641.74"/>
<text text-anchor="middle" x="14358.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 8 GELU Activation</text>
<text text-anchor="middle" x="14358.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14358.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14358.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_expert_8_gate_proj&#45;&gt;layer_3_expert_8_activation -->
<g id="edge444" class="edge">
<title>layer_3_expert_8_gate_proj&#45;&gt;layer_3_expert_8_activation</title>
<path fill="none" stroke="black" d="M14099.58,-677.69C14139.53,-667.05 14183.97,-655.22 14224.59,-644.4"/>
<polygon fill="black" stroke="black" points="14225.52,-647.78 14234.28,-641.82 14223.72,-641.01 14225.52,-647.78"/>
</g>
<!-- layer_3_expert_8_up_proj&#45;&gt;layer_3_expert_8_activation -->
<g id="edge446" class="edge">
<title>layer_3_expert_8_up_proj&#45;&gt;layer_3_expert_8_activation</title>
<path fill="none" stroke="black" d="M14362.55,-677.62C14362.08,-669.52 14361.56,-660.72 14361.06,-652.21"/>
<polygon fill="black" stroke="black" points="14364.54,-651.82 14360.46,-642.04 14357.55,-652.23 14364.54,-651.82"/>
</g>
<!-- layer_3_expert_8_down_proj -->
<g id="node327" class="node">
<title>layer_3_expert_8_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14544,-537.74 14173,-537.74 14173,-469.74 14544,-469.74 14544,-537.74"/>
<text text-anchor="middle" x="14358.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 8 Down Proj</text>
<text text-anchor="middle" x="14358.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14358.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14358.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- layer_3_expert_8_activation&#45;&gt;layer_3_expert_8_down_proj -->
<g id="edge447" class="edge">
<title>layer_3_expert_8_activation&#45;&gt;layer_3_expert_8_down_proj</title>
<path fill="none" stroke="black" d="M14358.5,-573.62C14358.5,-565.52 14358.5,-556.72 14358.5,-548.21"/>
<polygon fill="black" stroke="black" points="14362,-548.04 14358.5,-538.04 14355,-548.04 14362,-548.04"/>
</g>
<!-- layer_3_expert_8_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge448" class="edge">
<title>layer_3_expert_8_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M14358.5,-469.47C14358.5,-461.64 14358.5,-452.98 14358.5,-444.09"/>
<polygon fill="black" stroke="black" points="14362,-444 14358.5,-434 14355,-444 14362,-444"/>
</g>
<!-- layer_3_expert_9_gate_proj -->
<g id="node329" class="node">
<title>layer_3_expert_9_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14939,-745.74 14568,-745.74 14568,-677.74 14939,-677.74 14939,-745.74"/>
<text text-anchor="middle" x="14753.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 9 Gate Proj</text>
<text text-anchor="middle" x="14753.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14753.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14753.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_expert_9&#45;&gt;layer_3_expert_9_gate_proj -->
<g id="edge450" class="edge">
<title>layer_3_expert_9&#45;&gt;layer_3_expert_9_gate_proj</title>
<path fill="none" stroke="black" d="M14753.5,-781.62C14753.5,-773.52 14753.5,-764.72 14753.5,-756.21"/>
<polygon fill="black" stroke="black" points="14757,-756.04 14753.5,-746.04 14750,-756.04 14757,-756.04"/>
</g>
<!-- layer_3_expert_9_up_proj -->
<g id="node330" class="node">
<title>layer_3_expert_9_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="15328,-745.74 14957,-745.74 14957,-677.74 15328,-677.74 15328,-745.74"/>
<text text-anchor="middle" x="15142.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 9 Up Proj</text>
<text text-anchor="middle" x="15142.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15142.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15142.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_expert_9&#45;&gt;layer_3_expert_9_up_proj -->
<g id="edge452" class="edge">
<title>layer_3_expert_9&#45;&gt;layer_3_expert_9_up_proj</title>
<path fill="none" stroke="black" d="M14879.53,-781.69C14920.1,-771.05 14965.24,-759.22 15006.49,-748.4"/>
<polygon fill="black" stroke="black" points="15007.55,-751.74 15016.34,-745.82 15005.78,-744.97 15007.55,-751.74"/>
</g>
<!-- layer_3_expert_9_activation -->
<g id="node331" class="node">
<title>layer_3_expert_9_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="14939,-641.74 14568,-641.74 14568,-573.74 14939,-573.74 14939,-641.74"/>
<text text-anchor="middle" x="14753.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 9 GELU Activation</text>
<text text-anchor="middle" x="14753.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14753.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14753.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_expert_9_gate_proj&#45;&gt;layer_3_expert_9_activation -->
<g id="edge451" class="edge">
<title>layer_3_expert_9_gate_proj&#45;&gt;layer_3_expert_9_activation</title>
<path fill="none" stroke="black" d="M14753.5,-677.62C14753.5,-669.52 14753.5,-660.72 14753.5,-652.21"/>
<polygon fill="black" stroke="black" points="14757,-652.04 14753.5,-642.04 14750,-652.04 14757,-652.04"/>
</g>
<!-- layer_3_expert_9_up_proj&#45;&gt;layer_3_expert_9_activation -->
<g id="edge453" class="edge">
<title>layer_3_expert_9_up_proj&#45;&gt;layer_3_expert_9_activation</title>
<path fill="none" stroke="black" d="M15016.47,-677.69C14975.9,-667.05 14930.76,-655.22 14889.51,-644.4"/>
<polygon fill="black" stroke="black" points="14890.22,-640.97 14879.66,-641.82 14888.45,-647.74 14890.22,-640.97"/>
</g>
<!-- layer_3_expert_9_down_proj -->
<g id="node332" class="node">
<title>layer_3_expert_9_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="14936,-537.74 14565,-537.74 14565,-469.74 14936,-469.74 14936,-537.74"/>
<text text-anchor="middle" x="14750.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 9 Down Proj</text>
<text text-anchor="middle" x="14750.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="14750.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="14750.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- layer_3_expert_9_activation&#45;&gt;layer_3_expert_9_down_proj -->
<g id="edge454" class="edge">
<title>layer_3_expert_9_activation&#45;&gt;layer_3_expert_9_down_proj</title>
<path fill="none" stroke="black" d="M14752.53,-573.62C14752.29,-565.52 14752.03,-556.72 14751.78,-548.21"/>
<polygon fill="black" stroke="black" points="14755.27,-547.93 14751.48,-538.04 14748.27,-548.14 14755.27,-547.93"/>
</g>
<!-- layer_3_expert_9_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge455" class="edge">
<title>layer_3_expert_9_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M14655.36,-469.73C14626.79,-459.82 14594.3,-448.55 14561.54,-437.18"/>
<polygon fill="black" stroke="black" points="14562.43,-433.79 14551.84,-433.82 14560.14,-440.4 14562.43,-433.79"/>
</g>
<!-- layer_3_expert_10_gate_proj -->
<g id="node334" class="node">
<title>layer_3_expert_10_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="15717,-745.74 15346,-745.74 15346,-677.74 15717,-677.74 15717,-745.74"/>
<text text-anchor="middle" x="15531.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 10 Gate Proj</text>
<text text-anchor="middle" x="15531.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15531.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15531.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_expert_10&#45;&gt;layer_3_expert_10_gate_proj -->
<g id="edge457" class="edge">
<title>layer_3_expert_10&#45;&gt;layer_3_expert_10_gate_proj</title>
<path fill="none" stroke="black" d="M15531.5,-781.62C15531.5,-773.52 15531.5,-764.72 15531.5,-756.21"/>
<polygon fill="black" stroke="black" points="15535,-756.04 15531.5,-746.04 15528,-756.04 15535,-756.04"/>
</g>
<!-- layer_3_expert_10_up_proj -->
<g id="node335" class="node">
<title>layer_3_expert_10_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="16106,-745.74 15735,-745.74 15735,-677.74 16106,-677.74 16106,-745.74"/>
<text text-anchor="middle" x="15920.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 10 Up Proj</text>
<text text-anchor="middle" x="15920.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15920.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15920.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_expert_10&#45;&gt;layer_3_expert_10_up_proj -->
<g id="edge459" class="edge">
<title>layer_3_expert_10&#45;&gt;layer_3_expert_10_up_proj</title>
<path fill="none" stroke="black" d="M15657.53,-781.69C15698.1,-771.05 15743.24,-759.22 15784.49,-748.4"/>
<polygon fill="black" stroke="black" points="15785.55,-751.74 15794.34,-745.82 15783.78,-744.97 15785.55,-751.74"/>
</g>
<!-- layer_3_expert_10_activation -->
<g id="node336" class="node">
<title>layer_3_expert_10_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="15717,-641.74 15346,-641.74 15346,-573.74 15717,-573.74 15717,-641.74"/>
<text text-anchor="middle" x="15531.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 10 GELU Activation</text>
<text text-anchor="middle" x="15531.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15531.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15531.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_expert_10_gate_proj&#45;&gt;layer_3_expert_10_activation -->
<g id="edge458" class="edge">
<title>layer_3_expert_10_gate_proj&#45;&gt;layer_3_expert_10_activation</title>
<path fill="none" stroke="black" d="M15531.5,-677.62C15531.5,-669.52 15531.5,-660.72 15531.5,-652.21"/>
<polygon fill="black" stroke="black" points="15535,-652.04 15531.5,-642.04 15528,-652.04 15535,-652.04"/>
</g>
<!-- layer_3_expert_10_up_proj&#45;&gt;layer_3_expert_10_activation -->
<g id="edge460" class="edge">
<title>layer_3_expert_10_up_proj&#45;&gt;layer_3_expert_10_activation</title>
<path fill="none" stroke="black" d="M15794.47,-677.69C15753.9,-667.05 15708.76,-655.22 15667.51,-644.4"/>
<polygon fill="black" stroke="black" points="15668.22,-640.97 15657.66,-641.82 15666.45,-647.74 15668.22,-640.97"/>
</g>
<!-- layer_3_expert_10_down_proj -->
<g id="node337" class="node">
<title>layer_3_expert_10_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="15521,-537.74 15150,-537.74 15150,-469.74 15521,-469.74 15521,-537.74"/>
<text text-anchor="middle" x="15335.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 10 Down Proj</text>
<text text-anchor="middle" x="15335.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="15335.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="15335.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- layer_3_expert_10_activation&#45;&gt;layer_3_expert_10_down_proj -->
<g id="edge461" class="edge">
<title>layer_3_expert_10_activation&#45;&gt;layer_3_expert_10_down_proj</title>
<path fill="none" stroke="black" d="M15467.86,-573.62C15448.77,-563.69 15427.68,-552.71 15408.05,-542.5"/>
<polygon fill="black" stroke="black" points="15409.64,-539.38 15399.15,-537.86 15406.41,-545.59 15409.64,-539.38"/>
</g>
<!-- layer_3_expert_10_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge462" class="edge">
<title>layer_3_expert_10_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M15149.72,-476.88C15063.64,-464.9 14956.85,-450.03 14849.87,-435.14"/>
<polygon fill="black" stroke="black" points="14850.24,-431.66 14839.85,-433.75 14849.28,-438.59 14850.24,-431.66"/>
</g>
<!-- layer_3_expert_11_gate_proj -->
<g id="node339" class="node">
<title>layer_3_expert_11_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="16495,-745.74 16124,-745.74 16124,-677.74 16495,-677.74 16495,-745.74"/>
<text text-anchor="middle" x="16309.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 11 Gate Proj</text>
<text text-anchor="middle" x="16309.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16309.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16309.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_expert_11&#45;&gt;layer_3_expert_11_gate_proj -->
<g id="edge464" class="edge">
<title>layer_3_expert_11&#45;&gt;layer_3_expert_11_gate_proj</title>
<path fill="none" stroke="black" d="M16309.5,-781.62C16309.5,-773.52 16309.5,-764.72 16309.5,-756.21"/>
<polygon fill="black" stroke="black" points="16313,-756.04 16309.5,-746.04 16306,-756.04 16313,-756.04"/>
</g>
<!-- layer_3_expert_11_up_proj -->
<g id="node340" class="node">
<title>layer_3_expert_11_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="16884,-745.74 16513,-745.74 16513,-677.74 16884,-677.74 16884,-745.74"/>
<text text-anchor="middle" x="16698.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 11 Up Proj</text>
<text text-anchor="middle" x="16698.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16698.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16698.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_expert_11&#45;&gt;layer_3_expert_11_up_proj -->
<g id="edge466" class="edge">
<title>layer_3_expert_11&#45;&gt;layer_3_expert_11_up_proj</title>
<path fill="none" stroke="black" d="M16435.53,-781.69C16476.1,-771.05 16521.24,-759.22 16562.49,-748.4"/>
<polygon fill="black" stroke="black" points="16563.55,-751.74 16572.34,-745.82 16561.78,-744.97 16563.55,-751.74"/>
</g>
<!-- layer_3_expert_11_activation -->
<g id="node341" class="node">
<title>layer_3_expert_11_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="16495,-641.74 16124,-641.74 16124,-573.74 16495,-573.74 16495,-641.74"/>
<text text-anchor="middle" x="16309.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 11 GELU Activation</text>
<text text-anchor="middle" x="16309.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16309.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16309.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_expert_11_gate_proj&#45;&gt;layer_3_expert_11_activation -->
<g id="edge465" class="edge">
<title>layer_3_expert_11_gate_proj&#45;&gt;layer_3_expert_11_activation</title>
<path fill="none" stroke="black" d="M16309.5,-677.62C16309.5,-669.52 16309.5,-660.72 16309.5,-652.21"/>
<polygon fill="black" stroke="black" points="16313,-652.04 16309.5,-642.04 16306,-652.04 16313,-652.04"/>
</g>
<!-- layer_3_expert_11_up_proj&#45;&gt;layer_3_expert_11_activation -->
<g id="edge467" class="edge">
<title>layer_3_expert_11_up_proj&#45;&gt;layer_3_expert_11_activation</title>
<path fill="none" stroke="black" d="M16572.47,-677.69C16531.9,-667.05 16486.76,-655.22 16445.51,-644.4"/>
<polygon fill="black" stroke="black" points="16446.22,-640.97 16435.66,-641.82 16444.45,-647.74 16446.22,-640.97"/>
</g>
<!-- layer_3_expert_11_down_proj -->
<g id="node342" class="node">
<title>layer_3_expert_11_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="16203,-537.74 15832,-537.74 15832,-469.74 16203,-469.74 16203,-537.74"/>
<text text-anchor="middle" x="16017.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 11 Down Proj</text>
<text text-anchor="middle" x="16017.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16017.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16017.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- layer_3_expert_11_activation&#45;&gt;layer_3_expert_11_down_proj -->
<g id="edge468" class="edge">
<title>layer_3_expert_11_activation&#45;&gt;layer_3_expert_11_down_proj</title>
<path fill="none" stroke="black" d="M16214.7,-573.62C16185.09,-563.28 16152.28,-551.82 16122.04,-541.26"/>
<polygon fill="black" stroke="black" points="16122.92,-537.86 16112.33,-537.86 16120.61,-544.47 16122.92,-537.86"/>
</g>
<!-- layer_3_expert_11_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge469" class="edge">
<title>layer_3_expert_11_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M15831.62,-487.5C15588.27,-467.55 15153.4,-431.9 14819.01,-404.49"/>
<polygon fill="black" stroke="black" points="14818.9,-400.97 14808.64,-403.64 14818.33,-407.95 14818.9,-400.97"/>
</g>
<!-- layer_3_expert_12_gate_proj -->
<g id="node344" class="node">
<title>layer_3_expert_12_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="17273,-745.74 16902,-745.74 16902,-677.74 17273,-677.74 17273,-745.74"/>
<text text-anchor="middle" x="17087.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 12 Gate Proj</text>
<text text-anchor="middle" x="17087.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="17087.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="17087.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_expert_12&#45;&gt;layer_3_expert_12_gate_proj -->
<g id="edge471" class="edge">
<title>layer_3_expert_12&#45;&gt;layer_3_expert_12_gate_proj</title>
<path fill="none" stroke="black" d="M17087.5,-781.62C17087.5,-773.52 17087.5,-764.72 17087.5,-756.21"/>
<polygon fill="black" stroke="black" points="17091,-756.04 17087.5,-746.04 17084,-756.04 17091,-756.04"/>
</g>
<!-- layer_3_expert_12_up_proj -->
<g id="node345" class="node">
<title>layer_3_expert_12_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="17662,-745.74 17291,-745.74 17291,-677.74 17662,-677.74 17662,-745.74"/>
<text text-anchor="middle" x="17476.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 12 Up Proj</text>
<text text-anchor="middle" x="17476.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="17476.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="17476.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_expert_12&#45;&gt;layer_3_expert_12_up_proj -->
<g id="edge473" class="edge">
<title>layer_3_expert_12&#45;&gt;layer_3_expert_12_up_proj</title>
<path fill="none" stroke="black" d="M17213.53,-781.69C17254.1,-771.05 17299.24,-759.22 17340.49,-748.4"/>
<polygon fill="black" stroke="black" points="17341.55,-751.74 17350.34,-745.82 17339.78,-744.97 17341.55,-751.74"/>
</g>
<!-- layer_3_expert_12_activation -->
<g id="node346" class="node">
<title>layer_3_expert_12_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="17273,-641.74 16902,-641.74 16902,-573.74 17273,-573.74 17273,-641.74"/>
<text text-anchor="middle" x="17087.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 12 GELU Activation</text>
<text text-anchor="middle" x="17087.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="17087.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="17087.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_expert_12_gate_proj&#45;&gt;layer_3_expert_12_activation -->
<g id="edge472" class="edge">
<title>layer_3_expert_12_gate_proj&#45;&gt;layer_3_expert_12_activation</title>
<path fill="none" stroke="black" d="M17087.5,-677.62C17087.5,-669.52 17087.5,-660.72 17087.5,-652.21"/>
<polygon fill="black" stroke="black" points="17091,-652.04 17087.5,-642.04 17084,-652.04 17091,-652.04"/>
</g>
<!-- layer_3_expert_12_up_proj&#45;&gt;layer_3_expert_12_activation -->
<g id="edge474" class="edge">
<title>layer_3_expert_12_up_proj&#45;&gt;layer_3_expert_12_activation</title>
<path fill="none" stroke="black" d="M17350.47,-677.69C17309.9,-667.05 17264.76,-655.22 17223.51,-644.4"/>
<polygon fill="black" stroke="black" points="17224.22,-640.97 17213.66,-641.82 17222.45,-647.74 17224.22,-640.97"/>
</g>
<!-- layer_3_expert_12_down_proj -->
<g id="node347" class="node">
<title>layer_3_expert_12_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="17079,-537.74 16708,-537.74 16708,-469.74 17079,-469.74 17079,-537.74"/>
<text text-anchor="middle" x="16893.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 12 Down Proj</text>
<text text-anchor="middle" x="16893.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="16893.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="16893.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- layer_3_expert_12_activation&#45;&gt;layer_3_expert_12_down_proj -->
<g id="edge475" class="edge">
<title>layer_3_expert_12_activation&#45;&gt;layer_3_expert_12_down_proj</title>
<path fill="none" stroke="black" d="M17024.51,-573.62C17005.7,-563.73 16984.93,-552.81 16965.58,-542.64"/>
<polygon fill="black" stroke="black" points="16966.98,-539.42 16956.5,-537.86 16963.72,-545.62 16966.98,-539.42"/>
</g>
<!-- layer_3_expert_12_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge476" class="edge">
<title>layer_3_expert_12_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M16707.87,-492.78C16308.87,-471.38 15360.26,-420.48 14798.05,-390.32"/>
<polygon fill="black" stroke="black" points="14797.9,-386.81 14787.73,-389.77 14797.53,-393.8 14797.9,-386.81"/>
</g>
<!-- layer_3_expert_13_gate_proj -->
<g id="node349" class="node">
<title>layer_3_expert_13_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="18051,-745.74 17680,-745.74 17680,-677.74 18051,-677.74 18051,-745.74"/>
<text text-anchor="middle" x="17865.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 13 Gate Proj</text>
<text text-anchor="middle" x="17865.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="17865.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="17865.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_expert_13&#45;&gt;layer_3_expert_13_gate_proj -->
<g id="edge478" class="edge">
<title>layer_3_expert_13&#45;&gt;layer_3_expert_13_gate_proj</title>
<path fill="none" stroke="black" d="M17865.5,-781.62C17865.5,-773.52 17865.5,-764.72 17865.5,-756.21"/>
<polygon fill="black" stroke="black" points="17869,-756.04 17865.5,-746.04 17862,-756.04 17869,-756.04"/>
</g>
<!-- layer_3_expert_13_up_proj -->
<g id="node350" class="node">
<title>layer_3_expert_13_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="18440,-745.74 18069,-745.74 18069,-677.74 18440,-677.74 18440,-745.74"/>
<text text-anchor="middle" x="18254.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 13 Up Proj</text>
<text text-anchor="middle" x="18254.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="18254.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="18254.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_expert_13&#45;&gt;layer_3_expert_13_up_proj -->
<g id="edge480" class="edge">
<title>layer_3_expert_13&#45;&gt;layer_3_expert_13_up_proj</title>
<path fill="none" stroke="black" d="M17991.53,-781.69C18032.1,-771.05 18077.24,-759.22 18118.49,-748.4"/>
<polygon fill="black" stroke="black" points="18119.55,-751.74 18128.34,-745.82 18117.78,-744.97 18119.55,-751.74"/>
</g>
<!-- layer_3_expert_13_activation -->
<g id="node351" class="node">
<title>layer_3_expert_13_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="18051,-641.74 17680,-641.74 17680,-573.74 18051,-573.74 18051,-641.74"/>
<text text-anchor="middle" x="17865.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 13 GELU Activation</text>
<text text-anchor="middle" x="17865.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="17865.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="17865.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_expert_13_gate_proj&#45;&gt;layer_3_expert_13_activation -->
<g id="edge479" class="edge">
<title>layer_3_expert_13_gate_proj&#45;&gt;layer_3_expert_13_activation</title>
<path fill="none" stroke="black" d="M17865.5,-677.62C17865.5,-669.52 17865.5,-660.72 17865.5,-652.21"/>
<polygon fill="black" stroke="black" points="17869,-652.04 17865.5,-642.04 17862,-652.04 17869,-652.04"/>
</g>
<!-- layer_3_expert_13_up_proj&#45;&gt;layer_3_expert_13_activation -->
<g id="edge481" class="edge">
<title>layer_3_expert_13_up_proj&#45;&gt;layer_3_expert_13_activation</title>
<path fill="none" stroke="black" d="M18128.47,-677.69C18087.9,-667.05 18042.76,-655.22 18001.51,-644.4"/>
<polygon fill="black" stroke="black" points="18002.22,-640.97 17991.66,-641.82 18000.45,-647.74 18002.22,-640.97"/>
</g>
<!-- layer_3_expert_13_down_proj -->
<g id="node352" class="node">
<title>layer_3_expert_13_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="17760,-537.74 17389,-537.74 17389,-469.74 17760,-469.74 17760,-537.74"/>
<text text-anchor="middle" x="17574.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 13 Down Proj</text>
<text text-anchor="middle" x="17574.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="17574.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="17574.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- layer_3_expert_13_activation&#45;&gt;layer_3_expert_13_down_proj -->
<g id="edge482" class="edge">
<title>layer_3_expert_13_activation&#45;&gt;layer_3_expert_13_down_proj</title>
<path fill="none" stroke="black" d="M17771.02,-573.62C17741.52,-563.28 17708.81,-551.82 17678.69,-541.26"/>
<polygon fill="black" stroke="black" points="17679.6,-537.87 17669,-537.86 17677.28,-544.48 17679.6,-537.87"/>
</g>
<!-- layer_3_expert_13_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge483" class="edge">
<title>layer_3_expert_13_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M17388.8,-488.82C17298.25,-482.36 17187.73,-474.98 17088.5,-469.74 16272.25,-426.64 15317.79,-394.89 14781.11,-378.74"/>
<polygon fill="black" stroke="black" points="14780.98,-375.24 14770.88,-378.43 14780.77,-382.23 14780.98,-375.24"/>
</g>
<!-- layer_3_expert_14_gate_proj -->
<g id="node354" class="node">
<title>layer_3_expert_14_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="18829,-745.74 18458,-745.74 18458,-677.74 18829,-677.74 18829,-745.74"/>
<text text-anchor="middle" x="18643.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 14 Gate Proj</text>
<text text-anchor="middle" x="18643.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="18643.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="18643.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_expert_14&#45;&gt;layer_3_expert_14_gate_proj -->
<g id="edge485" class="edge">
<title>layer_3_expert_14&#45;&gt;layer_3_expert_14_gate_proj</title>
<path fill="none" stroke="black" d="M18643.5,-781.62C18643.5,-773.52 18643.5,-764.72 18643.5,-756.21"/>
<polygon fill="black" stroke="black" points="18647,-756.04 18643.5,-746.04 18640,-756.04 18647,-756.04"/>
</g>
<!-- layer_3_expert_14_up_proj -->
<g id="node355" class="node">
<title>layer_3_expert_14_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="19218,-745.74 18847,-745.74 18847,-677.74 19218,-677.74 19218,-745.74"/>
<text text-anchor="middle" x="19032.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 14 Up Proj</text>
<text text-anchor="middle" x="19032.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="19032.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="19032.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_expert_14&#45;&gt;layer_3_expert_14_up_proj -->
<g id="edge487" class="edge">
<title>layer_3_expert_14&#45;&gt;layer_3_expert_14_up_proj</title>
<path fill="none" stroke="black" d="M18769.53,-781.69C18810.1,-771.05 18855.24,-759.22 18896.49,-748.4"/>
<polygon fill="black" stroke="black" points="18897.55,-751.74 18906.34,-745.82 18895.78,-744.97 18897.55,-751.74"/>
</g>
<!-- layer_3_expert_14_activation -->
<g id="node356" class="node">
<title>layer_3_expert_14_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="18829,-641.74 18458,-641.74 18458,-573.74 18829,-573.74 18829,-641.74"/>
<text text-anchor="middle" x="18643.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 14 GELU Activation</text>
<text text-anchor="middle" x="18643.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="18643.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="18643.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_expert_14_gate_proj&#45;&gt;layer_3_expert_14_activation -->
<g id="edge486" class="edge">
<title>layer_3_expert_14_gate_proj&#45;&gt;layer_3_expert_14_activation</title>
<path fill="none" stroke="black" d="M18643.5,-677.62C18643.5,-669.52 18643.5,-660.72 18643.5,-652.21"/>
<polygon fill="black" stroke="black" points="18647,-652.04 18643.5,-642.04 18640,-652.04 18647,-652.04"/>
</g>
<!-- layer_3_expert_14_up_proj&#45;&gt;layer_3_expert_14_activation -->
<g id="edge488" class="edge">
<title>layer_3_expert_14_up_proj&#45;&gt;layer_3_expert_14_activation</title>
<path fill="none" stroke="black" d="M18906.47,-677.69C18865.9,-667.05 18820.76,-655.22 18779.51,-644.4"/>
<polygon fill="black" stroke="black" points="18780.22,-640.97 18769.66,-641.82 18778.45,-647.74 18780.22,-640.97"/>
</g>
<!-- layer_3_expert_14_down_proj -->
<g id="node357" class="node">
<title>layer_3_expert_14_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="18343,-537.74 17972,-537.74 17972,-469.74 18343,-469.74 18343,-537.74"/>
<text text-anchor="middle" x="18157.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 14 Down Proj</text>
<text text-anchor="middle" x="18157.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="18157.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="18157.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- layer_3_expert_14_activation&#45;&gt;layer_3_expert_14_down_proj -->
<g id="edge489" class="edge">
<title>layer_3_expert_14_activation&#45;&gt;layer_3_expert_14_down_proj</title>
<path fill="none" stroke="black" d="M18486.05,-573.69C18434.6,-562.9 18377.3,-550.87 18325.14,-539.92"/>
<polygon fill="black" stroke="black" points="18325.63,-536.45 18315.12,-537.82 18324.19,-543.3 18325.63,-536.45"/>
</g>
<!-- layer_3_expert_14_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge490" class="edge">
<title>layer_3_expert_14_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M17971.64,-484.85C17907.64,-479.25 17835.47,-473.54 17769.5,-469.74 16688.86,-407.52 15413.34,-381.65 14771.51,-371.93"/>
<polygon fill="black" stroke="black" points="14771.22,-368.43 14761.16,-371.78 14771.11,-375.43 14771.22,-368.43"/>
</g>
<!-- layer_3_expert_15_gate_proj -->
<g id="node359" class="node">
<title>layer_3_expert_15_gate_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="19607,-745.74 19236,-745.74 19236,-677.74 19607,-677.74 19607,-745.74"/>
<text text-anchor="middle" x="19421.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 15 Gate Proj</text>
<text text-anchor="middle" x="19421.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="19421.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="19421.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_expert_15&#45;&gt;layer_3_expert_15_gate_proj -->
<g id="edge492" class="edge">
<title>layer_3_expert_15&#45;&gt;layer_3_expert_15_gate_proj</title>
<path fill="none" stroke="black" d="M19421.5,-781.62C19421.5,-773.52 19421.5,-764.72 19421.5,-756.21"/>
<polygon fill="black" stroke="black" points="19425,-756.04 19421.5,-746.04 19418,-756.04 19425,-756.04"/>
</g>
<!-- layer_3_expert_15_up_proj -->
<g id="node360" class="node">
<title>layer_3_expert_15_up_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="19996,-745.74 19625,-745.74 19625,-677.74 19996,-677.74 19996,-745.74"/>
<text text-anchor="middle" x="19810.5" y="-730.54" font-family="Times,serif" font-size="14.00">Expert 15 Up Proj</text>
<text text-anchor="middle" x="19810.5" y="-715.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="19810.5" y="-700.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="19810.5" y="-685.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_expert_15&#45;&gt;layer_3_expert_15_up_proj -->
<g id="edge494" class="edge">
<title>layer_3_expert_15&#45;&gt;layer_3_expert_15_up_proj</title>
<path fill="none" stroke="black" d="M19547.53,-781.69C19588.1,-771.05 19633.24,-759.22 19674.49,-748.4"/>
<polygon fill="black" stroke="black" points="19675.55,-751.74 19684.34,-745.82 19673.78,-744.97 19675.55,-751.74"/>
</g>
<!-- layer_3_expert_15_activation -->
<g id="node361" class="node">
<title>layer_3_expert_15_activation</title>
<polygon fill="lightsteelblue" stroke="black" points="19607,-641.74 19236,-641.74 19236,-573.74 19607,-573.74 19607,-641.74"/>
<text text-anchor="middle" x="19421.5" y="-626.54" font-family="Times,serif" font-size="14.00">Expert 15 GELU Activation</text>
<text text-anchor="middle" x="19421.5" y="-611.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="19421.5" y="-596.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="19421.5" y="-581.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_expert_15_gate_proj&#45;&gt;layer_3_expert_15_activation -->
<g id="edge493" class="edge">
<title>layer_3_expert_15_gate_proj&#45;&gt;layer_3_expert_15_activation</title>
<path fill="none" stroke="black" d="M19421.5,-677.62C19421.5,-669.52 19421.5,-660.72 19421.5,-652.21"/>
<polygon fill="black" stroke="black" points="19425,-652.04 19421.5,-642.04 19418,-652.04 19425,-652.04"/>
</g>
<!-- layer_3_expert_15_up_proj&#45;&gt;layer_3_expert_15_activation -->
<g id="edge495" class="edge">
<title>layer_3_expert_15_up_proj&#45;&gt;layer_3_expert_15_activation</title>
<path fill="none" stroke="black" d="M19684.47,-677.69C19643.9,-667.05 19598.76,-655.22 19557.51,-644.4"/>
<polygon fill="black" stroke="black" points="19558.22,-640.97 19547.66,-641.82 19556.45,-647.74 19558.22,-640.97"/>
</g>
<!-- layer_3_expert_15_down_proj -->
<g id="node362" class="node">
<title>layer_3_expert_15_down_proj</title>
<polygon fill="lightsteelblue" stroke="black" points="19170,-537.74 18799,-537.74 18799,-469.74 19170,-469.74 19170,-537.74"/>
<text text-anchor="middle" x="18984.5" y="-522.54" font-family="Times,serif" font-size="14.00">Expert 15 Down Proj</text>
<text text-anchor="middle" x="18984.5" y="-507.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=variable, ffn_hidden=32768]</text>
<text text-anchor="middle" x="18984.5" y="-492.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=variable, hidden_size=8192]</text>
<text text-anchor="middle" x="18984.5" y="-477.54" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- layer_3_expert_15_activation&#45;&gt;layer_3_expert_15_down_proj -->
<g id="edge496" class="edge">
<title>layer_3_expert_15_activation&#45;&gt;layer_3_expert_15_down_proj</title>
<path fill="none" stroke="black" d="M19279.92,-573.69C19233.95,-562.97 19182.78,-551.02 19136.11,-540.13"/>
<polygon fill="black" stroke="black" points="19136.76,-536.69 19126.23,-537.82 19135.17,-543.5 19136.76,-536.69"/>
</g>
<!-- layer_3_expert_15_down_proj&#45;&gt;layer_3_expert_agg -->
<g id="edge497" class="edge">
<title>layer_3_expert_15_down_proj&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M18798.93,-491.76C18673.02,-484.63 18502.77,-475.6 18352.5,-469.74 17046.88,-418.83 15500.16,-387.07 14774.07,-373.85"/>
<polygon fill="black" stroke="black" points="14774.04,-370.35 14763.98,-373.66 14773.91,-377.35 14774.04,-370.35"/>
</g>
<!-- layer_3_expert_agg&#45;&gt;layer_3_expert_residual -->
<g id="edge499" class="edge">
<title>layer_3_expert_agg&#45;&gt;layer_3_expert_residual</title>
<path fill="none" stroke="black" d="M14724.49,-347.15C15310.98,-318.97 16445.92,-264.43 16944.05,-240.49"/>
<polygon fill="black" stroke="black" points="16944.43,-243.97 16954.25,-240 16944.09,-236.98 16944.43,-243.97"/>
</g>
<!-- layer_3_expert_layernorm -->
<g id="node365" class="node">
<title>layer_3_expert_layernorm</title>
<polygon fill="lightgray" stroke="black" points="17422.5,-157.74 16954.5,-157.74 16954.5,-89.74 17422.5,-89.74 17422.5,-157.74"/>
<text text-anchor="middle" x="17188.5" y="-142.54" font-family="Times,serif" font-size="14.00">Layer Norm (Post&#45;Experts)</text>
<text text-anchor="middle" x="17188.5" y="-127.54" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="17188.5" y="-112.54" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
<text text-anchor="middle" x="17188.5" y="-97.54" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_expert_residual&#45;&gt;layer_3_expert_layernorm -->
<g id="edge500" class="edge">
<title>layer_3_expert_residual&#45;&gt;layer_3_expert_layernorm</title>
<path fill="none" stroke="black" d="M17188.5,-193.62C17188.5,-185.52 17188.5,-176.72 17188.5,-168.21"/>
<polygon fill="black" stroke="black" points="17192,-168.04 17188.5,-158.04 17185,-168.04 17192,-168.04"/>
</g>
<!-- output -->
<g id="node366" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="17188.5" cy="-26.87" rx="330.85" ry="26.74"/>
<text text-anchor="middle" x="17188.5" y="-30.67" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="17188.5" y="-15.67" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=10000, hidden_size=8192]</text>
</g>
<!-- layer_3_expert_layernorm&#45;&gt;output -->
<g id="edge501" class="edge">
<title>layer_3_expert_layernorm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M17188.5,-89.56C17188.5,-81.37 17188.5,-72.55 17188.5,-64.22"/>
<polygon fill="black" stroke="black" points="17192,-64.01 17188.5,-54.01 17185,-64.01 17192,-64.01"/>
</g>
</g>
</svg>
