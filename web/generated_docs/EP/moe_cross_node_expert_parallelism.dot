digraph MoE_Cross_Node_Expert_Parallelism {
	graph [bb="0,0,20024,7351.5",
		rankdir=TB,
		size="20,20"
	];
	node [label="\N",
		shape=rectangle
	];
	input	[fillcolor=lightblue,
		height=0.74639,
		label="Model Input
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]",
		pos="7102.5,7324.6",
		shape=ellipse,
		style=filled,
		width=8.9567];
	layer_0_input	[fillcolor=lightyellow,
		height=1.4722,
		label="Layer 0 Input
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
GPU: all GPUs",
		pos="7102.5,7208.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	input -> layer_0_input	[pos="e,7102.5,7261.8 7102.5,7297.5 7102.5,7289.8 7102.5,7280.9 7102.5,7272"];
	layer_0_mha_qkv	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA QKV Projection
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, heads=16, \
d_k=512]
GPU: all GPUs",
		pos="6968.5,7085.7",
		style=filled,
		width=6.6806];
	layer_0_input -> layer_0_mha_qkv	[pos="e,7005.1,7119.8 7044.9,7155.7 7034.2,7146 7023.1,7136 7012.8,7126.8"];
	layer_0_mha_residual	[fillcolor=lightcoral,
		height=0.94444,
		label="MHA Residual Add
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_size=\
8192]
GPU: all GPUs",
		pos="7104.5,6773.7",
		style=filled,
		width=6.5];
	layer_0_input -> layer_0_mha_residual	[pos="e,7181.9,6807.8 7190,7155.5 7201.1,7145.1 7210.9,7133.2 7217.5,7119.7 7239.4,7075.4 7282.1,6960.5 7216.5,6843.7 7210,6832.2 7200.7,\
6822.3 7190.1,6813.9"];
	layer_0_mha_attention	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA Attention
Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]
Output: [batch_size=1024, seq_len=10000, hidden_size=8192]
\
GPU: all GPUs",
		pos="6971.5,6981.7",
		style=filled,
		width=6.5139];
	layer_0_mha_qkv -> layer_0_mha_attention	[pos="e,6970.5,7016 6969.5,7051.6 6969.7,7043.5 6970,7034.7 6970.2,7026.2"];
	layer_0_mha_proj	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA Output Projection
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="6973.5,6877.7",
		style=filled,
		width=6.5];
	layer_0_mha_attention -> layer_0_mha_proj	[pos="e,6972.8,6912 6972.1,6947.6 6972.3,6939.5 6972.5,6930.7 6972.6,6922.2"];
	layer_0_mha_proj -> layer_0_mha_residual	[pos="e,7061.7,6808 7016,6843.6 7028,6834.3 7041.2,6824 7053.7,6814.3"];
	layer_0_mha_layernorm	[fillcolor=lightgray,
		height=0.94444,
		label="Layer Norm (Post-MHA)
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="7104.5,6669.7",
		style=filled,
		width=6.5];
	layer_0_mha_residual -> layer_0_mha_layernorm	[pos="e,7104.5,6704 7104.5,6739.6 7104.5,6731.5 7104.5,6722.7 7104.5,6714.2"];
	layer_0_gate	[fillcolor=orange,
		height=1.8889,
		label="Expert Gate
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, k=2]
GPU: all GPUs",
		pos="6603.5,6531.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_0_mha_layernorm -> layer_0_gate	[pos="e,6850.6,6599.8 6982.9,6635.7 6945.6,6625.6 6903.1,6614.1 6860.3,6602.5"];
	layer_0_token_split	[fillcolor=lightyellow,
		height=1.8889,
		label="Token Split by Expert
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192] \
per expert
GPU: all GPUs",
		pos="6603.5,6359.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_0_mha_layernorm -> layer_0_token_split	[pos="e,7024.9,6427.8 7112.2,6635.7 7120.5,6590.9 7127.5,6511 7085.5,6463.7 7074.8,6451.7 7056.9,6441 7034.2,6431.5"];
	layer_0_expert_residual	[fillcolor=lightcoral,
		height=0.94444,
		label="Expert Residual Add
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_size=\
8192]
GPU: all GPUs",
		pos="9622.5,5633.7",
		style=filled,
		width=6.5];
	layer_0_mha_layernorm -> layer_0_expert_residual	[pos="e,9856.7,5645.2 7338.9,6667.7 8370.8,6661.6 12458,6621.1 12458,6360.7 12458,6360.7 12458,6360.7 12458,5908.7 12458,5779 10555,5677.9 \
9866.7,5645.6"];
	layer_0_gate -> layer_0_token_split	[pos="e,6603.5,6428 6603.5,6463.6 6603.5,6455.2 6603.5,6446.7 6603.5,6438.2",
		style=dashed];
	layer_0_expert_0	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 0
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 0",
		pos="574.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_0	[pos="e,760.18,6235 6222.9,6356.5 5335.2,6350.1 3058.7,6327.5 1157.5,6255.7 1028.4,6250.9 883.43,6242.7 770.33,6235.7"];
	layer_0_expert_1	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 1
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 1",
		pos="1352.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_1	[pos="e,1538.2,6234.9 6220.3,6354.8 5422.6,6345.5 3525.9,6318.3 1935.5,6255.7 1806.4,6250.7 1661.4,6242.5 1548.3,6235.5"];
	layer_0_expert_2	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 2
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 2",
		pos="2130.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_2	[pos="e,2316.2,6234.7 6216.9,6352.4 5517.6,6339.9 3996,6309 2713.5,6255.7 2584.5,6250.4 2439.5,6242.2 2326.3,6235.3"];
	layer_0_expert_3	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 3
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 3",
		pos="2908.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_3	[pos="e,3094.2,6234.4 6211.9,6348.7 5621.9,6333 4469.8,6299.6 3491.5,6255.7 3362.5,6250 3217.5,6241.8 3104.4,6235"];
	layer_0_expert_4	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 4
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 4",
		pos="3686.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_4	[pos="e,3872.2,6233.8 6203.1,6342.6 5738.1,6323.5 4948.2,6289.9 4269.5,6255.7 4140.5,6249.2 3995.5,6241 3882.4,6234.4"];
	layer_0_expert_5	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 5
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 5",
		pos="4464.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_5	[pos="e,4650.1,6234.5 6188.5,6332.4 5728.2,6303.1 5005.1,6257.1 4660.2,6235.2"];
	layer_0_expert_6	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 6
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 6",
		pos="5242.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_6	[pos="e,5428.2,6241.3 6163.5,6314.8 5919,6290.3 5626.9,6261.1 5438.2,6242.3"];
	layer_0_expert_7	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 7
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 7",
		pos="6020.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_7	[pos="e,6162.1,6255.8 6316.3,6291.7 6266.4,6280.1 6216.4,6268.4 6172.1,6258.1"];
	layer_0_expert_8	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 8
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 8",
		pos="6603.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_8	[pos="e,6603.5,6255.8 6603.5,6291.5 6603.5,6282.8 6603.5,6274 6603.5,6265.8"];
	layer_0_expert_9	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 9
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 9",
		pos="7187.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_9	[pos="e,7045.5,6255.8 6884.8,6293.2 6936.9,6281.1 6989.4,6268.9 7035.7,6258.1"];
	layer_0_expert_10	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 10
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 10",
		pos="7965.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_10	[pos="e,7779.6,6241.3 6931.5,6326 7193.1,6299.9 7550.8,6264.1 7769.6,6242.3"];
	layer_0_expert_11	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 11
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 11",
		pos="8743.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_11	[pos="e,8557.7,6234.5 6947,6336.9 7400.5,6308.1 8184,6258.3 8547.6,6235.2"];
	layer_0_expert_12	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 12
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 12",
		pos="9521.5,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_12	[pos="e,9335.8,6233.8 6958.1,6344.5 7415.8,6325.7 8236.6,6291.1 8938.5,6255.7 9067.5,6249.2 9212.5,6241 9325.6,6234.4"];
	layer_0_expert_13	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 13
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 13",
		pos="10300,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_13	[pos="e,10114,6234.4 6964.9,6349.5 7545.2,6334.1 8720.8,6300.4 9716.5,6255.7 9845.5,6250 9990.5,6241.8 10104,6235"];
	layer_0_expert_14	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 14
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 14",
		pos="11078,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_14	[pos="e,10892,6234.7 6969.4,6352.7 7659.1,6340.6 9198.8,6309.5 10494,6255.7 10624,6250.4 10769,6242.2 10882,6235.3"];
	layer_0_expert_15	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 15
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 15",
		pos="11856,6221.7",
		style=filled,
		width=5.1528];
	layer_0_token_split -> layer_0_expert_15	[pos="e,11670,6234.9 6972.8,6354.9 7762.3,6345.8 9672.4,6318.7 11272,6255.7 11402,6250.7 11547,6242.5 11660,6235.5"];
	layer_0_expert_0_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="185.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_0 -> layer_0_expert_0_gate_proj	[pos="e,311.66,6151.8 448.47,6187.7 407.9,6177.1 362.76,6165.2 321.51,6154.4"];
	layer_0_expert_0_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="574.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_0 -> layer_0_expert_0_up_proj	[pos="e,574.5,6152 574.5,6187.6 574.5,6179.5 574.5,6170.7 574.5,6162.2"];
	layer_0_expert_0_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="574.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_0_gate_proj -> layer_0_expert_0_activation	[pos="e,448.34,6047.8 311.53,6083.7 352.1,6073.1 397.24,6061.2 438.49,6050.4"];
	layer_0_expert_0_up_proj -> layer_0_expert_0_activation	[pos="e,574.5,6048 574.5,6083.6 574.5,6075.5 574.5,6066.7 574.5,6058.2"];
	layer_0_expert_0_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 0",
		pos="581.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_0_activation -> layer_0_expert_0_down_proj	[pos="e,579.21,5944 576.77,5979.6 577.33,5971.5 577.93,5962.7 578.52,5954.2"];
	layer_0_expert_agg	[fillcolor=lightyellow,
		height=1.8889,
		label="Expert Output Aggregation
Input: [batch_size=variable, hidden_size=8192] from all experts
Output: [batch_size=1024, seq_len=10000, \
hidden_size=8192]
GPU: all GPUs",
		pos="6792.5,5771.7",
		shape=parallelogram,
		style=filled,
		width=13.737];
	layer_0_expert_0_down_proj -> layer_0_expert_agg	[pos="e,6412.9,5781.1 767.38,5904.7 1624.9,5885.9 5208.1,5807.4 6402.9,5781.3"];
	layer_0_expert_1_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="963.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_1 -> layer_0_expert_1_gate_proj	[pos="e,1089.7,6151.8 1226.5,6187.7 1185.9,6177.1 1140.8,6165.2 1099.5,6154.4"];
	layer_0_expert_1_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="1352.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_1 -> layer_0_expert_1_up_proj	[pos="e,1352.5,6152 1352.5,6187.6 1352.5,6179.5 1352.5,6170.7 1352.5,6162.2"];
	layer_0_expert_1_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="1352.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_1_gate_proj -> layer_0_expert_1_activation	[pos="e,1226.3,6047.8 1089.5,6083.7 1130.1,6073.1 1175.2,6061.2 1216.5,6050.4"];
	layer_0_expert_1_up_proj -> layer_0_expert_1_activation	[pos="e,1352.5,6048 1352.5,6083.6 1352.5,6075.5 1352.5,6066.7 1352.5,6058.2"];
	layer_0_expert_1_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 1",
		pos="2526.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_1_activation -> layer_0_expert_1_down_proj	[pos="e,2340.8,5926.9 1538.2,5996.6 1754.5,5977.8 2110.2,5946.9 2330.7,5927.8"];
	layer_0_expert_1_down_proj -> layer_0_expert_agg	[pos="e,6417.4,5784.1 2712.4,5902.3 2908,5895.5 3224.9,5884.7 3498.5,5875.7 4550.7,5841.4 5791.9,5803.2 6407,5784.5"];
	layer_0_expert_2_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="1741.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_2 -> layer_0_expert_2_gate_proj	[pos="e,1867.7,6151.8 2004.5,6187.7 1963.9,6177.1 1918.8,6165.2 1877.5,6154.4"];
	layer_0_expert_2_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="2130.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_2 -> layer_0_expert_2_up_proj	[pos="e,2130.5,6152 2130.5,6187.6 2130.5,6179.5 2130.5,6170.7 2130.5,6162.2"];
	layer_0_expert_2_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="2130.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_2_gate_proj -> layer_0_expert_2_activation	[pos="e,2004.3,6047.8 1867.5,6083.7 1908.1,6073.1 1953.2,6061.2 1994.5,6050.4"];
	layer_0_expert_2_up_proj -> layer_0_expert_2_activation	[pos="e,2130.5,6048 2130.5,6083.6 2130.5,6075.5 2130.5,6066.7 2130.5,6058.2"];
	layer_0_expert_2_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 2",
		pos="3693.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_2_activation -> layer_0_expert_2_down_proj	[pos="e,3507.8,5922.9 2316.3,6000.6 2613.7,5981.2 3193.9,5943.3 3497.6,5923.5"];
	layer_0_expert_2_down_proj -> layer_0_expert_agg	[pos="e,6420.5,5786.2 3879.2,5897.5 3993.7,5890.7 4143.6,5882.2 4276.5,5875.7 5032.7,5838.9 5917.2,5804.7 6410.4,5786.5"];
	layer_0_expert_3_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="2519.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_3 -> layer_0_expert_3_gate_proj	[pos="e,2645.7,6151.8 2782.5,6187.7 2741.9,6177.1 2696.8,6165.2 2655.5,6154.4"];
	layer_0_expert_3_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="2908.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_3 -> layer_0_expert_3_up_proj	[pos="e,2908.5,6152 2908.5,6187.6 2908.5,6179.5 2908.5,6170.7 2908.5,6162.2"];
	layer_0_expert_3_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="2908.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_3_gate_proj -> layer_0_expert_3_activation	[pos="e,2782.3,6047.8 2645.5,6083.7 2686.1,6073.1 2731.2,6061.2 2772.5,6050.4"];
	layer_0_expert_3_up_proj -> layer_0_expert_3_activation	[pos="e,2908.5,6048 2908.5,6083.6 2908.5,6075.5 2908.5,6066.7 2908.5,6058.2"];
	layer_0_expert_3_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 3",
		pos="4471.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_3_activation -> layer_0_expert_3_down_proj	[pos="e,4285.8,5922.9 3094.3,6000.6 3391.7,5981.2 3971.9,5943.3 4275.6,5923.5"];
	layer_0_expert_3_down_proj -> layer_0_expert_agg	[pos="e,6424.4,5788.9 4657.4,5891.7 4721.4,5886.2 4793.6,5880.3 4859.5,5875.7 5399.2,5838.4 6024.6,5807.3 6414.4,5789.3"];
	layer_0_expert_4_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="3297.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_4 -> layer_0_expert_4_gate_proj	[pos="e,3423.7,6151.8 3560.5,6187.7 3519.9,6177.1 3474.8,6165.2 3433.5,6154.4"];
	layer_0_expert_4_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="3686.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_4 -> layer_0_expert_4_up_proj	[pos="e,3686.5,6152 3686.5,6187.6 3686.5,6179.5 3686.5,6170.7 3686.5,6162.2"];
	layer_0_expert_4_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="3686.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_4_gate_proj -> layer_0_expert_4_activation	[pos="e,3560.3,6047.8 3423.5,6083.7 3464.1,6073.1 3509.2,6061.2 3550.5,6050.4"];
	layer_0_expert_4_up_proj -> layer_0_expert_4_activation	[pos="e,3686.5,6048 3686.5,6083.6 3686.5,6075.5 3686.5,6066.7 3686.5,6058.2"];
	layer_0_expert_4_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 4",
		pos="5054.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_4_activation -> layer_0_expert_4_down_proj	[pos="e,4868.5,5927.1 3872.4,6000.4 4069.4,5987.2 4389.5,5965.2 4665.5,5943.7 4728.2,5938.9 4796.6,5933.2 4858.3,5927.9"];
	layer_0_expert_4_down_proj -> layer_0_expert_agg	[pos="e,6432.4,5794.2 5240.3,5886.5 5275.2,5882.6 5311.5,5878.9 5345.5,5875.7 5711.1,5842 6129.5,5813.3 6422,5794.8"];
	layer_0_expert_5_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="4075.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_5 -> layer_0_expert_5_gate_proj	[pos="e,4201.7,6151.8 4338.5,6187.7 4297.9,6177.1 4252.8,6165.2 4211.5,6154.4"];
	layer_0_expert_5_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="4464.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_5 -> layer_0_expert_5_up_proj	[pos="e,4464.5,6152 4464.5,6187.6 4464.5,6179.5 4464.5,6170.7 4464.5,6162.2"];
	layer_0_expert_5_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="4464.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_5_gate_proj -> layer_0_expert_5_activation	[pos="e,4338.3,6047.8 4201.5,6083.7 4242.1,6073.1 4287.2,6061.2 4328.5,6050.4"];
	layer_0_expert_5_up_proj -> layer_0_expert_5_activation	[pos="e,4464.5,6048 4464.5,6083.6 4464.5,6075.5 4464.5,6066.7 4464.5,6058.2"];
	layer_0_expert_5_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 5",
		pos="5540.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_5_activation -> layer_0_expert_5_down_proj	[pos="e,5354.8,5932.4 4650.4,5997.7 4809.3,5984.5 5044.1,5964.3 5248.5,5943.7 5279.7,5940.6 5312.7,5937.1 5344.9,5933.5"];
	layer_0_expert_5_down_proj -> layer_0_expert_agg	[pos="e,6448.4,5805 5726.2,5882.9 5745.5,5880.4 5764.9,5878 5783.5,5875.7 6000.7,5849.9 6244.7,5824.9 6438.3,5806"];
	layer_0_expert_6_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="4853.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_6 -> layer_0_expert_6_gate_proj	[pos="e,4979.7,6151.8 5116.5,6187.7 5075.9,6177.1 5030.8,6165.2 4989.5,6154.4"];
	layer_0_expert_6_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="5242.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_6 -> layer_0_expert_6_up_proj	[pos="e,5242.5,6152 5242.5,6187.6 5242.5,6179.5 5242.5,6170.7 5242.5,6162.2"];
	layer_0_expert_6_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="5242.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_6_gate_proj -> layer_0_expert_6_activation	[pos="e,5116.3,6047.8 4979.5,6083.7 5020.1,6073.1 5065.2,6061.2 5106.5,6050.4"];
	layer_0_expert_6_up_proj -> layer_0_expert_6_activation	[pos="e,5242.5,6048 5242.5,6083.6 5242.5,6075.5 5242.5,6066.7 5242.5,6058.2"];
	layer_0_expert_6_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 6",
		pos="5978.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_6_activation -> layer_0_expert_6_down_proj	[pos="e,5792.8,5936.5 5428.2,5987 5536.4,5972 5672.7,5953.1 5782.6,5937.9"];
	layer_0_expert_6_down_proj -> layer_0_expert_agg	[pos="e,6478.3,5825.2 6164.2,5877.7 6254.2,5862.7 6365,5844.2 6468.3,5826.9"];
	layer_0_expert_7_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="5631.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_7 -> layer_0_expert_7_gate_proj	[pos="e,5757.7,6151.8 5894.5,6187.7 5853.9,6177.1 5808.8,6165.2 5767.5,6154.4"];
	layer_0_expert_7_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="6020.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_7 -> layer_0_expert_7_up_proj	[pos="e,6020.5,6152 6020.5,6187.6 6020.5,6179.5 6020.5,6170.7 6020.5,6162.2"];
	layer_0_expert_7_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="6020.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_7_gate_proj -> layer_0_expert_7_activation	[pos="e,5894.3,6047.8 5757.5,6083.7 5798.1,6073.1 5843.2,6061.2 5884.5,6050.4"];
	layer_0_expert_7_up_proj -> layer_0_expert_7_activation	[pos="e,6020.5,6048 6020.5,6083.6 6020.5,6075.5 6020.5,6066.7 6020.5,6058.2"];
	layer_0_expert_7_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 7",
		pos="6391.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_7_activation -> layer_0_expert_7_down_proj	[pos="e,6271.2,5943.8 6140.7,5979.7 6179.2,5969.1 6222.1,5957.3 6261.3,5946.5"];
	layer_0_expert_7_down_proj -> layer_0_expert_agg	[pos="e,6594.7,5839.8 6488.8,5875.7 6518.2,5865.8 6551.6,5854.5 6585.2,5843"];
	layer_0_expert_8_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="6409.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_8 -> layer_0_expert_8_gate_proj	[pos="e,6472.5,6151.9 6540.5,6187.6 6521.7,6177.7 6500.9,6166.8 6481.6,6156.6"];
	layer_0_expert_8_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="6798.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_8 -> layer_0_expert_8_up_proj	[pos="e,6735.2,6151.9 6666.8,6187.6 6685.7,6177.7 6706.6,6166.8 6726.1,6156.6"];
	layer_0_expert_8_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="6792.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_8_gate_proj -> layer_0_expert_8_activation	[pos="e,6668.3,6047.8 6533.6,6083.7 6573.5,6073.1 6618,6061.2 6658.6,6050.4"];
	layer_0_expert_8_up_proj -> layer_0_expert_8_activation	[pos="e,6794.5,6048 6796.6,6083.6 6796.1,6075.5 6795.6,6066.7 6795.1,6058.2"];
	layer_0_expert_8_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 8",
		pos="6792.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_8_activation -> layer_0_expert_8_down_proj	[pos="e,6792.5,5944 6792.5,5979.6 6792.5,5971.5 6792.5,5962.7 6792.5,5954.2"];
	layer_0_expert_8_down_proj -> layer_0_expert_agg	[pos="e,6792.5,5840 6792.5,5875.5 6792.5,5867.6 6792.5,5859 6792.5,5850.1"];
	layer_0_expert_9_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="7187.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_9 -> layer_0_expert_9_gate_proj	[pos="e,7187.5,6152 7187.5,6187.6 7187.5,6179.5 7187.5,6170.7 7187.5,6162.2"];
	layer_0_expert_9_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="7576.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_9 -> layer_0_expert_9_up_proj	[pos="e,7450.3,6151.8 7313.5,6187.7 7354.1,6177.1 7399.2,6165.2 7440.5,6154.4"];
	layer_0_expert_9_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="7187.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_9_gate_proj -> layer_0_expert_9_activation	[pos="e,7187.5,6048 7187.5,6083.6 7187.5,6075.5 7187.5,6066.7 7187.5,6058.2"];
	layer_0_expert_9_up_proj -> layer_0_expert_9_activation	[pos="e,7313.7,6047.8 7450.5,6083.7 7409.9,6073.1 7364.8,6061.2 7323.5,6050.4"];
	layer_0_expert_9_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 9",
		pos="7181.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_9_activation -> layer_0_expert_9_down_proj	[pos="e,7183.5,5944 7185.6,5979.6 7185.1,5971.5 7184.6,5962.7 7184.1,5954.2"];
	layer_0_expert_9_down_proj -> layer_0_expert_agg	[pos="e,6984.1,5839.7 7086.8,5875.6 7058.5,5865.7 7026.3,5854.5 6993.8,5843.1"];
	layer_0_expert_10_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="7965.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_10 -> layer_0_expert_10_gate_proj	[pos="e,7965.5,6152 7965.5,6187.6 7965.5,6179.5 7965.5,6170.7 7965.5,6162.2"];
	layer_0_expert_10_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="8354.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_10 -> layer_0_expert_10_up_proj	[pos="e,8228.3,6151.8 8091.5,6187.7 8132.1,6177.1 8177.2,6165.2 8218.5,6154.4"];
	layer_0_expert_10_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="7965.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_10_gate_proj -> layer_0_expert_10_activation	[pos="e,7965.5,6048 7965.5,6083.6 7965.5,6075.5 7965.5,6066.7 7965.5,6058.2"];
	layer_0_expert_10_up_proj -> layer_0_expert_10_activation	[pos="e,8091.7,6047.8 8228.5,6083.7 8187.9,6073.1 8142.8,6061.2 8101.5,6050.4"];
	layer_0_expert_10_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 10",
		pos="7768.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_10_activation -> layer_0_expert_10_down_proj	[pos="e,7832.5,5943.9 7901.5,5979.6 7882.3,5969.7 7861.1,5958.7 7841.4,5948.5"];
	layer_0_expert_10_down_proj -> layer_0_expert_agg	[pos="e,7273.4,5839.7 7582.9,5882.9 7496.9,5870.9 7390.2,5856 7283.4,5841.1"];
	layer_0_expert_11_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="8743.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_11 -> layer_0_expert_11_gate_proj	[pos="e,8743.5,6152 8743.5,6187.6 8743.5,6179.5 8743.5,6170.7 8743.5,6162.2"];
	layer_0_expert_11_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="9132.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_11 -> layer_0_expert_11_up_proj	[pos="e,9006.3,6151.8 8869.5,6187.7 8910.1,6177.1 8955.2,6165.2 8996.5,6154.4"];
	layer_0_expert_11_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="8743.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_11_gate_proj -> layer_0_expert_11_activation	[pos="e,8743.5,6048 8743.5,6083.6 8743.5,6075.5 8743.5,6066.7 8743.5,6058.2"];
	layer_0_expert_11_up_proj -> layer_0_expert_11_activation	[pos="e,8869.7,6047.8 9006.5,6083.7 8965.9,6073.1 8920.8,6061.2 8879.5,6050.4"];
	layer_0_expert_11_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 11",
		pos="8450.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_11_activation -> layer_0_expert_11_down_proj	[pos="e,8545.4,5943.8 8648.4,5979.6 8618.6,5969.3 8585.6,5957.8 8555.2,5947.2"];
	layer_0_expert_11_down_proj -> layer_0_expert_agg	[pos="e,7242.4,5809.6 8264.7,5893.5 8021.5,5873.6 7586.9,5837.9 7252.7,5810.5"];
	layer_0_expert_12_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="9521.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_12 -> layer_0_expert_12_gate_proj	[pos="e,9521.5,6152 9521.5,6187.6 9521.5,6179.5 9521.5,6170.7 9521.5,6162.2"];
	layer_0_expert_12_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="9910.5,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_12 -> layer_0_expert_12_up_proj	[pos="e,9784.3,6151.8 9647.5,6187.7 9688.1,6177.1 9733.2,6165.2 9774.5,6154.4"];
	layer_0_expert_12_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="9521.5,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_12_gate_proj -> layer_0_expert_12_activation	[pos="e,9521.5,6048 9521.5,6083.6 9521.5,6075.5 9521.5,6066.7 9521.5,6058.2"];
	layer_0_expert_12_up_proj -> layer_0_expert_12_activation	[pos="e,9647.7,6047.8 9784.5,6083.7 9743.9,6073.1 9698.8,6061.2 9657.5,6050.4"];
	layer_0_expert_12_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 12",
		pos="9180.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_12_activation -> layer_0_expert_12_down_proj	[pos="e,9290.9,5943.8 9410.8,5979.6 9375.7,5969.1 9336.7,5957.5 9300.9,5946.8"];
	layer_0_expert_12_down_proj -> layer_0_expert_agg	[pos="e,7222.2,5795.9 8994.8,5897 8891.9,5890.6 8761.6,5882.5 8645.5,5875.7 8162.2,5847.4 7607.9,5816.8 7232.4,5796.4"];
	layer_0_expert_13_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="10300,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_13 -> layer_0_expert_13_gate_proj	[pos="e,10300,6152 10300,6187.6 10300,6179.5 10300,6170.7 10300,6162.2"];
	layer_0_expert_13_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="10688,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_13 -> layer_0_expert_13_up_proj	[pos="e,10562,6151.8 10426,6187.7 10466,6177.1 10511,6165.2 10552,6154.4"];
	layer_0_expert_13_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="10300,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_13_gate_proj -> layer_0_expert_13_activation	[pos="e,10300,6048 10300,6083.6 10300,6075.5 10300,6066.7 10300,6058.2"];
	layer_0_expert_13_up_proj -> layer_0_expert_13_activation	[pos="e,10426,6047.8 10562,6083.7 10522,6073.1 10477,6061.2 10436,6050.4"];
	layer_0_expert_13_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 13",
		pos="9934.5,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_13_activation -> layer_0_expert_13_down_proj	[pos="e,10053,5943.8 10181,5979.7 10143,5969.1 10101,5957.3 10063,5946.5"];
	layer_0_expert_13_down_proj -> layer_0_expert_agg	[pos="e,7208.7,5786.9 9748.9,5896.9 9640.1,5890.2 9500,5881.9 9375.5,5875.7 8616.3,5838.2 7731,5805.2 7218.8,5787.2"];
	layer_0_expert_14_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="11078,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_14 -> layer_0_expert_14_gate_proj	[pos="e,11078,6152 11078,6187.6 11078,6179.5 11078,6170.7 11078,6162.2"];
	layer_0_expert_14_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="11466,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_14 -> layer_0_expert_14_up_proj	[pos="e,11340,6151.8 11204,6187.7 11244,6177.1 11289,6165.2 11330,6154.4"];
	layer_0_expert_14_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="11078,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_14_gate_proj -> layer_0_expert_14_activation	[pos="e,11078,6048 11078,6083.6 11078,6075.5 11078,6066.7 11078,6058.2"];
	layer_0_expert_14_up_proj -> layer_0_expert_14_activation	[pos="e,11204,6047.8 11340,6083.7 11300,6073.1 11255,6061.2 11214,6050.4"];
	layer_0_expert_14_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 14",
		pos="10700,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_14_activation -> layer_0_expert_14_down_proj	[pos="e,10823,5943.8 10955,5979.7 10916,5969.1 10872,5957.3 10833,5946.5"];
	layer_0_expert_14_down_proj -> layer_0_expert_agg	[pos="e,7201,5781.8 10515,5896.7 10403,5889.8 10258,5881.4 10130,5875.7 9079.9,5829.2 7843.6,5796.9 7211.2,5782.1"];
	layer_0_expert_15_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="11856,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_15 -> layer_0_expert_15_gate_proj	[pos="e,11856,6152 11856,6187.6 11856,6179.5 11856,6170.7 11856,6162.2"];
	layer_0_expert_15_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="12244,6117.7",
		style=filled,
		width=5.1528];
	layer_0_expert_15 -> layer_0_expert_15_up_proj	[pos="e,12118,6151.8 11982,6187.7 12022,6177.1 12067,6165.2 12108,6154.4"];
	layer_0_expert_15_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="11856,6013.7",
		style=filled,
		width=5.1528];
	layer_0_expert_15_gate_proj -> layer_0_expert_15_activation	[pos="e,11856,6048 11856,6083.6 11856,6075.5 11856,6066.7 11856,6058.2"];
	layer_0_expert_15_up_proj -> layer_0_expert_15_activation	[pos="e,11982,6047.8 12118,6083.7 12078,6073.1 12033,6061.2 11992,6050.4"];
	layer_0_expert_15_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 15",
		pos="11472,5909.7",
		style=filled,
		width=5.1528];
	layer_0_expert_15_activation -> layer_0_expert_15_down_proj	[pos="e,11597,5943.8 11731,5979.7 11691,5969.1 11647,5957.2 11606,5946.4"];
	layer_0_expert_15_down_proj -> layer_0_expert_agg	[pos="e,7196.3,5778.6 11287,5896.6 11174,5889.6 11026,5881.1 10896,5875.7 9546.5,5820.2 7946.6,5790.5 7206.3,5778.7"];
	layer_0_expert_agg -> layer_0_expert_residual	[pos="e,9388.2,5646 7158.5,5753.2 7745,5725 8879.9,5670.4 9378.1,5646.5"];
	layer_0_expert_layernorm	[fillcolor=lightgray,
		height=0.94444,
		label="Layer Norm (Post-Experts)
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="9622.5,5529.7",
		style=filled,
		width=6.5];
	layer_0_expert_residual -> layer_0_expert_layernorm	[pos="e,9622.5,5564 9622.5,5599.6 9622.5,5591.5 9622.5,5582.7 9622.5,5574.2"];
	layer_1_input	[fillcolor=lightyellow,
		height=1.4722,
		label="Layer 1 Input
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
GPU: all GPUs",
		pos="9622.5,5406.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_0_expert_layernorm -> layer_1_input	[pos="e,9622.5,5459.9 9622.5,5495.7 9622.5,5487.6 9622.5,5478.8 9622.5,5469.9"];
	layer_1_mha_qkv	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA QKV Projection
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, heads=16, \
d_k=512]
GPU: all GPUs",
		pos="9488.5,5283.7",
		style=filled,
		width=6.6806];
	layer_1_input -> layer_1_mha_qkv	[pos="e,9525.1,5317.8 9564.9,5353.7 9554.2,5344 9543.1,5334 9532.8,5324.8"];
	layer_1_mha_residual	[fillcolor=lightcoral,
		height=0.94444,
		label="MHA Residual Add
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_size=\
8192]
GPU: all GPUs",
		pos="9626.5,4971.7",
		style=filled,
		width=6.5];
	layer_1_input -> layer_1_mha_residual	[pos="e,9703.9,5005.8 9710.8,5353.6 9722,5343.2 9731.8,5331.2 9738.5,5317.7 9793.1,5207.9 9798.3,5148.8 9738.5,5041.7 9732,5030.1 9722.7,\
5020.3 9712.2,5011.9"];
	layer_1_mha_attention	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA Attention
Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]
Output: [batch_size=1024, seq_len=10000, hidden_size=8192]
\
GPU: all GPUs",
		pos="9491.5,5179.7",
		style=filled,
		width=6.5139];
	layer_1_mha_qkv -> layer_1_mha_attention	[pos="e,9490.5,5214 9489.5,5249.6 9489.7,5241.5 9490,5232.7 9490.2,5224.2"];
	layer_1_mha_proj	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA Output Projection
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="9495.5,5075.7",
		style=filled,
		width=6.5];
	layer_1_mha_attention -> layer_1_mha_proj	[pos="e,9494.2,5110 9492.8,5145.6 9493.1,5137.5 9493.5,5128.7 9493.8,5120.2"];
	layer_1_mha_proj -> layer_1_mha_residual	[pos="e,9583.7,5006 9538,5041.6 9550,5032.3 9563.2,5022 9575.7,5012.3"];
	layer_1_mha_layernorm	[fillcolor=lightgray,
		height=0.94444,
		label="Layer Norm (Post-MHA)
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="9626.5,4867.7",
		style=filled,
		width=6.5];
	layer_1_mha_residual -> layer_1_mha_layernorm	[pos="e,9626.5,4902 9626.5,4937.6 9626.5,4929.5 9626.5,4920.7 9626.5,4912.2"];
	layer_1_gate	[fillcolor=orange,
		height=1.8889,
		label="Expert Gate
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, k=2]
GPU: all GPUs",
		pos="9125.5,4729.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_1_mha_layernorm -> layer_1_gate	[pos="e,9372.6,4797.8 9504.9,4833.7 9467.6,4823.6 9425.1,4812.1 9382.3,4800.5"];
	layer_1_token_split	[fillcolor=lightyellow,
		height=1.8889,
		label="Token Split by Expert
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192] \
per expert
GPU: all GPUs",
		pos="9125.5,4557.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_1_mha_layernorm -> layer_1_token_split	[pos="e,9546.9,4625.8 9634.2,4833.7 9642.5,4788.9 9649.5,4709 9607.5,4661.7 9596.8,4649.7 9578.9,4639 9556.2,4629.5"];
	layer_1_expert_residual	[fillcolor=lightcoral,
		height=0.94444,
		label="Expert Residual Add
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_size=\
8192]
GPU: all GPUs",
		pos="12144,3831.7",
		style=filled,
		width=6.5];
	layer_1_mha_layernorm -> layer_1_expert_residual	[pos="e,12379,3843.2 9860.9,4865.7 10893,4859.6 14980,4819.1 14980,4558.7 14980,4558.7 14980,4558.7 14980,4106.7 14980,3977 13077,3875.9 \
12389,3843.6"];
	layer_1_gate -> layer_1_token_split	[pos="e,9125.5,4626 9125.5,4661.6 9125.5,4653.2 9125.5,4644.7 9125.5,4636.2",
		style=dashed];
	layer_1_expert_0	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 0
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 0",
		pos="3096.5,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_0	[pos="e,3282.2,4433 8744.9,4554.5 7857.2,4548.1 5580.7,4525.5 3679.5,4453.7 3550.4,4448.9 3405.4,4440.7 3292.3,4433.7"];
	layer_1_expert_1	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 1
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 1",
		pos="3874.5,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_1	[pos="e,4060.2,4432.9 8742.3,4552.8 7944.6,4543.5 6047.9,4516.3 4457.5,4453.7 4328.4,4448.7 4183.4,4440.5 4070.3,4433.5"];
	layer_1_expert_2	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 2
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 2",
		pos="4652.5,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_2	[pos="e,4838.2,4432.7 8738.9,4550.4 8039.6,4537.9 6518,4507 5235.5,4453.7 5106.5,4448.4 4961.5,4440.2 4848.3,4433.3"];
	layer_1_expert_3	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 3
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 3",
		pos="5430.5,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_3	[pos="e,5616.2,4432.4 8733.9,4546.7 8143.9,4531 6991.8,4497.6 6013.5,4453.7 5884.5,4448 5739.5,4439.8 5626.4,4433"];
	layer_1_expert_4	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 4
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 4",
		pos="6208.5,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_4	[pos="e,6394.2,4431.8 8725.1,4540.6 8260.1,4521.5 7470.2,4487.9 6791.5,4453.7 6662.5,4447.2 6517.5,4439 6404.4,4432.4"];
	layer_1_expert_5	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 5
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 5",
		pos="6986.5,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_5	[pos="e,7172.1,4432.5 8710.5,4530.4 8250.2,4501.1 7527.1,4455.1 7182.2,4433.2"];
	layer_1_expert_6	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 6
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 6",
		pos="7764.5,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_6	[pos="e,7950.2,4439.3 8685.5,4512.8 8441,4488.3 8148.9,4459.1 7960.2,4440.3"];
	layer_1_expert_7	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 7
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 7",
		pos="8542.5,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_7	[pos="e,8684.1,4453.8 8838.3,4489.7 8788.4,4478.1 8738.4,4466.4 8694.1,4456.1"];
	layer_1_expert_8	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 8
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 8",
		pos="9125.5,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_8	[pos="e,9125.5,4453.8 9125.5,4489.5 9125.5,4480.8 9125.5,4472 9125.5,4463.8"];
	layer_1_expert_9	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 9
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 9",
		pos="9709.5,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_9	[pos="e,9567.5,4453.8 9406.8,4491.2 9458.9,4479.1 9511.4,4466.9 9557.7,4456.1"];
	layer_1_expert_10	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 10
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 10",
		pos="10488,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_10	[pos="e,10302,4439.3 9453.5,4524 9715.1,4497.9 10073,4462.1 10292,4440.3"];
	layer_1_expert_11	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 11
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 11",
		pos="11266,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_11	[pos="e,11080,4432.5 9469,4534.9 9922.5,4506.1 10706,4456.3 11070,4433.2"];
	layer_1_expert_12	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 12
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 12",
		pos="12044,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_12	[pos="e,11858,4431.8 9480.1,4542.5 9937.8,4523.7 10759,4489.1 11460,4453.7 11589,4447.2 11734,4439 11848,4432.4"];
	layer_1_expert_13	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 13
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 13",
		pos="12822,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_13	[pos="e,12636,4432.4 9486.9,4547.5 10067,4532.1 11243,4498.4 12238,4453.7 12368,4448 12513,4439.8 12626,4433"];
	layer_1_expert_14	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 14
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 14",
		pos="13600,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_14	[pos="e,13414,4432.7 9491.4,4550.7 10181,4538.6 11721,4507.5 13016,4453.7 13146,4448.4 13291,4440.2 13404,4433.3"];
	layer_1_expert_15	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 15
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 15",
		pos="14378,4419.7",
		style=filled,
		width=5.1528];
	layer_1_token_split -> layer_1_expert_15	[pos="e,14192,4432.9 9494.8,4552.9 10284,4543.8 12194,4516.7 13794,4453.7 13924,4448.7 14069,4440.5 14182,4433.5"];
	layer_1_expert_0_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="2707.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_0 -> layer_1_expert_0_gate_proj	[pos="e,2833.7,4349.8 2970.5,4385.7 2929.9,4375.1 2884.8,4363.2 2843.5,4352.4"];
	layer_1_expert_0_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="3096.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_0 -> layer_1_expert_0_up_proj	[pos="e,3096.5,4350 3096.5,4385.6 3096.5,4377.5 3096.5,4368.7 3096.5,4360.2"];
	layer_1_expert_0_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="3096.5,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_0_gate_proj -> layer_1_expert_0_activation	[pos="e,2970.3,4245.8 2833.5,4281.7 2874.1,4271.1 2919.2,4259.2 2960.5,4248.4"];
	layer_1_expert_0_up_proj -> layer_1_expert_0_activation	[pos="e,3096.5,4246 3096.5,4281.6 3096.5,4273.5 3096.5,4264.7 3096.5,4256.2"];
	layer_1_expert_0_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 0",
		pos="3103.5,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_0_activation -> layer_1_expert_0_down_proj	[pos="e,3101.2,4142 3098.8,4177.6 3099.3,4169.5 3099.9,4160.7 3100.5,4152.2"];
	layer_1_expert_agg	[fillcolor=lightyellow,
		height=1.8889,
		label="Expert Output Aggregation
Input: [batch_size=variable, hidden_size=8192] from all experts
Output: [batch_size=1024, seq_len=10000, \
hidden_size=8192]
GPU: all GPUs",
		pos="9314.5,3969.7",
		shape=parallelogram,
		style=filled,
		width=13.737];
	layer_1_expert_0_down_proj -> layer_1_expert_agg	[pos="e,8934.9,3979.1 3289.4,4102.7 4146.9,4083.9 7730.1,4005.4 8924.9,3979.3"];
	layer_1_expert_1_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="3485.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_1 -> layer_1_expert_1_gate_proj	[pos="e,3611.7,4349.8 3748.5,4385.7 3707.9,4375.1 3662.8,4363.2 3621.5,4352.4"];
	layer_1_expert_1_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="3874.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_1 -> layer_1_expert_1_up_proj	[pos="e,3874.5,4350 3874.5,4385.6 3874.5,4377.5 3874.5,4368.7 3874.5,4360.2"];
	layer_1_expert_1_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="3874.5,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_1_gate_proj -> layer_1_expert_1_activation	[pos="e,3748.3,4245.8 3611.5,4281.7 3652.1,4271.1 3697.2,4259.2 3738.5,4248.4"];
	layer_1_expert_1_up_proj -> layer_1_expert_1_activation	[pos="e,3874.5,4246 3874.5,4281.6 3874.5,4273.5 3874.5,4264.7 3874.5,4256.2"];
	layer_1_expert_1_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 1",
		pos="5048.5,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_1_activation -> layer_1_expert_1_down_proj	[pos="e,4862.8,4124.9 4060.2,4194.6 4276.5,4175.8 4632.2,4144.9 4852.7,4125.8"];
	layer_1_expert_1_down_proj -> layer_1_expert_agg	[pos="e,8939.4,3982.1 5234.4,4100.3 5430,4093.5 5746.9,4082.7 6020.5,4073.7 7072.7,4039.4 8313.9,4001.2 8929,3982.5"];
	layer_1_expert_2_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="4263.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_2 -> layer_1_expert_2_gate_proj	[pos="e,4389.7,4349.8 4526.5,4385.7 4485.9,4375.1 4440.8,4363.2 4399.5,4352.4"];
	layer_1_expert_2_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="4652.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_2 -> layer_1_expert_2_up_proj	[pos="e,4652.5,4350 4652.5,4385.6 4652.5,4377.5 4652.5,4368.7 4652.5,4360.2"];
	layer_1_expert_2_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="4652.5,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_2_gate_proj -> layer_1_expert_2_activation	[pos="e,4526.3,4245.8 4389.5,4281.7 4430.1,4271.1 4475.2,4259.2 4516.5,4248.4"];
	layer_1_expert_2_up_proj -> layer_1_expert_2_activation	[pos="e,4652.5,4246 4652.5,4281.6 4652.5,4273.5 4652.5,4264.7 4652.5,4256.2"];
	layer_1_expert_2_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 2",
		pos="6215.5,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_2_activation -> layer_1_expert_2_down_proj	[pos="e,6029.8,4120.9 4838.3,4198.6 5135.7,4179.2 5715.9,4141.3 6019.6,4121.5"];
	layer_1_expert_2_down_proj -> layer_1_expert_agg	[pos="e,8942.5,3984.2 6401.2,4095.5 6515.7,4088.7 6665.6,4080.2 6798.5,4073.7 7554.7,4036.9 8439.2,4002.7 8932.4,3984.5"];
	layer_1_expert_3_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="5041.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_3 -> layer_1_expert_3_gate_proj	[pos="e,5167.7,4349.8 5304.5,4385.7 5263.9,4375.1 5218.8,4363.2 5177.5,4352.4"];
	layer_1_expert_3_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="5430.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_3 -> layer_1_expert_3_up_proj	[pos="e,5430.5,4350 5430.5,4385.6 5430.5,4377.5 5430.5,4368.7 5430.5,4360.2"];
	layer_1_expert_3_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="5430.5,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_3_gate_proj -> layer_1_expert_3_activation	[pos="e,5304.3,4245.8 5167.5,4281.7 5208.1,4271.1 5253.2,4259.2 5294.5,4248.4"];
	layer_1_expert_3_up_proj -> layer_1_expert_3_activation	[pos="e,5430.5,4246 5430.5,4281.6 5430.5,4273.5 5430.5,4264.7 5430.5,4256.2"];
	layer_1_expert_3_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 3",
		pos="6993.5,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_3_activation -> layer_1_expert_3_down_proj	[pos="e,6807.8,4120.9 5616.3,4198.6 5913.7,4179.2 6493.9,4141.3 6797.6,4121.5"];
	layer_1_expert_3_down_proj -> layer_1_expert_agg	[pos="e,8946.6,3986.9 7179.4,4089.8 7243.7,4084.2 7316.2,4078.3 7382.5,4073.7 7922,4036.5 8547,4005.4 8936.6,3987.4"];
	layer_1_expert_4_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="5819.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_4 -> layer_1_expert_4_gate_proj	[pos="e,5945.7,4349.8 6082.5,4385.7 6041.9,4375.1 5996.8,4363.2 5955.5,4352.4"];
	layer_1_expert_4_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="6208.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_4 -> layer_1_expert_4_up_proj	[pos="e,6208.5,4350 6208.5,4385.6 6208.5,4377.5 6208.5,4368.7 6208.5,4360.2"];
	layer_1_expert_4_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="6208.5,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_4_gate_proj -> layer_1_expert_4_activation	[pos="e,6082.3,4245.8 5945.5,4281.7 5986.1,4271.1 6031.2,4259.2 6072.5,4248.4"];
	layer_1_expert_4_up_proj -> layer_1_expert_4_activation	[pos="e,6208.5,4246 6208.5,4281.6 6208.5,4273.5 6208.5,4264.7 6208.5,4256.2"];
	layer_1_expert_4_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 4",
		pos="7576.5,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_4_activation -> layer_1_expert_4_down_proj	[pos="e,7390.5,4125.1 6394.4,4198.4 6591.4,4185.2 6911.5,4163.2 7187.5,4141.7 7250.2,4136.9 7318.6,4131.2 7380.3,4125.9"];
	layer_1_expert_4_down_proj -> layer_1_expert_agg	[pos="e,8954.3,3992.2 7762.1,4084.6 7797.4,4080.7 7834.1,4076.9 7868.5,4073.7 8233.7,4040.1 8651.6,4011.4 8943.9,3992.9"];
	layer_1_expert_5_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="6597.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_5 -> layer_1_expert_5_gate_proj	[pos="e,6723.7,4349.8 6860.5,4385.7 6819.9,4375.1 6774.8,4363.2 6733.5,4352.4"];
	layer_1_expert_5_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="6986.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_5 -> layer_1_expert_5_up_proj	[pos="e,6986.5,4350 6986.5,4385.6 6986.5,4377.5 6986.5,4368.7 6986.5,4360.2"];
	layer_1_expert_5_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="6986.5,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_5_gate_proj -> layer_1_expert_5_activation	[pos="e,6860.3,4245.8 6723.5,4281.7 6764.1,4271.1 6809.2,4259.2 6850.5,4248.4"];
	layer_1_expert_5_up_proj -> layer_1_expert_5_activation	[pos="e,6986.5,4246 6986.5,4281.6 6986.5,4273.5 6986.5,4264.7 6986.5,4256.2"];
	layer_1_expert_5_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 5",
		pos="8062.5,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_5_activation -> layer_1_expert_5_down_proj	[pos="e,7876.7,4130.5 7172.2,4195.7 7331.3,4182.6 7566.6,4162.4 7771.5,4141.7 7802.2,4138.7 7834.7,4135.2 7866.4,4131.7"];
	layer_1_expert_5_down_proj -> layer_1_expert_agg	[pos="e,8970.7,4003.1 8248.3,4081 8267.9,4078.4 8287.6,4076 8306.5,4073.7 8523.5,4048 8767.2,4023 8960.7,4004.1"];
	layer_1_expert_6_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="7375.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_6 -> layer_1_expert_6_gate_proj	[pos="e,7501.7,4349.8 7638.5,4385.7 7597.9,4375.1 7552.8,4363.2 7511.5,4352.4"];
	layer_1_expert_6_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="7764.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_6 -> layer_1_expert_6_up_proj	[pos="e,7764.5,4350 7764.5,4385.6 7764.5,4377.5 7764.5,4368.7 7764.5,4360.2"];
	layer_1_expert_6_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="7764.5,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_6_gate_proj -> layer_1_expert_6_activation	[pos="e,7638.3,4245.8 7501.5,4281.7 7542.1,4271.1 7587.2,4259.2 7628.5,4248.4"];
	layer_1_expert_6_up_proj -> layer_1_expert_6_activation	[pos="e,7764.5,4246 7764.5,4281.6 7764.5,4273.5 7764.5,4264.7 7764.5,4256.2"];
	layer_1_expert_6_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 6",
		pos="8500.5,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_6_activation -> layer_1_expert_6_down_proj	[pos="e,8314.8,4134.5 7950.2,4185 8058.4,4170 8194.7,4151.1 8304.6,4135.9"];
	layer_1_expert_6_down_proj -> layer_1_expert_agg	[pos="e,9000.3,4023.2 8686.2,4075.7 8776.2,4060.7 8887,4042.2 8990.3,4024.9"];
	layer_1_expert_7_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="8153.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_7 -> layer_1_expert_7_gate_proj	[pos="e,8279.7,4349.8 8416.5,4385.7 8375.9,4375.1 8330.8,4363.2 8289.5,4352.4"];
	layer_1_expert_7_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="8542.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_7 -> layer_1_expert_7_up_proj	[pos="e,8542.5,4350 8542.5,4385.6 8542.5,4377.5 8542.5,4368.7 8542.5,4360.2"];
	layer_1_expert_7_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="8542.5,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_7_gate_proj -> layer_1_expert_7_activation	[pos="e,8416.3,4245.8 8279.5,4281.7 8320.1,4271.1 8365.2,4259.2 8406.5,4248.4"];
	layer_1_expert_7_up_proj -> layer_1_expert_7_activation	[pos="e,8542.5,4246 8542.5,4281.6 8542.5,4273.5 8542.5,4264.7 8542.5,4256.2"];
	layer_1_expert_7_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 7",
		pos="8913.5,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_7_activation -> layer_1_expert_7_down_proj	[pos="e,8793.2,4141.8 8662.7,4177.7 8701.2,4167.1 8744.1,4155.3 8783.3,4144.5"];
	layer_1_expert_7_down_proj -> layer_1_expert_agg	[pos="e,9116.7,4037.8 9010.8,4073.7 9040.2,4063.8 9073.6,4052.5 9107.2,4041"];
	layer_1_expert_8_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="8931.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_8 -> layer_1_expert_8_gate_proj	[pos="e,8994.5,4349.9 9062.5,4385.6 9043.7,4375.7 9022.9,4364.8 9003.6,4354.6"];
	layer_1_expert_8_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="9320.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_8 -> layer_1_expert_8_up_proj	[pos="e,9257.2,4349.9 9188.8,4385.6 9207.7,4375.7 9228.6,4364.8 9248.1,4354.6"];
	layer_1_expert_8_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="9314.5,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_8_gate_proj -> layer_1_expert_8_activation	[pos="e,9190.3,4245.8 9055.6,4281.7 9095.5,4271.1 9140,4259.2 9180.6,4248.4"];
	layer_1_expert_8_up_proj -> layer_1_expert_8_activation	[pos="e,9316.5,4246 9318.6,4281.6 9318.1,4273.5 9317.6,4264.7 9317.1,4256.2"];
	layer_1_expert_8_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 8",
		pos="9314.5,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_8_activation -> layer_1_expert_8_down_proj	[pos="e,9314.5,4142 9314.5,4177.6 9314.5,4169.5 9314.5,4160.7 9314.5,4152.2"];
	layer_1_expert_8_down_proj -> layer_1_expert_agg	[pos="e,9314.5,4038 9314.5,4073.5 9314.5,4065.6 9314.5,4057 9314.5,4048.1"];
	layer_1_expert_9_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="9709.5,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_9 -> layer_1_expert_9_gate_proj	[pos="e,9709.5,4350 9709.5,4385.6 9709.5,4377.5 9709.5,4368.7 9709.5,4360.2"];
	layer_1_expert_9_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="10098,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_9 -> layer_1_expert_9_up_proj	[pos="e,9972.3,4349.8 9835.5,4385.7 9876.1,4375.1 9921.2,4363.2 9962.5,4352.4"];
	layer_1_expert_9_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="9709.5,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_9_gate_proj -> layer_1_expert_9_activation	[pos="e,9709.5,4246 9709.5,4281.6 9709.5,4273.5 9709.5,4264.7 9709.5,4256.2"];
	layer_1_expert_9_up_proj -> layer_1_expert_9_activation	[pos="e,9835.7,4245.8 9972.5,4281.7 9931.9,4271.1 9886.8,4259.2 9845.5,4248.4"];
	layer_1_expert_9_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 9",
		pos="9703.5,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_9_activation -> layer_1_expert_9_down_proj	[pos="e,9705.5,4142 9707.6,4177.6 9707.1,4169.5 9706.6,4160.7 9706.1,4152.2"];
	layer_1_expert_9_down_proj -> layer_1_expert_agg	[pos="e,9506.1,4037.7 9608.8,4073.6 9580.5,4063.7 9548.3,4052.5 9515.8,4041.1"];
	layer_1_expert_10_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="10488,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_10 -> layer_1_expert_10_gate_proj	[pos="e,10488,4350 10488,4385.6 10488,4377.5 10488,4368.7 10488,4360.2"];
	layer_1_expert_10_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="10876,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_10 -> layer_1_expert_10_up_proj	[pos="e,10750,4349.8 10614,4385.7 10654,4375.1 10699,4363.2 10740,4352.4"];
	layer_1_expert_10_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="10488,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_10_gate_proj -> layer_1_expert_10_activation	[pos="e,10488,4246 10488,4281.6 10488,4273.5 10488,4264.7 10488,4256.2"];
	layer_1_expert_10_up_proj -> layer_1_expert_10_activation	[pos="e,10614,4245.8 10750,4281.7 10710,4271.1 10665,4259.2 10624,4248.4"];
	layer_1_expert_10_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 10",
		pos="10290,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_10_activation -> layer_1_expert_10_down_proj	[pos="e,10354,4141.9 10424,4177.6 10404,4167.7 10383,4156.7 10363,4146.5"];
	layer_1_expert_10_down_proj -> layer_1_expert_agg	[pos="e,9795.4,4037.7 10105,4080.9 10019,4068.9 9912.2,4054 9805.4,4039.1"];
	layer_1_expert_11_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="11266,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_11 -> layer_1_expert_11_gate_proj	[pos="e,11266,4350 11266,4385.6 11266,4377.5 11266,4368.7 11266,4360.2"];
	layer_1_expert_11_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="11654,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_11 -> layer_1_expert_11_up_proj	[pos="e,11528,4349.8 11392,4385.7 11432,4375.1 11477,4363.2 11518,4352.4"];
	layer_1_expert_11_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="11266,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_11_gate_proj -> layer_1_expert_11_activation	[pos="e,11266,4246 11266,4281.6 11266,4273.5 11266,4264.7 11266,4256.2"];
	layer_1_expert_11_up_proj -> layer_1_expert_11_activation	[pos="e,11392,4245.8 11528,4281.7 11488,4271.1 11443,4259.2 11402,4248.4"];
	layer_1_expert_11_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 11",
		pos="10972,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_11_activation -> layer_1_expert_11_down_proj	[pos="e,11067,4141.8 11170,4177.6 11141,4167.3 11108,4155.8 11077,4145.2"];
	layer_1_expert_11_down_proj -> layer_1_expert_agg	[pos="e,9764.4,4007.6 10787,4091.5 10544,4071.6 10109,4035.9 9774.7,4008.5"];
	layer_1_expert_12_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="12044,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_12 -> layer_1_expert_12_gate_proj	[pos="e,12044,4350 12044,4385.6 12044,4377.5 12044,4368.7 12044,4360.2"];
	layer_1_expert_12_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="12432,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_12 -> layer_1_expert_12_up_proj	[pos="e,12306,4349.8 12170,4385.7 12210,4375.1 12255,4363.2 12296,4352.4"];
	layer_1_expert_12_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="12044,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_12_gate_proj -> layer_1_expert_12_activation	[pos="e,12044,4246 12044,4281.6 12044,4273.5 12044,4264.7 12044,4256.2"];
	layer_1_expert_12_up_proj -> layer_1_expert_12_activation	[pos="e,12170,4245.8 12306,4281.7 12266,4271.1 12221,4259.2 12180,4248.4"];
	layer_1_expert_12_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 12",
		pos="11702,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_12_activation -> layer_1_expert_12_down_proj	[pos="e,11813,4141.8 11933,4177.6 11898,4167.1 11859,4155.5 11823,4144.8"];
	layer_1_expert_12_down_proj -> layer_1_expert_agg	[pos="e,9744.2,3993.9 11517,4095 11414,4088.6 11284,4080.5 11168,4073.7 10684,4045.4 10130,4014.8 9754.4,3994.4"];
	layer_1_expert_13_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="12822,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_13 -> layer_1_expert_13_gate_proj	[pos="e,12822,4350 12822,4385.6 12822,4377.5 12822,4368.7 12822,4360.2"];
	layer_1_expert_13_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="13210,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_13 -> layer_1_expert_13_up_proj	[pos="e,13084,4349.8 12948,4385.7 12988,4375.1 13033,4363.2 13074,4352.4"];
	layer_1_expert_13_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="12822,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_13_gate_proj -> layer_1_expert_13_activation	[pos="e,12822,4246 12822,4281.6 12822,4273.5 12822,4264.7 12822,4256.2"];
	layer_1_expert_13_up_proj -> layer_1_expert_13_activation	[pos="e,12948,4245.8 13084,4281.7 13044,4271.1 12999,4259.2 12958,4248.4"];
	layer_1_expert_13_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 13",
		pos="12456,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_13_activation -> layer_1_expert_13_down_proj	[pos="e,12575,4141.8 12703,4177.7 12665,4167.1 12623,4155.3 12585,4144.5"];
	layer_1_expert_13_down_proj -> layer_1_expert_agg	[pos="e,9730.7,3984.9 12271,4094.9 12162,4088.2 12022,4079.9 11898,4073.7 11138,4036.2 10253,4003.2 9740.8,3985.2"];
	layer_1_expert_14_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="13600,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_14 -> layer_1_expert_14_gate_proj	[pos="e,13600,4350 13600,4385.6 13600,4377.5 13600,4368.7 13600,4360.2"];
	layer_1_expert_14_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="13988,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_14 -> layer_1_expert_14_up_proj	[pos="e,13862,4349.8 13726,4385.7 13766,4375.1 13811,4363.2 13852,4352.4"];
	layer_1_expert_14_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="13600,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_14_gate_proj -> layer_1_expert_14_activation	[pos="e,13600,4246 13600,4281.6 13600,4273.5 13600,4264.7 13600,4256.2"];
	layer_1_expert_14_up_proj -> layer_1_expert_14_activation	[pos="e,13726,4245.8 13862,4281.7 13822,4271.1 13777,4259.2 13736,4248.4"];
	layer_1_expert_14_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 14",
		pos="13222,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_14_activation -> layer_1_expert_14_down_proj	[pos="e,13345,4141.8 13477,4177.7 13438,4167.1 13394,4155.3 13355,4144.5"];
	layer_1_expert_14_down_proj -> layer_1_expert_agg	[pos="e,9723,3979.8 13037,4094.7 12925,4087.8 12780,4079.4 12652,4073.7 11602,4027.2 10366,3994.9 9733.2,3980.1"];
	layer_1_expert_15_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="14378,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_15 -> layer_1_expert_15_gate_proj	[pos="e,14378,4350 14378,4385.6 14378,4377.5 14378,4368.7 14378,4360.2"];
	layer_1_expert_15_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="14766,4315.7",
		style=filled,
		width=5.1528];
	layer_1_expert_15 -> layer_1_expert_15_up_proj	[pos="e,14640,4349.8 14504,4385.7 14544,4375.1 14589,4363.2 14630,4352.4"];
	layer_1_expert_15_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="14378,4211.7",
		style=filled,
		width=5.1528];
	layer_1_expert_15_gate_proj -> layer_1_expert_15_activation	[pos="e,14378,4246 14378,4281.6 14378,4273.5 14378,4264.7 14378,4256.2"];
	layer_1_expert_15_up_proj -> layer_1_expert_15_activation	[pos="e,14504,4245.8 14640,4281.7 14600,4271.1 14555,4259.2 14514,4248.4"];
	layer_1_expert_15_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 15",
		pos="13806,4107.7",
		style=filled,
		width=5.1528];
	layer_1_expert_15_activation -> layer_1_expert_15_down_proj	[pos="e,13991,4141.8 14192,4177.7 14131,4166.8 14063,4154.6 14001,4143.6"];
	layer_1_expert_15_down_proj -> layer_1_expert_agg	[pos="e,9712.7,3972.8 13620,4088.7 13556,4083 13483,4077.4 13418,4073.7 12066,3999.4 10461,3978.7 9723,3972.9"];
	layer_1_expert_agg -> layer_1_expert_residual	[pos="e,11910,3844 9680.5,3951.2 10267,3923 11402,3868.4 11900,3844.5"];
	layer_1_expert_layernorm	[fillcolor=lightgray,
		height=0.94444,
		label="Layer Norm (Post-Experts)
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="12144,3727.7",
		style=filled,
		width=6.5];
	layer_1_expert_residual -> layer_1_expert_layernorm	[pos="e,12144,3762 12144,3797.6 12144,3789.5 12144,3780.7 12144,3772.2"];
	layer_2_input	[fillcolor=lightyellow,
		height=1.4722,
		label="Layer 2 Input
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
GPU: all GPUs",
		pos="12144,3604.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_1_expert_layernorm -> layer_2_input	[pos="e,12144,3657.9 12144,3693.7 12144,3685.6 12144,3676.8 12144,3667.9"];
	layer_2_mha_qkv	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA QKV Projection
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, heads=16, \
d_k=512]
GPU: all GPUs",
		pos="12010,3481.7",
		style=filled,
		width=6.6806];
	layer_2_input -> layer_2_mha_qkv	[pos="e,12047,3515.8 12087,3551.7 12076,3542 12065,3532 12055,3522.8"];
	layer_2_mha_residual	[fillcolor=lightcoral,
		height=0.94444,
		label="MHA Residual Add
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_size=\
8192]
GPU: all GPUs",
		pos="12144,3169.7",
		style=filled,
		width=6.5];
	layer_2_input -> layer_2_mha_residual	[pos="e,12222,3203.9 12233,3551.6 12244,3541.2 12254,3529.2 12260,3515.7 12283,3469.7 12320,3351.7 12256,3239.7 12250,3228.2 12241,3218.3 \
12230,3210"];
	layer_2_mha_attention	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA Attention
Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]
Output: [batch_size=1024, seq_len=10000, hidden_size=8192]
\
GPU: all GPUs",
		pos="12014,3377.7",
		style=filled,
		width=6.5139];
	layer_2_mha_qkv -> layer_2_mha_attention	[pos="e,12013,3412 12011,3447.6 12012,3439.5 12012,3430.7 12012,3422.2"];
	layer_2_mha_proj	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA Output Projection
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="12014,3273.7",
		style=filled,
		width=6.5];
	layer_2_mha_attention -> layer_2_mha_proj	[pos="e,12014,3308 12014,3343.6 12014,3335.5 12014,3326.7 12014,3318.2"];
	layer_2_mha_proj -> layer_2_mha_residual	[pos="e,12102,3204 12056,3239.6 12068,3230.3 12081,3220 12094,3210.3"];
	layer_2_mha_layernorm	[fillcolor=lightgray,
		height=0.94444,
		label="Layer Norm (Post-MHA)
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="12144,3065.7",
		style=filled,
		width=6.5];
	layer_2_mha_residual -> layer_2_mha_layernorm	[pos="e,12144,3100 12144,3135.6 12144,3127.5 12144,3118.7 12144,3110.2"];
	layer_2_gate	[fillcolor=orange,
		height=1.8889,
		label="Expert Gate
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, k=2]
GPU: all GPUs",
		pos="11644,2927.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_2_mha_layernorm -> layer_2_gate	[pos="e,11891,2995.8 12023,3031.7 11986,3021.6 11943,3010.1 11900,2998.5"];
	layer_2_token_split	[fillcolor=lightyellow,
		height=1.8889,
		label="Token Split by Expert
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192] \
per expert
GPU: all GPUs",
		pos="11644,2755.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_2_mha_layernorm -> layer_2_token_split	[pos="e,12065,2823.8 12152,3031.7 12161,2986.9 12168,2907 12126,2859.7 12115,2847.7 12097,2837 12074,2827.5"];
	layer_2_expert_residual	[fillcolor=lightcoral,
		height=0.94444,
		label="Expert Residual Add
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_size=\
8192]
GPU: all GPUs",
		pos="14668,2029.7",
		style=filled,
		width=6.5];
	layer_2_mha_layernorm -> layer_2_expert_residual	[pos="e,14902,2041.2 12379,3063.7 13411,3057.6 17498,3017.1 17498,2756.7 17498,2756.7 17498,2756.7 17498,2304.7 17498,2175.3 15599,2074 \
14912,2041.7"];
	layer_2_gate -> layer_2_token_split	[pos="e,11644,2824 11644,2859.6 11644,2851.2 11644,2842.7 11644,2834.2",
		style=dashed];
	layer_2_expert_0	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 0
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 0",
		pos="5614.5,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_0	[pos="e,5800.2,2631 11263,2752.5 10375,2746.1 8098.7,2723.5 6197.5,2651.7 6068.4,2646.9 5923.4,2638.7 5810.3,2631.7"];
	layer_2_expert_1	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 1
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 1",
		pos="6392.5,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_1	[pos="e,6578.2,2630.9 11260,2750.8 10463,2741.5 8565.9,2714.3 6975.5,2651.7 6846.4,2646.7 6701.4,2638.5 6588.3,2631.5"];
	layer_2_expert_2	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 2
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 2",
		pos="7170.5,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_2	[pos="e,7356.2,2630.7 11257,2748.3 10558,2735.9 9036.7,2704.9 7754.5,2651.7 7625.1,2646.4 7479.7,2638.2 7366.4,2631.3"];
	layer_2_expert_3	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 3
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 3",
		pos="7948.5,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_3	[pos="e,8134.2,2630.3 11252,2744.7 10662,2728.9 9510.3,2695.5 8532.5,2651.7 8403.1,2645.9 8257.7,2637.7 8144.4,2631"];
	layer_2_expert_4	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 4
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 4",
		pos="8726.5,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_4	[pos="e,8912.2,2629.8 11243,2738.6 10778,2719.4 9988.9,2685.9 9310.5,2651.7 9181.2,2645.2 9035.8,2637 8922.4,2630.4"];
	layer_2_expert_5	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 5
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 5",
		pos="9504.5,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_5	[pos="e,9690.1,2630.5 11229,2728.4 10768,2699.1 10045,2653.1 9700.2,2631.2"];
	layer_2_expert_6	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 6
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 6",
		pos="10282,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_6	[pos="e,10468,2637.3 11204,2710.8 10959,2686.3 10667,2657.1 10478,2638.3"];
	layer_2_expert_7	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 7
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 7",
		pos="11060,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_7	[pos="e,11202,2651.8 11356,2687.7 11306,2676.1 11256,2664.4 11212,2654.1"];
	layer_2_expert_8	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 8
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 8",
		pos="11644,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_8	[pos="e,11644,2651.8 11644,2687.5 11644,2678.8 11644,2670 11644,2661.8"];
	layer_2_expert_9	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 9
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 9",
		pos="12228,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_9	[pos="e,12086,2651.8 11925,2689.2 11977,2677.1 12029,2664.9 12076,2654.1"];
	layer_2_expert_10	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 10
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 10",
		pos="13006,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_10	[pos="e,12820,2637.3 11971,2722 12233,2695.9 12591,2660.1 12810,2638.3"];
	layer_2_expert_11	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 11
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 11",
		pos="13784,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_11	[pos="e,13598,2630.5 11987,2732.9 12441,2704.1 13224,2654.3 13588,2631.2"];
	layer_2_expert_12	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 12
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 12",
		pos="14562,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_12	[pos="e,14376,2629.8 11998,2740.5 12456,2721.7 13277,2687.1 13978,2651.7 14107,2645.2 14252,2637 14366,2630.4"];
	layer_2_expert_13	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 13
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 13",
		pos="15340,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_13	[pos="e,15154,2630.4 12005,2745.5 12585,2730.1 13761,2696.4 14756,2651.7 14886,2646 15031,2637.8 15144,2631"];
	layer_2_expert_14	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 14
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 14",
		pos="16118,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_14	[pos="e,15932,2630.7 12009,2748.7 12699,2736.6 14239,2705.5 15534,2651.7 15664,2646.4 15809,2638.2 15922,2631.3"];
	layer_2_expert_15	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 15
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 15",
		pos="16896,2617.7",
		style=filled,
		width=5.1528];
	layer_2_token_split -> layer_2_expert_15	[pos="e,16710,2630.9 12013,2750.9 12802,2741.8 14712,2714.7 16312,2651.7 16442,2646.7 16587,2638.5 16700,2631.5"];
	layer_2_expert_0_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="5225.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_0 -> layer_2_expert_0_gate_proj	[pos="e,5351.7,2547.8 5488.5,2583.7 5447.9,2573.1 5402.8,2561.2 5361.5,2550.4"];
	layer_2_expert_0_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="5614.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_0 -> layer_2_expert_0_up_proj	[pos="e,5614.5,2548 5614.5,2583.6 5614.5,2575.5 5614.5,2566.7 5614.5,2558.2"];
	layer_2_expert_0_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="5614.5,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_0_gate_proj -> layer_2_expert_0_activation	[pos="e,5488.3,2443.8 5351.5,2479.7 5392.1,2469.1 5437.2,2457.2 5478.5,2446.4"];
	layer_2_expert_0_up_proj -> layer_2_expert_0_activation	[pos="e,5614.5,2444 5614.5,2479.6 5614.5,2471.5 5614.5,2462.7 5614.5,2454.2"];
	layer_2_expert_0_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 0",
		pos="6124.5,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_0_activation -> layer_2_expert_0_down_proj	[pos="e,5959.1,2339.8 5779.7,2375.7 5833.9,2364.9 5894.3,2352.8 5949.3,2341.8"];
	layer_2_expert_agg	[fillcolor=lightyellow,
		height=1.8889,
		label="Expert Output Aggregation
Input: [batch_size=variable, hidden_size=8192] from all experts
Output: [batch_size=1024, seq_len=10000, \
hidden_size=8192]
GPU: all GPUs",
		pos="11644,2167.7",
		shape=parallelogram,
		style=filled,
		width=13.737];
	layer_2_expert_0_down_proj -> layer_2_expert_agg	[pos="e,11260,2174.4 6310.1,2295.8 6467.5,2288.4 6699.2,2278.2 6901.5,2271.7 8514.4,2220 10437,2187.1 11250,2174.5"];
	layer_2_expert_1_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="6003.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_1 -> layer_2_expert_1_gate_proj	[pos="e,6129.7,2547.8 6266.5,2583.7 6225.9,2573.1 6180.8,2561.2 6139.5,2550.4"];
	layer_2_expert_1_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="6392.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_1 -> layer_2_expert_1_up_proj	[pos="e,6392.5,2548 6392.5,2583.6 6392.5,2575.5 6392.5,2566.7 6392.5,2558.2"];
	layer_2_expert_1_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="6392.5,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_1_gate_proj -> layer_2_expert_1_activation	[pos="e,6266.3,2443.8 6129.5,2479.7 6170.1,2469.1 6215.2,2457.2 6256.5,2446.4"];
	layer_2_expert_1_up_proj -> layer_2_expert_1_activation	[pos="e,6392.5,2444 6392.5,2479.6 6392.5,2471.5 6392.5,2462.7 6392.5,2454.2"];
	layer_2_expert_1_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 1",
		pos="7096.5,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_1_activation -> layer_2_expert_1_down_proj	[pos="e,6910.8,2333.6 6578.4,2381.8 6677.7,2367.4 6800,2349.7 6900.8,2335.1"];
	layer_2_expert_1_down_proj -> layer_2_expert_agg	[pos="e,11258,2173.1 7282.3,2290.3 7373,2283.7 7483.9,2276.4 7583.5,2271.7 8926.5,2209.2 10521,2182.7 11248,2173.2"];
	layer_2_expert_2_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="6781.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_2 -> layer_2_expert_2_gate_proj	[pos="e,6907.7,2547.8 7044.5,2583.7 7003.9,2573.1 6958.8,2561.2 6917.5,2550.4"];
	layer_2_expert_2_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="7170.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_2 -> layer_2_expert_2_up_proj	[pos="e,7170.5,2548 7170.5,2583.6 7170.5,2575.5 7170.5,2566.7 7170.5,2558.2"];
	layer_2_expert_2_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="7170.5,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_2_gate_proj -> layer_2_expert_2_activation	[pos="e,7044.3,2443.8 6907.5,2479.7 6948.1,2469.1 6993.2,2457.2 7034.5,2446.4"];
	layer_2_expert_2_up_proj -> layer_2_expert_2_activation	[pos="e,7170.5,2444 7170.5,2479.6 7170.5,2471.5 7170.5,2462.7 7170.5,2454.2"];
	layer_2_expert_2_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 2",
		pos="7777.5,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_2_activation -> layer_2_expert_2_down_proj	[pos="e,7591.9,2337.9 7356.3,2377.5 7427.7,2365.5 7509.4,2351.8 7581.7,2339.6"];
	layer_2_expert_2_down_proj -> layer_2_expert_agg	[pos="e,11255,2171.6 7963.1,2284.5 8013.5,2279.6 8068,2274.9 8118.5,2271.7 9251.3,2200.5 10592,2178.4 11245,2171.7"];
	layer_2_expert_3_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="7559.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_3 -> layer_2_expert_3_gate_proj	[pos="e,7685.7,2547.8 7822.5,2583.7 7781.9,2573.1 7736.8,2561.2 7695.5,2550.4"];
	layer_2_expert_3_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="7948.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_3 -> layer_2_expert_3_up_proj	[pos="e,7948.5,2548 7948.5,2583.6 7948.5,2575.5 7948.5,2566.7 7948.5,2558.2"];
	layer_2_expert_3_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="7948.5,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_3_gate_proj -> layer_2_expert_3_activation	[pos="e,7822.3,2443.8 7685.5,2479.7 7726.1,2469.1 7771.2,2457.2 7812.5,2446.4"];
	layer_2_expert_3_up_proj -> layer_2_expert_3_activation	[pos="e,7948.5,2444 7948.5,2479.6 7948.5,2471.5 7948.5,2462.7 7948.5,2454.2"];
	layer_2_expert_3_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 3",
		pos="8312.5,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_3_activation -> layer_2_expert_3_down_proj	[pos="e,8194.4,2339.8 8066.4,2375.7 8104.2,2365.1 8146.3,2353.3 8184.7,2342.5"];
	layer_2_expert_3_down_proj -> layer_2_expert_agg	[pos="e,11268,2180.1 8498.2,2292.8 8607.2,2286 8747.6,2277.7 8872.5,2271.7 9723.7,2230.8 10723,2197.3 11258,2180.4"];
	layer_2_expert_4_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="8337.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_4 -> layer_2_expert_4_gate_proj	[pos="e,8463.7,2547.8 8600.5,2583.7 8559.9,2573.1 8514.8,2561.2 8473.5,2550.4"];
	layer_2_expert_4_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="8726.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_4 -> layer_2_expert_4_up_proj	[pos="e,8726.5,2548 8726.5,2583.6 8726.5,2575.5 8726.5,2566.7 8726.5,2558.2"];
	layer_2_expert_4_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="8726.5,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_4_gate_proj -> layer_2_expert_4_activation	[pos="e,8600.3,2443.8 8463.5,2479.7 8504.1,2469.1 8549.2,2457.2 8590.5,2446.4"];
	layer_2_expert_4_up_proj -> layer_2_expert_4_activation	[pos="e,8726.5,2444 8726.5,2479.6 8726.5,2471.5 8726.5,2462.7 8726.5,2454.2"];
	layer_2_expert_4_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 4",
		pos="9066.5,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_4_activation -> layer_2_expert_4_down_proj	[pos="e,8956.4,2339.8 8836.9,2375.6 8871.9,2365.1 8910.8,2353.5 8946.4,2342.8"];
	layer_2_expert_4_down_proj -> layer_2_expert_agg	[pos="e,11280,2187.9 9252.1,2294.9 9673.6,2272.7 10710,2218 11270,2188.5"];
	layer_2_expert_5_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="9115.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_5 -> layer_2_expert_5_gate_proj	[pos="e,9241.7,2547.8 9378.5,2583.7 9337.9,2573.1 9292.8,2561.2 9251.5,2550.4"];
	layer_2_expert_5_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="9504.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_5 -> layer_2_expert_5_up_proj	[pos="e,9504.5,2548 9504.5,2583.6 9504.5,2575.5 9504.5,2566.7 9504.5,2558.2"];
	layer_2_expert_5_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="9504.5,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_5_gate_proj -> layer_2_expert_5_activation	[pos="e,9378.3,2443.8 9241.5,2479.7 9282.1,2469.1 9327.2,2457.2 9368.5,2446.4"];
	layer_2_expert_5_up_proj -> layer_2_expert_5_activation	[pos="e,9504.5,2444 9504.5,2479.6 9504.5,2471.5 9504.5,2462.7 9504.5,2454.2"];
	layer_2_expert_5_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 5",
		pos="10038,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_5_activation -> layer_2_expert_5_down_proj	[pos="e,9865.3,2339.8 9677.5,2375.7 9734.4,2364.8 9797.8,2352.7 9855.4,2341.7"];
	layer_2_expert_5_down_proj -> layer_2_expert_agg	[pos="e,11295,2198.2 10224,2289 10483,2267.1 10957,2227 11285,2199.1"];
	layer_2_expert_6_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="9893.5,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_6 -> layer_2_expert_6_gate_proj	[pos="e,10020,2547.8 10156,2583.7 10116,2573.1 10071,2561.2 10030,2550.4"];
	layer_2_expert_6_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="10282,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_6 -> layer_2_expert_6_up_proj	[pos="e,10282,2548 10282,2583.6 10282,2575.5 10282,2566.7 10282,2558.2"];
	layer_2_expert_6_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="10282,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_6_gate_proj -> layer_2_expert_6_activation	[pos="e,10156,2443.8 10020,2479.7 10060,2469.1 10105,2457.2 10146,2446.4"];
	layer_2_expert_6_up_proj -> layer_2_expert_6_activation	[pos="e,10282,2444 10282,2479.6 10282,2471.5 10282,2462.7 10282,2454.2"];
	layer_2_expert_6_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 6",
		pos="10720,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_6_activation -> layer_2_expert_6_down_proj	[pos="e,10578,2339.8 10424,2375.7 10470,2365 10521,2353 10568,2342.1"];
	layer_2_expert_6_down_proj -> layer_2_expert_agg	[pos="e,11322,2216.1 10905,2277.4 11021,2260.3 11175,2237.7 11311,2217.6"];
	layer_2_expert_7_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="10672,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_7 -> layer_2_expert_7_gate_proj	[pos="e,10798,2547.8 10934,2583.7 10894,2573.1 10849,2561.2 10808,2550.4"];
	layer_2_expert_7_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="11060,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_7 -> layer_2_expert_7_up_proj	[pos="e,11060,2548 11060,2583.6 11060,2575.5 11060,2566.7 11060,2558.2"];
	layer_2_expert_7_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="11060,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_7_gate_proj -> layer_2_expert_7_activation	[pos="e,10934,2443.8 10798,2479.7 10838,2469.1 10883,2457.2 10924,2446.4"];
	layer_2_expert_7_up_proj -> layer_2_expert_7_activation	[pos="e,11060,2444 11060,2479.6 11060,2471.5 11060,2462.7 11060,2454.2"];
	layer_2_expert_7_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 7",
		pos="11254,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_7_activation -> layer_2_expert_7_down_proj	[pos="e,11191,2339.9 11123,2375.6 11142,2365.7 11163,2354.8 11182,2344.6"];
	layer_2_expert_7_down_proj -> layer_2_expert_agg	[pos="e,11452,2235.7 11349,2271.6 11378,2261.7 11410,2250.5 11442,2239.1"];
	layer_2_expert_8_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="11450,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_8 -> layer_2_expert_8_gate_proj	[pos="e,11513,2547.9 11581,2583.6 11562,2573.7 11541,2562.8 11522,2552.6"];
	layer_2_expert_8_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="11838,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_8 -> layer_2_expert_8_up_proj	[pos="e,11775,2547.9 11707,2583.6 11726,2573.7 11747,2562.8 11766,2552.6"];
	layer_2_expert_8_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="11644,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_8_gate_proj -> layer_2_expert_8_activation	[pos="e,11580,2443.9 11512,2479.6 11531,2469.7 11552,2458.8 11571,2448.6"];
	layer_2_expert_8_up_proj -> layer_2_expert_8_activation	[pos="e,11707,2443.9 11775,2479.6 11756,2469.7 11735,2458.8 11716,2448.6"];
	layer_2_expert_8_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 8",
		pos="11644,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_8_activation -> layer_2_expert_8_down_proj	[pos="e,11644,2340 11644,2375.6 11644,2367.5 11644,2358.7 11644,2350.2"];
	layer_2_expert_8_down_proj -> layer_2_expert_agg	[pos="e,11644,2236 11644,2271.5 11644,2263.6 11644,2255 11644,2246.1"];
	layer_2_expert_9_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="12228,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_9 -> layer_2_expert_9_gate_proj	[pos="e,12228,2548 12228,2583.6 12228,2575.5 12228,2566.7 12228,2558.2"];
	layer_2_expert_9_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="12616,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_9 -> layer_2_expert_9_up_proj	[pos="e,12490,2547.8 12354,2583.7 12394,2573.1 12439,2561.2 12480,2550.4"];
	layer_2_expert_9_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="12228,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_9_gate_proj -> layer_2_expert_9_activation	[pos="e,12228,2444 12228,2479.6 12228,2471.5 12228,2462.7 12228,2454.2"];
	layer_2_expert_9_up_proj -> layer_2_expert_9_activation	[pos="e,12354,2443.8 12490,2479.7 12450,2469.1 12405,2457.2 12364,2446.4"];
	layer_2_expert_9_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 9",
		pos="12130,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_9_activation -> layer_2_expert_9_down_proj	[pos="e,12162,2340 12196,2375.6 12187,2366.6 12178,2356.8 12169,2347.4"];
	layer_2_expert_9_down_proj -> layer_2_expert_agg	[pos="e,11884,2235.8 12012,2271.7 11976,2261.6 11935,2250.1 11893,2238.5"];
	layer_2_expert_10_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="13006,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_10 -> layer_2_expert_10_gate_proj	[pos="e,13006,2548 13006,2583.6 13006,2575.5 13006,2566.7 13006,2558.2"];
	layer_2_expert_10_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="13394,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_10 -> layer_2_expert_10_up_proj	[pos="e,13268,2547.8 13132,2583.7 13172,2573.1 13217,2561.2 13258,2550.4"];
	layer_2_expert_10_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="13006,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_10_gate_proj -> layer_2_expert_10_activation	[pos="e,13006,2444 13006,2479.6 13006,2471.5 13006,2462.7 13006,2454.2"];
	layer_2_expert_10_up_proj -> layer_2_expert_10_activation	[pos="e,13132,2443.8 13268,2479.7 13228,2469.1 13183,2457.2 13142,2446.4"];
	layer_2_expert_10_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 10",
		pos="12762,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_10_activation -> layer_2_expert_10_down_proj	[pos="e,12841,2339.9 12927,2375.6 12902,2365.5 12876,2354.2 12851,2343.8"];
	layer_2_expert_10_down_proj -> layer_2_expert_agg	[pos="e,12126,2227.3 12577,2282.2 12456,2267.5 12292,2247.6 12136,2228.6"];
	layer_2_expert_11_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="13784,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_11 -> layer_2_expert_11_gate_proj	[pos="e,13784,2548 13784,2583.6 13784,2575.5 13784,2566.7 13784,2558.2"];
	layer_2_expert_11_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="14172,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_11 -> layer_2_expert_11_up_proj	[pos="e,14046,2547.8 13910,2583.7 13950,2573.1 13995,2561.2 14036,2550.4"];
	layer_2_expert_11_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="13784,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_11_gate_proj -> layer_2_expert_11_activation	[pos="e,13784,2444 13784,2479.6 13784,2471.5 13784,2462.7 13784,2454.2"];
	layer_2_expert_11_up_proj -> layer_2_expert_11_activation	[pos="e,13910,2443.8 14046,2479.7 14006,2469.1 13961,2457.2 13920,2446.4"];
	layer_2_expert_11_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 11",
		pos="13468,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_11_activation -> layer_2_expert_11_down_proj	[pos="e,13570,2339.8 13681,2375.6 13649,2365.2 13613,2353.6 13580,2342.9"];
	layer_2_expert_11_down_proj -> layer_2_expert_agg	[pos="e,12088,2201.9 13282,2290.9 13006,2270.3 12480,2231.1 12098,2202.6"];
	layer_2_expert_12_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="14562,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_12 -> layer_2_expert_12_gate_proj	[pos="e,14562,2548 14562,2583.6 14562,2575.5 14562,2566.7 14562,2558.2"];
	layer_2_expert_12_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="14950,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_12 -> layer_2_expert_12_up_proj	[pos="e,14824,2547.8 14688,2583.7 14728,2573.1 14773,2561.2 14814,2550.4"];
	layer_2_expert_12_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="14562,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_12_gate_proj -> layer_2_expert_12_activation	[pos="e,14562,2444 14562,2479.6 14562,2471.5 14562,2462.7 14562,2454.2"];
	layer_2_expert_12_up_proj -> layer_2_expert_12_activation	[pos="e,14688,2443.8 14824,2479.7 14784,2469.1 14739,2457.2 14698,2446.4"];
	layer_2_expert_12_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 12",
		pos="14210,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_12_activation -> layer_2_expert_12_down_proj	[pos="e,14324,2339.8 14447,2375.6 14411,2365.1 14370,2353.4 14333,2342.6"];
	layer_2_expert_12_down_proj -> layer_2_expert_agg	[pos="e,12069,2189.3 14024,2293.1 13918,2286.6 13783,2278.4 13662,2271.7 13117,2241.4 12488,2209.8 12079,2189.8"];
	layer_2_expert_13_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="15340,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_13 -> layer_2_expert_13_gate_proj	[pos="e,15340,2548 15340,2583.6 15340,2575.5 15340,2566.7 15340,2558.2"];
	layer_2_expert_13_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="15728,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_13 -> layer_2_expert_13_up_proj	[pos="e,15602,2547.8 15466,2583.7 15506,2573.1 15551,2561.2 15592,2550.4"];
	layer_2_expert_13_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="15340,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_13_gate_proj -> layer_2_expert_13_activation	[pos="e,15340,2444 15340,2479.6 15340,2471.5 15340,2462.7 15340,2454.2"];
	layer_2_expert_13_up_proj -> layer_2_expert_13_activation	[pos="e,15466,2443.8 15602,2479.7 15562,2469.1 15517,2457.2 15476,2446.4"];
	layer_2_expert_13_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 13",
		pos="14970,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_13_activation -> layer_2_expert_13_down_proj	[pos="e,15089,2339.8 15220,2375.7 15181,2365.1 15138,2353.3 15099,2342.5"];
	layer_2_expert_13_down_proj -> layer_2_expert_agg	[pos="e,12057,2181.5 14784,2292.9 14674,2286.1 14531,2277.8 14404,2271.7 13577,2232.2 12610,2199.1 12068,2181.8"];
	layer_2_expert_14_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="16118,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_14 -> layer_2_expert_14_gate_proj	[pos="e,16118,2548 16118,2583.6 16118,2575.5 16118,2566.7 16118,2558.2"];
	layer_2_expert_14_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="16506,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_14 -> layer_2_expert_14_up_proj	[pos="e,16380,2547.8 16244,2583.7 16284,2573.1 16329,2561.2 16370,2550.4"];
	layer_2_expert_14_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="16118,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_14_gate_proj -> layer_2_expert_14_activation	[pos="e,16118,2444 16118,2479.6 16118,2471.5 16118,2462.7 16118,2454.2"];
	layer_2_expert_14_up_proj -> layer_2_expert_14_activation	[pos="e,16244,2443.8 16380,2479.7 16340,2469.1 16295,2457.2 16254,2446.4"];
	layer_2_expert_14_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 14",
		pos="15552,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_14_activation -> layer_2_expert_14_down_proj	[pos="e,15736,2339.8 15934,2375.7 15874,2364.8 15807,2352.7 15746,2341.7"];
	layer_2_expert_14_down_proj -> layer_2_expert_agg	[pos="e,12045,2173.2 15367,2286.8 15303,2281.2 15230,2275.5 15164,2271.7 14041,2207.6 12713,2182.4 12055,2173.4"];
	layer_2_expert_15_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="16896,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_15 -> layer_2_expert_15_gate_proj	[pos="e,16896,2548 16896,2583.6 16896,2575.5 16896,2566.7 16896,2558.2"];
	layer_2_expert_15_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="17284,2513.7",
		style=filled,
		width=5.1528];
	layer_2_expert_15 -> layer_2_expert_15_up_proj	[pos="e,17158,2547.8 17022,2583.7 17062,2573.1 17107,2561.2 17148,2550.4"];
	layer_2_expert_15_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="16896,2409.7",
		style=filled,
		width=5.1528];
	layer_2_expert_15_gate_proj -> layer_2_expert_15_activation	[pos="e,16896,2444 16896,2479.6 16896,2471.5 16896,2462.7 16896,2454.2"];
	layer_2_expert_15_up_proj -> layer_2_expert_15_activation	[pos="e,17022,2443.8 17158,2479.7 17118,2469.1 17073,2457.2 17032,2446.4"];
	layer_2_expert_15_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 15",
		pos="16418,2305.7",
		style=filled,
		width=5.1528];
	layer_2_expert_15_activation -> layer_2_expert_15_down_proj	[pos="e,16573,2339.8 16741,2375.7 16690,2364.9 16634,2352.9 16583,2341.9"];
	layer_2_expert_15_down_proj -> layer_2_expert_agg	[pos="e,12049,2175.7 16233,2294.4 16098,2287.2 15912,2277.8 15748,2271.7 14399,2221.7 12800,2189.3 12059,2175.9"];
	layer_2_expert_agg -> layer_2_expert_residual	[pos="e,14433,2041.3 12011,2150.2 12637,2122.1 13893,2065.6 14423,2041.7"];
	layer_2_expert_layernorm	[fillcolor=lightgray,
		height=0.94444,
		label="Layer Norm (Post-Experts)
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="14668,1925.7",
		style=filled,
		width=6.5];
	layer_2_expert_residual -> layer_2_expert_layernorm	[pos="e,14668,1960 14668,1995.6 14668,1987.5 14668,1978.7 14668,1970.2"];
	layer_3_input	[fillcolor=lightyellow,
		height=1.4722,
		label="Layer 3 Input
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
GPU: all GPUs",
		pos="14668,1802.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_2_expert_layernorm -> layer_3_input	[pos="e,14668,1855.9 14668,1891.7 14668,1883.6 14668,1874.8 14668,1865.9"];
	layer_3_mha_qkv	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA QKV Projection
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, heads=16, \
d_k=512]
GPU: all GPUs",
		pos="14534,1679.7",
		style=filled,
		width=6.6806];
	layer_3_input -> layer_3_mha_qkv	[pos="e,14570,1713.8 14610,1749.7 14599,1740 14588,1730 14578,1720.8"];
	layer_3_mha_residual	[fillcolor=lightcoral,
		height=0.94444,
		label="MHA Residual Add
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_size=\
8192]
GPU: all GPUs",
		pos="14672,1367.7",
		style=filled,
		width=6.5];
	layer_3_input -> layer_3_mha_residual	[pos="e,14749,1401.8 14756,1749.6 14767,1739.2 14777,1727.2 14784,1713.7 14838,1603.9 14843,1544.8 14784,1437.7 14777,1426.1 14768,1416.3 \
14757,1407.9"];
	layer_3_mha_attention	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA Attention
Input: [batch_size=1024, seq_len=10000, heads=16, d_k=512]
Output: [batch_size=1024, seq_len=10000, hidden_size=8192]
\
GPU: all GPUs",
		pos="14536,1575.7",
		style=filled,
		width=6.5139];
	layer_3_mha_qkv -> layer_3_mha_attention	[pos="e,14536,1610 14534,1645.6 14535,1637.5 14535,1628.7 14535,1620.2"];
	layer_3_mha_proj	[fillcolor=lightgreen,
		height=0.94444,
		label="MHA Output Projection
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="14540,1471.7",
		style=filled,
		width=6.5];
	layer_3_mha_attention -> layer_3_mha_proj	[pos="e,14539,1506 14538,1541.6 14538,1533.5 14538,1524.7 14539,1516.2"];
	layer_3_mha_proj -> layer_3_mha_residual	[pos="e,14629,1402 14583,1437.6 14595,1428.3 14608,1418 14621,1408.3"];
	layer_3_mha_layernorm	[fillcolor=lightgray,
		height=0.94444,
		label="Layer Norm (Post-MHA)
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="14672,1263.7",
		style=filled,
		width=6.5];
	layer_3_mha_residual -> layer_3_mha_layernorm	[pos="e,14672,1298 14672,1333.6 14672,1325.5 14672,1316.7 14672,1308.2"];
	layer_3_gate	[fillcolor=orange,
		height=1.8889,
		label="Expert Gate
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, k=2]
GPU: all GPUs",
		pos="14170,1125.7",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_3_mha_layernorm -> layer_3_gate	[pos="e,14418,1193.8 14550,1229.7 14513,1219.6 14470,1208.1 14427,1196.5"];
	layer_3_token_split	[fillcolor=lightyellow,
		height=1.8889,
		label="Token Split by Expert
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192] \
per expert
GPU: all GPUs",
		pos="14170,953.74",
		shape=parallelogram,
		style=filled,
		width=13.132];
	layer_3_mha_layernorm -> layer_3_token_split	[pos="e,14592,1021.8 14679,1229.7 14688,1184.9 14695,1105 14652,1057.7 14642,1045.7 14624,1035 14601,1025.5"];
	layer_3_expert_residual	[fillcolor=lightcoral,
		height=0.94444,
		label="Expert Residual Add
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_size=\
8192]
GPU: all GPUs",
		pos="17188,227.74",
		style=filled,
		width=6.5];
	layer_3_mha_layernorm -> layer_3_expert_residual	[pos="e,17423,239.17 14906,1261.7 15938,1255.6 20024,1215 20024,954.74 20024,954.74 20024,954.74 20024,502.74 20024,373.05 18121,271.94 \
17433,239.64"];
	layer_3_gate -> layer_3_token_split	[pos="e,14170,1022 14170,1057.6 14170,1049.2 14170,1040.7 14170,1032.2",
		style=dashed];
	layer_3_expert_0	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 0
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 0",
		pos="8140.5,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_0	[pos="e,8326.2,829.01 13790,950.45 12902,944.05 10626,921.41 8724.5,849.74 8595.1,844.86 8449.7,836.65 8336.3,829.65"];
	layer_3_expert_1	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 1
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 1",
		pos="8918.5,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_1	[pos="e,9104.2,828.87 13787,948.74 12990,939.44 11093,912.2 9502.5,849.74 9373.1,844.66 9227.7,836.45 9114.3,829.49"];
	layer_3_expert_2	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 2
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 2",
		pos="9696.5,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_2	[pos="e,9882.2,828.66 13784,946.34 13085,933.91 11563,902.94 10280,849.74 10151,844.37 10006,836.16 9892.4,829.28"];
	layer_3_expert_3	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 3
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 3",
		pos="10474,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_3	[pos="e,10660,828.34 13779,942.71 13189,926.94 12037,893.56 11058,849.74 10929,843.94 10784,835.73 10670,828.95"];
	layer_3_expert_4	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 4
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 4",
		pos="11252,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_4	[pos="e,11438,827.82 13770,936.57 13305,917.45 12515,883.89 11836,849.74 11707,843.23 11562,835.02 11448,828.41"];
	layer_3_expert_5	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 5
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 5",
		pos="12030,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_5	[pos="e,12216,828.54 13756,926.38 13295,897.11 12571,851.12 12226,829.18"];
	layer_3_expert_6	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 6
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 6",
		pos="12808,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_6	[pos="e,12994,835.26 13731,908.82 13486,884.36 13193,855.13 13004,836.27"];
	layer_3_expert_7	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 7
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 7",
		pos="13586,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_7	[pos="e,13728,849.78 13883,885.74 13833,874.11 13783,862.45 13738,852.1"];
	layer_3_expert_8	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 8
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 8",
		pos="14170,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_8	[pos="e,14170,849.76 14170,885.54 14170,876.78 14170,868.02 14170,859.81"];
	layer_3_expert_9	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 9
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 9",
		pos="14754,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_9	[pos="e,14612,849.75 14452,887.13 14504,875.02 14556,862.8 14602,852.03"];
	layer_3_expert_10	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 10
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 10",
		pos="15532,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_10	[pos="e,15346,835.29 14499,919.95 14760,893.82 15117,858.12 15336,836.29"];
	layer_3_expert_11	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 11
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 11",
		pos="16310,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_11	[pos="e,16124,828.54 14514,930.89 14968,902.06 15750,852.29 16114,829.19"];
	layer_3_expert_12	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 12
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 12",
		pos="17088,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_12	[pos="e,16902,827.84 14525,938.47 14982,919.74 15803,885.07 16504,849.74 16633,843.24 16778,835.04 16892,828.44"];
	layer_3_expert_13	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 13
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 13",
		pos="17866,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_13	[pos="e,17680,828.37 14532,943.53 15112,928.12 16287,894.37 17282,849.74 17412,843.95 17557,835.75 17670,828.98"];
	layer_3_expert_14	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 14
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 14",
		pos="18644,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_14	[pos="e,18458,828.68 14537,946.71 15226,934.55 16765,903.53 18060,849.74 18190,844.38 18335,836.18 18448,829.3"];
	layer_3_expert_15	[fillcolor=lightcyan,
		height=0.94444,
		label="Expert 15
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, hidden_size=8192]
GPU: 15",
		pos="19422,815.74",
		style=filled,
		width=5.1528];
	layer_3_token_split -> layer_3_expert_15	[pos="e,19236,828.89 14540,948.92 15329,939.79 17239,912.65 18838,849.74 18968,844.67 19113,836.47 19226,829.51"];
	layer_3_expert_0_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="7751.5,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_0 -> layer_3_expert_0_gate_proj	[pos="e,7877.7,745.82 8014.5,781.69 7973.9,771.05 7928.8,759.22 7887.5,748.4"];
	layer_3_expert_0_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="8140.5,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_0 -> layer_3_expert_0_up_proj	[pos="e,8140.5,746.04 8140.5,781.62 8140.5,773.52 8140.5,764.72 8140.5,756.21"];
	layer_3_expert_0_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 0",
		pos="8140.5,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_0_gate_proj -> layer_3_expert_0_activation	[pos="e,8014.3,641.82 7877.5,677.69 7918.1,667.05 7963.2,655.22 8004.5,644.4"];
	layer_3_expert_0_up_proj -> layer_3_expert_0_activation	[pos="e,8140.5,642.04 8140.5,677.62 8140.5,669.52 8140.5,660.72 8140.5,652.21"];
	layer_3_expert_0_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 0 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 0",
		pos="8147.5,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_0_activation -> layer_3_expert_0_down_proj	[pos="e,8145.2,538.04 8142.8,573.62 8143.3,565.52 8143.9,556.72 8144.5,548.21"];
	layer_3_expert_agg	[fillcolor=lightyellow,
		height=1.8889,
		label="Expert Output Aggregation
Input: [batch_size=variable, hidden_size=8192] from all experts
Output: [batch_size=1024, seq_len=10000, \
hidden_size=8192]
GPU: all GPUs",
		pos="14358,365.74",
		shape=parallelogram,
		style=filled,
		width=13.737];
	layer_3_expert_0_down_proj -> layer_3_expert_agg	[pos="e,13979,375.05 8333.4,498.67 9190.9,479.89 12774,401.43 13969,375.27"];
	layer_3_expert_1_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="8529.5,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_1 -> layer_3_expert_1_gate_proj	[pos="e,8655.7,745.82 8792.5,781.69 8751.9,771.05 8706.8,759.22 8665.5,748.4"];
	layer_3_expert_1_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="8918.5,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_1 -> layer_3_expert_1_up_proj	[pos="e,8918.5,746.04 8918.5,781.62 8918.5,773.52 8918.5,764.72 8918.5,756.21"];
	layer_3_expert_1_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 1",
		pos="8918.5,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_1_gate_proj -> layer_3_expert_1_activation	[pos="e,8792.3,641.82 8655.5,677.69 8696.1,667.05 8741.2,655.22 8782.5,644.4"];
	layer_3_expert_1_up_proj -> layer_3_expert_1_activation	[pos="e,8918.5,642.04 8918.5,677.62 8918.5,669.52 8918.5,660.72 8918.5,652.21"];
	layer_3_expert_1_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 1 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 1",
		pos="10092,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_1_activation -> layer_3_expert_1_down_proj	[pos="e,9906.8,520.88 9104.2,590.61 9320.5,571.82 9676.2,540.91 9896.7,521.75"];
	layer_3_expert_1_down_proj -> layer_3_expert_agg	[pos="e,13983,378.15 10278,496.3 10474,489.54 10791,478.67 11066,469.74 12117,435.45 13358,397.25 13973,378.47"];
	layer_3_expert_2_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="9307.5,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_2 -> layer_3_expert_2_gate_proj	[pos="e,9433.7,745.82 9570.5,781.69 9529.9,771.05 9484.8,759.22 9443.5,748.4"];
	layer_3_expert_2_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="9696.5,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_2 -> layer_3_expert_2_up_proj	[pos="e,9696.5,746.04 9696.5,781.62 9696.5,773.52 9696.5,764.72 9696.5,756.21"];
	layer_3_expert_2_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 2",
		pos="9696.5,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_2_gate_proj -> layer_3_expert_2_activation	[pos="e,9570.3,641.82 9433.5,677.69 9474.1,667.05 9519.2,655.22 9560.5,644.4"];
	layer_3_expert_2_up_proj -> layer_3_expert_2_activation	[pos="e,9696.5,642.04 9696.5,677.62 9696.5,669.52 9696.5,660.72 9696.5,652.21"];
	layer_3_expert_2_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 2 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 2",
		pos="11260,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_2_activation -> layer_3_expert_2_down_proj	[pos="e,11074,516.86 9882.3,594.61 10180,575.21 10760,537.34 11064,517.53"];
	layer_3_expert_2_down_proj -> layer_3_expert_agg	[pos="e,13986,380.18 11445,491.51 11560,484.75 11710,476.23 11844,469.74 12599,432.91 13483,398.78 13976,380.55"];
	layer_3_expert_3_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="10086,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_3 -> layer_3_expert_3_gate_proj	[pos="e,10212,745.82 10348,781.69 10308,771.05 10263,759.22 10222,748.4"];
	layer_3_expert_3_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="10474,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_3 -> layer_3_expert_3_up_proj	[pos="e,10474,746.04 10474,781.62 10474,773.52 10474,764.72 10474,756.21"];
	layer_3_expert_3_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 3",
		pos="10474,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_3_gate_proj -> layer_3_expert_3_activation	[pos="e,10348,641.82 10212,677.69 10252,667.05 10297,655.22 10338,644.4"];
	layer_3_expert_3_up_proj -> layer_3_expert_3_activation	[pos="e,10474,642.04 10474,677.62 10474,669.52 10474,660.72 10474,652.21"];
	layer_3_expert_3_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 3 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 3",
		pos="12038,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_3_activation -> layer_3_expert_3_down_proj	[pos="e,11852,516.86 10660,594.61 10958,575.21 11538,537.34 11842,517.53"];
	layer_3_expert_3_down_proj -> layer_3_expert_agg	[pos="e,13991,382.92 12223,485.77 12288,480.22 12360,474.32 12426,469.74 12966,432.49 13591,401.36 13981,383.38"];
	layer_3_expert_4_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="10864,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_4 -> layer_3_expert_4_gate_proj	[pos="e,10990,745.82 11126,781.69 11086,771.05 11041,759.22 11000,748.4"];
	layer_3_expert_4_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="11252,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_4 -> layer_3_expert_4_up_proj	[pos="e,11252,746.04 11252,781.62 11252,773.52 11252,764.72 11252,756.21"];
	layer_3_expert_4_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 4",
		pos="11252,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_4_gate_proj -> layer_3_expert_4_activation	[pos="e,11126,641.82 10990,677.69 11030,667.05 11075,655.22 11116,644.4"];
	layer_3_expert_4_up_proj -> layer_3_expert_4_activation	[pos="e,11252,642.04 11252,677.62 11252,669.52 11252,660.72 11252,652.21"];
	layer_3_expert_4_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 4 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 4",
		pos="12620,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_4_activation -> layer_3_expert_4_down_proj	[pos="e,12435,521.11 11438,594.48 11635,581.26 11956,559.23 12232,537.74 12295,532.89 12363,527.23 12424,521.98"];
	layer_3_expert_4_down_proj -> layer_3_expert_agg	[pos="e,13998,388.24 12806,480.59 12841,476.71 12878,472.91 12912,469.74 13278,436.11 13696,407.4 13988,388.9"];
	layer_3_expert_5_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="11642,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_5 -> layer_3_expert_5_gate_proj	[pos="e,11768,745.82 11904,781.69 11864,771.05 11819,759.22 11778,748.4"];
	layer_3_expert_5_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="12030,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_5 -> layer_3_expert_5_up_proj	[pos="e,12030,746.04 12030,781.62 12030,773.52 12030,764.72 12030,756.21"];
	layer_3_expert_5_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 5",
		pos="12030,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_5_gate_proj -> layer_3_expert_5_activation	[pos="e,11904,641.82 11768,677.69 11808,667.05 11853,655.22 11894,644.4"];
	layer_3_expert_5_up_proj -> layer_3_expert_5_activation	[pos="e,12030,642.04 12030,677.62 12030,669.52 12030,660.72 12030,652.21"];
	layer_3_expert_5_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 5 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 5",
		pos="13106,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_5_activation -> layer_3_expert_5_down_proj	[pos="e,12921,526.52 12216,591.75 12375,578.58 12611,558.36 12816,537.74 12846,534.65 12879,531.17 12910,527.66"];
	layer_3_expert_5_down_proj -> layer_3_expert_agg	[pos="e,14015,399.07 13292,476.98 13312,474.44 13332,471.98 13350,469.74 13567,443.99 13811,418.98 14005,400.05"];
	layer_3_expert_6_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="12420,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_6 -> layer_3_expert_6_gate_proj	[pos="e,12546,745.82 12682,781.69 12642,771.05 12597,759.22 12556,748.4"];
	layer_3_expert_6_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="12808,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_6 -> layer_3_expert_6_up_proj	[pos="e,12808,746.04 12808,781.62 12808,773.52 12808,764.72 12808,756.21"];
	layer_3_expert_6_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 6",
		pos="12808,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_6_gate_proj -> layer_3_expert_6_activation	[pos="e,12682,641.82 12546,677.69 12586,667.05 12631,655.22 12672,644.4"];
	layer_3_expert_6_up_proj -> layer_3_expert_6_activation	[pos="e,12808,642.04 12808,677.62 12808,669.52 12808,660.72 12808,652.21"];
	layer_3_expert_6_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 6 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 6",
		pos="13544,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_6_activation -> layer_3_expert_6_down_proj	[pos="e,13359,530.47 12994,581 13102,566.01 13239,547.12 13349,531.89"];
	layer_3_expert_6_down_proj -> layer_3_expert_agg	[pos="e,14044,419.24 13730,471.71 13820,456.67 13931,438.17 14034,420.91"];
	layer_3_expert_7_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="13198,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_7 -> layer_3_expert_7_gate_proj	[pos="e,13324,745.82 13460,781.69 13420,771.05 13375,759.22 13334,748.4"];
	layer_3_expert_7_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="13586,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_7 -> layer_3_expert_7_up_proj	[pos="e,13586,746.04 13586,781.62 13586,773.52 13586,764.72 13586,756.21"];
	layer_3_expert_7_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 7",
		pos="13586,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_7_gate_proj -> layer_3_expert_7_activation	[pos="e,13460,641.82 13324,677.69 13364,667.05 13409,655.22 13450,644.4"];
	layer_3_expert_7_up_proj -> layer_3_expert_7_activation	[pos="e,13586,642.04 13586,677.62 13586,669.52 13586,660.72 13586,652.21"];
	layer_3_expert_7_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 7 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 7",
		pos="13958,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_7_activation -> layer_3_expert_7_down_proj	[pos="e,13837,537.82 13707,573.69 13745,563.1 13788,551.32 13827,540.54"];
	layer_3_expert_7_down_proj -> layer_3_expert_agg	[pos="e,14161,433.82 14055,469.73 14084,459.78 14118,448.45 14151,437.04"];
	layer_3_expert_8_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="13976,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_8 -> layer_3_expert_8_gate_proj	[pos="e,14039,745.86 14107,781.62 14088,771.73 14067,760.81 14048,750.64"];
	layer_3_expert_8_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="14364,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_8 -> layer_3_expert_8_up_proj	[pos="e,14301,745.86 14233,781.62 14252,771.73 14273,760.81 14292,750.64"];
	layer_3_expert_8_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 8",
		pos="14358,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_8_gate_proj -> layer_3_expert_8_activation	[pos="e,14234,641.82 14100,677.69 14140,667.05 14184,655.22 14225,644.4"];
	layer_3_expert_8_up_proj -> layer_3_expert_8_activation	[pos="e,14360,642.04 14363,677.62 14362,669.52 14362,660.72 14361,652.21"];
	layer_3_expert_8_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 8 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 8",
		pos="14358,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_8_activation -> layer_3_expert_8_down_proj	[pos="e,14358,538.04 14358,573.62 14358,565.52 14358,556.72 14358,548.21"];
	layer_3_expert_8_down_proj -> layer_3_expert_agg	[pos="e,14358,434 14358,469.47 14358,461.64 14358,452.98 14358,444.09"];
	layer_3_expert_9_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="14754,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_9 -> layer_3_expert_9_gate_proj	[pos="e,14754,746.04 14754,781.62 14754,773.52 14754,764.72 14754,756.21"];
	layer_3_expert_9_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="15142,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_9 -> layer_3_expert_9_up_proj	[pos="e,15016,745.82 14880,781.69 14920,771.05 14965,759.22 15006,748.4"];
	layer_3_expert_9_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 9",
		pos="14754,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_9_gate_proj -> layer_3_expert_9_activation	[pos="e,14754,642.04 14754,677.62 14754,669.52 14754,660.72 14754,652.21"];
	layer_3_expert_9_up_proj -> layer_3_expert_9_activation	[pos="e,14880,641.82 15016,677.69 14976,667.05 14931,655.22 14890,644.4"];
	layer_3_expert_9_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 9 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 9",
		pos="14750,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_9_activation -> layer_3_expert_9_down_proj	[pos="e,14751,538.04 14753,573.62 14752,565.52 14752,556.72 14752,548.21"];
	layer_3_expert_9_down_proj -> layer_3_expert_agg	[pos="e,14552,433.82 14655,469.73 14627,459.82 14594,448.55 14562,437.18"];
	layer_3_expert_10_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="15532,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_10 -> layer_3_expert_10_gate_proj	[pos="e,15532,746.04 15532,781.62 15532,773.52 15532,764.72 15532,756.21"];
	layer_3_expert_10_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="15920,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_10 -> layer_3_expert_10_up_proj	[pos="e,15794,745.82 15658,781.69 15698,771.05 15743,759.22 15784,748.4"];
	layer_3_expert_10_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 10",
		pos="15532,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_10_gate_proj -> layer_3_expert_10_activation	[pos="e,15532,642.04 15532,677.62 15532,669.52 15532,660.72 15532,652.21"];
	layer_3_expert_10_up_proj -> layer_3_expert_10_activation	[pos="e,15658,641.82 15794,677.69 15754,667.05 15709,655.22 15668,644.4"];
	layer_3_expert_10_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 10 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 10",
		pos="15336,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_10_activation -> layer_3_expert_10_down_proj	[pos="e,15399,537.86 15468,573.62 15449,563.69 15428,552.71 15408,542.5"];
	layer_3_expert_10_down_proj -> layer_3_expert_agg	[pos="e,14840,433.75 15150,476.88 15064,464.9 14957,450.03 14850,435.14"];
	layer_3_expert_11_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="16310,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_11 -> layer_3_expert_11_gate_proj	[pos="e,16310,746.04 16310,781.62 16310,773.52 16310,764.72 16310,756.21"];
	layer_3_expert_11_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="16698,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_11 -> layer_3_expert_11_up_proj	[pos="e,16572,745.82 16436,781.69 16476,771.05 16521,759.22 16562,748.4"];
	layer_3_expert_11_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 11",
		pos="16310,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_11_gate_proj -> layer_3_expert_11_activation	[pos="e,16310,642.04 16310,677.62 16310,669.52 16310,660.72 16310,652.21"];
	layer_3_expert_11_up_proj -> layer_3_expert_11_activation	[pos="e,16436,641.82 16572,677.69 16532,667.05 16487,655.22 16446,644.4"];
	layer_3_expert_11_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 11 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 11",
		pos="16018,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_11_activation -> layer_3_expert_11_down_proj	[pos="e,16112,537.86 16215,573.62 16185,563.28 16152,551.82 16122,541.26"];
	layer_3_expert_11_down_proj -> layer_3_expert_agg	[pos="e,14809,403.64 15832,487.5 15588,467.55 15153,431.9 14819,404.49"];
	layer_3_expert_12_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="17088,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_12 -> layer_3_expert_12_gate_proj	[pos="e,17088,746.04 17088,781.62 17088,773.52 17088,764.72 17088,756.21"];
	layer_3_expert_12_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="17476,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_12 -> layer_3_expert_12_up_proj	[pos="e,17350,745.82 17214,781.69 17254,771.05 17299,759.22 17340,748.4"];
	layer_3_expert_12_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 12",
		pos="17088,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_12_gate_proj -> layer_3_expert_12_activation	[pos="e,17088,642.04 17088,677.62 17088,669.52 17088,660.72 17088,652.21"];
	layer_3_expert_12_up_proj -> layer_3_expert_12_activation	[pos="e,17214,641.82 17350,677.69 17310,667.05 17265,655.22 17224,644.4"];
	layer_3_expert_12_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 12 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 12",
		pos="16894,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_12_activation -> layer_3_expert_12_down_proj	[pos="e,16957,537.86 17025,573.62 17006,563.73 16985,552.81 16966,542.64"];
	layer_3_expert_12_down_proj -> layer_3_expert_agg	[pos="e,14788,389.77 16708,492.78 16309,471.38 15360,420.48 14798,390.32"];
	layer_3_expert_13_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="17866,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_13 -> layer_3_expert_13_gate_proj	[pos="e,17866,746.04 17866,781.62 17866,773.52 17866,764.72 17866,756.21"];
	layer_3_expert_13_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="18254,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_13 -> layer_3_expert_13_up_proj	[pos="e,18128,745.82 17992,781.69 18032,771.05 18077,759.22 18118,748.4"];
	layer_3_expert_13_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 13",
		pos="17866,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_13_gate_proj -> layer_3_expert_13_activation	[pos="e,17866,642.04 17866,677.62 17866,669.52 17866,660.72 17866,652.21"];
	layer_3_expert_13_up_proj -> layer_3_expert_13_activation	[pos="e,17992,641.82 18128,677.69 18088,667.05 18043,655.22 18002,644.4"];
	layer_3_expert_13_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 13 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 13",
		pos="17574,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_13_activation -> layer_3_expert_13_down_proj	[pos="e,17669,537.86 17771,573.62 17742,563.28 17709,551.82 17679,541.26"];
	layer_3_expert_13_down_proj -> layer_3_expert_agg	[pos="e,14771,378.43 17389,488.82 17298,482.36 17188,474.98 17088,469.74 16272,426.64 15318,394.89 14781,378.74"];
	layer_3_expert_14_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="18644,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_14 -> layer_3_expert_14_gate_proj	[pos="e,18644,746.04 18644,781.62 18644,773.52 18644,764.72 18644,756.21"];
	layer_3_expert_14_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="19032,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_14 -> layer_3_expert_14_up_proj	[pos="e,18906,745.82 18770,781.69 18810,771.05 18855,759.22 18896,748.4"];
	layer_3_expert_14_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 14",
		pos="18644,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_14_gate_proj -> layer_3_expert_14_activation	[pos="e,18644,642.04 18644,677.62 18644,669.52 18644,660.72 18644,652.21"];
	layer_3_expert_14_up_proj -> layer_3_expert_14_activation	[pos="e,18770,641.82 18906,677.69 18866,667.05 18821,655.22 18780,644.4"];
	layer_3_expert_14_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 14 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 14",
		pos="18158,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_14_activation -> layer_3_expert_14_down_proj	[pos="e,18315,537.82 18486,573.69 18435,562.9 18377,550.87 18325,539.92"];
	layer_3_expert_14_down_proj -> layer_3_expert_agg	[pos="e,14761,371.78 17972,484.85 17908,479.25 17835,473.54 17770,469.74 16689,407.52 15413,381.65 14772,371.93"];
	layer_3_expert_15_gate_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Gate Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="19422,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_15 -> layer_3_expert_15_gate_proj	[pos="e,19422,746.04 19422,781.62 19422,773.52 19422,764.72 19422,756.21"];
	layer_3_expert_15_up_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Up Proj
Input: [batch_size=variable, hidden_size=8192]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="19810,711.74",
		style=filled,
		width=5.1528];
	layer_3_expert_15 -> layer_3_expert_15_up_proj	[pos="e,19684,745.82 19548,781.69 19588,771.05 19633,759.22 19674,748.4"];
	layer_3_expert_15_activation	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 GELU Activation
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, ffn_hidden=32768]
GPU: 15",
		pos="19422,607.74",
		style=filled,
		width=5.1528];
	layer_3_expert_15_gate_proj -> layer_3_expert_15_activation	[pos="e,19422,642.04 19422,677.62 19422,669.52 19422,660.72 19422,652.21"];
	layer_3_expert_15_up_proj -> layer_3_expert_15_activation	[pos="e,19548,641.82 19684,677.69 19644,667.05 19599,655.22 19558,644.4"];
	layer_3_expert_15_down_proj	[fillcolor=lightsteelblue,
		height=0.94444,
		label="Expert 15 Down Proj
Input: [batch_size=variable, ffn_hidden=32768]
Output: [batch_size=variable, hidden_size=8192]
GPU: 15",
		pos="18984,503.74",
		style=filled,
		width=5.1528];
	layer_3_expert_15_activation -> layer_3_expert_15_down_proj	[pos="e,19126,537.82 19280,573.69 19234,562.97 19183,551.02 19136,540.13"];
	layer_3_expert_15_down_proj -> layer_3_expert_agg	[pos="e,14764,373.66 18799,491.76 18673,484.63 18503,475.6 18352,469.74 17047,418.83 15500,387.07 14774,373.85"];
	layer_3_expert_agg -> layer_3_expert_residual	[pos="e,16954,240 14724,347.15 15311,318.97 16446,264.43 16944,240.49"];
	layer_3_expert_layernorm	[fillcolor=lightgray,
		height=0.94444,
		label="Layer Norm (Post-Experts)
Input: [batch_size=1024, seq_len=10000, hidden_size=8192]
Output: [batch_size=1024, seq_len=10000, hidden_\
size=8192]
GPU: all GPUs",
		pos="17188,123.74",
		style=filled,
		width=6.5];
	layer_3_expert_residual -> layer_3_expert_layernorm	[pos="e,17188,158.04 17188,193.62 17188,185.52 17188,176.72 17188,168.21"];
	output	[fillcolor=lightblue,
		height=0.74639,
		label="Model Output
Output: [batch_size=1024, seq_len=10000, hidden_size=8192]",
		pos="17188,26.87",
		shape=ellipse,
		style=filled,
		width=9.1924];
	layer_3_expert_layernorm -> output	[pos="e,17188,54.009 17188,89.559 17188,81.369 17188,72.554 17188,64.222"];
}
