// Helix Two-Level Partitioning: 4x4 Grid on 16 GPUs
digraph Helix_Partitioning_Scheme {
	rankdir=LR ranksep=1.5 splines=ortho
	node [fontname=Arial fontsize=12]
	input_tensor [label="Input Tensor\n[1024, 10000, 8192]" fillcolor=lightblue shape=ellipse style=filled]
	partition_heads [label="Head-Level Partitioning\n16 heads → 4 groups\n4 heads per group" fillcolor=yellow shape=rectangle style=filled]
	partition_dims [label="Intra-Head Dimension Partitioning\n512 dim/head → 4 segments\n128 dim per segment" fillcolor=yellow shape=rectangle style=filled]
	subgraph cluster_gpu_grid {
		color=red label="16 GPU Grid (4×4)" style=dashed
		gpu_0 [label="GPU 0\nHead Group 0\nDim Segment 0\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_1 [label="GPU 1\nHead Group 0\nDim Segment 1\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_2 [label="GPU 2\nHead Group 0\nDim Segment 2\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_3 [label="GPU 3\nHead Group 0\nDim Segment 3\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_4 [label="GPU 4\nHead Group 1\nDim Segment 0\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_5 [label="GPU 5\nHead Group 1\nDim Segment 1\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_6 [label="GPU 6\nHead Group 1\nDim Segment 2\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_7 [label="GPU 7\nHead Group 1\nDim Segment 3\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_8 [label="GPU 8\nHead Group 2\nDim Segment 0\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_9 [label="GPU 9\nHead Group 2\nDim Segment 1\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_10 [label="GPU 10\nHead Group 2\nDim Segment 2\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_11 [label="GPU 11\nHead Group 2\nDim Segment 3\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_12 [label="GPU 12\nHead Group 3\nDim Segment 0\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_13 [label="GPU 13\nHead Group 3\nDim Segment 1\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_14 [label="GPU 14\nHead Group 3\nDim Segment 2\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
		gpu_15 [label="GPU 15\nHead Group 3\nDim Segment 3\n4 heads × 128 dim" fillcolor=lightgreen shape=box style=filled]
	}
	input_tensor -> partition_heads
	partition_heads -> partition_dims
	partition_dims -> gpu_0
	gpu_0 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_1 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_2 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_3 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_4 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_5 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_6 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_7 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_8 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_9 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_10 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_11 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_12 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_13 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_14 -> output_aggregation [ltail=cluster_gpu_grid]
	gpu_15 -> output_aggregation [ltail=cluster_gpu_grid]
	output_aggregation [label="Output Aggregation\nHierarchical Concatenation" fillcolor=orange shape=parallelogram style=filled]
	final_output [label="Final Output\n[1024, 10000, 8192]" fillcolor=lightblue shape=ellipse style=filled]
	output_aggregation -> final_output
}
