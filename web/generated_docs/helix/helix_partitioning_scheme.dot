digraph Helix_Partitioning_Scheme {
	graph [bb="0,0,1697,1285",
		rankdir=LR,
		ranksep=1.5,
		splines=ortho
	];
	node [fontname=Arial,
		fontsize=12,
		label="\N"
	];
	subgraph cluster_gpu_grid {
		graph [bb="828.53,8,980.53,1277",
			color=red,
			label="16 GPU Grid (4×4)",
			lheight=0.21,
			lp="904.53,1265.5",
			lwidth=1.89,
			style=dashed
		];
		gpu_0	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 0\nHead Group 0\nDim Segment 0\n4 heads × 128 dim",
			pos="904.03,1216",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_1	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 1\nHead Group 0\nDim Segment 1\n4 heads × 128 dim",
			pos="904.03,1138",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_2	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 2\nHead Group 0\nDim Segment 2\n4 heads × 128 dim",
			pos="904.03,1060",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_3	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 3\nHead Group 0\nDim Segment 3\n4 heads × 128 dim",
			pos="904.03,982",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_4	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 4\nHead Group 1\nDim Segment 0\n4 heads × 128 dim",
			pos="904.03,904",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_5	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 5\nHead Group 1\nDim Segment 1\n4 heads × 128 dim",
			pos="904.03,826",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_6	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 6\nHead Group 1\nDim Segment 2\n4 heads × 128 dim",
			pos="904.03,748",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_7	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 7\nHead Group 1\nDim Segment 3\n4 heads × 128 dim",
			pos="904.03,670",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_8	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 8\nHead Group 2\nDim Segment 0\n4 heads × 128 dim",
			pos="904.03,592",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_9	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 9\nHead Group 2\nDim Segment 1\n4 heads × 128 dim",
			pos="904.03,514",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_10	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 10\nHead Group 2\nDim Segment 2\n4 heads × 128 dim",
			pos="904.03,436",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_11	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 11\nHead Group 2\nDim Segment 3\n4 heads × 128 dim",
			pos="904.03,358",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_12	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 12\nHead Group 3\nDim Segment 0\n4 heads × 128 dim",
			pos="904.03,280",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_13	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 13\nHead Group 3\nDim Segment 1\n4 heads × 128 dim",
			pos="904.03,202",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_14	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 14\nHead Group 3\nDim Segment 2\n4 heads × 128 dim",
			pos="904.03,124",
			shape=box,
			style=filled,
			width=1.5972];
		gpu_15	[fillcolor=lightgreen,
			height=0.83333,
			label="GPU 15\nHead Group 3\nDim Segment 3\n4 heads × 128 dim",
			pos="904.03,46",
			shape=box,
			style=filled,
			width=1.5972];
	}
	input_tensor	[fillcolor=lightblue,
		height=0.66782,
		label="Input Tensor\n[1024, 10000, 8192]",
		pos="86.267,1216",
		shape=ellipse,
		style=filled,
		width=2.3963];
	partition_heads	[fillcolor=yellow,
		height=0.65278,
		label="Head-Level Partitioning\n16 heads → 4 groups\n4 heads per group",
		pos="352.03,1216",
		shape=rectangle,
		style=filled,
		width=1.9861];
	input_tensor -> partition_heads	[pos="e,280.4,1216 172.55,1216 172.55,1216 270.4,1216 270.4,1216"];
	partition_dims	[fillcolor=yellow,
		height=0.65278,
		label="Intra-Head Dimension Partitioning\n512 dim/head → 4 segments\n128 dim per segment",
		pos="630.03,1216",
		shape=rectangle,
		style=filled,
		width=2.7361];
	partition_heads -> partition_dims	[pos="e,531.45,1216 423.63,1216 423.63,1216 521.45,1216 521.45,1216"];
	partition_dims -> gpu_0	[pos="e,846.16,1216 728.57,1216 728.57,1216 836.16,1216 836.16,1216"];
	output_aggregation	[fillcolor=orange,
		height=0.94444,
		label="Output Aggregation\nHierarchical Concatenation",
		pos="1248.5,631",
		shape=parallelogram,
		style=filled,
		width=4.6654];
	gpu_0 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1375,665.41 961.78,1216 1087.5,1216 1375,1216 1375,1216 1375,1216 1375,675.41 1375,675.41"];
	gpu_1 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1333,665.05 961.88,1138 1079,1138 1333,1138 1333,1138 1333,1138 1333,675.05 1333,675.05"];
	gpu_2 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1291,665.02 961.55,1060 1069.3,1060 1291,1060 1291,1060 1291,1060 1291,675.02 1291,675.02"];
	gpu_3 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1249,665.29 961.77,982 1060,982 1249,982 1249,982 1249,982 1249,675.29 1249,675.29"];
	gpu_4 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1207,665.02 961.73,904 1049.6,904 1207,904 1207,904 1207,904 1207,675.02 1207,675.02"];
	gpu_5 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1165,665.41 961.62,826 1038.5,826 1165,826 1165,826 1165,826 1165,675.41 1165,675.41"];
	gpu_6 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1123,639.04 961.56,748 1026.4,748 1123,748 1123,748 1123,748 1123,649.04 1123,649.04"];
	gpu_7 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1136.6,652.5 961.69,652.5 961.69,652.5 1126.6,652.5 1126.6,652.5"];
	gpu_8 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1092.9,609.5 961.69,609.5 961.69,609.5 1082.9,609.5 1082.9,609.5"];
	gpu_9 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1123,596.84 961.56,514 1026.4,514 1123,514 1123,514 1123,514 1123,586.84 1123,586.84"];
	gpu_10 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1165,596.59 961.62,436 1038.5,436 1165,436 1165,436 1165,436 1165,586.59 1165,586.59"];
	gpu_11 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1207,596.98 961.73,358 1049.6,358 1207,358 1207,358 1207,358 1207,586.98 1207,586.98"];
	gpu_12 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1249,596.71 961.77,280 1060,280 1249,280 1249,280 1249,280 1249,586.71 1249,586.71"];
	gpu_13 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1291,596.98 961.55,202 1069.3,202 1291,202 1291,202 1291,202 1291,586.98 1291,586.98"];
	gpu_14 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1333,596.95 961.88,124 1079,124 1333,124 1333,124 1333,124 1333,586.95 1333,586.95"];
	gpu_15 -> output_aggregation	[ltail=cluster_gpu_grid,
		pos="e,1375,623.6 961.78,46 1087.5,46 1375,46 1375,46 1375,46 1375,613.6 1375,613.6"];
	final_output	[fillcolor=lightblue,
		height=0.66782,
		label="Final Output\n[1024, 10000, 8192]",
		pos="1610.7,631",
		shape=ellipse,
		style=filled,
		width=2.3963];
	output_aggregation -> final_output	[pos="e,1524.2,631 1382.1,631 1382.1,631 1514.2,631 1514.2,631"];
}
