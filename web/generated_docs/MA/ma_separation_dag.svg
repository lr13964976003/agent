<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MA_Separation_Deployment Pages: 1 -->
<svg width="22257pt" height="11916pt"
 viewBox="0.00 0.00 22257.37 11916.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 11912.33)">
<title>MA_Separation_Deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-11912.33 22253.37,-11912.33 22253.37,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e6ffe6" stroke="black" cx="16254.69" cy="-11860.25" rx="321.05" ry="48.17"/>
<text text-anchor="middle" x="16254.69" y="-11879.05" font-family="monospace" font-size="14.00">Input</text>
<text text-anchor="middle" x="16254.69" y="-11864.05" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16254.69" y="-11849.05" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16254.69" y="-11834.05" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_ln1 -->
<g id="node2" class="node">
<title>layer_0_ln1</title>
<polygon fill="#e6f3ff" stroke="black" points="18169.69,-11704.17 17715.69,-11704.17 17715.69,-11636.17 18169.69,-11636.17 18169.69,-11704.17"/>
<text text-anchor="middle" x="17942.69" y="-11688.97" font-family="monospace" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="17942.69" y="-11673.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17942.69" y="-11658.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17942.69" y="-11643.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input&#45;&gt;layer_0_ln1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_ln1</title>
<path fill="none" stroke="black" d="M16423.7,-11819.04C16423.7,-11768.65 16423.7,-11690 16423.7,-11690 16423.7,-11690 17705.28,-11690 17705.28,-11690"/>
<polygon fill="black" stroke="black" points="17705.28,-11693.5 17715.28,-11690 17705.28,-11686.5 17705.28,-11693.5"/>
</g>
<!-- layer_0_residual1 -->
<g id="node43" class="node">
<title>layer_0_residual1</title>
<polygon fill="#fff0e6" stroke="black" points="18169.69,-10512.17 17715.69,-10512.17 17715.69,-10429.17 18169.69,-10429.17 18169.69,-10512.17"/>
<text text-anchor="middle" x="17942.69" y="-10496.97" font-family="monospace" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="17942.69" y="-10481.97" font-family="monospace" font-size="14.00">Input1: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17942.69" y="-10466.97" font-family="monospace" font-size="14.00">Input2: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17942.69" y="-10451.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17942.69" y="-10436.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input&#45;&gt;layer_0_residual1 -->
<g id="edge106" class="edge">
<title>input&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M16073.17,-11820.35C16073.17,-11681.8 16073.17,-11230 16073.17,-11230 16073.17,-11230 16504.19,-11230 16504.19,-11230 16504.19,-11230 16504.19,-10478 16504.19,-10478 16504.19,-10478 17705.55,-10478 17705.55,-10478"/>
<polygon fill="black" stroke="black" points="17705.55,-10481.5 17715.55,-10478 17705.55,-10474.5 17705.55,-10481.5"/>
</g>
<!-- layer_0_qkv_gpu_0 -->
<g id="node3" class="node">
<title>layer_0_qkv_gpu_0</title>
<polygon fill="#e6f3ff" stroke="black" points="17693.69,-11528.17 17231.69,-11528.17 17231.69,-11460.17 17693.69,-11460.17 17693.69,-11528.17"/>
<text text-anchor="middle" x="17462.69" y="-11512.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17462.69" y="-11497.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="17462.69" y="-11482.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17462.69" y="-11467.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_qkv_gpu_0 -->
<g id="edge2" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_qkv_gpu_0</title>
<path fill="none" stroke="black" d="M17715.34,-11649C17591.27,-11649 17462.69,-11649 17462.69,-11649 17462.69,-11649 17462.69,-11538.53 17462.69,-11538.53"/>
<polygon fill="black" stroke="black" points="17466.19,-11538.53 17462.69,-11528.53 17459.19,-11538.53 17466.19,-11538.53"/>
</g>
<!-- layer_0_qkv_gpu_1 -->
<g id="node4" class="node">
<title>layer_0_qkv_gpu_1</title>
<polygon fill="#e6f3ff" stroke="black" points="18173.69,-11528.17 17711.69,-11528.17 17711.69,-11460.17 18173.69,-11460.17 18173.69,-11528.17"/>
<text text-anchor="middle" x="17942.69" y="-11512.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17942.69" y="-11497.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="17942.69" y="-11482.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17942.69" y="-11467.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_qkv_gpu_1 -->
<g id="edge3" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_qkv_gpu_1</title>
<path fill="none" stroke="black" d="M17942.69,-11635.81C17942.69,-11635.81 17942.69,-11538.43 17942.69,-11538.43"/>
<polygon fill="black" stroke="black" points="17946.19,-11538.43 17942.69,-11528.43 17939.19,-11538.43 17946.19,-11538.43"/>
</g>
<!-- layer_0_qkv_gpu_2 -->
<g id="node5" class="node">
<title>layer_0_qkv_gpu_2</title>
<polygon fill="#e6f3ff" stroke="black" points="18653.69,-11528.17 18191.69,-11528.17 18191.69,-11460.17 18653.69,-11460.17 18653.69,-11528.17"/>
<text text-anchor="middle" x="18422.69" y="-11512.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18422.69" y="-11497.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="18422.69" y="-11482.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18422.69" y="-11467.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_qkv_gpu_2 -->
<g id="edge4" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_qkv_gpu_2</title>
<path fill="none" stroke="black" d="M18170.03,-11649C18294.1,-11649 18422.69,-11649 18422.69,-11649 18422.69,-11649 18422.69,-11538.53 18422.69,-11538.53"/>
<polygon fill="black" stroke="black" points="18426.19,-11538.53 18422.69,-11528.53 18419.19,-11538.53 18426.19,-11538.53"/>
</g>
<!-- layer_0_qkv_gpu_3 -->
<g id="node6" class="node">
<title>layer_0_qkv_gpu_3</title>
<polygon fill="#e6f3ff" stroke="black" points="19133.69,-11528.17 18671.69,-11528.17 18671.69,-11460.17 19133.69,-11460.17 19133.69,-11528.17"/>
<text text-anchor="middle" x="18902.69" y="-11512.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18902.69" y="-11497.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="18902.69" y="-11482.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18902.69" y="-11467.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_qkv_gpu_3 -->
<g id="edge5" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_qkv_gpu_3</title>
<path fill="none" stroke="black" d="M18169.89,-11663C18453.76,-11663 18902.69,-11663 18902.69,-11663 18902.69,-11663 18902.69,-11538.33 18902.69,-11538.33"/>
<polygon fill="black" stroke="black" points="18906.19,-11538.33 18902.69,-11528.33 18899.19,-11538.33 18906.19,-11538.33"/>
</g>
<!-- layer_0_qkv_gpu_4 -->
<g id="node7" class="node">
<title>layer_0_qkv_gpu_4</title>
<polygon fill="#e6f3ff" stroke="black" points="19613.69,-11528.17 19151.69,-11528.17 19151.69,-11460.17 19613.69,-11460.17 19613.69,-11528.17"/>
<text text-anchor="middle" x="19382.69" y="-11512.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="19382.69" y="-11497.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="19382.69" y="-11482.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19382.69" y="-11467.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_qkv_gpu_4 -->
<g id="edge6" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_qkv_gpu_4</title>
<path fill="none" stroke="black" d="M18170.06,-11676C18575.85,-11676 19382.69,-11676 19382.69,-11676 19382.69,-11676 19382.69,-11538.37 19382.69,-11538.37"/>
<polygon fill="black" stroke="black" points="19386.19,-11538.37 19382.69,-11528.37 19379.19,-11538.37 19386.19,-11538.37"/>
</g>
<!-- layer_0_qkv_gpu_5 -->
<g id="node8" class="node">
<title>layer_0_qkv_gpu_5</title>
<polygon fill="#e6f3ff" stroke="black" points="20093.69,-11528.17 19631.69,-11528.17 19631.69,-11460.17 20093.69,-11460.17 20093.69,-11528.17"/>
<text text-anchor="middle" x="19862.69" y="-11512.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="19862.69" y="-11497.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="19862.69" y="-11482.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19862.69" y="-11467.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_qkv_gpu_5 -->
<g id="edge7" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_qkv_gpu_5</title>
<path fill="none" stroke="black" d="M18170,-11690C18678.33,-11690 19862.69,-11690 19862.69,-11690 19862.69,-11690 19862.69,-11538.28 19862.69,-11538.28"/>
<polygon fill="black" stroke="black" points="19866.19,-11538.28 19862.69,-11528.28 19859.19,-11538.28 19866.19,-11538.28"/>
</g>
<!-- layer_0_qkv_gpu_6 -->
<g id="node9" class="node">
<title>layer_0_qkv_gpu_6</title>
<polygon fill="#e6f3ff" stroke="black" points="16733.69,-11528.17 16271.69,-11528.17 16271.69,-11460.17 16733.69,-11460.17 16733.69,-11528.17"/>
<text text-anchor="middle" x="16502.69" y="-11512.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16502.69" y="-11497.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="16502.69" y="-11482.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16502.69" y="-11467.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_qkv_gpu_6 -->
<g id="edge8" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_qkv_gpu_6</title>
<path fill="none" stroke="black" d="M17715.38,-11676C17345.63,-11676 16654.7,-11676 16654.7,-11676 16654.7,-11676 16654.7,-11538.37 16654.7,-11538.37"/>
<polygon fill="black" stroke="black" points="16658.2,-11538.37 16654.7,-11528.37 16651.2,-11538.37 16658.2,-11538.37"/>
</g>
<!-- layer_0_qkv_gpu_7 -->
<g id="node10" class="node">
<title>layer_0_qkv_gpu_7</title>
<polygon fill="#e6f3ff" stroke="black" points="17213.69,-11528.17 16751.69,-11528.17 16751.69,-11460.17 17213.69,-11460.17 17213.69,-11528.17"/>
<text text-anchor="middle" x="16982.69" y="-11512.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16982.69" y="-11497.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="16982.69" y="-11482.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16982.69" y="-11467.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_qkv_gpu_7 -->
<g id="edge9" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_qkv_gpu_7</title>
<path fill="none" stroke="black" d="M17715.48,-11663C17431.61,-11663 16982.69,-11663 16982.69,-11663 16982.69,-11663 16982.69,-11538.33 16982.69,-11538.33"/>
<polygon fill="black" stroke="black" points="16986.19,-11538.33 16982.69,-11528.33 16979.19,-11538.33 16986.19,-11538.33"/>
</g>
<!-- layer_0_attn_gpu_0 -->
<g id="node11" class="node">
<title>layer_0_attn_gpu_0</title>
<polygon fill="#e6f3ff" stroke="black" points="17513.69,-11352.17 17051.69,-11352.17 17051.69,-11284.17 17513.69,-11284.17 17513.69,-11352.17"/>
<text text-anchor="middle" x="17282.69" y="-11336.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="17282.69" y="-11321.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="17282.69" y="-11306.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17282.69" y="-11291.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_qkv_gpu_0&#45;&gt;layer_0_attn_gpu_0 -->
<g id="edge10" class="edge">
<title>layer_0_qkv_gpu_0&#45;&gt;layer_0_attn_gpu_0</title>
<path fill="none" stroke="black" d="M17372.69,-11459.81C17372.69,-11459.81 17372.69,-11362.43 17372.69,-11362.43"/>
<polygon fill="black" stroke="black" points="17376.19,-11362.43 17372.69,-11352.43 17369.19,-11362.43 17376.19,-11362.43"/>
</g>
<!-- layer_0_attn_gpu_1 -->
<g id="node12" class="node">
<title>layer_0_attn_gpu_1</title>
<polygon fill="#e6f3ff" stroke="black" points="18173.69,-11352.17 17711.69,-11352.17 17711.69,-11284.17 18173.69,-11284.17 18173.69,-11352.17"/>
<text text-anchor="middle" x="17942.69" y="-11336.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="17942.69" y="-11321.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="17942.69" y="-11306.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17942.69" y="-11291.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_qkv_gpu_1&#45;&gt;layer_0_attn_gpu_1 -->
<g id="edge11" class="edge">
<title>layer_0_qkv_gpu_1&#45;&gt;layer_0_attn_gpu_1</title>
<path fill="none" stroke="black" d="M17942.69,-11459.81C17942.69,-11459.81 17942.69,-11362.43 17942.69,-11362.43"/>
<polygon fill="black" stroke="black" points="17946.19,-11362.43 17942.69,-11352.43 17939.19,-11362.43 17946.19,-11362.43"/>
</g>
<!-- layer_0_attn_gpu_2 -->
<g id="node13" class="node">
<title>layer_0_attn_gpu_2</title>
<polygon fill="#e6f3ff" stroke="black" points="18892.69,-11352.17 18430.69,-11352.17 18430.69,-11284.17 18892.69,-11284.17 18892.69,-11352.17"/>
<text text-anchor="middle" x="18661.69" y="-11336.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="18661.69" y="-11321.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="18661.69" y="-11306.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18661.69" y="-11291.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_qkv_gpu_2&#45;&gt;layer_0_attn_gpu_2 -->
<g id="edge12" class="edge">
<title>layer_0_qkv_gpu_2&#45;&gt;layer_0_attn_gpu_2</title>
<path fill="none" stroke="black" d="M18542.19,-11459.81C18542.19,-11459.81 18542.19,-11362.43 18542.19,-11362.43"/>
<polygon fill="black" stroke="black" points="18545.69,-11362.43 18542.19,-11352.43 18538.69,-11362.43 18545.69,-11362.43"/>
</g>
<!-- layer_0_attn_gpu_3 -->
<g id="node14" class="node">
<title>layer_0_attn_gpu_3</title>
<polygon fill="#e6f3ff" stroke="black" points="19731.69,-11352.17 19269.69,-11352.17 19269.69,-11284.17 19731.69,-11284.17 19731.69,-11352.17"/>
<text text-anchor="middle" x="19500.69" y="-11336.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="19500.69" y="-11321.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="19500.69" y="-11306.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19500.69" y="-11291.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_qkv_gpu_3&#45;&gt;layer_0_attn_gpu_3 -->
<g id="edge13" class="edge">
<title>layer_0_qkv_gpu_3&#45;&gt;layer_0_attn_gpu_3</title>
<path fill="none" stroke="black" d="M19013.19,-11459.78C19013.19,-11408.51 19013.19,-11318 19013.19,-11318 19013.19,-11318 19259.43,-11318 19259.43,-11318"/>
<polygon fill="black" stroke="black" points="19259.43,-11321.5 19269.43,-11318 19259.43,-11314.5 19259.43,-11321.5"/>
</g>
<!-- layer_0_attn_gpu_4 -->
<g id="node15" class="node">
<title>layer_0_attn_gpu_4</title>
<polygon fill="#e6f3ff" stroke="black" points="20630.69,-11352.17 20168.69,-11352.17 20168.69,-11284.17 20630.69,-11284.17 20630.69,-11352.17"/>
<text text-anchor="middle" x="20399.69" y="-11336.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="20399.69" y="-11321.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="20399.69" y="-11306.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20399.69" y="-11291.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_qkv_gpu_4&#45;&gt;layer_0_attn_gpu_4 -->
<g id="edge14" class="edge">
<title>layer_0_qkv_gpu_4&#45;&gt;layer_0_attn_gpu_4</title>
<path fill="none" stroke="black" d="M19441.69,-11460.08C19441.69,-11435.27 19441.69,-11406 19441.69,-11406 19441.69,-11406 20399.69,-11406 20399.69,-11406 20399.69,-11406 20399.69,-11362.38 20399.69,-11362.38"/>
<polygon fill="black" stroke="black" points="20403.19,-11362.38 20399.69,-11352.38 20396.19,-11362.38 20403.19,-11362.38"/>
</g>
<!-- layer_0_attn_gpu_5 -->
<g id="node16" class="node">
<title>layer_0_attn_gpu_5</title>
<polygon fill="#e6f3ff" stroke="black" points="21559.69,-11352.17 21097.69,-11352.17 21097.69,-11284.17 21559.69,-11284.17 21559.69,-11352.17"/>
<text text-anchor="middle" x="21328.69" y="-11336.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="21328.69" y="-11321.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="21328.69" y="-11306.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="21328.69" y="-11291.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_qkv_gpu_5&#45;&gt;layer_0_attn_gpu_5 -->
<g id="edge15" class="edge">
<title>layer_0_qkv_gpu_5&#45;&gt;layer_0_attn_gpu_5</title>
<path fill="none" stroke="black" d="M20093.76,-11494C20506.74,-11494 21328.69,-11494 21328.69,-11494 21328.69,-11494 21328.69,-11362.49 21328.69,-11362.49"/>
<polygon fill="black" stroke="black" points="21332.19,-11362.49 21328.69,-11352.49 21325.19,-11362.49 21332.19,-11362.49"/>
</g>
<!-- layer_0_attn_gpu_6 -->
<g id="node17" class="node">
<title>layer_0_attn_gpu_6</title>
<polygon fill="#e6f3ff" stroke="black" points="15476.69,-11352.17 15014.69,-11352.17 15014.69,-11284.17 15476.69,-11284.17 15476.69,-11352.17"/>
<text text-anchor="middle" x="15245.69" y="-11336.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="15245.69" y="-11321.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="15245.69" y="-11306.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15245.69" y="-11291.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_qkv_gpu_6&#45;&gt;layer_0_attn_gpu_6 -->
<g id="edge16" class="edge">
<title>layer_0_qkv_gpu_6&#45;&gt;layer_0_attn_gpu_6</title>
<path fill="none" stroke="black" d="M16271.4,-11494C15908.36,-11494 15245.69,-11494 15245.69,-11494 15245.69,-11494 15245.69,-11362.49 15245.69,-11362.49"/>
<polygon fill="black" stroke="black" points="15249.19,-11362.49 15245.69,-11352.49 15242.19,-11362.49 15249.19,-11362.49"/>
</g>
<!-- layer_0_attn_gpu_7 -->
<g id="node18" class="node">
<title>layer_0_attn_gpu_7</title>
<polygon fill="#e6f3ff" stroke="black" points="16674.69,-11352.17 16212.69,-11352.17 16212.69,-11284.17 16674.69,-11284.17 16674.69,-11352.17"/>
<text text-anchor="middle" x="16443.69" y="-11336.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="16443.69" y="-11321.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="16443.69" y="-11306.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16443.69" y="-11291.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_0_qkv_gpu_7&#45;&gt;layer_0_attn_gpu_7 -->
<g id="edge17" class="edge">
<title>layer_0_qkv_gpu_7&#45;&gt;layer_0_attn_gpu_7</title>
<path fill="none" stroke="black" d="M16901.69,-11459.78C16901.69,-11408.51 16901.69,-11318 16901.69,-11318 16901.69,-11318 16684.7,-11318 16684.7,-11318"/>
<polygon fill="black" stroke="black" points="16684.7,-11314.5 16674.7,-11318 16684.7,-11321.5 16684.7,-11314.5"/>
</g>
<!-- layer_0_attn_allreduce_0 -->
<g id="node19" class="node">
<title>layer_0_attn_allreduce_0</title>
<polygon fill="#e6ffe6" stroke="black" points="17454.56,-11176.17 16705.51,-11176.17 16512.81,-11040.17 17261.87,-11040.17 17454.56,-11176.17"/>
<text text-anchor="middle" x="16983.69" y="-11126.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="16983.69" y="-11111.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="16983.69" y="-11096.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16983.69" y="-11081.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_gpu_0&#45;&gt;layer_0_attn_allreduce_0 -->
<g id="edge18" class="edge">
<title>layer_0_attn_gpu_0&#45;&gt;layer_0_attn_allreduce_0</title>
<path fill="none" stroke="black" d="M17253.03,-11283.96C17253.03,-11283.96 17253.03,-11186.33 17253.03,-11186.33"/>
<polygon fill="black" stroke="black" points="17256.53,-11186.33 17253.03,-11176.33 17249.53,-11186.33 17256.53,-11186.33"/>
</g>
<!-- layer_0_attn_allreduce_1 -->
<g id="node20" class="node">
<title>layer_0_attn_allreduce_1</title>
<polygon fill="#e6ffe6" stroke="black" points="18413.56,-11176.17 17664.51,-11176.17 17471.81,-11040.17 18220.87,-11040.17 18413.56,-11176.17"/>
<text text-anchor="middle" x="17942.69" y="-11126.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="17942.69" y="-11111.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="17942.69" y="-11096.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17942.69" y="-11081.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_gpu_1&#45;&gt;layer_0_attn_allreduce_1 -->
<g id="edge19" class="edge">
<title>layer_0_attn_gpu_1&#45;&gt;layer_0_attn_allreduce_1</title>
<path fill="none" stroke="black" d="M17942.69,-11283.96C17942.69,-11283.96 17942.69,-11186.33 17942.69,-11186.33"/>
<polygon fill="black" stroke="black" points="17946.19,-11186.33 17942.69,-11176.33 17939.19,-11186.33 17946.19,-11186.33"/>
</g>
<!-- layer_0_attn_allreduce_2 -->
<g id="node21" class="node">
<title>layer_0_attn_allreduce_2</title>
<polygon fill="#e6ffe6" stroke="black" points="19372.56,-11176.17 18623.51,-11176.17 18430.81,-11040.17 19179.87,-11040.17 19372.56,-11176.17"/>
<text text-anchor="middle" x="18901.69" y="-11126.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="18901.69" y="-11111.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="18901.69" y="-11096.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18901.69" y="-11081.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_gpu_2&#45;&gt;layer_0_attn_allreduce_2 -->
<g id="edge20" class="edge">
<title>layer_0_attn_gpu_2&#45;&gt;layer_0_attn_allreduce_2</title>
<path fill="none" stroke="black" d="M18661.84,-11283.96C18661.84,-11283.96 18661.84,-11186.33 18661.84,-11186.33"/>
<polygon fill="black" stroke="black" points="18665.34,-11186.33 18661.84,-11176.33 18658.34,-11186.33 18665.34,-11186.33"/>
</g>
<!-- layer_0_attn_allreduce_3 -->
<g id="node22" class="node">
<title>layer_0_attn_allreduce_3</title>
<polygon fill="#e6ffe6" stroke="black" points="20331.56,-11176.17 19582.51,-11176.17 19389.81,-11040.17 20138.87,-11040.17 20331.56,-11176.17"/>
<text text-anchor="middle" x="19860.69" y="-11126.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="19860.69" y="-11111.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="19860.69" y="-11096.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19860.69" y="-11081.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_gpu_3&#45;&gt;layer_0_attn_allreduce_3 -->
<g id="edge21" class="edge">
<title>layer_0_attn_gpu_3&#45;&gt;layer_0_attn_allreduce_3</title>
<path fill="none" stroke="black" d="M19560.84,-11283.96C19560.84,-11283.96 19560.84,-11171.25 19560.84,-11171.25"/>
<polygon fill="black" stroke="black" points="19564.34,-11171.25 19560.84,-11161.25 19557.34,-11171.25 19564.34,-11171.25"/>
</g>
<!-- layer_0_attn_allreduce_4 -->
<g id="node23" class="node">
<title>layer_0_attn_allreduce_4</title>
<polygon fill="#e6ffe6" stroke="black" points="21290.56,-11176.17 20541.51,-11176.17 20348.81,-11040.17 21097.87,-11040.17 21290.56,-11176.17"/>
<text text-anchor="middle" x="20819.69" y="-11126.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="20819.69" y="-11111.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="20819.69" y="-11096.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="20819.69" y="-11081.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_gpu_4&#45;&gt;layer_0_attn_allreduce_4 -->
<g id="edge22" class="edge">
<title>layer_0_attn_gpu_4&#45;&gt;layer_0_attn_allreduce_4</title>
<path fill="none" stroke="black" d="M20489.84,-11283.96C20489.84,-11283.96 20489.84,-11149.95 20489.84,-11149.95"/>
<polygon fill="black" stroke="black" points="20493.34,-11149.95 20489.84,-11139.95 20486.34,-11149.95 20493.34,-11149.95"/>
</g>
<!-- layer_0_attn_allreduce_5 -->
<g id="node24" class="node">
<title>layer_0_attn_allreduce_5</title>
<polygon fill="#e6ffe6" stroke="black" points="22249.56,-11176.17 21500.51,-11176.17 21307.81,-11040.17 22056.87,-11040.17 22249.56,-11176.17"/>
<text text-anchor="middle" x="21778.69" y="-11126.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="21778.69" y="-11111.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="21778.69" y="-11096.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="21778.69" y="-11081.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_gpu_5&#45;&gt;layer_0_attn_allreduce_5 -->
<g id="edge23" class="edge">
<title>layer_0_attn_gpu_5&#45;&gt;layer_0_attn_allreduce_5</title>
<path fill="none" stroke="black" d="M21433.84,-11283.96C21433.84,-11283.96 21433.84,-11139.25 21433.84,-11139.25"/>
<polygon fill="black" stroke="black" points="21437.34,-11139.25 21433.84,-11129.25 21430.34,-11139.25 21437.34,-11139.25"/>
</g>
<!-- layer_0_attn_allreduce_6 -->
<g id="node25" class="node">
<title>layer_0_attn_allreduce_6</title>
<polygon fill="#e6ffe6" stroke="black" points="15536.56,-11176.17 14787.51,-11176.17 14594.81,-11040.17 15343.87,-11040.17 15536.56,-11176.17"/>
<text text-anchor="middle" x="15065.69" y="-11126.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="15065.69" y="-11111.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="15065.69" y="-11096.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15065.69" y="-11081.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_gpu_6&#45;&gt;layer_0_attn_allreduce_6 -->
<g id="edge24" class="edge">
<title>layer_0_attn_gpu_6&#45;&gt;layer_0_attn_allreduce_6</title>
<path fill="none" stroke="black" d="M15245.69,-11283.96C15245.69,-11283.96 15245.69,-11186.33 15245.69,-11186.33"/>
<polygon fill="black" stroke="black" points="15249.19,-11186.33 15245.69,-11176.33 15242.19,-11186.33 15249.19,-11186.33"/>
</g>
<!-- layer_0_attn_allreduce_7 -->
<g id="node26" class="node">
<title>layer_0_attn_allreduce_7</title>
<polygon fill="#e6ffe6" stroke="black" points="16495.56,-11176.17 15746.51,-11176.17 15553.81,-11040.17 16302.87,-11040.17 16495.56,-11176.17"/>
<text text-anchor="middle" x="16024.69" y="-11126.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="16024.69" y="-11111.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="16024.69" y="-11096.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16024.69" y="-11081.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_gpu_7&#45;&gt;layer_0_attn_allreduce_7 -->
<g id="edge25" class="edge">
<title>layer_0_attn_gpu_7&#45;&gt;layer_0_attn_allreduce_7</title>
<path fill="none" stroke="black" d="M16354.03,-11283.96C16354.03,-11283.96 16354.03,-11186.33 16354.03,-11186.33"/>
<polygon fill="black" stroke="black" points="16357.53,-11186.33 16354.03,-11176.33 16350.53,-11186.33 16357.53,-11186.33"/>
</g>
<!-- layer_0_attn_proj_0 -->
<g id="node27" class="node">
<title>layer_0_attn_proj_0</title>
<polygon fill="#e6f3ff" stroke="black" points="17940.69,-10932.17 17486.69,-10932.17 17486.69,-10864.17 17940.69,-10864.17 17940.69,-10932.17"/>
<text text-anchor="middle" x="17713.69" y="-10916.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="17713.69" y="-10901.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="17713.69" y="-10886.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17713.69" y="-10871.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_allreduce_0&#45;&gt;layer_0_attn_proj_0 -->
<g id="edge26" class="edge">
<title>layer_0_attn_allreduce_0&#45;&gt;layer_0_attn_proj_0</title>
<path fill="none" stroke="black" d="M17307.81,-11072.48C17307.81,-11033.03 17307.81,-10975 17307.81,-10975 17307.81,-10975 17713.69,-10975 17713.69,-10975 17713.69,-10975 17713.69,-10942.54 17713.69,-10942.54"/>
<polygon fill="black" stroke="black" points="17717.19,-10942.54 17713.69,-10932.54 17710.19,-10942.54 17717.19,-10942.54"/>
</g>
<!-- layer_0_attn_proj_1 -->
<g id="node28" class="node">
<title>layer_0_attn_proj_1</title>
<polygon fill="#e6f3ff" stroke="black" points="18412.69,-10932.17 17958.69,-10932.17 17958.69,-10864.17 18412.69,-10864.17 18412.69,-10932.17"/>
<text text-anchor="middle" x="18185.69" y="-10916.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="18185.69" y="-10901.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="18185.69" y="-10886.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18185.69" y="-10871.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_allreduce_1&#45;&gt;layer_0_attn_proj_1 -->
<g id="edge27" class="edge">
<title>layer_0_attn_allreduce_1&#45;&gt;layer_0_attn_proj_1</title>
<path fill="none" stroke="black" d="M18185.69,-11039.99C18185.69,-11039.99 18185.69,-10942.2 18185.69,-10942.2"/>
<polygon fill="black" stroke="black" points="18189.19,-10942.2 18185.69,-10932.2 18182.19,-10942.2 18189.19,-10942.2"/>
</g>
<!-- layer_0_attn_proj_2 -->
<g id="node29" class="node">
<title>layer_0_attn_proj_2</title>
<polygon fill="#e6f3ff" stroke="black" points="18884.69,-10932.17 18430.69,-10932.17 18430.69,-10864.17 18884.69,-10864.17 18884.69,-10932.17"/>
<text text-anchor="middle" x="18657.69" y="-10916.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="18657.69" y="-10901.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="18657.69" y="-10886.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18657.69" y="-10871.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_allreduce_2&#45;&gt;layer_0_attn_proj_2 -->
<g id="edge28" class="edge">
<title>layer_0_attn_allreduce_2&#45;&gt;layer_0_attn_proj_2</title>
<path fill="none" stroke="black" d="M18657.84,-11039.99C18657.84,-11039.99 18657.84,-10942.2 18657.84,-10942.2"/>
<polygon fill="black" stroke="black" points="18661.34,-10942.2 18657.84,-10932.2 18654.34,-10942.2 18661.34,-10942.2"/>
</g>
<!-- layer_0_attn_proj_3 -->
<g id="node30" class="node">
<title>layer_0_attn_proj_3</title>
<polygon fill="#e6f3ff" stroke="black" points="19356.69,-10932.17 18902.69,-10932.17 18902.69,-10864.17 19356.69,-10864.17 19356.69,-10932.17"/>
<text text-anchor="middle" x="19129.69" y="-10916.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="19129.69" y="-10901.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="19129.69" y="-10886.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19129.69" y="-10871.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_allreduce_3&#45;&gt;layer_0_attn_proj_3 -->
<g id="edge29" class="edge">
<title>layer_0_attn_allreduce_3&#45;&gt;layer_0_attn_proj_3</title>
<path fill="none" stroke="black" d="M19536.23,-11039.83C19536.23,-11027.25 19536.23,-11018 19536.23,-11018 19536.23,-11018 19129.69,-11018 19129.69,-11018 19129.69,-11018 19129.69,-10942.19 19129.69,-10942.19"/>
<polygon fill="black" stroke="black" points="19133.19,-10942.19 19129.69,-10932.19 19126.19,-10942.19 19133.19,-10942.19"/>
</g>
<!-- layer_0_attn_proj_4 -->
<g id="node31" class="node">
<title>layer_0_attn_proj_4</title>
<polygon fill="#e6f3ff" stroke="black" points="19828.69,-10932.17 19374.69,-10932.17 19374.69,-10864.17 19828.69,-10864.17 19828.69,-10932.17"/>
<text text-anchor="middle" x="19601.69" y="-10916.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="19601.69" y="-10901.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="19601.69" y="-10886.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19601.69" y="-10871.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_allreduce_4&#45;&gt;layer_0_attn_proj_4 -->
<g id="edge30" class="edge">
<title>layer_0_attn_allreduce_4&#45;&gt;layer_0_attn_proj_4</title>
<path fill="none" stroke="black" d="M21081.18,-11040.01C21081.18,-11016.52 21081.18,-10996 21081.18,-10996 21081.18,-10996 19682.46,-10996 19682.46,-10996 19682.46,-10996 19682.46,-10942.38 19682.46,-10942.38"/>
<polygon fill="black" stroke="black" points="19685.96,-10942.38 19682.46,-10932.38 19678.96,-10942.38 19685.96,-10942.38"/>
</g>
<!-- layer_0_attn_proj_5 -->
<g id="node32" class="node">
<title>layer_0_attn_proj_5</title>
<polygon fill="#e6f3ff" stroke="black" points="20300.69,-10932.17 19846.69,-10932.17 19846.69,-10864.17 20300.69,-10864.17 20300.69,-10932.17"/>
<text text-anchor="middle" x="20073.69" y="-10916.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="20073.69" y="-10901.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="20073.69" y="-10886.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20073.69" y="-10871.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_allreduce_5&#45;&gt;layer_0_attn_proj_5 -->
<g id="edge31" class="edge">
<title>layer_0_attn_allreduce_5&#45;&gt;layer_0_attn_proj_5</title>
<path fill="none" stroke="black" d="M22144.77,-11102.17C22144.77,-11069.57 22144.77,-10915 22144.77,-10915 22144.77,-10915 20310.76,-10915 20310.76,-10915"/>
<polygon fill="black" stroke="black" points="20310.76,-10911.5 20300.76,-10915 20310.76,-10918.5 20310.76,-10911.5"/>
</g>
<!-- layer_0_attn_proj_6 -->
<g id="node33" class="node">
<title>layer_0_attn_proj_6</title>
<polygon fill="#e6f3ff" stroke="black" points="16996.69,-10932.17 16542.69,-10932.17 16542.69,-10864.17 16996.69,-10864.17 16996.69,-10932.17"/>
<text text-anchor="middle" x="16769.69" y="-10916.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="16769.69" y="-10901.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="16769.69" y="-10886.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16769.69" y="-10871.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_allreduce_6&#45;&gt;layer_0_attn_proj_6 -->
<g id="edge32" class="edge">
<title>layer_0_attn_allreduce_6&#45;&gt;layer_0_attn_proj_6</title>
<path fill="none" stroke="black" d="M15431.77,-11102.17C15431.77,-11069.57 15431.77,-10915 15431.77,-10915 15431.77,-10915 16532.35,-10915 16532.35,-10915"/>
<polygon fill="black" stroke="black" points="16532.35,-10918.5 16542.35,-10915 16532.35,-10911.5 16532.35,-10918.5"/>
</g>
<!-- layer_0_attn_proj_7 -->
<g id="node34" class="node">
<title>layer_0_attn_proj_7</title>
<polygon fill="#e6f3ff" stroke="black" points="17468.69,-10932.17 17014.69,-10932.17 17014.69,-10864.17 17468.69,-10864.17 17468.69,-10932.17"/>
<text text-anchor="middle" x="17241.69" y="-10916.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="17241.69" y="-10901.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="17241.69" y="-10886.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17241.69" y="-10871.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_allreduce_7&#45;&gt;layer_0_attn_proj_7 -->
<g id="edge33" class="edge">
<title>layer_0_attn_allreduce_7&#45;&gt;layer_0_attn_proj_7</title>
<path fill="none" stroke="black" d="M15658.6,-11040.11C15658.6,-10998.42 15658.6,-10953 15658.6,-10953 15658.6,-10953 17161.25,-10953 17161.25,-10953 17161.25,-10953 17161.25,-10942.27 17161.25,-10942.27"/>
<polygon fill="black" stroke="black" points="17164.75,-10942.27 17161.25,-10932.27 17157.75,-10942.27 17164.75,-10942.27"/>
</g>
<!-- layer_0_recv_attn_8 -->
<g id="node35" class="node">
<title>layer_0_recv_attn_8</title>
<polygon fill="#e6ffe6" stroke="black" points="22249.56,-10756.17 21500.51,-10756.17 21307.81,-10620.17 22056.87,-10620.17 22249.56,-10756.17"/>
<text text-anchor="middle" x="21778.69" y="-10706.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="21778.69" y="-10691.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="21778.69" y="-10676.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="21778.69" y="-10661.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_8 -->
<g id="edge34" class="edge">
<title>layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_8</title>
<path fill="none" stroke="black" d="M17890.24,-10863.9C17890.24,-10836.98 17890.24,-10804 17890.24,-10804 17890.24,-10804 21517.19,-10804 21517.19,-10804 21517.19,-10804 21517.19,-10766.22 21517.19,-10766.22"/>
<polygon fill="black" stroke="black" points="21520.69,-10766.22 21517.19,-10756.22 21513.69,-10766.22 21520.69,-10766.22"/>
</g>
<!-- layer_0_recv_attn_9 -->
<g id="node36" class="node">
<title>layer_0_recv_attn_9</title>
<polygon fill="#e6ffe6" stroke="black" points="15536.56,-10756.17 14787.51,-10756.17 14594.81,-10620.17 15343.87,-10620.17 15536.56,-10756.17"/>
<text text-anchor="middle" x="15065.69" y="-10706.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="15065.69" y="-10691.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15065.69" y="-10676.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15065.69" y="-10661.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_9 -->
<g id="edge35" class="edge">
<title>layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_9</title>
<path fill="none" stroke="black" d="M17537.13,-10864.13C17537.13,-10857.21 17537.13,-10852 17537.13,-10852 17537.13,-10852 14908.79,-10852 14908.79,-10852 14908.79,-10852 14908.79,-10766.22 14908.79,-10766.22"/>
<polygon fill="black" stroke="black" points="14912.29,-10766.22 14908.79,-10756.22 14905.29,-10766.22 14912.29,-10766.22"/>
</g>
<!-- layer_0_recv_attn_10 -->
<g id="node37" class="node">
<title>layer_0_recv_attn_10</title>
<polygon fill="#e6ffe6" stroke="black" points="16495.56,-10756.17 15746.51,-10756.17 15553.81,-10620.17 16302.87,-10620.17 16495.56,-10756.17"/>
<text text-anchor="middle" x="16024.69" y="-10706.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="16024.69" y="-10691.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16024.69" y="-10676.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16024.69" y="-10661.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_10 -->
<g id="edge36" class="edge">
<title>layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_10</title>
<path fill="none" stroke="black" d="M17587.57,-10864.01C17587.57,-10850 17587.57,-10837 17587.57,-10837 17587.57,-10837 15972.39,-10837 15972.39,-10837 15972.39,-10837 15972.39,-10766.48 15972.39,-10766.48"/>
<polygon fill="black" stroke="black" points="15975.89,-10766.48 15972.39,-10756.48 15968.89,-10766.48 15975.89,-10766.48"/>
</g>
<!-- layer_0_recv_attn_11 -->
<g id="node38" class="node">
<title>layer_0_recv_attn_11</title>
<polygon fill="#e6ffe6" stroke="black" points="17454.56,-10756.17 16705.51,-10756.17 16512.81,-10620.17 17261.87,-10620.17 17454.56,-10756.17"/>
<text text-anchor="middle" x="16983.69" y="-10706.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="16983.69" y="-10691.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="16983.69" y="-10676.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16983.69" y="-10661.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_11 -->
<g id="edge37" class="edge">
<title>layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_11</title>
<path fill="none" stroke="black" d="M17638.02,-10863.91C17638.02,-10846.09 17638.02,-10828 17638.02,-10828 17638.02,-10828 17214.54,-10828 17214.54,-10828 17214.54,-10828 17214.54,-10766.44 17214.54,-10766.44"/>
<polygon fill="black" stroke="black" points="17218.04,-10766.44 17214.54,-10756.44 17211.04,-10766.44 17218.04,-10766.44"/>
</g>
<!-- layer_0_recv_attn_12 -->
<g id="node39" class="node">
<title>layer_0_recv_attn_12</title>
<polygon fill="#e6ffe6" stroke="black" points="18413.56,-10756.17 17664.51,-10756.17 17471.81,-10620.17 18220.87,-10620.17 18413.56,-10756.17"/>
<text text-anchor="middle" x="17942.69" y="-10706.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="17942.69" y="-10691.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="17942.69" y="-10676.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17942.69" y="-10661.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_12 -->
<g id="edge38" class="edge">
<title>layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_12</title>
<path fill="none" stroke="black" d="M17688.46,-10863.96C17688.46,-10863.96 17688.46,-10766.33 17688.46,-10766.33"/>
<polygon fill="black" stroke="black" points="17691.96,-10766.33 17688.46,-10756.33 17684.96,-10766.33 17691.96,-10766.33"/>
</g>
<!-- layer_0_recv_attn_13 -->
<g id="node40" class="node">
<title>layer_0_recv_attn_13</title>
<polygon fill="#e6ffe6" stroke="black" points="19372.56,-10756.17 18623.51,-10756.17 18430.81,-10620.17 19179.87,-10620.17 19372.56,-10756.17"/>
<text text-anchor="middle" x="18901.69" y="-10706.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="18901.69" y="-10691.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="18901.69" y="-10676.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18901.69" y="-10661.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_13 -->
<g id="edge39" class="edge">
<title>layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_13</title>
<path fill="none" stroke="black" d="M17738.91,-10863.8C17738.91,-10841.28 17738.91,-10816 17738.91,-10816 17738.91,-10816 18678.47,-10816 18678.47,-10816 18678.47,-10816 18678.47,-10766.2 18678.47,-10766.2"/>
<polygon fill="black" stroke="black" points="18681.97,-10766.2 18678.47,-10756.2 18674.97,-10766.2 18681.97,-10766.2"/>
</g>
<!-- layer_0_recv_attn_14 -->
<g id="node41" class="node">
<title>layer_0_recv_attn_14</title>
<polygon fill="#e6ffe6" stroke="black" points="20331.56,-10756.17 19582.51,-10756.17 19389.81,-10620.17 20138.87,-10620.17 20331.56,-10756.17"/>
<text text-anchor="middle" x="19860.69" y="-10706.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="19860.69" y="-10691.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="19860.69" y="-10676.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19860.69" y="-10661.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_14 -->
<g id="edge40" class="edge">
<title>layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_14</title>
<path fill="none" stroke="black" d="M17789.35,-10863.99C17789.35,-10832.95 17789.35,-10792 17789.35,-10792 17789.35,-10792 19549.52,-10792 19549.52,-10792 19549.52,-10792 19549.52,-10743.11 19549.52,-10743.11"/>
<polygon fill="black" stroke="black" points="19553.02,-10743.11 19549.52,-10733.11 19546.02,-10743.11 19553.02,-10743.11"/>
</g>
<!-- layer_0_recv_attn_15 -->
<g id="node42" class="node">
<title>layer_0_recv_attn_15</title>
<polygon fill="#e6ffe6" stroke="black" points="21290.56,-10756.17 20541.51,-10756.17 20348.81,-10620.17 21097.87,-10620.17 21290.56,-10756.17"/>
<text text-anchor="middle" x="20819.69" y="-10706.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="20819.69" y="-10691.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="20819.69" y="-10676.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20819.69" y="-10661.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_15 -->
<g id="edge41" class="edge">
<title>layer_0_attn_proj_0&#45;&gt;layer_0_recv_attn_15</title>
<path fill="none" stroke="black" d="M17839.8,-10864.15C17839.8,-10834.43 17839.8,-10796 17839.8,-10796 17839.8,-10796 20558.19,-10796 20558.19,-10796 20558.19,-10796 20558.19,-10766.46 20558.19,-10766.46"/>
<polygon fill="black" stroke="black" points="20561.69,-10766.46 20558.19,-10756.46 20554.69,-10766.46 20561.69,-10766.46"/>
</g>
<!-- layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_8 -->
<g id="edge42" class="edge">
<title>layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_8</title>
<path fill="none" stroke="black" d="M18247.6,-10864.11C18247.6,-10837.85 18247.6,-10806 18247.6,-10806 18247.6,-10806 21621.79,-10806 21621.79,-10806 21621.79,-10806 21621.79,-10766.37 21621.79,-10766.37"/>
<polygon fill="black" stroke="black" points="21625.29,-10766.37 21621.79,-10756.37 21618.29,-10766.37 21625.29,-10766.37"/>
</g>
<!-- layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_9 -->
<g id="edge43" class="edge">
<title>layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_9</title>
<path fill="none" stroke="black" d="M17999.96,-10864.02C17999.96,-10855.63 17999.96,-10849 17999.96,-10849 17999.96,-10849 15013.39,-10849 15013.39,-10849 15013.39,-10849 15013.39,-10766.37 15013.39,-10766.37"/>
<polygon fill="black" stroke="black" points="15016.89,-10766.37 15013.39,-10756.37 15009.89,-10766.37 15016.89,-10766.37"/>
</g>
<!-- layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_10 -->
<g id="edge44" class="edge">
<title>layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_10</title>
<path fill="none" stroke="black" d="M18041.23,-10864C18041.23,-10849.11 18041.23,-10835 18041.23,-10835 18041.23,-10835 16076.98,-10835 16076.98,-10835 16076.98,-10835 16076.98,-10766.42 16076.98,-10766.42"/>
<polygon fill="black" stroke="black" points="16080.48,-10766.42 16076.98,-10756.42 16073.48,-10766.42 16080.48,-10766.42"/>
</g>
<!-- layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_11 -->
<g id="edge45" class="edge">
<title>layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_11</title>
<path fill="none" stroke="black" d="M18082.5,-10864.15C18082.5,-10845.05 18082.5,-10825 18082.5,-10825 18082.5,-10825 17254.51,-10825 17254.51,-10825 17254.51,-10825 17254.51,-10766.18 17254.51,-10766.18"/>
<polygon fill="black" stroke="black" points="17258.01,-10766.18 17254.51,-10756.18 17251.01,-10766.18 17258.01,-10766.18"/>
</g>
<!-- layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_12 -->
<g id="edge46" class="edge">
<title>layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_12</title>
<path fill="none" stroke="black" d="M18123.78,-10863.96C18123.78,-10863.96 18123.78,-10766.33 18123.78,-10766.33"/>
<polygon fill="black" stroke="black" points="18127.28,-10766.33 18123.78,-10756.33 18120.28,-10766.33 18127.28,-10766.33"/>
</g>
<!-- layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_13 -->
<g id="edge47" class="edge">
<title>layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_13</title>
<path fill="none" stroke="black" d="M18412.9,-10909C18416.92,-10909 18419.14,-10909 18419.14,-10909 18419.14,-10909 18419.14,-10665 18419.14,-10665 18419.14,-10665 18484.28,-10665 18484.28,-10665"/>
<polygon fill="black" stroke="black" points="18484.28,-10668.5 18494.28,-10665 18484.28,-10661.5 18484.28,-10668.5"/>
</g>
<!-- layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_14 -->
<g id="edge48" class="edge">
<title>layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_14</title>
<path fill="none" stroke="black" d="M18165.05,-10863.7C18165.05,-10841.98 18165.05,-10818 18165.05,-10818 18165.05,-10818 19589.4,-10818 19589.4,-10818 19589.4,-10818 19589.4,-10766.51 19589.4,-10766.51"/>
<polygon fill="black" stroke="black" points="19592.9,-10766.51 19589.4,-10756.51 19585.9,-10766.51 19592.9,-10766.51"/>
</g>
<!-- layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_15 -->
<g id="edge49" class="edge">
<title>layer_0_attn_proj_1&#45;&gt;layer_0_recv_attn_15</title>
<path fill="none" stroke="black" d="M18206.32,-10864.04C18206.32,-10835.35 18206.32,-10799 18206.32,-10799 18206.32,-10799 20662.79,-10799 20662.79,-10799 20662.79,-10799 20662.79,-10766.47 20662.79,-10766.47"/>
<polygon fill="black" stroke="black" points="20666.29,-10766.47 20662.79,-10756.47 20659.29,-10766.47 20666.29,-10766.47"/>
</g>
<!-- layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_8 -->
<g id="edge50" class="edge">
<title>layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_8</title>
<path fill="none" stroke="black" d="M18843.44,-10864.13C18843.44,-10859.34 18843.44,-10856 18843.44,-10856 18843.44,-10856 21726.39,-10856 21726.39,-10856 21726.39,-10856 21726.39,-10766.43 21726.39,-10766.43"/>
<polygon fill="black" stroke="black" points="21729.89,-10766.43 21726.39,-10756.43 21722.89,-10766.43 21729.89,-10766.43"/>
</g>
<!-- layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_9 -->
<g id="edge51" class="edge">
<title>layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_9</title>
<path fill="none" stroke="black" d="M18472.24,-10863.91C18472.24,-10831.24 18472.24,-10787 18472.24,-10787 18472.24,-10787 15117.98,-10787 15117.98,-10787 15117.98,-10787 15117.98,-10766.27 15117.98,-10766.27"/>
<polygon fill="black" stroke="black" points="15121.48,-10766.27 15117.98,-10756.27 15114.48,-10766.27 15121.48,-10766.27"/>
</g>
<!-- layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_10 -->
<g id="edge52" class="edge">
<title>layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_10</title>
<path fill="none" stroke="black" d="M18513.49,-10863.99C18513.49,-10829.09 18513.49,-10780 18513.49,-10780 18513.49,-10780 16181.58,-10780 16181.58,-10780 16181.58,-10780 16181.58,-10766.35 16181.58,-10766.35"/>
<polygon fill="black" stroke="black" points="16185.08,-10766.35 16181.58,-10756.35 16178.08,-10766.35 16185.08,-10766.35"/>
</g>
<!-- layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_11 -->
<g id="edge53" class="edge">
<title>layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_11</title>
<path fill="none" stroke="black" d="M18595.98,-10863.97C18595.98,-10839.55 18595.98,-10811 18595.98,-10811 18595.98,-10811 17294.49,-10811 17294.49,-10811 17294.49,-10811 17294.49,-10766.41 17294.49,-10766.41"/>
<polygon fill="black" stroke="black" points="17297.99,-10766.41 17294.49,-10756.41 17290.99,-10766.41 17297.99,-10766.41"/>
</g>
<!-- layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_12 -->
<g id="edge54" class="edge">
<title>layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_12</title>
<path fill="none" stroke="black" d="M18430.67,-10886C18426.96,-10886 18424.91,-10886 18424.91,-10886 18424.91,-10886 18424.91,-10710 18424.91,-10710 18424.91,-10710 18358.24,-10710 18358.24,-10710"/>
<polygon fill="black" stroke="black" points="18358.24,-10706.5 18348.24,-10710 18358.24,-10713.5 18358.24,-10706.5"/>
</g>
<!-- layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_13 -->
<g id="edge55" class="edge">
<title>layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_13</title>
<path fill="none" stroke="black" d="M18719.71,-10863.96C18719.71,-10863.96 18719.71,-10766.33 18719.71,-10766.33"/>
<polygon fill="black" stroke="black" points="18723.21,-10766.33 18719.71,-10756.33 18716.21,-10766.33 18723.21,-10766.33"/>
</g>
<!-- layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_14 -->
<g id="edge56" class="edge">
<title>layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_14</title>
<path fill="none" stroke="black" d="M18760.95,-10864.08C18760.95,-10847.04 18760.95,-10830 18760.95,-10830 18760.95,-10830 19629.28,-10830 19629.28,-10830 19629.28,-10830 19629.28,-10766.18 19629.28,-10766.18"/>
<polygon fill="black" stroke="black" points="19632.78,-10766.18 19629.28,-10756.18 19625.78,-10766.18 19632.78,-10766.18"/>
</g>
<!-- layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_15 -->
<g id="edge57" class="edge">
<title>layer_0_attn_proj_2&#45;&gt;layer_0_recv_attn_15</title>
<path fill="none" stroke="black" d="M18802.2,-10863.88C18802.2,-10852.18 18802.2,-10842 18802.2,-10842 18802.2,-10842 20767.39,-10842 20767.39,-10842 20767.39,-10842 20767.39,-10766.54 20767.39,-10766.54"/>
<polygon fill="black" stroke="black" points="20770.89,-10766.54 20767.39,-10756.54 20763.89,-10766.54 20770.89,-10766.54"/>
</g>
<!-- layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_8 -->
<g id="edge58" class="edge">
<title>layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_8</title>
<path fill="none" stroke="black" d="M19306.24,-10864.12C19306.24,-10861.01 19306.24,-10859 19306.24,-10859 19306.24,-10859 21830.98,-10859 21830.98,-10859 21830.98,-10859 21830.98,-10766.18 21830.98,-10766.18"/>
<polygon fill="black" stroke="black" points="21834.48,-10766.18 21830.98,-10756.18 21827.48,-10766.18 21834.48,-10766.18"/>
</g>
<!-- layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_9 -->
<g id="edge59" class="edge">
<title>layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_9</title>
<path fill="none" stroke="black" d="M18953.13,-10863.91C18953.13,-10830.28 18953.13,-10784 18953.13,-10784 18953.13,-10784 15222.58,-10784 15222.58,-10784 15222.58,-10784 15222.58,-10766.28 15222.58,-10766.28"/>
<polygon fill="black" stroke="black" points="15226.08,-10766.28 15222.58,-10756.28 15219.08,-10766.28 15226.08,-10766.28"/>
</g>
<!-- layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_10 -->
<g id="edge60" class="edge">
<title>layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_10</title>
<path fill="none" stroke="black" d="M19003.57,-10864.09C19003.57,-10828.25 19003.57,-10777 19003.57,-10777 19003.57,-10777 16286.18,-10777 16286.18,-10777 16286.18,-10777 16286.18,-10766.4 16286.18,-10766.4"/>
<polygon fill="black" stroke="black" points="16289.68,-10766.4 16286.18,-10756.4 16282.68,-10766.4 16289.68,-10766.4"/>
</g>
<!-- layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_11 -->
<g id="edge61" class="edge">
<title>layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_11</title>
<path fill="none" stroke="black" d="M19054.02,-10864.02C19054.02,-10826.66 19054.02,-10772 19054.02,-10772 19054.02,-10772 17334.46,-10772 17334.46,-10772 17334.46,-10772 17334.46,-10766.23 17334.46,-10766.23"/>
<polygon fill="black" stroke="black" points="17337.96,-10766.23 17334.46,-10756.23 17330.96,-10766.23 17337.96,-10766.23"/>
</g>
<!-- layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_12 -->
<g id="edge62" class="edge">
<title>layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_12</title>
<path fill="none" stroke="black" d="M19104.46,-10864.1C19104.46,-10844.21 19104.46,-10823 19104.46,-10823 19104.46,-10823 18288.87,-10823 18288.87,-10823 18288.87,-10823 18288.87,-10766.37 18288.87,-10766.37"/>
<polygon fill="black" stroke="black" points="18292.37,-10766.37 18288.87,-10756.37 18285.37,-10766.37 18292.37,-10766.37"/>
</g>
<!-- layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_13 -->
<g id="edge63" class="edge">
<title>layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_13</title>
<path fill="none" stroke="black" d="M19154.91,-10863.96C19154.91,-10863.96 19154.91,-10766.33 19154.91,-10766.33"/>
<polygon fill="black" stroke="black" points="19158.41,-10766.33 19154.91,-10756.33 19151.41,-10766.33 19158.41,-10766.33"/>
</g>
<!-- layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_14 -->
<g id="edge64" class="edge">
<title>layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_14</title>
<path fill="none" stroke="black" d="M19205.35,-10863.92C19205.35,-10847.78 19205.35,-10832 19205.35,-10832 19205.35,-10832 19669.16,-10832 19669.16,-10832 19669.16,-10832 19669.16,-10766.29 19669.16,-10766.29"/>
<polygon fill="black" stroke="black" points="19672.66,-10766.29 19669.16,-10756.29 19665.66,-10766.29 19672.66,-10766.29"/>
</g>
<!-- layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_15 -->
<g id="edge65" class="edge">
<title>layer_0_attn_proj_3&#45;&gt;layer_0_recv_attn_15</title>
<path fill="none" stroke="black" d="M19255.8,-10863.86C19255.8,-10853.11 19255.8,-10844 19255.8,-10844 19255.8,-10844 20871.98,-10844 20871.98,-10844 20871.98,-10844 20871.98,-10766.52 20871.98,-10766.52"/>
<polygon fill="black" stroke="black" points="20875.48,-10766.52 20871.98,-10756.52 20868.48,-10766.52 20875.48,-10766.52"/>
</g>
<!-- layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_8 -->
<g id="edge66" class="edge">
<title>layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_8</title>
<path fill="none" stroke="black" d="M19788.81,-10863.92C19788.81,-10862.1 19788.81,-10861 19788.81,-10861 19788.81,-10861 21935.58,-10861 21935.58,-10861 21935.58,-10861 21935.58,-10766.47 21935.58,-10766.47"/>
<polygon fill="black" stroke="black" points="21939.08,-10766.47 21935.58,-10756.47 21932.08,-10766.47 21939.08,-10766.47"/>
</g>
<!-- layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_9 -->
<g id="edge67" class="edge">
<title>layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_9</title>
<path fill="none" stroke="black" d="M19386.17,-10864.14C19386.17,-10773.49 19386.17,-10533 19386.17,-10533 19386.17,-10533 15228.79,-10533 15228.79,-10533 15228.79,-10533 15228.79,-10610.11 15228.79,-10610.11"/>
<polygon fill="black" stroke="black" points="15225.29,-10610.11 15228.79,-10620.11 15232.29,-10610.11 15225.29,-10610.11"/>
</g>
<!-- layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_10 -->
<g id="edge68" class="edge">
<title>layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_10</title>
<path fill="none" stroke="black" d="M19382.34,-10864.01C19382.34,-10777.21 19382.34,-10555 19382.34,-10555 19382.34,-10555 16187.79,-10555 16187.79,-10555 16187.79,-10555 16187.79,-10610.02 16187.79,-10610.02"/>
<polygon fill="black" stroke="black" points="16184.29,-10610.02 16187.79,-10620.02 16191.29,-10610.02 16184.29,-10610.02"/>
</g>
<!-- layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_11 -->
<g id="edge69" class="edge">
<title>layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_11</title>
<path fill="none" stroke="black" d="M19509.64,-10864.16C19509.64,-10826.19 19509.64,-10770 19509.64,-10770 19509.64,-10770 17374.43,-10770 17374.43,-10770 17374.43,-10770 17374.43,-10766.49 17374.43,-10766.49"/>
<polygon fill="black" stroke="black" points="17377.93,-10766.49 17374.43,-10756.49 17370.93,-10766.49 17377.93,-10766.49"/>
</g>
<!-- layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_12 -->
<g id="edge70" class="edge">
<title>layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_12</title>
<path fill="none" stroke="black" d="M19378.51,-10864.11C19378.51,-10843.04 19378.51,-10820 19378.51,-10820 19378.51,-10820 18330.14,-10820 18330.14,-10820 18330.14,-10820 18330.14,-10766.4 18330.14,-10766.4"/>
<polygon fill="black" stroke="black" points="18333.64,-10766.4 18330.14,-10756.4 18326.64,-10766.4 18333.64,-10766.4"/>
</g>
<!-- layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_13 -->
<g id="edge71" class="edge">
<title>layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_13</title>
<path fill="none" stroke="black" d="M19374.47,-10898C19366.53,-10898 19361.91,-10898 19361.91,-10898 19361.91,-10898 19361.91,-10698.32 19361.91,-10698.32"/>
<polygon fill="black" stroke="black" points="19365.41,-10698.32 19361.91,-10688.32 19358.41,-10698.32 19365.41,-10698.32"/>
</g>
<!-- layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_14 -->
<g id="edge72" class="edge">
<title>layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_14</title>
<path fill="none" stroke="black" d="M19709.04,-10863.96C19709.04,-10863.96 19709.04,-10766.33 19709.04,-10766.33"/>
<polygon fill="black" stroke="black" points="19712.54,-10766.33 19709.04,-10756.33 19705.54,-10766.33 19712.54,-10766.33"/>
</g>
<!-- layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_15 -->
<g id="edge73" class="edge">
<title>layer_0_attn_proj_4&#45;&gt;layer_0_recv_attn_15</title>
<path fill="none" stroke="black" d="M19748.92,-10864.04C19748.92,-10854.65 19748.92,-10847 19748.92,-10847 19748.92,-10847 20976.58,-10847 20976.58,-10847 20976.58,-10847 20976.58,-10766.45 20976.58,-10766.45"/>
<polygon fill="black" stroke="black" points="20980.08,-10766.45 20976.58,-10756.45 20973.08,-10766.45 20980.08,-10766.45"/>
</g>
<!-- layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_8 -->
<g id="edge74" class="edge">
<title>layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_8</title>
<path fill="none" stroke="black" d="M20300.71,-10898C20818.07,-10898 22040.18,-10898 22040.18,-10898 22040.18,-10898 22040.18,-10766.29 22040.18,-10766.29"/>
<polygon fill="black" stroke="black" points="22043.68,-10766.29 22040.18,-10756.29 22036.68,-10766.29 22043.68,-10766.29"/>
</g>
<!-- layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_9 -->
<g id="edge75" class="edge">
<title>layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_9</title>
<path fill="none" stroke="black" d="M19911.54,-10863.94C19911.54,-10829.67 19911.54,-10782 19911.54,-10782 19911.54,-10782 15327.18,-10782 15327.18,-10782 15327.18,-10782 15327.18,-10766.36 15327.18,-10766.36"/>
<polygon fill="black" stroke="black" points="15330.68,-10766.36 15327.18,-10756.36 15323.68,-10766.36 15330.68,-10766.36"/>
</g>
<!-- layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_10 -->
<g id="edge76" class="edge">
<title>layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_10</title>
<path fill="none" stroke="black" d="M19976.4,-10863.86C19976.4,-10827.41 19976.4,-10775 19976.4,-10775 19976.4,-10775 16390.77,-10775 16390.77,-10775 16390.77,-10775 16390.77,-10766.58 16390.77,-10766.58"/>
<polygon fill="black" stroke="black" points="16394.28,-10766.58 16390.77,-10756.58 16387.28,-10766.58 16394.28,-10766.58"/>
</g>
<!-- layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_11 -->
<g id="edge77" class="edge">
<title>layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_11</title>
<path fill="none" stroke="black" d="M20041.26,-10863.97C20041.26,-10825.4 20041.26,-10768 20041.26,-10768 20041.26,-10768 17414.4,-10768 17414.4,-10768 17414.4,-10768 17414.4,-10766.22 17414.4,-10766.22"/>
<polygon fill="black" stroke="black" points="17417.9,-10766.22 17414.4,-10756.22 17410.9,-10766.22 17417.9,-10766.22"/>
</g>
<!-- layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_12 -->
<g id="edge78" class="edge">
<title>layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_12</title>
<path fill="none" stroke="black" d="M20106.11,-10864.08C20106.11,-10838.54 20106.11,-10808 20106.11,-10808 20106.11,-10808 18371.41,-10808 18371.41,-10808 18371.41,-10808 18371.41,-10766.48 18371.41,-10766.48"/>
<polygon fill="black" stroke="black" points="18374.91,-10766.48 18371.41,-10756.48 18367.91,-10766.48 18374.91,-10766.48"/>
</g>
<!-- layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_13 -->
<g id="edge79" class="edge">
<title>layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_13</title>
<path fill="none" stroke="black" d="M20170.97,-10863.88C20170.97,-10822.38 20170.97,-10758 20170.97,-10758 20170.97,-10758 19367.14,-10758 19367.14,-10758 19367.14,-10758 19367.14,-10698.22 19367.14,-10698.22"/>
<polygon fill="black" stroke="black" points="19370.64,-10698.22 19367.14,-10688.22 19363.64,-10698.22 19370.64,-10698.22"/>
</g>
<!-- layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_14 -->
<g id="edge80" class="edge">
<title>layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_14</title>
<path fill="none" stroke="black" d="M20235.83,-10863.96C20235.83,-10863.96 20235.83,-10766.33 20235.83,-10766.33"/>
<polygon fill="black" stroke="black" points="20239.33,-10766.33 20235.83,-10756.33 20232.33,-10766.33 20239.33,-10766.33"/>
</g>
<!-- layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_15 -->
<g id="edge81" class="edge">
<title>layer_0_attn_proj_5&#45;&gt;layer_0_recv_attn_15</title>
<path fill="none" stroke="black" d="M20300.75,-10881C20626,-10881 21185.77,-10881 21185.77,-10881 21185.77,-10881 21185.77,-10766.42 21185.77,-10766.42"/>
<polygon fill="black" stroke="black" points="21189.28,-10766.42 21185.77,-10756.42 21182.28,-10766.42 21189.28,-10766.42"/>
</g>
<!-- layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_8 -->
<g id="edge82" class="edge">
<title>layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_8</title>
<path fill="none" stroke="black" d="M16931.83,-10863.91C16931.83,-10835.93 16931.83,-10801 16931.83,-10801 16931.83,-10801 21412.6,-10801 21412.6,-10801 21412.6,-10801 21412.6,-10704.23 21412.6,-10704.23"/>
<polygon fill="black" stroke="black" points="21416.1,-10704.23 21412.6,-10694.23 21409.1,-10704.23 21416.1,-10704.23"/>
</g>
<!-- layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_9 -->
<g id="edge83" class="edge">
<title>layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_9</title>
<path fill="none" stroke="black" d="M16542.23,-10898C16004.48,-10898 14699.6,-10898 14699.6,-10898 14699.6,-10898 14699.6,-10704.22 14699.6,-10704.22"/>
<polygon fill="black" stroke="black" points="14703.1,-10704.22 14699.6,-10694.22 14696.1,-10704.22 14703.1,-10704.22"/>
</g>
<!-- layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_10 -->
<g id="edge84" class="edge">
<title>layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_10</title>
<path fill="none" stroke="black" d="M16542.55,-10881C16245.7,-10881 15763.19,-10881 15763.19,-10881 15763.19,-10881 15763.19,-10766.42 15763.19,-10766.42"/>
<polygon fill="black" stroke="black" points="15766.69,-10766.42 15763.19,-10756.42 15759.69,-10766.42 15766.69,-10766.42"/>
</g>
<!-- layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_11 -->
<g id="edge85" class="edge">
<title>layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_11</title>
<path fill="none" stroke="black" d="M16607.54,-10863.96C16607.54,-10863.96 16607.54,-10698.25 16607.54,-10698.25"/>
<polygon fill="black" stroke="black" points="16611.04,-10698.25 16607.54,-10688.25 16604.04,-10698.25 16611.04,-10698.25"/>
</g>
<!-- layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_12 -->
<g id="edge86" class="edge">
<title>layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_12</title>
<path fill="none" stroke="black" d="M16672.4,-10864.01C16672.4,-10823.1 16672.4,-10760 16672.4,-10760 16672.4,-10760 17476.9,-10760 17476.9,-10760 17476.9,-10760 17476.9,-10698.22 17476.9,-10698.22"/>
<polygon fill="black" stroke="black" points="17480.4,-10698.22 17476.9,-10688.22 17473.4,-10698.22 17480.4,-10698.22"/>
</g>
<!-- layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_13 -->
<g id="edge87" class="edge">
<title>layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_13</title>
<path fill="none" stroke="black" d="M16737.26,-10863.93C16737.26,-10831.91 16737.26,-10789 16737.26,-10789 16737.26,-10789 18554.73,-10789 18554.73,-10789 18554.73,-10789 18554.73,-10718.09 18554.73,-10718.09"/>
<polygon fill="black" stroke="black" points="18558.23,-10718.09 18554.73,-10708.09 18551.23,-10718.09 18558.23,-10718.09"/>
</g>
<!-- layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_14 -->
<g id="edge88" class="edge">
<title>layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_14</title>
<path fill="none" stroke="black" d="M16802.11,-10864.06C16802.11,-10824.02 16802.11,-10763 16802.11,-10763 16802.11,-10763 19429.88,-10763 19429.88,-10763 19429.88,-10763 19429.88,-10698.22 19429.88,-10698.22"/>
<polygon fill="black" stroke="black" points="19433.38,-10698.22 19429.88,-10688.22 19426.38,-10698.22 19433.38,-10698.22"/>
</g>
<!-- layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_15 -->
<g id="edge89" class="edge">
<title>layer_0_attn_proj_6&#45;&gt;layer_0_recv_attn_15</title>
<path fill="none" stroke="black" d="M16866.97,-10864.06C16866.97,-10833.68 16866.97,-10794 16866.97,-10794 16866.97,-10794 20453.6,-10794 20453.6,-10794 20453.6,-10794 20453.6,-10704.16 20453.6,-10704.16"/>
<polygon fill="black" stroke="black" points="20457.1,-10704.16 20453.6,-10694.16 20450.1,-10704.16 20457.1,-10704.16"/>
</g>
<!-- layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_8 -->
<g id="edge90" class="edge">
<title>layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_8</title>
<path fill="none" stroke="black" d="M17457.95,-10863.99C17457.95,-10781.08 17457.95,-10576 17457.95,-10576 17457.95,-10576 21462.12,-10576 21462.12,-10576 21462.12,-10576 21462.12,-10610.01 21462.12,-10610.01"/>
<polygon fill="black" stroke="black" points="21458.62,-10610.01 21462.12,-10620.01 21465.62,-10610.01 21458.62,-10610.01"/>
</g>
<!-- layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_9 -->
<g id="edge91" class="edge">
<title>layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_9</title>
<path fill="none" stroke="black" d="M17054.66,-10863.8C17054.66,-10858.1 17054.66,-10854 17054.66,-10854 17054.66,-10854 14804.19,-10854 14804.19,-10854 14804.19,-10854 14804.19,-10766.57 14804.19,-10766.57"/>
<polygon fill="black" stroke="black" points="14807.69,-10766.57 14804.19,-10756.57 14800.69,-10766.57 14807.69,-10766.57"/>
</g>
<!-- layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_10 -->
<g id="edge92" class="edge">
<title>layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_10</title>
<path fill="none" stroke="black" d="M17094.63,-10863.99C17094.63,-10851.33 17094.63,-10840 17094.63,-10840 17094.63,-10840 15867.79,-10840 15867.79,-10840 15867.79,-10840 15867.79,-10766.53 15867.79,-10766.53"/>
<polygon fill="black" stroke="black" points="15871.29,-10766.53 15867.79,-10756.53 15864.29,-10766.53 15871.29,-10766.53"/>
</g>
<!-- layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_11 -->
<g id="edge93" class="edge">
<title>layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_11</title>
<path fill="none" stroke="black" d="M17134.6,-10863.96C17134.6,-10863.96 17134.6,-10766.33 17134.6,-10766.33"/>
<polygon fill="black" stroke="black" points="17138.1,-10766.33 17134.6,-10756.33 17131.1,-10766.33 17138.1,-10766.33"/>
</g>
<!-- layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_12 -->
<g id="edge94" class="edge">
<title>layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_12</title>
<path fill="none" stroke="black" d="M17468.88,-10898C17477.04,-10898 17481.79,-10898 17481.79,-10898 17481.79,-10898 17481.79,-10698.32 17481.79,-10698.32"/>
<polygon fill="black" stroke="black" points="17485.29,-10698.32 17481.79,-10688.32 17478.29,-10698.32 17485.29,-10698.32"/>
</g>
<!-- layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_13 -->
<g id="edge95" class="edge">
<title>layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_13</title>
<path fill="none" stroke="black" d="M17465.11,-10864.02C17465.11,-10840.32 17465.11,-10813 17465.11,-10813 17465.11,-10813 18637.22,-10813 18637.22,-10813 18637.22,-10813 18637.22,-10766.43 18637.22,-10766.43"/>
<polygon fill="black" stroke="black" points="18640.72,-10766.43 18637.22,-10756.43 18633.72,-10766.43 18640.72,-10766.43"/>
</g>
<!-- layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_14 -->
<g id="edge96" class="edge">
<title>layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_14</title>
<path fill="none" stroke="black" d="M17174.57,-10863.87C17174.57,-10824.42 17174.57,-10765 17174.57,-10765 17174.57,-10765 19469.76,-10765 19469.76,-10765 19469.76,-10765 19469.76,-10698.22 19469.76,-10698.22"/>
<polygon fill="black" stroke="black" points="19473.26,-10698.22 19469.76,-10688.22 19466.26,-10698.22 19473.26,-10698.22"/>
</g>
<!-- layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_15 -->
<g id="edge97" class="edge">
<title>layer_0_attn_proj_7&#45;&gt;layer_0_recv_attn_15</title>
<path fill="none" stroke="black" d="M17461.53,-10864.03C17461.53,-10785.35 17461.53,-10598 17461.53,-10598 17461.53,-10598 20503.12,-10598 20503.12,-10598 20503.12,-10598 20503.12,-10609.83 20503.12,-10609.83"/>
<polygon fill="black" stroke="black" points="20499.62,-10609.83 20503.12,-10619.83 20506.62,-10609.83 20499.62,-10609.83"/>
</g>
<!-- layer_0_recv_attn_8&#45;&gt;layer_0_residual1 -->
<g id="edge98" class="edge">
<title>layer_0_recv_attn_8&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M21616.25,-10620.11C21616.25,-10548.17 21616.25,-10445 21616.25,-10445 21616.25,-10445 18179.71,-10445 18179.71,-10445"/>
<polygon fill="black" stroke="black" points="18179.71,-10441.5 18169.71,-10445 18179.71,-10448.5 18179.71,-10441.5"/>
</g>
<!-- layer_0_recv_attn_9&#45;&gt;layer_0_residual1 -->
<g id="edge99" class="edge">
<title>layer_0_recv_attn_9&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M15382.58,-10647.47C15382.58,-10578.24 15382.58,-10445 15382.58,-10445 15382.58,-10445 17705.49,-10445 17705.49,-10445"/>
<polygon fill="black" stroke="black" points="17705.49,-10448.5 17715.49,-10445 17705.49,-10441.5 17705.49,-10448.5"/>
</g>
<!-- layer_0_recv_attn_10&#45;&gt;layer_0_residual1 -->
<g id="edge100" class="edge">
<title>layer_0_recv_attn_10&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M16341.58,-10647.47C16341.58,-10582.36 16341.58,-10462 16341.58,-10462 16341.58,-10462 17705.41,-10462 17705.41,-10462"/>
<polygon fill="black" stroke="black" points="17705.41,-10465.5 17715.41,-10462 17705.41,-10458.5 17705.41,-10465.5"/>
</g>
<!-- layer_0_recv_attn_11&#45;&gt;layer_0_residual1 -->
<g id="edge101" class="edge">
<title>layer_0_recv_attn_11&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M17223.69,-10620.06C17223.69,-10564.45 17223.69,-10495 17223.69,-10495 17223.69,-10495 17705.68,-10495 17705.68,-10495"/>
<polygon fill="black" stroke="black" points="17705.68,-10498.5 17715.68,-10495 17705.68,-10491.5 17705.68,-10498.5"/>
</g>
<!-- layer_0_recv_attn_12&#45;&gt;layer_0_residual1 -->
<g id="edge102" class="edge">
<title>layer_0_recv_attn_12&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M17942.69,-10619.94C17942.69,-10619.94 17942.69,-10522.38 17942.69,-10522.38"/>
<polygon fill="black" stroke="black" points="17946.19,-10522.38 17942.69,-10512.38 17939.19,-10522.38 17946.19,-10522.38"/>
</g>
<!-- layer_0_recv_attn_13&#45;&gt;layer_0_residual1 -->
<g id="edge103" class="edge">
<title>layer_0_recv_attn_13&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M18662.19,-10620.06C18662.19,-10564.45 18662.19,-10495 18662.19,-10495 18662.19,-10495 18179.85,-10495 18179.85,-10495"/>
<polygon fill="black" stroke="black" points="18179.85,-10491.5 18169.85,-10495 18179.85,-10498.5 18179.85,-10491.5"/>
</g>
<!-- layer_0_recv_attn_14&#45;&gt;layer_0_residual1 -->
<g id="edge104" class="edge">
<title>layer_0_recv_attn_14&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M19621.19,-10619.93C19621.19,-10558.56 19621.19,-10478 19621.19,-10478 19621.19,-10478 18179.93,-10478 18179.93,-10478"/>
<polygon fill="black" stroke="black" points="18179.93,-10474.5 18169.93,-10478 18179.93,-10481.5 18179.93,-10474.5"/>
</g>
<!-- layer_0_recv_attn_15&#45;&gt;layer_0_residual1 -->
<g id="edge105" class="edge">
<title>layer_0_recv_attn_15&#45;&gt;layer_0_residual1</title>
<path fill="none" stroke="black" d="M20657.25,-10620C20657.25,-10553.41 20657.25,-10462 20657.25,-10462 20657.25,-10462 18179.75,-10462 18179.75,-10462"/>
<polygon fill="black" stroke="black" points="18179.75,-10458.5 18169.75,-10462 18179.75,-10465.5 18179.75,-10458.5"/>
</g>
<!-- layer_0_ln2 -->
<g id="node44" class="node">
<title>layer_0_ln2</title>
<polygon fill="#ffe6e6" stroke="black" points="18169.69,-10321.17 17715.69,-10321.17 17715.69,-10253.17 18169.69,-10253.17 18169.69,-10321.17"/>
<text text-anchor="middle" x="17942.69" y="-10305.97" font-family="monospace" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="17942.69" y="-10290.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17942.69" y="-10275.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17942.69" y="-10260.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_residual1&#45;&gt;layer_0_ln2 -->
<g id="edge107" class="edge">
<title>layer_0_residual1&#45;&gt;layer_0_ln2</title>
<path fill="none" stroke="black" d="M17942.69,-10429.03C17942.69,-10429.03 17942.69,-10331.27 17942.69,-10331.27"/>
<polygon fill="black" stroke="black" points="17946.19,-10331.27 17942.69,-10321.27 17939.19,-10331.27 17946.19,-10331.27"/>
</g>
<!-- layer_0_gate -->
<g id="node45" class="node">
<title>layer_0_gate</title>
<polygon fill="#ffe6e6" stroke="black" points="18404.97,-10145.17 17669.58,-10145.17 17480.4,-10009.17 18215.79,-10009.17 18404.97,-10145.17"/>
<text text-anchor="middle" x="17942.69" y="-10095.97" font-family="monospace" font-size="14.00">Gate (Top&#45;2 routing)</text>
<text text-anchor="middle" x="17942.69" y="-10080.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17942.69" y="-10065.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, top_k=2]</text>
<text text-anchor="middle" x="17942.69" y="-10050.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_gate -->
<g id="edge108" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" d="M17942.69,-10252.96C17942.69,-10252.96 17942.69,-10155.33 17942.69,-10155.33"/>
<polygon fill="black" stroke="black" points="17946.19,-10155.33 17942.69,-10145.33 17939.19,-10155.33 17946.19,-10155.33"/>
</g>
<!-- layer_0_expert_select_8 -->
<g id="node62" class="node">
<title>layer_0_expert_select_8</title>
<polygon fill="#ffe6e6" stroke="black" points="15057.56,-9901.17 14308.51,-9901.17 14115.81,-9765.17 14864.87,-9765.17 15057.56,-9901.17"/>
<text text-anchor="middle" x="14586.69" y="-9851.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="14586.69" y="-9836.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14586.69" y="-9821.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14586.69" y="-9806.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_select_8 -->
<g id="edge109" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_select_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17622,-10111C16826.47,-10111 14826.19,-10111 14826.19,-10111 14826.19,-10111 14826.19,-9911.49 14826.19,-9911.49"/>
<polygon fill="black" stroke="black" points="14829.69,-9911.49 14826.19,-9901.49 14822.69,-9911.49 14829.69,-9911.49"/>
</g>
<!-- layer_0_expert_select_9 -->
<g id="node63" class="node">
<title>layer_0_expert_select_9</title>
<polygon fill="#ffe6e6" stroke="black" points="16016.56,-9901.17 15267.51,-9901.17 15074.81,-9765.17 15823.87,-9765.17 16016.56,-9901.17"/>
<text text-anchor="middle" x="15545.69" y="-9851.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="15545.69" y="-9836.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15545.69" y="-9821.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15545.69" y="-9806.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_select_9 -->
<g id="edge110" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_select_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17574.56,-10077C16958.43,-10077 15785.19,-10077 15785.19,-10077 15785.19,-10077 15785.19,-9911.41 15785.19,-9911.41"/>
<polygon fill="black" stroke="black" points="15788.69,-9911.41 15785.19,-9901.41 15781.69,-9911.41 15788.69,-9911.41"/>
</g>
<!-- layer_0_expert_select_10 -->
<g id="node64" class="node">
<title>layer_0_expert_select_10</title>
<polygon fill="#ffe6e6" stroke="black" points="16975.56,-9901.17 16226.51,-9901.17 16033.81,-9765.17 16782.87,-9765.17 16975.56,-9901.17"/>
<text text-anchor="middle" x="16504.69" y="-9851.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="16504.69" y="-9836.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16504.69" y="-9821.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16504.69" y="-9806.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_select_10 -->
<g id="edge111" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_select_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17527.29,-10043C17181.07,-10043 16744.19,-10043 16744.19,-10043 16744.19,-10043 16744.19,-9911.29 16744.19,-9911.29"/>
<polygon fill="black" stroke="black" points="16747.69,-9911.29 16744.19,-9901.29 16740.69,-9911.29 16747.69,-9911.29"/>
</g>
<!-- layer_0_expert_select_11 -->
<g id="node65" class="node">
<title>layer_0_expert_select_11</title>
<polygon fill="#ffe6e6" stroke="black" points="17934.56,-9901.17 17185.51,-9901.17 16992.81,-9765.17 17741.87,-9765.17 17934.56,-9901.17"/>
<text text-anchor="middle" x="17463.69" y="-9851.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="17463.69" y="-9836.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="17463.69" y="-9821.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17463.69" y="-9806.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_select_11 -->
<g id="edge112" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_select_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17707.33,-10008.87C17707.33,-10008.87 17707.33,-9911.44 17707.33,-9911.44"/>
<polygon fill="black" stroke="black" points="17710.83,-9911.44 17707.33,-9901.44 17703.83,-9911.44 17710.83,-9911.44"/>
</g>
<!-- layer_0_expert_select_12 -->
<g id="node66" class="node">
<title>layer_0_expert_select_12</title>
<polygon fill="#ffe6e6" stroke="black" points="18893.56,-9901.17 18144.51,-9901.17 17951.81,-9765.17 18700.87,-9765.17 18893.56,-9901.17"/>
<text text-anchor="middle" x="18422.69" y="-9851.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="18422.69" y="-9836.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="18422.69" y="-9821.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18422.69" y="-9806.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_select_12 -->
<g id="edge113" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_select_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18178.54,-10008.87C18178.54,-10008.87 18178.54,-9911.44 18178.54,-9911.44"/>
<polygon fill="black" stroke="black" points="18182.04,-9911.44 18178.54,-9901.44 18175.04,-9911.44 18182.04,-9911.44"/>
</g>
<!-- layer_0_expert_select_13 -->
<g id="node67" class="node">
<title>layer_0_expert_select_13</title>
<polygon fill="#ffe6e6" stroke="black" points="19852.56,-9901.17 19103.51,-9901.17 18910.81,-9765.17 19659.87,-9765.17 19852.56,-9901.17"/>
<text text-anchor="middle" x="19381.69" y="-9851.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="19381.69" y="-9836.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="19381.69" y="-9821.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19381.69" y="-9806.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_select_13 -->
<g id="edge114" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_select_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18263.21,-10043C18618.38,-10043 19141.69,-10043 19141.69,-10043 19141.69,-10043 19141.69,-9911.29 19141.69,-9911.29"/>
<polygon fill="black" stroke="black" points="19145.19,-9911.29 19141.69,-9901.29 19138.19,-9911.29 19145.19,-9911.29"/>
</g>
<!-- layer_0_expert_select_14 -->
<g id="node68" class="node">
<title>layer_0_expert_select_14</title>
<polygon fill="#ffe6e6" stroke="black" points="20811.56,-9901.17 20062.51,-9901.17 19869.81,-9765.17 20618.87,-9765.17 20811.56,-9901.17"/>
<text text-anchor="middle" x="20340.69" y="-9851.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="20340.69" y="-9836.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="20340.69" y="-9821.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20340.69" y="-9806.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_select_14 -->
<g id="edge115" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_select_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18310.29,-10077C18926.39,-10077 20100.69,-10077 20100.69,-10077 20100.69,-10077 20100.69,-9911.41 20100.69,-9911.41"/>
<polygon fill="black" stroke="black" points="20104.19,-9911.41 20100.69,-9901.41 20097.19,-9911.41 20104.19,-9911.41"/>
</g>
<!-- layer_0_expert_select_15 -->
<g id="node69" class="node">
<title>layer_0_expert_select_15</title>
<polygon fill="#ffe6e6" stroke="black" points="21770.56,-9901.17 21021.51,-9901.17 20828.81,-9765.17 21577.87,-9765.17 21770.56,-9901.17"/>
<text text-anchor="middle" x="21299.69" y="-9851.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="21299.69" y="-9836.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="21299.69" y="-9821.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="21299.69" y="-9806.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_select_15 -->
<g id="edge116" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_select_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18357.81,-10111C19206.25,-10111 21059.69,-10111 21059.69,-10111 21059.69,-10111 21059.69,-9911.49 21059.69,-9911.49"/>
<polygon fill="black" stroke="black" points="21063.19,-9911.49 21059.69,-9901.49 21056.19,-9911.49 21063.19,-9911.49"/>
</g>
<!-- layer_0_expert_0_gpu_8 -->
<g id="node46" class="node">
<title>layer_0_expert_0_gpu_8</title>
<polygon fill="#ffe6e6" stroke="black" points="14630.69,-9657.17 14176.69,-9657.17 14176.69,-9589.17 14630.69,-9589.17 14630.69,-9657.17"/>
<text text-anchor="middle" x="14403.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="14403.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14403.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14403.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_8 -->
<g id="node70" class="node">
<title>layer_0_expert_agg_8</title>
<polygon fill="#fff0e6" stroke="black" points="15057.56,-9481.17 14308.51,-9481.17 14115.81,-9345.17 14864.87,-9345.17 15057.56,-9481.17"/>
<text text-anchor="middle" x="14586.69" y="-9431.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14586.69" y="-9416.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14586.69" y="-9401.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14586.69" y="-9386.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_0_gpu_8&#45;&gt;layer_0_expert_agg_8 -->
<g id="edge133" class="edge">
<title>layer_0_expert_0_gpu_8&#45;&gt;layer_0_expert_agg_8</title>
<path fill="none" stroke="black" d="M14403.69,-9588.96C14403.69,-9588.96 14403.69,-9491.33 14403.69,-9491.33"/>
<polygon fill="black" stroke="black" points="14407.19,-9491.33 14403.69,-9481.33 14400.19,-9491.33 14407.19,-9491.33"/>
</g>
<!-- layer_0_expert_1_gpu_8 -->
<g id="node47" class="node">
<title>layer_0_expert_1_gpu_8</title>
<polygon fill="#ffe6e6" stroke="black" points="15102.69,-9657.17 14648.69,-9657.17 14648.69,-9589.17 15102.69,-9589.17 15102.69,-9657.17"/>
<text text-anchor="middle" x="14875.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14875.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14875.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14875.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_1_gpu_8&#45;&gt;layer_0_expert_agg_8 -->
<g id="edge134" class="edge">
<title>layer_0_expert_1_gpu_8&#45;&gt;layer_0_expert_agg_8</title>
<path fill="none" stroke="black" d="M14853.03,-9588.96C14853.03,-9588.96 14853.03,-9491.33 14853.03,-9491.33"/>
<polygon fill="black" stroke="black" points="14856.53,-9491.33 14853.03,-9481.33 14849.53,-9491.33 14856.53,-9491.33"/>
</g>
<!-- layer_0_expert_2_gpu_9 -->
<g id="node48" class="node">
<title>layer_0_expert_2_gpu_9</title>
<polygon fill="#ffe6e6" stroke="black" points="15673.69,-9657.17 15219.69,-9657.17 15219.69,-9589.17 15673.69,-9589.17 15673.69,-9657.17"/>
<text text-anchor="middle" x="15446.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15446.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15446.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15446.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_9 -->
<g id="node71" class="node">
<title>layer_0_expert_agg_9</title>
<polygon fill="#fff0e6" stroke="black" points="16016.56,-9481.17 15267.51,-9481.17 15074.81,-9345.17 15823.87,-9345.17 16016.56,-9481.17"/>
<text text-anchor="middle" x="15545.69" y="-9431.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15545.69" y="-9416.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15545.69" y="-9401.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15545.69" y="-9386.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_2_gpu_9&#45;&gt;layer_0_expert_agg_9 -->
<g id="edge135" class="edge">
<title>layer_0_expert_2_gpu_9&#45;&gt;layer_0_expert_agg_9</title>
<path fill="none" stroke="black" d="M15446.69,-9588.96C15446.69,-9588.96 15446.69,-9491.33 15446.69,-9491.33"/>
<polygon fill="black" stroke="black" points="15450.19,-9491.33 15446.69,-9481.33 15443.19,-9491.33 15450.19,-9491.33"/>
</g>
<!-- layer_0_expert_3_gpu_9 -->
<g id="node49" class="node">
<title>layer_0_expert_3_gpu_9</title>
<polygon fill="#ffe6e6" stroke="black" points="16145.69,-9657.17 15691.69,-9657.17 15691.69,-9589.17 16145.69,-9589.17 16145.69,-9657.17"/>
<text text-anchor="middle" x="15918.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="15918.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15918.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15918.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_3_gpu_9&#45;&gt;layer_0_expert_agg_9 -->
<g id="edge136" class="edge">
<title>layer_0_expert_3_gpu_9&#45;&gt;layer_0_expert_agg_9</title>
<path fill="none" stroke="black" d="M15854.03,-9588.96C15854.03,-9588.96 15854.03,-9491.33 15854.03,-9491.33"/>
<polygon fill="black" stroke="black" points="15857.53,-9491.33 15854.03,-9481.33 15850.53,-9491.33 15857.53,-9491.33"/>
</g>
<!-- layer_0_expert_4_gpu_10 -->
<g id="node50" class="node">
<title>layer_0_expert_4_gpu_10</title>
<polygon fill="#ffe6e6" stroke="black" points="16674.69,-9657.17 16220.69,-9657.17 16220.69,-9589.17 16674.69,-9589.17 16674.69,-9657.17"/>
<text text-anchor="middle" x="16447.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="16447.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16447.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16447.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_10 -->
<g id="node72" class="node">
<title>layer_0_expert_agg_10</title>
<polygon fill="#fff0e6" stroke="black" points="16975.56,-9481.17 16226.51,-9481.17 16033.81,-9345.17 16782.87,-9345.17 16975.56,-9481.17"/>
<text text-anchor="middle" x="16504.69" y="-9431.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16504.69" y="-9416.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16504.69" y="-9401.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16504.69" y="-9386.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_4_gpu_10&#45;&gt;layer_0_expert_agg_10 -->
<g id="edge137" class="edge">
<title>layer_0_expert_4_gpu_10&#45;&gt;layer_0_expert_agg_10</title>
<path fill="none" stroke="black" d="M16447.69,-9588.96C16447.69,-9588.96 16447.69,-9491.33 16447.69,-9491.33"/>
<polygon fill="black" stroke="black" points="16451.19,-9491.33 16447.69,-9481.33 16444.19,-9491.33 16451.19,-9491.33"/>
</g>
<!-- layer_0_expert_5_gpu_10 -->
<g id="node51" class="node">
<title>layer_0_expert_5_gpu_10</title>
<polygon fill="#ffe6e6" stroke="black" points="17146.69,-9657.17 16692.69,-9657.17 16692.69,-9589.17 17146.69,-9589.17 17146.69,-9657.17"/>
<text text-anchor="middle" x="16919.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="16919.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16919.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16919.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_5_gpu_10&#45;&gt;layer_0_expert_agg_10 -->
<g id="edge138" class="edge">
<title>layer_0_expert_5_gpu_10&#45;&gt;layer_0_expert_agg_10</title>
<path fill="none" stroke="black" d="M16834.03,-9588.96C16834.03,-9588.96 16834.03,-9491.33 16834.03,-9491.33"/>
<polygon fill="black" stroke="black" points="16837.53,-9491.33 16834.03,-9481.33 16830.53,-9491.33 16837.53,-9491.33"/>
</g>
<!-- layer_0_expert_6_gpu_11 -->
<g id="node52" class="node">
<title>layer_0_expert_6_gpu_11</title>
<polygon fill="#ffe6e6" stroke="black" points="17654.69,-9657.17 17200.69,-9657.17 17200.69,-9589.17 17654.69,-9589.17 17654.69,-9657.17"/>
<text text-anchor="middle" x="17427.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="17427.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="17427.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17427.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_11 -->
<g id="node73" class="node">
<title>layer_0_expert_agg_11</title>
<polygon fill="#fff0e6" stroke="black" points="17934.56,-9481.17 17185.51,-9481.17 16992.81,-9345.17 17741.87,-9345.17 17934.56,-9481.17"/>
<text text-anchor="middle" x="17463.69" y="-9431.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="17463.69" y="-9416.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="17463.69" y="-9401.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17463.69" y="-9386.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_6_gpu_11&#45;&gt;layer_0_expert_agg_11 -->
<g id="edge139" class="edge">
<title>layer_0_expert_6_gpu_11&#45;&gt;layer_0_expert_agg_11</title>
<path fill="none" stroke="black" d="M17427.69,-9588.96C17427.69,-9588.96 17427.69,-9491.33 17427.69,-9491.33"/>
<polygon fill="black" stroke="black" points="17431.19,-9491.33 17427.69,-9481.33 17424.19,-9491.33 17431.19,-9491.33"/>
</g>
<!-- layer_0_expert_7_gpu_11 -->
<g id="node53" class="node">
<title>layer_0_expert_7_gpu_11</title>
<polygon fill="#ffe6e6" stroke="black" points="18126.69,-9657.17 17672.69,-9657.17 17672.69,-9589.17 18126.69,-9589.17 18126.69,-9657.17"/>
<text text-anchor="middle" x="17899.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="17899.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="17899.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17899.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_7_gpu_11&#45;&gt;layer_0_expert_agg_11 -->
<g id="edge140" class="edge">
<title>layer_0_expert_7_gpu_11&#45;&gt;layer_0_expert_agg_11</title>
<path fill="none" stroke="black" d="M17803.53,-9588.96C17803.53,-9588.96 17803.53,-9491.33 17803.53,-9491.33"/>
<polygon fill="black" stroke="black" points="17807.03,-9491.33 17803.53,-9481.33 17800.03,-9491.33 17807.03,-9491.33"/>
</g>
<!-- layer_0_expert_8_gpu_12 -->
<g id="node54" class="node">
<title>layer_0_expert_8_gpu_12</title>
<polygon fill="#ffe6e6" stroke="black" points="18623.69,-9657.17 18169.69,-9657.17 18169.69,-9589.17 18623.69,-9589.17 18623.69,-9657.17"/>
<text text-anchor="middle" x="18396.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="18396.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="18396.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18396.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_12 -->
<g id="node74" class="node">
<title>layer_0_expert_agg_12</title>
<polygon fill="#fff0e6" stroke="black" points="18893.56,-9481.17 18144.51,-9481.17 17951.81,-9345.17 18700.87,-9345.17 18893.56,-9481.17"/>
<text text-anchor="middle" x="18422.69" y="-9431.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="18422.69" y="-9416.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="18422.69" y="-9401.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18422.69" y="-9386.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_8_gpu_12&#45;&gt;layer_0_expert_agg_12 -->
<g id="edge141" class="edge">
<title>layer_0_expert_8_gpu_12&#45;&gt;layer_0_expert_agg_12</title>
<path fill="none" stroke="black" d="M18396.69,-9588.96C18396.69,-9588.96 18396.69,-9491.33 18396.69,-9491.33"/>
<polygon fill="black" stroke="black" points="18400.19,-9491.33 18396.69,-9481.33 18393.19,-9491.33 18400.19,-9491.33"/>
</g>
<!-- layer_0_expert_9_gpu_12 -->
<g id="node55" class="node">
<title>layer_0_expert_9_gpu_12</title>
<polygon fill="#ffe6e6" stroke="black" points="19095.69,-9657.17 18641.69,-9657.17 18641.69,-9589.17 19095.69,-9589.17 19095.69,-9657.17"/>
<text text-anchor="middle" x="18868.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="18868.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="18868.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18868.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_9_gpu_12&#45;&gt;layer_0_expert_agg_12 -->
<g id="edge142" class="edge">
<title>layer_0_expert_9_gpu_12&#45;&gt;layer_0_expert_agg_12</title>
<path fill="none" stroke="black" d="M18767.53,-9588.96C18767.53,-9588.96 18767.53,-9491.33 18767.53,-9491.33"/>
<polygon fill="black" stroke="black" points="18771.03,-9491.33 18767.53,-9481.33 18764.03,-9491.33 18771.03,-9491.33"/>
</g>
<!-- layer_0_expert_10_gpu_13 -->
<g id="node56" class="node">
<title>layer_0_expert_10_gpu_13</title>
<polygon fill="#ffe6e6" stroke="black" points="19587.69,-9657.17 19133.69,-9657.17 19133.69,-9589.17 19587.69,-9589.17 19587.69,-9657.17"/>
<text text-anchor="middle" x="19360.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="19360.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="19360.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19360.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_13 -->
<g id="node75" class="node">
<title>layer_0_expert_agg_13</title>
<polygon fill="#fff0e6" stroke="black" points="19852.56,-9481.17 19103.51,-9481.17 18910.81,-9345.17 19659.87,-9345.17 19852.56,-9481.17"/>
<text text-anchor="middle" x="19381.69" y="-9431.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="19381.69" y="-9416.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="19381.69" y="-9401.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19381.69" y="-9386.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_10_gpu_13&#45;&gt;layer_0_expert_agg_13 -->
<g id="edge143" class="edge">
<title>layer_0_expert_10_gpu_13&#45;&gt;layer_0_expert_agg_13</title>
<path fill="none" stroke="black" d="M19360.69,-9588.96C19360.69,-9588.96 19360.69,-9491.33 19360.69,-9491.33"/>
<polygon fill="black" stroke="black" points="19364.19,-9491.33 19360.69,-9481.33 19357.19,-9491.33 19364.19,-9491.33"/>
</g>
<!-- layer_0_expert_11_gpu_13 -->
<g id="node57" class="node">
<title>layer_0_expert_11_gpu_13</title>
<polygon fill="#ffe6e6" stroke="black" points="20059.69,-9657.17 19605.69,-9657.17 19605.69,-9589.17 20059.69,-9589.17 20059.69,-9657.17"/>
<text text-anchor="middle" x="19832.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="19832.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="19832.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19832.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_11_gpu_13&#45;&gt;layer_0_expert_agg_13 -->
<g id="edge144" class="edge">
<title>layer_0_expert_11_gpu_13&#45;&gt;layer_0_expert_agg_13</title>
<path fill="none" stroke="black" d="M19729.03,-9588.96C19729.03,-9588.96 19729.03,-9491.33 19729.03,-9491.33"/>
<polygon fill="black" stroke="black" points="19732.53,-9491.33 19729.03,-9481.33 19725.53,-9491.33 19732.53,-9491.33"/>
</g>
<!-- layer_0_expert_12_gpu_14 -->
<g id="node58" class="node">
<title>layer_0_expert_12_gpu_14</title>
<polygon fill="#ffe6e6" stroke="black" points="20549.69,-9657.17 20095.69,-9657.17 20095.69,-9589.17 20549.69,-9589.17 20549.69,-9657.17"/>
<text text-anchor="middle" x="20322.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="20322.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="20322.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20322.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_14 -->
<g id="node76" class="node">
<title>layer_0_expert_agg_14</title>
<polygon fill="#fff0e6" stroke="black" points="20811.56,-9481.17 20062.51,-9481.17 19869.81,-9345.17 20618.87,-9345.17 20811.56,-9481.17"/>
<text text-anchor="middle" x="20340.69" y="-9431.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="20340.69" y="-9416.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="20340.69" y="-9401.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20340.69" y="-9386.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_12_gpu_14&#45;&gt;layer_0_expert_agg_14 -->
<g id="edge145" class="edge">
<title>layer_0_expert_12_gpu_14&#45;&gt;layer_0_expert_agg_14</title>
<path fill="none" stroke="black" d="M20322.69,-9588.96C20322.69,-9588.96 20322.69,-9491.33 20322.69,-9491.33"/>
<polygon fill="black" stroke="black" points="20326.19,-9491.33 20322.69,-9481.33 20319.19,-9491.33 20326.19,-9491.33"/>
</g>
<!-- layer_0_expert_13_gpu_14 -->
<g id="node59" class="node">
<title>layer_0_expert_13_gpu_14</title>
<polygon fill="#ffe6e6" stroke="black" points="21021.69,-9657.17 20567.69,-9657.17 20567.69,-9589.17 21021.69,-9589.17 21021.69,-9657.17"/>
<text text-anchor="middle" x="20794.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="20794.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="20794.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20794.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_13_gpu_14&#45;&gt;layer_0_expert_agg_14 -->
<g id="edge146" class="edge">
<title>layer_0_expert_13_gpu_14&#45;&gt;layer_0_expert_agg_14</title>
<path fill="none" stroke="black" d="M20689.53,-9588.96C20689.53,-9588.96 20689.53,-9491.33 20689.53,-9491.33"/>
<polygon fill="black" stroke="black" points="20693.03,-9491.33 20689.53,-9481.33 20686.03,-9491.33 20693.03,-9491.33"/>
</g>
<!-- layer_0_expert_14_gpu_15 -->
<g id="node60" class="node">
<title>layer_0_expert_14_gpu_15</title>
<polygon fill="#ffe6e6" stroke="black" points="21509.69,-9657.17 21055.69,-9657.17 21055.69,-9589.17 21509.69,-9589.17 21509.69,-9657.17"/>
<text text-anchor="middle" x="21282.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="21282.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="21282.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="21282.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_15 -->
<g id="node77" class="node">
<title>layer_0_expert_agg_15</title>
<polygon fill="#fff0e6" stroke="black" points="21770.56,-9481.17 21021.51,-9481.17 20828.81,-9345.17 21577.87,-9345.17 21770.56,-9481.17"/>
<text text-anchor="middle" x="21299.69" y="-9431.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="21299.69" y="-9416.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="21299.69" y="-9401.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="21299.69" y="-9386.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_14_gpu_15&#45;&gt;layer_0_expert_agg_15 -->
<g id="edge147" class="edge">
<title>layer_0_expert_14_gpu_15&#45;&gt;layer_0_expert_agg_15</title>
<path fill="none" stroke="black" d="M21282.69,-9588.96C21282.69,-9588.96 21282.69,-9491.33 21282.69,-9491.33"/>
<polygon fill="black" stroke="black" points="21286.19,-9491.33 21282.69,-9481.33 21279.19,-9491.33 21286.19,-9491.33"/>
</g>
<!-- layer_0_expert_15_gpu_15 -->
<g id="node61" class="node">
<title>layer_0_expert_15_gpu_15</title>
<polygon fill="#ffe6e6" stroke="black" points="21981.69,-9657.17 21527.69,-9657.17 21527.69,-9589.17 21981.69,-9589.17 21981.69,-9657.17"/>
<text text-anchor="middle" x="21754.69" y="-9641.97" font-family="monospace" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="21754.69" y="-9626.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="21754.69" y="-9611.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="21754.69" y="-9596.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_15_gpu_15&#45;&gt;layer_0_expert_agg_15 -->
<g id="edge148" class="edge">
<title>layer_0_expert_15_gpu_15&#45;&gt;layer_0_expert_agg_15</title>
<path fill="none" stroke="black" d="M21649.03,-9588.96C21649.03,-9588.96 21649.03,-9491.33 21649.03,-9491.33"/>
<polygon fill="black" stroke="black" points="21652.53,-9491.33 21649.03,-9481.33 21645.53,-9491.33 21652.53,-9491.33"/>
</g>
<!-- layer_0_expert_select_8&#45;&gt;layer_0_expert_0_gpu_8 -->
<g id="edge117" class="edge">
<title>layer_0_expert_select_8&#45;&gt;layer_0_expert_0_gpu_8</title>
<path fill="none" stroke="black" d="M14403.69,-9764.99C14403.69,-9764.99 14403.69,-9667.2 14403.69,-9667.2"/>
<polygon fill="black" stroke="black" points="14407.19,-9667.2 14403.69,-9657.2 14400.19,-9667.2 14407.19,-9667.2"/>
</g>
<!-- layer_0_expert_select_8&#45;&gt;layer_0_expert_1_gpu_8 -->
<g id="edge118" class="edge">
<title>layer_0_expert_select_8&#45;&gt;layer_0_expert_1_gpu_8</title>
<path fill="none" stroke="black" d="M14853.03,-9764.99C14853.03,-9764.99 14853.03,-9667.2 14853.03,-9667.2"/>
<polygon fill="black" stroke="black" points="14856.53,-9667.2 14853.03,-9657.2 14849.53,-9667.2 14856.53,-9667.2"/>
</g>
<!-- layer_0_expert_select_9&#45;&gt;layer_0_expert_2_gpu_9 -->
<g id="edge119" class="edge">
<title>layer_0_expert_select_9&#45;&gt;layer_0_expert_2_gpu_9</title>
<path fill="none" stroke="black" d="M15446.69,-9764.99C15446.69,-9764.99 15446.69,-9667.2 15446.69,-9667.2"/>
<polygon fill="black" stroke="black" points="15450.19,-9667.2 15446.69,-9657.2 15443.19,-9667.2 15450.19,-9667.2"/>
</g>
<!-- layer_0_expert_select_9&#45;&gt;layer_0_expert_3_gpu_9 -->
<g id="edge120" class="edge">
<title>layer_0_expert_select_9&#45;&gt;layer_0_expert_3_gpu_9</title>
<path fill="none" stroke="black" d="M15854.03,-9786.3C15854.03,-9786.3 15854.03,-9667.48 15854.03,-9667.48"/>
<polygon fill="black" stroke="black" points="15857.53,-9667.48 15854.03,-9657.48 15850.53,-9667.48 15857.53,-9667.48"/>
</g>
<!-- layer_0_expert_select_10&#45;&gt;layer_0_expert_4_gpu_10 -->
<g id="edge121" class="edge">
<title>layer_0_expert_select_10&#45;&gt;layer_0_expert_4_gpu_10</title>
<path fill="none" stroke="black" d="M16447.69,-9764.99C16447.69,-9764.99 16447.69,-9667.2 16447.69,-9667.2"/>
<polygon fill="black" stroke="black" points="16451.19,-9667.2 16447.69,-9657.2 16444.19,-9667.2 16451.19,-9667.2"/>
</g>
<!-- layer_0_expert_select_10&#45;&gt;layer_0_expert_5_gpu_10 -->
<g id="edge122" class="edge">
<title>layer_0_expert_select_10&#45;&gt;layer_0_expert_5_gpu_10</title>
<path fill="none" stroke="black" d="M16834.03,-9801.27C16834.03,-9801.27 16834.03,-9667.46 16834.03,-9667.46"/>
<polygon fill="black" stroke="black" points="16837.53,-9667.46 16834.03,-9657.46 16830.53,-9667.46 16837.53,-9667.46"/>
</g>
<!-- layer_0_expert_select_11&#45;&gt;layer_0_expert_6_gpu_11 -->
<g id="edge123" class="edge">
<title>layer_0_expert_select_11&#45;&gt;layer_0_expert_6_gpu_11</title>
<path fill="none" stroke="black" d="M17427.69,-9764.99C17427.69,-9764.99 17427.69,-9667.2 17427.69,-9667.2"/>
<polygon fill="black" stroke="black" points="17431.19,-9667.2 17427.69,-9657.2 17424.19,-9667.2 17431.19,-9667.2"/>
</g>
<!-- layer_0_expert_select_11&#45;&gt;layer_0_expert_7_gpu_11 -->
<g id="edge124" class="edge">
<title>layer_0_expert_select_11&#45;&gt;layer_0_expert_7_gpu_11</title>
<path fill="none" stroke="black" d="M17803.53,-9808.67C17803.53,-9808.67 17803.53,-9667.21 17803.53,-9667.21"/>
<polygon fill="black" stroke="black" points="17807.03,-9667.21 17803.53,-9657.21 17800.03,-9667.21 17807.03,-9667.21"/>
</g>
<!-- layer_0_expert_select_12&#45;&gt;layer_0_expert_8_gpu_12 -->
<g id="edge125" class="edge">
<title>layer_0_expert_select_12&#45;&gt;layer_0_expert_8_gpu_12</title>
<path fill="none" stroke="black" d="M18396.69,-9764.99C18396.69,-9764.99 18396.69,-9667.2 18396.69,-9667.2"/>
<polygon fill="black" stroke="black" points="18400.19,-9667.2 18396.69,-9657.2 18393.19,-9667.2 18400.19,-9667.2"/>
</g>
<!-- layer_0_expert_select_12&#45;&gt;layer_0_expert_9_gpu_12 -->
<g id="edge126" class="edge">
<title>layer_0_expert_select_12&#45;&gt;layer_0_expert_9_gpu_12</title>
<path fill="none" stroke="black" d="M18767.53,-9811.87C18767.53,-9811.87 18767.53,-9667.3 18767.53,-9667.3"/>
<polygon fill="black" stroke="black" points="18771.03,-9667.3 18767.53,-9657.3 18764.03,-9667.3 18771.03,-9667.3"/>
</g>
<!-- layer_0_expert_select_13&#45;&gt;layer_0_expert_10_gpu_13 -->
<g id="edge127" class="edge">
<title>layer_0_expert_select_13&#45;&gt;layer_0_expert_10_gpu_13</title>
<path fill="none" stroke="black" d="M19360.69,-9764.99C19360.69,-9764.99 19360.69,-9667.2 19360.69,-9667.2"/>
<polygon fill="black" stroke="black" points="19364.19,-9667.2 19360.69,-9657.2 19357.19,-9667.2 19364.19,-9667.2"/>
</g>
<!-- layer_0_expert_select_13&#45;&gt;layer_0_expert_11_gpu_13 -->
<g id="edge128" class="edge">
<title>layer_0_expert_select_13&#45;&gt;layer_0_expert_11_gpu_13</title>
<path fill="none" stroke="black" d="M19729.03,-9813.79C19729.03,-9813.79 19729.03,-9667.29 19729.03,-9667.29"/>
<polygon fill="black" stroke="black" points="19732.53,-9667.29 19729.03,-9657.29 19725.53,-9667.29 19732.53,-9667.29"/>
</g>
<!-- layer_0_expert_select_14&#45;&gt;layer_0_expert_12_gpu_14 -->
<g id="edge129" class="edge">
<title>layer_0_expert_select_14&#45;&gt;layer_0_expert_12_gpu_14</title>
<path fill="none" stroke="black" d="M20322.69,-9764.99C20322.69,-9764.99 20322.69,-9667.2 20322.69,-9667.2"/>
<polygon fill="black" stroke="black" points="20326.19,-9667.2 20322.69,-9657.2 20319.19,-9667.2 20326.19,-9667.2"/>
</g>
<!-- layer_0_expert_select_14&#45;&gt;layer_0_expert_13_gpu_14 -->
<g id="edge130" class="edge">
<title>layer_0_expert_select_14&#45;&gt;layer_0_expert_13_gpu_14</title>
<path fill="none" stroke="black" d="M20689.53,-9814.9C20689.53,-9814.9 20689.53,-9667.34 20689.53,-9667.34"/>
<polygon fill="black" stroke="black" points="20693.03,-9667.34 20689.53,-9657.34 20686.03,-9667.34 20693.03,-9667.34"/>
</g>
<!-- layer_0_expert_select_15&#45;&gt;layer_0_expert_14_gpu_15 -->
<g id="edge131" class="edge">
<title>layer_0_expert_select_15&#45;&gt;layer_0_expert_14_gpu_15</title>
<path fill="none" stroke="black" d="M21282.69,-9764.99C21282.69,-9764.99 21282.69,-9667.2 21282.69,-9667.2"/>
<polygon fill="black" stroke="black" points="21286.19,-9667.2 21282.69,-9657.2 21279.19,-9667.2 21286.19,-9667.2"/>
</g>
<!-- layer_0_expert_select_15&#45;&gt;layer_0_expert_15_gpu_15 -->
<g id="edge132" class="edge">
<title>layer_0_expert_select_15&#45;&gt;layer_0_expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M21649.03,-9815.26C21649.03,-9815.26 21649.03,-9667.49 21649.03,-9667.49"/>
<polygon fill="black" stroke="black" points="21652.53,-9667.49 21649.03,-9657.49 21645.53,-9667.49 21652.53,-9667.49"/>
</g>
<!-- layer_0_expert_broadcast_8 -->
<g id="node86" class="node">
<title>layer_0_expert_broadcast_8</title>
<polygon fill="#e6ffe6" stroke="black" points="15057.56,-9237.17 14308.51,-9237.17 14115.81,-9101.17 14864.87,-9101.17 15057.56,-9237.17"/>
<text text-anchor="middle" x="14586.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="14586.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="14586.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14586.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_8&#45;&gt;layer_0_expert_broadcast_8 -->
<g id="edge149" class="edge">
<title>layer_0_expert_agg_8&#45;&gt;layer_0_expert_broadcast_8</title>
<path fill="none" stroke="black" d="M14586.69,-9344.87C14586.69,-9344.87 14586.69,-9247.44 14586.69,-9247.44"/>
<polygon fill="black" stroke="black" points="14590.19,-9247.44 14586.69,-9237.44 14583.19,-9247.44 14590.19,-9247.44"/>
</g>
<!-- layer_0_expert_broadcast_9 -->
<g id="node87" class="node">
<title>layer_0_expert_broadcast_9</title>
<polygon fill="#e6ffe6" stroke="black" points="16016.56,-9237.17 15267.51,-9237.17 15074.81,-9101.17 15823.87,-9101.17 16016.56,-9237.17"/>
<text text-anchor="middle" x="15545.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="15545.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="15545.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15545.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_9&#45;&gt;layer_0_expert_broadcast_9 -->
<g id="edge150" class="edge">
<title>layer_0_expert_agg_9&#45;&gt;layer_0_expert_broadcast_9</title>
<path fill="none" stroke="black" d="M15545.69,-9344.87C15545.69,-9344.87 15545.69,-9247.44 15545.69,-9247.44"/>
<polygon fill="black" stroke="black" points="15549.19,-9247.44 15545.69,-9237.44 15542.19,-9247.44 15549.19,-9247.44"/>
</g>
<!-- layer_0_expert_broadcast_10 -->
<g id="node88" class="node">
<title>layer_0_expert_broadcast_10</title>
<polygon fill="#e6ffe6" stroke="black" points="16975.56,-9237.17 16226.51,-9237.17 16033.81,-9101.17 16782.87,-9101.17 16975.56,-9237.17"/>
<text text-anchor="middle" x="16504.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="16504.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="16504.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16504.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_10&#45;&gt;layer_0_expert_broadcast_10 -->
<g id="edge151" class="edge">
<title>layer_0_expert_agg_10&#45;&gt;layer_0_expert_broadcast_10</title>
<path fill="none" stroke="black" d="M16504.69,-9344.87C16504.69,-9344.87 16504.69,-9247.44 16504.69,-9247.44"/>
<polygon fill="black" stroke="black" points="16508.19,-9247.44 16504.69,-9237.44 16501.19,-9247.44 16508.19,-9247.44"/>
</g>
<!-- layer_0_expert_broadcast_11 -->
<g id="node89" class="node">
<title>layer_0_expert_broadcast_11</title>
<polygon fill="#e6ffe6" stroke="black" points="17934.56,-9237.17 17185.51,-9237.17 16992.81,-9101.17 17741.87,-9101.17 17934.56,-9237.17"/>
<text text-anchor="middle" x="17463.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="17463.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="17463.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17463.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_11&#45;&gt;layer_0_expert_broadcast_11 -->
<g id="edge152" class="edge">
<title>layer_0_expert_agg_11&#45;&gt;layer_0_expert_broadcast_11</title>
<path fill="none" stroke="black" d="M17463.69,-9344.87C17463.69,-9344.87 17463.69,-9247.44 17463.69,-9247.44"/>
<polygon fill="black" stroke="black" points="17467.19,-9247.44 17463.69,-9237.44 17460.19,-9247.44 17467.19,-9247.44"/>
</g>
<!-- layer_0_expert_broadcast_12 -->
<g id="node90" class="node">
<title>layer_0_expert_broadcast_12</title>
<polygon fill="#e6ffe6" stroke="black" points="18893.56,-9237.17 18144.51,-9237.17 17951.81,-9101.17 18700.87,-9101.17 18893.56,-9237.17"/>
<text text-anchor="middle" x="18422.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="18422.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="18422.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18422.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_12&#45;&gt;layer_0_expert_broadcast_12 -->
<g id="edge153" class="edge">
<title>layer_0_expert_agg_12&#45;&gt;layer_0_expert_broadcast_12</title>
<path fill="none" stroke="black" d="M18422.69,-9344.87C18422.69,-9344.87 18422.69,-9247.44 18422.69,-9247.44"/>
<polygon fill="black" stroke="black" points="18426.19,-9247.44 18422.69,-9237.44 18419.19,-9247.44 18426.19,-9247.44"/>
</g>
<!-- layer_0_expert_broadcast_13 -->
<g id="node91" class="node">
<title>layer_0_expert_broadcast_13</title>
<polygon fill="#e6ffe6" stroke="black" points="19852.56,-9237.17 19103.51,-9237.17 18910.81,-9101.17 19659.87,-9101.17 19852.56,-9237.17"/>
<text text-anchor="middle" x="19381.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="19381.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="19381.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19381.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_13&#45;&gt;layer_0_expert_broadcast_13 -->
<g id="edge154" class="edge">
<title>layer_0_expert_agg_13&#45;&gt;layer_0_expert_broadcast_13</title>
<path fill="none" stroke="black" d="M19381.69,-9344.87C19381.69,-9344.87 19381.69,-9247.44 19381.69,-9247.44"/>
<polygon fill="black" stroke="black" points="19385.19,-9247.44 19381.69,-9237.44 19378.19,-9247.44 19385.19,-9247.44"/>
</g>
<!-- layer_0_expert_broadcast_14 -->
<g id="node92" class="node">
<title>layer_0_expert_broadcast_14</title>
<polygon fill="#e6ffe6" stroke="black" points="20811.56,-9237.17 20062.51,-9237.17 19869.81,-9101.17 20618.87,-9101.17 20811.56,-9237.17"/>
<text text-anchor="middle" x="20340.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="20340.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="20340.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="20340.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_14&#45;&gt;layer_0_expert_broadcast_14 -->
<g id="edge155" class="edge">
<title>layer_0_expert_agg_14&#45;&gt;layer_0_expert_broadcast_14</title>
<path fill="none" stroke="black" d="M20340.69,-9344.87C20340.69,-9344.87 20340.69,-9247.44 20340.69,-9247.44"/>
<polygon fill="black" stroke="black" points="20344.19,-9247.44 20340.69,-9237.44 20337.19,-9247.44 20344.19,-9247.44"/>
</g>
<!-- layer_0_expert_broadcast_15 -->
<g id="node93" class="node">
<title>layer_0_expert_broadcast_15</title>
<polygon fill="#e6ffe6" stroke="black" points="21770.56,-9237.17 21021.51,-9237.17 20828.81,-9101.17 21577.87,-9101.17 21770.56,-9237.17"/>
<text text-anchor="middle" x="21299.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="21299.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="21299.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="21299.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_agg_15&#45;&gt;layer_0_expert_broadcast_15 -->
<g id="edge156" class="edge">
<title>layer_0_expert_agg_15&#45;&gt;layer_0_expert_broadcast_15</title>
<path fill="none" stroke="black" d="M21299.69,-9344.87C21299.69,-9344.87 21299.69,-9247.44 21299.69,-9247.44"/>
<polygon fill="black" stroke="black" points="21303.19,-9247.44 21299.69,-9237.44 21296.19,-9247.44 21303.19,-9247.44"/>
</g>
<!-- layer_0_expert_broadcast_0 -->
<g id="node78" class="node">
<title>layer_0_expert_broadcast_0</title>
<polygon fill="#e6ffe6" stroke="black" points="7385.56,-9237.17 6636.51,-9237.17 6443.81,-9101.17 7192.87,-9101.17 7385.56,-9237.17"/>
<text text-anchor="middle" x="6914.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="6914.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="6914.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6914.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_residual2 -->
<g id="node94" class="node">
<title>layer_0_residual2</title>
<polygon fill="#fff0e6" stroke="black" points="14333.69,-8993.17 13879.69,-8993.17 13879.69,-8910.17 14333.69,-8910.17 14333.69,-8993.17"/>
<text text-anchor="middle" x="14106.69" y="-8977.97" font-family="monospace" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="14106.69" y="-8962.97" font-family="monospace" font-size="14.00">Input1: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14106.69" y="-8947.97" font-family="monospace" font-size="14.00">Input2: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14106.69" y="-8932.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14106.69" y="-8917.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_expert_broadcast_0&#45;&gt;layer_0_residual2 -->
<g id="edge157" class="edge">
<title>layer_0_expert_broadcast_0&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M7279.19,-9161.98C7279.19,-9121.12 7279.19,-8920 7279.19,-8920 7279.19,-8920 13869.52,-8920 13869.52,-8920"/>
<polygon fill="black" stroke="black" points="13869.52,-8923.5 13879.52,-8920 13869.52,-8916.5 13869.52,-8923.5"/>
</g>
<!-- layer_0_expert_broadcast_1 -->
<g id="node79" class="node">
<title>layer_0_expert_broadcast_1</title>
<polygon fill="#e6ffe6" stroke="black" points="8344.56,-9237.17 7595.51,-9237.17 7402.81,-9101.17 8151.87,-9101.17 8344.56,-9237.17"/>
<text text-anchor="middle" x="7873.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="7873.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="7873.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7873.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_broadcast_1&#45;&gt;layer_0_residual2 -->
<g id="edge158" class="edge">
<title>layer_0_expert_broadcast_1&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M8238.19,-9162.01C8238.19,-9122.21 8238.19,-8930 8238.19,-8930 8238.19,-8930 13869.33,-8930 13869.33,-8930"/>
<polygon fill="black" stroke="black" points="13869.33,-8933.5 13879.33,-8930 13869.33,-8926.5 13869.33,-8933.5"/>
</g>
<!-- layer_0_expert_broadcast_2 -->
<g id="node80" class="node">
<title>layer_0_expert_broadcast_2</title>
<polygon fill="#e6ffe6" stroke="black" points="9303.56,-9237.17 8554.51,-9237.17 8361.81,-9101.17 9110.87,-9101.17 9303.56,-9237.17"/>
<text text-anchor="middle" x="8832.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="8832.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="8832.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8832.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_broadcast_2&#45;&gt;layer_0_residual2 -->
<g id="edge159" class="edge">
<title>layer_0_expert_broadcast_2&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M9197.19,-9162.09C9197.19,-9123.58 9197.19,-8941 9197.19,-8941 9197.19,-8941 13869.33,-8941 13869.33,-8941"/>
<polygon fill="black" stroke="black" points="13869.33,-8944.5 13879.33,-8941 13869.33,-8937.5 13869.33,-8944.5"/>
</g>
<!-- layer_0_expert_broadcast_3 -->
<g id="node81" class="node">
<title>layer_0_expert_broadcast_3</title>
<polygon fill="#e6ffe6" stroke="black" points="10262.56,-9237.17 9513.51,-9237.17 9320.81,-9101.17 10069.87,-9101.17 10262.56,-9237.17"/>
<text text-anchor="middle" x="9791.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="9791.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="9791.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9791.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_broadcast_3&#45;&gt;layer_0_residual2 -->
<g id="edge160" class="edge">
<title>layer_0_expert_broadcast_3&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M10156.19,-9161.91C10156.19,-9124.05 10156.19,-8951 10156.19,-8951 10156.19,-8951 13869.38,-8951 13869.38,-8951"/>
<polygon fill="black" stroke="black" points="13869.38,-8954.5 13879.38,-8951 13869.38,-8947.5 13869.38,-8954.5"/>
</g>
<!-- layer_0_expert_broadcast_4 -->
<g id="node82" class="node">
<title>layer_0_expert_broadcast_4</title>
<polygon fill="#e6ffe6" stroke="black" points="11221.56,-9237.17 10472.51,-9237.17 10279.81,-9101.17 11028.87,-9101.17 11221.56,-9237.17"/>
<text text-anchor="middle" x="10750.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="10750.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="10750.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10750.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_broadcast_4&#45;&gt;layer_0_residual2 -->
<g id="edge161" class="edge">
<title>layer_0_expert_broadcast_4&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M11115.19,-9161.79C11115.19,-9124.89 11115.19,-8962 11115.19,-8962 11115.19,-8962 13869.38,-8962 13869.38,-8962"/>
<polygon fill="black" stroke="black" points="13869.38,-8965.5 13879.38,-8962 13869.38,-8958.5 13869.38,-8965.5"/>
</g>
<!-- layer_0_expert_broadcast_5 -->
<g id="node83" class="node">
<title>layer_0_expert_broadcast_5</title>
<polygon fill="#e6ffe6" stroke="black" points="12180.56,-9237.17 11431.51,-9237.17 11238.81,-9101.17 11987.87,-9101.17 12180.56,-9237.17"/>
<text text-anchor="middle" x="11709.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="11709.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="11709.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11709.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_broadcast_5&#45;&gt;layer_0_residual2 -->
<g id="edge162" class="edge">
<title>layer_0_expert_broadcast_5&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M12074.19,-9161.68C12074.19,-9125.66 12074.19,-8972 12074.19,-8972 12074.19,-8972 13869.45,-8972 13869.45,-8972"/>
<polygon fill="black" stroke="black" points="13869.45,-8975.5 13879.45,-8972 13869.45,-8968.5 13869.45,-8975.5"/>
</g>
<!-- layer_0_expert_broadcast_6 -->
<g id="node84" class="node">
<title>layer_0_expert_broadcast_6</title>
<polygon fill="#e6ffe6" stroke="black" points="13139.56,-9237.17 12390.51,-9237.17 12197.81,-9101.17 12946.87,-9101.17 13139.56,-9237.17"/>
<text text-anchor="middle" x="12668.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="12668.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="12668.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12668.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_broadcast_6&#45;&gt;layer_0_residual2 -->
<g id="edge163" class="edge">
<title>layer_0_expert_broadcast_6&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M12793.19,-9101.07C12793.19,-9047.55 12793.19,-8982 12793.19,-8982 12793.19,-8982 13869.39,-8982 13869.39,-8982"/>
<polygon fill="black" stroke="black" points="13869.39,-8985.5 13879.39,-8982 13869.39,-8978.5 13869.39,-8985.5"/>
</g>
<!-- layer_0_expert_broadcast_7 -->
<g id="node85" class="node">
<title>layer_0_expert_broadcast_7</title>
<polygon fill="#e6ffe6" stroke="black" points="14098.56,-9237.17 13349.51,-9237.17 13156.81,-9101.17 13905.87,-9101.17 14098.56,-9237.17"/>
<text text-anchor="middle" x="13627.69" y="-9187.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="13627.69" y="-9172.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="13627.69" y="-9157.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13627.69" y="-9142.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_0_expert_broadcast_7&#45;&gt;layer_0_residual2 -->
<g id="edge164" class="edge">
<title>layer_0_expert_broadcast_7&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M13989.03,-9159.82C13989.03,-9159.82 13989.03,-9003.35 13989.03,-9003.35"/>
<polygon fill="black" stroke="black" points="13992.53,-9003.35 13989.03,-8993.35 13985.53,-9003.35 13992.53,-9003.35"/>
</g>
<!-- layer_0_expert_broadcast_8&#45;&gt;layer_0_residual2 -->
<g id="edge165" class="edge">
<title>layer_0_expert_broadcast_8&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M14224.84,-9100.94C14224.84,-9100.94 14224.84,-9003.38 14224.84,-9003.38"/>
<polygon fill="black" stroke="black" points="14228.34,-9003.38 14224.84,-8993.38 14221.34,-9003.38 14228.34,-9003.38"/>
</g>
<!-- layer_0_expert_broadcast_9&#45;&gt;layer_0_residual2 -->
<g id="edge166" class="edge">
<title>layer_0_expert_broadcast_9&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M15152.23,-9101.17C15152.23,-9047.98 15152.23,-8983 15152.23,-8983 15152.23,-8983 14343.88,-8983 14343.88,-8983"/>
<polygon fill="black" stroke="black" points="14343.88,-8979.5 14333.88,-8983 14343.88,-8986.5 14343.88,-8979.5"/>
</g>
<!-- layer_0_expert_broadcast_10&#45;&gt;layer_0_residual2 -->
<g id="edge167" class="edge">
<title>layer_0_expert_broadcast_10&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M16149.69,-9100.91C16149.69,-9044.63 16149.69,-8974 16149.69,-8974 16149.69,-8974 14344.11,-8974 14344.11,-8974"/>
<polygon fill="black" stroke="black" points="14344.11,-8970.5 14334.11,-8974 14344.11,-8977.5 14344.11,-8970.5"/>
</g>
<!-- layer_0_expert_broadcast_11&#45;&gt;layer_0_residual2 -->
<g id="edge168" class="edge">
<title>layer_0_expert_broadcast_11&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M17168.84,-9100.9C17168.84,-9041.55 17168.84,-8965 17168.84,-8965 17168.84,-8965 14343.72,-8965 14343.72,-8965"/>
<polygon fill="black" stroke="black" points="14343.72,-8961.5 14333.72,-8965 14343.72,-8968.5 14343.72,-8961.5"/>
</g>
<!-- layer_0_expert_broadcast_12&#45;&gt;layer_0_residual2 -->
<g id="edge169" class="edge">
<title>layer_0_expert_broadcast_12&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M18061.84,-9101.13C18061.84,-9038.75 18061.84,-8956 18061.84,-8956 18061.84,-8956 14343.9,-8956 14343.9,-8956"/>
<polygon fill="black" stroke="black" points="14343.9,-8952.5 14333.9,-8956 14343.9,-8959.5 14343.9,-8952.5"/>
</g>
<!-- layer_0_expert_broadcast_13&#45;&gt;layer_0_residual2 -->
<g id="edge170" class="edge">
<title>layer_0_expert_broadcast_13&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M19020.34,-9101C19020.34,-9035.69 19020.34,-8947 19020.34,-8947 19020.34,-8947 14343.83,-8947 14343.83,-8947"/>
<polygon fill="black" stroke="black" points="14343.83,-8943.5 14333.83,-8947 14343.83,-8950.5 14343.83,-8943.5"/>
</g>
<!-- layer_0_expert_broadcast_14&#45;&gt;layer_0_residual2 -->
<g id="edge171" class="edge">
<title>layer_0_expert_broadcast_14&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M19985.69,-9101.08C19985.69,-9032.57 19985.69,-8937 19985.69,-8937 19985.69,-8937 14344,-8937 14344,-8937"/>
<polygon fill="black" stroke="black" points="14344,-8933.5 14334,-8937 14344,-8940.5 14344,-8933.5"/>
</g>
<!-- layer_0_expert_broadcast_15&#45;&gt;layer_0_residual2 -->
<g id="edge172" class="edge">
<title>layer_0_expert_broadcast_15&#45;&gt;layer_0_residual2</title>
<path fill="none" stroke="black" d="M21299.69,-9101.02C21299.69,-9029.71 21299.69,-8928 21299.69,-8928 21299.69,-8928 14343.84,-8928 14343.84,-8928"/>
<polygon fill="black" stroke="black" points="14343.84,-8924.5 14333.84,-8928 14343.84,-8931.5 14343.84,-8924.5"/>
</g>
<!-- layer_1_ln1 -->
<g id="node95" class="node">
<title>layer_1_ln1</title>
<polygon fill="#e6f3ff" stroke="black" points="16021.69,-8802.17 15567.69,-8802.17 15567.69,-8734.17 16021.69,-8734.17 16021.69,-8802.17"/>
<text text-anchor="middle" x="15794.69" y="-8786.97" font-family="monospace" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="15794.69" y="-8771.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15794.69" y="-8756.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15794.69" y="-8741.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_residual2&#45;&gt;layer_1_ln1 -->
<g id="edge173" class="edge">
<title>layer_0_residual2&#45;&gt;layer_1_ln1</title>
<path fill="none" stroke="black" d="M14244.19,-8909.94C14244.19,-8861.45 14244.19,-8788 14244.19,-8788 14244.19,-8788 15557.57,-8788 15557.57,-8788"/>
<polygon fill="black" stroke="black" points="15557.57,-8791.5 15567.57,-8788 15557.57,-8784.5 15557.57,-8791.5"/>
</g>
<!-- layer_1_residual1 -->
<g id="node136" class="node">
<title>layer_1_residual1</title>
<polygon fill="#fff0e6" stroke="black" points="16021.69,-7610.17 15567.69,-7610.17 15567.69,-7527.17 16021.69,-7527.17 16021.69,-7610.17"/>
<text text-anchor="middle" x="15794.69" y="-7594.97" font-family="monospace" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="15794.69" y="-7579.97" font-family="monospace" font-size="14.00">Input1: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15794.69" y="-7564.97" font-family="monospace" font-size="14.00">Input2: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15794.69" y="-7549.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15794.69" y="-7534.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_0_residual2&#45;&gt;layer_1_residual1 -->
<g id="edge278" class="edge">
<title>layer_0_residual2&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M14333.82,-8919C14889,-8919 16269.7,-8919 16269.7,-8919 16269.7,-8919 16269.7,-7596 16269.7,-7596 16269.7,-7596 16031.76,-7596 16031.76,-7596"/>
<polygon fill="black" stroke="black" points="16031.76,-7592.5 16021.76,-7596 16031.76,-7599.5 16031.76,-7592.5"/>
</g>
<!-- layer_1_qkv_gpu_0 -->
<g id="node96" class="node">
<title>layer_1_qkv_gpu_0</title>
<polygon fill="#e6f3ff" stroke="black" points="15306.69,-8626.17 14844.69,-8626.17 14844.69,-8558.17 15306.69,-8558.17 15306.69,-8626.17"/>
<text text-anchor="middle" x="15075.69" y="-8610.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15075.69" y="-8595.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="15075.69" y="-8580.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15075.69" y="-8565.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_qkv_gpu_0 -->
<g id="edge174" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_qkv_gpu_0</title>
<path fill="none" stroke="black" d="M15567.64,-8747C15410.48,-8747 15229.46,-8747 15229.46,-8747 15229.46,-8747 15229.46,-8636.53 15229.46,-8636.53"/>
<polygon fill="black" stroke="black" points="15232.96,-8636.53 15229.46,-8626.53 15225.96,-8636.53 15232.96,-8636.53"/>
</g>
<!-- layer_1_qkv_gpu_1 -->
<g id="node97" class="node">
<title>layer_1_qkv_gpu_1</title>
<polygon fill="#e6f3ff" stroke="black" points="16025.69,-8626.17 15563.69,-8626.17 15563.69,-8558.17 16025.69,-8558.17 16025.69,-8626.17"/>
<text text-anchor="middle" x="15794.69" y="-8610.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15794.69" y="-8595.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="15794.69" y="-8580.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15794.69" y="-8565.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_qkv_gpu_1 -->
<g id="edge175" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_qkv_gpu_1</title>
<path fill="none" stroke="black" d="M15794.69,-8733.81C15794.69,-8733.81 15794.69,-8636.43 15794.69,-8636.43"/>
<polygon fill="black" stroke="black" points="15798.19,-8636.43 15794.69,-8626.43 15791.19,-8636.43 15798.19,-8636.43"/>
</g>
<!-- layer_1_qkv_gpu_2 -->
<g id="node98" class="node">
<title>layer_1_qkv_gpu_2</title>
<polygon fill="#e6f3ff" stroke="black" points="16744.69,-8626.17 16282.69,-8626.17 16282.69,-8558.17 16744.69,-8558.17 16744.69,-8626.17"/>
<text text-anchor="middle" x="16513.69" y="-8610.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16513.69" y="-8595.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="16513.69" y="-8580.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16513.69" y="-8565.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_qkv_gpu_2 -->
<g id="edge176" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_qkv_gpu_2</title>
<path fill="none" stroke="black" d="M16021.69,-8747C16232.39,-8747 16513.69,-8747 16513.69,-8747 16513.69,-8747 16513.69,-8636.53 16513.69,-8636.53"/>
<polygon fill="black" stroke="black" points="16517.19,-8636.53 16513.69,-8626.53 16510.19,-8636.53 16517.19,-8636.53"/>
</g>
<!-- layer_1_qkv_gpu_3 -->
<g id="node99" class="node">
<title>layer_1_qkv_gpu_3</title>
<polygon fill="#e6f3ff" stroke="black" points="17344.69,-8626.17 16882.69,-8626.17 16882.69,-8558.17 17344.69,-8558.17 17344.69,-8626.17"/>
<text text-anchor="middle" x="17113.69" y="-8610.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17113.69" y="-8595.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="17113.69" y="-8580.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17113.69" y="-8565.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_qkv_gpu_3 -->
<g id="edge177" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_qkv_gpu_3</title>
<path fill="none" stroke="black" d="M16021.85,-8761C16352.94,-8761 16929.03,-8761 16929.03,-8761 16929.03,-8761 16929.03,-8636.33 16929.03,-8636.33"/>
<polygon fill="black" stroke="black" points="16932.53,-8636.33 16929.03,-8626.33 16925.53,-8636.33 16932.53,-8636.33"/>
</g>
<!-- layer_1_qkv_gpu_4 -->
<g id="node100" class="node">
<title>layer_1_qkv_gpu_4</title>
<polygon fill="#e6f3ff" stroke="black" points="17884.69,-8626.17 17422.69,-8626.17 17422.69,-8558.17 17884.69,-8558.17 17884.69,-8626.17"/>
<text text-anchor="middle" x="17653.69" y="-8610.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17653.69" y="-8595.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="17653.69" y="-8580.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17653.69" y="-8565.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_qkv_gpu_4 -->
<g id="edge178" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_qkv_gpu_4</title>
<path fill="none" stroke="black" d="M16021.71,-8774C16517.62,-8774 17653.69,-8774 17653.69,-8774 17653.69,-8774 17653.69,-8636.37 17653.69,-8636.37"/>
<polygon fill="black" stroke="black" points="17657.19,-8636.37 17653.69,-8626.37 17650.19,-8636.37 17657.19,-8636.37"/>
</g>
<!-- layer_1_qkv_gpu_5 -->
<g id="node101" class="node">
<title>layer_1_qkv_gpu_5</title>
<polygon fill="#e6f3ff" stroke="black" points="18633.69,-8626.17 18171.69,-8626.17 18171.69,-8558.17 18633.69,-8558.17 18633.69,-8626.17"/>
<text text-anchor="middle" x="18402.69" y="-8610.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="18402.69" y="-8595.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="18402.69" y="-8580.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18402.69" y="-8565.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_qkv_gpu_5 -->
<g id="edge179" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_qkv_gpu_5</title>
<path fill="none" stroke="black" d="M16021.85,-8788C16656.6,-8788 18402.69,-8788 18402.69,-8788 18402.69,-8788 18402.69,-8636.28 18402.69,-8636.28"/>
<polygon fill="black" stroke="black" points="18406.19,-8636.28 18402.69,-8626.28 18399.19,-8636.28 18406.19,-8636.28"/>
</g>
<!-- layer_1_qkv_gpu_6 -->
<g id="node102" class="node">
<title>layer_1_qkv_gpu_6</title>
<polygon fill="#e6f3ff" stroke="black" points="14017.69,-8626.17 13555.69,-8626.17 13555.69,-8558.17 14017.69,-8558.17 14017.69,-8626.17"/>
<text text-anchor="middle" x="13786.69" y="-8610.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13786.69" y="-8595.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="13786.69" y="-8580.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13786.69" y="-8565.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_qkv_gpu_6 -->
<g id="edge180" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_qkv_gpu_6</title>
<path fill="none" stroke="black" d="M15567.41,-8774C15073.99,-8774 13948.69,-8774 13948.69,-8774 13948.69,-8774 13948.69,-8636.37 13948.69,-8636.37"/>
<polygon fill="black" stroke="black" points="13952.19,-8636.37 13948.69,-8626.37 13945.19,-8636.37 13952.19,-8636.37"/>
</g>
<!-- layer_1_qkv_gpu_7 -->
<g id="node103" class="node">
<title>layer_1_qkv_gpu_7</title>
<polygon fill="#e6f3ff" stroke="black" points="14616.69,-8626.17 14154.69,-8626.17 14154.69,-8558.17 14616.69,-8558.17 14616.69,-8626.17"/>
<text text-anchor="middle" x="14385.69" y="-8610.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14385.69" y="-8595.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="14385.69" y="-8580.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14385.69" y="-8565.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_qkv_gpu_7 -->
<g id="edge181" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_qkv_gpu_7</title>
<path fill="none" stroke="black" d="M15567.48,-8761C15190.12,-8761 14475.19,-8761 14475.19,-8761 14475.19,-8761 14475.19,-8636.33 14475.19,-8636.33"/>
<polygon fill="black" stroke="black" points="14478.69,-8636.33 14475.19,-8626.33 14471.69,-8636.33 14478.69,-8636.33"/>
</g>
<!-- layer_1_attn_gpu_0 -->
<g id="node104" class="node">
<title>layer_1_attn_gpu_0</title>
<polygon fill="#e6f3ff" stroke="black" points="15186.69,-8450.17 14724.69,-8450.17 14724.69,-8382.17 15186.69,-8382.17 15186.69,-8450.17"/>
<text text-anchor="middle" x="14955.69" y="-8434.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="14955.69" y="-8419.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="14955.69" y="-8404.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14955.69" y="-8389.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_qkv_gpu_0&#45;&gt;layer_1_attn_gpu_0 -->
<g id="edge182" class="edge">
<title>layer_1_qkv_gpu_0&#45;&gt;layer_1_attn_gpu_0</title>
<path fill="none" stroke="black" d="M15015.69,-8557.81C15015.69,-8557.81 15015.69,-8460.43 15015.69,-8460.43"/>
<polygon fill="black" stroke="black" points="15019.19,-8460.43 15015.69,-8450.43 15012.19,-8460.43 15019.19,-8460.43"/>
</g>
<!-- layer_1_attn_gpu_1 -->
<g id="node105" class="node">
<title>layer_1_attn_gpu_1</title>
<polygon fill="#e6f3ff" stroke="black" points="16025.69,-8450.17 15563.69,-8450.17 15563.69,-8382.17 16025.69,-8382.17 16025.69,-8450.17"/>
<text text-anchor="middle" x="15794.69" y="-8434.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="15794.69" y="-8419.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="15794.69" y="-8404.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15794.69" y="-8389.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_qkv_gpu_1&#45;&gt;layer_1_attn_gpu_1 -->
<g id="edge183" class="edge">
<title>layer_1_qkv_gpu_1&#45;&gt;layer_1_attn_gpu_1</title>
<path fill="none" stroke="black" d="M15794.69,-8557.81C15794.69,-8557.81 15794.69,-8460.43 15794.69,-8460.43"/>
<polygon fill="black" stroke="black" points="15798.19,-8460.43 15794.69,-8450.43 15791.19,-8460.43 15798.19,-8460.43"/>
</g>
<!-- layer_1_attn_gpu_2 -->
<g id="node106" class="node">
<title>layer_1_attn_gpu_2</title>
<polygon fill="#e6f3ff" stroke="black" points="16954.69,-8450.17 16492.69,-8450.17 16492.69,-8382.17 16954.69,-8382.17 16954.69,-8450.17"/>
<text text-anchor="middle" x="16723.69" y="-8434.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="16723.69" y="-8419.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="16723.69" y="-8404.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16723.69" y="-8389.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_qkv_gpu_2&#45;&gt;layer_1_attn_gpu_2 -->
<g id="edge184" class="edge">
<title>layer_1_qkv_gpu_2&#45;&gt;layer_1_attn_gpu_2</title>
<path fill="none" stroke="black" d="M16618.69,-8557.81C16618.69,-8557.81 16618.69,-8460.43 16618.69,-8460.43"/>
<polygon fill="black" stroke="black" points="16622.19,-8460.43 16618.69,-8450.43 16615.19,-8460.43 16622.19,-8460.43"/>
</g>
<!-- layer_1_attn_gpu_3 -->
<g id="node107" class="node">
<title>layer_1_attn_gpu_3</title>
<polygon fill="#e6f3ff" stroke="black" points="17434.69,-8450.17 16972.69,-8450.17 16972.69,-8382.17 17434.69,-8382.17 17434.69,-8450.17"/>
<text text-anchor="middle" x="17203.69" y="-8434.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="17203.69" y="-8419.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="17203.69" y="-8404.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17203.69" y="-8389.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_qkv_gpu_3&#45;&gt;layer_1_attn_gpu_3 -->
<g id="edge185" class="edge">
<title>layer_1_qkv_gpu_3&#45;&gt;layer_1_attn_gpu_3</title>
<path fill="none" stroke="black" d="M17158.69,-8557.81C17158.69,-8557.81 17158.69,-8460.43 17158.69,-8460.43"/>
<polygon fill="black" stroke="black" points="17162.19,-8460.43 17158.69,-8450.43 17155.19,-8460.43 17162.19,-8460.43"/>
</g>
<!-- layer_1_attn_gpu_4 -->
<g id="node108" class="node">
<title>layer_1_attn_gpu_4</title>
<polygon fill="#e6f3ff" stroke="black" points="17914.69,-8450.17 17452.69,-8450.17 17452.69,-8382.17 17914.69,-8382.17 17914.69,-8450.17"/>
<text text-anchor="middle" x="17683.69" y="-8434.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="17683.69" y="-8419.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="17683.69" y="-8404.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17683.69" y="-8389.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_qkv_gpu_4&#45;&gt;layer_1_attn_gpu_4 -->
<g id="edge186" class="edge">
<title>layer_1_qkv_gpu_4&#45;&gt;layer_1_attn_gpu_4</title>
<path fill="none" stroke="black" d="M17668.69,-8557.81C17668.69,-8557.81 17668.69,-8460.43 17668.69,-8460.43"/>
<polygon fill="black" stroke="black" points="17672.19,-8460.43 17668.69,-8450.43 17665.19,-8460.43 17672.19,-8460.43"/>
</g>
<!-- layer_1_attn_gpu_5 -->
<g id="node109" class="node">
<title>layer_1_attn_gpu_5</title>
<polygon fill="#e6f3ff" stroke="black" points="19591.69,-8450.17 19129.69,-8450.17 19129.69,-8382.17 19591.69,-8382.17 19591.69,-8450.17"/>
<text text-anchor="middle" x="19360.69" y="-8434.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="19360.69" y="-8419.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="19360.69" y="-8404.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19360.69" y="-8389.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_qkv_gpu_5&#45;&gt;layer_1_attn_gpu_5 -->
<g id="edge187" class="edge">
<title>layer_1_qkv_gpu_5&#45;&gt;layer_1_attn_gpu_5</title>
<path fill="none" stroke="black" d="M18489.46,-8557.94C18489.46,-8509.57 18489.46,-8427 18489.46,-8427 18489.46,-8427 19119.5,-8427 19119.5,-8427"/>
<polygon fill="black" stroke="black" points="19119.5,-8430.5 19129.5,-8427 19119.5,-8423.5 19119.5,-8430.5"/>
</g>
<!-- layer_1_attn_gpu_6 -->
<g id="node110" class="node">
<title>layer_1_attn_gpu_6</title>
<polygon fill="#e6f3ff" stroke="black" points="13687.69,-8450.17 13225.69,-8450.17 13225.69,-8382.17 13687.69,-8382.17 13687.69,-8450.17"/>
<text text-anchor="middle" x="13456.69" y="-8434.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="13456.69" y="-8419.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="13456.69" y="-8404.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13456.69" y="-8389.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_qkv_gpu_6&#45;&gt;layer_1_attn_gpu_6 -->
<g id="edge188" class="edge">
<title>layer_1_qkv_gpu_6&#45;&gt;layer_1_attn_gpu_6</title>
<path fill="none" stroke="black" d="M13621.69,-8557.81C13621.69,-8557.81 13621.69,-8460.43 13621.69,-8460.43"/>
<polygon fill="black" stroke="black" points="13625.19,-8460.43 13621.69,-8450.43 13618.19,-8460.43 13625.19,-8460.43"/>
</g>
<!-- layer_1_attn_gpu_7 -->
<g id="node111" class="node">
<title>layer_1_attn_gpu_7</title>
<polygon fill="#e6f3ff" stroke="black" points="14406.69,-8450.17 13944.69,-8450.17 13944.69,-8382.17 14406.69,-8382.17 14406.69,-8450.17"/>
<text text-anchor="middle" x="14175.69" y="-8434.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="14175.69" y="-8419.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="14175.69" y="-8404.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14175.69" y="-8389.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_1_qkv_gpu_7&#45;&gt;layer_1_attn_gpu_7 -->
<g id="edge189" class="edge">
<title>layer_1_qkv_gpu_7&#45;&gt;layer_1_attn_gpu_7</title>
<path fill="none" stroke="black" d="M14280.69,-8557.81C14280.69,-8557.81 14280.69,-8460.43 14280.69,-8460.43"/>
<polygon fill="black" stroke="black" points="14284.19,-8460.43 14280.69,-8450.43 14277.19,-8460.43 14284.19,-8460.43"/>
</g>
<!-- layer_1_attn_allreduce_0 -->
<g id="node112" class="node">
<title>layer_1_attn_allreduce_0</title>
<polygon fill="#e6ffe6" stroke="black" points="15306.56,-8274.17 14557.51,-8274.17 14364.81,-8138.17 15113.87,-8138.17 15306.56,-8274.17"/>
<text text-anchor="middle" x="14835.69" y="-8224.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="14835.69" y="-8209.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="14835.69" y="-8194.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14835.69" y="-8179.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_gpu_0&#45;&gt;layer_1_attn_allreduce_0 -->
<g id="edge190" class="edge">
<title>layer_1_attn_gpu_0&#45;&gt;layer_1_attn_allreduce_0</title>
<path fill="none" stroke="black" d="M14955.69,-8381.96C14955.69,-8381.96 14955.69,-8284.33 14955.69,-8284.33"/>
<polygon fill="black" stroke="black" points="14959.19,-8284.33 14955.69,-8274.33 14952.19,-8284.33 14959.19,-8284.33"/>
</g>
<!-- layer_1_attn_allreduce_1 -->
<g id="node113" class="node">
<title>layer_1_attn_allreduce_1</title>
<polygon fill="#e6ffe6" stroke="black" points="16265.56,-8274.17 15516.51,-8274.17 15323.81,-8138.17 16072.87,-8138.17 16265.56,-8274.17"/>
<text text-anchor="middle" x="15794.69" y="-8224.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="15794.69" y="-8209.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="15794.69" y="-8194.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15794.69" y="-8179.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_gpu_1&#45;&gt;layer_1_attn_allreduce_1 -->
<g id="edge191" class="edge">
<title>layer_1_attn_gpu_1&#45;&gt;layer_1_attn_allreduce_1</title>
<path fill="none" stroke="black" d="M15794.69,-8381.96C15794.69,-8381.96 15794.69,-8284.33 15794.69,-8284.33"/>
<polygon fill="black" stroke="black" points="15798.19,-8284.33 15794.69,-8274.33 15791.19,-8284.33 15798.19,-8284.33"/>
</g>
<!-- layer_1_attn_allreduce_2 -->
<g id="node114" class="node">
<title>layer_1_attn_allreduce_2</title>
<polygon fill="#e6ffe6" stroke="black" points="17224.56,-8274.17 16475.51,-8274.17 16282.81,-8138.17 17031.87,-8138.17 17224.56,-8274.17"/>
<text text-anchor="middle" x="16753.69" y="-8224.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="16753.69" y="-8209.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="16753.69" y="-8194.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16753.69" y="-8179.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_gpu_2&#45;&gt;layer_1_attn_allreduce_2 -->
<g id="edge192" class="edge">
<title>layer_1_attn_gpu_2&#45;&gt;layer_1_attn_allreduce_2</title>
<path fill="none" stroke="black" d="M16723.69,-8381.96C16723.69,-8381.96 16723.69,-8284.33 16723.69,-8284.33"/>
<polygon fill="black" stroke="black" points="16727.19,-8284.33 16723.69,-8274.33 16720.19,-8284.33 16727.19,-8284.33"/>
</g>
<!-- layer_1_attn_allreduce_3 -->
<g id="node115" class="node">
<title>layer_1_attn_allreduce_3</title>
<polygon fill="#e6ffe6" stroke="black" points="18183.56,-8274.17 17434.51,-8274.17 17241.81,-8138.17 17990.87,-8138.17 18183.56,-8274.17"/>
<text text-anchor="middle" x="17712.69" y="-8224.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="17712.69" y="-8209.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="17712.69" y="-8194.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17712.69" y="-8179.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_gpu_3&#45;&gt;layer_1_attn_allreduce_3 -->
<g id="edge193" class="edge">
<title>layer_1_attn_gpu_3&#45;&gt;layer_1_attn_allreduce_3</title>
<path fill="none" stroke="black" d="M17338.34,-8381.96C17338.34,-8381.96 17338.34,-8216.5 17338.34,-8216.5"/>
<polygon fill="black" stroke="black" points="17341.84,-8216.5 17338.34,-8206.5 17334.84,-8216.5 17341.84,-8216.5"/>
</g>
<!-- layer_1_attn_allreduce_4 -->
<g id="node116" class="node">
<title>layer_1_attn_allreduce_4</title>
<polygon fill="#e6ffe6" stroke="black" points="19142.56,-8274.17 18393.51,-8274.17 18200.81,-8138.17 18949.87,-8138.17 19142.56,-8274.17"/>
<text text-anchor="middle" x="18671.69" y="-8224.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="18671.69" y="-8209.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="18671.69" y="-8194.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="18671.69" y="-8179.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_gpu_4&#45;&gt;layer_1_attn_allreduce_4 -->
<g id="edge194" class="edge">
<title>layer_1_attn_gpu_4&#45;&gt;layer_1_attn_allreduce_4</title>
<path fill="none" stroke="black" d="M17915.06,-8404C18105.83,-8404 18345.23,-8404 18345.23,-8404 18345.23,-8404 18345.23,-8250.18 18345.23,-8250.18"/>
<polygon fill="black" stroke="black" points="18348.73,-8250.18 18345.23,-8240.18 18341.73,-8250.18 18348.73,-8250.18"/>
</g>
<!-- layer_1_attn_allreduce_5 -->
<g id="node117" class="node">
<title>layer_1_attn_allreduce_5</title>
<polygon fill="#e6ffe6" stroke="black" points="20101.56,-8274.17 19352.51,-8274.17 19159.81,-8138.17 19908.87,-8138.17 20101.56,-8274.17"/>
<text text-anchor="middle" x="19630.69" y="-8224.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="19630.69" y="-8209.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="19630.69" y="-8194.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="19630.69" y="-8179.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_gpu_5&#45;&gt;layer_1_attn_allreduce_5 -->
<g id="edge195" class="edge">
<title>layer_1_attn_gpu_5&#45;&gt;layer_1_attn_allreduce_5</title>
<path fill="none" stroke="black" d="M19375.84,-8381.96C19375.84,-8381.96 19375.84,-8284.33 19375.84,-8284.33"/>
<polygon fill="black" stroke="black" points="19379.34,-8284.33 19375.84,-8274.33 19372.34,-8284.33 19379.34,-8284.33"/>
</g>
<!-- layer_1_attn_allreduce_6 -->
<g id="node118" class="node">
<title>layer_1_attn_allreduce_6</title>
<polygon fill="#e6ffe6" stroke="black" points="13388.56,-8274.17 12639.51,-8274.17 12446.81,-8138.17 13195.87,-8138.17 13388.56,-8274.17"/>
<text text-anchor="middle" x="12917.69" y="-8224.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="12917.69" y="-8209.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="12917.69" y="-8194.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12917.69" y="-8179.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_gpu_6&#45;&gt;layer_1_attn_allreduce_6 -->
<g id="edge196" class="edge">
<title>layer_1_attn_gpu_6&#45;&gt;layer_1_attn_allreduce_6</title>
<path fill="none" stroke="black" d="M13307.03,-8381.96C13307.03,-8381.96 13307.03,-8284.33 13307.03,-8284.33"/>
<polygon fill="black" stroke="black" points="13310.53,-8284.33 13307.03,-8274.33 13303.53,-8284.33 13310.53,-8284.33"/>
</g>
<!-- layer_1_attn_allreduce_7 -->
<g id="node119" class="node">
<title>layer_1_attn_allreduce_7</title>
<polygon fill="#e6ffe6" stroke="black" points="14347.56,-8274.17 13598.51,-8274.17 13405.81,-8138.17 14154.87,-8138.17 14347.56,-8274.17"/>
<text text-anchor="middle" x="13876.69" y="-8224.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="13876.69" y="-8209.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="13876.69" y="-8194.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13876.69" y="-8179.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_gpu_7&#45;&gt;layer_1_attn_allreduce_7 -->
<g id="edge197" class="edge">
<title>layer_1_attn_gpu_7&#45;&gt;layer_1_attn_allreduce_7</title>
<path fill="none" stroke="black" d="M14146.03,-8381.96C14146.03,-8381.96 14146.03,-8284.33 14146.03,-8284.33"/>
<polygon fill="black" stroke="black" points="14149.53,-8284.33 14146.03,-8274.33 14142.53,-8284.33 14149.53,-8284.33"/>
</g>
<!-- layer_1_attn_proj_0 -->
<g id="node120" class="node">
<title>layer_1_attn_proj_0</title>
<polygon fill="#e6f3ff" stroke="black" points="15792.69,-8030.17 15338.69,-8030.17 15338.69,-7962.17 15792.69,-7962.17 15792.69,-8030.17"/>
<text text-anchor="middle" x="15565.69" y="-8014.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="15565.69" y="-7999.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="15565.69" y="-7984.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15565.69" y="-7969.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_allreduce_0&#45;&gt;layer_1_attn_proj_0 -->
<g id="edge198" class="edge">
<title>layer_1_attn_allreduce_0&#45;&gt;layer_1_attn_proj_0</title>
<path fill="none" stroke="black" d="M15159.81,-8170.48C15159.81,-8131.03 15159.81,-8073 15159.81,-8073 15159.81,-8073 15565.69,-8073 15565.69,-8073 15565.69,-8073 15565.69,-8040.54 15565.69,-8040.54"/>
<polygon fill="black" stroke="black" points="15569.19,-8040.54 15565.69,-8030.54 15562.19,-8040.54 15569.19,-8040.54"/>
</g>
<!-- layer_1_attn_proj_1 -->
<g id="node121" class="node">
<title>layer_1_attn_proj_1</title>
<polygon fill="#e6f3ff" stroke="black" points="16264.69,-8030.17 15810.69,-8030.17 15810.69,-7962.17 16264.69,-7962.17 16264.69,-8030.17"/>
<text text-anchor="middle" x="16037.69" y="-8014.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="16037.69" y="-7999.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="16037.69" y="-7984.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16037.69" y="-7969.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_allreduce_1&#45;&gt;layer_1_attn_proj_1 -->
<g id="edge199" class="edge">
<title>layer_1_attn_allreduce_1&#45;&gt;layer_1_attn_proj_1</title>
<path fill="none" stroke="black" d="M16037.69,-8137.99C16037.69,-8137.99 16037.69,-8040.2 16037.69,-8040.2"/>
<polygon fill="black" stroke="black" points="16041.19,-8040.2 16037.69,-8030.2 16034.19,-8040.2 16041.19,-8040.2"/>
</g>
<!-- layer_1_attn_proj_2 -->
<g id="node122" class="node">
<title>layer_1_attn_proj_2</title>
<polygon fill="#e6f3ff" stroke="black" points="16736.69,-8030.17 16282.69,-8030.17 16282.69,-7962.17 16736.69,-7962.17 16736.69,-8030.17"/>
<text text-anchor="middle" x="16509.69" y="-8014.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="16509.69" y="-7999.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="16509.69" y="-7984.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16509.69" y="-7969.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_allreduce_2&#45;&gt;layer_1_attn_proj_2 -->
<g id="edge200" class="edge">
<title>layer_1_attn_allreduce_2&#45;&gt;layer_1_attn_proj_2</title>
<path fill="none" stroke="black" d="M16509.84,-8137.99C16509.84,-8137.99 16509.84,-8040.2 16509.84,-8040.2"/>
<polygon fill="black" stroke="black" points="16513.34,-8040.2 16509.84,-8030.2 16506.34,-8040.2 16513.34,-8040.2"/>
</g>
<!-- layer_1_attn_proj_3 -->
<g id="node123" class="node">
<title>layer_1_attn_proj_3</title>
<polygon fill="#e6f3ff" stroke="black" points="17208.69,-8030.17 16754.69,-8030.17 16754.69,-7962.17 17208.69,-7962.17 17208.69,-8030.17"/>
<text text-anchor="middle" x="16981.69" y="-8014.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="16981.69" y="-7999.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="16981.69" y="-7984.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16981.69" y="-7969.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_allreduce_3&#45;&gt;layer_1_attn_proj_3 -->
<g id="edge201" class="edge">
<title>layer_1_attn_allreduce_3&#45;&gt;layer_1_attn_proj_3</title>
<path fill="none" stroke="black" d="M17388.23,-8137.83C17388.23,-8125.25 17388.23,-8116 17388.23,-8116 17388.23,-8116 16981.69,-8116 16981.69,-8116 16981.69,-8116 16981.69,-8040.19 16981.69,-8040.19"/>
<polygon fill="black" stroke="black" points="16985.19,-8040.19 16981.69,-8030.19 16978.19,-8040.19 16985.19,-8040.19"/>
</g>
<!-- layer_1_attn_proj_4 -->
<g id="node124" class="node">
<title>layer_1_attn_proj_4</title>
<polygon fill="#e6f3ff" stroke="black" points="17680.69,-8030.17 17226.69,-8030.17 17226.69,-7962.17 17680.69,-7962.17 17680.69,-8030.17"/>
<text text-anchor="middle" x="17453.69" y="-8014.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="17453.69" y="-7999.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="17453.69" y="-7984.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17453.69" y="-7969.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_allreduce_4&#45;&gt;layer_1_attn_proj_4 -->
<g id="edge202" class="edge">
<title>layer_1_attn_allreduce_4&#45;&gt;layer_1_attn_proj_4</title>
<path fill="none" stroke="black" d="M18933.18,-8138.01C18933.18,-8114.52 18933.18,-8094 18933.18,-8094 18933.18,-8094 17534.46,-8094 17534.46,-8094 17534.46,-8094 17534.46,-8040.38 17534.46,-8040.38"/>
<polygon fill="black" stroke="black" points="17537.96,-8040.38 17534.46,-8030.38 17530.96,-8040.38 17537.96,-8040.38"/>
</g>
<!-- layer_1_attn_proj_5 -->
<g id="node125" class="node">
<title>layer_1_attn_proj_5</title>
<polygon fill="#e6f3ff" stroke="black" points="18152.69,-8030.17 17698.69,-8030.17 17698.69,-7962.17 18152.69,-7962.17 18152.69,-8030.17"/>
<text text-anchor="middle" x="17925.69" y="-8014.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="17925.69" y="-7999.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="17925.69" y="-7984.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17925.69" y="-7969.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_allreduce_5&#45;&gt;layer_1_attn_proj_5 -->
<g id="edge203" class="edge">
<title>layer_1_attn_allreduce_5&#45;&gt;layer_1_attn_proj_5</title>
<path fill="none" stroke="black" d="M19996.77,-8200.17C19996.77,-8167.57 19996.77,-8013 19996.77,-8013 19996.77,-8013 18162.76,-8013 18162.76,-8013"/>
<polygon fill="black" stroke="black" points="18162.76,-8009.5 18152.76,-8013 18162.76,-8016.5 18162.76,-8009.5"/>
</g>
<!-- layer_1_attn_proj_6 -->
<g id="node126" class="node">
<title>layer_1_attn_proj_6</title>
<polygon fill="#e6f3ff" stroke="black" points="14848.69,-8030.17 14394.69,-8030.17 14394.69,-7962.17 14848.69,-7962.17 14848.69,-8030.17"/>
<text text-anchor="middle" x="14621.69" y="-8014.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="14621.69" y="-7999.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="14621.69" y="-7984.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14621.69" y="-7969.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_allreduce_6&#45;&gt;layer_1_attn_proj_6 -->
<g id="edge204" class="edge">
<title>layer_1_attn_allreduce_6&#45;&gt;layer_1_attn_proj_6</title>
<path fill="none" stroke="black" d="M13283.77,-8200.17C13283.77,-8167.57 13283.77,-8013 13283.77,-8013 13283.77,-8013 14384.35,-8013 14384.35,-8013"/>
<polygon fill="black" stroke="black" points="14384.35,-8016.5 14394.35,-8013 14384.35,-8009.5 14384.35,-8016.5"/>
</g>
<!-- layer_1_attn_proj_7 -->
<g id="node127" class="node">
<title>layer_1_attn_proj_7</title>
<polygon fill="#e6f3ff" stroke="black" points="15320.69,-8030.17 14866.69,-8030.17 14866.69,-7962.17 15320.69,-7962.17 15320.69,-8030.17"/>
<text text-anchor="middle" x="15093.69" y="-8014.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="15093.69" y="-7999.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="15093.69" y="-7984.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15093.69" y="-7969.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_allreduce_7&#45;&gt;layer_1_attn_proj_7 -->
<g id="edge205" class="edge">
<title>layer_1_attn_allreduce_7&#45;&gt;layer_1_attn_proj_7</title>
<path fill="none" stroke="black" d="M13510.6,-8138.11C13510.6,-8096.42 13510.6,-8051 13510.6,-8051 13510.6,-8051 15013.25,-8051 15013.25,-8051 15013.25,-8051 15013.25,-8040.27 15013.25,-8040.27"/>
<polygon fill="black" stroke="black" points="15016.75,-8040.27 15013.25,-8030.27 15009.75,-8040.27 15016.75,-8040.27"/>
</g>
<!-- layer_1_recv_attn_8 -->
<g id="node128" class="node">
<title>layer_1_recv_attn_8</title>
<polygon fill="#e6ffe6" stroke="black" points="20101.56,-7854.17 19352.51,-7854.17 19159.81,-7718.17 19908.87,-7718.17 20101.56,-7854.17"/>
<text text-anchor="middle" x="19630.69" y="-7804.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="19630.69" y="-7789.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="19630.69" y="-7774.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19630.69" y="-7759.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_8 -->
<g id="edge206" class="edge">
<title>layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_8</title>
<path fill="none" stroke="black" d="M15742.24,-7961.9C15742.24,-7934.98 15742.24,-7902 15742.24,-7902 15742.24,-7902 19369.19,-7902 19369.19,-7902 19369.19,-7902 19369.19,-7864.22 19369.19,-7864.22"/>
<polygon fill="black" stroke="black" points="19372.69,-7864.22 19369.19,-7854.22 19365.69,-7864.22 19372.69,-7864.22"/>
</g>
<!-- layer_1_recv_attn_9 -->
<g id="node129" class="node">
<title>layer_1_recv_attn_9</title>
<polygon fill="#e6ffe6" stroke="black" points="13388.56,-7854.17 12639.51,-7854.17 12446.81,-7718.17 13195.87,-7718.17 13388.56,-7854.17"/>
<text text-anchor="middle" x="12917.69" y="-7804.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="12917.69" y="-7789.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="12917.69" y="-7774.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12917.69" y="-7759.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_9 -->
<g id="edge207" class="edge">
<title>layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_9</title>
<path fill="none" stroke="black" d="M15389.13,-7962.13C15389.13,-7955.21 15389.13,-7950 15389.13,-7950 15389.13,-7950 12760.79,-7950 12760.79,-7950 12760.79,-7950 12760.79,-7864.22 12760.79,-7864.22"/>
<polygon fill="black" stroke="black" points="12764.29,-7864.22 12760.79,-7854.22 12757.29,-7864.22 12764.29,-7864.22"/>
</g>
<!-- layer_1_recv_attn_10 -->
<g id="node130" class="node">
<title>layer_1_recv_attn_10</title>
<polygon fill="#e6ffe6" stroke="black" points="14347.56,-7854.17 13598.51,-7854.17 13405.81,-7718.17 14154.87,-7718.17 14347.56,-7854.17"/>
<text text-anchor="middle" x="13876.69" y="-7804.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="13876.69" y="-7789.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="13876.69" y="-7774.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13876.69" y="-7759.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_10 -->
<g id="edge208" class="edge">
<title>layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_10</title>
<path fill="none" stroke="black" d="M15439.57,-7962.01C15439.57,-7948 15439.57,-7935 15439.57,-7935 15439.57,-7935 13824.39,-7935 13824.39,-7935 13824.39,-7935 13824.39,-7864.48 13824.39,-7864.48"/>
<polygon fill="black" stroke="black" points="13827.89,-7864.48 13824.39,-7854.48 13820.89,-7864.48 13827.89,-7864.48"/>
</g>
<!-- layer_1_recv_attn_11 -->
<g id="node131" class="node">
<title>layer_1_recv_attn_11</title>
<polygon fill="#e6ffe6" stroke="black" points="15306.56,-7854.17 14557.51,-7854.17 14364.81,-7718.17 15113.87,-7718.17 15306.56,-7854.17"/>
<text text-anchor="middle" x="14835.69" y="-7804.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="14835.69" y="-7789.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="14835.69" y="-7774.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14835.69" y="-7759.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_11 -->
<g id="edge209" class="edge">
<title>layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_11</title>
<path fill="none" stroke="black" d="M15490.02,-7961.91C15490.02,-7944.09 15490.02,-7926 15490.02,-7926 15490.02,-7926 15066.54,-7926 15066.54,-7926 15066.54,-7926 15066.54,-7864.44 15066.54,-7864.44"/>
<polygon fill="black" stroke="black" points="15070.04,-7864.44 15066.54,-7854.44 15063.04,-7864.44 15070.04,-7864.44"/>
</g>
<!-- layer_1_recv_attn_12 -->
<g id="node132" class="node">
<title>layer_1_recv_attn_12</title>
<polygon fill="#e6ffe6" stroke="black" points="16265.56,-7854.17 15516.51,-7854.17 15323.81,-7718.17 16072.87,-7718.17 16265.56,-7854.17"/>
<text text-anchor="middle" x="15794.69" y="-7804.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="15794.69" y="-7789.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="15794.69" y="-7774.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15794.69" y="-7759.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_12 -->
<g id="edge210" class="edge">
<title>layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_12</title>
<path fill="none" stroke="black" d="M15540.46,-7961.96C15540.46,-7961.96 15540.46,-7864.33 15540.46,-7864.33"/>
<polygon fill="black" stroke="black" points="15543.96,-7864.33 15540.46,-7854.33 15536.96,-7864.33 15543.96,-7864.33"/>
</g>
<!-- layer_1_recv_attn_13 -->
<g id="node133" class="node">
<title>layer_1_recv_attn_13</title>
<polygon fill="#e6ffe6" stroke="black" points="17224.56,-7854.17 16475.51,-7854.17 16282.81,-7718.17 17031.87,-7718.17 17224.56,-7854.17"/>
<text text-anchor="middle" x="16753.69" y="-7804.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="16753.69" y="-7789.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="16753.69" y="-7774.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16753.69" y="-7759.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_13 -->
<g id="edge211" class="edge">
<title>layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_13</title>
<path fill="none" stroke="black" d="M15590.91,-7961.8C15590.91,-7939.28 15590.91,-7914 15590.91,-7914 15590.91,-7914 16530.47,-7914 16530.47,-7914 16530.47,-7914 16530.47,-7864.2 16530.47,-7864.2"/>
<polygon fill="black" stroke="black" points="16533.97,-7864.2 16530.47,-7854.2 16526.97,-7864.2 16533.97,-7864.2"/>
</g>
<!-- layer_1_recv_attn_14 -->
<g id="node134" class="node">
<title>layer_1_recv_attn_14</title>
<polygon fill="#e6ffe6" stroke="black" points="18183.56,-7854.17 17434.51,-7854.17 17241.81,-7718.17 17990.87,-7718.17 18183.56,-7854.17"/>
<text text-anchor="middle" x="17712.69" y="-7804.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="17712.69" y="-7789.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="17712.69" y="-7774.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17712.69" y="-7759.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_14 -->
<g id="edge212" class="edge">
<title>layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_14</title>
<path fill="none" stroke="black" d="M15641.35,-7961.99C15641.35,-7930.95 15641.35,-7890 15641.35,-7890 15641.35,-7890 17401.52,-7890 17401.52,-7890 17401.52,-7890 17401.52,-7841.11 17401.52,-7841.11"/>
<polygon fill="black" stroke="black" points="17405.02,-7841.11 17401.52,-7831.11 17398.02,-7841.11 17405.02,-7841.11"/>
</g>
<!-- layer_1_recv_attn_15 -->
<g id="node135" class="node">
<title>layer_1_recv_attn_15</title>
<polygon fill="#e6ffe6" stroke="black" points="19142.56,-7854.17 18393.51,-7854.17 18200.81,-7718.17 18949.87,-7718.17 19142.56,-7854.17"/>
<text text-anchor="middle" x="18671.69" y="-7804.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="18671.69" y="-7789.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="18671.69" y="-7774.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18671.69" y="-7759.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_15 -->
<g id="edge213" class="edge">
<title>layer_1_attn_proj_0&#45;&gt;layer_1_recv_attn_15</title>
<path fill="none" stroke="black" d="M15691.8,-7962.15C15691.8,-7932.43 15691.8,-7894 15691.8,-7894 15691.8,-7894 18410.19,-7894 18410.19,-7894 18410.19,-7894 18410.19,-7864.46 18410.19,-7864.46"/>
<polygon fill="black" stroke="black" points="18413.69,-7864.46 18410.19,-7854.46 18406.69,-7864.46 18413.69,-7864.46"/>
</g>
<!-- layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_8 -->
<g id="edge214" class="edge">
<title>layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_8</title>
<path fill="none" stroke="black" d="M16099.6,-7962.11C16099.6,-7935.85 16099.6,-7904 16099.6,-7904 16099.6,-7904 19473.79,-7904 19473.79,-7904 19473.79,-7904 19473.79,-7864.37 19473.79,-7864.37"/>
<polygon fill="black" stroke="black" points="19477.29,-7864.37 19473.79,-7854.37 19470.29,-7864.37 19477.29,-7864.37"/>
</g>
<!-- layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_9 -->
<g id="edge215" class="edge">
<title>layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_9</title>
<path fill="none" stroke="black" d="M15851.96,-7962.02C15851.96,-7953.63 15851.96,-7947 15851.96,-7947 15851.96,-7947 12865.39,-7947 12865.39,-7947 12865.39,-7947 12865.39,-7864.37 12865.39,-7864.37"/>
<polygon fill="black" stroke="black" points="12868.89,-7864.37 12865.39,-7854.37 12861.89,-7864.37 12868.89,-7864.37"/>
</g>
<!-- layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_10 -->
<g id="edge216" class="edge">
<title>layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_10</title>
<path fill="none" stroke="black" d="M15893.23,-7962C15893.23,-7947.11 15893.23,-7933 15893.23,-7933 15893.23,-7933 13928.98,-7933 13928.98,-7933 13928.98,-7933 13928.98,-7864.42 13928.98,-7864.42"/>
<polygon fill="black" stroke="black" points="13932.48,-7864.42 13928.98,-7854.42 13925.48,-7864.42 13932.48,-7864.42"/>
</g>
<!-- layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_11 -->
<g id="edge217" class="edge">
<title>layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_11</title>
<path fill="none" stroke="black" d="M15934.5,-7962.15C15934.5,-7943.05 15934.5,-7923 15934.5,-7923 15934.5,-7923 15106.51,-7923 15106.51,-7923 15106.51,-7923 15106.51,-7864.18 15106.51,-7864.18"/>
<polygon fill="black" stroke="black" points="15110.01,-7864.18 15106.51,-7854.18 15103.01,-7864.18 15110.01,-7864.18"/>
</g>
<!-- layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_12 -->
<g id="edge218" class="edge">
<title>layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_12</title>
<path fill="none" stroke="black" d="M15975.78,-7961.96C15975.78,-7961.96 15975.78,-7864.33 15975.78,-7864.33"/>
<polygon fill="black" stroke="black" points="15979.28,-7864.33 15975.78,-7854.33 15972.28,-7864.33 15979.28,-7864.33"/>
</g>
<!-- layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_13 -->
<g id="edge219" class="edge">
<title>layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_13</title>
<path fill="none" stroke="black" d="M16264.76,-8007C16270.67,-8007 16274.03,-8007 16274.03,-8007 16274.03,-8007 16274.03,-7763 16274.03,-7763 16274.03,-7763 16336.1,-7763 16336.1,-7763"/>
<polygon fill="black" stroke="black" points="16336.1,-7766.5 16346.1,-7763 16336.1,-7759.5 16336.1,-7766.5"/>
</g>
<!-- layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_14 -->
<g id="edge220" class="edge">
<title>layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_14</title>
<path fill="none" stroke="black" d="M16017.05,-7961.7C16017.05,-7939.98 16017.05,-7916 16017.05,-7916 16017.05,-7916 17441.4,-7916 17441.4,-7916 17441.4,-7916 17441.4,-7864.51 17441.4,-7864.51"/>
<polygon fill="black" stroke="black" points="17444.9,-7864.51 17441.4,-7854.51 17437.9,-7864.51 17444.9,-7864.51"/>
</g>
<!-- layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_15 -->
<g id="edge221" class="edge">
<title>layer_1_attn_proj_1&#45;&gt;layer_1_recv_attn_15</title>
<path fill="none" stroke="black" d="M16058.32,-7962.04C16058.32,-7933.35 16058.32,-7897 16058.32,-7897 16058.32,-7897 18514.79,-7897 18514.79,-7897 18514.79,-7897 18514.79,-7864.47 18514.79,-7864.47"/>
<polygon fill="black" stroke="black" points="18518.29,-7864.47 18514.79,-7854.47 18511.29,-7864.47 18518.29,-7864.47"/>
</g>
<!-- layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_8 -->
<g id="edge222" class="edge">
<title>layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_8</title>
<path fill="none" stroke="black" d="M16695.44,-7962.13C16695.44,-7957.34 16695.44,-7954 16695.44,-7954 16695.44,-7954 19578.39,-7954 19578.39,-7954 19578.39,-7954 19578.39,-7864.43 19578.39,-7864.43"/>
<polygon fill="black" stroke="black" points="19581.89,-7864.43 19578.39,-7854.43 19574.89,-7864.43 19581.89,-7864.43"/>
</g>
<!-- layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_9 -->
<g id="edge223" class="edge">
<title>layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_9</title>
<path fill="none" stroke="black" d="M16324.24,-7961.91C16324.24,-7929.24 16324.24,-7885 16324.24,-7885 16324.24,-7885 12969.98,-7885 12969.98,-7885 12969.98,-7885 12969.98,-7864.27 12969.98,-7864.27"/>
<polygon fill="black" stroke="black" points="12973.48,-7864.27 12969.98,-7854.27 12966.48,-7864.27 12973.48,-7864.27"/>
</g>
<!-- layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_10 -->
<g id="edge224" class="edge">
<title>layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_10</title>
<path fill="none" stroke="black" d="M16365.49,-7961.99C16365.49,-7927.09 16365.49,-7878 16365.49,-7878 16365.49,-7878 14033.58,-7878 14033.58,-7878 14033.58,-7878 14033.58,-7864.35 14033.58,-7864.35"/>
<polygon fill="black" stroke="black" points="14037.08,-7864.35 14033.58,-7854.35 14030.08,-7864.35 14037.08,-7864.35"/>
</g>
<!-- layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_11 -->
<g id="edge225" class="edge">
<title>layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_11</title>
<path fill="none" stroke="black" d="M16447.98,-7961.97C16447.98,-7937.55 16447.98,-7909 16447.98,-7909 16447.98,-7909 15146.49,-7909 15146.49,-7909 15146.49,-7909 15146.49,-7864.41 15146.49,-7864.41"/>
<polygon fill="black" stroke="black" points="15149.99,-7864.41 15146.49,-7854.41 15142.99,-7864.41 15149.99,-7864.41"/>
</g>
<!-- layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_12 -->
<g id="edge226" class="edge">
<title>layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_12</title>
<path fill="none" stroke="black" d="M16282.37,-7984C16279.77,-7984 16278.36,-7984 16278.36,-7984 16278.36,-7984 16278.36,-7808 16278.36,-7808 16278.36,-7808 16210.38,-7808 16210.38,-7808"/>
<polygon fill="black" stroke="black" points="16210.38,-7804.5 16200.38,-7808 16210.38,-7811.5 16210.38,-7804.5"/>
</g>
<!-- layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_13 -->
<g id="edge227" class="edge">
<title>layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_13</title>
<path fill="none" stroke="black" d="M16571.71,-7961.96C16571.71,-7961.96 16571.71,-7864.33 16571.71,-7864.33"/>
<polygon fill="black" stroke="black" points="16575.21,-7864.33 16571.71,-7854.33 16568.21,-7864.33 16575.21,-7864.33"/>
</g>
<!-- layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_14 -->
<g id="edge228" class="edge">
<title>layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_14</title>
<path fill="none" stroke="black" d="M16612.95,-7962.08C16612.95,-7945.04 16612.95,-7928 16612.95,-7928 16612.95,-7928 17481.28,-7928 17481.28,-7928 17481.28,-7928 17481.28,-7864.18 17481.28,-7864.18"/>
<polygon fill="black" stroke="black" points="17484.78,-7864.18 17481.28,-7854.18 17477.78,-7864.18 17484.78,-7864.18"/>
</g>
<!-- layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_15 -->
<g id="edge229" class="edge">
<title>layer_1_attn_proj_2&#45;&gt;layer_1_recv_attn_15</title>
<path fill="none" stroke="black" d="M16654.2,-7961.88C16654.2,-7950.18 16654.2,-7940 16654.2,-7940 16654.2,-7940 18619.39,-7940 18619.39,-7940 18619.39,-7940 18619.39,-7864.54 18619.39,-7864.54"/>
<polygon fill="black" stroke="black" points="18622.89,-7864.54 18619.39,-7854.54 18615.89,-7864.54 18622.89,-7864.54"/>
</g>
<!-- layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_8 -->
<g id="edge230" class="edge">
<title>layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_8</title>
<path fill="none" stroke="black" d="M17158.24,-7962.12C17158.24,-7959.01 17158.24,-7957 17158.24,-7957 17158.24,-7957 19682.98,-7957 19682.98,-7957 19682.98,-7957 19682.98,-7864.18 19682.98,-7864.18"/>
<polygon fill="black" stroke="black" points="19686.48,-7864.18 19682.98,-7854.18 19679.48,-7864.18 19686.48,-7864.18"/>
</g>
<!-- layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_9 -->
<g id="edge231" class="edge">
<title>layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_9</title>
<path fill="none" stroke="black" d="M16805.13,-7961.91C16805.13,-7928.28 16805.13,-7882 16805.13,-7882 16805.13,-7882 13074.58,-7882 13074.58,-7882 13074.58,-7882 13074.58,-7864.28 13074.58,-7864.28"/>
<polygon fill="black" stroke="black" points="13078.08,-7864.28 13074.58,-7854.28 13071.08,-7864.28 13078.08,-7864.28"/>
</g>
<!-- layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_10 -->
<g id="edge232" class="edge">
<title>layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_10</title>
<path fill="none" stroke="black" d="M16855.57,-7962.09C16855.57,-7926.25 16855.57,-7875 16855.57,-7875 16855.57,-7875 14138.18,-7875 14138.18,-7875 14138.18,-7875 14138.18,-7864.4 14138.18,-7864.4"/>
<polygon fill="black" stroke="black" points="14141.68,-7864.4 14138.18,-7854.4 14134.68,-7864.4 14141.68,-7864.4"/>
</g>
<!-- layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_11 -->
<g id="edge233" class="edge">
<title>layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_11</title>
<path fill="none" stroke="black" d="M16906.02,-7962.02C16906.02,-7924.66 16906.02,-7870 16906.02,-7870 16906.02,-7870 15186.46,-7870 15186.46,-7870 15186.46,-7870 15186.46,-7864.23 15186.46,-7864.23"/>
<polygon fill="black" stroke="black" points="15189.96,-7864.23 15186.46,-7854.23 15182.96,-7864.23 15189.96,-7864.23"/>
</g>
<!-- layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_12 -->
<g id="edge234" class="edge">
<title>layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_12</title>
<path fill="none" stroke="black" d="M16956.46,-7962.1C16956.46,-7942.21 16956.46,-7921 16956.46,-7921 16956.46,-7921 16140.87,-7921 16140.87,-7921 16140.87,-7921 16140.87,-7864.37 16140.87,-7864.37"/>
<polygon fill="black" stroke="black" points="16144.37,-7864.37 16140.87,-7854.37 16137.37,-7864.37 16144.37,-7864.37"/>
</g>
<!-- layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_13 -->
<g id="edge235" class="edge">
<title>layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_13</title>
<path fill="none" stroke="black" d="M17006.91,-7961.96C17006.91,-7961.96 17006.91,-7864.33 17006.91,-7864.33"/>
<polygon fill="black" stroke="black" points="17010.41,-7864.33 17006.91,-7854.33 17003.41,-7864.33 17010.41,-7864.33"/>
</g>
<!-- layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_14 -->
<g id="edge236" class="edge">
<title>layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_14</title>
<path fill="none" stroke="black" d="M17057.35,-7961.92C17057.35,-7945.78 17057.35,-7930 17057.35,-7930 17057.35,-7930 17521.16,-7930 17521.16,-7930 17521.16,-7930 17521.16,-7864.29 17521.16,-7864.29"/>
<polygon fill="black" stroke="black" points="17524.66,-7864.29 17521.16,-7854.29 17517.66,-7864.29 17524.66,-7864.29"/>
</g>
<!-- layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_15 -->
<g id="edge237" class="edge">
<title>layer_1_attn_proj_3&#45;&gt;layer_1_recv_attn_15</title>
<path fill="none" stroke="black" d="M17107.8,-7961.86C17107.8,-7951.11 17107.8,-7942 17107.8,-7942 17107.8,-7942 18723.98,-7942 18723.98,-7942 18723.98,-7942 18723.98,-7864.52 18723.98,-7864.52"/>
<polygon fill="black" stroke="black" points="18727.48,-7864.52 18723.98,-7854.52 18720.48,-7864.52 18727.48,-7864.52"/>
</g>
<!-- layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_8 -->
<g id="edge238" class="edge">
<title>layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_8</title>
<path fill="none" stroke="black" d="M17640.81,-7961.92C17640.81,-7960.1 17640.81,-7959 17640.81,-7959 17640.81,-7959 19787.58,-7959 19787.58,-7959 19787.58,-7959 19787.58,-7864.47 19787.58,-7864.47"/>
<polygon fill="black" stroke="black" points="19791.08,-7864.47 19787.58,-7854.47 19784.08,-7864.47 19791.08,-7864.47"/>
</g>
<!-- layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_9 -->
<g id="edge239" class="edge">
<title>layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_9</title>
<path fill="none" stroke="black" d="M17238.17,-7962.14C17238.17,-7871.49 17238.17,-7631 17238.17,-7631 17238.17,-7631 13080.79,-7631 13080.79,-7631 13080.79,-7631 13080.79,-7708.11 13080.79,-7708.11"/>
<polygon fill="black" stroke="black" points="13077.29,-7708.11 13080.79,-7718.11 13084.29,-7708.11 13077.29,-7708.11"/>
</g>
<!-- layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_10 -->
<g id="edge240" class="edge">
<title>layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_10</title>
<path fill="none" stroke="black" d="M17234.34,-7962.01C17234.34,-7875.21 17234.34,-7653 17234.34,-7653 17234.34,-7653 14039.79,-7653 14039.79,-7653 14039.79,-7653 14039.79,-7708.02 14039.79,-7708.02"/>
<polygon fill="black" stroke="black" points="14036.29,-7708.02 14039.79,-7718.02 14043.29,-7708.02 14036.29,-7708.02"/>
</g>
<!-- layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_11 -->
<g id="edge241" class="edge">
<title>layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_11</title>
<path fill="none" stroke="black" d="M17361.64,-7962.16C17361.64,-7924.19 17361.64,-7868 17361.64,-7868 17361.64,-7868 15226.43,-7868 15226.43,-7868 15226.43,-7868 15226.43,-7864.49 15226.43,-7864.49"/>
<polygon fill="black" stroke="black" points="15229.93,-7864.49 15226.43,-7854.49 15222.93,-7864.49 15229.93,-7864.49"/>
</g>
<!-- layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_12 -->
<g id="edge242" class="edge">
<title>layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_12</title>
<path fill="none" stroke="black" d="M17230.51,-7962.11C17230.51,-7941.04 17230.51,-7918 17230.51,-7918 17230.51,-7918 16182.14,-7918 16182.14,-7918 16182.14,-7918 16182.14,-7864.4 16182.14,-7864.4"/>
<polygon fill="black" stroke="black" points="16185.64,-7864.4 16182.14,-7854.4 16178.64,-7864.4 16185.64,-7864.4"/>
</g>
<!-- layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_13 -->
<g id="edge243" class="edge">
<title>layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_13</title>
<path fill="none" stroke="black" d="M17226.47,-7996C17218.53,-7996 17213.91,-7996 17213.91,-7996 17213.91,-7996 17213.91,-7796.32 17213.91,-7796.32"/>
<polygon fill="black" stroke="black" points="17217.41,-7796.32 17213.91,-7786.32 17210.41,-7796.32 17217.41,-7796.32"/>
</g>
<!-- layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_14 -->
<g id="edge244" class="edge">
<title>layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_14</title>
<path fill="none" stroke="black" d="M17561.04,-7961.96C17561.04,-7961.96 17561.04,-7864.33 17561.04,-7864.33"/>
<polygon fill="black" stroke="black" points="17564.54,-7864.33 17561.04,-7854.33 17557.54,-7864.33 17564.54,-7864.33"/>
</g>
<!-- layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_15 -->
<g id="edge245" class="edge">
<title>layer_1_attn_proj_4&#45;&gt;layer_1_recv_attn_15</title>
<path fill="none" stroke="black" d="M17600.92,-7962.04C17600.92,-7952.65 17600.92,-7945 17600.92,-7945 17600.92,-7945 18828.58,-7945 18828.58,-7945 18828.58,-7945 18828.58,-7864.45 18828.58,-7864.45"/>
<polygon fill="black" stroke="black" points="18832.08,-7864.45 18828.58,-7854.45 18825.08,-7864.45 18832.08,-7864.45"/>
</g>
<!-- layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_8 -->
<g id="edge246" class="edge">
<title>layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_8</title>
<path fill="none" stroke="black" d="M18152.71,-7996C18670.07,-7996 19892.18,-7996 19892.18,-7996 19892.18,-7996 19892.18,-7864.29 19892.18,-7864.29"/>
<polygon fill="black" stroke="black" points="19895.68,-7864.29 19892.18,-7854.29 19888.68,-7864.29 19895.68,-7864.29"/>
</g>
<!-- layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_9 -->
<g id="edge247" class="edge">
<title>layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_9</title>
<path fill="none" stroke="black" d="M17763.54,-7961.94C17763.54,-7927.67 17763.54,-7880 17763.54,-7880 17763.54,-7880 13179.18,-7880 13179.18,-7880 13179.18,-7880 13179.18,-7864.36 13179.18,-7864.36"/>
<polygon fill="black" stroke="black" points="13182.68,-7864.36 13179.18,-7854.36 13175.68,-7864.36 13182.68,-7864.36"/>
</g>
<!-- layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_10 -->
<g id="edge248" class="edge">
<title>layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_10</title>
<path fill="none" stroke="black" d="M17828.4,-7961.86C17828.4,-7925.41 17828.4,-7873 17828.4,-7873 17828.4,-7873 14242.77,-7873 14242.77,-7873 14242.77,-7873 14242.77,-7864.58 14242.77,-7864.58"/>
<polygon fill="black" stroke="black" points="14246.28,-7864.58 14242.77,-7854.58 14239.28,-7864.58 14246.28,-7864.58"/>
</g>
<!-- layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_11 -->
<g id="edge249" class="edge">
<title>layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_11</title>
<path fill="none" stroke="black" d="M17893.26,-7961.97C17893.26,-7923.4 17893.26,-7866 17893.26,-7866 17893.26,-7866 15266.4,-7866 15266.4,-7866 15266.4,-7866 15266.4,-7864.22 15266.4,-7864.22"/>
<polygon fill="black" stroke="black" points="15269.9,-7864.22 15266.4,-7854.22 15262.9,-7864.22 15269.9,-7864.22"/>
</g>
<!-- layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_12 -->
<g id="edge250" class="edge">
<title>layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_12</title>
<path fill="none" stroke="black" d="M17958.11,-7962.08C17958.11,-7936.54 17958.11,-7906 17958.11,-7906 17958.11,-7906 16223.41,-7906 16223.41,-7906 16223.41,-7906 16223.41,-7864.48 16223.41,-7864.48"/>
<polygon fill="black" stroke="black" points="16226.91,-7864.48 16223.41,-7854.48 16219.91,-7864.48 16226.91,-7864.48"/>
</g>
<!-- layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_13 -->
<g id="edge251" class="edge">
<title>layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_13</title>
<path fill="none" stroke="black" d="M18022.97,-7961.88C18022.97,-7920.38 18022.97,-7856 18022.97,-7856 18022.97,-7856 17219.14,-7856 17219.14,-7856 17219.14,-7856 17219.14,-7796.22 17219.14,-7796.22"/>
<polygon fill="black" stroke="black" points="17222.64,-7796.22 17219.14,-7786.22 17215.64,-7796.22 17222.64,-7796.22"/>
</g>
<!-- layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_14 -->
<g id="edge252" class="edge">
<title>layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_14</title>
<path fill="none" stroke="black" d="M18087.83,-7961.96C18087.83,-7961.96 18087.83,-7864.33 18087.83,-7864.33"/>
<polygon fill="black" stroke="black" points="18091.33,-7864.33 18087.83,-7854.33 18084.33,-7864.33 18091.33,-7864.33"/>
</g>
<!-- layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_15 -->
<g id="edge253" class="edge">
<title>layer_1_attn_proj_5&#45;&gt;layer_1_recv_attn_15</title>
<path fill="none" stroke="black" d="M18152.75,-7979C18478,-7979 19037.77,-7979 19037.77,-7979 19037.77,-7979 19037.77,-7864.42 19037.77,-7864.42"/>
<polygon fill="black" stroke="black" points="19041.28,-7864.42 19037.77,-7854.42 19034.28,-7864.42 19041.28,-7864.42"/>
</g>
<!-- layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_8 -->
<g id="edge254" class="edge">
<title>layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_8</title>
<path fill="none" stroke="black" d="M14783.83,-7961.91C14783.83,-7933.93 14783.83,-7899 14783.83,-7899 14783.83,-7899 19264.6,-7899 19264.6,-7899 19264.6,-7899 19264.6,-7802.23 19264.6,-7802.23"/>
<polygon fill="black" stroke="black" points="19268.1,-7802.23 19264.6,-7792.23 19261.1,-7802.23 19268.1,-7802.23"/>
</g>
<!-- layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_9 -->
<g id="edge255" class="edge">
<title>layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_9</title>
<path fill="none" stroke="black" d="M14394.23,-7996C13856.48,-7996 12551.6,-7996 12551.6,-7996 12551.6,-7996 12551.6,-7802.22 12551.6,-7802.22"/>
<polygon fill="black" stroke="black" points="12555.1,-7802.22 12551.6,-7792.22 12548.1,-7802.22 12555.1,-7802.22"/>
</g>
<!-- layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_10 -->
<g id="edge256" class="edge">
<title>layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_10</title>
<path fill="none" stroke="black" d="M14394.55,-7979C14097.7,-7979 13615.19,-7979 13615.19,-7979 13615.19,-7979 13615.19,-7864.42 13615.19,-7864.42"/>
<polygon fill="black" stroke="black" points="13618.69,-7864.42 13615.19,-7854.42 13611.69,-7864.42 13618.69,-7864.42"/>
</g>
<!-- layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_11 -->
<g id="edge257" class="edge">
<title>layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_11</title>
<path fill="none" stroke="black" d="M14459.54,-7961.96C14459.54,-7961.96 14459.54,-7796.25 14459.54,-7796.25"/>
<polygon fill="black" stroke="black" points="14463.04,-7796.25 14459.54,-7786.25 14456.04,-7796.25 14463.04,-7796.25"/>
</g>
<!-- layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_12 -->
<g id="edge258" class="edge">
<title>layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_12</title>
<path fill="none" stroke="black" d="M14524.4,-7962.01C14524.4,-7921.1 14524.4,-7858 14524.4,-7858 14524.4,-7858 15328.9,-7858 15328.9,-7858 15328.9,-7858 15328.9,-7796.22 15328.9,-7796.22"/>
<polygon fill="black" stroke="black" points="15332.4,-7796.22 15328.9,-7786.22 15325.4,-7796.22 15332.4,-7796.22"/>
</g>
<!-- layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_13 -->
<g id="edge259" class="edge">
<title>layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_13</title>
<path fill="none" stroke="black" d="M14589.26,-7961.93C14589.26,-7929.91 14589.26,-7887 14589.26,-7887 14589.26,-7887 16406.73,-7887 16406.73,-7887 16406.73,-7887 16406.73,-7816.09 16406.73,-7816.09"/>
<polygon fill="black" stroke="black" points="16410.23,-7816.09 16406.73,-7806.09 16403.23,-7816.09 16410.23,-7816.09"/>
</g>
<!-- layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_14 -->
<g id="edge260" class="edge">
<title>layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_14</title>
<path fill="none" stroke="black" d="M14654.11,-7962.06C14654.11,-7922.02 14654.11,-7861 14654.11,-7861 14654.11,-7861 17281.88,-7861 17281.88,-7861 17281.88,-7861 17281.88,-7796.22 17281.88,-7796.22"/>
<polygon fill="black" stroke="black" points="17285.38,-7796.22 17281.88,-7786.22 17278.38,-7796.22 17285.38,-7796.22"/>
</g>
<!-- layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_15 -->
<g id="edge261" class="edge">
<title>layer_1_attn_proj_6&#45;&gt;layer_1_recv_attn_15</title>
<path fill="none" stroke="black" d="M14718.97,-7962.06C14718.97,-7931.68 14718.97,-7892 14718.97,-7892 14718.97,-7892 18305.6,-7892 18305.6,-7892 18305.6,-7892 18305.6,-7802.16 18305.6,-7802.16"/>
<polygon fill="black" stroke="black" points="18309.1,-7802.16 18305.6,-7792.16 18302.1,-7802.16 18309.1,-7802.16"/>
</g>
<!-- layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_8 -->
<g id="edge262" class="edge">
<title>layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_8</title>
<path fill="none" stroke="black" d="M15309.95,-7961.99C15309.95,-7879.08 15309.95,-7674 15309.95,-7674 15309.95,-7674 19314.12,-7674 19314.12,-7674 19314.12,-7674 19314.12,-7708.01 19314.12,-7708.01"/>
<polygon fill="black" stroke="black" points="19310.62,-7708.01 19314.12,-7718.01 19317.62,-7708.01 19310.62,-7708.01"/>
</g>
<!-- layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_9 -->
<g id="edge263" class="edge">
<title>layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_9</title>
<path fill="none" stroke="black" d="M14906.66,-7961.8C14906.66,-7956.1 14906.66,-7952 14906.66,-7952 14906.66,-7952 12656.19,-7952 12656.19,-7952 12656.19,-7952 12656.19,-7864.57 12656.19,-7864.57"/>
<polygon fill="black" stroke="black" points="12659.69,-7864.57 12656.19,-7854.57 12652.69,-7864.57 12659.69,-7864.57"/>
</g>
<!-- layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_10 -->
<g id="edge264" class="edge">
<title>layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_10</title>
<path fill="none" stroke="black" d="M14946.63,-7961.99C14946.63,-7949.33 14946.63,-7938 14946.63,-7938 14946.63,-7938 13719.79,-7938 13719.79,-7938 13719.79,-7938 13719.79,-7864.53 13719.79,-7864.53"/>
<polygon fill="black" stroke="black" points="13723.29,-7864.53 13719.79,-7854.53 13716.29,-7864.53 13723.29,-7864.53"/>
</g>
<!-- layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_11 -->
<g id="edge265" class="edge">
<title>layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_11</title>
<path fill="none" stroke="black" d="M14986.6,-7961.96C14986.6,-7961.96 14986.6,-7864.33 14986.6,-7864.33"/>
<polygon fill="black" stroke="black" points="14990.1,-7864.33 14986.6,-7854.33 14983.1,-7864.33 14990.1,-7864.33"/>
</g>
<!-- layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_12 -->
<g id="edge266" class="edge">
<title>layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_12</title>
<path fill="none" stroke="black" d="M15320.88,-7996C15329.04,-7996 15333.79,-7996 15333.79,-7996 15333.79,-7996 15333.79,-7796.32 15333.79,-7796.32"/>
<polygon fill="black" stroke="black" points="15337.29,-7796.32 15333.79,-7786.32 15330.29,-7796.32 15337.29,-7796.32"/>
</g>
<!-- layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_13 -->
<g id="edge267" class="edge">
<title>layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_13</title>
<path fill="none" stroke="black" d="M15317.11,-7962.02C15317.11,-7938.32 15317.11,-7911 15317.11,-7911 15317.11,-7911 16489.22,-7911 16489.22,-7911 16489.22,-7911 16489.22,-7864.43 16489.22,-7864.43"/>
<polygon fill="black" stroke="black" points="16492.72,-7864.43 16489.22,-7854.43 16485.72,-7864.43 16492.72,-7864.43"/>
</g>
<!-- layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_14 -->
<g id="edge268" class="edge">
<title>layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_14</title>
<path fill="none" stroke="black" d="M15026.57,-7961.87C15026.57,-7922.42 15026.57,-7863 15026.57,-7863 15026.57,-7863 17321.76,-7863 17321.76,-7863 17321.76,-7863 17321.76,-7796.22 17321.76,-7796.22"/>
<polygon fill="black" stroke="black" points="17325.26,-7796.22 17321.76,-7786.22 17318.26,-7796.22 17325.26,-7796.22"/>
</g>
<!-- layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_15 -->
<g id="edge269" class="edge">
<title>layer_1_attn_proj_7&#45;&gt;layer_1_recv_attn_15</title>
<path fill="none" stroke="black" d="M15313.53,-7962.03C15313.53,-7883.35 15313.53,-7696 15313.53,-7696 15313.53,-7696 18355.12,-7696 18355.12,-7696 18355.12,-7696 18355.12,-7707.83 18355.12,-7707.83"/>
<polygon fill="black" stroke="black" points="18351.62,-7707.83 18355.12,-7717.83 18358.62,-7707.83 18351.62,-7707.83"/>
</g>
<!-- layer_1_recv_attn_8&#45;&gt;layer_1_residual1 -->
<g id="edge270" class="edge">
<title>layer_1_recv_attn_8&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M19468.25,-7717.92C19468.25,-7645.07 19468.25,-7540 19468.25,-7540 19468.25,-7540 16031.71,-7540 16031.71,-7540"/>
<polygon fill="black" stroke="black" points="16031.71,-7536.5 16021.71,-7540 16031.71,-7543.5 16031.71,-7536.5"/>
</g>
<!-- layer_1_recv_attn_9&#45;&gt;layer_1_residual1 -->
<g id="edge271" class="edge">
<title>layer_1_recv_attn_9&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M13234.58,-7745.32C13234.58,-7677.02 13234.58,-7547 13234.58,-7547 13234.58,-7547 15557.49,-7547 15557.49,-7547"/>
<polygon fill="black" stroke="black" points="15557.49,-7550.5 15567.49,-7547 15557.49,-7543.5 15557.49,-7550.5"/>
</g>
<!-- layer_1_recv_attn_10&#45;&gt;layer_1_residual1 -->
<g id="edge272" class="edge">
<title>layer_1_recv_attn_10&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M14193.58,-7745.39C14193.58,-7682.24 14193.58,-7568 14193.58,-7568 14193.58,-7568 15557.41,-7568 15557.41,-7568"/>
<polygon fill="black" stroke="black" points="15557.41,-7571.5 15567.41,-7568 15557.41,-7564.5 15557.41,-7571.5"/>
</g>
<!-- layer_1_recv_attn_11&#45;&gt;layer_1_residual1 -->
<g id="edge273" class="edge">
<title>layer_1_recv_attn_11&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M15075.69,-7718.04C15075.69,-7661.05 15075.69,-7589 15075.69,-7589 15075.69,-7589 15557.68,-7589 15557.68,-7589"/>
<polygon fill="black" stroke="black" points="15557.68,-7592.5 15567.68,-7589 15557.68,-7585.5 15557.68,-7592.5"/>
</g>
<!-- layer_1_recv_attn_12&#45;&gt;layer_1_residual1 -->
<g id="edge274" class="edge">
<title>layer_1_recv_attn_12&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M15794.69,-7717.94C15794.69,-7717.94 15794.69,-7620.38 15794.69,-7620.38"/>
<polygon fill="black" stroke="black" points="15798.19,-7620.38 15794.69,-7610.38 15791.19,-7620.38 15798.19,-7620.38"/>
</g>
<!-- layer_1_recv_attn_13&#45;&gt;layer_1_residual1 -->
<g id="edge275" class="edge">
<title>layer_1_recv_attn_13&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M16514.19,-7717.9C16514.19,-7658.55 16514.19,-7582 16514.19,-7582 16514.19,-7582 16031.85,-7582 16031.85,-7582"/>
<polygon fill="black" stroke="black" points="16031.85,-7578.5 16021.85,-7582 16031.85,-7585.5 16031.85,-7578.5"/>
</g>
<!-- layer_1_recv_attn_14&#45;&gt;layer_1_residual1 -->
<g id="edge276" class="edge">
<title>layer_1_recv_attn_14&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M17473.19,-7718.03C17473.19,-7654.02 17473.19,-7568 17473.19,-7568 17473.19,-7568 16031.93,-7568 16031.93,-7568"/>
<polygon fill="black" stroke="black" points="16031.93,-7564.5 16021.93,-7568 16031.93,-7571.5 16031.93,-7564.5"/>
</g>
<!-- layer_1_recv_attn_15&#45;&gt;layer_1_residual1 -->
<g id="edge277" class="edge">
<title>layer_1_recv_attn_15&#45;&gt;layer_1_residual1</title>
<path fill="none" stroke="black" d="M18509.25,-7718.08C18509.25,-7649.57 18509.25,-7554 18509.25,-7554 18509.25,-7554 16031.75,-7554 16031.75,-7554"/>
<polygon fill="black" stroke="black" points="16031.75,-7550.5 16021.75,-7554 16031.75,-7557.5 16031.75,-7550.5"/>
</g>
<!-- layer_1_ln2 -->
<g id="node137" class="node">
<title>layer_1_ln2</title>
<polygon fill="#ffe6e6" stroke="black" points="16021.69,-7419.17 15567.69,-7419.17 15567.69,-7351.17 16021.69,-7351.17 16021.69,-7419.17"/>
<text text-anchor="middle" x="15794.69" y="-7403.97" font-family="monospace" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="15794.69" y="-7388.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15794.69" y="-7373.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15794.69" y="-7358.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_residual1&#45;&gt;layer_1_ln2 -->
<g id="edge279" class="edge">
<title>layer_1_residual1&#45;&gt;layer_1_ln2</title>
<path fill="none" stroke="black" d="M15794.69,-7527.03C15794.69,-7527.03 15794.69,-7429.27 15794.69,-7429.27"/>
<polygon fill="black" stroke="black" points="15798.19,-7429.27 15794.69,-7419.27 15791.19,-7429.27 15798.19,-7429.27"/>
</g>
<!-- layer_1_gate -->
<g id="node138" class="node">
<title>layer_1_gate</title>
<polygon fill="#ffe6e6" stroke="black" points="16256.97,-7243.17 15521.58,-7243.17 15332.4,-7107.17 16067.79,-7107.17 16256.97,-7243.17"/>
<text text-anchor="middle" x="15794.69" y="-7193.97" font-family="monospace" font-size="14.00">Gate (Top&#45;2 routing)</text>
<text text-anchor="middle" x="15794.69" y="-7178.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15794.69" y="-7163.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, top_k=2]</text>
<text text-anchor="middle" x="15794.69" y="-7148.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_gate -->
<g id="edge280" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" d="M15794.69,-7350.96C15794.69,-7350.96 15794.69,-7253.33 15794.69,-7253.33"/>
<polygon fill="black" stroke="black" points="15798.19,-7253.33 15794.69,-7243.33 15791.19,-7253.33 15798.19,-7253.33"/>
</g>
<!-- layer_1_expert_select_8 -->
<g id="node155" class="node">
<title>layer_1_expert_select_8</title>
<polygon fill="#ffe6e6" stroke="black" points="12909.56,-6999.17 12160.51,-6999.17 11967.81,-6863.17 12716.87,-6863.17 12909.56,-6999.17"/>
<text text-anchor="middle" x="12438.69" y="-6949.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="12438.69" y="-6934.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="12438.69" y="-6919.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12438.69" y="-6904.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_select_8 -->
<g id="edge281" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_select_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15474,-7209C14678.47,-7209 12678.19,-7209 12678.19,-7209 12678.19,-7209 12678.19,-7009.49 12678.19,-7009.49"/>
<polygon fill="black" stroke="black" points="12681.69,-7009.49 12678.19,-6999.49 12674.69,-7009.49 12681.69,-7009.49"/>
</g>
<!-- layer_1_expert_select_9 -->
<g id="node156" class="node">
<title>layer_1_expert_select_9</title>
<polygon fill="#ffe6e6" stroke="black" points="13868.56,-6999.17 13119.51,-6999.17 12926.81,-6863.17 13675.87,-6863.17 13868.56,-6999.17"/>
<text text-anchor="middle" x="13397.69" y="-6949.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="13397.69" y="-6934.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="13397.69" y="-6919.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13397.69" y="-6904.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_select_9 -->
<g id="edge282" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_select_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15426.56,-7175C14810.43,-7175 13637.19,-7175 13637.19,-7175 13637.19,-7175 13637.19,-7009.41 13637.19,-7009.41"/>
<polygon fill="black" stroke="black" points="13640.69,-7009.41 13637.19,-6999.41 13633.69,-7009.41 13640.69,-7009.41"/>
</g>
<!-- layer_1_expert_select_10 -->
<g id="node157" class="node">
<title>layer_1_expert_select_10</title>
<polygon fill="#ffe6e6" stroke="black" points="14827.56,-6999.17 14078.51,-6999.17 13885.81,-6863.17 14634.87,-6863.17 14827.56,-6999.17"/>
<text text-anchor="middle" x="14356.69" y="-6949.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="14356.69" y="-6934.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="14356.69" y="-6919.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14356.69" y="-6904.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_select_10 -->
<g id="edge283" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_select_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15379.29,-7141C15033.07,-7141 14596.19,-7141 14596.19,-7141 14596.19,-7141 14596.19,-7009.29 14596.19,-7009.29"/>
<polygon fill="black" stroke="black" points="14599.69,-7009.29 14596.19,-6999.29 14592.69,-7009.29 14599.69,-7009.29"/>
</g>
<!-- layer_1_expert_select_11 -->
<g id="node158" class="node">
<title>layer_1_expert_select_11</title>
<polygon fill="#ffe6e6" stroke="black" points="15786.56,-6999.17 15037.51,-6999.17 14844.81,-6863.17 15593.87,-6863.17 15786.56,-6999.17"/>
<text text-anchor="middle" x="15315.69" y="-6949.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="15315.69" y="-6934.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="15315.69" y="-6919.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15315.69" y="-6904.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_select_11 -->
<g id="edge284" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_select_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15559.33,-7106.87C15559.33,-7106.87 15559.33,-7009.44 15559.33,-7009.44"/>
<polygon fill="black" stroke="black" points="15562.83,-7009.44 15559.33,-6999.44 15555.83,-7009.44 15562.83,-7009.44"/>
</g>
<!-- layer_1_expert_select_12 -->
<g id="node159" class="node">
<title>layer_1_expert_select_12</title>
<polygon fill="#ffe6e6" stroke="black" points="16745.56,-6999.17 15996.51,-6999.17 15803.81,-6863.17 16552.87,-6863.17 16745.56,-6999.17"/>
<text text-anchor="middle" x="16274.69" y="-6949.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="16274.69" y="-6934.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="16274.69" y="-6919.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16274.69" y="-6904.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_select_12 -->
<g id="edge285" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_select_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16030.54,-7106.87C16030.54,-7106.87 16030.54,-7009.44 16030.54,-7009.44"/>
<polygon fill="black" stroke="black" points="16034.04,-7009.44 16030.54,-6999.44 16027.04,-7009.44 16034.04,-7009.44"/>
</g>
<!-- layer_1_expert_select_13 -->
<g id="node160" class="node">
<title>layer_1_expert_select_13</title>
<polygon fill="#ffe6e6" stroke="black" points="17704.56,-6999.17 16955.51,-6999.17 16762.81,-6863.17 17511.87,-6863.17 17704.56,-6999.17"/>
<text text-anchor="middle" x="17233.69" y="-6949.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="17233.69" y="-6934.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="17233.69" y="-6919.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17233.69" y="-6904.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_select_13 -->
<g id="edge286" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_select_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16115.21,-7141C16470.38,-7141 16993.69,-7141 16993.69,-7141 16993.69,-7141 16993.69,-7009.29 16993.69,-7009.29"/>
<polygon fill="black" stroke="black" points="16997.19,-7009.29 16993.69,-6999.29 16990.19,-7009.29 16997.19,-7009.29"/>
</g>
<!-- layer_1_expert_select_14 -->
<g id="node161" class="node">
<title>layer_1_expert_select_14</title>
<polygon fill="#ffe6e6" stroke="black" points="18663.56,-6999.17 17914.51,-6999.17 17721.81,-6863.17 18470.87,-6863.17 18663.56,-6999.17"/>
<text text-anchor="middle" x="18192.69" y="-6949.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="18192.69" y="-6934.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="18192.69" y="-6919.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18192.69" y="-6904.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_select_14 -->
<g id="edge287" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_select_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16162.29,-7175C16778.39,-7175 17952.69,-7175 17952.69,-7175 17952.69,-7175 17952.69,-7009.41 17952.69,-7009.41"/>
<polygon fill="black" stroke="black" points="17956.19,-7009.41 17952.69,-6999.41 17949.19,-7009.41 17956.19,-7009.41"/>
</g>
<!-- layer_1_expert_select_15 -->
<g id="node162" class="node">
<title>layer_1_expert_select_15</title>
<polygon fill="#ffe6e6" stroke="black" points="19622.56,-6999.17 18873.51,-6999.17 18680.81,-6863.17 19429.87,-6863.17 19622.56,-6999.17"/>
<text text-anchor="middle" x="19151.69" y="-6949.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="19151.69" y="-6934.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="19151.69" y="-6919.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19151.69" y="-6904.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_select_15 -->
<g id="edge288" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_select_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16209.81,-7209C17058.25,-7209 18911.69,-7209 18911.69,-7209 18911.69,-7209 18911.69,-7009.49 18911.69,-7009.49"/>
<polygon fill="black" stroke="black" points="18915.19,-7009.49 18911.69,-6999.49 18908.19,-7009.49 18915.19,-7009.49"/>
</g>
<!-- layer_1_expert_0_gpu_8 -->
<g id="node139" class="node">
<title>layer_1_expert_0_gpu_8</title>
<polygon fill="#ffe6e6" stroke="black" points="12482.69,-6755.17 12028.69,-6755.17 12028.69,-6687.17 12482.69,-6687.17 12482.69,-6755.17"/>
<text text-anchor="middle" x="12255.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="12255.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="12255.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12255.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_8 -->
<g id="node163" class="node">
<title>layer_1_expert_agg_8</title>
<polygon fill="#fff0e6" stroke="black" points="12909.56,-6579.17 12160.51,-6579.17 11967.81,-6443.17 12716.87,-6443.17 12909.56,-6579.17"/>
<text text-anchor="middle" x="12438.69" y="-6529.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12438.69" y="-6514.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="12438.69" y="-6499.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12438.69" y="-6484.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_0_gpu_8&#45;&gt;layer_1_expert_agg_8 -->
<g id="edge305" class="edge">
<title>layer_1_expert_0_gpu_8&#45;&gt;layer_1_expert_agg_8</title>
<path fill="none" stroke="black" d="M12255.69,-6686.96C12255.69,-6686.96 12255.69,-6589.33 12255.69,-6589.33"/>
<polygon fill="black" stroke="black" points="12259.19,-6589.33 12255.69,-6579.33 12252.19,-6589.33 12259.19,-6589.33"/>
</g>
<!-- layer_1_expert_1_gpu_8 -->
<g id="node140" class="node">
<title>layer_1_expert_1_gpu_8</title>
<polygon fill="#ffe6e6" stroke="black" points="12954.69,-6755.17 12500.69,-6755.17 12500.69,-6687.17 12954.69,-6687.17 12954.69,-6755.17"/>
<text text-anchor="middle" x="12727.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="12727.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="12727.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12727.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_1_gpu_8&#45;&gt;layer_1_expert_agg_8 -->
<g id="edge306" class="edge">
<title>layer_1_expert_1_gpu_8&#45;&gt;layer_1_expert_agg_8</title>
<path fill="none" stroke="black" d="M12705.03,-6686.96C12705.03,-6686.96 12705.03,-6589.33 12705.03,-6589.33"/>
<polygon fill="black" stroke="black" points="12708.53,-6589.33 12705.03,-6579.33 12701.53,-6589.33 12708.53,-6589.33"/>
</g>
<!-- layer_1_expert_2_gpu_9 -->
<g id="node141" class="node">
<title>layer_1_expert_2_gpu_9</title>
<polygon fill="#ffe6e6" stroke="black" points="13525.69,-6755.17 13071.69,-6755.17 13071.69,-6687.17 13525.69,-6687.17 13525.69,-6755.17"/>
<text text-anchor="middle" x="13298.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="13298.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="13298.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13298.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_9 -->
<g id="node164" class="node">
<title>layer_1_expert_agg_9</title>
<polygon fill="#fff0e6" stroke="black" points="13868.56,-6579.17 13119.51,-6579.17 12926.81,-6443.17 13675.87,-6443.17 13868.56,-6579.17"/>
<text text-anchor="middle" x="13397.69" y="-6529.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13397.69" y="-6514.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="13397.69" y="-6499.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13397.69" y="-6484.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_2_gpu_9&#45;&gt;layer_1_expert_agg_9 -->
<g id="edge307" class="edge">
<title>layer_1_expert_2_gpu_9&#45;&gt;layer_1_expert_agg_9</title>
<path fill="none" stroke="black" d="M13298.69,-6686.96C13298.69,-6686.96 13298.69,-6589.33 13298.69,-6589.33"/>
<polygon fill="black" stroke="black" points="13302.19,-6589.33 13298.69,-6579.33 13295.19,-6589.33 13302.19,-6589.33"/>
</g>
<!-- layer_1_expert_3_gpu_9 -->
<g id="node142" class="node">
<title>layer_1_expert_3_gpu_9</title>
<polygon fill="#ffe6e6" stroke="black" points="13997.69,-6755.17 13543.69,-6755.17 13543.69,-6687.17 13997.69,-6687.17 13997.69,-6755.17"/>
<text text-anchor="middle" x="13770.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="13770.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="13770.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13770.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_3_gpu_9&#45;&gt;layer_1_expert_agg_9 -->
<g id="edge308" class="edge">
<title>layer_1_expert_3_gpu_9&#45;&gt;layer_1_expert_agg_9</title>
<path fill="none" stroke="black" d="M13706.03,-6686.96C13706.03,-6686.96 13706.03,-6589.33 13706.03,-6589.33"/>
<polygon fill="black" stroke="black" points="13709.53,-6589.33 13706.03,-6579.33 13702.53,-6589.33 13709.53,-6589.33"/>
</g>
<!-- layer_1_expert_4_gpu_10 -->
<g id="node143" class="node">
<title>layer_1_expert_4_gpu_10</title>
<polygon fill="#ffe6e6" stroke="black" points="14526.69,-6755.17 14072.69,-6755.17 14072.69,-6687.17 14526.69,-6687.17 14526.69,-6755.17"/>
<text text-anchor="middle" x="14299.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="14299.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="14299.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14299.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_10 -->
<g id="node165" class="node">
<title>layer_1_expert_agg_10</title>
<polygon fill="#fff0e6" stroke="black" points="14827.56,-6579.17 14078.51,-6579.17 13885.81,-6443.17 14634.87,-6443.17 14827.56,-6579.17"/>
<text text-anchor="middle" x="14356.69" y="-6529.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14356.69" y="-6514.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="14356.69" y="-6499.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14356.69" y="-6484.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_4_gpu_10&#45;&gt;layer_1_expert_agg_10 -->
<g id="edge309" class="edge">
<title>layer_1_expert_4_gpu_10&#45;&gt;layer_1_expert_agg_10</title>
<path fill="none" stroke="black" d="M14299.69,-6686.96C14299.69,-6686.96 14299.69,-6589.33 14299.69,-6589.33"/>
<polygon fill="black" stroke="black" points="14303.19,-6589.33 14299.69,-6579.33 14296.19,-6589.33 14303.19,-6589.33"/>
</g>
<!-- layer_1_expert_5_gpu_10 -->
<g id="node144" class="node">
<title>layer_1_expert_5_gpu_10</title>
<polygon fill="#ffe6e6" stroke="black" points="14998.69,-6755.17 14544.69,-6755.17 14544.69,-6687.17 14998.69,-6687.17 14998.69,-6755.17"/>
<text text-anchor="middle" x="14771.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="14771.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="14771.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14771.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_5_gpu_10&#45;&gt;layer_1_expert_agg_10 -->
<g id="edge310" class="edge">
<title>layer_1_expert_5_gpu_10&#45;&gt;layer_1_expert_agg_10</title>
<path fill="none" stroke="black" d="M14686.03,-6686.96C14686.03,-6686.96 14686.03,-6589.33 14686.03,-6589.33"/>
<polygon fill="black" stroke="black" points="14689.53,-6589.33 14686.03,-6579.33 14682.53,-6589.33 14689.53,-6589.33"/>
</g>
<!-- layer_1_expert_6_gpu_11 -->
<g id="node145" class="node">
<title>layer_1_expert_6_gpu_11</title>
<polygon fill="#ffe6e6" stroke="black" points="15506.69,-6755.17 15052.69,-6755.17 15052.69,-6687.17 15506.69,-6687.17 15506.69,-6755.17"/>
<text text-anchor="middle" x="15279.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="15279.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="15279.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15279.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_11 -->
<g id="node166" class="node">
<title>layer_1_expert_agg_11</title>
<polygon fill="#fff0e6" stroke="black" points="15786.56,-6579.17 15037.51,-6579.17 14844.81,-6443.17 15593.87,-6443.17 15786.56,-6579.17"/>
<text text-anchor="middle" x="15315.69" y="-6529.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15315.69" y="-6514.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="15315.69" y="-6499.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15315.69" y="-6484.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_6_gpu_11&#45;&gt;layer_1_expert_agg_11 -->
<g id="edge311" class="edge">
<title>layer_1_expert_6_gpu_11&#45;&gt;layer_1_expert_agg_11</title>
<path fill="none" stroke="black" d="M15279.69,-6686.96C15279.69,-6686.96 15279.69,-6589.33 15279.69,-6589.33"/>
<polygon fill="black" stroke="black" points="15283.19,-6589.33 15279.69,-6579.33 15276.19,-6589.33 15283.19,-6589.33"/>
</g>
<!-- layer_1_expert_7_gpu_11 -->
<g id="node146" class="node">
<title>layer_1_expert_7_gpu_11</title>
<polygon fill="#ffe6e6" stroke="black" points="15978.69,-6755.17 15524.69,-6755.17 15524.69,-6687.17 15978.69,-6687.17 15978.69,-6755.17"/>
<text text-anchor="middle" x="15751.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="15751.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="15751.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15751.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_7_gpu_11&#45;&gt;layer_1_expert_agg_11 -->
<g id="edge312" class="edge">
<title>layer_1_expert_7_gpu_11&#45;&gt;layer_1_expert_agg_11</title>
<path fill="none" stroke="black" d="M15655.53,-6686.96C15655.53,-6686.96 15655.53,-6589.33 15655.53,-6589.33"/>
<polygon fill="black" stroke="black" points="15659.03,-6589.33 15655.53,-6579.33 15652.03,-6589.33 15659.03,-6589.33"/>
</g>
<!-- layer_1_expert_8_gpu_12 -->
<g id="node147" class="node">
<title>layer_1_expert_8_gpu_12</title>
<polygon fill="#ffe6e6" stroke="black" points="16475.69,-6755.17 16021.69,-6755.17 16021.69,-6687.17 16475.69,-6687.17 16475.69,-6755.17"/>
<text text-anchor="middle" x="16248.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="16248.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="16248.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16248.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_12 -->
<g id="node167" class="node">
<title>layer_1_expert_agg_12</title>
<polygon fill="#fff0e6" stroke="black" points="16745.56,-6579.17 15996.51,-6579.17 15803.81,-6443.17 16552.87,-6443.17 16745.56,-6579.17"/>
<text text-anchor="middle" x="16274.69" y="-6529.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16274.69" y="-6514.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="16274.69" y="-6499.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16274.69" y="-6484.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_8_gpu_12&#45;&gt;layer_1_expert_agg_12 -->
<g id="edge313" class="edge">
<title>layer_1_expert_8_gpu_12&#45;&gt;layer_1_expert_agg_12</title>
<path fill="none" stroke="black" d="M16248.69,-6686.96C16248.69,-6686.96 16248.69,-6589.33 16248.69,-6589.33"/>
<polygon fill="black" stroke="black" points="16252.19,-6589.33 16248.69,-6579.33 16245.19,-6589.33 16252.19,-6589.33"/>
</g>
<!-- layer_1_expert_9_gpu_12 -->
<g id="node148" class="node">
<title>layer_1_expert_9_gpu_12</title>
<polygon fill="#ffe6e6" stroke="black" points="16947.69,-6755.17 16493.69,-6755.17 16493.69,-6687.17 16947.69,-6687.17 16947.69,-6755.17"/>
<text text-anchor="middle" x="16720.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="16720.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="16720.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16720.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_9_gpu_12&#45;&gt;layer_1_expert_agg_12 -->
<g id="edge314" class="edge">
<title>layer_1_expert_9_gpu_12&#45;&gt;layer_1_expert_agg_12</title>
<path fill="none" stroke="black" d="M16619.53,-6686.96C16619.53,-6686.96 16619.53,-6589.33 16619.53,-6589.33"/>
<polygon fill="black" stroke="black" points="16623.03,-6589.33 16619.53,-6579.33 16616.03,-6589.33 16623.03,-6589.33"/>
</g>
<!-- layer_1_expert_10_gpu_13 -->
<g id="node149" class="node">
<title>layer_1_expert_10_gpu_13</title>
<polygon fill="#ffe6e6" stroke="black" points="17439.69,-6755.17 16985.69,-6755.17 16985.69,-6687.17 17439.69,-6687.17 17439.69,-6755.17"/>
<text text-anchor="middle" x="17212.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="17212.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="17212.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17212.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_13 -->
<g id="node168" class="node">
<title>layer_1_expert_agg_13</title>
<polygon fill="#fff0e6" stroke="black" points="17704.56,-6579.17 16955.51,-6579.17 16762.81,-6443.17 17511.87,-6443.17 17704.56,-6579.17"/>
<text text-anchor="middle" x="17233.69" y="-6529.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="17233.69" y="-6514.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="17233.69" y="-6499.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17233.69" y="-6484.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_10_gpu_13&#45;&gt;layer_1_expert_agg_13 -->
<g id="edge315" class="edge">
<title>layer_1_expert_10_gpu_13&#45;&gt;layer_1_expert_agg_13</title>
<path fill="none" stroke="black" d="M17212.69,-6686.96C17212.69,-6686.96 17212.69,-6589.33 17212.69,-6589.33"/>
<polygon fill="black" stroke="black" points="17216.19,-6589.33 17212.69,-6579.33 17209.19,-6589.33 17216.19,-6589.33"/>
</g>
<!-- layer_1_expert_11_gpu_13 -->
<g id="node150" class="node">
<title>layer_1_expert_11_gpu_13</title>
<polygon fill="#ffe6e6" stroke="black" points="17911.69,-6755.17 17457.69,-6755.17 17457.69,-6687.17 17911.69,-6687.17 17911.69,-6755.17"/>
<text text-anchor="middle" x="17684.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="17684.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="17684.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17684.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_11_gpu_13&#45;&gt;layer_1_expert_agg_13 -->
<g id="edge316" class="edge">
<title>layer_1_expert_11_gpu_13&#45;&gt;layer_1_expert_agg_13</title>
<path fill="none" stroke="black" d="M17581.03,-6686.96C17581.03,-6686.96 17581.03,-6589.33 17581.03,-6589.33"/>
<polygon fill="black" stroke="black" points="17584.53,-6589.33 17581.03,-6579.33 17577.53,-6589.33 17584.53,-6589.33"/>
</g>
<!-- layer_1_expert_12_gpu_14 -->
<g id="node151" class="node">
<title>layer_1_expert_12_gpu_14</title>
<polygon fill="#ffe6e6" stroke="black" points="18401.69,-6755.17 17947.69,-6755.17 17947.69,-6687.17 18401.69,-6687.17 18401.69,-6755.17"/>
<text text-anchor="middle" x="18174.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="18174.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="18174.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18174.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_14 -->
<g id="node169" class="node">
<title>layer_1_expert_agg_14</title>
<polygon fill="#fff0e6" stroke="black" points="18663.56,-6579.17 17914.51,-6579.17 17721.81,-6443.17 18470.87,-6443.17 18663.56,-6579.17"/>
<text text-anchor="middle" x="18192.69" y="-6529.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="18192.69" y="-6514.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="18192.69" y="-6499.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18192.69" y="-6484.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_12_gpu_14&#45;&gt;layer_1_expert_agg_14 -->
<g id="edge317" class="edge">
<title>layer_1_expert_12_gpu_14&#45;&gt;layer_1_expert_agg_14</title>
<path fill="none" stroke="black" d="M18174.69,-6686.96C18174.69,-6686.96 18174.69,-6589.33 18174.69,-6589.33"/>
<polygon fill="black" stroke="black" points="18178.19,-6589.33 18174.69,-6579.33 18171.19,-6589.33 18178.19,-6589.33"/>
</g>
<!-- layer_1_expert_13_gpu_14 -->
<g id="node152" class="node">
<title>layer_1_expert_13_gpu_14</title>
<polygon fill="#ffe6e6" stroke="black" points="18873.69,-6755.17 18419.69,-6755.17 18419.69,-6687.17 18873.69,-6687.17 18873.69,-6755.17"/>
<text text-anchor="middle" x="18646.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="18646.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="18646.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18646.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_13_gpu_14&#45;&gt;layer_1_expert_agg_14 -->
<g id="edge318" class="edge">
<title>layer_1_expert_13_gpu_14&#45;&gt;layer_1_expert_agg_14</title>
<path fill="none" stroke="black" d="M18541.53,-6686.96C18541.53,-6686.96 18541.53,-6589.33 18541.53,-6589.33"/>
<polygon fill="black" stroke="black" points="18545.03,-6589.33 18541.53,-6579.33 18538.03,-6589.33 18545.03,-6589.33"/>
</g>
<!-- layer_1_expert_14_gpu_15 -->
<g id="node153" class="node">
<title>layer_1_expert_14_gpu_15</title>
<polygon fill="#ffe6e6" stroke="black" points="19361.69,-6755.17 18907.69,-6755.17 18907.69,-6687.17 19361.69,-6687.17 19361.69,-6755.17"/>
<text text-anchor="middle" x="19134.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="19134.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="19134.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19134.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_15 -->
<g id="node170" class="node">
<title>layer_1_expert_agg_15</title>
<polygon fill="#fff0e6" stroke="black" points="19622.56,-6579.17 18873.51,-6579.17 18680.81,-6443.17 19429.87,-6443.17 19622.56,-6579.17"/>
<text text-anchor="middle" x="19151.69" y="-6529.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="19151.69" y="-6514.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="19151.69" y="-6499.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19151.69" y="-6484.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_14_gpu_15&#45;&gt;layer_1_expert_agg_15 -->
<g id="edge319" class="edge">
<title>layer_1_expert_14_gpu_15&#45;&gt;layer_1_expert_agg_15</title>
<path fill="none" stroke="black" d="M19134.69,-6686.96C19134.69,-6686.96 19134.69,-6589.33 19134.69,-6589.33"/>
<polygon fill="black" stroke="black" points="19138.19,-6589.33 19134.69,-6579.33 19131.19,-6589.33 19138.19,-6589.33"/>
</g>
<!-- layer_1_expert_15_gpu_15 -->
<g id="node154" class="node">
<title>layer_1_expert_15_gpu_15</title>
<polygon fill="#ffe6e6" stroke="black" points="19833.69,-6755.17 19379.69,-6755.17 19379.69,-6687.17 19833.69,-6687.17 19833.69,-6755.17"/>
<text text-anchor="middle" x="19606.69" y="-6739.97" font-family="monospace" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="19606.69" y="-6724.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="19606.69" y="-6709.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19606.69" y="-6694.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_15_gpu_15&#45;&gt;layer_1_expert_agg_15 -->
<g id="edge320" class="edge">
<title>layer_1_expert_15_gpu_15&#45;&gt;layer_1_expert_agg_15</title>
<path fill="none" stroke="black" d="M19501.03,-6686.96C19501.03,-6686.96 19501.03,-6589.33 19501.03,-6589.33"/>
<polygon fill="black" stroke="black" points="19504.53,-6589.33 19501.03,-6579.33 19497.53,-6589.33 19504.53,-6589.33"/>
</g>
<!-- layer_1_expert_select_8&#45;&gt;layer_1_expert_0_gpu_8 -->
<g id="edge289" class="edge">
<title>layer_1_expert_select_8&#45;&gt;layer_1_expert_0_gpu_8</title>
<path fill="none" stroke="black" d="M12255.69,-6862.99C12255.69,-6862.99 12255.69,-6765.2 12255.69,-6765.2"/>
<polygon fill="black" stroke="black" points="12259.19,-6765.2 12255.69,-6755.2 12252.19,-6765.2 12259.19,-6765.2"/>
</g>
<!-- layer_1_expert_select_8&#45;&gt;layer_1_expert_1_gpu_8 -->
<g id="edge290" class="edge">
<title>layer_1_expert_select_8&#45;&gt;layer_1_expert_1_gpu_8</title>
<path fill="none" stroke="black" d="M12705.03,-6862.99C12705.03,-6862.99 12705.03,-6765.2 12705.03,-6765.2"/>
<polygon fill="black" stroke="black" points="12708.53,-6765.2 12705.03,-6755.2 12701.53,-6765.2 12708.53,-6765.2"/>
</g>
<!-- layer_1_expert_select_9&#45;&gt;layer_1_expert_2_gpu_9 -->
<g id="edge291" class="edge">
<title>layer_1_expert_select_9&#45;&gt;layer_1_expert_2_gpu_9</title>
<path fill="none" stroke="black" d="M13298.69,-6862.99C13298.69,-6862.99 13298.69,-6765.2 13298.69,-6765.2"/>
<polygon fill="black" stroke="black" points="13302.19,-6765.2 13298.69,-6755.2 13295.19,-6765.2 13302.19,-6765.2"/>
</g>
<!-- layer_1_expert_select_9&#45;&gt;layer_1_expert_3_gpu_9 -->
<g id="edge292" class="edge">
<title>layer_1_expert_select_9&#45;&gt;layer_1_expert_3_gpu_9</title>
<path fill="none" stroke="black" d="M13706.03,-6884.3C13706.03,-6884.3 13706.03,-6765.48 13706.03,-6765.48"/>
<polygon fill="black" stroke="black" points="13709.53,-6765.48 13706.03,-6755.48 13702.53,-6765.48 13709.53,-6765.48"/>
</g>
<!-- layer_1_expert_select_10&#45;&gt;layer_1_expert_4_gpu_10 -->
<g id="edge293" class="edge">
<title>layer_1_expert_select_10&#45;&gt;layer_1_expert_4_gpu_10</title>
<path fill="none" stroke="black" d="M14299.69,-6862.99C14299.69,-6862.99 14299.69,-6765.2 14299.69,-6765.2"/>
<polygon fill="black" stroke="black" points="14303.19,-6765.2 14299.69,-6755.2 14296.19,-6765.2 14303.19,-6765.2"/>
</g>
<!-- layer_1_expert_select_10&#45;&gt;layer_1_expert_5_gpu_10 -->
<g id="edge294" class="edge">
<title>layer_1_expert_select_10&#45;&gt;layer_1_expert_5_gpu_10</title>
<path fill="none" stroke="black" d="M14686.03,-6899.27C14686.03,-6899.27 14686.03,-6765.46 14686.03,-6765.46"/>
<polygon fill="black" stroke="black" points="14689.53,-6765.46 14686.03,-6755.46 14682.53,-6765.46 14689.53,-6765.46"/>
</g>
<!-- layer_1_expert_select_11&#45;&gt;layer_1_expert_6_gpu_11 -->
<g id="edge295" class="edge">
<title>layer_1_expert_select_11&#45;&gt;layer_1_expert_6_gpu_11</title>
<path fill="none" stroke="black" d="M15279.69,-6862.99C15279.69,-6862.99 15279.69,-6765.2 15279.69,-6765.2"/>
<polygon fill="black" stroke="black" points="15283.19,-6765.2 15279.69,-6755.2 15276.19,-6765.2 15283.19,-6765.2"/>
</g>
<!-- layer_1_expert_select_11&#45;&gt;layer_1_expert_7_gpu_11 -->
<g id="edge296" class="edge">
<title>layer_1_expert_select_11&#45;&gt;layer_1_expert_7_gpu_11</title>
<path fill="none" stroke="black" d="M15655.53,-6906.67C15655.53,-6906.67 15655.53,-6765.21 15655.53,-6765.21"/>
<polygon fill="black" stroke="black" points="15659.03,-6765.21 15655.53,-6755.21 15652.03,-6765.21 15659.03,-6765.21"/>
</g>
<!-- layer_1_expert_select_12&#45;&gt;layer_1_expert_8_gpu_12 -->
<g id="edge297" class="edge">
<title>layer_1_expert_select_12&#45;&gt;layer_1_expert_8_gpu_12</title>
<path fill="none" stroke="black" d="M16248.69,-6862.99C16248.69,-6862.99 16248.69,-6765.2 16248.69,-6765.2"/>
<polygon fill="black" stroke="black" points="16252.19,-6765.2 16248.69,-6755.2 16245.19,-6765.2 16252.19,-6765.2"/>
</g>
<!-- layer_1_expert_select_12&#45;&gt;layer_1_expert_9_gpu_12 -->
<g id="edge298" class="edge">
<title>layer_1_expert_select_12&#45;&gt;layer_1_expert_9_gpu_12</title>
<path fill="none" stroke="black" d="M16619.53,-6909.87C16619.53,-6909.87 16619.53,-6765.3 16619.53,-6765.3"/>
<polygon fill="black" stroke="black" points="16623.03,-6765.3 16619.53,-6755.3 16616.03,-6765.3 16623.03,-6765.3"/>
</g>
<!-- layer_1_expert_select_13&#45;&gt;layer_1_expert_10_gpu_13 -->
<g id="edge299" class="edge">
<title>layer_1_expert_select_13&#45;&gt;layer_1_expert_10_gpu_13</title>
<path fill="none" stroke="black" d="M17212.69,-6862.99C17212.69,-6862.99 17212.69,-6765.2 17212.69,-6765.2"/>
<polygon fill="black" stroke="black" points="17216.19,-6765.2 17212.69,-6755.2 17209.19,-6765.2 17216.19,-6765.2"/>
</g>
<!-- layer_1_expert_select_13&#45;&gt;layer_1_expert_11_gpu_13 -->
<g id="edge300" class="edge">
<title>layer_1_expert_select_13&#45;&gt;layer_1_expert_11_gpu_13</title>
<path fill="none" stroke="black" d="M17581.03,-6911.79C17581.03,-6911.79 17581.03,-6765.29 17581.03,-6765.29"/>
<polygon fill="black" stroke="black" points="17584.53,-6765.29 17581.03,-6755.29 17577.53,-6765.29 17584.53,-6765.29"/>
</g>
<!-- layer_1_expert_select_14&#45;&gt;layer_1_expert_12_gpu_14 -->
<g id="edge301" class="edge">
<title>layer_1_expert_select_14&#45;&gt;layer_1_expert_12_gpu_14</title>
<path fill="none" stroke="black" d="M18174.69,-6862.99C18174.69,-6862.99 18174.69,-6765.2 18174.69,-6765.2"/>
<polygon fill="black" stroke="black" points="18178.19,-6765.2 18174.69,-6755.2 18171.19,-6765.2 18178.19,-6765.2"/>
</g>
<!-- layer_1_expert_select_14&#45;&gt;layer_1_expert_13_gpu_14 -->
<g id="edge302" class="edge">
<title>layer_1_expert_select_14&#45;&gt;layer_1_expert_13_gpu_14</title>
<path fill="none" stroke="black" d="M18541.53,-6912.9C18541.53,-6912.9 18541.53,-6765.34 18541.53,-6765.34"/>
<polygon fill="black" stroke="black" points="18545.03,-6765.34 18541.53,-6755.34 18538.03,-6765.34 18545.03,-6765.34"/>
</g>
<!-- layer_1_expert_select_15&#45;&gt;layer_1_expert_14_gpu_15 -->
<g id="edge303" class="edge">
<title>layer_1_expert_select_15&#45;&gt;layer_1_expert_14_gpu_15</title>
<path fill="none" stroke="black" d="M19134.69,-6862.99C19134.69,-6862.99 19134.69,-6765.2 19134.69,-6765.2"/>
<polygon fill="black" stroke="black" points="19138.19,-6765.2 19134.69,-6755.2 19131.19,-6765.2 19138.19,-6765.2"/>
</g>
<!-- layer_1_expert_select_15&#45;&gt;layer_1_expert_15_gpu_15 -->
<g id="edge304" class="edge">
<title>layer_1_expert_select_15&#45;&gt;layer_1_expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M19501.03,-6913.26C19501.03,-6913.26 19501.03,-6765.49 19501.03,-6765.49"/>
<polygon fill="black" stroke="black" points="19504.53,-6765.49 19501.03,-6755.49 19497.53,-6765.49 19504.53,-6765.49"/>
</g>
<!-- layer_1_expert_broadcast_8 -->
<g id="node179" class="node">
<title>layer_1_expert_broadcast_8</title>
<polygon fill="#e6ffe6" stroke="black" points="12909.56,-6335.17 12160.51,-6335.17 11967.81,-6199.17 12716.87,-6199.17 12909.56,-6335.17"/>
<text text-anchor="middle" x="12438.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="12438.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="12438.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12438.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_8&#45;&gt;layer_1_expert_broadcast_8 -->
<g id="edge321" class="edge">
<title>layer_1_expert_agg_8&#45;&gt;layer_1_expert_broadcast_8</title>
<path fill="none" stroke="black" d="M12438.69,-6442.87C12438.69,-6442.87 12438.69,-6345.44 12438.69,-6345.44"/>
<polygon fill="black" stroke="black" points="12442.19,-6345.44 12438.69,-6335.44 12435.19,-6345.44 12442.19,-6345.44"/>
</g>
<!-- layer_1_expert_broadcast_9 -->
<g id="node180" class="node">
<title>layer_1_expert_broadcast_9</title>
<polygon fill="#e6ffe6" stroke="black" points="13868.56,-6335.17 13119.51,-6335.17 12926.81,-6199.17 13675.87,-6199.17 13868.56,-6335.17"/>
<text text-anchor="middle" x="13397.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="13397.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="13397.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13397.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_9&#45;&gt;layer_1_expert_broadcast_9 -->
<g id="edge322" class="edge">
<title>layer_1_expert_agg_9&#45;&gt;layer_1_expert_broadcast_9</title>
<path fill="none" stroke="black" d="M13397.69,-6442.87C13397.69,-6442.87 13397.69,-6345.44 13397.69,-6345.44"/>
<polygon fill="black" stroke="black" points="13401.19,-6345.44 13397.69,-6335.44 13394.19,-6345.44 13401.19,-6345.44"/>
</g>
<!-- layer_1_expert_broadcast_10 -->
<g id="node181" class="node">
<title>layer_1_expert_broadcast_10</title>
<polygon fill="#e6ffe6" stroke="black" points="14827.56,-6335.17 14078.51,-6335.17 13885.81,-6199.17 14634.87,-6199.17 14827.56,-6335.17"/>
<text text-anchor="middle" x="14356.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="14356.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="14356.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14356.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_10&#45;&gt;layer_1_expert_broadcast_10 -->
<g id="edge323" class="edge">
<title>layer_1_expert_agg_10&#45;&gt;layer_1_expert_broadcast_10</title>
<path fill="none" stroke="black" d="M14356.69,-6442.87C14356.69,-6442.87 14356.69,-6345.44 14356.69,-6345.44"/>
<polygon fill="black" stroke="black" points="14360.19,-6345.44 14356.69,-6335.44 14353.19,-6345.44 14360.19,-6345.44"/>
</g>
<!-- layer_1_expert_broadcast_11 -->
<g id="node182" class="node">
<title>layer_1_expert_broadcast_11</title>
<polygon fill="#e6ffe6" stroke="black" points="15786.56,-6335.17 15037.51,-6335.17 14844.81,-6199.17 15593.87,-6199.17 15786.56,-6335.17"/>
<text text-anchor="middle" x="15315.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="15315.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="15315.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15315.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_11&#45;&gt;layer_1_expert_broadcast_11 -->
<g id="edge324" class="edge">
<title>layer_1_expert_agg_11&#45;&gt;layer_1_expert_broadcast_11</title>
<path fill="none" stroke="black" d="M15315.69,-6442.87C15315.69,-6442.87 15315.69,-6345.44 15315.69,-6345.44"/>
<polygon fill="black" stroke="black" points="15319.19,-6345.44 15315.69,-6335.44 15312.19,-6345.44 15319.19,-6345.44"/>
</g>
<!-- layer_1_expert_broadcast_12 -->
<g id="node183" class="node">
<title>layer_1_expert_broadcast_12</title>
<polygon fill="#e6ffe6" stroke="black" points="16745.56,-6335.17 15996.51,-6335.17 15803.81,-6199.17 16552.87,-6199.17 16745.56,-6335.17"/>
<text text-anchor="middle" x="16274.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="16274.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="16274.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16274.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_12&#45;&gt;layer_1_expert_broadcast_12 -->
<g id="edge325" class="edge">
<title>layer_1_expert_agg_12&#45;&gt;layer_1_expert_broadcast_12</title>
<path fill="none" stroke="black" d="M16274.69,-6442.87C16274.69,-6442.87 16274.69,-6345.44 16274.69,-6345.44"/>
<polygon fill="black" stroke="black" points="16278.19,-6345.44 16274.69,-6335.44 16271.19,-6345.44 16278.19,-6345.44"/>
</g>
<!-- layer_1_expert_broadcast_13 -->
<g id="node184" class="node">
<title>layer_1_expert_broadcast_13</title>
<polygon fill="#e6ffe6" stroke="black" points="17704.56,-6335.17 16955.51,-6335.17 16762.81,-6199.17 17511.87,-6199.17 17704.56,-6335.17"/>
<text text-anchor="middle" x="17233.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="17233.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="17233.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17233.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_13&#45;&gt;layer_1_expert_broadcast_13 -->
<g id="edge326" class="edge">
<title>layer_1_expert_agg_13&#45;&gt;layer_1_expert_broadcast_13</title>
<path fill="none" stroke="black" d="M17233.69,-6442.87C17233.69,-6442.87 17233.69,-6345.44 17233.69,-6345.44"/>
<polygon fill="black" stroke="black" points="17237.19,-6345.44 17233.69,-6335.44 17230.19,-6345.44 17237.19,-6345.44"/>
</g>
<!-- layer_1_expert_broadcast_14 -->
<g id="node185" class="node">
<title>layer_1_expert_broadcast_14</title>
<polygon fill="#e6ffe6" stroke="black" points="18663.56,-6335.17 17914.51,-6335.17 17721.81,-6199.17 18470.87,-6199.17 18663.56,-6335.17"/>
<text text-anchor="middle" x="18192.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="18192.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="18192.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="18192.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_14&#45;&gt;layer_1_expert_broadcast_14 -->
<g id="edge327" class="edge">
<title>layer_1_expert_agg_14&#45;&gt;layer_1_expert_broadcast_14</title>
<path fill="none" stroke="black" d="M18192.69,-6442.87C18192.69,-6442.87 18192.69,-6345.44 18192.69,-6345.44"/>
<polygon fill="black" stroke="black" points="18196.19,-6345.44 18192.69,-6335.44 18189.19,-6345.44 18196.19,-6345.44"/>
</g>
<!-- layer_1_expert_broadcast_15 -->
<g id="node186" class="node">
<title>layer_1_expert_broadcast_15</title>
<polygon fill="#e6ffe6" stroke="black" points="19622.56,-6335.17 18873.51,-6335.17 18680.81,-6199.17 19429.87,-6199.17 19622.56,-6335.17"/>
<text text-anchor="middle" x="19151.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="19151.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="19151.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="19151.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_agg_15&#45;&gt;layer_1_expert_broadcast_15 -->
<g id="edge328" class="edge">
<title>layer_1_expert_agg_15&#45;&gt;layer_1_expert_broadcast_15</title>
<path fill="none" stroke="black" d="M19151.69,-6442.87C19151.69,-6442.87 19151.69,-6345.44 19151.69,-6345.44"/>
<polygon fill="black" stroke="black" points="19155.19,-6345.44 19151.69,-6335.44 19148.19,-6345.44 19155.19,-6345.44"/>
</g>
<!-- layer_1_expert_broadcast_0 -->
<g id="node171" class="node">
<title>layer_1_expert_broadcast_0</title>
<polygon fill="#e6ffe6" stroke="black" points="5237.56,-6335.17 4488.51,-6335.17 4295.81,-6199.17 5044.87,-6199.17 5237.56,-6335.17"/>
<text text-anchor="middle" x="4766.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="4766.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="4766.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4766.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_residual2 -->
<g id="node187" class="node">
<title>layer_1_residual2</title>
<polygon fill="#fff0e6" stroke="black" points="12185.69,-6091.17 11731.69,-6091.17 11731.69,-6008.17 12185.69,-6008.17 12185.69,-6091.17"/>
<text text-anchor="middle" x="11958.69" y="-6075.97" font-family="monospace" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="11958.69" y="-6060.97" font-family="monospace" font-size="14.00">Input1: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11958.69" y="-6045.97" font-family="monospace" font-size="14.00">Input2: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11958.69" y="-6030.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11958.69" y="-6015.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_expert_broadcast_0&#45;&gt;layer_1_residual2 -->
<g id="edge329" class="edge">
<title>layer_1_expert_broadcast_0&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M5131.19,-6259.98C5131.19,-6219.12 5131.19,-6018 5131.19,-6018 5131.19,-6018 11721.52,-6018 11721.52,-6018"/>
<polygon fill="black" stroke="black" points="11721.52,-6021.5 11731.52,-6018 11721.52,-6014.5 11721.52,-6021.5"/>
</g>
<!-- layer_1_expert_broadcast_1 -->
<g id="node172" class="node">
<title>layer_1_expert_broadcast_1</title>
<polygon fill="#e6ffe6" stroke="black" points="6196.56,-6335.17 5447.51,-6335.17 5254.81,-6199.17 6003.87,-6199.17 6196.56,-6335.17"/>
<text text-anchor="middle" x="5725.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="5725.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="5725.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5725.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_broadcast_1&#45;&gt;layer_1_residual2 -->
<g id="edge330" class="edge">
<title>layer_1_expert_broadcast_1&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M6090.19,-6260.01C6090.19,-6220.21 6090.19,-6028 6090.19,-6028 6090.19,-6028 11721.33,-6028 11721.33,-6028"/>
<polygon fill="black" stroke="black" points="11721.33,-6031.5 11731.33,-6028 11721.33,-6024.5 11721.33,-6031.5"/>
</g>
<!-- layer_1_expert_broadcast_2 -->
<g id="node173" class="node">
<title>layer_1_expert_broadcast_2</title>
<polygon fill="#e6ffe6" stroke="black" points="7155.56,-6335.17 6406.51,-6335.17 6213.81,-6199.17 6962.87,-6199.17 7155.56,-6335.17"/>
<text text-anchor="middle" x="6684.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="6684.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="6684.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6684.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_broadcast_2&#45;&gt;layer_1_residual2 -->
<g id="edge331" class="edge">
<title>layer_1_expert_broadcast_2&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M7049.19,-6260.09C7049.19,-6221.58 7049.19,-6039 7049.19,-6039 7049.19,-6039 11721.33,-6039 11721.33,-6039"/>
<polygon fill="black" stroke="black" points="11721.33,-6042.5 11731.33,-6039 11721.33,-6035.5 11721.33,-6042.5"/>
</g>
<!-- layer_1_expert_broadcast_3 -->
<g id="node174" class="node">
<title>layer_1_expert_broadcast_3</title>
<polygon fill="#e6ffe6" stroke="black" points="8114.56,-6335.17 7365.51,-6335.17 7172.81,-6199.17 7921.87,-6199.17 8114.56,-6335.17"/>
<text text-anchor="middle" x="7643.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="7643.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="7643.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7643.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_broadcast_3&#45;&gt;layer_1_residual2 -->
<g id="edge332" class="edge">
<title>layer_1_expert_broadcast_3&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M8008.19,-6259.91C8008.19,-6222.05 8008.19,-6049 8008.19,-6049 8008.19,-6049 11721.38,-6049 11721.38,-6049"/>
<polygon fill="black" stroke="black" points="11721.38,-6052.5 11731.38,-6049 11721.38,-6045.5 11721.38,-6052.5"/>
</g>
<!-- layer_1_expert_broadcast_4 -->
<g id="node175" class="node">
<title>layer_1_expert_broadcast_4</title>
<polygon fill="#e6ffe6" stroke="black" points="9073.56,-6335.17 8324.51,-6335.17 8131.81,-6199.17 8880.87,-6199.17 9073.56,-6335.17"/>
<text text-anchor="middle" x="8602.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="8602.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="8602.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8602.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_broadcast_4&#45;&gt;layer_1_residual2 -->
<g id="edge333" class="edge">
<title>layer_1_expert_broadcast_4&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M8967.19,-6259.79C8967.19,-6222.89 8967.19,-6060 8967.19,-6060 8967.19,-6060 11721.38,-6060 11721.38,-6060"/>
<polygon fill="black" stroke="black" points="11721.38,-6063.5 11731.38,-6060 11721.38,-6056.5 11721.38,-6063.5"/>
</g>
<!-- layer_1_expert_broadcast_5 -->
<g id="node176" class="node">
<title>layer_1_expert_broadcast_5</title>
<polygon fill="#e6ffe6" stroke="black" points="10032.56,-6335.17 9283.51,-6335.17 9090.81,-6199.17 9839.87,-6199.17 10032.56,-6335.17"/>
<text text-anchor="middle" x="9561.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="9561.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="9561.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9561.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_broadcast_5&#45;&gt;layer_1_residual2 -->
<g id="edge334" class="edge">
<title>layer_1_expert_broadcast_5&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M9926.19,-6259.68C9926.19,-6223.66 9926.19,-6070 9926.19,-6070 9926.19,-6070 11721.45,-6070 11721.45,-6070"/>
<polygon fill="black" stroke="black" points="11721.45,-6073.5 11731.45,-6070 11721.45,-6066.5 11721.45,-6073.5"/>
</g>
<!-- layer_1_expert_broadcast_6 -->
<g id="node177" class="node">
<title>layer_1_expert_broadcast_6</title>
<polygon fill="#e6ffe6" stroke="black" points="10991.56,-6335.17 10242.51,-6335.17 10049.81,-6199.17 10798.87,-6199.17 10991.56,-6335.17"/>
<text text-anchor="middle" x="10520.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="10520.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="10520.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10520.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_broadcast_6&#45;&gt;layer_1_residual2 -->
<g id="edge335" class="edge">
<title>layer_1_expert_broadcast_6&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M10929.53,-6267.03C10929.53,-6261.36 10929.53,-6080 10929.53,-6080 10929.53,-6080 11721.56,-6080 11721.56,-6080"/>
<polygon fill="black" stroke="black" points="11721.56,-6083.5 11731.56,-6080 11721.56,-6076.5 11721.56,-6083.5"/>
</g>
<!-- layer_1_expert_broadcast_7 -->
<g id="node178" class="node">
<title>layer_1_expert_broadcast_7</title>
<polygon fill="#e6ffe6" stroke="black" points="11950.56,-6335.17 11201.51,-6335.17 11008.81,-6199.17 11757.87,-6199.17 11950.56,-6335.17"/>
<text text-anchor="middle" x="11479.69" y="-6285.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="11479.69" y="-6270.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="11479.69" y="-6255.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11479.69" y="-6240.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_1_expert_broadcast_7&#45;&gt;layer_1_residual2 -->
<g id="edge336" class="edge">
<title>layer_1_expert_broadcast_7&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M11841.03,-6257.82C11841.03,-6257.82 11841.03,-6101.35 11841.03,-6101.35"/>
<polygon fill="black" stroke="black" points="11844.53,-6101.35 11841.03,-6091.35 11837.53,-6101.35 11844.53,-6101.35"/>
</g>
<!-- layer_1_expert_broadcast_8&#45;&gt;layer_1_residual2 -->
<g id="edge337" class="edge">
<title>layer_1_expert_broadcast_8&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M12076.84,-6198.94C12076.84,-6198.94 12076.84,-6101.38 12076.84,-6101.38"/>
<polygon fill="black" stroke="black" points="12080.34,-6101.38 12076.84,-6091.38 12073.34,-6101.38 12080.34,-6101.38"/>
</g>
<!-- layer_1_expert_broadcast_9&#45;&gt;layer_1_residual2 -->
<g id="edge338" class="edge">
<title>layer_1_expert_broadcast_9&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M13004.23,-6199.07C13004.23,-6145.55 13004.23,-6080 13004.23,-6080 13004.23,-6080 12195.88,-6080 12195.88,-6080"/>
<polygon fill="black" stroke="black" points="12195.88,-6076.5 12185.88,-6080 12195.88,-6083.5 12195.88,-6076.5"/>
</g>
<!-- layer_1_expert_broadcast_10&#45;&gt;layer_1_residual2 -->
<g id="edge339" class="edge">
<title>layer_1_expert_broadcast_10&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M14001.69,-6199.04C14001.69,-6142.05 14001.69,-6070 14001.69,-6070 14001.69,-6070 12196.11,-6070 12196.11,-6070"/>
<polygon fill="black" stroke="black" points="12196.11,-6066.5 12186.11,-6070 12196.11,-6073.5 12196.11,-6066.5"/>
</g>
<!-- layer_1_expert_broadcast_11&#45;&gt;layer_1_residual2 -->
<g id="edge340" class="edge">
<title>layer_1_expert_broadcast_11&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M14909.34,-6199.05C14909.34,-6138.66 14909.34,-6060 14909.34,-6060 14909.34,-6060 12195.93,-6060 12195.93,-6060"/>
<polygon fill="black" stroke="black" points="12195.93,-6056.5 12185.93,-6060 12195.93,-6063.5 12195.93,-6056.5"/>
</g>
<!-- layer_1_expert_broadcast_12&#45;&gt;layer_1_residual2 -->
<g id="edge341" class="edge">
<title>layer_1_expert_broadcast_12&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M15949.84,-6199.03C15949.84,-6135.02 15949.84,-6049 15949.84,-6049 15949.84,-6049 12195.79,-6049 12195.79,-6049"/>
<polygon fill="black" stroke="black" points="12195.79,-6045.5 12185.79,-6049 12195.79,-6052.5 12195.79,-6045.5"/>
</g>
<!-- layer_1_expert_broadcast_13&#45;&gt;layer_1_residual2 -->
<g id="edge342" class="edge">
<title>layer_1_expert_broadcast_13&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M16878.69,-6199.02C16878.69,-6131.79 16878.69,-6039 16878.69,-6039 16878.69,-6039 12195.71,-6039 12195.71,-6039"/>
<polygon fill="black" stroke="black" points="12195.71,-6035.5 12185.71,-6039 12195.71,-6042.5 12195.71,-6035.5"/>
</g>
<!-- layer_1_expert_broadcast_14&#45;&gt;layer_1_residual2 -->
<g id="edge343" class="edge">
<title>layer_1_expert_broadcast_14&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M17837.69,-6198.95C17837.69,-6128.26 17837.69,-6028 17837.69,-6028 17837.69,-6028 12196,-6028 12196,-6028"/>
<polygon fill="black" stroke="black" points="12196,-6024.5 12186,-6028 12196,-6031.5 12196,-6024.5"/>
</g>
<!-- layer_1_expert_broadcast_15&#45;&gt;layer_1_residual2 -->
<g id="edge344" class="edge">
<title>layer_1_expert_broadcast_15&#45;&gt;layer_1_residual2</title>
<path fill="none" stroke="black" d="M19151.69,-6199.08C19151.69,-6125.31 19151.69,-6018 19151.69,-6018 19151.69,-6018 12195.84,-6018 12195.84,-6018"/>
<polygon fill="black" stroke="black" points="12195.84,-6014.5 12185.84,-6018 12195.84,-6021.5 12195.84,-6014.5"/>
</g>
<!-- layer_2_ln1 -->
<g id="node188" class="node">
<title>layer_2_ln1</title>
<polygon fill="#e6f3ff" stroke="black" points="13873.69,-5900.17 13419.69,-5900.17 13419.69,-5832.17 13873.69,-5832.17 13873.69,-5900.17"/>
<text text-anchor="middle" x="13646.69" y="-5884.97" font-family="monospace" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="13646.69" y="-5869.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13646.69" y="-5854.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13646.69" y="-5839.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_residual2&#45;&gt;layer_2_ln1 -->
<g id="edge345" class="edge">
<title>layer_1_residual2&#45;&gt;layer_2_ln1</title>
<path fill="none" stroke="black" d="M12111.19,-6007.94C12111.19,-5959.45 12111.19,-5886 12111.19,-5886 12111.19,-5886 13409.29,-5886 13409.29,-5886"/>
<polygon fill="black" stroke="black" points="13409.29,-5889.5 13419.29,-5886 13409.29,-5882.5 13409.29,-5889.5"/>
</g>
<!-- layer_2_residual1 -->
<g id="node229" class="node">
<title>layer_2_residual1</title>
<polygon fill="#fff0e6" stroke="black" points="13873.69,-4708.17 13419.69,-4708.17 13419.69,-4625.17 13873.69,-4625.17 13873.69,-4708.17"/>
<text text-anchor="middle" x="13646.69" y="-4692.97" font-family="monospace" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="13646.69" y="-4677.97" font-family="monospace" font-size="14.00">Input1: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13646.69" y="-4662.97" font-family="monospace" font-size="14.00">Input2: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13646.69" y="-4647.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13646.69" y="-4632.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_1_residual2&#45;&gt;layer_2_residual1 -->
<g id="edge450" class="edge">
<title>layer_1_residual2&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M11794.69,-6007.78C11794.69,-5867.94 11794.69,-5426 11794.69,-5426 11794.69,-5426 12208.19,-5426 12208.19,-5426 12208.19,-5426 12208.19,-4674 12208.19,-4674 12208.19,-4674 13409.55,-4674 13409.55,-4674"/>
<polygon fill="black" stroke="black" points="13409.55,-4677.5 13419.55,-4674 13409.55,-4670.5 13409.55,-4677.5"/>
</g>
<!-- layer_2_qkv_gpu_0 -->
<g id="node189" class="node">
<title>layer_2_qkv_gpu_0</title>
<polygon fill="#e6f3ff" stroke="black" points="13158.69,-5724.17 12696.69,-5724.17 12696.69,-5656.17 13158.69,-5656.17 13158.69,-5724.17"/>
<text text-anchor="middle" x="12927.69" y="-5708.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12927.69" y="-5693.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="12927.69" y="-5678.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12927.69" y="-5663.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_qkv_gpu_0 -->
<g id="edge346" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_qkv_gpu_0</title>
<path fill="none" stroke="black" d="M13419.64,-5845C13262.48,-5845 13081.46,-5845 13081.46,-5845 13081.46,-5845 13081.46,-5734.53 13081.46,-5734.53"/>
<polygon fill="black" stroke="black" points="13084.96,-5734.53 13081.46,-5724.53 13077.96,-5734.53 13084.96,-5734.53"/>
</g>
<!-- layer_2_qkv_gpu_1 -->
<g id="node190" class="node">
<title>layer_2_qkv_gpu_1</title>
<polygon fill="#e6f3ff" stroke="black" points="13877.69,-5724.17 13415.69,-5724.17 13415.69,-5656.17 13877.69,-5656.17 13877.69,-5724.17"/>
<text text-anchor="middle" x="13646.69" y="-5708.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13646.69" y="-5693.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="13646.69" y="-5678.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13646.69" y="-5663.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_qkv_gpu_1 -->
<g id="edge347" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_qkv_gpu_1</title>
<path fill="none" stroke="black" d="M13646.69,-5831.81C13646.69,-5831.81 13646.69,-5734.43 13646.69,-5734.43"/>
<polygon fill="black" stroke="black" points="13650.19,-5734.43 13646.69,-5724.43 13643.19,-5734.43 13650.19,-5734.43"/>
</g>
<!-- layer_2_qkv_gpu_2 -->
<g id="node191" class="node">
<title>layer_2_qkv_gpu_2</title>
<polygon fill="#e6f3ff" stroke="black" points="14596.69,-5724.17 14134.69,-5724.17 14134.69,-5656.17 14596.69,-5656.17 14596.69,-5724.17"/>
<text text-anchor="middle" x="14365.69" y="-5708.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14365.69" y="-5693.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="14365.69" y="-5678.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14365.69" y="-5663.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_qkv_gpu_2 -->
<g id="edge348" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_qkv_gpu_2</title>
<path fill="none" stroke="black" d="M13873.69,-5845C14084.39,-5845 14365.69,-5845 14365.69,-5845 14365.69,-5845 14365.69,-5734.53 14365.69,-5734.53"/>
<polygon fill="black" stroke="black" points="14369.19,-5734.53 14365.69,-5724.53 14362.19,-5734.53 14369.19,-5734.53"/>
</g>
<!-- layer_2_qkv_gpu_3 -->
<g id="node192" class="node">
<title>layer_2_qkv_gpu_3</title>
<polygon fill="#e6f3ff" stroke="black" points="15435.69,-5724.17 14973.69,-5724.17 14973.69,-5656.17 15435.69,-5656.17 15435.69,-5724.17"/>
<text text-anchor="middle" x="15204.69" y="-5708.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15204.69" y="-5693.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="15204.69" y="-5678.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15204.69" y="-5663.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_qkv_gpu_3 -->
<g id="edge349" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_qkv_gpu_3</title>
<path fill="none" stroke="black" d="M13874.07,-5859C14306.5,-5859 15204.69,-5859 15204.69,-5859 15204.69,-5859 15204.69,-5734.33 15204.69,-5734.33"/>
<polygon fill="black" stroke="black" points="15208.19,-5734.33 15204.69,-5724.33 15201.19,-5734.33 15208.19,-5734.33"/>
</g>
<!-- layer_2_qkv_gpu_4 -->
<g id="node193" class="node">
<title>layer_2_qkv_gpu_4</title>
<polygon fill="#e6f3ff" stroke="black" points="16095.69,-5724.17 15633.69,-5724.17 15633.69,-5656.17 16095.69,-5656.17 16095.69,-5724.17"/>
<text text-anchor="middle" x="15864.69" y="-5708.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15864.69" y="-5693.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="15864.69" y="-5678.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15864.69" y="-5663.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_qkv_gpu_4 -->
<g id="edge350" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_qkv_gpu_4</title>
<path fill="none" stroke="black" d="M13873.9,-5872C14410.2,-5872 15710.03,-5872 15710.03,-5872 15710.03,-5872 15710.03,-5734.37 15710.03,-5734.37"/>
<polygon fill="black" stroke="black" points="15713.53,-5734.37 15710.03,-5724.37 15706.53,-5734.37 15713.53,-5734.37"/>
</g>
<!-- layer_2_qkv_gpu_5 -->
<g id="node194" class="node">
<title>layer_2_qkv_gpu_5</title>
<polygon fill="#e6f3ff" stroke="black" points="16665.69,-5724.17 16203.69,-5724.17 16203.69,-5656.17 16665.69,-5656.17 16665.69,-5724.17"/>
<text text-anchor="middle" x="16434.69" y="-5708.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16434.69" y="-5693.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="16434.69" y="-5678.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16434.69" y="-5663.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_qkv_gpu_5 -->
<g id="edge351" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_qkv_gpu_5</title>
<path fill="none" stroke="black" d="M13873.95,-5886C14539.01,-5886 16434.69,-5886 16434.69,-5886 16434.69,-5886 16434.69,-5734.28 16434.69,-5734.28"/>
<polygon fill="black" stroke="black" points="16438.19,-5734.28 16434.69,-5724.28 16431.19,-5734.28 16438.19,-5734.28"/>
</g>
<!-- layer_2_qkv_gpu_6 -->
<g id="node195" class="node">
<title>layer_2_qkv_gpu_6</title>
<polygon fill="#e6f3ff" stroke="black" points="11659.69,-5724.17 11197.69,-5724.17 11197.69,-5656.17 11659.69,-5656.17 11659.69,-5724.17"/>
<text text-anchor="middle" x="11428.69" y="-5708.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11428.69" y="-5693.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="11428.69" y="-5678.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11428.69" y="-5663.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_qkv_gpu_6 -->
<g id="edge352" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_qkv_gpu_6</title>
<path fill="none" stroke="black" d="M13419.49,-5872C12854.02,-5872 11428.69,-5872 11428.69,-5872 11428.69,-5872 11428.69,-5734.37 11428.69,-5734.37"/>
<polygon fill="black" stroke="black" points="11432.19,-5734.37 11428.69,-5724.37 11425.19,-5734.37 11432.19,-5734.37"/>
</g>
<!-- layer_2_qkv_gpu_7 -->
<g id="node196" class="node">
<title>layer_2_qkv_gpu_7</title>
<polygon fill="#e6f3ff" stroke="black" points="12498.69,-5724.17 12036.69,-5724.17 12036.69,-5656.17 12498.69,-5656.17 12498.69,-5724.17"/>
<text text-anchor="middle" x="12267.69" y="-5708.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12267.69" y="-5693.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="12267.69" y="-5678.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12267.69" y="-5663.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_qkv_gpu_7 -->
<g id="edge353" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_qkv_gpu_7</title>
<path fill="none" stroke="black" d="M13419.46,-5859C13045.71,-5859 12342.19,-5859 12342.19,-5859 12342.19,-5859 12342.19,-5734.33 12342.19,-5734.33"/>
<polygon fill="black" stroke="black" points="12345.69,-5734.33 12342.19,-5724.33 12338.69,-5734.33 12345.69,-5734.33"/>
</g>
<!-- layer_2_attn_gpu_0 -->
<g id="node197" class="node">
<title>layer_2_attn_gpu_0</title>
<polygon fill="#e6f3ff" stroke="black" points="13038.69,-5548.17 12576.69,-5548.17 12576.69,-5480.17 13038.69,-5480.17 13038.69,-5548.17"/>
<text text-anchor="middle" x="12807.69" y="-5532.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="12807.69" y="-5517.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="12807.69" y="-5502.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12807.69" y="-5487.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_qkv_gpu_0&#45;&gt;layer_2_attn_gpu_0 -->
<g id="edge354" class="edge">
<title>layer_2_qkv_gpu_0&#45;&gt;layer_2_attn_gpu_0</title>
<path fill="none" stroke="black" d="M12867.69,-5655.81C12867.69,-5655.81 12867.69,-5558.43 12867.69,-5558.43"/>
<polygon fill="black" stroke="black" points="12871.19,-5558.43 12867.69,-5548.43 12864.19,-5558.43 12871.19,-5558.43"/>
</g>
<!-- layer_2_attn_gpu_1 -->
<g id="node198" class="node">
<title>layer_2_attn_gpu_1</title>
<polygon fill="#e6f3ff" stroke="black" points="13877.69,-5548.17 13415.69,-5548.17 13415.69,-5480.17 13877.69,-5480.17 13877.69,-5548.17"/>
<text text-anchor="middle" x="13646.69" y="-5532.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="13646.69" y="-5517.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="13646.69" y="-5502.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13646.69" y="-5487.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_qkv_gpu_1&#45;&gt;layer_2_attn_gpu_1 -->
<g id="edge355" class="edge">
<title>layer_2_qkv_gpu_1&#45;&gt;layer_2_attn_gpu_1</title>
<path fill="none" stroke="black" d="M13646.69,-5655.81C13646.69,-5655.81 13646.69,-5558.43 13646.69,-5558.43"/>
<polygon fill="black" stroke="black" points="13650.19,-5558.43 13646.69,-5548.43 13643.19,-5558.43 13650.19,-5558.43"/>
</g>
<!-- layer_2_attn_gpu_2 -->
<g id="node199" class="node">
<title>layer_2_attn_gpu_2</title>
<polygon fill="#e6f3ff" stroke="black" points="14596.69,-5548.17 14134.69,-5548.17 14134.69,-5480.17 14596.69,-5480.17 14596.69,-5548.17"/>
<text text-anchor="middle" x="14365.69" y="-5532.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="14365.69" y="-5517.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="14365.69" y="-5502.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14365.69" y="-5487.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_qkv_gpu_2&#45;&gt;layer_2_attn_gpu_2 -->
<g id="edge356" class="edge">
<title>layer_2_qkv_gpu_2&#45;&gt;layer_2_attn_gpu_2</title>
<path fill="none" stroke="black" d="M14365.69,-5655.81C14365.69,-5655.81 14365.69,-5558.43 14365.69,-5558.43"/>
<polygon fill="black" stroke="black" points="14369.19,-5558.43 14365.69,-5548.43 14362.19,-5558.43 14369.19,-5558.43"/>
</g>
<!-- layer_2_attn_gpu_3 -->
<g id="node200" class="node">
<title>layer_2_attn_gpu_3</title>
<polygon fill="#e6f3ff" stroke="black" points="15705.69,-5548.17 15243.69,-5548.17 15243.69,-5480.17 15705.69,-5480.17 15705.69,-5548.17"/>
<text text-anchor="middle" x="15474.69" y="-5532.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="15474.69" y="-5517.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="15474.69" y="-5502.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15474.69" y="-5487.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_qkv_gpu_3&#45;&gt;layer_2_attn_gpu_3 -->
<g id="edge357" class="edge">
<title>layer_2_qkv_gpu_3&#45;&gt;layer_2_attn_gpu_3</title>
<path fill="none" stroke="black" d="M15339.69,-5655.81C15339.69,-5655.81 15339.69,-5558.43 15339.69,-5558.43"/>
<polygon fill="black" stroke="black" points="15343.19,-5558.43 15339.69,-5548.43 15336.19,-5558.43 15343.19,-5558.43"/>
</g>
<!-- layer_2_attn_gpu_4 -->
<g id="node201" class="node">
<title>layer_2_attn_gpu_4</title>
<polygon fill="#e6f3ff" stroke="black" points="16185.69,-5548.17 15723.69,-5548.17 15723.69,-5480.17 16185.69,-5480.17 16185.69,-5548.17"/>
<text text-anchor="middle" x="15954.69" y="-5532.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="15954.69" y="-5517.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="15954.69" y="-5502.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15954.69" y="-5487.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_qkv_gpu_4&#45;&gt;layer_2_attn_gpu_4 -->
<g id="edge358" class="edge">
<title>layer_2_qkv_gpu_4&#45;&gt;layer_2_attn_gpu_4</title>
<path fill="none" stroke="black" d="M15909.69,-5655.81C15909.69,-5655.81 15909.69,-5558.43 15909.69,-5558.43"/>
<polygon fill="black" stroke="black" points="15913.19,-5558.43 15909.69,-5548.43 15906.19,-5558.43 15913.19,-5558.43"/>
</g>
<!-- layer_2_attn_gpu_5 -->
<g id="node202" class="node">
<title>layer_2_attn_gpu_5</title>
<polygon fill="#e6f3ff" stroke="black" points="17623.69,-5548.17 17161.69,-5548.17 17161.69,-5480.17 17623.69,-5480.17 17623.69,-5548.17"/>
<text text-anchor="middle" x="17392.69" y="-5532.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="17392.69" y="-5517.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="17392.69" y="-5502.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17392.69" y="-5487.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_qkv_gpu_5&#45;&gt;layer_2_attn_gpu_5 -->
<g id="edge359" class="edge">
<title>layer_2_qkv_gpu_5&#45;&gt;layer_2_attn_gpu_5</title>
<path fill="none" stroke="black" d="M16665.98,-5690C16949.48,-5690 17392.69,-5690 17392.69,-5690 17392.69,-5690 17392.69,-5558.49 17392.69,-5558.49"/>
<polygon fill="black" stroke="black" points="17396.19,-5558.49 17392.69,-5548.49 17389.19,-5558.49 17396.19,-5558.49"/>
</g>
<!-- layer_2_attn_gpu_6 -->
<g id="node203" class="node">
<title>layer_2_attn_gpu_6</title>
<polygon fill="#e6f3ff" stroke="black" points="11329.69,-5548.17 10867.69,-5548.17 10867.69,-5480.17 11329.69,-5480.17 11329.69,-5548.17"/>
<text text-anchor="middle" x="11098.69" y="-5532.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="11098.69" y="-5517.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="11098.69" y="-5502.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11098.69" y="-5487.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_qkv_gpu_6&#45;&gt;layer_2_attn_gpu_6 -->
<g id="edge360" class="edge">
<title>layer_2_qkv_gpu_6&#45;&gt;layer_2_attn_gpu_6</title>
<path fill="none" stroke="black" d="M11263.69,-5655.81C11263.69,-5655.81 11263.69,-5558.43 11263.69,-5558.43"/>
<polygon fill="black" stroke="black" points="11267.19,-5558.43 11263.69,-5548.43 11260.19,-5558.43 11267.19,-5558.43"/>
</g>
<!-- layer_2_attn_gpu_7 -->
<g id="node204" class="node">
<title>layer_2_attn_gpu_7</title>
<polygon fill="#e6f3ff" stroke="black" points="12319.69,-5548.17 11857.69,-5548.17 11857.69,-5480.17 12319.69,-5480.17 12319.69,-5548.17"/>
<text text-anchor="middle" x="12088.69" y="-5532.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="12088.69" y="-5517.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="12088.69" y="-5502.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12088.69" y="-5487.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_2_qkv_gpu_7&#45;&gt;layer_2_attn_gpu_7 -->
<g id="edge361" class="edge">
<title>layer_2_qkv_gpu_7&#45;&gt;layer_2_attn_gpu_7</title>
<path fill="none" stroke="black" d="M12178.19,-5655.81C12178.19,-5655.81 12178.19,-5558.43 12178.19,-5558.43"/>
<polygon fill="black" stroke="black" points="12181.69,-5558.43 12178.19,-5548.43 12174.69,-5558.43 12181.69,-5558.43"/>
</g>
<!-- layer_2_attn_allreduce_0 -->
<g id="node205" class="node">
<title>layer_2_attn_allreduce_0</title>
<polygon fill="#e6ffe6" stroke="black" points="13158.56,-5372.17 12409.51,-5372.17 12216.81,-5236.17 12965.87,-5236.17 13158.56,-5372.17"/>
<text text-anchor="middle" x="12687.69" y="-5322.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="12687.69" y="-5307.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="12687.69" y="-5292.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12687.69" y="-5277.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_gpu_0&#45;&gt;layer_2_attn_allreduce_0 -->
<g id="edge362" class="edge">
<title>layer_2_attn_gpu_0&#45;&gt;layer_2_attn_allreduce_0</title>
<path fill="none" stroke="black" d="M12807.69,-5479.96C12807.69,-5479.96 12807.69,-5382.33 12807.69,-5382.33"/>
<polygon fill="black" stroke="black" points="12811.19,-5382.33 12807.69,-5372.33 12804.19,-5382.33 12811.19,-5382.33"/>
</g>
<!-- layer_2_attn_allreduce_1 -->
<g id="node206" class="node">
<title>layer_2_attn_allreduce_1</title>
<polygon fill="#e6ffe6" stroke="black" points="14117.56,-5372.17 13368.51,-5372.17 13175.81,-5236.17 13924.87,-5236.17 14117.56,-5372.17"/>
<text text-anchor="middle" x="13646.69" y="-5322.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="13646.69" y="-5307.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="13646.69" y="-5292.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13646.69" y="-5277.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_gpu_1&#45;&gt;layer_2_attn_allreduce_1 -->
<g id="edge363" class="edge">
<title>layer_2_attn_gpu_1&#45;&gt;layer_2_attn_allreduce_1</title>
<path fill="none" stroke="black" d="M13646.69,-5479.96C13646.69,-5479.96 13646.69,-5382.33 13646.69,-5382.33"/>
<polygon fill="black" stroke="black" points="13650.19,-5382.33 13646.69,-5372.33 13643.19,-5382.33 13650.19,-5382.33"/>
</g>
<!-- layer_2_attn_allreduce_2 -->
<g id="node207" class="node">
<title>layer_2_attn_allreduce_2</title>
<polygon fill="#e6ffe6" stroke="black" points="15076.56,-5372.17 14327.51,-5372.17 14134.81,-5236.17 14883.87,-5236.17 15076.56,-5372.17"/>
<text text-anchor="middle" x="14605.69" y="-5322.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="14605.69" y="-5307.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="14605.69" y="-5292.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14605.69" y="-5277.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_gpu_2&#45;&gt;layer_2_attn_allreduce_2 -->
<g id="edge364" class="edge">
<title>layer_2_attn_gpu_2&#45;&gt;layer_2_attn_allreduce_2</title>
<path fill="none" stroke="black" d="M14365.84,-5479.96C14365.84,-5479.96 14365.84,-5382.33 14365.84,-5382.33"/>
<polygon fill="black" stroke="black" points="14369.34,-5382.33 14365.84,-5372.33 14362.34,-5382.33 14369.34,-5382.33"/>
</g>
<!-- layer_2_attn_allreduce_3 -->
<g id="node208" class="node">
<title>layer_2_attn_allreduce_3</title>
<polygon fill="#e6ffe6" stroke="black" points="16035.56,-5372.17 15286.51,-5372.17 15093.81,-5236.17 15842.87,-5236.17 16035.56,-5372.17"/>
<text text-anchor="middle" x="15564.69" y="-5322.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="15564.69" y="-5307.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="15564.69" y="-5292.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15564.69" y="-5277.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_gpu_3&#45;&gt;layer_2_attn_allreduce_3 -->
<g id="edge365" class="edge">
<title>layer_2_attn_gpu_3&#45;&gt;layer_2_attn_allreduce_3</title>
<path fill="none" stroke="black" d="M15474.69,-5479.96C15474.69,-5479.96 15474.69,-5382.33 15474.69,-5382.33"/>
<polygon fill="black" stroke="black" points="15478.19,-5382.33 15474.69,-5372.33 15471.19,-5382.33 15478.19,-5382.33"/>
</g>
<!-- layer_2_attn_allreduce_4 -->
<g id="node209" class="node">
<title>layer_2_attn_allreduce_4</title>
<polygon fill="#e6ffe6" stroke="black" points="16994.56,-5372.17 16245.51,-5372.17 16052.81,-5236.17 16801.87,-5236.17 16994.56,-5372.17"/>
<text text-anchor="middle" x="16523.69" y="-5322.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="16523.69" y="-5307.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="16523.69" y="-5292.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="16523.69" y="-5277.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_gpu_4&#45;&gt;layer_2_attn_allreduce_4 -->
<g id="edge366" class="edge">
<title>layer_2_attn_gpu_4&#45;&gt;layer_2_attn_allreduce_4</title>
<path fill="none" stroke="black" d="M16119.34,-5479.96C16119.34,-5479.96 16119.34,-5314.25 16119.34,-5314.25"/>
<polygon fill="black" stroke="black" points="16122.84,-5314.25 16119.34,-5304.25 16115.84,-5314.25 16122.84,-5314.25"/>
</g>
<!-- layer_2_attn_allreduce_5 -->
<g id="node210" class="node">
<title>layer_2_attn_allreduce_5</title>
<polygon fill="#e6ffe6" stroke="black" points="17953.56,-5372.17 17204.51,-5372.17 17011.81,-5236.17 17760.87,-5236.17 17953.56,-5372.17"/>
<text text-anchor="middle" x="17482.69" y="-5322.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="17482.69" y="-5307.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="17482.69" y="-5292.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="17482.69" y="-5277.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_gpu_5&#45;&gt;layer_2_attn_allreduce_5 -->
<g id="edge367" class="edge">
<title>layer_2_attn_gpu_5&#45;&gt;layer_2_attn_allreduce_5</title>
<path fill="none" stroke="black" d="M17392.69,-5479.96C17392.69,-5479.96 17392.69,-5382.33 17392.69,-5382.33"/>
<polygon fill="black" stroke="black" points="17396.19,-5382.33 17392.69,-5372.33 17389.19,-5382.33 17396.19,-5382.33"/>
</g>
<!-- layer_2_attn_allreduce_6 -->
<g id="node211" class="node">
<title>layer_2_attn_allreduce_6</title>
<polygon fill="#e6ffe6" stroke="black" points="11240.56,-5372.17 10491.51,-5372.17 10298.81,-5236.17 11047.87,-5236.17 11240.56,-5372.17"/>
<text text-anchor="middle" x="10769.69" y="-5322.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="10769.69" y="-5307.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="10769.69" y="-5292.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10769.69" y="-5277.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_gpu_6&#45;&gt;layer_2_attn_allreduce_6 -->
<g id="edge368" class="edge">
<title>layer_2_attn_gpu_6&#45;&gt;layer_2_attn_allreduce_6</title>
<path fill="none" stroke="black" d="M11054.03,-5479.96C11054.03,-5479.96 11054.03,-5382.33 11054.03,-5382.33"/>
<polygon fill="black" stroke="black" points="11057.53,-5382.33 11054.03,-5372.33 11050.53,-5382.33 11057.53,-5382.33"/>
</g>
<!-- layer_2_attn_allreduce_7 -->
<g id="node212" class="node">
<title>layer_2_attn_allreduce_7</title>
<polygon fill="#e6ffe6" stroke="black" points="12199.56,-5372.17 11450.51,-5372.17 11257.81,-5236.17 12006.87,-5236.17 12199.56,-5372.17"/>
<text text-anchor="middle" x="11728.69" y="-5322.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="11728.69" y="-5307.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="11728.69" y="-5292.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11728.69" y="-5277.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_gpu_7&#45;&gt;layer_2_attn_allreduce_7 -->
<g id="edge369" class="edge">
<title>layer_2_attn_gpu_7&#45;&gt;layer_2_attn_allreduce_7</title>
<path fill="none" stroke="black" d="M12028.53,-5479.96C12028.53,-5479.96 12028.53,-5382.33 12028.53,-5382.33"/>
<polygon fill="black" stroke="black" points="12032.03,-5382.33 12028.53,-5372.33 12025.03,-5382.33 12032.03,-5382.33"/>
</g>
<!-- layer_2_attn_proj_0 -->
<g id="node213" class="node">
<title>layer_2_attn_proj_0</title>
<polygon fill="#e6f3ff" stroke="black" points="13644.69,-5128.17 13190.69,-5128.17 13190.69,-5060.17 13644.69,-5060.17 13644.69,-5128.17"/>
<text text-anchor="middle" x="13417.69" y="-5112.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="13417.69" y="-5097.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="13417.69" y="-5082.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13417.69" y="-5067.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_allreduce_0&#45;&gt;layer_2_attn_proj_0 -->
<g id="edge370" class="edge">
<title>layer_2_attn_allreduce_0&#45;&gt;layer_2_attn_proj_0</title>
<path fill="none" stroke="black" d="M13011.81,-5268.48C13011.81,-5229.03 13011.81,-5171 13011.81,-5171 13011.81,-5171 13417.69,-5171 13417.69,-5171 13417.69,-5171 13417.69,-5138.54 13417.69,-5138.54"/>
<polygon fill="black" stroke="black" points="13421.19,-5138.54 13417.69,-5128.54 13414.19,-5138.54 13421.19,-5138.54"/>
</g>
<!-- layer_2_attn_proj_1 -->
<g id="node214" class="node">
<title>layer_2_attn_proj_1</title>
<polygon fill="#e6f3ff" stroke="black" points="14116.69,-5128.17 13662.69,-5128.17 13662.69,-5060.17 14116.69,-5060.17 14116.69,-5128.17"/>
<text text-anchor="middle" x="13889.69" y="-5112.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="13889.69" y="-5097.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="13889.69" y="-5082.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13889.69" y="-5067.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_allreduce_1&#45;&gt;layer_2_attn_proj_1 -->
<g id="edge371" class="edge">
<title>layer_2_attn_allreduce_1&#45;&gt;layer_2_attn_proj_1</title>
<path fill="none" stroke="black" d="M13889.69,-5235.99C13889.69,-5235.99 13889.69,-5138.2 13889.69,-5138.2"/>
<polygon fill="black" stroke="black" points="13893.19,-5138.2 13889.69,-5128.2 13886.19,-5138.2 13893.19,-5138.2"/>
</g>
<!-- layer_2_attn_proj_2 -->
<g id="node215" class="node">
<title>layer_2_attn_proj_2</title>
<polygon fill="#e6f3ff" stroke="black" points="14588.69,-5128.17 14134.69,-5128.17 14134.69,-5060.17 14588.69,-5060.17 14588.69,-5128.17"/>
<text text-anchor="middle" x="14361.69" y="-5112.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="14361.69" y="-5097.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="14361.69" y="-5082.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14361.69" y="-5067.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_allreduce_2&#45;&gt;layer_2_attn_proj_2 -->
<g id="edge372" class="edge">
<title>layer_2_attn_allreduce_2&#45;&gt;layer_2_attn_proj_2</title>
<path fill="none" stroke="black" d="M14361.84,-5235.99C14361.84,-5235.99 14361.84,-5138.2 14361.84,-5138.2"/>
<polygon fill="black" stroke="black" points="14365.34,-5138.2 14361.84,-5128.2 14358.34,-5138.2 14365.34,-5138.2"/>
</g>
<!-- layer_2_attn_proj_3 -->
<g id="node216" class="node">
<title>layer_2_attn_proj_3</title>
<polygon fill="#e6f3ff" stroke="black" points="15060.69,-5128.17 14606.69,-5128.17 14606.69,-5060.17 15060.69,-5060.17 15060.69,-5128.17"/>
<text text-anchor="middle" x="14833.69" y="-5112.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="14833.69" y="-5097.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="14833.69" y="-5082.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14833.69" y="-5067.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_allreduce_3&#45;&gt;layer_2_attn_proj_3 -->
<g id="edge373" class="edge">
<title>layer_2_attn_allreduce_3&#45;&gt;layer_2_attn_proj_3</title>
<path fill="none" stroke="black" d="M15240.23,-5235.83C15240.23,-5223.25 15240.23,-5214 15240.23,-5214 15240.23,-5214 14833.69,-5214 14833.69,-5214 14833.69,-5214 14833.69,-5138.19 14833.69,-5138.19"/>
<polygon fill="black" stroke="black" points="14837.19,-5138.19 14833.69,-5128.19 14830.19,-5138.19 14837.19,-5138.19"/>
</g>
<!-- layer_2_attn_proj_4 -->
<g id="node217" class="node">
<title>layer_2_attn_proj_4</title>
<polygon fill="#e6f3ff" stroke="black" points="15532.69,-5128.17 15078.69,-5128.17 15078.69,-5060.17 15532.69,-5060.17 15532.69,-5128.17"/>
<text text-anchor="middle" x="15305.69" y="-5112.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="15305.69" y="-5097.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="15305.69" y="-5082.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15305.69" y="-5067.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_allreduce_4&#45;&gt;layer_2_attn_proj_4 -->
<g id="edge374" class="edge">
<title>layer_2_attn_allreduce_4&#45;&gt;layer_2_attn_proj_4</title>
<path fill="none" stroke="black" d="M16785.18,-5236.01C16785.18,-5212.52 16785.18,-5192 16785.18,-5192 16785.18,-5192 15386.46,-5192 15386.46,-5192 15386.46,-5192 15386.46,-5138.38 15386.46,-5138.38"/>
<polygon fill="black" stroke="black" points="15389.96,-5138.38 15386.46,-5128.38 15382.96,-5138.38 15389.96,-5138.38"/>
</g>
<!-- layer_2_attn_proj_5 -->
<g id="node218" class="node">
<title>layer_2_attn_proj_5</title>
<polygon fill="#e6f3ff" stroke="black" points="16004.69,-5128.17 15550.69,-5128.17 15550.69,-5060.17 16004.69,-5060.17 16004.69,-5128.17"/>
<text text-anchor="middle" x="15777.69" y="-5112.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="15777.69" y="-5097.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="15777.69" y="-5082.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15777.69" y="-5067.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_allreduce_5&#45;&gt;layer_2_attn_proj_5 -->
<g id="edge375" class="edge">
<title>layer_2_attn_allreduce_5&#45;&gt;layer_2_attn_proj_5</title>
<path fill="none" stroke="black" d="M17848.77,-5298.17C17848.77,-5265.57 17848.77,-5111 17848.77,-5111 17848.77,-5111 16014.76,-5111 16014.76,-5111"/>
<polygon fill="black" stroke="black" points="16014.76,-5107.5 16004.76,-5111 16014.76,-5114.5 16014.76,-5107.5"/>
</g>
<!-- layer_2_attn_proj_6 -->
<g id="node219" class="node">
<title>layer_2_attn_proj_6</title>
<polygon fill="#e6f3ff" stroke="black" points="12700.69,-5128.17 12246.69,-5128.17 12246.69,-5060.17 12700.69,-5060.17 12700.69,-5128.17"/>
<text text-anchor="middle" x="12473.69" y="-5112.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="12473.69" y="-5097.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="12473.69" y="-5082.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12473.69" y="-5067.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_allreduce_6&#45;&gt;layer_2_attn_proj_6 -->
<g id="edge376" class="edge">
<title>layer_2_attn_allreduce_6&#45;&gt;layer_2_attn_proj_6</title>
<path fill="none" stroke="black" d="M11135.77,-5298.17C11135.77,-5265.57 11135.77,-5111 11135.77,-5111 11135.77,-5111 12236.35,-5111 12236.35,-5111"/>
<polygon fill="black" stroke="black" points="12236.35,-5114.5 12246.35,-5111 12236.35,-5107.5 12236.35,-5114.5"/>
</g>
<!-- layer_2_attn_proj_7 -->
<g id="node220" class="node">
<title>layer_2_attn_proj_7</title>
<polygon fill="#e6f3ff" stroke="black" points="13172.69,-5128.17 12718.69,-5128.17 12718.69,-5060.17 13172.69,-5060.17 13172.69,-5128.17"/>
<text text-anchor="middle" x="12945.69" y="-5112.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="12945.69" y="-5097.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="12945.69" y="-5082.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12945.69" y="-5067.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_allreduce_7&#45;&gt;layer_2_attn_proj_7 -->
<g id="edge377" class="edge">
<title>layer_2_attn_allreduce_7&#45;&gt;layer_2_attn_proj_7</title>
<path fill="none" stroke="black" d="M11362.6,-5236.11C11362.6,-5194.42 11362.6,-5149 11362.6,-5149 11362.6,-5149 12865.25,-5149 12865.25,-5149 12865.25,-5149 12865.25,-5138.27 12865.25,-5138.27"/>
<polygon fill="black" stroke="black" points="12868.75,-5138.27 12865.25,-5128.27 12861.75,-5138.27 12868.75,-5138.27"/>
</g>
<!-- layer_2_recv_attn_8 -->
<g id="node221" class="node">
<title>layer_2_recv_attn_8</title>
<polygon fill="#e6ffe6" stroke="black" points="17953.56,-4952.17 17204.51,-4952.17 17011.81,-4816.17 17760.87,-4816.17 17953.56,-4952.17"/>
<text text-anchor="middle" x="17482.69" y="-4902.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="17482.69" y="-4887.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="17482.69" y="-4872.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17482.69" y="-4857.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_8 -->
<g id="edge378" class="edge">
<title>layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_8</title>
<path fill="none" stroke="black" d="M13594.24,-5059.9C13594.24,-5032.98 13594.24,-5000 13594.24,-5000 13594.24,-5000 17221.19,-5000 17221.19,-5000 17221.19,-5000 17221.19,-4962.22 17221.19,-4962.22"/>
<polygon fill="black" stroke="black" points="17224.69,-4962.22 17221.19,-4952.22 17217.69,-4962.22 17224.69,-4962.22"/>
</g>
<!-- layer_2_recv_attn_9 -->
<g id="node222" class="node">
<title>layer_2_recv_attn_9</title>
<polygon fill="#e6ffe6" stroke="black" points="11240.56,-4952.17 10491.51,-4952.17 10298.81,-4816.17 11047.87,-4816.17 11240.56,-4952.17"/>
<text text-anchor="middle" x="10769.69" y="-4902.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="10769.69" y="-4887.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="10769.69" y="-4872.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10769.69" y="-4857.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_9 -->
<g id="edge379" class="edge">
<title>layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_9</title>
<path fill="none" stroke="black" d="M13241.13,-5060.13C13241.13,-5053.21 13241.13,-5048 13241.13,-5048 13241.13,-5048 10612.79,-5048 10612.79,-5048 10612.79,-5048 10612.79,-4962.22 10612.79,-4962.22"/>
<polygon fill="black" stroke="black" points="10616.29,-4962.22 10612.79,-4952.22 10609.29,-4962.22 10616.29,-4962.22"/>
</g>
<!-- layer_2_recv_attn_10 -->
<g id="node223" class="node">
<title>layer_2_recv_attn_10</title>
<polygon fill="#e6ffe6" stroke="black" points="12199.56,-4952.17 11450.51,-4952.17 11257.81,-4816.17 12006.87,-4816.17 12199.56,-4952.17"/>
<text text-anchor="middle" x="11728.69" y="-4902.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="11728.69" y="-4887.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="11728.69" y="-4872.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11728.69" y="-4857.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_10 -->
<g id="edge380" class="edge">
<title>layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_10</title>
<path fill="none" stroke="black" d="M13291.57,-5060.01C13291.57,-5046 13291.57,-5033 13291.57,-5033 13291.57,-5033 11676.39,-5033 11676.39,-5033 11676.39,-5033 11676.39,-4962.48 11676.39,-4962.48"/>
<polygon fill="black" stroke="black" points="11679.89,-4962.48 11676.39,-4952.48 11672.89,-4962.48 11679.89,-4962.48"/>
</g>
<!-- layer_2_recv_attn_11 -->
<g id="node224" class="node">
<title>layer_2_recv_attn_11</title>
<polygon fill="#e6ffe6" stroke="black" points="13158.56,-4952.17 12409.51,-4952.17 12216.81,-4816.17 12965.87,-4816.17 13158.56,-4952.17"/>
<text text-anchor="middle" x="12687.69" y="-4902.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="12687.69" y="-4887.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="12687.69" y="-4872.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12687.69" y="-4857.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_11 -->
<g id="edge381" class="edge">
<title>layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_11</title>
<path fill="none" stroke="black" d="M13342.02,-5059.91C13342.02,-5042.09 13342.02,-5024 13342.02,-5024 13342.02,-5024 12918.54,-5024 12918.54,-5024 12918.54,-5024 12918.54,-4962.44 12918.54,-4962.44"/>
<polygon fill="black" stroke="black" points="12922.04,-4962.44 12918.54,-4952.44 12915.04,-4962.44 12922.04,-4962.44"/>
</g>
<!-- layer_2_recv_attn_12 -->
<g id="node225" class="node">
<title>layer_2_recv_attn_12</title>
<polygon fill="#e6ffe6" stroke="black" points="14117.56,-4952.17 13368.51,-4952.17 13175.81,-4816.17 13924.87,-4816.17 14117.56,-4952.17"/>
<text text-anchor="middle" x="13646.69" y="-4902.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="13646.69" y="-4887.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="13646.69" y="-4872.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13646.69" y="-4857.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_12 -->
<g id="edge382" class="edge">
<title>layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_12</title>
<path fill="none" stroke="black" d="M13392.46,-5059.96C13392.46,-5059.96 13392.46,-4962.33 13392.46,-4962.33"/>
<polygon fill="black" stroke="black" points="13395.96,-4962.33 13392.46,-4952.33 13388.96,-4962.33 13395.96,-4962.33"/>
</g>
<!-- layer_2_recv_attn_13 -->
<g id="node226" class="node">
<title>layer_2_recv_attn_13</title>
<polygon fill="#e6ffe6" stroke="black" points="15076.56,-4952.17 14327.51,-4952.17 14134.81,-4816.17 14883.87,-4816.17 15076.56,-4952.17"/>
<text text-anchor="middle" x="14605.69" y="-4902.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="14605.69" y="-4887.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="14605.69" y="-4872.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14605.69" y="-4857.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_13 -->
<g id="edge383" class="edge">
<title>layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_13</title>
<path fill="none" stroke="black" d="M13442.91,-5059.8C13442.91,-5037.28 13442.91,-5012 13442.91,-5012 13442.91,-5012 14382.47,-5012 14382.47,-5012 14382.47,-5012 14382.47,-4962.2 14382.47,-4962.2"/>
<polygon fill="black" stroke="black" points="14385.97,-4962.2 14382.47,-4952.2 14378.97,-4962.2 14385.97,-4962.2"/>
</g>
<!-- layer_2_recv_attn_14 -->
<g id="node227" class="node">
<title>layer_2_recv_attn_14</title>
<polygon fill="#e6ffe6" stroke="black" points="16035.56,-4952.17 15286.51,-4952.17 15093.81,-4816.17 15842.87,-4816.17 16035.56,-4952.17"/>
<text text-anchor="middle" x="15564.69" y="-4902.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="15564.69" y="-4887.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="15564.69" y="-4872.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15564.69" y="-4857.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_14 -->
<g id="edge384" class="edge">
<title>layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_14</title>
<path fill="none" stroke="black" d="M13493.35,-5059.99C13493.35,-5028.95 13493.35,-4988 13493.35,-4988 13493.35,-4988 15253.52,-4988 15253.52,-4988 15253.52,-4988 15253.52,-4939.11 15253.52,-4939.11"/>
<polygon fill="black" stroke="black" points="15257.02,-4939.11 15253.52,-4929.11 15250.02,-4939.11 15257.02,-4939.11"/>
</g>
<!-- layer_2_recv_attn_15 -->
<g id="node228" class="node">
<title>layer_2_recv_attn_15</title>
<polygon fill="#e6ffe6" stroke="black" points="16994.56,-4952.17 16245.51,-4952.17 16052.81,-4816.17 16801.87,-4816.17 16994.56,-4952.17"/>
<text text-anchor="middle" x="16523.69" y="-4902.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="16523.69" y="-4887.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="16523.69" y="-4872.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16523.69" y="-4857.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_15 -->
<g id="edge385" class="edge">
<title>layer_2_attn_proj_0&#45;&gt;layer_2_recv_attn_15</title>
<path fill="none" stroke="black" d="M13543.8,-5060.15C13543.8,-5030.43 13543.8,-4992 13543.8,-4992 13543.8,-4992 16262.19,-4992 16262.19,-4992 16262.19,-4992 16262.19,-4962.46 16262.19,-4962.46"/>
<polygon fill="black" stroke="black" points="16265.69,-4962.46 16262.19,-4952.46 16258.69,-4962.46 16265.69,-4962.46"/>
</g>
<!-- layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_8 -->
<g id="edge386" class="edge">
<title>layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_8</title>
<path fill="none" stroke="black" d="M13951.6,-5060.11C13951.6,-5033.85 13951.6,-5002 13951.6,-5002 13951.6,-5002 17325.79,-5002 17325.79,-5002 17325.79,-5002 17325.79,-4962.37 17325.79,-4962.37"/>
<polygon fill="black" stroke="black" points="17329.29,-4962.37 17325.79,-4952.37 17322.29,-4962.37 17329.29,-4962.37"/>
</g>
<!-- layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_9 -->
<g id="edge387" class="edge">
<title>layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_9</title>
<path fill="none" stroke="black" d="M13703.96,-5060.02C13703.96,-5051.63 13703.96,-5045 13703.96,-5045 13703.96,-5045 10717.39,-5045 10717.39,-5045 10717.39,-5045 10717.39,-4962.37 10717.39,-4962.37"/>
<polygon fill="black" stroke="black" points="10720.89,-4962.37 10717.39,-4952.37 10713.89,-4962.37 10720.89,-4962.37"/>
</g>
<!-- layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_10 -->
<g id="edge388" class="edge">
<title>layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_10</title>
<path fill="none" stroke="black" d="M13745.23,-5060C13745.23,-5045.11 13745.23,-5031 13745.23,-5031 13745.23,-5031 11780.98,-5031 11780.98,-5031 11780.98,-5031 11780.98,-4962.42 11780.98,-4962.42"/>
<polygon fill="black" stroke="black" points="11784.48,-4962.42 11780.98,-4952.42 11777.48,-4962.42 11784.48,-4962.42"/>
</g>
<!-- layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_11 -->
<g id="edge389" class="edge">
<title>layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_11</title>
<path fill="none" stroke="black" d="M13786.5,-5060.15C13786.5,-5041.05 13786.5,-5021 13786.5,-5021 13786.5,-5021 12958.51,-5021 12958.51,-5021 12958.51,-5021 12958.51,-4962.18 12958.51,-4962.18"/>
<polygon fill="black" stroke="black" points="12962.01,-4962.18 12958.51,-4952.18 12955.01,-4962.18 12962.01,-4962.18"/>
</g>
<!-- layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_12 -->
<g id="edge390" class="edge">
<title>layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_12</title>
<path fill="none" stroke="black" d="M13827.78,-5059.96C13827.78,-5059.96 13827.78,-4962.33 13827.78,-4962.33"/>
<polygon fill="black" stroke="black" points="13831.28,-4962.33 13827.78,-4952.33 13824.28,-4962.33 13831.28,-4962.33"/>
</g>
<!-- layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_13 -->
<g id="edge391" class="edge">
<title>layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_13</title>
<path fill="none" stroke="black" d="M14116.9,-5105C14120.92,-5105 14123.14,-5105 14123.14,-5105 14123.14,-5105 14123.14,-4861 14123.14,-4861 14123.14,-4861 14188.28,-4861 14188.28,-4861"/>
<polygon fill="black" stroke="black" points="14188.28,-4864.5 14198.28,-4861 14188.28,-4857.5 14188.28,-4864.5"/>
</g>
<!-- layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_14 -->
<g id="edge392" class="edge">
<title>layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_14</title>
<path fill="none" stroke="black" d="M13869.05,-5059.7C13869.05,-5037.98 13869.05,-5014 13869.05,-5014 13869.05,-5014 15293.4,-5014 15293.4,-5014 15293.4,-5014 15293.4,-4962.51 15293.4,-4962.51"/>
<polygon fill="black" stroke="black" points="15296.9,-4962.51 15293.4,-4952.51 15289.9,-4962.51 15296.9,-4962.51"/>
</g>
<!-- layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_15 -->
<g id="edge393" class="edge">
<title>layer_2_attn_proj_1&#45;&gt;layer_2_recv_attn_15</title>
<path fill="none" stroke="black" d="M13910.32,-5060.04C13910.32,-5031.35 13910.32,-4995 13910.32,-4995 13910.32,-4995 16366.79,-4995 16366.79,-4995 16366.79,-4995 16366.79,-4962.47 16366.79,-4962.47"/>
<polygon fill="black" stroke="black" points="16370.29,-4962.47 16366.79,-4952.47 16363.29,-4962.47 16370.29,-4962.47"/>
</g>
<!-- layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_8 -->
<g id="edge394" class="edge">
<title>layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_8</title>
<path fill="none" stroke="black" d="M14547.44,-5060.13C14547.44,-5055.34 14547.44,-5052 14547.44,-5052 14547.44,-5052 17430.39,-5052 17430.39,-5052 17430.39,-5052 17430.39,-4962.43 17430.39,-4962.43"/>
<polygon fill="black" stroke="black" points="17433.89,-4962.43 17430.39,-4952.43 17426.89,-4962.43 17433.89,-4962.43"/>
</g>
<!-- layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_9 -->
<g id="edge395" class="edge">
<title>layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_9</title>
<path fill="none" stroke="black" d="M14176.24,-5059.91C14176.24,-5027.24 14176.24,-4983 14176.24,-4983 14176.24,-4983 10821.98,-4983 10821.98,-4983 10821.98,-4983 10821.98,-4962.27 10821.98,-4962.27"/>
<polygon fill="black" stroke="black" points="10825.48,-4962.27 10821.98,-4952.27 10818.48,-4962.27 10825.48,-4962.27"/>
</g>
<!-- layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_10 -->
<g id="edge396" class="edge">
<title>layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_10</title>
<path fill="none" stroke="black" d="M14217.49,-5059.99C14217.49,-5025.09 14217.49,-4976 14217.49,-4976 14217.49,-4976 11885.58,-4976 11885.58,-4976 11885.58,-4976 11885.58,-4962.35 11885.58,-4962.35"/>
<polygon fill="black" stroke="black" points="11889.08,-4962.35 11885.58,-4952.35 11882.08,-4962.35 11889.08,-4962.35"/>
</g>
<!-- layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_11 -->
<g id="edge397" class="edge">
<title>layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_11</title>
<path fill="none" stroke="black" d="M14299.98,-5059.97C14299.98,-5035.55 14299.98,-5007 14299.98,-5007 14299.98,-5007 12998.49,-5007 12998.49,-5007 12998.49,-5007 12998.49,-4962.41 12998.49,-4962.41"/>
<polygon fill="black" stroke="black" points="13001.99,-4962.41 12998.49,-4952.41 12994.99,-4962.41 13001.99,-4962.41"/>
</g>
<!-- layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_12 -->
<g id="edge398" class="edge">
<title>layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_12</title>
<path fill="none" stroke="black" d="M14134.67,-5082C14130.96,-5082 14128.91,-5082 14128.91,-5082 14128.91,-5082 14128.91,-4906 14128.91,-4906 14128.91,-4906 14062.24,-4906 14062.24,-4906"/>
<polygon fill="black" stroke="black" points="14062.24,-4902.5 14052.24,-4906 14062.24,-4909.5 14062.24,-4902.5"/>
</g>
<!-- layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_13 -->
<g id="edge399" class="edge">
<title>layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_13</title>
<path fill="none" stroke="black" d="M14423.71,-5059.96C14423.71,-5059.96 14423.71,-4962.33 14423.71,-4962.33"/>
<polygon fill="black" stroke="black" points="14427.21,-4962.33 14423.71,-4952.33 14420.21,-4962.33 14427.21,-4962.33"/>
</g>
<!-- layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_14 -->
<g id="edge400" class="edge">
<title>layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_14</title>
<path fill="none" stroke="black" d="M14464.95,-5060.08C14464.95,-5043.04 14464.95,-5026 14464.95,-5026 14464.95,-5026 15333.28,-5026 15333.28,-5026 15333.28,-5026 15333.28,-4962.18 15333.28,-4962.18"/>
<polygon fill="black" stroke="black" points="15336.78,-4962.18 15333.28,-4952.18 15329.78,-4962.18 15336.78,-4962.18"/>
</g>
<!-- layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_15 -->
<g id="edge401" class="edge">
<title>layer_2_attn_proj_2&#45;&gt;layer_2_recv_attn_15</title>
<path fill="none" stroke="black" d="M14506.2,-5059.88C14506.2,-5048.18 14506.2,-5038 14506.2,-5038 14506.2,-5038 16471.39,-5038 16471.39,-5038 16471.39,-5038 16471.39,-4962.54 16471.39,-4962.54"/>
<polygon fill="black" stroke="black" points="16474.89,-4962.54 16471.39,-4952.54 16467.89,-4962.54 16474.89,-4962.54"/>
</g>
<!-- layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_8 -->
<g id="edge402" class="edge">
<title>layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_8</title>
<path fill="none" stroke="black" d="M15010.24,-5060.12C15010.24,-5057.01 15010.24,-5055 15010.24,-5055 15010.24,-5055 17534.98,-5055 17534.98,-5055 17534.98,-5055 17534.98,-4962.18 17534.98,-4962.18"/>
<polygon fill="black" stroke="black" points="17538.48,-4962.18 17534.98,-4952.18 17531.48,-4962.18 17538.48,-4962.18"/>
</g>
<!-- layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_9 -->
<g id="edge403" class="edge">
<title>layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_9</title>
<path fill="none" stroke="black" d="M14657.13,-5059.91C14657.13,-5026.28 14657.13,-4980 14657.13,-4980 14657.13,-4980 10926.58,-4980 10926.58,-4980 10926.58,-4980 10926.58,-4962.28 10926.58,-4962.28"/>
<polygon fill="black" stroke="black" points="10930.08,-4962.28 10926.58,-4952.28 10923.08,-4962.28 10930.08,-4962.28"/>
</g>
<!-- layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_10 -->
<g id="edge404" class="edge">
<title>layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_10</title>
<path fill="none" stroke="black" d="M14707.57,-5060.09C14707.57,-5024.25 14707.57,-4973 14707.57,-4973 14707.57,-4973 11990.18,-4973 11990.18,-4973 11990.18,-4973 11990.18,-4962.4 11990.18,-4962.4"/>
<polygon fill="black" stroke="black" points="11993.68,-4962.4 11990.18,-4952.4 11986.68,-4962.4 11993.68,-4962.4"/>
</g>
<!-- layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_11 -->
<g id="edge405" class="edge">
<title>layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_11</title>
<path fill="none" stroke="black" d="M14758.02,-5060.02C14758.02,-5022.66 14758.02,-4968 14758.02,-4968 14758.02,-4968 13038.46,-4968 13038.46,-4968 13038.46,-4968 13038.46,-4962.23 13038.46,-4962.23"/>
<polygon fill="black" stroke="black" points="13041.96,-4962.23 13038.46,-4952.23 13034.96,-4962.23 13041.96,-4962.23"/>
</g>
<!-- layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_12 -->
<g id="edge406" class="edge">
<title>layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_12</title>
<path fill="none" stroke="black" d="M14808.46,-5060.1C14808.46,-5040.21 14808.46,-5019 14808.46,-5019 14808.46,-5019 13992.87,-5019 13992.87,-5019 13992.87,-5019 13992.87,-4962.37 13992.87,-4962.37"/>
<polygon fill="black" stroke="black" points="13996.37,-4962.37 13992.87,-4952.37 13989.37,-4962.37 13996.37,-4962.37"/>
</g>
<!-- layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_13 -->
<g id="edge407" class="edge">
<title>layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_13</title>
<path fill="none" stroke="black" d="M14858.91,-5059.96C14858.91,-5059.96 14858.91,-4962.33 14858.91,-4962.33"/>
<polygon fill="black" stroke="black" points="14862.41,-4962.33 14858.91,-4952.33 14855.41,-4962.33 14862.41,-4962.33"/>
</g>
<!-- layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_14 -->
<g id="edge408" class="edge">
<title>layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_14</title>
<path fill="none" stroke="black" d="M14909.35,-5059.92C14909.35,-5043.78 14909.35,-5028 14909.35,-5028 14909.35,-5028 15373.16,-5028 15373.16,-5028 15373.16,-5028 15373.16,-4962.29 15373.16,-4962.29"/>
<polygon fill="black" stroke="black" points="15376.66,-4962.29 15373.16,-4952.29 15369.66,-4962.29 15376.66,-4962.29"/>
</g>
<!-- layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_15 -->
<g id="edge409" class="edge">
<title>layer_2_attn_proj_3&#45;&gt;layer_2_recv_attn_15</title>
<path fill="none" stroke="black" d="M14959.8,-5059.86C14959.8,-5049.11 14959.8,-5040 14959.8,-5040 14959.8,-5040 16575.98,-5040 16575.98,-5040 16575.98,-5040 16575.98,-4962.52 16575.98,-4962.52"/>
<polygon fill="black" stroke="black" points="16579.48,-4962.52 16575.98,-4952.52 16572.48,-4962.52 16579.48,-4962.52"/>
</g>
<!-- layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_8 -->
<g id="edge410" class="edge">
<title>layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_8</title>
<path fill="none" stroke="black" d="M15492.81,-5059.92C15492.81,-5058.1 15492.81,-5057 15492.81,-5057 15492.81,-5057 17639.58,-5057 17639.58,-5057 17639.58,-5057 17639.58,-4962.47 17639.58,-4962.47"/>
<polygon fill="black" stroke="black" points="17643.08,-4962.47 17639.58,-4952.47 17636.08,-4962.47 17643.08,-4962.47"/>
</g>
<!-- layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_9 -->
<g id="edge411" class="edge">
<title>layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_9</title>
<path fill="none" stroke="black" d="M15090.17,-5060.14C15090.17,-4969.49 15090.17,-4729 15090.17,-4729 15090.17,-4729 10932.79,-4729 10932.79,-4729 10932.79,-4729 10932.79,-4806.11 10932.79,-4806.11"/>
<polygon fill="black" stroke="black" points="10929.29,-4806.11 10932.79,-4816.11 10936.29,-4806.11 10929.29,-4806.11"/>
</g>
<!-- layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_10 -->
<g id="edge412" class="edge">
<title>layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_10</title>
<path fill="none" stroke="black" d="M15086.34,-5060.01C15086.34,-4973.21 15086.34,-4751 15086.34,-4751 15086.34,-4751 11891.79,-4751 11891.79,-4751 11891.79,-4751 11891.79,-4806.02 11891.79,-4806.02"/>
<polygon fill="black" stroke="black" points="11888.29,-4806.02 11891.79,-4816.02 11895.29,-4806.02 11888.29,-4806.02"/>
</g>
<!-- layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_11 -->
<g id="edge413" class="edge">
<title>layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_11</title>
<path fill="none" stroke="black" d="M15213.64,-5060.16C15213.64,-5022.19 15213.64,-4966 15213.64,-4966 15213.64,-4966 13078.43,-4966 13078.43,-4966 13078.43,-4966 13078.43,-4962.49 13078.43,-4962.49"/>
<polygon fill="black" stroke="black" points="13081.93,-4962.49 13078.43,-4952.49 13074.93,-4962.49 13081.93,-4962.49"/>
</g>
<!-- layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_12 -->
<g id="edge414" class="edge">
<title>layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_12</title>
<path fill="none" stroke="black" d="M15082.51,-5060.11C15082.51,-5039.04 15082.51,-5016 15082.51,-5016 15082.51,-5016 14034.14,-5016 14034.14,-5016 14034.14,-5016 14034.14,-4962.4 14034.14,-4962.4"/>
<polygon fill="black" stroke="black" points="14037.64,-4962.4 14034.14,-4952.4 14030.64,-4962.4 14037.64,-4962.4"/>
</g>
<!-- layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_13 -->
<g id="edge415" class="edge">
<title>layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_13</title>
<path fill="none" stroke="black" d="M15078.47,-5094C15070.53,-5094 15065.91,-5094 15065.91,-5094 15065.91,-5094 15065.91,-4894.32 15065.91,-4894.32"/>
<polygon fill="black" stroke="black" points="15069.41,-4894.32 15065.91,-4884.32 15062.41,-4894.32 15069.41,-4894.32"/>
</g>
<!-- layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_14 -->
<g id="edge416" class="edge">
<title>layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_14</title>
<path fill="none" stroke="black" d="M15413.04,-5059.96C15413.04,-5059.96 15413.04,-4962.33 15413.04,-4962.33"/>
<polygon fill="black" stroke="black" points="15416.54,-4962.33 15413.04,-4952.33 15409.54,-4962.33 15416.54,-4962.33"/>
</g>
<!-- layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_15 -->
<g id="edge417" class="edge">
<title>layer_2_attn_proj_4&#45;&gt;layer_2_recv_attn_15</title>
<path fill="none" stroke="black" d="M15452.92,-5060.04C15452.92,-5050.65 15452.92,-5043 15452.92,-5043 15452.92,-5043 16680.58,-5043 16680.58,-5043 16680.58,-5043 16680.58,-4962.45 16680.58,-4962.45"/>
<polygon fill="black" stroke="black" points="16684.08,-4962.45 16680.58,-4952.45 16677.08,-4962.45 16684.08,-4962.45"/>
</g>
<!-- layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_8 -->
<g id="edge418" class="edge">
<title>layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_8</title>
<path fill="none" stroke="black" d="M16004.71,-5094C16522.07,-5094 17744.18,-5094 17744.18,-5094 17744.18,-5094 17744.18,-4962.29 17744.18,-4962.29"/>
<polygon fill="black" stroke="black" points="17747.68,-4962.29 17744.18,-4952.29 17740.68,-4962.29 17747.68,-4962.29"/>
</g>
<!-- layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_9 -->
<g id="edge419" class="edge">
<title>layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_9</title>
<path fill="none" stroke="black" d="M15615.54,-5059.94C15615.54,-5025.67 15615.54,-4978 15615.54,-4978 15615.54,-4978 11031.18,-4978 11031.18,-4978 11031.18,-4978 11031.18,-4962.36 11031.18,-4962.36"/>
<polygon fill="black" stroke="black" points="11034.68,-4962.36 11031.18,-4952.36 11027.68,-4962.36 11034.68,-4962.36"/>
</g>
<!-- layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_10 -->
<g id="edge420" class="edge">
<title>layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_10</title>
<path fill="none" stroke="black" d="M15680.4,-5059.86C15680.4,-5023.41 15680.4,-4971 15680.4,-4971 15680.4,-4971 12094.77,-4971 12094.77,-4971 12094.77,-4971 12094.77,-4962.58 12094.77,-4962.58"/>
<polygon fill="black" stroke="black" points="12098.28,-4962.58 12094.77,-4952.58 12091.28,-4962.58 12098.28,-4962.58"/>
</g>
<!-- layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_11 -->
<g id="edge421" class="edge">
<title>layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_11</title>
<path fill="none" stroke="black" d="M15745.26,-5059.97C15745.26,-5021.4 15745.26,-4964 15745.26,-4964 15745.26,-4964 13118.4,-4964 13118.4,-4964 13118.4,-4964 13118.4,-4962.22 13118.4,-4962.22"/>
<polygon fill="black" stroke="black" points="13121.9,-4962.22 13118.4,-4952.22 13114.9,-4962.22 13121.9,-4962.22"/>
</g>
<!-- layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_12 -->
<g id="edge422" class="edge">
<title>layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_12</title>
<path fill="none" stroke="black" d="M15810.11,-5060.08C15810.11,-5034.54 15810.11,-5004 15810.11,-5004 15810.11,-5004 14075.41,-5004 14075.41,-5004 14075.41,-5004 14075.41,-4962.48 14075.41,-4962.48"/>
<polygon fill="black" stroke="black" points="14078.91,-4962.48 14075.41,-4952.48 14071.91,-4962.48 14078.91,-4962.48"/>
</g>
<!-- layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_13 -->
<g id="edge423" class="edge">
<title>layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_13</title>
<path fill="none" stroke="black" d="M15874.97,-5059.88C15874.97,-5018.38 15874.97,-4954 15874.97,-4954 15874.97,-4954 15071.14,-4954 15071.14,-4954 15071.14,-4954 15071.14,-4894.22 15071.14,-4894.22"/>
<polygon fill="black" stroke="black" points="15074.64,-4894.22 15071.14,-4884.22 15067.64,-4894.22 15074.64,-4894.22"/>
</g>
<!-- layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_14 -->
<g id="edge424" class="edge">
<title>layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_14</title>
<path fill="none" stroke="black" d="M15939.83,-5059.96C15939.83,-5059.96 15939.83,-4962.33 15939.83,-4962.33"/>
<polygon fill="black" stroke="black" points="15943.33,-4962.33 15939.83,-4952.33 15936.33,-4962.33 15943.33,-4962.33"/>
</g>
<!-- layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_15 -->
<g id="edge425" class="edge">
<title>layer_2_attn_proj_5&#45;&gt;layer_2_recv_attn_15</title>
<path fill="none" stroke="black" d="M16004.75,-5077C16330,-5077 16889.77,-5077 16889.77,-5077 16889.77,-5077 16889.77,-4962.42 16889.77,-4962.42"/>
<polygon fill="black" stroke="black" points="16893.28,-4962.42 16889.77,-4952.42 16886.28,-4962.42 16893.28,-4962.42"/>
</g>
<!-- layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_8 -->
<g id="edge426" class="edge">
<title>layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_8</title>
<path fill="none" stroke="black" d="M12635.83,-5059.91C12635.83,-5031.93 12635.83,-4997 12635.83,-4997 12635.83,-4997 17116.6,-4997 17116.6,-4997 17116.6,-4997 17116.6,-4900.23 17116.6,-4900.23"/>
<polygon fill="black" stroke="black" points="17120.1,-4900.23 17116.6,-4890.23 17113.1,-4900.23 17120.1,-4900.23"/>
</g>
<!-- layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_9 -->
<g id="edge427" class="edge">
<title>layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_9</title>
<path fill="none" stroke="black" d="M12246.23,-5094C11708.48,-5094 10403.6,-5094 10403.6,-5094 10403.6,-5094 10403.6,-4900.22 10403.6,-4900.22"/>
<polygon fill="black" stroke="black" points="10407.1,-4900.22 10403.6,-4890.22 10400.1,-4900.22 10407.1,-4900.22"/>
</g>
<!-- layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_10 -->
<g id="edge428" class="edge">
<title>layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_10</title>
<path fill="none" stroke="black" d="M12246.55,-5077C11949.7,-5077 11467.19,-5077 11467.19,-5077 11467.19,-5077 11467.19,-4962.42 11467.19,-4962.42"/>
<polygon fill="black" stroke="black" points="11470.69,-4962.42 11467.19,-4952.42 11463.69,-4962.42 11470.69,-4962.42"/>
</g>
<!-- layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_11 -->
<g id="edge429" class="edge">
<title>layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_11</title>
<path fill="none" stroke="black" d="M12311.54,-5059.96C12311.54,-5059.96 12311.54,-4894.25 12311.54,-4894.25"/>
<polygon fill="black" stroke="black" points="12315.04,-4894.25 12311.54,-4884.25 12308.04,-4894.25 12315.04,-4894.25"/>
</g>
<!-- layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_12 -->
<g id="edge430" class="edge">
<title>layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_12</title>
<path fill="none" stroke="black" d="M12376.4,-5060.01C12376.4,-5019.1 12376.4,-4956 12376.4,-4956 12376.4,-4956 13180.9,-4956 13180.9,-4956 13180.9,-4956 13180.9,-4894.22 13180.9,-4894.22"/>
<polygon fill="black" stroke="black" points="13184.4,-4894.22 13180.9,-4884.22 13177.4,-4894.22 13184.4,-4894.22"/>
</g>
<!-- layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_13 -->
<g id="edge431" class="edge">
<title>layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_13</title>
<path fill="none" stroke="black" d="M12441.26,-5059.93C12441.26,-5027.91 12441.26,-4985 12441.26,-4985 12441.26,-4985 14258.73,-4985 14258.73,-4985 14258.73,-4985 14258.73,-4914.09 14258.73,-4914.09"/>
<polygon fill="black" stroke="black" points="14262.23,-4914.09 14258.73,-4904.09 14255.23,-4914.09 14262.23,-4914.09"/>
</g>
<!-- layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_14 -->
<g id="edge432" class="edge">
<title>layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_14</title>
<path fill="none" stroke="black" d="M12506.11,-5060.06C12506.11,-5020.02 12506.11,-4959 12506.11,-4959 12506.11,-4959 15133.88,-4959 15133.88,-4959 15133.88,-4959 15133.88,-4894.22 15133.88,-4894.22"/>
<polygon fill="black" stroke="black" points="15137.38,-4894.22 15133.88,-4884.22 15130.38,-4894.22 15137.38,-4894.22"/>
</g>
<!-- layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_15 -->
<g id="edge433" class="edge">
<title>layer_2_attn_proj_6&#45;&gt;layer_2_recv_attn_15</title>
<path fill="none" stroke="black" d="M12570.97,-5060.06C12570.97,-5029.68 12570.97,-4990 12570.97,-4990 12570.97,-4990 16157.6,-4990 16157.6,-4990 16157.6,-4990 16157.6,-4900.16 16157.6,-4900.16"/>
<polygon fill="black" stroke="black" points="16161.1,-4900.16 16157.6,-4890.16 16154.1,-4900.16 16161.1,-4900.16"/>
</g>
<!-- layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_8 -->
<g id="edge434" class="edge">
<title>layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_8</title>
<path fill="none" stroke="black" d="M13161.95,-5059.99C13161.95,-4977.08 13161.95,-4772 13161.95,-4772 13161.95,-4772 17166.12,-4772 17166.12,-4772 17166.12,-4772 17166.12,-4806.01 17166.12,-4806.01"/>
<polygon fill="black" stroke="black" points="17162.62,-4806.01 17166.12,-4816.01 17169.62,-4806.01 17162.62,-4806.01"/>
</g>
<!-- layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_9 -->
<g id="edge435" class="edge">
<title>layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_9</title>
<path fill="none" stroke="black" d="M12758.66,-5059.8C12758.66,-5054.1 12758.66,-5050 12758.66,-5050 12758.66,-5050 10508.19,-5050 10508.19,-5050 10508.19,-5050 10508.19,-4962.57 10508.19,-4962.57"/>
<polygon fill="black" stroke="black" points="10511.69,-4962.57 10508.19,-4952.57 10504.69,-4962.57 10511.69,-4962.57"/>
</g>
<!-- layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_10 -->
<g id="edge436" class="edge">
<title>layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_10</title>
<path fill="none" stroke="black" d="M12798.63,-5059.99C12798.63,-5047.33 12798.63,-5036 12798.63,-5036 12798.63,-5036 11571.79,-5036 11571.79,-5036 11571.79,-5036 11571.79,-4962.53 11571.79,-4962.53"/>
<polygon fill="black" stroke="black" points="11575.29,-4962.53 11571.79,-4952.53 11568.29,-4962.53 11575.29,-4962.53"/>
</g>
<!-- layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_11 -->
<g id="edge437" class="edge">
<title>layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_11</title>
<path fill="none" stroke="black" d="M12838.6,-5059.96C12838.6,-5059.96 12838.6,-4962.33 12838.6,-4962.33"/>
<polygon fill="black" stroke="black" points="12842.1,-4962.33 12838.6,-4952.33 12835.1,-4962.33 12842.1,-4962.33"/>
</g>
<!-- layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_12 -->
<g id="edge438" class="edge">
<title>layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_12</title>
<path fill="none" stroke="black" d="M13172.88,-5094C13181.04,-5094 13185.79,-5094 13185.79,-5094 13185.79,-5094 13185.79,-4894.32 13185.79,-4894.32"/>
<polygon fill="black" stroke="black" points="13189.29,-4894.32 13185.79,-4884.32 13182.29,-4894.32 13189.29,-4894.32"/>
</g>
<!-- layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_13 -->
<g id="edge439" class="edge">
<title>layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_13</title>
<path fill="none" stroke="black" d="M13169.11,-5060.02C13169.11,-5036.32 13169.11,-5009 13169.11,-5009 13169.11,-5009 14341.22,-5009 14341.22,-5009 14341.22,-5009 14341.22,-4962.43 14341.22,-4962.43"/>
<polygon fill="black" stroke="black" points="14344.72,-4962.43 14341.22,-4952.43 14337.72,-4962.43 14344.72,-4962.43"/>
</g>
<!-- layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_14 -->
<g id="edge440" class="edge">
<title>layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_14</title>
<path fill="none" stroke="black" d="M12878.57,-5059.87C12878.57,-5020.42 12878.57,-4961 12878.57,-4961 12878.57,-4961 15173.76,-4961 15173.76,-4961 15173.76,-4961 15173.76,-4894.22 15173.76,-4894.22"/>
<polygon fill="black" stroke="black" points="15177.26,-4894.22 15173.76,-4884.22 15170.26,-4894.22 15177.26,-4894.22"/>
</g>
<!-- layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_15 -->
<g id="edge441" class="edge">
<title>layer_2_attn_proj_7&#45;&gt;layer_2_recv_attn_15</title>
<path fill="none" stroke="black" d="M13165.53,-5060.03C13165.53,-4981.35 13165.53,-4794 13165.53,-4794 13165.53,-4794 16207.12,-4794 16207.12,-4794 16207.12,-4794 16207.12,-4805.83 16207.12,-4805.83"/>
<polygon fill="black" stroke="black" points="16203.62,-4805.83 16207.12,-4815.83 16210.62,-4805.83 16203.62,-4805.83"/>
</g>
<!-- layer_2_recv_attn_8&#45;&gt;layer_2_residual1 -->
<g id="edge442" class="edge">
<title>layer_2_recv_attn_8&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M17320.25,-4816.11C17320.25,-4744.17 17320.25,-4641 17320.25,-4641 17320.25,-4641 13883.71,-4641 13883.71,-4641"/>
<polygon fill="black" stroke="black" points="13883.71,-4637.5 13873.71,-4641 13883.71,-4644.5 13883.71,-4637.5"/>
</g>
<!-- layer_2_recv_attn_9&#45;&gt;layer_2_residual1 -->
<g id="edge443" class="edge">
<title>layer_2_recv_attn_9&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M11086.58,-4843.47C11086.58,-4774.24 11086.58,-4641 11086.58,-4641 11086.58,-4641 13409.49,-4641 13409.49,-4641"/>
<polygon fill="black" stroke="black" points="13409.49,-4644.5 13419.49,-4641 13409.49,-4637.5 13409.49,-4644.5"/>
</g>
<!-- layer_2_recv_attn_10&#45;&gt;layer_2_residual1 -->
<g id="edge444" class="edge">
<title>layer_2_recv_attn_10&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M12045.58,-4843.47C12045.58,-4778.36 12045.58,-4658 12045.58,-4658 12045.58,-4658 13409.41,-4658 13409.41,-4658"/>
<polygon fill="black" stroke="black" points="13409.41,-4661.5 13419.41,-4658 13409.41,-4654.5 13409.41,-4661.5"/>
</g>
<!-- layer_2_recv_attn_11&#45;&gt;layer_2_residual1 -->
<g id="edge445" class="edge">
<title>layer_2_recv_attn_11&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M12927.69,-4816.06C12927.69,-4760.45 12927.69,-4691 12927.69,-4691 12927.69,-4691 13409.68,-4691 13409.68,-4691"/>
<polygon fill="black" stroke="black" points="13409.68,-4694.5 13419.68,-4691 13409.68,-4687.5 13409.68,-4694.5"/>
</g>
<!-- layer_2_recv_attn_12&#45;&gt;layer_2_residual1 -->
<g id="edge446" class="edge">
<title>layer_2_recv_attn_12&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M13646.69,-4815.94C13646.69,-4815.94 13646.69,-4718.38 13646.69,-4718.38"/>
<polygon fill="black" stroke="black" points="13650.19,-4718.38 13646.69,-4708.38 13643.19,-4718.38 13650.19,-4718.38"/>
</g>
<!-- layer_2_recv_attn_13&#45;&gt;layer_2_residual1 -->
<g id="edge447" class="edge">
<title>layer_2_recv_attn_13&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M14366.19,-4816.06C14366.19,-4760.45 14366.19,-4691 14366.19,-4691 14366.19,-4691 13883.85,-4691 13883.85,-4691"/>
<polygon fill="black" stroke="black" points="13883.85,-4687.5 13873.85,-4691 13883.85,-4694.5 13883.85,-4687.5"/>
</g>
<!-- layer_2_recv_attn_14&#45;&gt;layer_2_residual1 -->
<g id="edge448" class="edge">
<title>layer_2_recv_attn_14&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M15325.19,-4815.93C15325.19,-4754.56 15325.19,-4674 15325.19,-4674 15325.19,-4674 13883.93,-4674 13883.93,-4674"/>
<polygon fill="black" stroke="black" points="13883.93,-4670.5 13873.93,-4674 13883.93,-4677.5 13883.93,-4670.5"/>
</g>
<!-- layer_2_recv_attn_15&#45;&gt;layer_2_residual1 -->
<g id="edge449" class="edge">
<title>layer_2_recv_attn_15&#45;&gt;layer_2_residual1</title>
<path fill="none" stroke="black" d="M16361.25,-4816C16361.25,-4749.41 16361.25,-4658 16361.25,-4658 16361.25,-4658 13883.75,-4658 13883.75,-4658"/>
<polygon fill="black" stroke="black" points="13883.75,-4654.5 13873.75,-4658 13883.75,-4661.5 13883.75,-4654.5"/>
</g>
<!-- layer_2_ln2 -->
<g id="node230" class="node">
<title>layer_2_ln2</title>
<polygon fill="#ffe6e6" stroke="black" points="13873.69,-4517.17 13419.69,-4517.17 13419.69,-4449.17 13873.69,-4449.17 13873.69,-4517.17"/>
<text text-anchor="middle" x="13646.69" y="-4501.97" font-family="monospace" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="13646.69" y="-4486.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13646.69" y="-4471.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13646.69" y="-4456.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_residual1&#45;&gt;layer_2_ln2 -->
<g id="edge451" class="edge">
<title>layer_2_residual1&#45;&gt;layer_2_ln2</title>
<path fill="none" stroke="black" d="M13646.69,-4625.03C13646.69,-4625.03 13646.69,-4527.27 13646.69,-4527.27"/>
<polygon fill="black" stroke="black" points="13650.19,-4527.27 13646.69,-4517.27 13643.19,-4527.27 13650.19,-4527.27"/>
</g>
<!-- layer_2_gate -->
<g id="node231" class="node">
<title>layer_2_gate</title>
<polygon fill="#ffe6e6" stroke="black" points="14108.97,-4341.17 13373.58,-4341.17 13184.4,-4205.17 13919.79,-4205.17 14108.97,-4341.17"/>
<text text-anchor="middle" x="13646.69" y="-4291.97" font-family="monospace" font-size="14.00">Gate (Top&#45;2 routing)</text>
<text text-anchor="middle" x="13646.69" y="-4276.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13646.69" y="-4261.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, top_k=2]</text>
<text text-anchor="middle" x="13646.69" y="-4246.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_gate -->
<g id="edge452" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" d="M13646.69,-4448.96C13646.69,-4448.96 13646.69,-4351.33 13646.69,-4351.33"/>
<polygon fill="black" stroke="black" points="13650.19,-4351.33 13646.69,-4341.33 13643.19,-4351.33 13650.19,-4351.33"/>
</g>
<!-- layer_2_expert_select_8 -->
<g id="node248" class="node">
<title>layer_2_expert_select_8</title>
<polygon fill="#ffe6e6" stroke="black" points="10761.56,-4097.17 10012.51,-4097.17 9819.81,-3961.17 10568.87,-3961.17 10761.56,-4097.17"/>
<text text-anchor="middle" x="10290.69" y="-4047.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="10290.69" y="-4032.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10290.69" y="-4017.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10290.69" y="-4002.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_select_8 -->
<g id="edge453" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_select_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13326,-4307C12530.47,-4307 10530.19,-4307 10530.19,-4307 10530.19,-4307 10530.19,-4107.49 10530.19,-4107.49"/>
<polygon fill="black" stroke="black" points="10533.69,-4107.49 10530.19,-4097.49 10526.69,-4107.49 10533.69,-4107.49"/>
</g>
<!-- layer_2_expert_select_9 -->
<g id="node249" class="node">
<title>layer_2_expert_select_9</title>
<polygon fill="#ffe6e6" stroke="black" points="11720.56,-4097.17 10971.51,-4097.17 10778.81,-3961.17 11527.87,-3961.17 11720.56,-4097.17"/>
<text text-anchor="middle" x="11249.69" y="-4047.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="11249.69" y="-4032.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="11249.69" y="-4017.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11249.69" y="-4002.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_select_9 -->
<g id="edge454" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_select_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13278.56,-4273C12662.43,-4273 11489.19,-4273 11489.19,-4273 11489.19,-4273 11489.19,-4107.41 11489.19,-4107.41"/>
<polygon fill="black" stroke="black" points="11492.69,-4107.41 11489.19,-4097.41 11485.69,-4107.41 11492.69,-4107.41"/>
</g>
<!-- layer_2_expert_select_10 -->
<g id="node250" class="node">
<title>layer_2_expert_select_10</title>
<polygon fill="#ffe6e6" stroke="black" points="12679.56,-4097.17 11930.51,-4097.17 11737.81,-3961.17 12486.87,-3961.17 12679.56,-4097.17"/>
<text text-anchor="middle" x="12208.69" y="-4047.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="12208.69" y="-4032.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="12208.69" y="-4017.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12208.69" y="-4002.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_select_10 -->
<g id="edge455" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_select_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13231.29,-4239C12885.07,-4239 12448.19,-4239 12448.19,-4239 12448.19,-4239 12448.19,-4107.29 12448.19,-4107.29"/>
<polygon fill="black" stroke="black" points="12451.69,-4107.29 12448.19,-4097.29 12444.69,-4107.29 12451.69,-4107.29"/>
</g>
<!-- layer_2_expert_select_11 -->
<g id="node251" class="node">
<title>layer_2_expert_select_11</title>
<polygon fill="#ffe6e6" stroke="black" points="13638.56,-4097.17 12889.51,-4097.17 12696.81,-3961.17 13445.87,-3961.17 13638.56,-4097.17"/>
<text text-anchor="middle" x="13167.69" y="-4047.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="13167.69" y="-4032.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="13167.69" y="-4017.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13167.69" y="-4002.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_select_11 -->
<g id="edge456" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_select_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13411.33,-4204.87C13411.33,-4204.87 13411.33,-4107.44 13411.33,-4107.44"/>
<polygon fill="black" stroke="black" points="13414.83,-4107.44 13411.33,-4097.44 13407.83,-4107.44 13414.83,-4107.44"/>
</g>
<!-- layer_2_expert_select_12 -->
<g id="node252" class="node">
<title>layer_2_expert_select_12</title>
<polygon fill="#ffe6e6" stroke="black" points="14597.56,-4097.17 13848.51,-4097.17 13655.81,-3961.17 14404.87,-3961.17 14597.56,-4097.17"/>
<text text-anchor="middle" x="14126.69" y="-4047.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="14126.69" y="-4032.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="14126.69" y="-4017.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14126.69" y="-4002.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_select_12 -->
<g id="edge457" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_select_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13882.54,-4204.87C13882.54,-4204.87 13882.54,-4107.44 13882.54,-4107.44"/>
<polygon fill="black" stroke="black" points="13886.04,-4107.44 13882.54,-4097.44 13879.04,-4107.44 13886.04,-4107.44"/>
</g>
<!-- layer_2_expert_select_13 -->
<g id="node253" class="node">
<title>layer_2_expert_select_13</title>
<polygon fill="#ffe6e6" stroke="black" points="15556.56,-4097.17 14807.51,-4097.17 14614.81,-3961.17 15363.87,-3961.17 15556.56,-4097.17"/>
<text text-anchor="middle" x="15085.69" y="-4047.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="15085.69" y="-4032.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="15085.69" y="-4017.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15085.69" y="-4002.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_select_13 -->
<g id="edge458" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_select_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13967.21,-4239C14322.38,-4239 14845.69,-4239 14845.69,-4239 14845.69,-4239 14845.69,-4107.29 14845.69,-4107.29"/>
<polygon fill="black" stroke="black" points="14849.19,-4107.29 14845.69,-4097.29 14842.19,-4107.29 14849.19,-4107.29"/>
</g>
<!-- layer_2_expert_select_14 -->
<g id="node254" class="node">
<title>layer_2_expert_select_14</title>
<polygon fill="#ffe6e6" stroke="black" points="16515.56,-4097.17 15766.51,-4097.17 15573.81,-3961.17 16322.87,-3961.17 16515.56,-4097.17"/>
<text text-anchor="middle" x="16044.69" y="-4047.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="16044.69" y="-4032.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="16044.69" y="-4017.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16044.69" y="-4002.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_select_14 -->
<g id="edge459" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_select_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14014.29,-4273C14630.39,-4273 15804.69,-4273 15804.69,-4273 15804.69,-4273 15804.69,-4107.41 15804.69,-4107.41"/>
<polygon fill="black" stroke="black" points="15808.19,-4107.41 15804.69,-4097.41 15801.19,-4107.41 15808.19,-4107.41"/>
</g>
<!-- layer_2_expert_select_15 -->
<g id="node255" class="node">
<title>layer_2_expert_select_15</title>
<polygon fill="#ffe6e6" stroke="black" points="17474.56,-4097.17 16725.51,-4097.17 16532.81,-3961.17 17281.87,-3961.17 17474.56,-4097.17"/>
<text text-anchor="middle" x="17003.69" y="-4047.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="17003.69" y="-4032.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="17003.69" y="-4017.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17003.69" y="-4002.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_select_15 -->
<g id="edge460" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_select_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14061.81,-4307C14910.25,-4307 16763.69,-4307 16763.69,-4307 16763.69,-4307 16763.69,-4107.49 16763.69,-4107.49"/>
<polygon fill="black" stroke="black" points="16767.19,-4107.49 16763.69,-4097.49 16760.19,-4107.49 16767.19,-4107.49"/>
</g>
<!-- layer_2_expert_0_gpu_8 -->
<g id="node232" class="node">
<title>layer_2_expert_0_gpu_8</title>
<polygon fill="#ffe6e6" stroke="black" points="10334.69,-3853.17 9880.69,-3853.17 9880.69,-3785.17 10334.69,-3785.17 10334.69,-3853.17"/>
<text text-anchor="middle" x="10107.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="10107.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10107.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10107.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_8 -->
<g id="node256" class="node">
<title>layer_2_expert_agg_8</title>
<polygon fill="#fff0e6" stroke="black" points="10761.56,-3677.17 10012.51,-3677.17 9819.81,-3541.17 10568.87,-3541.17 10761.56,-3677.17"/>
<text text-anchor="middle" x="10290.69" y="-3627.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10290.69" y="-3612.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10290.69" y="-3597.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10290.69" y="-3582.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_0_gpu_8&#45;&gt;layer_2_expert_agg_8 -->
<g id="edge477" class="edge">
<title>layer_2_expert_0_gpu_8&#45;&gt;layer_2_expert_agg_8</title>
<path fill="none" stroke="black" d="M10107.69,-3784.96C10107.69,-3784.96 10107.69,-3687.33 10107.69,-3687.33"/>
<polygon fill="black" stroke="black" points="10111.19,-3687.33 10107.69,-3677.33 10104.19,-3687.33 10111.19,-3687.33"/>
</g>
<!-- layer_2_expert_1_gpu_8 -->
<g id="node233" class="node">
<title>layer_2_expert_1_gpu_8</title>
<polygon fill="#ffe6e6" stroke="black" points="10806.69,-3853.17 10352.69,-3853.17 10352.69,-3785.17 10806.69,-3785.17 10806.69,-3853.17"/>
<text text-anchor="middle" x="10579.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="10579.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10579.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10579.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_1_gpu_8&#45;&gt;layer_2_expert_agg_8 -->
<g id="edge478" class="edge">
<title>layer_2_expert_1_gpu_8&#45;&gt;layer_2_expert_agg_8</title>
<path fill="none" stroke="black" d="M10557.03,-3784.96C10557.03,-3784.96 10557.03,-3687.33 10557.03,-3687.33"/>
<polygon fill="black" stroke="black" points="10560.53,-3687.33 10557.03,-3677.33 10553.53,-3687.33 10560.53,-3687.33"/>
</g>
<!-- layer_2_expert_2_gpu_9 -->
<g id="node234" class="node">
<title>layer_2_expert_2_gpu_9</title>
<polygon fill="#ffe6e6" stroke="black" points="11377.69,-3853.17 10923.69,-3853.17 10923.69,-3785.17 11377.69,-3785.17 11377.69,-3853.17"/>
<text text-anchor="middle" x="11150.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11150.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="11150.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11150.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_9 -->
<g id="node257" class="node">
<title>layer_2_expert_agg_9</title>
<polygon fill="#fff0e6" stroke="black" points="11720.56,-3677.17 10971.51,-3677.17 10778.81,-3541.17 11527.87,-3541.17 11720.56,-3677.17"/>
<text text-anchor="middle" x="11249.69" y="-3627.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11249.69" y="-3612.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="11249.69" y="-3597.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11249.69" y="-3582.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_2_gpu_9&#45;&gt;layer_2_expert_agg_9 -->
<g id="edge479" class="edge">
<title>layer_2_expert_2_gpu_9&#45;&gt;layer_2_expert_agg_9</title>
<path fill="none" stroke="black" d="M11150.69,-3784.96C11150.69,-3784.96 11150.69,-3687.33 11150.69,-3687.33"/>
<polygon fill="black" stroke="black" points="11154.19,-3687.33 11150.69,-3677.33 11147.19,-3687.33 11154.19,-3687.33"/>
</g>
<!-- layer_2_expert_3_gpu_9 -->
<g id="node235" class="node">
<title>layer_2_expert_3_gpu_9</title>
<polygon fill="#ffe6e6" stroke="black" points="11849.69,-3853.17 11395.69,-3853.17 11395.69,-3785.17 11849.69,-3785.17 11849.69,-3853.17"/>
<text text-anchor="middle" x="11622.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="11622.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="11622.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11622.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_3_gpu_9&#45;&gt;layer_2_expert_agg_9 -->
<g id="edge480" class="edge">
<title>layer_2_expert_3_gpu_9&#45;&gt;layer_2_expert_agg_9</title>
<path fill="none" stroke="black" d="M11558.03,-3784.96C11558.03,-3784.96 11558.03,-3687.33 11558.03,-3687.33"/>
<polygon fill="black" stroke="black" points="11561.53,-3687.33 11558.03,-3677.33 11554.53,-3687.33 11561.53,-3687.33"/>
</g>
<!-- layer_2_expert_4_gpu_10 -->
<g id="node236" class="node">
<title>layer_2_expert_4_gpu_10</title>
<polygon fill="#ffe6e6" stroke="black" points="12378.69,-3853.17 11924.69,-3853.17 11924.69,-3785.17 12378.69,-3785.17 12378.69,-3853.17"/>
<text text-anchor="middle" x="12151.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="12151.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="12151.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12151.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_10 -->
<g id="node258" class="node">
<title>layer_2_expert_agg_10</title>
<polygon fill="#fff0e6" stroke="black" points="12679.56,-3677.17 11930.51,-3677.17 11737.81,-3541.17 12486.87,-3541.17 12679.56,-3677.17"/>
<text text-anchor="middle" x="12208.69" y="-3627.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12208.69" y="-3612.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="12208.69" y="-3597.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12208.69" y="-3582.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_4_gpu_10&#45;&gt;layer_2_expert_agg_10 -->
<g id="edge481" class="edge">
<title>layer_2_expert_4_gpu_10&#45;&gt;layer_2_expert_agg_10</title>
<path fill="none" stroke="black" d="M12151.69,-3784.96C12151.69,-3784.96 12151.69,-3687.33 12151.69,-3687.33"/>
<polygon fill="black" stroke="black" points="12155.19,-3687.33 12151.69,-3677.33 12148.19,-3687.33 12155.19,-3687.33"/>
</g>
<!-- layer_2_expert_5_gpu_10 -->
<g id="node237" class="node">
<title>layer_2_expert_5_gpu_10</title>
<polygon fill="#ffe6e6" stroke="black" points="12850.69,-3853.17 12396.69,-3853.17 12396.69,-3785.17 12850.69,-3785.17 12850.69,-3853.17"/>
<text text-anchor="middle" x="12623.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="12623.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="12623.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12623.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_5_gpu_10&#45;&gt;layer_2_expert_agg_10 -->
<g id="edge482" class="edge">
<title>layer_2_expert_5_gpu_10&#45;&gt;layer_2_expert_agg_10</title>
<path fill="none" stroke="black" d="M12538.03,-3784.96C12538.03,-3784.96 12538.03,-3687.33 12538.03,-3687.33"/>
<polygon fill="black" stroke="black" points="12541.53,-3687.33 12538.03,-3677.33 12534.53,-3687.33 12541.53,-3687.33"/>
</g>
<!-- layer_2_expert_6_gpu_11 -->
<g id="node238" class="node">
<title>layer_2_expert_6_gpu_11</title>
<polygon fill="#ffe6e6" stroke="black" points="13358.69,-3853.17 12904.69,-3853.17 12904.69,-3785.17 13358.69,-3785.17 13358.69,-3853.17"/>
<text text-anchor="middle" x="13131.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="13131.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="13131.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13131.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_11 -->
<g id="node259" class="node">
<title>layer_2_expert_agg_11</title>
<polygon fill="#fff0e6" stroke="black" points="13638.56,-3677.17 12889.51,-3677.17 12696.81,-3541.17 13445.87,-3541.17 13638.56,-3677.17"/>
<text text-anchor="middle" x="13167.69" y="-3627.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13167.69" y="-3612.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="13167.69" y="-3597.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13167.69" y="-3582.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_6_gpu_11&#45;&gt;layer_2_expert_agg_11 -->
<g id="edge483" class="edge">
<title>layer_2_expert_6_gpu_11&#45;&gt;layer_2_expert_agg_11</title>
<path fill="none" stroke="black" d="M13131.69,-3784.96C13131.69,-3784.96 13131.69,-3687.33 13131.69,-3687.33"/>
<polygon fill="black" stroke="black" points="13135.19,-3687.33 13131.69,-3677.33 13128.19,-3687.33 13135.19,-3687.33"/>
</g>
<!-- layer_2_expert_7_gpu_11 -->
<g id="node239" class="node">
<title>layer_2_expert_7_gpu_11</title>
<polygon fill="#ffe6e6" stroke="black" points="13830.69,-3853.17 13376.69,-3853.17 13376.69,-3785.17 13830.69,-3785.17 13830.69,-3853.17"/>
<text text-anchor="middle" x="13603.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="13603.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="13603.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13603.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_7_gpu_11&#45;&gt;layer_2_expert_agg_11 -->
<g id="edge484" class="edge">
<title>layer_2_expert_7_gpu_11&#45;&gt;layer_2_expert_agg_11</title>
<path fill="none" stroke="black" d="M13507.53,-3784.96C13507.53,-3784.96 13507.53,-3687.33 13507.53,-3687.33"/>
<polygon fill="black" stroke="black" points="13511.03,-3687.33 13507.53,-3677.33 13504.03,-3687.33 13511.03,-3687.33"/>
</g>
<!-- layer_2_expert_8_gpu_12 -->
<g id="node240" class="node">
<title>layer_2_expert_8_gpu_12</title>
<polygon fill="#ffe6e6" stroke="black" points="14327.69,-3853.17 13873.69,-3853.17 13873.69,-3785.17 14327.69,-3785.17 14327.69,-3853.17"/>
<text text-anchor="middle" x="14100.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="14100.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="14100.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14100.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_12 -->
<g id="node260" class="node">
<title>layer_2_expert_agg_12</title>
<polygon fill="#fff0e6" stroke="black" points="14597.56,-3677.17 13848.51,-3677.17 13655.81,-3541.17 14404.87,-3541.17 14597.56,-3677.17"/>
<text text-anchor="middle" x="14126.69" y="-3627.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14126.69" y="-3612.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="14126.69" y="-3597.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14126.69" y="-3582.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_8_gpu_12&#45;&gt;layer_2_expert_agg_12 -->
<g id="edge485" class="edge">
<title>layer_2_expert_8_gpu_12&#45;&gt;layer_2_expert_agg_12</title>
<path fill="none" stroke="black" d="M14100.69,-3784.96C14100.69,-3784.96 14100.69,-3687.33 14100.69,-3687.33"/>
<polygon fill="black" stroke="black" points="14104.19,-3687.33 14100.69,-3677.33 14097.19,-3687.33 14104.19,-3687.33"/>
</g>
<!-- layer_2_expert_9_gpu_12 -->
<g id="node241" class="node">
<title>layer_2_expert_9_gpu_12</title>
<polygon fill="#ffe6e6" stroke="black" points="14799.69,-3853.17 14345.69,-3853.17 14345.69,-3785.17 14799.69,-3785.17 14799.69,-3853.17"/>
<text text-anchor="middle" x="14572.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="14572.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="14572.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14572.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_9_gpu_12&#45;&gt;layer_2_expert_agg_12 -->
<g id="edge486" class="edge">
<title>layer_2_expert_9_gpu_12&#45;&gt;layer_2_expert_agg_12</title>
<path fill="none" stroke="black" d="M14471.53,-3784.96C14471.53,-3784.96 14471.53,-3687.33 14471.53,-3687.33"/>
<polygon fill="black" stroke="black" points="14475.03,-3687.33 14471.53,-3677.33 14468.03,-3687.33 14475.03,-3687.33"/>
</g>
<!-- layer_2_expert_10_gpu_13 -->
<g id="node242" class="node">
<title>layer_2_expert_10_gpu_13</title>
<polygon fill="#ffe6e6" stroke="black" points="15291.69,-3853.17 14837.69,-3853.17 14837.69,-3785.17 15291.69,-3785.17 15291.69,-3853.17"/>
<text text-anchor="middle" x="15064.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="15064.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="15064.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15064.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_13 -->
<g id="node261" class="node">
<title>layer_2_expert_agg_13</title>
<polygon fill="#fff0e6" stroke="black" points="15556.56,-3677.17 14807.51,-3677.17 14614.81,-3541.17 15363.87,-3541.17 15556.56,-3677.17"/>
<text text-anchor="middle" x="15085.69" y="-3627.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15085.69" y="-3612.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="15085.69" y="-3597.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15085.69" y="-3582.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_10_gpu_13&#45;&gt;layer_2_expert_agg_13 -->
<g id="edge487" class="edge">
<title>layer_2_expert_10_gpu_13&#45;&gt;layer_2_expert_agg_13</title>
<path fill="none" stroke="black" d="M15064.69,-3784.96C15064.69,-3784.96 15064.69,-3687.33 15064.69,-3687.33"/>
<polygon fill="black" stroke="black" points="15068.19,-3687.33 15064.69,-3677.33 15061.19,-3687.33 15068.19,-3687.33"/>
</g>
<!-- layer_2_expert_11_gpu_13 -->
<g id="node243" class="node">
<title>layer_2_expert_11_gpu_13</title>
<polygon fill="#ffe6e6" stroke="black" points="15763.69,-3853.17 15309.69,-3853.17 15309.69,-3785.17 15763.69,-3785.17 15763.69,-3853.17"/>
<text text-anchor="middle" x="15536.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="15536.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="15536.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15536.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_11_gpu_13&#45;&gt;layer_2_expert_agg_13 -->
<g id="edge488" class="edge">
<title>layer_2_expert_11_gpu_13&#45;&gt;layer_2_expert_agg_13</title>
<path fill="none" stroke="black" d="M15433.03,-3784.96C15433.03,-3784.96 15433.03,-3687.33 15433.03,-3687.33"/>
<polygon fill="black" stroke="black" points="15436.53,-3687.33 15433.03,-3677.33 15429.53,-3687.33 15436.53,-3687.33"/>
</g>
<!-- layer_2_expert_12_gpu_14 -->
<g id="node244" class="node">
<title>layer_2_expert_12_gpu_14</title>
<polygon fill="#ffe6e6" stroke="black" points="16253.69,-3853.17 15799.69,-3853.17 15799.69,-3785.17 16253.69,-3785.17 16253.69,-3853.17"/>
<text text-anchor="middle" x="16026.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="16026.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="16026.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16026.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_14 -->
<g id="node262" class="node">
<title>layer_2_expert_agg_14</title>
<polygon fill="#fff0e6" stroke="black" points="16515.56,-3677.17 15766.51,-3677.17 15573.81,-3541.17 16322.87,-3541.17 16515.56,-3677.17"/>
<text text-anchor="middle" x="16044.69" y="-3627.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16044.69" y="-3612.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="16044.69" y="-3597.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16044.69" y="-3582.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_12_gpu_14&#45;&gt;layer_2_expert_agg_14 -->
<g id="edge489" class="edge">
<title>layer_2_expert_12_gpu_14&#45;&gt;layer_2_expert_agg_14</title>
<path fill="none" stroke="black" d="M16026.69,-3784.96C16026.69,-3784.96 16026.69,-3687.33 16026.69,-3687.33"/>
<polygon fill="black" stroke="black" points="16030.19,-3687.33 16026.69,-3677.33 16023.19,-3687.33 16030.19,-3687.33"/>
</g>
<!-- layer_2_expert_13_gpu_14 -->
<g id="node245" class="node">
<title>layer_2_expert_13_gpu_14</title>
<polygon fill="#ffe6e6" stroke="black" points="16725.69,-3853.17 16271.69,-3853.17 16271.69,-3785.17 16725.69,-3785.17 16725.69,-3853.17"/>
<text text-anchor="middle" x="16498.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="16498.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="16498.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16498.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_13_gpu_14&#45;&gt;layer_2_expert_agg_14 -->
<g id="edge490" class="edge">
<title>layer_2_expert_13_gpu_14&#45;&gt;layer_2_expert_agg_14</title>
<path fill="none" stroke="black" d="M16393.53,-3784.96C16393.53,-3784.96 16393.53,-3687.33 16393.53,-3687.33"/>
<polygon fill="black" stroke="black" points="16397.03,-3687.33 16393.53,-3677.33 16390.03,-3687.33 16397.03,-3687.33"/>
</g>
<!-- layer_2_expert_14_gpu_15 -->
<g id="node246" class="node">
<title>layer_2_expert_14_gpu_15</title>
<polygon fill="#ffe6e6" stroke="black" points="17213.69,-3853.17 16759.69,-3853.17 16759.69,-3785.17 17213.69,-3785.17 17213.69,-3853.17"/>
<text text-anchor="middle" x="16986.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="16986.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="16986.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16986.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_15 -->
<g id="node263" class="node">
<title>layer_2_expert_agg_15</title>
<polygon fill="#fff0e6" stroke="black" points="17474.56,-3677.17 16725.51,-3677.17 16532.81,-3541.17 17281.87,-3541.17 17474.56,-3677.17"/>
<text text-anchor="middle" x="17003.69" y="-3627.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="17003.69" y="-3612.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="17003.69" y="-3597.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17003.69" y="-3582.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_14_gpu_15&#45;&gt;layer_2_expert_agg_15 -->
<g id="edge491" class="edge">
<title>layer_2_expert_14_gpu_15&#45;&gt;layer_2_expert_agg_15</title>
<path fill="none" stroke="black" d="M16986.69,-3784.96C16986.69,-3784.96 16986.69,-3687.33 16986.69,-3687.33"/>
<polygon fill="black" stroke="black" points="16990.19,-3687.33 16986.69,-3677.33 16983.19,-3687.33 16990.19,-3687.33"/>
</g>
<!-- layer_2_expert_15_gpu_15 -->
<g id="node247" class="node">
<title>layer_2_expert_15_gpu_15</title>
<polygon fill="#ffe6e6" stroke="black" points="17685.69,-3853.17 17231.69,-3853.17 17231.69,-3785.17 17685.69,-3785.17 17685.69,-3853.17"/>
<text text-anchor="middle" x="17458.69" y="-3837.97" font-family="monospace" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="17458.69" y="-3822.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="17458.69" y="-3807.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17458.69" y="-3792.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_15_gpu_15&#45;&gt;layer_2_expert_agg_15 -->
<g id="edge492" class="edge">
<title>layer_2_expert_15_gpu_15&#45;&gt;layer_2_expert_agg_15</title>
<path fill="none" stroke="black" d="M17353.03,-3784.96C17353.03,-3784.96 17353.03,-3687.33 17353.03,-3687.33"/>
<polygon fill="black" stroke="black" points="17356.53,-3687.33 17353.03,-3677.33 17349.53,-3687.33 17356.53,-3687.33"/>
</g>
<!-- layer_2_expert_select_8&#45;&gt;layer_2_expert_0_gpu_8 -->
<g id="edge461" class="edge">
<title>layer_2_expert_select_8&#45;&gt;layer_2_expert_0_gpu_8</title>
<path fill="none" stroke="black" d="M10107.69,-3960.99C10107.69,-3960.99 10107.69,-3863.2 10107.69,-3863.2"/>
<polygon fill="black" stroke="black" points="10111.19,-3863.2 10107.69,-3853.2 10104.19,-3863.2 10111.19,-3863.2"/>
</g>
<!-- layer_2_expert_select_8&#45;&gt;layer_2_expert_1_gpu_8 -->
<g id="edge462" class="edge">
<title>layer_2_expert_select_8&#45;&gt;layer_2_expert_1_gpu_8</title>
<path fill="none" stroke="black" d="M10557.03,-3960.99C10557.03,-3960.99 10557.03,-3863.2 10557.03,-3863.2"/>
<polygon fill="black" stroke="black" points="10560.53,-3863.2 10557.03,-3853.2 10553.53,-3863.2 10560.53,-3863.2"/>
</g>
<!-- layer_2_expert_select_9&#45;&gt;layer_2_expert_2_gpu_9 -->
<g id="edge463" class="edge">
<title>layer_2_expert_select_9&#45;&gt;layer_2_expert_2_gpu_9</title>
<path fill="none" stroke="black" d="M11150.69,-3960.99C11150.69,-3960.99 11150.69,-3863.2 11150.69,-3863.2"/>
<polygon fill="black" stroke="black" points="11154.19,-3863.2 11150.69,-3853.2 11147.19,-3863.2 11154.19,-3863.2"/>
</g>
<!-- layer_2_expert_select_9&#45;&gt;layer_2_expert_3_gpu_9 -->
<g id="edge464" class="edge">
<title>layer_2_expert_select_9&#45;&gt;layer_2_expert_3_gpu_9</title>
<path fill="none" stroke="black" d="M11558.03,-3982.3C11558.03,-3982.3 11558.03,-3863.48 11558.03,-3863.48"/>
<polygon fill="black" stroke="black" points="11561.53,-3863.48 11558.03,-3853.48 11554.53,-3863.48 11561.53,-3863.48"/>
</g>
<!-- layer_2_expert_select_10&#45;&gt;layer_2_expert_4_gpu_10 -->
<g id="edge465" class="edge">
<title>layer_2_expert_select_10&#45;&gt;layer_2_expert_4_gpu_10</title>
<path fill="none" stroke="black" d="M12151.69,-3960.99C12151.69,-3960.99 12151.69,-3863.2 12151.69,-3863.2"/>
<polygon fill="black" stroke="black" points="12155.19,-3863.2 12151.69,-3853.2 12148.19,-3863.2 12155.19,-3863.2"/>
</g>
<!-- layer_2_expert_select_10&#45;&gt;layer_2_expert_5_gpu_10 -->
<g id="edge466" class="edge">
<title>layer_2_expert_select_10&#45;&gt;layer_2_expert_5_gpu_10</title>
<path fill="none" stroke="black" d="M12538.03,-3997.27C12538.03,-3997.27 12538.03,-3863.46 12538.03,-3863.46"/>
<polygon fill="black" stroke="black" points="12541.53,-3863.46 12538.03,-3853.46 12534.53,-3863.46 12541.53,-3863.46"/>
</g>
<!-- layer_2_expert_select_11&#45;&gt;layer_2_expert_6_gpu_11 -->
<g id="edge467" class="edge">
<title>layer_2_expert_select_11&#45;&gt;layer_2_expert_6_gpu_11</title>
<path fill="none" stroke="black" d="M13131.69,-3960.99C13131.69,-3960.99 13131.69,-3863.2 13131.69,-3863.2"/>
<polygon fill="black" stroke="black" points="13135.19,-3863.2 13131.69,-3853.2 13128.19,-3863.2 13135.19,-3863.2"/>
</g>
<!-- layer_2_expert_select_11&#45;&gt;layer_2_expert_7_gpu_11 -->
<g id="edge468" class="edge">
<title>layer_2_expert_select_11&#45;&gt;layer_2_expert_7_gpu_11</title>
<path fill="none" stroke="black" d="M13507.53,-4004.67C13507.53,-4004.67 13507.53,-3863.21 13507.53,-3863.21"/>
<polygon fill="black" stroke="black" points="13511.03,-3863.21 13507.53,-3853.21 13504.03,-3863.21 13511.03,-3863.21"/>
</g>
<!-- layer_2_expert_select_12&#45;&gt;layer_2_expert_8_gpu_12 -->
<g id="edge469" class="edge">
<title>layer_2_expert_select_12&#45;&gt;layer_2_expert_8_gpu_12</title>
<path fill="none" stroke="black" d="M14100.69,-3960.99C14100.69,-3960.99 14100.69,-3863.2 14100.69,-3863.2"/>
<polygon fill="black" stroke="black" points="14104.19,-3863.2 14100.69,-3853.2 14097.19,-3863.2 14104.19,-3863.2"/>
</g>
<!-- layer_2_expert_select_12&#45;&gt;layer_2_expert_9_gpu_12 -->
<g id="edge470" class="edge">
<title>layer_2_expert_select_12&#45;&gt;layer_2_expert_9_gpu_12</title>
<path fill="none" stroke="black" d="M14471.53,-4007.87C14471.53,-4007.87 14471.53,-3863.3 14471.53,-3863.3"/>
<polygon fill="black" stroke="black" points="14475.03,-3863.3 14471.53,-3853.3 14468.03,-3863.3 14475.03,-3863.3"/>
</g>
<!-- layer_2_expert_select_13&#45;&gt;layer_2_expert_10_gpu_13 -->
<g id="edge471" class="edge">
<title>layer_2_expert_select_13&#45;&gt;layer_2_expert_10_gpu_13</title>
<path fill="none" stroke="black" d="M15064.69,-3960.99C15064.69,-3960.99 15064.69,-3863.2 15064.69,-3863.2"/>
<polygon fill="black" stroke="black" points="15068.19,-3863.2 15064.69,-3853.2 15061.19,-3863.2 15068.19,-3863.2"/>
</g>
<!-- layer_2_expert_select_13&#45;&gt;layer_2_expert_11_gpu_13 -->
<g id="edge472" class="edge">
<title>layer_2_expert_select_13&#45;&gt;layer_2_expert_11_gpu_13</title>
<path fill="none" stroke="black" d="M15433.03,-4009.79C15433.03,-4009.79 15433.03,-3863.29 15433.03,-3863.29"/>
<polygon fill="black" stroke="black" points="15436.53,-3863.29 15433.03,-3853.29 15429.53,-3863.29 15436.53,-3863.29"/>
</g>
<!-- layer_2_expert_select_14&#45;&gt;layer_2_expert_12_gpu_14 -->
<g id="edge473" class="edge">
<title>layer_2_expert_select_14&#45;&gt;layer_2_expert_12_gpu_14</title>
<path fill="none" stroke="black" d="M16026.69,-3960.99C16026.69,-3960.99 16026.69,-3863.2 16026.69,-3863.2"/>
<polygon fill="black" stroke="black" points="16030.19,-3863.2 16026.69,-3853.2 16023.19,-3863.2 16030.19,-3863.2"/>
</g>
<!-- layer_2_expert_select_14&#45;&gt;layer_2_expert_13_gpu_14 -->
<g id="edge474" class="edge">
<title>layer_2_expert_select_14&#45;&gt;layer_2_expert_13_gpu_14</title>
<path fill="none" stroke="black" d="M16393.53,-4010.9C16393.53,-4010.9 16393.53,-3863.34 16393.53,-3863.34"/>
<polygon fill="black" stroke="black" points="16397.03,-3863.34 16393.53,-3853.34 16390.03,-3863.34 16397.03,-3863.34"/>
</g>
<!-- layer_2_expert_select_15&#45;&gt;layer_2_expert_14_gpu_15 -->
<g id="edge475" class="edge">
<title>layer_2_expert_select_15&#45;&gt;layer_2_expert_14_gpu_15</title>
<path fill="none" stroke="black" d="M16986.69,-3960.99C16986.69,-3960.99 16986.69,-3863.2 16986.69,-3863.2"/>
<polygon fill="black" stroke="black" points="16990.19,-3863.2 16986.69,-3853.2 16983.19,-3863.2 16990.19,-3863.2"/>
</g>
<!-- layer_2_expert_select_15&#45;&gt;layer_2_expert_15_gpu_15 -->
<g id="edge476" class="edge">
<title>layer_2_expert_select_15&#45;&gt;layer_2_expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M17353.03,-4011.26C17353.03,-4011.26 17353.03,-3863.49 17353.03,-3863.49"/>
<polygon fill="black" stroke="black" points="17356.53,-3863.49 17353.03,-3853.49 17349.53,-3863.49 17356.53,-3863.49"/>
</g>
<!-- layer_2_expert_broadcast_8 -->
<g id="node272" class="node">
<title>layer_2_expert_broadcast_8</title>
<polygon fill="#e6ffe6" stroke="black" points="10761.56,-3433.17 10012.51,-3433.17 9819.81,-3297.17 10568.87,-3297.17 10761.56,-3433.17"/>
<text text-anchor="middle" x="10290.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="10290.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="10290.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10290.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_8&#45;&gt;layer_2_expert_broadcast_8 -->
<g id="edge493" class="edge">
<title>layer_2_expert_agg_8&#45;&gt;layer_2_expert_broadcast_8</title>
<path fill="none" stroke="black" d="M10290.69,-3540.87C10290.69,-3540.87 10290.69,-3443.44 10290.69,-3443.44"/>
<polygon fill="black" stroke="black" points="10294.19,-3443.44 10290.69,-3433.44 10287.19,-3443.44 10294.19,-3443.44"/>
</g>
<!-- layer_2_expert_broadcast_9 -->
<g id="node273" class="node">
<title>layer_2_expert_broadcast_9</title>
<polygon fill="#e6ffe6" stroke="black" points="11720.56,-3433.17 10971.51,-3433.17 10778.81,-3297.17 11527.87,-3297.17 11720.56,-3433.17"/>
<text text-anchor="middle" x="11249.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="11249.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="11249.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11249.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_9&#45;&gt;layer_2_expert_broadcast_9 -->
<g id="edge494" class="edge">
<title>layer_2_expert_agg_9&#45;&gt;layer_2_expert_broadcast_9</title>
<path fill="none" stroke="black" d="M11249.69,-3540.87C11249.69,-3540.87 11249.69,-3443.44 11249.69,-3443.44"/>
<polygon fill="black" stroke="black" points="11253.19,-3443.44 11249.69,-3433.44 11246.19,-3443.44 11253.19,-3443.44"/>
</g>
<!-- layer_2_expert_broadcast_10 -->
<g id="node274" class="node">
<title>layer_2_expert_broadcast_10</title>
<polygon fill="#e6ffe6" stroke="black" points="12679.56,-3433.17 11930.51,-3433.17 11737.81,-3297.17 12486.87,-3297.17 12679.56,-3433.17"/>
<text text-anchor="middle" x="12208.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="12208.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="12208.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12208.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_10&#45;&gt;layer_2_expert_broadcast_10 -->
<g id="edge495" class="edge">
<title>layer_2_expert_agg_10&#45;&gt;layer_2_expert_broadcast_10</title>
<path fill="none" stroke="black" d="M12208.69,-3540.87C12208.69,-3540.87 12208.69,-3443.44 12208.69,-3443.44"/>
<polygon fill="black" stroke="black" points="12212.19,-3443.44 12208.69,-3433.44 12205.19,-3443.44 12212.19,-3443.44"/>
</g>
<!-- layer_2_expert_broadcast_11 -->
<g id="node275" class="node">
<title>layer_2_expert_broadcast_11</title>
<polygon fill="#e6ffe6" stroke="black" points="13638.56,-3433.17 12889.51,-3433.17 12696.81,-3297.17 13445.87,-3297.17 13638.56,-3433.17"/>
<text text-anchor="middle" x="13167.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="13167.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="13167.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13167.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_11&#45;&gt;layer_2_expert_broadcast_11 -->
<g id="edge496" class="edge">
<title>layer_2_expert_agg_11&#45;&gt;layer_2_expert_broadcast_11</title>
<path fill="none" stroke="black" d="M13167.69,-3540.87C13167.69,-3540.87 13167.69,-3443.44 13167.69,-3443.44"/>
<polygon fill="black" stroke="black" points="13171.19,-3443.44 13167.69,-3433.44 13164.19,-3443.44 13171.19,-3443.44"/>
</g>
<!-- layer_2_expert_broadcast_12 -->
<g id="node276" class="node">
<title>layer_2_expert_broadcast_12</title>
<polygon fill="#e6ffe6" stroke="black" points="14597.56,-3433.17 13848.51,-3433.17 13655.81,-3297.17 14404.87,-3297.17 14597.56,-3433.17"/>
<text text-anchor="middle" x="14126.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="14126.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="14126.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14126.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_12&#45;&gt;layer_2_expert_broadcast_12 -->
<g id="edge497" class="edge">
<title>layer_2_expert_agg_12&#45;&gt;layer_2_expert_broadcast_12</title>
<path fill="none" stroke="black" d="M14126.69,-3540.87C14126.69,-3540.87 14126.69,-3443.44 14126.69,-3443.44"/>
<polygon fill="black" stroke="black" points="14130.19,-3443.44 14126.69,-3433.44 14123.19,-3443.44 14130.19,-3443.44"/>
</g>
<!-- layer_2_expert_broadcast_13 -->
<g id="node277" class="node">
<title>layer_2_expert_broadcast_13</title>
<polygon fill="#e6ffe6" stroke="black" points="15556.56,-3433.17 14807.51,-3433.17 14614.81,-3297.17 15363.87,-3297.17 15556.56,-3433.17"/>
<text text-anchor="middle" x="15085.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="15085.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="15085.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15085.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_13&#45;&gt;layer_2_expert_broadcast_13 -->
<g id="edge498" class="edge">
<title>layer_2_expert_agg_13&#45;&gt;layer_2_expert_broadcast_13</title>
<path fill="none" stroke="black" d="M15085.69,-3540.87C15085.69,-3540.87 15085.69,-3443.44 15085.69,-3443.44"/>
<polygon fill="black" stroke="black" points="15089.19,-3443.44 15085.69,-3433.44 15082.19,-3443.44 15089.19,-3443.44"/>
</g>
<!-- layer_2_expert_broadcast_14 -->
<g id="node278" class="node">
<title>layer_2_expert_broadcast_14</title>
<polygon fill="#e6ffe6" stroke="black" points="16515.56,-3433.17 15766.51,-3433.17 15573.81,-3297.17 16322.87,-3297.17 16515.56,-3433.17"/>
<text text-anchor="middle" x="16044.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="16044.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="16044.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="16044.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_14&#45;&gt;layer_2_expert_broadcast_14 -->
<g id="edge499" class="edge">
<title>layer_2_expert_agg_14&#45;&gt;layer_2_expert_broadcast_14</title>
<path fill="none" stroke="black" d="M16044.69,-3540.87C16044.69,-3540.87 16044.69,-3443.44 16044.69,-3443.44"/>
<polygon fill="black" stroke="black" points="16048.19,-3443.44 16044.69,-3433.44 16041.19,-3443.44 16048.19,-3443.44"/>
</g>
<!-- layer_2_expert_broadcast_15 -->
<g id="node279" class="node">
<title>layer_2_expert_broadcast_15</title>
<polygon fill="#e6ffe6" stroke="black" points="17474.56,-3433.17 16725.51,-3433.17 16532.81,-3297.17 17281.87,-3297.17 17474.56,-3433.17"/>
<text text-anchor="middle" x="17003.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="17003.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="17003.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="17003.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_agg_15&#45;&gt;layer_2_expert_broadcast_15 -->
<g id="edge500" class="edge">
<title>layer_2_expert_agg_15&#45;&gt;layer_2_expert_broadcast_15</title>
<path fill="none" stroke="black" d="M17003.69,-3540.87C17003.69,-3540.87 17003.69,-3443.44 17003.69,-3443.44"/>
<polygon fill="black" stroke="black" points="17007.19,-3443.44 17003.69,-3433.44 17000.19,-3443.44 17007.19,-3443.44"/>
</g>
<!-- layer_2_expert_broadcast_0 -->
<g id="node264" class="node">
<title>layer_2_expert_broadcast_0</title>
<polygon fill="#e6ffe6" stroke="black" points="3089.56,-3433.17 2340.51,-3433.17 2147.81,-3297.17 2896.87,-3297.17 3089.56,-3433.17"/>
<text text-anchor="middle" x="2618.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="2618.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="2618.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2618.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_residual2 -->
<g id="node280" class="node">
<title>layer_2_residual2</title>
<polygon fill="#fff0e6" stroke="black" points="10037.69,-3189.17 9583.69,-3189.17 9583.69,-3106.17 10037.69,-3106.17 10037.69,-3189.17"/>
<text text-anchor="middle" x="9810.69" y="-3173.97" font-family="monospace" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="9810.69" y="-3158.97" font-family="monospace" font-size="14.00">Input1: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9810.69" y="-3143.97" font-family="monospace" font-size="14.00">Input2: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9810.69" y="-3128.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9810.69" y="-3113.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_expert_broadcast_0&#45;&gt;layer_2_residual2 -->
<g id="edge501" class="edge">
<title>layer_2_expert_broadcast_0&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M2983.19,-3357.98C2983.19,-3317.12 2983.19,-3116 2983.19,-3116 2983.19,-3116 9573.52,-3116 9573.52,-3116"/>
<polygon fill="black" stroke="black" points="9573.52,-3119.5 9583.52,-3116 9573.52,-3112.5 9573.52,-3119.5"/>
</g>
<!-- layer_2_expert_broadcast_1 -->
<g id="node265" class="node">
<title>layer_2_expert_broadcast_1</title>
<polygon fill="#e6ffe6" stroke="black" points="4048.56,-3433.17 3299.51,-3433.17 3106.81,-3297.17 3855.87,-3297.17 4048.56,-3433.17"/>
<text text-anchor="middle" x="3577.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="3577.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="3577.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3577.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_broadcast_1&#45;&gt;layer_2_residual2 -->
<g id="edge502" class="edge">
<title>layer_2_expert_broadcast_1&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M3942.19,-3358.01C3942.19,-3318.21 3942.19,-3126 3942.19,-3126 3942.19,-3126 9573.33,-3126 9573.33,-3126"/>
<polygon fill="black" stroke="black" points="9573.33,-3129.5 9583.33,-3126 9573.33,-3122.5 9573.33,-3129.5"/>
</g>
<!-- layer_2_expert_broadcast_2 -->
<g id="node266" class="node">
<title>layer_2_expert_broadcast_2</title>
<polygon fill="#e6ffe6" stroke="black" points="5007.56,-3433.17 4258.51,-3433.17 4065.81,-3297.17 4814.87,-3297.17 5007.56,-3433.17"/>
<text text-anchor="middle" x="4536.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="4536.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="4536.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4536.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_broadcast_2&#45;&gt;layer_2_residual2 -->
<g id="edge503" class="edge">
<title>layer_2_expert_broadcast_2&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M4901.19,-3358.09C4901.19,-3319.58 4901.19,-3137 4901.19,-3137 4901.19,-3137 9573.33,-3137 9573.33,-3137"/>
<polygon fill="black" stroke="black" points="9573.33,-3140.5 9583.33,-3137 9573.33,-3133.5 9573.33,-3140.5"/>
</g>
<!-- layer_2_expert_broadcast_3 -->
<g id="node267" class="node">
<title>layer_2_expert_broadcast_3</title>
<polygon fill="#e6ffe6" stroke="black" points="5966.56,-3433.17 5217.51,-3433.17 5024.81,-3297.17 5773.87,-3297.17 5966.56,-3433.17"/>
<text text-anchor="middle" x="5495.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="5495.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="5495.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5495.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_broadcast_3&#45;&gt;layer_2_residual2 -->
<g id="edge504" class="edge">
<title>layer_2_expert_broadcast_3&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M5860.19,-3357.91C5860.19,-3320.05 5860.19,-3147 5860.19,-3147 5860.19,-3147 9573.38,-3147 9573.38,-3147"/>
<polygon fill="black" stroke="black" points="9573.38,-3150.5 9583.38,-3147 9573.38,-3143.5 9573.38,-3150.5"/>
</g>
<!-- layer_2_expert_broadcast_4 -->
<g id="node268" class="node">
<title>layer_2_expert_broadcast_4</title>
<polygon fill="#e6ffe6" stroke="black" points="6925.56,-3433.17 6176.51,-3433.17 5983.81,-3297.17 6732.87,-3297.17 6925.56,-3433.17"/>
<text text-anchor="middle" x="6454.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="6454.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="6454.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6454.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_broadcast_4&#45;&gt;layer_2_residual2 -->
<g id="edge505" class="edge">
<title>layer_2_expert_broadcast_4&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M6819.19,-3357.79C6819.19,-3320.89 6819.19,-3158 6819.19,-3158 6819.19,-3158 9573.38,-3158 9573.38,-3158"/>
<polygon fill="black" stroke="black" points="9573.38,-3161.5 9583.38,-3158 9573.38,-3154.5 9573.38,-3161.5"/>
</g>
<!-- layer_2_expert_broadcast_5 -->
<g id="node269" class="node">
<title>layer_2_expert_broadcast_5</title>
<polygon fill="#e6ffe6" stroke="black" points="7884.56,-3433.17 7135.51,-3433.17 6942.81,-3297.17 7691.87,-3297.17 7884.56,-3433.17"/>
<text text-anchor="middle" x="7413.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="7413.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="7413.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7413.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_broadcast_5&#45;&gt;layer_2_residual2 -->
<g id="edge506" class="edge">
<title>layer_2_expert_broadcast_5&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M7778.19,-3357.68C7778.19,-3321.66 7778.19,-3168 7778.19,-3168 7778.19,-3168 9573.45,-3168 9573.45,-3168"/>
<polygon fill="black" stroke="black" points="9573.45,-3171.5 9583.45,-3168 9573.45,-3164.5 9573.45,-3171.5"/>
</g>
<!-- layer_2_expert_broadcast_6 -->
<g id="node270" class="node">
<title>layer_2_expert_broadcast_6</title>
<polygon fill="#e6ffe6" stroke="black" points="8843.56,-3433.17 8094.51,-3433.17 7901.81,-3297.17 8650.87,-3297.17 8843.56,-3433.17"/>
<text text-anchor="middle" x="8372.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="8372.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8372.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8372.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_broadcast_6&#45;&gt;layer_2_residual2 -->
<g id="edge507" class="edge">
<title>layer_2_expert_broadcast_6&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M8826.53,-3365.03C8826.53,-3359.36 8826.53,-3178 8826.53,-3178 8826.53,-3178 9573.66,-3178 9573.66,-3178"/>
<polygon fill="black" stroke="black" points="9573.66,-3181.5 9583.66,-3178 9573.66,-3174.5 9573.66,-3181.5"/>
</g>
<!-- layer_2_expert_broadcast_7 -->
<g id="node271" class="node">
<title>layer_2_expert_broadcast_7</title>
<polygon fill="#e6ffe6" stroke="black" points="9802.56,-3433.17 9053.51,-3433.17 8860.81,-3297.17 9609.87,-3297.17 9802.56,-3433.17"/>
<text text-anchor="middle" x="9331.69" y="-3383.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="9331.69" y="-3368.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="9331.69" y="-3353.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9331.69" y="-3338.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_2_expert_broadcast_7&#45;&gt;layer_2_residual2 -->
<g id="edge508" class="edge">
<title>layer_2_expert_broadcast_7&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M9693.03,-3355.82C9693.03,-3355.82 9693.03,-3199.35 9693.03,-3199.35"/>
<polygon fill="black" stroke="black" points="9696.53,-3199.35 9693.03,-3189.35 9689.53,-3199.35 9696.53,-3199.35"/>
</g>
<!-- layer_2_expert_broadcast_8&#45;&gt;layer_2_residual2 -->
<g id="edge509" class="edge">
<title>layer_2_expert_broadcast_8&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M9928.84,-3296.94C9928.84,-3296.94 9928.84,-3199.38 9928.84,-3199.38"/>
<polygon fill="black" stroke="black" points="9932.34,-3199.38 9928.84,-3189.38 9925.34,-3199.38 9932.34,-3199.38"/>
</g>
<!-- layer_2_expert_broadcast_9&#45;&gt;layer_2_residual2 -->
<g id="edge510" class="edge">
<title>layer_2_expert_broadcast_9&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M10856.23,-3297.07C10856.23,-3243.55 10856.23,-3178 10856.23,-3178 10856.23,-3178 10047.88,-3178 10047.88,-3178"/>
<polygon fill="black" stroke="black" points="10047.88,-3174.5 10037.88,-3178 10047.88,-3181.5 10047.88,-3174.5"/>
</g>
<!-- layer_2_expert_broadcast_10&#45;&gt;layer_2_residual2 -->
<g id="edge511" class="edge">
<title>layer_2_expert_broadcast_10&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M11802.84,-3297.04C11802.84,-3240.05 11802.84,-3168 11802.84,-3168 11802.84,-3168 10047.76,-3168 10047.76,-3168"/>
<polygon fill="black" stroke="black" points="10047.76,-3164.5 10037.76,-3168 10047.76,-3171.5 10047.76,-3164.5"/>
</g>
<!-- layer_2_expert_broadcast_11&#45;&gt;layer_2_residual2 -->
<g id="edge512" class="edge">
<title>layer_2_expert_broadcast_11&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M12783.34,-3297.05C12783.34,-3236.66 12783.34,-3158 12783.34,-3158 12783.34,-3158 10047.78,-3158 10047.78,-3158"/>
<polygon fill="black" stroke="black" points="10047.78,-3154.5 10037.78,-3158 10047.78,-3161.5 10047.78,-3154.5"/>
</g>
<!-- layer_2_expert_broadcast_12&#45;&gt;layer_2_residual2 -->
<g id="edge513" class="edge">
<title>layer_2_expert_broadcast_12&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M13697.34,-3365.01C13697.34,-3358.4 13697.34,-3147 13697.34,-3147 13697.34,-3147 10047.87,-3147 10047.87,-3147"/>
<polygon fill="black" stroke="black" points="10047.87,-3143.5 10037.87,-3147 10047.87,-3150.5 10047.87,-3143.5"/>
</g>
<!-- layer_2_expert_broadcast_13&#45;&gt;layer_2_residual2 -->
<g id="edge514" class="edge">
<title>layer_2_expert_broadcast_13&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M14730.69,-3297.02C14730.69,-3229.79 14730.69,-3137 14730.69,-3137 14730.69,-3137 10047.71,-3137 10047.71,-3137"/>
<polygon fill="black" stroke="black" points="10047.71,-3133.5 10037.71,-3137 10047.71,-3140.5 10047.71,-3133.5"/>
</g>
<!-- layer_2_expert_broadcast_14&#45;&gt;layer_2_residual2 -->
<g id="edge515" class="edge">
<title>layer_2_expert_broadcast_14&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M15689.69,-3296.95C15689.69,-3226.26 15689.69,-3126 15689.69,-3126 15689.69,-3126 10048,-3126 10048,-3126"/>
<polygon fill="black" stroke="black" points="10048,-3122.5 10038,-3126 10048,-3129.5 10048,-3122.5"/>
</g>
<!-- layer_2_expert_broadcast_15&#45;&gt;layer_2_residual2 -->
<g id="edge516" class="edge">
<title>layer_2_expert_broadcast_15&#45;&gt;layer_2_residual2</title>
<path fill="none" stroke="black" d="M17003.69,-3297.08C17003.69,-3223.31 17003.69,-3116 17003.69,-3116 17003.69,-3116 10047.84,-3116 10047.84,-3116"/>
<polygon fill="black" stroke="black" points="10047.84,-3112.5 10037.84,-3116 10047.84,-3119.5 10047.84,-3112.5"/>
</g>
<!-- layer_3_ln1 -->
<g id="node281" class="node">
<title>layer_3_ln1</title>
<polygon fill="#e6f3ff" stroke="black" points="11725.69,-2998.17 11271.69,-2998.17 11271.69,-2930.17 11725.69,-2930.17 11725.69,-2998.17"/>
<text text-anchor="middle" x="11498.69" y="-2982.97" font-family="monospace" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="11498.69" y="-2967.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11498.69" y="-2952.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11498.69" y="-2937.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_residual2&#45;&gt;layer_3_ln1 -->
<g id="edge517" class="edge">
<title>layer_2_residual2&#45;&gt;layer_3_ln1</title>
<path fill="none" stroke="black" d="M9963.19,-3105.94C9963.19,-3057.45 9963.19,-2984 9963.19,-2984 9963.19,-2984 11261.29,-2984 11261.29,-2984"/>
<polygon fill="black" stroke="black" points="11261.29,-2987.5 11271.29,-2984 11261.29,-2980.5 11261.29,-2987.5"/>
</g>
<!-- layer_3_residual1 -->
<g id="node322" class="node">
<title>layer_3_residual1</title>
<polygon fill="#fff0e6" stroke="black" points="11725.69,-1806.17 11271.69,-1806.17 11271.69,-1723.17 11725.69,-1723.17 11725.69,-1806.17"/>
<text text-anchor="middle" x="11498.69" y="-1790.97" font-family="monospace" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="11498.69" y="-1775.97" font-family="monospace" font-size="14.00">Input1: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11498.69" y="-1760.97" font-family="monospace" font-size="14.00">Input2: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11498.69" y="-1745.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11498.69" y="-1730.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_2_residual2&#45;&gt;layer_3_residual1 -->
<g id="edge622" class="edge">
<title>layer_2_residual2&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M9646.69,-3105.78C9646.69,-2965.94 9646.69,-2524 9646.69,-2524 9646.69,-2524 10060.19,-2524 10060.19,-2524 10060.19,-2524 10060.19,-1772 10060.19,-1772 10060.19,-1772 11261.55,-1772 11261.55,-1772"/>
<polygon fill="black" stroke="black" points="11261.55,-1775.5 11271.55,-1772 11261.55,-1768.5 11261.55,-1775.5"/>
</g>
<!-- layer_3_qkv_gpu_0 -->
<g id="node282" class="node">
<title>layer_3_qkv_gpu_0</title>
<polygon fill="#e6f3ff" stroke="black" points="11010.69,-2822.17 10548.69,-2822.17 10548.69,-2754.17 11010.69,-2754.17 11010.69,-2822.17"/>
<text text-anchor="middle" x="10779.69" y="-2806.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10779.69" y="-2791.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="10779.69" y="-2776.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10779.69" y="-2761.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_qkv_gpu_0 -->
<g id="edge518" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_qkv_gpu_0</title>
<path fill="none" stroke="black" d="M11271.64,-2943C11114.48,-2943 10933.46,-2943 10933.46,-2943 10933.46,-2943 10933.46,-2832.53 10933.46,-2832.53"/>
<polygon fill="black" stroke="black" points="10936.96,-2832.53 10933.46,-2822.53 10929.96,-2832.53 10936.96,-2832.53"/>
</g>
<!-- layer_3_qkv_gpu_1 -->
<g id="node283" class="node">
<title>layer_3_qkv_gpu_1</title>
<polygon fill="#e6f3ff" stroke="black" points="11729.69,-2822.17 11267.69,-2822.17 11267.69,-2754.17 11729.69,-2754.17 11729.69,-2822.17"/>
<text text-anchor="middle" x="11498.69" y="-2806.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11498.69" y="-2791.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="11498.69" y="-2776.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11498.69" y="-2761.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_qkv_gpu_1 -->
<g id="edge519" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_qkv_gpu_1</title>
<path fill="none" stroke="black" d="M11498.69,-2929.81C11498.69,-2929.81 11498.69,-2832.43 11498.69,-2832.43"/>
<polygon fill="black" stroke="black" points="11502.19,-2832.43 11498.69,-2822.43 11495.19,-2832.43 11502.19,-2832.43"/>
</g>
<!-- layer_3_qkv_gpu_2 -->
<g id="node284" class="node">
<title>layer_3_qkv_gpu_2</title>
<polygon fill="#e6f3ff" stroke="black" points="12329.69,-2822.17 11867.69,-2822.17 11867.69,-2754.17 12329.69,-2754.17 12329.69,-2822.17"/>
<text text-anchor="middle" x="12098.69" y="-2806.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12098.69" y="-2791.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="12098.69" y="-2776.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12098.69" y="-2761.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_qkv_gpu_2 -->
<g id="edge520" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_qkv_gpu_2</title>
<path fill="none" stroke="black" d="M11725.95,-2943C11895.77,-2943 12098.69,-2943 12098.69,-2943 12098.69,-2943 12098.69,-2832.53 12098.69,-2832.53"/>
<polygon fill="black" stroke="black" points="12102.19,-2832.53 12098.69,-2822.53 12095.19,-2832.53 12102.19,-2832.53"/>
</g>
<!-- layer_3_qkv_gpu_3 -->
<g id="node285" class="node">
<title>layer_3_qkv_gpu_3</title>
<polygon fill="#e6f3ff" stroke="black" points="12869.69,-2822.17 12407.69,-2822.17 12407.69,-2754.17 12869.69,-2754.17 12869.69,-2822.17"/>
<text text-anchor="middle" x="12638.69" y="-2806.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12638.69" y="-2791.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="12638.69" y="-2776.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12638.69" y="-2761.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_qkv_gpu_3 -->
<g id="edge521" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_qkv_gpu_3</title>
<path fill="none" stroke="black" d="M11725.72,-2957C12033.05,-2957 12543.53,-2957 12543.53,-2957 12543.53,-2957 12543.53,-2832.33 12543.53,-2832.33"/>
<polygon fill="black" stroke="black" points="12547.03,-2832.33 12543.53,-2822.33 12540.03,-2832.33 12547.03,-2832.33"/>
</g>
<!-- layer_3_qkv_gpu_4 -->
<g id="node286" class="node">
<title>layer_3_qkv_gpu_4</title>
<polygon fill="#e6f3ff" stroke="black" points="13738.69,-2822.17 13276.69,-2822.17 13276.69,-2754.17 13738.69,-2754.17 13738.69,-2822.17"/>
<text text-anchor="middle" x="13507.69" y="-2806.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13507.69" y="-2791.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="13507.69" y="-2776.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13507.69" y="-2761.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_qkv_gpu_4 -->
<g id="edge522" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_qkv_gpu_4</title>
<path fill="none" stroke="black" d="M11725.78,-2970C12241.69,-2970 13457.53,-2970 13457.53,-2970 13457.53,-2970 13457.53,-2832.37 13457.53,-2832.37"/>
<polygon fill="black" stroke="black" points="13461.03,-2832.37 13457.53,-2822.37 13454.03,-2832.37 13461.03,-2832.37"/>
</g>
<!-- layer_3_qkv_gpu_5 -->
<g id="node287" class="node">
<title>layer_3_qkv_gpu_5</title>
<polygon fill="#e6f3ff" stroke="black" points="14412.69,-2822.17 13950.69,-2822.17 13950.69,-2754.17 14412.69,-2754.17 14412.69,-2822.17"/>
<text text-anchor="middle" x="14181.69" y="-2806.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14181.69" y="-2791.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="14181.69" y="-2776.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14181.69" y="-2761.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_qkv_gpu_5 -->
<g id="edge523" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_qkv_gpu_5</title>
<path fill="none" stroke="black" d="M11725.7,-2984C12373.04,-2984 14181.69,-2984 14181.69,-2984 14181.69,-2984 14181.69,-2832.28 14181.69,-2832.28"/>
<polygon fill="black" stroke="black" points="14185.19,-2832.28 14181.69,-2822.28 14178.19,-2832.28 14185.19,-2832.28"/>
</g>
<!-- layer_3_qkv_gpu_6 -->
<g id="node288" class="node">
<title>layer_3_qkv_gpu_6</title>
<polygon fill="#e6f3ff" stroke="black" points="9570.69,-2822.17 9108.69,-2822.17 9108.69,-2754.17 9570.69,-2754.17 9570.69,-2822.17"/>
<text text-anchor="middle" x="9339.69" y="-2806.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9339.69" y="-2791.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="9339.69" y="-2776.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9339.69" y="-2761.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_qkv_gpu_6 -->
<g id="edge524" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_qkv_gpu_6</title>
<path fill="none" stroke="black" d="M11271.46,-2970C10716.98,-2970 9339.69,-2970 9339.69,-2970 9339.69,-2970 9339.69,-2832.37 9339.69,-2832.37"/>
<polygon fill="black" stroke="black" points="9343.19,-2832.37 9339.69,-2822.37 9336.19,-2832.37 9343.19,-2832.37"/>
</g>
<!-- layer_3_qkv_gpu_7 -->
<g id="node289" class="node">
<title>layer_3_qkv_gpu_7</title>
<polygon fill="#e6f3ff" stroke="black" points="10350.69,-2822.17 9888.69,-2822.17 9888.69,-2754.17 10350.69,-2754.17 10350.69,-2822.17"/>
<text text-anchor="middle" x="10119.69" y="-2806.97" font-family="monospace" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10119.69" y="-2791.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="10119.69" y="-2776.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10119.69" y="-2761.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_qkv_gpu_7 -->
<g id="edge525" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_qkv_gpu_7</title>
<path fill="none" stroke="black" d="M11271.46,-2957C10897.71,-2957 10194.19,-2957 10194.19,-2957 10194.19,-2957 10194.19,-2832.33 10194.19,-2832.33"/>
<polygon fill="black" stroke="black" points="10197.69,-2832.33 10194.19,-2822.33 10190.69,-2832.33 10197.69,-2832.33"/>
</g>
<!-- layer_3_attn_gpu_0 -->
<g id="node290" class="node">
<title>layer_3_attn_gpu_0</title>
<polygon fill="#e6f3ff" stroke="black" points="10890.69,-2646.17 10428.69,-2646.17 10428.69,-2578.17 10890.69,-2578.17 10890.69,-2646.17"/>
<text text-anchor="middle" x="10659.69" y="-2630.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="10659.69" y="-2615.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="10659.69" y="-2600.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10659.69" y="-2585.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_qkv_gpu_0&#45;&gt;layer_3_attn_gpu_0 -->
<g id="edge526" class="edge">
<title>layer_3_qkv_gpu_0&#45;&gt;layer_3_attn_gpu_0</title>
<path fill="none" stroke="black" d="M10719.69,-2753.81C10719.69,-2753.81 10719.69,-2656.43 10719.69,-2656.43"/>
<polygon fill="black" stroke="black" points="10723.19,-2656.43 10719.69,-2646.43 10716.19,-2656.43 10723.19,-2656.43"/>
</g>
<!-- layer_3_attn_gpu_1 -->
<g id="node291" class="node">
<title>layer_3_attn_gpu_1</title>
<polygon fill="#e6f3ff" stroke="black" points="11729.69,-2646.17 11267.69,-2646.17 11267.69,-2578.17 11729.69,-2578.17 11729.69,-2646.17"/>
<text text-anchor="middle" x="11498.69" y="-2630.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="11498.69" y="-2615.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="11498.69" y="-2600.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11498.69" y="-2585.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_qkv_gpu_1&#45;&gt;layer_3_attn_gpu_1 -->
<g id="edge527" class="edge">
<title>layer_3_qkv_gpu_1&#45;&gt;layer_3_attn_gpu_1</title>
<path fill="none" stroke="black" d="M11498.69,-2753.81C11498.69,-2753.81 11498.69,-2656.43 11498.69,-2656.43"/>
<polygon fill="black" stroke="black" points="11502.19,-2656.43 11498.69,-2646.43 11495.19,-2656.43 11502.19,-2656.43"/>
</g>
<!-- layer_3_attn_gpu_2 -->
<g id="node292" class="node">
<title>layer_3_attn_gpu_2</title>
<polygon fill="#e6f3ff" stroke="black" points="12628.69,-2646.17 12166.69,-2646.17 12166.69,-2578.17 12628.69,-2578.17 12628.69,-2646.17"/>
<text text-anchor="middle" x="12397.69" y="-2630.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="12397.69" y="-2615.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="12397.69" y="-2600.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12397.69" y="-2585.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_qkv_gpu_2&#45;&gt;layer_3_attn_gpu_2 -->
<g id="edge528" class="edge">
<title>layer_3_qkv_gpu_2&#45;&gt;layer_3_attn_gpu_2</title>
<path fill="none" stroke="black" d="M12248.19,-2753.81C12248.19,-2753.81 12248.19,-2656.43 12248.19,-2656.43"/>
<polygon fill="black" stroke="black" points="12251.69,-2656.43 12248.19,-2646.43 12244.69,-2656.43 12251.69,-2656.43"/>
</g>
<!-- layer_3_attn_gpu_3 -->
<g id="node293" class="node">
<title>layer_3_attn_gpu_3</title>
<polygon fill="#e6f3ff" stroke="black" points="13108.69,-2646.17 12646.69,-2646.17 12646.69,-2578.17 13108.69,-2578.17 13108.69,-2646.17"/>
<text text-anchor="middle" x="12877.69" y="-2630.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="12877.69" y="-2615.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="12877.69" y="-2600.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12877.69" y="-2585.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_qkv_gpu_3&#45;&gt;layer_3_attn_gpu_3 -->
<g id="edge529" class="edge">
<title>layer_3_qkv_gpu_3&#45;&gt;layer_3_attn_gpu_3</title>
<path fill="none" stroke="black" d="M12758.19,-2753.81C12758.19,-2753.81 12758.19,-2656.43 12758.19,-2656.43"/>
<polygon fill="black" stroke="black" points="12761.69,-2656.43 12758.19,-2646.43 12754.69,-2656.43 12761.69,-2656.43"/>
</g>
<!-- layer_3_attn_gpu_4 -->
<g id="node294" class="node">
<title>layer_3_attn_gpu_4</title>
<polygon fill="#e6f3ff" stroke="black" points="14217.69,-2646.17 13755.69,-2646.17 13755.69,-2578.17 14217.69,-2578.17 14217.69,-2646.17"/>
<text text-anchor="middle" x="13986.69" y="-2630.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="13986.69" y="-2615.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="13986.69" y="-2600.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13986.69" y="-2585.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_qkv_gpu_4&#45;&gt;layer_3_attn_gpu_4 -->
<g id="edge530" class="edge">
<title>layer_3_qkv_gpu_4&#45;&gt;layer_3_attn_gpu_4</title>
<path fill="none" stroke="black" d="M13739.1,-2788C13802.04,-2788 13853.19,-2788 13853.19,-2788 13853.19,-2788 13853.19,-2656.49 13853.19,-2656.49"/>
<polygon fill="black" stroke="black" points="13856.69,-2656.49 13853.19,-2646.49 13849.69,-2656.49 13856.69,-2656.49"/>
</g>
<!-- layer_3_attn_gpu_5 -->
<g id="node295" class="node">
<title>layer_3_attn_gpu_5</title>
<polygon fill="#e6f3ff" stroke="black" points="15370.69,-2646.17 14908.69,-2646.17 14908.69,-2578.17 15370.69,-2578.17 15370.69,-2646.17"/>
<text text-anchor="middle" x="15139.69" y="-2630.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="15139.69" y="-2615.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="15139.69" y="-2600.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15139.69" y="-2585.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_qkv_gpu_5&#45;&gt;layer_3_attn_gpu_5 -->
<g id="edge531" class="edge">
<title>layer_3_qkv_gpu_5&#45;&gt;layer_3_attn_gpu_5</title>
<path fill="none" stroke="black" d="M14315.19,-2753.78C14315.19,-2702.51 14315.19,-2612 14315.19,-2612 14315.19,-2612 14898.65,-2612 14898.65,-2612"/>
<polygon fill="black" stroke="black" points="14898.65,-2615.5 14908.65,-2612 14898.65,-2608.5 14898.65,-2615.5"/>
</g>
<!-- layer_3_attn_gpu_6 -->
<g id="node296" class="node">
<title>layer_3_attn_gpu_6</title>
<polygon fill="#e6f3ff" stroke="black" points="9271.69,-2646.17 8809.69,-2646.17 8809.69,-2578.17 9271.69,-2578.17 9271.69,-2646.17"/>
<text text-anchor="middle" x="9040.69" y="-2630.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="9040.69" y="-2615.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="9040.69" y="-2600.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9040.69" y="-2585.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_qkv_gpu_6&#45;&gt;layer_3_attn_gpu_6 -->
<g id="edge532" class="edge">
<title>layer_3_qkv_gpu_6&#45;&gt;layer_3_attn_gpu_6</title>
<path fill="none" stroke="black" d="M9190.19,-2753.81C9190.19,-2753.81 9190.19,-2656.43 9190.19,-2656.43"/>
<polygon fill="black" stroke="black" points="9193.69,-2656.43 9190.19,-2646.43 9186.69,-2656.43 9193.69,-2656.43"/>
</g>
<!-- layer_3_attn_gpu_7 -->
<g id="node297" class="node">
<title>layer_3_attn_gpu_7</title>
<polygon fill="#e6f3ff" stroke="black" points="10171.69,-2646.17 9709.69,-2646.17 9709.69,-2578.17 10171.69,-2578.17 10171.69,-2646.17"/>
<text text-anchor="middle" x="9940.69" y="-2630.97" font-family="monospace" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="9940.69" y="-2615.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="9940.69" y="-2600.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9940.69" y="-2585.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
</g>
<!-- layer_3_qkv_gpu_7&#45;&gt;layer_3_attn_gpu_7 -->
<g id="edge533" class="edge">
<title>layer_3_qkv_gpu_7&#45;&gt;layer_3_attn_gpu_7</title>
<path fill="none" stroke="black" d="M10030.19,-2753.81C10030.19,-2753.81 10030.19,-2656.43 10030.19,-2656.43"/>
<polygon fill="black" stroke="black" points="10033.69,-2656.43 10030.19,-2646.43 10026.69,-2656.43 10033.69,-2656.43"/>
</g>
<!-- layer_3_attn_allreduce_0 -->
<g id="node298" class="node">
<title>layer_3_attn_allreduce_0</title>
<polygon fill="#e6ffe6" stroke="black" points="11010.56,-2470.17 10261.51,-2470.17 10068.81,-2334.17 10817.87,-2334.17 11010.56,-2470.17"/>
<text text-anchor="middle" x="10539.69" y="-2420.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="10539.69" y="-2405.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="10539.69" y="-2390.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="10539.69" y="-2375.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_gpu_0&#45;&gt;layer_3_attn_allreduce_0 -->
<g id="edge534" class="edge">
<title>layer_3_attn_gpu_0&#45;&gt;layer_3_attn_allreduce_0</title>
<path fill="none" stroke="black" d="M10659.69,-2577.96C10659.69,-2577.96 10659.69,-2480.33 10659.69,-2480.33"/>
<polygon fill="black" stroke="black" points="10663.19,-2480.33 10659.69,-2470.33 10656.19,-2480.33 10663.19,-2480.33"/>
</g>
<!-- layer_3_attn_allreduce_1 -->
<g id="node299" class="node">
<title>layer_3_attn_allreduce_1</title>
<polygon fill="#e6ffe6" stroke="black" points="11969.56,-2470.17 11220.51,-2470.17 11027.81,-2334.17 11776.87,-2334.17 11969.56,-2470.17"/>
<text text-anchor="middle" x="11498.69" y="-2420.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="11498.69" y="-2405.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="11498.69" y="-2390.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="11498.69" y="-2375.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_gpu_1&#45;&gt;layer_3_attn_allreduce_1 -->
<g id="edge535" class="edge">
<title>layer_3_attn_gpu_1&#45;&gt;layer_3_attn_allreduce_1</title>
<path fill="none" stroke="black" d="M11498.69,-2577.96C11498.69,-2577.96 11498.69,-2480.33 11498.69,-2480.33"/>
<polygon fill="black" stroke="black" points="11502.19,-2480.33 11498.69,-2470.33 11495.19,-2480.33 11502.19,-2480.33"/>
</g>
<!-- layer_3_attn_allreduce_2 -->
<g id="node300" class="node">
<title>layer_3_attn_allreduce_2</title>
<polygon fill="#e6ffe6" stroke="black" points="12928.56,-2470.17 12179.51,-2470.17 11986.81,-2334.17 12735.87,-2334.17 12928.56,-2470.17"/>
<text text-anchor="middle" x="12457.69" y="-2420.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="12457.69" y="-2405.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="12457.69" y="-2390.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="12457.69" y="-2375.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_gpu_2&#45;&gt;layer_3_attn_allreduce_2 -->
<g id="edge536" class="edge">
<title>layer_3_attn_gpu_2&#45;&gt;layer_3_attn_allreduce_2</title>
<path fill="none" stroke="black" d="M12397.69,-2577.96C12397.69,-2577.96 12397.69,-2480.33 12397.69,-2480.33"/>
<polygon fill="black" stroke="black" points="12401.19,-2480.33 12397.69,-2470.33 12394.19,-2480.33 12401.19,-2480.33"/>
</g>
<!-- layer_3_attn_allreduce_3 -->
<g id="node301" class="node">
<title>layer_3_attn_allreduce_3</title>
<polygon fill="#e6ffe6" stroke="black" points="13887.56,-2470.17 13138.51,-2470.17 12945.81,-2334.17 13694.87,-2334.17 13887.56,-2470.17"/>
<text text-anchor="middle" x="13416.69" y="-2420.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="13416.69" y="-2405.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="13416.69" y="-2390.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="13416.69" y="-2375.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_gpu_3&#45;&gt;layer_3_attn_allreduce_3 -->
<g id="edge537" class="edge">
<title>layer_3_attn_gpu_3&#45;&gt;layer_3_attn_allreduce_3</title>
<path fill="none" stroke="black" d="M13027.34,-2577.96C13027.34,-2577.96 13027.34,-2412.25 13027.34,-2412.25"/>
<polygon fill="black" stroke="black" points="13030.84,-2412.25 13027.34,-2402.25 13023.84,-2412.25 13030.84,-2412.25"/>
</g>
<!-- layer_3_attn_allreduce_4 -->
<g id="node302" class="node">
<title>layer_3_attn_allreduce_4</title>
<polygon fill="#e6ffe6" stroke="black" points="14846.56,-2470.17 14097.51,-2470.17 13904.81,-2334.17 14653.87,-2334.17 14846.56,-2470.17"/>
<text text-anchor="middle" x="14375.69" y="-2420.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="14375.69" y="-2405.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="14375.69" y="-2390.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="14375.69" y="-2375.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_gpu_4&#45;&gt;layer_3_attn_allreduce_4 -->
<g id="edge538" class="edge">
<title>layer_3_attn_gpu_4&#45;&gt;layer_3_attn_allreduce_4</title>
<path fill="none" stroke="black" d="M14061.34,-2577.96C14061.34,-2577.96 14061.34,-2454.71 14061.34,-2454.71"/>
<polygon fill="black" stroke="black" points="14064.84,-2454.71 14061.34,-2444.71 14057.84,-2454.71 14064.84,-2454.71"/>
</g>
<!-- layer_3_attn_allreduce_5 -->
<g id="node303" class="node">
<title>layer_3_attn_allreduce_5</title>
<polygon fill="#e6ffe6" stroke="black" points="15805.56,-2470.17 15056.51,-2470.17 14863.81,-2334.17 15612.87,-2334.17 15805.56,-2470.17"/>
<text text-anchor="middle" x="15334.69" y="-2420.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="15334.69" y="-2405.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="15334.69" y="-2390.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="15334.69" y="-2375.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_gpu_5&#45;&gt;layer_3_attn_allreduce_5 -->
<g id="edge539" class="edge">
<title>layer_3_attn_gpu_5&#45;&gt;layer_3_attn_allreduce_5</title>
<path fill="none" stroke="black" d="M15139.69,-2577.96C15139.69,-2577.96 15139.69,-2480.33 15139.69,-2480.33"/>
<polygon fill="black" stroke="black" points="15143.19,-2480.33 15139.69,-2470.33 15136.19,-2480.33 15143.19,-2480.33"/>
</g>
<!-- layer_3_attn_allreduce_6 -->
<g id="node304" class="node">
<title>layer_3_attn_allreduce_6</title>
<polygon fill="#e6ffe6" stroke="black" points="9092.56,-2470.17 8343.51,-2470.17 8150.81,-2334.17 8899.87,-2334.17 9092.56,-2470.17"/>
<text text-anchor="middle" x="8621.69" y="-2420.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="8621.69" y="-2405.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="8621.69" y="-2390.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="8621.69" y="-2375.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_gpu_6&#45;&gt;layer_3_attn_allreduce_6 -->
<g id="edge540" class="edge">
<title>layer_3_attn_gpu_6&#45;&gt;layer_3_attn_allreduce_6</title>
<path fill="none" stroke="black" d="M8951.03,-2577.96C8951.03,-2577.96 8951.03,-2480.33 8951.03,-2480.33"/>
<polygon fill="black" stroke="black" points="8954.53,-2480.33 8951.03,-2470.33 8947.53,-2480.33 8954.53,-2480.33"/>
</g>
<!-- layer_3_attn_allreduce_7 -->
<g id="node305" class="node">
<title>layer_3_attn_allreduce_7</title>
<polygon fill="#e6ffe6" stroke="black" points="10051.56,-2470.17 9302.51,-2470.17 9109.81,-2334.17 9858.87,-2334.17 10051.56,-2470.17"/>
<text text-anchor="middle" x="9580.69" y="-2420.97" font-family="monospace" font-size="14.00">All&#45;Reduce Attention</text>
<text text-anchor="middle" x="9580.69" y="-2405.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="9580.69" y="-2390.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="9580.69" y="-2375.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_gpu_7&#45;&gt;layer_3_attn_allreduce_7 -->
<g id="edge541" class="edge">
<title>layer_3_attn_gpu_7&#45;&gt;layer_3_attn_allreduce_7</title>
<path fill="none" stroke="black" d="M9880.53,-2577.96C9880.53,-2577.96 9880.53,-2480.33 9880.53,-2480.33"/>
<polygon fill="black" stroke="black" points="9884.03,-2480.33 9880.53,-2470.33 9877.03,-2480.33 9884.03,-2480.33"/>
</g>
<!-- layer_3_attn_proj_0 -->
<g id="node306" class="node">
<title>layer_3_attn_proj_0</title>
<polygon fill="#e6f3ff" stroke="black" points="11496.69,-2226.17 11042.69,-2226.17 11042.69,-2158.17 11496.69,-2158.17 11496.69,-2226.17"/>
<text text-anchor="middle" x="11269.69" y="-2210.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="11269.69" y="-2195.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="11269.69" y="-2180.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11269.69" y="-2165.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_allreduce_0&#45;&gt;layer_3_attn_proj_0 -->
<g id="edge542" class="edge">
<title>layer_3_attn_allreduce_0&#45;&gt;layer_3_attn_proj_0</title>
<path fill="none" stroke="black" d="M10863.81,-2366.48C10863.81,-2327.03 10863.81,-2269 10863.81,-2269 10863.81,-2269 11269.69,-2269 11269.69,-2269 11269.69,-2269 11269.69,-2236.54 11269.69,-2236.54"/>
<polygon fill="black" stroke="black" points="11273.19,-2236.54 11269.69,-2226.54 11266.19,-2236.54 11273.19,-2236.54"/>
</g>
<!-- layer_3_attn_proj_1 -->
<g id="node307" class="node">
<title>layer_3_attn_proj_1</title>
<polygon fill="#e6f3ff" stroke="black" points="11968.69,-2226.17 11514.69,-2226.17 11514.69,-2158.17 11968.69,-2158.17 11968.69,-2226.17"/>
<text text-anchor="middle" x="11741.69" y="-2210.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="11741.69" y="-2195.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="11741.69" y="-2180.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11741.69" y="-2165.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_allreduce_1&#45;&gt;layer_3_attn_proj_1 -->
<g id="edge543" class="edge">
<title>layer_3_attn_allreduce_1&#45;&gt;layer_3_attn_proj_1</title>
<path fill="none" stroke="black" d="M11741.69,-2333.99C11741.69,-2333.99 11741.69,-2236.2 11741.69,-2236.2"/>
<polygon fill="black" stroke="black" points="11745.19,-2236.2 11741.69,-2226.2 11738.19,-2236.2 11745.19,-2236.2"/>
</g>
<!-- layer_3_attn_proj_2 -->
<g id="node308" class="node">
<title>layer_3_attn_proj_2</title>
<polygon fill="#e6f3ff" stroke="black" points="12440.69,-2226.17 11986.69,-2226.17 11986.69,-2158.17 12440.69,-2158.17 12440.69,-2226.17"/>
<text text-anchor="middle" x="12213.69" y="-2210.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="12213.69" y="-2195.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="12213.69" y="-2180.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12213.69" y="-2165.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_allreduce_2&#45;&gt;layer_3_attn_proj_2 -->
<g id="edge544" class="edge">
<title>layer_3_attn_allreduce_2&#45;&gt;layer_3_attn_proj_2</title>
<path fill="none" stroke="black" d="M12213.84,-2333.99C12213.84,-2333.99 12213.84,-2236.2 12213.84,-2236.2"/>
<polygon fill="black" stroke="black" points="12217.34,-2236.2 12213.84,-2226.2 12210.34,-2236.2 12217.34,-2236.2"/>
</g>
<!-- layer_3_attn_proj_3 -->
<g id="node309" class="node">
<title>layer_3_attn_proj_3</title>
<polygon fill="#e6f3ff" stroke="black" points="12912.69,-2226.17 12458.69,-2226.17 12458.69,-2158.17 12912.69,-2158.17 12912.69,-2226.17"/>
<text text-anchor="middle" x="12685.69" y="-2210.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="12685.69" y="-2195.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="12685.69" y="-2180.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12685.69" y="-2165.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_allreduce_3&#45;&gt;layer_3_attn_proj_3 -->
<g id="edge545" class="edge">
<title>layer_3_attn_allreduce_3&#45;&gt;layer_3_attn_proj_3</title>
<path fill="none" stroke="black" d="M13092.23,-2333.83C13092.23,-2321.25 13092.23,-2312 13092.23,-2312 13092.23,-2312 12685.69,-2312 12685.69,-2312 12685.69,-2312 12685.69,-2236.19 12685.69,-2236.19"/>
<polygon fill="black" stroke="black" points="12689.19,-2236.19 12685.69,-2226.19 12682.19,-2236.19 12689.19,-2236.19"/>
</g>
<!-- layer_3_attn_proj_4 -->
<g id="node310" class="node">
<title>layer_3_attn_proj_4</title>
<polygon fill="#e6f3ff" stroke="black" points="13384.69,-2226.17 12930.69,-2226.17 12930.69,-2158.17 13384.69,-2158.17 13384.69,-2226.17"/>
<text text-anchor="middle" x="13157.69" y="-2210.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="13157.69" y="-2195.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="13157.69" y="-2180.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13157.69" y="-2165.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_allreduce_4&#45;&gt;layer_3_attn_proj_4 -->
<g id="edge546" class="edge">
<title>layer_3_attn_allreduce_4&#45;&gt;layer_3_attn_proj_4</title>
<path fill="none" stroke="black" d="M14637.18,-2334.01C14637.18,-2310.52 14637.18,-2290 14637.18,-2290 14637.18,-2290 13238.46,-2290 13238.46,-2290 13238.46,-2290 13238.46,-2236.38 13238.46,-2236.38"/>
<polygon fill="black" stroke="black" points="13241.96,-2236.38 13238.46,-2226.38 13234.96,-2236.38 13241.96,-2236.38"/>
</g>
<!-- layer_3_attn_proj_5 -->
<g id="node311" class="node">
<title>layer_3_attn_proj_5</title>
<polygon fill="#e6f3ff" stroke="black" points="13856.69,-2226.17 13402.69,-2226.17 13402.69,-2158.17 13856.69,-2158.17 13856.69,-2226.17"/>
<text text-anchor="middle" x="13629.69" y="-2210.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="13629.69" y="-2195.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="13629.69" y="-2180.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13629.69" y="-2165.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_allreduce_5&#45;&gt;layer_3_attn_proj_5 -->
<g id="edge547" class="edge">
<title>layer_3_attn_allreduce_5&#45;&gt;layer_3_attn_proj_5</title>
<path fill="none" stroke="black" d="M15700.77,-2396.17C15700.77,-2363.57 15700.77,-2209 15700.77,-2209 15700.77,-2209 13866.76,-2209 13866.76,-2209"/>
<polygon fill="black" stroke="black" points="13866.76,-2205.5 13856.76,-2209 13866.76,-2212.5 13866.76,-2205.5"/>
</g>
<!-- layer_3_attn_proj_6 -->
<g id="node312" class="node">
<title>layer_3_attn_proj_6</title>
<polygon fill="#e6f3ff" stroke="black" points="10552.69,-2226.17 10098.69,-2226.17 10098.69,-2158.17 10552.69,-2158.17 10552.69,-2226.17"/>
<text text-anchor="middle" x="10325.69" y="-2210.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="10325.69" y="-2195.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="10325.69" y="-2180.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10325.69" y="-2165.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_allreduce_6&#45;&gt;layer_3_attn_proj_6 -->
<g id="edge548" class="edge">
<title>layer_3_attn_allreduce_6&#45;&gt;layer_3_attn_proj_6</title>
<path fill="none" stroke="black" d="M8987.77,-2396.17C8987.77,-2363.57 8987.77,-2209 8987.77,-2209 8987.77,-2209 10088.35,-2209 10088.35,-2209"/>
<polygon fill="black" stroke="black" points="10088.35,-2212.5 10098.35,-2209 10088.35,-2205.5 10088.35,-2212.5"/>
</g>
<!-- layer_3_attn_proj_7 -->
<g id="node313" class="node">
<title>layer_3_attn_proj_7</title>
<polygon fill="#e6f3ff" stroke="black" points="11024.69,-2226.17 10570.69,-2226.17 10570.69,-2158.17 11024.69,-2158.17 11024.69,-2226.17"/>
<text text-anchor="middle" x="10797.69" y="-2210.97" font-family="monospace" font-size="14.00">Attention Output Projection</text>
<text text-anchor="middle" x="10797.69" y="-2195.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="10797.69" y="-2180.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10797.69" y="-2165.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_allreduce_7&#45;&gt;layer_3_attn_proj_7 -->
<g id="edge549" class="edge">
<title>layer_3_attn_allreduce_7&#45;&gt;layer_3_attn_proj_7</title>
<path fill="none" stroke="black" d="M9214.6,-2334.11C9214.6,-2292.42 9214.6,-2247 9214.6,-2247 9214.6,-2247 10717.25,-2247 10717.25,-2247 10717.25,-2247 10717.25,-2236.27 10717.25,-2236.27"/>
<polygon fill="black" stroke="black" points="10720.75,-2236.27 10717.25,-2226.27 10713.75,-2236.27 10720.75,-2236.27"/>
</g>
<!-- layer_3_recv_attn_8 -->
<g id="node314" class="node">
<title>layer_3_recv_attn_8</title>
<polygon fill="#e6ffe6" stroke="black" points="15805.56,-2050.17 15056.51,-2050.17 14863.81,-1914.17 15612.87,-1914.17 15805.56,-2050.17"/>
<text text-anchor="middle" x="15334.69" y="-2000.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="15334.69" y="-1985.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="15334.69" y="-1970.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15334.69" y="-1955.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_8 -->
<g id="edge550" class="edge">
<title>layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_8</title>
<path fill="none" stroke="black" d="M11446.24,-2157.9C11446.24,-2130.98 11446.24,-2098 11446.24,-2098 11446.24,-2098 15073.19,-2098 15073.19,-2098 15073.19,-2098 15073.19,-2060.22 15073.19,-2060.22"/>
<polygon fill="black" stroke="black" points="15076.69,-2060.22 15073.19,-2050.22 15069.69,-2060.22 15076.69,-2060.22"/>
</g>
<!-- layer_3_recv_attn_9 -->
<g id="node315" class="node">
<title>layer_3_recv_attn_9</title>
<polygon fill="#e6ffe6" stroke="black" points="9092.56,-2050.17 8343.51,-2050.17 8150.81,-1914.17 8899.87,-1914.17 9092.56,-2050.17"/>
<text text-anchor="middle" x="8621.69" y="-2000.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="8621.69" y="-1985.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="8621.69" y="-1970.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8621.69" y="-1955.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_9 -->
<g id="edge551" class="edge">
<title>layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_9</title>
<path fill="none" stroke="black" d="M11093.13,-2158.13C11093.13,-2151.21 11093.13,-2146 11093.13,-2146 11093.13,-2146 8464.79,-2146 8464.79,-2146 8464.79,-2146 8464.79,-2060.22 8464.79,-2060.22"/>
<polygon fill="black" stroke="black" points="8468.29,-2060.22 8464.79,-2050.22 8461.29,-2060.22 8468.29,-2060.22"/>
</g>
<!-- layer_3_recv_attn_10 -->
<g id="node316" class="node">
<title>layer_3_recv_attn_10</title>
<polygon fill="#e6ffe6" stroke="black" points="10051.56,-2050.17 9302.51,-2050.17 9109.81,-1914.17 9858.87,-1914.17 10051.56,-2050.17"/>
<text text-anchor="middle" x="9580.69" y="-2000.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="9580.69" y="-1985.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="9580.69" y="-1970.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9580.69" y="-1955.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_10 -->
<g id="edge552" class="edge">
<title>layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_10</title>
<path fill="none" stroke="black" d="M11143.57,-2158.01C11143.57,-2144 11143.57,-2131 11143.57,-2131 11143.57,-2131 9528.39,-2131 9528.39,-2131 9528.39,-2131 9528.39,-2060.48 9528.39,-2060.48"/>
<polygon fill="black" stroke="black" points="9531.89,-2060.48 9528.39,-2050.48 9524.89,-2060.48 9531.89,-2060.48"/>
</g>
<!-- layer_3_recv_attn_11 -->
<g id="node317" class="node">
<title>layer_3_recv_attn_11</title>
<polygon fill="#e6ffe6" stroke="black" points="11010.56,-2050.17 10261.51,-2050.17 10068.81,-1914.17 10817.87,-1914.17 11010.56,-2050.17"/>
<text text-anchor="middle" x="10539.69" y="-2000.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="10539.69" y="-1985.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10539.69" y="-1970.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10539.69" y="-1955.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_11 -->
<g id="edge553" class="edge">
<title>layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_11</title>
<path fill="none" stroke="black" d="M11194.02,-2157.91C11194.02,-2140.09 11194.02,-2122 11194.02,-2122 11194.02,-2122 10770.54,-2122 10770.54,-2122 10770.54,-2122 10770.54,-2060.44 10770.54,-2060.44"/>
<polygon fill="black" stroke="black" points="10774.04,-2060.44 10770.54,-2050.44 10767.04,-2060.44 10774.04,-2060.44"/>
</g>
<!-- layer_3_recv_attn_12 -->
<g id="node318" class="node">
<title>layer_3_recv_attn_12</title>
<polygon fill="#e6ffe6" stroke="black" points="11969.56,-2050.17 11220.51,-2050.17 11027.81,-1914.17 11776.87,-1914.17 11969.56,-2050.17"/>
<text text-anchor="middle" x="11498.69" y="-2000.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="11498.69" y="-1985.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11498.69" y="-1970.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11498.69" y="-1955.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_12 -->
<g id="edge554" class="edge">
<title>layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_12</title>
<path fill="none" stroke="black" d="M11244.46,-2157.96C11244.46,-2157.96 11244.46,-2060.33 11244.46,-2060.33"/>
<polygon fill="black" stroke="black" points="11247.96,-2060.33 11244.46,-2050.33 11240.96,-2060.33 11247.96,-2060.33"/>
</g>
<!-- layer_3_recv_attn_13 -->
<g id="node319" class="node">
<title>layer_3_recv_attn_13</title>
<polygon fill="#e6ffe6" stroke="black" points="12928.56,-2050.17 12179.51,-2050.17 11986.81,-1914.17 12735.87,-1914.17 12928.56,-2050.17"/>
<text text-anchor="middle" x="12457.69" y="-2000.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="12457.69" y="-1985.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12457.69" y="-1970.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12457.69" y="-1955.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_13 -->
<g id="edge555" class="edge">
<title>layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_13</title>
<path fill="none" stroke="black" d="M11294.91,-2157.8C11294.91,-2135.28 11294.91,-2110 11294.91,-2110 11294.91,-2110 12234.47,-2110 12234.47,-2110 12234.47,-2110 12234.47,-2060.2 12234.47,-2060.2"/>
<polygon fill="black" stroke="black" points="12237.97,-2060.2 12234.47,-2050.2 12230.97,-2060.2 12237.97,-2060.2"/>
</g>
<!-- layer_3_recv_attn_14 -->
<g id="node320" class="node">
<title>layer_3_recv_attn_14</title>
<polygon fill="#e6ffe6" stroke="black" points="13887.56,-2050.17 13138.51,-2050.17 12945.81,-1914.17 13694.87,-1914.17 13887.56,-2050.17"/>
<text text-anchor="middle" x="13416.69" y="-2000.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="13416.69" y="-1985.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13416.69" y="-1970.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13416.69" y="-1955.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_14 -->
<g id="edge556" class="edge">
<title>layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_14</title>
<path fill="none" stroke="black" d="M11345.35,-2157.99C11345.35,-2126.95 11345.35,-2086 11345.35,-2086 11345.35,-2086 13105.52,-2086 13105.52,-2086 13105.52,-2086 13105.52,-2037.11 13105.52,-2037.11"/>
<polygon fill="black" stroke="black" points="13109.02,-2037.11 13105.52,-2027.11 13102.02,-2037.11 13109.02,-2037.11"/>
</g>
<!-- layer_3_recv_attn_15 -->
<g id="node321" class="node">
<title>layer_3_recv_attn_15</title>
<polygon fill="#e6ffe6" stroke="black" points="14846.56,-2050.17 14097.51,-2050.17 13904.81,-1914.17 14653.87,-1914.17 14846.56,-2050.17"/>
<text text-anchor="middle" x="14375.69" y="-2000.97" font-family="monospace" font-size="14.00">Receive Attention Output</text>
<text text-anchor="middle" x="14375.69" y="-1985.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14375.69" y="-1970.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14375.69" y="-1955.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_15 -->
<g id="edge557" class="edge">
<title>layer_3_attn_proj_0&#45;&gt;layer_3_recv_attn_15</title>
<path fill="none" stroke="black" d="M11395.8,-2158.15C11395.8,-2128.43 11395.8,-2090 11395.8,-2090 11395.8,-2090 14114.19,-2090 14114.19,-2090 14114.19,-2090 14114.19,-2060.46 14114.19,-2060.46"/>
<polygon fill="black" stroke="black" points="14117.69,-2060.46 14114.19,-2050.46 14110.69,-2060.46 14117.69,-2060.46"/>
</g>
<!-- layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_8 -->
<g id="edge558" class="edge">
<title>layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_8</title>
<path fill="none" stroke="black" d="M11803.6,-2158.11C11803.6,-2131.85 11803.6,-2100 11803.6,-2100 11803.6,-2100 15177.79,-2100 15177.79,-2100 15177.79,-2100 15177.79,-2060.37 15177.79,-2060.37"/>
<polygon fill="black" stroke="black" points="15181.29,-2060.37 15177.79,-2050.37 15174.29,-2060.37 15181.29,-2060.37"/>
</g>
<!-- layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_9 -->
<g id="edge559" class="edge">
<title>layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_9</title>
<path fill="none" stroke="black" d="M11555.96,-2158.02C11555.96,-2149.63 11555.96,-2143 11555.96,-2143 11555.96,-2143 8569.39,-2143 8569.39,-2143 8569.39,-2143 8569.39,-2060.37 8569.39,-2060.37"/>
<polygon fill="black" stroke="black" points="8572.89,-2060.37 8569.39,-2050.37 8565.89,-2060.37 8572.89,-2060.37"/>
</g>
<!-- layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_10 -->
<g id="edge560" class="edge">
<title>layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_10</title>
<path fill="none" stroke="black" d="M11597.23,-2158C11597.23,-2143.11 11597.23,-2129 11597.23,-2129 11597.23,-2129 9632.98,-2129 9632.98,-2129 9632.98,-2129 9632.98,-2060.42 9632.98,-2060.42"/>
<polygon fill="black" stroke="black" points="9636.48,-2060.42 9632.98,-2050.42 9629.48,-2060.42 9636.48,-2060.42"/>
</g>
<!-- layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_11 -->
<g id="edge561" class="edge">
<title>layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_11</title>
<path fill="none" stroke="black" d="M11638.5,-2158.15C11638.5,-2139.05 11638.5,-2119 11638.5,-2119 11638.5,-2119 10810.51,-2119 10810.51,-2119 10810.51,-2119 10810.51,-2060.18 10810.51,-2060.18"/>
<polygon fill="black" stroke="black" points="10814.01,-2060.18 10810.51,-2050.18 10807.01,-2060.18 10814.01,-2060.18"/>
</g>
<!-- layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_12 -->
<g id="edge562" class="edge">
<title>layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_12</title>
<path fill="none" stroke="black" d="M11679.78,-2157.96C11679.78,-2157.96 11679.78,-2060.33 11679.78,-2060.33"/>
<polygon fill="black" stroke="black" points="11683.28,-2060.33 11679.78,-2050.33 11676.28,-2060.33 11683.28,-2060.33"/>
</g>
<!-- layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_13 -->
<g id="edge563" class="edge">
<title>layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_13</title>
<path fill="none" stroke="black" d="M11968.9,-2203C11972.92,-2203 11975.14,-2203 11975.14,-2203 11975.14,-2203 11975.14,-1959 11975.14,-1959 11975.14,-1959 12040.28,-1959 12040.28,-1959"/>
<polygon fill="black" stroke="black" points="12040.28,-1962.5 12050.28,-1959 12040.28,-1955.5 12040.28,-1962.5"/>
</g>
<!-- layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_14 -->
<g id="edge564" class="edge">
<title>layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_14</title>
<path fill="none" stroke="black" d="M11721.05,-2157.7C11721.05,-2135.98 11721.05,-2112 11721.05,-2112 11721.05,-2112 13145.4,-2112 13145.4,-2112 13145.4,-2112 13145.4,-2060.51 13145.4,-2060.51"/>
<polygon fill="black" stroke="black" points="13148.9,-2060.51 13145.4,-2050.51 13141.9,-2060.51 13148.9,-2060.51"/>
</g>
<!-- layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_15 -->
<g id="edge565" class="edge">
<title>layer_3_attn_proj_1&#45;&gt;layer_3_recv_attn_15</title>
<path fill="none" stroke="black" d="M11762.32,-2158.04C11762.32,-2129.35 11762.32,-2093 11762.32,-2093 11762.32,-2093 14218.79,-2093 14218.79,-2093 14218.79,-2093 14218.79,-2060.47 14218.79,-2060.47"/>
<polygon fill="black" stroke="black" points="14222.29,-2060.47 14218.79,-2050.47 14215.29,-2060.47 14222.29,-2060.47"/>
</g>
<!-- layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_8 -->
<g id="edge566" class="edge">
<title>layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_8</title>
<path fill="none" stroke="black" d="M12399.44,-2158.13C12399.44,-2153.34 12399.44,-2150 12399.44,-2150 12399.44,-2150 15282.39,-2150 15282.39,-2150 15282.39,-2150 15282.39,-2060.43 15282.39,-2060.43"/>
<polygon fill="black" stroke="black" points="15285.89,-2060.43 15282.39,-2050.43 15278.89,-2060.43 15285.89,-2060.43"/>
</g>
<!-- layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_9 -->
<g id="edge567" class="edge">
<title>layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_9</title>
<path fill="none" stroke="black" d="M12028.24,-2157.91C12028.24,-2125.24 12028.24,-2081 12028.24,-2081 12028.24,-2081 8673.98,-2081 8673.98,-2081 8673.98,-2081 8673.98,-2060.27 8673.98,-2060.27"/>
<polygon fill="black" stroke="black" points="8677.48,-2060.27 8673.98,-2050.27 8670.48,-2060.27 8677.48,-2060.27"/>
</g>
<!-- layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_10 -->
<g id="edge568" class="edge">
<title>layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_10</title>
<path fill="none" stroke="black" d="M12069.49,-2157.99C12069.49,-2123.09 12069.49,-2074 12069.49,-2074 12069.49,-2074 9737.58,-2074 9737.58,-2074 9737.58,-2074 9737.58,-2060.35 9737.58,-2060.35"/>
<polygon fill="black" stroke="black" points="9741.08,-2060.35 9737.58,-2050.35 9734.08,-2060.35 9741.08,-2060.35"/>
</g>
<!-- layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_11 -->
<g id="edge569" class="edge">
<title>layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_11</title>
<path fill="none" stroke="black" d="M12151.98,-2157.97C12151.98,-2133.55 12151.98,-2105 12151.98,-2105 12151.98,-2105 10850.49,-2105 10850.49,-2105 10850.49,-2105 10850.49,-2060.41 10850.49,-2060.41"/>
<polygon fill="black" stroke="black" points="10853.99,-2060.41 10850.49,-2050.41 10846.99,-2060.41 10853.99,-2060.41"/>
</g>
<!-- layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_12 -->
<g id="edge570" class="edge">
<title>layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_12</title>
<path fill="none" stroke="black" d="M11986.67,-2180C11982.96,-2180 11980.91,-2180 11980.91,-2180 11980.91,-2180 11980.91,-2004 11980.91,-2004 11980.91,-2004 11914.24,-2004 11914.24,-2004"/>
<polygon fill="black" stroke="black" points="11914.24,-2000.5 11904.24,-2004 11914.24,-2007.5 11914.24,-2000.5"/>
</g>
<!-- layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_13 -->
<g id="edge571" class="edge">
<title>layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_13</title>
<path fill="none" stroke="black" d="M12275.71,-2157.96C12275.71,-2157.96 12275.71,-2060.33 12275.71,-2060.33"/>
<polygon fill="black" stroke="black" points="12279.21,-2060.33 12275.71,-2050.33 12272.21,-2060.33 12279.21,-2060.33"/>
</g>
<!-- layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_14 -->
<g id="edge572" class="edge">
<title>layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_14</title>
<path fill="none" stroke="black" d="M12316.95,-2158.08C12316.95,-2141.04 12316.95,-2124 12316.95,-2124 12316.95,-2124 13185.28,-2124 13185.28,-2124 13185.28,-2124 13185.28,-2060.18 13185.28,-2060.18"/>
<polygon fill="black" stroke="black" points="13188.78,-2060.18 13185.28,-2050.18 13181.78,-2060.18 13188.78,-2060.18"/>
</g>
<!-- layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_15 -->
<g id="edge573" class="edge">
<title>layer_3_attn_proj_2&#45;&gt;layer_3_recv_attn_15</title>
<path fill="none" stroke="black" d="M12358.2,-2157.88C12358.2,-2146.18 12358.2,-2136 12358.2,-2136 12358.2,-2136 14323.39,-2136 14323.39,-2136 14323.39,-2136 14323.39,-2060.54 14323.39,-2060.54"/>
<polygon fill="black" stroke="black" points="14326.89,-2060.54 14323.39,-2050.54 14319.89,-2060.54 14326.89,-2060.54"/>
</g>
<!-- layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_8 -->
<g id="edge574" class="edge">
<title>layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_8</title>
<path fill="none" stroke="black" d="M12862.24,-2158.12C12862.24,-2155.01 12862.24,-2153 12862.24,-2153 12862.24,-2153 15386.98,-2153 15386.98,-2153 15386.98,-2153 15386.98,-2060.18 15386.98,-2060.18"/>
<polygon fill="black" stroke="black" points="15390.48,-2060.18 15386.98,-2050.18 15383.48,-2060.18 15390.48,-2060.18"/>
</g>
<!-- layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_9 -->
<g id="edge575" class="edge">
<title>layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_9</title>
<path fill="none" stroke="black" d="M12509.13,-2157.91C12509.13,-2124.28 12509.13,-2078 12509.13,-2078 12509.13,-2078 8778.58,-2078 8778.58,-2078 8778.58,-2078 8778.58,-2060.28 8778.58,-2060.28"/>
<polygon fill="black" stroke="black" points="8782.08,-2060.28 8778.58,-2050.28 8775.08,-2060.28 8782.08,-2060.28"/>
</g>
<!-- layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_10 -->
<g id="edge576" class="edge">
<title>layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_10</title>
<path fill="none" stroke="black" d="M12559.57,-2158.09C12559.57,-2122.25 12559.57,-2071 12559.57,-2071 12559.57,-2071 9842.18,-2071 9842.18,-2071 9842.18,-2071 9842.18,-2060.4 9842.18,-2060.4"/>
<polygon fill="black" stroke="black" points="9845.68,-2060.4 9842.18,-2050.4 9838.68,-2060.4 9845.68,-2060.4"/>
</g>
<!-- layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_11 -->
<g id="edge577" class="edge">
<title>layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_11</title>
<path fill="none" stroke="black" d="M12610.02,-2158.02C12610.02,-2120.66 12610.02,-2066 12610.02,-2066 12610.02,-2066 10890.46,-2066 10890.46,-2066 10890.46,-2066 10890.46,-2060.23 10890.46,-2060.23"/>
<polygon fill="black" stroke="black" points="10893.96,-2060.23 10890.46,-2050.23 10886.96,-2060.23 10893.96,-2060.23"/>
</g>
<!-- layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_12 -->
<g id="edge578" class="edge">
<title>layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_12</title>
<path fill="none" stroke="black" d="M12660.46,-2158.1C12660.46,-2138.21 12660.46,-2117 12660.46,-2117 12660.46,-2117 11844.87,-2117 11844.87,-2117 11844.87,-2117 11844.87,-2060.37 11844.87,-2060.37"/>
<polygon fill="black" stroke="black" points="11848.37,-2060.37 11844.87,-2050.37 11841.37,-2060.37 11848.37,-2060.37"/>
</g>
<!-- layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_13 -->
<g id="edge579" class="edge">
<title>layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_13</title>
<path fill="none" stroke="black" d="M12710.91,-2157.96C12710.91,-2157.96 12710.91,-2060.33 12710.91,-2060.33"/>
<polygon fill="black" stroke="black" points="12714.41,-2060.33 12710.91,-2050.33 12707.41,-2060.33 12714.41,-2060.33"/>
</g>
<!-- layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_14 -->
<g id="edge580" class="edge">
<title>layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_14</title>
<path fill="none" stroke="black" d="M12761.35,-2157.92C12761.35,-2141.78 12761.35,-2126 12761.35,-2126 12761.35,-2126 13225.16,-2126 13225.16,-2126 13225.16,-2126 13225.16,-2060.29 13225.16,-2060.29"/>
<polygon fill="black" stroke="black" points="13228.66,-2060.29 13225.16,-2050.29 13221.66,-2060.29 13228.66,-2060.29"/>
</g>
<!-- layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_15 -->
<g id="edge581" class="edge">
<title>layer_3_attn_proj_3&#45;&gt;layer_3_recv_attn_15</title>
<path fill="none" stroke="black" d="M12811.8,-2157.86C12811.8,-2147.11 12811.8,-2138 12811.8,-2138 12811.8,-2138 14427.98,-2138 14427.98,-2138 14427.98,-2138 14427.98,-2060.52 14427.98,-2060.52"/>
<polygon fill="black" stroke="black" points="14431.48,-2060.52 14427.98,-2050.52 14424.48,-2060.52 14431.48,-2060.52"/>
</g>
<!-- layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_8 -->
<g id="edge582" class="edge">
<title>layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_8</title>
<path fill="none" stroke="black" d="M13344.81,-2157.92C13344.81,-2156.1 13344.81,-2155 13344.81,-2155 13344.81,-2155 15491.58,-2155 15491.58,-2155 15491.58,-2155 15491.58,-2060.47 15491.58,-2060.47"/>
<polygon fill="black" stroke="black" points="15495.08,-2060.47 15491.58,-2050.47 15488.08,-2060.47 15495.08,-2060.47"/>
</g>
<!-- layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_9 -->
<g id="edge583" class="edge">
<title>layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_9</title>
<path fill="none" stroke="black" d="M12942.17,-2158.14C12942.17,-2067.49 12942.17,-1827 12942.17,-1827 12942.17,-1827 8784.79,-1827 8784.79,-1827 8784.79,-1827 8784.79,-1904.11 8784.79,-1904.11"/>
<polygon fill="black" stroke="black" points="8781.29,-1904.11 8784.79,-1914.11 8788.29,-1904.11 8781.29,-1904.11"/>
</g>
<!-- layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_10 -->
<g id="edge584" class="edge">
<title>layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_10</title>
<path fill="none" stroke="black" d="M12938.34,-2158.01C12938.34,-2071.21 12938.34,-1849 12938.34,-1849 12938.34,-1849 9743.79,-1849 9743.79,-1849 9743.79,-1849 9743.79,-1904.02 9743.79,-1904.02"/>
<polygon fill="black" stroke="black" points="9740.29,-1904.02 9743.79,-1914.02 9747.29,-1904.02 9740.29,-1904.02"/>
</g>
<!-- layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_11 -->
<g id="edge585" class="edge">
<title>layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_11</title>
<path fill="none" stroke="black" d="M13065.64,-2158.16C13065.64,-2120.19 13065.64,-2064 13065.64,-2064 13065.64,-2064 10930.43,-2064 10930.43,-2064 10930.43,-2064 10930.43,-2060.49 10930.43,-2060.49"/>
<polygon fill="black" stroke="black" points="10933.93,-2060.49 10930.43,-2050.49 10926.93,-2060.49 10933.93,-2060.49"/>
</g>
<!-- layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_12 -->
<g id="edge586" class="edge">
<title>layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_12</title>
<path fill="none" stroke="black" d="M12934.51,-2158.11C12934.51,-2137.04 12934.51,-2114 12934.51,-2114 12934.51,-2114 11886.14,-2114 11886.14,-2114 11886.14,-2114 11886.14,-2060.4 11886.14,-2060.4"/>
<polygon fill="black" stroke="black" points="11889.64,-2060.4 11886.14,-2050.4 11882.64,-2060.4 11889.64,-2060.4"/>
</g>
<!-- layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_13 -->
<g id="edge587" class="edge">
<title>layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_13</title>
<path fill="none" stroke="black" d="M12930.47,-2192C12922.53,-2192 12917.91,-2192 12917.91,-2192 12917.91,-2192 12917.91,-1992.32 12917.91,-1992.32"/>
<polygon fill="black" stroke="black" points="12921.41,-1992.32 12917.91,-1982.32 12914.41,-1992.32 12921.41,-1992.32"/>
</g>
<!-- layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_14 -->
<g id="edge588" class="edge">
<title>layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_14</title>
<path fill="none" stroke="black" d="M13265.04,-2157.96C13265.04,-2157.96 13265.04,-2060.33 13265.04,-2060.33"/>
<polygon fill="black" stroke="black" points="13268.54,-2060.33 13265.04,-2050.33 13261.54,-2060.33 13268.54,-2060.33"/>
</g>
<!-- layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_15 -->
<g id="edge589" class="edge">
<title>layer_3_attn_proj_4&#45;&gt;layer_3_recv_attn_15</title>
<path fill="none" stroke="black" d="M13304.92,-2158.04C13304.92,-2148.65 13304.92,-2141 13304.92,-2141 13304.92,-2141 14532.58,-2141 14532.58,-2141 14532.58,-2141 14532.58,-2060.45 14532.58,-2060.45"/>
<polygon fill="black" stroke="black" points="14536.08,-2060.45 14532.58,-2050.45 14529.08,-2060.45 14536.08,-2060.45"/>
</g>
<!-- layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_8 -->
<g id="edge590" class="edge">
<title>layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_8</title>
<path fill="none" stroke="black" d="M13856.71,-2192C14374.07,-2192 15596.18,-2192 15596.18,-2192 15596.18,-2192 15596.18,-2060.29 15596.18,-2060.29"/>
<polygon fill="black" stroke="black" points="15599.68,-2060.29 15596.18,-2050.29 15592.68,-2060.29 15599.68,-2060.29"/>
</g>
<!-- layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_9 -->
<g id="edge591" class="edge">
<title>layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_9</title>
<path fill="none" stroke="black" d="M13467.54,-2157.94C13467.54,-2123.67 13467.54,-2076 13467.54,-2076 13467.54,-2076 8883.18,-2076 8883.18,-2076 8883.18,-2076 8883.18,-2060.36 8883.18,-2060.36"/>
<polygon fill="black" stroke="black" points="8886.68,-2060.36 8883.18,-2050.36 8879.68,-2060.36 8886.68,-2060.36"/>
</g>
<!-- layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_10 -->
<g id="edge592" class="edge">
<title>layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_10</title>
<path fill="none" stroke="black" d="M13532.4,-2157.86C13532.4,-2121.41 13532.4,-2069 13532.4,-2069 13532.4,-2069 9946.77,-2069 9946.77,-2069 9946.77,-2069 9946.77,-2060.58 9946.77,-2060.58"/>
<polygon fill="black" stroke="black" points="9950.28,-2060.58 9946.77,-2050.58 9943.28,-2060.58 9950.28,-2060.58"/>
</g>
<!-- layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_11 -->
<g id="edge593" class="edge">
<title>layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_11</title>
<path fill="none" stroke="black" d="M13597.26,-2157.97C13597.26,-2119.4 13597.26,-2062 13597.26,-2062 13597.26,-2062 10970.4,-2062 10970.4,-2062 10970.4,-2062 10970.4,-2060.22 10970.4,-2060.22"/>
<polygon fill="black" stroke="black" points="10973.9,-2060.22 10970.4,-2050.22 10966.9,-2060.22 10973.9,-2060.22"/>
</g>
<!-- layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_12 -->
<g id="edge594" class="edge">
<title>layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_12</title>
<path fill="none" stroke="black" d="M13662.11,-2158.08C13662.11,-2132.54 13662.11,-2102 13662.11,-2102 13662.11,-2102 11927.41,-2102 11927.41,-2102 11927.41,-2102 11927.41,-2060.48 11927.41,-2060.48"/>
<polygon fill="black" stroke="black" points="11930.91,-2060.48 11927.41,-2050.48 11923.91,-2060.48 11930.91,-2060.48"/>
</g>
<!-- layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_13 -->
<g id="edge595" class="edge">
<title>layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_13</title>
<path fill="none" stroke="black" d="M13726.97,-2157.88C13726.97,-2116.38 13726.97,-2052 13726.97,-2052 13726.97,-2052 12923.14,-2052 12923.14,-2052 12923.14,-2052 12923.14,-1992.22 12923.14,-1992.22"/>
<polygon fill="black" stroke="black" points="12926.64,-1992.22 12923.14,-1982.22 12919.64,-1992.22 12926.64,-1992.22"/>
</g>
<!-- layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_14 -->
<g id="edge596" class="edge">
<title>layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_14</title>
<path fill="none" stroke="black" d="M13791.83,-2157.96C13791.83,-2157.96 13791.83,-2060.33 13791.83,-2060.33"/>
<polygon fill="black" stroke="black" points="13795.33,-2060.33 13791.83,-2050.33 13788.33,-2060.33 13795.33,-2060.33"/>
</g>
<!-- layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_15 -->
<g id="edge597" class="edge">
<title>layer_3_attn_proj_5&#45;&gt;layer_3_recv_attn_15</title>
<path fill="none" stroke="black" d="M13856.75,-2175C14182,-2175 14741.77,-2175 14741.77,-2175 14741.77,-2175 14741.77,-2060.42 14741.77,-2060.42"/>
<polygon fill="black" stroke="black" points="14745.28,-2060.42 14741.77,-2050.42 14738.28,-2060.42 14745.28,-2060.42"/>
</g>
<!-- layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_8 -->
<g id="edge598" class="edge">
<title>layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_8</title>
<path fill="none" stroke="black" d="M10487.83,-2157.91C10487.83,-2129.93 10487.83,-2095 10487.83,-2095 10487.83,-2095 14968.6,-2095 14968.6,-2095 14968.6,-2095 14968.6,-1998.23 14968.6,-1998.23"/>
<polygon fill="black" stroke="black" points="14972.1,-1998.23 14968.6,-1988.23 14965.1,-1998.23 14972.1,-1998.23"/>
</g>
<!-- layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_9 -->
<g id="edge599" class="edge">
<title>layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_9</title>
<path fill="none" stroke="black" d="M10098.23,-2192C9560.48,-2192 8255.6,-2192 8255.6,-2192 8255.6,-2192 8255.6,-1998.22 8255.6,-1998.22"/>
<polygon fill="black" stroke="black" points="8259.1,-1998.22 8255.6,-1988.22 8252.1,-1998.22 8259.1,-1998.22"/>
</g>
<!-- layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_10 -->
<g id="edge600" class="edge">
<title>layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_10</title>
<path fill="none" stroke="black" d="M10098.55,-2175C9801.7,-2175 9319.19,-2175 9319.19,-2175 9319.19,-2175 9319.19,-2060.42 9319.19,-2060.42"/>
<polygon fill="black" stroke="black" points="9322.69,-2060.42 9319.19,-2050.42 9315.69,-2060.42 9322.69,-2060.42"/>
</g>
<!-- layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_11 -->
<g id="edge601" class="edge">
<title>layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_11</title>
<path fill="none" stroke="black" d="M10163.54,-2157.96C10163.54,-2157.96 10163.54,-1992.25 10163.54,-1992.25"/>
<polygon fill="black" stroke="black" points="10167.04,-1992.25 10163.54,-1982.25 10160.04,-1992.25 10167.04,-1992.25"/>
</g>
<!-- layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_12 -->
<g id="edge602" class="edge">
<title>layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_12</title>
<path fill="none" stroke="black" d="M10228.4,-2158.01C10228.4,-2117.1 10228.4,-2054 10228.4,-2054 10228.4,-2054 11032.9,-2054 11032.9,-2054 11032.9,-2054 11032.9,-1992.22 11032.9,-1992.22"/>
<polygon fill="black" stroke="black" points="11036.4,-1992.22 11032.9,-1982.22 11029.4,-1992.22 11036.4,-1992.22"/>
</g>
<!-- layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_13 -->
<g id="edge603" class="edge">
<title>layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_13</title>
<path fill="none" stroke="black" d="M10293.26,-2157.93C10293.26,-2125.91 10293.26,-2083 10293.26,-2083 10293.26,-2083 12110.73,-2083 12110.73,-2083 12110.73,-2083 12110.73,-2012.09 12110.73,-2012.09"/>
<polygon fill="black" stroke="black" points="12114.23,-2012.09 12110.73,-2002.09 12107.23,-2012.09 12114.23,-2012.09"/>
</g>
<!-- layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_14 -->
<g id="edge604" class="edge">
<title>layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_14</title>
<path fill="none" stroke="black" d="M10358.11,-2158.06C10358.11,-2118.02 10358.11,-2057 10358.11,-2057 10358.11,-2057 12985.88,-2057 12985.88,-2057 12985.88,-2057 12985.88,-1992.22 12985.88,-1992.22"/>
<polygon fill="black" stroke="black" points="12989.38,-1992.22 12985.88,-1982.22 12982.38,-1992.22 12989.38,-1992.22"/>
</g>
<!-- layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_15 -->
<g id="edge605" class="edge">
<title>layer_3_attn_proj_6&#45;&gt;layer_3_recv_attn_15</title>
<path fill="none" stroke="black" d="M10422.97,-2158.06C10422.97,-2127.68 10422.97,-2088 10422.97,-2088 10422.97,-2088 14009.6,-2088 14009.6,-2088 14009.6,-2088 14009.6,-1998.16 14009.6,-1998.16"/>
<polygon fill="black" stroke="black" points="14013.1,-1998.16 14009.6,-1988.16 14006.1,-1998.16 14013.1,-1998.16"/>
</g>
<!-- layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_8 -->
<g id="edge606" class="edge">
<title>layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_8</title>
<path fill="none" stroke="black" d="M11013.95,-2157.99C11013.95,-2075.08 11013.95,-1870 11013.95,-1870 11013.95,-1870 15018.12,-1870 15018.12,-1870 15018.12,-1870 15018.12,-1904.01 15018.12,-1904.01"/>
<polygon fill="black" stroke="black" points="15014.62,-1904.01 15018.12,-1914.01 15021.62,-1904.01 15014.62,-1904.01"/>
</g>
<!-- layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_9 -->
<g id="edge607" class="edge">
<title>layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_9</title>
<path fill="none" stroke="black" d="M10610.66,-2157.8C10610.66,-2152.1 10610.66,-2148 10610.66,-2148 10610.66,-2148 8360.19,-2148 8360.19,-2148 8360.19,-2148 8360.19,-2060.57 8360.19,-2060.57"/>
<polygon fill="black" stroke="black" points="8363.69,-2060.57 8360.19,-2050.57 8356.69,-2060.57 8363.69,-2060.57"/>
</g>
<!-- layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_10 -->
<g id="edge608" class="edge">
<title>layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_10</title>
<path fill="none" stroke="black" d="M10650.63,-2157.99C10650.63,-2145.33 10650.63,-2134 10650.63,-2134 10650.63,-2134 9423.79,-2134 9423.79,-2134 9423.79,-2134 9423.79,-2060.53 9423.79,-2060.53"/>
<polygon fill="black" stroke="black" points="9427.29,-2060.53 9423.79,-2050.53 9420.29,-2060.53 9427.29,-2060.53"/>
</g>
<!-- layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_11 -->
<g id="edge609" class="edge">
<title>layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_11</title>
<path fill="none" stroke="black" d="M10690.6,-2157.96C10690.6,-2157.96 10690.6,-2060.33 10690.6,-2060.33"/>
<polygon fill="black" stroke="black" points="10694.1,-2060.33 10690.6,-2050.33 10687.1,-2060.33 10694.1,-2060.33"/>
</g>
<!-- layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_12 -->
<g id="edge610" class="edge">
<title>layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_12</title>
<path fill="none" stroke="black" d="M11024.88,-2192C11033.04,-2192 11037.79,-2192 11037.79,-2192 11037.79,-2192 11037.79,-1992.32 11037.79,-1992.32"/>
<polygon fill="black" stroke="black" points="11041.29,-1992.32 11037.79,-1982.32 11034.29,-1992.32 11041.29,-1992.32"/>
</g>
<!-- layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_13 -->
<g id="edge611" class="edge">
<title>layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_13</title>
<path fill="none" stroke="black" d="M11021.11,-2158.02C11021.11,-2134.32 11021.11,-2107 11021.11,-2107 11021.11,-2107 12193.22,-2107 12193.22,-2107 12193.22,-2107 12193.22,-2060.43 12193.22,-2060.43"/>
<polygon fill="black" stroke="black" points="12196.72,-2060.43 12193.22,-2050.43 12189.72,-2060.43 12196.72,-2060.43"/>
</g>
<!-- layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_14 -->
<g id="edge612" class="edge">
<title>layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_14</title>
<path fill="none" stroke="black" d="M10730.57,-2157.87C10730.57,-2118.42 10730.57,-2059 10730.57,-2059 10730.57,-2059 13025.76,-2059 13025.76,-2059 13025.76,-2059 13025.76,-1992.22 13025.76,-1992.22"/>
<polygon fill="black" stroke="black" points="13029.26,-1992.22 13025.76,-1982.22 13022.26,-1992.22 13029.26,-1992.22"/>
</g>
<!-- layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_15 -->
<g id="edge613" class="edge">
<title>layer_3_attn_proj_7&#45;&gt;layer_3_recv_attn_15</title>
<path fill="none" stroke="black" d="M11017.53,-2158.03C11017.53,-2079.35 11017.53,-1892 11017.53,-1892 11017.53,-1892 14059.12,-1892 14059.12,-1892 14059.12,-1892 14059.12,-1903.83 14059.12,-1903.83"/>
<polygon fill="black" stroke="black" points="14055.62,-1903.83 14059.12,-1913.83 14062.62,-1903.83 14055.62,-1903.83"/>
</g>
<!-- layer_3_recv_attn_8&#45;&gt;layer_3_residual1 -->
<g id="edge614" class="edge">
<title>layer_3_recv_attn_8&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M15172.25,-1914.11C15172.25,-1842.17 15172.25,-1739 15172.25,-1739 15172.25,-1739 11735.71,-1739 11735.71,-1739"/>
<polygon fill="black" stroke="black" points="11735.71,-1735.5 11725.71,-1739 11735.71,-1742.5 11735.71,-1735.5"/>
</g>
<!-- layer_3_recv_attn_9&#45;&gt;layer_3_residual1 -->
<g id="edge615" class="edge">
<title>layer_3_recv_attn_9&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M8938.58,-1941.47C8938.58,-1872.24 8938.58,-1739 8938.58,-1739 8938.58,-1739 11261.49,-1739 11261.49,-1739"/>
<polygon fill="black" stroke="black" points="11261.49,-1742.5 11271.49,-1739 11261.49,-1735.5 11261.49,-1742.5"/>
</g>
<!-- layer_3_recv_attn_10&#45;&gt;layer_3_residual1 -->
<g id="edge616" class="edge">
<title>layer_3_recv_attn_10&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M9897.58,-1941.47C9897.58,-1876.36 9897.58,-1756 9897.58,-1756 9897.58,-1756 11261.41,-1756 11261.41,-1756"/>
<polygon fill="black" stroke="black" points="11261.41,-1759.5 11271.41,-1756 11261.41,-1752.5 11261.41,-1759.5"/>
</g>
<!-- layer_3_recv_attn_11&#45;&gt;layer_3_residual1 -->
<g id="edge617" class="edge">
<title>layer_3_recv_attn_11&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M10779.69,-1914.06C10779.69,-1858.45 10779.69,-1789 10779.69,-1789 10779.69,-1789 11261.68,-1789 11261.68,-1789"/>
<polygon fill="black" stroke="black" points="11261.68,-1792.5 11271.68,-1789 11261.68,-1785.5 11261.68,-1792.5"/>
</g>
<!-- layer_3_recv_attn_12&#45;&gt;layer_3_residual1 -->
<g id="edge618" class="edge">
<title>layer_3_recv_attn_12&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M11498.69,-1913.94C11498.69,-1913.94 11498.69,-1816.38 11498.69,-1816.38"/>
<polygon fill="black" stroke="black" points="11502.19,-1816.38 11498.69,-1806.38 11495.19,-1816.38 11502.19,-1816.38"/>
</g>
<!-- layer_3_recv_attn_13&#45;&gt;layer_3_residual1 -->
<g id="edge619" class="edge">
<title>layer_3_recv_attn_13&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M12218.19,-1914.06C12218.19,-1858.45 12218.19,-1789 12218.19,-1789 12218.19,-1789 11735.85,-1789 11735.85,-1789"/>
<polygon fill="black" stroke="black" points="11735.85,-1785.5 11725.85,-1789 11735.85,-1792.5 11735.85,-1785.5"/>
</g>
<!-- layer_3_recv_attn_14&#45;&gt;layer_3_residual1 -->
<g id="edge620" class="edge">
<title>layer_3_recv_attn_14&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M13177.19,-1913.93C13177.19,-1852.56 13177.19,-1772 13177.19,-1772 13177.19,-1772 11735.93,-1772 11735.93,-1772"/>
<polygon fill="black" stroke="black" points="11735.93,-1768.5 11725.93,-1772 11735.93,-1775.5 11735.93,-1768.5"/>
</g>
<!-- layer_3_recv_attn_15&#45;&gt;layer_3_residual1 -->
<g id="edge621" class="edge">
<title>layer_3_recv_attn_15&#45;&gt;layer_3_residual1</title>
<path fill="none" stroke="black" d="M14213.25,-1914C14213.25,-1847.41 14213.25,-1756 14213.25,-1756 14213.25,-1756 11735.75,-1756 11735.75,-1756"/>
<polygon fill="black" stroke="black" points="11735.75,-1752.5 11725.75,-1756 11735.75,-1759.5 11735.75,-1752.5"/>
</g>
<!-- layer_3_ln2 -->
<g id="node323" class="node">
<title>layer_3_ln2</title>
<polygon fill="#ffe6e6" stroke="black" points="11725.69,-1615.17 11271.69,-1615.17 11271.69,-1547.17 11725.69,-1547.17 11725.69,-1615.17"/>
<text text-anchor="middle" x="11498.69" y="-1599.97" font-family="monospace" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11498.69" y="-1584.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11498.69" y="-1569.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11498.69" y="-1554.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_residual1&#45;&gt;layer_3_ln2 -->
<g id="edge623" class="edge">
<title>layer_3_residual1&#45;&gt;layer_3_ln2</title>
<path fill="none" stroke="black" d="M11498.69,-1723.03C11498.69,-1723.03 11498.69,-1625.27 11498.69,-1625.27"/>
<polygon fill="black" stroke="black" points="11502.19,-1625.27 11498.69,-1615.27 11495.19,-1625.27 11502.19,-1625.27"/>
</g>
<!-- layer_3_gate -->
<g id="node324" class="node">
<title>layer_3_gate</title>
<polygon fill="#ffe6e6" stroke="black" points="11960.97,-1439.17 11225.58,-1439.17 11036.4,-1303.17 11771.79,-1303.17 11960.97,-1439.17"/>
<text text-anchor="middle" x="11498.69" y="-1389.97" font-family="monospace" font-size="14.00">Gate (Top&#45;2 routing)</text>
<text text-anchor="middle" x="11498.69" y="-1374.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11498.69" y="-1359.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, top_k=2]</text>
<text text-anchor="middle" x="11498.69" y="-1344.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_gate -->
<g id="edge624" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" d="M11498.69,-1546.96C11498.69,-1546.96 11498.69,-1449.33 11498.69,-1449.33"/>
<polygon fill="black" stroke="black" points="11502.19,-1449.33 11498.69,-1439.33 11495.19,-1449.33 11502.19,-1449.33"/>
</g>
<!-- layer_3_expert_select_8 -->
<g id="node341" class="node">
<title>layer_3_expert_select_8</title>
<polygon fill="#ffe6e6" stroke="black" points="8613.56,-1195.17 7864.51,-1195.17 7671.81,-1059.17 8420.87,-1059.17 8613.56,-1195.17"/>
<text text-anchor="middle" x="8142.69" y="-1145.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="8142.69" y="-1130.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8142.69" y="-1115.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8142.69" y="-1100.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_select_8 -->
<g id="edge625" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_select_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11178,-1405C10382.47,-1405 8382.19,-1405 8382.19,-1405 8382.19,-1405 8382.19,-1205.49 8382.19,-1205.49"/>
<polygon fill="black" stroke="black" points="8385.69,-1205.49 8382.19,-1195.49 8378.69,-1205.49 8385.69,-1205.49"/>
</g>
<!-- layer_3_expert_select_9 -->
<g id="node342" class="node">
<title>layer_3_expert_select_9</title>
<polygon fill="#ffe6e6" stroke="black" points="9572.56,-1195.17 8823.51,-1195.17 8630.81,-1059.17 9379.87,-1059.17 9572.56,-1195.17"/>
<text text-anchor="middle" x="9101.69" y="-1145.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="9101.69" y="-1130.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9101.69" y="-1115.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9101.69" y="-1100.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_select_9 -->
<g id="edge626" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_select_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11130.56,-1371C10514.43,-1371 9341.19,-1371 9341.19,-1371 9341.19,-1371 9341.19,-1205.41 9341.19,-1205.41"/>
<polygon fill="black" stroke="black" points="9344.69,-1205.41 9341.19,-1195.41 9337.69,-1205.41 9344.69,-1205.41"/>
</g>
<!-- layer_3_expert_select_10 -->
<g id="node343" class="node">
<title>layer_3_expert_select_10</title>
<polygon fill="#ffe6e6" stroke="black" points="10531.56,-1195.17 9782.51,-1195.17 9589.81,-1059.17 10338.87,-1059.17 10531.56,-1195.17"/>
<text text-anchor="middle" x="10060.69" y="-1145.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="10060.69" y="-1130.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10060.69" y="-1115.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10060.69" y="-1100.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_select_10 -->
<g id="edge627" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_select_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11083.29,-1337C10737.07,-1337 10300.19,-1337 10300.19,-1337 10300.19,-1337 10300.19,-1205.29 10300.19,-1205.29"/>
<polygon fill="black" stroke="black" points="10303.69,-1205.29 10300.19,-1195.29 10296.69,-1205.29 10303.69,-1205.29"/>
</g>
<!-- layer_3_expert_select_11 -->
<g id="node344" class="node">
<title>layer_3_expert_select_11</title>
<polygon fill="#ffe6e6" stroke="black" points="11490.56,-1195.17 10741.51,-1195.17 10548.81,-1059.17 11297.87,-1059.17 11490.56,-1195.17"/>
<text text-anchor="middle" x="11019.69" y="-1145.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="11019.69" y="-1130.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11019.69" y="-1115.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11019.69" y="-1100.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_select_11 -->
<g id="edge628" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_select_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11263.33,-1302.87C11263.33,-1302.87 11263.33,-1205.44 11263.33,-1205.44"/>
<polygon fill="black" stroke="black" points="11266.83,-1205.44 11263.33,-1195.44 11259.83,-1205.44 11266.83,-1205.44"/>
</g>
<!-- layer_3_expert_select_12 -->
<g id="node345" class="node">
<title>layer_3_expert_select_12</title>
<polygon fill="#ffe6e6" stroke="black" points="12449.56,-1195.17 11700.51,-1195.17 11507.81,-1059.17 12256.87,-1059.17 12449.56,-1195.17"/>
<text text-anchor="middle" x="11978.69" y="-1145.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="11978.69" y="-1130.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11978.69" y="-1115.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11978.69" y="-1100.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_select_12 -->
<g id="edge629" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_select_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11734.54,-1302.87C11734.54,-1302.87 11734.54,-1205.44 11734.54,-1205.44"/>
<polygon fill="black" stroke="black" points="11738.04,-1205.44 11734.54,-1195.44 11731.04,-1205.44 11738.04,-1205.44"/>
</g>
<!-- layer_3_expert_select_13 -->
<g id="node346" class="node">
<title>layer_3_expert_select_13</title>
<polygon fill="#ffe6e6" stroke="black" points="13408.56,-1195.17 12659.51,-1195.17 12466.81,-1059.17 13215.87,-1059.17 13408.56,-1195.17"/>
<text text-anchor="middle" x="12937.69" y="-1145.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="12937.69" y="-1130.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12937.69" y="-1115.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12937.69" y="-1100.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_select_13 -->
<g id="edge630" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_select_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11819.21,-1337C12174.38,-1337 12697.69,-1337 12697.69,-1337 12697.69,-1337 12697.69,-1205.29 12697.69,-1205.29"/>
<polygon fill="black" stroke="black" points="12701.19,-1205.29 12697.69,-1195.29 12694.19,-1205.29 12701.19,-1205.29"/>
</g>
<!-- layer_3_expert_select_14 -->
<g id="node347" class="node">
<title>layer_3_expert_select_14</title>
<polygon fill="#ffe6e6" stroke="black" points="14367.56,-1195.17 13618.51,-1195.17 13425.81,-1059.17 14174.87,-1059.17 14367.56,-1195.17"/>
<text text-anchor="middle" x="13896.69" y="-1145.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="13896.69" y="-1130.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13896.69" y="-1115.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13896.69" y="-1100.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_select_14 -->
<g id="edge631" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_select_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11866.29,-1371C12482.39,-1371 13656.69,-1371 13656.69,-1371 13656.69,-1371 13656.69,-1205.41 13656.69,-1205.41"/>
<polygon fill="black" stroke="black" points="13660.19,-1205.41 13656.69,-1195.41 13653.19,-1205.41 13660.19,-1205.41"/>
</g>
<!-- layer_3_expert_select_15 -->
<g id="node348" class="node">
<title>layer_3_expert_select_15</title>
<polygon fill="#ffe6e6" stroke="black" points="15326.56,-1195.17 14577.51,-1195.17 14384.81,-1059.17 15133.87,-1059.17 15326.56,-1195.17"/>
<text text-anchor="middle" x="14855.69" y="-1145.97" font-family="monospace" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="14855.69" y="-1130.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14855.69" y="-1115.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14855.69" y="-1100.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_select_15 -->
<g id="edge632" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_select_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11913.81,-1405C12762.25,-1405 14615.69,-1405 14615.69,-1405 14615.69,-1405 14615.69,-1205.49 14615.69,-1205.49"/>
<polygon fill="black" stroke="black" points="14619.19,-1205.49 14615.69,-1195.49 14612.19,-1205.49 14619.19,-1205.49"/>
</g>
<!-- layer_3_expert_0_gpu_8 -->
<g id="node325" class="node">
<title>layer_3_expert_0_gpu_8</title>
<polygon fill="#ffe6e6" stroke="black" points="8186.69,-951.17 7732.69,-951.17 7732.69,-883.17 8186.69,-883.17 8186.69,-951.17"/>
<text text-anchor="middle" x="7959.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7959.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="7959.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7959.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_8 -->
<g id="node349" class="node">
<title>layer_3_expert_agg_8</title>
<polygon fill="#fff0e6" stroke="black" points="8613.56,-775.17 7864.51,-775.17 7671.81,-639.17 8420.87,-639.17 8613.56,-775.17"/>
<text text-anchor="middle" x="8142.69" y="-725.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8142.69" y="-710.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8142.69" y="-695.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8142.69" y="-680.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_0_gpu_8&#45;&gt;layer_3_expert_agg_8 -->
<g id="edge649" class="edge">
<title>layer_3_expert_0_gpu_8&#45;&gt;layer_3_expert_agg_8</title>
<path fill="none" stroke="black" d="M7959.69,-882.96C7959.69,-882.96 7959.69,-785.33 7959.69,-785.33"/>
<polygon fill="black" stroke="black" points="7963.19,-785.33 7959.69,-775.33 7956.19,-785.33 7963.19,-785.33"/>
</g>
<!-- layer_3_expert_1_gpu_8 -->
<g id="node326" class="node">
<title>layer_3_expert_1_gpu_8</title>
<polygon fill="#ffe6e6" stroke="black" points="8658.69,-951.17 8204.69,-951.17 8204.69,-883.17 8658.69,-883.17 8658.69,-951.17"/>
<text text-anchor="middle" x="8431.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8431.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8431.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8431.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_1_gpu_8&#45;&gt;layer_3_expert_agg_8 -->
<g id="edge650" class="edge">
<title>layer_3_expert_1_gpu_8&#45;&gt;layer_3_expert_agg_8</title>
<path fill="none" stroke="black" d="M8409.03,-882.96C8409.03,-882.96 8409.03,-785.33 8409.03,-785.33"/>
<polygon fill="black" stroke="black" points="8412.53,-785.33 8409.03,-775.33 8405.53,-785.33 8412.53,-785.33"/>
</g>
<!-- layer_3_expert_2_gpu_9 -->
<g id="node327" class="node">
<title>layer_3_expert_2_gpu_9</title>
<polygon fill="#ffe6e6" stroke="black" points="9229.69,-951.17 8775.69,-951.17 8775.69,-883.17 9229.69,-883.17 9229.69,-951.17"/>
<text text-anchor="middle" x="9002.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9002.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9002.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9002.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_9 -->
<g id="node350" class="node">
<title>layer_3_expert_agg_9</title>
<polygon fill="#fff0e6" stroke="black" points="9572.56,-775.17 8823.51,-775.17 8630.81,-639.17 9379.87,-639.17 9572.56,-775.17"/>
<text text-anchor="middle" x="9101.69" y="-725.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9101.69" y="-710.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9101.69" y="-695.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9101.69" y="-680.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_2_gpu_9&#45;&gt;layer_3_expert_agg_9 -->
<g id="edge651" class="edge">
<title>layer_3_expert_2_gpu_9&#45;&gt;layer_3_expert_agg_9</title>
<path fill="none" stroke="black" d="M9002.69,-882.96C9002.69,-882.96 9002.69,-785.33 9002.69,-785.33"/>
<polygon fill="black" stroke="black" points="9006.19,-785.33 9002.69,-775.33 8999.19,-785.33 9006.19,-785.33"/>
</g>
<!-- layer_3_expert_3_gpu_9 -->
<g id="node328" class="node">
<title>layer_3_expert_3_gpu_9</title>
<polygon fill="#ffe6e6" stroke="black" points="9701.69,-951.17 9247.69,-951.17 9247.69,-883.17 9701.69,-883.17 9701.69,-951.17"/>
<text text-anchor="middle" x="9474.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9474.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9474.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9474.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_3_gpu_9&#45;&gt;layer_3_expert_agg_9 -->
<g id="edge652" class="edge">
<title>layer_3_expert_3_gpu_9&#45;&gt;layer_3_expert_agg_9</title>
<path fill="none" stroke="black" d="M9410.03,-882.96C9410.03,-882.96 9410.03,-785.33 9410.03,-785.33"/>
<polygon fill="black" stroke="black" points="9413.53,-785.33 9410.03,-775.33 9406.53,-785.33 9413.53,-785.33"/>
</g>
<!-- layer_3_expert_4_gpu_10 -->
<g id="node329" class="node">
<title>layer_3_expert_4_gpu_10</title>
<polygon fill="#ffe6e6" stroke="black" points="10230.69,-951.17 9776.69,-951.17 9776.69,-883.17 10230.69,-883.17 10230.69,-951.17"/>
<text text-anchor="middle" x="10003.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10003.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10003.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10003.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_10 -->
<g id="node351" class="node">
<title>layer_3_expert_agg_10</title>
<polygon fill="#fff0e6" stroke="black" points="10531.56,-775.17 9782.51,-775.17 9589.81,-639.17 10338.87,-639.17 10531.56,-775.17"/>
<text text-anchor="middle" x="10060.69" y="-725.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10060.69" y="-710.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10060.69" y="-695.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10060.69" y="-680.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_4_gpu_10&#45;&gt;layer_3_expert_agg_10 -->
<g id="edge653" class="edge">
<title>layer_3_expert_4_gpu_10&#45;&gt;layer_3_expert_agg_10</title>
<path fill="none" stroke="black" d="M10003.69,-882.96C10003.69,-882.96 10003.69,-785.33 10003.69,-785.33"/>
<polygon fill="black" stroke="black" points="10007.19,-785.33 10003.69,-775.33 10000.19,-785.33 10007.19,-785.33"/>
</g>
<!-- layer_3_expert_5_gpu_10 -->
<g id="node330" class="node">
<title>layer_3_expert_5_gpu_10</title>
<polygon fill="#ffe6e6" stroke="black" points="10702.69,-951.17 10248.69,-951.17 10248.69,-883.17 10702.69,-883.17 10702.69,-951.17"/>
<text text-anchor="middle" x="10475.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10475.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10475.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10475.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_5_gpu_10&#45;&gt;layer_3_expert_agg_10 -->
<g id="edge654" class="edge">
<title>layer_3_expert_5_gpu_10&#45;&gt;layer_3_expert_agg_10</title>
<path fill="none" stroke="black" d="M10390.03,-882.96C10390.03,-882.96 10390.03,-785.33 10390.03,-785.33"/>
<polygon fill="black" stroke="black" points="10393.53,-785.33 10390.03,-775.33 10386.53,-785.33 10393.53,-785.33"/>
</g>
<!-- layer_3_expert_6_gpu_11 -->
<g id="node331" class="node">
<title>layer_3_expert_6_gpu_11</title>
<polygon fill="#ffe6e6" stroke="black" points="11210.69,-951.17 10756.69,-951.17 10756.69,-883.17 11210.69,-883.17 11210.69,-951.17"/>
<text text-anchor="middle" x="10983.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10983.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="10983.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10983.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_11 -->
<g id="node352" class="node">
<title>layer_3_expert_agg_11</title>
<polygon fill="#fff0e6" stroke="black" points="11490.56,-775.17 10741.51,-775.17 10548.81,-639.17 11297.87,-639.17 11490.56,-775.17"/>
<text text-anchor="middle" x="11019.69" y="-725.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11019.69" y="-710.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11019.69" y="-695.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11019.69" y="-680.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_6_gpu_11&#45;&gt;layer_3_expert_agg_11 -->
<g id="edge655" class="edge">
<title>layer_3_expert_6_gpu_11&#45;&gt;layer_3_expert_agg_11</title>
<path fill="none" stroke="black" d="M10983.69,-882.96C10983.69,-882.96 10983.69,-785.33 10983.69,-785.33"/>
<polygon fill="black" stroke="black" points="10987.19,-785.33 10983.69,-775.33 10980.19,-785.33 10987.19,-785.33"/>
</g>
<!-- layer_3_expert_7_gpu_11 -->
<g id="node332" class="node">
<title>layer_3_expert_7_gpu_11</title>
<polygon fill="#ffe6e6" stroke="black" points="11682.69,-951.17 11228.69,-951.17 11228.69,-883.17 11682.69,-883.17 11682.69,-951.17"/>
<text text-anchor="middle" x="11455.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="11455.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11455.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11455.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_7_gpu_11&#45;&gt;layer_3_expert_agg_11 -->
<g id="edge656" class="edge">
<title>layer_3_expert_7_gpu_11&#45;&gt;layer_3_expert_agg_11</title>
<path fill="none" stroke="black" d="M11359.53,-882.96C11359.53,-882.96 11359.53,-785.33 11359.53,-785.33"/>
<polygon fill="black" stroke="black" points="11363.03,-785.33 11359.53,-775.33 11356.03,-785.33 11363.03,-785.33"/>
</g>
<!-- layer_3_expert_8_gpu_12 -->
<g id="node333" class="node">
<title>layer_3_expert_8_gpu_12</title>
<polygon fill="#ffe6e6" stroke="black" points="12179.69,-951.17 11725.69,-951.17 11725.69,-883.17 12179.69,-883.17 12179.69,-951.17"/>
<text text-anchor="middle" x="11952.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="11952.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11952.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11952.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_12 -->
<g id="node353" class="node">
<title>layer_3_expert_agg_12</title>
<polygon fill="#fff0e6" stroke="black" points="12449.56,-775.17 11700.51,-775.17 11507.81,-639.17 12256.87,-639.17 12449.56,-775.17"/>
<text text-anchor="middle" x="11978.69" y="-725.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11978.69" y="-710.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11978.69" y="-695.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11978.69" y="-680.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_8_gpu_12&#45;&gt;layer_3_expert_agg_12 -->
<g id="edge657" class="edge">
<title>layer_3_expert_8_gpu_12&#45;&gt;layer_3_expert_agg_12</title>
<path fill="none" stroke="black" d="M11952.69,-882.96C11952.69,-882.96 11952.69,-785.33 11952.69,-785.33"/>
<polygon fill="black" stroke="black" points="11956.19,-785.33 11952.69,-775.33 11949.19,-785.33 11956.19,-785.33"/>
</g>
<!-- layer_3_expert_9_gpu_12 -->
<g id="node334" class="node">
<title>layer_3_expert_9_gpu_12</title>
<polygon fill="#ffe6e6" stroke="black" points="12651.69,-951.17 12197.69,-951.17 12197.69,-883.17 12651.69,-883.17 12651.69,-951.17"/>
<text text-anchor="middle" x="12424.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="12424.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="12424.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12424.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_9_gpu_12&#45;&gt;layer_3_expert_agg_12 -->
<g id="edge658" class="edge">
<title>layer_3_expert_9_gpu_12&#45;&gt;layer_3_expert_agg_12</title>
<path fill="none" stroke="black" d="M12323.53,-882.96C12323.53,-882.96 12323.53,-785.33 12323.53,-785.33"/>
<polygon fill="black" stroke="black" points="12327.03,-785.33 12323.53,-775.33 12320.03,-785.33 12327.03,-785.33"/>
</g>
<!-- layer_3_expert_10_gpu_13 -->
<g id="node335" class="node">
<title>layer_3_expert_10_gpu_13</title>
<polygon fill="#ffe6e6" stroke="black" points="13143.69,-951.17 12689.69,-951.17 12689.69,-883.17 13143.69,-883.17 13143.69,-951.17"/>
<text text-anchor="middle" x="12916.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="12916.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12916.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12916.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_13 -->
<g id="node354" class="node">
<title>layer_3_expert_agg_13</title>
<polygon fill="#fff0e6" stroke="black" points="13408.56,-775.17 12659.51,-775.17 12466.81,-639.17 13215.87,-639.17 13408.56,-775.17"/>
<text text-anchor="middle" x="12937.69" y="-725.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12937.69" y="-710.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12937.69" y="-695.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12937.69" y="-680.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_10_gpu_13&#45;&gt;layer_3_expert_agg_13 -->
<g id="edge659" class="edge">
<title>layer_3_expert_10_gpu_13&#45;&gt;layer_3_expert_agg_13</title>
<path fill="none" stroke="black" d="M12916.69,-882.96C12916.69,-882.96 12916.69,-785.33 12916.69,-785.33"/>
<polygon fill="black" stroke="black" points="12920.19,-785.33 12916.69,-775.33 12913.19,-785.33 12920.19,-785.33"/>
</g>
<!-- layer_3_expert_11_gpu_13 -->
<g id="node336" class="node">
<title>layer_3_expert_11_gpu_13</title>
<polygon fill="#ffe6e6" stroke="black" points="13615.69,-951.17 13161.69,-951.17 13161.69,-883.17 13615.69,-883.17 13615.69,-951.17"/>
<text text-anchor="middle" x="13388.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="13388.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="13388.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13388.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_11_gpu_13&#45;&gt;layer_3_expert_agg_13 -->
<g id="edge660" class="edge">
<title>layer_3_expert_11_gpu_13&#45;&gt;layer_3_expert_agg_13</title>
<path fill="none" stroke="black" d="M13285.03,-882.96C13285.03,-882.96 13285.03,-785.33 13285.03,-785.33"/>
<polygon fill="black" stroke="black" points="13288.53,-785.33 13285.03,-775.33 13281.53,-785.33 13288.53,-785.33"/>
</g>
<!-- layer_3_expert_12_gpu_14 -->
<g id="node337" class="node">
<title>layer_3_expert_12_gpu_14</title>
<polygon fill="#ffe6e6" stroke="black" points="14105.69,-951.17 13651.69,-951.17 13651.69,-883.17 14105.69,-883.17 14105.69,-951.17"/>
<text text-anchor="middle" x="13878.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="13878.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13878.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13878.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_14 -->
<g id="node355" class="node">
<title>layer_3_expert_agg_14</title>
<polygon fill="#fff0e6" stroke="black" points="14367.56,-775.17 13618.51,-775.17 13425.81,-639.17 14174.87,-639.17 14367.56,-775.17"/>
<text text-anchor="middle" x="13896.69" y="-725.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13896.69" y="-710.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13896.69" y="-695.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13896.69" y="-680.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_12_gpu_14&#45;&gt;layer_3_expert_agg_14 -->
<g id="edge661" class="edge">
<title>layer_3_expert_12_gpu_14&#45;&gt;layer_3_expert_agg_14</title>
<path fill="none" stroke="black" d="M13878.69,-882.96C13878.69,-882.96 13878.69,-785.33 13878.69,-785.33"/>
<polygon fill="black" stroke="black" points="13882.19,-785.33 13878.69,-775.33 13875.19,-785.33 13882.19,-785.33"/>
</g>
<!-- layer_3_expert_13_gpu_14 -->
<g id="node338" class="node">
<title>layer_3_expert_13_gpu_14</title>
<polygon fill="#ffe6e6" stroke="black" points="14577.69,-951.17 14123.69,-951.17 14123.69,-883.17 14577.69,-883.17 14577.69,-951.17"/>
<text text-anchor="middle" x="14350.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="14350.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="14350.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14350.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_13_gpu_14&#45;&gt;layer_3_expert_agg_14 -->
<g id="edge662" class="edge">
<title>layer_3_expert_13_gpu_14&#45;&gt;layer_3_expert_agg_14</title>
<path fill="none" stroke="black" d="M14245.53,-882.96C14245.53,-882.96 14245.53,-785.33 14245.53,-785.33"/>
<polygon fill="black" stroke="black" points="14249.03,-785.33 14245.53,-775.33 14242.03,-785.33 14249.03,-785.33"/>
</g>
<!-- layer_3_expert_14_gpu_15 -->
<g id="node339" class="node">
<title>layer_3_expert_14_gpu_15</title>
<polygon fill="#ffe6e6" stroke="black" points="15065.69,-951.17 14611.69,-951.17 14611.69,-883.17 15065.69,-883.17 15065.69,-951.17"/>
<text text-anchor="middle" x="14838.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="14838.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14838.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14838.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_15 -->
<g id="node356" class="node">
<title>layer_3_expert_agg_15</title>
<polygon fill="#fff0e6" stroke="black" points="15326.56,-775.17 14577.51,-775.17 14384.81,-639.17 15133.87,-639.17 15326.56,-775.17"/>
<text text-anchor="middle" x="14855.69" y="-725.97" font-family="monospace" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14855.69" y="-710.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14855.69" y="-695.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14855.69" y="-680.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_14_gpu_15&#45;&gt;layer_3_expert_agg_15 -->
<g id="edge663" class="edge">
<title>layer_3_expert_14_gpu_15&#45;&gt;layer_3_expert_agg_15</title>
<path fill="none" stroke="black" d="M14838.69,-882.96C14838.69,-882.96 14838.69,-785.33 14838.69,-785.33"/>
<polygon fill="black" stroke="black" points="14842.19,-785.33 14838.69,-775.33 14835.19,-785.33 14842.19,-785.33"/>
</g>
<!-- layer_3_expert_15_gpu_15 -->
<g id="node340" class="node">
<title>layer_3_expert_15_gpu_15</title>
<polygon fill="#ffe6e6" stroke="black" points="15537.69,-951.17 15083.69,-951.17 15083.69,-883.17 15537.69,-883.17 15537.69,-951.17"/>
<text text-anchor="middle" x="15310.69" y="-935.97" font-family="monospace" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="15310.69" y="-920.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="15310.69" y="-905.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="15310.69" y="-890.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_15_gpu_15&#45;&gt;layer_3_expert_agg_15 -->
<g id="edge664" class="edge">
<title>layer_3_expert_15_gpu_15&#45;&gt;layer_3_expert_agg_15</title>
<path fill="none" stroke="black" d="M15205.03,-882.96C15205.03,-882.96 15205.03,-785.33 15205.03,-785.33"/>
<polygon fill="black" stroke="black" points="15208.53,-785.33 15205.03,-775.33 15201.53,-785.33 15208.53,-785.33"/>
</g>
<!-- layer_3_expert_select_8&#45;&gt;layer_3_expert_0_gpu_8 -->
<g id="edge633" class="edge">
<title>layer_3_expert_select_8&#45;&gt;layer_3_expert_0_gpu_8</title>
<path fill="none" stroke="black" d="M7959.69,-1058.99C7959.69,-1058.99 7959.69,-961.2 7959.69,-961.2"/>
<polygon fill="black" stroke="black" points="7963.19,-961.2 7959.69,-951.2 7956.19,-961.2 7963.19,-961.2"/>
</g>
<!-- layer_3_expert_select_8&#45;&gt;layer_3_expert_1_gpu_8 -->
<g id="edge634" class="edge">
<title>layer_3_expert_select_8&#45;&gt;layer_3_expert_1_gpu_8</title>
<path fill="none" stroke="black" d="M8409.03,-1058.99C8409.03,-1058.99 8409.03,-961.2 8409.03,-961.2"/>
<polygon fill="black" stroke="black" points="8412.53,-961.2 8409.03,-951.2 8405.53,-961.2 8412.53,-961.2"/>
</g>
<!-- layer_3_expert_select_9&#45;&gt;layer_3_expert_2_gpu_9 -->
<g id="edge635" class="edge">
<title>layer_3_expert_select_9&#45;&gt;layer_3_expert_2_gpu_9</title>
<path fill="none" stroke="black" d="M9002.69,-1058.99C9002.69,-1058.99 9002.69,-961.2 9002.69,-961.2"/>
<polygon fill="black" stroke="black" points="9006.19,-961.2 9002.69,-951.2 8999.19,-961.2 9006.19,-961.2"/>
</g>
<!-- layer_3_expert_select_9&#45;&gt;layer_3_expert_3_gpu_9 -->
<g id="edge636" class="edge">
<title>layer_3_expert_select_9&#45;&gt;layer_3_expert_3_gpu_9</title>
<path fill="none" stroke="black" d="M9410.03,-1080.3C9410.03,-1080.3 9410.03,-961.48 9410.03,-961.48"/>
<polygon fill="black" stroke="black" points="9413.53,-961.48 9410.03,-951.48 9406.53,-961.48 9413.53,-961.48"/>
</g>
<!-- layer_3_expert_select_10&#45;&gt;layer_3_expert_4_gpu_10 -->
<g id="edge637" class="edge">
<title>layer_3_expert_select_10&#45;&gt;layer_3_expert_4_gpu_10</title>
<path fill="none" stroke="black" d="M10003.69,-1058.99C10003.69,-1058.99 10003.69,-961.2 10003.69,-961.2"/>
<polygon fill="black" stroke="black" points="10007.19,-961.2 10003.69,-951.2 10000.19,-961.2 10007.19,-961.2"/>
</g>
<!-- layer_3_expert_select_10&#45;&gt;layer_3_expert_5_gpu_10 -->
<g id="edge638" class="edge">
<title>layer_3_expert_select_10&#45;&gt;layer_3_expert_5_gpu_10</title>
<path fill="none" stroke="black" d="M10390.03,-1095.27C10390.03,-1095.27 10390.03,-961.46 10390.03,-961.46"/>
<polygon fill="black" stroke="black" points="10393.53,-961.46 10390.03,-951.46 10386.53,-961.46 10393.53,-961.46"/>
</g>
<!-- layer_3_expert_select_11&#45;&gt;layer_3_expert_6_gpu_11 -->
<g id="edge639" class="edge">
<title>layer_3_expert_select_11&#45;&gt;layer_3_expert_6_gpu_11</title>
<path fill="none" stroke="black" d="M10983.69,-1058.99C10983.69,-1058.99 10983.69,-961.2 10983.69,-961.2"/>
<polygon fill="black" stroke="black" points="10987.19,-961.2 10983.69,-951.2 10980.19,-961.2 10987.19,-961.2"/>
</g>
<!-- layer_3_expert_select_11&#45;&gt;layer_3_expert_7_gpu_11 -->
<g id="edge640" class="edge">
<title>layer_3_expert_select_11&#45;&gt;layer_3_expert_7_gpu_11</title>
<path fill="none" stroke="black" d="M11359.53,-1102.67C11359.53,-1102.67 11359.53,-961.21 11359.53,-961.21"/>
<polygon fill="black" stroke="black" points="11363.03,-961.21 11359.53,-951.21 11356.03,-961.21 11363.03,-961.21"/>
</g>
<!-- layer_3_expert_select_12&#45;&gt;layer_3_expert_8_gpu_12 -->
<g id="edge641" class="edge">
<title>layer_3_expert_select_12&#45;&gt;layer_3_expert_8_gpu_12</title>
<path fill="none" stroke="black" d="M11952.69,-1058.99C11952.69,-1058.99 11952.69,-961.2 11952.69,-961.2"/>
<polygon fill="black" stroke="black" points="11956.19,-961.2 11952.69,-951.2 11949.19,-961.2 11956.19,-961.2"/>
</g>
<!-- layer_3_expert_select_12&#45;&gt;layer_3_expert_9_gpu_12 -->
<g id="edge642" class="edge">
<title>layer_3_expert_select_12&#45;&gt;layer_3_expert_9_gpu_12</title>
<path fill="none" stroke="black" d="M12323.53,-1105.87C12323.53,-1105.87 12323.53,-961.3 12323.53,-961.3"/>
<polygon fill="black" stroke="black" points="12327.03,-961.3 12323.53,-951.3 12320.03,-961.3 12327.03,-961.3"/>
</g>
<!-- layer_3_expert_select_13&#45;&gt;layer_3_expert_10_gpu_13 -->
<g id="edge643" class="edge">
<title>layer_3_expert_select_13&#45;&gt;layer_3_expert_10_gpu_13</title>
<path fill="none" stroke="black" d="M12916.69,-1058.99C12916.69,-1058.99 12916.69,-961.2 12916.69,-961.2"/>
<polygon fill="black" stroke="black" points="12920.19,-961.2 12916.69,-951.2 12913.19,-961.2 12920.19,-961.2"/>
</g>
<!-- layer_3_expert_select_13&#45;&gt;layer_3_expert_11_gpu_13 -->
<g id="edge644" class="edge">
<title>layer_3_expert_select_13&#45;&gt;layer_3_expert_11_gpu_13</title>
<path fill="none" stroke="black" d="M13285.03,-1107.79C13285.03,-1107.79 13285.03,-961.29 13285.03,-961.29"/>
<polygon fill="black" stroke="black" points="13288.53,-961.29 13285.03,-951.29 13281.53,-961.29 13288.53,-961.29"/>
</g>
<!-- layer_3_expert_select_14&#45;&gt;layer_3_expert_12_gpu_14 -->
<g id="edge645" class="edge">
<title>layer_3_expert_select_14&#45;&gt;layer_3_expert_12_gpu_14</title>
<path fill="none" stroke="black" d="M13878.69,-1058.99C13878.69,-1058.99 13878.69,-961.2 13878.69,-961.2"/>
<polygon fill="black" stroke="black" points="13882.19,-961.2 13878.69,-951.2 13875.19,-961.2 13882.19,-961.2"/>
</g>
<!-- layer_3_expert_select_14&#45;&gt;layer_3_expert_13_gpu_14 -->
<g id="edge646" class="edge">
<title>layer_3_expert_select_14&#45;&gt;layer_3_expert_13_gpu_14</title>
<path fill="none" stroke="black" d="M14245.53,-1108.9C14245.53,-1108.9 14245.53,-961.34 14245.53,-961.34"/>
<polygon fill="black" stroke="black" points="14249.03,-961.34 14245.53,-951.34 14242.03,-961.34 14249.03,-961.34"/>
</g>
<!-- layer_3_expert_select_15&#45;&gt;layer_3_expert_14_gpu_15 -->
<g id="edge647" class="edge">
<title>layer_3_expert_select_15&#45;&gt;layer_3_expert_14_gpu_15</title>
<path fill="none" stroke="black" d="M14838.69,-1058.99C14838.69,-1058.99 14838.69,-961.2 14838.69,-961.2"/>
<polygon fill="black" stroke="black" points="14842.19,-961.2 14838.69,-951.2 14835.19,-961.2 14842.19,-961.2"/>
</g>
<!-- layer_3_expert_select_15&#45;&gt;layer_3_expert_15_gpu_15 -->
<g id="edge648" class="edge">
<title>layer_3_expert_select_15&#45;&gt;layer_3_expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M15205.03,-1109.26C15205.03,-1109.26 15205.03,-961.49 15205.03,-961.49"/>
<polygon fill="black" stroke="black" points="15208.53,-961.49 15205.03,-951.49 15201.53,-961.49 15208.53,-961.49"/>
</g>
<!-- layer_3_expert_broadcast_8 -->
<g id="node365" class="node">
<title>layer_3_expert_broadcast_8</title>
<polygon fill="#e6ffe6" stroke="black" points="8613.56,-531.17 7864.51,-531.17 7671.81,-395.17 8420.87,-395.17 8613.56,-531.17"/>
<text text-anchor="middle" x="8142.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="8142.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="8142.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="8142.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_8&#45;&gt;layer_3_expert_broadcast_8 -->
<g id="edge665" class="edge">
<title>layer_3_expert_agg_8&#45;&gt;layer_3_expert_broadcast_8</title>
<path fill="none" stroke="black" d="M8142.69,-638.87C8142.69,-638.87 8142.69,-541.44 8142.69,-541.44"/>
<polygon fill="black" stroke="black" points="8146.19,-541.44 8142.69,-531.44 8139.19,-541.44 8146.19,-541.44"/>
</g>
<!-- layer_3_expert_broadcast_9 -->
<g id="node366" class="node">
<title>layer_3_expert_broadcast_9</title>
<polygon fill="#e6ffe6" stroke="black" points="9572.56,-531.17 8823.51,-531.17 8630.81,-395.17 9379.87,-395.17 9572.56,-531.17"/>
<text text-anchor="middle" x="9101.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="9101.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="9101.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="9101.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_9&#45;&gt;layer_3_expert_broadcast_9 -->
<g id="edge666" class="edge">
<title>layer_3_expert_agg_9&#45;&gt;layer_3_expert_broadcast_9</title>
<path fill="none" stroke="black" d="M9101.69,-638.87C9101.69,-638.87 9101.69,-541.44 9101.69,-541.44"/>
<polygon fill="black" stroke="black" points="9105.19,-541.44 9101.69,-531.44 9098.19,-541.44 9105.19,-541.44"/>
</g>
<!-- layer_3_expert_broadcast_10 -->
<g id="node367" class="node">
<title>layer_3_expert_broadcast_10</title>
<polygon fill="#e6ffe6" stroke="black" points="10531.56,-531.17 9782.51,-531.17 9589.81,-395.17 10338.87,-395.17 10531.56,-531.17"/>
<text text-anchor="middle" x="10060.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="10060.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="10060.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="10060.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_10&#45;&gt;layer_3_expert_broadcast_10 -->
<g id="edge667" class="edge">
<title>layer_3_expert_agg_10&#45;&gt;layer_3_expert_broadcast_10</title>
<path fill="none" stroke="black" d="M10060.69,-638.87C10060.69,-638.87 10060.69,-541.44 10060.69,-541.44"/>
<polygon fill="black" stroke="black" points="10064.19,-541.44 10060.69,-531.44 10057.19,-541.44 10064.19,-541.44"/>
</g>
<!-- layer_3_expert_broadcast_11 -->
<g id="node368" class="node">
<title>layer_3_expert_broadcast_11</title>
<polygon fill="#e6ffe6" stroke="black" points="11490.56,-531.17 10741.51,-531.17 10548.81,-395.17 11297.87,-395.17 11490.56,-531.17"/>
<text text-anchor="middle" x="11019.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="11019.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="11019.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11019.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_11&#45;&gt;layer_3_expert_broadcast_11 -->
<g id="edge668" class="edge">
<title>layer_3_expert_agg_11&#45;&gt;layer_3_expert_broadcast_11</title>
<path fill="none" stroke="black" d="M11019.69,-638.87C11019.69,-638.87 11019.69,-541.44 11019.69,-541.44"/>
<polygon fill="black" stroke="black" points="11023.19,-541.44 11019.69,-531.44 11016.19,-541.44 11023.19,-541.44"/>
</g>
<!-- layer_3_expert_broadcast_12 -->
<g id="node369" class="node">
<title>layer_3_expert_broadcast_12</title>
<polygon fill="#e6ffe6" stroke="black" points="12449.56,-531.17 11700.51,-531.17 11507.81,-395.17 12256.87,-395.17 12449.56,-531.17"/>
<text text-anchor="middle" x="11978.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="11978.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="11978.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="11978.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_12&#45;&gt;layer_3_expert_broadcast_12 -->
<g id="edge669" class="edge">
<title>layer_3_expert_agg_12&#45;&gt;layer_3_expert_broadcast_12</title>
<path fill="none" stroke="black" d="M11978.69,-638.87C11978.69,-638.87 11978.69,-541.44 11978.69,-541.44"/>
<polygon fill="black" stroke="black" points="11982.19,-541.44 11978.69,-531.44 11975.19,-541.44 11982.19,-541.44"/>
</g>
<!-- layer_3_expert_broadcast_13 -->
<g id="node370" class="node">
<title>layer_3_expert_broadcast_13</title>
<polygon fill="#e6ffe6" stroke="black" points="13408.56,-531.17 12659.51,-531.17 12466.81,-395.17 13215.87,-395.17 13408.56,-531.17"/>
<text text-anchor="middle" x="12937.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="12937.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="12937.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="12937.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_13&#45;&gt;layer_3_expert_broadcast_13 -->
<g id="edge670" class="edge">
<title>layer_3_expert_agg_13&#45;&gt;layer_3_expert_broadcast_13</title>
<path fill="none" stroke="black" d="M12937.69,-638.87C12937.69,-638.87 12937.69,-541.44 12937.69,-541.44"/>
<polygon fill="black" stroke="black" points="12941.19,-541.44 12937.69,-531.44 12934.19,-541.44 12941.19,-541.44"/>
</g>
<!-- layer_3_expert_broadcast_14 -->
<g id="node371" class="node">
<title>layer_3_expert_broadcast_14</title>
<polygon fill="#e6ffe6" stroke="black" points="14367.56,-531.17 13618.51,-531.17 13425.81,-395.17 14174.87,-395.17 14367.56,-531.17"/>
<text text-anchor="middle" x="13896.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="13896.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="13896.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="13896.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_14&#45;&gt;layer_3_expert_broadcast_14 -->
<g id="edge671" class="edge">
<title>layer_3_expert_agg_14&#45;&gt;layer_3_expert_broadcast_14</title>
<path fill="none" stroke="black" d="M13896.69,-638.87C13896.69,-638.87 13896.69,-541.44 13896.69,-541.44"/>
<polygon fill="black" stroke="black" points="13900.19,-541.44 13896.69,-531.44 13893.19,-541.44 13900.19,-541.44"/>
</g>
<!-- layer_3_expert_broadcast_15 -->
<g id="node372" class="node">
<title>layer_3_expert_broadcast_15</title>
<polygon fill="#e6ffe6" stroke="black" points="15326.56,-531.17 14577.51,-531.17 14384.81,-395.17 15133.87,-395.17 15326.56,-531.17"/>
<text text-anchor="middle" x="14855.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="14855.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="14855.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="14855.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_agg_15&#45;&gt;layer_3_expert_broadcast_15 -->
<g id="edge672" class="edge">
<title>layer_3_expert_agg_15&#45;&gt;layer_3_expert_broadcast_15</title>
<path fill="none" stroke="black" d="M14855.69,-638.87C14855.69,-638.87 14855.69,-541.44 14855.69,-541.44"/>
<polygon fill="black" stroke="black" points="14859.19,-541.44 14855.69,-531.44 14852.19,-541.44 14859.19,-541.44"/>
</g>
<!-- layer_3_expert_broadcast_0 -->
<g id="node357" class="node">
<title>layer_3_expert_broadcast_0</title>
<polygon fill="#e6ffe6" stroke="black" points="941.56,-531.17 192.51,-531.17 -0.19,-395.17 748.87,-395.17 941.56,-531.17"/>
<text text-anchor="middle" x="470.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="470.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="470.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="470.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_residual2 -->
<g id="node373" class="node">
<title>layer_3_residual2</title>
<polygon fill="#fff0e6" stroke="black" points="7889.69,-287.17 7435.69,-287.17 7435.69,-204.17 7889.69,-204.17 7889.69,-287.17"/>
<text text-anchor="middle" x="7662.69" y="-271.97" font-family="monospace" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="7662.69" y="-256.97" font-family="monospace" font-size="14.00">Input1: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7662.69" y="-241.97" font-family="monospace" font-size="14.00">Input2: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7662.69" y="-226.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7662.69" y="-211.97" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_expert_broadcast_0&#45;&gt;layer_3_residual2 -->
<g id="edge673" class="edge">
<title>layer_3_expert_broadcast_0&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M470.69,-395.08C470.69,-321.31 470.69,-214 470.69,-214 470.69,-214 7425.57,-214 7425.57,-214"/>
<polygon fill="black" stroke="black" points="7425.57,-217.5 7435.57,-214 7425.57,-210.5 7425.57,-217.5"/>
</g>
<!-- layer_3_expert_broadcast_1 -->
<g id="node358" class="node">
<title>layer_3_expert_broadcast_1</title>
<polygon fill="#e6ffe6" stroke="black" points="1900.56,-531.17 1151.51,-531.17 958.81,-395.17 1707.87,-395.17 1900.56,-531.17"/>
<text text-anchor="middle" x="1429.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="1429.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="1429.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="1429.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_broadcast_1&#45;&gt;layer_3_residual2 -->
<g id="edge674" class="edge">
<title>layer_3_expert_broadcast_1&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M1429.69,-394.95C1429.69,-324.26 1429.69,-224 1429.69,-224 1429.69,-224 7425.32,-224 7425.32,-224"/>
<polygon fill="black" stroke="black" points="7425.32,-227.5 7435.32,-224 7425.32,-220.5 7425.32,-227.5"/>
</g>
<!-- layer_3_expert_broadcast_2 -->
<g id="node359" class="node">
<title>layer_3_expert_broadcast_2</title>
<polygon fill="#e6ffe6" stroke="black" points="2859.56,-531.17 2110.51,-531.17 1917.81,-395.17 2666.87,-395.17 2859.56,-531.17"/>
<text text-anchor="middle" x="2388.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="2388.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="2388.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="2388.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_broadcast_2&#45;&gt;layer_3_residual2 -->
<g id="edge675" class="edge">
<title>layer_3_expert_broadcast_2&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M2388.69,-395.02C2388.69,-327.79 2388.69,-235 2388.69,-235 2388.69,-235 7425.65,-235 7425.65,-235"/>
<polygon fill="black" stroke="black" points="7425.65,-238.5 7435.65,-235 7425.65,-231.5 7425.65,-238.5"/>
</g>
<!-- layer_3_expert_broadcast_3 -->
<g id="node360" class="node">
<title>layer_3_expert_broadcast_3</title>
<polygon fill="#e6ffe6" stroke="black" points="3818.56,-531.17 3069.51,-531.17 2876.81,-395.17 3625.87,-395.17 3818.56,-531.17"/>
<text text-anchor="middle" x="3347.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="3347.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="3347.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="3347.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_broadcast_3&#45;&gt;layer_3_residual2 -->
<g id="edge676" class="edge">
<title>layer_3_expert_broadcast_3&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M3347.69,-395.03C3347.69,-331.02 3347.69,-245 3347.69,-245 3347.69,-245 7425.63,-245 7425.63,-245"/>
<polygon fill="black" stroke="black" points="7425.63,-248.5 7435.63,-245 7425.63,-241.5 7425.63,-248.5"/>
</g>
<!-- layer_3_expert_broadcast_4 -->
<g id="node361" class="node">
<title>layer_3_expert_broadcast_4</title>
<polygon fill="#e6ffe6" stroke="black" points="4777.56,-531.17 4028.51,-531.17 3835.81,-395.17 4584.87,-395.17 4777.56,-531.17"/>
<text text-anchor="middle" x="4306.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="4306.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="4306.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="4306.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_broadcast_4&#45;&gt;layer_3_residual2 -->
<g id="edge677" class="edge">
<title>layer_3_expert_broadcast_4&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M4306.69,-395.05C4306.69,-334.66 4306.69,-256 4306.69,-256 4306.69,-256 7425.64,-256 7425.64,-256"/>
<polygon fill="black" stroke="black" points="7425.64,-259.5 7435.64,-256 7425.64,-252.5 7425.64,-259.5"/>
</g>
<!-- layer_3_expert_broadcast_5 -->
<g id="node362" class="node">
<title>layer_3_expert_broadcast_5</title>
<polygon fill="#e6ffe6" stroke="black" points="5736.56,-531.17 4987.51,-531.17 4794.81,-395.17 5543.87,-395.17 5736.56,-531.17"/>
<text text-anchor="middle" x="5265.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="5265.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="5265.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="5265.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_broadcast_5&#45;&gt;layer_3_residual2 -->
<g id="edge678" class="edge">
<title>layer_3_expert_broadcast_5&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M5265.69,-395.04C5265.69,-338.05 5265.69,-266 5265.69,-266 5265.69,-266 7425.56,-266 7425.56,-266"/>
<polygon fill="black" stroke="black" points="7425.56,-269.5 7435.56,-266 7425.56,-262.5 7425.56,-269.5"/>
</g>
<!-- layer_3_expert_broadcast_6 -->
<g id="node363" class="node">
<title>layer_3_expert_broadcast_6</title>
<polygon fill="#e6ffe6" stroke="black" points="6695.56,-531.17 5946.51,-531.17 5753.81,-395.17 6502.87,-395.17 6695.56,-531.17"/>
<text text-anchor="middle" x="6224.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="6224.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="6224.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="6224.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_broadcast_6&#45;&gt;layer_3_residual2 -->
<g id="edge679" class="edge">
<title>layer_3_expert_broadcast_6&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M6224.69,-395.07C6224.69,-341.55 6224.69,-276 6224.69,-276 6224.69,-276 7425.62,-276 7425.62,-276"/>
<polygon fill="black" stroke="black" points="7425.62,-279.5 7435.62,-276 7425.62,-272.5 7425.62,-279.5"/>
</g>
<!-- layer_3_expert_broadcast_7 -->
<g id="node364" class="node">
<title>layer_3_expert_broadcast_7</title>
<polygon fill="#e6ffe6" stroke="black" points="7654.56,-531.17 6905.51,-531.17 6712.81,-395.17 7461.87,-395.17 7654.56,-531.17"/>
<text text-anchor="middle" x="7183.69" y="-481.97" font-family="monospace" font-size="14.00">Broadcast Expert Output</text>
<text text-anchor="middle" x="7183.69" y="-466.97" font-family="monospace" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="7183.69" y="-451.97" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7183.69" y="-436.97" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
</g>
<!-- layer_3_expert_broadcast_7&#45;&gt;layer_3_residual2 -->
<g id="edge680" class="edge">
<title>layer_3_expert_broadcast_7&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M7545.03,-453.82C7545.03,-453.82 7545.03,-297.35 7545.03,-297.35"/>
<polygon fill="black" stroke="black" points="7548.53,-297.35 7545.03,-287.35 7541.53,-297.35 7548.53,-297.35"/>
</g>
<!-- layer_3_expert_broadcast_8&#45;&gt;layer_3_residual2 -->
<g id="edge681" class="edge">
<title>layer_3_expert_broadcast_8&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M7780.84,-394.94C7780.84,-394.94 7780.84,-297.38 7780.84,-297.38"/>
<polygon fill="black" stroke="black" points="7784.34,-297.38 7780.84,-287.38 7777.34,-297.38 7784.34,-297.38"/>
</g>
<!-- layer_3_expert_broadcast_9&#45;&gt;layer_3_residual2 -->
<g id="edge682" class="edge">
<title>layer_3_expert_broadcast_9&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M9101.69,-395.07C9101.69,-341.55 9101.69,-276 9101.69,-276 9101.69,-276 7899.91,-276 7899.91,-276"/>
<polygon fill="black" stroke="black" points="7899.91,-272.5 7889.91,-276 7899.91,-279.5 7899.91,-272.5"/>
</g>
<!-- layer_3_expert_broadcast_10&#45;&gt;layer_3_residual2 -->
<g id="edge683" class="edge">
<title>layer_3_expert_broadcast_10&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M10060.69,-395.04C10060.69,-338.05 10060.69,-266 10060.69,-266 10060.69,-266 7899.9,-266 7899.9,-266"/>
<polygon fill="black" stroke="black" points="7899.9,-262.5 7889.9,-266 7899.9,-269.5 7899.9,-262.5"/>
</g>
<!-- layer_3_expert_broadcast_11&#45;&gt;layer_3_residual2 -->
<g id="edge684" class="edge">
<title>layer_3_expert_broadcast_11&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M11019.69,-395.05C11019.69,-334.66 11019.69,-256 11019.69,-256 11019.69,-256 7899.8,-256 7899.8,-256"/>
<polygon fill="black" stroke="black" points="7899.8,-252.5 7889.8,-256 7899.8,-259.5 7899.8,-252.5"/>
</g>
<!-- layer_3_expert_broadcast_12&#45;&gt;layer_3_residual2 -->
<g id="edge685" class="edge">
<title>layer_3_expert_broadcast_12&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M11978.69,-395.03C11978.69,-331.02 11978.69,-245 11978.69,-245 11978.69,-245 7899.79,-245 7899.79,-245"/>
<polygon fill="black" stroke="black" points="7899.79,-241.5 7889.79,-245 7899.79,-248.5 7899.79,-241.5"/>
</g>
<!-- layer_3_expert_broadcast_13&#45;&gt;layer_3_residual2 -->
<g id="edge686" class="edge">
<title>layer_3_expert_broadcast_13&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M12937.69,-395.02C12937.69,-327.79 12937.69,-235 12937.69,-235 12937.69,-235 7899.77,-235 7899.77,-235"/>
<polygon fill="black" stroke="black" points="7899.77,-231.5 7889.77,-235 7899.77,-238.5 7899.77,-231.5"/>
</g>
<!-- layer_3_expert_broadcast_14&#45;&gt;layer_3_residual2 -->
<g id="edge687" class="edge">
<title>layer_3_expert_broadcast_14&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M13896.69,-394.95C13896.69,-324.26 13896.69,-224 13896.69,-224 13896.69,-224 7900.09,-224 7900.09,-224"/>
<polygon fill="black" stroke="black" points="7900.09,-220.5 7890.09,-224 7900.09,-227.5 7900.09,-220.5"/>
</g>
<!-- layer_3_expert_broadcast_15&#45;&gt;layer_3_residual2 -->
<g id="edge688" class="edge">
<title>layer_3_expert_broadcast_15&#45;&gt;layer_3_residual2</title>
<path fill="none" stroke="black" d="M14855.69,-395.08C14855.69,-321.31 14855.69,-214 14855.69,-214 14855.69,-214 7899.84,-214 7899.84,-214"/>
<polygon fill="black" stroke="black" points="7899.84,-210.5 7889.84,-214 7899.84,-217.5 7899.84,-210.5"/>
</g>
<!-- output -->
<g id="node374" class="node">
<title>output</title>
<ellipse fill="#e6ffe6" stroke="black" cx="7662.69" cy="-48.08" rx="326.87" ry="48.17"/>
<text text-anchor="middle" x="7662.69" y="-66.88" font-family="monospace" font-size="14.00">Output</text>
<text text-anchor="middle" x="7662.69" y="-51.88" font-family="monospace" font-size="14.00">Input: [batch_size=B, seq_len=2048, hidden_dim=4096]</text>
<text text-anchor="middle" x="7662.69" y="-36.88" font-family="monospace" font-size="14.00">Output: [batch_size=B, seq_len=2048, vocab_size=50265]</text>
<text text-anchor="middle" x="7662.69" y="-21.88" font-family="monospace" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- layer_3_residual2&#45;&gt;output -->
<g id="edge689" class="edge">
<title>layer_3_residual2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7662.69,-203.76C7662.69,-203.76 7662.69,-106.18 7662.69,-106.18"/>
<polygon fill="black" stroke="black" points="7666.19,-106.18 7662.69,-96.18 7659.19,-106.18 7666.19,-106.18"/>
</g>
</g>
</svg>
