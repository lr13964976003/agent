// MA Separation GPU Mapping
digraph GPU_Mapping {
	graph [compound=true rankdir=LR]
	subgraph cluster_attention {
		color=lightblue label="Attention GPUs (0-7)" style=filled
		att_gpu_0 [label="GPU 0\n4 heads\nReplication: 2x" fillcolor=lightblue shape=box style=filled]
		att_gpu_1 [label="GPU 1\n4 heads\nReplication: 2x" fillcolor=lightblue shape=box style=filled]
		att_gpu_2 [label="GPU 2\n4 heads\nReplication: 2x" fillcolor=lightblue shape=box style=filled]
		att_gpu_3 [label="GPU 3\n4 heads\nReplication: 2x" fillcolor=lightblue shape=box style=filled]
		att_gpu_4 [label="GPU 4\n4 heads\nReplication: 2x" fillcolor=lightblue shape=box style=filled]
		att_gpu_5 [label="GPU 5\n4 heads\nReplication: 2x" fillcolor=lightblue shape=box style=filled]
		att_gpu_6 [label="GPU 6\n4 heads\nReplication: 2x" fillcolor=lightblue shape=box style=filled]
		att_gpu_7 [label="GPU 7\n4 heads\nReplication: 2x" fillcolor=lightblue shape=box style=filled]
	}
	subgraph cluster_moe {
		color=lightcoral label="MoE GPUs (8-15)" style=filled
		moe_gpu_8 [label="GPU 8\nExperts 0-1" fillcolor=lightcoral shape=box style=filled]
		moe_gpu_9 [label="GPU 9\nExperts 2-3" fillcolor=lightcoral shape=box style=filled]
		moe_gpu_10 [label="GPU 10\nExperts 4-5" fillcolor=lightcoral shape=box style=filled]
		moe_gpu_11 [label="GPU 11\nExperts 6-7" fillcolor=lightcoral shape=box style=filled]
		moe_gpu_12 [label="GPU 12\nExperts 8-9" fillcolor=lightcoral shape=box style=filled]
		moe_gpu_13 [label="GPU 13\nExperts 10-11" fillcolor=lightcoral shape=box style=filled]
		moe_gpu_14 [label="GPU 14\nExperts 12-13" fillcolor=lightcoral shape=box style=filled]
		moe_gpu_15 [label="GPU 15\nExperts 14-15" fillcolor=lightcoral shape=box style=filled]
	}
	att_gpu_0 -> moe_gpu_8 [label=broadcast color=green style=dashed]
	att_gpu_0 -> moe_gpu_9 [label=broadcast color=green style=dashed]
	att_gpu_0 -> moe_gpu_10 [label=broadcast color=green style=dashed]
	att_gpu_0 -> moe_gpu_11 [label=broadcast color=green style=dashed]
	att_gpu_0 -> moe_gpu_12 [label=broadcast color=green style=dashed]
	att_gpu_0 -> moe_gpu_13 [label=broadcast color=green style=dashed]
	att_gpu_0 -> moe_gpu_14 [label=broadcast color=green style=dashed]
	att_gpu_0 -> moe_gpu_15 [label=broadcast color=green style=dashed]
	att_gpu_1 -> moe_gpu_8 [label=broadcast color=green style=dashed]
	att_gpu_1 -> moe_gpu_9 [label=broadcast color=green style=dashed]
	att_gpu_1 -> moe_gpu_10 [label=broadcast color=green style=dashed]
	att_gpu_1 -> moe_gpu_11 [label=broadcast color=green style=dashed]
	att_gpu_1 -> moe_gpu_12 [label=broadcast color=green style=dashed]
	att_gpu_1 -> moe_gpu_13 [label=broadcast color=green style=dashed]
	att_gpu_1 -> moe_gpu_14 [label=broadcast color=green style=dashed]
	att_gpu_1 -> moe_gpu_15 [label=broadcast color=green style=dashed]
	att_gpu_2 -> moe_gpu_8 [label=broadcast color=green style=dashed]
	att_gpu_2 -> moe_gpu_9 [label=broadcast color=green style=dashed]
	att_gpu_2 -> moe_gpu_10 [label=broadcast color=green style=dashed]
	att_gpu_2 -> moe_gpu_11 [label=broadcast color=green style=dashed]
	att_gpu_2 -> moe_gpu_12 [label=broadcast color=green style=dashed]
	att_gpu_2 -> moe_gpu_13 [label=broadcast color=green style=dashed]
	att_gpu_2 -> moe_gpu_14 [label=broadcast color=green style=dashed]
	att_gpu_2 -> moe_gpu_15 [label=broadcast color=green style=dashed]
	att_gpu_3 -> moe_gpu_8 [label=broadcast color=green style=dashed]
	att_gpu_3 -> moe_gpu_9 [label=broadcast color=green style=dashed]
	att_gpu_3 -> moe_gpu_10 [label=broadcast color=green style=dashed]
	att_gpu_3 -> moe_gpu_11 [label=broadcast color=green style=dashed]
	att_gpu_3 -> moe_gpu_12 [label=broadcast color=green style=dashed]
	att_gpu_3 -> moe_gpu_13 [label=broadcast color=green style=dashed]
	att_gpu_3 -> moe_gpu_14 [label=broadcast color=green style=dashed]
	att_gpu_3 -> moe_gpu_15 [label=broadcast color=green style=dashed]
	att_gpu_4 -> moe_gpu_8 [label=broadcast color=green style=dashed]
	att_gpu_4 -> moe_gpu_9 [label=broadcast color=green style=dashed]
	att_gpu_4 -> moe_gpu_10 [label=broadcast color=green style=dashed]
	att_gpu_4 -> moe_gpu_11 [label=broadcast color=green style=dashed]
	att_gpu_4 -> moe_gpu_12 [label=broadcast color=green style=dashed]
	att_gpu_4 -> moe_gpu_13 [label=broadcast color=green style=dashed]
	att_gpu_4 -> moe_gpu_14 [label=broadcast color=green style=dashed]
	att_gpu_4 -> moe_gpu_15 [label=broadcast color=green style=dashed]
	att_gpu_5 -> moe_gpu_8 [label=broadcast color=green style=dashed]
	att_gpu_5 -> moe_gpu_9 [label=broadcast color=green style=dashed]
	att_gpu_5 -> moe_gpu_10 [label=broadcast color=green style=dashed]
	att_gpu_5 -> moe_gpu_11 [label=broadcast color=green style=dashed]
	att_gpu_5 -> moe_gpu_12 [label=broadcast color=green style=dashed]
	att_gpu_5 -> moe_gpu_13 [label=broadcast color=green style=dashed]
	att_gpu_5 -> moe_gpu_14 [label=broadcast color=green style=dashed]
	att_gpu_5 -> moe_gpu_15 [label=broadcast color=green style=dashed]
	att_gpu_6 -> moe_gpu_8 [label=broadcast color=green style=dashed]
	att_gpu_6 -> moe_gpu_9 [label=broadcast color=green style=dashed]
	att_gpu_6 -> moe_gpu_10 [label=broadcast color=green style=dashed]
	att_gpu_6 -> moe_gpu_11 [label=broadcast color=green style=dashed]
	att_gpu_6 -> moe_gpu_12 [label=broadcast color=green style=dashed]
	att_gpu_6 -> moe_gpu_13 [label=broadcast color=green style=dashed]
	att_gpu_6 -> moe_gpu_14 [label=broadcast color=green style=dashed]
	att_gpu_6 -> moe_gpu_15 [label=broadcast color=green style=dashed]
	att_gpu_7 -> moe_gpu_8 [label=broadcast color=green style=dashed]
	att_gpu_7 -> moe_gpu_9 [label=broadcast color=green style=dashed]
	att_gpu_7 -> moe_gpu_10 [label=broadcast color=green style=dashed]
	att_gpu_7 -> moe_gpu_11 [label=broadcast color=green style=dashed]
	att_gpu_7 -> moe_gpu_12 [label=broadcast color=green style=dashed]
	att_gpu_7 -> moe_gpu_13 [label=broadcast color=green style=dashed]
	att_gpu_7 -> moe_gpu_14 [label=broadcast color=green style=dashed]
	att_gpu_7 -> moe_gpu_15 [label=broadcast color=green style=dashed]
}
