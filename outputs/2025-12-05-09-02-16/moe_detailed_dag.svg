<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="25366pt" height="2262pt"
 viewBox="0.00 0.00 25366.00 2262.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2258.5)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2258.5 25362,-2258.5 25362,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="white" stroke="black" d="M23905,-2139.5C23905,-2139.5 24313,-2139.5 24313,-2139.5 24319,-2139.5 24325,-2145.5 24325,-2151.5 24325,-2151.5 24325,-2234.5 24325,-2234.5 24325,-2240.5 24319,-2246.5 24313,-2246.5 24313,-2246.5 23905,-2246.5 23905,-2246.5 23899,-2246.5 23893,-2240.5 23893,-2234.5 23893,-2234.5 23893,-2151.5 23893,-2151.5 23893,-2145.5 23899,-2139.5 23905,-2139.5"/>
<text text-anchor="middle" x="24109" y="-2231.3" font-family="Times,serif" font-size="14.00">Input Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pp0</title>
<path fill="white" stroke="black" d="M22972,-844C22972,-844 25338,-844 25338,-844 25344,-844 25350,-850 25350,-856 25350,-856 25350,-1955.5 25350,-1955.5 25350,-1961.5 25344,-1967.5 25338,-1967.5 25338,-1967.5 22972,-1967.5 22972,-1967.5 22966,-1967.5 22960,-1961.5 22960,-1955.5 22960,-1955.5 22960,-856 22960,-856 22960,-850 22966,-844 22972,-844"/>
<text text-anchor="middle" x="24155" y="-1952.3" font-family="Times,serif" font-size="14.00">Pipeline Stage 0: Layers 0&#45;3 (GPUs 0&#45;127)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_pp1</title>
<path fill="white" stroke="black" d="M15825,-661C15825,-661 24121,-661 24121,-661 24127,-661 24133,-667 24133,-673 24133,-673 24133,-824 24133,-824 24133,-830 24127,-836 24121,-836 24121,-836 15825,-836 15825,-836 15819,-836 15813,-830 15813,-824 15813,-824 15813,-673 15813,-673 15813,-667 15819,-661 15825,-661"/>
<text text-anchor="middle" x="19973" y="-820.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 1: Layers 4&#45;7 (GPUs 128&#45;255)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_pp2</title>
<path fill="white" stroke="black" d="M8013,-478C8013,-478 16309,-478 16309,-478 16315,-478 16321,-484 16321,-490 16321,-490 16321,-641 16321,-641 16321,-647 16315,-653 16309,-653 16309,-653 8013,-653 8013,-653 8007,-653 8001,-647 8001,-641 8001,-641 8001,-490 8001,-490 8001,-484 8007,-478 8013,-478"/>
<text text-anchor="middle" x="12161" y="-637.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 2: Layers 8&#45;11 (GPUs 256&#45;383)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_pp3</title>
<path fill="white" stroke="black" d="M201,-295C201,-295 8497,-295 8497,-295 8503,-295 8509,-301 8509,-307 8509,-307 8509,-458 8509,-458 8509,-464 8503,-470 8497,-470 8497,-470 201,-470 201,-470 195,-470 189,-464 189,-458 189,-458 189,-307 189,-307 189,-301 195,-295 201,-295"/>
<text text-anchor="middle" x="4349" y="-454.8" font-family="Times,serif" font-size="14.00">Pipeline Stage 3: Layers 12&#45;15 (GPUs 384&#45;511)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_output</title>
<path fill="white" stroke="black" d="M20,-8C20,-8 950,-8 950,-8 956,-8 962,-14 962,-20 962,-20 962,-275 962,-275 962,-281 956,-287 950,-287 950,-287 20,-287 20,-287 14,-287 8,-281 8,-275 8,-275 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="485" y="-271.8" font-family="Times,serif" font-size="14.00">Output Layer</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightblue" stroke="black" points="24317,-2215.5 23901,-2215.5 23901,-2147.5 24317,-2147.5 24317,-2215.5"/>
<text text-anchor="middle" x="24109" y="-2200.3" font-family="Times,serif" font-size="14.00">Input Embedding</text>
<text text-anchor="middle" x="24109" y="-2185.3" font-family="Times,serif" font-size="14.00">GPU: [0&#45;511]</text>
<text text-anchor="middle" x="24109" y="-2170.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="24109" y="-2155.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, hidden=1024]</text>
</g>
<!-- dp_split -->
<g id="node2" class="node">
<title>dp_split</title>
<polygon fill="lightyellow" stroke="black" points="24530.92,-2111.5 23859.74,-2111.5 23687.08,-1975.5 24358.26,-1975.5 24530.92,-2111.5"/>
<text text-anchor="middle" x="24109" y="-2062.3" font-family="Times,serif" font-size="14.00">DP Split</text>
<text text-anchor="middle" x="24109" y="-2047.3" font-family="Times,serif" font-size="14.00">GPU: [0&#45;511]</text>
<text text-anchor="middle" x="24109" y="-2032.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=128, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="24109" y="-2017.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- input&#45;&gt;dp_split -->
<g id="edge1" class="edge">
<title>input&#45;&gt;dp_split</title>
<path fill="none" stroke="black" d="M24109,-2147.39C24109,-2147.39 24109,-2121.73 24109,-2121.73"/>
<polygon fill="black" stroke="black" points="24112.5,-2121.73 24109,-2111.73 24105.5,-2121.73 24112.5,-2121.73"/>
</g>
<!-- pp0_layer0_attn -->
<g id="node3" class="node">
<title>pp0_layer0_attn</title>
<polygon fill="lightblue" stroke="black" points="24312.5,-1936.5 23905.5,-1936.5 23905.5,-1868.5 24312.5,-1868.5 24312.5,-1936.5"/>
<text text-anchor="middle" x="24109" y="-1921.3" font-family="Times,serif" font-size="14.00">Layer 0: Attention</text>
<text text-anchor="middle" x="24109" y="-1906.3" font-family="Times,serif" font-size="14.00">GPU: [0&#45;31]</text>
<text text-anchor="middle" x="24109" y="-1891.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="24109" y="-1876.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- dp_split&#45;&gt;pp0_layer0_attn -->
<g id="edge2" class="edge">
<title>dp_split&#45;&gt;pp0_layer0_attn</title>
<path fill="none" stroke="black" d="M24109,-1975.48C24109,-1975.48 24109,-1946.54 24109,-1946.54"/>
<polygon fill="black" stroke="black" points="24112.5,-1946.54 24109,-1936.54 24105.5,-1946.54 24112.5,-1946.54"/>
</g>
<!-- pp0_layer0_tp_comm -->
<g id="node4" class="node">
<title>pp0_layer0_tp_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="24109" cy="-1784.42" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="24109" y="-1803.22" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="24109" y="-1788.22" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7], [8&#45;15], [16&#45;23], [24&#45;31]</text>
<text text-anchor="middle" x="24109" y="-1773.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=128]</text>
<text text-anchor="middle" x="24109" y="-1758.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_attn&#45;&gt;pp0_layer0_tp_comm -->
<g id="edge3" class="edge">
<title>pp0_layer0_attn&#45;&gt;pp0_layer0_tp_comm</title>
<path fill="none" stroke="black" d="M24109,-1868.34C24109,-1868.34 24109,-1842.55 24109,-1842.55"/>
<polygon fill="black" stroke="black" points="24112.5,-1842.55 24109,-1832.55 24105.5,-1842.55 24112.5,-1842.55"/>
</g>
<!-- pp0_layer0_moe -->
<g id="node5" class="node">
<title>pp0_layer0_moe</title>
<polygon fill="lightyellow" stroke="black" points="24530.92,-1700.33 23859.74,-1700.33 23687.08,-1564.33 24358.26,-1564.33 24530.92,-1700.33"/>
<text text-anchor="middle" x="24109" y="-1651.13" font-family="Times,serif" font-size="14.00">Layer 0: MoE Routing</text>
<text text-anchor="middle" x="24109" y="-1636.13" font-family="Times,serif" font-size="14.00">GPU: [0&#45;31]</text>
<text text-anchor="middle" x="24109" y="-1621.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="24109" y="-1606.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_tp_comm&#45;&gt;pp0_layer0_moe -->
<g id="edge4" class="edge">
<title>pp0_layer0_tp_comm&#45;&gt;pp0_layer0_moe</title>
<path fill="none" stroke="black" d="M24109,-1736.3C24109,-1736.3 24109,-1710.42 24109,-1710.42"/>
<polygon fill="black" stroke="black" points="24112.5,-1710.42 24109,-1700.42 24105.5,-1710.42 24112.5,-1710.42"/>
</g>
<!-- pp0_layer0_gate -->
<g id="node6" class="node">
<title>pp0_layer0_gate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24518.53,-1528.33 23867.06,-1528.33 23699.47,-1392.33 24350.94,-1392.33 24518.53,-1528.33"/>
<text text-anchor="middle" x="24109" y="-1479.13" font-family="Times,serif" font-size="14.00">Expert Gate Selection</text>
<text text-anchor="middle" x="24109" y="-1464.13" font-family="Times,serif" font-size="14.00">GPU: [0&#45;31]</text>
<text text-anchor="middle" x="24109" y="-1449.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="24109" y="-1434.13" font-family="Times,serif" font-size="14.00">Output: routing decisions</text>
</g>
<!-- pp0_layer0_moe&#45;&gt;pp0_layer0_gate -->
<g id="edge5" class="edge">
<title>pp0_layer0_moe&#45;&gt;pp0_layer0_gate</title>
<path fill="none" stroke="black" d="M24109,-1563.86C24109,-1563.86 24109,-1538.57 24109,-1538.57"/>
<polygon fill="black" stroke="black" points="24112.5,-1538.57 24109,-1528.57 24105.5,-1538.57 24112.5,-1538.57"/>
</g>
<!-- pp0_layer0_expert0 -->
<g id="node7" class="node">
<title>pp0_layer0_expert0</title>
<polygon fill="lightblue" stroke="black" points="23554,-1356.33 23144,-1356.33 23144,-1288.33 23554,-1288.33 23554,-1356.33"/>
<text text-anchor="middle" x="23349" y="-1341.13" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="23349" y="-1326.13" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="23349" y="-1311.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="23349" y="-1296.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_gate&#45;&gt;pp0_layer0_expert0 -->
<g id="edge6" class="edge">
<title>pp0_layer0_gate&#45;&gt;pp0_layer0_expert0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23782.83,-1460C23576.7,-1460 23349,-1460 23349,-1460 23349,-1460 23349,-1366.36 23349,-1366.36"/>
<polygon fill="black" stroke="black" points="23352.5,-1366.36 23349,-1356.36 23345.5,-1366.36 23352.5,-1366.36"/>
</g>
<!-- pp0_layer0_expert1 -->
<g id="node9" class="node">
<title>pp0_layer0_expert1</title>
<polygon fill="lightblue" stroke="black" points="24074,-1356.33 23664,-1356.33 23664,-1288.33 24074,-1288.33 24074,-1356.33"/>
<text text-anchor="middle" x="23869" y="-1341.13" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="23869" y="-1326.13" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="23869" y="-1311.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="23869" y="-1296.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_gate&#45;&gt;pp0_layer0_expert1 -->
<g id="edge9" class="edge">
<title>pp0_layer0_gate&#45;&gt;pp0_layer0_expert1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M23886.74,-1392.14C23886.74,-1392.14 23886.74,-1366.55 23886.74,-1366.55"/>
<polygon fill="black" stroke="black" points="23890.24,-1366.55 23886.74,-1356.55 23883.24,-1366.55 23890.24,-1366.55"/>
</g>
<!-- pp0_layer0_expert2 -->
<g id="node11" class="node">
<title>pp0_layer0_expert2</title>
<polygon fill="lightblue" stroke="black" points="24587,-1356.33 24177,-1356.33 24177,-1288.33 24587,-1288.33 24587,-1356.33"/>
<text text-anchor="middle" x="24382" y="-1341.13" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="24382" y="-1326.13" font-family="Times,serif" font-size="14.00">GPU: [16&#45;23]</text>
<text text-anchor="middle" x="24382" y="-1311.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="24382" y="-1296.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_gate&#45;&gt;pp0_layer0_expert2 -->
<g id="edge12" class="edge">
<title>pp0_layer0_gate&#45;&gt;pp0_layer0_expert2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24347.76,-1392.14C24347.76,-1392.14 24347.76,-1366.55 24347.76,-1366.55"/>
<polygon fill="black" stroke="black" points="24351.26,-1366.55 24347.76,-1356.55 24344.26,-1366.55 24351.26,-1366.55"/>
</g>
<!-- pp0_layer0_expert3 -->
<g id="node13" class="node">
<title>pp0_layer0_expert3</title>
<polygon fill="lightblue" stroke="black" points="25142,-1356.33 24732,-1356.33 24732,-1288.33 25142,-1288.33 25142,-1356.33"/>
<text text-anchor="middle" x="24937" y="-1341.13" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="24937" y="-1326.13" font-family="Times,serif" font-size="14.00">GPU: [24&#45;31]</text>
<text text-anchor="middle" x="24937" y="-1311.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="24937" y="-1296.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_gate&#45;&gt;pp0_layer0_expert3 -->
<g id="edge15" class="edge">
<title>pp0_layer0_gate&#45;&gt;pp0_layer0_expert3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M24434.46,-1460C24666.3,-1460 24937,-1460 24937,-1460 24937,-1460 24937,-1366.36 24937,-1366.36"/>
<polygon fill="black" stroke="black" points="24940.5,-1366.36 24937,-1356.36 24933.5,-1366.36 24940.5,-1366.36"/>
</g>
<!-- pp0_layer0_expert0_tp -->
<g id="node8" class="node">
<title>pp0_layer0_expert0_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="23258" cy="-1204.25" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="23258" y="-1223.05" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="23258" y="-1208.05" font-family="Times,serif" font-size="14.00">GPU: [0&#45;7]</text>
<text text-anchor="middle" x="23258" y="-1193.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="23258" y="-1178.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_expert0&#45;&gt;pp0_layer0_expert0_tp -->
<g id="edge7" class="edge">
<title>pp0_layer0_expert0&#45;&gt;pp0_layer0_expert0_tp</title>
<path fill="none" stroke="black" d="M23345.96,-1288.18C23345.96,-1288.18 23345.96,-1260.19 23345.96,-1260.19"/>
<polygon fill="black" stroke="black" points="23349.46,-1260.19 23345.96,-1250.19 23342.46,-1260.19 23349.46,-1260.19"/>
</g>
<!-- pp0_layer0_agg -->
<g id="node15" class="node">
<title>pp0_layer0_agg</title>
<polygon fill="lightyellow" stroke="black" points="24364.96,-1120.17 23658.72,-1120.17 23477.04,-984.17 24183.28,-984.17 24364.96,-1120.17"/>
<text text-anchor="middle" x="23921" y="-1070.97" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="23921" y="-1055.97" font-family="Times,serif" font-size="14.00">GPU: [0&#45;31]</text>
<text text-anchor="middle" x="23921" y="-1040.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024] × 4</text>
<text text-anchor="middle" x="23921" y="-1025.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_expert0_tp&#45;&gt;pp0_layer0_agg -->
<g id="edge8" class="edge">
<title>pp0_layer0_expert0_tp&#45;&gt;pp0_layer0_agg</title>
<path fill="none" stroke="black" d="M23512.59,-1181.15C23512.59,-1181.15 23512.59,-1062.23 23512.59,-1062.23"/>
<polygon fill="black" stroke="black" points="23516.09,-1062.23 23512.59,-1052.23 23509.09,-1062.23 23516.09,-1062.23"/>
</g>
<!-- pp0_layer0_expert1_tp -->
<g id="node10" class="node">
<title>pp0_layer0_expert1_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="23856" cy="-1204.25" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="23856" y="-1223.05" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="23856" y="-1208.05" font-family="Times,serif" font-size="14.00">GPU: [8&#45;15]</text>
<text text-anchor="middle" x="23856" y="-1193.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="23856" y="-1178.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_expert1&#45;&gt;pp0_layer0_expert1_tp -->
<g id="edge10" class="edge">
<title>pp0_layer0_expert1&#45;&gt;pp0_layer0_expert1_tp</title>
<path fill="none" stroke="black" d="M23869,-1288.18C23869,-1288.18 23869,-1262.38 23869,-1262.38"/>
<polygon fill="black" stroke="black" points="23872.5,-1262.38 23869,-1252.38 23865.5,-1262.38 23872.5,-1262.38"/>
</g>
<!-- pp0_layer0_expert1_tp&#45;&gt;pp0_layer0_agg -->
<g id="edge11" class="edge">
<title>pp0_layer0_expert1_tp&#45;&gt;pp0_layer0_agg</title>
<path fill="none" stroke="black" d="M23856,-1156.13C23856,-1156.13 23856,-1130.26 23856,-1130.26"/>
<polygon fill="black" stroke="black" points="23859.5,-1130.26 23856,-1120.26 23852.5,-1130.26 23859.5,-1130.26"/>
</g>
<!-- pp0_layer0_expert2_tp -->
<g id="node12" class="node">
<title>pp0_layer0_expert2_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="24454" cy="-1204.25" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="24454" y="-1223.05" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="24454" y="-1208.05" font-family="Times,serif" font-size="14.00">GPU: [16&#45;23]</text>
<text text-anchor="middle" x="24454" y="-1193.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="24454" y="-1178.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_expert2&#45;&gt;pp0_layer0_expert2_tp -->
<g id="edge13" class="edge">
<title>pp0_layer0_expert2&#45;&gt;pp0_layer0_expert2_tp</title>
<path fill="none" stroke="black" d="M24382,-1288.18C24382,-1288.18 24382,-1261.07 24382,-1261.07"/>
<polygon fill="black" stroke="black" points="24385.5,-1261.07 24382,-1251.07 24378.5,-1261.07 24385.5,-1261.07"/>
</g>
<!-- pp0_layer0_expert2_tp&#45;&gt;pp0_layer0_agg -->
<g id="edge14" class="edge">
<title>pp0_layer0_expert2_tp&#45;&gt;pp0_layer0_agg</title>
<path fill="none" stroke="black" d="M24264.41,-1167.82C24264.41,-1167.82 24264.41,-1130.46 24264.41,-1130.46"/>
<polygon fill="black" stroke="black" points="24267.91,-1130.46 24264.41,-1120.46 24260.91,-1130.46 24267.91,-1130.46"/>
</g>
<!-- pp0_layer0_expert3_tp -->
<g id="node14" class="node">
<title>pp0_layer0_expert3_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="25052" cy="-1204.25" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="25052" y="-1223.05" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="25052" y="-1208.05" font-family="Times,serif" font-size="14.00">GPU: [24&#45;31]</text>
<text text-anchor="middle" x="25052" y="-1193.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="25052" y="-1178.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_expert3&#45;&gt;pp0_layer0_expert3_tp -->
<g id="edge16" class="edge">
<title>pp0_layer0_expert3&#45;&gt;pp0_layer0_expert3_tp</title>
<path fill="none" stroke="black" d="M24952.04,-1288.18C24952.04,-1288.18 24952.04,-1259.76 24952.04,-1259.76"/>
<polygon fill="black" stroke="black" points="24955.54,-1259.76 24952.04,-1249.76 24948.54,-1259.76 24955.54,-1259.76"/>
</g>
<!-- pp0_layer0_expert3_tp&#45;&gt;pp0_layer0_agg -->
<g id="edge17" class="edge">
<title>pp0_layer0_expert3_tp&#45;&gt;pp0_layer0_agg</title>
<path fill="none" stroke="black" d="M25052,-1156.08C25052,-1111.47 25052,-1052 25052,-1052 25052,-1052 24284.2,-1052 24284.2,-1052"/>
<polygon fill="black" stroke="black" points="24284.2,-1048.5 24274.2,-1052 24284.2,-1055.5 24284.2,-1048.5"/>
</g>
<!-- pp0_layer0_ep_comm -->
<g id="node16" class="node">
<title>pp0_layer0_ep_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="23921" cy="-900.08" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="23921" y="-918.88" font-family="Times,serif" font-size="14.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="23921" y="-903.88" font-family="Times,serif" font-size="14.00">GPU: [0&#45;31]</text>
<text text-anchor="middle" x="23921" y="-888.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="23921" y="-873.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_agg&#45;&gt;pp0_layer0_ep_comm -->
<g id="edge18" class="edge">
<title>pp0_layer0_agg&#45;&gt;pp0_layer0_ep_comm</title>
<path fill="none" stroke="black" d="M23921,-984.13C23921,-984.13 23921,-958.48 23921,-958.48"/>
<polygon fill="black" stroke="black" points="23924.5,-958.48 23921,-948.48 23917.5,-958.48 23924.5,-958.48"/>
</g>
<!-- pp1_layer4_attn -->
<g id="node17" class="node">
<title>pp1_layer4_attn</title>
<polygon fill="lightblue" stroke="black" points="24124.5,-771 23717.5,-771 23717.5,-703 24124.5,-703 24124.5,-771"/>
<text text-anchor="middle" x="23921" y="-755.8" font-family="Times,serif" font-size="14.00">Layer 4: Attention</text>
<text text-anchor="middle" x="23921" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128&#45;159]</text>
<text text-anchor="middle" x="23921" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="23921" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_ep_comm&#45;&gt;pp1_layer4_attn -->
<g id="edge19" class="edge">
<title>pp0_layer0_ep_comm&#45;&gt;pp1_layer4_attn</title>
<path fill="none" stroke="black" d="M23921,-851.59C23921,-851.59 23921,-781.08 23921,-781.08"/>
<polygon fill="black" stroke="black" points="23924.5,-781.08 23921,-771.08 23917.5,-781.08 23924.5,-781.08"/>
</g>
<!-- pp1_layer4_moe -->
<g id="node19" class="node">
<title>pp1_layer4_moe</title>
<polygon fill="lightyellow" stroke="black" points="23105.92,-805 22434.74,-805 22262.08,-669 22933.26,-669 23105.92,-805"/>
<text text-anchor="middle" x="22684" y="-755.8" font-family="Times,serif" font-size="14.00">Layer 4: MoE Routing</text>
<text text-anchor="middle" x="22684" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128&#45;159]</text>
<text text-anchor="middle" x="22684" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="22684" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_ep_comm&#45;&gt;pp1_layer4_moe -->
<g id="edge24" class="edge">
<title>pp0_layer0_ep_comm&#45;&gt;pp1_layer4_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M23666.5,-877.54C23666.5,-846.66 23666.5,-795 23666.5,-795 23666.5,-795 23103.55,-795 23103.55,-795"/>
<polygon fill="black" stroke="black" points="23103.55,-791.5 23093.55,-795 23103.55,-798.5 23103.55,-791.5"/>
</g>
<!-- pp2_layer8_moe -->
<g id="node33" class="node">
<title>pp2_layer8_moe</title>
<polygon fill="lightyellow" stroke="black" points="15293.92,-622 14622.74,-622 14450.08,-486 15121.26,-486 15293.92,-622"/>
<text text-anchor="middle" x="14872" y="-572.8" font-family="Times,serif" font-size="14.00">Layer 8: MoE Routing</text>
<text text-anchor="middle" x="14872" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256&#45;287]</text>
<text text-anchor="middle" x="14872" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="14872" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_ep_comm&#45;&gt;pp2_layer8_moe -->
<g id="edge25" class="edge">
<title>pp0_layer0_ep_comm&#45;&gt;pp2_layer8_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M23705.69,-867.99C23705.69,-792.11 23705.69,-608 23705.69,-608 23705.69,-608 15286.34,-608 15286.34,-608"/>
<polygon fill="black" stroke="black" points="15286.34,-604.5 15276.34,-608 15286.34,-611.5 15286.34,-604.5"/>
</g>
<!-- pp3_layer12_moe -->
<g id="node47" class="node">
<title>pp3_layer12_moe</title>
<polygon fill="lightyellow" stroke="black" points="7481.92,-439 6810.74,-439 6638.08,-303 7309.26,-303 7481.92,-439"/>
<text text-anchor="middle" x="7060" y="-389.8" font-family="Times,serif" font-size="14.00">Layer 12: MoE Routing</text>
<text text-anchor="middle" x="7060" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384&#45;415]</text>
<text text-anchor="middle" x="7060" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="7060" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp0_layer0_ep_comm&#45;&gt;pp3_layer12_moe -->
<g id="edge26" class="edge">
<title>pp0_layer0_ep_comm&#45;&gt;pp3_layer12_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M23711.6,-866.98C23711.6,-759.02 23711.6,-424 23711.6,-424 23711.6,-424 7473.11,-424 7473.11,-424"/>
<polygon fill="black" stroke="black" points="7473.11,-420.5 7463.11,-424 7473.11,-427.5 7473.11,-420.5"/>
</g>
<!-- pp1_layer4_tp_comm -->
<g id="node18" class="node">
<title>pp1_layer4_tp_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="23412" cy="-737" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="23412" y="-755.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="23412" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128&#45;135], [136&#45;143], [144&#45;151], [152&#45;159]</text>
<text text-anchor="middle" x="23412" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=128]</text>
<text text-anchor="middle" x="23412" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_gate -->
<g id="node20" class="node">
<title>pp1_layer4_gate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="22244.53,-805 21593.06,-805 21425.47,-669 22076.94,-669 22244.53,-805"/>
<text text-anchor="middle" x="21835" y="-755.8" font-family="Times,serif" font-size="14.00">Expert Gate Selection</text>
<text text-anchor="middle" x="21835" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128&#45;159]</text>
<text text-anchor="middle" x="21835" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="21835" y="-710.8" font-family="Times,serif" font-size="14.00">Output: routing decisions</text>
</g>
<!-- pp1_layer4_expert0 -->
<g id="node21" class="node">
<title>pp1_layer4_expert0</title>
<polygon fill="lightblue" stroke="black" points="21407,-771 20997,-771 20997,-703 21407,-703 21407,-771"/>
<text text-anchor="middle" x="21202" y="-755.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="21202" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128+0&#45;128+7]</text>
<text text-anchor="middle" x="21202" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="21202" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_expert0_tp -->
<g id="node22" class="node">
<title>pp1_layer4_expert0_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="20689" cy="-737" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="20689" y="-755.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="20689" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128+0&#45;128+7]</text>
<text text-anchor="middle" x="20689" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="20689" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_expert1 -->
<g id="node23" class="node">
<title>pp1_layer4_expert1</title>
<polygon fill="lightblue" stroke="black" points="20381,-771 19971,-771 19971,-703 20381,-703 20381,-771"/>
<text text-anchor="middle" x="20176" y="-755.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="20176" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128+8&#45;128+15]</text>
<text text-anchor="middle" x="20176" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="20176" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_expert1_tp -->
<g id="node24" class="node">
<title>pp1_layer4_expert1_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="19663" cy="-737" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="19663" y="-755.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="19663" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128+8&#45;128+15]</text>
<text text-anchor="middle" x="19663" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="19663" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_expert2 -->
<g id="node25" class="node">
<title>pp1_layer4_expert2</title>
<polygon fill="lightblue" stroke="black" points="19355,-771 18945,-771 18945,-703 19355,-703 19355,-771"/>
<text text-anchor="middle" x="19150" y="-755.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="19150" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128+16&#45;128+23]</text>
<text text-anchor="middle" x="19150" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="19150" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_expert2_tp -->
<g id="node26" class="node">
<title>pp1_layer4_expert2_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="18637" cy="-737" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="18637" y="-755.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="18637" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128+16&#45;128+23]</text>
<text text-anchor="middle" x="18637" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="18637" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_expert3 -->
<g id="node27" class="node">
<title>pp1_layer4_expert3</title>
<polygon fill="lightblue" stroke="black" points="18329,-771 17919,-771 17919,-703 18329,-703 18329,-771"/>
<text text-anchor="middle" x="18124" y="-755.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="18124" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128+24&#45;128+31]</text>
<text text-anchor="middle" x="18124" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="18124" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_expert3_tp -->
<g id="node28" class="node">
<title>pp1_layer4_expert3_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="17611" cy="-737" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="17611" y="-755.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="17611" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128+24&#45;128+31]</text>
<text text-anchor="middle" x="17611" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="17611" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_agg -->
<g id="node29" class="node">
<title>pp1_layer4_agg</title>
<polygon fill="lightyellow" stroke="black" points="17302.96,-805 16596.72,-805 16415.04,-669 17121.28,-669 17302.96,-805"/>
<text text-anchor="middle" x="16859" y="-755.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16859" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128&#45;159]</text>
<text text-anchor="middle" x="16859" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024] × 4</text>
<text text-anchor="middle" x="16859" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_ep_comm -->
<g id="node30" class="node">
<title>pp1_layer4_ep_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="16109" cy="-737" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="16109" y="-755.8" font-family="Times,serif" font-size="14.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="16109" y="-740.8" font-family="Times,serif" font-size="14.00">GPU: [128&#45;159]</text>
<text text-anchor="middle" x="16109" y="-725.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="16109" y="-710.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_ep_comm&#45;&gt;pp0_layer0_moe -->
<g id="edge27" class="edge">
<title>pp1_layer4_ep_comm&#45;&gt;pp0_layer0_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M16109,-785.14C16109,-966.46 16109,-1598 16109,-1598 16109,-1598 23719.53,-1598 23719.53,-1598"/>
<polygon fill="black" stroke="black" points="23719.53,-1601.5 23729.53,-1598 23719.53,-1594.5 23719.53,-1601.5"/>
</g>
<!-- pp2_layer8_attn -->
<g id="node31" class="node">
<title>pp2_layer8_attn</title>
<polygon fill="lightblue" stroke="black" points="16312.5,-588 15905.5,-588 15905.5,-520 16312.5,-520 16312.5,-588"/>
<text text-anchor="middle" x="16109" y="-572.8" font-family="Times,serif" font-size="14.00">Layer 8: Attention</text>
<text text-anchor="middle" x="16109" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256&#45;287]</text>
<text text-anchor="middle" x="16109" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="16109" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp1_layer4_ep_comm&#45;&gt;pp2_layer8_attn -->
<g id="edge20" class="edge">
<title>pp1_layer4_ep_comm&#45;&gt;pp2_layer8_attn</title>
<path fill="none" stroke="black" d="M16109,-688.44C16109,-688.44 16109,-598 16109,-598"/>
<polygon fill="black" stroke="black" points="16112.5,-598 16109,-588 16105.5,-598 16112.5,-598"/>
</g>
<!-- pp1_layer4_ep_comm&#45;&gt;pp2_layer8_moe -->
<g id="edge28" class="edge">
<title>pp1_layer4_ep_comm&#45;&gt;pp2_layer8_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15854.5,-714.34C15854.5,-679.06 15854.5,-615 15854.5,-615 15854.5,-615 15295.11,-615 15295.11,-615"/>
<polygon fill="black" stroke="black" points="15295.11,-611.5 15285.11,-615 15295.11,-618.5 15295.11,-611.5"/>
</g>
<!-- pp1_layer4_ep_comm&#45;&gt;pp3_layer12_moe -->
<g id="edge29" class="edge">
<title>pp1_layer4_ep_comm&#45;&gt;pp3_layer12_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M15896.65,-704.33C15896.65,-625.06 15896.65,-429 15896.65,-429 15896.65,-429 7479.59,-429 7479.59,-429"/>
<polygon fill="black" stroke="black" points="7479.59,-425.5 7469.59,-429 7479.59,-432.5 7479.59,-425.5"/>
</g>
<!-- pp2_layer8_tp_comm -->
<g id="node32" class="node">
<title>pp2_layer8_tp_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="15600" cy="-554" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="15600" y="-572.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="15600" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256&#45;263], [264&#45;271], [272&#45;279], [280&#45;287]</text>
<text text-anchor="middle" x="15600" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=128]</text>
<text text-anchor="middle" x="15600" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_gate -->
<g id="node34" class="node">
<title>pp2_layer8_gate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="14432.53,-622 13781.06,-622 13613.47,-486 14264.94,-486 14432.53,-622"/>
<text text-anchor="middle" x="14023" y="-572.8" font-family="Times,serif" font-size="14.00">Expert Gate Selection</text>
<text text-anchor="middle" x="14023" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256&#45;287]</text>
<text text-anchor="middle" x="14023" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="14023" y="-527.8" font-family="Times,serif" font-size="14.00">Output: routing decisions</text>
</g>
<!-- pp2_layer8_expert0 -->
<g id="node35" class="node">
<title>pp2_layer8_expert0</title>
<polygon fill="lightblue" stroke="black" points="13595,-588 13185,-588 13185,-520 13595,-520 13595,-588"/>
<text text-anchor="middle" x="13390" y="-572.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13390" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256+0&#45;256+7]</text>
<text text-anchor="middle" x="13390" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="13390" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_expert0_tp -->
<g id="node36" class="node">
<title>pp2_layer8_expert0_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="12877" cy="-554" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="12877" y="-572.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="12877" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256+0&#45;256+7]</text>
<text text-anchor="middle" x="12877" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="12877" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_expert1 -->
<g id="node37" class="node">
<title>pp2_layer8_expert1</title>
<polygon fill="lightblue" stroke="black" points="12569,-588 12159,-588 12159,-520 12569,-520 12569,-588"/>
<text text-anchor="middle" x="12364" y="-572.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="12364" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256+8&#45;256+15]</text>
<text text-anchor="middle" x="12364" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="12364" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_expert1_tp -->
<g id="node38" class="node">
<title>pp2_layer8_expert1_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="11851" cy="-554" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="11851" y="-572.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="11851" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256+8&#45;256+15]</text>
<text text-anchor="middle" x="11851" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="11851" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_expert2 -->
<g id="node39" class="node">
<title>pp2_layer8_expert2</title>
<polygon fill="lightblue" stroke="black" points="11543,-588 11133,-588 11133,-520 11543,-520 11543,-588"/>
<text text-anchor="middle" x="11338" y="-572.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11338" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256+16&#45;256+23]</text>
<text text-anchor="middle" x="11338" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="11338" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_expert2_tp -->
<g id="node40" class="node">
<title>pp2_layer8_expert2_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="10825" cy="-554" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="10825" y="-572.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="10825" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256+16&#45;256+23]</text>
<text text-anchor="middle" x="10825" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="10825" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_expert3 -->
<g id="node41" class="node">
<title>pp2_layer8_expert3</title>
<polygon fill="lightblue" stroke="black" points="10517,-588 10107,-588 10107,-520 10517,-520 10517,-588"/>
<text text-anchor="middle" x="10312" y="-572.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10312" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256+24&#45;256+31]</text>
<text text-anchor="middle" x="10312" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="10312" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_expert3_tp -->
<g id="node42" class="node">
<title>pp2_layer8_expert3_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="9799" cy="-554" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="9799" y="-572.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="9799" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256+24&#45;256+31]</text>
<text text-anchor="middle" x="9799" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="9799" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_agg -->
<g id="node43" class="node">
<title>pp2_layer8_agg</title>
<polygon fill="lightyellow" stroke="black" points="9490.96,-622 8784.72,-622 8603.04,-486 9309.28,-486 9490.96,-622"/>
<text text-anchor="middle" x="9047" y="-572.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9047" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256&#45;287]</text>
<text text-anchor="middle" x="9047" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024] × 4</text>
<text text-anchor="middle" x="9047" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_ep_comm -->
<g id="node44" class="node">
<title>pp2_layer8_ep_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="8297" cy="-554" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="8297" y="-572.8" font-family="Times,serif" font-size="14.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="8297" y="-557.8" font-family="Times,serif" font-size="14.00">GPU: [256&#45;287]</text>
<text text-anchor="middle" x="8297" y="-542.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="8297" y="-527.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_ep_comm&#45;&gt;pp0_layer0_moe -->
<g id="edge30" class="edge">
<title>pp2_layer8_ep_comm&#45;&gt;pp0_layer0_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8297,-602.41C8297,-812.17 8297,-1632 8297,-1632 8297,-1632 23762.81,-1632 23762.81,-1632"/>
<polygon fill="black" stroke="black" points="23762.81,-1635.5 23772.81,-1632 23762.81,-1628.5 23762.81,-1635.5"/>
</g>
<!-- pp2_layer8_ep_comm&#45;&gt;pp1_layer4_moe -->
<g id="edge31" class="edge">
<title>pp2_layer8_ep_comm&#45;&gt;pp1_layer4_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8542.65,-528.86C8542.65,-501.62 8542.65,-462 8542.65,-462 8542.65,-462 22543.35,-462 22543.35,-462 22543.35,-462 22543.35,-658.67 22543.35,-658.67"/>
<polygon fill="black" stroke="black" points="22539.85,-658.67 22543.35,-668.67 22546.85,-658.67 22539.85,-658.67"/>
</g>
<!-- pp3_layer12_attn -->
<g id="node45" class="node">
<title>pp3_layer12_attn</title>
<polygon fill="lightblue" stroke="black" points="8500.5,-405 8093.5,-405 8093.5,-337 8500.5,-337 8500.5,-405"/>
<text text-anchor="middle" x="8297" y="-389.8" font-family="Times,serif" font-size="14.00">Layer 12: Attention</text>
<text text-anchor="middle" x="8297" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384&#45;415]</text>
<text text-anchor="middle" x="8297" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="8297" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp2_layer8_ep_comm&#45;&gt;pp3_layer12_attn -->
<g id="edge21" class="edge">
<title>pp2_layer8_ep_comm&#45;&gt;pp3_layer12_attn</title>
<path fill="none" stroke="black" d="M8297,-505.44C8297,-505.44 8297,-415 8297,-415"/>
<polygon fill="black" stroke="black" points="8300.5,-415 8297,-405 8293.5,-415 8300.5,-415"/>
</g>
<!-- pp2_layer8_ep_comm&#45;&gt;pp3_layer12_moe -->
<g id="edge32" class="edge">
<title>pp2_layer8_ep_comm&#45;&gt;pp3_layer12_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M8042.5,-531.43C8042.5,-496.67 8042.5,-434 8042.5,-434 8042.5,-434 7485.6,-434 7485.6,-434"/>
<polygon fill="black" stroke="black" points="7485.6,-430.5 7475.6,-434 7485.6,-437.5 7485.6,-430.5"/>
</g>
<!-- pp3_layer12_tp_comm -->
<g id="node46" class="node">
<title>pp3_layer12_tp_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="7788" cy="-371" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="7788" y="-389.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="7788" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384&#45;391], [392&#45;399], [400&#45;407], [408&#45;415]</text>
<text text-anchor="middle" x="7788" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=128]</text>
<text text-anchor="middle" x="7788" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_gate -->
<g id="node48" class="node">
<title>pp3_layer12_gate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6620.53,-439 5969.06,-439 5801.47,-303 6452.94,-303 6620.53,-439"/>
<text text-anchor="middle" x="6211" y="-389.8" font-family="Times,serif" font-size="14.00">Expert Gate Selection</text>
<text text-anchor="middle" x="6211" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384&#45;415]</text>
<text text-anchor="middle" x="6211" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="6211" y="-344.8" font-family="Times,serif" font-size="14.00">Output: routing decisions</text>
</g>
<!-- pp3_layer12_expert0 -->
<g id="node49" class="node">
<title>pp3_layer12_expert0</title>
<polygon fill="lightblue" stroke="black" points="5783,-405 5373,-405 5373,-337 5783,-337 5783,-405"/>
<text text-anchor="middle" x="5578" y="-389.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5578" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384+0&#45;384+7]</text>
<text text-anchor="middle" x="5578" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="5578" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_expert0_tp -->
<g id="node50" class="node">
<title>pp3_layer12_expert0_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="5065" cy="-371" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="5065" y="-389.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="5065" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384+0&#45;384+7]</text>
<text text-anchor="middle" x="5065" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="5065" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_expert1 -->
<g id="node51" class="node">
<title>pp3_layer12_expert1</title>
<polygon fill="lightblue" stroke="black" points="4757,-405 4347,-405 4347,-337 4757,-337 4757,-405"/>
<text text-anchor="middle" x="4552" y="-389.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4552" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384+8&#45;384+15]</text>
<text text-anchor="middle" x="4552" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="4552" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_expert1_tp -->
<g id="node52" class="node">
<title>pp3_layer12_expert1_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="4039" cy="-371" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="4039" y="-389.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="4039" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384+8&#45;384+15]</text>
<text text-anchor="middle" x="4039" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="4039" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_expert2 -->
<g id="node53" class="node">
<title>pp3_layer12_expert2</title>
<polygon fill="lightblue" stroke="black" points="3731,-405 3321,-405 3321,-337 3731,-337 3731,-405"/>
<text text-anchor="middle" x="3526" y="-389.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3526" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384+16&#45;384+23]</text>
<text text-anchor="middle" x="3526" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="3526" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_expert2_tp -->
<g id="node54" class="node">
<title>pp3_layer12_expert2_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="3013" cy="-371" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="3013" y="-389.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="3013" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384+16&#45;384+23]</text>
<text text-anchor="middle" x="3013" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="3013" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_expert3 -->
<g id="node55" class="node">
<title>pp3_layer12_expert3</title>
<polygon fill="lightblue" stroke="black" points="2705,-405 2295,-405 2295,-337 2705,-337 2705,-405"/>
<text text-anchor="middle" x="2500" y="-389.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2500" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384+24&#45;384+31]</text>
<text text-anchor="middle" x="2500" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="2500" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_expert3_tp -->
<g id="node56" class="node">
<title>pp3_layer12_expert3_tp</title>
<ellipse fill="lightgreen" stroke="black" cx="1987" cy="-371" rx="289.83" ry="48.17"/>
<text text-anchor="middle" x="1987" y="-389.8" font-family="Times,serif" font-size="14.00">TP All&#45;Reduce</text>
<text text-anchor="middle" x="1987" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384+24&#45;384+31]</text>
<text text-anchor="middle" x="1987" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=256]</text>
<text text-anchor="middle" x="1987" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=~2, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_agg -->
<g id="node57" class="node">
<title>pp3_layer12_agg</title>
<polygon fill="lightyellow" stroke="black" points="1678.96,-439 972.72,-439 791.04,-303 1497.28,-303 1678.96,-439"/>
<text text-anchor="middle" x="1235" y="-389.8" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1235" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384&#45;415]</text>
<text text-anchor="middle" x="1235" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=~2, seq_len=1024, hidden=1024] × 4</text>
<text text-anchor="middle" x="1235" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_ep_comm -->
<g id="node58" class="node">
<title>pp3_layer12_ep_comm</title>
<ellipse fill="lightgreen" stroke="black" cx="485" cy="-371" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="485" y="-389.8" font-family="Times,serif" font-size="14.00">EP All&#45;to&#45;All</text>
<text text-anchor="middle" x="485" y="-374.8" font-family="Times,serif" font-size="14.00">GPU: [384&#45;415]</text>
<text text-anchor="middle" x="485" y="-359.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="485" y="-344.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, hidden=1024]</text>
</g>
<!-- pp3_layer12_ep_comm&#45;&gt;pp0_layer0_moe -->
<g id="edge33" class="edge">
<title>pp3_layer12_ep_comm&#45;&gt;pp0_layer0_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M485,-419.4C485,-654.5 485,-1666 485,-1666 485,-1666 23805.91,-1666 23805.91,-1666"/>
<polygon fill="black" stroke="black" points="23805.91,-1669.5 23815.91,-1666 23805.91,-1662.5 23805.91,-1669.5"/>
</g>
<!-- pp3_layer12_ep_comm&#45;&gt;pp1_layer4_moe -->
<g id="edge34" class="edge">
<title>pp3_layer12_ep_comm&#45;&gt;pp1_layer4_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M728.6,-345.25C728.6,-315.62 728.6,-271 728.6,-271 728.6,-271 22824.65,-271 22824.65,-271 22824.65,-271 22824.65,-658.74 22824.65,-658.74"/>
<polygon fill="black" stroke="black" points="22821.15,-658.74 22824.65,-668.74 22828.15,-658.74 22821.15,-658.74"/>
</g>
<!-- pp3_layer12_ep_comm&#45;&gt;pp2_layer8_moe -->
<g id="edge35" class="edge">
<title>pp3_layer12_ep_comm&#45;&gt;pp2_layer8_moe</title>
<path fill="none" stroke="black" stroke-dasharray="1,5" d="M750.69,-352.36C750.69,-327.61 750.69,-287 750.69,-287 750.69,-287 14872,-287 14872,-287 14872,-287 14872,-475.93 14872,-475.93"/>
<polygon fill="black" stroke="black" points="14868.5,-475.93 14872,-485.93 14875.5,-475.93 14868.5,-475.93"/>
</g>
<!-- output -->
<g id="node59" class="node">
<title>output</title>
<polygon fill="lightblue" stroke="black" points="706.5,-256 263.5,-256 263.5,-188 706.5,-188 706.5,-256"/>
<text text-anchor="middle" x="485" y="-240.8" font-family="Times,serif" font-size="14.00">Output Layer</text>
<text text-anchor="middle" x="485" y="-225.8" font-family="Times,serif" font-size="14.00">GPU: [384&#45;415]</text>
<text text-anchor="middle" x="485" y="-210.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, hidden=1024]</text>
<text text-anchor="middle" x="485" y="-195.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=32, seq_len=1024, vocab_size=32000]</text>
</g>
<!-- pp3_layer12_ep_comm&#45;&gt;output -->
<g id="edge22" class="edge">
<title>pp3_layer12_ep_comm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M485,-322.62C485,-322.62 485,-266.46 485,-266.46"/>
<polygon fill="black" stroke="black" points="488.5,-266.46 485,-256.46 481.5,-266.46 488.5,-266.46"/>
</g>
<!-- dp_agg -->
<g id="node60" class="node">
<title>dp_agg</title>
<polygon fill="lightyellow" stroke="black" points="953.72,-152 208.09,-152 16.28,-16 761.91,-16 953.72,-152"/>
<text text-anchor="middle" x="485" y="-102.8" font-family="Times,serif" font-size="14.00">DP Aggregation</text>
<text text-anchor="middle" x="485" y="-87.8" font-family="Times,serif" font-size="14.00">GPU: [0&#45;511]</text>
<text text-anchor="middle" x="485" y="-72.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=32, seq_len=1024, vocab_size=32000]</text>
<text text-anchor="middle" x="485" y="-57.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=128, seq_len=1024, vocab_size=32000]</text>
</g>
<!-- output&#45;&gt;dp_agg -->
<g id="edge23" class="edge">
<title>output&#45;&gt;dp_agg</title>
<path fill="none" stroke="black" d="M485,-187.89C485,-187.89 485,-162.23 485,-162.23"/>
<polygon fill="black" stroke="black" points="488.5,-162.23 485,-152.23 481.5,-162.23 488.5,-162.23"/>
</g>
</g>
</svg>
