// Detailed MoE Parallelism with Communication
digraph {
	subgraph cluster_dp {
		label="Data Parallelism"
		dp_split [label="DP Split" shape=parallelogram]
		dp_agg [label="DP Aggregate" shape=parallelogram]
	}
	subgraph cluster_tp {
		label="Tensor Parallelism"
		tp_split [label="TP Split" shape=parallelogram]
		tp_concat [label="TP Concat" shape=parallelogram]
	}
	subgraph cluster_ep {
		label="Expert Parallelism"
		ep_expert_0 [label="Expert 0" shape=rectangle]
		ep_expert_1 [label="Expert 1" shape=rectangle]
		ep_expert_2 [label="Expert 2" shape=rectangle]
		ep_expert_3 [label="Expert 3" shape=rectangle]
		ep_expert_4 [label="Expert 4" shape=rectangle]
		ep_expert_5 [label="Expert 5" shape=rectangle]
		ep_expert_6 [label="Expert 6" shape=rectangle]
		ep_expert_7 [label="Expert 7" shape=rectangle]
		ep_expert_8 [label="Expert 8" shape=rectangle]
		ep_expert_9 [label="Expert 9" shape=rectangle]
		ep_expert_10 [label="Expert 10" shape=rectangle]
		ep_expert_11 [label="Expert 11" shape=rectangle]
		ep_expert_12 [label="Expert 12" shape=rectangle]
		ep_expert_13 [label="Expert 13" shape=rectangle]
		ep_expert_14 [label="Expert 14" shape=rectangle]
		ep_expert_15 [label="Expert 15" shape=rectangle]
	}
}
