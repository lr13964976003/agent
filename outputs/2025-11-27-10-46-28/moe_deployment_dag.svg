<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="7115pt" height="3082pt"
 viewBox="0.00 0.00 7115.00 3082.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3078.33)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3078.33 7111,-3078.33 7111,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="3632.5" cy="-3026.25" rx="304.53" ry="48.17"/>
<text text-anchor="middle" x="3632.5" y="-3045.05" font-family="Times,serif" font-size="14.00">Input Layer</text>
<text text-anchor="middle" x="3632.5" y="-3030.05" font-family="Times,serif" font-size="14.00">GPU: META</text>
<text text-anchor="middle" x="3632.5" y="-3015.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, vocab_size=128256]</text>
<text text-anchor="middle" x="3632.5" y="-3000.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- dense1_dp_split -->
<g id="node2" class="node">
<title>dense1_dp_split</title>
<polygon fill="yellow" stroke="black" points="4091.56,-2941.17 3361.3,-2941.17 3173.44,-2805.17 3903.7,-2805.17 4091.56,-2941.17"/>
<text text-anchor="middle" x="3632.5" y="-2891.97" font-family="Times,serif" font-size="14.00">DP Split</text>
<text text-anchor="middle" x="3632.5" y="-2876.97" font-family="Times,serif" font-size="14.00">GPU: META</text>
<text text-anchor="middle" x="3632.5" y="-2861.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, vocab_size=128256]</text>
<text text-anchor="middle" x="3632.5" y="-2846.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, vocab_size=128256]</text>
</g>
<!-- input&#45;&gt;dense1_dp_split -->
<g id="edge33" class="edge">
<title>input&#45;&gt;dense1_dp_split</title>
<path fill="none" stroke="black" d="M3632.5,-2977.86C3632.5,-2969.44 3632.5,-2960.46 3632.5,-2951.46"/>
<polygon fill="black" stroke="black" points="3636,-2951.31 3632.5,-2941.31 3629,-2951.31 3636,-2951.31"/>
</g>
<!-- embed_gpu0 -->
<g id="node3" class="node">
<title>embed_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3624,-2768.17 3193,-2768.17 3193,-2700.17 3624,-2700.17 3624,-2768.17"/>
<text text-anchor="middle" x="3408.5" y="-2752.97" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="3408.5" y="-2737.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3408.5" y="-2722.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, vocab_size=128256]</text>
<text text-anchor="middle" x="3408.5" y="-2707.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=3584]</text>
</g>
<!-- dense1_dp_split&#45;&gt;embed_gpu0 -->
<g id="edge34" class="edge">
<title>dense1_dp_split&#45;&gt;embed_gpu0</title>
<path fill="none" stroke="black" d="M3522.8,-2805.07C3505.12,-2794.26 3487.37,-2783.4 3471.3,-2773.57"/>
<polygon fill="black" stroke="black" points="3472.91,-2770.46 3462.56,-2768.23 3469.26,-2776.43 3472.91,-2770.46"/>
</g>
<!-- embed_gpu1 -->
<g id="node4" class="node">
<title>embed_gpu1</title>
<polygon fill="lightblue" stroke="black" points="4073,-2768.17 3642,-2768.17 3642,-2700.17 4073,-2700.17 4073,-2768.17"/>
<text text-anchor="middle" x="3857.5" y="-2752.97" font-family="Times,serif" font-size="14.00">Embedding</text>
<text text-anchor="middle" x="3857.5" y="-2737.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="3857.5" y="-2722.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, vocab_size=128256]</text>
<text text-anchor="middle" x="3857.5" y="-2707.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=3584]</text>
</g>
<!-- dense1_dp_split&#45;&gt;embed_gpu1 -->
<g id="edge35" class="edge">
<title>dense1_dp_split&#45;&gt;embed_gpu1</title>
<path fill="none" stroke="black" d="M3742.69,-2805.07C3760.45,-2794.26 3778.28,-2783.4 3794.42,-2773.57"/>
<polygon fill="black" stroke="black" points="3796.48,-2776.42 3803.2,-2768.23 3792.84,-2770.44 3796.48,-2776.42"/>
</g>
<!-- embed_concat -->
<g id="node5" class="node">
<title>embed_concat</title>
<polygon fill="yellow" stroke="black" points="4079.18,-2663.17 3368.61,-2663.17 3185.82,-2527.17 3896.39,-2527.17 4079.18,-2663.17"/>
<text text-anchor="middle" x="3632.5" y="-2613.97" font-family="Times,serif" font-size="14.00">TP Concat</text>
<text text-anchor="middle" x="3632.5" y="-2598.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;1</text>
<text text-anchor="middle" x="3632.5" y="-2583.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, hidden_dim=3584]</text>
<text text-anchor="middle" x="3632.5" y="-2568.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- embed_gpu0&#45;&gt;embed_concat -->
<g id="edge36" class="edge">
<title>embed_gpu0&#45;&gt;embed_concat</title>
<path fill="none" stroke="black" d="M3462.72,-2700C3478.3,-2690.48 3495.93,-2679.69 3513.79,-2668.77"/>
<polygon fill="black" stroke="black" points="3515.87,-2671.6 3522.57,-2663.4 3512.21,-2665.63 3515.87,-2671.6"/>
</g>
<!-- embed_gpu1&#45;&gt;embed_concat -->
<g id="edge37" class="edge">
<title>embed_gpu1&#45;&gt;embed_concat</title>
<path fill="none" stroke="black" d="M3803.03,-2700C3787.39,-2690.48 3769.68,-2679.69 3751.74,-2668.77"/>
<polygon fill="black" stroke="black" points="3753.28,-2665.61 3742.92,-2663.4 3749.64,-2671.59 3753.28,-2665.61"/>
</g>
<!-- ln1_gpu0 -->
<g id="node6" class="node">
<title>ln1_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3848,-2490.17 3417,-2490.17 3417,-2422.17 3848,-2422.17 3848,-2490.17"/>
<text text-anchor="middle" x="3632.5" y="-2474.97" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3632.5" y="-2459.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3632.5" y="-2444.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
<text text-anchor="middle" x="3632.5" y="-2429.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- embed_concat&#45;&gt;ln1_gpu0 -->
<g id="edge38" class="edge">
<title>embed_concat&#45;&gt;ln1_gpu0</title>
<path fill="none" stroke="black" d="M3632.5,-2526.87C3632.5,-2517.93 3632.5,-2508.95 3632.5,-2500.56"/>
<polygon fill="black" stroke="black" points="3636,-2500.29 3632.5,-2490.29 3629,-2500.29 3636,-2500.29"/>
</g>
<!-- qkv_proj_gpu0 -->
<g id="node7" class="node">
<title>qkv_proj_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3900.5,-2385.17 3364.5,-2385.17 3364.5,-2317.17 3900.5,-2317.17 3900.5,-2385.17"/>
<text text-anchor="middle" x="3632.5" y="-2369.97" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3632.5" y="-2354.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3632.5" y="-2339.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
<text text-anchor="middle" x="3632.5" y="-2324.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, num_heads=128, head_dim=168]</text>
</g>
<!-- ln1_gpu0&#45;&gt;qkv_proj_gpu0 -->
<g id="edge39" class="edge">
<title>ln1_gpu0&#45;&gt;qkv_proj_gpu0</title>
<path fill="none" stroke="black" d="M3632.5,-2422.01C3632.5,-2413.56 3632.5,-2404.34 3632.5,-2395.47"/>
<polygon fill="black" stroke="black" points="3636,-2395.26 3632.5,-2385.26 3629,-2395.26 3636,-2395.26"/>
</g>
<!-- mla_split -->
<g id="node8" class="node">
<title>mla_split</title>
<polygon fill="yellow" stroke="black" points="4206.72,-2280.17 3293.26,-2280.17 3058.28,-2144.17 3971.74,-2144.17 4206.72,-2280.17"/>
<text text-anchor="middle" x="3632.5" y="-2230.97" font-family="Times,serif" font-size="14.00">Head Split</text>
<text text-anchor="middle" x="3632.5" y="-2215.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3632.5" y="-2200.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, num_heads=128, head_dim=168]</text>
<text text-anchor="middle" x="3632.5" y="-2185.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=168]</text>
</g>
<!-- qkv_proj_gpu0&#45;&gt;mla_split -->
<g id="edge40" class="edge">
<title>qkv_proj_gpu0&#45;&gt;mla_split</title>
<path fill="none" stroke="black" d="M3632.5,-2317C3632.5,-2308.86 3632.5,-2299.8 3632.5,-2290.52"/>
<polygon fill="black" stroke="black" points="3636,-2290.4 3632.5,-2280.4 3629,-2290.4 3636,-2290.4"/>
</g>
<!-- mha_gpu0 -->
<g id="node9" class="node">
<title>mha_gpu0</title>
<polygon fill="lightblue" stroke="black" points="1868,-2107.17 1323,-2107.17 1323,-2039.17 1868,-2039.17 1868,-2107.17"/>
<text text-anchor="middle" x="1595.5" y="-2091.97" font-family="Times,serif" font-size="14.00">MHA Head Group</text>
<text text-anchor="middle" x="1595.5" y="-2076.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="1595.5" y="-2061.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=168]</text>
<text text-anchor="middle" x="1595.5" y="-2046.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=56]</text>
</g>
<!-- mla_split&#45;&gt;mha_gpu0 -->
<g id="edge41" class="edge">
<title>mla_split&#45;&gt;mha_gpu0</title>
<path fill="none" stroke="black" d="M3136.17,-2189.43C2786.93,-2172.27 2308.42,-2145.05 1878.17,-2107.3"/>
<polygon fill="black" stroke="black" points="1878.28,-2103.8 1868.02,-2106.41 1877.67,-2110.77 1878.28,-2103.8"/>
</g>
<!-- mha_gpu1 -->
<g id="node10" class="node">
<title>mha_gpu1</title>
<polygon fill="lightblue" stroke="black" points="2431,-2107.17 1886,-2107.17 1886,-2039.17 2431,-2039.17 2431,-2107.17"/>
<text text-anchor="middle" x="2158.5" y="-2091.97" font-family="Times,serif" font-size="14.00">MHA Head Group</text>
<text text-anchor="middle" x="2158.5" y="-2076.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="2158.5" y="-2061.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=168]</text>
<text text-anchor="middle" x="2158.5" y="-2046.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=56]</text>
</g>
<!-- mla_split&#45;&gt;mha_gpu1 -->
<g id="edge42" class="edge">
<title>mla_split&#45;&gt;mha_gpu1</title>
<path fill="none" stroke="black" d="M3099.55,-2168.14C2896.37,-2150.85 2662.44,-2129.88 2441.22,-2107.33"/>
<polygon fill="black" stroke="black" points="2441.33,-2103.83 2431.03,-2106.29 2440.62,-2110.79 2441.33,-2103.83"/>
</g>
<!-- mha_gpu2 -->
<g id="node11" class="node">
<title>mha_gpu2</title>
<polygon fill="lightblue" stroke="black" points="2994,-2107.17 2449,-2107.17 2449,-2039.17 2994,-2039.17 2994,-2107.17"/>
<text text-anchor="middle" x="2721.5" y="-2091.97" font-family="Times,serif" font-size="14.00">MHA Head Group</text>
<text text-anchor="middle" x="2721.5" y="-2076.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="2721.5" y="-2061.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=168]</text>
<text text-anchor="middle" x="2721.5" y="-2046.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=56]</text>
</g>
<!-- mla_split&#45;&gt;mha_gpu2 -->
<g id="edge43" class="edge">
<title>mla_split&#45;&gt;mha_gpu2</title>
<path fill="none" stroke="black" d="M3186.67,-2144.12C3105.04,-2131.85 3023,-2119.51 2951.03,-2108.68"/>
<polygon fill="black" stroke="black" points="2951.35,-2105.19 2940.94,-2107.17 2950.31,-2112.12 2951.35,-2105.19"/>
</g>
<!-- mha_gpu3 -->
<g id="node12" class="node">
<title>mha_gpu3</title>
<polygon fill="lightblue" stroke="black" points="3557,-2107.17 3012,-2107.17 3012,-2039.17 3557,-2039.17 3557,-2107.17"/>
<text text-anchor="middle" x="3284.5" y="-2091.97" font-family="Times,serif" font-size="14.00">MHA Head Group</text>
<text text-anchor="middle" x="3284.5" y="-2076.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="3284.5" y="-2061.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=168]</text>
<text text-anchor="middle" x="3284.5" y="-2046.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=56]</text>
</g>
<!-- mla_split&#45;&gt;mha_gpu3 -->
<g id="edge44" class="edge">
<title>mla_split&#45;&gt;mha_gpu3</title>
<path fill="none" stroke="black" d="M3462.07,-2144.07C3433.08,-2132.66 3403.96,-2121.2 3377.93,-2110.95"/>
<polygon fill="black" stroke="black" points="3379.07,-2107.63 3368.48,-2107.23 3376.5,-2114.15 3379.07,-2107.63"/>
</g>
<!-- mha_gpu4 -->
<g id="node13" class="node">
<title>mha_gpu4</title>
<polygon fill="lightblue" stroke="black" points="4120,-2107.17 3575,-2107.17 3575,-2039.17 4120,-2039.17 4120,-2107.17"/>
<text text-anchor="middle" x="3847.5" y="-2091.97" font-family="Times,serif" font-size="14.00">MHA Head Group</text>
<text text-anchor="middle" x="3847.5" y="-2076.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="3847.5" y="-2061.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=168]</text>
<text text-anchor="middle" x="3847.5" y="-2046.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=56]</text>
</g>
<!-- mla_split&#45;&gt;mha_gpu4 -->
<g id="edge45" class="edge">
<title>mla_split&#45;&gt;mha_gpu4</title>
<path fill="none" stroke="black" d="M3737.8,-2144.07C3754.61,-2133.36 3771.49,-2122.6 3786.8,-2112.85"/>
<polygon fill="black" stroke="black" points="3789.06,-2115.55 3795.61,-2107.23 3785.3,-2109.65 3789.06,-2115.55"/>
</g>
<!-- mha_gpu5 -->
<g id="node14" class="node">
<title>mha_gpu5</title>
<polygon fill="lightblue" stroke="black" points="4683,-2107.17 4138,-2107.17 4138,-2039.17 4683,-2039.17 4683,-2107.17"/>
<text text-anchor="middle" x="4410.5" y="-2091.97" font-family="Times,serif" font-size="14.00">MHA Head Group</text>
<text text-anchor="middle" x="4410.5" y="-2076.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="4410.5" y="-2061.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=168]</text>
<text text-anchor="middle" x="4410.5" y="-2046.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=56]</text>
</g>
<!-- mla_split&#45;&gt;mha_gpu5 -->
<g id="edge46" class="edge">
<title>mla_split&#45;&gt;mha_gpu5</title>
<path fill="none" stroke="black" d="M3981.39,-2149.73C4060.9,-2135.73 4142.66,-2121.33 4213.21,-2108.91"/>
<polygon fill="black" stroke="black" points="4213.85,-2112.35 4223.09,-2107.17 4212.64,-2105.45 4213.85,-2112.35"/>
</g>
<!-- mha_gpu6 -->
<g id="node15" class="node">
<title>mha_gpu6</title>
<polygon fill="lightblue" stroke="black" points="5246,-2107.17 4701,-2107.17 4701,-2039.17 5246,-2039.17 5246,-2107.17"/>
<text text-anchor="middle" x="4973.5" y="-2091.97" font-family="Times,serif" font-size="14.00">MHA Head Group</text>
<text text-anchor="middle" x="4973.5" y="-2076.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="4973.5" y="-2061.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=168]</text>
<text text-anchor="middle" x="4973.5" y="-2046.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=56]</text>
</g>
<!-- mla_split&#45;&gt;mha_gpu6 -->
<g id="edge47" class="edge">
<title>mla_split&#45;&gt;mha_gpu6</title>
<path fill="none" stroke="black" d="M4024.39,-2174.52C4221.48,-2155.64 4464.31,-2131.69 4690.88,-2107.34"/>
<polygon fill="black" stroke="black" points="4691.4,-2110.8 4700.97,-2106.25 4690.65,-2103.84 4691.4,-2110.8"/>
</g>
<!-- mha_gpu7 -->
<g id="node16" class="node">
<title>mha_gpu7</title>
<polygon fill="lightblue" stroke="black" points="5809,-2107.17 5264,-2107.17 5264,-2039.17 5809,-2039.17 5809,-2107.17"/>
<text text-anchor="middle" x="5536.5" y="-2091.97" font-family="Times,serif" font-size="14.00">MHA Head Group</text>
<text text-anchor="middle" x="5536.5" y="-2076.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="5536.5" y="-2061.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=168]</text>
<text text-anchor="middle" x="5536.5" y="-2046.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=56]</text>
</g>
<!-- mla_split&#45;&gt;mha_gpu7 -->
<g id="edge48" class="edge">
<title>mla_split&#45;&gt;mha_gpu7</title>
<path fill="none" stroke="black" d="M4052.05,-2190.39C4377.39,-2172.82 4839.72,-2144.65 5253.9,-2107.3"/>
<polygon fill="black" stroke="black" points="5254.34,-2110.77 5263.98,-2106.39 5253.71,-2103.8 5254.34,-2110.77"/>
</g>
<!-- attn_concat -->
<g id="node17" class="node">
<title>attn_concat</title>
<polygon fill="yellow" stroke="black" points="4118.18,-2002.17 3238.99,-2002.17 3012.82,-1866.17 3892.01,-1866.17 4118.18,-2002.17"/>
<text text-anchor="middle" x="3565.5" y="-1952.97" font-family="Times,serif" font-size="14.00">Attention Concat</text>
<text text-anchor="middle" x="3565.5" y="-1937.97" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
<text text-anchor="middle" x="3565.5" y="-1922.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, heads_per_gpu=16, head_dim=56]</text>
<text text-anchor="middle" x="3565.5" y="-1907.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- mha_gpu0&#45;&gt;attn_concat -->
<g id="edge49" class="edge">
<title>mha_gpu0&#45;&gt;attn_concat</title>
<path fill="none" stroke="black" d="M1868.02,-2039.94C1870.86,-2039.68 1873.69,-2039.42 1876.5,-2039.17 2309.51,-2000.44 2806.27,-1971.73 3148.4,-1954.41"/>
<polygon fill="black" stroke="black" points="3148.67,-1957.9 3158.48,-1953.9 3148.31,-1950.91 3148.67,-1957.9"/>
</g>
<!-- mha_gpu1&#45;&gt;attn_concat -->
<g id="edge50" class="edge">
<title>mha_gpu1&#45;&gt;attn_concat</title>
<path fill="none" stroke="black" d="M2431.03,-2040.06C2433.87,-2039.76 2436.69,-2039.46 2439.5,-2039.17 2682.63,-2013.67 2955.65,-1988.37 3171.95,-1969.11"/>
<polygon fill="black" stroke="black" points="3172.56,-1972.57 3182.21,-1968.19 3171.94,-1965.59 3172.56,-1972.57"/>
</g>
<!-- mha_gpu2&#45;&gt;attn_concat -->
<g id="edge51" class="edge">
<title>mha_gpu2&#45;&gt;attn_concat</title>
<path fill="none" stroke="black" d="M2925,-2039.13C3010.71,-2025.22 3113.03,-2008.61 3210.47,-1992.8"/>
<polygon fill="black" stroke="black" points="3211.18,-1996.23 3220.49,-1991.17 3210.06,-1989.32 3211.18,-1996.23"/>
</g>
<!-- mha_gpu3&#45;&gt;attn_concat -->
<g id="edge52" class="edge">
<title>mha_gpu3&#45;&gt;attn_concat</title>
<path fill="none" stroke="black" d="M3352.52,-2039C3372.67,-2029.18 3395.55,-2018.02 3418.67,-2006.75"/>
<polygon fill="black" stroke="black" points="3420.42,-2009.79 3427.88,-2002.26 3417.36,-2003.5 3420.42,-2009.79"/>
</g>
<!-- mha_gpu4&#45;&gt;attn_concat -->
<g id="edge53" class="edge">
<title>mha_gpu4&#45;&gt;attn_concat</title>
<path fill="none" stroke="black" d="M3779.24,-2039C3759.02,-2029.18 3736.05,-2018.02 3712.86,-2006.75"/>
<polygon fill="black" stroke="black" points="3714.14,-2003.49 3703.61,-2002.26 3711.08,-2009.78 3714.14,-2003.49"/>
</g>
<!-- mha_gpu5&#45;&gt;attn_concat -->
<g id="edge54" class="edge">
<title>mha_gpu5&#45;&gt;attn_concat</title>
<path fill="none" stroke="black" d="M4206.76,-2039.13C4140.74,-2028.43 4064.88,-2016.13 3988.98,-2003.83"/>
<polygon fill="black" stroke="black" points="3989.19,-2000.31 3978.76,-2002.17 3988.07,-2007.22 3989.19,-2000.31"/>
</g>
<!-- mha_gpu6&#45;&gt;attn_concat -->
<g id="edge55" class="edge">
<title>mha_gpu6&#45;&gt;attn_concat</title>
<path fill="none" stroke="black" d="M4700.97,-2040.06C4698.13,-2039.76 4695.31,-2039.46 4692.5,-2039.17 4496.56,-2018.62 4281.21,-1998.22 4091.73,-1980.99"/>
<polygon fill="black" stroke="black" points="4091.86,-1977.49 4081.58,-1980.07 4091.22,-1984.46 4091.86,-1977.49"/>
</g>
<!-- mha_gpu7&#45;&gt;attn_concat -->
<g id="edge56" class="edge">
<title>mha_gpu7&#45;&gt;attn_concat</title>
<path fill="none" stroke="black" d="M5263.98,-2039.94C5261.14,-2039.67 5258.31,-2039.42 5255.5,-2039.17 4851.61,-2003.05 4392.28,-1975.66 4054.54,-1958.08"/>
<polygon fill="black" stroke="black" points="4054.25,-1954.56 4044.08,-1957.53 4053.89,-1961.55 4054.25,-1954.56"/>
</g>
<!-- out_proj_gpu0 -->
<g id="node18" class="node">
<title>out_proj_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3781,-1829.17 3350,-1829.17 3350,-1761.17 3781,-1761.17 3781,-1829.17"/>
<text text-anchor="middle" x="3565.5" y="-1813.97" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3565.5" y="-1798.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3565.5" y="-1783.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
<text text-anchor="middle" x="3565.5" y="-1768.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- attn_concat&#45;&gt;out_proj_gpu0 -->
<g id="edge57" class="edge">
<title>attn_concat&#45;&gt;out_proj_gpu0</title>
<path fill="none" stroke="black" d="M3565.5,-1865.87C3565.5,-1856.93 3565.5,-1847.95 3565.5,-1839.56"/>
<polygon fill="black" stroke="black" points="3569,-1839.29 3565.5,-1829.29 3562,-1839.29 3569,-1839.29"/>
</g>
<!-- residual1 -->
<g id="node19" class="node">
<title>residual1</title>
<polygon fill="lightblue" stroke="black" points="3781,-1724.17 3350,-1724.17 3350,-1656.17 3781,-1656.17 3781,-1724.17"/>
<text text-anchor="middle" x="3565.5" y="-1708.97" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3565.5" y="-1693.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3565.5" y="-1678.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
<text text-anchor="middle" x="3565.5" y="-1663.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- out_proj_gpu0&#45;&gt;residual1 -->
<g id="edge58" class="edge">
<title>out_proj_gpu0&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M3565.5,-1761.01C3565.5,-1752.56 3565.5,-1743.34 3565.5,-1734.47"/>
<polygon fill="black" stroke="black" points="3569,-1734.26 3565.5,-1724.26 3562,-1734.26 3569,-1734.26"/>
</g>
<!-- moe_ln1 -->
<g id="node20" class="node">
<title>moe_ln1</title>
<polygon fill="lightblue" stroke="black" points="3781,-1619.17 3350,-1619.17 3350,-1551.17 3781,-1551.17 3781,-1619.17"/>
<text text-anchor="middle" x="3565.5" y="-1603.97" font-family="Times,serif" font-size="14.00">Pre&#45;MoE LayerNorm</text>
<text text-anchor="middle" x="3565.5" y="-1588.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3565.5" y="-1573.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
<text text-anchor="middle" x="3565.5" y="-1558.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- residual1&#45;&gt;moe_ln1 -->
<g id="edge59" class="edge">
<title>residual1&#45;&gt;moe_ln1</title>
<path fill="none" stroke="black" d="M3565.5,-1656.01C3565.5,-1647.56 3565.5,-1638.34 3565.5,-1629.47"/>
<polygon fill="black" stroke="black" points="3569,-1629.26 3565.5,-1619.26 3562,-1629.26 3569,-1629.26"/>
</g>
<!-- gate_gpu0 -->
<g id="node21" class="node">
<title>gate_gpu0</title>
<polygon fill="lightblue" stroke="black" points="3777,-1514.17 3354,-1514.17 3354,-1446.17 3777,-1446.17 3777,-1514.17"/>
<text text-anchor="middle" x="3565.5" y="-1498.97" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="3565.5" y="-1483.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3565.5" y="-1468.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
<text text-anchor="middle" x="3565.5" y="-1453.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, num_experts=16]</text>
</g>
<!-- moe_ln1&#45;&gt;gate_gpu0 -->
<g id="edge60" class="edge">
<title>moe_ln1&#45;&gt;gate_gpu0</title>
<path fill="none" stroke="black" d="M3565.5,-1551.01C3565.5,-1542.56 3565.5,-1533.34 3565.5,-1524.47"/>
<polygon fill="black" stroke="black" points="3569,-1524.26 3565.5,-1514.26 3562,-1524.26 3569,-1524.26"/>
</g>
<!-- expert_select -->
<g id="node22" class="node">
<title>expert_select</title>
<polygon fill="yellow" stroke="black" points="4023.99,-1409.17 3294.64,-1409.17 3107.01,-1273.17 3836.36,-1273.17 4023.99,-1409.17"/>
<text text-anchor="middle" x="3565.5" y="-1359.97" font-family="Times,serif" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="3565.5" y="-1344.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="3565.5" y="-1329.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="3565.5" y="-1314.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, selected_experts=2]</text>
</g>
<!-- gate_gpu0&#45;&gt;expert_select -->
<g id="edge61" class="edge">
<title>gate_gpu0&#45;&gt;expert_select</title>
<path fill="none" stroke="black" d="M3565.5,-1446C3565.5,-1437.86 3565.5,-1428.8 3565.5,-1419.52"/>
<polygon fill="black" stroke="black" points="3569,-1419.4 3565.5,-1409.4 3562,-1419.4 3569,-1419.4"/>
</g>
<!-- expert_0 -->
<g id="node23" class="node">
<title>expert_0</title>
<polygon fill="lightblue" stroke="black" points="432,-1222.17 5,-1222.17 5,-1154.17 432,-1154.17 432,-1222.17"/>
<text text-anchor="middle" x="218.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 0 MLP</text>
<text text-anchor="middle" x="218.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 100</text>
<text text-anchor="middle" x="218.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="218.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_0 -->
<g id="edge1" class="edge">
<title>expert_select&#45;&gt;expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3185.77,-1330.32C2687.8,-1316.76 1786.99,-1290 1017.5,-1255.17 764.16,-1243.7 697.7,-1248.29 441.98,-1222.29"/>
<polygon fill="black" stroke="black" points="442.32,-1218.81 432.02,-1221.27 441.61,-1225.77 442.32,-1218.81"/>
<text text-anchor="middle" x="1104.5" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 0</text>
</g>
<!-- expert_select&#45;&gt;expert_0 -->
<g id="edge62" class="edge">
<title>expert_select&#45;&gt;expert_0</title>
<path fill="none" stroke="black" d="M3189.13,-1332.78C2636.74,-1320.83 1633.08,-1294.52 1273.5,-1255.17 1236.67,-1251.14 1228.35,-1243.96 1191.5,-1240.17 862.78,-1206.37 774.94,-1249.86 442.42,-1222.28"/>
<polygon fill="black" stroke="black" points="442.26,-1218.76 432,-1221.4 441.67,-1225.73 442.26,-1218.76"/>
</g>
<!-- expert_1 -->
<g id="node24" class="node">
<title>expert_1</title>
<polygon fill="lightblue" stroke="black" points="877,-1222.17 450,-1222.17 450,-1154.17 877,-1154.17 877,-1222.17"/>
<text text-anchor="middle" x="663.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 1 MLP</text>
<text text-anchor="middle" x="663.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 101</text>
<text text-anchor="middle" x="663.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="663.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_1 -->
<g id="edge2" class="edge">
<title>expert_select&#45;&gt;expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3177.05,-1324.13C2477.49,-1295.09 1062.65,-1235.65 887.12,-1222.18"/>
<polygon fill="black" stroke="black" points="887.27,-1218.68 877.01,-1221.32 886.68,-1225.65 887.27,-1218.68"/>
<text text-anchor="middle" x="1617.5" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 1</text>
</g>
<!-- expert_select&#45;&gt;expert_1 -->
<g id="edge64" class="edge">
<title>expert_select&#45;&gt;expert_1</title>
<path fill="none" stroke="black" d="M3168.89,-1318.13C2666.77,-1290.34 1849.75,-1245.51 1708.5,-1240.17 1346.2,-1226.45 1251.75,-1252.64 887.04,-1222.26"/>
<polygon fill="black" stroke="black" points="887.26,-1218.76 877,-1221.41 886.67,-1225.74 887.26,-1218.76"/>
</g>
<!-- expert_2 -->
<g id="node25" class="node">
<title>expert_2</title>
<polygon fill="lightblue" stroke="black" points="1322,-1222.17 895,-1222.17 895,-1154.17 1322,-1154.17 1322,-1222.17"/>
<text text-anchor="middle" x="1108.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 2 MLP</text>
<text text-anchor="middle" x="1108.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 102</text>
<text text-anchor="middle" x="1108.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="1108.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_2 -->
<g id="edge3" class="edge">
<title>expert_select&#45;&gt;expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3169.41,-1318.54C2895.26,-1302.86 2522.04,-1280.09 2193.5,-1255.17 2119.19,-1249.53 2100.9,-1244.47 2026.5,-1240.17 1720.9,-1222.51 1640.49,-1248.4 1332.13,-1222.27"/>
<polygon fill="black" stroke="black" points="1332.27,-1218.76 1322,-1221.4 1331.67,-1225.74 1332.27,-1218.76"/>
<text text-anchor="middle" x="2280.5" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 2</text>
</g>
<!-- expert_select&#45;&gt;expert_2 -->
<g id="edge66" class="edge">
<title>expert_select&#45;&gt;expert_2</title>
<path fill="none" stroke="black" d="M3184.72,-1329.6C2900.92,-1318.52 2538.72,-1296.69 2395.5,-1255.17 2381.94,-1251.24 2381.16,-1243.72 2367.5,-1240.17 2258.7,-1211.85 1484.51,-1230.69 1332.24,-1222.12"/>
<polygon fill="black" stroke="black" points="1332.22,-1218.62 1322,-1221.43 1331.74,-1225.6 1332.22,-1218.62"/>
</g>
<!-- expert_3 -->
<g id="node26" class="node">
<title>expert_3</title>
<polygon fill="lightblue" stroke="black" points="1767,-1222.17 1340,-1222.17 1340,-1154.17 1767,-1154.17 1767,-1222.17"/>
<text text-anchor="middle" x="1553.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 3 MLP</text>
<text text-anchor="middle" x="1553.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 103</text>
<text text-anchor="middle" x="1553.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="1553.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_3 -->
<g id="edge4" class="edge">
<title>expert_select&#45;&gt;expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3183.11,-1328.52C2967.13,-1317.57 2692.89,-1296.34 2451.5,-1255.17 2426.1,-1250.83 2420.99,-1243.9 2395.5,-1240.17 2126.07,-1200.72 2051.9,-1245.36 1777.28,-1222.27"/>
<polygon fill="black" stroke="black" points="1777.27,-1218.76 1767.01,-1221.38 1776.67,-1225.73 1777.27,-1218.76"/>
<text text-anchor="middle" x="2538.5" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 3</text>
</g>
<!-- expert_select&#45;&gt;expert_3 -->
<g id="edge68" class="edge">
<title>expert_select&#45;&gt;expert_3</title>
<path fill="none" stroke="black" d="M3169.73,-1318.78C2969.44,-1304.85 2748.91,-1283.88 2653.5,-1255.17 2639.98,-1251.1 2639.16,-1243.75 2625.5,-1240.17 2536.71,-1216.88 1906.81,-1229.37 1777.05,-1222.1"/>
<polygon fill="black" stroke="black" points="1777.22,-1218.61 1767,-1221.41 1776.74,-1225.59 1777.22,-1218.61"/>
</g>
<!-- expert_4 -->
<g id="node27" class="node">
<title>expert_4</title>
<polygon fill="lightblue" stroke="black" points="2212,-1222.17 1785,-1222.17 1785,-1154.17 2212,-1154.17 2212,-1222.17"/>
<text text-anchor="middle" x="1998.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 4 MLP</text>
<text text-anchor="middle" x="1998.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 104</text>
<text text-anchor="middle" x="1998.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="1998.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_4 -->
<g id="edge5" class="edge">
<title>expert_select&#45;&gt;expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3166.76,-1316.49C2977.16,-1302.26 2772.56,-1281.72 2682.5,-1255.17 2668.58,-1251.06 2667.53,-1243.89 2653.5,-1240.17 2563.33,-1216.23 2331.48,-1230.31 2222.19,-1222.19"/>
<polygon fill="black" stroke="black" points="2222.27,-1218.68 2212.01,-1221.33 2221.68,-1225.66 2222.27,-1218.68"/>
<text text-anchor="middle" x="2769.5" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 4</text>
</g>
<!-- expert_select&#45;&gt;expert_4 -->
<g id="edge70" class="edge">
<title>expert_select&#45;&gt;expert_4</title>
<path fill="none" stroke="black" d="M3164.53,-1314.95C3071.19,-1302.3 2973.2,-1283.38 2884.5,-1255.17 2871.05,-1250.89 2870.14,-1243.8 2856.5,-1240.17 2790.65,-1222.65 2326.3,-1227.95 2222.16,-1222.09"/>
<polygon fill="black" stroke="black" points="2222.22,-1218.59 2212.01,-1221.39 2221.74,-1225.57 2222.22,-1218.59"/>
</g>
<!-- expert_5 -->
<g id="node28" class="node">
<title>expert_5</title>
<polygon fill="lightblue" stroke="black" points="2657,-1222.17 2230,-1222.17 2230,-1154.17 2657,-1154.17 2657,-1222.17"/>
<text text-anchor="middle" x="2443.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 5 MLP</text>
<text text-anchor="middle" x="2443.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 105</text>
<text text-anchor="middle" x="2443.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="2443.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_5 -->
<g id="edge6" class="edge">
<title>expert_select&#45;&gt;expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3166.69,-1316.54C3079.6,-1303.74 2989.11,-1284.36 2907.5,-1255.17 2895.66,-1250.93 2895.44,-1244.13 2883.5,-1240.17 2794.3,-1210.56 2764.08,-1231.8 2667.25,-1222.27"/>
<polygon fill="black" stroke="black" points="2667.34,-1218.76 2657.03,-1221.17 2666.6,-1225.72 2667.34,-1218.76"/>
<text text-anchor="middle" x="2994.5" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 5</text>
</g>
<!-- expert_select&#45;&gt;expert_5 -->
<g id="edge72" class="edge">
<title>expert_select&#45;&gt;expert_5</title>
<path fill="none" stroke="black" d="M3166,-1273.15C3146.75,-1267.59 3127.83,-1261.61 3109.5,-1255.17 3096.18,-1250.48 3095.12,-1243.9 3081.5,-1240.17 2995.14,-1216.49 2772.58,-1230.04 2667.14,-1222.18"/>
<polygon fill="black" stroke="black" points="2667.27,-1218.68 2657.01,-1221.33 2666.68,-1225.66 2667.27,-1218.68"/>
</g>
<!-- expert_6 -->
<g id="node29" class="node">
<title>expert_6</title>
<polygon fill="lightblue" stroke="black" points="3102,-1222.17 2675,-1222.17 2675,-1154.17 3102,-1154.17 3102,-1222.17"/>
<text text-anchor="middle" x="2888.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 6 MLP</text>
<text text-anchor="middle" x="2888.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 106</text>
<text text-anchor="middle" x="2888.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="2888.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_6 -->
<g id="edge7" class="edge">
<title>expert_select&#45;&gt;expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3178.58,-1273.11C3161.83,-1267.58 3145.4,-1261.61 3129.5,-1255.17 3118.19,-1250.58 3117.72,-1244.96 3106.5,-1240.17 3093.65,-1234.67 3080.11,-1229.72 3066.33,-1225.26"/>
<polygon fill="black" stroke="black" points="3067.34,-1221.91 3056.75,-1222.25 3065.24,-1228.59 3067.34,-1221.91"/>
<text text-anchor="middle" x="3216.5" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 6</text>
</g>
<!-- expert_select&#45;&gt;expert_6 -->
<g id="edge74" class="edge">
<title>expert_select&#45;&gt;expert_6</title>
<path fill="none" stroke="black" d="M3392.35,-1273.09C3347.06,-1255.74 3309.16,-1241.48 3303.5,-1240.17 3222.71,-1221.35 3197.86,-1231.67 3112.21,-1222.3"/>
<polygon fill="black" stroke="black" points="3112.37,-1218.8 3102.03,-1221.13 3111.57,-1225.75 3112.37,-1218.8"/>
</g>
<!-- expert_7 -->
<g id="node30" class="node">
<title>expert_7</title>
<polygon fill="lightblue" stroke="black" points="3547,-1222.17 3120,-1222.17 3120,-1154.17 3547,-1154.17 3547,-1222.17"/>
<text text-anchor="middle" x="3333.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 7 MLP</text>
<text text-anchor="middle" x="3333.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 107</text>
<text text-anchor="middle" x="3333.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="3333.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_7 -->
<g id="edge8" class="edge">
<title>expert_select&#45;&gt;expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3379.7,-1272.86C3372.52,-1267.4 3365.74,-1261.51 3359.5,-1255.17 3353.1,-1248.66 3348.22,-1240.39 3344.53,-1231.92"/>
<polygon fill="black" stroke="black" points="3347.71,-1230.43 3340.84,-1222.36 3341.18,-1232.95 3347.71,-1230.43"/>
<text text-anchor="middle" x="3446.5" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 7</text>
</g>
<!-- expert_select&#45;&gt;expert_7 -->
<g id="edge76" class="edge">
<title>expert_select&#45;&gt;expert_7</title>
<path fill="none" stroke="black" d="M3554.38,-1273.13C3549.67,-1260.85 3542.99,-1249.1 3533.5,-1240.17 3528.79,-1235.73 3523.75,-1231.67 3518.46,-1227.95"/>
<polygon fill="black" stroke="black" points="3520.21,-1224.92 3509.93,-1222.38 3516.39,-1230.78 3520.21,-1224.92"/>
</g>
<!-- expert_8 -->
<g id="node31" class="node">
<title>expert_8</title>
<polygon fill="lightblue" stroke="black" points="3992,-1222.17 3565,-1222.17 3565,-1154.17 3992,-1154.17 3992,-1222.17"/>
<text text-anchor="middle" x="3778.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 8 MLP</text>
<text text-anchor="middle" x="3778.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 108</text>
<text text-anchor="middle" x="3778.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="3778.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_8 -->
<g id="edge9" class="edge">
<title>expert_select&#45;&gt;expert_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3569.77,-1273.01C3573.28,-1260.87 3578.84,-1249.22 3587.5,-1240.17 3591.68,-1235.8 3596.19,-1231.79 3600.96,-1228.11"/>
<polygon fill="black" stroke="black" points="3603.11,-1230.87 3609.23,-1222.23 3599.05,-1225.17 3603.11,-1230.87"/>
<text text-anchor="middle" x="3674.5" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 8</text>
</g>
<!-- expert_select&#45;&gt;expert_8 -->
<g id="edge78" class="edge">
<title>expert_select&#45;&gt;expert_8</title>
<path fill="none" stroke="black" d="M3743.7,-1272.86C3750.1,-1267.4 3756.08,-1261.51 3761.5,-1255.17 3767.08,-1248.63 3770.86,-1240.5 3773.42,-1232.2"/>
<polygon fill="black" stroke="black" points="3776.82,-1233.01 3775.89,-1222.46 3770.03,-1231.29 3776.82,-1233.01"/>
</g>
<!-- expert_9 -->
<g id="node32" class="node">
<title>expert_9</title>
<polygon fill="lightblue" stroke="black" points="4437,-1222.17 4010,-1222.17 4010,-1154.17 4437,-1154.17 4437,-1222.17"/>
<text text-anchor="middle" x="4223.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 9 MLP</text>
<text text-anchor="middle" x="4223.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 109</text>
<text text-anchor="middle" x="4223.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="4223.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_9 -->
<g id="edge10" class="edge">
<title>expert_select&#45;&gt;expert_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3836.52,-1273.22C3883.78,-1261.92 3932.53,-1250.51 3978.5,-1240.17 4001.97,-1234.88 4026.75,-1229.5 4051.17,-1224.31"/>
<polygon fill="black" stroke="black" points="4052.19,-1227.67 4061.24,-1222.17 4050.73,-1220.82 4052.19,-1227.67"/>
<text text-anchor="middle" x="4065.5" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 9</text>
</g>
<!-- expert_select&#45;&gt;expert_9 -->
<g id="edge80" class="edge">
<title>expert_select&#45;&gt;expert_9</title>
<path fill="none" stroke="black" d="M3887.93,-1310.5C3997.25,-1296.82 4103.97,-1278.39 4152.5,-1255.17 4165.57,-1248.91 4177.88,-1239.4 4188.46,-1229.53"/>
<polygon fill="black" stroke="black" points="4191.14,-1231.8 4195.85,-1222.31 4186.25,-1226.8 4191.14,-1231.8"/>
</g>
<!-- expert_10 -->
<g id="node33" class="node">
<title>expert_10</title>
<polygon fill="lightblue" stroke="black" points="4882,-1222.17 4455,-1222.17 4455,-1154.17 4882,-1154.17 4882,-1222.17"/>
<text text-anchor="middle" x="4668.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 10 MLP</text>
<text text-anchor="middle" x="4668.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 110</text>
<text text-anchor="middle" x="4668.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="4668.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_10 -->
<g id="edge11" class="edge">
<title>expert_select&#45;&gt;expert_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3873.48,-1300.02C4039.88,-1278.06 4249.19,-1249.99 4445.04,-1222.37"/>
<polygon fill="black" stroke="black" points="4445.53,-1225.83 4454.95,-1220.97 4444.56,-1218.9 4445.53,-1225.83"/>
<text text-anchor="middle" x="4393" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 10</text>
</g>
<!-- expert_select&#45;&gt;expert_10 -->
<g id="edge82" class="edge">
<title>expert_select&#45;&gt;expert_10</title>
<path fill="none" stroke="black" d="M3913.99,-1329.43C4088.22,-1318.68 4301.3,-1297.35 4488.5,-1255.17 4519.85,-1248.1 4553.16,-1236.98 4582.48,-1225.86"/>
<polygon fill="black" stroke="black" points="4583.78,-1229.11 4591.86,-1222.26 4581.27,-1222.58 4583.78,-1229.11"/>
</g>
<!-- expert_11 -->
<g id="node34" class="node">
<title>expert_11</title>
<polygon fill="lightblue" stroke="black" points="5327,-1222.17 4900,-1222.17 4900,-1154.17 5327,-1154.17 5327,-1222.17"/>
<text text-anchor="middle" x="5113.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 11 MLP</text>
<text text-anchor="middle" x="5113.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 111</text>
<text text-anchor="middle" x="5113.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="5113.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_11 -->
<g id="edge12" class="edge">
<title>expert_select&#45;&gt;expert_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3896.1,-1316.33C4162.09,-1295.82 4545.58,-1263.26 4889.8,-1222.35"/>
<polygon fill="black" stroke="black" points="4890.45,-1225.8 4899.97,-1221.14 4889.63,-1218.85 4890.45,-1225.8"/>
<text text-anchor="middle" x="4803" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 11</text>
</g>
<!-- expert_select&#45;&gt;expert_11 -->
<g id="edge84" class="edge">
<title>expert_select&#45;&gt;expert_11</title>
<path fill="none" stroke="black" d="M3911.44,-1327.29C4242.04,-1313.33 4716.22,-1288.48 4898.5,-1255.17 4936.42,-1248.24 4977.06,-1236.84 5012.69,-1225.45"/>
<polygon fill="black" stroke="black" points="5014.17,-1228.65 5022.6,-1222.24 5012.01,-1221.99 5014.17,-1228.65"/>
</g>
<!-- expert_12 -->
<g id="node35" class="node">
<title>expert_12</title>
<polygon fill="lightblue" stroke="black" points="5772,-1222.17 5345,-1222.17 5345,-1154.17 5772,-1154.17 5772,-1222.17"/>
<text text-anchor="middle" x="5558.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 12 MLP</text>
<text text-anchor="middle" x="5558.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 112</text>
<text text-anchor="middle" x="5558.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="5558.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_12 -->
<g id="edge13" class="edge">
<title>expert_select&#45;&gt;expert_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3903.06,-1321.4C4181.91,-1305.4 4588.05,-1280.95 4942.5,-1255.17 5114.51,-1242.66 5160.26,-1242.43 5334.93,-1222.33"/>
<polygon fill="black" stroke="black" points="5335.44,-1225.79 5344.97,-1221.17 5334.64,-1218.84 5335.44,-1225.79"/>
<text text-anchor="middle" x="5244" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 12</text>
</g>
<!-- expert_select&#45;&gt;expert_12 -->
<g id="edge86" class="edge">
<title>expert_select&#45;&gt;expert_12</title>
<path fill="none" stroke="black" d="M3919.7,-1333.44C4357.35,-1323.34 5076.36,-1300.42 5339.5,-1255.17 5378.66,-1248.43 5420.66,-1236.88 5457.31,-1225.3"/>
<polygon fill="black" stroke="black" points="5458.54,-1228.59 5466.99,-1222.2 5456.4,-1221.92 5458.54,-1228.59"/>
</g>
<!-- expert_13 -->
<g id="node36" class="node">
<title>expert_13</title>
<polygon fill="lightblue" stroke="black" points="6217,-1222.17 5790,-1222.17 5790,-1154.17 6217,-1154.17 6217,-1222.17"/>
<text text-anchor="middle" x="6003.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 13 MLP</text>
<text text-anchor="middle" x="6003.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 113</text>
<text text-anchor="middle" x="6003.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="6003.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_13 -->
<g id="edge14" class="edge">
<title>expert_select&#45;&gt;expert_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3911.69,-1327.69C4277.62,-1313.63 4871.52,-1288.35 5383.5,-1255.17 5557.34,-1243.9 5603.48,-1242.6 5779.83,-1222.34"/>
<polygon fill="black" stroke="black" points="5780.44,-1225.79 5789.97,-1221.17 5779.64,-1218.84 5780.44,-1225.79"/>
<text text-anchor="middle" x="5694" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 13</text>
</g>
<!-- expert_select&#45;&gt;expert_13 -->
<g id="edge88" class="edge">
<title>expert_select&#45;&gt;expert_13</title>
<path fill="none" stroke="black" d="M3925.64,-1337.79C4461.33,-1332.32 5442.22,-1314.31 5789.5,-1255.17 5827.86,-1248.63 5868.94,-1237.12 5904.74,-1225.52"/>
<polygon fill="black" stroke="black" points="5906.29,-1228.7 5914.7,-1222.25 5904.1,-1222.05 5906.29,-1228.7"/>
</g>
<!-- expert_14 -->
<g id="node37" class="node">
<title>expert_14</title>
<polygon fill="lightblue" stroke="black" points="6662,-1222.17 6235,-1222.17 6235,-1154.17 6662,-1154.17 6662,-1222.17"/>
<text text-anchor="middle" x="6448.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 14 MLP</text>
<text text-anchor="middle" x="6448.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 114</text>
<text text-anchor="middle" x="6448.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="6448.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_14 -->
<g id="edge15" class="edge">
<title>expert_select&#45;&gt;expert_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3917.68,-1332.08C4364.16,-1320.66 5157.45,-1296.45 5835.5,-1255.17 6006.34,-1244.76 6051.61,-1242.42 6225,-1222.32"/>
<polygon fill="black" stroke="black" points="6225.44,-1225.79 6234.97,-1221.16 6224.63,-1218.84 6225.44,-1225.79"/>
<text text-anchor="middle" x="6142" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 14</text>
</g>
<!-- expert_select&#45;&gt;expert_14 -->
<g id="edge90" class="edge">
<title>expert_select&#45;&gt;expert_14</title>
<path fill="none" stroke="black" d="M3929.9,-1340.77C4554.74,-1339.77 5805.04,-1328.28 6237.5,-1255.17 6275.55,-1248.73 6316.26,-1237.17 6351.67,-1225.5"/>
<polygon fill="black" stroke="black" points="6353.14,-1228.7 6361.51,-1222.21 6350.92,-1222.07 6353.14,-1228.7"/>
</g>
<!-- expert_15 -->
<g id="node38" class="node">
<title>expert_15</title>
<polygon fill="lightblue" stroke="black" points="7107,-1222.17 6680,-1222.17 6680,-1154.17 7107,-1154.17 7107,-1222.17"/>
<text text-anchor="middle" x="6893.5" y="-1206.97" font-family="Times,serif" font-size="14.00">Expert 15 MLP</text>
<text text-anchor="middle" x="6893.5" y="-1191.97" font-family="Times,serif" font-size="14.00">GPU: 115</text>
<text text-anchor="middle" x="6893.5" y="-1176.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="6893.5" y="-1161.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert_select&#45;&gt;expert_15 -->
<g id="edge16" class="edge">
<title>expert_select&#45;&gt;expert_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3921.94,-1335.1C4441.6,-1326.34 5437.5,-1304.34 6283.5,-1255.17 6452.99,-1245.32 6497.9,-1242.35 6669.81,-1222.35"/>
<polygon fill="black" stroke="black" points="6670.44,-1225.8 6679.97,-1221.16 6669.63,-1218.84 6670.44,-1225.8"/>
<text text-anchor="middle" x="6588" y="-1243.97" font-family="Times,serif" font-size="14.00">route tokens to expert 15</text>
</g>
<!-- expert_select&#45;&gt;expert_15 -->
<g id="edge92" class="edge">
<title>expert_select&#45;&gt;expert_15</title>
<path fill="none" stroke="black" d="M3923.39,-1335.99C4684.9,-1326.28 6418.08,-1299.6 6683.5,-1255.17 6721.48,-1248.81 6762.11,-1237.23 6797.4,-1225.52"/>
<polygon fill="black" stroke="black" points="6798.85,-1228.73 6807.21,-1222.22 6796.61,-1222.09 6798.85,-1228.73"/>
</g>
<!-- expert_agg -->
<g id="node39" class="node">
<title>expert_agg</title>
<polygon fill="yellow" stroke="black" points="4003.25,-1117.17 3290.98,-1117.17 3107.75,-981.17 3820.02,-981.17 4003.25,-1117.17"/>
<text text-anchor="middle" x="3555.5" y="-1067.97" font-family="Times,serif" font-size="14.00">Expert Output Aggregation</text>
<text text-anchor="middle" x="3555.5" y="-1052.97" font-family="Times,serif" font-size="14.00">GPU: 116</text>
<text text-anchor="middle" x="3555.5" y="-1037.97" font-family="Times,serif" font-size="14.00">Input: [tokens_from_experts=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="3555.5" y="-1022.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- expert_0&#45;&gt;expert_agg -->
<g id="edge63" class="edge">
<title>expert_0&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M432.01,-1154.97C434.85,-1154.69 437.69,-1154.42 440.5,-1154.17 966.03,-1106.49 2498.94,-1071.09 3199.16,-1056.94"/>
<polygon fill="black" stroke="black" points="3199.48,-1060.43 3209.4,-1056.73 3199.33,-1053.43 3199.48,-1060.43"/>
</g>
<!-- expert_1&#45;&gt;expert_agg -->
<g id="edge65" class="edge">
<title>expert_1&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M877.01,-1154.99C879.86,-1154.7 882.69,-1154.43 885.5,-1154.17 1707.96,-1077.25 2678.08,-1057.02 3192.5,-1051.83"/>
<polygon fill="black" stroke="black" points="3192.72,-1055.33 3202.68,-1051.73 3192.65,-1048.33 3192.72,-1055.33"/>
</g>
<!-- expert_2&#45;&gt;expert_agg -->
<g id="edge67" class="edge">
<title>expert_2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1322.01,-1154.95C1324.85,-1154.68 1327.69,-1154.41 1330.5,-1154.17 1609.53,-1129.53 1680.62,-1147.71 1960.5,-1136.17 2394.43,-1118.27 2894.38,-1090.09 3217.16,-1070.9"/>
<polygon fill="black" stroke="black" points="3217.84,-1074.36 3227.61,-1070.28 3217.42,-1067.38 3217.84,-1074.36"/>
</g>
<!-- expert_3&#45;&gt;expert_agg -->
<g id="edge69" class="edge">
<title>expert_3&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M1767,-1154.91C1769.85,-1154.65 1772.68,-1154.4 1775.5,-1154.17 2194.12,-1119.21 2301.2,-1161.71 2720.5,-1136.17 2892.91,-1125.66 3084.65,-1106.45 3240.88,-1088.85"/>
<polygon fill="black" stroke="black" points="3241.57,-1092.29 3251.12,-1087.69 3240.79,-1085.34 3241.57,-1092.29"/>
</g>
<!-- expert_4&#45;&gt;expert_agg -->
<g id="edge71" class="edge">
<title>expert_4&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2212,-1154.91C2214.85,-1154.65 2217.68,-1154.4 2220.5,-1154.17 2615.63,-1120.95 2718.2,-1178.1 3112.5,-1136.17 3164.48,-1130.64 3219.46,-1122.15 3272.34,-1112.62"/>
<polygon fill="black" stroke="black" points="3272.98,-1116.06 3282.19,-1110.83 3271.72,-1109.17 3272.98,-1116.06"/>
</g>
<!-- expert_5&#45;&gt;expert_agg -->
<g id="edge73" class="edge">
<title>expert_5&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M2657,-1154.94C2659.85,-1154.67 2662.69,-1154.41 2665.5,-1154.17 2810.77,-1141.42 3178.29,-1163.68 3321.5,-1136.17 3342.14,-1132.2 3363.37,-1126.64 3384.23,-1120.24"/>
<polygon fill="black" stroke="black" points="3385.28,-1123.58 3393.78,-1117.25 3383.19,-1116.9 3385.28,-1123.58"/>
</g>
<!-- expert_6&#45;&gt;expert_agg -->
<g id="edge75" class="edge">
<title>expert_6&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3102.02,-1155.05C3104.86,-1154.75 3107.69,-1154.45 3110.5,-1154.17 3183.13,-1146.79 3369.79,-1160.81 3438.5,-1136.17 3448.49,-1132.58 3458.36,-1127.85 3467.88,-1122.45"/>
<polygon fill="black" stroke="black" points="3469.71,-1125.43 3476.52,-1117.31 3466.13,-1119.41 3469.71,-1125.43"/>
</g>
<!-- expert_7&#45;&gt;expert_agg -->
<g id="edge77" class="edge">
<title>expert_7&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3482.05,-1153.99C3491.82,-1148.87 3501.1,-1142.97 3509.5,-1136.17 3513.51,-1132.92 3517.21,-1129.23 3520.63,-1125.24"/>
<polygon fill="black" stroke="black" points="3523.47,-1127.29 3526.86,-1117.25 3517.95,-1122.99 3523.47,-1127.29"/>
</g>
<!-- expert_8&#45;&gt;expert_agg -->
<g id="edge79" class="edge">
<title>expert_8&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M3724.52,-1154C3709.01,-1144.48 3691.46,-1133.69 3673.68,-1122.77"/>
<polygon fill="black" stroke="black" points="3675.29,-1119.65 3664.94,-1117.4 3671.63,-1125.62 3675.29,-1119.65"/>
</g>
<!-- expert_9&#45;&gt;expert_agg -->
<g id="edge81" class="edge">
<title>expert_9&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4062.22,-1154.09C4010.65,-1143.51 3951.51,-1131.38 3892.25,-1119.23"/>
<polygon fill="black" stroke="black" points="3892.85,-1115.78 3882.35,-1117.2 3891.44,-1122.64 3892.85,-1115.78"/>
</g>
<!-- expert_10&#45;&gt;expert_agg -->
<g id="edge83" class="edge">
<title>expert_10&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4454.96,-1155.3C4452.12,-1154.91 4449.3,-1154.54 4446.5,-1154.17 4296.43,-1134.26 4131.87,-1114.48 3985.45,-1097.59"/>
<polygon fill="black" stroke="black" points="3985.72,-1094.1 3975.39,-1096.43 3984.92,-1101.05 3985.72,-1094.1"/>
</g>
<!-- expert_11&#45;&gt;expert_agg -->
<g id="edge85" class="edge">
<title>expert_11&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M4899.98,-1155.14C4897.13,-1154.81 4894.31,-1154.48 4891.5,-1154.17 4577.39,-1118.64 4220.34,-1091.53 3954.43,-1073.9"/>
<polygon fill="black" stroke="black" points="3954.43,-1070.4 3944.22,-1073.23 3953.97,-1077.38 3954.43,-1070.4"/>
</g>
<!-- expert_12&#45;&gt;expert_agg -->
<g id="edge87" class="edge">
<title>expert_12&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M5344.98,-1155.07C5342.14,-1154.76 5339.31,-1154.46 5336.5,-1154.17 4856.34,-1104.56 4300.71,-1076.81 3939.48,-1062.69"/>
<polygon fill="black" stroke="black" points="3939.51,-1059.18 3929.38,-1062.29 3939.24,-1066.18 3939.51,-1059.18"/>
</g>
<!-- expert_13&#45;&gt;expert_agg -->
<g id="edge89" class="edge">
<title>expert_13&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M5789.99,-1155.02C5787.14,-1154.73 5784.31,-1154.44 5781.5,-1154.17 5133.05,-1090.99 4374.47,-1065.92 3931.26,-1056.17"/>
<polygon fill="black" stroke="black" points="3931.25,-1052.67 3921.17,-1055.95 3931.09,-1059.67 3931.25,-1052.67"/>
</g>
<!-- expert_14&#45;&gt;expert_agg -->
<g id="edge91" class="edge">
<title>expert_14&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M6234.99,-1154.99C6232.14,-1154.7 6229.31,-1154.43 6226.5,-1154.17 5407.46,-1077.58 4442.05,-1057.19 3925.66,-1051.89"/>
<polygon fill="black" stroke="black" points="3925.47,-1048.39 3915.44,-1051.79 3925.4,-1055.39 3925.47,-1048.39"/>
</g>
<!-- expert_15&#45;&gt;expert_agg -->
<g id="edge93" class="edge">
<title>expert_15&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M6679.99,-1154.97C6677.15,-1154.69 6674.31,-1154.42 6671.5,-1154.17 6150.93,-1106.94 4642.25,-1071.78 3932.71,-1057.36"/>
<polygon fill="black" stroke="black" points="3932.65,-1053.86 3922.59,-1057.15 3932.51,-1060.85 3932.65,-1053.86"/>
</g>
<!-- moe2_ln1 -->
<g id="node40" class="node">
<title>moe2_ln1</title>
<polygon fill="lightblue" stroke="black" points="3771,-944.17 3340,-944.17 3340,-876.17 3771,-876.17 3771,-944.17"/>
<text text-anchor="middle" x="3555.5" y="-928.97" font-family="Times,serif" font-size="14.00">Pre&#45;MoE2 LayerNorm</text>
<text text-anchor="middle" x="3555.5" y="-913.97" font-family="Times,serif" font-size="14.00">GPU: 116</text>
<text text-anchor="middle" x="3555.5" y="-898.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
<text text-anchor="middle" x="3555.5" y="-883.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- expert_agg&#45;&gt;moe2_ln1 -->
<g id="edge94" class="edge">
<title>expert_agg&#45;&gt;moe2_ln1</title>
<path fill="none" stroke="black" d="M3555.5,-980.87C3555.5,-971.93 3555.5,-962.95 3555.5,-954.56"/>
<polygon fill="black" stroke="black" points="3559,-954.29 3555.5,-944.29 3552,-954.29 3559,-954.29"/>
</g>
<!-- gate2_gpu116 -->
<g id="node41" class="node">
<title>gate2_gpu116</title>
<polygon fill="lightblue" stroke="black" points="3767,-839.17 3344,-839.17 3344,-771.17 3767,-771.17 3767,-839.17"/>
<text text-anchor="middle" x="3555.5" y="-823.97" font-family="Times,serif" font-size="14.00">Expert Gate 2</text>
<text text-anchor="middle" x="3555.5" y="-808.97" font-family="Times,serif" font-size="14.00">GPU: 116</text>
<text text-anchor="middle" x="3555.5" y="-793.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
<text text-anchor="middle" x="3555.5" y="-778.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, num_experts=16]</text>
</g>
<!-- moe2_ln1&#45;&gt;gate2_gpu116 -->
<g id="edge95" class="edge">
<title>moe2_ln1&#45;&gt;gate2_gpu116</title>
<path fill="none" stroke="black" d="M3555.5,-876.01C3555.5,-867.56 3555.5,-858.34 3555.5,-849.47"/>
<polygon fill="black" stroke="black" points="3559,-849.26 3555.5,-839.26 3552,-849.26 3559,-849.26"/>
</g>
<!-- expert2_select -->
<g id="node42" class="node">
<title>expert2_select</title>
<polygon fill="yellow" stroke="black" points="4013.99,-734.17 3284.64,-734.17 3097.01,-598.17 3826.36,-598.17 4013.99,-734.17"/>
<text text-anchor="middle" x="3555.5" y="-684.97" font-family="Times,serif" font-size="14.00">Expert Selection 2</text>
<text text-anchor="middle" x="3555.5" y="-669.97" font-family="Times,serif" font-size="14.00">GPU: 116</text>
<text text-anchor="middle" x="3555.5" y="-654.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="3555.5" y="-639.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, selected_experts=2]</text>
</g>
<!-- gate2_gpu116&#45;&gt;expert2_select -->
<g id="edge96" class="edge">
<title>gate2_gpu116&#45;&gt;expert2_select</title>
<path fill="none" stroke="black" d="M3555.5,-771C3555.5,-762.86 3555.5,-753.8 3555.5,-744.52"/>
<polygon fill="black" stroke="black" points="3559,-744.4 3555.5,-734.4 3552,-744.4 3559,-744.4"/>
</g>
<!-- expert2_0 -->
<g id="node43" class="node">
<title>expert2_0</title>
<polygon fill="lightblue" stroke="black" points="427,-547.17 0,-547.17 0,-479.17 427,-479.17 427,-547.17"/>
<text text-anchor="middle" x="213.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 0 MLP 2</text>
<text text-anchor="middle" x="213.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 200</text>
<text text-anchor="middle" x="213.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="213.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_0 -->
<g id="edge17" class="edge">
<title>expert2_select&#45;&gt;expert2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3176.77,-656.08C2673.24,-643.22 1755.7,-617.11 972.5,-580.17 736.91,-569.05 675,-572.02 437.02,-547.3"/>
<polygon fill="black" stroke="black" points="437.33,-543.81 427.02,-546.25 436.6,-550.77 437.33,-543.81"/>
<text text-anchor="middle" x="1064" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 0</text>
</g>
<!-- expert2_select&#45;&gt;expert2_0 -->
<g id="edge97" class="edge">
<title>expert2_select&#45;&gt;expert2_0</title>
<path fill="none" stroke="black" d="M3185.3,-662.33C2732.31,-656.34 1942.28,-637.75 1267.5,-580.17 1217.46,-575.9 1205.57,-569.13 1155.5,-565.17 839.67,-540.14 756.12,-574.04 437,-547.25"/>
<polygon fill="black" stroke="black" points="437.27,-543.76 427,-546.4 436.67,-550.74 437.27,-543.76"/>
</g>
<!-- expert2_1 -->
<g id="node44" class="node">
<title>expert2_1</title>
<polygon fill="lightblue" stroke="black" points="872,-547.17 445,-547.17 445,-479.17 872,-479.17 872,-547.17"/>
<text text-anchor="middle" x="658.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 1 MLP 2</text>
<text text-anchor="middle" x="658.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 201</text>
<text text-anchor="middle" x="658.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="658.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_1 -->
<g id="edge18" class="edge">
<title>expert2_select&#45;&gt;expert2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3167.08,-649.09C2468.58,-620.04 1057.24,-560.63 882.1,-547.18"/>
<polygon fill="black" stroke="black" points="882.27,-543.68 872.01,-546.32 881.68,-550.65 882.27,-543.68"/>
<text text-anchor="middle" x="1616" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 1</text>
</g>
<!-- expert2_select&#45;&gt;expert2_1 -->
<g id="edge99" class="edge">
<title>expert2_select&#45;&gt;expert2_1</title>
<path fill="none" stroke="black" d="M3160.21,-644.23C2840.6,-627.23 2379.04,-602.49 1975.5,-580.17 1858.16,-573.68 1828.93,-569.77 1711.5,-565.17 1345.7,-550.82 1250.31,-577.89 882.14,-547.26"/>
<polygon fill="black" stroke="black" points="882.26,-543.76 872,-546.41 881.67,-550.74 882.26,-543.76"/>
</g>
<!-- expert2_2 -->
<g id="node45" class="node">
<title>expert2_2</title>
<polygon fill="lightblue" stroke="black" points="1317,-547.17 890,-547.17 890,-479.17 1317,-479.17 1317,-547.17"/>
<text text-anchor="middle" x="1103.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 2 MLP 2</text>
<text text-anchor="middle" x="1103.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 202</text>
<text text-anchor="middle" x="1103.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="1103.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_2 -->
<g id="edge19" class="edge">
<title>expert2_select&#45;&gt;expert2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3161.49,-645.07C2876.59,-629.68 2482.55,-606.64 2136.5,-580.17 2064.84,-574.68 2047.23,-569.5 1975.5,-565.17 1690.41,-547.96 1615.15,-571.88 1327.33,-547.28"/>
<polygon fill="black" stroke="black" points="1327.27,-543.77 1317,-546.39 1326.67,-550.74 1327.27,-543.77"/>
<text text-anchor="middle" x="2228" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 2</text>
</g>
<!-- expert2_select&#45;&gt;expert2_2 -->
<g id="edge101" class="edge">
<title>expert2_select&#45;&gt;expert2_2</title>
<path fill="none" stroke="black" d="M3176.19,-655.75C2881.23,-645.2 2497.73,-623.53 2347.5,-580.17 2333.94,-576.25 2333.16,-568.73 2319.5,-565.17 2215.32,-538.01 1474.61,-555.37 1327.29,-547.12"/>
<polygon fill="black" stroke="black" points="1327.22,-543.61 1317,-546.43 1326.74,-550.6 1327.22,-543.61"/>
</g>
<!-- expert2_3 -->
<g id="node46" class="node">
<title>expert2_3</title>
<polygon fill="lightblue" stroke="black" points="1762,-547.17 1335,-547.17 1335,-479.17 1762,-479.17 1762,-547.17"/>
<text text-anchor="middle" x="1548.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 3 MLP 2</text>
<text text-anchor="middle" x="1548.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 203</text>
<text text-anchor="middle" x="1548.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="1548.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_3 -->
<g id="edge20" class="edge">
<title>expert2_select&#45;&gt;expert2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3176.14,-655.58C2950.16,-645.32 2658.44,-624.08 2402.5,-580.17 2377.53,-575.88 2372.56,-568.92 2347.5,-565.17 2097.11,-527.65 2027.86,-568.95 1772.35,-547.28"/>
<polygon fill="black" stroke="black" points="1772.27,-543.76 1762.01,-546.37 1771.66,-550.73 1772.27,-543.76"/>
<text text-anchor="middle" x="2494" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 3</text>
</g>
<!-- expert2_select&#45;&gt;expert2_3 -->
<g id="edge103" class="edge">
<title>expert2_select&#45;&gt;expert2_3</title>
<path fill="none" stroke="black" d="M3162.16,-645.41C2951.29,-631.7 2714.52,-610.41 2613.5,-580.17 2599.98,-576.12 2599.15,-568.75 2585.5,-565.17 2500.46,-542.82 1897.61,-554.13 1772.04,-547.1"/>
<polygon fill="black" stroke="black" points="1772.22,-543.6 1762,-546.41 1771.74,-550.59 1772.22,-543.6"/>
</g>
<!-- expert2_4 -->
<g id="node47" class="node">
<title>expert2_4</title>
<polygon fill="lightblue" stroke="black" points="2207,-547.17 1780,-547.17 1780,-479.17 2207,-479.17 2207,-547.17"/>
<text text-anchor="middle" x="1993.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 4 MLP 2</text>
<text text-anchor="middle" x="1993.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 204</text>
<text text-anchor="middle" x="1993.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="1993.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_4 -->
<g id="edge21" class="edge">
<title>expert2_select&#45;&gt;expert2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3159.16,-643.24C2958.77,-629.15 2738.17,-608.2 2642.5,-580.17 2628.57,-576.09 2627.52,-568.91 2613.5,-565.17 2530.81,-543.06 2318.37,-554.84 2217.05,-547.18"/>
<polygon fill="black" stroke="black" points="2217.27,-543.69 2207.01,-546.32 2216.68,-550.66 2217.27,-543.69"/>
<text text-anchor="middle" x="2734" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 4</text>
</g>
<!-- expert2_select&#45;&gt;expert2_4 -->
<g id="edge105" class="edge">
<title>expert2_select&#45;&gt;expert2_4</title>
<path fill="none" stroke="black" d="M3158.76,-643.08C3057.63,-630.43 2950.22,-610.74 2853.5,-580.17 2840.04,-575.91 2839.14,-568.8 2825.5,-565.17 2697.41,-531 2365.92,-557.89 2216.98,-547.18"/>
<polygon fill="black" stroke="black" points="2217.25,-543.69 2207.01,-546.38 2216.69,-550.67 2217.25,-543.69"/>
</g>
<!-- expert2_5 -->
<g id="node48" class="node">
<title>expert2_5</title>
<polygon fill="lightblue" stroke="black" points="2652,-547.17 2225,-547.17 2225,-479.17 2652,-479.17 2652,-547.17"/>
<text text-anchor="middle" x="2438.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 5 MLP 2</text>
<text text-anchor="middle" x="2438.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 205</text>
<text text-anchor="middle" x="2438.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="2438.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_5 -->
<g id="edge22" class="edge">
<title>expert2_select&#45;&gt;expert2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3137.54,-627.56C3028.28,-614.45 2926.79,-598.39 2875.5,-580.17 2863.65,-575.95 2863.42,-569.2 2851.5,-565.17 2773.73,-538.85 2747.12,-556.05 2662.13,-547.26"/>
<polygon fill="black" stroke="black" points="2662.36,-543.76 2652.03,-546.12 2661.58,-550.72 2662.36,-543.76"/>
<text text-anchor="middle" x="2967" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 5</text>
</g>
<!-- expert2_select&#45;&gt;expert2_5 -->
<g id="edge107" class="edge">
<title>expert2_select&#45;&gt;expert2_5</title>
<path fill="none" stroke="black" d="M3143.37,-598.12C3124.01,-592.58 3104.96,-586.6 3086.5,-580.17 3073.17,-575.52 3072.11,-568.91 3058.5,-565.17 2975.97,-542.46 2763.38,-554.8 2662.05,-547.18"/>
<polygon fill="black" stroke="black" points="2662.27,-543.68 2652.01,-546.32 2661.68,-550.66 2662.27,-543.68"/>
</g>
<!-- expert2_6 -->
<g id="node49" class="node">
<title>expert2_6</title>
<polygon fill="lightblue" stroke="black" points="3097,-547.17 2670,-547.17 2670,-479.17 3097,-479.17 3097,-547.17"/>
<text text-anchor="middle" x="2883.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 6 MLP 2</text>
<text text-anchor="middle" x="2883.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 206</text>
<text text-anchor="middle" x="2883.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="2883.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_6 -->
<g id="edge23" class="edge">
<title>expert2_select&#45;&gt;expert2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3155.88,-598.08C3139.04,-592.57 3122.51,-586.61 3106.5,-580.17 3095.18,-575.61 3094.67,-570.07 3083.5,-565.17 3071.16,-559.75 3058.12,-554.82 3044.87,-550.35"/>
<polygon fill="black" stroke="black" points="3045.78,-546.97 3035.18,-547.18 3043.6,-553.62 3045.78,-546.97"/>
<text text-anchor="middle" x="3198" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 6</text>
</g>
<!-- expert2_select&#45;&gt;expert2_6 -->
<g id="edge109" class="edge">
<title>expert2_select&#45;&gt;expert2_6</title>
<path fill="none" stroke="black" d="M3377.18,-598.1C3328.91,-579.95 3289.68,-565.21 3289.5,-565.17 3212.59,-547.28 3188.89,-556.42 3107.28,-547.31"/>
<polygon fill="black" stroke="black" points="3107.37,-543.8 3097.03,-546.11 3106.56,-550.75 3107.37,-543.8"/>
</g>
<!-- expert2_7 -->
<g id="node50" class="node">
<title>expert2_7</title>
<polygon fill="lightblue" stroke="black" points="3542,-547.17 3115,-547.17 3115,-479.17 3542,-479.17 3542,-547.17"/>
<text text-anchor="middle" x="3328.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 7 MLP 2</text>
<text text-anchor="middle" x="3328.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 207</text>
<text text-anchor="middle" x="3328.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="3328.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_7 -->
<g id="edge24" class="edge">
<title>expert2_select&#45;&gt;expert2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3359.15,-598.11C3352.79,-592.59 3346.87,-586.62 3341.5,-580.17 3336.14,-573.72 3332.76,-565.69 3330.68,-557.49"/>
<polygon fill="black" stroke="black" points="3334.08,-556.63 3328.73,-547.48 3327.21,-557.96 3334.08,-556.63"/>
<text text-anchor="middle" x="3433" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 7</text>
</g>
<!-- expert2_select&#45;&gt;expert2_7 -->
<g id="edge111" class="edge">
<title>expert2_select&#45;&gt;expert2_7</title>
<path fill="none" stroke="black" d="M3544.95,-597.94C3540.37,-585.74 3533.83,-574.08 3524.5,-565.17 3519.83,-560.7 3514.82,-556.62 3509.54,-552.88"/>
<polygon fill="black" stroke="black" points="3511.31,-549.86 3501.04,-547.29 3507.47,-555.71 3511.31,-549.86"/>
</g>
<!-- expert2_8 -->
<g id="node51" class="node">
<title>expert2_8</title>
<polygon fill="lightblue" stroke="black" points="3987,-547.17 3560,-547.17 3560,-479.17 3987,-479.17 3987,-547.17"/>
<text text-anchor="middle" x="3773.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 8 MLP 2</text>
<text text-anchor="middle" x="3773.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 208</text>
<text text-anchor="middle" x="3773.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="3773.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_8 -->
<g id="edge25" class="edge">
<title>expert2_select&#45;&gt;expert2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3558.27,-598.02C3561.55,-585.89 3566.92,-574.23 3575.5,-565.17 3580.31,-560.08 3588.34,-555.35 3598.49,-550.99"/>
<polygon fill="black" stroke="black" points="3599.91,-554.19 3607.92,-547.26 3597.33,-547.69 3599.91,-554.19"/>
<text text-anchor="middle" x="3667" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 8</text>
</g>
<!-- expert2_select&#45;&gt;expert2_8 -->
<g id="edge113" class="edge">
<title>expert2_select&#45;&gt;expert2_8</title>
<path fill="none" stroke="black" d="M3740.71,-598.07C3747.11,-592.56 3753.09,-586.6 3758.5,-580.17 3763.93,-573.71 3767.49,-565.68 3769.81,-557.47"/>
<polygon fill="black" stroke="black" points="3773.28,-557.98 3772.06,-547.46 3766.45,-556.45 3773.28,-557.98"/>
</g>
<!-- expert2_9 -->
<g id="node52" class="node">
<title>expert2_9</title>
<polygon fill="lightblue" stroke="black" points="4432,-547.17 4005,-547.17 4005,-479.17 4432,-479.17 4432,-547.17"/>
<text text-anchor="middle" x="4218.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 9 MLP 2</text>
<text text-anchor="middle" x="4218.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 209</text>
<text text-anchor="middle" x="4218.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="4218.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_9 -->
<g id="edge26" class="edge">
<title>expert2_select&#45;&gt;expert2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3825.26,-598.15C3872.59,-586.83 3921.43,-575.43 3967.5,-565.17 3991.45,-559.83 4016.73,-554.42 4041.66,-549.23"/>
<polygon fill="black" stroke="black" points="4042.49,-552.63 4051.57,-547.17 4041.07,-545.78 4042.49,-552.63"/>
<text text-anchor="middle" x="4059" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 9</text>
</g>
<!-- expert2_select&#45;&gt;expert2_9 -->
<g id="edge115" class="edge">
<title>expert2_select&#45;&gt;expert2_9</title>
<path fill="none" stroke="black" d="M3879.8,-636.67C3991.61,-623.07 4101.14,-604.39 4150.5,-580.17 4163.22,-573.93 4175.07,-564.42 4185.21,-554.55"/>
<polygon fill="black" stroke="black" points="4187.77,-556.93 4192.27,-547.33 4182.77,-552.03 4187.77,-556.93"/>
</g>
<!-- expert2_10 -->
<g id="node53" class="node">
<title>expert2_10</title>
<polygon fill="lightblue" stroke="black" points="4877,-547.17 4450,-547.17 4450,-479.17 4877,-479.17 4877,-547.17"/>
<text text-anchor="middle" x="4663.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 10 MLP 2</text>
<text text-anchor="middle" x="4663.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 210</text>
<text text-anchor="middle" x="4663.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="4663.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_10 -->
<g id="edge27" class="edge">
<title>expert2_select&#45;&gt;expert2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3863.95,-625.25C4031.5,-603.28 4242.57,-575.14 4439.96,-547.38"/>
<polygon fill="black" stroke="black" points="4440.53,-550.83 4449.95,-545.97 4439.56,-543.9 4440.53,-550.83"/>
<text text-anchor="middle" x="4392.5" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 10</text>
</g>
<!-- expert2_select&#45;&gt;expert2_10 -->
<g id="edge117" class="edge">
<title>expert2_select&#45;&gt;expert2_10</title>
<path fill="none" stroke="black" d="M3906.81,-656.39C4084.27,-646.16 4301.82,-624.69 4492.5,-580.17 4522.43,-573.18 4554.11,-562.07 4581.97,-550.94"/>
<polygon fill="black" stroke="black" points="4583.31,-554.18 4591.26,-547.17 4580.68,-547.69 4583.31,-554.18"/>
</g>
<!-- expert2_11 -->
<g id="node54" class="node">
<title>expert2_11</title>
<polygon fill="lightblue" stroke="black" points="5322,-547.17 4895,-547.17 4895,-479.17 5322,-479.17 5322,-547.17"/>
<text text-anchor="middle" x="5108.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 11 MLP 2</text>
<text text-anchor="middle" x="5108.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 211</text>
<text text-anchor="middle" x="5108.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="5108.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_11 -->
<g id="edge28" class="edge">
<title>expert2_select&#45;&gt;expert2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3886.69,-641.65C4153.78,-621.29 4539.22,-588.77 4885.01,-547.33"/>
<polygon fill="black" stroke="black" points="4885.46,-550.8 4894.97,-546.13 4884.62,-543.85 4885.46,-550.8"/>
<text text-anchor="middle" x="4801.5" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 11</text>
</g>
<!-- expert2_select&#45;&gt;expert2_11 -->
<g id="edge119" class="edge">
<title>expert2_select&#45;&gt;expert2_11</title>
<path fill="none" stroke="black" d="M3902.16,-652.94C4236.15,-639.41 4717.12,-614.83 4901.5,-580.17 4938.18,-573.27 4977.43,-561.84 5011.78,-550.42"/>
<polygon fill="black" stroke="black" points="5012.98,-553.71 5021.34,-547.2 5010.74,-547.08 5012.98,-553.71"/>
</g>
<!-- expert2_12 -->
<g id="node55" class="node">
<title>expert2_12</title>
<polygon fill="lightblue" stroke="black" points="5767,-547.17 5340,-547.17 5340,-479.17 5767,-479.17 5767,-547.17"/>
<text text-anchor="middle" x="5553.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 12 MLP 2</text>
<text text-anchor="middle" x="5553.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 212</text>
<text text-anchor="middle" x="5553.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="5553.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_12 -->
<g id="edge29" class="edge">
<title>expert2_select&#45;&gt;expert2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3893.63,-646.7C4174.78,-630.81 4585.34,-606.36 4943.5,-580.17 5112.82,-567.78 5157.9,-567.25 5329.81,-547.34"/>
<polygon fill="black" stroke="black" points="5330.44,-550.79 5339.97,-546.16 5329.63,-543.84 5330.44,-550.79"/>
<text text-anchor="middle" x="5246.5" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 12</text>
</g>
<!-- expert2_select&#45;&gt;expert2_12 -->
<g id="edge121" class="edge">
<title>expert2_select&#45;&gt;expert2_12</title>
<path fill="none" stroke="black" d="M3910.82,-659.27C4352.55,-650.03 5080.73,-627.99 5346.5,-580.17 5383.57,-573.5 5423.22,-561.99 5457.79,-550.43"/>
<polygon fill="black" stroke="black" points="5459.06,-553.7 5467.4,-547.17 5456.81,-547.07 5459.06,-553.7"/>
</g>
<!-- expert2_13 -->
<g id="node56" class="node">
<title>expert2_13</title>
<polygon fill="lightblue" stroke="black" points="6212,-547.17 5785,-547.17 5785,-479.17 6212,-479.17 6212,-547.17"/>
<text text-anchor="middle" x="5998.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 13 MLP 2</text>
<text text-anchor="middle" x="5998.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 213</text>
<text text-anchor="middle" x="5998.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="5998.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_13 -->
<g id="edge30" class="edge">
<title>expert2_select&#45;&gt;expert2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3902.2,-653.1C4271.15,-639.33 4871.86,-614.22 5389.5,-580.17 5558.47,-569.05 5603.35,-567.27 5774.84,-547.34"/>
<polygon fill="black" stroke="black" points="5775.44,-550.79 5784.97,-546.16 5774.63,-543.84 5775.44,-550.79"/>
<text text-anchor="middle" x="5698.5" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 13</text>
</g>
<!-- expert2_select&#45;&gt;expert2_13 -->
<g id="edge123" class="edge">
<title>expert2_select&#45;&gt;expert2_13</title>
<path fill="none" stroke="black" d="M3916.92,-663.77C4456.95,-659.59 5448.43,-643.26 5798.5,-580.17 5834.36,-573.7 5872.61,-562.27 5905.96,-550.71"/>
<polygon fill="black" stroke="black" points="5907.41,-553.91 5915.68,-547.29 5905.09,-547.31 5907.41,-553.91"/>
</g>
<!-- expert2_14 -->
<g id="node57" class="node">
<title>expert2_14</title>
<polygon fill="lightblue" stroke="black" points="6657,-547.17 6230,-547.17 6230,-479.17 6657,-479.17 6657,-547.17"/>
<text text-anchor="middle" x="6443.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 14 MLP 2</text>
<text text-anchor="middle" x="6443.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 214</text>
<text text-anchor="middle" x="6443.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="6443.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_14 -->
<g id="edge31" class="edge">
<title>expert2_select&#45;&gt;expert2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3908.38,-657.49C4357.86,-646.46 5158.44,-622.63 5842.5,-580.17 6008.04,-569.89 6051.92,-567.05 6220.04,-547.32"/>
<polygon fill="black" stroke="black" points="6220.45,-550.8 6229.97,-546.15 6219.63,-543.84 6220.45,-550.8"/>
<text text-anchor="middle" x="6146.5" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 14</text>
</g>
<!-- expert2_select&#45;&gt;expert2_14 -->
<g id="edge125" class="edge">
<title>expert2_select&#45;&gt;expert2_14</title>
<path fill="none" stroke="black" d="M3911.33,-659.7C4590.26,-648.42 6023.14,-620.22 6246.5,-580.17 6282.05,-573.79 6319.92,-562.31 6352.86,-550.69"/>
<polygon fill="black" stroke="black" points="6354.23,-553.92 6362.47,-547.25 6351.87,-547.33 6354.23,-553.92"/>
</g>
<!-- expert2_15 -->
<g id="node58" class="node">
<title>expert2_15</title>
<polygon fill="lightblue" stroke="black" points="7102,-547.17 6675,-547.17 6675,-479.17 7102,-479.17 7102,-547.17"/>
<text text-anchor="middle" x="6888.5" y="-531.97" font-family="Times,serif" font-size="14.00">Expert 15 MLP 2</text>
<text text-anchor="middle" x="6888.5" y="-516.97" font-family="Times,serif" font-size="14.00">GPU: 215</text>
<text text-anchor="middle" x="6888.5" y="-501.97" font-family="Times,serif" font-size="14.00">Input: [tokens_per_expert=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="6888.5" y="-486.97" font-family="Times,serif" font-size="14.00">Output: [tokens_per_expert=variable, hidden_dim=7168]</text>
</g>
<!-- expert2_select&#45;&gt;expert2_15 -->
<g id="edge32" class="edge">
<title>expert2_select&#45;&gt;expert2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3912.55,-660.5C4435.02,-652.21 5438.39,-630.76 6290.5,-580.17 6454.69,-570.42 6498.22,-566.98 6664.86,-547.34"/>
<polygon fill="black" stroke="black" points="6665.45,-550.8 6674.97,-546.15 6664.63,-543.85 6665.45,-550.8"/>
<text text-anchor="middle" x="6593.5" y="-568.97" font-family="Times,serif" font-size="14.00">route tokens to expert2 15</text>
</g>
<!-- expert2_select&#45;&gt;expert2_15 -->
<g id="edge127" class="edge">
<title>expert2_select&#45;&gt;expert2_15</title>
<path fill="none" stroke="black" d="M3913.95,-661.48C4679.56,-652.74 6426.67,-627.82 6693.5,-580.17 6728.73,-573.88 6766.22,-562.41 6798.83,-550.78"/>
<polygon fill="black" stroke="black" points="6800.12,-554.03 6808.33,-547.34 6797.74,-547.45 6800.12,-554.03"/>
</g>
<!-- expert2_agg -->
<g id="node59" class="node">
<title>expert2_agg</title>
<polygon fill="yellow" stroke="black" points="3998.25,-442.17 3285.98,-442.17 3102.75,-306.17 3815.02,-306.17 3998.25,-442.17"/>
<text text-anchor="middle" x="3550.5" y="-392.97" font-family="Times,serif" font-size="14.00">Expert Output Aggregation 2</text>
<text text-anchor="middle" x="3550.5" y="-377.97" font-family="Times,serif" font-size="14.00">GPU: 216</text>
<text text-anchor="middle" x="3550.5" y="-362.97" font-family="Times,serif" font-size="14.00">Input: [tokens_from_experts=variable, hidden_dim=7168]</text>
<text text-anchor="middle" x="3550.5" y="-347.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- expert2_0&#45;&gt;expert2_agg -->
<g id="edge98" class="edge">
<title>expert2_0&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M427.01,-479.97C429.85,-479.69 432.69,-479.42 435.5,-479.17 961.03,-431.49 2493.94,-396.09 3194.16,-381.94"/>
<polygon fill="black" stroke="black" points="3194.48,-385.43 3204.4,-381.73 3194.33,-378.43 3194.48,-385.43"/>
</g>
<!-- expert2_1&#45;&gt;expert2_agg -->
<g id="edge100" class="edge">
<title>expert2_1&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M872.01,-479.99C874.86,-479.7 877.69,-479.43 880.5,-479.17 1702.96,-402.25 2673.08,-382.02 3187.5,-376.83"/>
<polygon fill="black" stroke="black" points="3187.72,-380.33 3197.68,-376.73 3187.65,-373.33 3187.72,-380.33"/>
</g>
<!-- expert2_2&#45;&gt;expert2_agg -->
<g id="edge102" class="edge">
<title>expert2_2&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M1317.01,-479.95C1319.85,-479.68 1322.69,-479.41 1325.5,-479.17 1604.53,-454.53 1675.62,-472.71 1955.5,-461.17 2389.43,-443.27 2889.38,-415.09 3212.16,-395.9"/>
<polygon fill="black" stroke="black" points="3212.84,-399.36 3222.61,-395.28 3212.42,-392.38 3212.84,-399.36"/>
</g>
<!-- expert2_3&#45;&gt;expert2_agg -->
<g id="edge104" class="edge">
<title>expert2_3&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M1762,-479.91C1764.85,-479.65 1767.68,-479.4 1770.5,-479.17 2189.12,-444.21 2296.2,-486.71 2715.5,-461.17 2887.91,-450.66 3079.65,-431.45 3235.88,-413.85"/>
<polygon fill="black" stroke="black" points="3236.57,-417.29 3246.12,-412.69 3235.79,-410.34 3236.57,-417.29"/>
</g>
<!-- expert2_4&#45;&gt;expert2_agg -->
<g id="edge106" class="edge">
<title>expert2_4&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M2207,-479.91C2209.85,-479.65 2212.68,-479.4 2215.5,-479.17 2610.63,-445.95 2713.2,-503.1 3107.5,-461.17 3159.48,-455.64 3214.46,-447.15 3267.34,-437.62"/>
<polygon fill="black" stroke="black" points="3267.98,-441.06 3277.19,-435.83 3266.72,-434.17 3267.98,-441.06"/>
</g>
<!-- expert2_5&#45;&gt;expert2_agg -->
<g id="edge108" class="edge">
<title>expert2_5&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M2652,-479.94C2654.85,-479.67 2657.69,-479.41 2660.5,-479.17 2805.77,-466.42 3173.29,-488.68 3316.5,-461.17 3337.14,-457.2 3358.37,-451.64 3379.23,-445.24"/>
<polygon fill="black" stroke="black" points="3380.28,-448.58 3388.78,-442.25 3378.19,-441.9 3380.28,-448.58"/>
</g>
<!-- expert2_6&#45;&gt;expert2_agg -->
<g id="edge110" class="edge">
<title>expert2_6&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M3097.02,-480.05C3099.86,-479.75 3102.69,-479.45 3105.5,-479.17 3178.13,-471.79 3364.79,-485.81 3433.5,-461.17 3443.49,-457.58 3453.36,-452.85 3462.88,-447.45"/>
<polygon fill="black" stroke="black" points="3464.71,-450.43 3471.52,-442.31 3461.13,-444.41 3464.71,-450.43"/>
</g>
<!-- expert2_7&#45;&gt;expert2_agg -->
<g id="edge112" class="edge">
<title>expert2_7&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M3477.05,-478.99C3486.82,-473.87 3496.1,-467.97 3504.5,-461.17 3508.51,-457.92 3512.21,-454.23 3515.63,-450.24"/>
<polygon fill="black" stroke="black" points="3518.47,-452.29 3521.86,-442.25 3512.95,-447.99 3518.47,-452.29"/>
</g>
<!-- expert2_8&#45;&gt;expert2_agg -->
<g id="edge114" class="edge">
<title>expert2_8&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M3719.52,-479C3704.01,-469.48 3686.46,-458.69 3668.68,-447.77"/>
<polygon fill="black" stroke="black" points="3670.29,-444.65 3659.94,-442.4 3666.63,-450.62 3670.29,-444.65"/>
</g>
<!-- expert2_9&#45;&gt;expert2_agg -->
<g id="edge116" class="edge">
<title>expert2_9&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M4057.22,-479.09C4005.65,-468.51 3946.51,-456.38 3887.25,-444.23"/>
<polygon fill="black" stroke="black" points="3887.85,-440.78 3877.35,-442.2 3886.44,-447.64 3887.85,-440.78"/>
</g>
<!-- expert2_10&#45;&gt;expert2_agg -->
<g id="edge118" class="edge">
<title>expert2_10&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M4449.96,-480.3C4447.12,-479.91 4444.3,-479.54 4441.5,-479.17 4291.43,-459.26 4126.87,-439.48 3980.45,-422.59"/>
<polygon fill="black" stroke="black" points="3980.72,-419.1 3970.39,-421.43 3979.92,-426.05 3980.72,-419.1"/>
</g>
<!-- expert2_11&#45;&gt;expert2_agg -->
<g id="edge120" class="edge">
<title>expert2_11&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M4894.98,-480.14C4892.13,-479.81 4889.31,-479.48 4886.5,-479.17 4572.39,-443.64 4215.34,-416.53 3949.43,-398.9"/>
<polygon fill="black" stroke="black" points="3949.43,-395.4 3939.22,-398.23 3948.97,-402.38 3949.43,-395.4"/>
</g>
<!-- expert2_12&#45;&gt;expert2_agg -->
<g id="edge122" class="edge">
<title>expert2_12&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M5339.98,-480.07C5337.14,-479.76 5334.31,-479.46 5331.5,-479.17 4851.34,-429.56 4295.71,-401.81 3934.48,-387.69"/>
<polygon fill="black" stroke="black" points="3934.51,-384.18 3924.38,-387.29 3934.24,-391.18 3934.51,-384.18"/>
</g>
<!-- expert2_13&#45;&gt;expert2_agg -->
<g id="edge124" class="edge">
<title>expert2_13&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M5784.99,-480.02C5782.14,-479.73 5779.31,-479.44 5776.5,-479.17 5128.05,-415.99 4369.47,-390.92 3926.26,-381.17"/>
<polygon fill="black" stroke="black" points="3926.25,-377.67 3916.17,-380.95 3926.09,-384.67 3926.25,-377.67"/>
</g>
<!-- expert2_14&#45;&gt;expert2_agg -->
<g id="edge126" class="edge">
<title>expert2_14&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M6229.99,-479.99C6227.14,-479.7 6224.31,-479.43 6221.5,-479.17 5402.46,-402.58 4437.05,-382.19 3920.66,-376.89"/>
<polygon fill="black" stroke="black" points="3920.47,-373.39 3910.44,-376.79 3920.4,-380.39 3920.47,-373.39"/>
</g>
<!-- expert2_15&#45;&gt;expert2_agg -->
<g id="edge128" class="edge">
<title>expert2_15&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M6674.99,-479.97C6672.15,-479.69 6669.31,-479.42 6666.5,-479.17 6145.93,-431.94 4637.25,-396.78 3927.71,-382.36"/>
<polygon fill="black" stroke="black" points="3927.65,-378.86 3917.59,-382.15 3927.51,-385.85 3927.65,-378.86"/>
</g>
<!-- dp_agg -->
<g id="node60" class="node">
<title>dp_agg</title>
<polygon fill="yellow" stroke="black" points="3997.18,-269.17 3286.61,-269.17 3103.82,-133.17 3814.39,-133.17 3997.18,-269.17"/>
<text text-anchor="middle" x="3550.5" y="-219.97" font-family="Times,serif" font-size="14.00">DP Aggregation</text>
<text text-anchor="middle" x="3550.5" y="-204.97" font-family="Times,serif" font-size="14.00">GPU: META</text>
<text text-anchor="middle" x="3550.5" y="-189.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1, seq_len=2048, hidden_dim=7168]</text>
<text text-anchor="middle" x="3550.5" y="-174.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, hidden_dim=7168]</text>
</g>
<!-- expert2_agg&#45;&gt;dp_agg -->
<g id="edge129" class="edge">
<title>expert2_agg&#45;&gt;dp_agg</title>
<path fill="none" stroke="black" d="M3550.5,-306.07C3550.5,-297.4 3550.5,-288.46 3550.5,-279.63"/>
<polygon fill="black" stroke="black" points="3554,-279.35 3550.5,-269.35 3547,-279.35 3554,-279.35"/>
</g>
<!-- output -->
<g id="node61" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="3550.5" cy="-48.08" rx="313.5" ry="48.17"/>
<text text-anchor="middle" x="3550.5" y="-66.88" font-family="Times,serif" font-size="14.00">Output Layer</text>
<text text-anchor="middle" x="3550.5" y="-51.88" font-family="Times,serif" font-size="14.00">GPU: META</text>
<text text-anchor="middle" x="3550.5" y="-36.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=4, seq_len=2048, hidden_dim=7168]</text>
<text text-anchor="middle" x="3550.5" y="-21.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=4, seq_len=2048, vocab_size=128256]</text>
</g>
<!-- dp_agg&#45;&gt;output -->
<g id="edge130" class="edge">
<title>dp_agg&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3550.5,-133.02C3550.5,-124.28 3550.5,-115.39 3550.5,-106.82"/>
<polygon fill="black" stroke="black" points="3554,-106.56 3550.5,-96.56 3547,-106.56 3554,-106.56"/>
</g>
</g>
</svg>
