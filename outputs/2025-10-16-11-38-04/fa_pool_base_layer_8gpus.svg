<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="24886pt" height="1956pt"
 viewBox="0.00 0.00 24886.00 1956.50" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1952.5)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1952.5 24882,-1952.5 24882,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="8092" cy="-1900.42" rx="287.59" ry="48.17"/>
<text text-anchor="middle" x="8092" y="-1919.22" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="8092" y="-1904.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="8092" y="-1889.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="8092" y="-1874.22" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- embedding_0 -->
<g id="node2" class="node">
<title>embedding_0</title>
<polygon fill="lightblue" stroke="black" points="10523,-1816.33 10125,-1816.33 10125,-1748.33 10523,-1748.33 10523,-1816.33"/>
<text text-anchor="middle" x="10324" y="-1801.13" font-family="Times,serif" font-size="14.00">Embedding Partition 0</text>
<text text-anchor="middle" x="10324" y="-1786.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="10324" y="-1771.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10324" y="-1756.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;embedding_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embedding_0</title>
<path fill="none" stroke="black" d="M8379.8,-1900C8982.9,-1900 10324,-1900 10324,-1900 10324,-1900 10324,-1826.37 10324,-1826.37"/>
<polygon fill="black" stroke="black" points="10327.5,-1826.37 10324,-1816.37 10320.5,-1826.37 10327.5,-1826.37"/>
</g>
<!-- embedding_1 -->
<g id="node3" class="node">
<title>embedding_1</title>
<polygon fill="lightblue" stroke="black" points="6554,-1816.33 6156,-1816.33 6156,-1748.33 6554,-1748.33 6554,-1816.33"/>
<text text-anchor="middle" x="6355" y="-1801.13" font-family="Times,serif" font-size="14.00">Embedding Partition 1</text>
<text text-anchor="middle" x="6355" y="-1786.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="6355" y="-1771.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6355" y="-1756.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- input&#45;&gt;embedding_1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;embedding_1</title>
<path fill="none" stroke="black" d="M7840.82,-1924C7359.61,-1924 6355,-1924 6355,-1924 6355,-1924 6355,-1826.63 6355,-1826.63"/>
<polygon fill="black" stroke="black" points="6358.5,-1826.63 6355,-1816.63 6351.5,-1826.63 6358.5,-1826.63"/>
</g>
<!-- embedding_2 -->
<g id="node4" class="node">
<title>embedding_2</title>
<polygon fill="lightblue" stroke="black" points="6989,-1816.33 6591,-1816.33 6591,-1748.33 6989,-1748.33 6989,-1816.33"/>
<text text-anchor="middle" x="6790" y="-1801.13" font-family="Times,serif" font-size="14.00">Embedding Partition 2</text>
<text text-anchor="middle" x="6790" y="-1786.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="6790" y="-1771.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6790" y="-1756.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- input&#45;&gt;embedding_2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;embedding_2</title>
<path fill="none" stroke="black" d="M7803.85,-1900C7420.35,-1900 6790,-1900 6790,-1900 6790,-1900 6790,-1826.37 6790,-1826.37"/>
<polygon fill="black" stroke="black" points="6793.5,-1826.37 6790,-1816.37 6786.5,-1826.37 6793.5,-1826.37"/>
</g>
<!-- embedding_3 -->
<g id="node5" class="node">
<title>embedding_3</title>
<polygon fill="lightblue" stroke="black" points="7423,-1816.33 7025,-1816.33 7025,-1748.33 7423,-1748.33 7423,-1816.33"/>
<text text-anchor="middle" x="7224" y="-1801.13" font-family="Times,serif" font-size="14.00">Embedding Partition 3</text>
<text text-anchor="middle" x="7224" y="-1786.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="7224" y="-1771.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7224" y="-1756.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- input&#45;&gt;embedding_3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;embedding_3</title>
<path fill="none" stroke="black" d="M7843.85,-1876C7587.32,-1876 7224,-1876 7224,-1876 7224,-1876 7224,-1826.41 7224,-1826.41"/>
<polygon fill="black" stroke="black" points="7227.5,-1826.41 7224,-1816.41 7220.5,-1826.41 7227.5,-1826.41"/>
</g>
<!-- embedding_4 -->
<g id="node6" class="node">
<title>embedding_4</title>
<polygon fill="lightblue" stroke="black" points="7857,-1816.33 7459,-1816.33 7459,-1748.33 7857,-1748.33 7857,-1816.33"/>
<text text-anchor="middle" x="7658" y="-1801.13" font-family="Times,serif" font-size="14.00">Embedding Partition 4</text>
<text text-anchor="middle" x="7658" y="-1786.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="7658" y="-1771.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7658" y="-1756.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- input&#45;&gt;embedding_4 -->
<g id="edge5" class="edge">
<title>input&#45;&gt;embedding_4</title>
<path fill="none" stroke="black" d="M7830.6,-1880.12C7830.6,-1880.12 7830.6,-1826.68 7830.6,-1826.68"/>
<polygon fill="black" stroke="black" points="7834.1,-1826.68 7830.6,-1816.68 7827.1,-1826.68 7834.1,-1826.68"/>
</g>
<!-- embedding_5 -->
<g id="node7" class="node">
<title>embedding_5</title>
<polygon fill="lightblue" stroke="black" points="8291,-1816.33 7893,-1816.33 7893,-1748.33 8291,-1748.33 8291,-1816.33"/>
<text text-anchor="middle" x="8092" y="-1801.13" font-family="Times,serif" font-size="14.00">Embedding Partition 5</text>
<text text-anchor="middle" x="8092" y="-1786.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="8092" y="-1771.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8092" y="-1756.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- input&#45;&gt;embedding_5 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;embedding_5</title>
<path fill="none" stroke="black" d="M8092,-1852.05C8092,-1852.05 8092,-1826.37 8092,-1826.37"/>
<polygon fill="black" stroke="black" points="8095.5,-1826.37 8092,-1816.37 8088.5,-1826.37 8095.5,-1826.37"/>
</g>
<!-- embedding_6 -->
<g id="node8" class="node">
<title>embedding_6</title>
<polygon fill="lightblue" stroke="black" points="8944,-1816.33 8546,-1816.33 8546,-1748.33 8944,-1748.33 8944,-1816.33"/>
<text text-anchor="middle" x="8745" y="-1801.13" font-family="Times,serif" font-size="14.00">Embedding Partition 6</text>
<text text-anchor="middle" x="8745" y="-1786.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="8745" y="-1771.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8745" y="-1756.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- input&#45;&gt;embedding_6 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;embedding_6</title>
<path fill="none" stroke="black" d="M8335.4,-1874.72C8335.4,-1839.89 8335.4,-1782 8335.4,-1782 8335.4,-1782 8535.9,-1782 8535.9,-1782"/>
<polygon fill="black" stroke="black" points="8535.9,-1785.5 8545.9,-1782 8535.9,-1778.5 8535.9,-1785.5"/>
</g>
<!-- embedding_7 -->
<g id="node9" class="node">
<title>embedding_7</title>
<polygon fill="lightblue" stroke="black" points="9706,-1816.33 9308,-1816.33 9308,-1748.33 9706,-1748.33 9706,-1816.33"/>
<text text-anchor="middle" x="9507" y="-1801.13" font-family="Times,serif" font-size="14.00">Embedding Partition 7</text>
<text text-anchor="middle" x="9507" y="-1786.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="9507" y="-1771.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9507" y="-1756.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- input&#45;&gt;embedding_7 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;embedding_7</title>
<path fill="none" stroke="black" d="M8340.09,-1876C8745.91,-1876 9507,-1876 9507,-1876 9507,-1876 9507,-1826.41 9507,-1826.41"/>
<polygon fill="black" stroke="black" points="9510.5,-1826.41 9507,-1816.41 9503.5,-1826.41 9510.5,-1826.41"/>
</g>
<!-- residual_ffn_0 -->
<g id="node83" class="node">
<title>residual_ffn_0</title>
<ellipse fill="orange" stroke="black" cx="11344" cy="-952.33" rx="297.88" ry="48.17"/>
<text text-anchor="middle" x="11344" y="-971.13" font-family="Times,serif" font-size="14.00">Residual Add FFN 0</text>
<text text-anchor="middle" x="11344" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096] x 2</text>
<text text-anchor="middle" x="11344" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="11344" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input&#45;&gt;residual_ffn_0 -->
<g id="edge73" class="edge">
<title>input&#45;&gt;residual_ffn_0</title>
<path fill="none" stroke="black" d="M8343.12,-1924C9105.91,-1924 11344,-1924 11344,-1924 11344,-1924 11344,-1010.52 11344,-1010.52"/>
<polygon fill="black" stroke="black" points="11347.5,-1010.52 11344,-1000.52 11340.5,-1010.52 11347.5,-1010.52"/>
</g>
<!-- pos_enc_0 -->
<g id="node10" class="node">
<title>pos_enc_0</title>
<polygon fill="lightblue" stroke="black" points="10660,-1712.33 10262,-1712.33 10262,-1644.33 10660,-1644.33 10660,-1712.33"/>
<text text-anchor="middle" x="10461" y="-1697.13" font-family="Times,serif" font-size="14.00">Positional Encoding 0</text>
<text text-anchor="middle" x="10461" y="-1682.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10461" y="-1667.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10461" y="-1652.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- embedding_0&#45;&gt;pos_enc_0 -->
<g id="edge9" class="edge">
<title>embedding_0&#45;&gt;pos_enc_0</title>
<path fill="none" stroke="black" d="M10392.5,-1748.28C10392.5,-1748.28 10392.5,-1722.46 10392.5,-1722.46"/>
<polygon fill="black" stroke="black" points="10396,-1722.46 10392.5,-1712.46 10389,-1722.46 10396,-1722.46"/>
</g>
<!-- pos_enc_1 -->
<g id="node11" class="node">
<title>pos_enc_1</title>
<polygon fill="lightblue" stroke="black" points="5350,-1712.33 4952,-1712.33 4952,-1644.33 5350,-1644.33 5350,-1712.33"/>
<text text-anchor="middle" x="5151" y="-1697.13" font-family="Times,serif" font-size="14.00">Positional Encoding 1</text>
<text text-anchor="middle" x="5151" y="-1682.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5151" y="-1667.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5151" y="-1652.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- embedding_1&#45;&gt;pos_enc_1 -->
<g id="edge10" class="edge">
<title>embedding_1&#45;&gt;pos_enc_1</title>
<path fill="none" stroke="black" d="M6155.85,-1782C5813.78,-1782 5151,-1782 5151,-1782 5151,-1782 5151,-1722.56 5151,-1722.56"/>
<polygon fill="black" stroke="black" points="5154.5,-1722.56 5151,-1712.56 5147.5,-1722.56 5154.5,-1722.56"/>
</g>
<!-- pos_enc_2 -->
<g id="node12" class="node">
<title>pos_enc_2</title>
<polygon fill="lightblue" stroke="black" points="6441,-1712.33 6043,-1712.33 6043,-1644.33 6441,-1644.33 6441,-1712.33"/>
<text text-anchor="middle" x="6242" y="-1697.13" font-family="Times,serif" font-size="14.00">Positional Encoding 2</text>
<text text-anchor="middle" x="6242" y="-1682.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6242" y="-1667.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6242" y="-1652.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- embedding_2&#45;&gt;pos_enc_2 -->
<g id="edge11" class="edge">
<title>embedding_2&#45;&gt;pos_enc_2</title>
<path fill="none" stroke="black" d="M6698,-1748.17C6698,-1717.74 6698,-1678 6698,-1678 6698,-1678 6451.01,-1678 6451.01,-1678"/>
<polygon fill="black" stroke="black" points="6451.01,-1674.5 6441.01,-1678 6451.01,-1681.5 6451.01,-1674.5"/>
</g>
<!-- pos_enc_3 -->
<g id="node13" class="node">
<title>pos_enc_3</title>
<polygon fill="lightblue" stroke="black" points="7203,-1712.33 6805,-1712.33 6805,-1644.33 7203,-1644.33 7203,-1712.33"/>
<text text-anchor="middle" x="7004" y="-1697.13" font-family="Times,serif" font-size="14.00">Positional Encoding 3</text>
<text text-anchor="middle" x="7004" y="-1682.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7004" y="-1667.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7004" y="-1652.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- embedding_3&#45;&gt;pos_enc_3 -->
<g id="edge12" class="edge">
<title>embedding_3&#45;&gt;pos_enc_3</title>
<path fill="none" stroke="black" d="M7114,-1748.28C7114,-1748.28 7114,-1722.46 7114,-1722.46"/>
<polygon fill="black" stroke="black" points="7117.5,-1722.46 7114,-1712.46 7110.5,-1722.46 7117.5,-1722.46"/>
</g>
<!-- pos_enc_4 -->
<g id="node14" class="node">
<title>pos_enc_4</title>
<polygon fill="lightblue" stroke="black" points="7801,-1712.33 7403,-1712.33 7403,-1644.33 7801,-1644.33 7801,-1712.33"/>
<text text-anchor="middle" x="7602" y="-1697.13" font-family="Times,serif" font-size="14.00">Positional Encoding 4</text>
<text text-anchor="middle" x="7602" y="-1682.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7602" y="-1667.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7602" y="-1652.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- embedding_4&#45;&gt;pos_enc_4 -->
<g id="edge13" class="edge">
<title>embedding_4&#45;&gt;pos_enc_4</title>
<path fill="none" stroke="black" d="M7630,-1748.28C7630,-1748.28 7630,-1722.46 7630,-1722.46"/>
<polygon fill="black" stroke="black" points="7633.5,-1722.46 7630,-1712.46 7626.5,-1722.46 7633.5,-1722.46"/>
</g>
<!-- pos_enc_5 -->
<g id="node15" class="node">
<title>pos_enc_5</title>
<polygon fill="lightblue" stroke="black" points="8291,-1712.33 7893,-1712.33 7893,-1644.33 8291,-1644.33 8291,-1712.33"/>
<text text-anchor="middle" x="8092" y="-1697.13" font-family="Times,serif" font-size="14.00">Positional Encoding 5</text>
<text text-anchor="middle" x="8092" y="-1682.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8092" y="-1667.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8092" y="-1652.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- embedding_5&#45;&gt;pos_enc_5 -->
<g id="edge14" class="edge">
<title>embedding_5&#45;&gt;pos_enc_5</title>
<path fill="none" stroke="black" d="M8092,-1748.28C8092,-1748.28 8092,-1722.46 8092,-1722.46"/>
<polygon fill="black" stroke="black" points="8095.5,-1722.46 8092,-1712.46 8088.5,-1722.46 8095.5,-1722.46"/>
</g>
<!-- pos_enc_6 -->
<g id="node16" class="node">
<title>pos_enc_6</title>
<polygon fill="lightblue" stroke="black" points="8999,-1712.33 8601,-1712.33 8601,-1644.33 8999,-1644.33 8999,-1712.33"/>
<text text-anchor="middle" x="8800" y="-1697.13" font-family="Times,serif" font-size="14.00">Positional Encoding 6</text>
<text text-anchor="middle" x="8800" y="-1682.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8800" y="-1667.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8800" y="-1652.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- embedding_6&#45;&gt;pos_enc_6 -->
<g id="edge15" class="edge">
<title>embedding_6&#45;&gt;pos_enc_6</title>
<path fill="none" stroke="black" d="M8772.5,-1748.28C8772.5,-1748.28 8772.5,-1722.46 8772.5,-1722.46"/>
<polygon fill="black" stroke="black" points="8776,-1722.46 8772.5,-1712.46 8769,-1722.46 8776,-1722.46"/>
</g>
<!-- pos_enc_7 -->
<g id="node17" class="node">
<title>pos_enc_7</title>
<polygon fill="lightblue" stroke="black" points="9816,-1712.33 9418,-1712.33 9418,-1644.33 9816,-1644.33 9816,-1712.33"/>
<text text-anchor="middle" x="9617" y="-1697.13" font-family="Times,serif" font-size="14.00">Positional Encoding 7</text>
<text text-anchor="middle" x="9617" y="-1682.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9617" y="-1667.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9617" y="-1652.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- embedding_7&#45;&gt;pos_enc_7 -->
<g id="edge16" class="edge">
<title>embedding_7&#45;&gt;pos_enc_7</title>
<path fill="none" stroke="black" d="M9562,-1748.28C9562,-1748.28 9562,-1722.46 9562,-1722.46"/>
<polygon fill="black" stroke="black" points="9565.5,-1722.46 9562,-1712.46 9558.5,-1722.46 9565.5,-1722.46"/>
</g>
<!-- layer_norm_0_0 -->
<g id="node18" class="node">
<title>layer_norm_0_0</title>
<polygon fill="lightblue" stroke="black" points="10852,-1608.33 10454,-1608.33 10454,-1540.33 10852,-1540.33 10852,-1608.33"/>
<text text-anchor="middle" x="10653" y="-1593.13" font-family="Times,serif" font-size="14.00">Layer Norm 0 Part 0</text>
<text text-anchor="middle" x="10653" y="-1578.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10653" y="-1563.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10653" y="-1548.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- pos_enc_0&#45;&gt;layer_norm_0_0 -->
<g id="edge17" class="edge">
<title>pos_enc_0&#45;&gt;layer_norm_0_0</title>
<path fill="none" stroke="black" d="M10557,-1644.28C10557,-1644.28 10557,-1618.46 10557,-1618.46"/>
<polygon fill="black" stroke="black" points="10560.5,-1618.46 10557,-1608.46 10553.5,-1618.46 10560.5,-1618.46"/>
</g>
<!-- layer_norm_0_1 -->
<g id="node19" class="node">
<title>layer_norm_0_1</title>
<polygon fill="lightblue" stroke="black" points="5184,-1608.33 4786,-1608.33 4786,-1540.33 5184,-1540.33 5184,-1608.33"/>
<text text-anchor="middle" x="4985" y="-1593.13" font-family="Times,serif" font-size="14.00">Layer Norm 0 Part 1</text>
<text text-anchor="middle" x="4985" y="-1578.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4985" y="-1563.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4985" y="-1548.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- pos_enc_1&#45;&gt;layer_norm_0_1 -->
<g id="edge24" class="edge">
<title>pos_enc_1&#45;&gt;layer_norm_0_1</title>
<path fill="none" stroke="black" d="M5068,-1644.28C5068,-1644.28 5068,-1618.46 5068,-1618.46"/>
<polygon fill="black" stroke="black" points="5071.5,-1618.46 5068,-1608.46 5064.5,-1618.46 5071.5,-1618.46"/>
</g>
<!-- layer_norm_0_2 -->
<g id="node20" class="node">
<title>layer_norm_0_2</title>
<polygon fill="lightblue" stroke="black" points="6056,-1608.33 5658,-1608.33 5658,-1540.33 6056,-1540.33 6056,-1608.33"/>
<text text-anchor="middle" x="5857" y="-1593.13" font-family="Times,serif" font-size="14.00">Layer Norm 0 Part 2</text>
<text text-anchor="middle" x="5857" y="-1578.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5857" y="-1563.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5857" y="-1548.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- pos_enc_2&#45;&gt;layer_norm_0_2 -->
<g id="edge31" class="edge">
<title>pos_enc_2&#45;&gt;layer_norm_0_2</title>
<path fill="none" stroke="black" d="M6049.5,-1644.28C6049.5,-1644.28 6049.5,-1618.46 6049.5,-1618.46"/>
<polygon fill="black" stroke="black" points="6053,-1618.46 6049.5,-1608.46 6046,-1618.46 6053,-1618.46"/>
</g>
<!-- layer_norm_0_3 -->
<g id="node21" class="node">
<title>layer_norm_0_3</title>
<polygon fill="lightblue" stroke="black" points="6928,-1608.33 6530,-1608.33 6530,-1540.33 6928,-1540.33 6928,-1608.33"/>
<text text-anchor="middle" x="6729" y="-1593.13" font-family="Times,serif" font-size="14.00">Layer Norm 0 Part 3</text>
<text text-anchor="middle" x="6729" y="-1578.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6729" y="-1563.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6729" y="-1548.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- pos_enc_3&#45;&gt;layer_norm_0_3 -->
<g id="edge38" class="edge">
<title>pos_enc_3&#45;&gt;layer_norm_0_3</title>
<path fill="none" stroke="black" d="M6866.5,-1644.28C6866.5,-1644.28 6866.5,-1618.46 6866.5,-1618.46"/>
<polygon fill="black" stroke="black" points="6870,-1618.46 6866.5,-1608.46 6863,-1618.46 6870,-1618.46"/>
</g>
<!-- layer_norm_0_4 -->
<g id="node22" class="node">
<title>layer_norm_0_4</title>
<polygon fill="lightblue" stroke="black" points="7800,-1608.33 7402,-1608.33 7402,-1540.33 7800,-1540.33 7800,-1608.33"/>
<text text-anchor="middle" x="7601" y="-1593.13" font-family="Times,serif" font-size="14.00">Layer Norm 0 Part 4</text>
<text text-anchor="middle" x="7601" y="-1578.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7601" y="-1563.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7601" y="-1548.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- pos_enc_4&#45;&gt;layer_norm_0_4 -->
<g id="edge45" class="edge">
<title>pos_enc_4&#45;&gt;layer_norm_0_4</title>
<path fill="none" stroke="black" d="M7601.5,-1644.28C7601.5,-1644.28 7601.5,-1618.46 7601.5,-1618.46"/>
<polygon fill="black" stroke="black" points="7605,-1618.46 7601.5,-1608.46 7598,-1618.46 7605,-1618.46"/>
</g>
<!-- layer_norm_0_5 -->
<g id="node23" class="node">
<title>layer_norm_0_5</title>
<polygon fill="lightblue" stroke="black" points="8291,-1608.33 7893,-1608.33 7893,-1540.33 8291,-1540.33 8291,-1608.33"/>
<text text-anchor="middle" x="8092" y="-1593.13" font-family="Times,serif" font-size="14.00">Layer Norm 0 Part 5</text>
<text text-anchor="middle" x="8092" y="-1578.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8092" y="-1563.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8092" y="-1548.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- pos_enc_5&#45;&gt;layer_norm_0_5 -->
<g id="edge52" class="edge">
<title>pos_enc_5&#45;&gt;layer_norm_0_5</title>
<path fill="none" stroke="black" d="M8092,-1644.28C8092,-1644.28 8092,-1618.46 8092,-1618.46"/>
<polygon fill="black" stroke="black" points="8095.5,-1618.46 8092,-1608.46 8088.5,-1618.46 8095.5,-1618.46"/>
</g>
<!-- layer_norm_0_6 -->
<g id="node24" class="node">
<title>layer_norm_0_6</title>
<polygon fill="lightblue" stroke="black" points="9108,-1608.33 8710,-1608.33 8710,-1540.33 9108,-1540.33 9108,-1608.33"/>
<text text-anchor="middle" x="8909" y="-1593.13" font-family="Times,serif" font-size="14.00">Layer Norm 0 Part 6</text>
<text text-anchor="middle" x="8909" y="-1578.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8909" y="-1563.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8909" y="-1548.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- pos_enc_6&#45;&gt;layer_norm_0_6 -->
<g id="edge59" class="edge">
<title>pos_enc_6&#45;&gt;layer_norm_0_6</title>
<path fill="none" stroke="black" d="M8854.5,-1644.28C8854.5,-1644.28 8854.5,-1618.46 8854.5,-1618.46"/>
<polygon fill="black" stroke="black" points="8858,-1618.46 8854.5,-1608.46 8851,-1618.46 8858,-1618.46"/>
</g>
<!-- layer_norm_0_7 -->
<g id="node25" class="node">
<title>layer_norm_0_7</title>
<polygon fill="lightblue" stroke="black" points="9980,-1608.33 9582,-1608.33 9582,-1540.33 9980,-1540.33 9980,-1608.33"/>
<text text-anchor="middle" x="9781" y="-1593.13" font-family="Times,serif" font-size="14.00">Layer Norm 0 Part 7</text>
<text text-anchor="middle" x="9781" y="-1578.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9781" y="-1563.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9781" y="-1548.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- pos_enc_7&#45;&gt;layer_norm_0_7 -->
<g id="edge66" class="edge">
<title>pos_enc_7&#45;&gt;layer_norm_0_7</title>
<path fill="none" stroke="black" d="M9699,-1644.28C9699,-1644.28 9699,-1618.46 9699,-1618.46"/>
<polygon fill="black" stroke="black" points="9702.5,-1618.46 9699,-1608.46 9695.5,-1618.46 9702.5,-1618.46"/>
</g>
<!-- ffn_gate_0_0 -->
<g id="node50" class="node">
<title>ffn_gate_0_0</title>
<polygon fill="lightblue" stroke="black" points="10853,-1504.33 10453,-1504.33 10453,-1436.33 10853,-1436.33 10853,-1504.33"/>
<text text-anchor="middle" x="10653" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Gate 0 Part 0</text>
<text text-anchor="middle" x="10653" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10653" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10653" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_0_0&#45;&gt;ffn_gate_0_0 -->
<g id="edge18" class="edge">
<title>layer_norm_0_0&#45;&gt;ffn_gate_0_0</title>
<path fill="none" stroke="black" d="M10653,-1540.28C10653,-1540.28 10653,-1514.46 10653,-1514.46"/>
<polygon fill="black" stroke="black" points="10656.5,-1514.46 10653,-1504.46 10649.5,-1514.46 10656.5,-1514.46"/>
</g>
<!-- ffn_up_0_0 -->
<g id="node58" class="node">
<title>ffn_up_0_0</title>
<polygon fill="lightblue" stroke="black" points="11289,-1504.33 10889,-1504.33 10889,-1436.33 11289,-1436.33 11289,-1504.33"/>
<text text-anchor="middle" x="11089" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Up 0 Part 0</text>
<text text-anchor="middle" x="11089" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="11089" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="11089" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_0_0&#45;&gt;ffn_up_0_0 -->
<g id="edge19" class="edge">
<title>layer_norm_0_0&#45;&gt;ffn_up_0_0</title>
<path fill="none" stroke="black" d="M10852.18,-1574C10967.08,-1574 11089,-1574 11089,-1574 11089,-1574 11089,-1514.56 11089,-1514.56"/>
<polygon fill="black" stroke="black" points="11092.5,-1514.56 11089,-1504.56 11085.5,-1514.56 11092.5,-1514.56"/>
</g>
<!-- ffn_gate_0_1 -->
<g id="node51" class="node">
<title>ffn_gate_0_1</title>
<polygon fill="lightblue" stroke="black" points="4749,-1504.33 4349,-1504.33 4349,-1436.33 4749,-1436.33 4749,-1504.33"/>
<text text-anchor="middle" x="4549" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Gate 0 Part 1</text>
<text text-anchor="middle" x="4549" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4549" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="4549" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_norm_0_1&#45;&gt;ffn_gate_0_1 -->
<g id="edge25" class="edge">
<title>layer_norm_0_1&#45;&gt;ffn_gate_0_1</title>
<path fill="none" stroke="black" d="M4785.82,-1574C4670.92,-1574 4549,-1574 4549,-1574 4549,-1574 4549,-1514.56 4549,-1514.56"/>
<polygon fill="black" stroke="black" points="4552.5,-1514.56 4549,-1504.56 4545.5,-1514.56 4552.5,-1514.56"/>
</g>
<!-- ffn_up_0_1 -->
<g id="node59" class="node">
<title>ffn_up_0_1</title>
<polygon fill="lightblue" stroke="black" points="5185,-1504.33 4785,-1504.33 4785,-1436.33 5185,-1436.33 5185,-1504.33"/>
<text text-anchor="middle" x="4985" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Up 0 Part 1</text>
<text text-anchor="middle" x="4985" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4985" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="4985" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_norm_0_1&#45;&gt;ffn_up_0_1 -->
<g id="edge26" class="edge">
<title>layer_norm_0_1&#45;&gt;ffn_up_0_1</title>
<path fill="none" stroke="black" d="M4985,-1540.28C4985,-1540.28 4985,-1514.46 4985,-1514.46"/>
<polygon fill="black" stroke="black" points="4988.5,-1514.46 4985,-1504.46 4981.5,-1514.46 4988.5,-1514.46"/>
</g>
<!-- ffn_gate_0_2 -->
<g id="node52" class="node">
<title>ffn_gate_0_2</title>
<polygon fill="lightblue" stroke="black" points="5621,-1504.33 5221,-1504.33 5221,-1436.33 5621,-1436.33 5621,-1504.33"/>
<text text-anchor="middle" x="5421" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Gate 0 Part 2</text>
<text text-anchor="middle" x="5421" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5421" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="5421" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_norm_0_2&#45;&gt;ffn_gate_0_2 -->
<g id="edge32" class="edge">
<title>layer_norm_0_2&#45;&gt;ffn_gate_0_2</title>
<path fill="none" stroke="black" d="M5657.93,-1574C5569.7,-1574 5485.5,-1574 5485.5,-1574 5485.5,-1574 5485.5,-1514.56 5485.5,-1514.56"/>
<polygon fill="black" stroke="black" points="5489,-1514.56 5485.5,-1504.56 5482,-1514.56 5489,-1514.56"/>
</g>
<!-- ffn_up_0_2 -->
<g id="node60" class="node">
<title>ffn_up_0_2</title>
<polygon fill="lightblue" stroke="black" points="6057,-1504.33 5657,-1504.33 5657,-1436.33 6057,-1436.33 6057,-1504.33"/>
<text text-anchor="middle" x="5857" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Up 0 Part 2</text>
<text text-anchor="middle" x="5857" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5857" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="5857" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_norm_0_2&#45;&gt;ffn_up_0_2 -->
<g id="edge33" class="edge">
<title>layer_norm_0_2&#45;&gt;ffn_up_0_2</title>
<path fill="none" stroke="black" d="M5857,-1540.28C5857,-1540.28 5857,-1514.46 5857,-1514.46"/>
<polygon fill="black" stroke="black" points="5860.5,-1514.46 5857,-1504.46 5853.5,-1514.46 5860.5,-1514.46"/>
</g>
<!-- ffn_gate_0_3 -->
<g id="node53" class="node">
<title>ffn_gate_0_3</title>
<polygon fill="lightblue" stroke="black" points="6493,-1504.33 6093,-1504.33 6093,-1436.33 6493,-1436.33 6493,-1504.33"/>
<text text-anchor="middle" x="6293" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Gate 0 Part 3</text>
<text text-anchor="middle" x="6293" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6293" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="6293" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_norm_0_3&#45;&gt;ffn_gate_0_3 -->
<g id="edge39" class="edge">
<title>layer_norm_0_3&#45;&gt;ffn_gate_0_3</title>
<path fill="none" stroke="black" d="M6529.76,-1574C6493.55,-1574 6467,-1574 6467,-1574 6467,-1574 6467,-1514.56 6467,-1514.56"/>
<polygon fill="black" stroke="black" points="6470.5,-1514.56 6467,-1504.56 6463.5,-1514.56 6470.5,-1514.56"/>
</g>
<!-- ffn_up_0_3 -->
<g id="node61" class="node">
<title>ffn_up_0_3</title>
<polygon fill="lightblue" stroke="black" points="6929,-1504.33 6529,-1504.33 6529,-1436.33 6929,-1436.33 6929,-1504.33"/>
<text text-anchor="middle" x="6729" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Up 0 Part 3</text>
<text text-anchor="middle" x="6729" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6729" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="6729" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_norm_0_3&#45;&gt;ffn_up_0_3 -->
<g id="edge40" class="edge">
<title>layer_norm_0_3&#45;&gt;ffn_up_0_3</title>
<path fill="none" stroke="black" d="M6729,-1540.28C6729,-1540.28 6729,-1514.46 6729,-1514.46"/>
<polygon fill="black" stroke="black" points="6732.5,-1514.46 6729,-1504.46 6725.5,-1514.46 6732.5,-1514.46"/>
</g>
<!-- ffn_gate_0_4 -->
<g id="node54" class="node">
<title>ffn_gate_0_4</title>
<polygon fill="lightblue" stroke="black" points="7365,-1504.33 6965,-1504.33 6965,-1436.33 7365,-1436.33 7365,-1504.33"/>
<text text-anchor="middle" x="7165" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Gate 0 Part 4</text>
<text text-anchor="middle" x="7165" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7165" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="7165" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_norm_0_4&#45;&gt;ffn_gate_0_4 -->
<g id="edge46" class="edge">
<title>layer_norm_0_4&#45;&gt;ffn_gate_0_4</title>
<path fill="none" stroke="black" d="M7401.59,-1574C7338.09,-1574 7284,-1574 7284,-1574 7284,-1574 7284,-1514.56 7284,-1514.56"/>
<polygon fill="black" stroke="black" points="7287.5,-1514.56 7284,-1504.56 7280.5,-1514.56 7287.5,-1514.56"/>
</g>
<!-- ffn_up_0_4 -->
<g id="node62" class="node">
<title>ffn_up_0_4</title>
<polygon fill="lightblue" stroke="black" points="7801,-1504.33 7401,-1504.33 7401,-1436.33 7801,-1436.33 7801,-1504.33"/>
<text text-anchor="middle" x="7601" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Up 0 Part 4</text>
<text text-anchor="middle" x="7601" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7601" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="7601" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_norm_0_4&#45;&gt;ffn_up_0_4 -->
<g id="edge47" class="edge">
<title>layer_norm_0_4&#45;&gt;ffn_up_0_4</title>
<path fill="none" stroke="black" d="M7601,-1540.28C7601,-1540.28 7601,-1514.46 7601,-1514.46"/>
<polygon fill="black" stroke="black" points="7604.5,-1514.46 7601,-1504.46 7597.5,-1514.46 7604.5,-1514.46"/>
</g>
<!-- ffn_gate_0_5 -->
<g id="node55" class="node">
<title>ffn_gate_0_5</title>
<polygon fill="lightblue" stroke="black" points="8237,-1504.33 7837,-1504.33 7837,-1436.33 8237,-1436.33 8237,-1504.33"/>
<text text-anchor="middle" x="8037" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Gate 0 Part 5</text>
<text text-anchor="middle" x="8037" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8037" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8037" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_norm_0_5&#45;&gt;ffn_gate_0_5 -->
<g id="edge53" class="edge">
<title>layer_norm_0_5&#45;&gt;ffn_gate_0_5</title>
<path fill="none" stroke="black" d="M8065,-1540.28C8065,-1540.28 8065,-1514.46 8065,-1514.46"/>
<polygon fill="black" stroke="black" points="8068.5,-1514.46 8065,-1504.46 8061.5,-1514.46 8068.5,-1514.46"/>
</g>
<!-- ffn_up_0_5 -->
<g id="node63" class="node">
<title>ffn_up_0_5</title>
<polygon fill="lightblue" stroke="black" points="8673,-1504.33 8273,-1504.33 8273,-1436.33 8673,-1436.33 8673,-1504.33"/>
<text text-anchor="middle" x="8473" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Up 0 Part 5</text>
<text text-anchor="middle" x="8473" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8473" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8473" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_norm_0_5&#45;&gt;ffn_up_0_5 -->
<g id="edge54" class="edge">
<title>layer_norm_0_5&#45;&gt;ffn_up_0_5</title>
<path fill="none" stroke="black" d="M8282,-1540.28C8282,-1540.28 8282,-1514.46 8282,-1514.46"/>
<polygon fill="black" stroke="black" points="8285.5,-1514.46 8282,-1504.46 8278.5,-1514.46 8285.5,-1514.46"/>
</g>
<!-- ffn_gate_0_6 -->
<g id="node56" class="node">
<title>ffn_gate_0_6</title>
<polygon fill="lightblue" stroke="black" points="9109,-1504.33 8709,-1504.33 8709,-1436.33 9109,-1436.33 9109,-1504.33"/>
<text text-anchor="middle" x="8909" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Gate 0 Part 6</text>
<text text-anchor="middle" x="8909" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8909" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8909" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_norm_0_6&#45;&gt;ffn_gate_0_6 -->
<g id="edge60" class="edge">
<title>layer_norm_0_6&#45;&gt;ffn_gate_0_6</title>
<path fill="none" stroke="black" d="M8909,-1540.28C8909,-1540.28 8909,-1514.46 8909,-1514.46"/>
<polygon fill="black" stroke="black" points="8912.5,-1514.46 8909,-1504.46 8905.5,-1514.46 8912.5,-1514.46"/>
</g>
<!-- ffn_up_0_6 -->
<g id="node64" class="node">
<title>ffn_up_0_6</title>
<polygon fill="lightblue" stroke="black" points="9545,-1504.33 9145,-1504.33 9145,-1436.33 9545,-1436.33 9545,-1504.33"/>
<text text-anchor="middle" x="9345" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Up 0 Part 6</text>
<text text-anchor="middle" x="9345" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9345" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9345" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_norm_0_6&#45;&gt;ffn_up_0_6 -->
<g id="edge61" class="edge">
<title>layer_norm_0_6&#45;&gt;ffn_up_0_6</title>
<path fill="none" stroke="black" d="M9108.27,-1574C9172.07,-1574 9226.5,-1574 9226.5,-1574 9226.5,-1574 9226.5,-1514.56 9226.5,-1514.56"/>
<polygon fill="black" stroke="black" points="9230,-1514.56 9226.5,-1504.56 9223,-1514.56 9230,-1514.56"/>
</g>
<!-- ffn_gate_0_7 -->
<g id="node57" class="node">
<title>ffn_gate_0_7</title>
<polygon fill="lightblue" stroke="black" points="9981,-1504.33 9581,-1504.33 9581,-1436.33 9981,-1436.33 9981,-1504.33"/>
<text text-anchor="middle" x="9781" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Gate 0 Part 7</text>
<text text-anchor="middle" x="9781" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9781" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9781" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_norm_0_7&#45;&gt;ffn_gate_0_7 -->
<g id="edge67" class="edge">
<title>layer_norm_0_7&#45;&gt;ffn_gate_0_7</title>
<path fill="none" stroke="black" d="M9781,-1540.28C9781,-1540.28 9781,-1514.46 9781,-1514.46"/>
<polygon fill="black" stroke="black" points="9784.5,-1514.46 9781,-1504.46 9777.5,-1514.46 9784.5,-1514.46"/>
</g>
<!-- ffn_up_0_7 -->
<g id="node65" class="node">
<title>ffn_up_0_7</title>
<polygon fill="lightblue" stroke="black" points="10417,-1504.33 10017,-1504.33 10017,-1436.33 10417,-1436.33 10417,-1504.33"/>
<text text-anchor="middle" x="10217" y="-1489.13" font-family="Times,serif" font-size="14.00">FFN Up 0 Part 7</text>
<text text-anchor="middle" x="10217" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10217" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10217" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_norm_0_7&#45;&gt;ffn_up_0_7 -->
<g id="edge68" class="edge">
<title>layer_norm_0_7&#45;&gt;ffn_up_0_7</title>
<path fill="none" stroke="black" d="M9980.04,-1574C10030.64,-1574 10071,-1574 10071,-1574 10071,-1574 10071,-1514.56 10071,-1514.56"/>
<polygon fill="black" stroke="black" points="10074.5,-1514.56 10071,-1504.56 10067.5,-1514.56 10074.5,-1514.56"/>
</g>
<!-- layer_norm_1_0 -->
<g id="node26" class="node">
<title>layer_norm_1_0</title>
<polygon fill="lightblue" stroke="black" points="17248,-1504.33 16850,-1504.33 16850,-1436.33 17248,-1436.33 17248,-1504.33"/>
<text text-anchor="middle" x="17049" y="-1489.13" font-family="Times,serif" font-size="14.00">Layer Norm 1 Part 0</text>
<text text-anchor="middle" x="17049" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="17049" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="17049" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_gate_1_0 -->
<g id="node84" class="node">
<title>ffn_gate_1_0</title>
<polygon fill="lightblue" stroke="black" points="17031,-1400.33 16631,-1400.33 16631,-1332.33 17031,-1332.33 17031,-1400.33"/>
<text text-anchor="middle" x="16831" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Gate 1 Part 0</text>
<text text-anchor="middle" x="16831" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="16831" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="16831" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_1_0&#45;&gt;ffn_gate_1_0 -->
<g id="edge75" class="edge">
<title>layer_norm_1_0&#45;&gt;ffn_gate_1_0</title>
<path fill="none" stroke="black" d="M16940.5,-1436.28C16940.5,-1436.28 16940.5,-1410.46 16940.5,-1410.46"/>
<polygon fill="black" stroke="black" points="16944,-1410.46 16940.5,-1400.46 16937,-1410.46 16944,-1410.46"/>
</g>
<!-- ffn_up_1_0 -->
<g id="node92" class="node">
<title>ffn_up_1_0</title>
<polygon fill="lightblue" stroke="black" points="17467,-1400.33 17067,-1400.33 17067,-1332.33 17467,-1332.33 17467,-1400.33"/>
<text text-anchor="middle" x="17267" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Up 1 Part 0</text>
<text text-anchor="middle" x="17267" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="17267" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="17267" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_1_0&#45;&gt;ffn_up_1_0 -->
<g id="edge76" class="edge">
<title>layer_norm_1_0&#45;&gt;ffn_up_1_0</title>
<path fill="none" stroke="black" d="M17157.5,-1436.28C17157.5,-1436.28 17157.5,-1410.46 17157.5,-1410.46"/>
<polygon fill="black" stroke="black" points="17161,-1410.46 17157.5,-1400.46 17154,-1410.46 17161,-1410.46"/>
</g>
<!-- layer_norm_1_1 -->
<g id="node27" class="node">
<title>layer_norm_1_1</title>
<polygon fill="lightblue" stroke="black" points="18120,-1504.33 17722,-1504.33 17722,-1436.33 18120,-1436.33 18120,-1504.33"/>
<text text-anchor="middle" x="17921" y="-1489.13" font-family="Times,serif" font-size="14.00">Layer Norm 1 Part 1</text>
<text text-anchor="middle" x="17921" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="17921" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="17921" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_gate_1_1 -->
<g id="node85" class="node">
<title>ffn_gate_1_1</title>
<polygon fill="lightblue" stroke="black" points="17903,-1400.33 17503,-1400.33 17503,-1332.33 17903,-1332.33 17903,-1400.33"/>
<text text-anchor="middle" x="17703" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Gate 1 Part 1</text>
<text text-anchor="middle" x="17703" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="17703" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="17703" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_norm_1_1&#45;&gt;ffn_gate_1_1 -->
<g id="edge81" class="edge">
<title>layer_norm_1_1&#45;&gt;ffn_gate_1_1</title>
<path fill="none" stroke="black" d="M17812.5,-1436.28C17812.5,-1436.28 17812.5,-1410.46 17812.5,-1410.46"/>
<polygon fill="black" stroke="black" points="17816,-1410.46 17812.5,-1400.46 17809,-1410.46 17816,-1410.46"/>
</g>
<!-- ffn_up_1_1 -->
<g id="node93" class="node">
<title>ffn_up_1_1</title>
<polygon fill="lightblue" stroke="black" points="18339,-1400.33 17939,-1400.33 17939,-1332.33 18339,-1332.33 18339,-1400.33"/>
<text text-anchor="middle" x="18139" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Up 1 Part 1</text>
<text text-anchor="middle" x="18139" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="18139" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="18139" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_norm_1_1&#45;&gt;ffn_up_1_1 -->
<g id="edge82" class="edge">
<title>layer_norm_1_1&#45;&gt;ffn_up_1_1</title>
<path fill="none" stroke="black" d="M18029.5,-1436.28C18029.5,-1436.28 18029.5,-1410.46 18029.5,-1410.46"/>
<polygon fill="black" stroke="black" points="18033,-1410.46 18029.5,-1400.46 18026,-1410.46 18033,-1410.46"/>
</g>
<!-- layer_norm_1_2 -->
<g id="node28" class="node">
<title>layer_norm_1_2</title>
<polygon fill="lightblue" stroke="black" points="12016,-1504.33 11618,-1504.33 11618,-1436.33 12016,-1436.33 12016,-1504.33"/>
<text text-anchor="middle" x="11817" y="-1489.13" font-family="Times,serif" font-size="14.00">Layer Norm 1 Part 2</text>
<text text-anchor="middle" x="11817" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="11817" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="11817" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_gate_1_2 -->
<g id="node86" class="node">
<title>ffn_gate_1_2</title>
<polygon fill="lightblue" stroke="black" points="11799,-1400.33 11399,-1400.33 11399,-1332.33 11799,-1332.33 11799,-1400.33"/>
<text text-anchor="middle" x="11599" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Gate 1 Part 2</text>
<text text-anchor="middle" x="11599" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="11599" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="11599" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_norm_1_2&#45;&gt;ffn_gate_1_2 -->
<g id="edge87" class="edge">
<title>layer_norm_1_2&#45;&gt;ffn_gate_1_2</title>
<path fill="none" stroke="black" d="M11708.5,-1436.28C11708.5,-1436.28 11708.5,-1410.46 11708.5,-1410.46"/>
<polygon fill="black" stroke="black" points="11712,-1410.46 11708.5,-1400.46 11705,-1410.46 11712,-1410.46"/>
</g>
<!-- ffn_up_1_2 -->
<g id="node94" class="node">
<title>ffn_up_1_2</title>
<polygon fill="lightblue" stroke="black" points="12235,-1400.33 11835,-1400.33 11835,-1332.33 12235,-1332.33 12235,-1400.33"/>
<text text-anchor="middle" x="12035" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Up 1 Part 2</text>
<text text-anchor="middle" x="12035" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="12035" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="12035" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_norm_1_2&#45;&gt;ffn_up_1_2 -->
<g id="edge88" class="edge">
<title>layer_norm_1_2&#45;&gt;ffn_up_1_2</title>
<path fill="none" stroke="black" d="M11925.5,-1436.28C11925.5,-1436.28 11925.5,-1410.46 11925.5,-1410.46"/>
<polygon fill="black" stroke="black" points="11929,-1410.46 11925.5,-1400.46 11922,-1410.46 11929,-1410.46"/>
</g>
<!-- layer_norm_1_3 -->
<g id="node29" class="node">
<title>layer_norm_1_3</title>
<polygon fill="lightblue" stroke="black" points="12888,-1504.33 12490,-1504.33 12490,-1436.33 12888,-1436.33 12888,-1504.33"/>
<text text-anchor="middle" x="12689" y="-1489.13" font-family="Times,serif" font-size="14.00">Layer Norm 1 Part 3</text>
<text text-anchor="middle" x="12689" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="12689" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="12689" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_gate_1_3 -->
<g id="node87" class="node">
<title>ffn_gate_1_3</title>
<polygon fill="lightblue" stroke="black" points="12671,-1400.33 12271,-1400.33 12271,-1332.33 12671,-1332.33 12671,-1400.33"/>
<text text-anchor="middle" x="12471" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Gate 1 Part 3</text>
<text text-anchor="middle" x="12471" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="12471" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="12471" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_norm_1_3&#45;&gt;ffn_gate_1_3 -->
<g id="edge93" class="edge">
<title>layer_norm_1_3&#45;&gt;ffn_gate_1_3</title>
<path fill="none" stroke="black" d="M12580.5,-1436.28C12580.5,-1436.28 12580.5,-1410.46 12580.5,-1410.46"/>
<polygon fill="black" stroke="black" points="12584,-1410.46 12580.5,-1400.46 12577,-1410.46 12584,-1410.46"/>
</g>
<!-- ffn_up_1_3 -->
<g id="node95" class="node">
<title>ffn_up_1_3</title>
<polygon fill="lightblue" stroke="black" points="13107,-1400.33 12707,-1400.33 12707,-1332.33 13107,-1332.33 13107,-1400.33"/>
<text text-anchor="middle" x="12907" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Up 1 Part 3</text>
<text text-anchor="middle" x="12907" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="12907" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="12907" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_norm_1_3&#45;&gt;ffn_up_1_3 -->
<g id="edge94" class="edge">
<title>layer_norm_1_3&#45;&gt;ffn_up_1_3</title>
<path fill="none" stroke="black" d="M12797.5,-1436.28C12797.5,-1436.28 12797.5,-1410.46 12797.5,-1410.46"/>
<polygon fill="black" stroke="black" points="12801,-1410.46 12797.5,-1400.46 12794,-1410.46 12801,-1410.46"/>
</g>
<!-- layer_norm_1_4 -->
<g id="node30" class="node">
<title>layer_norm_1_4</title>
<polygon fill="lightblue" stroke="black" points="13760,-1504.33 13362,-1504.33 13362,-1436.33 13760,-1436.33 13760,-1504.33"/>
<text text-anchor="middle" x="13561" y="-1489.13" font-family="Times,serif" font-size="14.00">Layer Norm 1 Part 4</text>
<text text-anchor="middle" x="13561" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="13561" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="13561" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_gate_1_4 -->
<g id="node88" class="node">
<title>ffn_gate_1_4</title>
<polygon fill="lightblue" stroke="black" points="13543,-1400.33 13143,-1400.33 13143,-1332.33 13543,-1332.33 13543,-1400.33"/>
<text text-anchor="middle" x="13343" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Gate 1 Part 4</text>
<text text-anchor="middle" x="13343" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="13343" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="13343" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_norm_1_4&#45;&gt;ffn_gate_1_4 -->
<g id="edge99" class="edge">
<title>layer_norm_1_4&#45;&gt;ffn_gate_1_4</title>
<path fill="none" stroke="black" d="M13452.5,-1436.28C13452.5,-1436.28 13452.5,-1410.46 13452.5,-1410.46"/>
<polygon fill="black" stroke="black" points="13456,-1410.46 13452.5,-1400.46 13449,-1410.46 13456,-1410.46"/>
</g>
<!-- ffn_up_1_4 -->
<g id="node96" class="node">
<title>ffn_up_1_4</title>
<polygon fill="lightblue" stroke="black" points="13979,-1400.33 13579,-1400.33 13579,-1332.33 13979,-1332.33 13979,-1400.33"/>
<text text-anchor="middle" x="13779" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Up 1 Part 4</text>
<text text-anchor="middle" x="13779" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="13779" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="13779" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_norm_1_4&#45;&gt;ffn_up_1_4 -->
<g id="edge100" class="edge">
<title>layer_norm_1_4&#45;&gt;ffn_up_1_4</title>
<path fill="none" stroke="black" d="M13669.5,-1436.28C13669.5,-1436.28 13669.5,-1410.46 13669.5,-1410.46"/>
<polygon fill="black" stroke="black" points="13673,-1410.46 13669.5,-1400.46 13666,-1410.46 13673,-1410.46"/>
</g>
<!-- layer_norm_1_5 -->
<g id="node31" class="node">
<title>layer_norm_1_5</title>
<polygon fill="lightblue" stroke="black" points="14632,-1504.33 14234,-1504.33 14234,-1436.33 14632,-1436.33 14632,-1504.33"/>
<text text-anchor="middle" x="14433" y="-1489.13" font-family="Times,serif" font-size="14.00">Layer Norm 1 Part 5</text>
<text text-anchor="middle" x="14433" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="14433" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="14433" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_gate_1_5 -->
<g id="node89" class="node">
<title>ffn_gate_1_5</title>
<polygon fill="lightblue" stroke="black" points="14415,-1400.33 14015,-1400.33 14015,-1332.33 14415,-1332.33 14415,-1400.33"/>
<text text-anchor="middle" x="14215" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Gate 1 Part 5</text>
<text text-anchor="middle" x="14215" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="14215" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="14215" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_norm_1_5&#45;&gt;ffn_gate_1_5 -->
<g id="edge105" class="edge">
<title>layer_norm_1_5&#45;&gt;ffn_gate_1_5</title>
<path fill="none" stroke="black" d="M14324.5,-1436.28C14324.5,-1436.28 14324.5,-1410.46 14324.5,-1410.46"/>
<polygon fill="black" stroke="black" points="14328,-1410.46 14324.5,-1400.46 14321,-1410.46 14328,-1410.46"/>
</g>
<!-- ffn_up_1_5 -->
<g id="node97" class="node">
<title>ffn_up_1_5</title>
<polygon fill="lightblue" stroke="black" points="14851,-1400.33 14451,-1400.33 14451,-1332.33 14851,-1332.33 14851,-1400.33"/>
<text text-anchor="middle" x="14651" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Up 1 Part 5</text>
<text text-anchor="middle" x="14651" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="14651" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="14651" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_norm_1_5&#45;&gt;ffn_up_1_5 -->
<g id="edge106" class="edge">
<title>layer_norm_1_5&#45;&gt;ffn_up_1_5</title>
<path fill="none" stroke="black" d="M14541.5,-1436.28C14541.5,-1436.28 14541.5,-1410.46 14541.5,-1410.46"/>
<polygon fill="black" stroke="black" points="14545,-1410.46 14541.5,-1400.46 14538,-1410.46 14545,-1410.46"/>
</g>
<!-- layer_norm_1_6 -->
<g id="node32" class="node">
<title>layer_norm_1_6</title>
<polygon fill="lightblue" stroke="black" points="15504,-1504.33 15106,-1504.33 15106,-1436.33 15504,-1436.33 15504,-1504.33"/>
<text text-anchor="middle" x="15305" y="-1489.13" font-family="Times,serif" font-size="14.00">Layer Norm 1 Part 6</text>
<text text-anchor="middle" x="15305" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="15305" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="15305" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_gate_1_6 -->
<g id="node90" class="node">
<title>ffn_gate_1_6</title>
<polygon fill="lightblue" stroke="black" points="15287,-1400.33 14887,-1400.33 14887,-1332.33 15287,-1332.33 15287,-1400.33"/>
<text text-anchor="middle" x="15087" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Gate 1 Part 6</text>
<text text-anchor="middle" x="15087" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="15087" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="15087" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_norm_1_6&#45;&gt;ffn_gate_1_6 -->
<g id="edge111" class="edge">
<title>layer_norm_1_6&#45;&gt;ffn_gate_1_6</title>
<path fill="none" stroke="black" d="M15196.5,-1436.28C15196.5,-1436.28 15196.5,-1410.46 15196.5,-1410.46"/>
<polygon fill="black" stroke="black" points="15200,-1410.46 15196.5,-1400.46 15193,-1410.46 15200,-1410.46"/>
</g>
<!-- ffn_up_1_6 -->
<g id="node98" class="node">
<title>ffn_up_1_6</title>
<polygon fill="lightblue" stroke="black" points="15723,-1400.33 15323,-1400.33 15323,-1332.33 15723,-1332.33 15723,-1400.33"/>
<text text-anchor="middle" x="15523" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Up 1 Part 6</text>
<text text-anchor="middle" x="15523" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="15523" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="15523" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_norm_1_6&#45;&gt;ffn_up_1_6 -->
<g id="edge112" class="edge">
<title>layer_norm_1_6&#45;&gt;ffn_up_1_6</title>
<path fill="none" stroke="black" d="M15413.5,-1436.28C15413.5,-1436.28 15413.5,-1410.46 15413.5,-1410.46"/>
<polygon fill="black" stroke="black" points="15417,-1410.46 15413.5,-1400.46 15410,-1410.46 15417,-1410.46"/>
</g>
<!-- layer_norm_1_7 -->
<g id="node33" class="node">
<title>layer_norm_1_7</title>
<polygon fill="lightblue" stroke="black" points="16376,-1504.33 15978,-1504.33 15978,-1436.33 16376,-1436.33 16376,-1504.33"/>
<text text-anchor="middle" x="16177" y="-1489.13" font-family="Times,serif" font-size="14.00">Layer Norm 1 Part 7</text>
<text text-anchor="middle" x="16177" y="-1474.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="16177" y="-1459.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="16177" y="-1444.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_gate_1_7 -->
<g id="node91" class="node">
<title>ffn_gate_1_7</title>
<polygon fill="lightblue" stroke="black" points="16159,-1400.33 15759,-1400.33 15759,-1332.33 16159,-1332.33 16159,-1400.33"/>
<text text-anchor="middle" x="15959" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Gate 1 Part 7</text>
<text text-anchor="middle" x="15959" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="15959" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="15959" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_norm_1_7&#45;&gt;ffn_gate_1_7 -->
<g id="edge117" class="edge">
<title>layer_norm_1_7&#45;&gt;ffn_gate_1_7</title>
<path fill="none" stroke="black" d="M16068.5,-1436.28C16068.5,-1436.28 16068.5,-1410.46 16068.5,-1410.46"/>
<polygon fill="black" stroke="black" points="16072,-1410.46 16068.5,-1400.46 16065,-1410.46 16072,-1410.46"/>
</g>
<!-- ffn_up_1_7 -->
<g id="node99" class="node">
<title>ffn_up_1_7</title>
<polygon fill="lightblue" stroke="black" points="16595,-1400.33 16195,-1400.33 16195,-1332.33 16595,-1332.33 16595,-1400.33"/>
<text text-anchor="middle" x="16395" y="-1385.13" font-family="Times,serif" font-size="14.00">FFN Up 1 Part 7</text>
<text text-anchor="middle" x="16395" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="16395" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="16395" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_norm_1_7&#45;&gt;ffn_up_1_7 -->
<g id="edge118" class="edge">
<title>layer_norm_1_7&#45;&gt;ffn_up_1_7</title>
<path fill="none" stroke="black" d="M16285.5,-1436.28C16285.5,-1436.28 16285.5,-1410.46 16285.5,-1410.46"/>
<polygon fill="black" stroke="black" points="16289,-1410.46 16285.5,-1400.46 16282,-1410.46 16289,-1410.46"/>
</g>
<!-- layer_norm_2_0 -->
<g id="node34" class="node">
<title>layer_norm_2_0</title>
<polygon fill="lightblue" stroke="black" points="23787,-1400.33 23389,-1400.33 23389,-1332.33 23787,-1332.33 23787,-1400.33"/>
<text text-anchor="middle" x="23588" y="-1385.13" font-family="Times,serif" font-size="14.00">Layer Norm 2 Part 0</text>
<text text-anchor="middle" x="23588" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="23588" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="23588" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_gate_2_0 -->
<g id="node118" class="node">
<title>ffn_gate_2_0</title>
<polygon fill="lightblue" stroke="black" points="23570,-1296.33 23170,-1296.33 23170,-1228.33 23570,-1228.33 23570,-1296.33"/>
<text text-anchor="middle" x="23370" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Gate 2 Part 0</text>
<text text-anchor="middle" x="23370" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="23370" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="23370" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_2_0&#45;&gt;ffn_gate_2_0 -->
<g id="edge125" class="edge">
<title>layer_norm_2_0&#45;&gt;ffn_gate_2_0</title>
<path fill="none" stroke="black" d="M23479.5,-1332.28C23479.5,-1332.28 23479.5,-1306.46 23479.5,-1306.46"/>
<polygon fill="black" stroke="black" points="23483,-1306.46 23479.5,-1296.46 23476,-1306.46 23483,-1306.46"/>
</g>
<!-- ffn_up_2_0 -->
<g id="node126" class="node">
<title>ffn_up_2_0</title>
<polygon fill="lightblue" stroke="black" points="24006,-1296.33 23606,-1296.33 23606,-1228.33 24006,-1228.33 24006,-1296.33"/>
<text text-anchor="middle" x="23806" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Up 2 Part 0</text>
<text text-anchor="middle" x="23806" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="23806" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="23806" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_2_0&#45;&gt;ffn_up_2_0 -->
<g id="edge126" class="edge">
<title>layer_norm_2_0&#45;&gt;ffn_up_2_0</title>
<path fill="none" stroke="black" d="M23696.5,-1332.28C23696.5,-1332.28 23696.5,-1306.46 23696.5,-1306.46"/>
<polygon fill="black" stroke="black" points="23700,-1306.46 23696.5,-1296.46 23693,-1306.46 23700,-1306.46"/>
</g>
<!-- layer_norm_2_1 -->
<g id="node35" class="node">
<title>layer_norm_2_1</title>
<polygon fill="lightblue" stroke="black" points="24659,-1400.33 24261,-1400.33 24261,-1332.33 24659,-1332.33 24659,-1400.33"/>
<text text-anchor="middle" x="24460" y="-1385.13" font-family="Times,serif" font-size="14.00">Layer Norm 2 Part 1</text>
<text text-anchor="middle" x="24460" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="24460" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="24460" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_gate_2_1 -->
<g id="node119" class="node">
<title>ffn_gate_2_1</title>
<polygon fill="lightblue" stroke="black" points="24442,-1296.33 24042,-1296.33 24042,-1228.33 24442,-1228.33 24442,-1296.33"/>
<text text-anchor="middle" x="24242" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Gate 2 Part 1</text>
<text text-anchor="middle" x="24242" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="24242" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="24242" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_norm_2_1&#45;&gt;ffn_gate_2_1 -->
<g id="edge131" class="edge">
<title>layer_norm_2_1&#45;&gt;ffn_gate_2_1</title>
<path fill="none" stroke="black" d="M24351.5,-1332.28C24351.5,-1332.28 24351.5,-1306.46 24351.5,-1306.46"/>
<polygon fill="black" stroke="black" points="24355,-1306.46 24351.5,-1296.46 24348,-1306.46 24355,-1306.46"/>
</g>
<!-- ffn_up_2_1 -->
<g id="node127" class="node">
<title>ffn_up_2_1</title>
<polygon fill="lightblue" stroke="black" points="24878,-1296.33 24478,-1296.33 24478,-1228.33 24878,-1228.33 24878,-1296.33"/>
<text text-anchor="middle" x="24678" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Up 2 Part 1</text>
<text text-anchor="middle" x="24678" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="24678" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="24678" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_norm_2_1&#45;&gt;ffn_up_2_1 -->
<g id="edge132" class="edge">
<title>layer_norm_2_1&#45;&gt;ffn_up_2_1</title>
<path fill="none" stroke="black" d="M24568.5,-1332.28C24568.5,-1332.28 24568.5,-1306.46 24568.5,-1306.46"/>
<polygon fill="black" stroke="black" points="24572,-1306.46 24568.5,-1296.46 24565,-1306.46 24572,-1306.46"/>
</g>
<!-- layer_norm_2_2 -->
<g id="node36" class="node">
<title>layer_norm_2_2</title>
<polygon fill="lightblue" stroke="black" points="18773,-1400.33 18375,-1400.33 18375,-1332.33 18773,-1332.33 18773,-1400.33"/>
<text text-anchor="middle" x="18574" y="-1385.13" font-family="Times,serif" font-size="14.00">Layer Norm 2 Part 2</text>
<text text-anchor="middle" x="18574" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="18574" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="18574" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_gate_2_2 -->
<g id="node120" class="node">
<title>ffn_gate_2_2</title>
<polygon fill="lightblue" stroke="black" points="18338,-1296.33 17938,-1296.33 17938,-1228.33 18338,-1228.33 18338,-1296.33"/>
<text text-anchor="middle" x="18138" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Gate 2 Part 2</text>
<text text-anchor="middle" x="18138" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="18138" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="18138" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_norm_2_2&#45;&gt;ffn_gate_2_2 -->
<g id="edge137" class="edge">
<title>layer_norm_2_2&#45;&gt;ffn_gate_2_2</title>
<path fill="none" stroke="black" d="M18374.67,-1366C18363.37,-1366 18356.5,-1366 18356.5,-1366 18356.5,-1366 18356.5,-1262 18356.5,-1262 18356.5,-1262 18348.25,-1262 18348.25,-1262"/>
<polygon fill="black" stroke="black" points="18348.25,-1258.5 18338.25,-1262 18348.25,-1265.5 18348.25,-1258.5"/>
</g>
<!-- ffn_up_2_2 -->
<g id="node128" class="node">
<title>ffn_up_2_2</title>
<polygon fill="lightblue" stroke="black" points="18774,-1296.33 18374,-1296.33 18374,-1228.33 18774,-1228.33 18774,-1296.33"/>
<text text-anchor="middle" x="18574" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Up 2 Part 2</text>
<text text-anchor="middle" x="18574" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="18574" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="18574" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_norm_2_2&#45;&gt;ffn_up_2_2 -->
<g id="edge138" class="edge">
<title>layer_norm_2_2&#45;&gt;ffn_up_2_2</title>
<path fill="none" stroke="black" d="M18574,-1332.28C18574,-1332.28 18574,-1306.46 18574,-1306.46"/>
<polygon fill="black" stroke="black" points="18577.5,-1306.46 18574,-1296.46 18570.5,-1306.46 18577.5,-1306.46"/>
</g>
<!-- layer_norm_2_3 -->
<g id="node37" class="node">
<title>layer_norm_2_3</title>
<polygon fill="lightblue" stroke="black" points="19427,-1400.33 19029,-1400.33 19029,-1332.33 19427,-1332.33 19427,-1400.33"/>
<text text-anchor="middle" x="19228" y="-1385.13" font-family="Times,serif" font-size="14.00">Layer Norm 2 Part 3</text>
<text text-anchor="middle" x="19228" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="19228" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="19228" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_gate_2_3 -->
<g id="node121" class="node">
<title>ffn_gate_2_3</title>
<polygon fill="lightblue" stroke="black" points="19210,-1296.33 18810,-1296.33 18810,-1228.33 19210,-1228.33 19210,-1296.33"/>
<text text-anchor="middle" x="19010" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Gate 2 Part 3</text>
<text text-anchor="middle" x="19010" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="19010" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="19010" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_norm_2_3&#45;&gt;ffn_gate_2_3 -->
<g id="edge143" class="edge">
<title>layer_norm_2_3&#45;&gt;ffn_gate_2_3</title>
<path fill="none" stroke="black" d="M19119.5,-1332.28C19119.5,-1332.28 19119.5,-1306.46 19119.5,-1306.46"/>
<polygon fill="black" stroke="black" points="19123,-1306.46 19119.5,-1296.46 19116,-1306.46 19123,-1306.46"/>
</g>
<!-- ffn_up_2_3 -->
<g id="node129" class="node">
<title>ffn_up_2_3</title>
<polygon fill="lightblue" stroke="black" points="19646,-1296.33 19246,-1296.33 19246,-1228.33 19646,-1228.33 19646,-1296.33"/>
<text text-anchor="middle" x="19446" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Up 2 Part 3</text>
<text text-anchor="middle" x="19446" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="19446" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="19446" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_norm_2_3&#45;&gt;ffn_up_2_3 -->
<g id="edge144" class="edge">
<title>layer_norm_2_3&#45;&gt;ffn_up_2_3</title>
<path fill="none" stroke="black" d="M19336.5,-1332.28C19336.5,-1332.28 19336.5,-1306.46 19336.5,-1306.46"/>
<polygon fill="black" stroke="black" points="19340,-1306.46 19336.5,-1296.46 19333,-1306.46 19340,-1306.46"/>
</g>
<!-- layer_norm_2_4 -->
<g id="node38" class="node">
<title>layer_norm_2_4</title>
<polygon fill="lightblue" stroke="black" points="20299,-1400.33 19901,-1400.33 19901,-1332.33 20299,-1332.33 20299,-1400.33"/>
<text text-anchor="middle" x="20100" y="-1385.13" font-family="Times,serif" font-size="14.00">Layer Norm 2 Part 4</text>
<text text-anchor="middle" x="20100" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="20100" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="20100" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_gate_2_4 -->
<g id="node122" class="node">
<title>ffn_gate_2_4</title>
<polygon fill="lightblue" stroke="black" points="20082,-1296.33 19682,-1296.33 19682,-1228.33 20082,-1228.33 20082,-1296.33"/>
<text text-anchor="middle" x="19882" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Gate 2 Part 4</text>
<text text-anchor="middle" x="19882" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="19882" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="19882" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_norm_2_4&#45;&gt;ffn_gate_2_4 -->
<g id="edge149" class="edge">
<title>layer_norm_2_4&#45;&gt;ffn_gate_2_4</title>
<path fill="none" stroke="black" d="M19991.5,-1332.28C19991.5,-1332.28 19991.5,-1306.46 19991.5,-1306.46"/>
<polygon fill="black" stroke="black" points="19995,-1306.46 19991.5,-1296.46 19988,-1306.46 19995,-1306.46"/>
</g>
<!-- ffn_up_2_4 -->
<g id="node130" class="node">
<title>ffn_up_2_4</title>
<polygon fill="lightblue" stroke="black" points="20518,-1296.33 20118,-1296.33 20118,-1228.33 20518,-1228.33 20518,-1296.33"/>
<text text-anchor="middle" x="20318" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Up 2 Part 4</text>
<text text-anchor="middle" x="20318" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="20318" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="20318" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_norm_2_4&#45;&gt;ffn_up_2_4 -->
<g id="edge150" class="edge">
<title>layer_norm_2_4&#45;&gt;ffn_up_2_4</title>
<path fill="none" stroke="black" d="M20208.5,-1332.28C20208.5,-1332.28 20208.5,-1306.46 20208.5,-1306.46"/>
<polygon fill="black" stroke="black" points="20212,-1306.46 20208.5,-1296.46 20205,-1306.46 20212,-1306.46"/>
</g>
<!-- layer_norm_2_5 -->
<g id="node39" class="node">
<title>layer_norm_2_5</title>
<polygon fill="lightblue" stroke="black" points="21171,-1400.33 20773,-1400.33 20773,-1332.33 21171,-1332.33 21171,-1400.33"/>
<text text-anchor="middle" x="20972" y="-1385.13" font-family="Times,serif" font-size="14.00">Layer Norm 2 Part 5</text>
<text text-anchor="middle" x="20972" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="20972" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="20972" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_gate_2_5 -->
<g id="node123" class="node">
<title>ffn_gate_2_5</title>
<polygon fill="lightblue" stroke="black" points="20954,-1296.33 20554,-1296.33 20554,-1228.33 20954,-1228.33 20954,-1296.33"/>
<text text-anchor="middle" x="20754" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Gate 2 Part 5</text>
<text text-anchor="middle" x="20754" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="20754" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="20754" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_norm_2_5&#45;&gt;ffn_gate_2_5 -->
<g id="edge155" class="edge">
<title>layer_norm_2_5&#45;&gt;ffn_gate_2_5</title>
<path fill="none" stroke="black" d="M20863.5,-1332.28C20863.5,-1332.28 20863.5,-1306.46 20863.5,-1306.46"/>
<polygon fill="black" stroke="black" points="20867,-1306.46 20863.5,-1296.46 20860,-1306.46 20867,-1306.46"/>
</g>
<!-- ffn_up_2_5 -->
<g id="node131" class="node">
<title>ffn_up_2_5</title>
<polygon fill="lightblue" stroke="black" points="21390,-1296.33 20990,-1296.33 20990,-1228.33 21390,-1228.33 21390,-1296.33"/>
<text text-anchor="middle" x="21190" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Up 2 Part 5</text>
<text text-anchor="middle" x="21190" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="21190" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="21190" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_norm_2_5&#45;&gt;ffn_up_2_5 -->
<g id="edge156" class="edge">
<title>layer_norm_2_5&#45;&gt;ffn_up_2_5</title>
<path fill="none" stroke="black" d="M21080.5,-1332.28C21080.5,-1332.28 21080.5,-1306.46 21080.5,-1306.46"/>
<polygon fill="black" stroke="black" points="21084,-1306.46 21080.5,-1296.46 21077,-1306.46 21084,-1306.46"/>
</g>
<!-- layer_norm_2_6 -->
<g id="node40" class="node">
<title>layer_norm_2_6</title>
<polygon fill="lightblue" stroke="black" points="22043,-1400.33 21645,-1400.33 21645,-1332.33 22043,-1332.33 22043,-1400.33"/>
<text text-anchor="middle" x="21844" y="-1385.13" font-family="Times,serif" font-size="14.00">Layer Norm 2 Part 6</text>
<text text-anchor="middle" x="21844" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="21844" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="21844" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_gate_2_6 -->
<g id="node124" class="node">
<title>ffn_gate_2_6</title>
<polygon fill="lightblue" stroke="black" points="21826,-1296.33 21426,-1296.33 21426,-1228.33 21826,-1228.33 21826,-1296.33"/>
<text text-anchor="middle" x="21626" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Gate 2 Part 6</text>
<text text-anchor="middle" x="21626" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="21626" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="21626" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_norm_2_6&#45;&gt;ffn_gate_2_6 -->
<g id="edge161" class="edge">
<title>layer_norm_2_6&#45;&gt;ffn_gate_2_6</title>
<path fill="none" stroke="black" d="M21735.5,-1332.28C21735.5,-1332.28 21735.5,-1306.46 21735.5,-1306.46"/>
<polygon fill="black" stroke="black" points="21739,-1306.46 21735.5,-1296.46 21732,-1306.46 21739,-1306.46"/>
</g>
<!-- ffn_up_2_6 -->
<g id="node132" class="node">
<title>ffn_up_2_6</title>
<polygon fill="lightblue" stroke="black" points="22262,-1296.33 21862,-1296.33 21862,-1228.33 22262,-1228.33 22262,-1296.33"/>
<text text-anchor="middle" x="22062" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Up 2 Part 6</text>
<text text-anchor="middle" x="22062" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="22062" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="22062" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_norm_2_6&#45;&gt;ffn_up_2_6 -->
<g id="edge162" class="edge">
<title>layer_norm_2_6&#45;&gt;ffn_up_2_6</title>
<path fill="none" stroke="black" d="M21952.5,-1332.28C21952.5,-1332.28 21952.5,-1306.46 21952.5,-1306.46"/>
<polygon fill="black" stroke="black" points="21956,-1306.46 21952.5,-1296.46 21949,-1306.46 21956,-1306.46"/>
</g>
<!-- layer_norm_2_7 -->
<g id="node41" class="node">
<title>layer_norm_2_7</title>
<polygon fill="lightblue" stroke="black" points="22915,-1400.33 22517,-1400.33 22517,-1332.33 22915,-1332.33 22915,-1400.33"/>
<text text-anchor="middle" x="22716" y="-1385.13" font-family="Times,serif" font-size="14.00">Layer Norm 2 Part 7</text>
<text text-anchor="middle" x="22716" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="22716" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="22716" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_gate_2_7 -->
<g id="node125" class="node">
<title>ffn_gate_2_7</title>
<polygon fill="lightblue" stroke="black" points="22698,-1296.33 22298,-1296.33 22298,-1228.33 22698,-1228.33 22698,-1296.33"/>
<text text-anchor="middle" x="22498" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Gate 2 Part 7</text>
<text text-anchor="middle" x="22498" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="22498" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="22498" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_norm_2_7&#45;&gt;ffn_gate_2_7 -->
<g id="edge167" class="edge">
<title>layer_norm_2_7&#45;&gt;ffn_gate_2_7</title>
<path fill="none" stroke="black" d="M22607.5,-1332.28C22607.5,-1332.28 22607.5,-1306.46 22607.5,-1306.46"/>
<polygon fill="black" stroke="black" points="22611,-1306.46 22607.5,-1296.46 22604,-1306.46 22611,-1306.46"/>
</g>
<!-- ffn_up_2_7 -->
<g id="node133" class="node">
<title>ffn_up_2_7</title>
<polygon fill="lightblue" stroke="black" points="23134,-1296.33 22734,-1296.33 22734,-1228.33 23134,-1228.33 23134,-1296.33"/>
<text text-anchor="middle" x="22934" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Up 2 Part 7</text>
<text text-anchor="middle" x="22934" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="22934" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="22934" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_norm_2_7&#45;&gt;ffn_up_2_7 -->
<g id="edge168" class="edge">
<title>layer_norm_2_7&#45;&gt;ffn_up_2_7</title>
<path fill="none" stroke="black" d="M22824.5,-1332.28C22824.5,-1332.28 22824.5,-1306.46 22824.5,-1306.46"/>
<polygon fill="black" stroke="black" points="22828,-1306.46 22824.5,-1296.46 22821,-1306.46 22828,-1306.46"/>
</g>
<!-- layer_norm_3_0 -->
<g id="node42" class="node">
<title>layer_norm_3_0</title>
<polygon fill="lightblue" stroke="black" points="5849,-1296.33 5451,-1296.33 5451,-1228.33 5849,-1228.33 5849,-1296.33"/>
<text text-anchor="middle" x="5650" y="-1281.13" font-family="Times,serif" font-size="14.00">Layer Norm 3 Part 0</text>
<text text-anchor="middle" x="5650" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5650" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5650" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_gate_3_0 -->
<g id="node152" class="node">
<title>ffn_gate_3_0</title>
<polygon fill="lightblue" stroke="black" points="5632,-1158.33 5232,-1158.33 5232,-1090.33 5632,-1090.33 5632,-1158.33"/>
<text text-anchor="middle" x="5432" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Gate 3 Part 0</text>
<text text-anchor="middle" x="5432" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5432" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="5432" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_3_0&#45;&gt;ffn_gate_3_0 -->
<g id="edge175" class="edge">
<title>layer_norm_3_0&#45;&gt;ffn_gate_3_0</title>
<path fill="none" stroke="black" d="M5541.5,-1228.22C5541.5,-1228.22 5541.5,-1168.53 5541.5,-1168.53"/>
<polygon fill="black" stroke="black" points="5545,-1168.53 5541.5,-1158.53 5538,-1168.53 5545,-1168.53"/>
</g>
<!-- ffn_up_3_0 -->
<g id="node160" class="node">
<title>ffn_up_3_0</title>
<polygon fill="lightblue" stroke="black" points="6068,-1158.33 5668,-1158.33 5668,-1090.33 6068,-1090.33 6068,-1158.33"/>
<text text-anchor="middle" x="5868" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Up 3 Part 0</text>
<text text-anchor="middle" x="5868" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5868" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="5868" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- layer_norm_3_0&#45;&gt;ffn_up_3_0 -->
<g id="edge176" class="edge">
<title>layer_norm_3_0&#45;&gt;ffn_up_3_0</title>
<path fill="none" stroke="black" d="M5758.5,-1228.22C5758.5,-1228.22 5758.5,-1168.53 5758.5,-1168.53"/>
<polygon fill="black" stroke="black" points="5762,-1168.53 5758.5,-1158.53 5755,-1168.53 5762,-1168.53"/>
</g>
<!-- layer_norm_3_1 -->
<g id="node43" class="node">
<title>layer_norm_3_1</title>
<polygon fill="lightblue" stroke="black" points="6503,-1296.33 6105,-1296.33 6105,-1228.33 6503,-1228.33 6503,-1296.33"/>
<text text-anchor="middle" x="6304" y="-1281.13" font-family="Times,serif" font-size="14.00">Layer Norm 3 Part 1</text>
<text text-anchor="middle" x="6304" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6304" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6304" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_gate_3_1 -->
<g id="node153" class="node">
<title>ffn_gate_3_1</title>
<polygon fill="lightblue" stroke="black" points="6504,-1158.33 6104,-1158.33 6104,-1090.33 6504,-1090.33 6504,-1158.33"/>
<text text-anchor="middle" x="6304" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Gate 3 Part 1</text>
<text text-anchor="middle" x="6304" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6304" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="6304" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_norm_3_1&#45;&gt;ffn_gate_3_1 -->
<g id="edge181" class="edge">
<title>layer_norm_3_1&#45;&gt;ffn_gate_3_1</title>
<path fill="none" stroke="black" d="M6304,-1228.22C6304,-1228.22 6304,-1168.53 6304,-1168.53"/>
<polygon fill="black" stroke="black" points="6307.5,-1168.53 6304,-1158.53 6300.5,-1168.53 6307.5,-1168.53"/>
</g>
<!-- ffn_up_3_1 -->
<g id="node161" class="node">
<title>ffn_up_3_1</title>
<polygon fill="lightblue" stroke="black" points="6940,-1158.33 6540,-1158.33 6540,-1090.33 6940,-1090.33 6940,-1158.33"/>
<text text-anchor="middle" x="6740" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Up 3 Part 1</text>
<text text-anchor="middle" x="6740" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6740" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="6740" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- layer_norm_3_1&#45;&gt;ffn_up_3_1 -->
<g id="edge182" class="edge">
<title>layer_norm_3_1&#45;&gt;ffn_up_3_1</title>
<path fill="none" stroke="black" d="M6503.21,-1262C6511.57,-1262 6516.5,-1262 6516.5,-1262 6516.5,-1262 6516.5,-1124 6516.5,-1124 6516.5,-1124 6530,-1124 6530,-1124"/>
<polygon fill="black" stroke="black" points="6530,-1127.5 6540,-1124 6530,-1120.5 6530,-1127.5"/>
</g>
<!-- layer_norm_3_2 -->
<g id="node44" class="node">
<title>layer_norm_3_2</title>
<polygon fill="lightblue" stroke="black" points="617,-1296.33 219,-1296.33 219,-1228.33 617,-1228.33 617,-1296.33"/>
<text text-anchor="middle" x="418" y="-1281.13" font-family="Times,serif" font-size="14.00">Layer Norm 3 Part 2</text>
<text text-anchor="middle" x="418" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="418" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="418" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_gate_3_2 -->
<g id="node154" class="node">
<title>ffn_gate_3_2</title>
<polygon fill="lightblue" stroke="black" points="400,-1158.33 0,-1158.33 0,-1090.33 400,-1090.33 400,-1158.33"/>
<text text-anchor="middle" x="200" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Gate 3 Part 2</text>
<text text-anchor="middle" x="200" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="200" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="200" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_norm_3_2&#45;&gt;ffn_gate_3_2 -->
<g id="edge187" class="edge">
<title>layer_norm_3_2&#45;&gt;ffn_gate_3_2</title>
<path fill="none" stroke="black" d="M309.5,-1228.22C309.5,-1228.22 309.5,-1168.53 309.5,-1168.53"/>
<polygon fill="black" stroke="black" points="313,-1168.53 309.5,-1158.53 306,-1168.53 313,-1168.53"/>
</g>
<!-- ffn_up_3_2 -->
<g id="node162" class="node">
<title>ffn_up_3_2</title>
<polygon fill="lightblue" stroke="black" points="836,-1158.33 436,-1158.33 436,-1090.33 836,-1090.33 836,-1158.33"/>
<text text-anchor="middle" x="636" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Up 3 Part 2</text>
<text text-anchor="middle" x="636" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="636" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="636" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- layer_norm_3_2&#45;&gt;ffn_up_3_2 -->
<g id="edge188" class="edge">
<title>layer_norm_3_2&#45;&gt;ffn_up_3_2</title>
<path fill="none" stroke="black" d="M526.5,-1228.22C526.5,-1228.22 526.5,-1168.53 526.5,-1168.53"/>
<polygon fill="black" stroke="black" points="530,-1168.53 526.5,-1158.53 523,-1168.53 530,-1168.53"/>
</g>
<!-- layer_norm_3_3 -->
<g id="node45" class="node">
<title>layer_norm_3_3</title>
<polygon fill="lightblue" stroke="black" points="1489,-1296.33 1091,-1296.33 1091,-1228.33 1489,-1228.33 1489,-1296.33"/>
<text text-anchor="middle" x="1290" y="-1281.13" font-family="Times,serif" font-size="14.00">Layer Norm 3 Part 3</text>
<text text-anchor="middle" x="1290" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1290" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1290" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_gate_3_3 -->
<g id="node155" class="node">
<title>ffn_gate_3_3</title>
<polygon fill="lightblue" stroke="black" points="1272,-1158.33 872,-1158.33 872,-1090.33 1272,-1090.33 1272,-1158.33"/>
<text text-anchor="middle" x="1072" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Gate 3 Part 3</text>
<text text-anchor="middle" x="1072" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1072" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="1072" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_norm_3_3&#45;&gt;ffn_gate_3_3 -->
<g id="edge193" class="edge">
<title>layer_norm_3_3&#45;&gt;ffn_gate_3_3</title>
<path fill="none" stroke="black" d="M1181.5,-1228.22C1181.5,-1228.22 1181.5,-1168.53 1181.5,-1168.53"/>
<polygon fill="black" stroke="black" points="1185,-1168.53 1181.5,-1158.53 1178,-1168.53 1185,-1168.53"/>
</g>
<!-- ffn_up_3_3 -->
<g id="node163" class="node">
<title>ffn_up_3_3</title>
<polygon fill="lightblue" stroke="black" points="1708,-1158.33 1308,-1158.33 1308,-1090.33 1708,-1090.33 1708,-1158.33"/>
<text text-anchor="middle" x="1508" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Up 3 Part 3</text>
<text text-anchor="middle" x="1508" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1508" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="1508" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- layer_norm_3_3&#45;&gt;ffn_up_3_3 -->
<g id="edge194" class="edge">
<title>layer_norm_3_3&#45;&gt;ffn_up_3_3</title>
<path fill="none" stroke="black" d="M1398.5,-1228.22C1398.5,-1228.22 1398.5,-1168.53 1398.5,-1168.53"/>
<polygon fill="black" stroke="black" points="1402,-1168.53 1398.5,-1158.53 1395,-1168.53 1402,-1168.53"/>
</g>
<!-- layer_norm_3_4 -->
<g id="node46" class="node">
<title>layer_norm_3_4</title>
<polygon fill="lightblue" stroke="black" points="2361,-1296.33 1963,-1296.33 1963,-1228.33 2361,-1228.33 2361,-1296.33"/>
<text text-anchor="middle" x="2162" y="-1281.13" font-family="Times,serif" font-size="14.00">Layer Norm 3 Part 4</text>
<text text-anchor="middle" x="2162" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="2162" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="2162" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_gate_3_4 -->
<g id="node156" class="node">
<title>ffn_gate_3_4</title>
<polygon fill="lightblue" stroke="black" points="2144,-1158.33 1744,-1158.33 1744,-1090.33 2144,-1090.33 2144,-1158.33"/>
<text text-anchor="middle" x="1944" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Gate 3 Part 4</text>
<text text-anchor="middle" x="1944" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1944" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="1944" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_norm_3_4&#45;&gt;ffn_gate_3_4 -->
<g id="edge199" class="edge">
<title>layer_norm_3_4&#45;&gt;ffn_gate_3_4</title>
<path fill="none" stroke="black" d="M2053.5,-1228.22C2053.5,-1228.22 2053.5,-1168.53 2053.5,-1168.53"/>
<polygon fill="black" stroke="black" points="2057,-1168.53 2053.5,-1158.53 2050,-1168.53 2057,-1168.53"/>
</g>
<!-- ffn_up_3_4 -->
<g id="node164" class="node">
<title>ffn_up_3_4</title>
<polygon fill="lightblue" stroke="black" points="2580,-1158.33 2180,-1158.33 2180,-1090.33 2580,-1090.33 2580,-1158.33"/>
<text text-anchor="middle" x="2380" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Up 3 Part 4</text>
<text text-anchor="middle" x="2380" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="2380" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="2380" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- layer_norm_3_4&#45;&gt;ffn_up_3_4 -->
<g id="edge200" class="edge">
<title>layer_norm_3_4&#45;&gt;ffn_up_3_4</title>
<path fill="none" stroke="black" d="M2270.5,-1228.22C2270.5,-1228.22 2270.5,-1168.53 2270.5,-1168.53"/>
<polygon fill="black" stroke="black" points="2274,-1168.53 2270.5,-1158.53 2267,-1168.53 2274,-1168.53"/>
</g>
<!-- layer_norm_3_5 -->
<g id="node47" class="node">
<title>layer_norm_3_5</title>
<polygon fill="lightblue" stroke="black" points="3233,-1296.33 2835,-1296.33 2835,-1228.33 3233,-1228.33 3233,-1296.33"/>
<text text-anchor="middle" x="3034" y="-1281.13" font-family="Times,serif" font-size="14.00">Layer Norm 3 Part 5</text>
<text text-anchor="middle" x="3034" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3034" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3034" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_gate_3_5 -->
<g id="node157" class="node">
<title>ffn_gate_3_5</title>
<polygon fill="lightblue" stroke="black" points="3016,-1158.33 2616,-1158.33 2616,-1090.33 3016,-1090.33 3016,-1158.33"/>
<text text-anchor="middle" x="2816" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Gate 3 Part 5</text>
<text text-anchor="middle" x="2816" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="2816" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="2816" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_norm_3_5&#45;&gt;ffn_gate_3_5 -->
<g id="edge205" class="edge">
<title>layer_norm_3_5&#45;&gt;ffn_gate_3_5</title>
<path fill="none" stroke="black" d="M2925.5,-1228.22C2925.5,-1228.22 2925.5,-1168.53 2925.5,-1168.53"/>
<polygon fill="black" stroke="black" points="2929,-1168.53 2925.5,-1158.53 2922,-1168.53 2929,-1168.53"/>
</g>
<!-- ffn_up_3_5 -->
<g id="node165" class="node">
<title>ffn_up_3_5</title>
<polygon fill="lightblue" stroke="black" points="3452,-1158.33 3052,-1158.33 3052,-1090.33 3452,-1090.33 3452,-1158.33"/>
<text text-anchor="middle" x="3252" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Up 3 Part 5</text>
<text text-anchor="middle" x="3252" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3252" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="3252" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- layer_norm_3_5&#45;&gt;ffn_up_3_5 -->
<g id="edge206" class="edge">
<title>layer_norm_3_5&#45;&gt;ffn_up_3_5</title>
<path fill="none" stroke="black" d="M3142.5,-1228.22C3142.5,-1228.22 3142.5,-1168.53 3142.5,-1168.53"/>
<polygon fill="black" stroke="black" points="3146,-1168.53 3142.5,-1158.53 3139,-1168.53 3146,-1168.53"/>
</g>
<!-- layer_norm_3_6 -->
<g id="node48" class="node">
<title>layer_norm_3_6</title>
<polygon fill="lightblue" stroke="black" points="4105,-1296.33 3707,-1296.33 3707,-1228.33 4105,-1228.33 4105,-1296.33"/>
<text text-anchor="middle" x="3906" y="-1281.13" font-family="Times,serif" font-size="14.00">Layer Norm 3 Part 6</text>
<text text-anchor="middle" x="3906" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3906" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3906" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_gate_3_6 -->
<g id="node158" class="node">
<title>ffn_gate_3_6</title>
<polygon fill="lightblue" stroke="black" points="3888,-1158.33 3488,-1158.33 3488,-1090.33 3888,-1090.33 3888,-1158.33"/>
<text text-anchor="middle" x="3688" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Gate 3 Part 6</text>
<text text-anchor="middle" x="3688" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3688" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="3688" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_norm_3_6&#45;&gt;ffn_gate_3_6 -->
<g id="edge211" class="edge">
<title>layer_norm_3_6&#45;&gt;ffn_gate_3_6</title>
<path fill="none" stroke="black" d="M3797.5,-1228.22C3797.5,-1228.22 3797.5,-1168.53 3797.5,-1168.53"/>
<polygon fill="black" stroke="black" points="3801,-1168.53 3797.5,-1158.53 3794,-1168.53 3801,-1168.53"/>
</g>
<!-- ffn_up_3_6 -->
<g id="node166" class="node">
<title>ffn_up_3_6</title>
<polygon fill="lightblue" stroke="black" points="4324,-1158.33 3924,-1158.33 3924,-1090.33 4324,-1090.33 4324,-1158.33"/>
<text text-anchor="middle" x="4124" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Up 3 Part 6</text>
<text text-anchor="middle" x="4124" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4124" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="4124" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- layer_norm_3_6&#45;&gt;ffn_up_3_6 -->
<g id="edge212" class="edge">
<title>layer_norm_3_6&#45;&gt;ffn_up_3_6</title>
<path fill="none" stroke="black" d="M4014.5,-1228.22C4014.5,-1228.22 4014.5,-1168.53 4014.5,-1168.53"/>
<polygon fill="black" stroke="black" points="4018,-1168.53 4014.5,-1158.53 4011,-1168.53 4018,-1168.53"/>
</g>
<!-- layer_norm_3_7 -->
<g id="node49" class="node">
<title>layer_norm_3_7</title>
<polygon fill="lightblue" stroke="black" points="4977,-1296.33 4579,-1296.33 4579,-1228.33 4977,-1228.33 4977,-1296.33"/>
<text text-anchor="middle" x="4778" y="-1281.13" font-family="Times,serif" font-size="14.00">Layer Norm 3 Part 7</text>
<text text-anchor="middle" x="4778" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4778" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4778" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_gate_3_7 -->
<g id="node159" class="node">
<title>ffn_gate_3_7</title>
<polygon fill="lightblue" stroke="black" points="4760,-1158.33 4360,-1158.33 4360,-1090.33 4760,-1090.33 4760,-1158.33"/>
<text text-anchor="middle" x="4560" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Gate 3 Part 7</text>
<text text-anchor="middle" x="4560" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4560" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="4560" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_norm_3_7&#45;&gt;ffn_gate_3_7 -->
<g id="edge217" class="edge">
<title>layer_norm_3_7&#45;&gt;ffn_gate_3_7</title>
<path fill="none" stroke="black" d="M4669.5,-1228.22C4669.5,-1228.22 4669.5,-1168.53 4669.5,-1168.53"/>
<polygon fill="black" stroke="black" points="4673,-1168.53 4669.5,-1158.53 4666,-1168.53 4673,-1168.53"/>
</g>
<!-- ffn_up_3_7 -->
<g id="node167" class="node">
<title>ffn_up_3_7</title>
<polygon fill="lightblue" stroke="black" points="5196,-1158.33 4796,-1158.33 4796,-1090.33 5196,-1090.33 5196,-1158.33"/>
<text text-anchor="middle" x="4996" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Up 3 Part 7</text>
<text text-anchor="middle" x="4996" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4996" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="4996" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- layer_norm_3_7&#45;&gt;ffn_up_3_7 -->
<g id="edge218" class="edge">
<title>layer_norm_3_7&#45;&gt;ffn_up_3_7</title>
<path fill="none" stroke="black" d="M4886.5,-1228.22C4886.5,-1228.22 4886.5,-1168.53 4886.5,-1168.53"/>
<polygon fill="black" stroke="black" points="4890,-1168.53 4886.5,-1158.53 4883,-1168.53 4890,-1168.53"/>
</g>
<!-- gelu_0_0 -->
<g id="node66" class="node">
<title>gelu_0_0</title>
<polygon fill="lightblue" stroke="black" points="10853,-1400.33 10453,-1400.33 10453,-1332.33 10853,-1332.33 10853,-1400.33"/>
<text text-anchor="middle" x="10653" y="-1385.13" font-family="Times,serif" font-size="14.00">GELU 0 Part 0</text>
<text text-anchor="middle" x="10653" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10653" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10653" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_gate_0_0&#45;&gt;gelu_0_0 -->
<g id="edge20" class="edge">
<title>ffn_gate_0_0&#45;&gt;gelu_0_0</title>
<path fill="none" stroke="black" d="M10653,-1436.28C10653,-1436.28 10653,-1410.46 10653,-1410.46"/>
<polygon fill="black" stroke="black" points="10656.5,-1410.46 10653,-1400.46 10649.5,-1410.46 10656.5,-1410.46"/>
</g>
<!-- gelu_0_1 -->
<g id="node67" class="node">
<title>gelu_0_1</title>
<polygon fill="lightblue" stroke="black" points="5185,-1400.33 4785,-1400.33 4785,-1332.33 5185,-1332.33 5185,-1400.33"/>
<text text-anchor="middle" x="4985" y="-1385.13" font-family="Times,serif" font-size="14.00">GELU 0 Part 1</text>
<text text-anchor="middle" x="4985" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="4985" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="4985" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_gate_0_1&#45;&gt;gelu_0_1 -->
<g id="edge27" class="edge">
<title>ffn_gate_0_1&#45;&gt;gelu_0_1</title>
<path fill="none" stroke="black" d="M4664,-1436.17C4664,-1405.74 4664,-1366 4664,-1366 4664,-1366 4774.9,-1366 4774.9,-1366"/>
<polygon fill="black" stroke="black" points="4774.9,-1369.5 4784.9,-1366 4774.9,-1362.5 4774.9,-1369.5"/>
</g>
<!-- gelu_0_2 -->
<g id="node68" class="node">
<title>gelu_0_2</title>
<polygon fill="lightblue" stroke="black" points="6057,-1400.33 5657,-1400.33 5657,-1332.33 6057,-1332.33 6057,-1400.33"/>
<text text-anchor="middle" x="5857" y="-1385.13" font-family="Times,serif" font-size="14.00">GELU 0 Part 2</text>
<text text-anchor="middle" x="5857" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="5857" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="5857" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_gate_0_2&#45;&gt;gelu_0_2 -->
<g id="edge34" class="edge">
<title>ffn_gate_0_2&#45;&gt;gelu_0_2</title>
<path fill="none" stroke="black" d="M5536,-1436.17C5536,-1405.74 5536,-1366 5536,-1366 5536,-1366 5646.9,-1366 5646.9,-1366"/>
<polygon fill="black" stroke="black" points="5646.9,-1369.5 5656.9,-1366 5646.9,-1362.5 5646.9,-1369.5"/>
</g>
<!-- gelu_0_3 -->
<g id="node69" class="node">
<title>gelu_0_3</title>
<polygon fill="lightblue" stroke="black" points="6929,-1400.33 6529,-1400.33 6529,-1332.33 6929,-1332.33 6929,-1400.33"/>
<text text-anchor="middle" x="6729" y="-1385.13" font-family="Times,serif" font-size="14.00">GELU 0 Part 3</text>
<text text-anchor="middle" x="6729" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="6729" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="6729" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_gate_0_3&#45;&gt;gelu_0_3 -->
<g id="edge41" class="edge">
<title>ffn_gate_0_3&#45;&gt;gelu_0_3</title>
<path fill="none" stroke="black" d="M6299,-1436.17C6299,-1405.74 6299,-1366 6299,-1366 6299,-1366 6518.79,-1366 6518.79,-1366"/>
<polygon fill="black" stroke="black" points="6518.79,-1369.5 6528.79,-1366 6518.79,-1362.5 6518.79,-1369.5"/>
</g>
<!-- gelu_0_4 -->
<g id="node70" class="node">
<title>gelu_0_4</title>
<polygon fill="lightblue" stroke="black" points="7801,-1400.33 7401,-1400.33 7401,-1332.33 7801,-1332.33 7801,-1400.33"/>
<text text-anchor="middle" x="7601" y="-1385.13" font-family="Times,serif" font-size="14.00">GELU 0 Part 4</text>
<text text-anchor="middle" x="7601" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="7601" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="7601" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_gate_0_4&#45;&gt;gelu_0_4 -->
<g id="edge48" class="edge">
<title>ffn_gate_0_4&#45;&gt;gelu_0_4</title>
<path fill="none" stroke="black" d="M7169,-1436.11C7169,-1409.47 7169,-1377 7169,-1377 7169,-1377 7390.81,-1377 7390.81,-1377"/>
<polygon fill="black" stroke="black" points="7390.81,-1380.5 7400.81,-1377 7390.81,-1373.5 7390.81,-1380.5"/>
</g>
<!-- gelu_0_5 -->
<g id="node71" class="node">
<title>gelu_0_5</title>
<polygon fill="lightblue" stroke="black" points="8673,-1400.33 8273,-1400.33 8273,-1332.33 8673,-1332.33 8673,-1400.33"/>
<text text-anchor="middle" x="8473" y="-1385.13" font-family="Times,serif" font-size="14.00">GELU 0 Part 5</text>
<text text-anchor="middle" x="8473" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8473" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8473" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_gate_0_5&#45;&gt;gelu_0_5 -->
<g id="edge55" class="edge">
<title>ffn_gate_0_5&#45;&gt;gelu_0_5</title>
<path fill="none" stroke="black" d="M8105,-1436.11C8105,-1409.47 8105,-1377 8105,-1377 8105,-1377 8262.85,-1377 8262.85,-1377"/>
<polygon fill="black" stroke="black" points="8262.85,-1380.5 8272.85,-1377 8262.85,-1373.5 8262.85,-1380.5"/>
</g>
<!-- gelu_0_6 -->
<g id="node72" class="node">
<title>gelu_0_6</title>
<polygon fill="lightblue" stroke="black" points="9109,-1400.33 8709,-1400.33 8709,-1332.33 9109,-1332.33 9109,-1400.33"/>
<text text-anchor="middle" x="8909" y="-1385.13" font-family="Times,serif" font-size="14.00">GELU 0 Part 6</text>
<text text-anchor="middle" x="8909" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8909" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8909" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_gate_0_6&#45;&gt;gelu_0_6 -->
<g id="edge62" class="edge">
<title>ffn_gate_0_6&#45;&gt;gelu_0_6</title>
<path fill="none" stroke="black" d="M8909,-1436.28C8909,-1436.28 8909,-1410.46 8909,-1410.46"/>
<polygon fill="black" stroke="black" points="8912.5,-1410.46 8909,-1400.46 8905.5,-1410.46 8912.5,-1410.46"/>
</g>
<!-- gelu_0_7 -->
<g id="node73" class="node">
<title>gelu_0_7</title>
<polygon fill="lightblue" stroke="black" points="9981,-1400.33 9581,-1400.33 9581,-1332.33 9981,-1332.33 9981,-1400.33"/>
<text text-anchor="middle" x="9781" y="-1385.13" font-family="Times,serif" font-size="14.00">GELU 0 Part 7</text>
<text text-anchor="middle" x="9781" y="-1370.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9781" y="-1355.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9781" y="-1340.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_gate_0_7&#45;&gt;gelu_0_7 -->
<g id="edge69" class="edge">
<title>ffn_gate_0_7&#45;&gt;gelu_0_7</title>
<path fill="none" stroke="black" d="M9781,-1436.28C9781,-1436.28 9781,-1410.46 9781,-1410.46"/>
<polygon fill="black" stroke="black" points="9784.5,-1410.46 9781,-1400.46 9777.5,-1410.46 9784.5,-1410.46"/>
</g>
<!-- ffn_up_0_0&#45;&gt;gelu_0_0 -->
<g id="edge21" class="edge">
<title>ffn_up_0_0&#45;&gt;gelu_0_0</title>
<path fill="none" stroke="black" d="M10967.65,-1436.17C10967.65,-1405.74 10967.65,-1366 10967.65,-1366 10967.65,-1366 10863.17,-1366 10863.17,-1366"/>
<polygon fill="black" stroke="black" points="10863.17,-1362.5 10853.17,-1366 10863.17,-1369.5 10863.17,-1362.5"/>
</g>
<!-- ffn_up_0_1&#45;&gt;gelu_0_1 -->
<g id="edge28" class="edge">
<title>ffn_up_0_1&#45;&gt;gelu_0_1</title>
<path fill="none" stroke="black" d="M4985,-1436.28C4985,-1436.28 4985,-1410.46 4985,-1410.46"/>
<polygon fill="black" stroke="black" points="4988.5,-1410.46 4985,-1400.46 4981.5,-1410.46 4988.5,-1410.46"/>
</g>
<!-- ffn_up_0_2&#45;&gt;gelu_0_2 -->
<g id="edge35" class="edge">
<title>ffn_up_0_2&#45;&gt;gelu_0_2</title>
<path fill="none" stroke="black" d="M5857,-1436.28C5857,-1436.28 5857,-1410.46 5857,-1410.46"/>
<polygon fill="black" stroke="black" points="5860.5,-1410.46 5857,-1400.46 5853.5,-1410.46 5860.5,-1410.46"/>
</g>
<!-- ffn_up_0_3&#45;&gt;gelu_0_3 -->
<g id="edge42" class="edge">
<title>ffn_up_0_3&#45;&gt;gelu_0_3</title>
<path fill="none" stroke="black" d="M6729,-1436.28C6729,-1436.28 6729,-1410.46 6729,-1410.46"/>
<polygon fill="black" stroke="black" points="6732.5,-1410.46 6729,-1400.46 6725.5,-1410.46 6732.5,-1410.46"/>
</g>
<!-- ffn_up_0_4&#45;&gt;gelu_0_4 -->
<g id="edge49" class="edge">
<title>ffn_up_0_4&#45;&gt;gelu_0_4</title>
<path fill="none" stroke="black" d="M7601,-1436.28C7601,-1436.28 7601,-1410.46 7601,-1410.46"/>
<polygon fill="black" stroke="black" points="7604.5,-1410.46 7601,-1400.46 7597.5,-1410.46 7604.5,-1410.46"/>
</g>
<!-- ffn_up_0_5&#45;&gt;gelu_0_5 -->
<g id="edge56" class="edge">
<title>ffn_up_0_5&#45;&gt;gelu_0_5</title>
<path fill="none" stroke="black" d="M8473,-1436.28C8473,-1436.28 8473,-1410.46 8473,-1410.46"/>
<polygon fill="black" stroke="black" points="8476.5,-1410.46 8473,-1400.46 8469.5,-1410.46 8476.5,-1410.46"/>
</g>
<!-- ffn_up_0_6&#45;&gt;gelu_0_6 -->
<g id="edge63" class="edge">
<title>ffn_up_0_6&#45;&gt;gelu_0_6</title>
<path fill="none" stroke="black" d="M9249,-1436.17C9249,-1405.74 9249,-1366 9249,-1366 9249,-1366 9119.24,-1366 9119.24,-1366"/>
<polygon fill="black" stroke="black" points="9119.24,-1362.5 9109.24,-1366 9119.24,-1369.5 9119.24,-1362.5"/>
</g>
<!-- ffn_up_0_7&#45;&gt;gelu_0_7 -->
<g id="edge70" class="edge">
<title>ffn_up_0_7&#45;&gt;gelu_0_7</title>
<path fill="none" stroke="black" d="M10071,-1436.17C10071,-1405.74 10071,-1366 10071,-1366 10071,-1366 9991.23,-1366 9991.23,-1366"/>
<polygon fill="black" stroke="black" points="9991.23,-1362.5 9981.23,-1366 9991.23,-1369.5 9991.23,-1362.5"/>
</g>
<!-- ffn_down_0_0 -->
<g id="node74" class="node">
<title>ffn_down_0_0</title>
<polygon fill="lightblue" stroke="black" points="10523,-1296.33 10125,-1296.33 10125,-1228.33 10523,-1228.33 10523,-1296.33"/>
<text text-anchor="middle" x="10324" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Down 0 Part 0</text>
<text text-anchor="middle" x="10324" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="10324" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="10324" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gelu_0_0&#45;&gt;ffn_down_0_0 -->
<g id="edge22" class="edge">
<title>gelu_0_0&#45;&gt;ffn_down_0_0</title>
<path fill="none" stroke="black" d="M10488,-1332.28C10488,-1332.28 10488,-1306.46 10488,-1306.46"/>
<polygon fill="black" stroke="black" points="10491.5,-1306.46 10488,-1296.46 10484.5,-1306.46 10491.5,-1306.46"/>
</g>
<!-- ffn_down_0_1 -->
<g id="node75" class="node">
<title>ffn_down_0_1</title>
<polygon fill="lightblue" stroke="black" points="6937,-1296.33 6539,-1296.33 6539,-1228.33 6937,-1228.33 6937,-1296.33"/>
<text text-anchor="middle" x="6738" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Down 0 Part 1</text>
<text text-anchor="middle" x="6738" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="6738" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6738" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gelu_0_1&#45;&gt;ffn_down_0_1 -->
<g id="edge29" class="edge">
<title>gelu_0_1&#45;&gt;ffn_down_0_1</title>
<path fill="none" stroke="black" d="M5081,-1332.3C5081,-1322.31 5081,-1314 5081,-1314 5081,-1314 6734,-1314 6734,-1314 6734,-1314 6734,-1306.51 6734,-1306.51"/>
<polygon fill="black" stroke="black" points="6737.5,-1306.51 6734,-1296.51 6730.5,-1306.51 6737.5,-1306.51"/>
</g>
<!-- ffn_down_0_2 -->
<g id="node76" class="node">
<title>ffn_down_0_2</title>
<polygon fill="lightblue" stroke="black" points="7371,-1296.33 6973,-1296.33 6973,-1228.33 7371,-1228.33 7371,-1296.33"/>
<text text-anchor="middle" x="7172" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Down 0 Part 2</text>
<text text-anchor="middle" x="7172" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="7172" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7172" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gelu_0_2&#45;&gt;ffn_down_0_2 -->
<g id="edge36" class="edge">
<title>gelu_0_2&#45;&gt;ffn_down_0_2</title>
<path fill="none" stroke="black" d="M5953,-1332.03C5953,-1286.01 5953,-1210 5953,-1210 5953,-1210 6993,-1210 6993,-1210 6993,-1210 6993,-1218.3 6993,-1218.3"/>
<polygon fill="black" stroke="black" points="6989.5,-1218.3 6993,-1228.3 6996.5,-1218.3 6989.5,-1218.3"/>
</g>
<!-- ffn_down_0_3 -->
<g id="node77" class="node">
<title>ffn_down_0_3</title>
<polygon fill="lightblue" stroke="black" points="7805,-1296.33 7407,-1296.33 7407,-1228.33 7805,-1228.33 7805,-1296.33"/>
<text text-anchor="middle" x="7606" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Down 0 Part 3</text>
<text text-anchor="middle" x="7606" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="7606" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7606" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gelu_0_3&#45;&gt;ffn_down_0_3 -->
<g id="edge43" class="edge">
<title>gelu_0_3&#45;&gt;ffn_down_0_3</title>
<path fill="none" stroke="black" d="M6929.24,-1354C7122.5,-1354 7386,-1354 7386,-1354 7386,-1354 7386,-1262 7386,-1262 7386,-1262 7396.7,-1262 7396.7,-1262"/>
<polygon fill="black" stroke="black" points="7396.7,-1265.5 7406.7,-1262 7396.7,-1258.5 7396.7,-1265.5"/>
</g>
<!-- ffn_down_0_4 -->
<g id="node78" class="node">
<title>ffn_down_0_4</title>
<polygon fill="lightblue" stroke="black" points="8239,-1296.33 7841,-1296.33 7841,-1228.33 8239,-1228.33 8239,-1296.33"/>
<text text-anchor="middle" x="8040" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Down 0 Part 4</text>
<text text-anchor="middle" x="8040" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8040" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8040" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gelu_0_4&#45;&gt;ffn_down_0_4 -->
<g id="edge50" class="edge">
<title>gelu_0_4&#45;&gt;ffn_down_0_4</title>
<path fill="none" stroke="black" d="M7801.16,-1354C7889.21,-1354 7973,-1354 7973,-1354 7973,-1354 7973,-1306.47 7973,-1306.47"/>
<polygon fill="black" stroke="black" points="7976.5,-1306.47 7973,-1296.47 7969.5,-1306.47 7976.5,-1306.47"/>
</g>
<!-- ffn_down_0_5 -->
<g id="node79" class="node">
<title>ffn_down_0_5</title>
<polygon fill="lightblue" stroke="black" points="8673,-1296.33 8275,-1296.33 8275,-1228.33 8673,-1228.33 8673,-1296.33"/>
<text text-anchor="middle" x="8474" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Down 0 Part 5</text>
<text text-anchor="middle" x="8474" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8474" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8474" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gelu_0_5&#45;&gt;ffn_down_0_5 -->
<g id="edge57" class="edge">
<title>gelu_0_5&#45;&gt;ffn_down_0_5</title>
<path fill="none" stroke="black" d="M8474,-1332.28C8474,-1332.28 8474,-1306.46 8474,-1306.46"/>
<polygon fill="black" stroke="black" points="8477.5,-1306.46 8474,-1296.46 8470.5,-1306.46 8477.5,-1306.46"/>
</g>
<!-- ffn_down_0_6 -->
<g id="node80" class="node">
<title>ffn_down_0_6</title>
<polygon fill="lightblue" stroke="black" points="9108,-1296.33 8710,-1296.33 8710,-1228.33 9108,-1228.33 9108,-1296.33"/>
<text text-anchor="middle" x="8909" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Down 0 Part 6</text>
<text text-anchor="middle" x="8909" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="8909" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8909" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gelu_0_6&#45;&gt;ffn_down_0_6 -->
<g id="edge64" class="edge">
<title>gelu_0_6&#45;&gt;ffn_down_0_6</title>
<path fill="none" stroke="black" d="M8909,-1332.28C8909,-1332.28 8909,-1306.46 8909,-1306.46"/>
<polygon fill="black" stroke="black" points="8912.5,-1306.46 8909,-1296.46 8905.5,-1306.46 8912.5,-1306.46"/>
</g>
<!-- ffn_down_0_7 -->
<g id="node81" class="node">
<title>ffn_down_0_7</title>
<polygon fill="lightblue" stroke="black" points="9761,-1296.33 9363,-1296.33 9363,-1228.33 9761,-1228.33 9761,-1296.33"/>
<text text-anchor="middle" x="9562" y="-1281.13" font-family="Times,serif" font-size="14.00">FFN Down 0 Part 7</text>
<text text-anchor="middle" x="9562" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="9562" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9562" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gelu_0_7&#45;&gt;ffn_down_0_7 -->
<g id="edge71" class="edge">
<title>gelu_0_7&#45;&gt;ffn_down_0_7</title>
<path fill="none" stroke="black" d="M9671,-1332.28C9671,-1332.28 9671,-1306.46 9671,-1306.46"/>
<polygon fill="black" stroke="black" points="9674.5,-1306.46 9671,-1296.46 9667.5,-1306.46 9674.5,-1306.46"/>
</g>
<!-- ffn_all_reduce_0 -->
<g id="node82" class="node">
<title>ffn_all_reduce_0</title>
<polygon fill="lightyellow" stroke="black" points="8901.28,-1192.33 8221.57,-1192.33 8046.72,-1056.33 8726.43,-1056.33 8901.28,-1192.33"/>
<text text-anchor="middle" x="8474" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce 0</text>
<text text-anchor="middle" x="8474" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512] x 8</text>
<text text-anchor="middle" x="8474" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="8474" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ffn_down_0_0&#45;&gt;ffn_all_reduce_0 -->
<g id="edge23" class="edge">
<title>ffn_down_0_0&#45;&gt;ffn_all_reduce_0</title>
<path fill="none" stroke="black" d="M10324,-1228.11C10324,-1201.47 10324,-1169 10324,-1169 10324,-1169 8881.44,-1169 8881.44,-1169"/>
<polygon fill="black" stroke="black" points="8881.44,-1165.5 8871.44,-1169 8881.44,-1172.5 8881.44,-1165.5"/>
</g>
<!-- ffn_down_0_1&#45;&gt;ffn_all_reduce_0 -->
<g id="edge30" class="edge">
<title>ffn_down_0_1&#45;&gt;ffn_all_reduce_0</title>
<path fill="none" stroke="black" d="M6738.5,-1228.1C6738.5,-1200.41 6738.5,-1166 6738.5,-1166 6738.5,-1166 8177.42,-1166 8177.42,-1166"/>
<polygon fill="black" stroke="black" points="8177.42,-1169.5 8187.42,-1166 8177.42,-1162.5 8177.42,-1169.5"/>
</g>
<!-- ffn_down_0_2&#45;&gt;ffn_all_reduce_0 -->
<g id="edge37" class="edge">
<title>ffn_down_0_2&#45;&gt;ffn_all_reduce_0</title>
<path fill="none" stroke="black" d="M7319.77,-1228.32C7319.77,-1203.8 7319.77,-1175 7319.77,-1175 7319.77,-1175 8189,-1175 8189,-1175"/>
<polygon fill="black" stroke="black" points="8189,-1178.5 8199,-1175 8189,-1171.5 8189,-1178.5"/>
</g>
<!-- ffn_down_0_3&#45;&gt;ffn_all_reduce_0 -->
<g id="edge44" class="edge">
<title>ffn_down_0_3&#45;&gt;ffn_all_reduce_0</title>
<path fill="none" stroke="black" d="M7606,-1228.23C7606,-1206.73 7606,-1183 7606,-1183 7606,-1183 8199.45,-1183 8199.45,-1183"/>
<polygon fill="black" stroke="black" points="8199.45,-1186.5 8209.45,-1183 8199.45,-1179.5 8199.45,-1186.5"/>
</g>
<!-- ffn_down_0_4&#45;&gt;ffn_all_reduce_0 -->
<g id="edge51" class="edge">
<title>ffn_down_0_4&#45;&gt;ffn_all_reduce_0</title>
<path fill="none" stroke="black" d="M8142.93,-1228.22C8142.93,-1228.22 8142.93,-1141.42 8142.93,-1141.42"/>
<polygon fill="black" stroke="black" points="8146.43,-1141.42 8142.93,-1131.42 8139.43,-1141.42 8146.43,-1141.42"/>
</g>
<!-- ffn_down_0_5&#45;&gt;ffn_all_reduce_0 -->
<g id="edge58" class="edge">
<title>ffn_down_0_5&#45;&gt;ffn_all_reduce_0</title>
<path fill="none" stroke="black" d="M8474,-1228.22C8474,-1228.22 8474,-1202.56 8474,-1202.56"/>
<polygon fill="black" stroke="black" points="8477.5,-1202.56 8474,-1192.56 8470.5,-1202.56 8477.5,-1202.56"/>
</g>
<!-- ffn_down_0_6&#45;&gt;ffn_all_reduce_0 -->
<g id="edge65" class="edge">
<title>ffn_down_0_6&#45;&gt;ffn_all_reduce_0</title>
<path fill="none" stroke="black" d="M8805.57,-1228.22C8805.57,-1228.22 8805.57,-1202.56 8805.57,-1202.56"/>
<polygon fill="black" stroke="black" points="8809.07,-1202.56 8805.57,-1192.56 8802.07,-1202.56 8809.07,-1202.56"/>
</g>
<!-- ffn_down_0_7&#45;&gt;ffn_all_reduce_0 -->
<g id="edge72" class="edge">
<title>ffn_down_0_7&#45;&gt;ffn_all_reduce_0</title>
<path fill="none" stroke="black" d="M9562,-1227.89C9562,-1205.33 9562,-1180 9562,-1180 9562,-1180 8895.71,-1180 8895.71,-1180"/>
<polygon fill="black" stroke="black" points="8895.71,-1176.5 8885.71,-1180 8895.71,-1183.5 8895.71,-1176.5"/>
</g>
<!-- ffn_all_reduce_0&#45;&gt;residual_ffn_0 -->
<g id="edge74" class="edge">
<title>ffn_all_reduce_0&#45;&gt;residual_ffn_0</title>
<path fill="none" stroke="black" d="M8895.07,-1124.24C8895.07,-1120.26 8895.07,-993 8895.07,-993 8895.07,-993 11174.74,-993 11174.74,-993"/>
<polygon fill="black" stroke="black" points="11174.74,-996.5 11184.74,-993 11174.73,-989.5 11174.74,-996.5"/>
</g>
<!-- residual_ffn_1 -->
<g id="node117" class="node">
<title>residual_ffn_1</title>
<ellipse fill="orange" stroke="black" cx="12888" cy="-780.33" rx="297.88" ry="48.17"/>
<text text-anchor="middle" x="12888" y="-799.13" font-family="Times,serif" font-size="14.00">Residual Add FFN 1</text>
<text text-anchor="middle" x="12888" y="-784.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096] x 2</text>
<text text-anchor="middle" x="12888" y="-769.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="12888" y="-754.13" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- residual_ffn_0&#45;&gt;residual_ffn_1 -->
<g id="edge123" class="edge">
<title>residual_ffn_0&#45;&gt;residual_ffn_1</title>
<path fill="none" stroke="black" d="M11641.71,-952C12017.98,-952 12617.21,-952 12617.21,-952 12617.21,-952 12617.21,-810.36 12617.21,-810.36"/>
<polygon fill="black" stroke="black" points="12620.71,-810.36 12617.21,-800.36 12613.71,-810.36 12620.71,-810.36"/>
</g>
<!-- gelu_1_0 -->
<g id="node100" class="node">
<title>gelu_1_0</title>
<polygon fill="lightblue" stroke="black" points="17031,-1296.33 16631,-1296.33 16631,-1228.33 17031,-1228.33 17031,-1296.33"/>
<text text-anchor="middle" x="16831" y="-1281.13" font-family="Times,serif" font-size="14.00">GELU 1 Part 0</text>
<text text-anchor="middle" x="16831" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="16831" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="16831" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_gate_1_0&#45;&gt;gelu_1_0 -->
<g id="edge77" class="edge">
<title>ffn_gate_1_0&#45;&gt;gelu_1_0</title>
<path fill="none" stroke="black" d="M16831,-1332.28C16831,-1332.28 16831,-1306.46 16831,-1306.46"/>
<polygon fill="black" stroke="black" points="16834.5,-1306.46 16831,-1296.46 16827.5,-1306.46 16834.5,-1306.46"/>
</g>
<!-- gelu_1_1 -->
<g id="node101" class="node">
<title>gelu_1_1</title>
<polygon fill="lightblue" stroke="black" points="17902,-1296.33 17502,-1296.33 17502,-1228.33 17902,-1228.33 17902,-1296.33"/>
<text text-anchor="middle" x="17702" y="-1281.13" font-family="Times,serif" font-size="14.00">GELU 1 Part 1</text>
<text text-anchor="middle" x="17702" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="17702" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="17702" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_gate_1_1&#45;&gt;gelu_1_1 -->
<g id="edge83" class="edge">
<title>ffn_gate_1_1&#45;&gt;gelu_1_1</title>
<path fill="none" stroke="black" d="M17702.5,-1332.28C17702.5,-1332.28 17702.5,-1306.46 17702.5,-1306.46"/>
<polygon fill="black" stroke="black" points="17706,-1306.46 17702.5,-1296.46 17699,-1306.46 17706,-1306.46"/>
</g>
<!-- gelu_1_2 -->
<g id="node102" class="node">
<title>gelu_1_2</title>
<polygon fill="lightblue" stroke="black" points="12235,-1296.33 11835,-1296.33 11835,-1228.33 12235,-1228.33 12235,-1296.33"/>
<text text-anchor="middle" x="12035" y="-1281.13" font-family="Times,serif" font-size="14.00">GELU 1 Part 2</text>
<text text-anchor="middle" x="12035" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="12035" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="12035" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_gate_1_2&#45;&gt;gelu_1_2 -->
<g id="edge89" class="edge">
<title>ffn_gate_1_2&#45;&gt;gelu_1_2</title>
<path fill="none" stroke="black" d="M11720.35,-1332.17C11720.35,-1301.74 11720.35,-1262 11720.35,-1262 11720.35,-1262 11824.83,-1262 11824.83,-1262"/>
<polygon fill="black" stroke="black" points="11824.83,-1265.5 11834.83,-1262 11824.83,-1258.5 11824.83,-1265.5"/>
</g>
<!-- gelu_1_3 -->
<g id="node103" class="node">
<title>gelu_1_3</title>
<polygon fill="lightblue" stroke="black" points="13107,-1296.33 12707,-1296.33 12707,-1228.33 13107,-1228.33 13107,-1296.33"/>
<text text-anchor="middle" x="12907" y="-1281.13" font-family="Times,serif" font-size="14.00">GELU 1 Part 3</text>
<text text-anchor="middle" x="12907" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="12907" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="12907" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_gate_1_3&#45;&gt;gelu_1_3 -->
<g id="edge95" class="edge">
<title>ffn_gate_1_3&#45;&gt;gelu_1_3</title>
<path fill="none" stroke="black" d="M12644.1,-1332.17C12644.1,-1301.74 12644.1,-1262 12644.1,-1262 12644.1,-1262 12696.74,-1262 12696.74,-1262"/>
<polygon fill="black" stroke="black" points="12696.74,-1265.5 12706.74,-1262 12696.74,-1258.5 12696.74,-1265.5"/>
</g>
<!-- gelu_1_4 -->
<g id="node104" class="node">
<title>gelu_1_4</title>
<polygon fill="lightblue" stroke="black" points="13979,-1296.33 13579,-1296.33 13579,-1228.33 13979,-1228.33 13979,-1296.33"/>
<text text-anchor="middle" x="13779" y="-1281.13" font-family="Times,serif" font-size="14.00">GELU 1 Part 4</text>
<text text-anchor="middle" x="13779" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="13779" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="13779" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_gate_1_4&#45;&gt;gelu_1_4 -->
<g id="edge101" class="edge">
<title>ffn_gate_1_4&#45;&gt;gelu_1_4</title>
<path fill="none" stroke="black" d="M13489,-1332.17C13489,-1301.74 13489,-1262 13489,-1262 13489,-1262 13568.77,-1262 13568.77,-1262"/>
<polygon fill="black" stroke="black" points="13568.77,-1265.5 13578.77,-1262 13568.77,-1258.5 13568.77,-1265.5"/>
</g>
<!-- gelu_1_5 -->
<g id="node105" class="node">
<title>gelu_1_5</title>
<polygon fill="lightblue" stroke="black" points="14633,-1296.33 14233,-1296.33 14233,-1228.33 14633,-1228.33 14633,-1296.33"/>
<text text-anchor="middle" x="14433" y="-1281.13" font-family="Times,serif" font-size="14.00">GELU 1 Part 5</text>
<text text-anchor="middle" x="14433" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="14433" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="14433" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_gate_1_5&#45;&gt;gelu_1_5 -->
<g id="edge107" class="edge">
<title>ffn_gate_1_5&#45;&gt;gelu_1_5</title>
<path fill="none" stroke="black" d="M14324,-1332.28C14324,-1332.28 14324,-1306.46 14324,-1306.46"/>
<polygon fill="black" stroke="black" points="14327.5,-1306.46 14324,-1296.46 14320.5,-1306.46 14327.5,-1306.46"/>
</g>
<!-- gelu_1_6 -->
<g id="node106" class="node">
<title>gelu_1_6</title>
<polygon fill="lightblue" stroke="black" points="15287,-1296.33 14887,-1296.33 14887,-1228.33 15287,-1228.33 15287,-1296.33"/>
<text text-anchor="middle" x="15087" y="-1281.13" font-family="Times,serif" font-size="14.00">GELU 1 Part 6</text>
<text text-anchor="middle" x="15087" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="15087" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="15087" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_gate_1_6&#45;&gt;gelu_1_6 -->
<g id="edge113" class="edge">
<title>ffn_gate_1_6&#45;&gt;gelu_1_6</title>
<path fill="none" stroke="black" d="M15087,-1332.28C15087,-1332.28 15087,-1306.46 15087,-1306.46"/>
<polygon fill="black" stroke="black" points="15090.5,-1306.46 15087,-1296.46 15083.5,-1306.46 15090.5,-1306.46"/>
</g>
<!-- gelu_1_7 -->
<g id="node107" class="node">
<title>gelu_1_7</title>
<polygon fill="lightblue" stroke="black" points="16159,-1296.33 15759,-1296.33 15759,-1228.33 16159,-1228.33 16159,-1296.33"/>
<text text-anchor="middle" x="15959" y="-1281.13" font-family="Times,serif" font-size="14.00">GELU 1 Part 7</text>
<text text-anchor="middle" x="15959" y="-1266.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="15959" y="-1251.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="15959" y="-1236.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_gate_1_7&#45;&gt;gelu_1_7 -->
<g id="edge119" class="edge">
<title>ffn_gate_1_7&#45;&gt;gelu_1_7</title>
<path fill="none" stroke="black" d="M15959,-1332.28C15959,-1332.28 15959,-1306.46 15959,-1306.46"/>
<polygon fill="black" stroke="black" points="15962.5,-1306.46 15959,-1296.46 15955.5,-1306.46 15962.5,-1306.46"/>
</g>
<!-- ffn_up_1_0&#45;&gt;gelu_1_0 -->
<g id="edge78" class="edge">
<title>ffn_up_1_0&#45;&gt;gelu_1_0</title>
<path fill="none" stroke="black" d="M17121,-1332.17C17121,-1301.74 17121,-1262 17121,-1262 17121,-1262 17041.23,-1262 17041.23,-1262"/>
<polygon fill="black" stroke="black" points="17041.23,-1258.5 17031.23,-1262 17041.23,-1265.5 17041.23,-1258.5"/>
</g>
<!-- ffn_up_1_1&#45;&gt;gelu_1_1 -->
<g id="edge84" class="edge">
<title>ffn_up_1_1&#45;&gt;gelu_1_1</title>
<path fill="none" stroke="black" d="M17938.75,-1366C17927.4,-1366 17920.5,-1366 17920.5,-1366 17920.5,-1366 17920.5,-1262 17920.5,-1262 17920.5,-1262 17912.25,-1262 17912.25,-1262"/>
<polygon fill="black" stroke="black" points="17912.25,-1258.5 17902.25,-1262 17912.25,-1265.5 17912.25,-1258.5"/>
</g>
<!-- ffn_up_1_2&#45;&gt;gelu_1_2 -->
<g id="edge90" class="edge">
<title>ffn_up_1_2&#45;&gt;gelu_1_2</title>
<path fill="none" stroke="black" d="M12035,-1332.28C12035,-1332.28 12035,-1306.46 12035,-1306.46"/>
<polygon fill="black" stroke="black" points="12038.5,-1306.46 12035,-1296.46 12031.5,-1306.46 12038.5,-1306.46"/>
</g>
<!-- ffn_up_1_3&#45;&gt;gelu_1_3 -->
<g id="edge96" class="edge">
<title>ffn_up_1_3&#45;&gt;gelu_1_3</title>
<path fill="none" stroke="black" d="M12907,-1332.28C12907,-1332.28 12907,-1306.46 12907,-1306.46"/>
<polygon fill="black" stroke="black" points="12910.5,-1306.46 12907,-1296.46 12903.5,-1306.46 12910.5,-1306.46"/>
</g>
<!-- ffn_up_1_4&#45;&gt;gelu_1_4 -->
<g id="edge102" class="edge">
<title>ffn_up_1_4&#45;&gt;gelu_1_4</title>
<path fill="none" stroke="black" d="M13779,-1332.28C13779,-1332.28 13779,-1306.46 13779,-1306.46"/>
<polygon fill="black" stroke="black" points="13782.5,-1306.46 13779,-1296.46 13775.5,-1306.46 13782.5,-1306.46"/>
</g>
<!-- ffn_up_1_5&#45;&gt;gelu_1_5 -->
<g id="edge108" class="edge">
<title>ffn_up_1_5&#45;&gt;gelu_1_5</title>
<path fill="none" stroke="black" d="M14542,-1332.28C14542,-1332.28 14542,-1306.46 14542,-1306.46"/>
<polygon fill="black" stroke="black" points="14545.5,-1306.46 14542,-1296.46 14538.5,-1306.46 14545.5,-1306.46"/>
</g>
<!-- ffn_up_1_6&#45;&gt;gelu_1_6 -->
<g id="edge114" class="edge">
<title>ffn_up_1_6&#45;&gt;gelu_1_6</title>
<path fill="none" stroke="black" d="M15404.5,-1332.17C15404.5,-1301.74 15404.5,-1262 15404.5,-1262 15404.5,-1262 15297.18,-1262 15297.18,-1262"/>
<polygon fill="black" stroke="black" points="15297.18,-1258.5 15287.18,-1262 15297.18,-1265.5 15297.18,-1258.5"/>
</g>
<!-- ffn_up_1_7&#45;&gt;gelu_1_7 -->
<g id="edge120" class="edge">
<title>ffn_up_1_7&#45;&gt;gelu_1_7</title>
<path fill="none" stroke="black" d="M16304,-1332.17C16304,-1301.74 16304,-1262 16304,-1262 16304,-1262 16169.19,-1262 16169.19,-1262"/>
<polygon fill="black" stroke="black" points="16169.19,-1258.5 16159.19,-1262 16169.19,-1265.5 16169.19,-1258.5"/>
</g>
<!-- ffn_down_1_0 -->
<g id="node108" class="node">
<title>ffn_down_1_0</title>
<polygon fill="lightblue" stroke="black" points="16811,-1158.33 16413,-1158.33 16413,-1090.33 16811,-1090.33 16811,-1158.33"/>
<text text-anchor="middle" x="16612" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Down 1 Part 0</text>
<text text-anchor="middle" x="16612" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="16612" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="16612" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gelu_1_0&#45;&gt;ffn_down_1_0 -->
<g id="edge79" class="edge">
<title>gelu_1_0&#45;&gt;ffn_down_1_0</title>
<path fill="none" stroke="black" d="M16721,-1228.22C16721,-1228.22 16721,-1168.53 16721,-1168.53"/>
<polygon fill="black" stroke="black" points="16724.5,-1168.53 16721,-1158.53 16717.5,-1168.53 16724.5,-1168.53"/>
</g>
<!-- ffn_down_1_1 -->
<g id="node109" class="node">
<title>ffn_down_1_1</title>
<polygon fill="lightblue" stroke="black" points="17573,-1158.33 17175,-1158.33 17175,-1090.33 17573,-1090.33 17573,-1158.33"/>
<text text-anchor="middle" x="17374" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Down 1 Part 1</text>
<text text-anchor="middle" x="17374" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="17374" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="17374" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gelu_1_1&#45;&gt;ffn_down_1_1 -->
<g id="edge85" class="edge">
<title>gelu_1_1&#45;&gt;ffn_down_1_1</title>
<path fill="none" stroke="black" d="M17537.5,-1228.22C17537.5,-1228.22 17537.5,-1168.53 17537.5,-1168.53"/>
<polygon fill="black" stroke="black" points="17541,-1168.53 17537.5,-1158.53 17534,-1168.53 17541,-1168.53"/>
</g>
<!-- ffn_down_1_2 -->
<g id="node110" class="node">
<title>ffn_down_1_2</title>
<polygon fill="lightblue" stroke="black" points="12563,-1158.33 12165,-1158.33 12165,-1090.33 12563,-1090.33 12563,-1158.33"/>
<text text-anchor="middle" x="12364" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Down 1 Part 2</text>
<text text-anchor="middle" x="12364" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="12364" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="12364" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gelu_1_2&#45;&gt;ffn_down_1_2 -->
<g id="edge91" class="edge">
<title>gelu_1_2&#45;&gt;ffn_down_1_2</title>
<path fill="none" stroke="black" d="M12200,-1228.22C12200,-1228.22 12200,-1168.53 12200,-1168.53"/>
<polygon fill="black" stroke="black" points="12203.5,-1168.53 12200,-1158.53 12196.5,-1168.53 12203.5,-1168.53"/>
</g>
<!-- ffn_down_1_3 -->
<g id="node111" class="node">
<title>ffn_down_1_3</title>
<polygon fill="lightblue" stroke="black" points="13435,-1158.33 13037,-1158.33 13037,-1090.33 13435,-1090.33 13435,-1158.33"/>
<text text-anchor="middle" x="13236" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Down 1 Part 3</text>
<text text-anchor="middle" x="13236" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="13236" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="13236" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gelu_1_3&#45;&gt;ffn_down_1_3 -->
<g id="edge97" class="edge">
<title>gelu_1_3&#45;&gt;ffn_down_1_3</title>
<path fill="none" stroke="black" d="M13072,-1228.22C13072,-1228.22 13072,-1168.53 13072,-1168.53"/>
<polygon fill="black" stroke="black" points="13075.5,-1168.53 13072,-1158.53 13068.5,-1168.53 13075.5,-1168.53"/>
</g>
<!-- ffn_down_1_4 -->
<g id="node112" class="node">
<title>ffn_down_1_4</title>
<polygon fill="lightblue" stroke="black" points="14088,-1158.33 13690,-1158.33 13690,-1090.33 14088,-1090.33 14088,-1158.33"/>
<text text-anchor="middle" x="13889" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Down 1 Part 4</text>
<text text-anchor="middle" x="13889" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="13889" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="13889" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gelu_1_4&#45;&gt;ffn_down_1_4 -->
<g id="edge103" class="edge">
<title>gelu_1_4&#45;&gt;ffn_down_1_4</title>
<path fill="none" stroke="black" d="M13834.5,-1228.22C13834.5,-1228.22 13834.5,-1168.53 13834.5,-1168.53"/>
<polygon fill="black" stroke="black" points="13838,-1168.53 13834.5,-1158.53 13831,-1168.53 13838,-1168.53"/>
</g>
<!-- ffn_down_1_5 -->
<g id="node113" class="node">
<title>ffn_down_1_5</title>
<polygon fill="lightblue" stroke="black" points="14632,-1158.33 14234,-1158.33 14234,-1090.33 14632,-1090.33 14632,-1158.33"/>
<text text-anchor="middle" x="14433" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Down 1 Part 5</text>
<text text-anchor="middle" x="14433" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="14433" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="14433" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gelu_1_5&#45;&gt;ffn_down_1_5 -->
<g id="edge109" class="edge">
<title>gelu_1_5&#45;&gt;ffn_down_1_5</title>
<path fill="none" stroke="black" d="M14433,-1228.22C14433,-1228.22 14433,-1168.53 14433,-1168.53"/>
<polygon fill="black" stroke="black" points="14436.5,-1168.53 14433,-1158.53 14429.5,-1168.53 14436.5,-1168.53"/>
</g>
<!-- ffn_down_1_6 -->
<g id="node114" class="node">
<title>ffn_down_1_6</title>
<polygon fill="lightblue" stroke="black" points="15176,-1158.33 14778,-1158.33 14778,-1090.33 15176,-1090.33 15176,-1158.33"/>
<text text-anchor="middle" x="14977" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Down 1 Part 6</text>
<text text-anchor="middle" x="14977" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="14977" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="14977" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gelu_1_6&#45;&gt;ffn_down_1_6 -->
<g id="edge115" class="edge">
<title>gelu_1_6&#45;&gt;ffn_down_1_6</title>
<path fill="none" stroke="black" d="M15031.5,-1228.22C15031.5,-1228.22 15031.5,-1168.53 15031.5,-1168.53"/>
<polygon fill="black" stroke="black" points="15035,-1168.53 15031.5,-1158.53 15028,-1168.53 15035,-1168.53"/>
</g>
<!-- ffn_down_1_7 -->
<g id="node115" class="node">
<title>ffn_down_1_7</title>
<polygon fill="lightblue" stroke="black" points="15884,-1158.33 15486,-1158.33 15486,-1090.33 15884,-1090.33 15884,-1158.33"/>
<text text-anchor="middle" x="15685" y="-1143.13" font-family="Times,serif" font-size="14.00">FFN Down 1 Part 7</text>
<text text-anchor="middle" x="15685" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="15685" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="15685" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gelu_1_7&#45;&gt;ffn_down_1_7 -->
<g id="edge121" class="edge">
<title>gelu_1_7&#45;&gt;ffn_down_1_7</title>
<path fill="none" stroke="black" d="M15821.5,-1228.22C15821.5,-1228.22 15821.5,-1168.53 15821.5,-1168.53"/>
<polygon fill="black" stroke="black" points="15825,-1168.53 15821.5,-1158.53 15818,-1168.53 15825,-1168.53"/>
</g>
<!-- ffn_all_reduce_1 -->
<g id="node116" class="node">
<title>ffn_all_reduce_1</title>
<polygon fill="lightyellow" stroke="black" points="14860.28,-1020.33 14180.57,-1020.33 14005.72,-884.33 14685.43,-884.33 14860.28,-1020.33"/>
<text text-anchor="middle" x="14433" y="-971.13" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce 1</text>
<text text-anchor="middle" x="14433" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512] x 8</text>
<text text-anchor="middle" x="14433" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="14433" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ffn_down_1_0&#45;&gt;ffn_all_reduce_1 -->
<g id="edge80" class="edge">
<title>ffn_down_1_0&#45;&gt;ffn_all_reduce_1</title>
<path fill="none" stroke="black" d="M16612,-1090.21C16612,-1054.32 16612,-1003 16612,-1003 16612,-1003 14848.07,-1003 14848.07,-1003"/>
<polygon fill="black" stroke="black" points="14848.07,-999.5 14838.07,-1003 14848.06,-1006.5 14848.07,-999.5"/>
</g>
<!-- ffn_down_1_1&#45;&gt;ffn_all_reduce_1 -->
<g id="edge86" class="edge">
<title>ffn_down_1_1&#45;&gt;ffn_all_reduce_1</title>
<path fill="none" stroke="black" d="M17374,-1090.09C17374,-1051.47 17374,-994 17374,-994 17374,-994 14836.58,-994 14836.58,-994"/>
<polygon fill="black" stroke="black" points="14836.58,-990.5 14826.58,-994 14836.58,-997.5 14836.58,-990.5"/>
</g>
<!-- ffn_down_1_2&#45;&gt;ffn_all_reduce_1 -->
<g id="edge92" class="edge">
<title>ffn_down_1_2&#45;&gt;ffn_all_reduce_1</title>
<path fill="none" stroke="black" d="M12364,-1090.08C12364,-1055.45 12364,-1007 12364,-1007 12364,-1007 14153.31,-1007 14153.31,-1007"/>
<polygon fill="black" stroke="black" points="14153.31,-1010.5 14163.31,-1007 14153.31,-1003.5 14153.31,-1010.5"/>
</g>
<!-- ffn_down_1_3&#45;&gt;ffn_all_reduce_1 -->
<g id="edge98" class="edge">
<title>ffn_down_1_3&#45;&gt;ffn_all_reduce_1</title>
<path fill="none" stroke="black" d="M13310.35,-1090.32C13310.35,-1057.58 13310.35,-1013 13310.35,-1013 13310.35,-1013 14160.85,-1013 14160.85,-1013"/>
<polygon fill="black" stroke="black" points="14160.85,-1016.5 14170.85,-1013 14160.85,-1009.5 14160.85,-1016.5"/>
</g>
<!-- ffn_down_1_4&#45;&gt;ffn_all_reduce_1 -->
<g id="edge104" class="edge">
<title>ffn_down_1_4&#45;&gt;ffn_all_reduce_1</title>
<path fill="none" stroke="black" d="M14046.93,-1089.94C14046.93,-1089.94 14046.93,-962.4 14046.93,-962.4"/>
<polygon fill="black" stroke="black" points="14050.43,-962.4 14046.93,-952.4 14043.43,-962.4 14050.43,-962.4"/>
</g>
<!-- ffn_down_1_5&#45;&gt;ffn_all_reduce_1 -->
<g id="edge110" class="edge">
<title>ffn_down_1_5&#45;&gt;ffn_all_reduce_1</title>
<path fill="none" stroke="black" d="M14433,-1089.94C14433,-1089.94 14433,-1030.45 14433,-1030.45"/>
<polygon fill="black" stroke="black" points="14436.5,-1030.45 14433,-1020.45 14429.5,-1030.45 14436.5,-1030.45"/>
</g>
<!-- ffn_down_1_6&#45;&gt;ffn_all_reduce_1 -->
<g id="edge116" class="edge">
<title>ffn_down_1_6&#45;&gt;ffn_all_reduce_1</title>
<path fill="none" stroke="black" d="M14819.07,-1089.94C14819.07,-1089.94 14819.07,-1030.45 14819.07,-1030.45"/>
<polygon fill="black" stroke="black" points="14822.57,-1030.45 14819.07,-1020.45 14815.57,-1030.45 14822.57,-1030.45"/>
</g>
<!-- ffn_down_1_7&#45;&gt;ffn_all_reduce_1 -->
<g id="edge122" class="edge">
<title>ffn_down_1_7&#45;&gt;ffn_all_reduce_1</title>
<path fill="none" stroke="black" d="M15685,-1090.33C15685,-1056.95 15685,-1011 15685,-1011 15685,-1011 14858.59,-1011 14858.59,-1011"/>
<polygon fill="black" stroke="black" points="14858.59,-1007.5 14848.59,-1011 14858.59,-1014.5 14858.59,-1007.5"/>
</g>
<!-- ffn_all_reduce_1&#45;&gt;residual_ffn_1 -->
<g id="edge124" class="edge">
<title>ffn_all_reduce_1&#45;&gt;residual_ffn_1</title>
<path fill="none" stroke="black" d="M14017.99,-894C13630.44,-894 13111.35,-894 13111.35,-894 13111.35,-894 13111.35,-822.3 13111.35,-822.3"/>
<polygon fill="black" stroke="black" points="13114.85,-822.3 13111.35,-812.3 13107.85,-822.3 13114.85,-822.3"/>
</g>
<!-- residual_ffn_2 -->
<g id="node151" class="node">
<title>residual_ffn_2</title>
<ellipse fill="orange" stroke="black" cx="12888" cy="-608.33" rx="297.88" ry="48.17"/>
<text text-anchor="middle" x="12888" y="-627.13" font-family="Times,serif" font-size="14.00">Residual Add FFN 2</text>
<text text-anchor="middle" x="12888" y="-612.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096] x 2</text>
<text text-anchor="middle" x="12888" y="-597.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="12888" y="-582.13" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- residual_ffn_1&#45;&gt;residual_ffn_2 -->
<g id="edge173" class="edge">
<title>residual_ffn_1&#45;&gt;residual_ffn_2</title>
<path fill="none" stroke="black" d="M12788.77,-734.69C12788.77,-734.69 12788.77,-663.89 12788.77,-663.89"/>
<polygon fill="black" stroke="black" points="12792.27,-663.89 12788.77,-653.89 12785.27,-663.89 12792.27,-663.89"/>
</g>
<!-- gelu_2_0 -->
<g id="node134" class="node">
<title>gelu_2_0</title>
<polygon fill="lightblue" stroke="black" points="23570,-1158.33 23170,-1158.33 23170,-1090.33 23570,-1090.33 23570,-1158.33"/>
<text text-anchor="middle" x="23370" y="-1143.13" font-family="Times,serif" font-size="14.00">GELU 2 Part 0</text>
<text text-anchor="middle" x="23370" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="23370" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="23370" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_gate_2_0&#45;&gt;gelu_2_0 -->
<g id="edge127" class="edge">
<title>ffn_gate_2_0&#45;&gt;gelu_2_0</title>
<path fill="none" stroke="black" d="M23370,-1228.22C23370,-1228.22 23370,-1168.53 23370,-1168.53"/>
<polygon fill="black" stroke="black" points="23373.5,-1168.53 23370,-1158.53 23366.5,-1168.53 23373.5,-1168.53"/>
</g>
<!-- gelu_2_1 -->
<g id="node135" class="node">
<title>gelu_2_1</title>
<polygon fill="lightblue" stroke="black" points="24442,-1158.33 24042,-1158.33 24042,-1090.33 24442,-1090.33 24442,-1158.33"/>
<text text-anchor="middle" x="24242" y="-1143.13" font-family="Times,serif" font-size="14.00">GELU 2 Part 1</text>
<text text-anchor="middle" x="24242" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="24242" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="24242" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_gate_2_1&#45;&gt;gelu_2_1 -->
<g id="edge133" class="edge">
<title>ffn_gate_2_1&#45;&gt;gelu_2_1</title>
<path fill="none" stroke="black" d="M24242,-1228.22C24242,-1228.22 24242,-1168.53 24242,-1168.53"/>
<polygon fill="black" stroke="black" points="24245.5,-1168.53 24242,-1158.53 24238.5,-1168.53 24245.5,-1168.53"/>
</g>
<!-- gelu_2_2 -->
<g id="node136" class="node">
<title>gelu_2_2</title>
<polygon fill="lightblue" stroke="black" points="18774,-1158.33 18374,-1158.33 18374,-1090.33 18774,-1090.33 18774,-1158.33"/>
<text text-anchor="middle" x="18574" y="-1143.13" font-family="Times,serif" font-size="14.00">GELU 2 Part 2</text>
<text text-anchor="middle" x="18574" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="18574" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="18574" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_gate_2_2&#45;&gt;gelu_2_2 -->
<g id="edge139" class="edge">
<title>ffn_gate_2_2&#45;&gt;gelu_2_2</title>
<path fill="none" stroke="black" d="M18138,-1228.14C18138,-1187.17 18138,-1124 18138,-1124 18138,-1124 18363.86,-1124 18363.86,-1124"/>
<polygon fill="black" stroke="black" points="18363.87,-1127.5 18373.86,-1124 18363.86,-1120.5 18363.87,-1127.5"/>
</g>
<!-- gelu_2_3 -->
<g id="node137" class="node">
<title>gelu_2_3</title>
<polygon fill="lightblue" stroke="black" points="19646,-1158.33 19246,-1158.33 19246,-1090.33 19646,-1090.33 19646,-1158.33"/>
<text text-anchor="middle" x="19446" y="-1143.13" font-family="Times,serif" font-size="14.00">GELU 2 Part 3</text>
<text text-anchor="middle" x="19446" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="19446" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="19446" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_gate_2_3&#45;&gt;gelu_2_3 -->
<g id="edge145" class="edge">
<title>ffn_gate_2_3&#45;&gt;gelu_2_3</title>
<path fill="none" stroke="black" d="M19156,-1228.14C19156,-1187.17 19156,-1124 19156,-1124 19156,-1124 19235.77,-1124 19235.77,-1124"/>
<polygon fill="black" stroke="black" points="19235.77,-1127.5 19245.77,-1124 19235.77,-1120.5 19235.77,-1127.5"/>
</g>
<!-- gelu_2_4 -->
<g id="node138" class="node">
<title>gelu_2_4</title>
<polygon fill="lightblue" stroke="black" points="20518,-1158.33 20118,-1158.33 20118,-1090.33 20518,-1090.33 20518,-1158.33"/>
<text text-anchor="middle" x="20318" y="-1143.13" font-family="Times,serif" font-size="14.00">GELU 2 Part 4</text>
<text text-anchor="middle" x="20318" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="20318" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="20318" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_gate_2_4&#45;&gt;gelu_2_4 -->
<g id="edge151" class="edge">
<title>ffn_gate_2_4&#45;&gt;gelu_2_4</title>
<path fill="none" stroke="black" d="M20028,-1228.14C20028,-1187.17 20028,-1124 20028,-1124 20028,-1124 20107.77,-1124 20107.77,-1124"/>
<polygon fill="black" stroke="black" points="20107.77,-1127.5 20117.77,-1124 20107.77,-1120.5 20107.77,-1127.5"/>
</g>
<!-- gelu_2_5 -->
<g id="node139" class="node">
<title>gelu_2_5</title>
<polygon fill="lightblue" stroke="black" points="21172,-1158.33 20772,-1158.33 20772,-1090.33 21172,-1090.33 21172,-1158.33"/>
<text text-anchor="middle" x="20972" y="-1143.13" font-family="Times,serif" font-size="14.00">GELU 2 Part 5</text>
<text text-anchor="middle" x="20972" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="20972" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="20972" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_gate_2_5&#45;&gt;gelu_2_5 -->
<g id="edge157" class="edge">
<title>ffn_gate_2_5&#45;&gt;gelu_2_5</title>
<path fill="none" stroke="black" d="M20863,-1228.22C20863,-1228.22 20863,-1168.53 20863,-1168.53"/>
<polygon fill="black" stroke="black" points="20866.5,-1168.53 20863,-1158.53 20859.5,-1168.53 20866.5,-1168.53"/>
</g>
<!-- gelu_2_6 -->
<g id="node140" class="node">
<title>gelu_2_6</title>
<polygon fill="lightblue" stroke="black" points="21826,-1158.33 21426,-1158.33 21426,-1090.33 21826,-1090.33 21826,-1158.33"/>
<text text-anchor="middle" x="21626" y="-1143.13" font-family="Times,serif" font-size="14.00">GELU 2 Part 6</text>
<text text-anchor="middle" x="21626" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="21626" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="21626" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_gate_2_6&#45;&gt;gelu_2_6 -->
<g id="edge163" class="edge">
<title>ffn_gate_2_6&#45;&gt;gelu_2_6</title>
<path fill="none" stroke="black" d="M21626,-1228.22C21626,-1228.22 21626,-1168.53 21626,-1168.53"/>
<polygon fill="black" stroke="black" points="21629.5,-1168.53 21626,-1158.53 21622.5,-1168.53 21629.5,-1168.53"/>
</g>
<!-- gelu_2_7 -->
<g id="node141" class="node">
<title>gelu_2_7</title>
<polygon fill="lightblue" stroke="black" points="22698,-1158.33 22298,-1158.33 22298,-1090.33 22698,-1090.33 22698,-1158.33"/>
<text text-anchor="middle" x="22498" y="-1143.13" font-family="Times,serif" font-size="14.00">GELU 2 Part 7</text>
<text text-anchor="middle" x="22498" y="-1128.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="22498" y="-1113.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="22498" y="-1098.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_gate_2_7&#45;&gt;gelu_2_7 -->
<g id="edge169" class="edge">
<title>ffn_gate_2_7&#45;&gt;gelu_2_7</title>
<path fill="none" stroke="black" d="M22498,-1228.22C22498,-1228.22 22498,-1168.53 22498,-1168.53"/>
<polygon fill="black" stroke="black" points="22501.5,-1168.53 22498,-1158.53 22494.5,-1168.53 22501.5,-1168.53"/>
</g>
<!-- ffn_up_2_0&#45;&gt;gelu_2_0 -->
<g id="edge128" class="edge">
<title>ffn_up_2_0&#45;&gt;gelu_2_0</title>
<path fill="none" stroke="black" d="M23626,-1228.21C23626,-1190.49 23626,-1135 23626,-1135 23626,-1135 23580.14,-1135 23580.14,-1135"/>
<polygon fill="black" stroke="black" points="23580.14,-1131.5 23570.14,-1135 23580.14,-1138.5 23580.14,-1131.5"/>
</g>
<!-- ffn_up_2_1&#45;&gt;gelu_2_1 -->
<g id="edge134" class="edge">
<title>ffn_up_2_1&#45;&gt;gelu_2_1</title>
<path fill="none" stroke="black" d="M24678,-1228.14C24678,-1187.17 24678,-1124 24678,-1124 24678,-1124 24452.14,-1124 24452.14,-1124"/>
<polygon fill="black" stroke="black" points="24452.14,-1120.5 24442.14,-1124 24452.13,-1127.5 24452.14,-1120.5"/>
</g>
<!-- ffn_up_2_2&#45;&gt;gelu_2_2 -->
<g id="edge140" class="edge">
<title>ffn_up_2_2&#45;&gt;gelu_2_2</title>
<path fill="none" stroke="black" d="M18574,-1228.22C18574,-1228.22 18574,-1168.53 18574,-1168.53"/>
<polygon fill="black" stroke="black" points="18577.5,-1168.53 18574,-1158.53 18570.5,-1168.53 18577.5,-1168.53"/>
</g>
<!-- ffn_up_2_3&#45;&gt;gelu_2_3 -->
<g id="edge146" class="edge">
<title>ffn_up_2_3&#45;&gt;gelu_2_3</title>
<path fill="none" stroke="black" d="M19446,-1228.22C19446,-1228.22 19446,-1168.53 19446,-1168.53"/>
<polygon fill="black" stroke="black" points="19449.5,-1168.53 19446,-1158.53 19442.5,-1168.53 19449.5,-1168.53"/>
</g>
<!-- ffn_up_2_4&#45;&gt;gelu_2_4 -->
<g id="edge152" class="edge">
<title>ffn_up_2_4&#45;&gt;gelu_2_4</title>
<path fill="none" stroke="black" d="M20318,-1228.22C20318,-1228.22 20318,-1168.53 20318,-1168.53"/>
<polygon fill="black" stroke="black" points="20321.5,-1168.53 20318,-1158.53 20314.5,-1168.53 20321.5,-1168.53"/>
</g>
<!-- ffn_up_2_5&#45;&gt;gelu_2_5 -->
<g id="edge158" class="edge">
<title>ffn_up_2_5&#45;&gt;gelu_2_5</title>
<path fill="none" stroke="black" d="M21081,-1228.22C21081,-1228.22 21081,-1168.53 21081,-1168.53"/>
<polygon fill="black" stroke="black" points="21084.5,-1168.53 21081,-1158.53 21077.5,-1168.53 21084.5,-1168.53"/>
</g>
<!-- ffn_up_2_6&#45;&gt;gelu_2_6 -->
<g id="edge164" class="edge">
<title>ffn_up_2_6&#45;&gt;gelu_2_6</title>
<path fill="none" stroke="black" d="M21943.5,-1228.14C21943.5,-1187.17 21943.5,-1124 21943.5,-1124 21943.5,-1124 21836.18,-1124 21836.18,-1124"/>
<polygon fill="black" stroke="black" points="21836.18,-1120.5 21826.18,-1124 21836.18,-1127.5 21836.18,-1120.5"/>
</g>
<!-- ffn_up_2_7&#45;&gt;gelu_2_7 -->
<g id="edge170" class="edge">
<title>ffn_up_2_7&#45;&gt;gelu_2_7</title>
<path fill="none" stroke="black" d="M22774.5,-1228.14C22774.5,-1187.17 22774.5,-1124 22774.5,-1124 22774.5,-1124 22708.21,-1124 22708.21,-1124"/>
<polygon fill="black" stroke="black" points="22708.21,-1120.5 22698.21,-1124 22708.21,-1127.5 22708.21,-1120.5"/>
</g>
<!-- ffn_down_2_0 -->
<g id="node142" class="node">
<title>ffn_down_2_0</title>
<polygon fill="lightblue" stroke="black" points="23213,-986.33 22815,-986.33 22815,-918.33 23213,-918.33 23213,-986.33"/>
<text text-anchor="middle" x="23014" y="-971.13" font-family="Times,serif" font-size="14.00">FFN Down 2 Part 0</text>
<text text-anchor="middle" x="23014" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="23014" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="23014" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gelu_2_0&#45;&gt;ffn_down_2_0 -->
<g id="edge129" class="edge">
<title>gelu_2_0&#45;&gt;ffn_down_2_0</title>
<path fill="none" stroke="black" d="M23191.5,-1089.94C23191.5,-1089.94 23191.5,-996.37 23191.5,-996.37"/>
<polygon fill="black" stroke="black" points="23195,-996.37 23191.5,-986.37 23188,-996.37 23195,-996.37"/>
</g>
<!-- ffn_down_2_1 -->
<g id="node143" class="node">
<title>ffn_down_2_1</title>
<polygon fill="lightblue" stroke="black" points="24044,-986.33 23646,-986.33 23646,-918.33 24044,-918.33 24044,-986.33"/>
<text text-anchor="middle" x="23845" y="-971.13" font-family="Times,serif" font-size="14.00">FFN Down 2 Part 1</text>
<text text-anchor="middle" x="23845" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="23845" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="23845" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gelu_2_1&#45;&gt;ffn_down_2_1 -->
<g id="edge135" class="edge">
<title>gelu_2_1&#45;&gt;ffn_down_2_1</title>
<path fill="none" stroke="black" d="M24041.84,-1112C24030.74,-1112 24024,-1112 24024,-1112 24024,-1112 24024,-996.59 24024,-996.59"/>
<polygon fill="black" stroke="black" points="24027.5,-996.59 24024,-986.59 24020.5,-996.59 24027.5,-996.59"/>
</g>
<!-- ffn_down_2_2 -->
<g id="node144" class="node">
<title>ffn_down_2_2</title>
<polygon fill="lightblue" stroke="black" points="19102,-986.33 18704,-986.33 18704,-918.33 19102,-918.33 19102,-986.33"/>
<text text-anchor="middle" x="18903" y="-971.13" font-family="Times,serif" font-size="14.00">FFN Down 2 Part 2</text>
<text text-anchor="middle" x="18903" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="18903" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="18903" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gelu_2_2&#45;&gt;ffn_down_2_2 -->
<g id="edge141" class="edge">
<title>gelu_2_2&#45;&gt;ffn_down_2_2</title>
<path fill="none" stroke="black" d="M18739,-1089.94C18739,-1089.94 18739,-996.37 18739,-996.37"/>
<polygon fill="black" stroke="black" points="18742.5,-996.37 18739,-986.37 18735.5,-996.37 18742.5,-996.37"/>
</g>
<!-- ffn_down_2_3 -->
<g id="node145" class="node">
<title>ffn_down_2_3</title>
<polygon fill="lightblue" stroke="black" points="19974,-986.33 19576,-986.33 19576,-918.33 19974,-918.33 19974,-986.33"/>
<text text-anchor="middle" x="19775" y="-971.13" font-family="Times,serif" font-size="14.00">FFN Down 2 Part 3</text>
<text text-anchor="middle" x="19775" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="19775" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="19775" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gelu_2_3&#45;&gt;ffn_down_2_3 -->
<g id="edge147" class="edge">
<title>gelu_2_3&#45;&gt;ffn_down_2_3</title>
<path fill="none" stroke="black" d="M19611,-1089.94C19611,-1089.94 19611,-996.37 19611,-996.37"/>
<polygon fill="black" stroke="black" points="19614.5,-996.37 19611,-986.37 19607.5,-996.37 19614.5,-996.37"/>
</g>
<!-- ffn_down_2_4 -->
<g id="node146" class="node">
<title>ffn_down_2_4</title>
<polygon fill="lightblue" stroke="black" points="20627,-986.33 20229,-986.33 20229,-918.33 20627,-918.33 20627,-986.33"/>
<text text-anchor="middle" x="20428" y="-971.13" font-family="Times,serif" font-size="14.00">FFN Down 2 Part 4</text>
<text text-anchor="middle" x="20428" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="20428" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="20428" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gelu_2_4&#45;&gt;ffn_down_2_4 -->
<g id="edge153" class="edge">
<title>gelu_2_4&#45;&gt;ffn_down_2_4</title>
<path fill="none" stroke="black" d="M20373.5,-1089.94C20373.5,-1089.94 20373.5,-996.37 20373.5,-996.37"/>
<polygon fill="black" stroke="black" points="20377,-996.37 20373.5,-986.37 20370,-996.37 20377,-996.37"/>
</g>
<!-- ffn_down_2_5 -->
<g id="node147" class="node">
<title>ffn_down_2_5</title>
<polygon fill="lightblue" stroke="black" points="21171,-986.33 20773,-986.33 20773,-918.33 21171,-918.33 21171,-986.33"/>
<text text-anchor="middle" x="20972" y="-971.13" font-family="Times,serif" font-size="14.00">FFN Down 2 Part 5</text>
<text text-anchor="middle" x="20972" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="20972" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="20972" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gelu_2_5&#45;&gt;ffn_down_2_5 -->
<g id="edge159" class="edge">
<title>gelu_2_5&#45;&gt;ffn_down_2_5</title>
<path fill="none" stroke="black" d="M20972,-1089.94C20972,-1089.94 20972,-996.37 20972,-996.37"/>
<polygon fill="black" stroke="black" points="20975.5,-996.37 20972,-986.37 20968.5,-996.37 20975.5,-996.37"/>
</g>
<!-- ffn_down_2_6 -->
<g id="node148" class="node">
<title>ffn_down_2_6</title>
<polygon fill="lightblue" stroke="black" points="21715,-986.33 21317,-986.33 21317,-918.33 21715,-918.33 21715,-986.33"/>
<text text-anchor="middle" x="21516" y="-971.13" font-family="Times,serif" font-size="14.00">FFN Down 2 Part 6</text>
<text text-anchor="middle" x="21516" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="21516" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="21516" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gelu_2_6&#45;&gt;ffn_down_2_6 -->
<g id="edge165" class="edge">
<title>gelu_2_6&#45;&gt;ffn_down_2_6</title>
<path fill="none" stroke="black" d="M21570.5,-1089.94C21570.5,-1089.94 21570.5,-996.37 21570.5,-996.37"/>
<polygon fill="black" stroke="black" points="21574,-996.37 21570.5,-986.37 21567,-996.37 21574,-996.37"/>
</g>
<!-- ffn_down_2_7 -->
<g id="node149" class="node">
<title>ffn_down_2_7</title>
<polygon fill="lightblue" stroke="black" points="22423,-986.33 22025,-986.33 22025,-918.33 22423,-918.33 22423,-986.33"/>
<text text-anchor="middle" x="22224" y="-971.13" font-family="Times,serif" font-size="14.00">FFN Down 2 Part 7</text>
<text text-anchor="middle" x="22224" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="22224" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="22224" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gelu_2_7&#45;&gt;ffn_down_2_7 -->
<g id="edge171" class="edge">
<title>gelu_2_7&#45;&gt;ffn_down_2_7</title>
<path fill="none" stroke="black" d="M22360.5,-1089.94C22360.5,-1089.94 22360.5,-996.37 22360.5,-996.37"/>
<polygon fill="black" stroke="black" points="22364,-996.37 22360.5,-986.37 22357,-996.37 22364,-996.37"/>
</g>
<!-- ffn_all_reduce_2 -->
<g id="node150" class="node">
<title>ffn_all_reduce_2</title>
<polygon fill="lightyellow" stroke="black" points="21399.28,-848.33 20719.57,-848.33 20544.72,-712.33 21224.43,-712.33 21399.28,-848.33"/>
<text text-anchor="middle" x="20972" y="-799.13" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce 2</text>
<text text-anchor="middle" x="20972" y="-784.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512] x 8</text>
<text text-anchor="middle" x="20972" y="-769.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="20972" y="-754.13" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ffn_down_2_0&#45;&gt;ffn_all_reduce_2 -->
<g id="edge130" class="edge">
<title>ffn_down_2_0&#45;&gt;ffn_all_reduce_2</title>
<path fill="none" stroke="black" d="M23014,-918.29C23014,-868.06 23014,-780 23014,-780 23014,-780 21321.49,-780 21321.49,-780"/>
<polygon fill="black" stroke="black" points="21321.49,-776.5 21311.49,-780 21321.49,-783.5 21321.49,-776.5"/>
</g>
<!-- ffn_down_2_1&#45;&gt;ffn_all_reduce_2 -->
<g id="edge136" class="edge">
<title>ffn_down_2_1&#45;&gt;ffn_all_reduce_2</title>
<path fill="none" stroke="black" d="M23845,-918.26C23845,-859.66 23845,-746 23845,-746 23845,-746 21277.97,-746 21277.97,-746"/>
<polygon fill="black" stroke="black" points="21277.97,-742.5 21267.97,-746 21277.97,-749.5 21277.97,-742.5"/>
</g>
<!-- ffn_down_2_2&#45;&gt;ffn_all_reduce_2 -->
<g id="edge142" class="edge">
<title>ffn_down_2_2&#45;&gt;ffn_all_reduce_2</title>
<path fill="none" stroke="black" d="M18903,-918.08C18903,-883.45 18903,-835 18903,-835 18903,-835 20692.31,-835 20692.31,-835"/>
<polygon fill="black" stroke="black" points="20692.31,-838.5 20702.31,-835 20692.31,-831.5 20692.31,-838.5"/>
</g>
<!-- ffn_down_2_3&#45;&gt;ffn_all_reduce_2 -->
<g id="edge148" class="edge">
<title>ffn_down_2_3&#45;&gt;ffn_all_reduce_2</title>
<path fill="none" stroke="black" d="M19775,-918.32C19775,-885.58 19775,-841 19775,-841 19775,-841 20700.05,-841 20700.05,-841"/>
<polygon fill="black" stroke="black" points="20700.05,-844.5 20710.05,-841 20700.05,-837.5 20700.05,-844.5"/>
</g>
<!-- ffn_down_2_4&#45;&gt;ffn_all_reduce_2 -->
<g id="edge154" class="edge">
<title>ffn_down_2_4&#45;&gt;ffn_all_reduce_2</title>
<path fill="none" stroke="black" d="M20585.93,-917.94C20585.93,-917.94 20585.93,-790.4 20585.93,-790.4"/>
<polygon fill="black" stroke="black" points="20589.43,-790.4 20585.93,-780.4 20582.43,-790.4 20589.43,-790.4"/>
</g>
<!-- ffn_down_2_5&#45;&gt;ffn_all_reduce_2 -->
<g id="edge160" class="edge">
<title>ffn_down_2_5&#45;&gt;ffn_all_reduce_2</title>
<path fill="none" stroke="black" d="M20972,-917.94C20972,-917.94 20972,-858.45 20972,-858.45"/>
<polygon fill="black" stroke="black" points="20975.5,-858.45 20972,-848.45 20968.5,-858.45 20975.5,-858.45"/>
</g>
<!-- ffn_down_2_6&#45;&gt;ffn_all_reduce_2 -->
<g id="edge166" class="edge">
<title>ffn_down_2_6&#45;&gt;ffn_all_reduce_2</title>
<path fill="none" stroke="black" d="M21358.07,-917.94C21358.07,-917.94 21358.07,-858.45 21358.07,-858.45"/>
<polygon fill="black" stroke="black" points="21361.57,-858.45 21358.07,-848.45 21354.57,-858.45 21361.57,-858.45"/>
</g>
<!-- ffn_down_2_7&#45;&gt;ffn_all_reduce_2 -->
<g id="edge172" class="edge">
<title>ffn_down_2_7&#45;&gt;ffn_all_reduce_2</title>
<path fill="none" stroke="black" d="M22224,-918.14C22224,-877.17 22224,-814 22224,-814 22224,-814 21365.3,-814 21365.3,-814"/>
<polygon fill="black" stroke="black" points="21365.3,-810.5 21355.3,-814 21365.3,-817.5 21365.3,-810.5"/>
</g>
<!-- ffn_all_reduce_2&#45;&gt;residual_ffn_2 -->
<g id="edge174" class="edge">
<title>ffn_all_reduce_2&#45;&gt;residual_ffn_2</title>
<path fill="none" stroke="black" d="M20557.08,-722C18918.58,-722 12987.23,-722 12987.23,-722 12987.23,-722 12987.23,-663.91 12987.23,-663.91"/>
<polygon fill="black" stroke="black" points="12990.73,-663.91 12987.23,-653.91 12983.73,-663.91 12990.73,-663.91"/>
</g>
<!-- residual_ffn_3 -->
<g id="node185" class="node">
<title>residual_ffn_3</title>
<ellipse fill="orange" stroke="black" cx="7515" cy="-456.25" rx="297.88" ry="48.17"/>
<text text-anchor="middle" x="7515" y="-475.05" font-family="Times,serif" font-size="14.00">Residual Add FFN 3</text>
<text text-anchor="middle" x="7515" y="-460.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=4096] x 2</text>
<text text-anchor="middle" x="7515" y="-445.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="7515" y="-430.05" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- residual_ffn_2&#45;&gt;residual_ffn_3 -->
<g id="edge223" class="edge">
<title>residual_ffn_2&#45;&gt;residual_ffn_3</title>
<path fill="none" stroke="black" d="M12590.17,-608C11502.61,-608 7808.85,-608 7808.85,-608 7808.85,-608 7808.85,-473.98 7808.85,-473.98"/>
<polygon fill="black" stroke="black" points="7812.35,-473.98 7808.85,-463.98 7805.35,-473.98 7812.35,-473.98"/>
</g>
<!-- gelu_3_0 -->
<g id="node168" class="node">
<title>gelu_3_0</title>
<polygon fill="lightblue" stroke="black" points="5632,-986.33 5232,-986.33 5232,-918.33 5632,-918.33 5632,-986.33"/>
<text text-anchor="middle" x="5432" y="-971.13" font-family="Times,serif" font-size="14.00">GELU 3 Part 0</text>
<text text-anchor="middle" x="5432" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="5432" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="5432" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_gate_3_0&#45;&gt;gelu_3_0 -->
<g id="edge177" class="edge">
<title>ffn_gate_3_0&#45;&gt;gelu_3_0</title>
<path fill="none" stroke="black" d="M5432,-1089.94C5432,-1089.94 5432,-996.37 5432,-996.37"/>
<polygon fill="black" stroke="black" points="5435.5,-996.37 5432,-986.37 5428.5,-996.37 5435.5,-996.37"/>
</g>
<!-- gelu_3_1 -->
<g id="node169" class="node">
<title>gelu_3_1</title>
<polygon fill="lightblue" stroke="black" points="6504,-986.33 6104,-986.33 6104,-918.33 6504,-918.33 6504,-986.33"/>
<text text-anchor="middle" x="6304" y="-971.13" font-family="Times,serif" font-size="14.00">GELU 3 Part 1</text>
<text text-anchor="middle" x="6304" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="6304" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="6304" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_gate_3_1&#45;&gt;gelu_3_1 -->
<g id="edge183" class="edge">
<title>ffn_gate_3_1&#45;&gt;gelu_3_1</title>
<path fill="none" stroke="black" d="M6304,-1089.94C6304,-1089.94 6304,-996.37 6304,-996.37"/>
<polygon fill="black" stroke="black" points="6307.5,-996.37 6304,-986.37 6300.5,-996.37 6307.5,-996.37"/>
</g>
<!-- gelu_3_2 -->
<g id="node170" class="node">
<title>gelu_3_2</title>
<polygon fill="lightblue" stroke="black" points="836,-986.33 436,-986.33 436,-918.33 836,-918.33 836,-986.33"/>
<text text-anchor="middle" x="636" y="-971.13" font-family="Times,serif" font-size="14.00">GELU 3 Part 2</text>
<text text-anchor="middle" x="636" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="636" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="636" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_gate_3_2&#45;&gt;gelu_3_2 -->
<g id="edge189" class="edge">
<title>ffn_gate_3_2&#45;&gt;gelu_3_2</title>
<path fill="none" stroke="black" d="M200,-1090.29C200,-1040.06 200,-952 200,-952 200,-952 425.86,-952 425.86,-952"/>
<polygon fill="black" stroke="black" points="425.87,-955.5 435.86,-952 425.86,-948.5 425.87,-955.5"/>
</g>
<!-- gelu_3_3 -->
<g id="node171" class="node">
<title>gelu_3_3</title>
<polygon fill="lightblue" stroke="black" points="1708,-986.33 1308,-986.33 1308,-918.33 1708,-918.33 1708,-986.33"/>
<text text-anchor="middle" x="1508" y="-971.13" font-family="Times,serif" font-size="14.00">GELU 3 Part 3</text>
<text text-anchor="middle" x="1508" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="1508" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="1508" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_gate_3_3&#45;&gt;gelu_3_3 -->
<g id="edge195" class="edge">
<title>ffn_gate_3_3&#45;&gt;gelu_3_3</title>
<path fill="none" stroke="black" d="M1101.5,-1090.29C1101.5,-1040.06 1101.5,-952 1101.5,-952 1101.5,-952 1297.73,-952 1297.73,-952"/>
<polygon fill="black" stroke="black" points="1297.73,-955.5 1307.73,-952 1297.73,-948.5 1297.73,-955.5"/>
</g>
<!-- gelu_3_4 -->
<g id="node172" class="node">
<title>gelu_3_4</title>
<polygon fill="lightblue" stroke="black" points="2580,-986.33 2180,-986.33 2180,-918.33 2580,-918.33 2580,-986.33"/>
<text text-anchor="middle" x="2380" y="-971.13" font-family="Times,serif" font-size="14.00">GELU 3 Part 4</text>
<text text-anchor="middle" x="2380" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="2380" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="2380" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_gate_3_4&#45;&gt;gelu_3_4 -->
<g id="edge201" class="edge">
<title>ffn_gate_3_4&#45;&gt;gelu_3_4</title>
<path fill="none" stroke="black" d="M2138,-1090.12C2138,-1042.76 2138,-963 2138,-963 2138,-963 2169.88,-963 2169.88,-963"/>
<polygon fill="black" stroke="black" points="2169.88,-966.5 2179.88,-963 2169.88,-959.5 2169.88,-966.5"/>
</g>
<!-- gelu_3_5 -->
<g id="node173" class="node">
<title>gelu_3_5</title>
<polygon fill="lightblue" stroke="black" points="3452,-986.33 3052,-986.33 3052,-918.33 3452,-918.33 3452,-986.33"/>
<text text-anchor="middle" x="3252" y="-971.13" font-family="Times,serif" font-size="14.00">GELU 3 Part 5</text>
<text text-anchor="middle" x="3252" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="3252" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="3252" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_gate_3_5&#45;&gt;gelu_3_5 -->
<g id="edge207" class="edge">
<title>ffn_gate_3_5&#45;&gt;gelu_3_5</title>
<path fill="none" stroke="black" d="M2982.5,-1090.29C2982.5,-1040.06 2982.5,-952 2982.5,-952 2982.5,-952 3041.9,-952 3041.9,-952"/>
<polygon fill="black" stroke="black" points="3041.9,-955.5 3051.9,-952 3041.9,-948.5 3041.9,-955.5"/>
</g>
<!-- gelu_3_6 -->
<g id="node174" class="node">
<title>gelu_3_6</title>
<polygon fill="lightblue" stroke="black" points="4106,-986.33 3706,-986.33 3706,-918.33 4106,-918.33 4106,-986.33"/>
<text text-anchor="middle" x="3906" y="-971.13" font-family="Times,serif" font-size="14.00">GELU 3 Part 6</text>
<text text-anchor="middle" x="3906" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="3906" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="3906" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_gate_3_6&#45;&gt;gelu_3_6 -->
<g id="edge213" class="edge">
<title>ffn_gate_3_6&#45;&gt;gelu_3_6</title>
<path fill="none" stroke="black" d="M3797,-1089.94C3797,-1089.94 3797,-996.37 3797,-996.37"/>
<polygon fill="black" stroke="black" points="3800.5,-996.37 3797,-986.37 3793.5,-996.37 3800.5,-996.37"/>
</g>
<!-- gelu_3_7 -->
<g id="node175" class="node">
<title>gelu_3_7</title>
<polygon fill="lightblue" stroke="black" points="4760,-986.33 4360,-986.33 4360,-918.33 4760,-918.33 4760,-986.33"/>
<text text-anchor="middle" x="4560" y="-971.13" font-family="Times,serif" font-size="14.00">GELU 3 Part 7</text>
<text text-anchor="middle" x="4560" y="-956.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="4560" y="-941.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="4560" y="-926.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_gate_3_7&#45;&gt;gelu_3_7 -->
<g id="edge219" class="edge">
<title>ffn_gate_3_7&#45;&gt;gelu_3_7</title>
<path fill="none" stroke="black" d="M4560,-1089.94C4560,-1089.94 4560,-996.37 4560,-996.37"/>
<polygon fill="black" stroke="black" points="4563.5,-996.37 4560,-986.37 4556.5,-996.37 4563.5,-996.37"/>
</g>
<!-- ffn_up_3_0&#45;&gt;gelu_3_0 -->
<g id="edge178" class="edge">
<title>ffn_up_3_0&#45;&gt;gelu_3_0</title>
<path fill="none" stroke="black" d="M5672.5,-1090.29C5672.5,-1040.06 5672.5,-952 5672.5,-952 5672.5,-952 5642.25,-952 5642.25,-952"/>
<polygon fill="black" stroke="black" points="5642.25,-948.5 5632.25,-952 5642.25,-955.5 5642.25,-948.5"/>
</g>
<!-- ffn_up_3_1&#45;&gt;gelu_3_1 -->
<g id="edge184" class="edge">
<title>ffn_up_3_1&#45;&gt;gelu_3_1</title>
<path fill="none" stroke="black" d="M6559.33,-1090.29C6559.33,-1040.06 6559.33,-952 6559.33,-952 6559.33,-952 6514.24,-952 6514.24,-952"/>
<polygon fill="black" stroke="black" points="6514.24,-948.5 6504.24,-952 6514.24,-955.5 6514.24,-948.5"/>
</g>
<!-- ffn_up_3_2&#45;&gt;gelu_3_2 -->
<g id="edge190" class="edge">
<title>ffn_up_3_2&#45;&gt;gelu_3_2</title>
<path fill="none" stroke="black" d="M636,-1089.94C636,-1089.94 636,-996.37 636,-996.37"/>
<polygon fill="black" stroke="black" points="639.5,-996.37 636,-986.37 632.5,-996.37 639.5,-996.37"/>
</g>
<!-- ffn_up_3_3&#45;&gt;gelu_3_3 -->
<g id="edge196" class="edge">
<title>ffn_up_3_3&#45;&gt;gelu_3_3</title>
<path fill="none" stroke="black" d="M1508,-1089.94C1508,-1089.94 1508,-996.37 1508,-996.37"/>
<polygon fill="black" stroke="black" points="1511.5,-996.37 1508,-986.37 1504.5,-996.37 1511.5,-996.37"/>
</g>
<!-- ffn_up_3_4&#45;&gt;gelu_3_4 -->
<g id="edge202" class="edge">
<title>ffn_up_3_4&#45;&gt;gelu_3_4</title>
<path fill="none" stroke="black" d="M2380,-1089.94C2380,-1089.94 2380,-996.37 2380,-996.37"/>
<polygon fill="black" stroke="black" points="2383.5,-996.37 2380,-986.37 2376.5,-996.37 2383.5,-996.37"/>
</g>
<!-- ffn_up_3_5&#45;&gt;gelu_3_5 -->
<g id="edge208" class="edge">
<title>ffn_up_3_5&#45;&gt;gelu_3_5</title>
<path fill="none" stroke="black" d="M3252,-1089.94C3252,-1089.94 3252,-996.37 3252,-996.37"/>
<polygon fill="black" stroke="black" points="3255.5,-996.37 3252,-986.37 3248.5,-996.37 3255.5,-996.37"/>
</g>
<!-- ffn_up_3_6&#45;&gt;gelu_3_6 -->
<g id="edge214" class="edge">
<title>ffn_up_3_6&#45;&gt;gelu_3_6</title>
<path fill="none" stroke="black" d="M4015,-1089.94C4015,-1089.94 4015,-996.37 4015,-996.37"/>
<polygon fill="black" stroke="black" points="4018.5,-996.37 4015,-986.37 4011.5,-996.37 4018.5,-996.37"/>
</g>
<!-- ffn_up_3_7&#45;&gt;gelu_3_7 -->
<g id="edge220" class="edge">
<title>ffn_up_3_7&#45;&gt;gelu_3_7</title>
<path fill="none" stroke="black" d="M4877.5,-1090.29C4877.5,-1040.06 4877.5,-952 4877.5,-952 4877.5,-952 4770.18,-952 4770.18,-952"/>
<polygon fill="black" stroke="black" points="4770.18,-948.5 4760.18,-952 4770.18,-955.5 4770.18,-948.5"/>
</g>
<!-- ffn_down_3_0 -->
<g id="node176" class="node">
<title>ffn_down_3_0</title>
<polygon fill="lightblue" stroke="black" points="5357,-814.33 4959,-814.33 4959,-746.33 5357,-746.33 5357,-814.33"/>
<text text-anchor="middle" x="5158" y="-799.13" font-family="Times,serif" font-size="14.00">FFN Down 3 Part 0</text>
<text text-anchor="middle" x="5158" y="-784.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="5158" y="-769.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5158" y="-754.13" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gelu_3_0&#45;&gt;ffn_down_3_0 -->
<g id="edge179" class="edge">
<title>gelu_3_0&#45;&gt;ffn_down_3_0</title>
<path fill="none" stroke="black" d="M5294.5,-917.94C5294.5,-917.94 5294.5,-824.37 5294.5,-824.37"/>
<polygon fill="black" stroke="black" points="5298,-824.37 5294.5,-814.37 5291,-824.37 5298,-824.37"/>
</g>
<!-- ffn_down_3_1 -->
<g id="node177" class="node">
<title>ffn_down_3_1</title>
<polygon fill="lightblue" stroke="black" points="6147,-814.33 5749,-814.33 5749,-746.33 6147,-746.33 6147,-814.33"/>
<text text-anchor="middle" x="5948" y="-799.13" font-family="Times,serif" font-size="14.00">FFN Down 3 Part 1</text>
<text text-anchor="middle" x="5948" y="-784.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="5948" y="-769.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5948" y="-754.13" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gelu_3_1&#45;&gt;ffn_down_3_1 -->
<g id="edge185" class="edge">
<title>gelu_3_1&#45;&gt;ffn_down_3_1</title>
<path fill="none" stroke="black" d="M6125.5,-917.94C6125.5,-917.94 6125.5,-824.37 6125.5,-824.37"/>
<polygon fill="black" stroke="black" points="6129,-824.37 6125.5,-814.37 6122,-824.37 6129,-824.37"/>
</g>
<!-- ffn_down_3_2 -->
<g id="node178" class="node">
<title>ffn_down_3_2</title>
<polygon fill="lightblue" stroke="black" points="931,-814.33 533,-814.33 533,-746.33 931,-746.33 931,-814.33"/>
<text text-anchor="middle" x="732" y="-799.13" font-family="Times,serif" font-size="14.00">FFN Down 3 Part 2</text>
<text text-anchor="middle" x="732" y="-784.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="732" y="-769.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="732" y="-754.13" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gelu_3_2&#45;&gt;ffn_down_3_2 -->
<g id="edge191" class="edge">
<title>gelu_3_2&#45;&gt;ffn_down_3_2</title>
<path fill="none" stroke="black" d="M684.5,-917.94C684.5,-917.94 684.5,-824.37 684.5,-824.37"/>
<polygon fill="black" stroke="black" points="688,-824.37 684.5,-814.37 681,-824.37 688,-824.37"/>
</g>
<!-- ffn_down_3_3 -->
<g id="node179" class="node">
<title>ffn_down_3_3</title>
<polygon fill="lightblue" stroke="black" points="2132,-814.33 1734,-814.33 1734,-746.33 2132,-746.33 2132,-814.33"/>
<text text-anchor="middle" x="1933" y="-799.13" font-family="Times,serif" font-size="14.00">FFN Down 3 Part 3</text>
<text text-anchor="middle" x="1933" y="-784.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="1933" y="-769.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="1933" y="-754.13" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gelu_3_3&#45;&gt;ffn_down_3_3 -->
<g id="edge197" class="edge">
<title>gelu_3_3&#45;&gt;ffn_down_3_3</title>
<path fill="none" stroke="black" d="M1708.32,-940C1726.94,-940 1739,-940 1739,-940 1739,-940 1739,-824.59 1739,-824.59"/>
<polygon fill="black" stroke="black" points="1742.5,-824.59 1739,-814.59 1735.5,-824.59 1742.5,-824.59"/>
</g>
<!-- ffn_down_3_4 -->
<g id="node180" class="node">
<title>ffn_down_3_4</title>
<polygon fill="lightblue" stroke="black" points="2949,-814.33 2551,-814.33 2551,-746.33 2949,-746.33 2949,-814.33"/>
<text text-anchor="middle" x="2750" y="-799.13" font-family="Times,serif" font-size="14.00">FFN Down 3 Part 4</text>
<text text-anchor="middle" x="2750" y="-784.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="2750" y="-769.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="2750" y="-754.13" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gelu_3_4&#45;&gt;ffn_down_3_4 -->
<g id="edge203" class="edge">
<title>gelu_3_4&#45;&gt;ffn_down_3_4</title>
<path fill="none" stroke="black" d="M2565.5,-917.94C2565.5,-917.94 2565.5,-824.37 2565.5,-824.37"/>
<polygon fill="black" stroke="black" points="2569,-824.37 2565.5,-814.37 2562,-824.37 2569,-824.37"/>
</g>
<!-- ffn_down_3_5 -->
<g id="node181" class="node">
<title>ffn_down_3_5</title>
<polygon fill="lightblue" stroke="black" points="3575,-814.33 3177,-814.33 3177,-746.33 3575,-746.33 3575,-814.33"/>
<text text-anchor="middle" x="3376" y="-799.13" font-family="Times,serif" font-size="14.00">FFN Down 3 Part 5</text>
<text text-anchor="middle" x="3376" y="-784.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="3376" y="-769.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3376" y="-754.13" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gelu_3_5&#45;&gt;ffn_down_3_5 -->
<g id="edge209" class="edge">
<title>gelu_3_5&#45;&gt;ffn_down_3_5</title>
<path fill="none" stroke="black" d="M3314.5,-917.94C3314.5,-917.94 3314.5,-824.37 3314.5,-824.37"/>
<polygon fill="black" stroke="black" points="3318,-824.37 3314.5,-814.37 3311,-824.37 3318,-824.37"/>
</g>
<!-- ffn_down_3_6 -->
<g id="node182" class="node">
<title>ffn_down_3_6</title>
<polygon fill="lightblue" stroke="black" points="4105,-814.33 3707,-814.33 3707,-746.33 4105,-746.33 4105,-814.33"/>
<text text-anchor="middle" x="3906" y="-799.13" font-family="Times,serif" font-size="14.00">FFN Down 3 Part 6</text>
<text text-anchor="middle" x="3906" y="-784.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="3906" y="-769.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="3906" y="-754.13" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gelu_3_6&#45;&gt;ffn_down_3_6 -->
<g id="edge215" class="edge">
<title>gelu_3_6&#45;&gt;ffn_down_3_6</title>
<path fill="none" stroke="black" d="M3906,-917.94C3906,-917.94 3906,-824.37 3906,-824.37"/>
<polygon fill="black" stroke="black" points="3909.5,-824.37 3906,-814.37 3902.5,-824.37 3909.5,-824.37"/>
</g>
<!-- ffn_down_3_7 -->
<g id="node183" class="node">
<title>ffn_down_3_7</title>
<polygon fill="lightblue" stroke="black" points="4649,-814.33 4251,-814.33 4251,-746.33 4649,-746.33 4649,-814.33"/>
<text text-anchor="middle" x="4450" y="-799.13" font-family="Times,serif" font-size="14.00">FFN Down 3 Part 7</text>
<text text-anchor="middle" x="4450" y="-784.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, ffn_dim=1024]</text>
<text text-anchor="middle" x="4450" y="-769.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="4450" y="-754.13" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gelu_3_7&#45;&gt;ffn_down_3_7 -->
<g id="edge221" class="edge">
<title>gelu_3_7&#45;&gt;ffn_down_3_7</title>
<path fill="none" stroke="black" d="M4504.5,-917.94C4504.5,-917.94 4504.5,-824.37 4504.5,-824.37"/>
<polygon fill="black" stroke="black" points="4508,-824.37 4504.5,-814.37 4501,-824.37 4508,-824.37"/>
</g>
<!-- ffn_all_reduce_3 -->
<g id="node184" class="node">
<title>ffn_all_reduce_3</title>
<polygon fill="lightyellow" stroke="black" points="4333.28,-676.33 3653.57,-676.33 3478.72,-540.33 4158.43,-540.33 4333.28,-676.33"/>
<text text-anchor="middle" x="3906" y="-627.13" font-family="Times,serif" font-size="14.00">FFN All&#45;Reduce 3</text>
<text text-anchor="middle" x="3906" y="-612.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512] x 8</text>
<text text-anchor="middle" x="3906" y="-597.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, d_model=4096]</text>
<text text-anchor="middle" x="3906" y="-582.13" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ffn_down_3_0&#45;&gt;ffn_all_reduce_3 -->
<g id="edge180" class="edge">
<title>ffn_down_3_0&#45;&gt;ffn_all_reduce_3</title>
<path fill="none" stroke="black" d="M5158,-746.32C5158,-713.58 5158,-669 5158,-669 5158,-669 4334.2,-669 4334.2,-669"/>
<polygon fill="black" stroke="black" points="4334.2,-665.5 4324.2,-669 4334.2,-672.5 4334.2,-665.5"/>
</g>
<!-- ffn_down_3_1&#45;&gt;ffn_all_reduce_3 -->
<g id="edge186" class="edge">
<title>ffn_down_3_1&#45;&gt;ffn_all_reduce_3</title>
<path fill="none" stroke="black" d="M5867.67,-746.08C5867.67,-711.45 5867.67,-663 5867.67,-663 5867.67,-663 4326.33,-663 4326.33,-663"/>
<polygon fill="black" stroke="black" points="4326.33,-659.5 4316.33,-663 4326.33,-666.5 4326.33,-659.5"/>
</g>
<!-- ffn_down_3_2&#45;&gt;ffn_all_reduce_3 -->
<g id="edge192" class="edge">
<title>ffn_down_3_2&#45;&gt;ffn_all_reduce_3</title>
<path fill="none" stroke="black" d="M732,-746.26C732,-687.66 732,-574 732,-574 732,-574 3511.96,-574 3511.96,-574"/>
<polygon fill="black" stroke="black" points="3511.96,-577.5 3521.96,-574 3511.96,-570.5 3511.96,-577.5"/>
</g>
<!-- ffn_down_3_3&#45;&gt;ffn_all_reduce_3 -->
<g id="edge198" class="edge">
<title>ffn_down_3_3&#45;&gt;ffn_all_reduce_3</title>
<path fill="none" stroke="black" d="M1933,-746.29C1933,-696.06 1933,-608 1933,-608 1933,-608 3555.71,-608 3555.71,-608"/>
<polygon fill="black" stroke="black" points="3555.71,-611.5 3565.71,-608 3555.71,-604.5 3555.71,-611.5"/>
</g>
<!-- ffn_down_3_4&#45;&gt;ffn_all_reduce_3 -->
<g id="edge204" class="edge">
<title>ffn_down_3_4&#45;&gt;ffn_all_reduce_3</title>
<path fill="none" stroke="black" d="M2750,-746.14C2750,-705.17 2750,-642 2750,-642 2750,-642 3599.43,-642 3599.43,-642"/>
<polygon fill="black" stroke="black" points="3599.43,-645.5 3609.43,-642 3599.43,-638.5 3599.43,-645.5"/>
</g>
<!-- ffn_down_3_5&#45;&gt;ffn_all_reduce_3 -->
<g id="edge210" class="edge">
<title>ffn_down_3_5&#45;&gt;ffn_all_reduce_3</title>
<path fill="none" stroke="black" d="M3526.93,-745.94C3526.93,-745.94 3526.93,-618.4 3526.93,-618.4"/>
<polygon fill="black" stroke="black" points="3530.43,-618.4 3526.93,-608.4 3523.43,-618.4 3530.43,-618.4"/>
</g>
<!-- ffn_down_3_6&#45;&gt;ffn_all_reduce_3 -->
<g id="edge216" class="edge">
<title>ffn_down_3_6&#45;&gt;ffn_all_reduce_3</title>
<path fill="none" stroke="black" d="M3906,-745.94C3906,-745.94 3906,-686.45 3906,-686.45"/>
<polygon fill="black" stroke="black" points="3909.5,-686.45 3906,-676.45 3902.5,-686.45 3909.5,-686.45"/>
</g>
<!-- ffn_down_3_7&#45;&gt;ffn_all_reduce_3 -->
<g id="edge222" class="edge">
<title>ffn_down_3_7&#45;&gt;ffn_all_reduce_3</title>
<path fill="none" stroke="black" d="M4292.07,-745.94C4292.07,-745.94 4292.07,-686.45 4292.07,-686.45"/>
<polygon fill="black" stroke="black" points="4295.57,-686.45 4292.07,-676.45 4288.57,-686.45 4295.57,-686.45"/>
</g>
<!-- ffn_all_reduce_3&#45;&gt;residual_ffn_3 -->
<g id="edge224" class="edge">
<title>ffn_all_reduce_3&#45;&gt;residual_ffn_3</title>
<path fill="none" stroke="black" d="M4170.91,-550C4964.58,-550 7268.54,-550 7268.54,-550 7268.54,-550 7268.54,-493.37 7268.54,-493.37"/>
<polygon fill="black" stroke="black" points="7272.04,-493.37 7268.54,-483.37 7265.04,-493.37 7272.04,-493.37"/>
</g>
<!-- output_proj_0 -->
<g id="node186" class="node">
<title>output_proj_0</title>
<polygon fill="lightblue" stroke="black" points="6105,-372.17 5677,-372.17 5677,-304.17 6105,-304.17 6105,-372.17"/>
<text text-anchor="middle" x="5891" y="-356.97" font-family="Times,serif" font-size="14.00">Output Projection 0</text>
<text text-anchor="middle" x="5891" y="-341.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="5891" y="-326.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=dim/8]</text>
<text text-anchor="middle" x="5891" y="-311.97" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- residual_ffn_3&#45;&gt;output_proj_0 -->
<g id="edge225" class="edge">
<title>residual_ffn_3&#45;&gt;output_proj_0</title>
<path fill="none" stroke="black" d="M7256.12,-480C6820.1,-480 5986.33,-480 5986.33,-480 5986.33,-480 5986.33,-382.5 5986.33,-382.5"/>
<polygon fill="black" stroke="black" points="5989.83,-382.5 5986.33,-372.5 5982.83,-382.5 5989.83,-382.5"/>
</g>
<!-- output_proj_1 -->
<g id="node187" class="node">
<title>output_proj_1</title>
<polygon fill="lightblue" stroke="black" points="6569,-372.17 6141,-372.17 6141,-304.17 6569,-304.17 6569,-372.17"/>
<text text-anchor="middle" x="6355" y="-356.97" font-family="Times,serif" font-size="14.00">Output Projection 1</text>
<text text-anchor="middle" x="6355" y="-341.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6355" y="-326.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=dim/8]</text>
<text text-anchor="middle" x="6355" y="-311.97" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- residual_ffn_3&#45;&gt;output_proj_1 -->
<g id="edge227" class="edge">
<title>residual_ffn_3&#45;&gt;output_proj_1</title>
<path fill="none" stroke="black" d="M7217.16,-456C6933.56,-456 6549.67,-456 6549.67,-456 6549.67,-456 6549.67,-382.25 6549.67,-382.25"/>
<polygon fill="black" stroke="black" points="6553.17,-382.25 6549.67,-372.25 6546.17,-382.25 6553.17,-382.25"/>
</g>
<!-- output_proj_2 -->
<g id="node188" class="node">
<title>output_proj_2</title>
<polygon fill="lightblue" stroke="black" points="7033,-372.17 6605,-372.17 6605,-304.17 7033,-304.17 7033,-372.17"/>
<text text-anchor="middle" x="6819" y="-356.97" font-family="Times,serif" font-size="14.00">Output Projection 2</text>
<text text-anchor="middle" x="6819" y="-341.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="6819" y="-326.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=dim/8]</text>
<text text-anchor="middle" x="6819" y="-311.97" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- residual_ffn_3&#45;&gt;output_proj_2 -->
<g id="edge229" class="edge">
<title>residual_ffn_3&#45;&gt;output_proj_2</title>
<path fill="none" stroke="black" d="M7257.75,-432C7134.37,-432 7013,-432 7013,-432 7013,-432 7013,-382.31 7013,-382.31"/>
<polygon fill="black" stroke="black" points="7016.5,-382.31 7013,-372.31 7009.5,-382.31 7016.5,-382.31"/>
</g>
<!-- output_proj_3 -->
<g id="node189" class="node">
<title>output_proj_3</title>
<polygon fill="lightblue" stroke="black" points="7497,-372.17 7069,-372.17 7069,-304.17 7497,-304.17 7497,-372.17"/>
<text text-anchor="middle" x="7283" y="-356.97" font-family="Times,serif" font-size="14.00">Output Projection 3</text>
<text text-anchor="middle" x="7283" y="-341.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7283" y="-326.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=dim/8]</text>
<text text-anchor="middle" x="7283" y="-311.97" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- residual_ffn_3&#45;&gt;output_proj_3 -->
<g id="edge231" class="edge">
<title>residual_ffn_3&#45;&gt;output_proj_3</title>
<path fill="none" stroke="black" d="M7357.15,-415.28C7357.15,-415.28 7357.15,-382.4 7357.15,-382.4"/>
<polygon fill="black" stroke="black" points="7360.65,-382.4 7357.15,-372.4 7353.65,-382.4 7360.65,-382.4"/>
</g>
<!-- output_proj_4 -->
<g id="node190" class="node">
<title>output_proj_4</title>
<polygon fill="lightblue" stroke="black" points="7961,-372.17 7533,-372.17 7533,-304.17 7961,-304.17 7961,-372.17"/>
<text text-anchor="middle" x="7747" y="-356.97" font-family="Times,serif" font-size="14.00">Output Projection 4</text>
<text text-anchor="middle" x="7747" y="-341.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="7747" y="-326.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=dim/8]</text>
<text text-anchor="middle" x="7747" y="-311.97" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- residual_ffn_3&#45;&gt;output_proj_4 -->
<g id="edge233" class="edge">
<title>residual_ffn_3&#45;&gt;output_proj_4</title>
<path fill="none" stroke="black" d="M7672.85,-415.28C7672.85,-415.28 7672.85,-382.4 7672.85,-382.4"/>
<polygon fill="black" stroke="black" points="7676.35,-382.4 7672.85,-372.4 7669.35,-382.4 7676.35,-382.4"/>
</g>
<!-- output_proj_5 -->
<g id="node191" class="node">
<title>output_proj_5</title>
<polygon fill="lightblue" stroke="black" points="8425,-372.17 7997,-372.17 7997,-304.17 8425,-304.17 8425,-372.17"/>
<text text-anchor="middle" x="8211" y="-356.97" font-family="Times,serif" font-size="14.00">Output Projection 5</text>
<text text-anchor="middle" x="8211" y="-341.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8211" y="-326.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=dim/8]</text>
<text text-anchor="middle" x="8211" y="-311.97" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- residual_ffn_3&#45;&gt;output_proj_5 -->
<g id="edge235" class="edge">
<title>residual_ffn_3&#45;&gt;output_proj_5</title>
<path fill="none" stroke="black" d="M7772.18,-432C7897.66,-432 8021.93,-432 8021.93,-432 8021.93,-432 8021.93,-382.31 8021.93,-382.31"/>
<polygon fill="black" stroke="black" points="8025.43,-382.31 8021.93,-372.31 8018.43,-382.31 8025.43,-382.31"/>
</g>
<!-- output_proj_6 -->
<g id="node192" class="node">
<title>output_proj_6</title>
<polygon fill="lightblue" stroke="black" points="8889,-372.17 8461,-372.17 8461,-304.17 8889,-304.17 8889,-372.17"/>
<text text-anchor="middle" x="8675" y="-356.97" font-family="Times,serif" font-size="14.00">Output Projection 6</text>
<text text-anchor="middle" x="8675" y="-341.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="8675" y="-326.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=dim/8]</text>
<text text-anchor="middle" x="8675" y="-311.97" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- residual_ffn_3&#45;&gt;output_proj_6 -->
<g id="edge237" class="edge">
<title>residual_ffn_3&#45;&gt;output_proj_6</title>
<path fill="none" stroke="black" d="M7812.98,-456C8156.67,-456 8675,-456 8675,-456 8675,-456 8675,-382.25 8675,-382.25"/>
<polygon fill="black" stroke="black" points="8678.5,-382.25 8675,-372.25 8671.5,-382.25 8678.5,-382.25"/>
</g>
<!-- output_proj_7 -->
<g id="node193" class="node">
<title>output_proj_7</title>
<polygon fill="lightblue" stroke="black" points="9353,-372.17 8925,-372.17 8925,-304.17 9353,-304.17 9353,-372.17"/>
<text text-anchor="middle" x="9139" y="-356.97" font-family="Times,serif" font-size="14.00">Output Projection 7</text>
<text text-anchor="middle" x="9139" y="-341.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, d_model=512]</text>
<text text-anchor="middle" x="9139" y="-326.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=dim/8]</text>
<text text-anchor="middle" x="9139" y="-311.97" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- residual_ffn_3&#45;&gt;output_proj_7 -->
<g id="edge239" class="edge">
<title>residual_ffn_3&#45;&gt;output_proj_7</title>
<path fill="none" stroke="black" d="M7773.97,-480C8203.5,-480 9016.5,-480 9016.5,-480 9016.5,-480 9016.5,-382.5 9016.5,-382.5"/>
<polygon fill="black" stroke="black" points="9020,-382.5 9016.5,-372.5 9013,-382.5 9020,-382.5"/>
</g>
<!-- output_all_reduce -->
<g id="node194" class="node">
<title>output_all_reduce</title>
<polygon fill="lightyellow" stroke="black" points="7989.67,-268.17 7234.58,-268.17 7040.33,-132.17 7795.42,-132.17 7989.67,-268.17"/>
<text text-anchor="middle" x="7515" y="-218.97" font-family="Times,serif" font-size="14.00">Output All&#45;Reduce</text>
<text text-anchor="middle" x="7515" y="-203.97" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, vocab_size=dim/8] x 8</text>
<text text-anchor="middle" x="7515" y="-188.97" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=full_vocab]</text>
<text text-anchor="middle" x="7515" y="-173.97" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- output_proj_0&#45;&gt;output_all_reduce -->
<g id="edge226" class="edge">
<title>output_proj_0&#45;&gt;output_all_reduce</title>
<path fill="none" stroke="black" d="M5891,-303.99C5891,-256.68 5891,-177 5891,-177 5891,-177 7094.15,-177 7094.15,-177"/>
<polygon fill="black" stroke="black" points="7094.15,-180.5 7104.15,-177 7094.15,-173.5 7094.15,-180.5"/>
</g>
<!-- output_proj_1&#45;&gt;output_all_reduce -->
<g id="edge228" class="edge">
<title>output_proj_1&#45;&gt;output_all_reduce</title>
<path fill="none" stroke="black" d="M6355,-303.94C6355,-269.67 6355,-222 6355,-222 6355,-222 7158.53,-222 7158.53,-222"/>
<polygon fill="black" stroke="black" points="7158.53,-225.5 7168.53,-222 7158.53,-218.5 7158.53,-225.5"/>
</g>
<!-- output_proj_2&#45;&gt;output_all_reduce -->
<g id="edge230" class="edge">
<title>output_proj_2&#45;&gt;output_all_reduce</title>
<path fill="none" stroke="black" d="M7033.26,-338C7046.47,-338 7054.58,-338 7054.58,-338 7054.58,-338 7054.58,-210.27 7054.58,-210.27"/>
<polygon fill="black" stroke="black" points="7058.08,-210.27 7054.58,-200.27 7051.08,-210.27 7058.08,-210.27"/>
</g>
<!-- output_proj_3&#45;&gt;output_all_reduce -->
<g id="edge232" class="edge">
<title>output_proj_3&#45;&gt;output_all_reduce</title>
<path fill="none" stroke="black" d="M7283,-304.05C7283,-304.05 7283,-278.4 7283,-278.4"/>
<polygon fill="black" stroke="black" points="7286.5,-278.4 7283,-268.4 7279.5,-278.4 7286.5,-278.4"/>
</g>
<!-- output_proj_4&#45;&gt;output_all_reduce -->
<g id="edge234" class="edge">
<title>output_proj_4&#45;&gt;output_all_reduce</title>
<path fill="none" stroke="black" d="M7747,-304.05C7747,-304.05 7747,-278.4 7747,-278.4"/>
<polygon fill="black" stroke="black" points="7750.5,-278.4 7747,-268.4 7743.5,-278.4 7750.5,-278.4"/>
</g>
<!-- output_proj_5&#45;&gt;output_all_reduce -->
<g id="edge236" class="edge">
<title>output_proj_5&#45;&gt;output_all_reduce</title>
<path fill="none" stroke="black" d="M7996.74,-338C7983.53,-338 7975.42,-338 7975.42,-338 7975.42,-338 7975.42,-210.27 7975.42,-210.27"/>
<polygon fill="black" stroke="black" points="7978.92,-210.27 7975.42,-200.27 7971.92,-210.27 7978.92,-210.27"/>
</g>
<!-- output_proj_6&#45;&gt;output_all_reduce -->
<g id="edge238" class="edge">
<title>output_proj_6&#45;&gt;output_all_reduce</title>
<path fill="none" stroke="black" d="M8675,-303.94C8675,-269.67 8675,-222 8675,-222 8675,-222 7933.97,-222 7933.97,-222"/>
<polygon fill="black" stroke="black" points="7933.97,-218.5 7923.97,-222 7933.97,-225.5 7933.97,-218.5"/>
</g>
<!-- output_proj_7&#45;&gt;output_all_reduce -->
<g id="edge240" class="edge">
<title>output_proj_7&#45;&gt;output_all_reduce</title>
<path fill="none" stroke="black" d="M9139,-303.99C9139,-256.68 9139,-177 9139,-177 9139,-177 7869.91,-177 7869.91,-177"/>
<polygon fill="black" stroke="black" points="7869.91,-173.5 7859.91,-177 7869.91,-180.5 7869.91,-173.5"/>
</g>
<!-- output -->
<g id="node195" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="7515" cy="-48.08" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="7515" y="-66.88" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7515" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=?, vocab_size=full_vocab]</text>
<text text-anchor="middle" x="7515" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=?, vocab_size=full_vocab]</text>
<text text-anchor="middle" x="7515" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- output_all_reduce&#45;&gt;output -->
<g id="edge241" class="edge">
<title>output_all_reduce&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7515,-132.13C7515,-132.13 7515,-106.48 7515,-106.48"/>
<polygon fill="black" stroke="black" points="7518.5,-106.48 7515,-96.48 7511.5,-106.48 7518.5,-106.48"/>
</g>
</g>
</svg>
