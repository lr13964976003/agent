<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1177pt" height="2231pt"
 viewBox="0.00 0.00 1177.11 2231.08" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2227.08)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2227.08 1173.11,-2227.08 1173.11,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_base</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="8,-2138.08 8,-2215.08 204,-2215.08 204,-2138.08 8,-2138.08"/>
<text text-anchor="middle" x="106" y="-2199.88" font-family="Times,serif" font-size="14.00">Base Layer (8 GPUs)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pool</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="224,-2138.08 224,-2215.08 440,-2215.08 440,-2138.08 224,-2138.08"/>
<text text-anchor="middle" x="332" y="-2199.88" font-family="Times,serif" font-size="14.00">Attention Pool (32 GPUs)</text>
</g>
<!-- base_start -->
<g id="node1" class="node">
<title>base_start</title>
<polygon fill="none" stroke="black" points="195.5,-2184.08 192.5,-2188.08 171.5,-2188.08 168.5,-2184.08 16.5,-2184.08 16.5,-2146.08 195.5,-2146.08 195.5,-2184.08"/>
<text text-anchor="middle" x="106" y="-2168.88" font-family="Times,serif" font-size="14.00">Base Layer Processing</text>
<text text-anchor="middle" x="106" y="-2153.88" font-family="Times,serif" font-size="14.00">GPU 0&#45;7</text>
</g>
<!-- pool_start -->
<g id="node2" class="node">
<title>pool_start</title>
<polygon fill="none" stroke="black" points="432,-2184.08 429,-2188.08 408,-2188.08 405,-2184.08 232,-2184.08 232,-2146.08 432,-2146.08 432,-2184.08"/>
<text text-anchor="middle" x="332" y="-2168.88" font-family="Times,serif" font-size="14.00">Attention Pool Processing</text>
<text text-anchor="middle" x="332" y="-2153.88" font-family="Times,serif" font-size="14.00">GPU 8&#45;39</text>
</g>
<!-- input_total -->
<g id="node3" class="node">
<title>input_total</title>
<ellipse fill="none" stroke="black" cx="800" cy="-2165.08" rx="332.18" ry="48.17"/>
<text text-anchor="middle" x="800" y="-2183.88" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="800" y="-2168.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len={seq_len}, d_model=4096]</text>
<text text-anchor="middle" x="800" y="-2153.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len={seq_len}, d_model=4096]</text>
<text text-anchor="middle" x="800" y="-2138.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- resource_manager -->
<g id="node4" class="node">
<title>resource_manager</title>
<polygon fill="none" stroke="black" points="800,-2081 606,-2013 800,-1945 994,-2013 800,-2081"/>
<text text-anchor="middle" x="800" y="-2031.8" font-family="Times,serif" font-size="14.00">Resource Manager</text>
<text text-anchor="middle" x="800" y="-2016.8" font-family="Times,serif" font-size="14.00">Sequence Length: 32768</text>
<text text-anchor="middle" x="800" y="-2001.8" font-family="Times,serif" font-size="14.00">Pool GPUs: 32</text>
<text text-anchor="middle" x="800" y="-1986.8" font-family="Times,serif" font-size="14.00">Total GPUs: 40</text>
</g>
<!-- input_total&#45;&gt;resource_manager -->
<g id="edge1" class="edge">
<title>input_total&#45;&gt;resource_manager</title>
<path fill="none" stroke="black" d="M800,-2116.96C800,-2116.96 800,-2091.09 800,-2091.09"/>
<polygon fill="black" stroke="black" points="803.5,-2091.09 800,-2081.09 796.5,-2091.09 803.5,-2091.09"/>
</g>
<!-- embeddings -->
<g id="node5" class="node">
<title>embeddings</title>
<polygon fill="none" stroke="black" points="1035,-1909 565,-1909 565,-1841 1035,-1841 1035,-1909"/>
<text text-anchor="middle" x="800" y="-1893.8" font-family="Times,serif" font-size="14.00">Token Embeddings</text>
<text text-anchor="middle" x="800" y="-1878.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len={seq_len}, d_model=4096]</text>
<text text-anchor="middle" x="800" y="-1863.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len={seq_len}, d_model=4096]</text>
<text text-anchor="middle" x="800" y="-1848.8" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (tensor parallel)</text>
</g>
<!-- resource_manager&#45;&gt;embeddings -->
<g id="edge2" class="edge">
<title>resource_manager&#45;&gt;embeddings</title>
<path fill="none" stroke="black" d="M800,-1944.81C800,-1944.81 800,-1919.21 800,-1919.21"/>
<polygon fill="black" stroke="black" points="803.5,-1919.21 800,-1909.21 796.5,-1919.21 803.5,-1919.21"/>
</g>
<!-- attention_0 -->
<g id="node6" class="node">
<title>attention_0</title>
<polygon fill="none" stroke="black" points="884,-1805 440,-1805 440,-1737 884,-1737 884,-1805"/>
<text text-anchor="middle" x="662" y="-1789.8" font-family="Times,serif" font-size="14.00">Layer 0 Attention</text>
<text text-anchor="middle" x="662" y="-1774.8" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-1759.8" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-1744.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;39</text>
</g>
<!-- embeddings&#45;&gt;attention_0 -->
<g id="edge3" class="edge">
<title>embeddings&#45;&gt;attention_0</title>
<path fill="none" stroke="black" d="M724.5,-1840.95C724.5,-1840.95 724.5,-1815.13 724.5,-1815.13"/>
<polygon fill="black" stroke="black" points="728,-1815.13 724.5,-1805.13 721,-1815.13 728,-1815.13"/>
</g>
<!-- residual_attn_0 -->
<g id="node8" class="node">
<title>residual_attn_0</title>
<ellipse fill="none" stroke="black" cx="800" cy="-1652.92" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="800" y="-1671.72" font-family="Times,serif" font-size="14.00">Residual Add Attention 0</text>
<text text-anchor="middle" x="800" y="-1656.72" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096] x 2</text>
<text text-anchor="middle" x="800" y="-1641.72" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="800" y="-1626.72" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- embeddings&#45;&gt;residual_attn_0 -->
<g id="edge5" class="edge">
<title>embeddings&#45;&gt;residual_attn_0</title>
<path fill="none" stroke="black" d="M959.5,-1840.79C959.5,-1840.79 959.5,-1705.14 959.5,-1705.14"/>
<polygon fill="black" stroke="black" points="963,-1705.14 959.5,-1695.14 956,-1705.14 963,-1705.14"/>
</g>
<!-- attention_0&#45;&gt;residual_attn_0 -->
<g id="edge4" class="edge">
<title>attention_0&#45;&gt;residual_attn_0</title>
<path fill="none" stroke="black" d="M680.07,-1736.84C680.07,-1736.84 680.07,-1707.99 680.07,-1707.99"/>
<polygon fill="black" stroke="black" points="683.57,-1707.99 680.07,-1697.99 676.57,-1707.99 683.57,-1707.99"/>
</g>
<!-- ffn_0 -->
<g id="node7" class="node">
<title>ffn_0</title>
<polygon fill="none" stroke="black" points="884,-1568.83 440,-1568.83 440,-1500.83 884,-1500.83 884,-1568.83"/>
<text text-anchor="middle" x="662" y="-1553.63" font-family="Times,serif" font-size="14.00">Layer 0 FFN</text>
<text text-anchor="middle" x="662" y="-1538.63" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-1523.63" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-1508.63" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (tensor parallel)</text>
</g>
<!-- residual_ffN_0 -->
<g id="node9" class="node">
<title>residual_ffN_0</title>
<ellipse fill="none" stroke="black" cx="800" cy="-1416.75" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="800" y="-1435.55" font-family="Times,serif" font-size="14.00">Residual Add FFN 0</text>
<text text-anchor="middle" x="800" y="-1420.55" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096] x 2</text>
<text text-anchor="middle" x="800" y="-1405.55" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="800" y="-1390.55" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_0&#45;&gt;residual_ffN_0 -->
<g id="edge8" class="edge">
<title>ffn_0&#45;&gt;residual_ffN_0</title>
<path fill="none" stroke="black" d="M680.07,-1500.68C680.07,-1500.68 680.07,-1471.82 680.07,-1471.82"/>
<polygon fill="black" stroke="black" points="683.57,-1471.82 680.07,-1461.82 676.57,-1471.82 683.57,-1471.82"/>
</g>
<!-- residual_attn_0&#45;&gt;ffn_0 -->
<g id="edge6" class="edge">
<title>residual_attn_0&#45;&gt;ffn_0</title>
<path fill="none" stroke="black" d="M680.07,-1607.94C680.07,-1607.94 680.07,-1579.03 680.07,-1579.03"/>
<polygon fill="black" stroke="black" points="683.57,-1579.03 680.07,-1569.03 676.57,-1579.03 683.57,-1579.03"/>
</g>
<!-- residual_attn_0&#45;&gt;residual_ffN_0 -->
<g id="edge7" class="edge">
<title>residual_attn_0&#45;&gt;residual_ffN_0</title>
<path fill="none" stroke="black" d="M1003.93,-1615.49C1003.93,-1615.49 1003.93,-1464.39 1003.93,-1464.39"/>
<polygon fill="black" stroke="black" points="1007.43,-1464.39 1003.93,-1454.39 1000.43,-1464.39 1007.43,-1464.39"/>
</g>
<!-- attention_1 -->
<g id="node10" class="node">
<title>attention_1</title>
<polygon fill="none" stroke="black" points="884,-1332.67 440,-1332.67 440,-1264.67 884,-1264.67 884,-1332.67"/>
<text text-anchor="middle" x="662" y="-1317.47" font-family="Times,serif" font-size="14.00">Layer 1 Attention</text>
<text text-anchor="middle" x="662" y="-1302.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-1287.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-1272.47" font-family="Times,serif" font-size="14.00">GPU: 8&#45;39</text>
</g>
<!-- residual_ffN_0&#45;&gt;attention_1 -->
<g id="edge9" class="edge">
<title>residual_ffN_0&#45;&gt;attention_1</title>
<path fill="none" stroke="black" d="M680.07,-1371.77C680.07,-1371.77 680.07,-1342.87 680.07,-1342.87"/>
<polygon fill="black" stroke="black" points="683.57,-1342.87 680.07,-1332.87 676.57,-1342.87 683.57,-1342.87"/>
</g>
<!-- residual_attn_1 -->
<g id="node20" class="node">
<title>residual_attn_1</title>
<ellipse fill="none" stroke="black" cx="800" cy="-1210.67" rx="81.79" ry="18"/>
<text text-anchor="middle" x="800" y="-1206.97" font-family="Times,serif" font-size="14.00">residual_attn_1</text>
</g>
<!-- residual_ffN_0&#45;&gt;residual_attn_1 -->
<g id="edge11" class="edge">
<title>residual_ffN_0&#45;&gt;residual_attn_1</title>
<path fill="none" stroke="black" d="M1043.9,-1384.94C1043.9,-1328.33 1043.9,-1216 1043.9,-1216 1043.9,-1216 888.52,-1216 888.52,-1216"/>
<polygon fill="black" stroke="black" points="888.52,-1212.5 878.52,-1216 888.52,-1219.5 888.52,-1212.5"/>
</g>
<!-- attention_1&#45;&gt;residual_attn_1 -->
<g id="edge10" class="edge">
<title>attention_1&#45;&gt;residual_attn_1</title>
<path fill="none" stroke="black" d="M800,-1264.64C800,-1264.64 800,-1238.86 800,-1238.86"/>
<polygon fill="black" stroke="black" points="803.5,-1238.86 800,-1228.86 796.5,-1238.86 803.5,-1238.86"/>
</g>
<!-- ffn_1 -->
<g id="node11" class="node">
<title>ffn_1</title>
<polygon fill="none" stroke="black" points="884,-1156.67 440,-1156.67 440,-1088.67 884,-1088.67 884,-1156.67"/>
<text text-anchor="middle" x="662" y="-1141.47" font-family="Times,serif" font-size="14.00">Layer 1 FFN</text>
<text text-anchor="middle" x="662" y="-1126.47" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-1111.47" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-1096.47" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (tensor parallel)</text>
</g>
<!-- residual_ffN_1 -->
<g id="node12" class="node">
<title>residual_ffN_1</title>
<ellipse fill="none" stroke="black" cx="800" cy="-1004.58" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="800" y="-1023.38" font-family="Times,serif" font-size="14.00">Residual Add FFN 1</text>
<text text-anchor="middle" x="800" y="-1008.38" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096] x 2</text>
<text text-anchor="middle" x="800" y="-993.38" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="800" y="-978.38" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_1&#45;&gt;residual_ffN_1 -->
<g id="edge13" class="edge">
<title>ffn_1&#45;&gt;residual_ffN_1</title>
<path fill="none" stroke="black" d="M680.07,-1088.51C680.07,-1088.51 680.07,-1059.65 680.07,-1059.65"/>
<polygon fill="black" stroke="black" points="683.57,-1059.65 680.07,-1049.65 676.57,-1059.65 683.57,-1059.65"/>
</g>
<!-- attention_2 -->
<g id="node13" class="node">
<title>attention_2</title>
<polygon fill="none" stroke="black" points="884,-920.5 440,-920.5 440,-852.5 884,-852.5 884,-920.5"/>
<text text-anchor="middle" x="662" y="-905.3" font-family="Times,serif" font-size="14.00">Layer 2 Attention</text>
<text text-anchor="middle" x="662" y="-890.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-875.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-860.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;39</text>
</g>
<!-- residual_ffN_1&#45;&gt;attention_2 -->
<g id="edge15" class="edge">
<title>residual_ffN_1&#45;&gt;attention_2</title>
<path fill="none" stroke="black" d="M680.07,-959.6C680.07,-959.6 680.07,-930.7 680.07,-930.7"/>
<polygon fill="black" stroke="black" points="683.57,-930.7 680.07,-920.7 676.57,-930.7 683.57,-930.7"/>
</g>
<!-- residual_attn_2 -->
<g id="node21" class="node">
<title>residual_attn_2</title>
<ellipse fill="none" stroke="black" cx="800" cy="-798.5" rx="81.79" ry="18"/>
<text text-anchor="middle" x="800" y="-794.8" font-family="Times,serif" font-size="14.00">residual_attn_2</text>
</g>
<!-- residual_ffN_1&#45;&gt;residual_attn_2 -->
<g id="edge17" class="edge">
<title>residual_ffN_1&#45;&gt;residual_attn_2</title>
<path fill="none" stroke="black" d="M1043.9,-972.8C1043.9,-916.24 1043.9,-804 1043.9,-804 1043.9,-804 888.18,-804 888.18,-804"/>
<polygon fill="black" stroke="black" points="888.18,-800.5 878.18,-804 888.18,-807.5 888.18,-800.5"/>
</g>
<!-- attention_2&#45;&gt;residual_attn_2 -->
<g id="edge16" class="edge">
<title>attention_2&#45;&gt;residual_attn_2</title>
<path fill="none" stroke="black" d="M800,-852.48C800,-852.48 800,-826.69 800,-826.69"/>
<polygon fill="black" stroke="black" points="803.5,-826.69 800,-816.69 796.5,-826.69 803.5,-826.69"/>
</g>
<!-- ffn_2 -->
<g id="node14" class="node">
<title>ffn_2</title>
<polygon fill="none" stroke="black" points="884,-744.5 440,-744.5 440,-676.5 884,-676.5 884,-744.5"/>
<text text-anchor="middle" x="662" y="-729.3" font-family="Times,serif" font-size="14.00">Layer 2 FFN</text>
<text text-anchor="middle" x="662" y="-714.3" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-699.3" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-684.3" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (tensor parallel)</text>
</g>
<!-- residual_ffN_2 -->
<g id="node15" class="node">
<title>residual_ffN_2</title>
<ellipse fill="none" stroke="black" cx="800" cy="-592.42" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="800" y="-611.22" font-family="Times,serif" font-size="14.00">Residual Add FFN 2</text>
<text text-anchor="middle" x="800" y="-596.22" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096] x 2</text>
<text text-anchor="middle" x="800" y="-581.22" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="800" y="-566.22" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_2&#45;&gt;residual_ffN_2 -->
<g id="edge19" class="edge">
<title>ffn_2&#45;&gt;residual_ffN_2</title>
<path fill="none" stroke="black" d="M680.07,-676.34C680.07,-676.34 680.07,-647.49 680.07,-647.49"/>
<polygon fill="black" stroke="black" points="683.57,-647.49 680.07,-637.49 676.57,-647.49 683.57,-647.49"/>
</g>
<!-- attention_3 -->
<g id="node16" class="node">
<title>attention_3</title>
<polygon fill="none" stroke="black" points="884,-508.33 440,-508.33 440,-440.33 884,-440.33 884,-508.33"/>
<text text-anchor="middle" x="662" y="-493.13" font-family="Times,serif" font-size="14.00">Layer 3 Attention</text>
<text text-anchor="middle" x="662" y="-478.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-463.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-448.13" font-family="Times,serif" font-size="14.00">GPU: 8&#45;39</text>
</g>
<!-- residual_ffN_2&#45;&gt;attention_3 -->
<g id="edge21" class="edge">
<title>residual_ffN_2&#45;&gt;attention_3</title>
<path fill="none" stroke="black" d="M680.07,-547.44C680.07,-547.44 680.07,-518.53 680.07,-518.53"/>
<polygon fill="black" stroke="black" points="683.57,-518.53 680.07,-508.53 676.57,-518.53 683.57,-518.53"/>
</g>
<!-- residual_attn_3 -->
<g id="node22" class="node">
<title>residual_attn_3</title>
<ellipse fill="none" stroke="black" cx="800" cy="-386.33" rx="81.79" ry="18"/>
<text text-anchor="middle" x="800" y="-382.63" font-family="Times,serif" font-size="14.00">residual_attn_3</text>
</g>
<!-- residual_ffN_2&#45;&gt;residual_attn_3 -->
<g id="edge23" class="edge">
<title>residual_ffN_2&#45;&gt;residual_attn_3</title>
<path fill="none" stroke="black" d="M1043.9,-560.66C1043.9,-504.15 1043.9,-392 1043.9,-392 1043.9,-392 887.84,-392 887.84,-392"/>
<polygon fill="black" stroke="black" points="887.84,-388.5 877.84,-392 887.84,-395.5 887.84,-388.5"/>
</g>
<!-- attention_3&#45;&gt;residual_attn_3 -->
<g id="edge22" class="edge">
<title>attention_3&#45;&gt;residual_attn_3</title>
<path fill="none" stroke="black" d="M800,-440.31C800,-440.31 800,-414.52 800,-414.52"/>
<polygon fill="black" stroke="black" points="803.5,-414.52 800,-404.52 796.5,-414.53 803.5,-414.52"/>
</g>
<!-- ffn_3 -->
<g id="node17" class="node">
<title>ffn_3</title>
<polygon fill="none" stroke="black" points="884,-332.33 440,-332.33 440,-264.33 884,-264.33 884,-332.33"/>
<text text-anchor="middle" x="662" y="-317.13" font-family="Times,serif" font-size="14.00">Layer 3 FFN</text>
<text text-anchor="middle" x="662" y="-302.13" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-287.13" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="662" y="-272.13" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7 (tensor parallel)</text>
</g>
<!-- residual_ffN_3 -->
<g id="node18" class="node">
<title>residual_ffN_3</title>
<ellipse fill="none" stroke="black" cx="800" cy="-180.25" rx="323.71" ry="48.17"/>
<text text-anchor="middle" x="800" y="-199.05" font-family="Times,serif" font-size="14.00">Residual Add FFN 3</text>
<text text-anchor="middle" x="800" y="-184.05" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len=32768, d_model=4096] x 2</text>
<text text-anchor="middle" x="800" y="-169.05" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len=32768, d_model=4096]</text>
<text text-anchor="middle" x="800" y="-154.05" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn_3&#45;&gt;residual_ffN_3 -->
<g id="edge25" class="edge">
<title>ffn_3&#45;&gt;residual_ffN_3</title>
<path fill="none" stroke="black" d="M680.07,-264.18C680.07,-264.18 680.07,-235.32 680.07,-235.32"/>
<polygon fill="black" stroke="black" points="683.57,-235.32 680.07,-225.32 676.57,-235.32 683.57,-235.32"/>
</g>
<!-- output_total -->
<g id="node19" class="node">
<title>output_total</title>
<ellipse fill="none" stroke="black" cx="800" cy="-48.08" rx="369.22" ry="48.17"/>
<text text-anchor="middle" x="800" y="-66.88" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="800" y="-51.88" font-family="Times,serif" font-size="14.00">Input: [batch_size=1024, seq_len={seq_len}, d_model=4096]</text>
<text text-anchor="middle" x="800" y="-36.88" font-family="Times,serif" font-size="14.00">Output: [batch_size=1024, seq_len={seq_len}, vocab_size=full_vocab]</text>
<text text-anchor="middle" x="800" y="-21.88" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- residual_ffN_3&#45;&gt;output_total -->
<g id="edge27" class="edge">
<title>residual_ffN_3&#45;&gt;output_total</title>
<path fill="none" stroke="black" d="M800,-132.16C800,-132.16 800,-106.36 800,-106.36"/>
<polygon fill="black" stroke="black" points="803.5,-106.36 800,-96.36 796.5,-106.36 803.5,-106.36"/>
</g>
<!-- residual_attn_1&#45;&gt;ffn_1 -->
<g id="edge12" class="edge">
<title>residual_attn_1&#45;&gt;ffn_1</title>
<path fill="none" stroke="black" d="M800,-1192.43C800,-1192.43 800,-1166.88 800,-1166.88"/>
<polygon fill="black" stroke="black" points="803.5,-1166.88 800,-1156.88 796.5,-1166.88 803.5,-1166.88"/>
</g>
<!-- residual_attn_1&#45;&gt;residual_ffN_1 -->
<g id="edge14" class="edge">
<title>residual_attn_1&#45;&gt;residual_ffN_1</title>
<path fill="none" stroke="black" d="M876.22,-1204C919.03,-1204 963.95,-1204 963.95,-1204 963.95,-1204 963.95,-1056.39 963.95,-1056.39"/>
<polygon fill="black" stroke="black" points="967.45,-1056.39 963.95,-1046.39 960.45,-1056.39 967.45,-1056.39"/>
</g>
<!-- residual_attn_2&#45;&gt;ffn_2 -->
<g id="edge18" class="edge">
<title>residual_attn_2&#45;&gt;ffn_2</title>
<path fill="none" stroke="black" d="M800,-780.27C800,-780.27 800,-754.72 800,-754.72"/>
<polygon fill="black" stroke="black" points="803.5,-754.72 800,-744.72 796.5,-754.72 803.5,-754.72"/>
</g>
<!-- residual_attn_2&#45;&gt;residual_ffN_2 -->
<g id="edge20" class="edge">
<title>residual_attn_2&#45;&gt;residual_ffN_2</title>
<path fill="none" stroke="black" d="M876.7,-792C919.37,-792 963.95,-792 963.95,-792 963.95,-792 963.95,-644.26 963.95,-644.26"/>
<polygon fill="black" stroke="black" points="967.45,-644.26 963.95,-634.26 960.45,-644.26 967.45,-644.26"/>
</g>
<!-- residual_attn_3&#45;&gt;ffn_3 -->
<g id="edge24" class="edge">
<title>residual_attn_3&#45;&gt;ffn_3</title>
<path fill="none" stroke="black" d="M800,-368.1C800,-368.1 800,-342.55 800,-342.55"/>
<polygon fill="black" stroke="black" points="803.5,-342.55 800,-332.55 796.5,-342.55 803.5,-342.55"/>
</g>
<!-- residual_attn_3&#45;&gt;residual_ffN_3 -->
<g id="edge26" class="edge">
<title>residual_attn_3&#45;&gt;residual_ffN_3</title>
<path fill="none" stroke="black" d="M876.7,-380C919.37,-380 963.95,-380 963.95,-380 963.95,-380 963.95,-232.12 963.95,-232.12"/>
<polygon fill="black" stroke="black" points="967.45,-232.12 963.95,-222.12 960.45,-232.12 967.45,-232.12"/>
</g>
</g>
</svg>
