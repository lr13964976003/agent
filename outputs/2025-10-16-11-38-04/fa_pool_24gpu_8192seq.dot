digraph FA_Pool_24GPU_Config {
	rankdir=TB splines=spline
	input [label="Model Input
SeqLen: 8192
[batch_size=1024, seq_len=8192, d_model=4096]" fillcolor=lightgreen shape=ellipse]
	manager [label="Resource Manager
SeqLen: 8192
Pool GPUs: 16" fillcolor=gold shape=diamond]
	layer0_prenorm [label="Pre-Norm L0
GPU: 0-7" fillcolor=lightblue]
	layer0_qsplit [label="Query Split L0
Block: 512
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer0_kvbroadcast [label="KV Broadcast L0
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer0_attn_q_0 [label="Q L0 GPU8" fillcolor=lightcoral]
	layer0_attn_k_0 [label="K L0 GPU8" fillcolor=lightcoral]
	layer0_attn_v_0 [label="V L0 GPU8" fillcolor=lightcoral]
	layer0_flash_0 [label="Flash L0 GPU8" fillcolor=lightcoral]
	layer0_out_0 [label="Output L0 GPU8" fillcolor=lightcoral]
	layer0_attn_q_1 [label="Q L0 GPU9" fillcolor=lightcoral]
	layer0_attn_k_1 [label="K L0 GPU9" fillcolor=lightcoral]
	layer0_attn_v_1 [label="V L0 GPU9" fillcolor=lightcoral]
	layer0_flash_1 [label="Flash L0 GPU9" fillcolor=lightcoral]
	layer0_out_1 [label="Output L0 GPU9" fillcolor=lightcoral]
	layer0_attn_q_2 [label="Q L0 GPU10" fillcolor=lightcoral]
	layer0_attn_k_2 [label="K L0 GPU10" fillcolor=lightcoral]
	layer0_attn_v_2 [label="V L0 GPU10" fillcolor=lightcoral]
	layer0_flash_2 [label="Flash L0 GPU10" fillcolor=lightcoral]
	layer0_out_2 [label="Output L0 GPU10" fillcolor=lightcoral]
	layer0_attn_q_3 [label="Q L0 GPU11" fillcolor=lightcoral]
	layer0_attn_k_3 [label="K L0 GPU11" fillcolor=lightcoral]
	layer0_attn_v_3 [label="V L0 GPU11" fillcolor=lightcoral]
	layer0_flash_3 [label="Flash L0 GPU11" fillcolor=lightcoral]
	layer0_out_3 [label="Output L0 GPU11" fillcolor=lightcoral]
	layer0_attn_q_4 [label="Q L0 GPU12" fillcolor=lightcoral]
	layer0_attn_k_4 [label="K L0 GPU12" fillcolor=lightcoral]
	layer0_attn_v_4 [label="V L0 GPU12" fillcolor=lightcoral]
	layer0_flash_4 [label="Flash L0 GPU12" fillcolor=lightcoral]
	layer0_out_4 [label="Output L0 GPU12" fillcolor=lightcoral]
	layer0_attn_q_5 [label="Q L0 GPU13" fillcolor=lightcoral]
	layer0_attn_k_5 [label="K L0 GPU13" fillcolor=lightcoral]
	layer0_attn_v_5 [label="V L0 GPU13" fillcolor=lightcoral]
	layer0_flash_5 [label="Flash L0 GPU13" fillcolor=lightcoral]
	layer0_out_5 [label="Output L0 GPU13" fillcolor=lightcoral]
	layer0_attn_q_6 [label="Q L0 GPU14" fillcolor=lightcoral]
	layer0_attn_k_6 [label="K L0 GPU14" fillcolor=lightcoral]
	layer0_attn_v_6 [label="V L0 GPU14" fillcolor=lightcoral]
	layer0_flash_6 [label="Flash L0 GPU14" fillcolor=lightcoral]
	layer0_out_6 [label="Output L0 GPU14" fillcolor=lightcoral]
	layer0_attn_q_7 [label="Q L0 GPU15" fillcolor=lightcoral]
	layer0_attn_k_7 [label="K L0 GPU15" fillcolor=lightcoral]
	layer0_attn_v_7 [label="V L0 GPU15" fillcolor=lightcoral]
	layer0_flash_7 [label="Flash L0 GPU15" fillcolor=lightcoral]
	layer0_out_7 [label="Output L0 GPU15" fillcolor=lightcoral]
	layer0_attn_q_8 [label="Q L0 GPU16" fillcolor=lightcoral]
	layer0_attn_k_8 [label="K L0 GPU16" fillcolor=lightcoral]
	layer0_attn_v_8 [label="V L0 GPU16" fillcolor=lightcoral]
	layer0_flash_8 [label="Flash L0 GPU16" fillcolor=lightcoral]
	layer0_out_8 [label="Output L0 GPU16" fillcolor=lightcoral]
	layer0_attn_q_9 [label="Q L0 GPU17" fillcolor=lightcoral]
	layer0_attn_k_9 [label="K L0 GPU17" fillcolor=lightcoral]
	layer0_attn_v_9 [label="V L0 GPU17" fillcolor=lightcoral]
	layer0_flash_9 [label="Flash L0 GPU17" fillcolor=lightcoral]
	layer0_out_9 [label="Output L0 GPU17" fillcolor=lightcoral]
	layer0_attn_q_10 [label="Q L0 GPU18" fillcolor=lightcoral]
	layer0_attn_k_10 [label="K L0 GPU18" fillcolor=lightcoral]
	layer0_attn_v_10 [label="V L0 GPU18" fillcolor=lightcoral]
	layer0_flash_10 [label="Flash L0 GPU18" fillcolor=lightcoral]
	layer0_out_10 [label="Output L0 GPU18" fillcolor=lightcoral]
	layer0_attn_q_11 [label="Q L0 GPU19" fillcolor=lightcoral]
	layer0_attn_k_11 [label="K L0 GPU19" fillcolor=lightcoral]
	layer0_attn_v_11 [label="V L0 GPU19" fillcolor=lightcoral]
	layer0_flash_11 [label="Flash L0 GPU19" fillcolor=lightcoral]
	layer0_out_11 [label="Output L0 GPU19" fillcolor=lightcoral]
	layer0_attn_q_12 [label="Q L0 GPU20" fillcolor=lightcoral]
	layer0_attn_k_12 [label="K L0 GPU20" fillcolor=lightcoral]
	layer0_attn_v_12 [label="V L0 GPU20" fillcolor=lightcoral]
	layer0_flash_12 [label="Flash L0 GPU20" fillcolor=lightcoral]
	layer0_out_12 [label="Output L0 GPU20" fillcolor=lightcoral]
	layer0_attn_q_13 [label="Q L0 GPU21" fillcolor=lightcoral]
	layer0_attn_k_13 [label="K L0 GPU21" fillcolor=lightcoral]
	layer0_attn_v_13 [label="V L0 GPU21" fillcolor=lightcoral]
	layer0_flash_13 [label="Flash L0 GPU21" fillcolor=lightcoral]
	layer0_out_13 [label="Output L0 GPU21" fillcolor=lightcoral]
	layer0_attn_q_14 [label="Q L0 GPU22" fillcolor=lightcoral]
	layer0_attn_k_14 [label="K L0 GPU22" fillcolor=lightcoral]
	layer0_attn_v_14 [label="V L0 GPU22" fillcolor=lightcoral]
	layer0_flash_14 [label="Flash L0 GPU22" fillcolor=lightcoral]
	layer0_out_14 [label="Output L0 GPU22" fillcolor=lightcoral]
	layer0_attn_q_15 [label="Q L0 GPU23" fillcolor=lightcoral]
	layer0_attn_k_15 [label="K L0 GPU23" fillcolor=lightcoral]
	layer0_attn_v_15 [label="V L0 GPU23" fillcolor=lightcoral]
	layer0_flash_15 [label="Flash L0 GPU23" fillcolor=lightcoral]
	layer0_out_15 [label="Output L0 GPU23" fillcolor=lightcoral]
	layer0_gather [label="Gather L0
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer0_attn_res [label="Attn Res L0" fillcolor=orange shape=ellipse]
	layer0_ffn [label="FFN L0
GPU: 0-7" fillcolor=lightblue]
	layer0_ffn_res [label="FFN Res L0" fillcolor=orange shape=ellipse]
	layer1_prenorm [label="Pre-Norm L1
GPU: 0-7" fillcolor=lightblue]
	layer1_qsplit [label="Query Split L1
Block: 512
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer1_kvbroadcast [label="KV Broadcast L1
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer1_attn_q_0 [label="Q L1 GPU8" fillcolor=lightcoral]
	layer1_attn_k_0 [label="K L1 GPU8" fillcolor=lightcoral]
	layer1_attn_v_0 [label="V L1 GPU8" fillcolor=lightcoral]
	layer1_flash_0 [label="Flash L1 GPU8" fillcolor=lightcoral]
	layer1_out_0 [label="Output L1 GPU8" fillcolor=lightcoral]
	layer1_attn_q_1 [label="Q L1 GPU9" fillcolor=lightcoral]
	layer1_attn_k_1 [label="K L1 GPU9" fillcolor=lightcoral]
	layer1_attn_v_1 [label="V L1 GPU9" fillcolor=lightcoral]
	layer1_flash_1 [label="Flash L1 GPU9" fillcolor=lightcoral]
	layer1_out_1 [label="Output L1 GPU9" fillcolor=lightcoral]
	layer1_attn_q_2 [label="Q L1 GPU10" fillcolor=lightcoral]
	layer1_attn_k_2 [label="K L1 GPU10" fillcolor=lightcoral]
	layer1_attn_v_2 [label="V L1 GPU10" fillcolor=lightcoral]
	layer1_flash_2 [label="Flash L1 GPU10" fillcolor=lightcoral]
	layer1_out_2 [label="Output L1 GPU10" fillcolor=lightcoral]
	layer1_attn_q_3 [label="Q L1 GPU11" fillcolor=lightcoral]
	layer1_attn_k_3 [label="K L1 GPU11" fillcolor=lightcoral]
	layer1_attn_v_3 [label="V L1 GPU11" fillcolor=lightcoral]
	layer1_flash_3 [label="Flash L1 GPU11" fillcolor=lightcoral]
	layer1_out_3 [label="Output L1 GPU11" fillcolor=lightcoral]
	layer1_attn_q_4 [label="Q L1 GPU12" fillcolor=lightcoral]
	layer1_attn_k_4 [label="K L1 GPU12" fillcolor=lightcoral]
	layer1_attn_v_4 [label="V L1 GPU12" fillcolor=lightcoral]
	layer1_flash_4 [label="Flash L1 GPU12" fillcolor=lightcoral]
	layer1_out_4 [label="Output L1 GPU12" fillcolor=lightcoral]
	layer1_attn_q_5 [label="Q L1 GPU13" fillcolor=lightcoral]
	layer1_attn_k_5 [label="K L1 GPU13" fillcolor=lightcoral]
	layer1_attn_v_5 [label="V L1 GPU13" fillcolor=lightcoral]
	layer1_flash_5 [label="Flash L1 GPU13" fillcolor=lightcoral]
	layer1_out_5 [label="Output L1 GPU13" fillcolor=lightcoral]
	layer1_attn_q_6 [label="Q L1 GPU14" fillcolor=lightcoral]
	layer1_attn_k_6 [label="K L1 GPU14" fillcolor=lightcoral]
	layer1_attn_v_6 [label="V L1 GPU14" fillcolor=lightcoral]
	layer1_flash_6 [label="Flash L1 GPU14" fillcolor=lightcoral]
	layer1_out_6 [label="Output L1 GPU14" fillcolor=lightcoral]
	layer1_attn_q_7 [label="Q L1 GPU15" fillcolor=lightcoral]
	layer1_attn_k_7 [label="K L1 GPU15" fillcolor=lightcoral]
	layer1_attn_v_7 [label="V L1 GPU15" fillcolor=lightcoral]
	layer1_flash_7 [label="Flash L1 GPU15" fillcolor=lightcoral]
	layer1_out_7 [label="Output L1 GPU15" fillcolor=lightcoral]
	layer1_attn_q_8 [label="Q L1 GPU16" fillcolor=lightcoral]
	layer1_attn_k_8 [label="K L1 GPU16" fillcolor=lightcoral]
	layer1_attn_v_8 [label="V L1 GPU16" fillcolor=lightcoral]
	layer1_flash_8 [label="Flash L1 GPU16" fillcolor=lightcoral]
	layer1_out_8 [label="Output L1 GPU16" fillcolor=lightcoral]
	layer1_attn_q_9 [label="Q L1 GPU17" fillcolor=lightcoral]
	layer1_attn_k_9 [label="K L1 GPU17" fillcolor=lightcoral]
	layer1_attn_v_9 [label="V L1 GPU17" fillcolor=lightcoral]
	layer1_flash_9 [label="Flash L1 GPU17" fillcolor=lightcoral]
	layer1_out_9 [label="Output L1 GPU17" fillcolor=lightcoral]
	layer1_attn_q_10 [label="Q L1 GPU18" fillcolor=lightcoral]
	layer1_attn_k_10 [label="K L1 GPU18" fillcolor=lightcoral]
	layer1_attn_v_10 [label="V L1 GPU18" fillcolor=lightcoral]
	layer1_flash_10 [label="Flash L1 GPU18" fillcolor=lightcoral]
	layer1_out_10 [label="Output L1 GPU18" fillcolor=lightcoral]
	layer1_attn_q_11 [label="Q L1 GPU19" fillcolor=lightcoral]
	layer1_attn_k_11 [label="K L1 GPU19" fillcolor=lightcoral]
	layer1_attn_v_11 [label="V L1 GPU19" fillcolor=lightcoral]
	layer1_flash_11 [label="Flash L1 GPU19" fillcolor=lightcoral]
	layer1_out_11 [label="Output L1 GPU19" fillcolor=lightcoral]
	layer1_attn_q_12 [label="Q L1 GPU20" fillcolor=lightcoral]
	layer1_attn_k_12 [label="K L1 GPU20" fillcolor=lightcoral]
	layer1_attn_v_12 [label="V L1 GPU20" fillcolor=lightcoral]
	layer1_flash_12 [label="Flash L1 GPU20" fillcolor=lightcoral]
	layer1_out_12 [label="Output L1 GPU20" fillcolor=lightcoral]
	layer1_attn_q_13 [label="Q L1 GPU21" fillcolor=lightcoral]
	layer1_attn_k_13 [label="K L1 GPU21" fillcolor=lightcoral]
	layer1_attn_v_13 [label="V L1 GPU21" fillcolor=lightcoral]
	layer1_flash_13 [label="Flash L1 GPU21" fillcolor=lightcoral]
	layer1_out_13 [label="Output L1 GPU21" fillcolor=lightcoral]
	layer1_attn_q_14 [label="Q L1 GPU22" fillcolor=lightcoral]
	layer1_attn_k_14 [label="K L1 GPU22" fillcolor=lightcoral]
	layer1_attn_v_14 [label="V L1 GPU22" fillcolor=lightcoral]
	layer1_flash_14 [label="Flash L1 GPU22" fillcolor=lightcoral]
	layer1_out_14 [label="Output L1 GPU22" fillcolor=lightcoral]
	layer1_attn_q_15 [label="Q L1 GPU23" fillcolor=lightcoral]
	layer1_attn_k_15 [label="K L1 GPU23" fillcolor=lightcoral]
	layer1_attn_v_15 [label="V L1 GPU23" fillcolor=lightcoral]
	layer1_flash_15 [label="Flash L1 GPU23" fillcolor=lightcoral]
	layer1_out_15 [label="Output L1 GPU23" fillcolor=lightcoral]
	layer1_gather [label="Gather L1
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer1_attn_res [label="Attn Res L1" fillcolor=orange shape=ellipse]
	layer1_ffn [label="FFN L1
GPU: 0-7" fillcolor=lightblue]
	layer1_ffn_res [label="FFN Res L1" fillcolor=orange shape=ellipse]
	layer2_prenorm [label="Pre-Norm L2
GPU: 0-7" fillcolor=lightblue]
	layer2_qsplit [label="Query Split L2
Block: 512
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer2_kvbroadcast [label="KV Broadcast L2
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer2_attn_q_0 [label="Q L2 GPU8" fillcolor=lightcoral]
	layer2_attn_k_0 [label="K L2 GPU8" fillcolor=lightcoral]
	layer2_attn_v_0 [label="V L2 GPU8" fillcolor=lightcoral]
	layer2_flash_0 [label="Flash L2 GPU8" fillcolor=lightcoral]
	layer2_out_0 [label="Output L2 GPU8" fillcolor=lightcoral]
	layer2_attn_q_1 [label="Q L2 GPU9" fillcolor=lightcoral]
	layer2_attn_k_1 [label="K L2 GPU9" fillcolor=lightcoral]
	layer2_attn_v_1 [label="V L2 GPU9" fillcolor=lightcoral]
	layer2_flash_1 [label="Flash L2 GPU9" fillcolor=lightcoral]
	layer2_out_1 [label="Output L2 GPU9" fillcolor=lightcoral]
	layer2_attn_q_2 [label="Q L2 GPU10" fillcolor=lightcoral]
	layer2_attn_k_2 [label="K L2 GPU10" fillcolor=lightcoral]
	layer2_attn_v_2 [label="V L2 GPU10" fillcolor=lightcoral]
	layer2_flash_2 [label="Flash L2 GPU10" fillcolor=lightcoral]
	layer2_out_2 [label="Output L2 GPU10" fillcolor=lightcoral]
	layer2_attn_q_3 [label="Q L2 GPU11" fillcolor=lightcoral]
	layer2_attn_k_3 [label="K L2 GPU11" fillcolor=lightcoral]
	layer2_attn_v_3 [label="V L2 GPU11" fillcolor=lightcoral]
	layer2_flash_3 [label="Flash L2 GPU11" fillcolor=lightcoral]
	layer2_out_3 [label="Output L2 GPU11" fillcolor=lightcoral]
	layer2_attn_q_4 [label="Q L2 GPU12" fillcolor=lightcoral]
	layer2_attn_k_4 [label="K L2 GPU12" fillcolor=lightcoral]
	layer2_attn_v_4 [label="V L2 GPU12" fillcolor=lightcoral]
	layer2_flash_4 [label="Flash L2 GPU12" fillcolor=lightcoral]
	layer2_out_4 [label="Output L2 GPU12" fillcolor=lightcoral]
	layer2_attn_q_5 [label="Q L2 GPU13" fillcolor=lightcoral]
	layer2_attn_k_5 [label="K L2 GPU13" fillcolor=lightcoral]
	layer2_attn_v_5 [label="V L2 GPU13" fillcolor=lightcoral]
	layer2_flash_5 [label="Flash L2 GPU13" fillcolor=lightcoral]
	layer2_out_5 [label="Output L2 GPU13" fillcolor=lightcoral]
	layer2_attn_q_6 [label="Q L2 GPU14" fillcolor=lightcoral]
	layer2_attn_k_6 [label="K L2 GPU14" fillcolor=lightcoral]
	layer2_attn_v_6 [label="V L2 GPU14" fillcolor=lightcoral]
	layer2_flash_6 [label="Flash L2 GPU14" fillcolor=lightcoral]
	layer2_out_6 [label="Output L2 GPU14" fillcolor=lightcoral]
	layer2_attn_q_7 [label="Q L2 GPU15" fillcolor=lightcoral]
	layer2_attn_k_7 [label="K L2 GPU15" fillcolor=lightcoral]
	layer2_attn_v_7 [label="V L2 GPU15" fillcolor=lightcoral]
	layer2_flash_7 [label="Flash L2 GPU15" fillcolor=lightcoral]
	layer2_out_7 [label="Output L2 GPU15" fillcolor=lightcoral]
	layer2_attn_q_8 [label="Q L2 GPU16" fillcolor=lightcoral]
	layer2_attn_k_8 [label="K L2 GPU16" fillcolor=lightcoral]
	layer2_attn_v_8 [label="V L2 GPU16" fillcolor=lightcoral]
	layer2_flash_8 [label="Flash L2 GPU16" fillcolor=lightcoral]
	layer2_out_8 [label="Output L2 GPU16" fillcolor=lightcoral]
	layer2_attn_q_9 [label="Q L2 GPU17" fillcolor=lightcoral]
	layer2_attn_k_9 [label="K L2 GPU17" fillcolor=lightcoral]
	layer2_attn_v_9 [label="V L2 GPU17" fillcolor=lightcoral]
	layer2_flash_9 [label="Flash L2 GPU17" fillcolor=lightcoral]
	layer2_out_9 [label="Output L2 GPU17" fillcolor=lightcoral]
	layer2_attn_q_10 [label="Q L2 GPU18" fillcolor=lightcoral]
	layer2_attn_k_10 [label="K L2 GPU18" fillcolor=lightcoral]
	layer2_attn_v_10 [label="V L2 GPU18" fillcolor=lightcoral]
	layer2_flash_10 [label="Flash L2 GPU18" fillcolor=lightcoral]
	layer2_out_10 [label="Output L2 GPU18" fillcolor=lightcoral]
	layer2_attn_q_11 [label="Q L2 GPU19" fillcolor=lightcoral]
	layer2_attn_k_11 [label="K L2 GPU19" fillcolor=lightcoral]
	layer2_attn_v_11 [label="V L2 GPU19" fillcolor=lightcoral]
	layer2_flash_11 [label="Flash L2 GPU19" fillcolor=lightcoral]
	layer2_out_11 [label="Output L2 GPU19" fillcolor=lightcoral]
	layer2_attn_q_12 [label="Q L2 GPU20" fillcolor=lightcoral]
	layer2_attn_k_12 [label="K L2 GPU20" fillcolor=lightcoral]
	layer2_attn_v_12 [label="V L2 GPU20" fillcolor=lightcoral]
	layer2_flash_12 [label="Flash L2 GPU20" fillcolor=lightcoral]
	layer2_out_12 [label="Output L2 GPU20" fillcolor=lightcoral]
	layer2_attn_q_13 [label="Q L2 GPU21" fillcolor=lightcoral]
	layer2_attn_k_13 [label="K L2 GPU21" fillcolor=lightcoral]
	layer2_attn_v_13 [label="V L2 GPU21" fillcolor=lightcoral]
	layer2_flash_13 [label="Flash L2 GPU21" fillcolor=lightcoral]
	layer2_out_13 [label="Output L2 GPU21" fillcolor=lightcoral]
	layer2_attn_q_14 [label="Q L2 GPU22" fillcolor=lightcoral]
	layer2_attn_k_14 [label="K L2 GPU22" fillcolor=lightcoral]
	layer2_attn_v_14 [label="V L2 GPU22" fillcolor=lightcoral]
	layer2_flash_14 [label="Flash L2 GPU22" fillcolor=lightcoral]
	layer2_out_14 [label="Output L2 GPU22" fillcolor=lightcoral]
	layer2_attn_q_15 [label="Q L2 GPU23" fillcolor=lightcoral]
	layer2_attn_k_15 [label="K L2 GPU23" fillcolor=lightcoral]
	layer2_attn_v_15 [label="V L2 GPU23" fillcolor=lightcoral]
	layer2_flash_15 [label="Flash L2 GPU23" fillcolor=lightcoral]
	layer2_out_15 [label="Output L2 GPU23" fillcolor=lightcoral]
	layer2_gather [label="Gather L2
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer2_attn_res [label="Attn Res L2" fillcolor=orange shape=ellipse]
	layer2_ffn [label="FFN L2
GPU: 0-7" fillcolor=lightblue]
	layer2_ffn_res [label="FFN Res L2" fillcolor=orange shape=ellipse]
	layer3_prenorm [label="Pre-Norm L3
GPU: 0-7" fillcolor=lightblue]
	layer3_qsplit [label="Query Split L3
Block: 512
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer3_kvbroadcast [label="KV Broadcast L3
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer3_attn_q_0 [label="Q L3 GPU8" fillcolor=lightcoral]
	layer3_attn_k_0 [label="K L3 GPU8" fillcolor=lightcoral]
	layer3_attn_v_0 [label="V L3 GPU8" fillcolor=lightcoral]
	layer3_flash_0 [label="Flash L3 GPU8" fillcolor=lightcoral]
	layer3_out_0 [label="Output L3 GPU8" fillcolor=lightcoral]
	layer3_attn_q_1 [label="Q L3 GPU9" fillcolor=lightcoral]
	layer3_attn_k_1 [label="K L3 GPU9" fillcolor=lightcoral]
	layer3_attn_v_1 [label="V L3 GPU9" fillcolor=lightcoral]
	layer3_flash_1 [label="Flash L3 GPU9" fillcolor=lightcoral]
	layer3_out_1 [label="Output L3 GPU9" fillcolor=lightcoral]
	layer3_attn_q_2 [label="Q L3 GPU10" fillcolor=lightcoral]
	layer3_attn_k_2 [label="K L3 GPU10" fillcolor=lightcoral]
	layer3_attn_v_2 [label="V L3 GPU10" fillcolor=lightcoral]
	layer3_flash_2 [label="Flash L3 GPU10" fillcolor=lightcoral]
	layer3_out_2 [label="Output L3 GPU10" fillcolor=lightcoral]
	layer3_attn_q_3 [label="Q L3 GPU11" fillcolor=lightcoral]
	layer3_attn_k_3 [label="K L3 GPU11" fillcolor=lightcoral]
	layer3_attn_v_3 [label="V L3 GPU11" fillcolor=lightcoral]
	layer3_flash_3 [label="Flash L3 GPU11" fillcolor=lightcoral]
	layer3_out_3 [label="Output L3 GPU11" fillcolor=lightcoral]
	layer3_attn_q_4 [label="Q L3 GPU12" fillcolor=lightcoral]
	layer3_attn_k_4 [label="K L3 GPU12" fillcolor=lightcoral]
	layer3_attn_v_4 [label="V L3 GPU12" fillcolor=lightcoral]
	layer3_flash_4 [label="Flash L3 GPU12" fillcolor=lightcoral]
	layer3_out_4 [label="Output L3 GPU12" fillcolor=lightcoral]
	layer3_attn_q_5 [label="Q L3 GPU13" fillcolor=lightcoral]
	layer3_attn_k_5 [label="K L3 GPU13" fillcolor=lightcoral]
	layer3_attn_v_5 [label="V L3 GPU13" fillcolor=lightcoral]
	layer3_flash_5 [label="Flash L3 GPU13" fillcolor=lightcoral]
	layer3_out_5 [label="Output L3 GPU13" fillcolor=lightcoral]
	layer3_attn_q_6 [label="Q L3 GPU14" fillcolor=lightcoral]
	layer3_attn_k_6 [label="K L3 GPU14" fillcolor=lightcoral]
	layer3_attn_v_6 [label="V L3 GPU14" fillcolor=lightcoral]
	layer3_flash_6 [label="Flash L3 GPU14" fillcolor=lightcoral]
	layer3_out_6 [label="Output L3 GPU14" fillcolor=lightcoral]
	layer3_attn_q_7 [label="Q L3 GPU15" fillcolor=lightcoral]
	layer3_attn_k_7 [label="K L3 GPU15" fillcolor=lightcoral]
	layer3_attn_v_7 [label="V L3 GPU15" fillcolor=lightcoral]
	layer3_flash_7 [label="Flash L3 GPU15" fillcolor=lightcoral]
	layer3_out_7 [label="Output L3 GPU15" fillcolor=lightcoral]
	layer3_attn_q_8 [label="Q L3 GPU16" fillcolor=lightcoral]
	layer3_attn_k_8 [label="K L3 GPU16" fillcolor=lightcoral]
	layer3_attn_v_8 [label="V L3 GPU16" fillcolor=lightcoral]
	layer3_flash_8 [label="Flash L3 GPU16" fillcolor=lightcoral]
	layer3_out_8 [label="Output L3 GPU16" fillcolor=lightcoral]
	layer3_attn_q_9 [label="Q L3 GPU17" fillcolor=lightcoral]
	layer3_attn_k_9 [label="K L3 GPU17" fillcolor=lightcoral]
	layer3_attn_v_9 [label="V L3 GPU17" fillcolor=lightcoral]
	layer3_flash_9 [label="Flash L3 GPU17" fillcolor=lightcoral]
	layer3_out_9 [label="Output L3 GPU17" fillcolor=lightcoral]
	layer3_attn_q_10 [label="Q L3 GPU18" fillcolor=lightcoral]
	layer3_attn_k_10 [label="K L3 GPU18" fillcolor=lightcoral]
	layer3_attn_v_10 [label="V L3 GPU18" fillcolor=lightcoral]
	layer3_flash_10 [label="Flash L3 GPU18" fillcolor=lightcoral]
	layer3_out_10 [label="Output L3 GPU18" fillcolor=lightcoral]
	layer3_attn_q_11 [label="Q L3 GPU19" fillcolor=lightcoral]
	layer3_attn_k_11 [label="K L3 GPU19" fillcolor=lightcoral]
	layer3_attn_v_11 [label="V L3 GPU19" fillcolor=lightcoral]
	layer3_flash_11 [label="Flash L3 GPU19" fillcolor=lightcoral]
	layer3_out_11 [label="Output L3 GPU19" fillcolor=lightcoral]
	layer3_attn_q_12 [label="Q L3 GPU20" fillcolor=lightcoral]
	layer3_attn_k_12 [label="K L3 GPU20" fillcolor=lightcoral]
	layer3_attn_v_12 [label="V L3 GPU20" fillcolor=lightcoral]
	layer3_flash_12 [label="Flash L3 GPU20" fillcolor=lightcoral]
	layer3_out_12 [label="Output L3 GPU20" fillcolor=lightcoral]
	layer3_attn_q_13 [label="Q L3 GPU21" fillcolor=lightcoral]
	layer3_attn_k_13 [label="K L3 GPU21" fillcolor=lightcoral]
	layer3_attn_v_13 [label="V L3 GPU21" fillcolor=lightcoral]
	layer3_flash_13 [label="Flash L3 GPU21" fillcolor=lightcoral]
	layer3_out_13 [label="Output L3 GPU21" fillcolor=lightcoral]
	layer3_attn_q_14 [label="Q L3 GPU22" fillcolor=lightcoral]
	layer3_attn_k_14 [label="K L3 GPU22" fillcolor=lightcoral]
	layer3_attn_v_14 [label="V L3 GPU22" fillcolor=lightcoral]
	layer3_flash_14 [label="Flash L3 GPU22" fillcolor=lightcoral]
	layer3_out_14 [label="Output L3 GPU22" fillcolor=lightcoral]
	layer3_attn_q_15 [label="Q L3 GPU23" fillcolor=lightcoral]
	layer3_attn_k_15 [label="K L3 GPU23" fillcolor=lightcoral]
	layer3_attn_v_15 [label="V L3 GPU23" fillcolor=lightcoral]
	layer3_flash_15 [label="Flash L3 GPU23" fillcolor=lightcoral]
	layer3_out_15 [label="Output L3 GPU23" fillcolor=lightcoral]
	layer3_gather [label="Gather L3
GPU: 8-23" fillcolor=yellow shape=parallelogram]
	layer3_attn_res [label="Attn Res L3" fillcolor=orange shape=ellipse]
	layer3_ffn [label="FFN L3
GPU: 0-7" fillcolor=lightblue]
	layer3_ffn_res [label="FFN Res L3" fillcolor=orange shape=ellipse]
	output [label="Model Output
[batch_size=1024, seq_len=8192, vocab_size=full_vocab]" fillcolor=lightgreen shape=ellipse]
	input -> manager
	manager -> layer0_prenorm
	layer0_prenorm -> layer0_qsplit
	layer0_prenorm -> layer0_kvbroadcast
	layer0_qsplit -> layer0_attn_q_0
	layer0_kvbroadcast -> layer0_attn_k_0
	layer0_kvbroadcast -> layer0_attn_v_0
	layer0_attn_q_0 -> layer0_flash_0
	layer0_attn_k_0 -> layer0_flash_0
	layer0_attn_v_0 -> layer0_flash_0
	layer0_flash_0 -> layer0_out_0
	layer0_out_0 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_1
	layer0_kvbroadcast -> layer0_attn_k_1
	layer0_kvbroadcast -> layer0_attn_v_1
	layer0_attn_q_1 -> layer0_flash_1
	layer0_attn_k_1 -> layer0_flash_1
	layer0_attn_v_1 -> layer0_flash_1
	layer0_flash_1 -> layer0_out_1
	layer0_out_1 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_2
	layer0_kvbroadcast -> layer0_attn_k_2
	layer0_kvbroadcast -> layer0_attn_v_2
	layer0_attn_q_2 -> layer0_flash_2
	layer0_attn_k_2 -> layer0_flash_2
	layer0_attn_v_2 -> layer0_flash_2
	layer0_flash_2 -> layer0_out_2
	layer0_out_2 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_3
	layer0_kvbroadcast -> layer0_attn_k_3
	layer0_kvbroadcast -> layer0_attn_v_3
	layer0_attn_q_3 -> layer0_flash_3
	layer0_attn_k_3 -> layer0_flash_3
	layer0_attn_v_3 -> layer0_flash_3
	layer0_flash_3 -> layer0_out_3
	layer0_out_3 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_4
	layer0_kvbroadcast -> layer0_attn_k_4
	layer0_kvbroadcast -> layer0_attn_v_4
	layer0_attn_q_4 -> layer0_flash_4
	layer0_attn_k_4 -> layer0_flash_4
	layer0_attn_v_4 -> layer0_flash_4
	layer0_flash_4 -> layer0_out_4
	layer0_out_4 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_5
	layer0_kvbroadcast -> layer0_attn_k_5
	layer0_kvbroadcast -> layer0_attn_v_5
	layer0_attn_q_5 -> layer0_flash_5
	layer0_attn_k_5 -> layer0_flash_5
	layer0_attn_v_5 -> layer0_flash_5
	layer0_flash_5 -> layer0_out_5
	layer0_out_5 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_6
	layer0_kvbroadcast -> layer0_attn_k_6
	layer0_kvbroadcast -> layer0_attn_v_6
	layer0_attn_q_6 -> layer0_flash_6
	layer0_attn_k_6 -> layer0_flash_6
	layer0_attn_v_6 -> layer0_flash_6
	layer0_flash_6 -> layer0_out_6
	layer0_out_6 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_7
	layer0_kvbroadcast -> layer0_attn_k_7
	layer0_kvbroadcast -> layer0_attn_v_7
	layer0_attn_q_7 -> layer0_flash_7
	layer0_attn_k_7 -> layer0_flash_7
	layer0_attn_v_7 -> layer0_flash_7
	layer0_flash_7 -> layer0_out_7
	layer0_out_7 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_8
	layer0_kvbroadcast -> layer0_attn_k_8
	layer0_kvbroadcast -> layer0_attn_v_8
	layer0_attn_q_8 -> layer0_flash_8
	layer0_attn_k_8 -> layer0_flash_8
	layer0_attn_v_8 -> layer0_flash_8
	layer0_flash_8 -> layer0_out_8
	layer0_out_8 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_9
	layer0_kvbroadcast -> layer0_attn_k_9
	layer0_kvbroadcast -> layer0_attn_v_9
	layer0_attn_q_9 -> layer0_flash_9
	layer0_attn_k_9 -> layer0_flash_9
	layer0_attn_v_9 -> layer0_flash_9
	layer0_flash_9 -> layer0_out_9
	layer0_out_9 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_10
	layer0_kvbroadcast -> layer0_attn_k_10
	layer0_kvbroadcast -> layer0_attn_v_10
	layer0_attn_q_10 -> layer0_flash_10
	layer0_attn_k_10 -> layer0_flash_10
	layer0_attn_v_10 -> layer0_flash_10
	layer0_flash_10 -> layer0_out_10
	layer0_out_10 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_11
	layer0_kvbroadcast -> layer0_attn_k_11
	layer0_kvbroadcast -> layer0_attn_v_11
	layer0_attn_q_11 -> layer0_flash_11
	layer0_attn_k_11 -> layer0_flash_11
	layer0_attn_v_11 -> layer0_flash_11
	layer0_flash_11 -> layer0_out_11
	layer0_out_11 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_12
	layer0_kvbroadcast -> layer0_attn_k_12
	layer0_kvbroadcast -> layer0_attn_v_12
	layer0_attn_q_12 -> layer0_flash_12
	layer0_attn_k_12 -> layer0_flash_12
	layer0_attn_v_12 -> layer0_flash_12
	layer0_flash_12 -> layer0_out_12
	layer0_out_12 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_13
	layer0_kvbroadcast -> layer0_attn_k_13
	layer0_kvbroadcast -> layer0_attn_v_13
	layer0_attn_q_13 -> layer0_flash_13
	layer0_attn_k_13 -> layer0_flash_13
	layer0_attn_v_13 -> layer0_flash_13
	layer0_flash_13 -> layer0_out_13
	layer0_out_13 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_14
	layer0_kvbroadcast -> layer0_attn_k_14
	layer0_kvbroadcast -> layer0_attn_v_14
	layer0_attn_q_14 -> layer0_flash_14
	layer0_attn_k_14 -> layer0_flash_14
	layer0_attn_v_14 -> layer0_flash_14
	layer0_flash_14 -> layer0_out_14
	layer0_out_14 -> layer0_gather
	layer0_qsplit -> layer0_attn_q_15
	layer0_kvbroadcast -> layer0_attn_k_15
	layer0_kvbroadcast -> layer0_attn_v_15
	layer0_attn_q_15 -> layer0_flash_15
	layer0_attn_k_15 -> layer0_flash_15
	layer0_attn_v_15 -> layer0_flash_15
	layer0_flash_15 -> layer0_out_15
	layer0_out_15 -> layer0_gather
	input -> layer0_attn_res
	layer0_gather -> layer0_attn_res
	layer0_attn_res -> layer0_ffn
	layer0_attn_res -> layer0_ffn_res
	layer0_ffn -> layer0_ffn_res
	layer0_ffn_res -> layer1_prenorm
	layer1_prenorm -> layer1_qsplit
	layer1_prenorm -> layer1_kvbroadcast
	layer1_qsplit -> layer1_attn_q_0
	layer1_kvbroadcast -> layer1_attn_k_0
	layer1_kvbroadcast -> layer1_attn_v_0
	layer1_attn_q_0 -> layer1_flash_0
	layer1_attn_k_0 -> layer1_flash_0
	layer1_attn_v_0 -> layer1_flash_0
	layer1_flash_0 -> layer1_out_0
	layer1_out_0 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_1
	layer1_kvbroadcast -> layer1_attn_k_1
	layer1_kvbroadcast -> layer1_attn_v_1
	layer1_attn_q_1 -> layer1_flash_1
	layer1_attn_k_1 -> layer1_flash_1
	layer1_attn_v_1 -> layer1_flash_1
	layer1_flash_1 -> layer1_out_1
	layer1_out_1 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_2
	layer1_kvbroadcast -> layer1_attn_k_2
	layer1_kvbroadcast -> layer1_attn_v_2
	layer1_attn_q_2 -> layer1_flash_2
	layer1_attn_k_2 -> layer1_flash_2
	layer1_attn_v_2 -> layer1_flash_2
	layer1_flash_2 -> layer1_out_2
	layer1_out_2 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_3
	layer1_kvbroadcast -> layer1_attn_k_3
	layer1_kvbroadcast -> layer1_attn_v_3
	layer1_attn_q_3 -> layer1_flash_3
	layer1_attn_k_3 -> layer1_flash_3
	layer1_attn_v_3 -> layer1_flash_3
	layer1_flash_3 -> layer1_out_3
	layer1_out_3 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_4
	layer1_kvbroadcast -> layer1_attn_k_4
	layer1_kvbroadcast -> layer1_attn_v_4
	layer1_attn_q_4 -> layer1_flash_4
	layer1_attn_k_4 -> layer1_flash_4
	layer1_attn_v_4 -> layer1_flash_4
	layer1_flash_4 -> layer1_out_4
	layer1_out_4 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_5
	layer1_kvbroadcast -> layer1_attn_k_5
	layer1_kvbroadcast -> layer1_attn_v_5
	layer1_attn_q_5 -> layer1_flash_5
	layer1_attn_k_5 -> layer1_flash_5
	layer1_attn_v_5 -> layer1_flash_5
	layer1_flash_5 -> layer1_out_5
	layer1_out_5 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_6
	layer1_kvbroadcast -> layer1_attn_k_6
	layer1_kvbroadcast -> layer1_attn_v_6
	layer1_attn_q_6 -> layer1_flash_6
	layer1_attn_k_6 -> layer1_flash_6
	layer1_attn_v_6 -> layer1_flash_6
	layer1_flash_6 -> layer1_out_6
	layer1_out_6 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_7
	layer1_kvbroadcast -> layer1_attn_k_7
	layer1_kvbroadcast -> layer1_attn_v_7
	layer1_attn_q_7 -> layer1_flash_7
	layer1_attn_k_7 -> layer1_flash_7
	layer1_attn_v_7 -> layer1_flash_7
	layer1_flash_7 -> layer1_out_7
	layer1_out_7 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_8
	layer1_kvbroadcast -> layer1_attn_k_8
	layer1_kvbroadcast -> layer1_attn_v_8
	layer1_attn_q_8 -> layer1_flash_8
	layer1_attn_k_8 -> layer1_flash_8
	layer1_attn_v_8 -> layer1_flash_8
	layer1_flash_8 -> layer1_out_8
	layer1_out_8 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_9
	layer1_kvbroadcast -> layer1_attn_k_9
	layer1_kvbroadcast -> layer1_attn_v_9
	layer1_attn_q_9 -> layer1_flash_9
	layer1_attn_k_9 -> layer1_flash_9
	layer1_attn_v_9 -> layer1_flash_9
	layer1_flash_9 -> layer1_out_9
	layer1_out_9 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_10
	layer1_kvbroadcast -> layer1_attn_k_10
	layer1_kvbroadcast -> layer1_attn_v_10
	layer1_attn_q_10 -> layer1_flash_10
	layer1_attn_k_10 -> layer1_flash_10
	layer1_attn_v_10 -> layer1_flash_10
	layer1_flash_10 -> layer1_out_10
	layer1_out_10 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_11
	layer1_kvbroadcast -> layer1_attn_k_11
	layer1_kvbroadcast -> layer1_attn_v_11
	layer1_attn_q_11 -> layer1_flash_11
	layer1_attn_k_11 -> layer1_flash_11
	layer1_attn_v_11 -> layer1_flash_11
	layer1_flash_11 -> layer1_out_11
	layer1_out_11 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_12
	layer1_kvbroadcast -> layer1_attn_k_12
	layer1_kvbroadcast -> layer1_attn_v_12
	layer1_attn_q_12 -> layer1_flash_12
	layer1_attn_k_12 -> layer1_flash_12
	layer1_attn_v_12 -> layer1_flash_12
	layer1_flash_12 -> layer1_out_12
	layer1_out_12 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_13
	layer1_kvbroadcast -> layer1_attn_k_13
	layer1_kvbroadcast -> layer1_attn_v_13
	layer1_attn_q_13 -> layer1_flash_13
	layer1_attn_k_13 -> layer1_flash_13
	layer1_attn_v_13 -> layer1_flash_13
	layer1_flash_13 -> layer1_out_13
	layer1_out_13 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_14
	layer1_kvbroadcast -> layer1_attn_k_14
	layer1_kvbroadcast -> layer1_attn_v_14
	layer1_attn_q_14 -> layer1_flash_14
	layer1_attn_k_14 -> layer1_flash_14
	layer1_attn_v_14 -> layer1_flash_14
	layer1_flash_14 -> layer1_out_14
	layer1_out_14 -> layer1_gather
	layer1_qsplit -> layer1_attn_q_15
	layer1_kvbroadcast -> layer1_attn_k_15
	layer1_kvbroadcast -> layer1_attn_v_15
	layer1_attn_q_15 -> layer1_flash_15
	layer1_attn_k_15 -> layer1_flash_15
	layer1_attn_v_15 -> layer1_flash_15
	layer1_flash_15 -> layer1_out_15
	layer1_out_15 -> layer1_gather
	layer0_ffn_res -> layer1_attn_res
	layer1_gather -> layer1_attn_res
	layer1_attn_res -> layer1_ffn
	layer1_attn_res -> layer1_ffn_res
	layer1_ffn -> layer1_ffn_res
	layer1_ffn_res -> layer2_prenorm
	layer2_prenorm -> layer2_qsplit
	layer2_prenorm -> layer2_kvbroadcast
	layer2_qsplit -> layer2_attn_q_0
	layer2_kvbroadcast -> layer2_attn_k_0
	layer2_kvbroadcast -> layer2_attn_v_0
	layer2_attn_q_0 -> layer2_flash_0
	layer2_attn_k_0 -> layer2_flash_0
	layer2_attn_v_0 -> layer2_flash_0
	layer2_flash_0 -> layer2_out_0
	layer2_out_0 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_1
	layer2_kvbroadcast -> layer2_attn_k_1
	layer2_kvbroadcast -> layer2_attn_v_1
	layer2_attn_q_1 -> layer2_flash_1
	layer2_attn_k_1 -> layer2_flash_1
	layer2_attn_v_1 -> layer2_flash_1
	layer2_flash_1 -> layer2_out_1
	layer2_out_1 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_2
	layer2_kvbroadcast -> layer2_attn_k_2
	layer2_kvbroadcast -> layer2_attn_v_2
	layer2_attn_q_2 -> layer2_flash_2
	layer2_attn_k_2 -> layer2_flash_2
	layer2_attn_v_2 -> layer2_flash_2
	layer2_flash_2 -> layer2_out_2
	layer2_out_2 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_3
	layer2_kvbroadcast -> layer2_attn_k_3
	layer2_kvbroadcast -> layer2_attn_v_3
	layer2_attn_q_3 -> layer2_flash_3
	layer2_attn_k_3 -> layer2_flash_3
	layer2_attn_v_3 -> layer2_flash_3
	layer2_flash_3 -> layer2_out_3
	layer2_out_3 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_4
	layer2_kvbroadcast -> layer2_attn_k_4
	layer2_kvbroadcast -> layer2_attn_v_4
	layer2_attn_q_4 -> layer2_flash_4
	layer2_attn_k_4 -> layer2_flash_4
	layer2_attn_v_4 -> layer2_flash_4
	layer2_flash_4 -> layer2_out_4
	layer2_out_4 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_5
	layer2_kvbroadcast -> layer2_attn_k_5
	layer2_kvbroadcast -> layer2_attn_v_5
	layer2_attn_q_5 -> layer2_flash_5
	layer2_attn_k_5 -> layer2_flash_5
	layer2_attn_v_5 -> layer2_flash_5
	layer2_flash_5 -> layer2_out_5
	layer2_out_5 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_6
	layer2_kvbroadcast -> layer2_attn_k_6
	layer2_kvbroadcast -> layer2_attn_v_6
	layer2_attn_q_6 -> layer2_flash_6
	layer2_attn_k_6 -> layer2_flash_6
	layer2_attn_v_6 -> layer2_flash_6
	layer2_flash_6 -> layer2_out_6
	layer2_out_6 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_7
	layer2_kvbroadcast -> layer2_attn_k_7
	layer2_kvbroadcast -> layer2_attn_v_7
	layer2_attn_q_7 -> layer2_flash_7
	layer2_attn_k_7 -> layer2_flash_7
	layer2_attn_v_7 -> layer2_flash_7
	layer2_flash_7 -> layer2_out_7
	layer2_out_7 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_8
	layer2_kvbroadcast -> layer2_attn_k_8
	layer2_kvbroadcast -> layer2_attn_v_8
	layer2_attn_q_8 -> layer2_flash_8
	layer2_attn_k_8 -> layer2_flash_8
	layer2_attn_v_8 -> layer2_flash_8
	layer2_flash_8 -> layer2_out_8
	layer2_out_8 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_9
	layer2_kvbroadcast -> layer2_attn_k_9
	layer2_kvbroadcast -> layer2_attn_v_9
	layer2_attn_q_9 -> layer2_flash_9
	layer2_attn_k_9 -> layer2_flash_9
	layer2_attn_v_9 -> layer2_flash_9
	layer2_flash_9 -> layer2_out_9
	layer2_out_9 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_10
	layer2_kvbroadcast -> layer2_attn_k_10
	layer2_kvbroadcast -> layer2_attn_v_10
	layer2_attn_q_10 -> layer2_flash_10
	layer2_attn_k_10 -> layer2_flash_10
	layer2_attn_v_10 -> layer2_flash_10
	layer2_flash_10 -> layer2_out_10
	layer2_out_10 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_11
	layer2_kvbroadcast -> layer2_attn_k_11
	layer2_kvbroadcast -> layer2_attn_v_11
	layer2_attn_q_11 -> layer2_flash_11
	layer2_attn_k_11 -> layer2_flash_11
	layer2_attn_v_11 -> layer2_flash_11
	layer2_flash_11 -> layer2_out_11
	layer2_out_11 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_12
	layer2_kvbroadcast -> layer2_attn_k_12
	layer2_kvbroadcast -> layer2_attn_v_12
	layer2_attn_q_12 -> layer2_flash_12
	layer2_attn_k_12 -> layer2_flash_12
	layer2_attn_v_12 -> layer2_flash_12
	layer2_flash_12 -> layer2_out_12
	layer2_out_12 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_13
	layer2_kvbroadcast -> layer2_attn_k_13
	layer2_kvbroadcast -> layer2_attn_v_13
	layer2_attn_q_13 -> layer2_flash_13
	layer2_attn_k_13 -> layer2_flash_13
	layer2_attn_v_13 -> layer2_flash_13
	layer2_flash_13 -> layer2_out_13
	layer2_out_13 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_14
	layer2_kvbroadcast -> layer2_attn_k_14
	layer2_kvbroadcast -> layer2_attn_v_14
	layer2_attn_q_14 -> layer2_flash_14
	layer2_attn_k_14 -> layer2_flash_14
	layer2_attn_v_14 -> layer2_flash_14
	layer2_flash_14 -> layer2_out_14
	layer2_out_14 -> layer2_gather
	layer2_qsplit -> layer2_attn_q_15
	layer2_kvbroadcast -> layer2_attn_k_15
	layer2_kvbroadcast -> layer2_attn_v_15
	layer2_attn_q_15 -> layer2_flash_15
	layer2_attn_k_15 -> layer2_flash_15
	layer2_attn_v_15 -> layer2_flash_15
	layer2_flash_15 -> layer2_out_15
	layer2_out_15 -> layer2_gather
	layer1_ffn_res -> layer2_attn_res
	layer2_gather -> layer2_attn_res
	layer2_attn_res -> layer2_ffn
	layer2_attn_res -> layer2_ffn_res
	layer2_ffn -> layer2_ffn_res
	layer2_ffn_res -> layer3_prenorm
	layer3_prenorm -> layer3_qsplit
	layer3_prenorm -> layer3_kvbroadcast
	layer3_qsplit -> layer3_attn_q_0
	layer3_kvbroadcast -> layer3_attn_k_0
	layer3_kvbroadcast -> layer3_attn_v_0
	layer3_attn_q_0 -> layer3_flash_0
	layer3_attn_k_0 -> layer3_flash_0
	layer3_attn_v_0 -> layer3_flash_0
	layer3_flash_0 -> layer3_out_0
	layer3_out_0 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_1
	layer3_kvbroadcast -> layer3_attn_k_1
	layer3_kvbroadcast -> layer3_attn_v_1
	layer3_attn_q_1 -> layer3_flash_1
	layer3_attn_k_1 -> layer3_flash_1
	layer3_attn_v_1 -> layer3_flash_1
	layer3_flash_1 -> layer3_out_1
	layer3_out_1 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_2
	layer3_kvbroadcast -> layer3_attn_k_2
	layer3_kvbroadcast -> layer3_attn_v_2
	layer3_attn_q_2 -> layer3_flash_2
	layer3_attn_k_2 -> layer3_flash_2
	layer3_attn_v_2 -> layer3_flash_2
	layer3_flash_2 -> layer3_out_2
	layer3_out_2 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_3
	layer3_kvbroadcast -> layer3_attn_k_3
	layer3_kvbroadcast -> layer3_attn_v_3
	layer3_attn_q_3 -> layer3_flash_3
	layer3_attn_k_3 -> layer3_flash_3
	layer3_attn_v_3 -> layer3_flash_3
	layer3_flash_3 -> layer3_out_3
	layer3_out_3 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_4
	layer3_kvbroadcast -> layer3_attn_k_4
	layer3_kvbroadcast -> layer3_attn_v_4
	layer3_attn_q_4 -> layer3_flash_4
	layer3_attn_k_4 -> layer3_flash_4
	layer3_attn_v_4 -> layer3_flash_4
	layer3_flash_4 -> layer3_out_4
	layer3_out_4 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_5
	layer3_kvbroadcast -> layer3_attn_k_5
	layer3_kvbroadcast -> layer3_attn_v_5
	layer3_attn_q_5 -> layer3_flash_5
	layer3_attn_k_5 -> layer3_flash_5
	layer3_attn_v_5 -> layer3_flash_5
	layer3_flash_5 -> layer3_out_5
	layer3_out_5 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_6
	layer3_kvbroadcast -> layer3_attn_k_6
	layer3_kvbroadcast -> layer3_attn_v_6
	layer3_attn_q_6 -> layer3_flash_6
	layer3_attn_k_6 -> layer3_flash_6
	layer3_attn_v_6 -> layer3_flash_6
	layer3_flash_6 -> layer3_out_6
	layer3_out_6 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_7
	layer3_kvbroadcast -> layer3_attn_k_7
	layer3_kvbroadcast -> layer3_attn_v_7
	layer3_attn_q_7 -> layer3_flash_7
	layer3_attn_k_7 -> layer3_flash_7
	layer3_attn_v_7 -> layer3_flash_7
	layer3_flash_7 -> layer3_out_7
	layer3_out_7 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_8
	layer3_kvbroadcast -> layer3_attn_k_8
	layer3_kvbroadcast -> layer3_attn_v_8
	layer3_attn_q_8 -> layer3_flash_8
	layer3_attn_k_8 -> layer3_flash_8
	layer3_attn_v_8 -> layer3_flash_8
	layer3_flash_8 -> layer3_out_8
	layer3_out_8 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_9
	layer3_kvbroadcast -> layer3_attn_k_9
	layer3_kvbroadcast -> layer3_attn_v_9
	layer3_attn_q_9 -> layer3_flash_9
	layer3_attn_k_9 -> layer3_flash_9
	layer3_attn_v_9 -> layer3_flash_9
	layer3_flash_9 -> layer3_out_9
	layer3_out_9 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_10
	layer3_kvbroadcast -> layer3_attn_k_10
	layer3_kvbroadcast -> layer3_attn_v_10
	layer3_attn_q_10 -> layer3_flash_10
	layer3_attn_k_10 -> layer3_flash_10
	layer3_attn_v_10 -> layer3_flash_10
	layer3_flash_10 -> layer3_out_10
	layer3_out_10 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_11
	layer3_kvbroadcast -> layer3_attn_k_11
	layer3_kvbroadcast -> layer3_attn_v_11
	layer3_attn_q_11 -> layer3_flash_11
	layer3_attn_k_11 -> layer3_flash_11
	layer3_attn_v_11 -> layer3_flash_11
	layer3_flash_11 -> layer3_out_11
	layer3_out_11 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_12
	layer3_kvbroadcast -> layer3_attn_k_12
	layer3_kvbroadcast -> layer3_attn_v_12
	layer3_attn_q_12 -> layer3_flash_12
	layer3_attn_k_12 -> layer3_flash_12
	layer3_attn_v_12 -> layer3_flash_12
	layer3_flash_12 -> layer3_out_12
	layer3_out_12 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_13
	layer3_kvbroadcast -> layer3_attn_k_13
	layer3_kvbroadcast -> layer3_attn_v_13
	layer3_attn_q_13 -> layer3_flash_13
	layer3_attn_k_13 -> layer3_flash_13
	layer3_attn_v_13 -> layer3_flash_13
	layer3_flash_13 -> layer3_out_13
	layer3_out_13 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_14
	layer3_kvbroadcast -> layer3_attn_k_14
	layer3_kvbroadcast -> layer3_attn_v_14
	layer3_attn_q_14 -> layer3_flash_14
	layer3_attn_k_14 -> layer3_flash_14
	layer3_attn_v_14 -> layer3_flash_14
	layer3_flash_14 -> layer3_out_14
	layer3_out_14 -> layer3_gather
	layer3_qsplit -> layer3_attn_q_15
	layer3_kvbroadcast -> layer3_attn_k_15
	layer3_kvbroadcast -> layer3_attn_v_15
	layer3_attn_q_15 -> layer3_flash_15
	layer3_attn_k_15 -> layer3_flash_15
	layer3_attn_v_15 -> layer3_flash_15
	layer3_flash_15 -> layer3_out_15
	layer3_out_15 -> layer3_gather
	layer2_ffn_res -> layer3_attn_res
	layer3_gather -> layer3_attn_res
	layer3_attn_res -> layer3_ffn
	layer3_attn_res -> layer3_ffn_res
	layer3_ffn -> layer3_ffn_res
	layer3_ffn_res -> output
}
