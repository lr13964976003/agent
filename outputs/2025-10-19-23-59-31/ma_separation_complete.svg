<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- MA Separation Complete Model DAG &#45; 16 GPUs -->
<!-- Title: ma_separation_complete Pages: 1 -->
<svg width="1800pt" height="845pt"
 viewBox="0.00 0.00 1800.00 845.48" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.25 0.25) rotate(0) translate(4 3321.54)">
<title>ma_separation_complete</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3321.54 7076,-3321.54 7076,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e6f3ff" stroke="black" cx="2905" cy="-3280.77" rx="140.93" ry="36.54"/>
<text text-anchor="middle" x="2905" y="-3294.77" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="2905" y="-3283.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048]</text>
<text text-anchor="middle" x="2905" y="-3272.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048]</text>
<text text-anchor="middle" x="2905" y="-3261.77" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- embedding -->
<g id="node3" class="node">
<title>embedding</title>
<polygon fill="#000080" stroke="black" points="3047,-3208 2763,-3208 2763,-3156 3047,-3156 3047,-3208"/>
<text text-anchor="middle" x="2905" y="-3196" font-family="Arial" font-size="10.00">Embedding</text>
<text text-anchor="middle" x="2905" y="-3185" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048]</text>
<text text-anchor="middle" x="2905" y="-3174" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2905" y="-3163" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;embedding -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embedding</title>
<path fill="none" stroke="black" d="M2905,-3243.74C2905,-3235.42 2905,-3226.59 2905,-3218.31"/>
<polygon fill="black" stroke="black" points="2908.5,-3218.2 2905,-3208.2 2901.5,-3218.2 2908.5,-3218.2"/>
</g>
<!-- output -->
<g id="node2" class="node">
<title>output</title>
<ellipse fill="#e6f3ff" stroke="black" cx="2257" cy="-140" rx="202.88" ry="36.54"/>
<text text-anchor="middle" x="2257" y="-154" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="2257" y="-143" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2257" y="-132" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, vocab_size=50265]</text>
<text text-anchor="middle" x="2257" y="-121" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln1_0 -->
<g id="node4" class="node">
<title>ln1_0</title>
<polygon fill="#000080" stroke="black" points="2174,-3120 1890,-3120 1890,-3068 2174,-3068 2174,-3120"/>
<text text-anchor="middle" x="2032" y="-3108" font-family="Arial" font-size="10.00">LayerNorm 0</text>
<text text-anchor="middle" x="2032" y="-3097" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2032" y="-3086" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2032" y="-3075" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- embedding&#45;&gt;ln1_0 -->
<g id="edge2" class="edge">
<title>embedding&#45;&gt;ln1_0</title>
<path fill="none" stroke="black" d="M2762.79,-3166.99C2603.78,-3151.33 2347.24,-3126.05 2184.26,-3110"/>
<polygon fill="black" stroke="black" points="2184.44,-3106.5 2174.14,-3109 2183.75,-3113.47 2184.44,-3106.5"/>
</g>
<!-- residual1_0 -->
<g id="node19" class="node">
<title>residual1_0</title>
<polygon fill="#ffffcc" stroke="black" points="3199.38,-2716 2731.09,-2716 2610.62,-2612 3078.91,-2612 3199.38,-2716"/>
<text text-anchor="middle" x="2905" y="-2678" font-family="Arial" font-size="10.00">Residual Add 0</text>
<text text-anchor="middle" x="2905" y="-2667" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2905" y="-2656" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2905" y="-2645" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- embedding&#45;&gt;residual1_0 -->
<g id="edge29" class="edge">
<title>embedding&#45;&gt;residual1_0</title>
<path fill="none" stroke="black" d="M3047.21,-3181.57C3294.58,-3178.68 3778,-3154.2 3778,-3007 3778,-3007 3778,-3007 3778,-2891 3778,-2763.88 3426.71,-2707.09 3169.81,-2682.56"/>
<polygon fill="black" stroke="black" points="3169.85,-2679.05 3159.56,-2681.6 3169.19,-2686.02 3169.85,-2679.05"/>
</g>
<!-- qkv_0_0 -->
<g id="node5" class="node">
<title>qkv_0_0</title>
<polygon fill="#0014ff" stroke="black" points="3436,-3032 3140,-3032 3140,-2980 3436,-2980 3436,-3032"/>
<text text-anchor="middle" x="3288" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 0</text>
<text text-anchor="middle" x="3288" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3288" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3288" y="-2987" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_0 -->
<g id="edge3" class="edge">
<title>ln1_0&#45;&gt;qkv_0_0</title>
<path fill="none" stroke="black" d="M2174.2,-3089.76C2382.04,-3083.98 2781.06,-3068.94 3129.68,-3032.09"/>
<polygon fill="black" stroke="black" points="3130.15,-3035.56 3139.72,-3031.03 3129.41,-3028.6 3130.15,-3035.56"/>
</g>
<!-- qkv_0_1 -->
<g id="node6" class="node">
<title>qkv_0_1</title>
<polygon fill="#001eff" stroke="black" points="3750,-3032 3454,-3032 3454,-2980 3750,-2980 3750,-3032"/>
<text text-anchor="middle" x="3602" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 1</text>
<text text-anchor="middle" x="3602" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3602" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3602" y="-2987" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_1 -->
<g id="edge4" class="edge">
<title>ln1_0&#45;&gt;qkv_0_1</title>
<path fill="none" stroke="black" d="M2174.03,-3092.25C2427.34,-3089.72 2973.78,-3078.9 3443.69,-3032.08"/>
<polygon fill="black" stroke="black" points="3444.13,-3035.56 3453.73,-3031.07 3443.43,-3028.59 3444.13,-3035.56"/>
</g>
<!-- qkv_0_2 -->
<g id="node7" class="node">
<title>qkv_0_2</title>
<polygon fill="#0028ff" stroke="black" points="296,-3032 0,-3032 0,-2980 296,-2980 296,-3032"/>
<text text-anchor="middle" x="148" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 2</text>
<text text-anchor="middle" x="148" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="148" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="148" y="-2987" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_2 -->
<g id="edge5" class="edge">
<title>ln1_0&#45;&gt;qkv_0_2</title>
<path fill="none" stroke="black" d="M1889.74,-3093.86C1595.59,-3094.36 899.1,-3088.87 306.3,-3032.07"/>
<polygon fill="black" stroke="black" points="306.56,-3028.58 296.27,-3031.11 305.89,-3035.55 306.56,-3028.58"/>
</g>
<!-- qkv_0_3 -->
<g id="node8" class="node">
<title>qkv_0_3</title>
<polygon fill="#0032ff" stroke="black" points="610,-3032 314,-3032 314,-2980 610,-2980 610,-3032"/>
<text text-anchor="middle" x="462" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 3</text>
<text text-anchor="middle" x="462" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="462" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="462" y="-2987" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_3 -->
<g id="edge6" class="edge">
<title>ln1_0&#45;&gt;qkv_0_3</title>
<path fill="none" stroke="black" d="M1889.97,-3092.25C1636.66,-3089.72 1090.22,-3078.9 620.31,-3032.08"/>
<polygon fill="black" stroke="black" points="620.57,-3028.59 610.27,-3031.07 619.87,-3035.56 620.57,-3028.59"/>
</g>
<!-- qkv_0_4 -->
<g id="node9" class="node">
<title>qkv_0_4</title>
<polygon fill="#003cff" stroke="black" points="924,-3032 628,-3032 628,-2980 924,-2980 924,-3032"/>
<text text-anchor="middle" x="776" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 4</text>
<text text-anchor="middle" x="776" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="776" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="776" y="-2987" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_4 -->
<g id="edge7" class="edge">
<title>ln1_0&#45;&gt;qkv_0_4</title>
<path fill="none" stroke="black" d="M1889.8,-3089.76C1681.96,-3083.98 1282.94,-3068.94 934.32,-3032.09"/>
<polygon fill="black" stroke="black" points="934.59,-3028.6 924.28,-3031.03 933.85,-3035.56 934.59,-3028.6"/>
</g>
<!-- qkv_0_5 -->
<g id="node10" class="node">
<title>qkv_0_5</title>
<polygon fill="#0046ff" stroke="black" points="1238,-3032 942,-3032 942,-2980 1238,-2980 1238,-3032"/>
<text text-anchor="middle" x="1090" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 5</text>
<text text-anchor="middle" x="1090" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1090" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1090" y="-2987" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_5 -->
<g id="edge8" class="edge">
<title>ln1_0&#45;&gt;qkv_0_5</title>
<path fill="none" stroke="black" d="M1889.85,-3085.4C1734.65,-3076.31 1478.62,-3059.01 1248.53,-3032.14"/>
<polygon fill="black" stroke="black" points="1248.63,-3028.63 1238.29,-3030.94 1247.81,-3035.58 1248.63,-3028.63"/>
</g>
<!-- qkv_0_6 -->
<g id="node11" class="node">
<title>qkv_0_6</title>
<polygon fill="#0050ff" stroke="black" points="1552,-3032 1256,-3032 1256,-2980 1552,-2980 1552,-3032"/>
<text text-anchor="middle" x="1404" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 6</text>
<text text-anchor="middle" x="1404" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1404" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1404" y="-2987" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_6 -->
<g id="edge9" class="edge">
<title>ln1_0&#45;&gt;qkv_0_6</title>
<path fill="none" stroke="black" d="M1889.9,-3075.69C1799.01,-3064.36 1678.33,-3048.83 1562.44,-3032.19"/>
<polygon fill="black" stroke="black" points="1562.71,-3028.7 1552.32,-3030.74 1561.71,-3035.62 1562.71,-3028.7"/>
</g>
<!-- qkv_0_7 -->
<g id="node12" class="node">
<title>qkv_0_7</title>
<polygon fill="#005aff" stroke="black" points="1866,-3032 1570,-3032 1570,-2980 1866,-2980 1866,-3032"/>
<text text-anchor="middle" x="1718" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 7</text>
<text text-anchor="middle" x="1718" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1718" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1718" y="-2987" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_7 -->
<g id="edge10" class="edge">
<title>ln1_0&#45;&gt;qkv_0_7</title>
<path fill="none" stroke="black" d="M1940.33,-3067.89C1902.37,-3057.5 1858.2,-3045.4 1819.28,-3034.74"/>
<polygon fill="black" stroke="black" points="1820.08,-3031.33 1809.51,-3032.06 1818.23,-3038.08 1820.08,-3031.33"/>
</g>
<!-- qkv_0_8 -->
<g id="node13" class="node">
<title>qkv_0_8</title>
<polygon fill="#0064ff" stroke="black" points="2180,-3032 1884,-3032 1884,-2980 2180,-2980 2180,-3032"/>
<text text-anchor="middle" x="2032" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 8</text>
<text text-anchor="middle" x="2032" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2032" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="2032" y="-2987" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_8 -->
<g id="edge11" class="edge">
<title>ln1_0&#45;&gt;qkv_0_8</title>
<path fill="none" stroke="black" d="M2032,-3067.66C2032,-3059.7 2032,-3050.76 2032,-3042.24"/>
<polygon fill="black" stroke="black" points="2035.5,-3042.16 2032,-3032.16 2028.5,-3042.16 2035.5,-3042.16"/>
</g>
<!-- qkv_0_9 -->
<g id="node14" class="node">
<title>qkv_0_9</title>
<polygon fill="#006eff" stroke="black" points="2494,-3032 2198,-3032 2198,-2980 2494,-2980 2494,-3032"/>
<text text-anchor="middle" x="2346" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 9</text>
<text text-anchor="middle" x="2346" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2346" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="2346" y="-2987" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_9 -->
<g id="edge12" class="edge">
<title>ln1_0&#45;&gt;qkv_0_9</title>
<path fill="none" stroke="black" d="M2123.67,-3067.89C2161.63,-3057.5 2205.8,-3045.4 2244.72,-3034.74"/>
<polygon fill="black" stroke="black" points="2245.77,-3038.08 2254.49,-3032.06 2243.92,-3031.33 2245.77,-3038.08"/>
</g>
<!-- qkv_0_10 -->
<g id="node15" class="node">
<title>qkv_0_10</title>
<polygon fill="#0078ff" stroke="black" points="2808,-3032 2512,-3032 2512,-2980 2808,-2980 2808,-3032"/>
<text text-anchor="middle" x="2660" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 10</text>
<text text-anchor="middle" x="2660" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2660" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="2660" y="-2987" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_10 -->
<g id="edge13" class="edge">
<title>ln1_0&#45;&gt;qkv_0_10</title>
<path fill="none" stroke="black" d="M2174.1,-3075.69C2264.99,-3064.36 2385.67,-3048.83 2501.56,-3032.19"/>
<polygon fill="black" stroke="black" points="2502.29,-3035.62 2511.68,-3030.74 2501.29,-3028.7 2502.29,-3035.62"/>
</g>
<!-- qkv_0_11 -->
<g id="node16" class="node">
<title>qkv_0_11</title>
<polygon fill="#0082ff" stroke="black" points="3122,-3032 2826,-3032 2826,-2980 3122,-2980 3122,-3032"/>
<text text-anchor="middle" x="2974" y="-3020" font-family="Arial" font-size="10.00">QKV Proj 11</text>
<text text-anchor="middle" x="2974" y="-3009" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2974" y="-2998" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="2974" y="-2987" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- ln1_0&#45;&gt;qkv_0_11 -->
<g id="edge14" class="edge">
<title>ln1_0&#45;&gt;qkv_0_11</title>
<path fill="none" stroke="black" d="M2174.15,-3085.4C2329.35,-3076.31 2585.38,-3059.01 2815.47,-3032.14"/>
<polygon fill="black" stroke="black" points="2816.19,-3035.58 2825.71,-3030.94 2815.37,-3028.63 2816.19,-3035.58"/>
</g>
<!-- attn_agg_0 -->
<g id="node17" class="node">
<title>attn_agg_0</title>
<polygon fill="#ffffcc" stroke="black" points="2326.38,-2944 1858.09,-2944 1737.62,-2840 2205.91,-2840 2326.38,-2944"/>
<text text-anchor="middle" x="2032" y="-2906" font-family="Arial" font-size="10.00">All&#45;Reduce Attention 0</text>
<text text-anchor="middle" x="2032" y="-2895" font-family="Arial" font-size="10.00">Input: [12× partial attention outputs]</text>
<text text-anchor="middle" x="2032" y="-2884" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2032" y="-2873" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- qkv_0_0&#45;&gt;attn_agg_0 -->
<g id="edge15" class="edge">
<title>qkv_0_0&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M3139.71,-2981.07C3136.78,-2980.7 3133.88,-2980.34 3131,-2980 2845.79,-2946.06 2517.31,-2922.01 2294.29,-2907.93"/>
<polygon fill="black" stroke="black" points="2294.28,-2904.42 2284.08,-2907.28 2293.84,-2911.4 2294.28,-2904.42"/>
</g>
<!-- qkv_0_1&#45;&gt;attn_agg_0 -->
<g id="edge16" class="edge">
<title>qkv_0_1&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M3453.72,-2981C3450.79,-2980.65 3447.88,-2980.32 3445,-2980 3041.35,-2935.54 2570.13,-2912.23 2286.72,-2901.29"/>
<polygon fill="black" stroke="black" points="2286.84,-2897.79 2276.72,-2900.9 2286.58,-2904.79 2286.84,-2897.79"/>
</g>
<!-- qkv_0_2&#45;&gt;attn_agg_0 -->
<g id="edge17" class="edge">
<title>qkv_0_2&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M296.28,-2980.95C299.21,-2980.62 302.12,-2980.3 305,-2980 834.35,-2924.68 1458.79,-2904.26 1792.73,-2896.93"/>
<polygon fill="black" stroke="black" points="1793.1,-2900.42 1803.02,-2896.7 1792.94,-2893.42 1793.1,-2900.42"/>
</g>
<!-- qkv_0_3&#45;&gt;attn_agg_0 -->
<g id="edge18" class="edge">
<title>qkv_0_3&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M610.28,-2981C613.21,-2980.65 616.12,-2980.32 619,-2980 1032.11,-2934.5 1515.97,-2911.15 1796.88,-2900.54"/>
<polygon fill="black" stroke="black" points="1797.34,-2904.03 1807.2,-2900.15 1797.08,-2897.03 1797.34,-2904.03"/>
</g>
<!-- qkv_0_4&#45;&gt;attn_agg_0 -->
<g id="edge19" class="edge">
<title>qkv_0_4&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M924.29,-2981.07C927.22,-2980.7 930.12,-2980.34 933,-2980 1232.72,-2944.33 1580.22,-2919.59 1802.9,-2905.85"/>
<polygon fill="black" stroke="black" points="1803.31,-2909.33 1813.08,-2905.23 1802.88,-2902.35 1803.31,-2909.33"/>
</g>
<!-- qkv_0_5&#45;&gt;attn_agg_0 -->
<g id="edge20" class="edge">
<title>qkv_0_5&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M1238.31,-2981.19C1241.23,-2980.79 1244.13,-2980.39 1247,-2980 1437.48,-2954.29 1654.71,-2930.66 1812.3,-2914.53"/>
<polygon fill="black" stroke="black" points="1813,-2917.97 1822.59,-2913.48 1812.29,-2911.01 1813,-2917.97"/>
</g>
<!-- qkv_0_6&#45;&gt;attn_agg_0 -->
<g id="edge21" class="edge">
<title>qkv_0_6&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M1544.54,-2979.93C1628.18,-2965.02 1735.75,-2945.84 1828.54,-2929.29"/>
<polygon fill="black" stroke="black" points="1829.4,-2932.69 1838.63,-2927.49 1828.17,-2925.8 1829.4,-2932.69"/>
</g>
<!-- qkv_0_7&#45;&gt;attn_agg_0 -->
<g id="edge22" class="edge">
<title>qkv_0_7&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M1788.47,-2979.87C1815.42,-2970.25 1847.33,-2958.87 1879.01,-2947.57"/>
<polygon fill="black" stroke="black" points="1880.59,-2950.72 1888.84,-2944.06 1878.24,-2944.13 1880.59,-2950.72"/>
</g>
<!-- qkv_0_8&#45;&gt;attn_agg_0 -->
<g id="edge23" class="edge">
<title>qkv_0_8&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M2032,-2979.87C2032,-2972.18 2032,-2963.37 2032,-2954.37"/>
<polygon fill="black" stroke="black" points="2035.5,-2954.18 2032,-2944.18 2028.5,-2954.18 2035.5,-2954.18"/>
</g>
<!-- qkv_0_9&#45;&gt;attn_agg_0 -->
<g id="edge24" class="edge">
<title>qkv_0_9&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M2275.53,-2979.87C2248.58,-2970.25 2216.67,-2958.87 2184.99,-2947.57"/>
<polygon fill="black" stroke="black" points="2185.76,-2944.13 2175.16,-2944.06 2183.41,-2950.72 2185.76,-2944.13"/>
</g>
<!-- qkv_0_10&#45;&gt;attn_agg_0 -->
<g id="edge25" class="edge">
<title>qkv_0_10&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M2519.46,-2979.93C2462.59,-2969.79 2394.67,-2957.68 2327.85,-2945.76"/>
<polygon fill="black" stroke="black" points="2328.46,-2942.32 2318,-2944.01 2327.23,-2949.21 2328.46,-2942.32"/>
</g>
<!-- qkv_0_11&#45;&gt;attn_agg_0 -->
<g id="edge26" class="edge">
<title>qkv_0_11&#45;&gt;attn_agg_0</title>
<path fill="none" stroke="black" d="M2825.69,-2981.19C2822.77,-2980.79 2819.87,-2980.39 2817,-2980 2648.47,-2957.26 2458.98,-2936.13 2308.4,-2920.39"/>
<polygon fill="black" stroke="black" points="2308.4,-2916.87 2298.09,-2919.32 2307.67,-2923.83 2308.4,-2916.87"/>
</g>
<!-- out_proj_0 -->
<g id="node18" class="node">
<title>out_proj_0</title>
<polygon fill="#000080" stroke="black" points="2962,-2804 2678,-2804 2678,-2752 2962,-2752 2962,-2804"/>
<text text-anchor="middle" x="2820" y="-2792" font-family="Arial" font-size="10.00">Output Projection 0</text>
<text text-anchor="middle" x="2820" y="-2781" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2820" y="-2770" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2820" y="-2759" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- attn_agg_0&#45;&gt;out_proj_0 -->
<g id="edge27" class="edge">
<title>attn_agg_0&#45;&gt;out_proj_0</title>
<path fill="none" stroke="black" d="M2232.12,-2862.56C2367.63,-2843.3 2543.91,-2818.24 2667.96,-2800.61"/>
<polygon fill="black" stroke="black" points="2668.52,-2804.07 2677.92,-2799.19 2667.53,-2797.14 2668.52,-2804.07"/>
</g>
<!-- out_proj_0&#45;&gt;residual1_0 -->
<g id="edge28" class="edge">
<title>out_proj_0&#45;&gt;residual1_0</title>
<path fill="none" stroke="black" d="M2839.08,-2751.87C2845.35,-2743.6 2852.61,-2734.03 2859.97,-2724.33"/>
<polygon fill="black" stroke="black" points="2862.9,-2726.26 2866.16,-2716.18 2857.33,-2722.03 2862.9,-2726.26"/>
</g>
<!-- ln2_0 -->
<g id="node20" class="node">
<title>ln2_0</title>
<polygon fill="#000080" stroke="black" points="3584,-2576 3300,-2576 3300,-2524 3584,-2524 3584,-2576"/>
<text text-anchor="middle" x="3442" y="-2564" font-family="Arial" font-size="10.00">LayerNorm 0 (MoE)</text>
<text text-anchor="middle" x="3442" y="-2553" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3442" y="-2542" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3442" y="-2531" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_0&#45;&gt;ln2_0 -->
<g id="edge30" class="edge">
<title>residual1_0&#45;&gt;ln2_0</title>
<path fill="none" stroke="black" d="M3092.82,-2623.83C3165.17,-2608.74 3246.14,-2591.85 3311.88,-2578.14"/>
<polygon fill="black" stroke="black" points="3312.8,-2581.52 3321.88,-2576.05 3311.37,-2574.67 3312.8,-2581.52"/>
</g>
<!-- residual2_0 -->
<g id="node39" class="node">
<title>residual2_0</title>
<polygon fill="#ffffcc" stroke="black" points="4857.38,-2120 4389.09,-2120 4268.62,-2016 4736.91,-2016 4857.38,-2120"/>
<text text-anchor="middle" x="4563" y="-2082" font-family="Arial" font-size="10.00">Residual Add 0 (MoE)</text>
<text text-anchor="middle" x="4563" y="-2071" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4563" y="-2060" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4563" y="-2049" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_0&#45;&gt;residual2_0 -->
<g id="edge81" class="edge">
<title>residual1_0&#45;&gt;residual2_0</title>
<path fill="none" stroke="black" d="M2963.11,-2611.79C3037.08,-2549.19 3171.16,-2444.18 3303,-2384 3652.18,-2224.62 4094.1,-2137.92 4351.03,-2097.72"/>
<polygon fill="black" stroke="black" points="4351.89,-2101.12 4361.23,-2096.13 4350.81,-2094.21 4351.89,-2101.12"/>
</g>
<!-- gate_0 -->
<g id="node21" class="node">
<title>gate_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3888.43,-2488 3429.6,-2488 3311.57,-2384 3770.4,-2384 3888.43,-2488"/>
<text text-anchor="middle" x="3600" y="-2450" font-family="Arial" font-size="10.00">Gating Network 0</text>
<text text-anchor="middle" x="3600" y="-2439" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3600" y="-2428" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="3600" y="-2417" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln2_0&#45;&gt;gate_0 -->
<g id="edge31" class="edge">
<title>ln2_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M3477.46,-2523.87C3490.05,-2514.94 3504.78,-2504.5 3519.59,-2494"/>
<polygon fill="black" stroke="black" points="3521.67,-2496.82 3527.8,-2488.18 3517.62,-2491.11 3521.67,-2496.82"/>
</g>
<!-- exp_0_12 -->
<g id="node22" class="node">
<title>exp_0_12</title>
<polygon fill="#ff8800" stroke="black" points="5065,-2348 4781,-2348 4781,-2296 5065,-2296 5065,-2348"/>
<text text-anchor="middle" x="4923" y="-2336" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4923" y="-2325" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4923" y="-2314" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4923" y="-2303" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_0&#45;&gt;exp_0_12 -->
<g id="edge32" class="edge">
<title>ln2_0&#45;&gt;exp_0_12</title>
<path fill="none" stroke="black" d="M3584.06,-2530.93C3673.86,-2519.26 3792.33,-2503.43 3897,-2488 4207.89,-2442.17 4570.71,-2382.32 4770.86,-2348.74"/>
<polygon fill="black" stroke="black" points="4771.58,-2352.17 4780.86,-2347.07 4770.42,-2345.27 4771.58,-2352.17"/>
</g>
<!-- exp_1_12 -->
<g id="node23" class="node">
<title>exp_1_12</title>
<polygon fill="#ff8800" stroke="black" points="3765,-52 3481,-52 3481,0 3765,0 3765,-52"/>
<text text-anchor="middle" x="3623" y="-40" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3623" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3623" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3623" y="-7" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_0&#45;&gt;exp_1_12 -->
<g id="edge33" class="edge">
<title>ln2_0&#45;&gt;exp_1_12</title>
<path fill="none" stroke="black" d="M3313.2,-2523.79C3296.24,-2515.13 3280.97,-2503.53 3270,-2488 3184.87,-2367.48 3267.09,-2303.53 3270,-2156 3278.45,-1727.31 3229.56,-1613.54 3308,-1192 3315.56,-1151.38 3310.26,-1134.63 3338,-1104 3363.9,-1075.4 3393.98,-1098.97 3417,-1068 3445.03,-1030.29 3474,-695.98 3474,-649 3474,-649 3474,-649 3474,-533 3474,-459.18 3504.93,-422.37 3455,-368 3400.4,-308.56 3328.33,-394.29 3277,-332 3208.04,-248.31 3206.27,-171.06 3276,-88 3277.7,-85.98 3378.36,-68.42 3470.82,-52.65"/>
<polygon fill="black" stroke="black" points="3471.62,-56.07 3480.89,-50.94 3470.44,-49.17 3471.62,-56.07"/>
</g>
<!-- exp_2_12 -->
<g id="node24" class="node">
<title>exp_2_12</title>
<polygon fill="#ff8800" stroke="black" points="1789,-52 1505,-52 1505,0 1789,0 1789,-52"/>
<text text-anchor="middle" x="1647" y="-40" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1647" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1647" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1647" y="-7" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_0&#45;&gt;exp_2_12 -->
<g id="edge34" class="edge">
<title>ln2_0&#45;&gt;exp_2_12</title>
<path fill="none" stroke="black" d="M3299.68,-2548.38C2870.52,-2545.98 1613.92,-2534.96 1540,-2488 1470.54,-2443.87 1456,-2405.29 1456,-2323 1456,-2323 1456,-2323 1456,-279 1456,-183.25 1544.67,-100.99 1601.17,-58.29"/>
<polygon fill="black" stroke="black" points="1603.32,-61.05 1609.26,-52.28 1599.15,-55.43 1603.32,-61.05"/>
</g>
<!-- exp_3_12 -->
<g id="node25" class="node">
<title>exp_3_12</title>
<polygon fill="#ff8800" stroke="black" points="2091,-52 1807,-52 1807,0 2091,0 2091,-52"/>
<text text-anchor="middle" x="1949" y="-40" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1949" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1949" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1949" y="-7" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_0&#45;&gt;exp_3_12 -->
<g id="edge35" class="edge">
<title>ln2_0&#45;&gt;exp_3_12</title>
<path fill="none" stroke="black" d="M3299.67,-2546.9C2895.8,-2540.58 1766.93,-2520.11 1694,-2488 1599.94,-2446.59 1532,-2425.77 1532,-2323 1532,-2323 1532,-2323 1532,-279 1532,-150.86 1678.03,-86.13 1797.25,-54.63"/>
<polygon fill="black" stroke="black" points="1798.43,-57.94 1807.24,-52.06 1796.68,-51.17 1798.43,-57.94"/>
</g>
<!-- exp_4_13 -->
<g id="node26" class="node">
<title>exp_4_13</title>
<polygon fill="#ff8800" stroke="black" points="2557,-52 2273,-52 2273,0 2557,0 2557,-52"/>
<text text-anchor="middle" x="2415" y="-40" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="2415" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2415" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2415" y="-7" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_0&#45;&gt;exp_4_13 -->
<g id="edge36" class="edge">
<title>ln2_0&#45;&gt;exp_4_13</title>
<path fill="none" stroke="black" d="M3299.77,-2547.74C2947.57,-2543.98 2054.06,-2530.34 1926,-2488 1802.4,-2447.14 1684,-2453.18 1684,-2323 1684,-2323 1684,-2323 1684,-419 1684,-231.93 1781.37,-180.44 1944,-88 1971.55,-72.34 2135.82,-53.5 2262.7,-40.93"/>
<polygon fill="black" stroke="black" points="2263.31,-44.39 2272.92,-39.93 2262.63,-37.42 2263.31,-44.39"/>
</g>
<!-- exp_5_13 -->
<g id="node27" class="node">
<title>exp_5_13</title>
<polygon fill="#ff8800" stroke="black" points="2859,-52 2575,-52 2575,0 2859,0 2859,-52"/>
<text text-anchor="middle" x="2717" y="-40" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="2717" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2717" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2717" y="-7" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_0&#45;&gt;exp_5_13 -->
<g id="edge37" class="edge">
<title>ln2_0&#45;&gt;exp_5_13</title>
<path fill="none" stroke="black" d="M3299.79,-2548.95C3115.41,-2546.79 2784.47,-2535.74 2506,-2488 2239.32,-2442.28 1920,-2593.57 1920,-2323 1920,-2323 1920,-2323 1920,-419 1920,-340.37 1979.83,-131.99 2045,-88 2091.07,-56.9 2474.14,-58.54 2564.63,-51.86"/>
<polygon fill="black" stroke="black" points="2565.15,-55.33 2574.79,-50.93 2564.51,-48.36 2565.15,-55.33"/>
</g>
<!-- exp_6_13 -->
<g id="node28" class="node">
<title>exp_6_13</title>
<polygon fill="#ff8800" stroke="black" points="3161,-52 2877,-52 2877,0 3161,0 3161,-52"/>
<text text-anchor="middle" x="3019" y="-40" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="3019" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3019" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3019" y="-7" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_0&#45;&gt;exp_6_13 -->
<g id="edge38" class="edge">
<title>ln2_0&#45;&gt;exp_6_13</title>
<path fill="none" stroke="black" d="M3299.73,-2546.86C3074.12,-2542.25 2654.05,-2528.32 2599,-2488 2491.34,-2409.14 2488,-2342.45 2488,-2209 2488,-2209 2488,-2209 2488,-761 2488,-685.33 2498.98,-665.02 2530,-596 2557.28,-535.28 2583.27,-531.05 2614,-472 2617.35,-465.57 2704.36,-234.76 2707,-228 2731.38,-165.58 2712.27,-131.79 2763,-88 2772.99,-79.37 2826.13,-66.11 2881.42,-54.14"/>
<polygon fill="black" stroke="black" points="2882.35,-57.52 2891.4,-52.01 2880.88,-50.68 2882.35,-57.52"/>
</g>
<!-- exp_7_13 -->
<g id="node29" class="node">
<title>exp_7_13</title>
<polygon fill="#ff8800" stroke="black" points="3463,-52 3179,-52 3179,0 3463,0 3463,-52"/>
<text text-anchor="middle" x="3321" y="-40" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="3321" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3321" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3321" y="-7" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_0&#45;&gt;exp_7_13 -->
<g id="edge39" class="edge">
<title>ln2_0&#45;&gt;exp_7_13</title>
<path fill="none" stroke="black" d="M3299.95,-2546.02C3089.3,-2540.4 2713.5,-2525.23 2664,-2488 2601.39,-2440.91 2602,-2401.34 2602,-2323 2602,-2323 2602,-2323 2602,-761 2602,-685.44 2612.51,-665.14 2643,-596 2670.35,-533.97 2924.31,-125.19 2981,-88 2985.25,-85.21 3080.48,-68.25 3169.07,-52.91"/>
<polygon fill="black" stroke="black" points="3169.74,-56.35 3179,-51.2 3168.55,-49.45 3169.74,-56.35"/>
</g>
<!-- exp_8_14 -->
<g id="node30" class="node">
<title>exp_8_14</title>
<polygon fill="#ff8800" stroke="black" points="4067,-52 3783,-52 3783,0 4067,0 4067,-52"/>
<text text-anchor="middle" x="3925" y="-40" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="3925" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3925" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3925" y="-7" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_0&#45;&gt;exp_8_14 -->
<g id="edge40" class="edge">
<title>ln2_0&#45;&gt;exp_8_14</title>
<path fill="none" stroke="black" d="M3344.82,-2523.83C3328.27,-2515.17 3313.16,-2503.55 3303,-2488 3277.72,-2449.3 3297.97,-2429.95 3303,-2384 3324.24,-2189.87 3398,-2150.29 3398,-1955 3398,-1955 3398,-1955 3398,-1243 3398,-1155.94 3460.24,-1151.16 3486,-1068 3560.14,-828.66 3565.17,-758.16 3551,-508 3548.35,-461.28 3489.32,-123.33 3520,-88 3555.55,-47.06 3702.29,-59.26 3772.56,-51.94"/>
<polygon fill="black" stroke="black" points="3773.27,-55.38 3782.75,-50.65 3772.39,-48.43 3773.27,-55.38"/>
</g>
<!-- exp_9_14 -->
<g id="node31" class="node">
<title>exp_9_14</title>
<polygon fill="#ff8800" stroke="black" points="5260,-52 4976,-52 4976,0 5260,0 5260,-52"/>
<text text-anchor="middle" x="5118" y="-40" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="5118" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5118" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5118" y="-7" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_0&#45;&gt;exp_9_14 -->
<g id="edge41" class="edge">
<title>ln2_0&#45;&gt;exp_9_14</title>
<path fill="none" stroke="black" d="M3584.17,-2546.08C4188.34,-2532.74 6512,-2471.78 6512,-2323 6512,-2323 6512,-2323 6512,-647 6512,-194.48 6088.16,-237.37 5661,-88 5498.91,-31.32 5444.55,-72.7 5270.24,-52.08"/>
<polygon fill="black" stroke="black" points="5270.58,-48.59 5260.22,-50.84 5269.72,-55.54 5270.58,-48.59"/>
</g>
<!-- exp_10_14 -->
<g id="node32" class="node">
<title>exp_10_14</title>
<polygon fill="#ff8800" stroke="black" points="5562,-52 5278,-52 5278,0 5562,0 5562,-52"/>
<text text-anchor="middle" x="5420" y="-40" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="5420" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5420" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5420" y="-7" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_0&#45;&gt;exp_10_14 -->
<g id="edge42" class="edge">
<title>ln2_0&#45;&gt;exp_10_14</title>
<path fill="none" stroke="black" d="M3584.17,-2548.6C4027.07,-2546.85 5378.34,-2537.48 5814,-2488 6179.91,-2446.44 6626,-2691.26 6626,-2323 6626,-2323 6626,-2323 6626,-647 6626,-202.25 6230.38,-183.47 5796,-88 5700.18,-66.94 5672.66,-68.17 5572.21,-52.18"/>
<polygon fill="black" stroke="black" points="5572.69,-48.71 5562.26,-50.58 5571.58,-55.62 5572.69,-48.71"/>
</g>
<!-- exp_11_14 -->
<g id="node33" class="node">
<title>exp_11_14</title>
<polygon fill="#ff8800" stroke="black" points="5864,-52 5580,-52 5580,0 5864,0 5864,-52"/>
<text text-anchor="middle" x="5722" y="-40" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="5722" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5722" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5722" y="-7" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_0&#45;&gt;exp_11_14 -->
<g id="edge43" class="edge">
<title>ln2_0&#45;&gt;exp_11_14</title>
<path fill="none" stroke="black" d="M3584.36,-2548.3C4115.99,-2545.37 5967.87,-2532.05 6229,-2488 6464.33,-2448.3 6740,-2561.66 6740,-2323 6740,-2323 6740,-2323 6740,-647 6740,-420.02 6640.56,-348.18 6448,-228 6285.37,-126.49 6225.27,-137.29 6040,-88 6008.16,-79.53 5938.79,-66.02 5872.95,-53.87"/>
<polygon fill="black" stroke="black" points="5873.31,-50.38 5862.84,-52.01 5872.04,-57.26 5873.31,-50.38"/>
</g>
<!-- exp_12_15 -->
<g id="node34" class="node">
<title>exp_12_15</title>
<polygon fill="#ff8800" stroke="black" points="6166,-52 5882,-52 5882,0 6166,0 6166,-52"/>
<text text-anchor="middle" x="6024" y="-40" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="6024" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="6024" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="6024" y="-7" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_0&#45;&gt;exp_12_15 -->
<g id="edge44" class="edge">
<title>ln2_0&#45;&gt;exp_12_15</title>
<path fill="none" stroke="black" d="M3584.14,-2548.02C4167.24,-2543.78 6351.99,-2525.44 6494,-2488 6635.16,-2450.79 6778,-2468.98 6778,-2323 6778,-2323 6778,-2323 6778,-647 6778,-432.17 6716.34,-346.28 6537,-228 6408.91,-143.52 6239.93,-85.99 6131.59,-54.81"/>
<polygon fill="black" stroke="black" points="6132.52,-51.44 6121.95,-52.06 6130.6,-58.17 6132.52,-51.44"/>
</g>
<!-- exp_13_15 -->
<g id="node35" class="node">
<title>exp_13_15</title>
<polygon fill="#ff8800" stroke="black" points="6468,-52 6184,-52 6184,0 6468,0 6468,-52"/>
<text text-anchor="middle" x="6326" y="-40" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="6326" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="6326" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="6326" y="-7" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_0&#45;&gt;exp_13_15 -->
<g id="edge45" class="edge">
<title>ln2_0&#45;&gt;exp_13_15</title>
<path fill="none" stroke="black" d="M3584.01,-2548.5C4185.02,-2546.13 6495.37,-2534.01 6643,-2488 6769.75,-2448.5 6892,-2455.76 6892,-2323 6892,-2323 6892,-2323 6892,-279 6892,-181.91 6610.53,-96.44 6444.57,-54.48"/>
<polygon fill="black" stroke="black" points="6445.35,-51.06 6434.8,-52.02 6443.64,-57.85 6445.35,-51.06"/>
</g>
<!-- exp_14_15 -->
<g id="node36" class="node">
<title>exp_14_15</title>
<polygon fill="#ff8800" stroke="black" points="6770,-52 6486,-52 6486,0 6770,0 6770,-52"/>
<text text-anchor="middle" x="6628" y="-40" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="6628" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="6628" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="6628" y="-7" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_0&#45;&gt;exp_14_15 -->
<g id="edge46" class="edge">
<title>ln2_0&#45;&gt;exp_14_15</title>
<path fill="none" stroke="black" d="M3584.23,-2549.06C4201.35,-2549 6622.98,-2545.11 6774,-2488 6879.87,-2447.96 6968,-2436.19 6968,-2323 6968,-2323 6968,-2323 6968,-279 6968,-159.42 6830.58,-90.04 6730.47,-55.35"/>
<polygon fill="black" stroke="black" points="6731.5,-52 6720.91,-52.1 6729.25,-58.63 6731.5,-52"/>
</g>
<!-- exp_15_15 -->
<g id="node37" class="node">
<title>exp_15_15</title>
<polygon fill="#ff8800" stroke="black" points="7072,-52 6788,-52 6788,0 7072,0 7072,-52"/>
<text text-anchor="middle" x="6930" y="-40" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="6930" y="-29" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="6930" y="-18" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="6930" y="-7" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_0&#45;&gt;exp_15_15 -->
<g id="edge47" class="edge">
<title>ln2_0&#45;&gt;exp_15_15</title>
<path fill="none" stroke="black" d="M3584.01,-2549.43C4213.06,-2550.97 6724.27,-2553.01 6878,-2488 6973.81,-2447.49 7044,-2427.02 7044,-2323 7044,-2323 7044,-2323 7044,-279 7044,-191.99 7045.83,-162.58 7001,-88 6994.46,-77.12 6985.3,-67.2 6975.73,-58.67"/>
<polygon fill="black" stroke="black" points="6977.9,-55.92 6968.01,-52.13 6973.38,-61.26 6977.9,-55.92"/>
</g>
<!-- gate_0&#45;&gt;exp_0_12 -->
<g id="edge48" class="edge">
<title>gate_0&#45;&gt;exp_0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3808.54,-2417.35C4076.03,-2394.7 4533.63,-2355.96 4770.67,-2335.9"/>
<polygon fill="black" stroke="black" points="4771.07,-2339.37 4780.74,-2335.04 4770.48,-2332.4 4771.07,-2339.37"/>
</g>
<!-- gate_0&#45;&gt;exp_1_12 -->
<g id="edge49" class="edge">
<title>gate_0&#45;&gt;exp_1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3465.07,-2383.83C3394.24,-2347.31 3322,-2290.17 3322,-2209 3322,-2209 3322,-2209 3322,-1243 3322,-1175.36 3338.11,-1153.7 3384,-1104 3406.67,-1079.45 3430.2,-1094.91 3450,-1068 3524.44,-966.85 3483.52,-913.51 3488,-788 3494.65,-601.45 3604.21,-514.08 3488,-368 3443.7,-312.32 3376.69,-387.37 3332,-332 3263.88,-247.62 3261.58,-172.14 3330,-88 3335.09,-81.74 3404.16,-67.21 3473.96,-53.89"/>
<polygon fill="black" stroke="black" points="3474.63,-57.33 3483.8,-52.02 3473.33,-50.45 3474.63,-57.33"/>
</g>
<!-- gate_0&#45;&gt;exp_2_12 -->
<g id="edge50" class="edge">
<title>gate_0&#45;&gt;exp_2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3364.53,-2430.73C2860.37,-2418.46 1722,-2372.63 1722,-2209 1722,-2209 1722,-2209 1722,-533 1722,-437.96 1674.3,-423.61 1649,-332 1632.13,-270.92 1628.03,-255.08 1622,-192 1617.6,-145.99 1613.07,-133.35 1622,-88 1623.75,-79.11 1626.81,-69.88 1630.2,-61.37"/>
<polygon fill="black" stroke="black" points="1633.44,-62.71 1634.12,-52.13 1627,-59.97 1633.44,-62.71"/>
</g>
<!-- gate_0&#45;&gt;exp_3_12 -->
<g id="edge51" class="edge">
<title>gate_0&#45;&gt;exp_3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3361.91,-2428.45C3107.07,-2419.01 2720.73,-2396.97 2582,-2348 2240.26,-2227.36 2096.21,-2200.48 1906,-1892 1773.24,-1676.69 1761,-1015.95 1761,-763 1761,-763 1761,-763 1761,-533 1761,-332.43 1719.24,-251.08 1836,-88 1844.89,-75.58 1857.11,-65.45 1870.25,-57.25"/>
<polygon fill="black" stroke="black" points="1872.12,-60.21 1878.98,-52.15 1868.59,-54.17 1872.12,-60.21"/>
</g>
<!-- gate_0&#45;&gt;exp_4_13 -->
<g id="edge52" class="edge">
<title>gate_0&#45;&gt;exp_4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3354.14,-2421.71C3133,-2407.8 2825.55,-2383.08 2709,-2348 2563.42,-2304.18 2517.63,-2258.07 2454,-2120 2089.85,-1329.77 1874.05,-1094.69 1951,-228 1956.58,-165.19 1928.85,-132.02 1974,-88 1994.84,-67.68 2143.86,-50.15 2262.98,-39.17"/>
<polygon fill="black" stroke="black" points="2263.31,-42.65 2272.95,-38.26 2262.68,-35.68 2263.31,-42.65"/>
</g>
<!-- gate_0&#45;&gt;exp_5_13 -->
<g id="edge53" class="edge">
<title>gate_0&#45;&gt;exp_5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3352.64,-2420.37C3212.67,-2408.29 3035.3,-2386.6 2881,-2348 2776.03,-2321.74 2743.77,-2320.41 2654,-2260 2583.05,-2212.26 2569.13,-2191.36 2522,-2120 2477.9,-2053.24 2450,-2035.01 2450,-1955 2450,-1955 2450,-1955 2450,-761 2450,-686.89 2453.46,-667.2 2474,-596 2485.86,-554.9 2483.64,-539.11 2513,-508 2537.01,-482.56 2563.14,-500.8 2583,-472 2680.48,-330.62 2536.84,-234.77 2626,-88 2633.15,-76.23 2643.54,-66.23 2654.76,-57.95"/>
<polygon fill="black" stroke="black" points="2656.81,-60.79 2663.04,-52.23 2652.83,-55.04 2656.81,-60.79"/>
</g>
<!-- gate_0&#45;&gt;exp_6_13 -->
<g id="edge54" class="edge">
<title>gate_0&#45;&gt;exp_6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3344.66,-2383.98C3288.39,-2372.43 3229.13,-2360.01 3174,-2348 3004.61,-2311.1 2951.34,-2332.78 2794,-2260 2723.65,-2227.46 2720.93,-2195.09 2654,-2156 2619.98,-2136.13 2598.83,-2149.75 2573,-2120 2523.01,-2062.43 2526,-2031.25 2526,-1955 2526,-1955 2526,-1955 2526,-761 2526,-682.66 2555.75,-667.39 2588,-596 2613.7,-539.1 2624.86,-527.21 2654,-472 2743.92,-301.64 2710.47,-215.36 2855,-88 2870.08,-74.71 2888.32,-64.21 2907.09,-55.96"/>
<polygon fill="black" stroke="black" points="2908.46,-59.18 2916.33,-52.08 2905.75,-52.72 2908.46,-59.18"/>
</g>
<!-- gate_0&#45;&gt;exp_7_13 -->
<g id="edge55" class="edge">
<title>gate_0&#45;&gt;exp_7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3452.59,-2383.93C3419.45,-2372.27 3384.48,-2359.82 3352,-2348 3082.38,-2249.83 2971.82,-2299.55 2748,-2120 2679.63,-2065.16 2640,-2042.65 2640,-1955 2640,-1955 2640,-1955 2640,-761 2640,-612.87 2740.68,-604.94 2806,-472 2828.06,-427.11 2819.41,-408.33 2849,-368 2863.74,-347.9 2874.69,-349.93 2892,-332 2987.45,-233.11 2967,-163.27 3082,-88 3099.87,-76.31 3140.09,-64.47 3182.53,-54.37"/>
<polygon fill="black" stroke="black" points="3183.54,-57.73 3192.48,-52.04 3181.94,-50.91 3183.54,-57.73"/>
</g>
<!-- gate_0&#45;&gt;exp_8_14 -->
<g id="edge56" class="edge">
<title>gate_0&#45;&gt;exp_8_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3533.77,-2383.59C3488.25,-2342.03 3436,-2279.05 3436,-2209 3436,-2209 3436,-2209 3436,-1839 3436,-1754.11 3490.07,-1735.9 3567,-1700 3629.23,-1670.96 4134.11,-1711.19 4184,-1664 4218.05,-1631.8 4232,-1291.86 4232,-1245 4232,-1245 4232,-1245 4232,-1129 4232,-859.32 4131.55,-787.83 3942,-596 3823.79,-476.37 3774.38,-469.12 3640,-368 3618.69,-351.97 3606.37,-354.46 3592,-332 3533.11,-239.97 3491.43,-171.42 3562,-88 3562.46,-87.46 3673.75,-68.81 3772.97,-52.27"/>
<polygon fill="black" stroke="black" points="3773.55,-55.72 3782.83,-50.63 3772.39,-48.82 3773.55,-55.72"/>
</g>
<!-- gate_0&#45;&gt;exp_9_14 -->
<g id="edge57" class="edge">
<title>gate_0&#45;&gt;exp_9_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3828.01,-2434.55C4381.69,-2430.43 5752,-2400.85 5752,-2209 5752,-2209 5752,-2209 5752,-279 5752,-160.51 5672.19,-140.57 5566,-88 5449.74,-30.45 5402.92,-68.88 5270.35,-52.09"/>
<polygon fill="black" stroke="black" points="5270.62,-48.6 5260.24,-50.73 5269.68,-55.53 5270.62,-48.6"/>
</g>
<!-- gate_0&#45;&gt;exp_10_14 -->
<g id="edge58" class="edge">
<title>gate_0&#45;&gt;exp_10_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3825.18,-2432.15C4262.66,-2425.41 5212.8,-2404.58 5535,-2348 5739.08,-2312.16 5980,-2416.2 5980,-2209 5980,-2209 5980,-2209 5980,-279 5980,-182.73 5701.31,-96.88 5537.14,-54.65"/>
<polygon fill="black" stroke="black" points="5537.54,-51.14 5526.98,-52.06 5535.8,-57.93 5537.54,-51.14"/>
</g>
<!-- gate_0&#45;&gt;exp_11_14 -->
<g id="edge59" class="edge">
<title>gate_0&#45;&gt;exp_11_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3827.26,-2434.01C4303.74,-2430.6 5393.33,-2415.43 5758,-2348 5948.03,-2312.86 6170,-2402.25 6170,-2209 6170,-2209 6170,-2209 6170,-279 6170,-147.15 6059.68,-149.4 5943,-88 5916.89,-74.26 5887.38,-63.36 5858.61,-54.82"/>
<polygon fill="black" stroke="black" points="5859.47,-51.42 5848.89,-52.01 5857.53,-58.15 5859.47,-51.42"/>
</g>
<!-- gate_0&#45;&gt;exp_12_15 -->
<g id="edge60" class="edge">
<title>gate_0&#45;&gt;exp_12_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3827.87,-2434.5C4337.74,-2432.09 5557.6,-2418.86 5963,-2348 6162.93,-2313.05 6398,-2411.96 6398,-2209 6398,-2209 6398,-2209 6398,-279 6398,-155.02 6254.91,-88 6145.75,-54.91"/>
<polygon fill="black" stroke="black" points="6146.54,-51.5 6135.96,-52.01 6144.55,-58.21 6146.54,-51.5"/>
</g>
<!-- gate_0&#45;&gt;exp_13_15 -->
<g id="edge61" class="edge">
<title>gate_0&#45;&gt;exp_13_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3824.61,-2431.72C4410.18,-2422.55 5953.93,-2394.27 6181,-2348 6322.23,-2319.22 6474,-2353.13 6474,-2209 6474,-2209 6474,-2209 6474,-647 6474,-398.29 6602.97,-282.53 6448,-88 6437.92,-75.35 6424.53,-65.1 6410.32,-56.88"/>
<polygon fill="black" stroke="black" points="6411.84,-53.73 6401.38,-52.02 6408.49,-59.87 6411.84,-53.73"/>
</g>
<!-- gate_0&#45;&gt;exp_14_15 -->
<g id="edge62" class="edge">
<title>gate_0&#45;&gt;exp_14_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3826.76,-2433.57C4437.19,-2428.91 6085.23,-2410.62 6323,-2348 6451.61,-2314.13 6588,-2342 6588,-2209 6588,-2209 6588,-2209 6588,-647 6588,-575.98 6632.71,-402.41 6642,-332 6650.17,-270.05 6652.11,-254.42 6655,-192 6657.14,-145.83 6664.56,-133.22 6655,-88 6653.1,-79.03 6649.8,-69.77 6646.13,-61.26"/>
<polygon fill="black" stroke="black" points="6649.25,-59.66 6641.9,-52.02 6642.88,-62.57 6649.25,-59.66"/>
</g>
<!-- gate_0&#45;&gt;exp_15_15 -->
<g id="edge63" class="edge">
<title>gate_0&#45;&gt;exp_15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3827.52,-2434.14C4458.18,-2430.9 6198.6,-2415.85 6448,-2348 6572.17,-2314.22 6702,-2337.69 6702,-2209 6702,-2209 6702,-2209 6702,-647 6702,-409.55 6917.33,-420.47 6982,-192 6994.59,-147.52 6997.98,-131.37 6982,-88 6978.28,-77.91 6972.07,-68.35 6965.2,-59.92"/>
<polygon fill="black" stroke="black" points="6967.69,-57.45 6958.49,-52.21 6962.41,-62.04 6967.69,-57.45"/>
</g>
<!-- expert_agg_0 -->
<g id="node38" class="node">
<title>expert_agg_0</title>
<polygon fill="#ffffcc" stroke="black" points="4857.38,-2260 4389.09,-2260 4268.62,-2156 4736.91,-2156 4857.38,-2260"/>
<text text-anchor="middle" x="4563" y="-2222" font-family="Arial" font-size="10.00">Expert Aggregation 0</text>
<text text-anchor="middle" x="4563" y="-2211" font-family="Arial" font-size="10.00">Input: [16× expert outputs]</text>
<text text-anchor="middle" x="4563" y="-2200" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4563" y="-2189" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- exp_0_12&#45;&gt;expert_agg_0 -->
<g id="edge64" class="edge">
<title>exp_0_12&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M4842.21,-2295.87C4810.9,-2286.13 4773.78,-2274.58 4736.99,-2263.13"/>
<polygon fill="black" stroke="black" points="4737.73,-2259.69 4727.14,-2260.06 4735.65,-2266.38 4737.73,-2259.69"/>
</g>
<!-- exp_1_12&#45;&gt;expert_agg_0 -->
<g id="edge65" class="edge">
<title>exp_1_12&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M3480.79,-50.59C3418.44,-62.38 3357.2,-76.53 3348,-88 3319.07,-124.05 3346.52,-145.8 3348,-192 3350,-254.32 3315.36,-285.6 3357,-332 3419.37,-401.5 3498.2,-301.74 3564,-368 3636.39,-440.9 3593.53,-493.62 3602,-596 3614.17,-743.05 3611.17,-780.73 3602,-928 3581.66,-1254.65 3479.34,-1351.94 3578,-1664 3583.8,-1682.34 3594.88,-1682.14 3602,-1700 3625.22,-1758.23 3626,-1776.31 3626,-1839 3626,-1955 3626,-1955 3626,-1955 3626,-2094.57 4018.57,-2159.04 4295.51,-2187.15"/>
<polygon fill="black" stroke="black" points="4295.42,-2190.66 4305.72,-2188.18 4296.12,-2183.7 4295.42,-2190.66"/>
</g>
<!-- exp_2_12&#45;&gt;expert_agg_0 -->
<g id="edge66" class="edge">
<title>exp_2_12&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M1638.81,-52.15C1629.41,-85.23 1617.3,-144.72 1634,-192 1660.63,-267.4 1795.89,-424.21 1860,-472 2131.16,-674.16 2564,-422.77 2564,-761 2564,-1955 2564,-1955 2564,-1955 2564,-2064.84 2646.38,-2078.29 2748,-2120 2888.96,-2177.85 3850.89,-2197.93 4314.36,-2204.31"/>
<polygon fill="black" stroke="black" points="4314.49,-2207.81 4324.54,-2204.45 4314.59,-2200.81 4314.49,-2207.81"/>
</g>
<!-- exp_3_12&#45;&gt;expert_agg_0 -->
<g id="edge67" class="edge">
<title>exp_3_12&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M1906.58,-52.17C1894.41,-61.72 1882.65,-73.79 1876,-88 1802.42,-245.37 1820.11,-355.52 1949,-472 1987.71,-506.98 2129.73,-498.35 2181,-508 2358.61,-541.43 2431.12,-490.69 2578,-596 2647.69,-645.97 2678,-675.25 2678,-761 2678,-1955 2678,-1955 2678,-1955 2678,-2117.56 3793.61,-2179.15 4308.34,-2198.91"/>
<polygon fill="black" stroke="black" points="4308.38,-2202.41 4318.5,-2199.3 4308.64,-2195.42 4308.38,-2202.41"/>
</g>
<!-- exp_4_13&#45;&gt;expert_agg_0 -->
<g id="edge68" class="edge">
<title>exp_4_13&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M2272.65,-37C2184.19,-45.74 2080.74,-61.33 2045,-88 1975.54,-139.82 1917.52,-408.97 1977,-472 2024.44,-522.27 2534.48,-480.76 2598,-508 2712.03,-556.91 2716,-636.93 2716,-761 2716,-877 2716,-877 2716,-877 2716,-962.31 2680.14,-1002.67 2735,-1068 2920.49,-1288.91 3360,-954.54 3360,-1243 3360,-1955 3360,-1955 3360,-1955 3360,-2042.16 3391.22,-2075.23 3466,-2120 3536.43,-2162.16 4006.7,-2186.93 4308.21,-2198.65"/>
<polygon fill="black" stroke="black" points="4308.29,-2202.15 4318.42,-2199.04 4308.56,-2195.16 4308.29,-2202.15"/>
</g>
<!-- exp_5_13&#45;&gt;expert_agg_0 -->
<g id="edge69" class="edge">
<title>exp_5_13&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M2718.61,-52.21C2725.74,-164.32 2754,-618.26 2754,-761 2754,-877 2754,-877 2754,-877 2754,-962.31 2711.5,-1008.88 2773,-1068 2869.45,-1160.73 3263.99,-1027.84 3374,-1104 3429.62,-1142.5 3436,-1175.36 3436,-1243 3436,-1359 3436,-1359 3436,-1359 3436,-1573 3474,-1625 3474,-1839 3474,-1955 3474,-1955 3474,-1955 3474,-2030.15 3454.32,-2070.65 3511,-2120 3570.06,-2171.42 4019.15,-2192.96 4311.17,-2201.6"/>
<polygon fill="black" stroke="black" points="4311.39,-2205.1 4321.49,-2201.9 4311.6,-2198.11 4311.39,-2205.1"/>
</g>
<!-- exp_6_13&#45;&gt;expert_agg_0 -->
<g id="edge70" class="edge">
<title>exp_6_13&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M2937.05,-52.11C2919.86,-60.92 2903.48,-72.61 2892,-88 2852.16,-141.45 2792,-573.36 2792,-761 2792,-877 2792,-877 2792,-877 2792,-962.31 2749.4,-1008.99 2811,-1068 2913.7,-1166.39 3343.83,-1009.36 3450,-1104 3496.8,-1145.72 3474,-1180.31 3474,-1243 3474,-1359 3474,-1359 3474,-1359 3474,-1573 3512,-1625 3512,-1839 3512,-1955 3512,-1955 3512,-1955 3512,-2035.55 3521.28,-2073.42 3587,-2120 3644.55,-2160.79 4037.25,-2185.24 4306.64,-2197.41"/>
<polygon fill="black" stroke="black" points="4306.82,-2200.92 4316.97,-2197.87 4307.14,-2193.93 4306.82,-2200.92"/>
</g>
<!-- exp_7_13&#45;&gt;expert_agg_0 -->
<g id="edge71" class="edge">
<title>exp_7_13&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M3201.25,-52.06C3184.23,-60.72 3168.85,-72.36 3158,-88 3131.66,-125.98 3138.04,-150.31 3158,-192 3200.87,-281.52 3242.72,-288.63 3332,-332 3396,-363.09 3439.37,-316.05 3488,-368 3573.79,-459.64 3566.74,-802.56 3562,-928 3557.55,-1045.59 3550.64,-1074.65 3542,-1192 3537.42,-1254.21 3534.58,-1269.67 3532,-1332 3528.47,-1417.26 3526.45,-1438.79 3531,-1524 3534.34,-1586.49 3535.34,-1602.34 3546,-1664 3559.62,-1742.82 3588,-1759.01 3588,-1839 3588,-1955 3588,-1955 3588,-1955 3588,-2034.83 3594.5,-2072.95 3659,-2120 3671.9,-2129.41 4030.66,-2161.76 4292.28,-2184.25"/>
<polygon fill="black" stroke="black" points="4292.06,-2187.74 4302.32,-2185.11 4292.65,-2180.77 4292.06,-2187.74"/>
</g>
<!-- exp_8_14&#45;&gt;expert_agg_0 -->
<g id="edge72" class="edge">
<title>exp_8_14&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M3782.89,-51.38C3690.08,-67.47 3585.71,-85.96 3584,-88 3554.33,-123.45 3569.28,-148.18 3584,-192 3608.85,-265.98 3622.14,-293.46 3690,-332 3816.37,-403.77 3883.24,-306.68 4015,-368 4178.02,-443.88 4308,-467.18 4308,-647 4308,-1245 4308,-1245 4308,-1245 4308,-1510.67 4241,-1573.33 4241,-1839 4241,-1955 4241,-1955 4241,-1955 4241,-2028.82 4212.28,-2063.68 4260,-2120 4270,-2131.81 4290.38,-2142.64 4316.05,-2152.36"/>
<polygon fill="black" stroke="black" points="4315.14,-2155.76 4325.73,-2155.89 4317.54,-2149.18 4315.14,-2155.76"/>
</g>
<!-- exp_9_14&#45;&gt;expert_agg_0 -->
<g id="edge73" class="edge">
<title>exp_9_14&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M5260.25,-50.63C5263.19,-51.09 5266.11,-51.55 5269,-52 5323.37,-60.49 5471.45,-53.11 5514,-88 5599.6,-158.19 5624.97,-239.61 5564,-332 5438.86,-521.62 5094,-305.81 5094,-533 5094,-1955 5094,-1955 5094,-1955 5094,-2099.64 4931.21,-2161.36 4785.9,-2187.65"/>
<polygon fill="black" stroke="black" points="4785.16,-2184.23 4775.92,-2189.41 4786.37,-2191.12 4785.16,-2184.23"/>
</g>
<!-- exp_10_14&#45;&gt;expert_agg_0 -->
<g id="edge74" class="edge">
<title>exp_10_14&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M5516.02,-52.08C5534.75,-60.8 5552.68,-72.46 5566,-88 5698.59,-242.68 5676,-329.27 5676,-533 5676,-1955 5676,-1955 5676,-1955 5676,-2133.26 5126.07,-2185.43 4799.32,-2200.69"/>
<polygon fill="black" stroke="black" points="4799.07,-2197.2 4789.24,-2201.15 4799.39,-2204.19 4799.07,-2197.2"/>
</g>
<!-- exp_11_14&#45;&gt;expert_agg_0 -->
<g id="edge75" class="edge">
<title>exp_11_14&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M5856.56,-52.2C5874.73,-60.86 5891.41,-72.46 5904,-88 5997.21,-203.06 5942,-270.92 5942,-419 5942,-1955 5942,-1955 5942,-1955 5942,-2137.09 5743.4,-2074.87 5567,-2120 5425.99,-2156.08 5044.18,-2182.01 4794.14,-2195.74"/>
<polygon fill="black" stroke="black" points="4793.61,-2192.27 4783.81,-2196.31 4793.99,-2199.26 4793.61,-2192.27"/>
</g>
<!-- exp_12_15&#45;&gt;expert_agg_0 -->
<g id="edge76" class="edge">
<title>exp_12_15&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M6033.3,-52.13C6059.5,-125.24 6132,-344.59 6132,-533 6132,-1955 6132,-1955 6132,-1955 6132,-2135.05 5936.64,-2076.16 5762,-2120 5585.68,-2164.26 5094.09,-2188.57 4797.97,-2199.59"/>
<polygon fill="black" stroke="black" points="4797.82,-2196.09 4787.96,-2199.96 4798.08,-2203.09 4797.82,-2196.09"/>
</g>
<!-- exp_13_15&#45;&gt;expert_agg_0 -->
<g id="edge77" class="edge">
<title>exp_13_15&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M6377.2,-52.12C6390.87,-61.43 6404.04,-73.37 6412,-88 6530.87,-306.42 6436,-398.33 6436,-647 6436,-1955 6436,-1955 6436,-1955 6436,-2181.01 6176.66,-2075.89 5955,-2120 5740.67,-2162.65 5136.54,-2188.41 4798.86,-2199.89"/>
<polygon fill="black" stroke="black" points="4798.32,-2196.41 4788.45,-2200.24 4798.56,-2203.4 4798.32,-2196.41"/>
</g>
<!-- exp_14_15&#45;&gt;expert_agg_0 -->
<g id="edge78" class="edge">
<title>exp_14_15&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M6634.07,-52.06C6636.43,-63.02 6638.84,-76.08 6640,-88 6644.48,-134 6644.4,-145.99 6640,-192 6627.95,-318.16 6618.11,-349.4 6586,-472 6581.73,-488.32 6578.11,-491.64 6574,-508 6558.71,-568.8 6550,-584.31 6550,-647 6550,-1955 6550,-1955 6550,-1955 6550,-2125.37 6369.12,-2078.02 6204,-2120 5946.57,-2185.45 5195.43,-2201.72 4805,-2205.72"/>
<polygon fill="black" stroke="black" points="4804.95,-2202.22 4794.98,-2205.82 4805.02,-2209.22 4804.95,-2202.22"/>
</g>
<!-- exp_15_15&#45;&gt;expert_agg_0 -->
<g id="edge79" class="edge">
<title>exp_15_15&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M6921.84,-52.05C6910.9,-84.78 6890.25,-143.63 6868,-192 6808.65,-321.03 6789.94,-351.98 6714,-472 6703.45,-488.68 6695.65,-489.81 6688,-508 6663.69,-565.79 6664,-584.31 6664,-647 6664,-1955 6664,-1955 6664,-1955 6664,-2099.44 6522.41,-2078.68 6384,-2120 6236.39,-2164.07 5260.09,-2191.43 4800.92,-2202"/>
<polygon fill="black" stroke="black" points="4800.76,-2198.51 4790.84,-2202.23 4800.92,-2205.5 4800.76,-2198.51"/>
</g>
<!-- expert_agg_0&#45;&gt;residual2_0 -->
<g id="edge80" class="edge">
<title>expert_agg_0&#45;&gt;residual2_0</title>
<path fill="none" stroke="black" d="M4563,-2155.61C4563,-2147.44 4563,-2138.92 4563,-2130.54"/>
<polygon fill="black" stroke="black" points="4566.5,-2130.43 4563,-2120.43 4559.5,-2130.43 4566.5,-2130.43"/>
</g>
<!-- ln1_1 -->
<g id="node40" class="node">
<title>ln1_1</title>
<polygon fill="#000080" stroke="black" points="4724,-1980 4440,-1980 4440,-1928 4724,-1928 4724,-1980"/>
<text text-anchor="middle" x="4582" y="-1968" font-family="Arial" font-size="10.00">LayerNorm 1</text>
<text text-anchor="middle" x="4582" y="-1957" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4582" y="-1946" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4582" y="-1935" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1 -->
<g id="edge82" class="edge">
<title>residual2_0&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M4571.67,-2015.92C4573.15,-2007.15 4574.67,-1998.23 4576.06,-1990.01"/>
<polygon fill="black" stroke="black" points="4579.53,-1990.49 4577.75,-1980.04 4572.63,-1989.32 4579.53,-1990.49"/>
</g>
<!-- residual1_1 -->
<g id="node43" class="node">
<title>residual1_1</title>
<polygon fill="#ffffcc" stroke="black" points="4895.38,-1664 4427.09,-1664 4306.62,-1560 4774.91,-1560 4895.38,-1664"/>
<text text-anchor="middle" x="4601" y="-1626" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="4601" y="-1615" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4601" y="-1604" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4601" y="-1593" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_0&#45;&gt;residual1_1 -->
<g id="edge86" class="edge">
<title>residual2_0&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M4435.62,-2015.93C4383.07,-1987.76 4327.62,-1947.12 4298,-1892 4276.12,-1851.29 4274.91,-1828.04 4298,-1788 4328.97,-1734.28 4383.41,-1695.58 4437.68,-1668.46"/>
<polygon fill="black" stroke="black" points="4439.29,-1671.57 4446.74,-1664.04 4436.22,-1665.28 4439.29,-1671.57"/>
</g>
<!-- attn_agg_1 -->
<g id="node41" class="node">
<title>attn_agg_1</title>
<polygon fill="#ffffcc" stroke="black" points="4895.38,-1892 4427.09,-1892 4306.62,-1788 4774.91,-1788 4895.38,-1892"/>
<text text-anchor="middle" x="4601" y="-1854" font-family="Arial" font-size="10.00">All&#45;Reduce Attention 1</text>
<text text-anchor="middle" x="4601" y="-1843" font-family="Arial" font-size="10.00">Input: [12× partial attention outputs]</text>
<text text-anchor="middle" x="4601" y="-1832" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4601" y="-1821" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln1_1&#45;&gt;attn_agg_1 -->
<g id="edge83" class="edge">
<title>ln1_1&#45;&gt;attn_agg_1</title>
<path fill="none" stroke="black" d="M4586.26,-1927.87C4587.58,-1920.1 4589.09,-1911.18 4590.64,-1902.08"/>
<polygon fill="black" stroke="black" points="4594.1,-1902.62 4592.32,-1892.18 4587.19,-1901.45 4594.1,-1902.62"/>
</g>
<!-- out_proj_1 -->
<g id="node42" class="node">
<title>out_proj_1</title>
<polygon fill="#000080" stroke="black" points="4743,-1752 4459,-1752 4459,-1700 4743,-1700 4743,-1752"/>
<text text-anchor="middle" x="4601" y="-1740" font-family="Arial" font-size="10.00">Output Projection 1</text>
<text text-anchor="middle" x="4601" y="-1729" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4601" y="-1718" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4601" y="-1707" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- attn_agg_1&#45;&gt;out_proj_1 -->
<g id="edge84" class="edge">
<title>attn_agg_1&#45;&gt;out_proj_1</title>
<path fill="none" stroke="black" d="M4601,-1787.92C4601,-1779.25 4601,-1770.43 4601,-1762.29"/>
<polygon fill="black" stroke="black" points="4604.5,-1762.04 4601,-1752.04 4597.5,-1762.04 4604.5,-1762.04"/>
</g>
<!-- out_proj_1&#45;&gt;residual1_1 -->
<g id="edge85" class="edge">
<title>out_proj_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M4601,-1699.87C4601,-1692.18 4601,-1683.37 4601,-1674.37"/>
<polygon fill="black" stroke="black" points="4604.5,-1674.18 4601,-1664.18 4597.5,-1674.18 4604.5,-1674.18"/>
</g>
<!-- ln2_1 -->
<g id="node44" class="node">
<title>ln2_1</title>
<polygon fill="#000080" stroke="black" points="5555,-306 5271,-306 5271,-254 5555,-254 5555,-306"/>
<text text-anchor="middle" x="5413" y="-294" font-family="Arial" font-size="10.00">LayerNorm 1 (MoE)</text>
<text text-anchor="middle" x="5413" y="-283" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5413" y="-272" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5413" y="-261" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge87" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M4743.75,-1559.92C4827.49,-1519.83 4917,-1454.61 4917,-1359 4917,-1359 4917,-1359 4917,-533 4917,-429.92 4990.72,-419.53 5080,-368 5135.03,-336.24 5201.79,-315.85 5261.05,-302.87"/>
<polygon fill="black" stroke="black" points="5261.82,-306.28 5270.87,-300.77 5260.36,-299.44 5261.82,-306.28"/>
</g>
<!-- residual2_1 -->
<g id="node47" class="node">
<title>residual2_1</title>
<polygon fill="#ffffcc" stroke="black" points="4175.38,-1524 3707.09,-1524 3586.62,-1420 4054.91,-1420 4175.38,-1524"/>
<text text-anchor="middle" x="3881" y="-1486" font-family="Arial" font-size="10.00">Residual Add 1 (MoE)</text>
<text text-anchor="middle" x="3881" y="-1475" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3881" y="-1464" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3881" y="-1453" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge122" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M4334.69,-1559.96C4276.86,-1548.87 4215.56,-1537.12 4157.35,-1525.97"/>
<polygon fill="black" stroke="black" points="4157.76,-1522.48 4147.28,-1524.04 4156.45,-1529.36 4157.76,-1522.48"/>
</g>
<!-- ln2_1&#45;&gt;exp_0_12 -->
<g id="edge89" class="edge">
<title>ln2_1&#45;&gt;exp_0_12</title>
<path fill="none" stroke="black" d="M5487.4,-306.11C5576.54,-341.46 5714,-415.1 5714,-533 5714,-2069 5714,-2069 5714,-2069 5714,-2201.61 5305.3,-2273.78 5075.46,-2303.88"/>
<polygon fill="black" stroke="black" points="5074.79,-2300.44 5065.33,-2305.2 5075.7,-2307.38 5074.79,-2300.44"/>
</g>
<!-- ln2_1&#45;&gt;exp_1_12 -->
<g id="edge90" class="edge">
<title>ln2_1&#45;&gt;exp_1_12</title>
<path fill="none" stroke="black" d="M5289.42,-253.94C5235.22,-244.02 5170.69,-233.65 5112,-228 5070.43,-224 3638.17,-221.88 3609,-192 3575.82,-158.01 3591.3,-99.16 3606.45,-61.7"/>
<polygon fill="black" stroke="black" points="3609.8,-62.78 3610.47,-52.2 3603.35,-60.05 3609.8,-62.78"/>
</g>
<!-- ln2_1&#45;&gt;exp_2_12 -->
<g id="edge91" class="edge">
<title>ln2_1&#45;&gt;exp_2_12</title>
<path fill="none" stroke="black" d="M5291.64,-253.99C5237,-243.88 5171.52,-233.35 5112,-228 4937.8,-212.34 2133.65,-234.54 1964,-192 1858.46,-165.54 1748.75,-97.9 1690.12,-57.91"/>
<polygon fill="black" stroke="black" points="1692.07,-55.01 1681.84,-52.22 1688.1,-60.78 1692.07,-55.01"/>
</g>
<!-- ln2_1&#45;&gt;exp_3_12 -->
<g id="edge92" class="edge">
<title>ln2_1&#45;&gt;exp_3_12</title>
<path fill="none" stroke="black" d="M5291.64,-254C5237,-243.89 5171.52,-233.36 5112,-228 5027.14,-220.36 2118.61,-234.91 2045,-192 1996.8,-163.9 1970.48,-101.41 1958.1,-61.9"/>
<polygon fill="black" stroke="black" points="1961.41,-60.72 1955.18,-52.15 1954.7,-62.73 1961.41,-60.72"/>
</g>
<!-- ln2_1&#45;&gt;exp_4_13 -->
<g id="edge93" class="edge">
<title>ln2_1&#45;&gt;exp_4_13</title>
<path fill="none" stroke="black" d="M5290.9,-253.98C5236.4,-243.93 5171.24,-233.46 5112,-228 4860.15,-204.81 3084.14,-240.93 2836,-192 2831.48,-191.11 2607.34,-102.85 2488.01,-55.8"/>
<polygon fill="black" stroke="black" points="2489.14,-52.48 2478.55,-52.07 2486.57,-59 2489.14,-52.48"/>
</g>
<!-- ln2_1&#45;&gt;exp_5_13 -->
<g id="edge94" class="edge">
<title>ln2_1&#45;&gt;exp_5_13</title>
<path fill="none" stroke="black" d="M5290.53,-253.98C5236.11,-243.96 5171.11,-233.51 5112,-228 4892.36,-207.52 3343.18,-235.9 3127,-192 2994.05,-165 2849.17,-96.59 2772.26,-56.85"/>
<polygon fill="black" stroke="black" points="2773.71,-53.65 2763.22,-52.15 2770.48,-59.86 2773.71,-53.65"/>
</g>
<!-- ln2_1&#45;&gt;exp_6_13 -->
<g id="edge95" class="edge">
<title>ln2_1&#45;&gt;exp_6_13</title>
<path fill="none" stroke="black" d="M5290.16,-253.99C5235.81,-244.01 5170.97,-233.58 5112,-228 4921.81,-209.99 3579.51,-233.36 3393,-192 3270.99,-164.95 3139.87,-97.04 3069.91,-57.28"/>
<polygon fill="black" stroke="black" points="3071.28,-54.03 3060.86,-52.11 3067.8,-60.11 3071.28,-54.03"/>
</g>
<!-- ln2_1&#45;&gt;exp_7_13 -->
<g id="edge96" class="edge">
<title>ln2_1&#45;&gt;exp_7_13</title>
<path fill="none" stroke="black" d="M5289.79,-253.99C5235.51,-244.05 5170.83,-233.65 5112,-228 4943.06,-211.78 3747.57,-240.71 3585,-192 3494.94,-165.02 3405.39,-98.53 3357.23,-58.68"/>
<polygon fill="black" stroke="black" points="3359.21,-55.77 3349.29,-52.04 3354.72,-61.14 3359.21,-55.77"/>
</g>
<!-- ln2_1&#45;&gt;exp_8_14 -->
<g id="edge97" class="edge">
<title>ln2_1&#45;&gt;exp_8_14</title>
<path fill="none" stroke="black" d="M5433.35,-253.68C5463.3,-213.24 5511.18,-133.96 5467,-88 5443.13,-63.16 4461.68,-38.85 4077.22,-30.26"/>
<polygon fill="black" stroke="black" points="4077.21,-26.76 4067.13,-30.03 4077.05,-33.76 4077.21,-26.76"/>
</g>
<!-- ln2_1&#45;&gt;exp_9_14 -->
<g id="edge98" class="edge">
<title>ln2_1&#45;&gt;exp_9_14</title>
<path fill="none" stroke="black" d="M5445.44,-253.77C5462.84,-238.11 5482.59,-216.36 5492,-192 5508.66,-148.88 5521.97,-123.19 5492,-88 5461.24,-51.87 5333.63,-59.12 5270.53,-51.97"/>
<polygon fill="black" stroke="black" points="5270.64,-48.45 5260.26,-50.57 5269.7,-55.39 5270.64,-48.45"/>
</g>
<!-- ln2_1&#45;&gt;exp_10_14 -->
<g id="edge99" class="edge">
<title>ln2_1&#45;&gt;exp_10_14</title>
<path fill="none" stroke="black" d="M5555.09,-257.87C5592.7,-245.09 5629.14,-224.64 5652,-192 5678.51,-154.14 5680.22,-124.6 5652,-88 5644.86,-78.74 5599.37,-65.87 5550.53,-54.34"/>
<polygon fill="black" stroke="black" points="5551.26,-50.92 5540.73,-52.05 5549.67,-57.74 5551.26,-50.92"/>
</g>
<!-- ln2_1&#45;&gt;exp_11_14 -->
<g id="edge100" class="edge">
<title>ln2_1&#45;&gt;exp_11_14</title>
<path fill="none" stroke="black" d="M5555.23,-271.97C5677.09,-262.61 5839.22,-241.08 5880,-192 5909.54,-156.45 5906.14,-126.12 5880,-88 5871.2,-75.17 5859.29,-65.04 5845.93,-57.04"/>
<polygon fill="black" stroke="black" points="5847.4,-53.85 5836.96,-52.08 5844.02,-59.98 5847.4,-53.85"/>
</g>
<!-- ln2_1&#45;&gt;exp_12_15 -->
<g id="edge101" class="edge">
<title>ln2_1&#45;&gt;exp_12_15</title>
<path fill="none" stroke="black" d="M5555.22,-270C5738.19,-256.96 6036.61,-230.1 6070,-192 6100.46,-157.24 6084.67,-131.83 6070,-88 6066.72,-78.19 6061.16,-68.69 6055.03,-60.23"/>
<polygon fill="black" stroke="black" points="6057.65,-57.91 6048.76,-52.14 6052.12,-62.19 6057.65,-57.91"/>
</g>
<!-- ln2_1&#45;&gt;exp_13_15 -->
<g id="edge102" class="edge">
<title>ln2_1&#45;&gt;exp_13_15</title>
<path fill="none" stroke="black" d="M5555.45,-274.34C5791.92,-265.24 6244.89,-241.51 6298,-192 6333.06,-159.31 6334.56,-100.22 6331.19,-62.34"/>
<polygon fill="black" stroke="black" points="6334.66,-61.84 6330.14,-52.26 6327.7,-62.57 6334.66,-61.84"/>
</g>
<!-- ln2_1&#45;&gt;exp_14_15 -->
<g id="edge103" class="edge">
<title>ln2_1&#45;&gt;exp_14_15</title>
<path fill="none" stroke="black" d="M5555.2,-275.03C5836.74,-266.13 6444.99,-241.4 6526,-192 6574.17,-162.63 6602.98,-101.04 6617.13,-61.97"/>
<polygon fill="black" stroke="black" points="6620.6,-62.68 6620.58,-52.08 6613.98,-60.37 6620.6,-62.68"/>
</g>
<!-- ln2_1&#45;&gt;exp_15_15 -->
<g id="edge104" class="edge">
<title>ln2_1&#45;&gt;exp_15_15</title>
<path fill="none" stroke="black" d="M5555.09,-275.2C5877.76,-265.78 6646.2,-238.72 6754,-192 6819.66,-163.54 6876.07,-99.58 6906.33,-60.18"/>
<polygon fill="black" stroke="black" points="6909.15,-62.25 6912.38,-52.16 6903.56,-58.03 6909.15,-62.25"/>
</g>
<!-- gate_1 -->
<g id="node45" class="node">
<title>gate_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5458.43,-192 4999.6,-192 4881.57,-88 5340.4,-88 5458.43,-192"/>
<text text-anchor="middle" x="5170" y="-154" font-family="Arial" font-size="10.00">Gating Network 1</text>
<text text-anchor="middle" x="5170" y="-143" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5170" y="-132" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="5170" y="-121" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln2_1&#45;&gt;gate_1 -->
<g id="edge88" class="edge">
<title>ln2_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M5368.71,-253.85C5340.76,-237.97 5303.5,-216.81 5268.8,-197.11"/>
<polygon fill="black" stroke="black" points="5270.46,-194.03 5260.04,-192.13 5267,-200.11 5270.46,-194.03"/>
</g>
<!-- gate_1&#45;&gt;exp_0_12 -->
<g id="edge105" class="edge">
<title>gate_1&#45;&gt;exp_0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5170,-192.24C5170,-248.02 5170,-339.85 5170,-419 5170,-2069 5170,-2069 5170,-2069 5170,-2154.56 5202.05,-2195.36 5146,-2260 5134.66,-2273.08 5105.66,-2284.26 5072.17,-2293.35"/>
<polygon fill="black" stroke="black" points="5070.93,-2290.06 5062.14,-2295.98 5072.7,-2296.83 5070.93,-2290.06"/>
</g>
<!-- gate_1&#45;&gt;exp_1_12 -->
<g id="edge106" class="edge">
<title>gate_1&#45;&gt;exp_1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4882.42,-88.99C4879.26,-88.65 4876.12,-88.32 4873,-88 4390.13,-38.87 4262.09,-99.18 3775.3,-52.06"/>
<polygon fill="black" stroke="black" points="3775.49,-48.57 3765.2,-51.08 3774.81,-55.53 3775.49,-48.57"/>
</g>
<!-- gate_1&#45;&gt;exp_2_12 -->
<g id="edge107" class="edge">
<title>gate_1&#45;&gt;exp_2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4882.43,-88.9C4879.27,-88.58 4876.13,-88.28 4873,-88 4195.76,-26.28 2495.45,-111.15 1799.36,-52.04"/>
<polygon fill="black" stroke="black" points="1799.45,-48.54 1789.19,-51.16 1798.85,-55.51 1799.45,-48.54"/>
</g>
<!-- gate_1&#45;&gt;exp_3_12 -->
<g id="edge108" class="edge">
<title>gate_1&#45;&gt;exp_3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4882.42,-88.91C4879.27,-88.59 4876.13,-88.29 4873,-88 4295.62,-34.77 2843.21,-78.95 2264,-52 2210.96,-49.53 2152.99,-45.36 2101.41,-41.12"/>
<polygon fill="black" stroke="black" points="2101.43,-37.61 2091.18,-40.27 2100.86,-44.58 2101.43,-37.61"/>
</g>
<!-- gate_1&#45;&gt;exp_4_13 -->
<g id="edge109" class="edge">
<title>gate_1&#45;&gt;exp_4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4882.42,-88.92C4879.27,-88.6 4876.13,-88.29 4873,-88 3855.32,6.74 3589.08,-143.01 2567.35,-52.06"/>
<polygon fill="black" stroke="black" points="2567.46,-48.55 2557.19,-51.14 2566.84,-55.52 2567.46,-48.55"/>
</g>
<!-- gate_1&#45;&gt;exp_5_13 -->
<g id="edge110" class="edge">
<title>gate_1&#45;&gt;exp_5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4882.42,-88.93C4879.27,-88.6 4876.13,-88.29 4873,-88 3989.04,-4.66 3757.32,-132.03 2869.34,-52.06"/>
<polygon fill="black" stroke="black" points="2869.46,-48.55 2859.19,-51.14 2868.83,-55.52 2869.46,-48.55"/>
</g>
<!-- gate_1&#45;&gt;exp_6_13 -->
<g id="edge111" class="edge">
<title>gate_1&#45;&gt;exp_6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4882.42,-88.94C4879.27,-88.61 4876.12,-88.3 4873,-88 4122.71,-16.06 3925.54,-121.08 3171.21,-52.05"/>
<polygon fill="black" stroke="black" points="3171.47,-48.56 3161.19,-51.12 3170.83,-55.53 3171.47,-48.56"/>
</g>
<!-- gate_1&#45;&gt;exp_7_13 -->
<g id="edge112" class="edge">
<title>gate_1&#45;&gt;exp_7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4882.42,-88.96C4879.26,-88.63 4876.12,-88.31 4873,-88 4256.44,-27.46 4093.81,-110.11 3473.29,-52.06"/>
<polygon fill="black" stroke="black" points="3473.48,-48.56 3463.19,-51.1 3472.82,-55.53 3473.48,-48.56"/>
</g>
<!-- gate_1&#45;&gt;exp_8_14 -->
<g id="edge113" class="edge">
<title>gate_1&#45;&gt;exp_8_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4882.79,-89.18C4879.51,-88.78 4876.25,-88.38 4873,-88 4593.35,-55.09 4265.05,-38.94 4077.38,-31.84"/>
<polygon fill="black" stroke="black" points="4077.29,-28.33 4067.16,-31.46 4077.02,-35.33 4077.29,-28.33"/>
</g>
<!-- gate_1&#45;&gt;exp_9_14 -->
<g id="edge114" class="edge">
<title>gate_1&#45;&gt;exp_9_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5146.28,-87.92C5142.08,-78.86 5137.79,-69.64 5133.87,-61.19"/>
<polygon fill="black" stroke="black" points="5137.01,-59.64 5129.63,-52.04 5130.66,-62.59 5137.01,-59.64"/>
</g>
<!-- gate_1&#45;&gt;exp_10_14 -->
<g id="edge115" class="edge">
<title>gate_1&#45;&gt;exp_10_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5284.03,-87.92C5308.26,-77.06 5333.04,-65.96 5354.7,-56.25"/>
<polygon fill="black" stroke="black" points="5356.4,-59.33 5364.1,-52.04 5353.54,-52.94 5356.4,-59.33"/>
</g>
<!-- gate_1&#45;&gt;exp_11_14 -->
<g id="edge116" class="edge">
<title>gate_1&#45;&gt;exp_11_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5355.73,-101.32C5431.97,-85.85 5518.55,-68.28 5588.38,-54.11"/>
<polygon fill="black" stroke="black" points="5589.46,-57.46 5598.56,-52.05 5588.06,-50.6 5589.46,-57.46"/>
</g>
<!-- gate_1&#45;&gt;exp_12_15 -->
<g id="edge117" class="edge">
<title>gate_1&#45;&gt;exp_12_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5372.57,-116.16C5510.5,-100.07 5697.45,-77.22 5871.63,-52.18"/>
<polygon fill="black" stroke="black" points="5872.36,-55.61 5881.76,-50.72 5871.36,-48.68 5872.36,-55.61"/>
</g>
<!-- gate_1&#45;&gt;exp_13_15 -->
<g id="edge118" class="edge">
<title>gate_1&#45;&gt;exp_13_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5383.23,-125.37C5584.53,-111.37 5894.94,-86.89 6173.47,-52.15"/>
<polygon fill="black" stroke="black" points="6174.29,-55.58 6183.78,-50.86 6173.42,-48.63 6174.29,-55.58"/>
</g>
<!-- gate_1&#45;&gt;exp_14_15 -->
<g id="edge119" class="edge">
<title>gate_1&#45;&gt;exp_14_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5389.42,-130.94C5647.34,-119.97 6088.32,-96.53 6475.78,-52.1"/>
<polygon fill="black" stroke="black" points="6476.26,-55.56 6485.79,-50.94 6475.46,-48.61 6476.26,-55.56"/>
</g>
<!-- gate_1&#45;&gt;exp_15_15 -->
<g id="edge120" class="edge">
<title>gate_1&#45;&gt;exp_15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5393.5,-134.68C5702.68,-126.95 6278.33,-106.23 6777.5,-52.11"/>
<polygon fill="black" stroke="black" points="6778.23,-55.55 6787.8,-50.99 6777.48,-48.6 6778.23,-55.55"/>
</g>
<!-- expert_agg_1 -->
<g id="node46" class="node">
<title>expert_agg_1</title>
<polygon fill="#ffffcc" stroke="black" points="4175.38,-1664 3707.09,-1664 3586.62,-1560 4054.91,-1560 4175.38,-1664"/>
<text text-anchor="middle" x="3881" y="-1626" font-family="Arial" font-size="10.00">Expert Aggregation 1</text>
<text text-anchor="middle" x="3881" y="-1615" font-family="Arial" font-size="10.00">Input: [16× expert outputs]</text>
<text text-anchor="middle" x="3881" y="-1604" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3881" y="-1593" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- expert_agg_1&#45;&gt;residual2_1 -->
<g id="edge121" class="edge">
<title>expert_agg_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M3881,-1559.61C3881,-1551.44 3881,-1542.92 3881,-1534.54"/>
<polygon fill="black" stroke="black" points="3884.5,-1534.43 3881,-1524.43 3877.5,-1534.43 3884.5,-1534.43"/>
</g>
<!-- ln1_2 -->
<g id="node48" class="node">
<title>ln1_2</title>
<polygon fill="#000080" stroke="black" points="4023,-1384 3739,-1384 3739,-1332 4023,-1332 4023,-1384"/>
<text text-anchor="middle" x="3881" y="-1372" font-family="Arial" font-size="10.00">LayerNorm 2</text>
<text text-anchor="middle" x="3881" y="-1361" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3881" y="-1350" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3881" y="-1339" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2 -->
<g id="edge123" class="edge">
<title>residual2_1&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M3881,-1419.92C3881,-1411.25 3881,-1402.43 3881,-1394.29"/>
<polygon fill="black" stroke="black" points="3884.5,-1394.04 3881,-1384.04 3877.5,-1394.04 3884.5,-1394.04"/>
</g>
<!-- residual1_2 -->
<g id="node51" class="node">
<title>residual1_2</title>
<polygon fill="#ffffcc" stroke="black" points="4204.38,-1068 3736.09,-1068 3615.62,-964 4083.91,-964 4204.38,-1068"/>
<text text-anchor="middle" x="3910" y="-1030" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="3910" y="-1019" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3910" y="-1008" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3910" y="-997" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_1&#45;&gt;residual1_2 -->
<g id="edge127" class="edge">
<title>residual2_1&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M4029.64,-1419.88C4085.7,-1392.45 4143.49,-1352.39 4175,-1296 4197.55,-1255.65 4196.88,-1232.71 4175,-1192 4147.05,-1140 4096.13,-1100.89 4046.33,-1072.97"/>
<polygon fill="black" stroke="black" points="4047.83,-1069.8 4037.38,-1068.07 4044.47,-1075.94 4047.83,-1069.8"/>
</g>
<!-- attn_agg_2 -->
<g id="node49" class="node">
<title>attn_agg_2</title>
<polygon fill="#ffffcc" stroke="black" points="4166.38,-1296 3698.09,-1296 3577.62,-1192 4045.91,-1192 4166.38,-1296"/>
<text text-anchor="middle" x="3872" y="-1258" font-family="Arial" font-size="10.00">All&#45;Reduce Attention 2</text>
<text text-anchor="middle" x="3872" y="-1247" font-family="Arial" font-size="10.00">Input: [12× partial attention outputs]</text>
<text text-anchor="middle" x="3872" y="-1236" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3872" y="-1225" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln1_2&#45;&gt;attn_agg_2 -->
<g id="edge124" class="edge">
<title>ln1_2&#45;&gt;attn_agg_2</title>
<path fill="none" stroke="black" d="M3878.98,-1331.87C3878.36,-1324.18 3877.65,-1315.37 3876.93,-1306.37"/>
<polygon fill="black" stroke="black" points="3880.4,-1305.87 3876.11,-1296.18 3873.42,-1306.43 3880.4,-1305.87"/>
</g>
<!-- out_proj_2 -->
<g id="node50" class="node">
<title>out_proj_2</title>
<polygon fill="#000080" stroke="black" points="4033,-1156 3749,-1156 3749,-1104 4033,-1104 4033,-1156"/>
<text text-anchor="middle" x="3891" y="-1144" font-family="Arial" font-size="10.00">Output Projection 2</text>
<text text-anchor="middle" x="3891" y="-1133" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3891" y="-1122" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3891" y="-1111" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- attn_agg_2&#45;&gt;out_proj_2 -->
<g id="edge125" class="edge">
<title>attn_agg_2&#45;&gt;out_proj_2</title>
<path fill="none" stroke="black" d="M3880.67,-1191.92C3882.15,-1183.15 3883.67,-1174.23 3885.06,-1166.01"/>
<polygon fill="black" stroke="black" points="3888.53,-1166.49 3886.75,-1156.04 3881.63,-1165.32 3888.53,-1166.49"/>
</g>
<!-- out_proj_2&#45;&gt;residual1_2 -->
<g id="edge126" class="edge">
<title>out_proj_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M3895.26,-1103.87C3896.58,-1096.1 3898.09,-1087.18 3899.64,-1078.08"/>
<polygon fill="black" stroke="black" points="3903.1,-1078.62 3901.32,-1068.18 3896.19,-1077.45 3903.1,-1078.62"/>
</g>
<!-- ln2_2 -->
<g id="node52" class="node">
<title>ln2_2</title>
<polygon fill="#000080" stroke="black" points="5103,-306 4819,-306 4819,-254 5103,-254 5103,-306"/>
<text text-anchor="middle" x="4961" y="-294" font-family="Arial" font-size="10.00">LayerNorm 2 (MoE)</text>
<text text-anchor="middle" x="4961" y="-283" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4961" y="-272" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4961" y="-261" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge128" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M3915.79,-963.92C3921.06,-913.06 3928,-832.74 3928,-763 3928,-763 3928,-763 3928,-533 3928,-353.87 4521.68,-301.51 4808.9,-286.66"/>
<polygon fill="black" stroke="black" points="4809.18,-290.15 4818.99,-286.15 4808.83,-283.16 4809.18,-290.15"/>
</g>
<!-- residual2_2 -->
<g id="node55" class="node">
<title>residual2_2</title>
<polygon fill="#ffffcc" stroke="black" points="3427.38,-928 2959.09,-928 2838.62,-824 3306.91,-824 3427.38,-928"/>
<text text-anchor="middle" x="3133" y="-890" font-family="Arial" font-size="10.00">Residual Add 2 (MoE)</text>
<text text-anchor="middle" x="3133" y="-879" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3133" y="-868" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3133" y="-857" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_2&#45;&gt;residual2_2 -->
<g id="edge163" class="edge">
<title>residual1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M3622.61,-963.96C3559.94,-952.83 3493.5,-941.03 3430.45,-929.83"/>
<polygon fill="black" stroke="black" points="3430.82,-926.34 3420.37,-928.04 3429.6,-933.23 3430.82,-926.34"/>
</g>
<!-- ln2_2&#45;&gt;exp_0_12 -->
<g id="edge130" class="edge">
<title>ln2_2&#45;&gt;exp_0_12</title>
<path fill="none" stroke="black" d="M4961,-306.04C4961,-351.33 4961,-449.88 4961,-533 4961,-2069 4961,-2069 4961,-2069 4961,-2147.11 4942.93,-2237.34 4931.71,-2285.82"/>
<polygon fill="black" stroke="black" points="4928.25,-2285.26 4929.36,-2295.79 4935.06,-2286.86 4928.25,-2285.26"/>
</g>
<!-- ln2_2&#45;&gt;exp_1_12 -->
<g id="edge131" class="edge">
<title>ln2_2&#45;&gt;exp_1_12</title>
<path fill="none" stroke="black" d="M4818.93,-271.34C4467.8,-252.24 3586.56,-203.25 3576,-192 3544.36,-158.31 3561.1,-131.75 3576,-88 3579.36,-78.13 3585.04,-68.61 3591.31,-60.15"/>
<polygon fill="black" stroke="black" points="3594.25,-62.07 3597.71,-52.06 3588.76,-57.73 3594.25,-62.07"/>
</g>
<!-- ln2_2&#45;&gt;exp_2_12 -->
<g id="edge132" class="edge">
<title>ln2_2&#45;&gt;exp_2_12</title>
<path fill="none" stroke="black" d="M4818.64,-269.86C4629.79,-258.12 4286.01,-238.05 3992,-228 3928.58,-225.83 1759.78,-228.67 1708,-192 1705.2,-190.02 1676.27,-109.5 1659.28,-61.69"/>
<polygon fill="black" stroke="black" points="1662.49,-60.28 1655.84,-52.03 1655.89,-62.62 1662.49,-60.28"/>
</g>
<!-- ln2_2&#45;&gt;exp_3_12 -->
<g id="edge133" class="edge">
<title>ln2_2&#45;&gt;exp_3_12</title>
<path fill="none" stroke="black" d="M4818.63,-269.94C4629.78,-258.28 4286,-238.31 3992,-228 3934.92,-226 1976.03,-232.74 1936,-192 1902.72,-158.13 1917.82,-99.25 1932.71,-61.75"/>
<polygon fill="black" stroke="black" points="1936.05,-62.82 1936.66,-52.24 1929.59,-60.13 1936.05,-62.82"/>
</g>
<!-- ln2_2&#45;&gt;exp_4_13 -->
<g id="edge134" class="edge">
<title>ln2_2&#45;&gt;exp_4_13</title>
<path fill="none" stroke="black" d="M4818.62,-270.3C4629.75,-259.04 4285.95,-239.5 3992,-228 3914.03,-224.95 2655.75,-230.7 2588,-192 2540.67,-164.97 2562.39,-125.68 2523,-88 2510.58,-76.12 2495.4,-65.71 2480.39,-57.02"/>
<polygon fill="black" stroke="black" points="2482.04,-53.93 2471.6,-52.1 2478.62,-60.04 2482.04,-53.93"/>
</g>
<!-- ln2_2&#45;&gt;exp_5_13 -->
<g id="edge135" class="edge">
<title>ln2_2&#45;&gt;exp_5_13</title>
<path fill="none" stroke="black" d="M4818.61,-270.52C4629.73,-259.51 4285.92,-240.23 3992,-228 3926.69,-225.28 2870.37,-228.28 2816,-192 2773.81,-163.84 2796.17,-130.84 2769,-88 2762.89,-78.37 2755.37,-68.66 2747.96,-59.9"/>
<polygon fill="black" stroke="black" points="2750.44,-57.41 2741.24,-52.16 2745.15,-62 2750.44,-57.41"/>
</g>
<!-- ln2_2&#45;&gt;exp_6_13 -->
<g id="edge136" class="edge">
<title>ln2_2&#45;&gt;exp_6_13</title>
<path fill="none" stroke="black" d="M4818.6,-270.85C4629.7,-260.19 4285.88,-241.31 3992,-228 3939.35,-225.61 3083.3,-227.12 3044,-192 3008.25,-160.06 3008.27,-100.49 3012.75,-62.34"/>
<polygon fill="black" stroke="black" points="3016.25,-62.57 3014.11,-52.19 3009.32,-61.64 3016.25,-62.57"/>
</g>
<!-- ln2_2&#45;&gt;exp_7_13 -->
<g id="edge137" class="edge">
<title>ln2_2&#45;&gt;exp_7_13</title>
<path fill="none" stroke="black" d="M4818.98,-271.41C4630.14,-261.34 4286,-243.09 3992,-228 3952,-225.95 3299.6,-221.02 3272,-192 3240.14,-158.51 3256.66,-131.6 3272,-88 3275.52,-78 3281.45,-68.42 3287.99,-59.95"/>
<polygon fill="black" stroke="black" points="3290.73,-62.12 3294.39,-52.18 3285.33,-57.67 3290.73,-62.12"/>
</g>
<!-- ln2_2&#45;&gt;exp_8_14 -->
<g id="edge138" class="edge">
<title>ln2_2&#45;&gt;exp_8_14</title>
<path fill="none" stroke="black" d="M4896.68,-254C4868.9,-244.24 4835.77,-233.99 4805,-228 4689.99,-205.63 4381.59,-248.58 4279,-192 4228.87,-164.35 4250.95,-119.27 4203,-88 4165.75,-63.71 4120.34,-48.96 4077.11,-40.04"/>
<polygon fill="black" stroke="black" points="4077.53,-36.56 4067.05,-38.07 4076.18,-43.43 4077.53,-36.56"/>
</g>
<!-- ln2_2&#45;&gt;exp_9_14 -->
<g id="edge139" class="edge">
<title>ln2_2&#45;&gt;exp_9_14</title>
<path fill="none" stroke="black" d="M5103.02,-254.86C5252.44,-229.42 5466.25,-192.89 5467,-192 5496.79,-156.66 5496.74,-123.39 5467,-88 5465.29,-85.96 5363.31,-68.28 5270.05,-52.48"/>
<polygon fill="black" stroke="black" points="5270.63,-49.02 5260.18,-50.81 5269.46,-55.93 5270.63,-49.02"/>
</g>
<!-- ln2_2&#45;&gt;exp_10_14 -->
<g id="edge140" class="edge">
<title>ln2_2&#45;&gt;exp_10_14</title>
<path fill="none" stroke="black" d="M5097.06,-253.99C5148.61,-245.03 5207.9,-235.34 5262,-228 5339.92,-217.43 5561.3,-250.36 5614,-192 5644.98,-157.69 5641.35,-125.26 5614,-88 5602.9,-72.87 5588.04,-61.39 5571.47,-52.7"/>
<polygon fill="black" stroke="black" points="5572.62,-49.37 5562.1,-48.16 5569.57,-55.67 5572.62,-49.37"/>
</g>
<!-- ln2_2&#45;&gt;exp_11_14 -->
<g id="edge141" class="edge">
<title>ln2_2&#45;&gt;exp_11_14</title>
<path fill="none" stroke="black" d="M5090.58,-253.96C5143.55,-244.53 5205.53,-234.52 5262,-228 5326.14,-220.6 5797.78,-239.05 5842,-192 5873.66,-158.32 5866.17,-127.4 5842,-88 5834.3,-75.46 5823.14,-65.39 5810.67,-57.35"/>
<polygon fill="black" stroke="black" points="5812.23,-54.21 5801.85,-52.1 5808.65,-60.22 5812.23,-54.21"/>
</g>
<!-- ln2_2&#45;&gt;exp_12_15 -->
<g id="edge142" class="edge">
<title>ln2_2&#45;&gt;exp_12_15</title>
<path fill="none" stroke="black" d="M5087.95,-253.98C5141.47,-244.35 5204.56,-234.19 5262,-228 5304.58,-223.41 6002.43,-222.98 6032,-192 6064.72,-157.72 6051.87,-98.95 6038.64,-61.59"/>
<polygon fill="black" stroke="black" points="6041.89,-60.27 6035.12,-52.12 6035.33,-62.71 6041.89,-60.27"/>
</g>
<!-- ln2_2&#45;&gt;exp_13_15 -->
<g id="edge143" class="edge">
<title>ln2_2&#45;&gt;exp_13_15</title>
<path fill="none" stroke="black" d="M5086.44,-253.95C5140.27,-244.18 5204,-233.93 5262,-228 5317.19,-222.35 6215.11,-224.61 6260,-192 6299.81,-163.08 6279.28,-133.51 6298,-88 6301.61,-79.22 6305.77,-69.84 6309.75,-61.14"/>
<polygon fill="black" stroke="black" points="6312.94,-62.57 6313.96,-52.03 6306.59,-59.63 6312.94,-62.57"/>
</g>
<!-- ln2_2&#45;&gt;exp_14_15 -->
<g id="edge144" class="edge">
<title>ln2_2&#45;&gt;exp_14_15</title>
<path fill="none" stroke="black" d="M5085.32,-253.96C5139.38,-244.1 5203.59,-233.78 5262,-228 5329.81,-221.29 6432.74,-231.86 6488,-192 6527.91,-163.21 6494.63,-125.92 6526,-88 6535.92,-76 6548.86,-65.78 6562.17,-57.32"/>
<polygon fill="black" stroke="black" points="6564.2,-60.19 6570.95,-52.02 6560.58,-54.19 6564.2,-60.19"/>
</g>
<!-- ln2_2&#45;&gt;exp_15_15 -->
<g id="edge145" class="edge">
<title>ln2_2&#45;&gt;exp_15_15</title>
<path fill="none" stroke="black" d="M5084.58,-253.96C5138.78,-244.04 5203.31,-233.67 5262,-228 5342.43,-220.23 6650.36,-239.12 6716,-192 6755.98,-163.3 6718.91,-122.51 6754,-88 6767.55,-74.68 6784.15,-64.26 6801.69,-56.11"/>
<polygon fill="black" stroke="black" points="6803.18,-59.27 6810.93,-52.05 6800.37,-52.86 6803.18,-59.27"/>
</g>
<!-- gate_2 -->
<g id="node53" class="node">
<title>gate_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4864.43,-192 4405.6,-192 4287.57,-88 4746.4,-88 4864.43,-192"/>
<text text-anchor="middle" x="4576" y="-154" font-family="Arial" font-size="10.00">Gating Network 2</text>
<text text-anchor="middle" x="4576" y="-143" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4576" y="-132" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="4576" y="-121" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln2_2&#45;&gt;gate_2 -->
<g id="edge129" class="edge">
<title>ln2_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M4890.83,-253.85C4845.42,-237.57 4784.5,-215.73 4728.34,-195.61"/>
<polygon fill="black" stroke="black" points="4729.24,-192.21 4718.65,-192.13 4726.88,-198.8 4729.24,-192.21"/>
</g>
<!-- gate_2&#45;&gt;exp_0_12 -->
<g id="edge146" class="edge">
<title>gate_2&#45;&gt;exp_0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4862.87,-190.36C4866.26,-190.91 4869.64,-191.46 4873,-192 4926.03,-200.55 5074.89,-189.17 5112,-228 5170.98,-289.7 5132,-333.65 5132,-419 5132,-2069 5132,-2069 5132,-2069 5132,-2167.8 5035.64,-2248.61 4973.78,-2290.31"/>
<polygon fill="black" stroke="black" points="4971.7,-2287.49 4965.29,-2295.94 4975.56,-2293.33 4971.7,-2287.49"/>
</g>
<!-- gate_2&#45;&gt;exp_1_12 -->
<g id="edge147" class="edge">
<title>gate_2&#45;&gt;exp_1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4300.7,-99.71C4267.81,-95.5 4234.67,-91.49 4203,-88 4016.07,-67.39 3965.58,-75.36 3775.27,-52.11"/>
<polygon fill="black" stroke="black" points="3775.57,-48.62 3765.22,-50.87 3774.71,-55.57 3775.57,-48.62"/>
</g>
<!-- gate_2&#45;&gt;exp_2_12 -->
<g id="edge148" class="edge">
<title>gate_2&#45;&gt;exp_2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4297.86,-97.21C4265.93,-93.53 4233.79,-90.33 4203,-88 3140.41,-7.7 2864.48,-146.68 1799.39,-52.06"/>
<polygon fill="black" stroke="black" points="1799.46,-48.55 1789.19,-51.15 1798.84,-55.52 1799.46,-48.55"/>
</g>
<!-- gate_2&#45;&gt;exp_3_12 -->
<g id="edge149" class="edge">
<title>gate_2&#45;&gt;exp_3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4298.1,-97.35C4266.09,-93.64 4233.87,-90.39 4203,-88 3343.64,-21.5 3124.9,-94.12 2264,-52 2210.96,-49.41 2153,-45.2 2101.41,-40.97"/>
<polygon fill="black" stroke="black" points="2101.44,-37.46 2091.19,-40.12 2100.86,-44.44 2101.44,-37.46"/>
</g>
<!-- gate_2&#45;&gt;exp_4_13 -->
<g id="edge150" class="edge">
<title>gate_2&#45;&gt;exp_4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4298.09,-97.46C4266.08,-93.73 4233.87,-90.44 4203,-88 3480.9,-30.88 3292.33,-118.78 2567.36,-52.06"/>
<polygon fill="black" stroke="black" points="2567.47,-48.56 2557.19,-51.12 2566.83,-55.53 2567.47,-48.56"/>
</g>
<!-- gate_2&#45;&gt;exp_5_13 -->
<g id="edge151" class="edge">
<title>gate_2&#45;&gt;exp_5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4298.34,-97.64C4266.24,-93.87 4233.94,-90.53 4203,-88 3614.74,-40 3460.57,-107.84 2869.25,-52.06"/>
<polygon fill="black" stroke="black" points="2869.48,-48.56 2859.19,-51.1 2868.82,-55.53 2869.48,-48.56"/>
</g>
<!-- gate_2&#45;&gt;exp_6_13 -->
<g id="edge152" class="edge">
<title>gate_2&#45;&gt;exp_6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4298.82,-97.94C4266.57,-94.1 4234.1,-90.66 4203,-88 3748.64,-49.12 3628.87,-96.9 3171.38,-52.08"/>
<polygon fill="black" stroke="black" points="3171.49,-48.57 3161.2,-51.07 3170.8,-55.54 3171.49,-48.57"/>
</g>
<!-- gate_2&#45;&gt;exp_7_13 -->
<g id="edge153" class="edge">
<title>gate_2&#45;&gt;exp_7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4299.29,-98.45C4266.88,-94.5 4234.24,-90.9 4203,-88 3882.43,-58.25 3797.18,-86.04 3473.34,-52.09"/>
<polygon fill="black" stroke="black" points="3473.52,-48.58 3463.2,-51.01 3472.78,-55.55 3473.52,-48.58"/>
</g>
<!-- gate_2&#45;&gt;exp_8_14 -->
<g id="edge154" class="edge">
<title>gate_2&#45;&gt;exp_8_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4289.04,-89.63C4216.08,-77.08 4140.5,-64.07 4077.24,-53.19"/>
<polygon fill="black" stroke="black" points="4077.64,-49.71 4067.19,-51.46 4076.45,-56.61 4077.64,-49.71"/>
</g>
<!-- gate_2&#45;&gt;exp_9_14 -->
<g id="edge155" class="edge">
<title>gate_2&#45;&gt;exp_9_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4761.01,-100.77C4835.25,-85.43 4919.1,-68.1 4986.87,-54.1"/>
<polygon fill="black" stroke="black" points="4987.66,-57.51 4996.75,-52.06 4986.25,-50.65 4987.66,-57.51"/>
</g>
<!-- gate_2&#45;&gt;exp_10_14 -->
<g id="edge156" class="edge">
<title>gate_2&#45;&gt;exp_10_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4764.99,-104.23C4800.79,-98.31 4837.99,-92.59 4873,-88 5044.98,-65.45 5091.97,-74.11 5267.67,-52.13"/>
<polygon fill="black" stroke="black" points="5268.3,-55.57 5277.78,-50.85 5267.42,-48.63 5268.3,-55.57"/>
</g>
<!-- gate_2&#45;&gt;exp_11_14 -->
<g id="edge157" class="edge">
<title>gate_2&#45;&gt;exp_11_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4764.06,-103.25C4800.11,-97.38 4837.64,-91.93 4873,-88 5178.41,-54.02 5260.41,-84.75 5569.64,-52.09"/>
<polygon fill="black" stroke="black" points="5570.23,-55.55 5579.8,-51 5569.48,-48.59 5570.23,-55.55"/>
</g>
<!-- gate_2&#45;&gt;exp_12_15 -->
<g id="edge158" class="edge">
<title>gate_2&#45;&gt;exp_12_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4763.62,-102.87C4799.79,-97.01 4837.48,-91.67 4873,-88 5312.03,-42.61 5428.73,-95.6 5871.61,-52.08"/>
<polygon fill="black" stroke="black" points="5872.2,-55.54 5881.8,-51.06 5871.51,-48.57 5872.2,-55.54"/>
</g>
<!-- gate_2&#45;&gt;exp_13_15 -->
<g id="edge159" class="edge">
<title>gate_2&#45;&gt;exp_13_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4763.19,-102.69C4799.5,-96.83 4837.34,-91.54 4873,-88 5445.69,-31.2 5597,-106.51 6173.57,-52.07"/>
<polygon fill="black" stroke="black" points="6174.18,-55.53 6183.81,-51.1 6173.52,-48.56 6174.18,-55.53"/>
</g>
<!-- gate_2&#45;&gt;exp_14_15 -->
<g id="edge160" class="edge">
<title>gate_2&#45;&gt;exp_14_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4763.18,-102.54C4799.48,-96.7 4837.33,-91.44 4873,-88 5579.48,-19.79 5765.31,-117.49 6475.84,-52.04"/>
<polygon fill="black" stroke="black" points="6476.18,-55.53 6485.81,-51.12 6475.53,-48.56 6476.18,-55.53"/>
</g>
<!-- gate_2&#45;&gt;exp_15_15 -->
<g id="edge161" class="edge">
<title>gate_2&#45;&gt;exp_15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4763.17,-102.44C4799.47,-96.6 4837.32,-91.38 4873,-88 5713.19,-8.39 5933.56,-128.45 6777.85,-52.04"/>
<polygon fill="black" stroke="black" points="6778.17,-55.53 6787.81,-51.13 6777.53,-48.55 6778.17,-55.53"/>
</g>
<!-- expert_agg_2 -->
<g id="node54" class="node">
<title>expert_agg_2</title>
<polygon fill="#ffffcc" stroke="black" points="3408.38,-1068 2940.09,-1068 2819.62,-964 3287.91,-964 3408.38,-1068"/>
<text text-anchor="middle" x="3114" y="-1030" font-family="Arial" font-size="10.00">Expert Aggregation 2</text>
<text text-anchor="middle" x="3114" y="-1019" font-family="Arial" font-size="10.00">Input: [16× expert outputs]</text>
<text text-anchor="middle" x="3114" y="-1008" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3114" y="-997" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- expert_agg_2&#45;&gt;residual2_2 -->
<g id="edge162" class="edge">
<title>expert_agg_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M3121.07,-963.61C3122.2,-955.44 3123.37,-946.92 3124.53,-938.54"/>
<polygon fill="black" stroke="black" points="3128.02,-938.81 3125.92,-928.43 3121.09,-937.86 3128.02,-938.81"/>
</g>
<!-- ln1_3 -->
<g id="node56" class="node">
<title>ln1_3</title>
<polygon fill="#000080" stroke="black" points="3265,-788 2981,-788 2981,-736 3265,-736 3265,-788"/>
<text text-anchor="middle" x="3123" y="-776" font-family="Arial" font-size="10.00">LayerNorm 3</text>
<text text-anchor="middle" x="3123" y="-765" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3123" y="-754" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3123" y="-743" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3 -->
<g id="edge164" class="edge">
<title>residual2_2&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M3128.44,-823.92C3127.66,-815.15 3126.86,-806.23 3126.13,-798.01"/>
<polygon fill="black" stroke="black" points="3129.61,-797.69 3125.24,-788.04 3122.64,-798.32 3129.61,-797.69"/>
</g>
<!-- residual1_3 -->
<g id="node59" class="node">
<title>residual1_3</title>
<polygon fill="#ffffcc" stroke="black" points="3446.38,-472 2978.09,-472 2857.62,-368 3325.91,-368 3446.38,-472"/>
<text text-anchor="middle" x="3152" y="-434" font-family="Arial" font-size="10.00">Residual Add 3</text>
<text text-anchor="middle" x="3152" y="-423" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3152" y="-412" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3152" y="-401" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_2&#45;&gt;residual1_3 -->
<g id="edge168" class="edge">
<title>residual2_2&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M3273.7,-823.82C3328.62,-796.12 3385.8,-755.87 3417,-700 3439.54,-659.64 3438.88,-636.71 3417,-596 3389.05,-544 3338.13,-504.89 3288.33,-476.97"/>
<polygon fill="black" stroke="black" points="3289.83,-473.8 3279.38,-472.07 3286.47,-479.94 3289.83,-473.8"/>
</g>
<!-- attn_agg_3 -->
<g id="node57" class="node">
<title>attn_agg_3</title>
<polygon fill="#ffffcc" stroke="black" points="3408.38,-700 2940.09,-700 2819.62,-596 3287.91,-596 3408.38,-700"/>
<text text-anchor="middle" x="3114" y="-662" font-family="Arial" font-size="10.00">All&#45;Reduce Attention 3</text>
<text text-anchor="middle" x="3114" y="-651" font-family="Arial" font-size="10.00">Input: [12× partial attention outputs]</text>
<text text-anchor="middle" x="3114" y="-640" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3114" y="-629" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln1_3&#45;&gt;attn_agg_3 -->
<g id="edge165" class="edge">
<title>ln1_3&#45;&gt;attn_agg_3</title>
<path fill="none" stroke="black" d="M3120.98,-735.87C3120.36,-728.18 3119.65,-719.37 3118.93,-710.37"/>
<polygon fill="black" stroke="black" points="3122.4,-709.87 3118.11,-700.18 3115.42,-710.43 3122.4,-709.87"/>
</g>
<!-- out_proj_3 -->
<g id="node58" class="node">
<title>out_proj_3</title>
<polygon fill="#000080" stroke="black" points="3275,-560 2991,-560 2991,-508 3275,-508 3275,-560"/>
<text text-anchor="middle" x="3133" y="-548" font-family="Arial" font-size="10.00">Output Projection 3</text>
<text text-anchor="middle" x="3133" y="-537" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3133" y="-526" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3133" y="-515" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- attn_agg_3&#45;&gt;out_proj_3 -->
<g id="edge166" class="edge">
<title>attn_agg_3&#45;&gt;out_proj_3</title>
<path fill="none" stroke="black" d="M3122.67,-595.92C3124.15,-587.15 3125.67,-578.23 3127.06,-570.01"/>
<polygon fill="black" stroke="black" points="3130.53,-570.49 3128.75,-560.04 3123.63,-569.32 3130.53,-570.49"/>
</g>
<!-- out_proj_3&#45;&gt;residual1_3 -->
<g id="edge167" class="edge">
<title>out_proj_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M3137.26,-507.87C3138.58,-500.1 3140.09,-491.18 3141.64,-482.08"/>
<polygon fill="black" stroke="black" points="3145.1,-482.62 3143.32,-472.18 3138.19,-481.45 3145.1,-482.62"/>
</g>
<!-- ln2_3 -->
<g id="node60" class="node">
<title>ln2_3</title>
<polygon fill="#000080" stroke="black" points="3983,-306 3699,-306 3699,-254 3983,-254 3983,-306"/>
<text text-anchor="middle" x="3841" y="-294" font-family="Arial" font-size="10.00">LayerNorm 3 (MoE)</text>
<text text-anchor="middle" x="3841" y="-283" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3841" y="-272" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3841" y="-261" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge169" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M3341.18,-381.11C3456.87,-357.94 3602.1,-328.85 3706.16,-308.01"/>
<polygon fill="black" stroke="black" points="3706.98,-311.41 3716.1,-306.02 3705.6,-304.55 3706.98,-311.41"/>
</g>
<!-- residual2_3 -->
<g id="node63" class="node">
<title>residual2_3</title>
<polygon fill="#ffffcc" stroke="black" points="2574.38,-332 2106.09,-332 1985.62,-228 2453.91,-228 2574.38,-332"/>
<text text-anchor="middle" x="2280" y="-294" font-family="Arial" font-size="10.00">Residual Add 3 (MoE)</text>
<text text-anchor="middle" x="2280" y="-283" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2280" y="-272" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2280" y="-261" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_3&#45;&gt;residual2_3 -->
<g id="edge204" class="edge">
<title>residual1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M2863.76,-373.38C2772.11,-358.88 2670.59,-342.81 2578.25,-328.2"/>
<polygon fill="black" stroke="black" points="2578.62,-324.71 2568.19,-326.61 2577.52,-331.63 2578.62,-324.71"/>
</g>
<!-- ln2_3&#45;&gt;exp_0_12 -->
<g id="edge171" class="edge">
<title>ln2_3&#45;&gt;exp_0_12</title>
<path fill="none" stroke="black" d="M3983.25,-303.93C4108.13,-333.13 4270,-397.17 4270,-533 4270,-1245 4270,-1245 4270,-1245 4270,-1291.93 4247.94,-1628.72 4217,-1664 4014.91,-1894.41 3550,-1532.52 3550,-1839 3550,-2069 3550,-2069 3550,-2069 3550,-2395.77 3936.73,-2212.29 4260,-2260 4434.31,-2285.73 4636.11,-2302.44 4770.86,-2311.76"/>
<polygon fill="black" stroke="black" points="4770.63,-2315.25 4780.84,-2312.44 4771.11,-2308.27 4770.63,-2315.25"/>
</g>
<!-- ln2_3&#45;&gt;exp_1_12 -->
<g id="edge172" class="edge">
<title>ln2_3&#45;&gt;exp_1_12</title>
<path fill="none" stroke="black" d="M3698.67,-260.43C3616.68,-246.48 3525.02,-224.21 3500,-192 3471.64,-155.5 3475.64,-127.28 3500,-88 3507.81,-75.41 3519.08,-65.34 3531.66,-57.3"/>
<polygon fill="black" stroke="black" points="3533.72,-60.15 3540.56,-52.06 3530.17,-54.12 3533.72,-60.15"/>
</g>
<!-- ln2_3&#45;&gt;exp_2_12 -->
<g id="edge173" class="edge">
<title>ln2_3&#45;&gt;exp_2_12</title>
<path fill="none" stroke="black" d="M3698.56,-273.17C3465.38,-263.65 2987.6,-244.18 2583,-228 2532.28,-225.97 1707.63,-226.07 1670,-192 1634.53,-159.88 1635.3,-100.36 1640.28,-62.27"/>
<polygon fill="black" stroke="black" points="1643.78,-62.54 1641.77,-52.14 1636.86,-61.52 1643.78,-62.54"/>
</g>
<!-- ln2_3&#45;&gt;exp_3_12 -->
<g id="edge174" class="edge">
<title>ln2_3&#45;&gt;exp_3_12</title>
<path fill="none" stroke="black" d="M3698.77,-273.28C3252,-255.21 1905.78,-200.14 1898,-192 1866.06,-158.59 1882.23,-131.45 1898,-88 1901.68,-77.87 1907.85,-68.25 1914.66,-59.76"/>
<polygon fill="black" stroke="black" points="1917.47,-61.87 1921.32,-52 1912.15,-57.31 1917.47,-61.87"/>
</g>
<!-- ln2_3&#45;&gt;exp_4_13 -->
<g id="edge175" class="edge">
<title>ln2_3&#45;&gt;exp_4_13</title>
<path fill="none" stroke="black" d="M3698.71,-275.94C3384.11,-268.24 2649.39,-244.78 2550,-192 2498.26,-164.52 2506.44,-133.07 2469,-88 2461.31,-78.74 2452.77,-68.9 2444.79,-59.89"/>
<polygon fill="black" stroke="black" points="2447.22,-57.36 2437.96,-52.21 2441.99,-62.01 2447.22,-57.36"/>
</g>
<!-- ln2_3&#45;&gt;exp_5_13 -->
<g id="edge176" class="edge">
<title>ln2_3&#45;&gt;exp_5_13</title>
<path fill="none" stroke="black" d="M3698.85,-275.77C3426.07,-268.37 2849.72,-246.43 2778,-192 2756.83,-175.93 2736.25,-105.45 2725.24,-61.96"/>
<polygon fill="black" stroke="black" points="2728.59,-60.93 2722.78,-52.07 2721.8,-62.62 2728.59,-60.93"/>
</g>
<!-- ln2_3&#45;&gt;exp_6_13 -->
<g id="edge177" class="edge">
<title>ln2_3&#45;&gt;exp_6_13</title>
<path fill="none" stroke="black" d="M3698.94,-274.37C3472.73,-265.52 3051.43,-242.41 3006,-192 2974.3,-156.83 2988.8,-98.58 3003.15,-61.53"/>
<polygon fill="black" stroke="black" points="3006.44,-62.71 3006.96,-52.13 2999.96,-60.08 3006.44,-62.71"/>
</g>
<!-- ln2_3&#45;&gt;exp_7_13 -->
<g id="edge178" class="edge">
<title>ln2_3&#45;&gt;exp_7_13</title>
<path fill="none" stroke="black" d="M3698.75,-279.24C3538.58,-276.12 3292.92,-259.97 3234,-192 3203.72,-157.07 3212.67,-129.01 3234,-88 3240.11,-76.26 3249.62,-66.31 3260.15,-58.07"/>
<polygon fill="black" stroke="black" points="3262.33,-60.81 3268.36,-52.1 3258.22,-55.15 3262.33,-60.81"/>
</g>
<!-- ln2_3&#45;&gt;exp_8_14 -->
<g id="edge179" class="edge">
<title>ln2_3&#45;&gt;exp_8_14</title>
<path fill="none" stroke="black" d="M3698.74,-255.42C3663.75,-242.55 3630.26,-222.67 3609,-192 3582.67,-154.01 3579.58,-123.65 3609,-88 3611.91,-84.47 3694.47,-68.61 3774.46,-53.94"/>
<polygon fill="black" stroke="black" points="3775.49,-57.31 3784.7,-52.06 3774.23,-50.42 3775.49,-57.31"/>
</g>
<!-- ln2_3&#45;&gt;exp_9_14 -->
<g id="edge180" class="edge">
<title>ln2_3&#45;&gt;exp_9_14</title>
<path fill="none" stroke="black" d="M3983.41,-267.98C4054.18,-257 4138.18,-235.19 4203,-192 4250.64,-160.25 4228.93,-115.75 4279,-88 4337.34,-55.66 4739.7,-38.41 4965.36,-31.19"/>
<polygon fill="black" stroke="black" points="4965.75,-34.68 4975.63,-30.86 4965.53,-27.68 4965.75,-34.68"/>
</g>
<!-- ln2_3&#45;&gt;exp_10_14 -->
<g id="edge181" class="edge">
<title>ln2_3&#45;&gt;exp_10_14</title>
<path fill="none" stroke="black" d="M3983,-271.56C4378.77,-250.81 5465.41,-193.68 5467,-192 5498.8,-158.45 5481.9,-131.75 5467,-88 5463.64,-78.13 5457.96,-68.61 5451.69,-60.15"/>
<polygon fill="black" stroke="black" points="5454.24,-57.73 5445.29,-52.06 5448.75,-62.07 5454.24,-57.73"/>
</g>
<!-- ln2_3&#45;&gt;exp_11_14 -->
<g id="edge182" class="edge">
<title>ln2_3&#45;&gt;exp_11_14</title>
<path fill="none" stroke="black" d="M3983.02,-271.51C4383.01,-250.4 5490,-192 5490,-192 5570.62,-163.89 5648.08,-98.59 5689.93,-59.08"/>
<polygon fill="black" stroke="black" points="5692.51,-61.46 5697.32,-52.02 5687.67,-56.4 5692.51,-61.46"/>
</g>
<!-- ln2_3&#45;&gt;exp_12_15 -->
<g id="edge183" class="edge">
<title>ln2_3&#45;&gt;exp_12_15</title>
<path fill="none" stroke="black" d="M3983.01,-271.25C4171.84,-261 4515.97,-242.56 4810,-228 4982.42,-219.46 5416.93,-226.86 5586,-192 5726.43,-163.05 5881.36,-95.62 5964.08,-56.51"/>
<polygon fill="black" stroke="black" points="5965.79,-59.57 5973.32,-52.12 5962.79,-53.25 5965.79,-59.57"/>
</g>
<!-- ln2_3&#45;&gt;exp_13_15 -->
<g id="edge184" class="edge">
<title>ln2_3&#45;&gt;exp_13_15</title>
<path fill="none" stroke="black" d="M3983.4,-270.86C4172.3,-260.22 4516.13,-241.35 4810,-228 5019.27,-218.49 5545.16,-225.18 5752,-192 5934.11,-162.79 6140.28,-94.51 6249.15,-55.56"/>
<polygon fill="black" stroke="black" points="6250.51,-58.79 6258.73,-52.11 6248.14,-52.2 6250.51,-58.79"/>
</g>
<!-- ln2_3&#45;&gt;exp_14_15 -->
<g id="edge185" class="edge">
<title>ln2_3&#45;&gt;exp_14_15</title>
<path fill="none" stroke="black" d="M3983.39,-270.55C4172.27,-259.56 4516.08,-240.31 4810,-228 5066.57,-217.25 5710.63,-227.21 5965,-192 6175.13,-162.92 6415.24,-93.94 6540.89,-55.01"/>
<polygon fill="black" stroke="black" points="6541.96,-58.34 6550.47,-52.03 6539.88,-51.65 6541.96,-58.34"/>
</g>
<!-- ln2_3&#45;&gt;exp_15_15 -->
<g id="edge186" class="edge">
<title>ln2_3&#45;&gt;exp_15_15</title>
<path fill="none" stroke="black" d="M3983.38,-270.31C4172.25,-259.05 4516.05,-239.52 4810,-228 5120.53,-215.83 5899.66,-230.81 6208,-192 6436.76,-163.21 6699.3,-93.79 6836.05,-54.79"/>
<polygon fill="black" stroke="black" points="6837.03,-58.15 6845.68,-52.04 6835.1,-51.42 6837.03,-58.15"/>
</g>
<!-- gate_3 -->
<g id="node61" class="node">
<title>gate_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4194.43,-192 3735.6,-192 3617.57,-88 4076.4,-88 4194.43,-192"/>
<text text-anchor="middle" x="3906" y="-154" font-family="Arial" font-size="10.00">Gating Network 3</text>
<text text-anchor="middle" x="3906" y="-143" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3906" y="-132" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="3906" y="-121" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln2_3&#45;&gt;gate_3 -->
<g id="edge170" class="edge">
<title>ln2_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M3852.92,-253.69C3859.85,-238.98 3868.9,-219.77 3877.56,-201.38"/>
<polygon fill="black" stroke="black" points="3880.81,-202.7 3881.9,-192.16 3874.47,-199.72 3880.81,-202.7"/>
</g>
<!-- gate_3&#45;&gt;exp_0_12 -->
<g id="edge187" class="edge">
<title>gate_3&#45;&gt;exp_0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4023.37,-192.12C4282.15,-313.66 4879,-646.31 4879,-1129 4879,-1359 4879,-1359 4879,-1359 4879,-1522.84 4923,-1561.16 4923,-1725 4923,-2069 4923,-2069 4923,-2069 4923,-2146.44 4923,-2237.27 4923,-2285.95"/>
<polygon fill="black" stroke="black" points="4919.5,-2285.96 4923,-2295.96 4926.5,-2285.96 4919.5,-2285.96"/>
</g>
<!-- gate_3&#45;&gt;exp_1_12 -->
<g id="edge188" class="edge">
<title>gate_3&#45;&gt;exp_1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3776.92,-87.92C3749,-76.87 3720.43,-65.56 3695.6,-55.73"/>
<polygon fill="black" stroke="black" points="3696.87,-52.47 3686.28,-52.04 3694.29,-58.98 3696.87,-52.47"/>
</g>
<!-- gate_3&#45;&gt;exp_2_12 -->
<g id="edge189" class="edge">
<title>gate_3&#45;&gt;exp_2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3665.98,-130.76C3161.03,-113.18 2018.04,-72.07 1799.47,-52.04"/>
<polygon fill="black" stroke="black" points="1799.49,-48.52 1789.2,-51.04 1798.81,-55.49 1799.49,-48.52"/>
</g>
<!-- gate_3&#45;&gt;exp_3_12 -->
<g id="edge190" class="edge">
<title>gate_3&#45;&gt;exp_3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3662.8,-128.11C3342.16,-113.3 2760.52,-84.85 2264,-52 2211.01,-48.49 2153.06,-44.07 2101.47,-39.91"/>
<polygon fill="black" stroke="black" points="2101.49,-36.4 2091.25,-39.09 2100.93,-43.38 2101.49,-36.4"/>
</g>
<!-- gate_3&#45;&gt;exp_4_13 -->
<g id="edge191" class="edge">
<title>gate_3&#45;&gt;exp_4_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3665.72,-130.59C3399.35,-119.61 2956.94,-96.46 2567.27,-52.1"/>
<polygon fill="black" stroke="black" points="2567.54,-48.61 2557.21,-50.95 2566.75,-55.56 2567.54,-48.61"/>
</g>
<!-- gate_3&#45;&gt;exp_5_13 -->
<g id="edge192" class="edge">
<title>gate_3&#45;&gt;exp_5_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3658.2,-123.86C3450.12,-109.81 3144.85,-86.11 2869.42,-52.14"/>
<polygon fill="black" stroke="black" points="2869.57,-48.63 2859.22,-50.87 2868.71,-55.58 2869.57,-48.63"/>
</g>
<!-- gate_3&#45;&gt;exp_6_13 -->
<g id="edge193" class="edge">
<title>gate_3&#45;&gt;exp_6_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3643.33,-110.94C3505.6,-95.5 3333.9,-75.08 3171.43,-52.18"/>
<polygon fill="black" stroke="black" points="3171.63,-48.67 3161.24,-50.74 3170.65,-55.6 3171.63,-48.67"/>
</g>
<!-- gate_3&#45;&gt;exp_7_13 -->
<g id="edge194" class="edge">
<title>gate_3&#45;&gt;exp_7_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3639.61,-88C3578.14,-76.23 3515.12,-64.16 3461.53,-53.9"/>
<polygon fill="black" stroke="black" points="3462.11,-50.45 3451.63,-52.01 3460.8,-57.33 3462.11,-50.45"/>
</g>
<!-- gate_3&#45;&gt;exp_8_14 -->
<g id="edge195" class="edge">
<title>gate_3&#45;&gt;exp_8_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3914.67,-87.92C3916.15,-79.15 3917.67,-70.23 3919.06,-62.01"/>
<polygon fill="black" stroke="black" points="3922.53,-62.49 3920.75,-52.04 3915.63,-61.32 3922.53,-62.49"/>
</g>
<!-- gate_3&#45;&gt;exp_9_14 -->
<g id="edge196" class="edge">
<title>gate_3&#45;&gt;exp_9_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4098.5,-107.42C4146.58,-100.28 4198.09,-93.26 4246,-88 4497.57,-60.38 4791.41,-42.86 4965.7,-34"/>
<polygon fill="black" stroke="black" points="4965.91,-37.49 4975.72,-33.49 4965.55,-30.5 4965.91,-37.49"/>
</g>
<!-- gate_3&#45;&gt;exp_10_14 -->
<g id="edge197" class="edge">
<title>gate_3&#45;&gt;exp_10_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4100.15,-108.73C4157.6,-100.78 4220.72,-93.03 4279,-88 4714.34,-50.42 4829.19,-95.36 5267.71,-52.07"/>
<polygon fill="black" stroke="black" points="5268.2,-55.54 5277.8,-51.06 5267.51,-48.57 5268.2,-55.54"/>
</g>
<!-- gate_3&#45;&gt;exp_11_14 -->
<g id="edge198" class="edge">
<title>gate_3&#45;&gt;exp_11_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4100.12,-108.41C4157.57,-100.46 4220.7,-92.78 4279,-88 4848.17,-41.3 4997.45,-106.27 5569.65,-52.07"/>
<polygon fill="black" stroke="black" points="5570.19,-55.53 5579.81,-51.1 5569.52,-48.56 5570.19,-55.53"/>
</g>
<!-- gate_3&#45;&gt;exp_12_15 -->
<g id="edge199" class="edge">
<title>gate_3&#45;&gt;exp_12_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4099.62,-108.28C4157.2,-100.3 4220.52,-92.64 4279,-88 4982.04,-32.18 5165.71,-117.22 5871.64,-52.06"/>
<polygon fill="black" stroke="black" points="5872.18,-55.53 5881.81,-51.12 5871.53,-48.56 5872.18,-55.53"/>
</g>
<!-- gate_3&#45;&gt;exp_13_15 -->
<g id="edge200" class="edge">
<title>gate_3&#45;&gt;exp_13_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4099.61,-108.15C4157.19,-100.16 4220.52,-92.54 4279,-88 5115.91,-23.06 5333.96,-128.18 6173.59,-52.06"/>
<polygon fill="black" stroke="black" points="6174.17,-55.53 6183.81,-51.13 6173.53,-48.55 6174.17,-55.53"/>
</g>
<!-- gate_3&#45;&gt;exp_14_15 -->
<g id="edge201" class="edge">
<title>gate_3&#45;&gt;exp_14_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4099.61,-108.05C4157.19,-100.06 4220.51,-92.46 4279,-88 5249.86,-13.94 5502.23,-139.17 6475.77,-52.05"/>
<polygon fill="black" stroke="black" points="6476.17,-55.52 6485.81,-51.14 6475.54,-48.55 6476.17,-55.52"/>
</g>
<!-- gate_3&#45;&gt;exp_15_15 -->
<g id="edge202" class="edge">
<title>gate_3&#45;&gt;exp_15_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4099.6,-107.98C4157.18,-99.99 4220.51,-92.4 4279,-88 5383.71,-4.83 5670.45,-150.14 6777.62,-52.06"/>
<polygon fill="black" stroke="black" points="6778.16,-55.52 6787.81,-51.15 6777.54,-48.55 6778.16,-55.52"/>
</g>
<!-- expert_agg_3 -->
<g id="node62" class="node">
<title>expert_agg_3</title>
<polygon fill="#ffffcc" stroke="black" points="2574.38,-472 2106.09,-472 1985.62,-368 2453.91,-368 2574.38,-472"/>
<text text-anchor="middle" x="2280" y="-434" font-family="Arial" font-size="10.00">Expert Aggregation 3</text>
<text text-anchor="middle" x="2280" y="-423" font-family="Arial" font-size="10.00">Input: [16× expert outputs]</text>
<text text-anchor="middle" x="2280" y="-412" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2280" y="-401" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- expert_agg_3&#45;&gt;residual2_3 -->
<g id="edge203" class="edge">
<title>expert_agg_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M2280,-367.61C2280,-359.44 2280,-350.92 2280,-342.54"/>
<polygon fill="black" stroke="black" points="2283.5,-342.43 2280,-332.43 2276.5,-342.43 2283.5,-342.43"/>
</g>
<!-- residual2_3&#45;&gt;output -->
<g id="edge205" class="edge">
<title>residual2_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2271.44,-227.61C2269.22,-214.31 2266.85,-200.07 2264.68,-187.06"/>
<polygon fill="black" stroke="black" points="2268.09,-186.22 2262.99,-176.93 2261.18,-187.37 2268.09,-186.22"/>
</g>
</g>
</svg>
