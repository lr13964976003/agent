<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: ma_separation_dag Pages: 1 -->
<svg width="1440pt" height="1460pt"
 viewBox="0.00 0.00 1440.00 1459.96" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.27 0.27) rotate(0) translate(4 5487.08)">
<title>ma_separation_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5487.08 5412,-5487.08 5412,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0</title>
<polygon fill="none" stroke="gray" stroke-dasharray="5,2" points="8,-4038.54 8,-5313.54 4858,-5313.54 4858,-4038.54 8,-4038.54"/>
<text text-anchor="middle" x="2433" y="-5298.34" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_1</title>
<polygon fill="none" stroke="gray" stroke-dasharray="5,2" points="550,-2755.54 550,-4030.54 5400,-4030.54 5400,-2755.54 550,-2755.54"/>
<text text-anchor="middle" x="2975" y="-4015.34" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_2</title>
<polygon fill="none" stroke="gray" stroke-dasharray="5,2" points="64,-1472.54 64,-2747.54 4914,-2747.54 4914,-1472.54 64,-1472.54"/>
<text text-anchor="middle" x="2489" y="-2732.34" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_3</title>
<polygon fill="none" stroke="gray" stroke-dasharray="5,2" points="380,-189.54 380,-1464.54 5230,-1464.54 5230,-189.54 380,-189.54"/>
<text text-anchor="middle" x="2805" y="-1449.34" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e6f3ff" stroke="black" cx="3325" cy="-5446.31" rx="200.64" ry="36.54"/>
<text text-anchor="middle" x="3325" y="-5460.31" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="3325" y="-5449.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048]</text>
<text text-anchor="middle" x="3325" y="-5438.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3325" y="-5427.31" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- embedding -->
<g id="node2" class="node">
<title>embedding</title>
<polygon fill="#0080ff" stroke="black" points="3467,-5373.54 3183,-5373.54 3183,-5321.54 3467,-5321.54 3467,-5373.54"/>
<text text-anchor="middle" x="3325" y="-5361.54" font-family="Arial" font-size="10.00">Embedding</text>
<text text-anchor="middle" x="3325" y="-5350.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048]</text>
<text text-anchor="middle" x="3325" y="-5339.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3325" y="-5328.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;embedding -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embedding</title>
<path fill="none" stroke="black" d="M3325,-5409.28C3325,-5400.96 3325,-5392.13 3325,-5383.85"/>
<polygon fill="black" stroke="black" points="3328.5,-5383.74 3325,-5373.74 3321.5,-5383.74 3328.5,-5383.74"/>
</g>
<!-- ln1_layer_0 -->
<g id="node3" class="node">
<title>ln1_layer_0</title>
<polygon fill="#0080ff" stroke="black" points="2594,-5282.54 2310,-5282.54 2310,-5230.54 2594,-5230.54 2594,-5282.54"/>
<text text-anchor="middle" x="2452" y="-5270.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2452" y="-5259.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2452" y="-5248.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2452" y="-5237.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- embedding&#45;&gt;ln1_layer_0 -->
<g id="edge2" class="edge">
<title>embedding&#45;&gt;ln1_layer_0</title>
<path fill="none" stroke="black" d="M3182.79,-5332.04C3023.78,-5315.83 2767.24,-5289.68 2604.26,-5273.06"/>
<polygon fill="black" stroke="black" points="2604.45,-5269.56 2594.14,-5272.03 2603.74,-5276.53 2604.45,-5269.56"/>
</g>
<!-- residual1_layer_0 -->
<g id="node30" class="node">
<title>residual1_layer_0</title>
<polygon fill="#ffffcc" stroke="black" points="3674.82,-4746.54 3196.28,-4746.54 3073.18,-4642.54 3551.72,-4642.54 3674.82,-4746.54"/>
<text text-anchor="middle" x="3374" y="-4708.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="3374" y="-4697.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3374" y="-4686.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3374" y="-4675.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- embedding&#45;&gt;residual1_layer_0 -->
<g id="edge173" class="edge">
<title>embedding&#45;&gt;residual1_layer_0</title>
<path fill="none" stroke="black" d="M3467.21,-5344.92C3714.58,-5338.21 4198,-5306.21 4198,-5158.54 4198,-5158.54 4198,-5158.54 4198,-4921.54 4198,-4805.51 3890.29,-4746.89 3650.95,-4718.85"/>
<polygon fill="black" stroke="black" points="3651.01,-4715.33 3640.68,-4717.66 3650.21,-4722.29 3651.01,-4715.33"/>
</g>
<!-- qkv_layer_0_gpu_0 -->
<g id="node4" class="node">
<title>qkv_layer_0_gpu_0</title>
<polygon fill="#0080ff" stroke="black" points="716,-5194.54 420,-5194.54 420,-5120.54 716,-5120.54 716,-5194.54"/>
<text text-anchor="middle" x="568" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="568" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="568" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="568" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="568" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="568" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_0 -->
<g id="edge3" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_0</title>
<path fill="none" stroke="black" d="M2309.99,-5254C1957.75,-5249.63 1049.69,-5234.83 726.52,-5194.63"/>
<polygon fill="black" stroke="black" points="726.56,-5191.11 716.2,-5193.31 725.67,-5198.05 726.56,-5191.11"/>
</g>
<!-- qkv_layer_0_gpu_1 -->
<g id="node5" class="node">
<title>qkv_layer_0_gpu_1</title>
<polygon fill="#0f8aff" stroke="black" points="1030,-5194.54 734,-5194.54 734,-5120.54 1030,-5120.54 1030,-5194.54"/>
<text text-anchor="middle" x="882" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="882" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="882" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="882" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="882" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="882" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_1 -->
<g id="edge16" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_1</title>
<path fill="none" stroke="black" d="M2309.92,-5252.7C2006.06,-5246.09 1300.27,-5227.77 1040.38,-5194.61"/>
<polygon fill="black" stroke="black" points="1040.57,-5191.11 1030.2,-5193.28 1039.66,-5198.05 1040.57,-5191.11"/>
</g>
<!-- qkv_layer_0_gpu_2 -->
<g id="node6" class="node">
<title>qkv_layer_0_gpu_2</title>
<polygon fill="#1e94ff" stroke="black" points="1344,-5194.54 1048,-5194.54 1048,-5120.54 1344,-5120.54 1344,-5194.54"/>
<text text-anchor="middle" x="1196" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1196" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1196" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1196" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1196" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1196" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_2 -->
<g id="edge29" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_2</title>
<path fill="none" stroke="black" d="M2309.86,-5255.34C2101.67,-5253.33 1701.76,-5242.95 1354.22,-5194.63"/>
<polygon fill="black" stroke="black" points="1354.6,-5191.15 1344.21,-5193.23 1353.62,-5198.08 1354.6,-5191.15"/>
</g>
<!-- qkv_layer_0_gpu_3 -->
<g id="node7" class="node">
<title>qkv_layer_0_gpu_3</title>
<polygon fill="#2d9eff" stroke="black" points="1658,-5194.54 1362,-5194.54 1362,-5120.54 1658,-5120.54 1658,-5194.54"/>
<text text-anchor="middle" x="1510" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1510" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1510" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1510" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1510" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1510" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_3 -->
<g id="edge42" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_3</title>
<path fill="none" stroke="black" d="M2309.82,-5250.81C2154.33,-5244.2 1897.78,-5229.05 1668.43,-5194.69"/>
<polygon fill="black" stroke="black" points="1668.63,-5191.18 1658.22,-5193.14 1667.58,-5198.1 1668.63,-5191.18"/>
</g>
<!-- qkv_layer_0_gpu_4 -->
<g id="node8" class="node">
<title>qkv_layer_0_gpu_4</title>
<polygon fill="#3ca8ff" stroke="black" points="1972,-5194.54 1676,-5194.54 1676,-5120.54 1972,-5120.54 1972,-5194.54"/>
<text text-anchor="middle" x="1824" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1824" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1824" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1824" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1824" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1824" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_4 -->
<g id="edge55" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_4</title>
<path fill="none" stroke="black" d="M2309.76,-5240.74C2218.68,-5230.4 2097.84,-5215.08 1982.34,-5194.73"/>
<polygon fill="black" stroke="black" points="1982.71,-5191.24 1972.26,-5192.94 1981.49,-5198.13 1982.71,-5191.24"/>
</g>
<!-- qkv_layer_0_gpu_5 -->
<g id="node9" class="node">
<title>qkv_layer_0_gpu_5</title>
<polygon fill="#4bb2ff" stroke="black" points="2286,-5194.54 1990,-5194.54 1990,-5120.54 2286,-5120.54 2286,-5194.54"/>
<text text-anchor="middle" x="2138" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2138" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2138" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2138" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2138" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2138" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_5 -->
<g id="edge68" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_5</title>
<path fill="none" stroke="black" d="M2370.73,-5230.43C2338.28,-5220.41 2300.17,-5208.64 2264.28,-5197.55"/>
<polygon fill="black" stroke="black" points="2265.3,-5194.2 2254.72,-5194.59 2263.24,-5200.89 2265.3,-5194.2"/>
</g>
<!-- qkv_layer_0_gpu_6 -->
<g id="node10" class="node">
<title>qkv_layer_0_gpu_6</title>
<polygon fill="#5abcff" stroke="black" points="2600,-5194.54 2304,-5194.54 2304,-5120.54 2600,-5120.54 2600,-5194.54"/>
<text text-anchor="middle" x="2452" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2452" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2452" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2452" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2452" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2452" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_6 -->
<g id="edge81" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_6</title>
<path fill="none" stroke="black" d="M2452,-5230.31C2452,-5222.48 2452,-5213.59 2452,-5204.8"/>
<polygon fill="black" stroke="black" points="2455.5,-5204.6 2452,-5194.6 2448.5,-5204.6 2455.5,-5204.6"/>
</g>
<!-- qkv_layer_0_gpu_7 -->
<g id="node11" class="node">
<title>qkv_layer_0_gpu_7</title>
<polygon fill="#69c6ff" stroke="black" points="2914,-5194.54 2618,-5194.54 2618,-5120.54 2914,-5120.54 2914,-5194.54"/>
<text text-anchor="middle" x="2766" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2766" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2766" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2766" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2766" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2766" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_7 -->
<g id="edge94" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_7</title>
<path fill="none" stroke="black" d="M2533.27,-5230.43C2565.72,-5220.41 2603.83,-5208.64 2639.72,-5197.55"/>
<polygon fill="black" stroke="black" points="2640.76,-5200.89 2649.28,-5194.59 2638.7,-5194.2 2640.76,-5200.89"/>
</g>
<!-- qkv_layer_0_gpu_8 -->
<g id="node12" class="node">
<title>qkv_layer_0_gpu_8</title>
<polygon fill="#78d0ff" stroke="black" points="3228,-5194.54 2932,-5194.54 2932,-5120.54 3228,-5120.54 3228,-5194.54"/>
<text text-anchor="middle" x="3080" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3080" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3080" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3080" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3080" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3080" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_8 -->
<g id="edge107" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_8</title>
<path fill="none" stroke="black" d="M2594.24,-5240.74C2685.32,-5230.4 2806.16,-5215.08 2921.66,-5194.73"/>
<polygon fill="black" stroke="black" points="2922.51,-5198.13 2931.74,-5192.94 2921.29,-5191.24 2922.51,-5198.13"/>
</g>
<!-- qkv_layer_0_gpu_9 -->
<g id="node13" class="node">
<title>qkv_layer_0_gpu_9</title>
<polygon fill="#87daff" stroke="black" points="3542,-5194.54 3246,-5194.54 3246,-5120.54 3542,-5120.54 3542,-5194.54"/>
<text text-anchor="middle" x="3394" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3394" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3394" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3394" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3394" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3394" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_9 -->
<g id="edge120" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_9</title>
<path fill="none" stroke="black" d="M2594.18,-5250.81C2749.67,-5244.2 3006.22,-5229.05 3235.57,-5194.69"/>
<polygon fill="black" stroke="black" points="3236.42,-5198.1 3245.78,-5193.14 3235.37,-5191.18 3236.42,-5198.1"/>
</g>
<!-- qkv_layer_0_gpu_10 -->
<g id="node14" class="node">
<title>qkv_layer_0_gpu_10</title>
<polygon fill="#96e4ff" stroke="black" points="3856,-5194.54 3560,-5194.54 3560,-5120.54 3856,-5120.54 3856,-5194.54"/>
<text text-anchor="middle" x="3708" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3708" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3708" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3708" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3708" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3708" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_10 -->
<g id="edge133" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_10</title>
<path fill="none" stroke="black" d="M2594.14,-5255.34C2802.33,-5253.33 3202.24,-5242.95 3549.78,-5194.63"/>
<polygon fill="black" stroke="black" points="3550.38,-5198.08 3559.79,-5193.23 3549.4,-5191.15 3550.38,-5198.08"/>
</g>
<!-- qkv_layer_0_gpu_11 -->
<g id="node15" class="node">
<title>qkv_layer_0_gpu_11</title>
<polygon fill="#a5eeff" stroke="black" points="4170,-5194.54 3874,-5194.54 3874,-5120.54 4170,-5120.54 4170,-5194.54"/>
<text text-anchor="middle" x="4022" y="-5182.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4022" y="-5171.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4022" y="-5160.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4022" y="-5149.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4022" y="-5138.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4022" y="-5127.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- ln1_layer_0&#45;&gt;qkv_layer_0_gpu_11 -->
<g id="edge146" class="edge">
<title>ln1_layer_0&#45;&gt;qkv_layer_0_gpu_11</title>
<path fill="none" stroke="black" d="M2594.08,-5252.7C2897.94,-5246.09 3603.73,-5227.77 3863.62,-5194.61"/>
<polygon fill="black" stroke="black" points="3864.34,-5198.05 3873.8,-5193.28 3863.43,-5191.11 3864.34,-5198.05"/>
</g>
<!-- attention_layer_0_gpu_0 -->
<g id="node16" class="node">
<title>attention_layer_0_gpu_0</title>
<polygon fill="#0080ff" stroke="black" points="754.5,-5084.54 465.5,-5084.54 465.5,-5010.54 754.5,-5010.54 754.5,-5084.54"/>
<text text-anchor="middle" x="610" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="610" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="610" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="610" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="610" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="610" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge4" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="black" d="M582.1,-5120.28C585.32,-5111.99 588.79,-5103.09 592.14,-5094.46"/>
<polygon fill="black" stroke="black" points="595.5,-5095.48 595.86,-5084.89 588.98,-5092.94 595.5,-5095.48"/>
</g>
<!-- attention_layer_0_gpu_1 -->
<g id="node17" class="node">
<title>attention_layer_0_gpu_1</title>
<polygon fill="#0f8aff" stroke="black" points="1061.5,-5084.54 772.5,-5084.54 772.5,-5010.54 1061.5,-5010.54 1061.5,-5084.54"/>
<text text-anchor="middle" x="917" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="917" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="917" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="917" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="917" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="917" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge18" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M684.7,-5120.43C718.75,-5109.89 756.11,-5098.33 790.73,-5087.61"/>
<polygon fill="blue" stroke="blue" points="791.89,-5090.92 800.41,-5084.62 789.83,-5084.23 791.89,-5090.92"/>
</g>
<!-- attention_layer_0_gpu_2 -->
<g id="node18" class="node">
<title>attention_layer_0_gpu_2</title>
<polygon fill="#1e94ff" stroke="black" points="1368.5,-5084.54 1079.5,-5084.54 1079.5,-5010.54 1368.5,-5010.54 1368.5,-5084.54"/>
<text text-anchor="middle" x="1224" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1224" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1224" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1224" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1224" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1224" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge31" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M716.24,-5122.04C719.18,-5121.52 722.1,-5121.02 725,-5120.54 873.81,-5095.81 916.17,-5109.52 1069.18,-5084.59"/>
<polygon fill="blue" stroke="blue" points="1070.13,-5087.98 1079.43,-5082.89 1068.99,-5081.08 1070.13,-5087.98"/>
</g>
<!-- attention_layer_0_gpu_3 -->
<g id="node19" class="node">
<title>attention_layer_0_gpu_3</title>
<polygon fill="#2d9eff" stroke="black" points="1675.5,-5084.54 1386.5,-5084.54 1386.5,-5010.54 1675.5,-5010.54 1675.5,-5084.54"/>
<text text-anchor="middle" x="1531" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1531" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1531" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1531" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1531" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1531" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge44" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M716.21,-5121.85C719.16,-5121.39 722.09,-5120.95 725,-5120.54 1009.44,-5080.39 1088.46,-5124.92 1375.85,-5084.77"/>
<polygon fill="blue" stroke="blue" points="1376.76,-5088.17 1386.16,-5083.3 1375.77,-5081.24 1376.76,-5088.17"/>
</g>
<!-- attention_layer_0_gpu_4 -->
<g id="node20" class="node">
<title>attention_layer_0_gpu_4</title>
<polygon fill="#3ca8ff" stroke="black" points="1982.5,-5084.54 1693.5,-5084.54 1693.5,-5010.54 1982.5,-5010.54 1982.5,-5084.54"/>
<text text-anchor="middle" x="1838" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1838" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1838" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1838" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1838" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1838" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge57" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M716.2,-5121.78C719.15,-5121.34 722.09,-5120.92 725,-5120.54 1144.98,-5065.02 1260.08,-5140.51 1683.12,-5084.71"/>
<polygon fill="blue" stroke="blue" points="1683.72,-5088.16 1693.17,-5083.37 1682.8,-5081.22 1683.72,-5088.16"/>
</g>
<!-- attention_layer_0_gpu_5 -->
<g id="node21" class="node">
<title>attention_layer_0_gpu_5</title>
<polygon fill="#4bb2ff" stroke="black" points="2289.5,-5084.54 2000.5,-5084.54 2000.5,-5010.54 2289.5,-5010.54 2289.5,-5084.54"/>
<text text-anchor="middle" x="2145" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2145" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2145" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2145" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2145" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2145" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge70" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M716.19,-5121.74C719.15,-5121.31 722.09,-5120.91 725,-5120.54 1280.53,-5049.66 1431.63,-5156.16 1990.26,-5084.68"/>
<polygon fill="blue" stroke="blue" points="1990.71,-5088.15 2000.18,-5083.4 1989.81,-5081.21 1990.71,-5088.15"/>
</g>
<!-- attention_layer_0_gpu_6 -->
<g id="node22" class="node">
<title>attention_layer_0_gpu_6</title>
<polygon fill="#5abcff" stroke="black" points="2596.5,-5084.54 2307.5,-5084.54 2307.5,-5010.54 2596.5,-5010.54 2596.5,-5084.54"/>
<text text-anchor="middle" x="2452" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2452" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2452" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2452" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2452" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2452" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge83" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M716.19,-5121.72C719.15,-5121.3 722.09,-5120.9 725,-5120.54 1416.05,-5034.31 1603.12,-5171.83 2297.19,-5084.69"/>
<polygon fill="blue" stroke="blue" points="2297.7,-5088.15 2307.18,-5083.42 2296.82,-5081.21 2297.7,-5088.15"/>
</g>
<!-- attention_layer_0_gpu_7 -->
<g id="node23" class="node">
<title>attention_layer_0_gpu_7</title>
<polygon fill="#69c6ff" stroke="black" points="2903.5,-5084.54 2614.5,-5084.54 2614.5,-5010.54 2903.5,-5010.54 2903.5,-5084.54"/>
<text text-anchor="middle" x="2759" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2759" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2759" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2759" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2759" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2759" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge96" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M716.19,-5121.7C719.15,-5121.29 722.09,-5120.9 725,-5120.54 1551.57,-5018.97 1774.59,-5187.51 2604.09,-5084.7"/>
<polygon fill="blue" stroke="blue" points="2604.69,-5088.15 2614.18,-5083.44 2603.83,-5081.2 2604.69,-5088.15"/>
</g>
<!-- attention_layer_0_gpu_8 -->
<g id="node24" class="node">
<title>attention_layer_0_gpu_8</title>
<polygon fill="#78d0ff" stroke="black" points="3210.5,-5084.54 2921.5,-5084.54 2921.5,-5010.54 3210.5,-5010.54 3210.5,-5084.54"/>
<text text-anchor="middle" x="3066" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3066" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3066" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3066" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3066" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3066" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge109" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M716.19,-5121.69C719.15,-5121.28 722.09,-5120.89 725,-5120.54 1204.44,-5062.28 2413.75,-5143.45 2911.02,-5084.68"/>
<polygon fill="blue" stroke="blue" points="2911.68,-5088.12 2921.18,-5083.45 2910.83,-5081.18 2911.68,-5088.12"/>
</g>
<!-- attention_layer_0_gpu_9 -->
<g id="node25" class="node">
<title>attention_layer_0_gpu_9</title>
<polygon fill="#87daff" stroke="black" points="3517.5,-5084.54 3228.5,-5084.54 3228.5,-5010.54 3517.5,-5010.54 3517.5,-5084.54"/>
<text text-anchor="middle" x="3373" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3373" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3373" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3373" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3373" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3373" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge122" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M716.19,-5121.68C719.14,-5121.27 722.08,-5120.89 725,-5120.54 1272.16,-5054.61 2652.68,-5151.25 3217.86,-5084.7"/>
<polygon fill="blue" stroke="blue" points="3218.68,-5088.13 3228.18,-5083.45 3217.84,-5081.18 3218.68,-5088.13"/>
</g>
<!-- attention_layer_0_gpu_10 -->
<g id="node26" class="node">
<title>attention_layer_0_gpu_10</title>
<polygon fill="#96e4ff" stroke="black" points="3824.5,-5084.54 3535.5,-5084.54 3535.5,-5010.54 3824.5,-5010.54 3824.5,-5084.54"/>
<text text-anchor="middle" x="3680" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3680" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3680" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3680" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3680" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3680" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge135" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M716.19,-5121.68C719.14,-5121.27 722.08,-5120.89 725,-5120.54 1339.98,-5046.93 2892.12,-5159.09 3525.01,-5084.68"/>
<polygon fill="blue" stroke="blue" points="3525.67,-5088.13 3535.19,-5083.46 3524.84,-5081.18 3525.67,-5088.13"/>
</g>
<!-- attention_layer_0_gpu_11 -->
<g id="node27" class="node">
<title>attention_layer_0_gpu_11</title>
<polygon fill="#a5eeff" stroke="black" points="4131.5,-5084.54 3842.5,-5084.54 3842.5,-5010.54 4131.5,-5010.54 4131.5,-5084.54"/>
<text text-anchor="middle" x="3987" y="-5072.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3987" y="-5061.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3987" y="-5050.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3987" y="-5039.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3987" y="-5028.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3987" y="-5017.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge148" class="edge">
<title>qkv_layer_0_gpu_0&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M716.19,-5121.67C719.14,-5121.27 722.08,-5120.89 725,-5120.54 1407.82,-5039.25 3131.63,-5166.94 3832.2,-5084.66"/>
<polygon fill="blue" stroke="blue" points="3832.67,-5088.13 3842.19,-5083.46 3831.84,-5081.18 3832.67,-5088.13"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge5" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M791.05,-5120.43C765.19,-5110.16 736.88,-5098.92 710.49,-5088.44"/>
<polygon fill="blue" stroke="blue" points="711.45,-5085.06 700.86,-5084.62 708.87,-5091.56 711.45,-5085.06"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge17" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="black" d="M893.75,-5120.28C896.44,-5111.99 899.32,-5103.09 902.12,-5094.46"/>
<polygon fill="black" stroke="black" points="905.47,-5095.48 905.22,-5084.89 898.81,-5093.32 905.47,-5095.48"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge32" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M996.36,-5120.43C1029.58,-5109.93 1066.03,-5098.43 1099.83,-5087.75"/>
<polygon fill="blue" stroke="blue" points="1101.27,-5090.97 1109.75,-5084.62 1099.16,-5084.29 1101.27,-5090.97"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge45" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1030.24,-5122.05C1033.18,-5121.53 1036.1,-5121.02 1039,-5120.54 1185.23,-5096.1 1226.85,-5109.34 1376.14,-5084.78"/>
<polygon fill="blue" stroke="blue" points="1376.85,-5088.21 1386.13,-5083.11 1375.69,-5081.31 1376.85,-5088.21"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge58" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1030.21,-5121.85C1033.16,-5121.39 1036.09,-5120.95 1039,-5120.54 1320.38,-5080.73 1398.57,-5124.58 1682.96,-5084.75"/>
<polygon fill="blue" stroke="blue" points="1683.76,-5088.17 1693.16,-5083.3 1682.77,-5081.24 1683.76,-5088.17"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge71" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1030.2,-5121.78C1033.15,-5121.34 1036.09,-5120.92 1039,-5120.54 1455.91,-5065.36 1570.19,-5140.16 1990.19,-5084.7"/>
<polygon fill="blue" stroke="blue" points="1990.73,-5088.16 2000.17,-5083.37 1989.8,-5081.22 1990.73,-5088.16"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge84" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1030.19,-5121.74C1033.15,-5121.31 1036.09,-5120.91 1039,-5120.54 1591.33,-5050.02 1741.66,-5155.76 2296.9,-5084.73"/>
<polygon fill="blue" stroke="blue" points="2297.71,-5088.15 2307.18,-5083.4 2296.81,-5081.21 2297.71,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge97" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1030.19,-5121.72C1033.15,-5121.3 1036.09,-5120.9 1039,-5120.54 1726.97,-5034.66 1913.21,-5171.48 2604.23,-5084.68"/>
<polygon fill="blue" stroke="blue" points="2604.7,-5088.15 2614.18,-5083.42 2603.82,-5081.21 2604.7,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge110" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1030.19,-5121.7C1033.15,-5121.29 1036.09,-5120.9 1039,-5120.54 1862.49,-5019.32 2084.69,-5187.16 2911.12,-5084.69"/>
<polygon fill="blue" stroke="blue" points="2911.69,-5088.15 2921.18,-5083.44 2910.83,-5081.2 2911.69,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge123" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1030.19,-5121.69C1033.15,-5121.28 1036.09,-5120.89 1039,-5120.54 1516.9,-5062.45 2722.35,-5143.28 3218.05,-5084.68"/>
<polygon fill="blue" stroke="blue" points="3218.68,-5088.12 3228.18,-5083.45 3217.83,-5081.18 3218.68,-5088.12"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge136" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1030.19,-5121.69C1033.14,-5121.27 1036.08,-5120.89 1039,-5120.54 1584.62,-5054.78 2961.28,-5151.07 3524.89,-5084.69"/>
<polygon fill="blue" stroke="blue" points="3525.68,-5088.13 3535.18,-5083.45 3524.84,-5081.18 3525.68,-5088.13"/>
</g>
<!-- qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge149" class="edge">
<title>qkv_layer_0_gpu_1&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1030.19,-5121.68C1033.14,-5121.27 1036.08,-5120.89 1039,-5120.54 1652.45,-5047.1 3200.7,-5158.91 3832.04,-5084.68"/>
<polygon fill="blue" stroke="blue" points="3832.67,-5088.13 3842.19,-5083.46 3831.84,-5081.18 3832.67,-5088.13"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge6" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1047.74,-5122.15C1044.81,-5121.6 1041.89,-5121.06 1039,-5120.54 920.88,-5099.31 887.05,-5106.2 764.73,-5084.6"/>
<polygon fill="blue" stroke="blue" points="765.06,-5081.1 754.59,-5082.78 763.82,-5087.99 765.06,-5081.1"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge19" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1102.71,-5120.43C1076.07,-5110.11 1046.89,-5098.82 1019.72,-5088.3"/>
<polygon fill="blue" stroke="blue" points="1020.79,-5084.96 1010.2,-5084.62 1018.27,-5091.49 1020.79,-5084.96"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge30" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="black" d="M1205.4,-5120.28C1207.53,-5112.08 1209.81,-5103.28 1212.02,-5094.74"/>
<polygon fill="black" stroke="black" points="1215.45,-5095.45 1214.58,-5084.89 1208.68,-5093.69 1215.45,-5095.45"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge46" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1308.02,-5120.43C1340.56,-5109.93 1376.26,-5098.43 1409.37,-5087.75"/>
<polygon fill="blue" stroke="blue" points="1410.65,-5091.02 1419.09,-5084.62 1408.5,-5084.35 1410.65,-5091.02"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge59" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1344.24,-5122.06C1347.18,-5121.53 1350.1,-5121.03 1353,-5120.54 1496.08,-5096.46 1536.89,-5108.99 1682.9,-5084.83"/>
<polygon fill="blue" stroke="blue" points="1683.85,-5088.22 1693.13,-5083.1 1682.69,-5081.31 1683.85,-5088.22"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge72" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1344.21,-5121.85C1347.16,-5121.39 1350.09,-5120.95 1353,-5120.54 1631.33,-5081.08 1708.67,-5124.23 1990.07,-5084.74"/>
<polygon fill="blue" stroke="blue" points="1990.76,-5088.17 2000.16,-5083.3 1989.77,-5081.24 1990.76,-5088.17"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge85" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1344.2,-5121.78C1347.15,-5121.34 1350.09,-5120.92 1353,-5120.54 1766.74,-5065.72 1880.23,-5139.77 2296.96,-5084.73"/>
<polygon fill="blue" stroke="blue" points="2297.73,-5088.16 2307.17,-5083.36 2296.8,-5081.22 2297.73,-5088.16"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge98" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1344.19,-5121.74C1347.15,-5121.31 1350.09,-5120.91 1353,-5120.54 1902.25,-5050.37 2051.75,-5155.41 2603.96,-5084.72"/>
<polygon fill="blue" stroke="blue" points="2604.71,-5088.15 2614.18,-5083.4 2603.81,-5081.21 2604.71,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge111" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1344.19,-5121.72C1347.15,-5121.3 1350.09,-5120.9 1353,-5120.54 2037.81,-5035.02 2223.27,-5171.09 2911.02,-5084.71"/>
<polygon fill="blue" stroke="blue" points="2911.7,-5088.15 2921.18,-5083.42 2910.82,-5081.21 2911.7,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge124" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1344.19,-5121.7C1347.15,-5121.29 1350.09,-5120.9 1353,-5120.54 2173.41,-5019.67 2394.78,-5186.81 3218.16,-5084.69"/>
<polygon fill="blue" stroke="blue" points="3218.69,-5088.15 3228.18,-5083.43 3217.83,-5081.2 3218.69,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge137" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1344.19,-5121.69C1347.15,-5121.28 1350.09,-5120.89 1353,-5120.54 1829.37,-5062.63 3030.95,-5143.1 3525.08,-5084.67"/>
<polygon fill="blue" stroke="blue" points="3525.68,-5088.12 3535.18,-5083.44 3524.83,-5081.18 3525.68,-5088.12"/>
</g>
<!-- qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge150" class="edge">
<title>qkv_layer_0_gpu_2&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1344.19,-5121.69C1347.14,-5121.27 1350.08,-5120.89 1353,-5120.54 1897.09,-5054.96 3269.87,-5150.9 3831.92,-5084.69"/>
<polygon fill="blue" stroke="blue" points="3832.68,-5088.13 3842.18,-5083.45 3831.84,-5081.18 3832.68,-5088.13"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge7" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1361.79,-5121.87C1358.84,-5121.4 1355.91,-5120.96 1353,-5120.54 1096.71,-5083.58 1025.31,-5121.54 764.69,-5084.54"/>
<polygon fill="blue" stroke="blue" points="764.94,-5081.04 754.55,-5083.08 763.94,-5087.97 764.94,-5081.04"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge20" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1361.75,-5122.14C1358.81,-5121.59 1355.89,-5121.05 1353,-5120.54 1231.76,-5098.95 1197.09,-5106.53 1071.59,-5084.57"/>
<polygon fill="blue" stroke="blue" points="1072.05,-5081.1 1061.59,-5082.8 1070.82,-5087.99 1072.05,-5081.1"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge33" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1414.37,-5120.43C1386.94,-5110.07 1356.89,-5098.72 1328.94,-5088.16"/>
<polygon fill="blue" stroke="blue" points="1330.13,-5084.88 1319.54,-5084.62 1327.66,-5091.42 1330.13,-5084.88"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge43" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="black" d="M1517.05,-5120.28C1518.64,-5112.08 1520.36,-5103.28 1522.02,-5094.74"/>
<polygon fill="black" stroke="black" points="1525.46,-5095.37 1523.93,-5084.89 1518.59,-5094.04 1525.46,-5095.37"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge60" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1619.68,-5120.43C1651.54,-5109.93 1686.49,-5098.43 1718.91,-5087.75"/>
<polygon fill="blue" stroke="blue" points="1720.02,-5091.07 1728.43,-5084.62 1717.84,-5084.42 1720.02,-5091.07"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge73" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1658.24,-5122.07C1661.18,-5121.54 1664.11,-5121.03 1667,-5120.54 1807.07,-5096.8 1847,-5108.66 1990.1,-5084.8"/>
<polygon fill="blue" stroke="blue" points="1990.86,-5088.22 2000.13,-5083.09 1989.69,-5081.32 1990.86,-5088.22"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge86" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1658.21,-5121.86C1661.16,-5121.39 1664.09,-5120.95 1667,-5120.54 1942.28,-5081.42 2018.78,-5123.89 2297.17,-5084.72"/>
<polygon fill="blue" stroke="blue" points="2297.76,-5088.17 2307.16,-5083.29 2296.77,-5081.24 2297.76,-5088.17"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge99" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1658.2,-5121.78C1661.15,-5121.34 1664.09,-5120.93 1667,-5120.54 2077.68,-5066.07 2190.33,-5139.43 2604.03,-5084.72"/>
<polygon fill="blue" stroke="blue" points="2604.73,-5088.16 2614.17,-5083.36 2603.8,-5081.22 2604.73,-5088.16"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge112" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1658.19,-5121.74C1661.15,-5121.31 1664.09,-5120.91 1667,-5120.54 2213.18,-5050.72 2361.85,-5155.06 2911.01,-5084.71"/>
<polygon fill="blue" stroke="blue" points="2911.71,-5088.15 2921.18,-5083.4 2910.81,-5081.21 2911.71,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge125" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1658.19,-5121.72C1661.15,-5121.3 1664.09,-5120.9 1667,-5120.54 2348.74,-5035.37 2533.36,-5170.74 3218.07,-5084.7"/>
<polygon fill="blue" stroke="blue" points="3218.7,-5088.15 3228.18,-5083.42 3217.82,-5081.21 3218.7,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge138" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1658.19,-5121.7C1661.15,-5121.29 1664.09,-5120.9 1667,-5120.54 2484.33,-5020.01 2704.88,-5186.45 3525.2,-5084.68"/>
<polygon fill="blue" stroke="blue" points="3525.69,-5088.15 3535.18,-5083.43 3524.83,-5081.2 3525.69,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge151" class="edge">
<title>qkv_layer_0_gpu_3&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1658.19,-5121.69C1661.15,-5121.28 1664.09,-5120.89 1667,-5120.54 2141.83,-5062.8 3339.55,-5142.93 3832.11,-5084.67"/>
<polygon fill="blue" stroke="blue" points="3832.68,-5088.12 3842.18,-5083.44 3831.83,-5081.18 3832.68,-5088.12"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge8" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1675.8,-5121.79C1672.85,-5121.34 1669.91,-5120.93 1667,-5120.54 1272.18,-5067.87 1163.81,-5137.32 764.62,-5084.52"/>
<polygon fill="blue" stroke="blue" points="764.91,-5081.03 754.53,-5083.17 763.98,-5087.96 764.91,-5081.03"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge21" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1675.79,-5121.87C1672.84,-5121.4 1669.91,-5120.96 1667,-5120.54 1407.67,-5083.24 1335.41,-5121.87 1071.81,-5084.56"/>
<polygon fill="blue" stroke="blue" points="1071.94,-5081.04 1061.55,-5083.08 1070.94,-5087.97 1071.94,-5081.04"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge34" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1675.75,-5122.12C1672.81,-5121.58 1669.89,-5121.05 1667,-5120.54 1542.77,-5098.62 1507.21,-5106.85 1378.82,-5084.61"/>
<polygon fill="blue" stroke="blue" points="1379.05,-5081.1 1368.59,-5082.81 1377.83,-5087.99 1379.05,-5081.1"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge47" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1726.03,-5120.43C1697.93,-5110.07 1667.14,-5098.72 1638.5,-5088.16"/>
<polygon fill="blue" stroke="blue" points="1639.47,-5084.79 1628.88,-5084.62 1637.05,-5091.36 1639.47,-5084.79"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge56" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="black" d="M1828.7,-5120.28C1829.75,-5112.17 1830.88,-5103.47 1831.97,-5095.02"/>
<polygon fill="black" stroke="black" points="1835.47,-5095.26 1833.29,-5084.89 1828.53,-5094.36 1835.47,-5095.26"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge74" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1931.33,-5120.43C1962.39,-5109.98 1996.43,-5098.52 2028.04,-5087.89"/>
<polygon fill="blue" stroke="blue" points="2029.4,-5091.12 2037.77,-5084.62 2027.17,-5084.49 2029.4,-5091.12"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge87" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1972.24,-5122.08C1975.18,-5121.55 1978.11,-5121.03 1981,-5120.54 2117.92,-5097.17 2157.04,-5108.32 2296.88,-5084.84"/>
<polygon fill="blue" stroke="blue" points="2297.86,-5088.22 2307.13,-5083.09 2296.68,-5081.32 2297.86,-5088.22"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge100" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1972.21,-5121.86C1975.16,-5121.39 1978.09,-5120.95 1981,-5120.54 2253.1,-5081.79 2328.81,-5123.51 2603.87,-5084.77"/>
<polygon fill="blue" stroke="blue" points="2604.76,-5088.17 2614.16,-5083.29 2603.77,-5081.24 2604.76,-5088.17"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge113" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1972.2,-5121.78C1975.15,-5121.34 1978.09,-5120.93 1981,-5120.54 2388.61,-5066.42 2500.44,-5139.08 2911.11,-5084.71"/>
<polygon fill="blue" stroke="blue" points="2911.73,-5088.16 2921.17,-5083.36 2910.8,-5081.22 2911.73,-5088.16"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge126" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1972.19,-5121.74C1975.15,-5121.31 1978.09,-5120.91 1981,-5120.54 2524.11,-5051.07 2671.95,-5154.71 3218.07,-5084.71"/>
<polygon fill="blue" stroke="blue" points="3218.71,-5088.15 3228.18,-5083.4 3217.81,-5081.21 3218.71,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge139" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1972.19,-5121.72C1975.15,-5121.3 1978.09,-5120.9 1981,-5120.54 2659.66,-5035.72 2843.46,-5170.39 3525.11,-5084.7"/>
<polygon fill="blue" stroke="blue" points="3525.7,-5088.15 3535.18,-5083.42 3524.82,-5081.21 3525.7,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge152" class="edge">
<title>qkv_layer_0_gpu_4&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1972.19,-5121.71C1975.15,-5121.29 1978.09,-5120.9 1981,-5120.54 2795.25,-5020.36 3014.97,-5186.1 3832.24,-5084.68"/>
<polygon fill="blue" stroke="blue" points="3832.69,-5088.15 3842.18,-5083.43 3831.83,-5081.2 3832.69,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge9" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1989.81,-5121.75C1986.85,-5121.32 1983.91,-5120.91 1981,-5120.54 1447.54,-5052.16 1302.36,-5153.23 764.48,-5084.5"/>
<polygon fill="blue" stroke="blue" points="764.89,-5081.02 754.53,-5083.21 764,-5087.96 764.89,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge22" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1989.8,-5121.79C1986.85,-5121.34 1983.91,-5120.93 1981,-5120.54 1583.12,-5067.52 1473.91,-5137.67 1071.69,-5084.53"/>
<polygon fill="blue" stroke="blue" points="1071.91,-5081.03 1061.53,-5083.17 1070.98,-5087.96 1071.91,-5081.03"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge35" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1989.79,-5121.87C1986.84,-5121.4 1983.91,-5120.96 1981,-5120.54 1718.49,-5082.87 1645.45,-5122.25 1378.53,-5084.52"/>
<polygon fill="blue" stroke="blue" points="1378.94,-5081.04 1368.55,-5083.08 1377.95,-5087.97 1378.94,-5081.04"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge48" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1989.75,-5122.11C1986.81,-5121.57 1983.89,-5121.05 1981,-5120.54 1853.65,-5098.26 1817.26,-5107.19 1685.65,-5084.58"/>
<polygon fill="blue" stroke="blue" points="1686.04,-5081.09 1675.59,-5082.82 1684.84,-5087.99 1686.04,-5081.09"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge61" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2037.69,-5120.43C2008.79,-5110.02 1977.12,-5098.62 1947.69,-5088.03"/>
<polygon fill="blue" stroke="blue" points="1948.81,-5084.71 1938.22,-5084.62 1946.44,-5091.3 1948.81,-5084.71"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge69" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="black" d="M2140.35,-5120.28C2140.88,-5112.17 2141.44,-5103.47 2141.99,-5095.02"/>
<polygon fill="black" stroke="black" points="2145.49,-5095.1 2142.64,-5084.89 2138.5,-5094.64 2145.49,-5095.1"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge88" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2242.99,-5120.43C2273.37,-5109.98 2306.67,-5098.52 2337.59,-5087.89"/>
<polygon fill="blue" stroke="blue" points="2338.79,-5091.18 2347.1,-5084.62 2336.51,-5084.56 2338.79,-5091.18"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge101" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2286.25,-5122.09C2289.19,-5121.55 2292.11,-5121.04 2295,-5120.54 2428.92,-5097.51 2467.16,-5107.99 2604.1,-5084.8"/>
<polygon fill="blue" stroke="blue" points="2604.87,-5088.22 2614.13,-5083.08 2603.68,-5081.32 2604.87,-5088.22"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge114" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2286.21,-5121.86C2289.16,-5121.4 2292.09,-5120.95 2295,-5120.54 2564.05,-5082.13 2638.92,-5123.17 2910.98,-5084.75"/>
<polygon fill="blue" stroke="blue" points="2911.76,-5088.17 2921.16,-5083.29 2910.77,-5081.25 2911.76,-5088.17"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge127" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2286.2,-5121.78C2289.15,-5121.34 2292.09,-5120.93 2295,-5120.54 2699.55,-5066.76 2810.54,-5138.73 3218.18,-5084.7"/>
<polygon fill="blue" stroke="blue" points="3218.73,-5088.16 3228.17,-5083.36 3217.8,-5081.22 3218.73,-5088.16"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge140" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2286.19,-5121.74C2289.15,-5121.31 2292.09,-5120.91 2295,-5120.54 2835.04,-5051.41 2982.05,-5154.36 3525.13,-5084.7"/>
<polygon fill="blue" stroke="blue" points="3525.71,-5088.15 3535.18,-5083.4 3524.81,-5081.21 3525.71,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge153" class="edge">
<title>qkv_layer_0_gpu_5&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2286.19,-5121.72C2289.15,-5121.3 2292.09,-5120.9 2295,-5120.54 2970.59,-5036.06 3153.56,-5170.04 3832.16,-5084.69"/>
<polygon fill="blue" stroke="blue" points="3832.7,-5088.15 3842.18,-5083.42 3831.82,-5081.21 3832.7,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge10" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2303.81,-5121.72C2300.85,-5121.3 2297.91,-5120.9 2295,-5120.54 1622.93,-5036.46 1440.96,-5169.15 764.52,-5084.5"/>
<polygon fill="blue" stroke="blue" points="764.88,-5081.02 754.52,-5083.24 764.01,-5087.96 764.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge23" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2303.81,-5121.75C2300.85,-5121.32 2297.91,-5120.91 2295,-5120.54 1758.47,-5051.81 1612.46,-5153.58 1071.54,-5084.5"/>
<polygon fill="blue" stroke="blue" points="1071.89,-5081.02 1061.53,-5083.21 1071,-5087.96 1071.89,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge36" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2303.8,-5121.78C2300.85,-5121.34 2297.91,-5120.93 2295,-5120.54 1893.95,-5067.16 1783.96,-5138.05 1378.47,-5084.5"/>
<polygon fill="blue" stroke="blue" points="1378.91,-5081.03 1368.53,-5083.17 1377.98,-5087.96 1378.91,-5081.03"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge49" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2303.79,-5121.86C2300.84,-5121.4 2297.91,-5120.96 2295,-5120.54 2029.44,-5082.53 1955.56,-5122.59 1685.64,-5084.53"/>
<polygon fill="blue" stroke="blue" points="1685.94,-5081.04 1675.54,-5083.09 1684.95,-5087.97 1685.94,-5081.04"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge62" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2303.75,-5122.1C2300.81,-5121.56 2297.89,-5121.04 2295,-5120.54 2164.51,-5097.89 2127.3,-5107.53 1992.46,-5084.54"/>
<polygon fill="blue" stroke="blue" points="1993.04,-5081.09 1982.59,-5082.83 1991.84,-5087.99 1993.04,-5081.09"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge75" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2349.35,-5120.43C2319.78,-5110.02 2287.37,-5098.62 2257.25,-5088.03"/>
<polygon fill="blue" stroke="blue" points="2258.15,-5084.63 2247.56,-5084.62 2255.83,-5091.24 2258.15,-5084.63"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge82" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="black" d="M2452,-5120.28C2452,-5112.17 2452,-5103.47 2452,-5095.02"/>
<polygon fill="black" stroke="black" points="2455.5,-5094.89 2452,-5084.89 2448.5,-5094.89 2455.5,-5094.89"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge102" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2554.65,-5120.43C2584.22,-5110.02 2616.63,-5098.62 2646.75,-5088.03"/>
<polygon fill="blue" stroke="blue" points="2648.17,-5091.24 2656.44,-5084.62 2645.85,-5084.63 2648.17,-5091.24"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge115" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2600.25,-5122.1C2603.19,-5121.56 2606.11,-5121.04 2609,-5120.54 2739.78,-5097.87 2777.2,-5107.65 2910.9,-5084.84"/>
<polygon fill="blue" stroke="blue" points="2911.87,-5088.23 2921.13,-5083.07 2910.68,-5081.33 2911.87,-5088.23"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge128" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2600.21,-5121.86C2603.16,-5121.4 2606.09,-5120.96 2609,-5120.54 2875,-5082.48 2949.03,-5122.83 3218.1,-5084.74"/>
<polygon fill="blue" stroke="blue" points="3218.76,-5088.18 3228.16,-5083.29 3217.77,-5081.25 3218.76,-5088.18"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge141" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2600.2,-5121.78C2603.15,-5121.34 2606.09,-5120.93 2609,-5120.54 3010.48,-5067.11 3120.64,-5138.39 3525.25,-5084.69"/>
<polygon fill="blue" stroke="blue" points="3525.73,-5088.16 3535.17,-5083.36 3524.8,-5081.22 3525.73,-5088.16"/>
</g>
<!-- qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge154" class="edge">
<title>qkv_layer_0_gpu_6&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2600.19,-5121.75C2603.15,-5121.32 2606.09,-5120.91 2609,-5120.54 3145.97,-5051.76 3292.15,-5154.01 3832.18,-5084.69"/>
<polygon fill="blue" stroke="blue" points="3832.71,-5088.15 3842.18,-5083.4 3831.81,-5081.21 3832.71,-5088.15"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge11" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2617.81,-5121.71C2614.85,-5121.29 2611.91,-5120.9 2609,-5120.54 1798.36,-5020.77 1579.61,-5185.07 764.74,-5084.53"/>
<polygon fill="blue" stroke="blue" points="764.88,-5081.02 754.52,-5083.25 764.01,-5087.96 764.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge24" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2617.81,-5121.72C2614.85,-5121.3 2611.91,-5120.9 2609,-5120.54 1933.85,-5036.11 1751.06,-5169.5 1071.56,-5084.5"/>
<polygon fill="blue" stroke="blue" points="1071.88,-5081.02 1061.52,-5083.24 1071.01,-5087.96 1071.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge37" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2617.81,-5121.74C2614.85,-5121.31 2611.91,-5120.91 2609,-5120.54 2069.4,-5051.46 1922.55,-5153.92 1378.59,-5084.51"/>
<polygon fill="blue" stroke="blue" points="1378.89,-5081.02 1368.53,-5083.21 1378,-5087.96 1378.89,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge50" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2617.8,-5121.78C2614.85,-5121.34 2611.91,-5120.93 2609,-5120.54 2204.89,-5066.81 2094.06,-5138.39 1685.55,-5084.51"/>
<polygon fill="blue" stroke="blue" points="1685.91,-5081.03 1675.53,-5083.17 1684.98,-5087.96 1685.91,-5081.03"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge63" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2617.79,-5121.86C2614.84,-5121.4 2611.91,-5120.95 2609,-5120.54 2340.39,-5082.18 2265.66,-5122.93 1992.75,-5084.55"/>
<polygon fill="blue" stroke="blue" points="1992.94,-5081.04 1982.54,-5083.09 1991.95,-5087.97 1992.94,-5081.04"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge76" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2617.75,-5122.09C2614.81,-5121.56 2611.89,-5121.04 2609,-5120.54 2475.51,-5097.56 2437.42,-5107.85 2299.68,-5084.58"/>
<polygon fill="blue" stroke="blue" points="2300.03,-5081.09 2289.58,-5082.84 2298.85,-5087.99 2300.03,-5081.09"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge89" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2661.01,-5120.43C2630.63,-5109.98 2597.33,-5098.52 2566.41,-5087.89"/>
<polygon fill="blue" stroke="blue" points="2567.49,-5084.56 2556.9,-5084.62 2565.21,-5091.18 2567.49,-5084.56"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge95" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="black" d="M2763.65,-5120.28C2763.12,-5112.17 2762.56,-5103.47 2762.01,-5095.02"/>
<polygon fill="black" stroke="black" points="2765.5,-5094.64 2761.36,-5084.89 2758.51,-5095.1 2765.5,-5094.64"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge116" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2866.31,-5120.43C2895.21,-5110.02 2926.88,-5098.62 2956.31,-5088.03"/>
<polygon fill="blue" stroke="blue" points="2957.56,-5091.3 2965.78,-5084.62 2955.19,-5084.71 2957.56,-5091.3"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge129" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2914.25,-5122.11C2917.19,-5121.57 2920.11,-5121.04 2923,-5120.54 3050.78,-5098.21 3087.31,-5107.33 3218.12,-5084.81"/>
<polygon fill="blue" stroke="blue" points="3218.88,-5088.23 3228.12,-5083.06 3217.67,-5081.33 3218.88,-5088.23"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge142" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2914.21,-5121.87C2917.16,-5121.4 2920.09,-5120.96 2923,-5120.54 3185.95,-5082.82 3259.13,-5122.49 3525.21,-5084.72"/>
<polygon fill="blue" stroke="blue" points="3525.76,-5088.18 3535.16,-5083.28 3524.76,-5081.25 3525.76,-5088.18"/>
</g>
<!-- qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge155" class="edge">
<title>qkv_layer_0_gpu_7&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2914.2,-5121.79C2917.15,-5121.34 2920.09,-5120.93 2923,-5120.54 3321.32,-5067.47 3430.69,-5138 3832.03,-5084.72"/>
<polygon fill="blue" stroke="blue" points="3832.73,-5088.16 3842.17,-5083.36 3831.79,-5081.22 3832.73,-5088.16"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge12" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2931.81,-5121.69C2928.85,-5121.28 2925.91,-5120.89 2923,-5120.54 2449.92,-5063 1256.67,-5142.39 764.58,-5084.48"/>
<polygon fill="blue" stroke="blue" points="764.87,-5080.99 754.52,-5083.27 764.03,-5087.94 764.87,-5080.99"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge25" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2931.81,-5121.71C2928.85,-5121.29 2925.91,-5120.9 2923,-5120.54 2109.19,-5020.41 1889.66,-5185.46 1071.48,-5084.49"/>
<polygon fill="blue" stroke="blue" points="1071.88,-5081.02 1061.52,-5083.25 1071.01,-5087.96 1071.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge38" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2931.81,-5121.72C2928.85,-5121.3 2925.91,-5120.9 2923,-5120.54 2244.78,-5035.76 2061.16,-5169.85 1378.61,-5084.51"/>
<polygon fill="blue" stroke="blue" points="1378.88,-5081.02 1368.52,-5083.24 1378.01,-5087.96 1378.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge51" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2931.81,-5121.74C2928.85,-5121.31 2925.91,-5120.91 2923,-5120.54 2380.33,-5051.12 2232.65,-5154.27 1685.65,-5084.52"/>
<polygon fill="blue" stroke="blue" points="1685.89,-5081.02 1675.53,-5083.21 1685,-5087.96 1685.89,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge64" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2931.8,-5121.78C2928.85,-5121.34 2925.91,-5120.93 2923,-5120.54 2515.82,-5066.47 2404.16,-5138.74 1992.62,-5084.52"/>
<polygon fill="blue" stroke="blue" points="1992.91,-5081.03 1982.53,-5083.17 1991.98,-5087.96 1992.91,-5081.03"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge77" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2931.79,-5121.86C2928.84,-5121.39 2925.91,-5120.95 2923,-5120.54 2651.21,-5081.82 2575.7,-5123.31 2299.46,-5084.51"/>
<polygon fill="blue" stroke="blue" points="2299.94,-5081.04 2289.54,-5083.09 2298.95,-5087.97 2299.94,-5081.04"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge90" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2931.76,-5122.08C2928.82,-5121.55 2925.89,-5121.03 2923,-5120.54 2786.37,-5097.19 2747.45,-5108.19 2606.46,-5084.54"/>
<polygon fill="blue" stroke="blue" points="2607.03,-5081.09 2596.58,-5082.85 2605.85,-5087.99 2607.03,-5081.09"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge103" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2972.67,-5120.43C2941.61,-5109.98 2907.57,-5098.52 2875.96,-5087.89"/>
<polygon fill="blue" stroke="blue" points="2876.83,-5084.49 2866.23,-5084.62 2874.6,-5091.12 2876.83,-5084.49"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge108" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="black" d="M3075.3,-5120.28C3074.25,-5112.17 3073.12,-5103.47 3072.03,-5095.02"/>
<polygon fill="black" stroke="black" points="3075.47,-5094.36 3070.71,-5084.89 3068.53,-5095.26 3075.47,-5094.36"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge130" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3177.97,-5120.43C3206.07,-5110.07 3236.86,-5098.72 3265.5,-5088.16"/>
<polygon fill="blue" stroke="blue" points="3266.95,-5091.36 3275.12,-5084.62 3264.53,-5084.79 3266.95,-5091.36"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge143" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3228.25,-5122.12C3231.19,-5121.58 3234.11,-5121.05 3237,-5120.54 3361.66,-5098.57 3397.36,-5106.99 3524.96,-5084.84"/>
<polygon fill="blue" stroke="blue" points="3525.88,-5088.23 3535.12,-5083.05 3524.67,-5081.34 3525.88,-5088.23"/>
</g>
<!-- qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge156" class="edge">
<title>qkv_layer_0_gpu_8&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3228.21,-5121.87C3231.16,-5121.4 3234.09,-5120.96 3237,-5120.54 3496.77,-5083.19 3569.17,-5122.11 3831.93,-5084.76"/>
<polygon fill="blue" stroke="blue" points="3832.76,-5088.18 3842.16,-5083.28 3831.76,-5081.25 3832.76,-5088.18"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge13" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3245.81,-5121.69C3242.86,-5121.27 3239.92,-5120.89 3237,-5120.54 2694.67,-5055.16 1326.36,-5150.31 764.77,-5084.51"/>
<polygon fill="blue" stroke="blue" points="764.87,-5080.99 754.52,-5083.28 764.03,-5087.94 764.87,-5080.99"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge26" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3245.81,-5121.69C3242.85,-5121.28 3239.91,-5120.89 3237,-5120.54 2762.39,-5062.82 1565.27,-5142.56 1071.61,-5084.49"/>
<polygon fill="blue" stroke="blue" points="1071.87,-5080.99 1061.52,-5083.27 1071.03,-5087.94 1071.87,-5080.99"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge39" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3245.81,-5121.7C3242.85,-5121.29 3239.91,-5120.9 3237,-5120.54 2420.11,-5020.06 2199.75,-5185.81 1378.52,-5084.5"/>
<polygon fill="blue" stroke="blue" points="1378.88,-5081.02 1368.52,-5083.25 1378.01,-5087.96 1378.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge52" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3245.81,-5121.72C3242.85,-5121.3 3239.91,-5120.9 3237,-5120.54 2555.7,-5035.42 2371.26,-5170.2 1685.65,-5084.52"/>
<polygon fill="blue" stroke="blue" points="1685.88,-5081.02 1675.52,-5083.24 1685.01,-5087.96 1685.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge65" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3245.81,-5121.74C3242.85,-5121.31 3239.91,-5120.91 3237,-5120.54 2691.26,-5050.77 2542.75,-5154.62 1992.71,-5084.52"/>
<polygon fill="blue" stroke="blue" points="1992.89,-5081.02 1982.53,-5083.21 1992,-5087.96 1992.89,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge78" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3245.8,-5121.78C3242.85,-5121.34 3239.91,-5120.93 3237,-5120.54 2826.76,-5066.12 2714.26,-5139.08 2299.69,-5084.53"/>
<polygon fill="blue" stroke="blue" points="2299.91,-5081.03 2289.53,-5083.17 2298.98,-5087.96 2299.91,-5081.03"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge91" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3245.79,-5121.86C3242.84,-5121.39 3239.91,-5120.95 3237,-5120.54 2962.15,-5081.47 2885.8,-5123.65 2606.56,-5084.52"/>
<polygon fill="blue" stroke="blue" points="2606.94,-5081.04 2596.54,-5083.09 2605.95,-5087.97 2606.94,-5081.04"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge104" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3245.76,-5122.07C3242.82,-5121.54 3239.89,-5121.03 3237,-5120.54 3097.36,-5096.85 3057.57,-5108.52 2913.67,-5084.57"/>
<polygon fill="blue" stroke="blue" points="2914.02,-5081.08 2903.58,-5082.86 2912.86,-5087.98 2914.02,-5081.08"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge117" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3284.32,-5120.43C3252.46,-5109.93 3217.51,-5098.43 3185.09,-5087.75"/>
<polygon fill="blue" stroke="blue" points="3186.16,-5084.42 3175.57,-5084.62 3183.98,-5091.07 3186.16,-5084.42"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge121" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="black" d="M3386.95,-5120.28C3385.36,-5112.08 3383.64,-5103.28 3381.98,-5094.74"/>
<polygon fill="black" stroke="black" points="3385.41,-5094.04 3380.07,-5084.89 3378.54,-5095.37 3385.41,-5094.04"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge144" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3489.63,-5120.43C3517.06,-5110.07 3547.11,-5098.72 3575.06,-5088.16"/>
<polygon fill="blue" stroke="blue" points="3576.34,-5091.42 3584.46,-5084.62 3573.87,-5084.88 3576.34,-5091.42"/>
</g>
<!-- qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge157" class="edge">
<title>qkv_layer_0_gpu_9&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3542.25,-5122.13C3545.19,-5121.59 3548.11,-5121.05 3551,-5120.54 3672.66,-5098.91 3707.48,-5106.67 3832.19,-5084.8"/>
<polygon fill="blue" stroke="blue" points="3832.89,-5088.23 3842.12,-5083.03 3831.66,-5081.34 3832.89,-5088.23"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge14" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3559.81,-5121.68C3556.86,-5121.27 3553.92,-5120.89 3551,-5120.54 2939.31,-5047.3 1395.54,-5158.27 764.66,-5084.49"/>
<polygon fill="blue" stroke="blue" points="764.86,-5080.99 754.52,-5083.28 764.03,-5087.94 764.86,-5080.99"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge27" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3559.81,-5121.69C3556.86,-5121.27 3553.92,-5120.89 3551,-5120.54 3007.13,-5054.98 1634.95,-5150.48 1071.8,-5084.51"/>
<polygon fill="blue" stroke="blue" points="1071.86,-5080.99 1061.52,-5083.28 1071.03,-5087.94 1071.86,-5080.99"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge40" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3559.81,-5121.69C3556.85,-5121.28 3553.91,-5120.89 3551,-5120.54 3074.85,-5062.65 1873.87,-5142.73 1378.65,-5084.49"/>
<polygon fill="blue" stroke="blue" points="1378.87,-5080.99 1368.52,-5083.27 1378.03,-5087.94 1378.87,-5080.99"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge53" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3559.81,-5121.7C3556.85,-5121.29 3553.91,-5120.9 3551,-5120.54 2731.03,-5019.71 2509.85,-5186.17 1685.55,-5084.5"/>
<polygon fill="blue" stroke="blue" points="1685.88,-5081.02 1675.52,-5083.25 1685.01,-5087.96 1685.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge66" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3559.81,-5121.72C3556.85,-5121.3 3553.91,-5120.9 3551,-5120.54 2866.63,-5035.07 2681.35,-5170.55 1992.7,-5084.52"/>
<polygon fill="blue" stroke="blue" points="1992.88,-5081.02 1982.52,-5083.24 1992.01,-5087.96 1992.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge79" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3559.81,-5121.74C3556.85,-5121.31 3553.91,-5120.91 3551,-5120.54 3002.18,-5050.42 2852.85,-5154.97 2299.76,-5084.53"/>
<polygon fill="blue" stroke="blue" points="2299.89,-5081.02 2289.53,-5083.21 2299,-5087.96 2299.89,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge92" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3559.8,-5121.78C3556.85,-5121.34 3553.91,-5120.92 3551,-5120.54 3137.59,-5065.76 3024.31,-5139.46 2606.46,-5084.5"/>
<polygon fill="blue" stroke="blue" points="2606.91,-5081.03 2596.53,-5083.17 2605.98,-5087.96 2606.91,-5081.03"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge105" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3559.79,-5121.85C3556.84,-5121.39 3553.91,-5120.95 3551,-5120.54 3273.1,-5081.13 3195.91,-5123.99 2913.67,-5084.53"/>
<polygon fill="blue" stroke="blue" points="2913.94,-5081.04 2903.54,-5083.1 2912.95,-5087.97 2913.94,-5081.04"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge118" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3559.76,-5122.06C3556.82,-5121.54 3553.9,-5121.03 3551,-5120.54 3408.35,-5096.51 3367.69,-5108.84 3220.87,-5084.6"/>
<polygon fill="blue" stroke="blue" points="3221.02,-5081.08 3210.58,-5082.87 3219.86,-5087.98 3221.02,-5081.08"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge131" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3595.98,-5120.43C3563.44,-5109.93 3527.74,-5098.43 3494.63,-5087.75"/>
<polygon fill="blue" stroke="blue" points="3495.5,-5084.35 3484.91,-5084.62 3493.35,-5091.02 3495.5,-5084.35"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge134" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="black" d="M3698.6,-5120.28C3696.47,-5112.08 3694.19,-5103.28 3691.98,-5094.74"/>
<polygon fill="black" stroke="black" points="3695.32,-5093.69 3689.42,-5084.89 3688.55,-5095.45 3695.32,-5093.69"/>
</g>
<!-- qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge158" class="edge">
<title>qkv_layer_0_gpu_10&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3801.29,-5120.43C3827.93,-5110.11 3857.11,-5098.82 3884.28,-5088.3"/>
<polygon fill="blue" stroke="blue" points="3885.73,-5091.49 3893.8,-5084.62 3883.21,-5084.96 3885.73,-5091.49"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_0 -->
<g id="edge15" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3873.81,-5121.67C3870.86,-5121.27 3867.92,-5120.89 3865,-5120.54 3183.93,-5039.45 1464.62,-5166.25 764.49,-5084.48"/>
<polygon fill="blue" stroke="blue" points="764.86,-5080.99 754.52,-5083.29 764.03,-5087.95 764.86,-5080.99"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_1 -->
<g id="edge28" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3873.81,-5121.68C3870.86,-5121.27 3867.92,-5120.89 3865,-5120.54 3251.77,-5047.13 1704.12,-5158.44 1071.68,-5084.5"/>
<polygon fill="blue" stroke="blue" points="1071.86,-5080.99 1061.52,-5083.28 1071.03,-5087.94 1071.86,-5080.99"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_2 -->
<g id="edge41" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3873.81,-5121.69C3870.86,-5121.27 3867.92,-5120.89 3865,-5120.54 3319.6,-5054.81 1943.54,-5150.65 1378.83,-5084.51"/>
<polygon fill="blue" stroke="blue" points="1378.86,-5080.99 1368.52,-5083.28 1378.03,-5087.94 1378.86,-5080.99"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_3 -->
<g id="edge54" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3873.81,-5121.69C3870.85,-5121.28 3867.91,-5120.89 3865,-5120.54 3387.32,-5062.48 2182.47,-5142.91 1685.68,-5084.49"/>
<polygon fill="blue" stroke="blue" points="1685.87,-5080.99 1675.52,-5083.27 1685.03,-5087.94 1685.87,-5080.99"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_4 -->
<g id="edge67" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3873.81,-5121.7C3870.85,-5121.29 3867.91,-5120.9 3865,-5120.54 3041.95,-5019.37 2819.95,-5186.52 1992.59,-5084.51"/>
<polygon fill="blue" stroke="blue" points="1992.88,-5081.02 1982.52,-5083.26 1992.01,-5087.96 1992.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_5 -->
<g id="edge80" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3873.81,-5121.72C3870.85,-5121.3 3867.91,-5120.9 3865,-5120.54 3177.47,-5034.71 2991.41,-5170.93 2299.49,-5084.49"/>
<polygon fill="blue" stroke="blue" points="2299.88,-5081.02 2289.52,-5083.24 2299.01,-5087.96 2299.88,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_6 -->
<g id="edge93" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3873.81,-5121.74C3870.85,-5121.31 3867.91,-5120.91 3865,-5120.54 3313.11,-5050.07 3162.95,-5155.32 2606.82,-5084.54"/>
<polygon fill="blue" stroke="blue" points="2606.89,-5081.02 2596.53,-5083.22 2606,-5087.96 2606.89,-5081.02"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_7 -->
<g id="edge106" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3873.8,-5121.78C3870.85,-5121.34 3867.91,-5120.92 3865,-5120.54 3448.53,-5065.41 3334.41,-5139.81 2913.53,-5084.51"/>
<polygon fill="blue" stroke="blue" points="2913.91,-5081.03 2903.53,-5083.18 2912.98,-5087.96 2913.91,-5081.03"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_8 -->
<g id="edge119" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3873.79,-5121.85C3870.84,-5121.39 3867.91,-5120.95 3865,-5120.54 3584.05,-5080.78 3506.02,-5124.33 3220.78,-5084.55"/>
<polygon fill="blue" stroke="blue" points="3220.93,-5081.04 3210.54,-5083.1 3219.95,-5087.97 3220.93,-5081.04"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_9 -->
<g id="edge132" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3873.76,-5122.05C3870.82,-5121.53 3867.9,-5121.02 3865,-5120.54 3719.2,-5096.15 3677.72,-5109.19 3527.62,-5084.56"/>
<polygon fill="blue" stroke="blue" points="3528.02,-5081.08 3517.58,-5082.88 3526.86,-5087.98 3528.02,-5081.08"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_10 -->
<g id="edge145" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3907.64,-5120.43C3874.42,-5109.93 3837.97,-5098.43 3804.17,-5087.75"/>
<polygon fill="blue" stroke="blue" points="3804.84,-5084.29 3794.25,-5084.62 3802.73,-5090.97 3804.84,-5084.29"/>
</g>
<!-- qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_11 -->
<g id="edge147" class="edge">
<title>qkv_layer_0_gpu_11&#45;&gt;attention_layer_0_gpu_11</title>
<path fill="none" stroke="black" d="M4010.25,-5120.28C4007.56,-5111.99 4004.68,-5103.09 4001.88,-5094.46"/>
<polygon fill="black" stroke="black" points="4005.19,-5093.32 3998.78,-5084.89 3998.53,-5095.48 4005.19,-5093.32"/>
</g>
<!-- attention_agg_layer_0 -->
<g id="node28" class="node">
<title>attention_agg_layer_0</title>
<polygon fill="#ffcccc" stroke="black" points="2769.49,-4974.54 2264.43,-4974.54 2134.51,-4870.54 2639.57,-4870.54 2769.49,-4974.54"/>
<text text-anchor="middle" x="2452" y="-4936.54" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="2452" y="-4925.54" font-family="Arial" font-size="10.00">Input: [12Ã— batch_size=1024, seq_len=2048, heads=2&#45;3, d_k=128]</text>
<text text-anchor="middle" x="2452" y="-4914.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2452" y="-4903.54" font-family="Arial" font-size="10.00">GPU: all attention GPUs</text>
</g>
<!-- attention_layer_0_gpu_0&#45;&gt;attention_agg_layer_0 -->
<g id="edge159" class="edge">
<title>attention_layer_0_gpu_0&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M754.54,-5011.96C757.72,-5011.46 760.87,-5010.98 764,-5010.54 1033.41,-4972.42 1798.3,-4943.87 2199.43,-4931.03"/>
<polygon fill="black" stroke="black" points="2199.54,-4934.53 2209.43,-4930.72 2199.32,-4927.54 2199.54,-4934.53"/>
</g>
<!-- attention_layer_0_gpu_1&#45;&gt;attention_agg_layer_0 -->
<g id="edge160" class="edge">
<title>attention_layer_0_gpu_1&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M1061.55,-5012.01C1064.72,-5011.49 1067.88,-5011 1071,-5010.54 1459.98,-4953.23 1916.04,-4933.64 2194.43,-4926.96"/>
<polygon fill="black" stroke="black" points="2194.76,-4930.46 2204.67,-4926.72 2194.59,-4923.46 2194.76,-4930.46"/>
</g>
<!-- attention_layer_0_gpu_2&#45;&gt;attention_agg_layer_0 -->
<g id="edge161" class="edge">
<title>attention_layer_0_gpu_2&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M1368.56,-5012.09C1371.73,-5011.54 1374.88,-5011.03 1378,-5010.54 1658.43,-4966.65 1983.72,-4944.23 2202.19,-4933.24"/>
<polygon fill="black" stroke="black" points="2202.37,-4936.73 2212.19,-4932.74 2202.02,-4929.74 2202.37,-4936.73"/>
</g>
<!-- attention_layer_0_gpu_3&#45;&gt;attention_agg_layer_0 -->
<g id="edge162" class="edge">
<title>attention_layer_0_gpu_3&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M1675.58,-5012.22C1678.75,-5011.64 1681.89,-5011.08 1685,-5010.54 1861.04,-4980.09 2061.73,-4957.76 2213.66,-4943.35"/>
<polygon fill="black" stroke="black" points="2214.43,-4946.79 2224.05,-4942.37 2213.77,-4939.82 2214.43,-4946.79"/>
</g>
<!-- attention_layer_0_gpu_4&#45;&gt;attention_agg_layer_0 -->
<g id="edge163" class="edge">
<title>attention_layer_0_gpu_4&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M1982.64,-5012.54C1985.79,-5011.86 1988.91,-5011.19 1992,-5010.54 2071.69,-4993.7 2159.48,-4976.71 2236.82,-4962.27"/>
<polygon fill="black" stroke="black" points="2237.49,-4965.7 2246.68,-4960.43 2236.21,-4958.82 2237.49,-4965.7"/>
</g>
<!-- attention_layer_0_gpu_5&#45;&gt;attention_agg_layer_0 -->
<g id="edge164" class="edge">
<title>attention_layer_0_gpu_5&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M2235.04,-5010.47C2260.12,-5000.42 2287.95,-4989.27 2315.08,-4978.4"/>
<polygon fill="black" stroke="black" points="2316.66,-4981.53 2324.64,-4974.56 2314.06,-4975.03 2316.66,-4981.53"/>
</g>
<!-- attention_layer_0_gpu_6&#45;&gt;attention_agg_layer_0 -->
<g id="edge165" class="edge">
<title>attention_layer_0_gpu_6&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M2452,-5010.3C2452,-5002.25 2452,-4993.51 2452,-4984.77"/>
<polygon fill="black" stroke="black" points="2455.5,-4984.56 2452,-4974.56 2448.5,-4984.56 2455.5,-4984.56"/>
</g>
<!-- attention_layer_0_gpu_7&#45;&gt;attention_agg_layer_0 -->
<g id="edge166" class="edge">
<title>attention_layer_0_gpu_7&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M2668.96,-5010.47C2643.88,-5000.42 2616.05,-4989.27 2588.92,-4978.4"/>
<polygon fill="black" stroke="black" points="2589.94,-4975.03 2579.36,-4974.56 2587.34,-4981.53 2589.94,-4975.03"/>
</g>
<!-- attention_layer_0_gpu_8&#45;&gt;attention_agg_layer_0 -->
<g id="edge167" class="edge">
<title>attention_layer_0_gpu_8&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M2921.48,-5012.35C2918.63,-5011.74 2915.8,-5011.13 2913,-5010.54 2858.32,-4998.95 2799.82,-4987.32 2743.49,-4976.51"/>
<polygon fill="black" stroke="black" points="2743.85,-4973.02 2733.37,-4974.57 2742.53,-4979.89 2743.85,-4973.02"/>
</g>
<!-- attention_layer_0_gpu_9&#45;&gt;attention_agg_layer_0 -->
<g id="edge168" class="edge">
<title>attention_layer_0_gpu_9&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M3228.13,-5011.99C3225.4,-5011.49 3222.69,-5011.01 3220,-5010.54 3064.59,-4983.55 2889.96,-4963 2746.54,-4948.67"/>
<polygon fill="black" stroke="black" points="2746.57,-4945.16 2736.27,-4947.65 2745.87,-4952.12 2746.57,-4945.16"/>
</g>
<!-- attention_layer_0_gpu_10&#45;&gt;attention_agg_layer_0 -->
<g id="edge169" class="edge">
<title>attention_layer_0_gpu_10&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M3535.15,-5011.87C3532.41,-5011.41 3529.7,-5010.96 3527,-5010.54 3257.75,-4968.21 2947.13,-4945.89 2729.24,-4934.51"/>
<polygon fill="black" stroke="black" points="2729.1,-4931 2718.93,-4933.98 2728.74,-4937.99 2729.1,-4931"/>
</g>
<!-- attention_layer_0_gpu_11&#45;&gt;attention_agg_layer_0 -->
<g id="edge170" class="edge">
<title>attention_layer_0_gpu_11&#45;&gt;attention_agg_layer_0</title>
<path fill="none" stroke="black" d="M3842.16,-5011.81C3839.42,-5011.36 3836.7,-5010.94 3834,-5010.54 3449.63,-4953.63 2999.73,-4933.9 2720.25,-4927.09"/>
<polygon fill="black" stroke="black" points="2720.05,-4923.59 2709.97,-4926.84 2719.89,-4930.58 2720.05,-4923.59"/>
</g>
<!-- out_proj_layer_0 -->
<g id="node29" class="node">
<title>out_proj_layer_0</title>
<polygon fill="#0080ff" stroke="black" points="3314,-4834.54 3030,-4834.54 3030,-4782.54 3314,-4782.54 3314,-4834.54"/>
<text text-anchor="middle" x="3172" y="-4822.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3172" y="-4811.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3172" y="-4800.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3172" y="-4789.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- attention_agg_layer_0&#45;&gt;out_proj_layer_0 -->
<g id="edge171" class="edge">
<title>attention_agg_layer_0&#45;&gt;out_proj_layer_0</title>
<path fill="none" stroke="black" d="M2662.67,-4888.77C2777.15,-4870.96 2916.12,-4849.34 3019.96,-4833.19"/>
<polygon fill="black" stroke="black" points="3020.55,-4836.64 3029.9,-4831.64 3019.48,-4829.72 3020.55,-4836.64"/>
</g>
<!-- out_proj_layer_0&#45;&gt;residual1_layer_0 -->
<g id="edge172" class="edge">
<title>out_proj_layer_0&#45;&gt;residual1_layer_0</title>
<path fill="none" stroke="black" d="M3217.33,-4782.4C3233.88,-4773.23 3253.32,-4762.45 3272.77,-4751.67"/>
<polygon fill="black" stroke="black" points="3274.65,-4754.63 3281.7,-4746.72 3271.25,-4748.51 3274.65,-4754.63"/>
</g>
<!-- ln2_layer_0 -->
<g id="node31" class="node">
<title>ln2_layer_0</title>
<polygon fill="#0080ff" stroke="black" points="2845,-4606.54 2561,-4606.54 2561,-4554.54 2845,-4554.54 2845,-4606.54"/>
<text text-anchor="middle" x="2703" y="-4594.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2703" y="-4583.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2703" y="-4572.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2703" y="-4561.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_layer_0&#45;&gt;ln2_layer_0 -->
<g id="edge174" class="edge">
<title>residual1_layer_0&#45;&gt;ln2_layer_0</title>
<path fill="none" stroke="black" d="M3074.32,-4643.52C2998.42,-4630.85 2920.05,-4617.77 2854.98,-4606.91"/>
<polygon fill="black" stroke="black" points="2855.5,-4603.45 2845.06,-4605.25 2854.35,-4610.35 2855.5,-4603.45"/>
</g>
<!-- residual2_layer_0 -->
<g id="node50" class="node">
<title>residual2_layer_0</title>
<polygon fill="#ffffcc" stroke="black" points="3160.82,-4150.54 2682.28,-4150.54 2559.18,-4046.54 3037.72,-4046.54 3160.82,-4150.54"/>
<text text-anchor="middle" x="2860" y="-4112.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="2860" y="-4101.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2860" y="-4090.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2860" y="-4079.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_layer_0&#45;&gt;residual2_layer_0 -->
<g id="edge225" class="edge">
<title>residual1_layer_0&#45;&gt;residual2_layer_0</title>
<path fill="none" stroke="black" d="M3598.42,-4681.9C4011.19,-4657.47 4849,-4592.5 4849,-4467.54 4849,-4467.54 4849,-4467.54 4849,-4351.54 4849,-4179.01 3655.99,-4122.57 3117.87,-4105.88"/>
<polygon fill="black" stroke="black" points="3117.74,-4102.38 3107.64,-4105.57 3117.52,-4109.38 3117.74,-4102.38"/>
</g>
<!-- gate_layer_0 -->
<g id="node32" class="node">
<title>gate_layer_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2837.43,-4518.54 2378.6,-4518.54 2260.57,-4414.54 2719.4,-4414.54 2837.43,-4518.54"/>
<text text-anchor="middle" x="2549" y="-4480.54" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="2549" y="-4469.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2549" y="-4458.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="2549" y="-4447.54" font-family="Arial" font-size="10.00">GPU: all MoE GPUs (12&#45;15)</text>
</g>
<!-- ln2_layer_0&#45;&gt;gate_layer_0 -->
<g id="edge175" class="edge">
<title>ln2_layer_0&#45;&gt;gate_layer_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2668.44,-4554.4C2656.28,-4545.56 2642.07,-4535.23 2627.78,-4524.83"/>
<polygon fill="black" stroke="black" points="2629.52,-4521.77 2619.37,-4518.72 2625.4,-4527.43 2629.52,-4521.77"/>
</g>
<!-- expert_layer_0_expert_0_gpu_12 -->
<g id="node33" class="node">
<title>expert_layer_0_expert_0_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="2716,-4378.54 2432,-4378.54 2432,-4326.54 2716,-4326.54 2716,-4378.54"/>
<text text-anchor="middle" x="2574" y="-4366.54" font-family="Arial" font-size="10.00">Expert0</text>
<text text-anchor="middle" x="2574" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2574" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2574" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_0_gpu_12 -->
<g id="edge177" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_0_gpu_12</title>
<path fill="none" stroke="black" d="M2803.64,-4554.51C2820.4,-4545.84 2835.66,-4534.19 2846,-4518.54 2871.48,-4479.97 2874.89,-4450.62 2846,-4414.54 2837.48,-4403.89 2783.72,-4390.79 2726.21,-4379.47"/>
<polygon fill="black" stroke="black" points="2726.69,-4375.99 2716.2,-4377.52 2725.35,-4382.87 2726.69,-4375.99"/>
</g>
<!-- expert_layer_0_expert_1_gpu_12 -->
<g id="node34" class="node">
<title>expert_layer_0_expert_1_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3018,-4378.54 2734,-4378.54 2734,-4326.54 3018,-4326.54 3018,-4378.54"/>
<text text-anchor="middle" x="2876" y="-4366.54" font-family="Arial" font-size="10.00">Expert1</text>
<text text-anchor="middle" x="2876" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2876" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2876" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_1_gpu_12 -->
<g id="edge179" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_1_gpu_12</title>
<path fill="none" stroke="black" d="M2815.19,-4554.41C2832.9,-4545.76 2849.22,-4534.15 2861,-4518.54 2889.07,-4481.34 2887.62,-4425.14 2882.77,-4388.89"/>
<polygon fill="black" stroke="black" points="2886.2,-4388.15 2881.26,-4378.78 2879.28,-4389.18 2886.2,-4388.15"/>
</g>
<!-- expert_layer_0_expert_2_gpu_12 -->
<g id="node35" class="node">
<title>expert_layer_0_expert_2_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3320,-4378.54 3036,-4378.54 3036,-4326.54 3320,-4326.54 3320,-4378.54"/>
<text text-anchor="middle" x="3178" y="-4366.54" font-family="Arial" font-size="10.00">Expert2</text>
<text text-anchor="middle" x="3178" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3178" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3178" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_2_gpu_12 -->
<g id="edge181" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_2_gpu_12</title>
<path fill="none" stroke="black" d="M2783.81,-4554.52C2813.82,-4544.41 2847.88,-4531.96 2878,-4518.54 2969.41,-4477.81 3070.34,-4419.29 3128.73,-4383.99"/>
<polygon fill="black" stroke="black" points="3130.65,-4386.93 3137.38,-4378.75 3127.02,-4380.94 3130.65,-4386.93"/>
</g>
<!-- expert_layer_0_expert_3_gpu_12 -->
<g id="node36" class="node">
<title>expert_layer_0_expert_3_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3622,-4378.54 3338,-4378.54 3338,-4326.54 3622,-4326.54 3622,-4378.54"/>
<text text-anchor="middle" x="3480" y="-4366.54" font-family="Arial" font-size="10.00">Expert3</text>
<text text-anchor="middle" x="3480" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3480" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3480" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_3_gpu_12 -->
<g id="edge183" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_3_gpu_12</title>
<path fill="none" stroke="black" d="M2829.49,-4554.52C2876.96,-4544.39 2931.21,-4531.93 2980,-4518.54 3131.22,-4477.05 3304.28,-4417.08 3402.01,-4382.02"/>
<polygon fill="black" stroke="black" points="3403.3,-4385.28 3411.52,-4378.61 3400.93,-4378.69 3403.3,-4385.28"/>
</g>
<!-- expert_layer_0_expert_4_gpu_13 -->
<g id="node37" class="node">
<title>expert_layer_0_expert_4_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="3924,-4378.54 3640,-4378.54 3640,-4326.54 3924,-4326.54 3924,-4378.54"/>
<text text-anchor="middle" x="3782" y="-4366.54" font-family="Arial" font-size="10.00">Expert4</text>
<text text-anchor="middle" x="3782" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3782" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3782" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_4_gpu_13 -->
<g id="edge185" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_4_gpu_13</title>
<path fill="none" stroke="black" d="M2845.35,-4564.23C2932.57,-4553.79 3046.23,-4538.28 3146,-4518.54 3341.02,-4479.95 3565.27,-4417.43 3688.57,-4381.45"/>
<polygon fill="black" stroke="black" points="3689.75,-4384.75 3698.36,-4378.59 3687.78,-4378.03 3689.75,-4384.75"/>
</g>
<!-- expert_layer_0_expert_5_gpu_13 -->
<g id="node38" class="node">
<title>expert_layer_0_expert_5_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="4226,-4378.54 3942,-4378.54 3942,-4326.54 4226,-4326.54 4226,-4378.54"/>
<text text-anchor="middle" x="4084" y="-4366.54" font-family="Arial" font-size="10.00">Expert5</text>
<text text-anchor="middle" x="4084" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4084" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4084" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_5_gpu_13 -->
<g id="edge187" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_5_gpu_13</title>
<path fill="none" stroke="black" d="M2845.3,-4571.86C2979.43,-4563.34 3185.74,-4546.88 3363,-4518.54 3586.51,-4482.8 3844.05,-4418.05 3982.79,-4381.18"/>
<polygon fill="black" stroke="black" points="3983.81,-4384.53 3992.58,-4378.58 3982.01,-4377.77 3983.81,-4384.53"/>
</g>
<!-- expert_layer_0_expert_6_gpu_13 -->
<g id="node39" class="node">
<title>expert_layer_0_expert_6_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="4528,-4378.54 4244,-4378.54 4244,-4326.54 4528,-4326.54 4528,-4378.54"/>
<text text-anchor="middle" x="4386" y="-4366.54" font-family="Arial" font-size="10.00">Expert6</text>
<text text-anchor="middle" x="4386" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4386" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4386" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_6_gpu_13 -->
<g id="edge189" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_6_gpu_13</title>
<path fill="none" stroke="black" d="M2845.27,-4576.2C3024.23,-4570.57 3340.63,-4555.88 3609,-4518.54 3851.34,-4484.82 4130.99,-4418.59 4279.82,-4381.1"/>
<polygon fill="black" stroke="black" points="4281.03,-4384.41 4289.87,-4378.56 4279.32,-4377.62 4281.03,-4384.41"/>
</g>
<!-- expert_layer_0_expert_7_gpu_13 -->
<g id="node40" class="node">
<title>expert_layer_0_expert_7_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="4830,-4378.54 4546,-4378.54 4546,-4326.54 4830,-4326.54 4830,-4378.54"/>
<text text-anchor="middle" x="4688" y="-4366.54" font-family="Arial" font-size="10.00">Expert7</text>
<text text-anchor="middle" x="4688" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4688" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4688" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_7_gpu_13 -->
<g id="edge191" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_7_gpu_13</title>
<path fill="none" stroke="black" d="M2845.43,-4578.88C3066.32,-4576.33 3504.48,-4565.19 3873,-4518.54 4128.24,-4486.23 4423.07,-4418.94 4578.68,-4381.03"/>
<polygon fill="black" stroke="black" points="4579.84,-4384.35 4588.73,-4378.58 4578.18,-4377.55 4579.84,-4384.35"/>
</g>
<!-- expert_layer_0_expert_8_gpu_14 -->
<g id="node41" class="node">
<title>expert_layer_0_expert_8_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="300,-4378.54 16,-4378.54 16,-4326.54 300,-4326.54 300,-4378.54"/>
<text text-anchor="middle" x="158" y="-4366.54" font-family="Arial" font-size="10.00">Expert8</text>
<text text-anchor="middle" x="158" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="158" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="158" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_8_gpu_14 -->
<g id="edge193" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_8_gpu_14</title>
<path fill="none" stroke="black" d="M2560.91,-4578.23C2117.6,-4573.75 778.07,-4557.15 586,-4518.54 447.86,-4490.77 296.23,-4422.57 215.73,-4383.09"/>
<polygon fill="black" stroke="black" points="217.27,-4379.94 206.75,-4378.66 214.17,-4386.22 217.27,-4379.94"/>
</g>
<!-- expert_layer_0_expert_9_gpu_14 -->
<g id="node42" class="node">
<title>expert_layer_0_expert_9_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="602,-4378.54 318,-4378.54 318,-4326.54 602,-4326.54 602,-4378.54"/>
<text text-anchor="middle" x="460" y="-4366.54" font-family="Arial" font-size="10.00">Expert9</text>
<text text-anchor="middle" x="460" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="460" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="460" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_9_gpu_14 -->
<g id="edge195" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_9_gpu_14</title>
<path fill="none" stroke="black" d="M2560.69,-4577.49C2161.34,-4571.37 1048.84,-4551.54 887,-4518.54 749.5,-4490.5 598.54,-4422.64 518.1,-4383.24"/>
<polygon fill="black" stroke="black" points="519.16,-4379.86 508.64,-4378.58 516.07,-4386.14 519.16,-4379.86"/>
</g>
<!-- expert_layer_0_expert_10_gpu_14 -->
<g id="node43" class="node">
<title>expert_layer_0_expert_10_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="904,-4378.54 620,-4378.54 620,-4326.54 904,-4326.54 904,-4378.54"/>
<text text-anchor="middle" x="762" y="-4366.54" font-family="Arial" font-size="10.00">Expert10</text>
<text text-anchor="middle" x="762" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="762" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="762" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_10_gpu_14 -->
<g id="edge197" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_10_gpu_14</title>
<path fill="none" stroke="black" d="M2560.85,-4579.78C2235.87,-4579.35 1446.65,-4572.6 1187,-4518.54 1050.36,-4490.09 900.32,-4422.55 820.16,-4383.27"/>
<polygon fill="black" stroke="black" points="821.26,-4379.9 810.74,-4378.62 818.16,-4386.18 821.26,-4379.9"/>
</g>
<!-- expert_layer_0_expert_11_gpu_14 -->
<g id="node44" class="node">
<title>expert_layer_0_expert_11_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="1206,-4378.54 922,-4378.54 922,-4326.54 1206,-4326.54 1206,-4378.54"/>
<text text-anchor="middle" x="1064" y="-4366.54" font-family="Arial" font-size="10.00">Expert11</text>
<text text-anchor="middle" x="1064" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1064" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1064" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_11_gpu_14 -->
<g id="edge199" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_11_gpu_14</title>
<path fill="none" stroke="black" d="M2560.86,-4578.14C2285.15,-4574.49 1687.15,-4561.71 1486,-4518.54 1350.56,-4489.47 1201.78,-4422.32 1122.09,-4383.24"/>
<polygon fill="black" stroke="black" points="1123.24,-4379.9 1112.72,-4378.61 1120.14,-4386.18 1123.24,-4379.9"/>
</g>
<!-- expert_layer_0_expert_12_gpu_15 -->
<g id="node45" class="node">
<title>expert_layer_0_expert_12_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="1508,-4378.54 1224,-4378.54 1224,-4326.54 1508,-4326.54 1508,-4378.54"/>
<text text-anchor="middle" x="1366" y="-4366.54" font-family="Arial" font-size="10.00">Expert12</text>
<text text-anchor="middle" x="1366" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1366" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1366" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_12_gpu_15 -->
<g id="edge201" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_12_gpu_15</title>
<path fill="none" stroke="black" d="M2560.72,-4575.62C2339.33,-4568.6 1922.78,-4551.43 1778,-4518.54 1646.05,-4488.56 1501.26,-4422.07 1423.33,-4383.26"/>
<polygon fill="black" stroke="black" points="1424.67,-4380.02 1414.16,-4378.67 1421.54,-4386.28 1424.67,-4380.02"/>
</g>
<!-- expert_layer_0_expert_13_gpu_15 -->
<g id="node46" class="node">
<title>expert_layer_0_expert_13_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="1810,-4378.54 1526,-4378.54 1526,-4326.54 1810,-4326.54 1810,-4378.54"/>
<text text-anchor="middle" x="1668" y="-4366.54" font-family="Arial" font-size="10.00">Expert13</text>
<text text-anchor="middle" x="1668" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1668" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1668" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_13_gpu_15 -->
<g id="edge203" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_13_gpu_15</title>
<path fill="none" stroke="black" d="M2560.98,-4579.25C2426.6,-4575.97 2220.23,-4563.08 2047,-4518.54 1925.53,-4487.31 1793.26,-4421.81 1721.56,-4383.4"/>
<polygon fill="black" stroke="black" points="1723.17,-4380.28 1712.7,-4378.62 1719.84,-4386.45 1723.17,-4380.28"/>
</g>
<!-- expert_layer_0_expert_14_gpu_15 -->
<g id="node47" class="node">
<title>expert_layer_0_expert_14_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2112,-4378.54 1828,-4378.54 1828,-4326.54 2112,-4326.54 2112,-4378.54"/>
<text text-anchor="middle" x="1970" y="-4366.54" font-family="Arial" font-size="10.00">Expert14</text>
<text text-anchor="middle" x="1970" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1970" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1970" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_14_gpu_15 -->
<g id="edge205" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_14_gpu_15</title>
<path fill="none" stroke="black" d="M2560.82,-4577.26C2464.87,-4571.89 2336.77,-4557.14 2230,-4518.54 2143.5,-4487.27 2055.83,-4423.51 2007.64,-4385.05"/>
<polygon fill="black" stroke="black" points="2009.66,-4382.18 1999.68,-4378.64 2005.27,-4387.64 2009.66,-4382.18"/>
</g>
<!-- expert_layer_0_expert_15_gpu_15 -->
<g id="node48" class="node">
<title>expert_layer_0_expert_15_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2414,-4378.54 2130,-4378.54 2130,-4326.54 2414,-4326.54 2414,-4378.54"/>
<text text-anchor="middle" x="2272" y="-4366.54" font-family="Arial" font-size="10.00">Expert15</text>
<text text-anchor="middle" x="2272" y="-4355.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2272" y="-4344.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2272" y="-4333.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_0&#45;&gt;expert_layer_0_expert_15_gpu_15 -->
<g id="edge207" class="edge">
<title>ln2_layer_0&#45;&gt;expert_layer_0_expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M2560.79,-4569.61C2436.36,-4559.43 2272.34,-4541.82 2252,-4518.54 2220.8,-4482.84 2237.89,-4424.99 2254.14,-4388.13"/>
<polygon fill="black" stroke="black" points="2257.44,-4389.33 2258.44,-4378.79 2251.08,-4386.41 2257.44,-4389.33"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_0_gpu_12 -->
<g id="edge176" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_0_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2560.4,-4414.46C2562.36,-4405.69 2564.35,-4396.77 2566.18,-4388.55"/>
<polygon fill="red" stroke="red" points="2569.65,-4389.1 2568.41,-4378.58 2562.82,-4387.58 2569.65,-4389.1"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_1_gpu_12 -->
<g id="edge178" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_1_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2698.15,-4414.46C2730.83,-4403.26 2764.29,-4391.8 2793.24,-4381.88"/>
<polygon fill="red" stroke="red" points="2794.56,-4385.13 2802.88,-4378.58 2792.29,-4378.51 2794.56,-4385.13"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_2_gpu_12 -->
<g id="edge180" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_2_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2739,-4431.71C2831.46,-4415.24 2941.03,-4395.73 3027.58,-4380.32"/>
<polygon fill="red" stroke="red" points="3028.25,-4383.76 3037.48,-4378.56 3027.02,-4376.87 3028.25,-4383.76"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_3_gpu_12 -->
<g id="edge182" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_3_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2755.06,-4445.56C2909.91,-4429.84 3127.45,-4406.22 3327.64,-4378.7"/>
<polygon fill="red" stroke="red" points="3328.34,-4382.14 3337.77,-4377.3 3327.38,-4375.2 3328.34,-4382.14"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_4_gpu_13 -->
<g id="edge184" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_4_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2763.81,-4453.59C2980.18,-4440.32 3323.66,-4415.88 3629.82,-4378.64"/>
<polygon fill="red" stroke="red" points="3630.28,-4382.11 3639.78,-4377.43 3629.43,-4375.17 3630.28,-4382.11"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_5_gpu_13 -->
<g id="edge186" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_5_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2769.53,-4458.57C3040.95,-4448.42 3515.93,-4425.54 3931.67,-4378.64"/>
<polygon fill="red" stroke="red" points="3932.25,-4382.1 3941.79,-4377.5 3931.46,-4375.14 3932.25,-4382.1"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_6_gpu_13 -->
<g id="edge188" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_6_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2773.27,-4461.98C3094.87,-4455.08 3705.59,-4435.25 4233.69,-4378.63"/>
<polygon fill="red" stroke="red" points="4234.23,-4382.09 4243.8,-4377.54 4233.48,-4375.13 4234.23,-4382.09"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_7_gpu_13 -->
<g id="edge190" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_7_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2776.24,-4464.47C3144.22,-4460.76 3893.23,-4445 4535.41,-4378.65"/>
<polygon fill="red" stroke="red" points="4536.22,-4382.09 4545.8,-4377.57 4535.49,-4375.12 4536.22,-4382.09"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_8_gpu_14 -->
<g id="edge192" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_8_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2318.98,-4466.09C1914.23,-4464.95 1048.4,-4453.11 310.24,-4378.61"/>
<polygon fill="red" stroke="red" points="310.5,-4375.12 300.2,-4377.59 309.79,-4382.08 310.5,-4375.12"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_9_gpu_14 -->
<g id="edge194" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_9_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2316.39,-4464.04C1953.86,-4459.7 1232.2,-4443.03 612.23,-4378.61"/>
<polygon fill="red" stroke="red" points="612.51,-4375.12 602.2,-4377.57 611.78,-4382.09 612.51,-4375.12"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_10_gpu_14 -->
<g id="edge196" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_10_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2313.31,-4461.21C1996.89,-4453.53 1417.29,-4432.96 914.21,-4378.62"/>
<polygon fill="red" stroke="red" points="914.52,-4375.13 904.2,-4377.53 913.77,-4382.09 914.52,-4375.13"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_11_gpu_14 -->
<g id="edge198" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_11_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2308.58,-4457.03C2043.27,-4445.98 1603.6,-4422.8 1216.21,-4378.63"/>
<polygon fill="red" stroke="red" points="1216.54,-4375.15 1206.21,-4377.49 1215.75,-4382.1 1216.54,-4375.15"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_12_gpu_15 -->
<g id="edge200" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_12_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2301.06,-4450.22C2094.21,-4436.13 1791.57,-4412.44 1518.33,-4378.67"/>
<polygon fill="red" stroke="red" points="1518.57,-4375.17 1508.22,-4377.41 1517.71,-4382.12 1518.57,-4375.17"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_13_gpu_15 -->
<g id="edge202" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_13_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2285.92,-4437.11C2149.74,-4421.67 1980.57,-4401.37 1820.29,-4378.7"/>
<polygon fill="red" stroke="red" points="1820.63,-4375.21 1810.24,-4377.27 1819.65,-4382.14 1820.63,-4375.21"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_14_gpu_15 -->
<g id="edge204" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_14_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2285.34,-4414.54C2224.63,-4402.79 2162.39,-4390.75 2109.42,-4380.51"/>
<polygon fill="red" stroke="red" points="2109.78,-4377.01 2099.29,-4378.55 2108.45,-4383.88 2109.78,-4377.01"/>
</g>
<!-- gate_layer_0&#45;&gt;expert_layer_0_expert_15_gpu_15 -->
<g id="edge206" class="edge">
<title>gate_layer_0&#45;&gt;expert_layer_0_expert_15_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2422.66,-4414.46C2395.45,-4403.45 2367.61,-4392.2 2343.38,-4382.4"/>
<polygon fill="red" stroke="red" points="2344.52,-4379.09 2333.94,-4378.58 2341.9,-4385.58 2344.52,-4379.09"/>
</g>
<!-- expert_agg_layer_0 -->
<g id="node49" class="node">
<title>expert_agg_layer_0</title>
<polygon fill="#ffcccc" stroke="black" points="2880.76,-4290.54 2392.77,-4290.54 2267.24,-4186.54 2755.23,-4186.54 2880.76,-4290.54"/>
<text text-anchor="middle" x="2574" y="-4252.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2574" y="-4241.54" font-family="Arial" font-size="10.00">Input: [16Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2574" y="-4230.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2574" y="-4219.54" font-family="Arial" font-size="10.00">GPU: all MoE GPUs</text>
</g>
<!-- expert_layer_0_expert_0_gpu_12&#45;&gt;expert_agg_layer_0 -->
<g id="edge208" class="edge">
<title>expert_layer_0_expert_0_gpu_12&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M2574,-4326.4C2574,-4318.72 2574,-4309.91 2574,-4300.91"/>
<polygon fill="black" stroke="black" points="2577.5,-4300.72 2574,-4290.72 2570.5,-4300.72 2577.5,-4300.72"/>
</g>
<!-- expert_layer_0_expert_1_gpu_12&#45;&gt;expert_agg_layer_0 -->
<g id="edge209" class="edge">
<title>expert_layer_0_expert_1_gpu_12&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M2808.23,-4326.4C2782.3,-4316.79 2751.61,-4305.41 2721.14,-4294.11"/>
<polygon fill="black" stroke="black" points="2722.29,-4290.8 2711.69,-4290.6 2719.85,-4297.36 2722.29,-4290.8"/>
</g>
<!-- expert_layer_0_expert_2_gpu_12&#45;&gt;expert_agg_layer_0 -->
<g id="edge210" class="edge">
<title>expert_layer_0_expert_2_gpu_12&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M3042.83,-4326.47C2988.25,-4316.35 2923.08,-4304.27 2858.94,-4292.38"/>
<polygon fill="black" stroke="black" points="2859.54,-4288.93 2849.07,-4290.55 2858.27,-4295.81 2859.54,-4288.93"/>
</g>
<!-- expert_layer_0_expert_3_gpu_12&#45;&gt;expert_agg_layer_0 -->
<g id="edge211" class="edge">
<title>expert_layer_0_expert_3_gpu_12&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M3337.77,-4327.79C3334.82,-4327.36 3331.89,-4326.95 3329,-4326.54 3176.04,-4305.08 3005.09,-4285.05 2864.6,-4269.64"/>
<polygon fill="black" stroke="black" points="2864.85,-4266.14 2854.53,-4268.53 2864.09,-4273.1 2864.85,-4266.14"/>
</g>
<!-- expert_layer_0_expert_4_gpu_13&#45;&gt;expert_agg_layer_0 -->
<g id="edge212" class="edge">
<title>expert_layer_0_expert_4_gpu_13&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M3639.78,-4327.66C3636.83,-4327.27 3633.9,-4326.9 3631,-4326.54 3366.02,-4293.75 3062.08,-4270.2 2848.34,-4255.93"/>
<polygon fill="black" stroke="black" points="2848.44,-4252.43 2838.23,-4255.26 2847.98,-4259.41 2848.44,-4252.43"/>
</g>
<!-- expert_layer_0_expert_5_gpu_13&#45;&gt;expert_agg_layer_0 -->
<g id="edge213" class="edge">
<title>expert_layer_0_expert_5_gpu_13&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M3941.79,-4327.59C3938.84,-4327.22 3935.9,-4326.87 3933,-4326.54 3554.66,-4283.22 3114.42,-4259.97 2839.95,-4248.69"/>
<polygon fill="black" stroke="black" points="2839.98,-4245.18 2829.85,-4248.27 2839.7,-4252.18 2839.98,-4245.18"/>
</g>
<!-- expert_layer_0_expert_6_gpu_13&#45;&gt;expert_agg_layer_0 -->
<g id="edge214" class="edge">
<title>expert_layer_0_expert_6_gpu_13&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M4243.8,-4327.54C4240.84,-4327.19 4237.91,-4326.85 4235,-4326.54 3741.86,-4272.97 3162.63,-4252.12 2834.9,-4244.2"/>
<polygon fill="black" stroke="black" points="2834.87,-4240.7 2824.79,-4243.96 2834.7,-4247.69 2834.87,-4240.7"/>
</g>
<!-- expert_layer_0_expert_7_gpu_13&#45;&gt;expert_agg_layer_0 -->
<g id="edge215" class="edge">
<title>expert_layer_0_expert_7_gpu_13&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M4545.8,-4327.51C4542.84,-4327.17 4539.91,-4326.84 4537,-4326.54 3927.6,-4262.82 3207.02,-4245.69 2831.25,-4241.13"/>
<polygon fill="black" stroke="black" points="2831.1,-4237.63 2821.06,-4241.01 2831.02,-4244.63 2831.1,-4237.63"/>
</g>
<!-- expert_layer_0_expert_8_gpu_14&#45;&gt;expert_agg_layer_0 -->
<g id="edge216" class="edge">
<title>expert_layer_0_expert_8_gpu_14&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M300.2,-4327.49C303.16,-4327.15 306.09,-4326.83 309,-4326.54 1036.19,-4252.67 1900.5,-4240.19 2320.15,-4238.91"/>
<polygon fill="black" stroke="black" points="2320.3,-4242.41 2330.29,-4238.88 2320.28,-4235.41 2320.3,-4242.41"/>
</g>
<!-- expert_layer_0_expert_9_gpu_14&#45;&gt;expert_agg_layer_0 -->
<g id="edge217" class="edge">
<title>expert_layer_0_expert_9_gpu_14&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M602.2,-4327.51C605.16,-4327.17 608.09,-4326.84 611,-4326.54 1223.55,-4262.49 1948.44,-4245.51 2322.55,-4241.07"/>
<polygon fill="black" stroke="black" points="2322.73,-4244.56 2332.69,-4240.95 2322.65,-4237.56 2322.73,-4244.56"/>
</g>
<!-- expert_layer_0_expert_10_gpu_14&#45;&gt;expert_agg_layer_0 -->
<g id="edge218" class="edge">
<title>expert_layer_0_expert_10_gpu_14&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M904.2,-4327.54C907.16,-4327.19 910.09,-4326.85 913,-4326.54 1412.72,-4272.26 2000.82,-4251.57 2326.07,-4243.89"/>
<polygon fill="black" stroke="black" points="2326.18,-4247.39 2336.09,-4243.65 2326.01,-4240.39 2326.18,-4247.39"/>
</g>
<!-- expert_layer_0_expert_11_gpu_14&#45;&gt;expert_agg_layer_0 -->
<g id="edge219" class="edge">
<title>expert_layer_0_expert_11_gpu_14&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M1206.21,-4327.59C1209.16,-4327.22 1212.1,-4326.87 1215,-4326.54 1603.78,-4282.02 2057.93,-4258.7 2330.39,-4247.78"/>
<polygon fill="black" stroke="black" points="2330.56,-4251.28 2340.41,-4247.38 2330.28,-4244.28 2330.56,-4251.28"/>
</g>
<!-- expert_layer_0_expert_12_gpu_15&#45;&gt;expert_agg_layer_0 -->
<g id="edge220" class="edge">
<title>expert_layer_0_expert_12_gpu_15&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M1508.22,-4327.66C1511.17,-4327.27 1514.1,-4326.9 1517,-4326.54 1797.84,-4291.79 2122.43,-4267.41 2337.02,-4253.47"/>
<polygon fill="black" stroke="black" points="2337.4,-4256.95 2347.16,-4252.81 2336.95,-4249.97 2337.4,-4256.95"/>
</g>
<!-- expert_layer_0_expert_13_gpu_15&#45;&gt;expert_agg_layer_0 -->
<g id="edge221" class="edge">
<title>expert_layer_0_expert_13_gpu_15&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M1810.23,-4327.79C1813.18,-4327.36 1816.11,-4326.95 1819,-4326.54 1996.06,-4301.7 2197.23,-4278.78 2347.36,-4262.7"/>
<polygon fill="black" stroke="black" points="2348.06,-4266.15 2357.63,-4261.61 2347.31,-4259.19 2348.06,-4266.15"/>
</g>
<!-- expert_layer_0_expert_14_gpu_15&#45;&gt;expert_agg_layer_0 -->
<g id="edge222" class="edge">
<title>expert_layer_0_expert_14_gpu_15&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M2105.17,-4326.47C2181.77,-4312.27 2279.23,-4294.2 2365.42,-4278.22"/>
<polygon fill="black" stroke="black" points="2366.14,-4281.64 2375.34,-4276.38 2364.87,-4274.76 2366.14,-4281.64"/>
</g>
<!-- expert_layer_0_expert_15_gpu_15&#45;&gt;expert_agg_layer_0 -->
<g id="edge223" class="edge">
<title>expert_layer_0_expert_15_gpu_15&#45;&gt;expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M2339.77,-4326.4C2365.7,-4316.79 2396.39,-4305.41 2426.86,-4294.11"/>
<polygon fill="black" stroke="black" points="2428.15,-4297.36 2436.31,-4290.6 2425.71,-4290.8 2428.15,-4297.36"/>
</g>
<!-- expert_agg_layer_0&#45;&gt;residual2_layer_0 -->
<g id="edge224" class="edge">
<title>expert_agg_layer_0&#45;&gt;residual2_layer_0</title>
<path fill="none" stroke="black" d="M2680.09,-4186.35C2701.23,-4176.15 2723.53,-4165.39 2744.96,-4155.05"/>
<polygon fill="black" stroke="black" points="2746.6,-4158.14 2754.08,-4150.65 2743.55,-4151.84 2746.6,-4158.14"/>
</g>
<!-- ln1_layer_1 -->
<g id="node51" class="node">
<title>ln1_layer_1</title>
<polygon fill="#0080ff" stroke="black" points="2880,-3999.54 2596,-3999.54 2596,-3947.54 2880,-3947.54 2880,-3999.54"/>
<text text-anchor="middle" x="2738" y="-3987.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2738" y="-3976.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2738" y="-3965.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2738" y="-3954.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_layer_0&#45;&gt;ln1_layer_1 -->
<g id="edge226" class="edge">
<title>residual2_layer_0&#45;&gt;ln1_layer_1</title>
<path fill="none" stroke="black" d="M2809.32,-4046.44C2796.09,-4033.11 2782.2,-4019.1 2770.22,-4007.02"/>
<polygon fill="black" stroke="black" points="2772.56,-4004.42 2763.04,-3999.78 2767.59,-4009.34 2772.56,-4004.42"/>
</g>
<!-- residual1_layer_1 -->
<g id="node78" class="node">
<title>residual1_layer_1</title>
<polygon fill="#ffffcc" stroke="black" points="4241.82,-3463.54 3763.28,-3463.54 3640.18,-3359.54 4118.72,-3359.54 4241.82,-3463.54"/>
<text text-anchor="middle" x="3941" y="-3425.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="3941" y="-3414.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3941" y="-3403.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3941" y="-3392.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_layer_0&#45;&gt;residual1_layer_1 -->
<g id="edge397" class="edge">
<title>residual2_layer_0&#45;&gt;residual1_layer_1</title>
<path fill="none" stroke="black" d="M3097.03,-4096.62C3488.39,-4090.79 4248.07,-4060.04 4465,-3911.54 4479.93,-3901.32 4484,-3893.63 4484,-3875.54 4484,-3875.54 4484,-3875.54 4484,-3638.54 4484,-3567.48 4323.51,-3506.89 4177.03,-3466.38"/>
<polygon fill="black" stroke="black" points="4177.53,-3462.89 4166.96,-3463.62 4175.68,-3469.64 4177.53,-3462.89"/>
</g>
<!-- qkv_layer_1_gpu_0 -->
<g id="node52" class="node">
<title>qkv_layer_1_gpu_0</title>
<polygon fill="#0080ff" stroke="black" points="1002,-3911.54 706,-3911.54 706,-3837.54 1002,-3837.54 1002,-3911.54"/>
<text text-anchor="middle" x="854" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="854" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="854" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="854" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="854" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="854" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_0 -->
<g id="edge227" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_0</title>
<path fill="none" stroke="black" d="M2595.99,-3971C2243.75,-3966.63 1335.69,-3951.83 1012.52,-3911.63"/>
<polygon fill="black" stroke="black" points="1012.56,-3908.11 1002.2,-3910.31 1011.67,-3915.05 1012.56,-3908.11"/>
</g>
<!-- qkv_layer_1_gpu_1 -->
<g id="node53" class="node">
<title>qkv_layer_1_gpu_1</title>
<polygon fill="#0f8aff" stroke="black" points="1316,-3911.54 1020,-3911.54 1020,-3837.54 1316,-3837.54 1316,-3911.54"/>
<text text-anchor="middle" x="1168" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1168" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1168" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1168" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1168" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1168" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_1 -->
<g id="edge240" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_1</title>
<path fill="none" stroke="black" d="M2595.92,-3969.7C2292.06,-3963.09 1586.27,-3944.77 1326.38,-3911.61"/>
<polygon fill="black" stroke="black" points="1326.57,-3908.11 1316.2,-3910.28 1325.66,-3915.05 1326.57,-3908.11"/>
</g>
<!-- qkv_layer_1_gpu_2 -->
<g id="node54" class="node">
<title>qkv_layer_1_gpu_2</title>
<polygon fill="#1e94ff" stroke="black" points="1630,-3911.54 1334,-3911.54 1334,-3837.54 1630,-3837.54 1630,-3911.54"/>
<text text-anchor="middle" x="1482" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1482" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1482" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1482" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1482" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1482" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_2 -->
<g id="edge253" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_2</title>
<path fill="none" stroke="black" d="M2595.86,-3972.34C2387.67,-3970.33 1987.76,-3959.95 1640.22,-3911.63"/>
<polygon fill="black" stroke="black" points="1640.6,-3908.15 1630.21,-3910.23 1639.62,-3915.08 1640.6,-3908.15"/>
</g>
<!-- qkv_layer_1_gpu_3 -->
<g id="node55" class="node">
<title>qkv_layer_1_gpu_3</title>
<polygon fill="#2d9eff" stroke="black" points="1944,-3911.54 1648,-3911.54 1648,-3837.54 1944,-3837.54 1944,-3911.54"/>
<text text-anchor="middle" x="1796" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1796" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1796" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1796" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1796" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1796" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_3 -->
<g id="edge266" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_3</title>
<path fill="none" stroke="black" d="M2595.82,-3967.81C2440.33,-3961.2 2183.78,-3946.05 1954.43,-3911.69"/>
<polygon fill="black" stroke="black" points="1954.63,-3908.18 1944.22,-3910.14 1953.58,-3915.1 1954.63,-3908.18"/>
</g>
<!-- qkv_layer_1_gpu_4 -->
<g id="node56" class="node">
<title>qkv_layer_1_gpu_4</title>
<polygon fill="#3ca8ff" stroke="black" points="2258,-3911.54 1962,-3911.54 1962,-3837.54 2258,-3837.54 2258,-3911.54"/>
<text text-anchor="middle" x="2110" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2110" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2110" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2110" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2110" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2110" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_4 -->
<g id="edge279" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_4</title>
<path fill="none" stroke="black" d="M2595.76,-3957.74C2504.68,-3947.4 2383.84,-3932.08 2268.34,-3911.73"/>
<polygon fill="black" stroke="black" points="2268.71,-3908.24 2258.26,-3909.94 2267.49,-3915.13 2268.71,-3908.24"/>
</g>
<!-- qkv_layer_1_gpu_5 -->
<g id="node57" class="node">
<title>qkv_layer_1_gpu_5</title>
<polygon fill="#4bb2ff" stroke="black" points="2572,-3911.54 2276,-3911.54 2276,-3837.54 2572,-3837.54 2572,-3911.54"/>
<text text-anchor="middle" x="2424" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2424" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2424" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2424" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2424" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2424" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_5 -->
<g id="edge292" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_5</title>
<path fill="none" stroke="black" d="M2656.73,-3947.43C2624.28,-3937.41 2586.17,-3925.64 2550.28,-3914.55"/>
<polygon fill="black" stroke="black" points="2551.3,-3911.2 2540.72,-3911.59 2549.24,-3917.89 2551.3,-3911.2"/>
</g>
<!-- qkv_layer_1_gpu_6 -->
<g id="node58" class="node">
<title>qkv_layer_1_gpu_6</title>
<polygon fill="#5abcff" stroke="black" points="2886,-3911.54 2590,-3911.54 2590,-3837.54 2886,-3837.54 2886,-3911.54"/>
<text text-anchor="middle" x="2738" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2738" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2738" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2738" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2738" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2738" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_6 -->
<g id="edge305" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_6</title>
<path fill="none" stroke="black" d="M2738,-3947.31C2738,-3939.48 2738,-3930.59 2738,-3921.8"/>
<polygon fill="black" stroke="black" points="2741.5,-3921.6 2738,-3911.6 2734.5,-3921.6 2741.5,-3921.6"/>
</g>
<!-- qkv_layer_1_gpu_7 -->
<g id="node59" class="node">
<title>qkv_layer_1_gpu_7</title>
<polygon fill="#69c6ff" stroke="black" points="3200,-3911.54 2904,-3911.54 2904,-3837.54 3200,-3837.54 3200,-3911.54"/>
<text text-anchor="middle" x="3052" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3052" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3052" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3052" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3052" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3052" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_7 -->
<g id="edge318" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_7</title>
<path fill="none" stroke="black" d="M2819.27,-3947.43C2851.72,-3937.41 2889.83,-3925.64 2925.72,-3914.55"/>
<polygon fill="black" stroke="black" points="2926.76,-3917.89 2935.28,-3911.59 2924.7,-3911.2 2926.76,-3917.89"/>
</g>
<!-- qkv_layer_1_gpu_8 -->
<g id="node60" class="node">
<title>qkv_layer_1_gpu_8</title>
<polygon fill="#78d0ff" stroke="black" points="3514,-3911.54 3218,-3911.54 3218,-3837.54 3514,-3837.54 3514,-3911.54"/>
<text text-anchor="middle" x="3366" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3366" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3366" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3366" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3366" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3366" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_8 -->
<g id="edge331" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_8</title>
<path fill="none" stroke="black" d="M2880.24,-3957.74C2971.32,-3947.4 3092.16,-3932.08 3207.66,-3911.73"/>
<polygon fill="black" stroke="black" points="3208.51,-3915.13 3217.74,-3909.94 3207.29,-3908.24 3208.51,-3915.13"/>
</g>
<!-- qkv_layer_1_gpu_9 -->
<g id="node61" class="node">
<title>qkv_layer_1_gpu_9</title>
<polygon fill="#87daff" stroke="black" points="3828,-3911.54 3532,-3911.54 3532,-3837.54 3828,-3837.54 3828,-3911.54"/>
<text text-anchor="middle" x="3680" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3680" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3680" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3680" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3680" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3680" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_9 -->
<g id="edge344" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_9</title>
<path fill="none" stroke="black" d="M2880.18,-3967.81C3035.67,-3961.2 3292.22,-3946.05 3521.57,-3911.69"/>
<polygon fill="black" stroke="black" points="3522.42,-3915.1 3531.78,-3910.14 3521.37,-3908.18 3522.42,-3915.1"/>
</g>
<!-- qkv_layer_1_gpu_10 -->
<g id="node62" class="node">
<title>qkv_layer_1_gpu_10</title>
<polygon fill="#96e4ff" stroke="black" points="4142,-3911.54 3846,-3911.54 3846,-3837.54 4142,-3837.54 4142,-3911.54"/>
<text text-anchor="middle" x="3994" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3994" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3994" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3994" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3994" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3994" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_10 -->
<g id="edge357" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_10</title>
<path fill="none" stroke="black" d="M2880.14,-3972.34C3088.33,-3970.33 3488.24,-3959.95 3835.78,-3911.63"/>
<polygon fill="black" stroke="black" points="3836.38,-3915.08 3845.79,-3910.23 3835.4,-3908.15 3836.38,-3915.08"/>
</g>
<!-- qkv_layer_1_gpu_11 -->
<g id="node63" class="node">
<title>qkv_layer_1_gpu_11</title>
<polygon fill="#a5eeff" stroke="black" points="4456,-3911.54 4160,-3911.54 4160,-3837.54 4456,-3837.54 4456,-3911.54"/>
<text text-anchor="middle" x="4308" y="-3899.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4308" y="-3888.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4308" y="-3877.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4308" y="-3866.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4308" y="-3855.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4308" y="-3844.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- ln1_layer_1&#45;&gt;qkv_layer_1_gpu_11 -->
<g id="edge370" class="edge">
<title>ln1_layer_1&#45;&gt;qkv_layer_1_gpu_11</title>
<path fill="none" stroke="black" d="M2880.08,-3969.7C3183.94,-3963.09 3889.73,-3944.77 4149.62,-3911.61"/>
<polygon fill="black" stroke="black" points="4150.34,-3915.05 4159.8,-3910.28 4149.43,-3908.11 4150.34,-3915.05"/>
</g>
<!-- attention_layer_1_gpu_0 -->
<g id="node64" class="node">
<title>attention_layer_1_gpu_0</title>
<polygon fill="#0080ff" stroke="black" points="1040.5,-3801.54 751.5,-3801.54 751.5,-3727.54 1040.5,-3727.54 1040.5,-3801.54"/>
<text text-anchor="middle" x="896" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="896" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="896" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="896" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="896" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="896" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge228" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="black" d="M868.1,-3837.28C871.32,-3828.99 874.79,-3820.09 878.14,-3811.46"/>
<polygon fill="black" stroke="black" points="881.5,-3812.48 881.86,-3801.89 874.98,-3809.94 881.5,-3812.48"/>
</g>
<!-- attention_layer_1_gpu_1 -->
<g id="node65" class="node">
<title>attention_layer_1_gpu_1</title>
<polygon fill="#0f8aff" stroke="black" points="1347.5,-3801.54 1058.5,-3801.54 1058.5,-3727.54 1347.5,-3727.54 1347.5,-3801.54"/>
<text text-anchor="middle" x="1203" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1203" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1203" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1203" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1203" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1203" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge242" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M970.7,-3837.43C1004.75,-3826.89 1042.11,-3815.33 1076.73,-3804.61"/>
<polygon fill="blue" stroke="blue" points="1077.89,-3807.92 1086.41,-3801.62 1075.83,-3801.23 1077.89,-3807.92"/>
</g>
<!-- attention_layer_1_gpu_2 -->
<g id="node66" class="node">
<title>attention_layer_1_gpu_2</title>
<polygon fill="#1e94ff" stroke="black" points="1654.5,-3801.54 1365.5,-3801.54 1365.5,-3727.54 1654.5,-3727.54 1654.5,-3801.54"/>
<text text-anchor="middle" x="1510" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1510" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1510" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1510" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1510" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1510" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge255" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.24,-3839.04C1005.18,-3838.52 1008.1,-3838.02 1011,-3837.54 1160.24,-3812.76 1202.74,-3826.67 1354.95,-3801.81"/>
<polygon fill="blue" stroke="blue" points="1355.85,-3805.21 1365.14,-3800.12 1354.7,-3798.31 1355.85,-3805.21"/>
</g>
<!-- attention_layer_1_gpu_3 -->
<g id="node67" class="node">
<title>attention_layer_1_gpu_3</title>
<polygon fill="#2d9eff" stroke="black" points="1961.5,-3801.54 1672.5,-3801.54 1672.5,-3727.54 1961.5,-3727.54 1961.5,-3801.54"/>
<text text-anchor="middle" x="1817" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1817" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1817" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1817" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1817" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1817" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge268" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.21,-3838.85C1005.16,-3838.39 1008.09,-3837.95 1011,-3837.54 1295.44,-3797.39 1374.46,-3841.92 1661.85,-3801.77"/>
<polygon fill="blue" stroke="blue" points="1662.76,-3805.17 1672.16,-3800.3 1661.77,-3798.24 1662.76,-3805.17"/>
</g>
<!-- attention_layer_1_gpu_4 -->
<g id="node68" class="node">
<title>attention_layer_1_gpu_4</title>
<polygon fill="#3ca8ff" stroke="black" points="2268.5,-3801.54 1979.5,-3801.54 1979.5,-3727.54 2268.5,-3727.54 2268.5,-3801.54"/>
<text text-anchor="middle" x="2124" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2124" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2124" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2124" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2124" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2124" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge281" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.2,-3838.78C1005.15,-3838.34 1008.09,-3837.92 1011,-3837.54 1430.98,-3782.02 1546.08,-3857.51 1969.12,-3801.71"/>
<polygon fill="blue" stroke="blue" points="1969.72,-3805.16 1979.17,-3800.37 1968.8,-3798.22 1969.72,-3805.16"/>
</g>
<!-- attention_layer_1_gpu_5 -->
<g id="node69" class="node">
<title>attention_layer_1_gpu_5</title>
<polygon fill="#4bb2ff" stroke="black" points="2575.5,-3801.54 2286.5,-3801.54 2286.5,-3727.54 2575.5,-3727.54 2575.5,-3801.54"/>
<text text-anchor="middle" x="2431" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2431" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2431" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2431" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2431" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2431" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge294" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.19,-3838.74C1005.15,-3838.31 1008.09,-3837.91 1011,-3837.54 1566.53,-3766.66 1717.63,-3873.16 2276.26,-3801.68"/>
<polygon fill="blue" stroke="blue" points="2276.71,-3805.15 2286.18,-3800.4 2275.81,-3798.21 2276.71,-3805.15"/>
</g>
<!-- attention_layer_1_gpu_6 -->
<g id="node70" class="node">
<title>attention_layer_1_gpu_6</title>
<polygon fill="#5abcff" stroke="black" points="2882.5,-3801.54 2593.5,-3801.54 2593.5,-3727.54 2882.5,-3727.54 2882.5,-3801.54"/>
<text text-anchor="middle" x="2738" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2738" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2738" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2738" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2738" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2738" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge307" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.19,-3838.72C1005.15,-3838.3 1008.09,-3837.9 1011,-3837.54 1702.05,-3751.31 1889.12,-3888.83 2583.19,-3801.69"/>
<polygon fill="blue" stroke="blue" points="2583.7,-3805.15 2593.18,-3800.42 2582.82,-3798.21 2583.7,-3805.15"/>
</g>
<!-- attention_layer_1_gpu_7 -->
<g id="node71" class="node">
<title>attention_layer_1_gpu_7</title>
<polygon fill="#69c6ff" stroke="black" points="3189.5,-3801.54 2900.5,-3801.54 2900.5,-3727.54 3189.5,-3727.54 3189.5,-3801.54"/>
<text text-anchor="middle" x="3045" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3045" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3045" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3045" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3045" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3045" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge320" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.19,-3838.7C1005.15,-3838.29 1008.09,-3837.9 1011,-3837.54 1837.57,-3735.97 2060.59,-3904.51 2890.09,-3801.7"/>
<polygon fill="blue" stroke="blue" points="2890.69,-3805.15 2900.18,-3800.44 2889.83,-3798.2 2890.69,-3805.15"/>
</g>
<!-- attention_layer_1_gpu_8 -->
<g id="node72" class="node">
<title>attention_layer_1_gpu_8</title>
<polygon fill="#78d0ff" stroke="black" points="3496.5,-3801.54 3207.5,-3801.54 3207.5,-3727.54 3496.5,-3727.54 3496.5,-3801.54"/>
<text text-anchor="middle" x="3352" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3352" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3352" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3352" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3352" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3352" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge333" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.19,-3838.69C1005.15,-3838.28 1008.09,-3837.89 1011,-3837.54 1490.44,-3779.28 2699.75,-3860.45 3197.02,-3801.68"/>
<polygon fill="blue" stroke="blue" points="3197.68,-3805.12 3207.18,-3800.45 3196.83,-3798.18 3197.68,-3805.12"/>
</g>
<!-- attention_layer_1_gpu_9 -->
<g id="node73" class="node">
<title>attention_layer_1_gpu_9</title>
<polygon fill="#87daff" stroke="black" points="3803.5,-3801.54 3514.5,-3801.54 3514.5,-3727.54 3803.5,-3727.54 3803.5,-3801.54"/>
<text text-anchor="middle" x="3659" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3659" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3659" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3659" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3659" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3659" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge346" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.19,-3838.68C1005.14,-3838.27 1008.08,-3837.89 1011,-3837.54 1558.16,-3771.61 2938.68,-3868.25 3503.86,-3801.7"/>
<polygon fill="blue" stroke="blue" points="3504.68,-3805.13 3514.18,-3800.45 3503.84,-3798.18 3504.68,-3805.13"/>
</g>
<!-- attention_layer_1_gpu_10 -->
<g id="node74" class="node">
<title>attention_layer_1_gpu_10</title>
<polygon fill="#96e4ff" stroke="black" points="4110.5,-3801.54 3821.5,-3801.54 3821.5,-3727.54 4110.5,-3727.54 4110.5,-3801.54"/>
<text text-anchor="middle" x="3966" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3966" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3966" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3966" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3966" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3966" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge359" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.19,-3838.68C1005.14,-3838.27 1008.08,-3837.89 1011,-3837.54 1625.98,-3763.93 3178.12,-3876.09 3811.01,-3801.68"/>
<polygon fill="blue" stroke="blue" points="3811.67,-3805.13 3821.19,-3800.46 3810.84,-3798.18 3811.67,-3805.13"/>
</g>
<!-- attention_layer_1_gpu_11 -->
<g id="node75" class="node">
<title>attention_layer_1_gpu_11</title>
<polygon fill="#a5eeff" stroke="black" points="4417.5,-3801.54 4128.5,-3801.54 4128.5,-3727.54 4417.5,-3727.54 4417.5,-3801.54"/>
<text text-anchor="middle" x="4273" y="-3789.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4273" y="-3778.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4273" y="-3767.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4273" y="-3756.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4273" y="-3745.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4273" y="-3734.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge372" class="edge">
<title>qkv_layer_1_gpu_0&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.19,-3838.67C1005.14,-3838.27 1008.08,-3837.89 1011,-3837.54 1693.82,-3756.25 3417.63,-3883.94 4118.2,-3801.66"/>
<polygon fill="blue" stroke="blue" points="4118.67,-3805.13 4128.19,-3800.46 4117.84,-3798.18 4118.67,-3805.13"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge229" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1077.05,-3837.43C1051.19,-3827.16 1022.88,-3815.92 996.49,-3805.44"/>
<polygon fill="blue" stroke="blue" points="997.45,-3802.06 986.86,-3801.62 994.87,-3808.56 997.45,-3802.06"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge241" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="black" d="M1179.75,-3837.28C1182.44,-3828.99 1185.32,-3820.09 1188.12,-3811.46"/>
<polygon fill="black" stroke="black" points="1191.47,-3812.48 1191.22,-3801.89 1184.81,-3810.32 1191.47,-3812.48"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge256" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1282.36,-3837.43C1315.58,-3826.93 1352.03,-3815.43 1385.83,-3804.75"/>
<polygon fill="blue" stroke="blue" points="1387.27,-3807.97 1395.75,-3801.62 1385.16,-3801.29 1387.27,-3807.97"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge269" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1316.24,-3839.05C1319.18,-3838.53 1322.1,-3838.02 1325,-3837.54 1471.23,-3813.1 1512.85,-3826.34 1662.14,-3801.78"/>
<polygon fill="blue" stroke="blue" points="1662.85,-3805.21 1672.13,-3800.11 1661.69,-3798.31 1662.85,-3805.21"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge282" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1316.21,-3838.85C1319.16,-3838.39 1322.09,-3837.95 1325,-3837.54 1606.38,-3797.73 1684.57,-3841.58 1968.96,-3801.75"/>
<polygon fill="blue" stroke="blue" points="1969.76,-3805.17 1979.16,-3800.3 1968.77,-3798.24 1969.76,-3805.17"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge295" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1316.2,-3838.78C1319.15,-3838.34 1322.09,-3837.92 1325,-3837.54 1741.91,-3782.36 1856.19,-3857.16 2276.19,-3801.7"/>
<polygon fill="blue" stroke="blue" points="2276.73,-3805.16 2286.17,-3800.37 2275.8,-3798.22 2276.73,-3805.16"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge308" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1316.19,-3838.74C1319.15,-3838.31 1322.09,-3837.91 1325,-3837.54 1877.33,-3767.02 2027.66,-3872.76 2582.9,-3801.73"/>
<polygon fill="blue" stroke="blue" points="2583.71,-3805.15 2593.18,-3800.4 2582.81,-3798.21 2583.71,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge321" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1316.19,-3838.72C1319.15,-3838.3 1322.09,-3837.9 1325,-3837.54 2012.97,-3751.66 2199.21,-3888.48 2890.23,-3801.68"/>
<polygon fill="blue" stroke="blue" points="2890.7,-3805.15 2900.18,-3800.42 2889.82,-3798.21 2890.7,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge334" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1316.19,-3838.7C1319.15,-3838.29 1322.09,-3837.9 1325,-3837.54 2148.49,-3736.32 2370.69,-3904.16 3197.12,-3801.69"/>
<polygon fill="blue" stroke="blue" points="3197.69,-3805.15 3207.18,-3800.44 3196.83,-3798.2 3197.69,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge347" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1316.19,-3838.69C1319.15,-3838.28 1322.09,-3837.89 1325,-3837.54 1802.9,-3779.45 3008.35,-3860.28 3504.05,-3801.68"/>
<polygon fill="blue" stroke="blue" points="3504.68,-3805.12 3514.18,-3800.45 3503.83,-3798.18 3504.68,-3805.12"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge360" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1316.19,-3838.69C1319.14,-3838.27 1322.08,-3837.89 1325,-3837.54 1870.62,-3771.78 3247.28,-3868.07 3810.89,-3801.69"/>
<polygon fill="blue" stroke="blue" points="3811.68,-3805.13 3821.18,-3800.45 3810.84,-3798.18 3811.68,-3805.13"/>
</g>
<!-- qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge373" class="edge">
<title>qkv_layer_1_gpu_1&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1316.19,-3838.68C1319.14,-3838.27 1322.08,-3837.89 1325,-3837.54 1938.45,-3764.1 3486.7,-3875.91 4118.04,-3801.68"/>
<polygon fill="blue" stroke="blue" points="4118.67,-3805.13 4128.19,-3800.46 4117.84,-3798.18 4118.67,-3805.13"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge230" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1333.74,-3839.15C1330.81,-3838.6 1327.89,-3838.06 1325,-3837.54 1206.88,-3816.31 1173.05,-3823.2 1050.73,-3801.6"/>
<polygon fill="blue" stroke="blue" points="1051.06,-3798.1 1040.59,-3799.78 1049.82,-3804.99 1051.06,-3798.1"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge243" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1388.71,-3837.43C1362.07,-3827.11 1332.89,-3815.82 1305.72,-3805.3"/>
<polygon fill="blue" stroke="blue" points="1306.79,-3801.96 1296.2,-3801.62 1304.27,-3808.49 1306.79,-3801.96"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge254" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="black" d="M1491.4,-3837.28C1493.53,-3829.08 1495.81,-3820.28 1498.02,-3811.74"/>
<polygon fill="black" stroke="black" points="1501.45,-3812.45 1500.58,-3801.89 1494.68,-3810.69 1501.45,-3812.45"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge270" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1594.02,-3837.43C1626.56,-3826.93 1662.26,-3815.43 1695.37,-3804.75"/>
<polygon fill="blue" stroke="blue" points="1696.65,-3808.02 1705.09,-3801.62 1694.5,-3801.35 1696.65,-3808.02"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge283" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1630.24,-3839.06C1633.18,-3838.53 1636.1,-3838.03 1639,-3837.54 1782.08,-3813.46 1822.89,-3825.99 1968.9,-3801.83"/>
<polygon fill="blue" stroke="blue" points="1969.85,-3805.22 1979.13,-3800.1 1968.69,-3798.31 1969.85,-3805.22"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge296" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1630.21,-3838.85C1633.16,-3838.39 1636.09,-3837.95 1639,-3837.54 1917.33,-3798.08 1994.67,-3841.23 2276.07,-3801.74"/>
<polygon fill="blue" stroke="blue" points="2276.76,-3805.17 2286.16,-3800.3 2275.77,-3798.24 2276.76,-3805.17"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge309" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1630.2,-3838.78C1633.15,-3838.34 1636.09,-3837.92 1639,-3837.54 2052.74,-3782.72 2166.23,-3856.77 2582.96,-3801.73"/>
<polygon fill="blue" stroke="blue" points="2583.73,-3805.16 2593.17,-3800.36 2582.8,-3798.22 2583.73,-3805.16"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge322" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1630.19,-3838.74C1633.15,-3838.31 1636.09,-3837.91 1639,-3837.54 2188.25,-3767.37 2337.75,-3872.41 2889.96,-3801.72"/>
<polygon fill="blue" stroke="blue" points="2890.71,-3805.15 2900.18,-3800.4 2889.81,-3798.21 2890.71,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge335" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1630.19,-3838.72C1633.15,-3838.3 1636.09,-3837.9 1639,-3837.54 2323.81,-3752.02 2509.27,-3888.09 3197.02,-3801.71"/>
<polygon fill="blue" stroke="blue" points="3197.7,-3805.15 3207.18,-3800.42 3196.82,-3798.21 3197.7,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge348" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1630.19,-3838.7C1633.15,-3838.29 1636.09,-3837.9 1639,-3837.54 2459.41,-3736.67 2680.78,-3903.81 3504.16,-3801.69"/>
<polygon fill="blue" stroke="blue" points="3504.69,-3805.15 3514.18,-3800.43 3503.83,-3798.2 3504.69,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge361" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1630.19,-3838.69C1633.15,-3838.28 1636.09,-3837.89 1639,-3837.54 2115.37,-3779.63 3316.95,-3860.1 3811.08,-3801.67"/>
<polygon fill="blue" stroke="blue" points="3811.68,-3805.12 3821.18,-3800.44 3810.83,-3798.18 3811.68,-3805.12"/>
</g>
<!-- qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge374" class="edge">
<title>qkv_layer_1_gpu_2&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1630.19,-3838.69C1633.14,-3838.27 1636.08,-3837.89 1639,-3837.54 2183.09,-3771.96 3555.87,-3867.9 4117.92,-3801.69"/>
<polygon fill="blue" stroke="blue" points="4118.68,-3805.13 4128.18,-3800.45 4117.84,-3798.18 4118.68,-3805.13"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge231" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1647.79,-3838.87C1644.84,-3838.4 1641.91,-3837.96 1639,-3837.54 1382.71,-3800.58 1311.31,-3838.54 1050.69,-3801.54"/>
<polygon fill="blue" stroke="blue" points="1050.94,-3798.04 1040.55,-3800.08 1049.94,-3804.97 1050.94,-3798.04"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge244" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1647.75,-3839.14C1644.81,-3838.59 1641.89,-3838.05 1639,-3837.54 1517.76,-3815.95 1483.09,-3823.53 1357.59,-3801.57"/>
<polygon fill="blue" stroke="blue" points="1358.05,-3798.1 1347.59,-3799.8 1356.82,-3804.99 1358.05,-3798.1"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge257" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1700.37,-3837.43C1672.94,-3827.07 1642.89,-3815.72 1614.94,-3805.16"/>
<polygon fill="blue" stroke="blue" points="1616.13,-3801.88 1605.54,-3801.62 1613.66,-3808.42 1616.13,-3801.88"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge267" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="black" d="M1803.05,-3837.28C1804.64,-3829.08 1806.36,-3820.28 1808.02,-3811.74"/>
<polygon fill="black" stroke="black" points="1811.46,-3812.37 1809.93,-3801.89 1804.59,-3811.04 1811.46,-3812.37"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge284" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1905.68,-3837.43C1937.54,-3826.93 1972.49,-3815.43 2004.91,-3804.75"/>
<polygon fill="blue" stroke="blue" points="2006.02,-3808.07 2014.43,-3801.62 2003.84,-3801.42 2006.02,-3808.07"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge297" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1944.24,-3839.07C1947.18,-3838.54 1950.11,-3838.03 1953,-3837.54 2093.07,-3813.8 2133,-3825.66 2276.1,-3801.8"/>
<polygon fill="blue" stroke="blue" points="2276.86,-3805.22 2286.13,-3800.09 2275.69,-3798.32 2276.86,-3805.22"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge310" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1944.21,-3838.86C1947.16,-3838.39 1950.09,-3837.95 1953,-3837.54 2228.28,-3798.42 2304.78,-3840.89 2583.17,-3801.72"/>
<polygon fill="blue" stroke="blue" points="2583.76,-3805.17 2593.16,-3800.29 2582.77,-3798.24 2583.76,-3805.17"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge323" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1944.2,-3838.78C1947.15,-3838.34 1950.09,-3837.93 1953,-3837.54 2363.68,-3783.07 2476.33,-3856.43 2890.03,-3801.72"/>
<polygon fill="blue" stroke="blue" points="2890.73,-3805.16 2900.17,-3800.36 2889.8,-3798.22 2890.73,-3805.16"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge336" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1944.19,-3838.74C1947.15,-3838.31 1950.09,-3837.91 1953,-3837.54 2499.18,-3767.72 2647.85,-3872.06 3197.01,-3801.71"/>
<polygon fill="blue" stroke="blue" points="3197.71,-3805.15 3207.18,-3800.4 3196.81,-3798.21 3197.71,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge349" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1944.19,-3838.72C1947.15,-3838.3 1950.09,-3837.9 1953,-3837.54 2634.74,-3752.37 2819.36,-3887.74 3504.07,-3801.7"/>
<polygon fill="blue" stroke="blue" points="3504.7,-3805.15 3514.18,-3800.42 3503.82,-3798.21 3504.7,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge362" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1944.19,-3838.7C1947.15,-3838.29 1950.09,-3837.9 1953,-3837.54 2770.33,-3737.01 2990.88,-3903.45 3811.2,-3801.68"/>
<polygon fill="blue" stroke="blue" points="3811.69,-3805.15 3821.18,-3800.43 3810.83,-3798.2 3811.69,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge375" class="edge">
<title>qkv_layer_1_gpu_3&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1944.19,-3838.69C1947.15,-3838.28 1950.09,-3837.89 1953,-3837.54 2427.83,-3779.8 3625.55,-3859.93 4118.11,-3801.67"/>
<polygon fill="blue" stroke="blue" points="4118.68,-3805.12 4128.18,-3800.44 4117.83,-3798.18 4118.68,-3805.12"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge232" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1961.8,-3838.79C1958.85,-3838.34 1955.91,-3837.93 1953,-3837.54 1558.18,-3784.87 1449.81,-3854.32 1050.62,-3801.52"/>
<polygon fill="blue" stroke="blue" points="1050.91,-3798.03 1040.53,-3800.17 1049.98,-3804.96 1050.91,-3798.03"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge245" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1961.79,-3838.87C1958.84,-3838.4 1955.91,-3837.96 1953,-3837.54 1693.67,-3800.24 1621.41,-3838.87 1357.81,-3801.56"/>
<polygon fill="blue" stroke="blue" points="1357.94,-3798.04 1347.55,-3800.08 1356.94,-3804.97 1357.94,-3798.04"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge258" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1961.75,-3839.12C1958.81,-3838.58 1955.89,-3838.05 1953,-3837.54 1828.77,-3815.62 1793.21,-3823.85 1664.82,-3801.61"/>
<polygon fill="blue" stroke="blue" points="1665.05,-3798.1 1654.59,-3799.81 1663.83,-3804.99 1665.05,-3798.1"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge271" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2012.03,-3837.43C1983.93,-3827.07 1953.14,-3815.72 1924.5,-3805.16"/>
<polygon fill="blue" stroke="blue" points="1925.47,-3801.79 1914.88,-3801.62 1923.05,-3808.36 1925.47,-3801.79"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge280" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="black" d="M2114.7,-3837.28C2115.75,-3829.17 2116.88,-3820.47 2117.97,-3812.02"/>
<polygon fill="black" stroke="black" points="2121.47,-3812.26 2119.29,-3801.89 2114.53,-3811.36 2121.47,-3812.26"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge298" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2217.33,-3837.43C2248.39,-3826.98 2282.43,-3815.52 2314.04,-3804.89"/>
<polygon fill="blue" stroke="blue" points="2315.4,-3808.12 2323.77,-3801.62 2313.17,-3801.49 2315.4,-3808.12"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge311" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2258.24,-3839.08C2261.18,-3838.55 2264.11,-3838.03 2267,-3837.54 2403.92,-3814.17 2443.04,-3825.32 2582.88,-3801.84"/>
<polygon fill="blue" stroke="blue" points="2583.86,-3805.22 2593.13,-3800.09 2582.68,-3798.32 2583.86,-3805.22"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge324" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2258.21,-3838.86C2261.16,-3838.39 2264.09,-3837.95 2267,-3837.54 2539.1,-3798.79 2614.81,-3840.51 2889.87,-3801.77"/>
<polygon fill="blue" stroke="blue" points="2890.76,-3805.17 2900.16,-3800.29 2889.77,-3798.24 2890.76,-3805.17"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge337" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2258.2,-3838.78C2261.15,-3838.34 2264.09,-3837.93 2267,-3837.54 2674.61,-3783.42 2786.44,-3856.08 3197.11,-3801.71"/>
<polygon fill="blue" stroke="blue" points="3197.73,-3805.16 3207.17,-3800.36 3196.8,-3798.22 3197.73,-3805.16"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge350" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2258.19,-3838.74C2261.15,-3838.31 2264.09,-3837.91 2267,-3837.54 2810.11,-3768.07 2957.95,-3871.71 3504.07,-3801.71"/>
<polygon fill="blue" stroke="blue" points="3504.71,-3805.15 3514.18,-3800.4 3503.81,-3798.21 3504.71,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge363" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2258.19,-3838.72C2261.15,-3838.3 2264.09,-3837.9 2267,-3837.54 2945.66,-3752.72 3129.46,-3887.39 3811.11,-3801.7"/>
<polygon fill="blue" stroke="blue" points="3811.7,-3805.15 3821.18,-3800.42 3810.82,-3798.21 3811.7,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge376" class="edge">
<title>qkv_layer_1_gpu_4&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2258.19,-3838.71C2261.15,-3838.29 2264.09,-3837.9 2267,-3837.54 3081.25,-3737.36 3300.97,-3903.1 4118.24,-3801.68"/>
<polygon fill="blue" stroke="blue" points="4118.69,-3805.15 4128.18,-3800.43 4117.83,-3798.2 4118.69,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge233" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2275.81,-3838.75C2272.85,-3838.32 2269.91,-3837.91 2267,-3837.54 1733.54,-3769.16 1588.36,-3870.23 1050.48,-3801.5"/>
<polygon fill="blue" stroke="blue" points="1050.89,-3798.02 1040.53,-3800.21 1050,-3804.96 1050.89,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge246" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2275.8,-3838.79C2272.85,-3838.34 2269.91,-3837.93 2267,-3837.54 1869.12,-3784.52 1759.91,-3854.67 1357.69,-3801.53"/>
<polygon fill="blue" stroke="blue" points="1357.91,-3798.03 1347.53,-3800.17 1356.98,-3804.96 1357.91,-3798.03"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge259" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2275.79,-3838.87C2272.84,-3838.4 2269.91,-3837.96 2267,-3837.54 2004.49,-3799.87 1931.45,-3839.25 1664.53,-3801.52"/>
<polygon fill="blue" stroke="blue" points="1664.94,-3798.04 1654.55,-3800.08 1663.95,-3804.97 1664.94,-3798.04"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge272" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2275.75,-3839.11C2272.81,-3838.57 2269.89,-3838.05 2267,-3837.54 2139.65,-3815.26 2103.26,-3824.19 1971.65,-3801.58"/>
<polygon fill="blue" stroke="blue" points="1972.04,-3798.09 1961.59,-3799.82 1970.84,-3804.99 1972.04,-3798.09"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge285" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2323.69,-3837.43C2294.79,-3827.02 2263.12,-3815.62 2233.69,-3805.03"/>
<polygon fill="blue" stroke="blue" points="2234.81,-3801.71 2224.22,-3801.62 2232.44,-3808.3 2234.81,-3801.71"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge293" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="black" d="M2426.35,-3837.28C2426.88,-3829.17 2427.44,-3820.47 2427.99,-3812.02"/>
<polygon fill="black" stroke="black" points="2431.49,-3812.1 2428.64,-3801.89 2424.5,-3811.64 2431.49,-3812.1"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge312" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2528.99,-3837.43C2559.37,-3826.98 2592.67,-3815.52 2623.59,-3804.89"/>
<polygon fill="blue" stroke="blue" points="2624.79,-3808.18 2633.1,-3801.62 2622.51,-3801.56 2624.79,-3808.18"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge325" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2572.25,-3839.09C2575.19,-3838.55 2578.11,-3838.04 2581,-3837.54 2714.92,-3814.51 2753.16,-3824.99 2890.1,-3801.8"/>
<polygon fill="blue" stroke="blue" points="2890.87,-3805.22 2900.13,-3800.08 2889.68,-3798.32 2890.87,-3805.22"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge338" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2572.21,-3838.86C2575.16,-3838.4 2578.09,-3837.95 2581,-3837.54 2850.05,-3799.13 2924.92,-3840.17 3196.98,-3801.75"/>
<polygon fill="blue" stroke="blue" points="3197.76,-3805.17 3207.16,-3800.29 3196.77,-3798.25 3197.76,-3805.17"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge351" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2572.2,-3838.78C2575.15,-3838.34 2578.09,-3837.93 2581,-3837.54 2985.55,-3783.76 3096.54,-3855.73 3504.18,-3801.7"/>
<polygon fill="blue" stroke="blue" points="3504.73,-3805.16 3514.17,-3800.36 3503.8,-3798.22 3504.73,-3805.16"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge364" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2572.19,-3838.74C2575.15,-3838.31 2578.09,-3837.91 2581,-3837.54 3121.04,-3768.41 3268.05,-3871.36 3811.13,-3801.7"/>
<polygon fill="blue" stroke="blue" points="3811.71,-3805.15 3821.18,-3800.4 3810.81,-3798.21 3811.71,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge377" class="edge">
<title>qkv_layer_1_gpu_5&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2572.19,-3838.72C2575.15,-3838.3 2578.09,-3837.9 2581,-3837.54 3256.59,-3753.06 3439.56,-3887.04 4118.16,-3801.69"/>
<polygon fill="blue" stroke="blue" points="4118.7,-3805.15 4128.18,-3800.42 4117.82,-3798.21 4118.7,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge234" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2589.81,-3838.72C2586.85,-3838.3 2583.91,-3837.9 2581,-3837.54 1908.93,-3753.46 1726.96,-3886.15 1050.52,-3801.5"/>
<polygon fill="blue" stroke="blue" points="1050.88,-3798.02 1040.52,-3800.24 1050.01,-3804.96 1050.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge247" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2589.81,-3838.75C2586.85,-3838.32 2583.91,-3837.91 2581,-3837.54 2044.47,-3768.81 1898.46,-3870.58 1357.54,-3801.5"/>
<polygon fill="blue" stroke="blue" points="1357.89,-3798.02 1347.53,-3800.21 1357,-3804.96 1357.89,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge260" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2589.8,-3838.78C2586.85,-3838.34 2583.91,-3837.93 2581,-3837.54 2179.95,-3784.16 2069.96,-3855.05 1664.47,-3801.5"/>
<polygon fill="blue" stroke="blue" points="1664.91,-3798.03 1654.53,-3800.17 1663.98,-3804.96 1664.91,-3798.03"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge273" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2589.79,-3838.86C2586.84,-3838.4 2583.91,-3837.96 2581,-3837.54 2315.44,-3799.53 2241.56,-3839.59 1971.64,-3801.53"/>
<polygon fill="blue" stroke="blue" points="1971.94,-3798.04 1961.54,-3800.09 1970.95,-3804.97 1971.94,-3798.04"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge286" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2589.75,-3839.1C2586.81,-3838.56 2583.89,-3838.04 2581,-3837.54 2450.51,-3814.89 2413.3,-3824.53 2278.46,-3801.54"/>
<polygon fill="blue" stroke="blue" points="2279.04,-3798.09 2268.59,-3799.83 2277.84,-3804.99 2279.04,-3798.09"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge299" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2635.35,-3837.43C2605.78,-3827.02 2573.37,-3815.62 2543.25,-3805.03"/>
<polygon fill="blue" stroke="blue" points="2544.15,-3801.63 2533.56,-3801.62 2541.83,-3808.24 2544.15,-3801.63"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge306" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="black" d="M2738,-3837.28C2738,-3829.17 2738,-3820.47 2738,-3812.02"/>
<polygon fill="black" stroke="black" points="2741.5,-3811.89 2738,-3801.89 2734.5,-3811.89 2741.5,-3811.89"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge326" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2840.65,-3837.43C2870.22,-3827.02 2902.63,-3815.62 2932.75,-3805.03"/>
<polygon fill="blue" stroke="blue" points="2934.17,-3808.24 2942.44,-3801.62 2931.85,-3801.63 2934.17,-3808.24"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge339" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2886.25,-3839.1C2889.19,-3838.56 2892.11,-3838.04 2895,-3837.54 3025.78,-3814.87 3063.2,-3824.65 3196.9,-3801.84"/>
<polygon fill="blue" stroke="blue" points="3197.87,-3805.23 3207.13,-3800.07 3196.68,-3798.33 3197.87,-3805.23"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge352" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2886.21,-3838.86C2889.16,-3838.4 2892.09,-3837.96 2895,-3837.54 3161,-3799.48 3235.03,-3839.83 3504.1,-3801.74"/>
<polygon fill="blue" stroke="blue" points="3504.76,-3805.18 3514.16,-3800.29 3503.77,-3798.25 3504.76,-3805.18"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge365" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2886.2,-3838.78C2889.15,-3838.34 2892.09,-3837.93 2895,-3837.54 3296.48,-3784.11 3406.64,-3855.39 3811.25,-3801.69"/>
<polygon fill="blue" stroke="blue" points="3811.73,-3805.16 3821.17,-3800.36 3810.8,-3798.22 3811.73,-3805.16"/>
</g>
<!-- qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge378" class="edge">
<title>qkv_layer_1_gpu_6&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2886.19,-3838.75C2889.15,-3838.32 2892.09,-3837.91 2895,-3837.54 3431.97,-3768.76 3578.15,-3871.01 4118.18,-3801.69"/>
<polygon fill="blue" stroke="blue" points="4118.71,-3805.15 4128.18,-3800.4 4117.81,-3798.21 4118.71,-3805.15"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge235" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2903.81,-3838.71C2900.85,-3838.29 2897.91,-3837.9 2895,-3837.54 2084.36,-3737.77 1865.61,-3902.07 1050.74,-3801.53"/>
<polygon fill="blue" stroke="blue" points="1050.88,-3798.02 1040.52,-3800.25 1050.01,-3804.96 1050.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge248" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2903.81,-3838.72C2900.85,-3838.3 2897.91,-3837.9 2895,-3837.54 2219.85,-3753.11 2037.06,-3886.5 1357.56,-3801.5"/>
<polygon fill="blue" stroke="blue" points="1357.88,-3798.02 1347.52,-3800.24 1357.01,-3804.96 1357.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge261" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2903.81,-3838.74C2900.85,-3838.31 2897.91,-3837.91 2895,-3837.54 2355.4,-3768.46 2208.55,-3870.92 1664.59,-3801.51"/>
<polygon fill="blue" stroke="blue" points="1664.89,-3798.02 1654.53,-3800.21 1664,-3804.96 1664.89,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge274" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2903.8,-3838.78C2900.85,-3838.34 2897.91,-3837.93 2895,-3837.54 2490.89,-3783.81 2380.06,-3855.39 1971.55,-3801.51"/>
<polygon fill="blue" stroke="blue" points="1971.91,-3798.03 1961.53,-3800.17 1970.98,-3804.96 1971.91,-3798.03"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge287" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2903.79,-3838.86C2900.84,-3838.4 2897.91,-3837.95 2895,-3837.54 2626.39,-3799.18 2551.66,-3839.93 2278.75,-3801.55"/>
<polygon fill="blue" stroke="blue" points="2278.94,-3798.04 2268.54,-3800.09 2277.95,-3804.97 2278.94,-3798.04"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge300" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2903.75,-3839.09C2900.81,-3838.56 2897.89,-3838.04 2895,-3837.54 2761.51,-3814.56 2723.42,-3824.85 2585.68,-3801.58"/>
<polygon fill="blue" stroke="blue" points="2586.03,-3798.09 2575.58,-3799.84 2584.85,-3804.99 2586.03,-3798.09"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge313" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2947.01,-3837.43C2916.63,-3826.98 2883.33,-3815.52 2852.41,-3804.89"/>
<polygon fill="blue" stroke="blue" points="2853.49,-3801.56 2842.9,-3801.62 2851.21,-3808.18 2853.49,-3801.56"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge319" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="black" d="M3049.65,-3837.28C3049.12,-3829.17 3048.56,-3820.47 3048.01,-3812.02"/>
<polygon fill="black" stroke="black" points="3051.5,-3811.64 3047.36,-3801.89 3044.51,-3812.1 3051.5,-3811.64"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge340" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3152.31,-3837.43C3181.21,-3827.02 3212.88,-3815.62 3242.31,-3805.03"/>
<polygon fill="blue" stroke="blue" points="3243.56,-3808.3 3251.78,-3801.62 3241.19,-3801.71 3243.56,-3808.3"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge353" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3200.25,-3839.11C3203.19,-3838.57 3206.11,-3838.04 3209,-3837.54 3336.78,-3815.21 3373.31,-3824.33 3504.12,-3801.81"/>
<polygon fill="blue" stroke="blue" points="3504.88,-3805.23 3514.12,-3800.06 3503.67,-3798.33 3504.88,-3805.23"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge366" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3200.21,-3838.87C3203.16,-3838.4 3206.09,-3837.96 3209,-3837.54 3471.95,-3799.82 3545.13,-3839.49 3811.21,-3801.72"/>
<polygon fill="blue" stroke="blue" points="3811.76,-3805.18 3821.16,-3800.28 3810.76,-3798.25 3811.76,-3805.18"/>
</g>
<!-- qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge379" class="edge">
<title>qkv_layer_1_gpu_7&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3200.2,-3838.79C3203.15,-3838.34 3206.09,-3837.93 3209,-3837.54 3607.32,-3784.47 3716.69,-3855 4118.03,-3801.72"/>
<polygon fill="blue" stroke="blue" points="4118.73,-3805.16 4128.17,-3800.36 4117.79,-3798.22 4118.73,-3805.16"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge236" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3217.81,-3838.69C3214.85,-3838.28 3211.91,-3837.89 3209,-3837.54 2735.92,-3780 1542.67,-3859.39 1050.58,-3801.48"/>
<polygon fill="blue" stroke="blue" points="1050.87,-3797.99 1040.52,-3800.27 1050.03,-3804.94 1050.87,-3797.99"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge249" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3217.81,-3838.71C3214.85,-3838.29 3211.91,-3837.9 3209,-3837.54 2395.19,-3737.41 2175.66,-3902.46 1357.48,-3801.49"/>
<polygon fill="blue" stroke="blue" points="1357.88,-3798.02 1347.52,-3800.25 1357.01,-3804.96 1357.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge262" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3217.81,-3838.72C3214.85,-3838.3 3211.91,-3837.9 3209,-3837.54 2530.78,-3752.76 2347.16,-3886.85 1664.61,-3801.51"/>
<polygon fill="blue" stroke="blue" points="1664.88,-3798.02 1654.52,-3800.24 1664.01,-3804.96 1664.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge275" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3217.81,-3838.74C3214.85,-3838.31 3211.91,-3837.91 3209,-3837.54 2666.33,-3768.12 2518.65,-3871.27 1971.65,-3801.52"/>
<polygon fill="blue" stroke="blue" points="1971.89,-3798.02 1961.53,-3800.21 1971,-3804.96 1971.89,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge288" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3217.8,-3838.78C3214.85,-3838.34 3211.91,-3837.93 3209,-3837.54 2801.82,-3783.47 2690.16,-3855.74 2278.62,-3801.52"/>
<polygon fill="blue" stroke="blue" points="2278.91,-3798.03 2268.53,-3800.17 2277.98,-3804.96 2278.91,-3798.03"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge301" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3217.79,-3838.86C3214.84,-3838.39 3211.91,-3837.95 3209,-3837.54 2937.21,-3798.82 2861.7,-3840.31 2585.46,-3801.51"/>
<polygon fill="blue" stroke="blue" points="2585.94,-3798.04 2575.54,-3800.09 2584.95,-3804.97 2585.94,-3798.04"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge314" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3217.76,-3839.08C3214.82,-3838.55 3211.89,-3838.03 3209,-3837.54 3072.37,-3814.19 3033.45,-3825.19 2892.46,-3801.54"/>
<polygon fill="blue" stroke="blue" points="2893.03,-3798.09 2882.58,-3799.85 2891.85,-3804.99 2893.03,-3798.09"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge327" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3258.67,-3837.43C3227.61,-3826.98 3193.57,-3815.52 3161.96,-3804.89"/>
<polygon fill="blue" stroke="blue" points="3162.83,-3801.49 3152.23,-3801.62 3160.6,-3808.12 3162.83,-3801.49"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge332" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="black" d="M3361.3,-3837.28C3360.25,-3829.17 3359.12,-3820.47 3358.03,-3812.02"/>
<polygon fill="black" stroke="black" points="3361.47,-3811.36 3356.71,-3801.89 3354.53,-3812.26 3361.47,-3811.36"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge354" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3463.97,-3837.43C3492.07,-3827.07 3522.86,-3815.72 3551.5,-3805.16"/>
<polygon fill="blue" stroke="blue" points="3552.95,-3808.36 3561.12,-3801.62 3550.53,-3801.79 3552.95,-3808.36"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge367" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3514.25,-3839.12C3517.19,-3838.58 3520.11,-3838.05 3523,-3837.54 3647.66,-3815.57 3683.36,-3823.99 3810.96,-3801.84"/>
<polygon fill="blue" stroke="blue" points="3811.88,-3805.23 3821.12,-3800.05 3810.67,-3798.34 3811.88,-3805.23"/>
</g>
<!-- qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge380" class="edge">
<title>qkv_layer_1_gpu_8&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3514.21,-3838.87C3517.16,-3838.4 3520.09,-3837.96 3523,-3837.54 3782.77,-3800.19 3855.17,-3839.11 4117.93,-3801.76"/>
<polygon fill="blue" stroke="blue" points="4118.76,-3805.18 4128.16,-3800.28 4117.76,-3798.25 4118.76,-3805.18"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge237" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3531.81,-3838.69C3528.86,-3838.27 3525.92,-3837.89 3523,-3837.54 2980.67,-3772.16 1612.36,-3867.31 1050.77,-3801.51"/>
<polygon fill="blue" stroke="blue" points="1050.87,-3797.99 1040.52,-3800.28 1050.03,-3804.94 1050.87,-3797.99"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge250" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3531.81,-3838.69C3528.85,-3838.28 3525.91,-3837.89 3523,-3837.54 3048.39,-3779.82 1851.27,-3859.56 1357.61,-3801.49"/>
<polygon fill="blue" stroke="blue" points="1357.87,-3797.99 1347.52,-3800.27 1357.03,-3804.94 1357.87,-3797.99"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge263" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3531.81,-3838.7C3528.85,-3838.29 3525.91,-3837.9 3523,-3837.54 2706.11,-3737.06 2485.75,-3902.81 1664.52,-3801.5"/>
<polygon fill="blue" stroke="blue" points="1664.88,-3798.02 1654.52,-3800.25 1664.01,-3804.96 1664.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge276" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3531.81,-3838.72C3528.85,-3838.3 3525.91,-3837.9 3523,-3837.54 2841.7,-3752.42 2657.26,-3887.2 1971.65,-3801.52"/>
<polygon fill="blue" stroke="blue" points="1971.88,-3798.02 1961.52,-3800.24 1971.01,-3804.96 1971.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge289" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3531.81,-3838.74C3528.85,-3838.31 3525.91,-3837.91 3523,-3837.54 2977.26,-3767.77 2828.75,-3871.62 2278.71,-3801.52"/>
<polygon fill="blue" stroke="blue" points="2278.89,-3798.02 2268.53,-3800.21 2278,-3804.96 2278.89,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge302" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3531.8,-3838.78C3528.85,-3838.34 3525.91,-3837.93 3523,-3837.54 3112.76,-3783.12 3000.26,-3856.08 2585.69,-3801.53"/>
<polygon fill="blue" stroke="blue" points="2585.91,-3798.03 2575.53,-3800.17 2584.98,-3804.96 2585.91,-3798.03"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge315" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3531.79,-3838.86C3528.84,-3838.39 3525.91,-3837.95 3523,-3837.54 3248.15,-3798.47 3171.8,-3840.65 2892.56,-3801.52"/>
<polygon fill="blue" stroke="blue" points="2892.94,-3798.04 2882.54,-3800.09 2891.95,-3804.97 2892.94,-3798.04"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge328" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3531.76,-3839.07C3528.82,-3838.54 3525.89,-3838.03 3523,-3837.54 3383.36,-3813.85 3343.57,-3825.52 3199.67,-3801.57"/>
<polygon fill="blue" stroke="blue" points="3200.02,-3798.08 3189.58,-3799.86 3198.86,-3804.98 3200.02,-3798.08"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge341" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3570.32,-3837.43C3538.46,-3826.93 3503.51,-3815.43 3471.09,-3804.75"/>
<polygon fill="blue" stroke="blue" points="3472.16,-3801.42 3461.57,-3801.62 3469.98,-3808.07 3472.16,-3801.42"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge345" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="black" d="M3672.95,-3837.28C3671.36,-3829.08 3669.64,-3820.28 3667.98,-3811.74"/>
<polygon fill="black" stroke="black" points="3671.41,-3811.04 3666.07,-3801.89 3664.54,-3812.37 3671.41,-3811.04"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge368" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3775.63,-3837.43C3803.06,-3827.07 3833.11,-3815.72 3861.06,-3805.16"/>
<polygon fill="blue" stroke="blue" points="3862.34,-3808.42 3870.46,-3801.62 3859.87,-3801.88 3862.34,-3808.42"/>
</g>
<!-- qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge381" class="edge">
<title>qkv_layer_1_gpu_9&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3828.25,-3839.13C3831.19,-3838.59 3834.11,-3838.05 3837,-3837.54 3958.66,-3815.91 3993.48,-3823.67 4118.19,-3801.8"/>
<polygon fill="blue" stroke="blue" points="4118.89,-3805.23 4128.12,-3800.03 4117.66,-3798.34 4118.89,-3805.23"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge238" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3845.81,-3838.68C3842.86,-3838.27 3839.92,-3837.89 3837,-3837.54 3225.31,-3764.3 1681.54,-3875.27 1050.66,-3801.49"/>
<polygon fill="blue" stroke="blue" points="1050.86,-3797.99 1040.52,-3800.28 1050.03,-3804.94 1050.86,-3797.99"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge251" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3845.81,-3838.69C3842.86,-3838.27 3839.92,-3837.89 3837,-3837.54 3293.13,-3771.98 1920.95,-3867.48 1357.8,-3801.51"/>
<polygon fill="blue" stroke="blue" points="1357.86,-3797.99 1347.52,-3800.28 1357.03,-3804.94 1357.86,-3797.99"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge264" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3845.81,-3838.69C3842.85,-3838.28 3839.91,-3837.89 3837,-3837.54 3360.85,-3779.65 2159.87,-3859.73 1664.65,-3801.49"/>
<polygon fill="blue" stroke="blue" points="1664.87,-3797.99 1654.52,-3800.27 1664.03,-3804.94 1664.87,-3797.99"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge277" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3845.81,-3838.7C3842.85,-3838.29 3839.91,-3837.9 3837,-3837.54 3017.03,-3736.71 2795.85,-3903.17 1971.55,-3801.5"/>
<polygon fill="blue" stroke="blue" points="1971.88,-3798.02 1961.52,-3800.25 1971.01,-3804.96 1971.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge290" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3845.81,-3838.72C3842.85,-3838.3 3839.91,-3837.9 3837,-3837.54 3152.63,-3752.07 2967.35,-3887.55 2278.7,-3801.52"/>
<polygon fill="blue" stroke="blue" points="2278.88,-3798.02 2268.52,-3800.24 2278.01,-3804.96 2278.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge303" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3845.81,-3838.74C3842.85,-3838.31 3839.91,-3837.91 3837,-3837.54 3288.18,-3767.42 3138.85,-3871.97 2585.76,-3801.53"/>
<polygon fill="blue" stroke="blue" points="2585.89,-3798.02 2575.53,-3800.21 2585,-3804.96 2585.89,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge316" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3845.8,-3838.78C3842.85,-3838.34 3839.91,-3837.92 3837,-3837.54 3423.59,-3782.76 3310.31,-3856.46 2892.46,-3801.5"/>
<polygon fill="blue" stroke="blue" points="2892.91,-3798.03 2882.53,-3800.17 2891.98,-3804.96 2892.91,-3798.03"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge329" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3845.79,-3838.85C3842.84,-3838.39 3839.91,-3837.95 3837,-3837.54 3559.1,-3798.13 3481.91,-3840.99 3199.67,-3801.53"/>
<polygon fill="blue" stroke="blue" points="3199.94,-3798.04 3189.54,-3800.1 3198.95,-3804.97 3199.94,-3798.04"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge342" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3845.76,-3839.06C3842.82,-3838.54 3839.9,-3838.03 3837,-3837.54 3694.35,-3813.51 3653.69,-3825.84 3506.87,-3801.6"/>
<polygon fill="blue" stroke="blue" points="3507.02,-3798.08 3496.58,-3799.87 3505.86,-3804.98 3507.02,-3798.08"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge355" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3881.98,-3837.43C3849.44,-3826.93 3813.74,-3815.43 3780.63,-3804.75"/>
<polygon fill="blue" stroke="blue" points="3781.5,-3801.35 3770.91,-3801.62 3779.35,-3808.02 3781.5,-3801.35"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge358" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="black" d="M3984.6,-3837.28C3982.47,-3829.08 3980.19,-3820.28 3977.98,-3811.74"/>
<polygon fill="black" stroke="black" points="3981.32,-3810.69 3975.42,-3801.89 3974.55,-3812.45 3981.32,-3810.69"/>
</g>
<!-- qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge382" class="edge">
<title>qkv_layer_1_gpu_10&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4087.29,-3837.43C4113.93,-3827.11 4143.11,-3815.82 4170.28,-3805.3"/>
<polygon fill="blue" stroke="blue" points="4171.73,-3808.49 4179.8,-3801.62 4169.21,-3801.96 4171.73,-3808.49"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_0 -->
<g id="edge239" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4159.81,-3838.67C4156.86,-3838.27 4153.92,-3837.89 4151,-3837.54 3469.93,-3756.45 1750.62,-3883.25 1050.49,-3801.48"/>
<polygon fill="blue" stroke="blue" points="1050.86,-3797.99 1040.52,-3800.29 1050.03,-3804.95 1050.86,-3797.99"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_1 -->
<g id="edge252" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4159.81,-3838.68C4156.86,-3838.27 4153.92,-3837.89 4151,-3837.54 3537.77,-3764.13 1990.12,-3875.44 1357.68,-3801.5"/>
<polygon fill="blue" stroke="blue" points="1357.86,-3797.99 1347.52,-3800.28 1357.03,-3804.94 1357.86,-3797.99"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_2 -->
<g id="edge265" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4159.81,-3838.69C4156.86,-3838.27 4153.92,-3837.89 4151,-3837.54 3605.6,-3771.81 2229.54,-3867.65 1664.83,-3801.51"/>
<polygon fill="blue" stroke="blue" points="1664.86,-3797.99 1654.52,-3800.28 1664.03,-3804.94 1664.86,-3797.99"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_3 -->
<g id="edge278" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4159.81,-3838.69C4156.85,-3838.28 4153.91,-3837.89 4151,-3837.54 3673.32,-3779.48 2468.47,-3859.91 1971.68,-3801.49"/>
<polygon fill="blue" stroke="blue" points="1971.87,-3797.99 1961.52,-3800.27 1971.03,-3804.94 1971.87,-3797.99"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_4 -->
<g id="edge291" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4159.81,-3838.7C4156.85,-3838.29 4153.91,-3837.9 4151,-3837.54 3327.95,-3736.37 3105.95,-3903.52 2278.59,-3801.51"/>
<polygon fill="blue" stroke="blue" points="2278.88,-3798.02 2268.52,-3800.26 2278.01,-3804.96 2278.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_5 -->
<g id="edge304" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4159.81,-3838.72C4156.85,-3838.3 4153.91,-3837.9 4151,-3837.54 3463.47,-3751.71 3277.41,-3887.93 2585.49,-3801.49"/>
<polygon fill="blue" stroke="blue" points="2585.88,-3798.02 2575.52,-3800.24 2585.01,-3804.96 2585.88,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_6 -->
<g id="edge317" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4159.81,-3838.74C4156.85,-3838.31 4153.91,-3837.91 4151,-3837.54 3599.11,-3767.07 3448.95,-3872.32 2892.82,-3801.54"/>
<polygon fill="blue" stroke="blue" points="2892.89,-3798.02 2882.53,-3800.22 2892,-3804.96 2892.89,-3798.02"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_7 -->
<g id="edge330" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4159.8,-3838.78C4156.85,-3838.34 4153.91,-3837.92 4151,-3837.54 3734.53,-3782.41 3620.41,-3856.81 3199.53,-3801.51"/>
<polygon fill="blue" stroke="blue" points="3199.91,-3798.03 3189.53,-3800.18 3198.98,-3804.96 3199.91,-3798.03"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_8 -->
<g id="edge343" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4159.79,-3838.85C4156.84,-3838.39 4153.91,-3837.95 4151,-3837.54 3870.05,-3797.78 3792.02,-3841.33 3506.78,-3801.55"/>
<polygon fill="blue" stroke="blue" points="3506.93,-3798.04 3496.54,-3800.1 3505.95,-3804.97 3506.93,-3798.04"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_9 -->
<g id="edge356" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4159.76,-3839.05C4156.82,-3838.53 4153.9,-3838.02 4151,-3837.54 4005.2,-3813.15 3963.72,-3826.19 3813.62,-3801.56"/>
<polygon fill="blue" stroke="blue" points="3814.02,-3798.08 3803.58,-3799.88 3812.86,-3804.98 3814.02,-3798.08"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_10 -->
<g id="edge369" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4193.64,-3837.43C4160.42,-3826.93 4123.97,-3815.43 4090.17,-3804.75"/>
<polygon fill="blue" stroke="blue" points="4090.84,-3801.29 4080.25,-3801.62 4088.73,-3807.97 4090.84,-3801.29"/>
</g>
<!-- qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_11 -->
<g id="edge371" class="edge">
<title>qkv_layer_1_gpu_11&#45;&gt;attention_layer_1_gpu_11</title>
<path fill="none" stroke="black" d="M4296.25,-3837.28C4293.56,-3828.99 4290.68,-3820.09 4287.88,-3811.46"/>
<polygon fill="black" stroke="black" points="4291.19,-3810.32 4284.78,-3801.89 4284.53,-3812.48 4291.19,-3810.32"/>
</g>
<!-- attention_agg_layer_1 -->
<g id="node76" class="node">
<title>attention_agg_layer_1</title>
<polygon fill="#ffcccc" stroke="black" points="3055.49,-3691.54 2550.43,-3691.54 2420.51,-3587.54 2925.57,-3587.54 3055.49,-3691.54"/>
<text text-anchor="middle" x="2738" y="-3653.54" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="2738" y="-3642.54" font-family="Arial" font-size="10.00">Input: [12Ã— batch_size=1024, seq_len=2048, heads=2&#45;3, d_k=128]</text>
<text text-anchor="middle" x="2738" y="-3631.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2738" y="-3620.54" font-family="Arial" font-size="10.00">GPU: all attention GPUs</text>
</g>
<!-- attention_layer_1_gpu_0&#45;&gt;attention_agg_layer_1 -->
<g id="edge383" class="edge">
<title>attention_layer_1_gpu_0&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M1040.54,-3728.96C1043.72,-3728.46 1046.87,-3727.98 1050,-3727.54 1319.41,-3689.42 2084.3,-3660.87 2485.43,-3648.03"/>
<polygon fill="black" stroke="black" points="2485.54,-3651.53 2495.43,-3647.72 2485.32,-3644.54 2485.54,-3651.53"/>
</g>
<!-- attention_layer_1_gpu_1&#45;&gt;attention_agg_layer_1 -->
<g id="edge384" class="edge">
<title>attention_layer_1_gpu_1&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M1347.55,-3729.01C1350.72,-3728.49 1353.88,-3728 1357,-3727.54 1745.98,-3670.23 2202.04,-3650.64 2480.43,-3643.96"/>
<polygon fill="black" stroke="black" points="2480.76,-3647.46 2490.67,-3643.72 2480.59,-3640.46 2480.76,-3647.46"/>
</g>
<!-- attention_layer_1_gpu_2&#45;&gt;attention_agg_layer_1 -->
<g id="edge385" class="edge">
<title>attention_layer_1_gpu_2&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M1654.56,-3729.09C1657.73,-3728.54 1660.88,-3728.03 1664,-3727.54 1944.43,-3683.65 2269.72,-3661.23 2488.19,-3650.24"/>
<polygon fill="black" stroke="black" points="2488.37,-3653.73 2498.19,-3649.74 2488.02,-3646.74 2488.37,-3653.73"/>
</g>
<!-- attention_layer_1_gpu_3&#45;&gt;attention_agg_layer_1 -->
<g id="edge386" class="edge">
<title>attention_layer_1_gpu_3&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M1961.58,-3729.22C1964.75,-3728.64 1967.89,-3728.08 1971,-3727.54 2147.04,-3697.09 2347.73,-3674.76 2499.66,-3660.35"/>
<polygon fill="black" stroke="black" points="2500.43,-3663.79 2510.05,-3659.37 2499.77,-3656.82 2500.43,-3663.79"/>
</g>
<!-- attention_layer_1_gpu_4&#45;&gt;attention_agg_layer_1 -->
<g id="edge387" class="edge">
<title>attention_layer_1_gpu_4&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M2268.64,-3729.54C2271.79,-3728.86 2274.91,-3728.19 2278,-3727.54 2357.69,-3710.7 2445.48,-3693.71 2522.82,-3679.27"/>
<polygon fill="black" stroke="black" points="2523.49,-3682.7 2532.68,-3677.43 2522.21,-3675.82 2523.49,-3682.7"/>
</g>
<!-- attention_layer_1_gpu_5&#45;&gt;attention_agg_layer_1 -->
<g id="edge388" class="edge">
<title>attention_layer_1_gpu_5&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M2521.04,-3727.47C2546.12,-3717.42 2573.95,-3706.27 2601.08,-3695.4"/>
<polygon fill="black" stroke="black" points="2602.66,-3698.53 2610.64,-3691.56 2600.06,-3692.03 2602.66,-3698.53"/>
</g>
<!-- attention_layer_1_gpu_6&#45;&gt;attention_agg_layer_1 -->
<g id="edge389" class="edge">
<title>attention_layer_1_gpu_6&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M2738,-3727.3C2738,-3719.25 2738,-3710.51 2738,-3701.77"/>
<polygon fill="black" stroke="black" points="2741.5,-3701.56 2738,-3691.56 2734.5,-3701.56 2741.5,-3701.56"/>
</g>
<!-- attention_layer_1_gpu_7&#45;&gt;attention_agg_layer_1 -->
<g id="edge390" class="edge">
<title>attention_layer_1_gpu_7&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M2954.96,-3727.47C2929.88,-3717.42 2902.05,-3706.27 2874.92,-3695.4"/>
<polygon fill="black" stroke="black" points="2875.94,-3692.03 2865.36,-3691.56 2873.34,-3698.53 2875.94,-3692.03"/>
</g>
<!-- attention_layer_1_gpu_8&#45;&gt;attention_agg_layer_1 -->
<g id="edge391" class="edge">
<title>attention_layer_1_gpu_8&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M3207.48,-3729.35C3204.63,-3728.74 3201.8,-3728.13 3199,-3727.54 3144.32,-3715.95 3085.82,-3704.32 3029.49,-3693.51"/>
<polygon fill="black" stroke="black" points="3029.85,-3690.02 3019.37,-3691.57 3028.53,-3696.89 3029.85,-3690.02"/>
</g>
<!-- attention_layer_1_gpu_9&#45;&gt;attention_agg_layer_1 -->
<g id="edge392" class="edge">
<title>attention_layer_1_gpu_9&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M3514.13,-3728.99C3511.4,-3728.49 3508.69,-3728.01 3506,-3727.54 3350.59,-3700.55 3175.96,-3680 3032.54,-3665.67"/>
<polygon fill="black" stroke="black" points="3032.57,-3662.16 3022.27,-3664.65 3031.87,-3669.12 3032.57,-3662.16"/>
</g>
<!-- attention_layer_1_gpu_10&#45;&gt;attention_agg_layer_1 -->
<g id="edge393" class="edge">
<title>attention_layer_1_gpu_10&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M3821.15,-3728.87C3818.41,-3728.41 3815.7,-3727.96 3813,-3727.54 3543.75,-3685.21 3233.13,-3662.89 3015.24,-3651.51"/>
<polygon fill="black" stroke="black" points="3015.1,-3648 3004.93,-3650.98 3014.74,-3654.99 3015.1,-3648"/>
</g>
<!-- attention_layer_1_gpu_11&#45;&gt;attention_agg_layer_1 -->
<g id="edge394" class="edge">
<title>attention_layer_1_gpu_11&#45;&gt;attention_agg_layer_1</title>
<path fill="none" stroke="black" d="M4128.16,-3728.81C4125.42,-3728.36 4122.7,-3727.94 4120,-3727.54 3735.63,-3670.63 3285.73,-3650.9 3006.25,-3644.09"/>
<polygon fill="black" stroke="black" points="3006.05,-3640.59 2995.97,-3643.84 3005.89,-3647.58 3006.05,-3640.59"/>
</g>
<!-- out_proj_layer_1 -->
<g id="node77" class="node">
<title>out_proj_layer_1</title>
<polygon fill="#0080ff" stroke="black" points="3481,-3551.54 3197,-3551.54 3197,-3499.54 3481,-3499.54 3481,-3551.54"/>
<text text-anchor="middle" x="3339" y="-3539.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3339" y="-3528.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3339" y="-3517.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3339" y="-3506.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- attention_agg_layer_1&#45;&gt;out_proj_layer_1 -->
<g id="edge395" class="edge">
<title>attention_agg_layer_1&#45;&gt;out_proj_layer_1</title>
<path fill="none" stroke="black" d="M2941.89,-3600.54C3024.8,-3585.09 3118.7,-3567.59 3194.36,-3553.49"/>
<polygon fill="black" stroke="black" points="3195.25,-3556.89 3204.44,-3551.62 3193.97,-3550.01 3195.25,-3556.89"/>
</g>
<!-- out_proj_layer_1&#45;&gt;residual1_layer_1 -->
<g id="edge396" class="edge">
<title>out_proj_layer_1&#45;&gt;residual1_layer_1</title>
<path fill="none" stroke="black" d="M3473.73,-3499.47C3550.9,-3485.12 3649.33,-3466.8 3735.93,-3450.69"/>
<polygon fill="black" stroke="black" points="3736.69,-3454.11 3745.88,-3448.84 3735.41,-3447.23 3736.69,-3454.11"/>
</g>
<!-- ln2_layer_1 -->
<g id="node79" class="node">
<title>ln2_layer_1</title>
<polygon fill="#0080ff" stroke="black" points="3387,-3323.54 3103,-3323.54 3103,-3271.54 3387,-3271.54 3387,-3323.54"/>
<text text-anchor="middle" x="3245" y="-3311.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="3245" y="-3300.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3245" y="-3289.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3245" y="-3278.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_layer_1&#45;&gt;ln2_layer_1 -->
<g id="edge398" class="edge">
<title>residual1_layer_1&#45;&gt;ln2_layer_1</title>
<path fill="none" stroke="black" d="M3643.81,-3362.72C3558.77,-3349.03 3469.59,-3334.68 3397.18,-3323.03"/>
<polygon fill="black" stroke="black" points="3397.5,-3319.54 3387.08,-3321.4 3396.39,-3326.45 3397.5,-3319.54"/>
</g>
<!-- residual2_layer_1 -->
<g id="node98" class="node">
<title>residual2_layer_1</title>
<polygon fill="#ffffcc" stroke="black" points="4265.82,-2867.54 3787.28,-2867.54 3664.18,-2763.54 4142.72,-2763.54 4265.82,-2867.54"/>
<text text-anchor="middle" x="3965" y="-2829.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="3965" y="-2818.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3965" y="-2807.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3965" y="-2796.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_layer_1&#45;&gt;residual2_layer_1 -->
<g id="edge449" class="edge">
<title>residual1_layer_1&#45;&gt;residual2_layer_1</title>
<path fill="none" stroke="black" d="M4164.78,-3398.33C4571.65,-3373.11 5391,-3307.11 5391,-3184.54 5391,-3184.54 5391,-3184.54 5391,-3068.54 5391,-3056.57 5390.35,-3051.01 5381,-3043.54 5207.57,-2904.83 4588.25,-2849.21 4228.69,-2828.23"/>
<polygon fill="black" stroke="black" points="4228.84,-2824.74 4218.66,-2827.65 4228.44,-2831.72 4228.84,-2824.74"/>
</g>
<!-- gate_layer_1 -->
<g id="node80" class="node">
<title>gate_layer_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3379.43,-3235.54 2920.6,-3235.54 2802.57,-3131.54 3261.4,-3131.54 3379.43,-3235.54"/>
<text text-anchor="middle" x="3091" y="-3197.54" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="3091" y="-3186.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3091" y="-3175.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="3091" y="-3164.54" font-family="Arial" font-size="10.00">GPU: all MoE GPUs (12&#45;15)</text>
</g>
<!-- ln2_layer_1&#45;&gt;gate_layer_1 -->
<g id="edge399" class="edge">
<title>ln2_layer_1&#45;&gt;gate_layer_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3210.44,-3271.4C3198.28,-3262.56 3184.07,-3252.23 3169.78,-3241.83"/>
<polygon fill="black" stroke="black" points="3171.52,-3238.77 3161.37,-3235.72 3167.4,-3244.43 3171.52,-3238.77"/>
</g>
<!-- expert_layer_1_expert_0_gpu_12 -->
<g id="node81" class="node">
<title>expert_layer_1_expert_0_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3258,-3095.54 2974,-3095.54 2974,-3043.54 3258,-3043.54 3258,-3095.54"/>
<text text-anchor="middle" x="3116" y="-3083.54" font-family="Arial" font-size="10.00">Expert0</text>
<text text-anchor="middle" x="3116" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3116" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3116" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_0_gpu_12 -->
<g id="edge401" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_0_gpu_12</title>
<path fill="none" stroke="black" d="M3345.64,-3271.51C3362.4,-3262.84 3377.66,-3251.19 3388,-3235.54 3413.48,-3196.97 3416.89,-3167.62 3388,-3131.54 3379.48,-3120.89 3325.72,-3107.79 3268.21,-3096.47"/>
<polygon fill="black" stroke="black" points="3268.69,-3092.99 3258.2,-3094.52 3267.35,-3099.87 3268.69,-3092.99"/>
</g>
<!-- expert_layer_1_expert_1_gpu_12 -->
<g id="node82" class="node">
<title>expert_layer_1_expert_1_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3560,-3095.54 3276,-3095.54 3276,-3043.54 3560,-3043.54 3560,-3095.54"/>
<text text-anchor="middle" x="3418" y="-3083.54" font-family="Arial" font-size="10.00">Expert1</text>
<text text-anchor="middle" x="3418" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3418" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3418" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_1_gpu_12 -->
<g id="edge403" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_1_gpu_12</title>
<path fill="none" stroke="black" d="M3357.19,-3271.41C3374.9,-3262.76 3391.22,-3251.15 3403,-3235.54 3431.07,-3198.34 3429.62,-3142.14 3424.77,-3105.89"/>
<polygon fill="black" stroke="black" points="3428.2,-3105.15 3423.26,-3095.78 3421.28,-3106.18 3428.2,-3105.15"/>
</g>
<!-- expert_layer_1_expert_2_gpu_12 -->
<g id="node83" class="node">
<title>expert_layer_1_expert_2_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3862,-3095.54 3578,-3095.54 3578,-3043.54 3862,-3043.54 3862,-3095.54"/>
<text text-anchor="middle" x="3720" y="-3083.54" font-family="Arial" font-size="10.00">Expert2</text>
<text text-anchor="middle" x="3720" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3720" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3720" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_2_gpu_12 -->
<g id="edge405" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_2_gpu_12</title>
<path fill="none" stroke="black" d="M3325.81,-3271.52C3355.82,-3261.41 3389.88,-3248.96 3420,-3235.54 3511.41,-3194.81 3612.34,-3136.29 3670.73,-3100.99"/>
<polygon fill="black" stroke="black" points="3672.65,-3103.93 3679.38,-3095.75 3669.02,-3097.94 3672.65,-3103.93"/>
</g>
<!-- expert_layer_1_expert_3_gpu_12 -->
<g id="node84" class="node">
<title>expert_layer_1_expert_3_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="4164,-3095.54 3880,-3095.54 3880,-3043.54 4164,-3043.54 4164,-3095.54"/>
<text text-anchor="middle" x="4022" y="-3083.54" font-family="Arial" font-size="10.00">Expert3</text>
<text text-anchor="middle" x="4022" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4022" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4022" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_3_gpu_12 -->
<g id="edge407" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_3_gpu_12</title>
<path fill="none" stroke="black" d="M3371.49,-3271.52C3418.96,-3261.39 3473.21,-3248.93 3522,-3235.54 3673.22,-3194.05 3846.28,-3134.08 3944.01,-3099.02"/>
<polygon fill="black" stroke="black" points="3945.3,-3102.28 3953.52,-3095.61 3942.93,-3095.69 3945.3,-3102.28"/>
</g>
<!-- expert_layer_1_expert_4_gpu_13 -->
<g id="node85" class="node">
<title>expert_layer_1_expert_4_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="4466,-3095.54 4182,-3095.54 4182,-3043.54 4466,-3043.54 4466,-3095.54"/>
<text text-anchor="middle" x="4324" y="-3083.54" font-family="Arial" font-size="10.00">Expert4</text>
<text text-anchor="middle" x="4324" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4324" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4324" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_4_gpu_13 -->
<g id="edge409" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_4_gpu_13</title>
<path fill="none" stroke="black" d="M3387.35,-3281.23C3474.57,-3270.79 3588.23,-3255.28 3688,-3235.54 3883.02,-3196.95 4107.27,-3134.43 4230.57,-3098.45"/>
<polygon fill="black" stroke="black" points="4231.75,-3101.75 4240.36,-3095.59 4229.78,-3095.03 4231.75,-3101.75"/>
</g>
<!-- expert_layer_1_expert_5_gpu_13 -->
<g id="node86" class="node">
<title>expert_layer_1_expert_5_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="4768,-3095.54 4484,-3095.54 4484,-3043.54 4768,-3043.54 4768,-3095.54"/>
<text text-anchor="middle" x="4626" y="-3083.54" font-family="Arial" font-size="10.00">Expert5</text>
<text text-anchor="middle" x="4626" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4626" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4626" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_5_gpu_13 -->
<g id="edge411" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_5_gpu_13</title>
<path fill="none" stroke="black" d="M3387.3,-3288.86C3521.43,-3280.34 3727.74,-3263.88 3905,-3235.54 4128.51,-3199.8 4386.05,-3135.05 4524.79,-3098.18"/>
<polygon fill="black" stroke="black" points="4525.81,-3101.53 4534.58,-3095.58 4524.01,-3094.77 4525.81,-3101.53"/>
</g>
<!-- expert_layer_1_expert_6_gpu_13 -->
<g id="node87" class="node">
<title>expert_layer_1_expert_6_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="5070,-3095.54 4786,-3095.54 4786,-3043.54 5070,-3043.54 5070,-3095.54"/>
<text text-anchor="middle" x="4928" y="-3083.54" font-family="Arial" font-size="10.00">Expert6</text>
<text text-anchor="middle" x="4928" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4928" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4928" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_6_gpu_13 -->
<g id="edge413" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_6_gpu_13</title>
<path fill="none" stroke="black" d="M3387.27,-3293.2C3566.23,-3287.57 3882.63,-3272.88 4151,-3235.54 4393.34,-3201.82 4672.99,-3135.59 4821.82,-3098.1"/>
<polygon fill="black" stroke="black" points="4823.03,-3101.41 4831.87,-3095.56 4821.32,-3094.62 4823.03,-3101.41"/>
</g>
<!-- expert_layer_1_expert_7_gpu_13 -->
<g id="node88" class="node">
<title>expert_layer_1_expert_7_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="5372,-3095.54 5088,-3095.54 5088,-3043.54 5372,-3043.54 5372,-3095.54"/>
<text text-anchor="middle" x="5230" y="-3083.54" font-family="Arial" font-size="10.00">Expert7</text>
<text text-anchor="middle" x="5230" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5230" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5230" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_7_gpu_13 -->
<g id="edge415" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_7_gpu_13</title>
<path fill="none" stroke="black" d="M3387.43,-3295.88C3608.32,-3293.33 4046.48,-3282.19 4415,-3235.54 4670.24,-3203.23 4965.07,-3135.94 5120.68,-3098.03"/>
<polygon fill="black" stroke="black" points="5121.84,-3101.35 5130.73,-3095.58 5120.18,-3094.55 5121.84,-3101.35"/>
</g>
<!-- expert_layer_1_expert_8_gpu_14 -->
<g id="node89" class="node">
<title>expert_layer_1_expert_8_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="842,-3095.54 558,-3095.54 558,-3043.54 842,-3043.54 842,-3095.54"/>
<text text-anchor="middle" x="700" y="-3083.54" font-family="Arial" font-size="10.00">Expert8</text>
<text text-anchor="middle" x="700" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="700" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="700" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_8_gpu_14 -->
<g id="edge417" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_8_gpu_14</title>
<path fill="none" stroke="black" d="M3102.77,-3295.24C2659.04,-3290.81 1318.22,-3274.33 1126,-3235.54 988.72,-3207.83 838.15,-3139.85 757.93,-3100.33"/>
<polygon fill="black" stroke="black" points="759.02,-3096.96 748.51,-3095.66 755.91,-3103.24 759.02,-3096.96"/>
</g>
<!-- expert_layer_1_expert_9_gpu_14 -->
<g id="node90" class="node">
<title>expert_layer_1_expert_9_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="1144,-3095.54 860,-3095.54 860,-3043.54 1144,-3043.54 1144,-3095.54"/>
<text text-anchor="middle" x="1002" y="-3083.54" font-family="Arial" font-size="10.00">Expert9</text>
<text text-anchor="middle" x="1002" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1002" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1002" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_9_gpu_14 -->
<g id="edge419" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_9_gpu_14</title>
<path fill="none" stroke="black" d="M3102.96,-3294.51C2703.71,-3288.41 1589.96,-3268.63 1428,-3235.54 1290.79,-3207.5 1140.19,-3139.65 1059.95,-3100.24"/>
<polygon fill="black" stroke="black" points="1061.04,-3096.87 1050.52,-3095.58 1057.94,-3103.15 1061.04,-3096.87"/>
</g>
<!-- expert_layer_1_expert_10_gpu_14 -->
<g id="node91" class="node">
<title>expert_layer_1_expert_10_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="1446,-3095.54 1162,-3095.54 1162,-3043.54 1446,-3043.54 1446,-3095.54"/>
<text text-anchor="middle" x="1304" y="-3083.54" font-family="Arial" font-size="10.00">Expert10</text>
<text text-anchor="middle" x="1304" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1304" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1304" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_10_gpu_14 -->
<g id="edge421" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_10_gpu_14</title>
<path fill="none" stroke="black" d="M3102.85,-3296.78C2777.87,-3296.35 1988.65,-3289.6 1729,-3235.54 1592.36,-3207.09 1442.32,-3139.55 1362.16,-3100.27"/>
<polygon fill="black" stroke="black" points="1363.26,-3096.9 1352.74,-3095.62 1360.16,-3103.18 1363.26,-3096.9"/>
</g>
<!-- expert_layer_1_expert_11_gpu_14 -->
<g id="node92" class="node">
<title>expert_layer_1_expert_11_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="1748,-3095.54 1464,-3095.54 1464,-3043.54 1748,-3043.54 1748,-3095.54"/>
<text text-anchor="middle" x="1606" y="-3083.54" font-family="Arial" font-size="10.00">Expert11</text>
<text text-anchor="middle" x="1606" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1606" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1606" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_11_gpu_14 -->
<g id="edge423" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_11_gpu_14</title>
<path fill="none" stroke="black" d="M3102.86,-3295.14C2827.15,-3291.49 2229.15,-3278.71 2028,-3235.54 1892.56,-3206.47 1743.78,-3139.32 1664.09,-3100.24"/>
<polygon fill="black" stroke="black" points="1665.24,-3096.9 1654.72,-3095.61 1662.14,-3103.18 1665.24,-3096.9"/>
</g>
<!-- expert_layer_1_expert_12_gpu_15 -->
<g id="node93" class="node">
<title>expert_layer_1_expert_12_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2050,-3095.54 1766,-3095.54 1766,-3043.54 2050,-3043.54 2050,-3095.54"/>
<text text-anchor="middle" x="1908" y="-3083.54" font-family="Arial" font-size="10.00">Expert12</text>
<text text-anchor="middle" x="1908" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1908" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1908" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_12_gpu_15 -->
<g id="edge425" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_12_gpu_15</title>
<path fill="none" stroke="black" d="M3102.72,-3292.62C2881.33,-3285.6 2464.78,-3268.43 2320,-3235.54 2188.05,-3205.56 2043.26,-3139.07 1965.33,-3100.26"/>
<polygon fill="black" stroke="black" points="1966.67,-3097.02 1956.16,-3095.67 1963.54,-3103.28 1966.67,-3097.02"/>
</g>
<!-- expert_layer_1_expert_13_gpu_15 -->
<g id="node94" class="node">
<title>expert_layer_1_expert_13_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2352,-3095.54 2068,-3095.54 2068,-3043.54 2352,-3043.54 2352,-3095.54"/>
<text text-anchor="middle" x="2210" y="-3083.54" font-family="Arial" font-size="10.00">Expert13</text>
<text text-anchor="middle" x="2210" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2210" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2210" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_13_gpu_15 -->
<g id="edge427" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_13_gpu_15</title>
<path fill="none" stroke="black" d="M3102.98,-3296.25C2968.6,-3292.97 2762.23,-3280.08 2589,-3235.54 2467.53,-3204.31 2335.26,-3138.81 2263.56,-3100.4"/>
<polygon fill="black" stroke="black" points="2265.17,-3097.28 2254.7,-3095.62 2261.84,-3103.45 2265.17,-3097.28"/>
</g>
<!-- expert_layer_1_expert_14_gpu_15 -->
<g id="node95" class="node">
<title>expert_layer_1_expert_14_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2654,-3095.54 2370,-3095.54 2370,-3043.54 2654,-3043.54 2654,-3095.54"/>
<text text-anchor="middle" x="2512" y="-3083.54" font-family="Arial" font-size="10.00">Expert14</text>
<text text-anchor="middle" x="2512" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2512" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2512" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_14_gpu_15 -->
<g id="edge429" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_14_gpu_15</title>
<path fill="none" stroke="black" d="M3102.82,-3294.26C3006.87,-3288.89 2878.77,-3274.14 2772,-3235.54 2685.5,-3204.27 2597.83,-3140.51 2549.64,-3102.05"/>
<polygon fill="black" stroke="black" points="2551.66,-3099.18 2541.68,-3095.64 2547.27,-3104.64 2551.66,-3099.18"/>
</g>
<!-- expert_layer_1_expert_15_gpu_15 -->
<g id="node96" class="node">
<title>expert_layer_1_expert_15_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2956,-3095.54 2672,-3095.54 2672,-3043.54 2956,-3043.54 2956,-3095.54"/>
<text text-anchor="middle" x="2814" y="-3083.54" font-family="Arial" font-size="10.00">Expert15</text>
<text text-anchor="middle" x="2814" y="-3072.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2814" y="-3061.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2814" y="-3050.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_1&#45;&gt;expert_layer_1_expert_15_gpu_15 -->
<g id="edge431" class="edge">
<title>ln2_layer_1&#45;&gt;expert_layer_1_expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M3102.79,-3286.61C2978.36,-3276.43 2814.34,-3258.82 2794,-3235.54 2762.8,-3199.84 2779.89,-3141.99 2796.14,-3105.13"/>
<polygon fill="black" stroke="black" points="2799.44,-3106.33 2800.44,-3095.79 2793.08,-3103.41 2799.44,-3106.33"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_0_gpu_12 -->
<g id="edge400" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_0_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3102.4,-3131.46C3104.36,-3122.69 3106.35,-3113.77 3108.18,-3105.55"/>
<polygon fill="red" stroke="red" points="3111.65,-3106.1 3110.41,-3095.58 3104.82,-3104.58 3111.65,-3106.1"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_1_gpu_12 -->
<g id="edge402" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_1_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3240.15,-3131.46C3272.83,-3120.26 3306.29,-3108.8 3335.24,-3098.88"/>
<polygon fill="red" stroke="red" points="3336.56,-3102.13 3344.88,-3095.58 3334.29,-3095.51 3336.56,-3102.13"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_2_gpu_12 -->
<g id="edge404" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_2_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3281,-3148.71C3373.46,-3132.24 3483.03,-3112.73 3569.58,-3097.32"/>
<polygon fill="red" stroke="red" points="3570.25,-3100.76 3579.48,-3095.56 3569.02,-3093.87 3570.25,-3100.76"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_3_gpu_12 -->
<g id="edge406" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_3_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3297.06,-3162.56C3451.91,-3146.84 3669.45,-3123.22 3869.64,-3095.7"/>
<polygon fill="red" stroke="red" points="3870.34,-3099.14 3879.77,-3094.3 3869.38,-3092.2 3870.34,-3099.14"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_4_gpu_13 -->
<g id="edge408" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_4_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3305.81,-3170.59C3522.18,-3157.32 3865.66,-3132.88 4171.82,-3095.64"/>
<polygon fill="red" stroke="red" points="4172.28,-3099.11 4181.78,-3094.43 4171.43,-3092.17 4172.28,-3099.11"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_5_gpu_13 -->
<g id="edge410" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_5_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3311.53,-3175.57C3582.95,-3165.42 4057.93,-3142.54 4473.67,-3095.64"/>
<polygon fill="red" stroke="red" points="4474.25,-3099.1 4483.79,-3094.5 4473.46,-3092.14 4474.25,-3099.1"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_6_gpu_13 -->
<g id="edge412" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_6_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3315.27,-3178.98C3636.87,-3172.08 4247.59,-3152.25 4775.69,-3095.63"/>
<polygon fill="red" stroke="red" points="4776.23,-3099.09 4785.8,-3094.54 4775.48,-3092.13 4776.23,-3099.09"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_7_gpu_13 -->
<g id="edge414" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_7_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3318.24,-3181.47C3686.22,-3177.76 4435.23,-3162 5077.41,-3095.65"/>
<polygon fill="red" stroke="red" points="5078.22,-3099.09 5087.8,-3094.57 5077.49,-3092.12 5078.22,-3099.09"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_8_gpu_14 -->
<g id="edge416" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_8_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2860.98,-3183.09C2456.23,-3181.95 1590.4,-3170.11 852.24,-3095.61"/>
<polygon fill="red" stroke="red" points="852.5,-3092.12 842.2,-3094.59 851.79,-3099.08 852.5,-3092.12"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_9_gpu_14 -->
<g id="edge418" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_9_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2858.39,-3181.04C2495.86,-3176.7 1774.2,-3160.03 1154.23,-3095.61"/>
<polygon fill="red" stroke="red" points="1154.51,-3092.12 1144.2,-3094.57 1153.78,-3099.09 1154.51,-3092.12"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_10_gpu_14 -->
<g id="edge420" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_10_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2855.31,-3178.21C2538.89,-3170.53 1959.29,-3149.96 1456.21,-3095.62"/>
<polygon fill="red" stroke="red" points="1456.52,-3092.13 1446.2,-3094.53 1455.77,-3099.09 1456.52,-3092.13"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_11_gpu_14 -->
<g id="edge422" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_11_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2850.58,-3174.03C2585.27,-3162.98 2145.6,-3139.8 1758.21,-3095.63"/>
<polygon fill="red" stroke="red" points="1758.54,-3092.15 1748.21,-3094.49 1757.75,-3099.1 1758.54,-3092.15"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_12_gpu_15 -->
<g id="edge424" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_12_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2843.06,-3167.22C2636.21,-3153.13 2333.57,-3129.44 2060.33,-3095.67"/>
<polygon fill="red" stroke="red" points="2060.57,-3092.17 2050.22,-3094.41 2059.71,-3099.12 2060.57,-3092.17"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_13_gpu_15 -->
<g id="edge426" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_13_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2827.92,-3154.11C2691.74,-3138.67 2522.57,-3118.37 2362.29,-3095.7"/>
<polygon fill="red" stroke="red" points="2362.63,-3092.21 2352.24,-3094.27 2361.65,-3099.14 2362.63,-3092.21"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_14_gpu_15 -->
<g id="edge428" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_14_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2827.34,-3131.54C2766.63,-3119.79 2704.39,-3107.75 2651.42,-3097.51"/>
<polygon fill="red" stroke="red" points="2651.78,-3094.01 2641.29,-3095.55 2650.45,-3100.88 2651.78,-3094.01"/>
</g>
<!-- gate_layer_1&#45;&gt;expert_layer_1_expert_15_gpu_15 -->
<g id="edge430" class="edge">
<title>gate_layer_1&#45;&gt;expert_layer_1_expert_15_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2964.66,-3131.46C2937.45,-3120.45 2909.61,-3109.2 2885.38,-3099.4"/>
<polygon fill="red" stroke="red" points="2886.52,-3096.09 2875.94,-3095.58 2883.9,-3102.58 2886.52,-3096.09"/>
</g>
<!-- expert_agg_layer_1 -->
<g id="node97" class="node">
<title>expert_agg_layer_1</title>
<polygon fill="#ffcccc" stroke="black" points="3422.76,-3007.54 2934.77,-3007.54 2809.24,-2903.54 3297.23,-2903.54 3422.76,-3007.54"/>
<text text-anchor="middle" x="3116" y="-2969.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3116" y="-2958.54" font-family="Arial" font-size="10.00">Input: [16Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3116" y="-2947.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3116" y="-2936.54" font-family="Arial" font-size="10.00">GPU: all MoE GPUs</text>
</g>
<!-- expert_layer_1_expert_0_gpu_12&#45;&gt;expert_agg_layer_1 -->
<g id="edge432" class="edge">
<title>expert_layer_1_expert_0_gpu_12&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M3116,-3043.4C3116,-3035.72 3116,-3026.91 3116,-3017.91"/>
<polygon fill="black" stroke="black" points="3119.5,-3017.72 3116,-3007.72 3112.5,-3017.72 3119.5,-3017.72"/>
</g>
<!-- expert_layer_1_expert_1_gpu_12&#45;&gt;expert_agg_layer_1 -->
<g id="edge433" class="edge">
<title>expert_layer_1_expert_1_gpu_12&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M3350.23,-3043.4C3324.3,-3033.79 3293.61,-3022.41 3263.14,-3011.11"/>
<polygon fill="black" stroke="black" points="3264.29,-3007.8 3253.69,-3007.6 3261.85,-3014.36 3264.29,-3007.8"/>
</g>
<!-- expert_layer_1_expert_2_gpu_12&#45;&gt;expert_agg_layer_1 -->
<g id="edge434" class="edge">
<title>expert_layer_1_expert_2_gpu_12&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M3584.83,-3043.47C3530.25,-3033.35 3465.08,-3021.27 3400.94,-3009.38"/>
<polygon fill="black" stroke="black" points="3401.54,-3005.93 3391.07,-3007.55 3400.27,-3012.81 3401.54,-3005.93"/>
</g>
<!-- expert_layer_1_expert_3_gpu_12&#45;&gt;expert_agg_layer_1 -->
<g id="edge435" class="edge">
<title>expert_layer_1_expert_3_gpu_12&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M3879.77,-3044.79C3876.82,-3044.36 3873.89,-3043.95 3871,-3043.54 3718.04,-3022.08 3547.09,-3002.05 3406.6,-2986.64"/>
<polygon fill="black" stroke="black" points="3406.85,-2983.14 3396.53,-2985.53 3406.09,-2990.1 3406.85,-2983.14"/>
</g>
<!-- expert_layer_1_expert_4_gpu_13&#45;&gt;expert_agg_layer_1 -->
<g id="edge436" class="edge">
<title>expert_layer_1_expert_4_gpu_13&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M4181.78,-3044.66C4178.83,-3044.27 4175.9,-3043.9 4173,-3043.54 3908.02,-3010.75 3604.08,-2987.2 3390.34,-2972.93"/>
<polygon fill="black" stroke="black" points="3390.44,-2969.43 3380.23,-2972.26 3389.98,-2976.41 3390.44,-2969.43"/>
</g>
<!-- expert_layer_1_expert_5_gpu_13&#45;&gt;expert_agg_layer_1 -->
<g id="edge437" class="edge">
<title>expert_layer_1_expert_5_gpu_13&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M4483.79,-3044.59C4480.84,-3044.22 4477.9,-3043.87 4475,-3043.54 4096.66,-3000.22 3656.42,-2976.97 3381.95,-2965.69"/>
<polygon fill="black" stroke="black" points="3381.98,-2962.18 3371.85,-2965.27 3381.7,-2969.18 3381.98,-2962.18"/>
</g>
<!-- expert_layer_1_expert_6_gpu_13&#45;&gt;expert_agg_layer_1 -->
<g id="edge438" class="edge">
<title>expert_layer_1_expert_6_gpu_13&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M4785.8,-3044.54C4782.84,-3044.19 4779.91,-3043.85 4777,-3043.54 4283.86,-2989.97 3704.63,-2969.12 3376.9,-2961.2"/>
<polygon fill="black" stroke="black" points="3376.87,-2957.7 3366.79,-2960.96 3376.7,-2964.69 3376.87,-2957.7"/>
</g>
<!-- expert_layer_1_expert_7_gpu_13&#45;&gt;expert_agg_layer_1 -->
<g id="edge439" class="edge">
<title>expert_layer_1_expert_7_gpu_13&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M5087.8,-3044.51C5084.84,-3044.17 5081.91,-3043.84 5079,-3043.54 4469.6,-2979.82 3749.02,-2962.69 3373.25,-2958.13"/>
<polygon fill="black" stroke="black" points="3373.1,-2954.63 3363.06,-2958.01 3373.02,-2961.63 3373.1,-2954.63"/>
</g>
<!-- expert_layer_1_expert_8_gpu_14&#45;&gt;expert_agg_layer_1 -->
<g id="edge440" class="edge">
<title>expert_layer_1_expert_8_gpu_14&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M842.2,-3044.49C845.16,-3044.15 848.09,-3043.83 851,-3043.54 1578.19,-2969.67 2442.5,-2957.19 2862.15,-2955.91"/>
<polygon fill="black" stroke="black" points="2862.3,-2959.41 2872.29,-2955.88 2862.28,-2952.41 2862.3,-2959.41"/>
</g>
<!-- expert_layer_1_expert_9_gpu_14&#45;&gt;expert_agg_layer_1 -->
<g id="edge441" class="edge">
<title>expert_layer_1_expert_9_gpu_14&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M1144.2,-3044.51C1147.16,-3044.17 1150.09,-3043.84 1153,-3043.54 1765.55,-2979.49 2490.44,-2962.51 2864.55,-2958.07"/>
<polygon fill="black" stroke="black" points="2864.73,-2961.56 2874.69,-2957.95 2864.65,-2954.56 2864.73,-2961.56"/>
</g>
<!-- expert_layer_1_expert_10_gpu_14&#45;&gt;expert_agg_layer_1 -->
<g id="edge442" class="edge">
<title>expert_layer_1_expert_10_gpu_14&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M1446.2,-3044.54C1449.16,-3044.19 1452.09,-3043.85 1455,-3043.54 1954.72,-2989.26 2542.82,-2968.57 2868.07,-2960.89"/>
<polygon fill="black" stroke="black" points="2868.18,-2964.39 2878.09,-2960.65 2868.01,-2957.39 2868.18,-2964.39"/>
</g>
<!-- expert_layer_1_expert_11_gpu_14&#45;&gt;expert_agg_layer_1 -->
<g id="edge443" class="edge">
<title>expert_layer_1_expert_11_gpu_14&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M1748.21,-3044.59C1751.16,-3044.22 1754.1,-3043.87 1757,-3043.54 2145.78,-2999.02 2599.93,-2975.7 2872.39,-2964.78"/>
<polygon fill="black" stroke="black" points="2872.56,-2968.28 2882.41,-2964.38 2872.28,-2961.28 2872.56,-2968.28"/>
</g>
<!-- expert_layer_1_expert_12_gpu_15&#45;&gt;expert_agg_layer_1 -->
<g id="edge444" class="edge">
<title>expert_layer_1_expert_12_gpu_15&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M2050.22,-3044.66C2053.17,-3044.27 2056.1,-3043.9 2059,-3043.54 2339.84,-3008.79 2664.43,-2984.41 2879.02,-2970.47"/>
<polygon fill="black" stroke="black" points="2879.4,-2973.95 2889.16,-2969.81 2878.95,-2966.97 2879.4,-2973.95"/>
</g>
<!-- expert_layer_1_expert_13_gpu_15&#45;&gt;expert_agg_layer_1 -->
<g id="edge445" class="edge">
<title>expert_layer_1_expert_13_gpu_15&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M2352.23,-3044.79C2355.18,-3044.36 2358.11,-3043.95 2361,-3043.54 2538.06,-3018.7 2739.23,-2995.78 2889.36,-2979.7"/>
<polygon fill="black" stroke="black" points="2890.06,-2983.15 2899.63,-2978.61 2889.31,-2976.19 2890.06,-2983.15"/>
</g>
<!-- expert_layer_1_expert_14_gpu_15&#45;&gt;expert_agg_layer_1 -->
<g id="edge446" class="edge">
<title>expert_layer_1_expert_14_gpu_15&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M2647.17,-3043.47C2723.77,-3029.27 2821.23,-3011.2 2907.42,-2995.22"/>
<polygon fill="black" stroke="black" points="2908.14,-2998.64 2917.34,-2993.38 2906.87,-2991.76 2908.14,-2998.64"/>
</g>
<!-- expert_layer_1_expert_15_gpu_15&#45;&gt;expert_agg_layer_1 -->
<g id="edge447" class="edge">
<title>expert_layer_1_expert_15_gpu_15&#45;&gt;expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M2881.77,-3043.4C2907.7,-3033.79 2938.39,-3022.41 2968.86,-3011.11"/>
<polygon fill="black" stroke="black" points="2970.15,-3014.36 2978.31,-3007.6 2967.71,-3007.8 2970.15,-3014.36"/>
</g>
<!-- expert_agg_layer_1&#45;&gt;residual2_layer_1 -->
<g id="edge448" class="edge">
<title>expert_agg_layer_1&#45;&gt;residual2_layer_1</title>
<path fill="none" stroke="black" d="M3319.09,-2921.53C3450.81,-2900.12 3622.04,-2872.29 3755.09,-2850.66"/>
<polygon fill="black" stroke="black" points="3755.7,-2854.11 3765.01,-2849.05 3754.58,-2847.2 3755.7,-2854.11"/>
</g>
<!-- ln1_layer_2 -->
<g id="node99" class="node">
<title>ln1_layer_2</title>
<polygon fill="#0080ff" stroke="black" points="2647,-2716.54 2363,-2716.54 2363,-2664.54 2647,-2664.54 2647,-2716.54"/>
<text text-anchor="middle" x="2505" y="-2704.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2505" y="-2693.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2505" y="-2682.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2505" y="-2671.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_layer_1&#45;&gt;ln1_layer_2 -->
<g id="edge450" class="edge">
<title>residual2_layer_1&#45;&gt;ln1_layer_2</title>
<path fill="none" stroke="black" d="M3697.64,-2792.01C3392.41,-2766.3 2903.62,-2725.12 2657.34,-2704.37"/>
<polygon fill="black" stroke="black" points="2657.5,-2700.87 2647.24,-2703.52 2656.91,-2707.85 2657.5,-2700.87"/>
</g>
<!-- residual1_layer_2 -->
<g id="node126" class="node">
<title>residual1_layer_2</title>
<polygon fill="#ffffcc" stroke="black" points="4505.82,-2180.54 4027.28,-2180.54 3904.18,-2076.54 4382.72,-2076.54 4505.82,-2180.54"/>
<text text-anchor="middle" x="4205" y="-2142.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="4205" y="-2131.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4205" y="-2120.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4205" y="-2109.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_layer_1&#45;&gt;residual1_layer_2 -->
<g id="edge621" class="edge">
<title>residual2_layer_1&#45;&gt;residual1_layer_2</title>
<path fill="none" stroke="black" d="M4108.84,-2763.47C4180.06,-2728.06 4251,-2672.68 4251,-2592.54 4251,-2592.54 4251,-2592.54 4251,-2355.54 4251,-2298.65 4236.83,-2235.3 4224.22,-2190.18"/>
<polygon fill="black" stroke="black" points="4227.58,-2189.21 4221.48,-2180.55 4220.85,-2191.13 4227.58,-2189.21"/>
</g>
<!-- qkv_layer_2_gpu_0 -->
<g id="node100" class="node">
<title>qkv_layer_2_gpu_0</title>
<polygon fill="#0080ff" stroke="black" points="769,-2628.54 473,-2628.54 473,-2554.54 769,-2554.54 769,-2628.54"/>
<text text-anchor="middle" x="621" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="621" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="621" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="621" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="621" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="621" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_0 -->
<g id="edge451" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_0</title>
<path fill="none" stroke="black" d="M2362.99,-2688C2010.75,-2683.63 1102.69,-2668.83 779.52,-2628.63"/>
<polygon fill="black" stroke="black" points="779.56,-2625.11 769.2,-2627.31 778.67,-2632.05 779.56,-2625.11"/>
</g>
<!-- qkv_layer_2_gpu_1 -->
<g id="node101" class="node">
<title>qkv_layer_2_gpu_1</title>
<polygon fill="#0f8aff" stroke="black" points="1083,-2628.54 787,-2628.54 787,-2554.54 1083,-2554.54 1083,-2628.54"/>
<text text-anchor="middle" x="935" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="935" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="935" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="935" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="935" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="935" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_1 -->
<g id="edge464" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_1</title>
<path fill="none" stroke="black" d="M2362.92,-2686.7C2059.06,-2680.09 1353.27,-2661.77 1093.38,-2628.61"/>
<polygon fill="black" stroke="black" points="1093.57,-2625.11 1083.2,-2627.28 1092.66,-2632.05 1093.57,-2625.11"/>
</g>
<!-- qkv_layer_2_gpu_2 -->
<g id="node102" class="node">
<title>qkv_layer_2_gpu_2</title>
<polygon fill="#1e94ff" stroke="black" points="1397,-2628.54 1101,-2628.54 1101,-2554.54 1397,-2554.54 1397,-2628.54"/>
<text text-anchor="middle" x="1249" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1249" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1249" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1249" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1249" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1249" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_2 -->
<g id="edge477" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_2</title>
<path fill="none" stroke="black" d="M2362.86,-2689.34C2154.67,-2687.33 1754.76,-2676.95 1407.22,-2628.63"/>
<polygon fill="black" stroke="black" points="1407.6,-2625.15 1397.21,-2627.23 1406.62,-2632.08 1407.6,-2625.15"/>
</g>
<!-- qkv_layer_2_gpu_3 -->
<g id="node103" class="node">
<title>qkv_layer_2_gpu_3</title>
<polygon fill="#2d9eff" stroke="black" points="1711,-2628.54 1415,-2628.54 1415,-2554.54 1711,-2554.54 1711,-2628.54"/>
<text text-anchor="middle" x="1563" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1563" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1563" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1563" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1563" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1563" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_3 -->
<g id="edge490" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_3</title>
<path fill="none" stroke="black" d="M2362.82,-2684.81C2207.33,-2678.2 1950.78,-2663.05 1721.43,-2628.69"/>
<polygon fill="black" stroke="black" points="1721.63,-2625.18 1711.22,-2627.14 1720.58,-2632.1 1721.63,-2625.18"/>
</g>
<!-- qkv_layer_2_gpu_4 -->
<g id="node104" class="node">
<title>qkv_layer_2_gpu_4</title>
<polygon fill="#3ca8ff" stroke="black" points="2025,-2628.54 1729,-2628.54 1729,-2554.54 2025,-2554.54 2025,-2628.54"/>
<text text-anchor="middle" x="1877" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1877" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1877" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1877" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1877" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1877" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_4 -->
<g id="edge503" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_4</title>
<path fill="none" stroke="black" d="M2362.76,-2674.74C2271.68,-2664.4 2150.84,-2649.08 2035.34,-2628.73"/>
<polygon fill="black" stroke="black" points="2035.71,-2625.24 2025.26,-2626.94 2034.49,-2632.13 2035.71,-2625.24"/>
</g>
<!-- qkv_layer_2_gpu_5 -->
<g id="node105" class="node">
<title>qkv_layer_2_gpu_5</title>
<polygon fill="#4bb2ff" stroke="black" points="2339,-2628.54 2043,-2628.54 2043,-2554.54 2339,-2554.54 2339,-2628.54"/>
<text text-anchor="middle" x="2191" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2191" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2191" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2191" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2191" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2191" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_5 -->
<g id="edge516" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_5</title>
<path fill="none" stroke="black" d="M2423.73,-2664.43C2391.28,-2654.41 2353.17,-2642.64 2317.28,-2631.55"/>
<polygon fill="black" stroke="black" points="2318.3,-2628.2 2307.72,-2628.59 2316.24,-2634.89 2318.3,-2628.2"/>
</g>
<!-- qkv_layer_2_gpu_6 -->
<g id="node106" class="node">
<title>qkv_layer_2_gpu_6</title>
<polygon fill="#5abcff" stroke="black" points="2653,-2628.54 2357,-2628.54 2357,-2554.54 2653,-2554.54 2653,-2628.54"/>
<text text-anchor="middle" x="2505" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2505" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2505" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2505" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2505" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2505" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_6 -->
<g id="edge529" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_6</title>
<path fill="none" stroke="black" d="M2505,-2664.31C2505,-2656.48 2505,-2647.59 2505,-2638.8"/>
<polygon fill="black" stroke="black" points="2508.5,-2638.6 2505,-2628.6 2501.5,-2638.6 2508.5,-2638.6"/>
</g>
<!-- qkv_layer_2_gpu_7 -->
<g id="node107" class="node">
<title>qkv_layer_2_gpu_7</title>
<polygon fill="#69c6ff" stroke="black" points="2967,-2628.54 2671,-2628.54 2671,-2554.54 2967,-2554.54 2967,-2628.54"/>
<text text-anchor="middle" x="2819" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2819" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2819" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2819" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2819" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2819" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_7 -->
<g id="edge542" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_7</title>
<path fill="none" stroke="black" d="M2586.27,-2664.43C2618.72,-2654.41 2656.83,-2642.64 2692.72,-2631.55"/>
<polygon fill="black" stroke="black" points="2693.76,-2634.89 2702.28,-2628.59 2691.7,-2628.2 2693.76,-2634.89"/>
</g>
<!-- qkv_layer_2_gpu_8 -->
<g id="node108" class="node">
<title>qkv_layer_2_gpu_8</title>
<polygon fill="#78d0ff" stroke="black" points="3281,-2628.54 2985,-2628.54 2985,-2554.54 3281,-2554.54 3281,-2628.54"/>
<text text-anchor="middle" x="3133" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3133" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3133" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3133" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3133" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3133" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_8 -->
<g id="edge555" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_8</title>
<path fill="none" stroke="black" d="M2647.24,-2674.74C2738.32,-2664.4 2859.16,-2649.08 2974.66,-2628.73"/>
<polygon fill="black" stroke="black" points="2975.51,-2632.13 2984.74,-2626.94 2974.29,-2625.24 2975.51,-2632.13"/>
</g>
<!-- qkv_layer_2_gpu_9 -->
<g id="node109" class="node">
<title>qkv_layer_2_gpu_9</title>
<polygon fill="#87daff" stroke="black" points="3595,-2628.54 3299,-2628.54 3299,-2554.54 3595,-2554.54 3595,-2628.54"/>
<text text-anchor="middle" x="3447" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3447" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3447" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3447" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3447" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3447" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_9 -->
<g id="edge568" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_9</title>
<path fill="none" stroke="black" d="M2647.18,-2684.81C2802.67,-2678.2 3059.22,-2663.05 3288.57,-2628.69"/>
<polygon fill="black" stroke="black" points="3289.42,-2632.1 3298.78,-2627.14 3288.37,-2625.18 3289.42,-2632.1"/>
</g>
<!-- qkv_layer_2_gpu_10 -->
<g id="node110" class="node">
<title>qkv_layer_2_gpu_10</title>
<polygon fill="#96e4ff" stroke="black" points="3909,-2628.54 3613,-2628.54 3613,-2554.54 3909,-2554.54 3909,-2628.54"/>
<text text-anchor="middle" x="3761" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3761" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3761" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3761" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3761" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3761" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_10 -->
<g id="edge581" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_10</title>
<path fill="none" stroke="black" d="M2647.14,-2689.34C2855.33,-2687.33 3255.24,-2676.95 3602.78,-2628.63"/>
<polygon fill="black" stroke="black" points="3603.38,-2632.08 3612.79,-2627.23 3602.4,-2625.15 3603.38,-2632.08"/>
</g>
<!-- qkv_layer_2_gpu_11 -->
<g id="node111" class="node">
<title>qkv_layer_2_gpu_11</title>
<polygon fill="#a5eeff" stroke="black" points="4223,-2628.54 3927,-2628.54 3927,-2554.54 4223,-2554.54 4223,-2628.54"/>
<text text-anchor="middle" x="4075" y="-2616.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4075" y="-2605.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4075" y="-2594.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4075" y="-2583.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4075" y="-2572.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4075" y="-2561.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- ln1_layer_2&#45;&gt;qkv_layer_2_gpu_11 -->
<g id="edge594" class="edge">
<title>ln1_layer_2&#45;&gt;qkv_layer_2_gpu_11</title>
<path fill="none" stroke="black" d="M2647.08,-2686.7C2950.94,-2680.09 3656.73,-2661.77 3916.62,-2628.61"/>
<polygon fill="black" stroke="black" points="3917.34,-2632.05 3926.8,-2627.28 3916.43,-2625.11 3917.34,-2632.05"/>
</g>
<!-- attention_layer_2_gpu_0 -->
<g id="node112" class="node">
<title>attention_layer_2_gpu_0</title>
<polygon fill="#0080ff" stroke="black" points="807.5,-2518.54 518.5,-2518.54 518.5,-2444.54 807.5,-2444.54 807.5,-2518.54"/>
<text text-anchor="middle" x="663" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="663" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="663" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="663" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="663" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="663" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge452" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="black" d="M635.1,-2554.28C638.32,-2545.99 641.79,-2537.09 645.14,-2528.46"/>
<polygon fill="black" stroke="black" points="648.5,-2529.48 648.86,-2518.89 641.98,-2526.94 648.5,-2529.48"/>
</g>
<!-- attention_layer_2_gpu_1 -->
<g id="node113" class="node">
<title>attention_layer_2_gpu_1</title>
<polygon fill="#0f8aff" stroke="black" points="1114.5,-2518.54 825.5,-2518.54 825.5,-2444.54 1114.5,-2444.54 1114.5,-2518.54"/>
<text text-anchor="middle" x="970" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="970" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="970" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="970" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="970" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="970" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge466" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M737.7,-2554.43C771.75,-2543.89 809.11,-2532.33 843.73,-2521.61"/>
<polygon fill="blue" stroke="blue" points="844.89,-2524.92 853.41,-2518.62 842.83,-2518.23 844.89,-2524.92"/>
</g>
<!-- attention_layer_2_gpu_2 -->
<g id="node114" class="node">
<title>attention_layer_2_gpu_2</title>
<polygon fill="#1e94ff" stroke="black" points="1421.5,-2518.54 1132.5,-2518.54 1132.5,-2444.54 1421.5,-2444.54 1421.5,-2518.54"/>
<text text-anchor="middle" x="1277" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1277" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1277" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1277" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1277" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1277" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge479" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M769.24,-2556.04C772.18,-2555.52 775.1,-2555.02 778,-2554.54 926.81,-2529.81 969.17,-2543.52 1122.18,-2518.59"/>
<polygon fill="blue" stroke="blue" points="1123.13,-2521.98 1132.43,-2516.89 1121.99,-2515.08 1123.13,-2521.98"/>
</g>
<!-- attention_layer_2_gpu_3 -->
<g id="node115" class="node">
<title>attention_layer_2_gpu_3</title>
<polygon fill="#2d9eff" stroke="black" points="1728.5,-2518.54 1439.5,-2518.54 1439.5,-2444.54 1728.5,-2444.54 1728.5,-2518.54"/>
<text text-anchor="middle" x="1584" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1584" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1584" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1584" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1584" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1584" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge492" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M769.21,-2555.85C772.16,-2555.39 775.09,-2554.95 778,-2554.54 1062.44,-2514.39 1141.46,-2558.92 1428.85,-2518.77"/>
<polygon fill="blue" stroke="blue" points="1429.76,-2522.17 1439.16,-2517.3 1428.77,-2515.24 1429.76,-2522.17"/>
</g>
<!-- attention_layer_2_gpu_4 -->
<g id="node116" class="node">
<title>attention_layer_2_gpu_4</title>
<polygon fill="#3ca8ff" stroke="black" points="2035.5,-2518.54 1746.5,-2518.54 1746.5,-2444.54 2035.5,-2444.54 2035.5,-2518.54"/>
<text text-anchor="middle" x="1891" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1891" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1891" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge505" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M769.2,-2555.78C772.15,-2555.34 775.09,-2554.92 778,-2554.54 1197.98,-2499.02 1313.08,-2574.51 1736.12,-2518.71"/>
<polygon fill="blue" stroke="blue" points="1736.72,-2522.16 1746.17,-2517.37 1735.8,-2515.22 1736.72,-2522.16"/>
</g>
<!-- attention_layer_2_gpu_5 -->
<g id="node117" class="node">
<title>attention_layer_2_gpu_5</title>
<polygon fill="#4bb2ff" stroke="black" points="2342.5,-2518.54 2053.5,-2518.54 2053.5,-2444.54 2342.5,-2444.54 2342.5,-2518.54"/>
<text text-anchor="middle" x="2198" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2198" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2198" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2198" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2198" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2198" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge518" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M769.19,-2555.74C772.15,-2555.31 775.09,-2554.91 778,-2554.54 1333.53,-2483.66 1484.63,-2590.16 2043.26,-2518.68"/>
<polygon fill="blue" stroke="blue" points="2043.71,-2522.15 2053.18,-2517.4 2042.81,-2515.21 2043.71,-2522.15"/>
</g>
<!-- attention_layer_2_gpu_6 -->
<g id="node118" class="node">
<title>attention_layer_2_gpu_6</title>
<polygon fill="#5abcff" stroke="black" points="2649.5,-2518.54 2360.5,-2518.54 2360.5,-2444.54 2649.5,-2444.54 2649.5,-2518.54"/>
<text text-anchor="middle" x="2505" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2505" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2505" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2505" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2505" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2505" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge531" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M769.19,-2555.72C772.15,-2555.3 775.09,-2554.9 778,-2554.54 1469.05,-2468.31 1656.12,-2605.83 2350.19,-2518.69"/>
<polygon fill="blue" stroke="blue" points="2350.7,-2522.15 2360.18,-2517.42 2349.82,-2515.21 2350.7,-2522.15"/>
</g>
<!-- attention_layer_2_gpu_7 -->
<g id="node119" class="node">
<title>attention_layer_2_gpu_7</title>
<polygon fill="#69c6ff" stroke="black" points="2956.5,-2518.54 2667.5,-2518.54 2667.5,-2444.54 2956.5,-2444.54 2956.5,-2518.54"/>
<text text-anchor="middle" x="2812" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2812" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2812" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2812" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2812" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2812" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge544" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M769.19,-2555.7C772.15,-2555.29 775.09,-2554.9 778,-2554.54 1604.57,-2452.97 1827.59,-2621.51 2657.09,-2518.7"/>
<polygon fill="blue" stroke="blue" points="2657.69,-2522.15 2667.18,-2517.44 2656.83,-2515.2 2657.69,-2522.15"/>
</g>
<!-- attention_layer_2_gpu_8 -->
<g id="node120" class="node">
<title>attention_layer_2_gpu_8</title>
<polygon fill="#78d0ff" stroke="black" points="3263.5,-2518.54 2974.5,-2518.54 2974.5,-2444.54 3263.5,-2444.54 3263.5,-2518.54"/>
<text text-anchor="middle" x="3119" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3119" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3119" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3119" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3119" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3119" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge557" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M769.19,-2555.69C772.15,-2555.28 775.09,-2554.89 778,-2554.54 1257.44,-2496.28 2466.75,-2577.45 2964.02,-2518.68"/>
<polygon fill="blue" stroke="blue" points="2964.68,-2522.12 2974.18,-2517.45 2963.83,-2515.18 2964.68,-2522.12"/>
</g>
<!-- attention_layer_2_gpu_9 -->
<g id="node121" class="node">
<title>attention_layer_2_gpu_9</title>
<polygon fill="#87daff" stroke="black" points="3570.5,-2518.54 3281.5,-2518.54 3281.5,-2444.54 3570.5,-2444.54 3570.5,-2518.54"/>
<text text-anchor="middle" x="3426" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3426" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3426" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3426" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3426" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3426" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge570" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M769.19,-2555.68C772.14,-2555.27 775.08,-2554.89 778,-2554.54 1325.16,-2488.61 2705.68,-2585.25 3270.86,-2518.7"/>
<polygon fill="blue" stroke="blue" points="3271.68,-2522.13 3281.18,-2517.45 3270.84,-2515.18 3271.68,-2522.13"/>
</g>
<!-- attention_layer_2_gpu_10 -->
<g id="node122" class="node">
<title>attention_layer_2_gpu_10</title>
<polygon fill="#96e4ff" stroke="black" points="3877.5,-2518.54 3588.5,-2518.54 3588.5,-2444.54 3877.5,-2444.54 3877.5,-2518.54"/>
<text text-anchor="middle" x="3733" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3733" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3733" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3733" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3733" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3733" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge583" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M769.19,-2555.68C772.14,-2555.27 775.08,-2554.89 778,-2554.54 1392.98,-2480.93 2945.12,-2593.09 3578.01,-2518.68"/>
<polygon fill="blue" stroke="blue" points="3578.67,-2522.13 3588.19,-2517.46 3577.84,-2515.18 3578.67,-2522.13"/>
</g>
<!-- attention_layer_2_gpu_11 -->
<g id="node123" class="node">
<title>attention_layer_2_gpu_11</title>
<polygon fill="#a5eeff" stroke="black" points="4184.5,-2518.54 3895.5,-2518.54 3895.5,-2444.54 4184.5,-2444.54 4184.5,-2518.54"/>
<text text-anchor="middle" x="4040" y="-2506.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4040" y="-2495.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4040" y="-2484.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4040" y="-2473.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4040" y="-2462.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4040" y="-2451.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge596" class="edge">
<title>qkv_layer_2_gpu_0&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M769.19,-2555.67C772.14,-2555.27 775.08,-2554.89 778,-2554.54 1460.82,-2473.25 3184.63,-2600.94 3885.2,-2518.66"/>
<polygon fill="blue" stroke="blue" points="3885.67,-2522.13 3895.19,-2517.46 3884.84,-2515.18 3885.67,-2522.13"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge453" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M844.05,-2554.43C818.19,-2544.16 789.88,-2532.92 763.49,-2522.44"/>
<polygon fill="blue" stroke="blue" points="764.45,-2519.06 753.86,-2518.62 761.87,-2525.56 764.45,-2519.06"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge465" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="black" d="M946.75,-2554.28C949.44,-2545.99 952.32,-2537.09 955.12,-2528.46"/>
<polygon fill="black" stroke="black" points="958.47,-2529.48 958.22,-2518.89 951.81,-2527.32 958.47,-2529.48"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge480" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1049.36,-2554.43C1082.58,-2543.93 1119.03,-2532.43 1152.83,-2521.75"/>
<polygon fill="blue" stroke="blue" points="1154.27,-2524.97 1162.75,-2518.62 1152.16,-2518.29 1154.27,-2524.97"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge493" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1083.24,-2556.05C1086.18,-2555.53 1089.1,-2555.02 1092,-2554.54 1238.23,-2530.1 1279.85,-2543.34 1429.14,-2518.78"/>
<polygon fill="blue" stroke="blue" points="1429.85,-2522.21 1439.13,-2517.11 1428.69,-2515.31 1429.85,-2522.21"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge506" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1083.21,-2555.85C1086.16,-2555.39 1089.09,-2554.95 1092,-2554.54 1373.38,-2514.73 1451.57,-2558.58 1735.96,-2518.75"/>
<polygon fill="blue" stroke="blue" points="1736.76,-2522.17 1746.16,-2517.3 1735.77,-2515.24 1736.76,-2522.17"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge519" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1083.2,-2555.78C1086.15,-2555.34 1089.09,-2554.92 1092,-2554.54 1508.91,-2499.36 1623.19,-2574.16 2043.19,-2518.7"/>
<polygon fill="blue" stroke="blue" points="2043.73,-2522.16 2053.17,-2517.37 2042.8,-2515.22 2043.73,-2522.16"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge532" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1083.19,-2555.74C1086.15,-2555.31 1089.09,-2554.91 1092,-2554.54 1644.33,-2484.02 1794.66,-2589.76 2349.9,-2518.73"/>
<polygon fill="blue" stroke="blue" points="2350.71,-2522.15 2360.18,-2517.4 2349.81,-2515.21 2350.71,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge545" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1083.19,-2555.72C1086.15,-2555.3 1089.09,-2554.9 1092,-2554.54 1779.97,-2468.66 1966.21,-2605.48 2657.23,-2518.68"/>
<polygon fill="blue" stroke="blue" points="2657.7,-2522.15 2667.18,-2517.42 2656.82,-2515.21 2657.7,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge558" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1083.19,-2555.7C1086.15,-2555.29 1089.09,-2554.9 1092,-2554.54 1915.49,-2453.32 2137.69,-2621.16 2964.12,-2518.69"/>
<polygon fill="blue" stroke="blue" points="2964.69,-2522.15 2974.18,-2517.44 2963.83,-2515.2 2964.69,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge571" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1083.19,-2555.69C1086.15,-2555.28 1089.09,-2554.89 1092,-2554.54 1569.9,-2496.45 2775.35,-2577.28 3271.05,-2518.68"/>
<polygon fill="blue" stroke="blue" points="3271.68,-2522.12 3281.18,-2517.45 3270.83,-2515.18 3271.68,-2522.12"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge584" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1083.19,-2555.69C1086.14,-2555.27 1089.08,-2554.89 1092,-2554.54 1637.62,-2488.78 3014.28,-2585.07 3577.89,-2518.69"/>
<polygon fill="blue" stroke="blue" points="3578.68,-2522.13 3588.18,-2517.45 3577.84,-2515.18 3578.68,-2522.13"/>
</g>
<!-- qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge597" class="edge">
<title>qkv_layer_2_gpu_1&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1083.19,-2555.68C1086.14,-2555.27 1089.08,-2554.89 1092,-2554.54 1705.45,-2481.1 3253.7,-2592.91 3885.04,-2518.68"/>
<polygon fill="blue" stroke="blue" points="3885.67,-2522.13 3895.19,-2517.46 3884.84,-2515.18 3885.67,-2522.13"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge454" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1100.74,-2556.15C1097.81,-2555.6 1094.89,-2555.06 1092,-2554.54 973.88,-2533.31 940.05,-2540.2 817.73,-2518.6"/>
<polygon fill="blue" stroke="blue" points="818.06,-2515.1 807.59,-2516.78 816.82,-2521.99 818.06,-2515.1"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge467" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1155.71,-2554.43C1129.07,-2544.11 1099.89,-2532.82 1072.72,-2522.3"/>
<polygon fill="blue" stroke="blue" points="1073.79,-2518.96 1063.2,-2518.62 1071.27,-2525.49 1073.79,-2518.96"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge478" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="black" d="M1258.4,-2554.28C1260.53,-2546.08 1262.81,-2537.28 1265.02,-2528.74"/>
<polygon fill="black" stroke="black" points="1268.45,-2529.45 1267.58,-2518.89 1261.68,-2527.69 1268.45,-2529.45"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge494" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1361.02,-2554.43C1393.56,-2543.93 1429.26,-2532.43 1462.37,-2521.75"/>
<polygon fill="blue" stroke="blue" points="1463.65,-2525.02 1472.09,-2518.62 1461.5,-2518.35 1463.65,-2525.02"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge507" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1397.24,-2556.06C1400.18,-2555.53 1403.1,-2555.03 1406,-2554.54 1549.08,-2530.46 1589.89,-2542.99 1735.9,-2518.83"/>
<polygon fill="blue" stroke="blue" points="1736.85,-2522.22 1746.13,-2517.1 1735.69,-2515.31 1736.85,-2522.22"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge520" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1397.21,-2555.85C1400.16,-2555.39 1403.09,-2554.95 1406,-2554.54 1684.33,-2515.08 1761.67,-2558.23 2043.07,-2518.74"/>
<polygon fill="blue" stroke="blue" points="2043.76,-2522.17 2053.16,-2517.3 2042.77,-2515.24 2043.76,-2522.17"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge533" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1397.2,-2555.78C1400.15,-2555.34 1403.09,-2554.92 1406,-2554.54 1819.74,-2499.72 1933.23,-2573.77 2349.96,-2518.73"/>
<polygon fill="blue" stroke="blue" points="2350.73,-2522.16 2360.17,-2517.36 2349.8,-2515.22 2350.73,-2522.16"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge546" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1397.19,-2555.74C1400.15,-2555.31 1403.09,-2554.91 1406,-2554.54 1955.25,-2484.37 2104.75,-2589.41 2656.96,-2518.72"/>
<polygon fill="blue" stroke="blue" points="2657.71,-2522.15 2667.18,-2517.4 2656.81,-2515.21 2657.71,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge559" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1397.19,-2555.72C1400.15,-2555.3 1403.09,-2554.9 1406,-2554.54 2090.81,-2469.02 2276.27,-2605.09 2964.02,-2518.71"/>
<polygon fill="blue" stroke="blue" points="2964.7,-2522.15 2974.18,-2517.42 2963.82,-2515.21 2964.7,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge572" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1397.19,-2555.7C1400.15,-2555.29 1403.09,-2554.9 1406,-2554.54 2226.41,-2453.67 2447.78,-2620.81 3271.16,-2518.69"/>
<polygon fill="blue" stroke="blue" points="3271.69,-2522.15 3281.18,-2517.43 3270.83,-2515.2 3271.69,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge585" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1397.19,-2555.69C1400.15,-2555.28 1403.09,-2554.89 1406,-2554.54 1882.37,-2496.63 3083.95,-2577.1 3578.08,-2518.67"/>
<polygon fill="blue" stroke="blue" points="3578.68,-2522.12 3588.18,-2517.44 3577.83,-2515.18 3578.68,-2522.12"/>
</g>
<!-- qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge598" class="edge">
<title>qkv_layer_2_gpu_2&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1397.19,-2555.69C1400.14,-2555.27 1403.08,-2554.89 1406,-2554.54 1950.09,-2488.96 3322.87,-2584.9 3884.92,-2518.69"/>
<polygon fill="blue" stroke="blue" points="3885.68,-2522.13 3895.18,-2517.45 3884.84,-2515.18 3885.68,-2522.13"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge455" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1414.79,-2555.87C1411.84,-2555.4 1408.91,-2554.96 1406,-2554.54 1149.71,-2517.58 1078.31,-2555.54 817.69,-2518.54"/>
<polygon fill="blue" stroke="blue" points="817.94,-2515.04 807.55,-2517.08 816.94,-2521.97 817.94,-2515.04"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge468" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1414.75,-2556.14C1411.81,-2555.59 1408.89,-2555.05 1406,-2554.54 1284.76,-2532.95 1250.09,-2540.53 1124.59,-2518.57"/>
<polygon fill="blue" stroke="blue" points="1125.05,-2515.1 1114.59,-2516.8 1123.82,-2521.99 1125.05,-2515.1"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge481" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1467.37,-2554.43C1439.94,-2544.07 1409.89,-2532.72 1381.94,-2522.16"/>
<polygon fill="blue" stroke="blue" points="1383.13,-2518.88 1372.54,-2518.62 1380.66,-2525.42 1383.13,-2518.88"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge491" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="black" d="M1570.05,-2554.28C1571.64,-2546.08 1573.36,-2537.28 1575.02,-2528.74"/>
<polygon fill="black" stroke="black" points="1578.46,-2529.37 1576.93,-2518.89 1571.59,-2528.04 1578.46,-2529.37"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge508" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1672.68,-2554.43C1704.54,-2543.93 1739.49,-2532.43 1771.91,-2521.75"/>
<polygon fill="blue" stroke="blue" points="1773.02,-2525.07 1781.43,-2518.62 1770.84,-2518.42 1773.02,-2525.07"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge521" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1711.24,-2556.07C1714.18,-2555.54 1717.11,-2555.03 1720,-2554.54 1860.07,-2530.8 1900,-2542.66 2043.1,-2518.8"/>
<polygon fill="blue" stroke="blue" points="2043.86,-2522.22 2053.13,-2517.09 2042.69,-2515.32 2043.86,-2522.22"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge534" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1711.21,-2555.86C1714.16,-2555.39 1717.09,-2554.95 1720,-2554.54 1995.28,-2515.42 2071.78,-2557.89 2350.17,-2518.72"/>
<polygon fill="blue" stroke="blue" points="2350.76,-2522.17 2360.16,-2517.29 2349.77,-2515.24 2350.76,-2522.17"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge547" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1711.2,-2555.78C1714.15,-2555.34 1717.09,-2554.93 1720,-2554.54 2130.68,-2500.07 2243.33,-2573.43 2657.03,-2518.72"/>
<polygon fill="blue" stroke="blue" points="2657.73,-2522.16 2667.17,-2517.36 2656.8,-2515.22 2657.73,-2522.16"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge560" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1711.19,-2555.74C1714.15,-2555.31 1717.09,-2554.91 1720,-2554.54 2266.18,-2484.72 2414.85,-2589.06 2964.01,-2518.71"/>
<polygon fill="blue" stroke="blue" points="2964.71,-2522.15 2974.18,-2517.4 2963.81,-2515.21 2964.71,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge573" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1711.19,-2555.72C1714.15,-2555.3 1717.09,-2554.9 1720,-2554.54 2401.74,-2469.37 2586.36,-2604.74 3271.07,-2518.7"/>
<polygon fill="blue" stroke="blue" points="3271.7,-2522.15 3281.18,-2517.42 3270.82,-2515.21 3271.7,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge586" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1711.19,-2555.7C1714.15,-2555.29 1717.09,-2554.9 1720,-2554.54 2537.33,-2454.01 2757.88,-2620.45 3578.2,-2518.68"/>
<polygon fill="blue" stroke="blue" points="3578.69,-2522.15 3588.18,-2517.43 3577.83,-2515.2 3578.69,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge599" class="edge">
<title>qkv_layer_2_gpu_3&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1711.19,-2555.69C1714.15,-2555.28 1717.09,-2554.89 1720,-2554.54 2194.83,-2496.8 3392.55,-2576.93 3885.11,-2518.67"/>
<polygon fill="blue" stroke="blue" points="3885.68,-2522.12 3895.18,-2517.44 3884.83,-2515.18 3885.68,-2522.12"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge456" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1728.8,-2555.79C1725.85,-2555.34 1722.91,-2554.93 1720,-2554.54 1325.18,-2501.87 1216.81,-2571.32 817.62,-2518.52"/>
<polygon fill="blue" stroke="blue" points="817.91,-2515.03 807.53,-2517.17 816.98,-2521.96 817.91,-2515.03"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge469" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1728.79,-2555.87C1725.84,-2555.4 1722.91,-2554.96 1720,-2554.54 1460.67,-2517.24 1388.41,-2555.87 1124.81,-2518.56"/>
<polygon fill="blue" stroke="blue" points="1124.94,-2515.04 1114.55,-2517.08 1123.94,-2521.97 1124.94,-2515.04"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge482" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1728.75,-2556.12C1725.81,-2555.58 1722.89,-2555.05 1720,-2554.54 1595.77,-2532.62 1560.21,-2540.85 1431.82,-2518.61"/>
<polygon fill="blue" stroke="blue" points="1432.05,-2515.1 1421.59,-2516.81 1430.83,-2521.99 1432.05,-2515.1"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge495" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1779.03,-2554.43C1750.93,-2544.07 1720.14,-2532.72 1691.5,-2522.16"/>
<polygon fill="blue" stroke="blue" points="1692.47,-2518.79 1681.88,-2518.62 1690.05,-2525.36 1692.47,-2518.79"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge504" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="black" d="M1881.7,-2554.28C1882.75,-2546.17 1883.88,-2537.47 1884.97,-2529.02"/>
<polygon fill="black" stroke="black" points="1888.47,-2529.26 1886.29,-2518.89 1881.53,-2528.36 1888.47,-2529.26"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge522" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1984.33,-2554.43C2015.39,-2543.98 2049.43,-2532.52 2081.04,-2521.89"/>
<polygon fill="blue" stroke="blue" points="2082.4,-2525.12 2090.77,-2518.62 2080.17,-2518.49 2082.4,-2525.12"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge535" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2025.24,-2556.08C2028.18,-2555.55 2031.11,-2555.03 2034,-2554.54 2170.92,-2531.17 2210.04,-2542.32 2349.88,-2518.84"/>
<polygon fill="blue" stroke="blue" points="2350.86,-2522.22 2360.13,-2517.09 2349.68,-2515.32 2350.86,-2522.22"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge548" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2025.21,-2555.86C2028.16,-2555.39 2031.09,-2554.95 2034,-2554.54 2306.1,-2515.79 2381.81,-2557.51 2656.87,-2518.77"/>
<polygon fill="blue" stroke="blue" points="2657.76,-2522.17 2667.16,-2517.29 2656.77,-2515.24 2657.76,-2522.17"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge561" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2025.2,-2555.78C2028.15,-2555.34 2031.09,-2554.93 2034,-2554.54 2441.61,-2500.42 2553.44,-2573.08 2964.11,-2518.71"/>
<polygon fill="blue" stroke="blue" points="2964.73,-2522.16 2974.17,-2517.36 2963.8,-2515.22 2964.73,-2522.16"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge574" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2025.19,-2555.74C2028.15,-2555.31 2031.09,-2554.91 2034,-2554.54 2577.11,-2485.07 2724.95,-2588.71 3271.07,-2518.71"/>
<polygon fill="blue" stroke="blue" points="3271.71,-2522.15 3281.18,-2517.4 3270.81,-2515.21 3271.71,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge587" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2025.19,-2555.72C2028.15,-2555.3 2031.09,-2554.9 2034,-2554.54 2712.66,-2469.72 2896.46,-2604.39 3578.11,-2518.7"/>
<polygon fill="blue" stroke="blue" points="3578.7,-2522.15 3588.18,-2517.42 3577.82,-2515.21 3578.7,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge600" class="edge">
<title>qkv_layer_2_gpu_4&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2025.19,-2555.71C2028.15,-2555.29 2031.09,-2554.9 2034,-2554.54 2848.25,-2454.36 3067.97,-2620.1 3885.24,-2518.68"/>
<polygon fill="blue" stroke="blue" points="3885.69,-2522.15 3895.18,-2517.43 3884.83,-2515.2 3885.69,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge457" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2042.81,-2555.75C2039.85,-2555.32 2036.91,-2554.91 2034,-2554.54 1500.54,-2486.16 1355.36,-2587.23 817.48,-2518.5"/>
<polygon fill="blue" stroke="blue" points="817.89,-2515.02 807.53,-2517.21 817,-2521.96 817.89,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge470" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2042.8,-2555.79C2039.85,-2555.34 2036.91,-2554.93 2034,-2554.54 1636.12,-2501.52 1526.91,-2571.67 1124.69,-2518.53"/>
<polygon fill="blue" stroke="blue" points="1124.91,-2515.03 1114.53,-2517.17 1123.98,-2521.96 1124.91,-2515.03"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge483" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2042.79,-2555.87C2039.84,-2555.4 2036.91,-2554.96 2034,-2554.54 1771.49,-2516.87 1698.45,-2556.25 1431.53,-2518.52"/>
<polygon fill="blue" stroke="blue" points="1431.94,-2515.04 1421.55,-2517.08 1430.95,-2521.97 1431.94,-2515.04"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge496" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2042.75,-2556.11C2039.81,-2555.57 2036.89,-2555.05 2034,-2554.54 1906.65,-2532.26 1870.26,-2541.19 1738.65,-2518.58"/>
<polygon fill="blue" stroke="blue" points="1739.04,-2515.09 1728.59,-2516.82 1737.84,-2521.99 1739.04,-2515.09"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge509" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2090.69,-2554.43C2061.79,-2544.02 2030.12,-2532.62 2000.69,-2522.03"/>
<polygon fill="blue" stroke="blue" points="2001.81,-2518.71 1991.22,-2518.62 1999.44,-2525.3 2001.81,-2518.71"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge517" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="black" d="M2193.35,-2554.28C2193.88,-2546.17 2194.44,-2537.47 2194.99,-2529.02"/>
<polygon fill="black" stroke="black" points="2198.49,-2529.1 2195.64,-2518.89 2191.5,-2528.64 2198.49,-2529.1"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge536" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2295.99,-2554.43C2326.37,-2543.98 2359.67,-2532.52 2390.59,-2521.89"/>
<polygon fill="blue" stroke="blue" points="2391.79,-2525.18 2400.1,-2518.62 2389.51,-2518.56 2391.79,-2525.18"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge549" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2339.25,-2556.09C2342.19,-2555.55 2345.11,-2555.04 2348,-2554.54 2481.92,-2531.51 2520.16,-2541.99 2657.1,-2518.8"/>
<polygon fill="blue" stroke="blue" points="2657.87,-2522.22 2667.13,-2517.08 2656.68,-2515.32 2657.87,-2522.22"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge562" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2339.21,-2555.86C2342.16,-2555.4 2345.09,-2554.95 2348,-2554.54 2617.05,-2516.13 2691.92,-2557.17 2963.98,-2518.75"/>
<polygon fill="blue" stroke="blue" points="2964.76,-2522.17 2974.16,-2517.29 2963.77,-2515.25 2964.76,-2522.17"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge575" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2339.2,-2555.78C2342.15,-2555.34 2345.09,-2554.93 2348,-2554.54 2752.55,-2500.76 2863.54,-2572.73 3271.18,-2518.7"/>
<polygon fill="blue" stroke="blue" points="3271.73,-2522.16 3281.17,-2517.36 3270.8,-2515.22 3271.73,-2522.16"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge588" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2339.19,-2555.74C2342.15,-2555.31 2345.09,-2554.91 2348,-2554.54 2888.04,-2485.41 3035.05,-2588.36 3578.13,-2518.7"/>
<polygon fill="blue" stroke="blue" points="3578.71,-2522.15 3588.18,-2517.4 3577.81,-2515.21 3578.71,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge601" class="edge">
<title>qkv_layer_2_gpu_5&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2339.19,-2555.72C2342.15,-2555.3 2345.09,-2554.9 2348,-2554.54 3023.59,-2470.06 3206.56,-2604.04 3885.16,-2518.69"/>
<polygon fill="blue" stroke="blue" points="3885.7,-2522.15 3895.18,-2517.42 3884.82,-2515.21 3885.7,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge458" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2356.81,-2555.72C2353.85,-2555.3 2350.91,-2554.9 2348,-2554.54 1675.93,-2470.46 1493.96,-2603.15 817.52,-2518.5"/>
<polygon fill="blue" stroke="blue" points="817.88,-2515.02 807.52,-2517.24 817.01,-2521.96 817.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge471" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2356.81,-2555.75C2353.85,-2555.32 2350.91,-2554.91 2348,-2554.54 1811.47,-2485.81 1665.46,-2587.58 1124.54,-2518.5"/>
<polygon fill="blue" stroke="blue" points="1124.89,-2515.02 1114.53,-2517.21 1124,-2521.96 1124.89,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge484" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2356.8,-2555.78C2353.85,-2555.34 2350.91,-2554.93 2348,-2554.54 1946.95,-2501.16 1836.96,-2572.05 1431.47,-2518.5"/>
<polygon fill="blue" stroke="blue" points="1431.91,-2515.03 1421.53,-2517.17 1430.98,-2521.96 1431.91,-2515.03"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge497" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2356.79,-2555.86C2353.84,-2555.4 2350.91,-2554.96 2348,-2554.54 2082.44,-2516.53 2008.56,-2556.59 1738.64,-2518.53"/>
<polygon fill="blue" stroke="blue" points="1738.94,-2515.04 1728.54,-2517.09 1737.95,-2521.97 1738.94,-2515.04"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge510" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2356.75,-2556.1C2353.81,-2555.56 2350.89,-2555.04 2348,-2554.54 2217.51,-2531.89 2180.3,-2541.53 2045.46,-2518.54"/>
<polygon fill="blue" stroke="blue" points="2046.04,-2515.09 2035.59,-2516.83 2044.84,-2521.99 2046.04,-2515.09"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge523" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2402.35,-2554.43C2372.78,-2544.02 2340.37,-2532.62 2310.25,-2522.03"/>
<polygon fill="blue" stroke="blue" points="2311.15,-2518.63 2300.56,-2518.62 2308.83,-2525.24 2311.15,-2518.63"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge530" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="black" d="M2505,-2554.28C2505,-2546.17 2505,-2537.47 2505,-2529.02"/>
<polygon fill="black" stroke="black" points="2508.5,-2528.89 2505,-2518.89 2501.5,-2528.89 2508.5,-2528.89"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge550" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2607.65,-2554.43C2637.22,-2544.02 2669.63,-2532.62 2699.75,-2522.03"/>
<polygon fill="blue" stroke="blue" points="2701.17,-2525.24 2709.44,-2518.62 2698.85,-2518.63 2701.17,-2525.24"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge563" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2653.25,-2556.1C2656.19,-2555.56 2659.11,-2555.04 2662,-2554.54 2792.78,-2531.87 2830.2,-2541.65 2963.9,-2518.84"/>
<polygon fill="blue" stroke="blue" points="2964.87,-2522.23 2974.13,-2517.07 2963.68,-2515.33 2964.87,-2522.23"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge576" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2653.21,-2555.86C2656.16,-2555.4 2659.09,-2554.96 2662,-2554.54 2928,-2516.48 3002.03,-2556.83 3271.1,-2518.74"/>
<polygon fill="blue" stroke="blue" points="3271.76,-2522.18 3281.16,-2517.29 3270.77,-2515.25 3271.76,-2522.18"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge589" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2653.2,-2555.78C2656.15,-2555.34 2659.09,-2554.93 2662,-2554.54 3063.48,-2501.11 3173.64,-2572.39 3578.25,-2518.69"/>
<polygon fill="blue" stroke="blue" points="3578.73,-2522.16 3588.17,-2517.36 3577.8,-2515.22 3578.73,-2522.16"/>
</g>
<!-- qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge602" class="edge">
<title>qkv_layer_2_gpu_6&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2653.19,-2555.75C2656.15,-2555.32 2659.09,-2554.91 2662,-2554.54 3198.97,-2485.76 3345.15,-2588.01 3885.18,-2518.69"/>
<polygon fill="blue" stroke="blue" points="3885.71,-2522.15 3895.18,-2517.4 3884.81,-2515.21 3885.71,-2522.15"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge459" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2670.81,-2555.71C2667.85,-2555.29 2664.91,-2554.9 2662,-2554.54 1851.36,-2454.77 1632.61,-2619.07 817.74,-2518.53"/>
<polygon fill="blue" stroke="blue" points="817.88,-2515.02 807.52,-2517.25 817.01,-2521.96 817.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge472" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2670.81,-2555.72C2667.85,-2555.3 2664.91,-2554.9 2662,-2554.54 1986.85,-2470.11 1804.06,-2603.5 1124.56,-2518.5"/>
<polygon fill="blue" stroke="blue" points="1124.88,-2515.02 1114.52,-2517.24 1124.01,-2521.96 1124.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge485" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2670.81,-2555.74C2667.85,-2555.31 2664.91,-2554.91 2662,-2554.54 2122.4,-2485.46 1975.55,-2587.92 1431.59,-2518.51"/>
<polygon fill="blue" stroke="blue" points="1431.89,-2515.02 1421.53,-2517.21 1431,-2521.96 1431.89,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge498" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2670.8,-2555.78C2667.85,-2555.34 2664.91,-2554.93 2662,-2554.54 2257.89,-2500.81 2147.06,-2572.39 1738.55,-2518.51"/>
<polygon fill="blue" stroke="blue" points="1738.91,-2515.03 1728.53,-2517.17 1737.98,-2521.96 1738.91,-2515.03"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge511" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2670.79,-2555.86C2667.84,-2555.4 2664.91,-2554.95 2662,-2554.54 2393.39,-2516.18 2318.66,-2556.93 2045.75,-2518.55"/>
<polygon fill="blue" stroke="blue" points="2045.94,-2515.04 2035.54,-2517.09 2044.95,-2521.97 2045.94,-2515.04"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge524" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2670.75,-2556.09C2667.81,-2555.56 2664.89,-2555.04 2662,-2554.54 2528.51,-2531.56 2490.42,-2541.85 2352.68,-2518.58"/>
<polygon fill="blue" stroke="blue" points="2353.03,-2515.09 2342.58,-2516.84 2351.85,-2521.99 2353.03,-2515.09"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge537" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2714.01,-2554.43C2683.63,-2543.98 2650.33,-2532.52 2619.41,-2521.89"/>
<polygon fill="blue" stroke="blue" points="2620.49,-2518.56 2609.9,-2518.62 2618.21,-2525.18 2620.49,-2518.56"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge543" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="black" d="M2816.65,-2554.28C2816.12,-2546.17 2815.56,-2537.47 2815.01,-2529.02"/>
<polygon fill="black" stroke="black" points="2818.5,-2528.64 2814.36,-2518.89 2811.51,-2529.1 2818.5,-2528.64"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge564" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2919.31,-2554.43C2948.21,-2544.02 2979.88,-2532.62 3009.31,-2522.03"/>
<polygon fill="blue" stroke="blue" points="3010.56,-2525.3 3018.78,-2518.62 3008.19,-2518.71 3010.56,-2525.3"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge577" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2967.25,-2556.11C2970.19,-2555.57 2973.11,-2555.04 2976,-2554.54 3103.78,-2532.21 3140.31,-2541.33 3271.12,-2518.81"/>
<polygon fill="blue" stroke="blue" points="3271.88,-2522.23 3281.12,-2517.06 3270.67,-2515.33 3271.88,-2522.23"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge590" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2967.21,-2555.87C2970.16,-2555.4 2973.09,-2554.96 2976,-2554.54 3238.95,-2516.82 3312.13,-2556.49 3578.21,-2518.72"/>
<polygon fill="blue" stroke="blue" points="3578.76,-2522.18 3588.16,-2517.28 3577.76,-2515.25 3578.76,-2522.18"/>
</g>
<!-- qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge603" class="edge">
<title>qkv_layer_2_gpu_7&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2967.2,-2555.79C2970.15,-2555.34 2973.09,-2554.93 2976,-2554.54 3374.32,-2501.47 3483.69,-2572 3885.03,-2518.72"/>
<polygon fill="blue" stroke="blue" points="3885.73,-2522.16 3895.17,-2517.36 3884.79,-2515.22 3885.73,-2522.16"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge460" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2984.81,-2555.69C2981.85,-2555.28 2978.91,-2554.89 2976,-2554.54 2502.92,-2497 1309.67,-2576.39 817.58,-2518.48"/>
<polygon fill="blue" stroke="blue" points="817.87,-2514.99 807.52,-2517.27 817.03,-2521.94 817.87,-2514.99"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge473" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2984.81,-2555.71C2981.85,-2555.29 2978.91,-2554.9 2976,-2554.54 2162.19,-2454.41 1942.66,-2619.46 1124.48,-2518.49"/>
<polygon fill="blue" stroke="blue" points="1124.88,-2515.02 1114.52,-2517.25 1124.01,-2521.96 1124.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge486" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2984.81,-2555.72C2981.85,-2555.3 2978.91,-2554.9 2976,-2554.54 2297.78,-2469.76 2114.16,-2603.85 1431.61,-2518.51"/>
<polygon fill="blue" stroke="blue" points="1431.88,-2515.02 1421.52,-2517.24 1431.01,-2521.96 1431.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge499" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2984.81,-2555.74C2981.85,-2555.31 2978.91,-2554.91 2976,-2554.54 2433.33,-2485.12 2285.65,-2588.27 1738.65,-2518.52"/>
<polygon fill="blue" stroke="blue" points="1738.89,-2515.02 1728.53,-2517.21 1738,-2521.96 1738.89,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge512" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2984.8,-2555.78C2981.85,-2555.34 2978.91,-2554.93 2976,-2554.54 2568.82,-2500.47 2457.16,-2572.74 2045.62,-2518.52"/>
<polygon fill="blue" stroke="blue" points="2045.91,-2515.03 2035.53,-2517.17 2044.98,-2521.96 2045.91,-2515.03"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge525" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2984.79,-2555.86C2981.84,-2555.39 2978.91,-2554.95 2976,-2554.54 2704.21,-2515.82 2628.7,-2557.31 2352.46,-2518.51"/>
<polygon fill="blue" stroke="blue" points="2352.94,-2515.04 2342.54,-2517.09 2351.95,-2521.97 2352.94,-2515.04"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge538" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2984.76,-2556.08C2981.82,-2555.55 2978.89,-2555.03 2976,-2554.54 2839.37,-2531.19 2800.45,-2542.19 2659.46,-2518.54"/>
<polygon fill="blue" stroke="blue" points="2660.03,-2515.09 2649.58,-2516.85 2658.85,-2521.99 2660.03,-2515.09"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge551" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3025.67,-2554.43C2994.61,-2543.98 2960.57,-2532.52 2928.96,-2521.89"/>
<polygon fill="blue" stroke="blue" points="2929.83,-2518.49 2919.23,-2518.62 2927.6,-2525.12 2929.83,-2518.49"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge556" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="black" d="M3128.3,-2554.28C3127.25,-2546.17 3126.12,-2537.47 3125.03,-2529.02"/>
<polygon fill="black" stroke="black" points="3128.47,-2528.36 3123.71,-2518.89 3121.53,-2529.26 3128.47,-2528.36"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge578" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3230.97,-2554.43C3259.07,-2544.07 3289.86,-2532.72 3318.5,-2522.16"/>
<polygon fill="blue" stroke="blue" points="3319.95,-2525.36 3328.12,-2518.62 3317.53,-2518.79 3319.95,-2525.36"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge591" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3281.25,-2556.12C3284.19,-2555.58 3287.11,-2555.05 3290,-2554.54 3414.66,-2532.57 3450.36,-2540.99 3577.96,-2518.84"/>
<polygon fill="blue" stroke="blue" points="3578.88,-2522.23 3588.12,-2517.05 3577.67,-2515.34 3578.88,-2522.23"/>
</g>
<!-- qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge604" class="edge">
<title>qkv_layer_2_gpu_8&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3281.21,-2555.87C3284.16,-2555.4 3287.09,-2554.96 3290,-2554.54 3549.77,-2517.19 3622.17,-2556.11 3884.93,-2518.76"/>
<polygon fill="blue" stroke="blue" points="3885.76,-2522.18 3895.16,-2517.28 3884.76,-2515.25 3885.76,-2522.18"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge461" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3298.81,-2555.69C3295.86,-2555.27 3292.92,-2554.89 3290,-2554.54 2747.67,-2489.16 1379.36,-2584.31 817.77,-2518.51"/>
<polygon fill="blue" stroke="blue" points="817.87,-2514.99 807.52,-2517.28 817.03,-2521.94 817.87,-2514.99"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge474" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3298.81,-2555.69C3295.85,-2555.28 3292.91,-2554.89 3290,-2554.54 2815.39,-2496.82 1618.27,-2576.56 1124.61,-2518.49"/>
<polygon fill="blue" stroke="blue" points="1124.87,-2514.99 1114.52,-2517.27 1124.03,-2521.94 1124.87,-2514.99"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge487" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3298.81,-2555.7C3295.85,-2555.29 3292.91,-2554.9 3290,-2554.54 2473.11,-2454.06 2252.75,-2619.81 1431.52,-2518.5"/>
<polygon fill="blue" stroke="blue" points="1431.88,-2515.02 1421.52,-2517.25 1431.01,-2521.96 1431.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge500" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3298.81,-2555.72C3295.85,-2555.3 3292.91,-2554.9 3290,-2554.54 2608.7,-2469.42 2424.26,-2604.2 1738.65,-2518.52"/>
<polygon fill="blue" stroke="blue" points="1738.88,-2515.02 1728.52,-2517.24 1738.01,-2521.96 1738.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge513" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3298.81,-2555.74C3295.85,-2555.31 3292.91,-2554.91 3290,-2554.54 2744.26,-2484.77 2595.75,-2588.62 2045.71,-2518.52"/>
<polygon fill="blue" stroke="blue" points="2045.89,-2515.02 2035.53,-2517.21 2045,-2521.96 2045.89,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge526" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3298.8,-2555.78C3295.85,-2555.34 3292.91,-2554.93 3290,-2554.54 2879.76,-2500.12 2767.26,-2573.08 2352.69,-2518.53"/>
<polygon fill="blue" stroke="blue" points="2352.91,-2515.03 2342.53,-2517.17 2351.98,-2521.96 2352.91,-2515.03"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge539" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3298.79,-2555.86C3295.84,-2555.39 3292.91,-2554.95 3290,-2554.54 3015.15,-2515.47 2938.8,-2557.65 2659.56,-2518.52"/>
<polygon fill="blue" stroke="blue" points="2659.94,-2515.04 2649.54,-2517.09 2658.95,-2521.97 2659.94,-2515.04"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge552" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3298.76,-2556.07C3295.82,-2555.54 3292.89,-2555.03 3290,-2554.54 3150.36,-2530.85 3110.57,-2542.52 2966.67,-2518.57"/>
<polygon fill="blue" stroke="blue" points="2967.02,-2515.08 2956.58,-2516.86 2965.86,-2521.98 2967.02,-2515.08"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge565" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3337.32,-2554.43C3305.46,-2543.93 3270.51,-2532.43 3238.09,-2521.75"/>
<polygon fill="blue" stroke="blue" points="3239.16,-2518.42 3228.57,-2518.62 3236.98,-2525.07 3239.16,-2518.42"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge569" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="black" d="M3439.95,-2554.28C3438.36,-2546.08 3436.64,-2537.28 3434.98,-2528.74"/>
<polygon fill="black" stroke="black" points="3438.41,-2528.04 3433.07,-2518.89 3431.54,-2529.37 3438.41,-2528.04"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge592" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3542.63,-2554.43C3570.06,-2544.07 3600.11,-2532.72 3628.06,-2522.16"/>
<polygon fill="blue" stroke="blue" points="3629.34,-2525.42 3637.46,-2518.62 3626.87,-2518.88 3629.34,-2525.42"/>
</g>
<!-- qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge605" class="edge">
<title>qkv_layer_2_gpu_9&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3595.25,-2556.13C3598.19,-2555.59 3601.11,-2555.05 3604,-2554.54 3725.66,-2532.91 3760.48,-2540.67 3885.19,-2518.8"/>
<polygon fill="blue" stroke="blue" points="3885.89,-2522.23 3895.12,-2517.03 3884.66,-2515.34 3885.89,-2522.23"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge462" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3612.81,-2555.68C3609.86,-2555.27 3606.92,-2554.89 3604,-2554.54 2992.31,-2481.3 1448.54,-2592.27 817.66,-2518.49"/>
<polygon fill="blue" stroke="blue" points="817.86,-2514.99 807.52,-2517.28 817.03,-2521.94 817.86,-2514.99"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge475" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3612.81,-2555.69C3609.86,-2555.27 3606.92,-2554.89 3604,-2554.54 3060.13,-2488.98 1687.95,-2584.48 1124.8,-2518.51"/>
<polygon fill="blue" stroke="blue" points="1124.86,-2514.99 1114.52,-2517.28 1124.03,-2521.94 1124.86,-2514.99"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge488" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3612.81,-2555.69C3609.85,-2555.28 3606.91,-2554.89 3604,-2554.54 3127.85,-2496.65 1926.87,-2576.73 1431.65,-2518.49"/>
<polygon fill="blue" stroke="blue" points="1431.87,-2514.99 1421.52,-2517.27 1431.03,-2521.94 1431.87,-2514.99"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge501" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3612.81,-2555.7C3609.85,-2555.29 3606.91,-2554.9 3604,-2554.54 2784.03,-2453.71 2562.85,-2620.17 1738.55,-2518.5"/>
<polygon fill="blue" stroke="blue" points="1738.88,-2515.02 1728.52,-2517.25 1738.01,-2521.96 1738.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge514" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3612.81,-2555.72C3609.85,-2555.3 3606.91,-2554.9 3604,-2554.54 2919.63,-2469.07 2734.35,-2604.55 2045.7,-2518.52"/>
<polygon fill="blue" stroke="blue" points="2045.88,-2515.02 2035.52,-2517.24 2045.01,-2521.96 2045.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge527" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3612.81,-2555.74C3609.85,-2555.31 3606.91,-2554.91 3604,-2554.54 3055.18,-2484.42 2905.85,-2588.97 2352.76,-2518.53"/>
<polygon fill="blue" stroke="blue" points="2352.89,-2515.02 2342.53,-2517.21 2352,-2521.96 2352.89,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge540" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3612.8,-2555.78C3609.85,-2555.34 3606.91,-2554.92 3604,-2554.54 3190.59,-2499.76 3077.31,-2573.46 2659.46,-2518.5"/>
<polygon fill="blue" stroke="blue" points="2659.91,-2515.03 2649.53,-2517.17 2658.98,-2521.96 2659.91,-2515.03"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge553" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3612.79,-2555.85C3609.84,-2555.39 3606.91,-2554.95 3604,-2554.54 3326.1,-2515.13 3248.91,-2557.99 2966.67,-2518.53"/>
<polygon fill="blue" stroke="blue" points="2966.94,-2515.04 2956.54,-2517.1 2965.95,-2521.97 2966.94,-2515.04"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge566" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3612.76,-2556.06C3609.82,-2555.54 3606.9,-2555.03 3604,-2554.54 3461.35,-2530.51 3420.69,-2542.84 3273.87,-2518.6"/>
<polygon fill="blue" stroke="blue" points="3274.02,-2515.08 3263.58,-2516.87 3272.86,-2521.98 3274.02,-2515.08"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge579" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3648.98,-2554.43C3616.44,-2543.93 3580.74,-2532.43 3547.63,-2521.75"/>
<polygon fill="blue" stroke="blue" points="3548.5,-2518.35 3537.91,-2518.62 3546.35,-2525.02 3548.5,-2518.35"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge582" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="black" d="M3751.6,-2554.28C3749.47,-2546.08 3747.19,-2537.28 3744.98,-2528.74"/>
<polygon fill="black" stroke="black" points="3748.32,-2527.69 3742.42,-2518.89 3741.55,-2529.45 3748.32,-2527.69"/>
</g>
<!-- qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge606" class="edge">
<title>qkv_layer_2_gpu_10&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3854.29,-2554.43C3880.93,-2544.11 3910.11,-2532.82 3937.28,-2522.3"/>
<polygon fill="blue" stroke="blue" points="3938.73,-2525.49 3946.8,-2518.62 3936.21,-2518.96 3938.73,-2525.49"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_0 -->
<g id="edge463" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3926.81,-2555.67C3923.86,-2555.27 3920.92,-2554.89 3918,-2554.54 3236.93,-2473.45 1517.62,-2600.25 817.49,-2518.48"/>
<polygon fill="blue" stroke="blue" points="817.86,-2514.99 807.52,-2517.29 817.03,-2521.95 817.86,-2514.99"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_1 -->
<g id="edge476" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3926.81,-2555.68C3923.86,-2555.27 3920.92,-2554.89 3918,-2554.54 3304.77,-2481.13 1757.12,-2592.44 1124.68,-2518.5"/>
<polygon fill="blue" stroke="blue" points="1124.86,-2514.99 1114.52,-2517.28 1124.03,-2521.94 1124.86,-2514.99"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_2 -->
<g id="edge489" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3926.81,-2555.69C3923.86,-2555.27 3920.92,-2554.89 3918,-2554.54 3372.6,-2488.81 1996.54,-2584.65 1431.83,-2518.51"/>
<polygon fill="blue" stroke="blue" points="1431.86,-2514.99 1421.52,-2517.28 1431.03,-2521.94 1431.86,-2514.99"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_3 -->
<g id="edge502" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3926.81,-2555.69C3923.85,-2555.28 3920.91,-2554.89 3918,-2554.54 3440.32,-2496.48 2235.47,-2576.91 1738.68,-2518.49"/>
<polygon fill="blue" stroke="blue" points="1738.87,-2514.99 1728.52,-2517.27 1738.03,-2521.94 1738.87,-2514.99"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_4 -->
<g id="edge515" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3926.81,-2555.7C3923.85,-2555.29 3920.91,-2554.9 3918,-2554.54 3094.95,-2453.37 2872.95,-2620.52 2045.59,-2518.51"/>
<polygon fill="blue" stroke="blue" points="2045.88,-2515.02 2035.52,-2517.26 2045.01,-2521.96 2045.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_5 -->
<g id="edge528" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3926.81,-2555.72C3923.85,-2555.3 3920.91,-2554.9 3918,-2554.54 3230.47,-2468.71 3044.41,-2604.93 2352.49,-2518.49"/>
<polygon fill="blue" stroke="blue" points="2352.88,-2515.02 2342.52,-2517.24 2352.01,-2521.96 2352.88,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_6 -->
<g id="edge541" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3926.81,-2555.74C3923.85,-2555.31 3920.91,-2554.91 3918,-2554.54 3366.11,-2484.07 3215.95,-2589.32 2659.82,-2518.54"/>
<polygon fill="blue" stroke="blue" points="2659.89,-2515.02 2649.53,-2517.22 2659,-2521.96 2659.89,-2515.02"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_7 -->
<g id="edge554" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3926.8,-2555.78C3923.85,-2555.34 3920.91,-2554.92 3918,-2554.54 3501.53,-2499.41 3387.41,-2573.81 2966.53,-2518.51"/>
<polygon fill="blue" stroke="blue" points="2966.91,-2515.03 2956.53,-2517.18 2965.98,-2521.96 2966.91,-2515.03"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_8 -->
<g id="edge567" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3926.79,-2555.85C3923.84,-2555.39 3920.91,-2554.95 3918,-2554.54 3637.05,-2514.78 3559.02,-2558.33 3273.78,-2518.55"/>
<polygon fill="blue" stroke="blue" points="3273.93,-2515.04 3263.54,-2517.1 3272.95,-2521.97 3273.93,-2515.04"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_9 -->
<g id="edge580" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3926.76,-2556.05C3923.82,-2555.53 3920.9,-2555.02 3918,-2554.54 3772.2,-2530.15 3730.72,-2543.19 3580.62,-2518.56"/>
<polygon fill="blue" stroke="blue" points="3581.02,-2515.08 3570.58,-2516.88 3579.86,-2521.98 3581.02,-2515.08"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_10 -->
<g id="edge593" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3960.64,-2554.43C3927.42,-2543.93 3890.97,-2532.43 3857.17,-2521.75"/>
<polygon fill="blue" stroke="blue" points="3857.84,-2518.29 3847.25,-2518.62 3855.73,-2524.97 3857.84,-2518.29"/>
</g>
<!-- qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_11 -->
<g id="edge595" class="edge">
<title>qkv_layer_2_gpu_11&#45;&gt;attention_layer_2_gpu_11</title>
<path fill="none" stroke="black" d="M4063.25,-2554.28C4060.56,-2545.99 4057.68,-2537.09 4054.88,-2528.46"/>
<polygon fill="black" stroke="black" points="4058.19,-2527.32 4051.78,-2518.89 4051.53,-2529.48 4058.19,-2527.32"/>
</g>
<!-- attention_agg_layer_2 -->
<g id="node124" class="node">
<title>attention_agg_layer_2</title>
<polygon fill="#ffcccc" stroke="black" points="2822.49,-2408.54 2317.43,-2408.54 2187.51,-2304.54 2692.57,-2304.54 2822.49,-2408.54"/>
<text text-anchor="middle" x="2505" y="-2370.54" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="2505" y="-2359.54" font-family="Arial" font-size="10.00">Input: [12Ã— batch_size=1024, seq_len=2048, heads=2&#45;3, d_k=128]</text>
<text text-anchor="middle" x="2505" y="-2348.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2505" y="-2337.54" font-family="Arial" font-size="10.00">GPU: all attention GPUs</text>
</g>
<!-- attention_layer_2_gpu_0&#45;&gt;attention_agg_layer_2 -->
<g id="edge607" class="edge">
<title>attention_layer_2_gpu_0&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M807.54,-2445.96C810.72,-2445.46 813.87,-2444.98 817,-2444.54 1086.41,-2406.42 1851.3,-2377.87 2252.43,-2365.03"/>
<polygon fill="black" stroke="black" points="2252.54,-2368.53 2262.43,-2364.72 2252.32,-2361.54 2252.54,-2368.53"/>
</g>
<!-- attention_layer_2_gpu_1&#45;&gt;attention_agg_layer_2 -->
<g id="edge608" class="edge">
<title>attention_layer_2_gpu_1&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M1114.55,-2446.01C1117.72,-2445.49 1120.88,-2445 1124,-2444.54 1512.98,-2387.23 1969.04,-2367.64 2247.43,-2360.96"/>
<polygon fill="black" stroke="black" points="2247.76,-2364.46 2257.67,-2360.72 2247.59,-2357.46 2247.76,-2364.46"/>
</g>
<!-- attention_layer_2_gpu_2&#45;&gt;attention_agg_layer_2 -->
<g id="edge609" class="edge">
<title>attention_layer_2_gpu_2&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M1421.56,-2446.09C1424.73,-2445.54 1427.88,-2445.03 1431,-2444.54 1711.43,-2400.65 2036.72,-2378.23 2255.19,-2367.24"/>
<polygon fill="black" stroke="black" points="2255.37,-2370.73 2265.19,-2366.74 2255.02,-2363.74 2255.37,-2370.73"/>
</g>
<!-- attention_layer_2_gpu_3&#45;&gt;attention_agg_layer_2 -->
<g id="edge610" class="edge">
<title>attention_layer_2_gpu_3&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M1728.58,-2446.22C1731.75,-2445.64 1734.89,-2445.08 1738,-2444.54 1914.04,-2414.09 2114.73,-2391.76 2266.66,-2377.35"/>
<polygon fill="black" stroke="black" points="2267.43,-2380.79 2277.05,-2376.37 2266.77,-2373.82 2267.43,-2380.79"/>
</g>
<!-- attention_layer_2_gpu_4&#45;&gt;attention_agg_layer_2 -->
<g id="edge611" class="edge">
<title>attention_layer_2_gpu_4&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M2035.64,-2446.54C2038.79,-2445.86 2041.91,-2445.19 2045,-2444.54 2124.69,-2427.7 2212.48,-2410.71 2289.82,-2396.27"/>
<polygon fill="black" stroke="black" points="2290.49,-2399.7 2299.68,-2394.43 2289.21,-2392.82 2290.49,-2399.7"/>
</g>
<!-- attention_layer_2_gpu_5&#45;&gt;attention_agg_layer_2 -->
<g id="edge612" class="edge">
<title>attention_layer_2_gpu_5&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M2288.04,-2444.47C2313.12,-2434.42 2340.95,-2423.27 2368.08,-2412.4"/>
<polygon fill="black" stroke="black" points="2369.66,-2415.53 2377.64,-2408.56 2367.06,-2409.03 2369.66,-2415.53"/>
</g>
<!-- attention_layer_2_gpu_6&#45;&gt;attention_agg_layer_2 -->
<g id="edge613" class="edge">
<title>attention_layer_2_gpu_6&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M2505,-2444.3C2505,-2436.25 2505,-2427.51 2505,-2418.77"/>
<polygon fill="black" stroke="black" points="2508.5,-2418.56 2505,-2408.56 2501.5,-2418.56 2508.5,-2418.56"/>
</g>
<!-- attention_layer_2_gpu_7&#45;&gt;attention_agg_layer_2 -->
<g id="edge614" class="edge">
<title>attention_layer_2_gpu_7&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M2721.96,-2444.47C2696.88,-2434.42 2669.05,-2423.27 2641.92,-2412.4"/>
<polygon fill="black" stroke="black" points="2642.94,-2409.03 2632.36,-2408.56 2640.34,-2415.53 2642.94,-2409.03"/>
</g>
<!-- attention_layer_2_gpu_8&#45;&gt;attention_agg_layer_2 -->
<g id="edge615" class="edge">
<title>attention_layer_2_gpu_8&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M2974.48,-2446.35C2971.63,-2445.74 2968.8,-2445.13 2966,-2444.54 2911.32,-2432.95 2852.82,-2421.32 2796.49,-2410.51"/>
<polygon fill="black" stroke="black" points="2796.85,-2407.02 2786.37,-2408.57 2795.53,-2413.89 2796.85,-2407.02"/>
</g>
<!-- attention_layer_2_gpu_9&#45;&gt;attention_agg_layer_2 -->
<g id="edge616" class="edge">
<title>attention_layer_2_gpu_9&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M3281.13,-2445.99C3278.4,-2445.49 3275.69,-2445.01 3273,-2444.54 3117.59,-2417.55 2942.96,-2397 2799.54,-2382.67"/>
<polygon fill="black" stroke="black" points="2799.57,-2379.16 2789.27,-2381.65 2798.87,-2386.12 2799.57,-2379.16"/>
</g>
<!-- attention_layer_2_gpu_10&#45;&gt;attention_agg_layer_2 -->
<g id="edge617" class="edge">
<title>attention_layer_2_gpu_10&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M3588.15,-2445.87C3585.41,-2445.41 3582.7,-2444.96 3580,-2444.54 3310.75,-2402.21 3000.13,-2379.89 2782.24,-2368.51"/>
<polygon fill="black" stroke="black" points="2782.1,-2365 2771.93,-2367.98 2781.74,-2371.99 2782.1,-2365"/>
</g>
<!-- attention_layer_2_gpu_11&#45;&gt;attention_agg_layer_2 -->
<g id="edge618" class="edge">
<title>attention_layer_2_gpu_11&#45;&gt;attention_agg_layer_2</title>
<path fill="none" stroke="black" d="M3895.16,-2445.81C3892.42,-2445.36 3889.7,-2444.94 3887,-2444.54 3502.63,-2387.63 3052.73,-2367.9 2773.25,-2361.09"/>
<polygon fill="black" stroke="black" points="2773.05,-2357.59 2762.97,-2360.84 2772.89,-2364.58 2773.05,-2357.59"/>
</g>
<!-- out_proj_layer_2 -->
<g id="node125" class="node">
<title>out_proj_layer_2</title>
<polygon fill="#0080ff" stroke="black" points="3435,-2268.54 3151,-2268.54 3151,-2216.54 3435,-2216.54 3435,-2268.54"/>
<text text-anchor="middle" x="3293" y="-2256.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3293" y="-2245.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3293" y="-2234.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3293" y="-2223.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- attention_agg_layer_2&#45;&gt;out_proj_layer_2 -->
<g id="edge619" class="edge">
<title>attention_agg_layer_2&#45;&gt;out_proj_layer_2</title>
<path fill="none" stroke="black" d="M2718.5,-2325.19C2852.06,-2306.21 3020.9,-2282.21 3140.91,-2265.16"/>
<polygon fill="black" stroke="black" points="3141.5,-2268.61 3150.91,-2263.73 3140.52,-2261.68 3141.5,-2268.61"/>
</g>
<!-- out_proj_layer_2&#45;&gt;residual1_layer_2 -->
<g id="edge620" class="edge">
<title>out_proj_layer_2&#45;&gt;residual1_layer_2</title>
<path fill="none" stroke="black" d="M3435.5,-2224.04C3583.23,-2205.9 3816.03,-2177.31 3986.92,-2156.32"/>
<polygon fill="black" stroke="black" points="3987.56,-2159.77 3997.05,-2155.08 3986.7,-2152.82 3987.56,-2159.77"/>
</g>
<!-- ln2_layer_2 -->
<g id="node127" class="node">
<title>ln2_layer_2</title>
<polygon fill="#0080ff" stroke="black" points="2901,-2040.54 2617,-2040.54 2617,-1988.54 2901,-1988.54 2901,-2040.54"/>
<text text-anchor="middle" x="2759" y="-2028.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2759" y="-2017.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2759" y="-2006.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2759" y="-1995.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_layer_2&#45;&gt;ln2_layer_2 -->
<g id="edge622" class="edge">
<title>residual1_layer_2&#45;&gt;ln2_layer_2</title>
<path fill="none" stroke="black" d="M3940.2,-2107.03C3638.5,-2083.66 3155.73,-2046.27 2911.34,-2027.34"/>
<polygon fill="black" stroke="black" points="2911.56,-2023.84 2901.32,-2026.56 2911.02,-2030.82 2911.56,-2023.84"/>
</g>
<!-- residual2_layer_2 -->
<g id="node146" class="node">
<title>residual2_layer_2</title>
<polygon fill="#ffffcc" stroke="black" points="3616.82,-1584.54 3138.28,-1584.54 3015.18,-1480.54 3493.72,-1480.54 3616.82,-1584.54"/>
<text text-anchor="middle" x="3316" y="-1546.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="3316" y="-1535.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3316" y="-1524.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3316" y="-1513.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_layer_2&#45;&gt;residual2_layer_2 -->
<g id="edge673" class="edge">
<title>residual1_layer_2&#45;&gt;residual2_layer_2</title>
<path fill="none" stroke="black" d="M4412.18,-2101.38C4618.59,-2069.36 4905,-2006.1 4905,-1901.54 4905,-1901.54 4905,-1901.54 4905,-1785.54 4905,-1773.57 4904.41,-1767.94 4895,-1760.54 4694.9,-1603.13 3967.8,-1554.74 3573.87,-1539.96"/>
<polygon fill="black" stroke="black" points="3573.88,-1536.46 3563.76,-1539.58 3573.62,-1543.45 3573.88,-1536.46"/>
</g>
<!-- gate_layer_2 -->
<g id="node128" class="node">
<title>gate_layer_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2893.43,-1952.54 2434.6,-1952.54 2316.57,-1848.54 2775.4,-1848.54 2893.43,-1952.54"/>
<text text-anchor="middle" x="2605" y="-1914.54" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="2605" y="-1903.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2605" y="-1892.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="2605" y="-1881.54" font-family="Arial" font-size="10.00">GPU: all MoE GPUs (12&#45;15)</text>
</g>
<!-- ln2_layer_2&#45;&gt;gate_layer_2 -->
<g id="edge623" class="edge">
<title>ln2_layer_2&#45;&gt;gate_layer_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2724.44,-1988.4C2712.28,-1979.56 2698.07,-1969.23 2683.78,-1958.83"/>
<polygon fill="black" stroke="black" points="2685.52,-1955.77 2675.37,-1952.72 2681.4,-1961.43 2685.52,-1955.77"/>
</g>
<!-- expert_layer_2_expert_0_gpu_12 -->
<g id="node129" class="node">
<title>expert_layer_2_expert_0_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3074,-1812.54 2790,-1812.54 2790,-1760.54 3074,-1760.54 3074,-1812.54"/>
<text text-anchor="middle" x="2932" y="-1800.54" font-family="Arial" font-size="10.00">Expert0</text>
<text text-anchor="middle" x="2932" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2932" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2932" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_0_gpu_12 -->
<g id="edge625" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_0_gpu_12</title>
<path fill="none" stroke="black" d="M2871.19,-1988.41C2888.9,-1979.76 2905.22,-1968.15 2917,-1952.54 2945.07,-1915.34 2943.62,-1859.14 2938.77,-1822.89"/>
<polygon fill="black" stroke="black" points="2942.2,-1822.15 2937.26,-1812.78 2935.28,-1823.18 2942.2,-1822.15"/>
</g>
<!-- expert_layer_2_expert_1_gpu_12 -->
<g id="node130" class="node">
<title>expert_layer_2_expert_1_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3376,-1812.54 3092,-1812.54 3092,-1760.54 3376,-1760.54 3376,-1812.54"/>
<text text-anchor="middle" x="3234" y="-1800.54" font-family="Arial" font-size="10.00">Expert1</text>
<text text-anchor="middle" x="3234" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3234" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3234" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_1_gpu_12 -->
<g id="edge627" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_1_gpu_12</title>
<path fill="none" stroke="black" d="M2839.81,-1988.52C2869.82,-1978.41 2903.88,-1965.96 2934,-1952.54 3025.41,-1911.81 3126.34,-1853.29 3184.73,-1817.99"/>
<polygon fill="black" stroke="black" points="3186.65,-1820.93 3193.38,-1812.75 3183.02,-1814.94 3186.65,-1820.93"/>
</g>
<!-- expert_layer_2_expert_2_gpu_12 -->
<g id="node131" class="node">
<title>expert_layer_2_expert_2_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3678,-1812.54 3394,-1812.54 3394,-1760.54 3678,-1760.54 3678,-1812.54"/>
<text text-anchor="middle" x="3536" y="-1800.54" font-family="Arial" font-size="10.00">Expert2</text>
<text text-anchor="middle" x="3536" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3536" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3536" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_2_gpu_12 -->
<g id="edge629" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_2_gpu_12</title>
<path fill="none" stroke="black" d="M2885.49,-1988.52C2932.96,-1978.39 2987.21,-1965.93 3036,-1952.54 3187.22,-1911.05 3360.28,-1851.08 3458.01,-1816.02"/>
<polygon fill="black" stroke="black" points="3459.3,-1819.28 3467.52,-1812.61 3456.93,-1812.69 3459.3,-1819.28"/>
</g>
<!-- expert_layer_2_expert_3_gpu_12 -->
<g id="node132" class="node">
<title>expert_layer_2_expert_3_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3980,-1812.54 3696,-1812.54 3696,-1760.54 3980,-1760.54 3980,-1812.54"/>
<text text-anchor="middle" x="3838" y="-1800.54" font-family="Arial" font-size="10.00">Expert3</text>
<text text-anchor="middle" x="3838" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3838" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3838" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_3_gpu_12 -->
<g id="edge631" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_3_gpu_12</title>
<path fill="none" stroke="black" d="M2901.35,-1998.23C2988.57,-1987.79 3102.23,-1972.28 3202,-1952.54 3397.02,-1913.95 3621.27,-1851.43 3744.57,-1815.45"/>
<polygon fill="black" stroke="black" points="3745.75,-1818.75 3754.36,-1812.59 3743.78,-1812.03 3745.75,-1818.75"/>
</g>
<!-- expert_layer_2_expert_4_gpu_13 -->
<g id="node133" class="node">
<title>expert_layer_2_expert_4_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="4282,-1812.54 3998,-1812.54 3998,-1760.54 4282,-1760.54 4282,-1812.54"/>
<text text-anchor="middle" x="4140" y="-1800.54" font-family="Arial" font-size="10.00">Expert4</text>
<text text-anchor="middle" x="4140" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4140" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4140" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_4_gpu_13 -->
<g id="edge633" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_4_gpu_13</title>
<path fill="none" stroke="black" d="M2901.3,-2005.86C3035.43,-1997.34 3241.74,-1980.88 3419,-1952.54 3642.51,-1916.8 3900.05,-1852.05 4038.79,-1815.18"/>
<polygon fill="black" stroke="black" points="4039.81,-1818.53 4048.58,-1812.58 4038.01,-1811.77 4039.81,-1818.53"/>
</g>
<!-- expert_layer_2_expert_5_gpu_13 -->
<g id="node134" class="node">
<title>expert_layer_2_expert_5_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="4584,-1812.54 4300,-1812.54 4300,-1760.54 4584,-1760.54 4584,-1812.54"/>
<text text-anchor="middle" x="4442" y="-1800.54" font-family="Arial" font-size="10.00">Expert5</text>
<text text-anchor="middle" x="4442" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4442" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4442" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_5_gpu_13 -->
<g id="edge635" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_5_gpu_13</title>
<path fill="none" stroke="black" d="M2901.27,-2010.2C3080.23,-2004.57 3396.63,-1989.88 3665,-1952.54 3907.34,-1918.82 4186.99,-1852.59 4335.82,-1815.1"/>
<polygon fill="black" stroke="black" points="4337.03,-1818.41 4345.87,-1812.56 4335.32,-1811.62 4337.03,-1818.41"/>
</g>
<!-- expert_layer_2_expert_6_gpu_13 -->
<g id="node135" class="node">
<title>expert_layer_2_expert_6_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="4886,-1812.54 4602,-1812.54 4602,-1760.54 4886,-1760.54 4886,-1812.54"/>
<text text-anchor="middle" x="4744" y="-1800.54" font-family="Arial" font-size="10.00">Expert6</text>
<text text-anchor="middle" x="4744" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4744" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4744" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_6_gpu_13 -->
<g id="edge637" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_6_gpu_13</title>
<path fill="none" stroke="black" d="M2901.43,-2012.88C3122.32,-2010.33 3560.48,-1999.19 3929,-1952.54 4184.24,-1920.23 4479.07,-1852.94 4634.68,-1815.03"/>
<polygon fill="black" stroke="black" points="4635.84,-1818.35 4644.73,-1812.58 4634.18,-1811.55 4635.84,-1818.35"/>
</g>
<!-- expert_layer_2_expert_7_gpu_13 -->
<g id="node136" class="node">
<title>expert_layer_2_expert_7_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="356,-1812.54 72,-1812.54 72,-1760.54 356,-1760.54 356,-1812.54"/>
<text text-anchor="middle" x="214" y="-1800.54" font-family="Arial" font-size="10.00">Expert7</text>
<text text-anchor="middle" x="214" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="214" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="214" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_7_gpu_13 -->
<g id="edge639" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_7_gpu_13</title>
<path fill="none" stroke="black" d="M2616.84,-2012.1C2175.77,-2007.24 848.67,-1989.69 658,-1952.54 515.04,-1924.69 357.38,-1856.4 273.78,-1816.95"/>
<polygon fill="black" stroke="black" points="275.23,-1813.77 264.69,-1812.64 272.23,-1820.09 275.23,-1813.77"/>
</g>
<!-- expert_layer_2_expert_8_gpu_14 -->
<g id="node137" class="node">
<title>expert_layer_2_expert_8_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="658,-1812.54 374,-1812.54 374,-1760.54 658,-1760.54 658,-1812.54"/>
<text text-anchor="middle" x="516" y="-1800.54" font-family="Arial" font-size="10.00">Expert8</text>
<text text-anchor="middle" x="516" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="516" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="516" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_8_gpu_14 -->
<g id="edge641" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_8_gpu_14</title>
<path fill="none" stroke="black" d="M2616.95,-2014.05C2254.99,-2014.48 1304.78,-2009.92 995,-1952.54 841.73,-1924.15 671.1,-1855.99 580.61,-1816.73"/>
<polygon fill="black" stroke="black" points="581.87,-1813.46 571.31,-1812.67 579.08,-1819.88 581.87,-1813.46"/>
</g>
<!-- expert_layer_2_expert_9_gpu_14 -->
<g id="node138" class="node">
<title>expert_layer_2_expert_9_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="960,-1812.54 676,-1812.54 676,-1760.54 960,-1760.54 960,-1812.54"/>
<text text-anchor="middle" x="818" y="-1800.54" font-family="Arial" font-size="10.00">Expert9</text>
<text text-anchor="middle" x="818" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="818" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="818" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_9_gpu_14 -->
<g id="edge643" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_9_gpu_14</title>
<path fill="none" stroke="black" d="M2616.75,-2014.25C2291.55,-2014.83 1501.9,-2010.07 1243,-1952.54 1126.32,-1926.61 1106.67,-1891.14 995,-1848.54 965.53,-1837.3 932.98,-1825.81 903.9,-1815.89"/>
<polygon fill="black" stroke="black" points="904.78,-1812.49 894.19,-1812.58 902.53,-1819.12 904.78,-1812.49"/>
</g>
<!-- expert_layer_2_expert_10_gpu_14 -->
<g id="node139" class="node">
<title>expert_layer_2_expert_10_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="1262,-1812.54 978,-1812.54 978,-1760.54 1262,-1760.54 1262,-1812.54"/>
<text text-anchor="middle" x="1120" y="-1800.54" font-family="Arial" font-size="10.00">Expert10</text>
<text text-anchor="middle" x="1120" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1120" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1120" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_10_gpu_14 -->
<g id="edge645" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_10_gpu_14</title>
<path fill="none" stroke="black" d="M2616.86,-2012.14C2341.15,-2008.49 1743.15,-1995.71 1542,-1952.54 1406.56,-1923.47 1257.78,-1856.32 1178.09,-1817.24"/>
<polygon fill="black" stroke="black" points="1179.24,-1813.9 1168.72,-1812.61 1176.14,-1820.18 1179.24,-1813.9"/>
</g>
<!-- expert_layer_2_expert_11_gpu_14 -->
<g id="node140" class="node">
<title>expert_layer_2_expert_11_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="1564,-1812.54 1280,-1812.54 1280,-1760.54 1564,-1760.54 1564,-1812.54"/>
<text text-anchor="middle" x="1422" y="-1800.54" font-family="Arial" font-size="10.00">Expert11</text>
<text text-anchor="middle" x="1422" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1422" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1422" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_11_gpu_14 -->
<g id="edge647" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_11_gpu_14</title>
<path fill="none" stroke="black" d="M2616.72,-2009.62C2395.33,-2002.6 1978.78,-1985.43 1834,-1952.54 1702.05,-1922.56 1557.26,-1856.07 1479.33,-1817.26"/>
<polygon fill="black" stroke="black" points="1480.67,-1814.02 1470.16,-1812.67 1477.54,-1820.28 1480.67,-1814.02"/>
</g>
<!-- expert_layer_2_expert_12_gpu_15 -->
<g id="node141" class="node">
<title>expert_layer_2_expert_12_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="1866,-1812.54 1582,-1812.54 1582,-1760.54 1866,-1760.54 1866,-1812.54"/>
<text text-anchor="middle" x="1724" y="-1800.54" font-family="Arial" font-size="10.00">Expert12</text>
<text text-anchor="middle" x="1724" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1724" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1724" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_12_gpu_15 -->
<g id="edge649" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_12_gpu_15</title>
<path fill="none" stroke="black" d="M2616.98,-2013.25C2482.6,-2009.97 2276.23,-1997.08 2103,-1952.54 1981.53,-1921.31 1849.26,-1855.81 1777.56,-1817.4"/>
<polygon fill="black" stroke="black" points="1779.17,-1814.28 1768.7,-1812.62 1775.84,-1820.45 1779.17,-1814.28"/>
</g>
<!-- expert_layer_2_expert_13_gpu_15 -->
<g id="node142" class="node">
<title>expert_layer_2_expert_13_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2168,-1812.54 1884,-1812.54 1884,-1760.54 2168,-1760.54 2168,-1812.54"/>
<text text-anchor="middle" x="2026" y="-1800.54" font-family="Arial" font-size="10.00">Expert13</text>
<text text-anchor="middle" x="2026" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2026" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2026" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_13_gpu_15 -->
<g id="edge651" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_13_gpu_15</title>
<path fill="none" stroke="black" d="M2616.82,-2011.26C2520.87,-2005.89 2392.77,-1991.14 2286,-1952.54 2199.5,-1921.27 2111.83,-1857.51 2063.64,-1819.05"/>
<polygon fill="black" stroke="black" points="2065.66,-1816.18 2055.68,-1812.64 2061.27,-1821.64 2065.66,-1816.18"/>
</g>
<!-- expert_layer_2_expert_14_gpu_15 -->
<g id="node143" class="node">
<title>expert_layer_2_expert_14_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2470,-1812.54 2186,-1812.54 2186,-1760.54 2470,-1760.54 2470,-1812.54"/>
<text text-anchor="middle" x="2328" y="-1800.54" font-family="Arial" font-size="10.00">Expert14</text>
<text text-anchor="middle" x="2328" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2328" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2328" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_14_gpu_15 -->
<g id="edge653" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_14_gpu_15</title>
<path fill="none" stroke="black" d="M2616.79,-2003.61C2492.36,-1993.43 2328.34,-1975.82 2308,-1952.54 2276.8,-1916.84 2293.89,-1858.99 2310.14,-1822.13"/>
<polygon fill="black" stroke="black" points="2313.44,-1823.33 2314.44,-1812.79 2307.08,-1820.41 2313.44,-1823.33"/>
</g>
<!-- expert_layer_2_expert_15_gpu_15 -->
<g id="node144" class="node">
<title>expert_layer_2_expert_15_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2772,-1812.54 2488,-1812.54 2488,-1760.54 2772,-1760.54 2772,-1812.54"/>
<text text-anchor="middle" x="2630" y="-1800.54" font-family="Arial" font-size="10.00">Expert15</text>
<text text-anchor="middle" x="2630" y="-1789.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2630" y="-1778.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2630" y="-1767.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_2&#45;&gt;expert_layer_2_expert_15_gpu_15 -->
<g id="edge655" class="edge">
<title>ln2_layer_2&#45;&gt;expert_layer_2_expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M2859.64,-1988.51C2876.4,-1979.84 2891.66,-1968.19 2902,-1952.54 2927.48,-1913.97 2930.89,-1884.62 2902,-1848.54 2893.48,-1837.89 2839.72,-1824.79 2782.21,-1813.47"/>
<polygon fill="black" stroke="black" points="2782.69,-1809.99 2772.2,-1811.52 2781.35,-1816.87 2782.69,-1809.99"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_0_gpu_12 -->
<g id="edge624" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_0_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2754.15,-1848.46C2786.83,-1837.26 2820.29,-1825.8 2849.24,-1815.88"/>
<polygon fill="red" stroke="red" points="2850.56,-1819.13 2858.88,-1812.58 2848.29,-1812.51 2850.56,-1819.13"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_1_gpu_12 -->
<g id="edge626" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_1_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2795,-1865.71C2887.46,-1849.24 2997.03,-1829.73 3083.58,-1814.32"/>
<polygon fill="red" stroke="red" points="3084.25,-1817.76 3093.48,-1812.56 3083.02,-1810.87 3084.25,-1817.76"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_2_gpu_12 -->
<g id="edge628" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_2_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2811.06,-1879.56C2965.91,-1863.84 3183.45,-1840.22 3383.64,-1812.7"/>
<polygon fill="red" stroke="red" points="3384.34,-1816.14 3393.77,-1811.3 3383.38,-1809.2 3384.34,-1816.14"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_3_gpu_12 -->
<g id="edge630" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_3_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2819.81,-1887.59C3036.18,-1874.32 3379.66,-1849.88 3685.82,-1812.64"/>
<polygon fill="red" stroke="red" points="3686.28,-1816.11 3695.78,-1811.43 3685.43,-1809.17 3686.28,-1816.11"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_4_gpu_13 -->
<g id="edge632" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_4_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2825.53,-1892.57C3096.95,-1882.42 3571.93,-1859.54 3987.67,-1812.64"/>
<polygon fill="red" stroke="red" points="3988.25,-1816.1 3997.79,-1811.5 3987.46,-1809.14 3988.25,-1816.1"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_5_gpu_13 -->
<g id="edge634" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_5_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2829.27,-1895.98C3150.87,-1889.08 3761.59,-1869.25 4289.69,-1812.63"/>
<polygon fill="red" stroke="red" points="4290.23,-1816.09 4299.8,-1811.54 4289.48,-1809.13 4290.23,-1816.09"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_6_gpu_13 -->
<g id="edge636" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_6_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2832.24,-1898.47C3200.22,-1894.76 3949.23,-1879 4591.41,-1812.65"/>
<polygon fill="red" stroke="red" points="4592.22,-1816.09 4601.8,-1811.57 4591.49,-1809.12 4592.22,-1816.09"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_7_gpu_13 -->
<g id="edge638" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_7_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2374.98,-1900.09C1970.23,-1898.95 1104.4,-1887.11 366.24,-1812.61"/>
<polygon fill="red" stroke="red" points="366.5,-1809.12 356.2,-1811.59 365.79,-1816.08 366.5,-1809.12"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_8_gpu_14 -->
<g id="edge640" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_8_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2372.39,-1898.04C2009.86,-1893.7 1288.2,-1877.03 668.23,-1812.61"/>
<polygon fill="red" stroke="red" points="668.51,-1809.12 658.2,-1811.57 667.78,-1816.09 668.51,-1809.12"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_9_gpu_14 -->
<g id="edge642" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_9_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2369.31,-1895.21C2052.89,-1887.53 1473.29,-1866.96 970.21,-1812.62"/>
<polygon fill="red" stroke="red" points="970.52,-1809.13 960.2,-1811.53 969.77,-1816.09 970.52,-1809.13"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_10_gpu_14 -->
<g id="edge644" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_10_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2364.58,-1891.03C2099.27,-1879.98 1659.6,-1856.8 1272.21,-1812.63"/>
<polygon fill="red" stroke="red" points="1272.54,-1809.15 1262.21,-1811.49 1271.75,-1816.1 1272.54,-1809.15"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_11_gpu_14 -->
<g id="edge646" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_11_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2357.06,-1884.22C2150.21,-1870.13 1847.57,-1846.44 1574.33,-1812.67"/>
<polygon fill="red" stroke="red" points="1574.57,-1809.17 1564.22,-1811.41 1573.71,-1816.12 1574.57,-1809.17"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_12_gpu_15 -->
<g id="edge648" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_12_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2341.92,-1871.11C2205.74,-1855.67 2036.57,-1835.37 1876.29,-1812.7"/>
<polygon fill="red" stroke="red" points="1876.63,-1809.21 1866.24,-1811.27 1875.65,-1816.14 1876.63,-1809.21"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_13_gpu_15 -->
<g id="edge650" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_13_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2341.34,-1848.54C2280.63,-1836.79 2218.39,-1824.75 2165.42,-1814.51"/>
<polygon fill="red" stroke="red" points="2165.78,-1811.01 2155.29,-1812.55 2164.45,-1817.88 2165.78,-1811.01"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_14_gpu_15 -->
<g id="edge652" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_14_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2478.66,-1848.46C2451.45,-1837.45 2423.61,-1826.2 2399.38,-1816.4"/>
<polygon fill="red" stroke="red" points="2400.52,-1813.09 2389.94,-1812.58 2397.9,-1819.58 2400.52,-1813.09"/>
</g>
<!-- gate_layer_2&#45;&gt;expert_layer_2_expert_15_gpu_15 -->
<g id="edge654" class="edge">
<title>gate_layer_2&#45;&gt;expert_layer_2_expert_15_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2616.4,-1848.46C2618.36,-1839.69 2620.35,-1830.77 2622.18,-1822.55"/>
<polygon fill="red" stroke="red" points="2625.65,-1823.1 2624.41,-1812.58 2618.82,-1821.58 2625.65,-1823.1"/>
</g>
<!-- expert_agg_layer_2 -->
<g id="node145" class="node">
<title>expert_agg_layer_2</title>
<polygon fill="#ffcccc" stroke="black" points="2936.76,-1724.54 2448.77,-1724.54 2323.24,-1620.54 2811.23,-1620.54 2936.76,-1724.54"/>
<text text-anchor="middle" x="2630" y="-1686.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2630" y="-1675.54" font-family="Arial" font-size="10.00">Input: [16Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2630" y="-1664.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2630" y="-1653.54" font-family="Arial" font-size="10.00">GPU: all MoE GPUs</text>
</g>
<!-- expert_layer_2_expert_0_gpu_12&#45;&gt;expert_agg_layer_2 -->
<g id="edge656" class="edge">
<title>expert_layer_2_expert_0_gpu_12&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M2864.23,-1760.4C2838.3,-1750.79 2807.61,-1739.41 2777.14,-1728.11"/>
<polygon fill="black" stroke="black" points="2778.29,-1724.8 2767.69,-1724.6 2775.85,-1731.36 2778.29,-1724.8"/>
</g>
<!-- expert_layer_2_expert_1_gpu_12&#45;&gt;expert_agg_layer_2 -->
<g id="edge657" class="edge">
<title>expert_layer_2_expert_1_gpu_12&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M3098.83,-1760.47C3044.25,-1750.35 2979.08,-1738.27 2914.94,-1726.38"/>
<polygon fill="black" stroke="black" points="2915.54,-1722.93 2905.07,-1724.55 2914.27,-1729.81 2915.54,-1722.93"/>
</g>
<!-- expert_layer_2_expert_2_gpu_12&#45;&gt;expert_agg_layer_2 -->
<g id="edge658" class="edge">
<title>expert_layer_2_expert_2_gpu_12&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M3393.77,-1761.79C3390.82,-1761.36 3387.89,-1760.95 3385,-1760.54 3232.04,-1739.08 3061.09,-1719.05 2920.6,-1703.64"/>
<polygon fill="black" stroke="black" points="2920.85,-1700.14 2910.53,-1702.53 2920.09,-1707.1 2920.85,-1700.14"/>
</g>
<!-- expert_layer_2_expert_3_gpu_12&#45;&gt;expert_agg_layer_2 -->
<g id="edge659" class="edge">
<title>expert_layer_2_expert_3_gpu_12&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M3695.78,-1761.66C3692.83,-1761.27 3689.9,-1760.9 3687,-1760.54 3422.02,-1727.75 3118.08,-1704.2 2904.34,-1689.93"/>
<polygon fill="black" stroke="black" points="2904.44,-1686.43 2894.23,-1689.26 2903.98,-1693.41 2904.44,-1686.43"/>
</g>
<!-- expert_layer_2_expert_4_gpu_13&#45;&gt;expert_agg_layer_2 -->
<g id="edge660" class="edge">
<title>expert_layer_2_expert_4_gpu_13&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M3997.79,-1761.59C3994.84,-1761.22 3991.9,-1760.87 3989,-1760.54 3610.66,-1717.22 3170.42,-1693.97 2895.95,-1682.69"/>
<polygon fill="black" stroke="black" points="2895.98,-1679.18 2885.85,-1682.27 2895.7,-1686.18 2895.98,-1679.18"/>
</g>
<!-- expert_layer_2_expert_5_gpu_13&#45;&gt;expert_agg_layer_2 -->
<g id="edge661" class="edge">
<title>expert_layer_2_expert_5_gpu_13&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M4299.8,-1761.54C4296.84,-1761.19 4293.91,-1760.85 4291,-1760.54 3797.86,-1706.97 3218.63,-1686.12 2890.9,-1678.2"/>
<polygon fill="black" stroke="black" points="2890.87,-1674.7 2880.79,-1677.96 2890.7,-1681.69 2890.87,-1674.7"/>
</g>
<!-- expert_layer_2_expert_6_gpu_13&#45;&gt;expert_agg_layer_2 -->
<g id="edge662" class="edge">
<title>expert_layer_2_expert_6_gpu_13&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M4601.8,-1761.51C4598.84,-1761.17 4595.91,-1760.84 4593,-1760.54 3983.6,-1696.82 3263.02,-1679.69 2887.25,-1675.13"/>
<polygon fill="black" stroke="black" points="2887.1,-1671.63 2877.06,-1675.01 2887.02,-1678.63 2887.1,-1671.63"/>
</g>
<!-- expert_layer_2_expert_7_gpu_13&#45;&gt;expert_agg_layer_2 -->
<g id="edge663" class="edge">
<title>expert_layer_2_expert_7_gpu_13&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M356.2,-1761.49C359.16,-1761.15 362.09,-1760.83 365,-1760.54 1092.19,-1686.67 1956.5,-1674.19 2376.15,-1672.91"/>
<polygon fill="black" stroke="black" points="2376.3,-1676.41 2386.29,-1672.88 2376.28,-1669.41 2376.3,-1676.41"/>
</g>
<!-- expert_layer_2_expert_8_gpu_14&#45;&gt;expert_agg_layer_2 -->
<g id="edge664" class="edge">
<title>expert_layer_2_expert_8_gpu_14&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M658.2,-1761.51C661.16,-1761.17 664.09,-1760.84 667,-1760.54 1279.55,-1696.49 2004.44,-1679.51 2378.55,-1675.07"/>
<polygon fill="black" stroke="black" points="2378.73,-1678.56 2388.69,-1674.95 2378.65,-1671.56 2378.73,-1678.56"/>
</g>
<!-- expert_layer_2_expert_9_gpu_14&#45;&gt;expert_agg_layer_2 -->
<g id="edge665" class="edge">
<title>expert_layer_2_expert_9_gpu_14&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M960.2,-1761.54C963.16,-1761.19 966.09,-1760.85 969,-1760.54 1468.72,-1706.26 2056.82,-1685.57 2382.07,-1677.89"/>
<polygon fill="black" stroke="black" points="2382.18,-1681.39 2392.09,-1677.65 2382.01,-1674.39 2382.18,-1681.39"/>
</g>
<!-- expert_layer_2_expert_10_gpu_14&#45;&gt;expert_agg_layer_2 -->
<g id="edge666" class="edge">
<title>expert_layer_2_expert_10_gpu_14&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M1262.21,-1761.59C1265.16,-1761.22 1268.1,-1760.87 1271,-1760.54 1659.78,-1716.02 2113.93,-1692.7 2386.39,-1681.78"/>
<polygon fill="black" stroke="black" points="2386.56,-1685.28 2396.41,-1681.38 2386.28,-1678.28 2386.56,-1685.28"/>
</g>
<!-- expert_layer_2_expert_11_gpu_14&#45;&gt;expert_agg_layer_2 -->
<g id="edge667" class="edge">
<title>expert_layer_2_expert_11_gpu_14&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M1564.22,-1761.66C1567.17,-1761.27 1570.1,-1760.9 1573,-1760.54 1853.84,-1725.79 2178.43,-1701.41 2393.02,-1687.47"/>
<polygon fill="black" stroke="black" points="2393.4,-1690.95 2403.16,-1686.81 2392.95,-1683.97 2393.4,-1690.95"/>
</g>
<!-- expert_layer_2_expert_12_gpu_15&#45;&gt;expert_agg_layer_2 -->
<g id="edge668" class="edge">
<title>expert_layer_2_expert_12_gpu_15&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M1866.23,-1761.79C1869.18,-1761.36 1872.11,-1760.95 1875,-1760.54 2052.06,-1735.7 2253.23,-1712.78 2403.36,-1696.7"/>
<polygon fill="black" stroke="black" points="2404.06,-1700.15 2413.63,-1695.61 2403.31,-1693.19 2404.06,-1700.15"/>
</g>
<!-- expert_layer_2_expert_13_gpu_15&#45;&gt;expert_agg_layer_2 -->
<g id="edge669" class="edge">
<title>expert_layer_2_expert_13_gpu_15&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M2161.17,-1760.47C2237.77,-1746.27 2335.23,-1728.2 2421.42,-1712.22"/>
<polygon fill="black" stroke="black" points="2422.14,-1715.64 2431.34,-1710.38 2420.87,-1708.76 2422.14,-1715.64"/>
</g>
<!-- expert_layer_2_expert_14_gpu_15&#45;&gt;expert_agg_layer_2 -->
<g id="edge670" class="edge">
<title>expert_layer_2_expert_14_gpu_15&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M2395.77,-1760.4C2421.7,-1750.79 2452.39,-1739.41 2482.86,-1728.11"/>
<polygon fill="black" stroke="black" points="2484.15,-1731.36 2492.31,-1724.6 2481.71,-1724.8 2484.15,-1731.36"/>
</g>
<!-- expert_layer_2_expert_15_gpu_15&#45;&gt;expert_agg_layer_2 -->
<g id="edge671" class="edge">
<title>expert_layer_2_expert_15_gpu_15&#45;&gt;expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M2630,-1760.4C2630,-1752.72 2630,-1743.91 2630,-1734.91"/>
<polygon fill="black" stroke="black" points="2633.5,-1734.72 2630,-1724.72 2626.5,-1734.72 2633.5,-1734.72"/>
</g>
<!-- expert_agg_layer_2&#45;&gt;residual2_layer_2 -->
<g id="edge672" class="edge">
<title>expert_agg_layer_2&#45;&gt;residual2_layer_2</title>
<path fill="none" stroke="black" d="M2825.66,-1632.18C2915.84,-1614.04 3022.79,-1592.52 3113.76,-1574.22"/>
<polygon fill="black" stroke="black" points="3114.52,-1577.64 3123.63,-1572.24 3113.14,-1570.78 3114.52,-1577.64"/>
</g>
<!-- ln1_layer_3 -->
<g id="node147" class="node">
<title>ln1_layer_3</title>
<polygon fill="#0080ff" stroke="black" points="2843,-1433.54 2559,-1433.54 2559,-1381.54 2843,-1381.54 2843,-1433.54"/>
<text text-anchor="middle" x="2701" y="-1421.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2701" y="-1410.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2701" y="-1399.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2701" y="-1388.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_layer_2&#45;&gt;ln1_layer_3 -->
<g id="edge674" class="edge">
<title>residual2_layer_2&#45;&gt;ln1_layer_3</title>
<path fill="none" stroke="black" d="M3060.97,-1480.53C2983.86,-1465.11 2902.21,-1448.78 2836.2,-1435.58"/>
<polygon fill="black" stroke="black" points="2836.65,-1432.1 2826.16,-1433.57 2835.28,-1438.96 2836.65,-1432.1"/>
</g>
<!-- residual1_layer_3 -->
<g id="node174" class="node">
<title>residual1_layer_3</title>
<polygon fill="#ffffcc" stroke="black" points="3844.82,-897.54 3366.28,-897.54 3243.18,-793.54 3721.72,-793.54 3844.82,-897.54"/>
<text text-anchor="middle" x="3544" y="-859.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="3544" y="-848.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3544" y="-837.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3544" y="-826.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_layer_2&#45;&gt;residual1_layer_3 -->
<g id="edge845" class="edge">
<title>residual2_layer_2&#45;&gt;residual1_layer_3</title>
<path fill="none" stroke="black" d="M3537.83,-1517.58C3820.5,-1495.91 4289.15,-1445.81 4428,-1345.54 4442.67,-1334.95 4447,-1327.63 4447,-1309.54 4447,-1309.54 4447,-1309.54 4447,-1072.54 4447,-940.36 4078.29,-884.82 3812.07,-861.95"/>
<polygon fill="black" stroke="black" points="3812.12,-858.45 3801.86,-861.09 3811.53,-865.42 3812.12,-858.45"/>
</g>
<!-- qkv_layer_3_gpu_0 -->
<g id="node148" class="node">
<title>qkv_layer_3_gpu_0</title>
<polygon fill="#0080ff" stroke="black" points="965,-1345.54 669,-1345.54 669,-1271.54 965,-1271.54 965,-1345.54"/>
<text text-anchor="middle" x="817" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="817" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="817" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="817" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="817" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="817" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_0 -->
<g id="edge675" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_0</title>
<path fill="none" stroke="black" d="M2558.99,-1405C2206.75,-1400.63 1298.69,-1385.83 975.52,-1345.63"/>
<polygon fill="black" stroke="black" points="975.56,-1342.11 965.2,-1344.31 974.67,-1349.05 975.56,-1342.11"/>
</g>
<!-- qkv_layer_3_gpu_1 -->
<g id="node149" class="node">
<title>qkv_layer_3_gpu_1</title>
<polygon fill="#0f8aff" stroke="black" points="1279,-1345.54 983,-1345.54 983,-1271.54 1279,-1271.54 1279,-1345.54"/>
<text text-anchor="middle" x="1131" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1131" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1131" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1131" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1131" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1131" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_1 -->
<g id="edge688" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_1</title>
<path fill="none" stroke="black" d="M2558.92,-1403.7C2255.06,-1397.09 1549.27,-1378.77 1289.38,-1345.61"/>
<polygon fill="black" stroke="black" points="1289.57,-1342.11 1279.2,-1344.28 1288.66,-1349.05 1289.57,-1342.11"/>
</g>
<!-- qkv_layer_3_gpu_2 -->
<g id="node150" class="node">
<title>qkv_layer_3_gpu_2</title>
<polygon fill="#1e94ff" stroke="black" points="1593,-1345.54 1297,-1345.54 1297,-1271.54 1593,-1271.54 1593,-1345.54"/>
<text text-anchor="middle" x="1445" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1445" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1445" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1445" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1445" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1445" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_2 -->
<g id="edge701" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_2</title>
<path fill="none" stroke="black" d="M2558.86,-1406.34C2350.67,-1404.33 1950.76,-1393.95 1603.22,-1345.63"/>
<polygon fill="black" stroke="black" points="1603.6,-1342.15 1593.21,-1344.23 1602.62,-1349.08 1603.6,-1342.15"/>
</g>
<!-- qkv_layer_3_gpu_3 -->
<g id="node151" class="node">
<title>qkv_layer_3_gpu_3</title>
<polygon fill="#2d9eff" stroke="black" points="1907,-1345.54 1611,-1345.54 1611,-1271.54 1907,-1271.54 1907,-1345.54"/>
<text text-anchor="middle" x="1759" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1759" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1759" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1759" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1759" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1759" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_3 -->
<g id="edge714" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_3</title>
<path fill="none" stroke="black" d="M2558.82,-1401.81C2403.33,-1395.2 2146.78,-1380.05 1917.43,-1345.69"/>
<polygon fill="black" stroke="black" points="1917.63,-1342.18 1907.22,-1344.14 1916.58,-1349.1 1917.63,-1342.18"/>
</g>
<!-- qkv_layer_3_gpu_4 -->
<g id="node152" class="node">
<title>qkv_layer_3_gpu_4</title>
<polygon fill="#3ca8ff" stroke="black" points="2221,-1345.54 1925,-1345.54 1925,-1271.54 2221,-1271.54 2221,-1345.54"/>
<text text-anchor="middle" x="2073" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2073" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2073" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2073" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2073" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2073" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_4 -->
<g id="edge727" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_4</title>
<path fill="none" stroke="black" d="M2558.76,-1391.74C2467.68,-1381.4 2346.84,-1366.08 2231.34,-1345.73"/>
<polygon fill="black" stroke="black" points="2231.71,-1342.24 2221.26,-1343.94 2230.49,-1349.13 2231.71,-1342.24"/>
</g>
<!-- qkv_layer_3_gpu_5 -->
<g id="node153" class="node">
<title>qkv_layer_3_gpu_5</title>
<polygon fill="#4bb2ff" stroke="black" points="2535,-1345.54 2239,-1345.54 2239,-1271.54 2535,-1271.54 2535,-1345.54"/>
<text text-anchor="middle" x="2387" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2387" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2387" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2387" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2387" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2387" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_5 -->
<g id="edge740" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_5</title>
<path fill="none" stroke="black" d="M2619.73,-1381.43C2587.28,-1371.41 2549.17,-1359.64 2513.28,-1348.55"/>
<polygon fill="black" stroke="black" points="2514.3,-1345.2 2503.72,-1345.59 2512.24,-1351.89 2514.3,-1345.2"/>
</g>
<!-- qkv_layer_3_gpu_6 -->
<g id="node154" class="node">
<title>qkv_layer_3_gpu_6</title>
<polygon fill="#5abcff" stroke="black" points="2849,-1345.54 2553,-1345.54 2553,-1271.54 2849,-1271.54 2849,-1345.54"/>
<text text-anchor="middle" x="2701" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2701" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2701" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2701" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2701" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2701" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_6 -->
<g id="edge753" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_6</title>
<path fill="none" stroke="black" d="M2701,-1381.31C2701,-1373.48 2701,-1364.59 2701,-1355.8"/>
<polygon fill="black" stroke="black" points="2704.5,-1355.6 2701,-1345.6 2697.5,-1355.6 2704.5,-1355.6"/>
</g>
<!-- qkv_layer_3_gpu_7 -->
<g id="node155" class="node">
<title>qkv_layer_3_gpu_7</title>
<polygon fill="#69c6ff" stroke="black" points="3163,-1345.54 2867,-1345.54 2867,-1271.54 3163,-1271.54 3163,-1345.54"/>
<text text-anchor="middle" x="3015" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3015" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3015" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3015" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3015" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3015" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_7 -->
<g id="edge766" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_7</title>
<path fill="none" stroke="black" d="M2782.27,-1381.43C2814.72,-1371.41 2852.83,-1359.64 2888.72,-1348.55"/>
<polygon fill="black" stroke="black" points="2889.76,-1351.89 2898.28,-1345.59 2887.7,-1345.2 2889.76,-1351.89"/>
</g>
<!-- qkv_layer_3_gpu_8 -->
<g id="node156" class="node">
<title>qkv_layer_3_gpu_8</title>
<polygon fill="#78d0ff" stroke="black" points="3477,-1345.54 3181,-1345.54 3181,-1271.54 3477,-1271.54 3477,-1345.54"/>
<text text-anchor="middle" x="3329" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3329" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3329" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3329" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3329" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3329" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_8 -->
<g id="edge779" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_8</title>
<path fill="none" stroke="black" d="M2843.24,-1391.74C2934.32,-1381.4 3055.16,-1366.08 3170.66,-1345.73"/>
<polygon fill="black" stroke="black" points="3171.51,-1349.13 3180.74,-1343.94 3170.29,-1342.24 3171.51,-1349.13"/>
</g>
<!-- qkv_layer_3_gpu_9 -->
<g id="node157" class="node">
<title>qkv_layer_3_gpu_9</title>
<polygon fill="#87daff" stroke="black" points="3791,-1345.54 3495,-1345.54 3495,-1271.54 3791,-1271.54 3791,-1345.54"/>
<text text-anchor="middle" x="3643" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3643" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3643" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3643" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3643" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3643" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_9 -->
<g id="edge792" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_9</title>
<path fill="none" stroke="black" d="M2843.18,-1401.81C2998.67,-1395.2 3255.22,-1380.05 3484.57,-1345.69"/>
<polygon fill="black" stroke="black" points="3485.42,-1349.1 3494.78,-1344.14 3484.37,-1342.18 3485.42,-1349.1"/>
</g>
<!-- qkv_layer_3_gpu_10 -->
<g id="node158" class="node">
<title>qkv_layer_3_gpu_10</title>
<polygon fill="#96e4ff" stroke="black" points="4105,-1345.54 3809,-1345.54 3809,-1271.54 4105,-1271.54 4105,-1345.54"/>
<text text-anchor="middle" x="3957" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3957" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3957" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3957" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3957" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3957" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_10 -->
<g id="edge805" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_10</title>
<path fill="none" stroke="black" d="M2843.14,-1406.34C3051.33,-1404.33 3451.24,-1393.95 3798.78,-1345.63"/>
<polygon fill="black" stroke="black" points="3799.38,-1349.08 3808.79,-1344.23 3798.4,-1342.15 3799.38,-1349.08"/>
</g>
<!-- qkv_layer_3_gpu_11 -->
<g id="node159" class="node">
<title>qkv_layer_3_gpu_11</title>
<polygon fill="#a5eeff" stroke="black" points="4419,-1345.54 4123,-1345.54 4123,-1271.54 4419,-1271.54 4419,-1345.54"/>
<text text-anchor="middle" x="4271" y="-1333.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4271" y="-1322.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4271" y="-1311.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4271" y="-1300.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4271" y="-1289.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4271" y="-1278.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- ln1_layer_3&#45;&gt;qkv_layer_3_gpu_11 -->
<g id="edge818" class="edge">
<title>ln1_layer_3&#45;&gt;qkv_layer_3_gpu_11</title>
<path fill="none" stroke="black" d="M2843.08,-1403.7C3146.94,-1397.09 3852.73,-1378.77 4112.62,-1345.61"/>
<polygon fill="black" stroke="black" points="4113.34,-1349.05 4122.8,-1344.28 4112.43,-1342.11 4113.34,-1349.05"/>
</g>
<!-- attention_layer_3_gpu_0 -->
<g id="node160" class="node">
<title>attention_layer_3_gpu_0</title>
<polygon fill="#0080ff" stroke="black" points="1003.5,-1235.54 714.5,-1235.54 714.5,-1161.54 1003.5,-1161.54 1003.5,-1235.54"/>
<text text-anchor="middle" x="859" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="859" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="859" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="859" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="859" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="859" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge676" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="black" d="M831.1,-1271.28C834.32,-1262.99 837.79,-1254.09 841.14,-1245.46"/>
<polygon fill="black" stroke="black" points="844.5,-1246.48 844.86,-1235.89 837.98,-1243.94 844.5,-1246.48"/>
</g>
<!-- attention_layer_3_gpu_1 -->
<g id="node161" class="node">
<title>attention_layer_3_gpu_1</title>
<polygon fill="#0f8aff" stroke="black" points="1310.5,-1235.54 1021.5,-1235.54 1021.5,-1161.54 1310.5,-1161.54 1310.5,-1235.54"/>
<text text-anchor="middle" x="1166" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1166" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1166" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1166" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1166" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1166" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge690" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M933.7,-1271.43C967.75,-1260.89 1005.11,-1249.33 1039.73,-1238.61"/>
<polygon fill="blue" stroke="blue" points="1040.89,-1241.92 1049.41,-1235.62 1038.83,-1235.23 1040.89,-1241.92"/>
</g>
<!-- attention_layer_3_gpu_2 -->
<g id="node162" class="node">
<title>attention_layer_3_gpu_2</title>
<polygon fill="#1e94ff" stroke="black" points="1617.5,-1235.54 1328.5,-1235.54 1328.5,-1161.54 1617.5,-1161.54 1617.5,-1235.54"/>
<text text-anchor="middle" x="1473" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1473" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1473" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1473" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1473" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1473" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge703" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M965.24,-1273.04C968.18,-1272.52 971.1,-1272.02 974,-1271.54 1123.24,-1246.76 1165.74,-1260.67 1317.95,-1235.81"/>
<polygon fill="blue" stroke="blue" points="1318.85,-1239.21 1328.14,-1234.12 1317.7,-1232.31 1318.85,-1239.21"/>
</g>
<!-- attention_layer_3_gpu_3 -->
<g id="node163" class="node">
<title>attention_layer_3_gpu_3</title>
<polygon fill="#2d9eff" stroke="black" points="1924.5,-1235.54 1635.5,-1235.54 1635.5,-1161.54 1924.5,-1161.54 1924.5,-1235.54"/>
<text text-anchor="middle" x="1780" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1780" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1780" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1780" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1780" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="1780" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge716" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M965.21,-1272.85C968.16,-1272.39 971.09,-1271.95 974,-1271.54 1258.44,-1231.39 1337.46,-1275.92 1624.85,-1235.77"/>
<polygon fill="blue" stroke="blue" points="1625.76,-1239.17 1635.16,-1234.3 1624.77,-1232.24 1625.76,-1239.17"/>
</g>
<!-- attention_layer_3_gpu_4 -->
<g id="node164" class="node">
<title>attention_layer_3_gpu_4</title>
<polygon fill="#3ca8ff" stroke="black" points="2231.5,-1235.54 1942.5,-1235.54 1942.5,-1161.54 2231.5,-1161.54 2231.5,-1235.54"/>
<text text-anchor="middle" x="2087" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2087" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2087" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2087" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2087" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2087" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge729" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M965.2,-1272.78C968.15,-1272.34 971.09,-1271.92 974,-1271.54 1393.98,-1216.02 1509.08,-1291.51 1932.12,-1235.71"/>
<polygon fill="blue" stroke="blue" points="1932.72,-1239.16 1942.17,-1234.37 1931.8,-1232.22 1932.72,-1239.16"/>
</g>
<!-- attention_layer_3_gpu_5 -->
<g id="node165" class="node">
<title>attention_layer_3_gpu_5</title>
<polygon fill="#4bb2ff" stroke="black" points="2538.5,-1235.54 2249.5,-1235.54 2249.5,-1161.54 2538.5,-1161.54 2538.5,-1235.54"/>
<text text-anchor="middle" x="2394" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2394" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2394" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2394" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2394" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2394" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge742" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M965.19,-1272.74C968.15,-1272.31 971.09,-1271.91 974,-1271.54 1529.53,-1200.66 1680.63,-1307.16 2239.26,-1235.68"/>
<polygon fill="blue" stroke="blue" points="2239.71,-1239.15 2249.18,-1234.4 2238.81,-1232.21 2239.71,-1239.15"/>
</g>
<!-- attention_layer_3_gpu_6 -->
<g id="node166" class="node">
<title>attention_layer_3_gpu_6</title>
<polygon fill="#5abcff" stroke="black" points="2845.5,-1235.54 2556.5,-1235.54 2556.5,-1161.54 2845.5,-1161.54 2845.5,-1235.54"/>
<text text-anchor="middle" x="2701" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2701" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2701" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2701" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2701" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="2701" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge755" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M965.19,-1272.72C968.15,-1272.3 971.09,-1271.9 974,-1271.54 1665.05,-1185.31 1852.12,-1322.83 2546.19,-1235.69"/>
<polygon fill="blue" stroke="blue" points="2546.7,-1239.15 2556.18,-1234.42 2545.82,-1232.21 2546.7,-1239.15"/>
</g>
<!-- attention_layer_3_gpu_7 -->
<g id="node167" class="node">
<title>attention_layer_3_gpu_7</title>
<polygon fill="#69c6ff" stroke="black" points="3152.5,-1235.54 2863.5,-1235.54 2863.5,-1161.54 3152.5,-1161.54 3152.5,-1235.54"/>
<text text-anchor="middle" x="3008" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3008" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3008" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3008" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3008" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=3, d_k=128]</text>
<text text-anchor="middle" x="3008" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge768" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M965.19,-1272.7C968.15,-1272.29 971.09,-1271.9 974,-1271.54 1800.57,-1169.97 2023.59,-1338.51 2853.09,-1235.7"/>
<polygon fill="blue" stroke="blue" points="2853.69,-1239.15 2863.18,-1234.44 2852.83,-1232.2 2853.69,-1239.15"/>
</g>
<!-- attention_layer_3_gpu_8 -->
<g id="node168" class="node">
<title>attention_layer_3_gpu_8</title>
<polygon fill="#78d0ff" stroke="black" points="3459.5,-1235.54 3170.5,-1235.54 3170.5,-1161.54 3459.5,-1161.54 3459.5,-1235.54"/>
<text text-anchor="middle" x="3315" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3315" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3315" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3315" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3315" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3315" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge781" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M965.19,-1272.69C968.15,-1272.28 971.09,-1271.89 974,-1271.54 1453.44,-1213.28 2662.75,-1294.45 3160.02,-1235.68"/>
<polygon fill="blue" stroke="blue" points="3160.68,-1239.12 3170.18,-1234.45 3159.83,-1232.18 3160.68,-1239.12"/>
</g>
<!-- attention_layer_3_gpu_9 -->
<g id="node169" class="node">
<title>attention_layer_3_gpu_9</title>
<polygon fill="#87daff" stroke="black" points="3766.5,-1235.54 3477.5,-1235.54 3477.5,-1161.54 3766.5,-1161.54 3766.5,-1235.54"/>
<text text-anchor="middle" x="3622" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3622" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3622" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3622" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3622" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3622" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge794" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M965.19,-1272.68C968.14,-1272.27 971.08,-1271.89 974,-1271.54 1521.16,-1205.61 2901.68,-1302.25 3466.86,-1235.7"/>
<polygon fill="blue" stroke="blue" points="3467.68,-1239.13 3477.18,-1234.45 3466.84,-1232.18 3467.68,-1239.13"/>
</g>
<!-- attention_layer_3_gpu_10 -->
<g id="node170" class="node">
<title>attention_layer_3_gpu_10</title>
<polygon fill="#96e4ff" stroke="black" points="4073.5,-1235.54 3784.5,-1235.54 3784.5,-1161.54 4073.5,-1161.54 4073.5,-1235.54"/>
<text text-anchor="middle" x="3929" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3929" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3929" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3929" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3929" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="3929" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge807" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M965.19,-1272.68C968.14,-1272.27 971.08,-1271.89 974,-1271.54 1588.98,-1197.93 3141.12,-1310.09 3774.01,-1235.68"/>
<polygon fill="blue" stroke="blue" points="3774.67,-1239.13 3784.19,-1234.46 3773.84,-1232.18 3774.67,-1239.13"/>
</g>
<!-- attention_layer_3_gpu_11 -->
<g id="node171" class="node">
<title>attention_layer_3_gpu_11</title>
<polygon fill="#a5eeff" stroke="black" points="4380.5,-1235.54 4091.5,-1235.54 4091.5,-1161.54 4380.5,-1161.54 4380.5,-1235.54"/>
<text text-anchor="middle" x="4236" y="-1223.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4236" y="-1212.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4236" y="-1201.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4236" y="-1190.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4236" y="-1179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=2, d_k=128]</text>
<text text-anchor="middle" x="4236" y="-1168.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge820" class="edge">
<title>qkv_layer_3_gpu_0&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M965.19,-1272.67C968.14,-1272.27 971.08,-1271.89 974,-1271.54 1656.82,-1190.25 3380.63,-1317.94 4081.2,-1235.66"/>
<polygon fill="blue" stroke="blue" points="4081.67,-1239.13 4091.19,-1234.46 4080.84,-1232.18 4081.67,-1239.13"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge677" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1040.05,-1271.43C1014.19,-1261.16 985.88,-1249.92 959.49,-1239.44"/>
<polygon fill="blue" stroke="blue" points="960.45,-1236.06 949.86,-1235.62 957.87,-1242.56 960.45,-1236.06"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge689" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="black" d="M1142.75,-1271.28C1145.44,-1262.99 1148.32,-1254.09 1151.12,-1245.46"/>
<polygon fill="black" stroke="black" points="1154.47,-1246.48 1154.22,-1235.89 1147.81,-1244.32 1154.47,-1246.48"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge704" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1245.36,-1271.43C1278.58,-1260.93 1315.03,-1249.43 1348.83,-1238.75"/>
<polygon fill="blue" stroke="blue" points="1350.27,-1241.97 1358.75,-1235.62 1348.16,-1235.29 1350.27,-1241.97"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge717" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1279.24,-1273.05C1282.18,-1272.53 1285.1,-1272.02 1288,-1271.54 1434.23,-1247.1 1475.85,-1260.34 1625.14,-1235.78"/>
<polygon fill="blue" stroke="blue" points="1625.85,-1239.21 1635.13,-1234.11 1624.69,-1232.31 1625.85,-1239.21"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge730" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1279.21,-1272.85C1282.16,-1272.39 1285.09,-1271.95 1288,-1271.54 1569.38,-1231.73 1647.57,-1275.58 1931.96,-1235.75"/>
<polygon fill="blue" stroke="blue" points="1932.76,-1239.17 1942.16,-1234.3 1931.77,-1232.24 1932.76,-1239.17"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge743" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1279.2,-1272.78C1282.15,-1272.34 1285.09,-1271.92 1288,-1271.54 1704.91,-1216.36 1819.19,-1291.16 2239.19,-1235.7"/>
<polygon fill="blue" stroke="blue" points="2239.73,-1239.16 2249.17,-1234.37 2238.8,-1232.22 2239.73,-1239.16"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge756" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1279.19,-1272.74C1282.15,-1272.31 1285.09,-1271.91 1288,-1271.54 1840.33,-1201.02 1990.66,-1306.76 2545.9,-1235.73"/>
<polygon fill="blue" stroke="blue" points="2546.71,-1239.15 2556.18,-1234.4 2545.81,-1232.21 2546.71,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge769" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1279.19,-1272.72C1282.15,-1272.3 1285.09,-1271.9 1288,-1271.54 1975.97,-1185.66 2162.21,-1322.48 2853.23,-1235.68"/>
<polygon fill="blue" stroke="blue" points="2853.7,-1239.15 2863.18,-1234.42 2852.82,-1232.21 2853.7,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge782" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1279.19,-1272.7C1282.15,-1272.29 1285.09,-1271.9 1288,-1271.54 2111.49,-1170.32 2333.69,-1338.16 3160.12,-1235.69"/>
<polygon fill="blue" stroke="blue" points="3160.69,-1239.15 3170.18,-1234.44 3159.83,-1232.2 3160.69,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge795" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1279.19,-1272.69C1282.15,-1272.28 1285.09,-1271.89 1288,-1271.54 1765.9,-1213.45 2971.35,-1294.28 3467.05,-1235.68"/>
<polygon fill="blue" stroke="blue" points="3467.68,-1239.12 3477.18,-1234.45 3466.83,-1232.18 3467.68,-1239.12"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge808" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1279.19,-1272.69C1282.14,-1272.27 1285.08,-1271.89 1288,-1271.54 1833.62,-1205.78 3210.28,-1302.07 3773.89,-1235.69"/>
<polygon fill="blue" stroke="blue" points="3774.68,-1239.13 3784.18,-1234.45 3773.84,-1232.18 3774.68,-1239.13"/>
</g>
<!-- qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge821" class="edge">
<title>qkv_layer_3_gpu_1&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1279.19,-1272.68C1282.14,-1272.27 1285.08,-1271.89 1288,-1271.54 1901.45,-1198.1 3449.7,-1309.91 4081.04,-1235.68"/>
<polygon fill="blue" stroke="blue" points="4081.67,-1239.13 4091.19,-1234.46 4080.84,-1232.18 4081.67,-1239.13"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge678" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1296.74,-1273.15C1293.81,-1272.6 1290.89,-1272.06 1288,-1271.54 1169.88,-1250.31 1136.05,-1257.2 1013.73,-1235.6"/>
<polygon fill="blue" stroke="blue" points="1014.06,-1232.1 1003.59,-1233.78 1012.82,-1238.99 1014.06,-1232.1"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge691" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1351.71,-1271.43C1325.07,-1261.11 1295.89,-1249.82 1268.72,-1239.3"/>
<polygon fill="blue" stroke="blue" points="1269.79,-1235.96 1259.2,-1235.62 1267.27,-1242.49 1269.79,-1235.96"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge702" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="black" d="M1454.4,-1271.28C1456.53,-1263.08 1458.81,-1254.28 1461.02,-1245.74"/>
<polygon fill="black" stroke="black" points="1464.45,-1246.45 1463.58,-1235.89 1457.68,-1244.69 1464.45,-1246.45"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge718" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1557.02,-1271.43C1589.56,-1260.93 1625.26,-1249.43 1658.37,-1238.75"/>
<polygon fill="blue" stroke="blue" points="1659.65,-1242.02 1668.09,-1235.62 1657.5,-1235.35 1659.65,-1242.02"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge731" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1593.24,-1273.06C1596.18,-1272.53 1599.1,-1272.03 1602,-1271.54 1745.08,-1247.46 1785.89,-1259.99 1931.9,-1235.83"/>
<polygon fill="blue" stroke="blue" points="1932.85,-1239.22 1942.13,-1234.1 1931.69,-1232.31 1932.85,-1239.22"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge744" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1593.21,-1272.85C1596.16,-1272.39 1599.09,-1271.95 1602,-1271.54 1880.33,-1232.08 1957.67,-1275.23 2239.07,-1235.74"/>
<polygon fill="blue" stroke="blue" points="2239.76,-1239.17 2249.16,-1234.3 2238.77,-1232.24 2239.76,-1239.17"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge757" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1593.2,-1272.78C1596.15,-1272.34 1599.09,-1271.92 1602,-1271.54 2015.74,-1216.72 2129.23,-1290.77 2545.96,-1235.73"/>
<polygon fill="blue" stroke="blue" points="2546.73,-1239.16 2556.17,-1234.36 2545.8,-1232.22 2546.73,-1239.16"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge770" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1593.19,-1272.74C1596.15,-1272.31 1599.09,-1271.91 1602,-1271.54 2151.25,-1201.37 2300.75,-1306.41 2852.96,-1235.72"/>
<polygon fill="blue" stroke="blue" points="2853.71,-1239.15 2863.18,-1234.4 2852.81,-1232.21 2853.71,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge783" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1593.19,-1272.72C1596.15,-1272.3 1599.09,-1271.9 1602,-1271.54 2286.81,-1186.02 2472.27,-1322.09 3160.02,-1235.71"/>
<polygon fill="blue" stroke="blue" points="3160.7,-1239.15 3170.18,-1234.42 3159.82,-1232.21 3160.7,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge796" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1593.19,-1272.7C1596.15,-1272.29 1599.09,-1271.9 1602,-1271.54 2422.41,-1170.67 2643.78,-1337.81 3467.16,-1235.69"/>
<polygon fill="blue" stroke="blue" points="3467.69,-1239.15 3477.18,-1234.43 3466.83,-1232.2 3467.69,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge809" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1593.19,-1272.69C1596.15,-1272.28 1599.09,-1271.89 1602,-1271.54 2078.37,-1213.63 3279.95,-1294.1 3774.08,-1235.67"/>
<polygon fill="blue" stroke="blue" points="3774.68,-1239.12 3784.18,-1234.44 3773.83,-1232.18 3774.68,-1239.12"/>
</g>
<!-- qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge822" class="edge">
<title>qkv_layer_3_gpu_2&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1593.19,-1272.69C1596.14,-1272.27 1599.08,-1271.89 1602,-1271.54 2146.09,-1205.96 3518.87,-1301.9 4080.92,-1235.69"/>
<polygon fill="blue" stroke="blue" points="4081.68,-1239.13 4091.18,-1234.45 4080.84,-1232.18 4081.68,-1239.13"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge679" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1610.79,-1272.87C1607.84,-1272.4 1604.91,-1271.96 1602,-1271.54 1345.71,-1234.58 1274.31,-1272.54 1013.69,-1235.54"/>
<polygon fill="blue" stroke="blue" points="1013.94,-1232.04 1003.55,-1234.08 1012.94,-1238.97 1013.94,-1232.04"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge692" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1610.75,-1273.14C1607.81,-1272.59 1604.89,-1272.05 1602,-1271.54 1480.76,-1249.95 1446.09,-1257.53 1320.59,-1235.57"/>
<polygon fill="blue" stroke="blue" points="1321.05,-1232.1 1310.59,-1233.8 1319.82,-1238.99 1321.05,-1232.1"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge705" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1663.37,-1271.43C1635.94,-1261.07 1605.89,-1249.72 1577.94,-1239.16"/>
<polygon fill="blue" stroke="blue" points="1579.13,-1235.88 1568.54,-1235.62 1576.66,-1242.42 1579.13,-1235.88"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge715" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="black" d="M1766.05,-1271.28C1767.64,-1263.08 1769.36,-1254.28 1771.02,-1245.74"/>
<polygon fill="black" stroke="black" points="1774.46,-1246.37 1772.93,-1235.89 1767.59,-1245.04 1774.46,-1246.37"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge732" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1868.68,-1271.43C1900.54,-1260.93 1935.49,-1249.43 1967.91,-1238.75"/>
<polygon fill="blue" stroke="blue" points="1969.02,-1242.07 1977.43,-1235.62 1966.84,-1235.42 1969.02,-1242.07"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge745" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1907.24,-1273.07C1910.18,-1272.54 1913.11,-1272.03 1916,-1271.54 2056.07,-1247.8 2096,-1259.66 2239.1,-1235.8"/>
<polygon fill="blue" stroke="blue" points="2239.86,-1239.22 2249.13,-1234.09 2238.69,-1232.32 2239.86,-1239.22"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge758" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1907.21,-1272.86C1910.16,-1272.39 1913.09,-1271.95 1916,-1271.54 2191.28,-1232.42 2267.78,-1274.89 2546.17,-1235.72"/>
<polygon fill="blue" stroke="blue" points="2546.76,-1239.17 2556.16,-1234.29 2545.77,-1232.24 2546.76,-1239.17"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge771" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1907.2,-1272.78C1910.15,-1272.34 1913.09,-1271.93 1916,-1271.54 2326.68,-1217.07 2439.33,-1290.43 2853.03,-1235.72"/>
<polygon fill="blue" stroke="blue" points="2853.73,-1239.16 2863.17,-1234.36 2852.8,-1232.22 2853.73,-1239.16"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge784" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1907.19,-1272.74C1910.15,-1272.31 1913.09,-1271.91 1916,-1271.54 2462.18,-1201.72 2610.85,-1306.06 3160.01,-1235.71"/>
<polygon fill="blue" stroke="blue" points="3160.71,-1239.15 3170.18,-1234.4 3159.81,-1232.21 3160.71,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge797" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1907.19,-1272.72C1910.15,-1272.3 1913.09,-1271.9 1916,-1271.54 2597.74,-1186.37 2782.36,-1321.74 3467.07,-1235.7"/>
<polygon fill="blue" stroke="blue" points="3467.7,-1239.15 3477.18,-1234.42 3466.82,-1232.21 3467.7,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge810" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1907.19,-1272.7C1910.15,-1272.29 1913.09,-1271.9 1916,-1271.54 2733.33,-1171.01 2953.88,-1337.45 3774.2,-1235.68"/>
<polygon fill="blue" stroke="blue" points="3774.69,-1239.15 3784.18,-1234.43 3773.83,-1232.2 3774.69,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge823" class="edge">
<title>qkv_layer_3_gpu_3&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1907.19,-1272.69C1910.15,-1272.28 1913.09,-1271.89 1916,-1271.54 2390.83,-1213.8 3588.55,-1293.93 4081.11,-1235.67"/>
<polygon fill="blue" stroke="blue" points="4081.68,-1239.12 4091.18,-1234.44 4080.83,-1232.18 4081.68,-1239.12"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge680" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1924.8,-1272.79C1921.85,-1272.34 1918.91,-1271.93 1916,-1271.54 1521.18,-1218.87 1412.81,-1288.32 1013.62,-1235.52"/>
<polygon fill="blue" stroke="blue" points="1013.91,-1232.03 1003.53,-1234.17 1012.98,-1238.96 1013.91,-1232.03"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge693" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1924.79,-1272.87C1921.84,-1272.4 1918.91,-1271.96 1916,-1271.54 1656.67,-1234.24 1584.41,-1272.87 1320.81,-1235.56"/>
<polygon fill="blue" stroke="blue" points="1320.94,-1232.04 1310.55,-1234.08 1319.94,-1238.97 1320.94,-1232.04"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge706" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1924.75,-1273.12C1921.81,-1272.58 1918.89,-1272.05 1916,-1271.54 1791.77,-1249.62 1756.21,-1257.85 1627.82,-1235.61"/>
<polygon fill="blue" stroke="blue" points="1628.05,-1232.1 1617.59,-1233.81 1626.83,-1238.99 1628.05,-1232.1"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge719" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1975.03,-1271.43C1946.93,-1261.07 1916.14,-1249.72 1887.5,-1239.16"/>
<polygon fill="blue" stroke="blue" points="1888.47,-1235.79 1877.88,-1235.62 1886.05,-1242.36 1888.47,-1235.79"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge728" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="black" d="M2077.7,-1271.28C2078.75,-1263.17 2079.88,-1254.47 2080.97,-1246.02"/>
<polygon fill="black" stroke="black" points="2084.47,-1246.26 2082.29,-1235.89 2077.53,-1245.36 2084.47,-1246.26"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge746" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2180.33,-1271.43C2211.39,-1260.98 2245.43,-1249.52 2277.04,-1238.89"/>
<polygon fill="blue" stroke="blue" points="2278.4,-1242.12 2286.77,-1235.62 2276.17,-1235.49 2278.4,-1242.12"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge759" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2221.24,-1273.08C2224.18,-1272.55 2227.11,-1272.03 2230,-1271.54 2366.92,-1248.17 2406.04,-1259.32 2545.88,-1235.84"/>
<polygon fill="blue" stroke="blue" points="2546.86,-1239.22 2556.13,-1234.09 2545.68,-1232.32 2546.86,-1239.22"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge772" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2221.21,-1272.86C2224.16,-1272.39 2227.09,-1271.95 2230,-1271.54 2502.1,-1232.79 2577.81,-1274.51 2852.87,-1235.77"/>
<polygon fill="blue" stroke="blue" points="2853.76,-1239.17 2863.16,-1234.29 2852.77,-1232.24 2853.76,-1239.17"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge785" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2221.2,-1272.78C2224.15,-1272.34 2227.09,-1271.93 2230,-1271.54 2637.61,-1217.42 2749.44,-1290.08 3160.11,-1235.71"/>
<polygon fill="blue" stroke="blue" points="3160.73,-1239.16 3170.17,-1234.36 3159.8,-1232.22 3160.73,-1239.16"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge798" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2221.19,-1272.74C2224.15,-1272.31 2227.09,-1271.91 2230,-1271.54 2773.11,-1202.07 2920.95,-1305.71 3467.07,-1235.71"/>
<polygon fill="blue" stroke="blue" points="3467.71,-1239.15 3477.18,-1234.4 3466.81,-1232.21 3467.71,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge811" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2221.19,-1272.72C2224.15,-1272.3 2227.09,-1271.9 2230,-1271.54 2908.66,-1186.72 3092.46,-1321.39 3774.11,-1235.7"/>
<polygon fill="blue" stroke="blue" points="3774.7,-1239.15 3784.18,-1234.42 3773.82,-1232.21 3774.7,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge824" class="edge">
<title>qkv_layer_3_gpu_4&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2221.19,-1272.71C2224.15,-1272.29 2227.09,-1271.9 2230,-1271.54 3044.25,-1171.36 3263.97,-1337.1 4081.24,-1235.68"/>
<polygon fill="blue" stroke="blue" points="4081.69,-1239.15 4091.18,-1234.43 4080.83,-1232.2 4081.69,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge681" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2238.81,-1272.75C2235.85,-1272.32 2232.91,-1271.91 2230,-1271.54 1696.54,-1203.16 1551.36,-1304.23 1013.48,-1235.5"/>
<polygon fill="blue" stroke="blue" points="1013.89,-1232.02 1003.53,-1234.21 1013,-1238.96 1013.89,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge694" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2238.8,-1272.79C2235.85,-1272.34 2232.91,-1271.93 2230,-1271.54 1832.12,-1218.52 1722.91,-1288.67 1320.69,-1235.53"/>
<polygon fill="blue" stroke="blue" points="1320.91,-1232.03 1310.53,-1234.17 1319.98,-1238.96 1320.91,-1232.03"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge707" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2238.79,-1272.87C2235.84,-1272.4 2232.91,-1271.96 2230,-1271.54 1967.49,-1233.87 1894.45,-1273.25 1627.53,-1235.52"/>
<polygon fill="blue" stroke="blue" points="1627.94,-1232.04 1617.55,-1234.08 1626.95,-1238.97 1627.94,-1232.04"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge720" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2238.75,-1273.11C2235.81,-1272.57 2232.89,-1272.05 2230,-1271.54 2102.65,-1249.26 2066.26,-1258.19 1934.65,-1235.58"/>
<polygon fill="blue" stroke="blue" points="1935.04,-1232.09 1924.59,-1233.82 1933.84,-1238.99 1935.04,-1232.09"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge733" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2286.69,-1271.43C2257.79,-1261.02 2226.12,-1249.62 2196.69,-1239.03"/>
<polygon fill="blue" stroke="blue" points="2197.81,-1235.71 2187.22,-1235.62 2195.44,-1242.3 2197.81,-1235.71"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge741" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="black" d="M2389.35,-1271.28C2389.88,-1263.17 2390.44,-1254.47 2390.99,-1246.02"/>
<polygon fill="black" stroke="black" points="2394.49,-1246.1 2391.64,-1235.89 2387.5,-1245.64 2394.49,-1246.1"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge760" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2491.99,-1271.43C2522.37,-1260.98 2555.67,-1249.52 2586.59,-1238.89"/>
<polygon fill="blue" stroke="blue" points="2587.79,-1242.18 2596.1,-1235.62 2585.51,-1235.56 2587.79,-1242.18"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge773" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2535.25,-1273.09C2538.19,-1272.55 2541.11,-1272.04 2544,-1271.54 2677.92,-1248.51 2716.16,-1258.99 2853.1,-1235.8"/>
<polygon fill="blue" stroke="blue" points="2853.87,-1239.22 2863.13,-1234.08 2852.68,-1232.32 2853.87,-1239.22"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge786" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2535.21,-1272.86C2538.16,-1272.4 2541.09,-1271.95 2544,-1271.54 2813.05,-1233.13 2887.92,-1274.17 3159.98,-1235.75"/>
<polygon fill="blue" stroke="blue" points="3160.76,-1239.17 3170.16,-1234.29 3159.77,-1232.25 3160.76,-1239.17"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge799" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2535.2,-1272.78C2538.15,-1272.34 2541.09,-1271.93 2544,-1271.54 2948.55,-1217.76 3059.54,-1289.73 3467.18,-1235.7"/>
<polygon fill="blue" stroke="blue" points="3467.73,-1239.16 3477.17,-1234.36 3466.8,-1232.22 3467.73,-1239.16"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge812" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2535.19,-1272.74C2538.15,-1272.31 2541.09,-1271.91 2544,-1271.54 3084.04,-1202.41 3231.05,-1305.36 3774.13,-1235.7"/>
<polygon fill="blue" stroke="blue" points="3774.71,-1239.15 3784.18,-1234.4 3773.81,-1232.21 3774.71,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge825" class="edge">
<title>qkv_layer_3_gpu_5&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2535.19,-1272.72C2538.15,-1272.3 2541.09,-1271.9 2544,-1271.54 3219.59,-1187.06 3402.56,-1321.04 4081.16,-1235.69"/>
<polygon fill="blue" stroke="blue" points="4081.7,-1239.15 4091.18,-1234.42 4080.82,-1232.21 4081.7,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge682" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2552.81,-1272.72C2549.85,-1272.3 2546.91,-1271.9 2544,-1271.54 1871.93,-1187.46 1689.96,-1320.15 1013.52,-1235.5"/>
<polygon fill="blue" stroke="blue" points="1013.88,-1232.02 1003.52,-1234.24 1013.01,-1238.96 1013.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge695" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2552.81,-1272.75C2549.85,-1272.32 2546.91,-1271.91 2544,-1271.54 2007.47,-1202.81 1861.46,-1304.58 1320.54,-1235.5"/>
<polygon fill="blue" stroke="blue" points="1320.89,-1232.02 1310.53,-1234.21 1320,-1238.96 1320.89,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge708" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2552.8,-1272.78C2549.85,-1272.34 2546.91,-1271.93 2544,-1271.54 2142.95,-1218.16 2032.96,-1289.05 1627.47,-1235.5"/>
<polygon fill="blue" stroke="blue" points="1627.91,-1232.03 1617.53,-1234.17 1626.98,-1238.96 1627.91,-1232.03"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge721" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2552.79,-1272.86C2549.84,-1272.4 2546.91,-1271.96 2544,-1271.54 2278.44,-1233.53 2204.56,-1273.59 1934.64,-1235.53"/>
<polygon fill="blue" stroke="blue" points="1934.94,-1232.04 1924.54,-1234.09 1933.95,-1238.97 1934.94,-1232.04"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge734" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2552.75,-1273.1C2549.81,-1272.56 2546.89,-1272.04 2544,-1271.54 2413.51,-1248.89 2376.3,-1258.53 2241.46,-1235.54"/>
<polygon fill="blue" stroke="blue" points="2242.04,-1232.09 2231.59,-1233.83 2240.84,-1238.99 2242.04,-1232.09"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge747" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2598.35,-1271.43C2568.78,-1261.02 2536.37,-1249.62 2506.25,-1239.03"/>
<polygon fill="blue" stroke="blue" points="2507.15,-1235.63 2496.56,-1235.62 2504.83,-1242.24 2507.15,-1235.63"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge754" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="black" d="M2701,-1271.28C2701,-1263.17 2701,-1254.47 2701,-1246.02"/>
<polygon fill="black" stroke="black" points="2704.5,-1245.89 2701,-1235.89 2697.5,-1245.89 2704.5,-1245.89"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge774" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2803.65,-1271.43C2833.22,-1261.02 2865.63,-1249.62 2895.75,-1239.03"/>
<polygon fill="blue" stroke="blue" points="2897.17,-1242.24 2905.44,-1235.62 2894.85,-1235.63 2897.17,-1242.24"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge787" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2849.25,-1273.1C2852.19,-1272.56 2855.11,-1272.04 2858,-1271.54 2988.78,-1248.87 3026.2,-1258.65 3159.9,-1235.84"/>
<polygon fill="blue" stroke="blue" points="3160.87,-1239.23 3170.13,-1234.07 3159.68,-1232.33 3160.87,-1239.23"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge800" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2849.21,-1272.86C2852.16,-1272.4 2855.09,-1271.96 2858,-1271.54 3124,-1233.48 3198.03,-1273.83 3467.1,-1235.74"/>
<polygon fill="blue" stroke="blue" points="3467.76,-1239.18 3477.16,-1234.29 3466.77,-1232.25 3467.76,-1239.18"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge813" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2849.2,-1272.78C2852.15,-1272.34 2855.09,-1271.93 2858,-1271.54 3259.48,-1218.11 3369.64,-1289.39 3774.25,-1235.69"/>
<polygon fill="blue" stroke="blue" points="3774.73,-1239.16 3784.17,-1234.36 3773.8,-1232.22 3774.73,-1239.16"/>
</g>
<!-- qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge826" class="edge">
<title>qkv_layer_3_gpu_6&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2849.19,-1272.75C2852.15,-1272.32 2855.09,-1271.91 2858,-1271.54 3394.97,-1202.76 3541.15,-1305.01 4081.18,-1235.69"/>
<polygon fill="blue" stroke="blue" points="4081.71,-1239.15 4091.18,-1234.4 4080.81,-1232.21 4081.71,-1239.15"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge683" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2866.81,-1272.71C2863.85,-1272.29 2860.91,-1271.9 2858,-1271.54 2047.36,-1171.77 1828.61,-1336.07 1013.74,-1235.53"/>
<polygon fill="blue" stroke="blue" points="1013.88,-1232.02 1003.52,-1234.25 1013.01,-1238.96 1013.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge696" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2866.81,-1272.72C2863.85,-1272.3 2860.91,-1271.9 2858,-1271.54 2182.85,-1187.11 2000.06,-1320.5 1320.56,-1235.5"/>
<polygon fill="blue" stroke="blue" points="1320.88,-1232.02 1310.52,-1234.24 1320.01,-1238.96 1320.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge709" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2866.81,-1272.74C2863.85,-1272.31 2860.91,-1271.91 2858,-1271.54 2318.4,-1202.46 2171.55,-1304.92 1627.59,-1235.51"/>
<polygon fill="blue" stroke="blue" points="1627.89,-1232.02 1617.53,-1234.21 1627,-1238.96 1627.89,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge722" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2866.8,-1272.78C2863.85,-1272.34 2860.91,-1271.93 2858,-1271.54 2453.89,-1217.81 2343.06,-1289.39 1934.55,-1235.51"/>
<polygon fill="blue" stroke="blue" points="1934.91,-1232.03 1924.53,-1234.17 1933.98,-1238.96 1934.91,-1232.03"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge735" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2866.79,-1272.86C2863.84,-1272.4 2860.91,-1271.95 2858,-1271.54 2589.39,-1233.18 2514.66,-1273.93 2241.75,-1235.55"/>
<polygon fill="blue" stroke="blue" points="2241.94,-1232.04 2231.54,-1234.09 2240.95,-1238.97 2241.94,-1232.04"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge748" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2866.75,-1273.09C2863.81,-1272.56 2860.89,-1272.04 2858,-1271.54 2724.51,-1248.56 2686.42,-1258.85 2548.68,-1235.58"/>
<polygon fill="blue" stroke="blue" points="2549.03,-1232.09 2538.58,-1233.84 2547.85,-1238.99 2549.03,-1232.09"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge761" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2910.01,-1271.43C2879.63,-1260.98 2846.33,-1249.52 2815.41,-1238.89"/>
<polygon fill="blue" stroke="blue" points="2816.49,-1235.56 2805.9,-1235.62 2814.21,-1242.18 2816.49,-1235.56"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge767" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="black" d="M3012.65,-1271.28C3012.12,-1263.17 3011.56,-1254.47 3011.01,-1246.02"/>
<polygon fill="black" stroke="black" points="3014.5,-1245.64 3010.36,-1235.89 3007.51,-1246.1 3014.5,-1245.64"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge788" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3115.31,-1271.43C3144.21,-1261.02 3175.88,-1249.62 3205.31,-1239.03"/>
<polygon fill="blue" stroke="blue" points="3206.56,-1242.3 3214.78,-1235.62 3204.19,-1235.71 3206.56,-1242.3"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge801" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3163.25,-1273.11C3166.19,-1272.57 3169.11,-1272.04 3172,-1271.54 3299.78,-1249.21 3336.31,-1258.33 3467.12,-1235.81"/>
<polygon fill="blue" stroke="blue" points="3467.88,-1239.23 3477.12,-1234.06 3466.67,-1232.33 3467.88,-1239.23"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge814" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3163.21,-1272.87C3166.16,-1272.4 3169.09,-1271.96 3172,-1271.54 3434.95,-1233.82 3508.13,-1273.49 3774.21,-1235.72"/>
<polygon fill="blue" stroke="blue" points="3774.76,-1239.18 3784.16,-1234.28 3773.76,-1232.25 3774.76,-1239.18"/>
</g>
<!-- qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge827" class="edge">
<title>qkv_layer_3_gpu_7&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3163.2,-1272.79C3166.15,-1272.34 3169.09,-1271.93 3172,-1271.54 3570.32,-1218.47 3679.69,-1289 4081.03,-1235.72"/>
<polygon fill="blue" stroke="blue" points="4081.73,-1239.16 4091.17,-1234.36 4080.79,-1232.22 4081.73,-1239.16"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge684" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3180.81,-1272.69C3177.85,-1272.28 3174.91,-1271.89 3172,-1271.54 2698.92,-1214 1505.67,-1293.39 1013.58,-1235.48"/>
<polygon fill="blue" stroke="blue" points="1013.87,-1231.99 1003.52,-1234.27 1013.03,-1238.94 1013.87,-1231.99"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge697" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3180.81,-1272.71C3177.85,-1272.29 3174.91,-1271.9 3172,-1271.54 2358.19,-1171.41 2138.66,-1336.46 1320.48,-1235.49"/>
<polygon fill="blue" stroke="blue" points="1320.88,-1232.02 1310.52,-1234.25 1320.01,-1238.96 1320.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge710" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3180.81,-1272.72C3177.85,-1272.3 3174.91,-1271.9 3172,-1271.54 2493.78,-1186.76 2310.16,-1320.85 1627.61,-1235.51"/>
<polygon fill="blue" stroke="blue" points="1627.88,-1232.02 1617.52,-1234.24 1627.01,-1238.96 1627.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge723" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3180.81,-1272.74C3177.85,-1272.31 3174.91,-1271.91 3172,-1271.54 2629.33,-1202.12 2481.65,-1305.27 1934.65,-1235.52"/>
<polygon fill="blue" stroke="blue" points="1934.89,-1232.02 1924.53,-1234.21 1934,-1238.96 1934.89,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge736" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3180.8,-1272.78C3177.85,-1272.34 3174.91,-1271.93 3172,-1271.54 2764.82,-1217.47 2653.16,-1289.74 2241.62,-1235.52"/>
<polygon fill="blue" stroke="blue" points="2241.91,-1232.03 2231.53,-1234.17 2240.98,-1238.96 2241.91,-1232.03"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge749" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3180.79,-1272.86C3177.84,-1272.39 3174.91,-1271.95 3172,-1271.54 2900.21,-1232.82 2824.7,-1274.31 2548.46,-1235.51"/>
<polygon fill="blue" stroke="blue" points="2548.94,-1232.04 2538.54,-1234.09 2547.95,-1238.97 2548.94,-1232.04"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge762" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3180.76,-1273.08C3177.82,-1272.55 3174.89,-1272.03 3172,-1271.54 3035.37,-1248.19 2996.45,-1259.19 2855.46,-1235.54"/>
<polygon fill="blue" stroke="blue" points="2856.03,-1232.09 2845.58,-1233.85 2854.85,-1238.99 2856.03,-1232.09"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge775" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3221.67,-1271.43C3190.61,-1260.98 3156.57,-1249.52 3124.96,-1238.89"/>
<polygon fill="blue" stroke="blue" points="3125.83,-1235.49 3115.23,-1235.62 3123.6,-1242.12 3125.83,-1235.49"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge780" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="black" d="M3324.3,-1271.28C3323.25,-1263.17 3322.12,-1254.47 3321.03,-1246.02"/>
<polygon fill="black" stroke="black" points="3324.47,-1245.36 3319.71,-1235.89 3317.53,-1246.26 3324.47,-1245.36"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge802" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3426.97,-1271.43C3455.07,-1261.07 3485.86,-1249.72 3514.5,-1239.16"/>
<polygon fill="blue" stroke="blue" points="3515.95,-1242.36 3524.12,-1235.62 3513.53,-1235.79 3515.95,-1242.36"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge815" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3477.25,-1273.12C3480.19,-1272.58 3483.11,-1272.05 3486,-1271.54 3610.66,-1249.57 3646.36,-1257.99 3773.96,-1235.84"/>
<polygon fill="blue" stroke="blue" points="3774.88,-1239.23 3784.12,-1234.05 3773.67,-1232.34 3774.88,-1239.23"/>
</g>
<!-- qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge828" class="edge">
<title>qkv_layer_3_gpu_8&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3477.21,-1272.87C3480.16,-1272.4 3483.09,-1271.96 3486,-1271.54 3745.77,-1234.19 3818.17,-1273.11 4080.93,-1235.76"/>
<polygon fill="blue" stroke="blue" points="4081.76,-1239.18 4091.16,-1234.28 4080.76,-1232.25 4081.76,-1239.18"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge685" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3494.81,-1272.69C3491.86,-1272.27 3488.92,-1271.89 3486,-1271.54 2943.67,-1206.16 1575.36,-1301.31 1013.77,-1235.51"/>
<polygon fill="blue" stroke="blue" points="1013.87,-1231.99 1003.52,-1234.28 1013.03,-1238.94 1013.87,-1231.99"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge698" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3494.81,-1272.69C3491.85,-1272.28 3488.91,-1271.89 3486,-1271.54 3011.39,-1213.82 1814.27,-1293.56 1320.61,-1235.49"/>
<polygon fill="blue" stroke="blue" points="1320.87,-1231.99 1310.52,-1234.27 1320.03,-1238.94 1320.87,-1231.99"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge711" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3494.81,-1272.7C3491.85,-1272.29 3488.91,-1271.9 3486,-1271.54 2669.11,-1171.06 2448.75,-1336.81 1627.52,-1235.5"/>
<polygon fill="blue" stroke="blue" points="1627.88,-1232.02 1617.52,-1234.25 1627.01,-1238.96 1627.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge724" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3494.81,-1272.72C3491.85,-1272.3 3488.91,-1271.9 3486,-1271.54 2804.7,-1186.42 2620.26,-1321.2 1934.65,-1235.52"/>
<polygon fill="blue" stroke="blue" points="1934.88,-1232.02 1924.52,-1234.24 1934.01,-1238.96 1934.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge737" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3494.81,-1272.74C3491.85,-1272.31 3488.91,-1271.91 3486,-1271.54 2940.26,-1201.77 2791.75,-1305.62 2241.71,-1235.52"/>
<polygon fill="blue" stroke="blue" points="2241.89,-1232.02 2231.53,-1234.21 2241,-1238.96 2241.89,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge750" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3494.8,-1272.78C3491.85,-1272.34 3488.91,-1271.93 3486,-1271.54 3075.76,-1217.12 2963.26,-1290.08 2548.69,-1235.53"/>
<polygon fill="blue" stroke="blue" points="2548.91,-1232.03 2538.53,-1234.17 2547.98,-1238.96 2548.91,-1232.03"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge763" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3494.79,-1272.86C3491.84,-1272.39 3488.91,-1271.95 3486,-1271.54 3211.15,-1232.47 3134.8,-1274.65 2855.56,-1235.52"/>
<polygon fill="blue" stroke="blue" points="2855.94,-1232.04 2845.54,-1234.09 2854.95,-1238.97 2855.94,-1232.04"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge776" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3494.76,-1273.07C3491.82,-1272.54 3488.89,-1272.03 3486,-1271.54 3346.36,-1247.85 3306.57,-1259.52 3162.67,-1235.57"/>
<polygon fill="blue" stroke="blue" points="3163.02,-1232.08 3152.58,-1233.86 3161.86,-1238.98 3163.02,-1232.08"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge789" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3533.32,-1271.43C3501.46,-1260.93 3466.51,-1249.43 3434.09,-1238.75"/>
<polygon fill="blue" stroke="blue" points="3435.16,-1235.42 3424.57,-1235.62 3432.98,-1242.07 3435.16,-1235.42"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge793" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="black" d="M3635.95,-1271.28C3634.36,-1263.08 3632.64,-1254.28 3630.98,-1245.74"/>
<polygon fill="black" stroke="black" points="3634.41,-1245.04 3629.07,-1235.89 3627.54,-1246.37 3634.41,-1245.04"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge816" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3738.63,-1271.43C3766.06,-1261.07 3796.11,-1249.72 3824.06,-1239.16"/>
<polygon fill="blue" stroke="blue" points="3825.34,-1242.42 3833.46,-1235.62 3822.87,-1235.88 3825.34,-1242.42"/>
</g>
<!-- qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge829" class="edge">
<title>qkv_layer_3_gpu_9&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3791.25,-1273.13C3794.19,-1272.59 3797.11,-1272.05 3800,-1271.54 3921.66,-1249.91 3956.48,-1257.67 4081.19,-1235.8"/>
<polygon fill="blue" stroke="blue" points="4081.89,-1239.23 4091.12,-1234.03 4080.66,-1232.34 4081.89,-1239.23"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge686" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3808.81,-1272.68C3805.86,-1272.27 3802.92,-1271.89 3800,-1271.54 3188.31,-1198.3 1644.54,-1309.27 1013.66,-1235.49"/>
<polygon fill="blue" stroke="blue" points="1013.86,-1231.99 1003.52,-1234.28 1013.03,-1238.94 1013.86,-1231.99"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge699" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3808.81,-1272.69C3805.86,-1272.27 3802.92,-1271.89 3800,-1271.54 3256.13,-1205.98 1883.95,-1301.48 1320.8,-1235.51"/>
<polygon fill="blue" stroke="blue" points="1320.86,-1231.99 1310.52,-1234.28 1320.03,-1238.94 1320.86,-1231.99"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge712" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3808.81,-1272.69C3805.85,-1272.28 3802.91,-1271.89 3800,-1271.54 3323.85,-1213.65 2122.87,-1293.73 1627.65,-1235.49"/>
<polygon fill="blue" stroke="blue" points="1627.87,-1231.99 1617.52,-1234.27 1627.03,-1238.94 1627.87,-1231.99"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge725" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3808.81,-1272.7C3805.85,-1272.29 3802.91,-1271.9 3800,-1271.54 2980.03,-1170.71 2758.85,-1337.17 1934.55,-1235.5"/>
<polygon fill="blue" stroke="blue" points="1934.88,-1232.02 1924.52,-1234.25 1934.01,-1238.96 1934.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge738" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3808.81,-1272.72C3805.85,-1272.3 3802.91,-1271.9 3800,-1271.54 3115.63,-1186.07 2930.35,-1321.55 2241.7,-1235.52"/>
<polygon fill="blue" stroke="blue" points="2241.88,-1232.02 2231.52,-1234.24 2241.01,-1238.96 2241.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge751" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3808.81,-1272.74C3805.85,-1272.31 3802.91,-1271.91 3800,-1271.54 3251.18,-1201.42 3101.85,-1305.97 2548.76,-1235.53"/>
<polygon fill="blue" stroke="blue" points="2548.89,-1232.02 2538.53,-1234.21 2548,-1238.96 2548.89,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge764" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3808.8,-1272.78C3805.85,-1272.34 3802.91,-1271.92 3800,-1271.54 3386.59,-1216.76 3273.31,-1290.46 2855.46,-1235.5"/>
<polygon fill="blue" stroke="blue" points="2855.91,-1232.03 2845.53,-1234.17 2854.98,-1238.96 2855.91,-1232.03"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge777" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3808.79,-1272.85C3805.84,-1272.39 3802.91,-1271.95 3800,-1271.54 3522.1,-1232.13 3444.91,-1274.99 3162.67,-1235.53"/>
<polygon fill="blue" stroke="blue" points="3162.94,-1232.04 3152.54,-1234.1 3161.95,-1238.97 3162.94,-1232.04"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge790" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3808.76,-1273.06C3805.82,-1272.54 3802.9,-1272.03 3800,-1271.54 3657.35,-1247.51 3616.69,-1259.84 3469.87,-1235.6"/>
<polygon fill="blue" stroke="blue" points="3470.02,-1232.08 3459.58,-1233.87 3468.86,-1238.98 3470.02,-1232.08"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge803" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3844.98,-1271.43C3812.44,-1260.93 3776.74,-1249.43 3743.63,-1238.75"/>
<polygon fill="blue" stroke="blue" points="3744.5,-1235.35 3733.91,-1235.62 3742.35,-1242.02 3744.5,-1235.35"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge806" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="black" d="M3947.6,-1271.28C3945.47,-1263.08 3943.19,-1254.28 3940.98,-1245.74"/>
<polygon fill="black" stroke="black" points="3944.32,-1244.69 3938.42,-1235.89 3937.55,-1246.45 3944.32,-1244.69"/>
</g>
<!-- qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge830" class="edge">
<title>qkv_layer_3_gpu_10&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4050.29,-1271.43C4076.93,-1261.11 4106.11,-1249.82 4133.28,-1239.3"/>
<polygon fill="blue" stroke="blue" points="4134.73,-1242.49 4142.8,-1235.62 4132.21,-1235.96 4134.73,-1242.49"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_0 -->
<g id="edge687" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4122.81,-1272.67C4119.86,-1272.27 4116.92,-1271.89 4114,-1271.54 3432.93,-1190.45 1713.62,-1317.25 1013.49,-1235.48"/>
<polygon fill="blue" stroke="blue" points="1013.86,-1231.99 1003.52,-1234.29 1013.03,-1238.95 1013.86,-1231.99"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_1 -->
<g id="edge700" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4122.81,-1272.68C4119.86,-1272.27 4116.92,-1271.89 4114,-1271.54 3500.77,-1198.13 1953.12,-1309.44 1320.68,-1235.5"/>
<polygon fill="blue" stroke="blue" points="1320.86,-1231.99 1310.52,-1234.28 1320.03,-1238.94 1320.86,-1231.99"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_2 -->
<g id="edge713" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4122.81,-1272.69C4119.86,-1272.27 4116.92,-1271.89 4114,-1271.54 3568.6,-1205.81 2192.54,-1301.65 1627.83,-1235.51"/>
<polygon fill="blue" stroke="blue" points="1627.86,-1231.99 1617.52,-1234.28 1627.03,-1238.94 1627.86,-1231.99"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_3 -->
<g id="edge726" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4122.81,-1272.69C4119.85,-1272.28 4116.91,-1271.89 4114,-1271.54 3636.32,-1213.48 2431.47,-1293.91 1934.68,-1235.49"/>
<polygon fill="blue" stroke="blue" points="1934.87,-1231.99 1924.52,-1234.27 1934.03,-1238.94 1934.87,-1231.99"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_4 -->
<g id="edge739" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4122.81,-1272.7C4119.85,-1272.29 4116.91,-1271.9 4114,-1271.54 3290.95,-1170.37 3068.95,-1337.52 2241.59,-1235.51"/>
<polygon fill="blue" stroke="blue" points="2241.88,-1232.02 2231.52,-1234.26 2241.01,-1238.96 2241.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_5 -->
<g id="edge752" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4122.81,-1272.72C4119.85,-1272.3 4116.91,-1271.9 4114,-1271.54 3426.47,-1185.71 3240.41,-1321.93 2548.49,-1235.49"/>
<polygon fill="blue" stroke="blue" points="2548.88,-1232.02 2538.52,-1234.24 2548.01,-1238.96 2548.88,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_6 -->
<g id="edge765" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4122.81,-1272.74C4119.85,-1272.31 4116.91,-1271.91 4114,-1271.54 3562.11,-1201.07 3411.95,-1306.32 2855.82,-1235.54"/>
<polygon fill="blue" stroke="blue" points="2855.89,-1232.02 2845.53,-1234.22 2855,-1238.96 2855.89,-1232.02"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_7 -->
<g id="edge778" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4122.8,-1272.78C4119.85,-1272.34 4116.91,-1271.92 4114,-1271.54 3697.53,-1216.41 3583.41,-1290.81 3162.53,-1235.51"/>
<polygon fill="blue" stroke="blue" points="3162.91,-1232.03 3152.53,-1234.18 3161.98,-1238.96 3162.91,-1232.03"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_8 -->
<g id="edge791" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4122.79,-1272.85C4119.84,-1272.39 4116.91,-1271.95 4114,-1271.54 3833.05,-1231.78 3755.02,-1275.33 3469.78,-1235.55"/>
<polygon fill="blue" stroke="blue" points="3469.93,-1232.04 3459.54,-1234.1 3468.95,-1238.97 3469.93,-1232.04"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_9 -->
<g id="edge804" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4122.76,-1273.05C4119.82,-1272.53 4116.9,-1272.02 4114,-1271.54 3968.2,-1247.15 3926.72,-1260.19 3776.62,-1235.56"/>
<polygon fill="blue" stroke="blue" points="3777.02,-1232.08 3766.58,-1233.88 3775.86,-1238.98 3777.02,-1232.08"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_10 -->
<g id="edge817" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4156.64,-1271.43C4123.42,-1260.93 4086.97,-1249.43 4053.17,-1238.75"/>
<polygon fill="blue" stroke="blue" points="4053.84,-1235.29 4043.25,-1235.62 4051.73,-1241.97 4053.84,-1235.29"/>
</g>
<!-- qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_11 -->
<g id="edge819" class="edge">
<title>qkv_layer_3_gpu_11&#45;&gt;attention_layer_3_gpu_11</title>
<path fill="none" stroke="black" d="M4259.25,-1271.28C4256.56,-1262.99 4253.68,-1254.09 4250.88,-1245.46"/>
<polygon fill="black" stroke="black" points="4254.19,-1244.32 4247.78,-1235.89 4247.53,-1246.48 4254.19,-1244.32"/>
</g>
<!-- attention_agg_layer_3 -->
<g id="node172" class="node">
<title>attention_agg_layer_3</title>
<polygon fill="#ffcccc" stroke="black" points="3018.49,-1125.54 2513.43,-1125.54 2383.51,-1021.54 2888.57,-1021.54 3018.49,-1125.54"/>
<text text-anchor="middle" x="2701" y="-1087.54" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="2701" y="-1076.54" font-family="Arial" font-size="10.00">Input: [12Ã— batch_size=1024, seq_len=2048, heads=2&#45;3, d_k=128]</text>
<text text-anchor="middle" x="2701" y="-1065.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2701" y="-1054.54" font-family="Arial" font-size="10.00">GPU: all attention GPUs</text>
</g>
<!-- attention_layer_3_gpu_0&#45;&gt;attention_agg_layer_3 -->
<g id="edge831" class="edge">
<title>attention_layer_3_gpu_0&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M1003.54,-1162.96C1006.72,-1162.46 1009.87,-1161.98 1013,-1161.54 1282.41,-1123.42 2047.3,-1094.87 2448.43,-1082.03"/>
<polygon fill="black" stroke="black" points="2448.54,-1085.53 2458.43,-1081.72 2448.32,-1078.54 2448.54,-1085.53"/>
</g>
<!-- attention_layer_3_gpu_1&#45;&gt;attention_agg_layer_3 -->
<g id="edge832" class="edge">
<title>attention_layer_3_gpu_1&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M1310.55,-1163.01C1313.72,-1162.49 1316.88,-1162 1320,-1161.54 1708.98,-1104.23 2165.04,-1084.64 2443.43,-1077.96"/>
<polygon fill="black" stroke="black" points="2443.76,-1081.46 2453.67,-1077.72 2443.59,-1074.46 2443.76,-1081.46"/>
</g>
<!-- attention_layer_3_gpu_2&#45;&gt;attention_agg_layer_3 -->
<g id="edge833" class="edge">
<title>attention_layer_3_gpu_2&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M1617.56,-1163.09C1620.73,-1162.54 1623.88,-1162.03 1627,-1161.54 1907.43,-1117.65 2232.72,-1095.23 2451.19,-1084.24"/>
<polygon fill="black" stroke="black" points="2451.37,-1087.73 2461.19,-1083.74 2451.02,-1080.74 2451.37,-1087.73"/>
</g>
<!-- attention_layer_3_gpu_3&#45;&gt;attention_agg_layer_3 -->
<g id="edge834" class="edge">
<title>attention_layer_3_gpu_3&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M1924.58,-1163.22C1927.75,-1162.64 1930.89,-1162.08 1934,-1161.54 2110.04,-1131.09 2310.73,-1108.76 2462.66,-1094.35"/>
<polygon fill="black" stroke="black" points="2463.43,-1097.79 2473.05,-1093.37 2462.77,-1090.82 2463.43,-1097.79"/>
</g>
<!-- attention_layer_3_gpu_4&#45;&gt;attention_agg_layer_3 -->
<g id="edge835" class="edge">
<title>attention_layer_3_gpu_4&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M2231.64,-1163.54C2234.79,-1162.86 2237.91,-1162.19 2241,-1161.54 2320.69,-1144.7 2408.48,-1127.71 2485.82,-1113.27"/>
<polygon fill="black" stroke="black" points="2486.49,-1116.7 2495.68,-1111.43 2485.21,-1109.82 2486.49,-1116.7"/>
</g>
<!-- attention_layer_3_gpu_5&#45;&gt;attention_agg_layer_3 -->
<g id="edge836" class="edge">
<title>attention_layer_3_gpu_5&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M2484.04,-1161.47C2509.12,-1151.42 2536.95,-1140.27 2564.08,-1129.4"/>
<polygon fill="black" stroke="black" points="2565.66,-1132.53 2573.64,-1125.56 2563.06,-1126.03 2565.66,-1132.53"/>
</g>
<!-- attention_layer_3_gpu_6&#45;&gt;attention_agg_layer_3 -->
<g id="edge837" class="edge">
<title>attention_layer_3_gpu_6&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M2701,-1161.3C2701,-1153.25 2701,-1144.51 2701,-1135.77"/>
<polygon fill="black" stroke="black" points="2704.5,-1135.56 2701,-1125.56 2697.5,-1135.56 2704.5,-1135.56"/>
</g>
<!-- attention_layer_3_gpu_7&#45;&gt;attention_agg_layer_3 -->
<g id="edge838" class="edge">
<title>attention_layer_3_gpu_7&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M2917.96,-1161.47C2892.88,-1151.42 2865.05,-1140.27 2837.92,-1129.4"/>
<polygon fill="black" stroke="black" points="2838.94,-1126.03 2828.36,-1125.56 2836.34,-1132.53 2838.94,-1126.03"/>
</g>
<!-- attention_layer_3_gpu_8&#45;&gt;attention_agg_layer_3 -->
<g id="edge839" class="edge">
<title>attention_layer_3_gpu_8&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M3170.48,-1163.35C3167.63,-1162.74 3164.8,-1162.13 3162,-1161.54 3107.32,-1149.95 3048.82,-1138.32 2992.49,-1127.51"/>
<polygon fill="black" stroke="black" points="2992.85,-1124.02 2982.37,-1125.57 2991.53,-1130.89 2992.85,-1124.02"/>
</g>
<!-- attention_layer_3_gpu_9&#45;&gt;attention_agg_layer_3 -->
<g id="edge840" class="edge">
<title>attention_layer_3_gpu_9&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M3477.13,-1162.99C3474.4,-1162.49 3471.69,-1162.01 3469,-1161.54 3313.59,-1134.55 3138.96,-1114 2995.54,-1099.67"/>
<polygon fill="black" stroke="black" points="2995.57,-1096.16 2985.27,-1098.65 2994.87,-1103.12 2995.57,-1096.16"/>
</g>
<!-- attention_layer_3_gpu_10&#45;&gt;attention_agg_layer_3 -->
<g id="edge841" class="edge">
<title>attention_layer_3_gpu_10&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M3784.15,-1162.87C3781.41,-1162.41 3778.7,-1161.96 3776,-1161.54 3506.75,-1119.21 3196.13,-1096.89 2978.24,-1085.51"/>
<polygon fill="black" stroke="black" points="2978.1,-1082 2967.93,-1084.98 2977.74,-1088.99 2978.1,-1082"/>
</g>
<!-- attention_layer_3_gpu_11&#45;&gt;attention_agg_layer_3 -->
<g id="edge842" class="edge">
<title>attention_layer_3_gpu_11&#45;&gt;attention_agg_layer_3</title>
<path fill="none" stroke="black" d="M4091.16,-1162.81C4088.42,-1162.36 4085.7,-1161.94 4083,-1161.54 3698.63,-1104.63 3248.73,-1084.9 2969.25,-1078.09"/>
<polygon fill="black" stroke="black" points="2969.05,-1074.59 2958.97,-1077.84 2968.89,-1081.58 2969.05,-1074.59"/>
</g>
<!-- out_proj_layer_3 -->
<g id="node173" class="node">
<title>out_proj_layer_3</title>
<polygon fill="#0080ff" stroke="black" points="3405,-985.54 3121,-985.54 3121,-933.54 3405,-933.54 3405,-985.54"/>
<text text-anchor="middle" x="3263" y="-973.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3263" y="-962.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3263" y="-951.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3263" y="-940.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- attention_agg_layer_3&#45;&gt;out_proj_layer_3 -->
<g id="edge843" class="edge">
<title>attention_agg_layer_3&#45;&gt;out_proj_layer_3</title>
<path fill="none" stroke="black" d="M2902.31,-1032.42C2977.06,-1017.52 3060.01,-1000.99 3127.5,-987.54"/>
<polygon fill="black" stroke="black" points="3128.22,-990.97 3137.34,-985.58 3126.85,-984.1 3128.22,-990.97"/>
</g>
<!-- out_proj_layer_3&#45;&gt;residual1_layer_3 -->
<g id="edge844" class="edge">
<title>out_proj_layer_3&#45;&gt;residual1_layer_3</title>
<path fill="none" stroke="black" d="M3326.06,-933.4C3349.98,-923.87 3378.24,-912.61 3406.36,-901.4"/>
<polygon fill="black" stroke="black" points="3407.89,-904.56 3415.88,-897.6 3405.3,-898.06 3407.89,-904.56"/>
</g>
<!-- ln2_layer_3 -->
<g id="node175" class="node">
<title>ln2_layer_3</title>
<polygon fill="#0080ff" stroke="black" points="3217,-757.54 2933,-757.54 2933,-705.54 3217,-705.54 3217,-757.54"/>
<text text-anchor="middle" x="3075" y="-745.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="3075" y="-734.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3075" y="-723.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3075" y="-712.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_layer_3&#45;&gt;ln2_layer_3 -->
<g id="edge846" class="edge">
<title>residual1_layer_3&#45;&gt;ln2_layer_3</title>
<path fill="none" stroke="black" d="M3330.43,-793.54C3281.87,-781.94 3232.1,-770.05 3189.54,-759.89"/>
<polygon fill="black" stroke="black" points="3190.27,-756.47 3179.73,-757.55 3188.64,-763.28 3190.27,-756.47"/>
</g>
<!-- residual2_layer_3 -->
<g id="node194" class="node">
<title>residual2_layer_3</title>
<polygon fill="#ffffcc" stroke="black" points="4233.82,-301.54 3755.28,-301.54 3632.18,-197.54 4110.72,-197.54 4233.82,-301.54"/>
<text text-anchor="middle" x="3933" y="-263.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="3933" y="-252.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3933" y="-241.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3933" y="-230.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual1_layer_3&#45;&gt;residual2_layer_3 -->
<g id="edge897" class="edge">
<title>residual1_layer_3&#45;&gt;residual2_layer_3</title>
<path fill="none" stroke="black" d="M3773.23,-836.99C4232.32,-818.81 5221,-762.9 5221,-618.54 5221,-618.54 5221,-618.54 5221,-502.54 5221,-490.57 5220.28,-485.09 5211,-477.54 5060.17,-354.8 4531.85,-294.39 4203.58,-268.04"/>
<polygon fill="black" stroke="black" points="4203.69,-264.54 4193.45,-267.23 4203.14,-271.52 4203.69,-264.54"/>
</g>
<!-- gate_layer_3 -->
<g id="node176" class="node">
<title>gate_layer_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3209.43,-669.54 2750.6,-669.54 2632.57,-565.54 3091.4,-565.54 3209.43,-669.54"/>
<text text-anchor="middle" x="2921" y="-631.54" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="2921" y="-620.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2921" y="-609.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="2921" y="-598.54" font-family="Arial" font-size="10.00">GPU: all MoE GPUs (12&#45;15)</text>
</g>
<!-- ln2_layer_3&#45;&gt;gate_layer_3 -->
<g id="edge847" class="edge">
<title>ln2_layer_3&#45;&gt;gate_layer_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3040.44,-705.4C3028.28,-696.56 3014.07,-686.23 2999.78,-675.83"/>
<polygon fill="black" stroke="black" points="3001.52,-672.77 2991.37,-669.72 2997.4,-678.43 3001.52,-672.77"/>
</g>
<!-- expert_layer_3_expert_0_gpu_12 -->
<g id="node177" class="node">
<title>expert_layer_3_expert_0_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3390,-529.54 3106,-529.54 3106,-477.54 3390,-477.54 3390,-529.54"/>
<text text-anchor="middle" x="3248" y="-517.54" font-family="Arial" font-size="10.00">Expert0</text>
<text text-anchor="middle" x="3248" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3248" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3248" y="-484.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_0_gpu_12 -->
<g id="edge849" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_0_gpu_12</title>
<path fill="none" stroke="black" d="M3187.19,-705.41C3204.9,-696.76 3221.22,-685.15 3233,-669.54 3261.07,-632.34 3259.62,-576.14 3254.77,-539.89"/>
<polygon fill="black" stroke="black" points="3258.2,-539.15 3253.26,-529.78 3251.28,-540.18 3258.2,-539.15"/>
</g>
<!-- expert_layer_3_expert_1_gpu_12 -->
<g id="node178" class="node">
<title>expert_layer_3_expert_1_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3692,-529.54 3408,-529.54 3408,-477.54 3692,-477.54 3692,-529.54"/>
<text text-anchor="middle" x="3550" y="-517.54" font-family="Arial" font-size="10.00">Expert1</text>
<text text-anchor="middle" x="3550" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3550" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3550" y="-484.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_1_gpu_12 -->
<g id="edge851" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_1_gpu_12</title>
<path fill="none" stroke="black" d="M3155.81,-705.52C3185.82,-695.41 3219.88,-682.96 3250,-669.54 3341.41,-628.81 3442.34,-570.29 3500.73,-534.99"/>
<polygon fill="black" stroke="black" points="3502.65,-537.93 3509.38,-529.75 3499.02,-531.94 3502.65,-537.93"/>
</g>
<!-- expert_layer_3_expert_2_gpu_12 -->
<g id="node179" class="node">
<title>expert_layer_3_expert_2_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="3994,-529.54 3710,-529.54 3710,-477.54 3994,-477.54 3994,-529.54"/>
<text text-anchor="middle" x="3852" y="-517.54" font-family="Arial" font-size="10.00">Expert2</text>
<text text-anchor="middle" x="3852" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3852" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3852" y="-484.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_2_gpu_12 -->
<g id="edge853" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_2_gpu_12</title>
<path fill="none" stroke="black" d="M3201.49,-705.52C3248.96,-695.39 3303.21,-682.93 3352,-669.54 3503.22,-628.05 3676.28,-568.08 3774.01,-533.02"/>
<polygon fill="black" stroke="black" points="3775.3,-536.28 3783.52,-529.61 3772.93,-529.69 3775.3,-536.28"/>
</g>
<!-- expert_layer_3_expert_3_gpu_12 -->
<g id="node180" class="node">
<title>expert_layer_3_expert_3_gpu_12</title>
<polygon fill="#ff0000" stroke="black" points="4296,-529.54 4012,-529.54 4012,-477.54 4296,-477.54 4296,-529.54"/>
<text text-anchor="middle" x="4154" y="-517.54" font-family="Arial" font-size="10.00">Expert3</text>
<text text-anchor="middle" x="4154" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4154" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4154" y="-484.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_3_gpu_12 -->
<g id="edge855" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_3_gpu_12</title>
<path fill="none" stroke="black" d="M3217.35,-715.23C3304.57,-704.79 3418.23,-689.28 3518,-669.54 3713.02,-630.95 3937.27,-568.43 4060.57,-532.45"/>
<polygon fill="black" stroke="black" points="4061.75,-535.75 4070.36,-529.59 4059.78,-529.03 4061.75,-535.75"/>
</g>
<!-- expert_layer_3_expert_4_gpu_13 -->
<g id="node181" class="node">
<title>expert_layer_3_expert_4_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="4598,-529.54 4314,-529.54 4314,-477.54 4598,-477.54 4598,-529.54"/>
<text text-anchor="middle" x="4456" y="-517.54" font-family="Arial" font-size="10.00">Expert4</text>
<text text-anchor="middle" x="4456" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4456" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4456" y="-484.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_4_gpu_13 -->
<g id="edge857" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_4_gpu_13</title>
<path fill="none" stroke="black" d="M3217.3,-722.86C3351.43,-714.34 3557.74,-697.88 3735,-669.54 3958.51,-633.8 4216.05,-569.05 4354.79,-532.18"/>
<polygon fill="black" stroke="black" points="4355.81,-535.53 4364.58,-529.58 4354.01,-528.77 4355.81,-535.53"/>
</g>
<!-- expert_layer_3_expert_5_gpu_13 -->
<g id="node182" class="node">
<title>expert_layer_3_expert_5_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="4900,-529.54 4616,-529.54 4616,-477.54 4900,-477.54 4900,-529.54"/>
<text text-anchor="middle" x="4758" y="-517.54" font-family="Arial" font-size="10.00">Expert5</text>
<text text-anchor="middle" x="4758" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4758" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4758" y="-484.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_5_gpu_13 -->
<g id="edge859" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_5_gpu_13</title>
<path fill="none" stroke="black" d="M3217.27,-727.2C3396.23,-721.57 3712.63,-706.88 3981,-669.54 4223.34,-635.82 4502.99,-569.59 4651.82,-532.1"/>
<polygon fill="black" stroke="black" points="4653.03,-535.41 4661.87,-529.56 4651.32,-528.62 4653.03,-535.41"/>
</g>
<!-- expert_layer_3_expert_6_gpu_13 -->
<g id="node183" class="node">
<title>expert_layer_3_expert_6_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="5202,-529.54 4918,-529.54 4918,-477.54 5202,-477.54 5202,-529.54"/>
<text text-anchor="middle" x="5060" y="-517.54" font-family="Arial" font-size="10.00">Expert6</text>
<text text-anchor="middle" x="5060" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5060" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5060" y="-484.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_6_gpu_13 -->
<g id="edge861" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_6_gpu_13</title>
<path fill="none" stroke="black" d="M3217.43,-729.88C3438.32,-727.33 3876.48,-716.19 4245,-669.54 4500.24,-637.23 4795.07,-569.94 4950.68,-532.03"/>
<polygon fill="black" stroke="black" points="4951.84,-535.35 4960.73,-529.58 4950.18,-528.55 4951.84,-535.35"/>
</g>
<!-- expert_layer_3_expert_7_gpu_13 -->
<g id="node184" class="node">
<title>expert_layer_3_expert_7_gpu_13</title>
<polygon fill="#ff3232" stroke="black" points="672,-529.54 388,-529.54 388,-477.54 672,-477.54 672,-529.54"/>
<text text-anchor="middle" x="530" y="-517.54" font-family="Arial" font-size="10.00">Expert7</text>
<text text-anchor="middle" x="530" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="530" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="530" y="-484.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_7_gpu_13 -->
<g id="edge863" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_7_gpu_13</title>
<path fill="none" stroke="black" d="M2932.77,-729.24C2489.04,-724.81 1148.22,-708.33 956,-669.54 818.72,-641.83 668.15,-573.85 587.93,-534.33"/>
<polygon fill="black" stroke="black" points="589.02,-530.96 578.51,-529.66 585.91,-537.24 589.02,-530.96"/>
</g>
<!-- expert_layer_3_expert_8_gpu_14 -->
<g id="node185" class="node">
<title>expert_layer_3_expert_8_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="974,-529.54 690,-529.54 690,-477.54 974,-477.54 974,-529.54"/>
<text text-anchor="middle" x="832" y="-517.54" font-family="Arial" font-size="10.00">Expert8</text>
<text text-anchor="middle" x="832" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="832" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="832" y="-484.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_8_gpu_14 -->
<g id="edge865" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_8_gpu_14</title>
<path fill="none" stroke="black" d="M2932.96,-728.51C2533.71,-722.41 1419.96,-702.63 1258,-669.54 1120.79,-641.5 970.19,-573.65 889.95,-534.24"/>
<polygon fill="black" stroke="black" points="891.04,-530.87 880.52,-529.58 887.94,-537.15 891.04,-530.87"/>
</g>
<!-- expert_layer_3_expert_9_gpu_14 -->
<g id="node186" class="node">
<title>expert_layer_3_expert_9_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="1276,-529.54 992,-529.54 992,-477.54 1276,-477.54 1276,-529.54"/>
<text text-anchor="middle" x="1134" y="-517.54" font-family="Arial" font-size="10.00">Expert9</text>
<text text-anchor="middle" x="1134" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1134" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1134" y="-484.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_9_gpu_14 -->
<g id="edge867" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_9_gpu_14</title>
<path fill="none" stroke="black" d="M2932.85,-730.78C2607.87,-730.35 1818.65,-723.6 1559,-669.54 1422.36,-641.09 1272.32,-573.55 1192.16,-534.27"/>
<polygon fill="black" stroke="black" points="1193.26,-530.9 1182.74,-529.62 1190.16,-537.18 1193.26,-530.9"/>
</g>
<!-- expert_layer_3_expert_10_gpu_14 -->
<g id="node187" class="node">
<title>expert_layer_3_expert_10_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="1578,-529.54 1294,-529.54 1294,-477.54 1578,-477.54 1578,-529.54"/>
<text text-anchor="middle" x="1436" y="-517.54" font-family="Arial" font-size="10.00">Expert10</text>
<text text-anchor="middle" x="1436" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1436" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1436" y="-484.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_10_gpu_14 -->
<g id="edge869" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_10_gpu_14</title>
<path fill="none" stroke="black" d="M2932.86,-729.14C2657.15,-725.49 2059.15,-712.71 1858,-669.54 1722.56,-640.47 1573.78,-573.32 1494.09,-534.24"/>
<polygon fill="black" stroke="black" points="1495.24,-530.9 1484.72,-529.61 1492.14,-537.18 1495.24,-530.9"/>
</g>
<!-- expert_layer_3_expert_11_gpu_14 -->
<g id="node188" class="node">
<title>expert_layer_3_expert_11_gpu_14</title>
<polygon fill="#ff6464" stroke="black" points="1880,-529.54 1596,-529.54 1596,-477.54 1880,-477.54 1880,-529.54"/>
<text text-anchor="middle" x="1738" y="-517.54" font-family="Arial" font-size="10.00">Expert11</text>
<text text-anchor="middle" x="1738" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1738" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="1738" y="-484.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_11_gpu_14 -->
<g id="edge871" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_11_gpu_14</title>
<path fill="none" stroke="black" d="M2932.72,-726.62C2711.33,-719.6 2294.78,-702.43 2150,-669.54 2018.05,-639.56 1873.26,-573.07 1795.33,-534.26"/>
<polygon fill="black" stroke="black" points="1796.67,-531.02 1786.16,-529.67 1793.54,-537.28 1796.67,-531.02"/>
</g>
<!-- expert_layer_3_expert_12_gpu_15 -->
<g id="node189" class="node">
<title>expert_layer_3_expert_12_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2182,-529.54 1898,-529.54 1898,-477.54 2182,-477.54 2182,-529.54"/>
<text text-anchor="middle" x="2040" y="-517.54" font-family="Arial" font-size="10.00">Expert12</text>
<text text-anchor="middle" x="2040" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2040" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2040" y="-484.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_12_gpu_15 -->
<g id="edge873" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_12_gpu_15</title>
<path fill="none" stroke="black" d="M2932.98,-730.25C2798.6,-726.97 2592.23,-714.08 2419,-669.54 2297.53,-638.31 2165.26,-572.81 2093.56,-534.4"/>
<polygon fill="black" stroke="black" points="2095.17,-531.28 2084.7,-529.62 2091.84,-537.45 2095.17,-531.28"/>
</g>
<!-- expert_layer_3_expert_13_gpu_15 -->
<g id="node190" class="node">
<title>expert_layer_3_expert_13_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2484,-529.54 2200,-529.54 2200,-477.54 2484,-477.54 2484,-529.54"/>
<text text-anchor="middle" x="2342" y="-517.54" font-family="Arial" font-size="10.00">Expert13</text>
<text text-anchor="middle" x="2342" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2342" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2342" y="-484.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_13_gpu_15 -->
<g id="edge875" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_13_gpu_15</title>
<path fill="none" stroke="black" d="M2932.82,-728.26C2836.87,-722.89 2708.77,-708.14 2602,-669.54 2515.5,-638.27 2427.83,-574.51 2379.64,-536.05"/>
<polygon fill="black" stroke="black" points="2381.66,-533.18 2371.68,-529.64 2377.27,-538.64 2381.66,-533.18"/>
</g>
<!-- expert_layer_3_expert_14_gpu_15 -->
<g id="node191" class="node">
<title>expert_layer_3_expert_14_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="2786,-529.54 2502,-529.54 2502,-477.54 2786,-477.54 2786,-529.54"/>
<text text-anchor="middle" x="2644" y="-517.54" font-family="Arial" font-size="10.00">Expert14</text>
<text text-anchor="middle" x="2644" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2644" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2644" y="-484.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_14_gpu_15 -->
<g id="edge877" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_14_gpu_15</title>
<path fill="none" stroke="black" d="M2932.79,-720.61C2808.36,-710.43 2644.34,-692.82 2624,-669.54 2592.8,-633.84 2609.89,-575.99 2626.14,-539.13"/>
<polygon fill="black" stroke="black" points="2629.44,-540.33 2630.44,-529.79 2623.08,-537.41 2629.44,-540.33"/>
</g>
<!-- expert_layer_3_expert_15_gpu_15 -->
<g id="node192" class="node">
<title>expert_layer_3_expert_15_gpu_15</title>
<polygon fill="#ff9696" stroke="black" points="3088,-529.54 2804,-529.54 2804,-477.54 3088,-477.54 3088,-529.54"/>
<text text-anchor="middle" x="2946" y="-517.54" font-family="Arial" font-size="10.00">Expert15</text>
<text text-anchor="middle" x="2946" y="-506.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2946" y="-495.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2946" y="-484.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- ln2_layer_3&#45;&gt;expert_layer_3_expert_15_gpu_15 -->
<g id="edge879" class="edge">
<title>ln2_layer_3&#45;&gt;expert_layer_3_expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M3175.64,-705.51C3192.4,-696.84 3207.66,-685.19 3218,-669.54 3243.48,-630.97 3246.89,-601.62 3218,-565.54 3209.48,-554.89 3155.72,-541.79 3098.21,-530.47"/>
<polygon fill="black" stroke="black" points="3098.69,-526.99 3088.2,-528.52 3097.35,-533.87 3098.69,-526.99"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_0_gpu_12 -->
<g id="edge848" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_0_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3070.15,-565.46C3102.83,-554.26 3136.29,-542.8 3165.24,-532.88"/>
<polygon fill="red" stroke="red" points="3166.56,-536.13 3174.88,-529.58 3164.29,-529.51 3166.56,-536.13"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_1_gpu_12 -->
<g id="edge850" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_1_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3111,-582.71C3203.46,-566.24 3313.03,-546.73 3399.58,-531.32"/>
<polygon fill="red" stroke="red" points="3400.25,-534.76 3409.48,-529.56 3399.02,-527.87 3400.25,-534.76"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_2_gpu_12 -->
<g id="edge852" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_2_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3127.06,-596.56C3281.91,-580.84 3499.45,-557.22 3699.64,-529.7"/>
<polygon fill="red" stroke="red" points="3700.34,-533.14 3709.77,-528.3 3699.38,-526.2 3700.34,-533.14"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_3_gpu_12 -->
<g id="edge854" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_3_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3135.81,-604.59C3352.18,-591.32 3695.66,-566.88 4001.82,-529.64"/>
<polygon fill="red" stroke="red" points="4002.28,-533.11 4011.78,-528.43 4001.43,-526.17 4002.28,-533.11"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_4_gpu_13 -->
<g id="edge856" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_4_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3141.53,-609.57C3412.95,-599.42 3887.93,-576.54 4303.67,-529.64"/>
<polygon fill="red" stroke="red" points="4304.25,-533.1 4313.79,-528.5 4303.46,-526.14 4304.25,-533.1"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_5_gpu_13 -->
<g id="edge858" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_5_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3145.27,-612.98C3466.87,-606.08 4077.59,-586.25 4605.69,-529.63"/>
<polygon fill="red" stroke="red" points="4606.23,-533.09 4615.8,-528.54 4605.48,-526.13 4606.23,-533.09"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_6_gpu_13 -->
<g id="edge860" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_6_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3148.24,-615.47C3516.22,-611.76 4265.23,-596 4907.41,-529.65"/>
<polygon fill="red" stroke="red" points="4908.22,-533.09 4917.8,-528.57 4907.49,-526.12 4908.22,-533.09"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_7_gpu_13 -->
<g id="edge862" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_7_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2690.98,-617.09C2286.23,-615.95 1420.4,-604.11 682.24,-529.61"/>
<polygon fill="red" stroke="red" points="682.5,-526.12 672.2,-528.59 681.79,-533.08 682.5,-526.12"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_8_gpu_14 -->
<g id="edge864" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_8_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2688.39,-615.04C2325.86,-610.7 1604.2,-594.03 984.23,-529.61"/>
<polygon fill="red" stroke="red" points="984.51,-526.12 974.2,-528.57 983.78,-533.09 984.51,-526.12"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_9_gpu_14 -->
<g id="edge866" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_9_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2685.31,-612.21C2368.89,-604.53 1789.29,-583.96 1286.21,-529.62"/>
<polygon fill="red" stroke="red" points="1286.52,-526.13 1276.2,-528.53 1285.77,-533.09 1286.52,-526.13"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_10_gpu_14 -->
<g id="edge868" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_10_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2680.58,-608.03C2415.27,-596.98 1975.6,-573.8 1588.21,-529.63"/>
<polygon fill="red" stroke="red" points="1588.54,-526.15 1578.21,-528.49 1587.75,-533.1 1588.54,-526.15"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_11_gpu_14 -->
<g id="edge870" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_11_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2673.06,-601.22C2466.21,-587.13 2163.57,-563.44 1890.33,-529.67"/>
<polygon fill="red" stroke="red" points="1890.57,-526.17 1880.22,-528.41 1889.71,-533.12 1890.57,-526.17"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_12_gpu_15 -->
<g id="edge872" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_12_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2657.92,-588.11C2521.74,-572.67 2352.57,-552.37 2192.29,-529.7"/>
<polygon fill="red" stroke="red" points="2192.63,-526.21 2182.24,-528.27 2191.65,-533.14 2192.63,-526.21"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_13_gpu_15 -->
<g id="edge874" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_13_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2657.34,-565.54C2596.63,-553.79 2534.39,-541.75 2481.42,-531.51"/>
<polygon fill="red" stroke="red" points="2481.78,-528.01 2471.29,-529.55 2480.45,-534.88 2481.78,-528.01"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_14_gpu_15 -->
<g id="edge876" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_14_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2794.66,-565.46C2767.45,-554.45 2739.61,-543.2 2715.38,-533.4"/>
<polygon fill="red" stroke="red" points="2716.52,-530.09 2705.94,-529.58 2713.9,-536.58 2716.52,-530.09"/>
</g>
<!-- gate_layer_3&#45;&gt;expert_layer_3_expert_15_gpu_15 -->
<g id="edge878" class="edge">
<title>gate_layer_3&#45;&gt;expert_layer_3_expert_15_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2932.4,-565.46C2934.36,-556.69 2936.35,-547.77 2938.18,-539.55"/>
<polygon fill="red" stroke="red" points="2941.65,-540.1 2940.41,-529.58 2934.82,-538.58 2941.65,-540.1"/>
</g>
<!-- expert_agg_layer_3 -->
<g id="node193" class="node">
<title>expert_agg_layer_3</title>
<polygon fill="#ffcccc" stroke="black" points="3252.76,-441.54 2764.77,-441.54 2639.24,-337.54 3127.23,-337.54 3252.76,-441.54"/>
<text text-anchor="middle" x="2946" y="-403.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2946" y="-392.54" font-family="Arial" font-size="10.00">Input: [16Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2946" y="-381.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2946" y="-370.54" font-family="Arial" font-size="10.00">GPU: all MoE GPUs</text>
</g>
<!-- expert_layer_3_expert_0_gpu_12&#45;&gt;expert_agg_layer_3 -->
<g id="edge880" class="edge">
<title>expert_layer_3_expert_0_gpu_12&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M3180.23,-477.4C3154.3,-467.79 3123.61,-456.41 3093.14,-445.11"/>
<polygon fill="black" stroke="black" points="3094.29,-441.8 3083.69,-441.6 3091.85,-448.36 3094.29,-441.8"/>
</g>
<!-- expert_layer_3_expert_1_gpu_12&#45;&gt;expert_agg_layer_3 -->
<g id="edge881" class="edge">
<title>expert_layer_3_expert_1_gpu_12&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M3414.83,-477.47C3360.25,-467.35 3295.08,-455.27 3230.94,-443.38"/>
<polygon fill="black" stroke="black" points="3231.54,-439.93 3221.07,-441.55 3230.27,-446.81 3231.54,-439.93"/>
</g>
<!-- expert_layer_3_expert_2_gpu_12&#45;&gt;expert_agg_layer_3 -->
<g id="edge882" class="edge">
<title>expert_layer_3_expert_2_gpu_12&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M3709.77,-478.79C3706.82,-478.36 3703.89,-477.95 3701,-477.54 3548.04,-456.08 3377.09,-436.05 3236.6,-420.64"/>
<polygon fill="black" stroke="black" points="3236.85,-417.14 3226.53,-419.53 3236.09,-424.1 3236.85,-417.14"/>
</g>
<!-- expert_layer_3_expert_3_gpu_12&#45;&gt;expert_agg_layer_3 -->
<g id="edge883" class="edge">
<title>expert_layer_3_expert_3_gpu_12&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M4011.78,-478.66C4008.83,-478.27 4005.9,-477.9 4003,-477.54 3738.02,-444.75 3434.08,-421.2 3220.34,-406.93"/>
<polygon fill="black" stroke="black" points="3220.44,-403.43 3210.23,-406.26 3219.98,-410.41 3220.44,-403.43"/>
</g>
<!-- expert_layer_3_expert_4_gpu_13&#45;&gt;expert_agg_layer_3 -->
<g id="edge884" class="edge">
<title>expert_layer_3_expert_4_gpu_13&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M4313.79,-478.59C4310.84,-478.22 4307.9,-477.87 4305,-477.54 3926.66,-434.22 3486.42,-410.97 3211.95,-399.69"/>
<polygon fill="black" stroke="black" points="3211.98,-396.18 3201.85,-399.27 3211.7,-403.18 3211.98,-396.18"/>
</g>
<!-- expert_layer_3_expert_5_gpu_13&#45;&gt;expert_agg_layer_3 -->
<g id="edge885" class="edge">
<title>expert_layer_3_expert_5_gpu_13&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M4615.8,-478.54C4612.84,-478.19 4609.91,-477.85 4607,-477.54 4113.86,-423.97 3534.63,-403.12 3206.9,-395.2"/>
<polygon fill="black" stroke="black" points="3206.87,-391.7 3196.79,-394.96 3206.7,-398.69 3206.87,-391.7"/>
</g>
<!-- expert_layer_3_expert_6_gpu_13&#45;&gt;expert_agg_layer_3 -->
<g id="edge886" class="edge">
<title>expert_layer_3_expert_6_gpu_13&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M4917.8,-478.51C4914.84,-478.17 4911.91,-477.84 4909,-477.54 4299.6,-413.82 3579.02,-396.69 3203.25,-392.13"/>
<polygon fill="black" stroke="black" points="3203.1,-388.63 3193.06,-392.01 3203.02,-395.63 3203.1,-388.63"/>
</g>
<!-- expert_layer_3_expert_7_gpu_13&#45;&gt;expert_agg_layer_3 -->
<g id="edge887" class="edge">
<title>expert_layer_3_expert_7_gpu_13&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M672.2,-478.49C675.16,-478.15 678.09,-477.83 681,-477.54 1408.19,-403.67 2272.5,-391.19 2692.15,-389.91"/>
<polygon fill="black" stroke="black" points="2692.3,-393.41 2702.29,-389.88 2692.28,-386.41 2692.3,-393.41"/>
</g>
<!-- expert_layer_3_expert_8_gpu_14&#45;&gt;expert_agg_layer_3 -->
<g id="edge888" class="edge">
<title>expert_layer_3_expert_8_gpu_14&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M974.2,-478.51C977.16,-478.17 980.09,-477.84 983,-477.54 1595.55,-413.49 2320.44,-396.51 2694.55,-392.07"/>
<polygon fill="black" stroke="black" points="2694.73,-395.56 2704.69,-391.95 2694.65,-388.56 2694.73,-395.56"/>
</g>
<!-- expert_layer_3_expert_9_gpu_14&#45;&gt;expert_agg_layer_3 -->
<g id="edge889" class="edge">
<title>expert_layer_3_expert_9_gpu_14&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M1276.2,-478.54C1279.16,-478.19 1282.09,-477.85 1285,-477.54 1784.72,-423.26 2372.82,-402.57 2698.07,-394.89"/>
<polygon fill="black" stroke="black" points="2698.18,-398.39 2708.09,-394.65 2698.01,-391.39 2698.18,-398.39"/>
</g>
<!-- expert_layer_3_expert_10_gpu_14&#45;&gt;expert_agg_layer_3 -->
<g id="edge890" class="edge">
<title>expert_layer_3_expert_10_gpu_14&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M1578.21,-478.59C1581.16,-478.22 1584.1,-477.87 1587,-477.54 1975.78,-433.02 2429.93,-409.7 2702.39,-398.78"/>
<polygon fill="black" stroke="black" points="2702.56,-402.28 2712.41,-398.38 2702.28,-395.28 2702.56,-402.28"/>
</g>
<!-- expert_layer_3_expert_11_gpu_14&#45;&gt;expert_agg_layer_3 -->
<g id="edge891" class="edge">
<title>expert_layer_3_expert_11_gpu_14&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M1880.22,-478.66C1883.17,-478.27 1886.1,-477.9 1889,-477.54 2169.84,-442.79 2494.43,-418.41 2709.02,-404.47"/>
<polygon fill="black" stroke="black" points="2709.4,-407.95 2719.16,-403.81 2708.95,-400.97 2709.4,-407.95"/>
</g>
<!-- expert_layer_3_expert_12_gpu_15&#45;&gt;expert_agg_layer_3 -->
<g id="edge892" class="edge">
<title>expert_layer_3_expert_12_gpu_15&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M2182.23,-478.79C2185.18,-478.36 2188.11,-477.95 2191,-477.54 2368.06,-452.7 2569.23,-429.78 2719.36,-413.7"/>
<polygon fill="black" stroke="black" points="2720.06,-417.15 2729.63,-412.61 2719.31,-410.19 2720.06,-417.15"/>
</g>
<!-- expert_layer_3_expert_13_gpu_15&#45;&gt;expert_agg_layer_3 -->
<g id="edge893" class="edge">
<title>expert_layer_3_expert_13_gpu_15&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M2477.17,-477.47C2553.77,-463.27 2651.23,-445.2 2737.42,-429.22"/>
<polygon fill="black" stroke="black" points="2738.14,-432.64 2747.34,-427.38 2736.87,-425.76 2738.14,-432.64"/>
</g>
<!-- expert_layer_3_expert_14_gpu_15&#45;&gt;expert_agg_layer_3 -->
<g id="edge894" class="edge">
<title>expert_layer_3_expert_14_gpu_15&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M2711.77,-477.4C2737.7,-467.79 2768.39,-456.41 2798.86,-445.11"/>
<polygon fill="black" stroke="black" points="2800.15,-448.36 2808.31,-441.6 2797.71,-441.8 2800.15,-448.36"/>
</g>
<!-- expert_layer_3_expert_15_gpu_15&#45;&gt;expert_agg_layer_3 -->
<g id="edge895" class="edge">
<title>expert_layer_3_expert_15_gpu_15&#45;&gt;expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M2946,-477.4C2946,-469.72 2946,-460.91 2946,-451.91"/>
<polygon fill="black" stroke="black" points="2949.5,-451.72 2946,-441.72 2942.5,-451.72 2949.5,-451.72"/>
</g>
<!-- expert_agg_layer_3&#45;&gt;residual2_layer_3 -->
<g id="edge896" class="edge">
<title>expert_agg_layer_3&#45;&gt;residual2_layer_3</title>
<path fill="none" stroke="black" d="M3153.81,-359.48C3319.59,-336.3 3550.98,-303.95 3718.5,-280.53"/>
<polygon fill="black" stroke="black" points="3719.01,-283.99 3728.43,-279.14 3718.04,-277.06 3719.01,-283.99"/>
</g>
<!-- final_layernorm -->
<g id="node195" class="node">
<title>final_layernorm</title>
<polygon fill="#0080ff" stroke="black" points="4075,-161.54 3791,-161.54 3791,-109.54 4075,-109.54 4075,-161.54"/>
<text text-anchor="middle" x="3933" y="-149.54" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="3933" y="-138.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3933" y="-127.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3933" y="-116.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- residual2_layer_3&#45;&gt;final_layernorm -->
<g id="edge898" class="edge">
<title>residual2_layer_3&#45;&gt;final_layernorm</title>
<path fill="none" stroke="black" d="M3933,-197.46C3933,-188.79 3933,-179.97 3933,-171.82"/>
<polygon fill="black" stroke="black" points="3936.5,-171.58 3933,-161.58 3929.5,-171.58 3936.5,-171.58"/>
</g>
<!-- output -->
<g id="node196" class="node">
<title>output</title>
<ellipse fill="#e6f3ff" stroke="black" cx="3933" cy="-36.77" rx="202.88" ry="36.54"/>
<text text-anchor="middle" x="3933" y="-50.77" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="3933" y="-39.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3933" y="-28.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, vocab_size=50265]</text>
<text text-anchor="middle" x="3933" y="-17.77" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- final_layernorm&#45;&gt;output -->
<g id="edge899" class="edge">
<title>final_layernorm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3933,-109.37C3933,-101.56 3933,-92.69 3933,-83.92"/>
<polygon fill="black" stroke="black" points="3936.5,-83.75 3933,-73.75 3929.5,-83.75 3936.5,-83.75"/>
</g>
</g>
</svg>
