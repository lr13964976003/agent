<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_hybrid_tp_pp_dag Pages: 1 -->
<svg width="1440pt" height="1303pt"
 viewBox="0.00 0.00 1440.00 1303.46" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.23 0.23) rotate(0) translate(4 5685.08)">
<title>baseline_hybrid_tp_pp_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-5685.08 6281,-5685.08 6281,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage_0</title>
<polygon fill="none" stroke="orange" stroke-dasharray="1,5" points="8,-2863.54 8,-5491.54 5002,-5491.54 5002,-2863.54 8,-2863.54"/>
<text text-anchor="middle" x="2505" y="-5476.34" font-family="Times,serif" font-size="14.00">Stage 0 (GPUs 0&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage0_layer_0</title>
<polygon fill="none" stroke="orange" stroke-dasharray="5,2" points="16,-4175.54 16,-5460.54 4994,-5460.54 4994,-4175.54 16,-4175.54"/>
<text text-anchor="middle" x="2505" y="-5445.34" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage0_layer_1</title>
<polygon fill="none" stroke="orange" stroke-dasharray="5,2" points="16,-2871.54 16,-4156.54 4994,-4156.54 4994,-2871.54 16,-2871.54"/>
<text text-anchor="middle" x="2505" y="-4141.34" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage_1</title>
<polygon fill="none" stroke="purple" stroke-dasharray="1,5" points="1275,-189.54 1275,-2817.54 6269,-2817.54 6269,-189.54 1275,-189.54"/>
<text text-anchor="middle" x="3772" y="-2802.34" font-family="Times,serif" font-size="14.00">Stage 1 (GPUs 8&#45;15)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_stage1_layer_2</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="1283,-1501.54 1283,-2786.54 6261,-2786.54 6261,-1501.54 1283,-1501.54"/>
<text text-anchor="middle" x="3772" y="-2771.34" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_stage1_layer_3</title>
<polygon fill="none" stroke="purple" stroke-dasharray="5,2" points="1283,-197.54 1283,-1482.54 6261,-1482.54 6261,-197.54 1283,-197.54"/>
<text text-anchor="middle" x="3772" y="-1467.34" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="#e6f3ff" stroke="black" cx="3419" cy="-5644.31" rx="200.64" ry="36.54"/>
<text text-anchor="middle" x="3419" y="-5658.31" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="3419" y="-5647.31" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048]</text>
<text text-anchor="middle" x="3419" y="-5636.31" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3419" y="-5625.31" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- embedding -->
<g id="node2" class="node">
<title>embedding</title>
<polygon fill="#ff0080" stroke="black" points="3561,-5570.54 3277,-5570.54 3277,-5518.54 3561,-5518.54 3561,-5570.54"/>
<text text-anchor="middle" x="3419" y="-5558.54" font-family="Arial" font-size="10.00">Embedding</text>
<text text-anchor="middle" x="3419" y="-5547.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048]</text>
<text text-anchor="middle" x="3419" y="-5536.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3419" y="-5525.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;embedding -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embedding</title>
<path fill="none" stroke="black" d="M3419,-5607.46C3419,-5598.78 3419,-5589.51 3419,-5580.85"/>
<polygon fill="black" stroke="black" points="3422.5,-5580.69 3419,-5570.69 3415.5,-5580.69 3422.5,-5580.69"/>
</g>
<!-- stage0_ln1_layer_0 -->
<g id="node3" class="node">
<title>stage0_ln1_layer_0</title>
<polygon fill="#ff0080" stroke="black" points="3002,-5429.54 2718,-5429.54 2718,-5377.54 3002,-5377.54 3002,-5429.54"/>
<text text-anchor="middle" x="2860" y="-5417.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2860" y="-5406.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2860" y="-5395.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2860" y="-5384.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (sharded)</text>
</g>
<!-- embedding&#45;&gt;stage0_ln1_layer_0 -->
<g id="edge2" class="edge">
<title>embedding&#45;&gt;stage0_ln1_layer_0</title>
<path fill="none" stroke="black" d="M3318.42,-5518.53C3220.46,-5494.17 3071.93,-5457.24 2970.67,-5432.06"/>
<polygon fill="black" stroke="black" points="2971.27,-5428.6 2960.72,-5429.58 2969.58,-5435.39 2971.27,-5428.6"/>
</g>
<!-- stage0_residual1_layer_0 -->
<g id="node22" class="node">
<title>stage0_residual1_layer_0</title>
<polygon fill="#ffffcc" stroke="black" points="4113.82,-4888.54 3635.28,-4888.54 3512.18,-4784.54 3990.72,-4784.54 4113.82,-4888.54"/>
<text text-anchor="middle" x="3813" y="-4850.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="3813" y="-4839.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3813" y="-4828.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3813" y="-4817.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (all&#45;reduce)</text>
</g>
<!-- embedding&#45;&gt;stage0_residual1_layer_0 -->
<g id="edge85" class="edge">
<title>embedding&#45;&gt;stage0_residual1_layer_0</title>
<path fill="none" stroke="black" d="M3561.14,-5536.16C3726.76,-5523.58 3978,-5490.35 3978,-5404.54 3978,-5404.54 3978,-5404.54 3978,-4950.54 3978,-4928.46 3967.82,-4910.38 3952.51,-4895.67"/>
<polygon fill="black" stroke="black" points="3954.43,-4892.69 3944.61,-4888.71 3949.81,-4897.95 3954.43,-4892.69"/>
</g>
<!-- stage0_qkv_layer_0_gpu_0 -->
<g id="node4" class="node">
<title>stage0_qkv_layer_0_gpu_0</title>
<polygon fill="#ff0080" stroke="black" points="3636,-5340.54 3340,-5340.54 3340,-5266.54 3636,-5266.54 3636,-5340.54"/>
<text text-anchor="middle" x="3488" y="-5328.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3488" y="-5317.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3488" y="-5306.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3488" y="-5295.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3488" y="-5284.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3488" y="-5273.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_0 -->
<g id="edge3" class="edge">
<title>stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_0</title>
<path fill="none" stroke="black" d="M3002.24,-5387.36C3093.31,-5376.8 3214.15,-5361.22 3329.66,-5340.73"/>
<polygon fill="black" stroke="black" points="3330.52,-5344.13 3339.74,-5338.93 3329.28,-5337.24 3330.52,-5344.13"/>
</g>
<!-- stage0_qkv_layer_0_gpu_1 -->
<g id="node5" class="node">
<title>stage0_qkv_layer_0_gpu_1</title>
<polygon fill="#ff1480" stroke="black" points="2380,-5340.54 2084,-5340.54 2084,-5266.54 2380,-5266.54 2380,-5340.54"/>
<text text-anchor="middle" x="2232" y="-5328.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2232" y="-5317.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2232" y="-5306.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2232" y="-5295.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2232" y="-5284.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2232" y="-5273.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_1 -->
<g id="edge12" class="edge">
<title>stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_1</title>
<path fill="none" stroke="black" d="M2717.76,-5387.36C2626.69,-5376.8 2505.85,-5361.22 2390.34,-5340.73"/>
<polygon fill="black" stroke="black" points="2390.72,-5337.24 2380.26,-5338.93 2389.48,-5344.13 2390.72,-5337.24"/>
</g>
<!-- stage0_qkv_layer_0_gpu_2 -->
<g id="node6" class="node">
<title>stage0_qkv_layer_0_gpu_2</title>
<polygon fill="#ff2880" stroke="black" points="2694,-5340.54 2398,-5340.54 2398,-5266.54 2694,-5266.54 2694,-5340.54"/>
<text text-anchor="middle" x="2546" y="-5328.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2546" y="-5317.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2546" y="-5306.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2546" y="-5295.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2546" y="-5284.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2546" y="-5273.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_2 -->
<g id="edge21" class="edge">
<title>stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_2</title>
<path fill="none" stroke="black" d="M2779.54,-5377.43C2746.6,-5367.15 2707.71,-5355.01 2671.2,-5343.62"/>
<polygon fill="black" stroke="black" points="2672.07,-5340.22 2661.48,-5340.58 2669.98,-5346.9 2672.07,-5340.22"/>
</g>
<!-- stage0_qkv_layer_0_gpu_3 -->
<g id="node7" class="node">
<title>stage0_qkv_layer_0_gpu_3</title>
<polygon fill="#ff3c80" stroke="black" points="2066,-5340.54 1770,-5340.54 1770,-5266.54 2066,-5266.54 2066,-5340.54"/>
<text text-anchor="middle" x="1918" y="-5328.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1918" y="-5317.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1918" y="-5306.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1918" y="-5295.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1918" y="-5284.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1918" y="-5273.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_3 -->
<g id="edge30" class="edge">
<title>stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_3</title>
<path fill="none" stroke="black" d="M2717.82,-5397.58C2562.33,-5390.72 2305.78,-5375.21 2076.43,-5340.69"/>
<polygon fill="black" stroke="black" points="2076.63,-5337.18 2066.22,-5339.13 2075.58,-5344.1 2076.63,-5337.18"/>
</g>
<!-- stage0_qkv_layer_0_gpu_4 -->
<g id="node8" class="node">
<title>stage0_qkv_layer_0_gpu_4</title>
<polygon fill="#ff5080" stroke="black" points="1752,-5340.54 1456,-5340.54 1456,-5266.54 1752,-5266.54 1752,-5340.54"/>
<text text-anchor="middle" x="1604" y="-5328.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="1604" y="-5317.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1604" y="-5306.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1604" y="-5295.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1604" y="-5284.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1604" y="-5273.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_4 -->
<g id="edge39" class="edge">
<title>stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_4</title>
<path fill="none" stroke="black" d="M2717.86,-5402.17C2509.67,-5399.92 2109.76,-5389.11 1762.22,-5340.63"/>
<polygon fill="black" stroke="black" points="1762.6,-5337.15 1752.21,-5339.22 1761.62,-5344.08 1762.6,-5337.15"/>
</g>
<!-- stage0_qkv_layer_0_gpu_5 -->
<g id="node9" class="node">
<title>stage0_qkv_layer_0_gpu_5</title>
<polygon fill="#ff6480" stroke="black" points="3322,-5340.54 3026,-5340.54 3026,-5266.54 3322,-5266.54 3322,-5340.54"/>
<text text-anchor="middle" x="3174" y="-5328.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3174" y="-5317.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3174" y="-5306.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3174" y="-5295.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3174" y="-5284.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3174" y="-5273.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_5 -->
<g id="edge48" class="edge">
<title>stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_5</title>
<path fill="none" stroke="black" d="M2940.46,-5377.43C2973.4,-5367.15 3012.29,-5355.01 3048.8,-5343.62"/>
<polygon fill="black" stroke="black" points="3050.02,-5346.9 3058.52,-5340.58 3047.93,-5340.22 3050.02,-5346.9"/>
</g>
<!-- stage0_qkv_layer_0_gpu_6 -->
<g id="node10" class="node">
<title>stage0_qkv_layer_0_gpu_6</title>
<polygon fill="#ff7880" stroke="black" points="3950,-5340.54 3654,-5340.54 3654,-5266.54 3950,-5266.54 3950,-5340.54"/>
<text text-anchor="middle" x="3802" y="-5328.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3802" y="-5317.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3802" y="-5306.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3802" y="-5295.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3802" y="-5284.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3802" y="-5273.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_6 -->
<g id="edge57" class="edge">
<title>stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_6</title>
<path fill="none" stroke="black" d="M3002.18,-5397.58C3157.67,-5390.72 3414.22,-5375.21 3643.57,-5340.69"/>
<polygon fill="black" stroke="black" points="3644.42,-5344.1 3653.78,-5339.13 3643.37,-5337.18 3644.42,-5344.1"/>
</g>
<!-- stage0_qkv_layer_0_gpu_7 -->
<g id="node11" class="node">
<title>stage0_qkv_layer_0_gpu_7</title>
<polygon fill="#ff8c80" stroke="black" points="3008,-5340.54 2712,-5340.54 2712,-5266.54 3008,-5266.54 3008,-5340.54"/>
<text text-anchor="middle" x="2860" y="-5328.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2860" y="-5317.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2860" y="-5306.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2860" y="-5295.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2860" y="-5284.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2860" y="-5273.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_7 -->
<g id="edge66" class="edge">
<title>stage0_ln1_layer_0&#45;&gt;stage0_qkv_layer_0_gpu_7</title>
<path fill="none" stroke="black" d="M2860,-5377.3C2860,-5369.23 2860,-5360.01 2860,-5350.92"/>
<polygon fill="black" stroke="black" points="2863.5,-5350.77 2860,-5340.77 2856.5,-5350.77 2863.5,-5350.77"/>
</g>
<!-- stage0_attention_layer_0_gpu_0 -->
<g id="node12" class="node">
<title>stage0_attention_layer_0_gpu_0</title>
<polygon fill="#ff0080" stroke="black" points="3618.5,-5229.54 3329.5,-5229.54 3329.5,-5155.54 3618.5,-5155.54 3618.5,-5229.54"/>
<text text-anchor="middle" x="3474" y="-5217.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3474" y="-5206.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3474" y="-5195.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3474" y="-5184.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3474" y="-5173.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3474" y="-5162.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_0 -->
<g id="edge4" class="edge">
<title>stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_0</title>
<path fill="none" stroke="black" d="M3483.34,-5266.24C3482.25,-5257.79 3481.08,-5248.67 3479.95,-5239.84"/>
<polygon fill="black" stroke="black" points="3483.39,-5239.15 3478.64,-5229.68 3476.44,-5240.04 3483.39,-5239.15"/>
</g>
<!-- stage0_attention_layer_0_gpu_1 -->
<g id="node13" class="node">
<title>stage0_attention_layer_0_gpu_1</title>
<polygon fill="#ff1480" stroke="black" points="3004.5,-5229.54 2715.5,-5229.54 2715.5,-5155.54 3004.5,-5155.54 3004.5,-5229.54"/>
<text text-anchor="middle" x="2860" y="-5217.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2860" y="-5206.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2860" y="-5195.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2860" y="-5184.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2860" y="-5173.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2860" y="-5162.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_1 -->
<g id="edge14" class="edge">
<title>stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3339.75,-5268.09C3336.81,-5267.56 3333.89,-5267.04 3331,-5266.54 3194.36,-5242.97 3155.47,-5253.45 3014.47,-5229.54"/>
<polygon fill="blue" stroke="blue" points="3015.03,-5226.09 3004.58,-5227.84 3013.84,-5232.99 3015.03,-5226.09"/>
</g>
<!-- stage0_attention_layer_0_gpu_2 -->
<g id="node14" class="node">
<title>stage0_attention_layer_0_gpu_2</title>
<polygon fill="#ff2880" stroke="black" points="3311.5,-5229.54 3022.5,-5229.54 3022.5,-5155.54 3311.5,-5155.54 3311.5,-5229.54"/>
<text text-anchor="middle" x="3167" y="-5217.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3167" y="-5206.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3167" y="-5195.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3167" y="-5184.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3167" y="-5173.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3167" y="-5162.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_2 -->
<g id="edge23" class="edge">
<title>stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3381.56,-5266.4C3349.83,-5255.62 3314.92,-5243.77 3282.63,-5232.8"/>
<polygon fill="blue" stroke="blue" points="3283.75,-5229.49 3273.15,-5229.59 3281.5,-5236.11 3283.75,-5229.49"/>
</g>
<!-- stage0_attention_layer_0_gpu_3 -->
<g id="node15" class="node">
<title>stage0_attention_layer_0_gpu_3</title>
<polygon fill="#ff3c80" stroke="black" points="2083.5,-5229.54 1794.5,-5229.54 1794.5,-5155.54 2083.5,-5155.54 2083.5,-5229.54"/>
<text text-anchor="middle" x="1939" y="-5217.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1939" y="-5206.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1939" y="-5195.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1939" y="-5184.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1939" y="-5173.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1939" y="-5162.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_3 -->
<g id="edge32" class="edge">
<title>stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3339.81,-5267.75C3336.85,-5267.32 3333.91,-5266.91 3331,-5266.54 3197.3,-5249.38 2268.69,-5247.42 2093.53,-5229.37"/>
<polygon fill="blue" stroke="blue" points="2093.86,-5225.88 2083.53,-5228.21 2093.06,-5232.83 2093.86,-5225.88"/>
</g>
<!-- stage0_attention_layer_0_gpu_4 -->
<g id="node16" class="node">
<title>stage0_attention_layer_0_gpu_4</title>
<polygon fill="#ff5080" stroke="black" points="2697.5,-5229.54 2408.5,-5229.54 2408.5,-5155.54 2697.5,-5155.54 2697.5,-5229.54"/>
<text text-anchor="middle" x="2553" y="-5217.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2553" y="-5206.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2553" y="-5195.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2553" y="-5184.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2553" y="-5173.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2553" y="-5162.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_4 -->
<g id="edge41" class="edge">
<title>stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3339.79,-5267.86C3336.84,-5267.4 3333.91,-5266.96 3331,-5266.54 3059.21,-5227.6 2983.69,-5268.54 2707.46,-5229.51"/>
<polygon fill="blue" stroke="blue" points="2707.94,-5226.04 2697.54,-5228.08 2706.95,-5232.97 2707.94,-5226.04"/>
</g>
<!-- stage0_attention_layer_0_gpu_5 -->
<g id="node17" class="node">
<title>stage0_attention_layer_0_gpu_5</title>
<polygon fill="#ff6480" stroke="black" points="1776.5,-5229.54 1487.5,-5229.54 1487.5,-5155.54 1776.5,-5155.54 1776.5,-5229.54"/>
<text text-anchor="middle" x="1632" y="-5217.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1632" y="-5206.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1632" y="-5195.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1632" y="-5184.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="1632" y="-5173.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="1632" y="-5162.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_5 -->
<g id="edge50" class="edge">
<title>stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3339.81,-5267.72C3336.85,-5267.3 3333.91,-5266.9 3331,-5266.54 3163.53,-5245.55 1997.2,-5251.05 1786.63,-5229.39"/>
<polygon fill="blue" stroke="blue" points="1786.86,-5225.89 1776.52,-5228.24 1786.06,-5232.85 1786.86,-5225.89"/>
</g>
<!-- stage0_attention_layer_0_gpu_6 -->
<g id="node18" class="node">
<title>stage0_attention_layer_0_gpu_6</title>
<polygon fill="#ff7880" stroke="black" points="3925.5,-5229.54 3636.5,-5229.54 3636.5,-5155.54 3925.5,-5155.54 3925.5,-5229.54"/>
<text text-anchor="middle" x="3781" y="-5217.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3781" y="-5206.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3781" y="-5195.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3781" y="-5184.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3781" y="-5173.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3781" y="-5162.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_6 -->
<g id="edge59" class="edge">
<title>stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3636.27,-5268.23C3639.2,-5267.65 3642.12,-5267.09 3645,-5266.54 3671.06,-5261.57 3742.76,-5265.69 3763,-5248.54 3766.28,-5245.76 3768.96,-5242.38 3771.16,-5238.67"/>
<polygon fill="blue" stroke="blue" points="3774.36,-5240.09 3775.46,-5229.55 3768.03,-5237.11 3774.36,-5240.09"/>
</g>
<!-- stage0_attention_layer_0_gpu_7 -->
<g id="node19" class="node">
<title>stage0_attention_layer_0_gpu_7</title>
<polygon fill="#ff8c80" stroke="black" points="2390.5,-5229.54 2101.5,-5229.54 2101.5,-5155.54 2390.5,-5155.54 2390.5,-5229.54"/>
<text text-anchor="middle" x="2246" y="-5217.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2246" y="-5206.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2246" y="-5195.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2246" y="-5184.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2246" y="-5173.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2246" y="-5162.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_7 -->
<g id="edge68" class="edge">
<title>stage0_qkv_layer_0_gpu_0&#45;&gt;stage0_attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3339.8,-5267.79C3336.85,-5267.34 3333.91,-5266.93 3331,-5266.54 3128.87,-5239.59 2620.86,-5256.8 2400.49,-5229.46"/>
<polygon fill="blue" stroke="blue" points="2400.9,-5225.98 2390.53,-5228.17 2400,-5232.93 2400.9,-5225.98"/>
</g>
<!-- stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_0 -->
<g id="edge5" class="edge">
<title>stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2380.19,-5267.7C2383.15,-5267.29 2386.09,-5266.9 2389,-5266.54 2593.5,-5241.38 3113.19,-5284.86 3316,-5248.54 3336.02,-5244.95 3356.92,-5239.21 3376.71,-5232.76"/>
<polygon fill="blue" stroke="blue" points="3377.95,-5236.04 3386.32,-5229.55 3375.73,-5229.4 3377.95,-5236.04"/>
</g>
<!-- stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_1 -->
<g id="edge13" class="edge">
<title>stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_1</title>
<path fill="none" stroke="black" d="M2380.21,-5267.85C2383.16,-5267.39 2386.09,-5266.95 2389,-5266.54 2532.24,-5246.3 2572.45,-5278.38 2714,-5248.54 2731.78,-5244.79 2750.26,-5239.23 2767.86,-5233.07"/>
<polygon fill="black" stroke="black" points="2769.32,-5236.26 2777.54,-5229.59 2766.95,-5229.68 2769.32,-5236.26"/>
</g>
<!-- stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_2 -->
<g id="edge24" class="edge">
<title>stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2380.19,-5267.72C2383.15,-5267.3 2386.09,-5266.9 2389,-5266.54 2430.13,-5261.38 3099.31,-5269.64 3135,-5248.54 3139.58,-5245.83 3143.57,-5242.2 3147.02,-5238.08"/>
<polygon fill="blue" stroke="blue" points="3150.06,-5239.86 3153.03,-5229.69 3144.37,-5235.78 3150.06,-5239.86"/>
</g>
<!-- stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_3 -->
<g id="edge33" class="edge">
<title>stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2115.59,-5266.53C2098.53,-5260.78 2081.24,-5254.69 2065,-5248.54 2052.91,-5243.96 2040.29,-5238.85 2027.9,-5233.65"/>
<polygon fill="blue" stroke="blue" points="2029.07,-5230.34 2018.5,-5229.66 2026.34,-5236.78 2029.07,-5230.34"/>
</g>
<!-- stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_4 -->
<g id="edge42" class="edge">
<title>stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2380.25,-5268.13C2383.19,-5267.58 2386.11,-5267.05 2389,-5266.54 2420.54,-5260.95 2506.81,-5268.32 2532,-5248.54 2535.44,-5245.84 2538.31,-5242.51 2540.72,-5238.83"/>
<polygon fill="blue" stroke="blue" points="2543.93,-5240.24 2545.52,-5229.76 2537.75,-5236.96 2543.93,-5240.24"/>
</g>
<!-- stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_5 -->
<g id="edge51" class="edge">
<title>stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2083.78,-5267.92C2080.83,-5267.43 2077.9,-5266.97 2075,-5266.54 1964.83,-5250.04 1934.7,-5267.91 1825,-5248.54 1801.55,-5244.4 1776.87,-5238.55 1753.29,-5232.2"/>
<polygon fill="blue" stroke="blue" points="1754.18,-5228.82 1743.61,-5229.55 1752.33,-5235.57 1754.18,-5228.82"/>
</g>
<!-- stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_6 -->
<g id="edge60" class="edge">
<title>stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2380.19,-5267.68C2383.14,-5267.27 2386.08,-5266.89 2389,-5266.54 2461.87,-5257.79 3640.72,-5272.76 3710,-5248.54 3718.76,-5245.48 3727.28,-5240.87 3735.2,-5235.6"/>
<polygon fill="blue" stroke="blue" points="3737.42,-5238.31 3743.54,-5229.66 3733.36,-5232.61 3737.42,-5238.31"/>
</g>
<!-- stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_7 -->
<g id="edge69" class="edge">
<title>stage0_qkv_layer_0_gpu_1&#45;&gt;stage0_attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2236.66,-5266.24C2237.75,-5257.79 2238.92,-5248.67 2240.05,-5239.84"/>
<polygon fill="blue" stroke="blue" points="2243.56,-5240.04 2241.36,-5229.68 2236.61,-5239.15 2243.56,-5240.04"/>
</g>
<!-- stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_0 -->
<g id="edge6" class="edge">
<title>stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2694.19,-5267.74C2697.15,-5267.31 2700.09,-5266.91 2703,-5266.54 2841.05,-5248.9 3192.49,-5275.59 3329,-5248.54 3347.05,-5244.96 3365.8,-5239.37 3383.58,-5233.11"/>
<polygon fill="blue" stroke="blue" points="3385.15,-5236.26 3393.35,-5229.56 3382.76,-5229.68 3385.15,-5236.26"/>
</g>
<!-- stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_1 -->
<g id="edge15" class="edge">
<title>stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2694.25,-5268.13C2697.19,-5267.58 2700.11,-5267.05 2703,-5266.54 2734.54,-5260.95 2821.99,-5269.74 2846,-5248.54 2849.03,-5245.86 2851.45,-5242.63 2853.37,-5239.1"/>
<polygon fill="blue" stroke="blue" points="2856.63,-5240.39 2857.21,-5229.81 2850.16,-5237.71 2856.63,-5240.39"/>
</g>
<!-- stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_2 -->
<g id="edge22" class="edge">
<title>stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_2</title>
<path fill="none" stroke="black" d="M2694.2,-5267.79C2697.15,-5267.35 2700.09,-5266.93 2703,-5266.54 2752.27,-5259.96 3110.6,-5278.84 3150,-5248.54 3153.43,-5245.9 3156.19,-5242.58 3158.4,-5238.88"/>
<polygon fill="black" stroke="black" points="3161.62,-5240.27 3162.64,-5229.72 3155.26,-5237.33 3161.62,-5240.27"/>
</g>
<!-- stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_3 -->
<g id="edge34" class="edge">
<title>stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2397.78,-5267.91C2394.83,-5267.43 2391.9,-5266.97 2389,-5266.54 2276.18,-5249.74 2245.35,-5268.2 2133,-5248.54 2109.44,-5244.42 2084.63,-5238.57 2060.92,-5232.23"/>
<polygon fill="blue" stroke="blue" points="2061.76,-5228.83 2051.19,-5229.58 2059.92,-5235.58 2061.76,-5228.83"/>
</g>
<!-- stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_4 -->
<g id="edge43" class="edge">
<title>stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2548.33,-5266.24C2548.87,-5257.79 2549.46,-5248.67 2550.03,-5239.84"/>
<polygon fill="blue" stroke="blue" points="2553.53,-5239.88 2550.68,-5229.68 2546.55,-5239.43 2553.53,-5239.88"/>
</g>
<!-- stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_5 -->
<g id="edge52" class="edge">
<title>stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2397.8,-5267.76C2394.85,-5267.33 2391.91,-5266.92 2389,-5266.54 2156.61,-5236.21 2094.24,-5279.95 1862,-5248.54 1832.76,-5244.58 1801.8,-5238.51 1772.41,-5231.83"/>
<polygon fill="blue" stroke="blue" points="1773.03,-5228.38 1762.5,-5229.54 1771.46,-5235.2 1773.03,-5228.38"/>
</g>
<!-- stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_6 -->
<g id="edge61" class="edge">
<title>stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2694.19,-5267.7C2697.15,-5267.28 2700.09,-5266.89 2703,-5266.54 2759.75,-5259.61 3680.04,-5272.39 3732,-5248.54 3738.25,-5245.67 3744.03,-5241.58 3749.27,-5236.91"/>
<polygon fill="blue" stroke="blue" points="3751.89,-5239.25 3756.55,-5229.73 3746.97,-5234.27 3751.89,-5239.25"/>
</g>
<!-- stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_7 -->
<g id="edge70" class="edge">
<title>stage0_qkv_layer_0_gpu_2&#45;&gt;stage0_attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2422.54,-5266.4C2405.12,-5260.73 2387.53,-5254.7 2371,-5248.54 2358.79,-5243.98 2346.05,-5238.85 2333.58,-5233.59"/>
<polygon fill="blue" stroke="blue" points="2334.69,-5230.26 2324.12,-5229.56 2331.94,-5236.7 2334.69,-5230.26"/>
</g>
<!-- stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_0 -->
<g id="edge7" class="edge">
<title>stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2066.19,-5267.69C2069.14,-5267.27 2072.08,-5266.89 2075,-5266.54 2345.73,-5233.88 3032.88,-5292.54 3302,-5248.54 3323.97,-5244.95 3346.98,-5239.12 3368.76,-5232.57"/>
<polygon fill="blue" stroke="blue" points="3369.82,-5235.91 3378.35,-5229.62 3367.76,-5229.21 3369.82,-5235.91"/>
</g>
<!-- stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_1 -->
<g id="edge16" class="edge">
<title>stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2066.19,-5267.74C2069.15,-5267.31 2072.09,-5266.91 2075,-5266.54 2212.6,-5248.95 2562.49,-5273.24 2699,-5248.54 2719.11,-5244.9 2740.1,-5239.21 2760.04,-5232.85"/>
<polygon fill="blue" stroke="blue" points="2761.32,-5236.11 2769.74,-5229.67 2759.14,-5229.46 2761.32,-5236.11"/>
</g>
<!-- stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_2 -->
<g id="edge25" class="edge">
<title>stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2066.19,-5267.7C2069.15,-5267.28 2072.09,-5266.89 2075,-5266.54 2132.2,-5259.56 3058.96,-5271.05 3112,-5248.54 3118.84,-5245.64 3125.27,-5241.44 3131.17,-5236.65"/>
<polygon fill="blue" stroke="blue" points="3133.72,-5239.06 3138.86,-5229.8 3129.06,-5233.84 3133.72,-5239.06"/>
</g>
<!-- stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_3 -->
<g id="edge31" class="edge">
<title>stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_3</title>
<path fill="none" stroke="black" d="M1924.99,-5266.24C1926.64,-5257.69 1928.42,-5248.47 1930.13,-5239.56"/>
<polygon fill="black" stroke="black" points="1933.58,-5240.16 1932.04,-5229.68 1926.71,-5238.83 1933.58,-5240.16"/>
</g>
<!-- stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_4 -->
<g id="edge44" class="edge">
<title>stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2066.2,-5267.79C2069.15,-5267.35 2072.09,-5266.93 2075,-5266.54 2123.72,-5260.02 2474.25,-5272.79 2517,-5248.54 2521.9,-5245.76 2526.25,-5242.01 2530.08,-5237.76"/>
<polygon fill="blue" stroke="blue" points="2533,-5239.71 2536.42,-5229.68 2527.49,-5235.39 2533,-5239.71"/>
</g>
<!-- stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_5 -->
<g id="edge53" class="edge">
<title>stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1808.1,-5266.52C1791.57,-5260.72 1774.78,-5254.62 1759,-5248.54 1746.94,-5243.89 1734.34,-5238.77 1721.96,-5233.57"/>
<polygon fill="blue" stroke="blue" points="1723.13,-5230.26 1712.55,-5229.59 1720.4,-5236.71 1723.13,-5230.26"/>
</g>
<!-- stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_6 -->
<g id="edge62" class="edge">
<title>stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2066.18,-5267.67C2069.14,-5267.26 2072.08,-5266.89 2075,-5266.54 2163.16,-5256.06 3586.79,-5269.74 3673,-5248.54 3686.4,-5245.24 3700.02,-5240.03 3712.87,-5234.09"/>
<polygon fill="blue" stroke="blue" points="3714.59,-5237.15 3722.08,-5229.66 3711.55,-5230.84 3714.59,-5237.15"/>
</g>
<!-- stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_7 -->
<g id="edge71" class="edge">
<title>stage0_qkv_layer_0_gpu_3&#45;&gt;stage0_attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2066.25,-5268.11C2069.19,-5267.57 2072.11,-5267.04 2075,-5266.54 2107.86,-5260.8 2197.56,-5268.86 2224,-5248.54 2227.49,-5245.86 2230.42,-5242.54 2232.89,-5238.87"/>
<polygon fill="blue" stroke="blue" points="2236.12,-5240.26 2237.86,-5229.81 2229.98,-5236.9 2236.12,-5240.26"/>
</g>
<!-- stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_0 -->
<g id="edge8" class="edge">
<title>stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1752.19,-5267.72C1755.15,-5267.3 1758.09,-5266.9 1761,-5266.54 1930.1,-5245.37 3107.77,-5251.35 3319.05,-5229.58"/>
<polygon fill="blue" stroke="blue" points="3319.64,-5233.03 3329.18,-5228.42 3318.85,-5226.08 3319.64,-5233.03"/>
</g>
<!-- stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_1 -->
<g id="edge17" class="edge">
<title>stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1752.2,-5267.78C1755.15,-5267.34 1758.09,-5266.93 1761,-5266.54 1966.39,-5239.22 2482.59,-5257.31 2705.12,-5229.67"/>
<polygon fill="blue" stroke="blue" points="2705.71,-5233.12 2715.17,-5228.36 2704.8,-5226.18 2705.71,-5233.12"/>
</g>
<!-- stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_2 -->
<g id="edge26" class="edge">
<title>stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1752.19,-5267.75C1755.15,-5267.32 1758.09,-5266.91 1761,-5266.54 2034.07,-5231.54 2721.44,-5264.93 3012.01,-5229.68"/>
<polygon fill="blue" stroke="blue" points="3012.69,-5233.12 3022.18,-5228.4 3011.82,-5226.18 3012.69,-5233.12"/>
</g>
<!-- stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_3 -->
<g id="edge35" class="edge">
<title>stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1715.08,-5266.4C1748.19,-5255.62 1784.63,-5243.77 1818.32,-5232.8"/>
<polygon fill="blue" stroke="blue" points="1819.79,-5236.01 1828.22,-5229.59 1817.62,-5229.35 1819.79,-5236.01"/>
</g>
<!-- stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_4 -->
<g id="edge40" class="edge">
<title>stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_4</title>
<path fill="none" stroke="black" d="M1752.21,-5267.86C1755.16,-5267.39 1758.09,-5266.95 1761,-5266.54 2039.33,-5226.86 2116.68,-5269.47 2398.07,-5229.74"/>
<polygon fill="black" stroke="black" points="2398.76,-5233.17 2408.16,-5228.29 2397.77,-5226.25 2398.76,-5233.17"/>
</g>
<!-- stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_5 -->
<g id="edge54" class="edge">
<title>stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1613.32,-5266.24C1615.52,-5257.69 1617.89,-5248.47 1620.18,-5239.56"/>
<polygon fill="blue" stroke="blue" points="1623.62,-5240.23 1622.72,-5229.68 1616.84,-5238.49 1623.62,-5240.23"/>
</g>
<!-- stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_6 -->
<g id="edge63" class="edge">
<title>stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1752.19,-5267.71C1755.15,-5267.29 1758.09,-5266.9 1761,-5266.54 1963.91,-5241.53 3379.78,-5255.09 3625.98,-5229.6"/>
<polygon fill="blue" stroke="blue" points="3626.64,-5233.04 3636.18,-5228.43 3625.85,-5226.09 3626.64,-5233.04"/>
</g>
<!-- stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_7 -->
<g id="edge72" class="edge">
<title>stage0_qkv_layer_0_gpu_4&#45;&gt;stage0_attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1752.24,-5268.07C1755.18,-5267.54 1758.11,-5267.03 1761,-5266.54 1904.09,-5242.24 1944.88,-5254.24 2090.9,-5229.83"/>
<polygon fill="blue" stroke="blue" points="2091.86,-5233.22 2101.13,-5228.09 2090.69,-5226.32 2091.86,-5233.22"/>
</g>
<!-- stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_0 -->
<g id="edge9" class="edge">
<title>stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3322.26,-5268.17C3325.2,-5267.61 3328.11,-5267.06 3331,-5266.54 3360.34,-5261.2 3442.44,-5269.15 3464,-5248.54 3466.8,-5245.87 3468.96,-5242.7 3470.63,-5239.24"/>
<polygon fill="blue" stroke="blue" points="3474,-5240.2 3473.96,-5229.6 3467.39,-5237.91 3474,-5240.2"/>
</g>
<!-- stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_1 -->
<g id="edge18" class="edge">
<title>stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3069.88,-5266.4C3038.98,-5255.67 3004.98,-5243.87 2973.52,-5232.94"/>
<polygon fill="blue" stroke="blue" points="2974.43,-5229.56 2963.84,-5229.59 2972.14,-5236.17 2974.43,-5229.56"/>
</g>
<!-- stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_2 -->
<g id="edge27" class="edge">
<title>stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3171.67,-5266.24C3171.13,-5257.79 3170.54,-5248.67 3169.97,-5239.84"/>
<polygon fill="blue" stroke="blue" points="3173.45,-5239.43 3169.32,-5229.68 3166.47,-5239.88 3173.45,-5239.43"/>
</g>
<!-- stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_3 -->
<g id="edge36" class="edge">
<title>stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3025.81,-5267.71C3022.85,-5267.29 3019.91,-5266.9 3017,-5266.54 2653.04,-5221.32 2556.71,-5287.24 2192,-5248.54 2158.23,-5244.96 2122.36,-5238.7 2088.57,-5231.66"/>
<polygon fill="blue" stroke="blue" points="2089.14,-5228.2 2078.63,-5229.55 2087.69,-5235.05 2089.14,-5228.2"/>
</g>
<!-- stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_4 -->
<g id="edge45" class="edge">
<title>stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3025.79,-5267.83C3022.84,-5267.37 3019.91,-5266.94 3017,-5266.54 2937.88,-5255.57 2735.06,-5269.56 2658,-5248.54 2645.34,-5245.09 2632.48,-5239.94 2620.3,-5234.16"/>
<polygon fill="blue" stroke="blue" points="2621.64,-5230.93 2611.13,-5229.64 2618.54,-5237.2 2621.64,-5230.93"/>
</g>
<!-- stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_5 -->
<g id="edge49" class="edge">
<title>stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_5</title>
<path fill="none" stroke="black" d="M3025.81,-5267.69C3022.85,-5267.28 3019.91,-5266.89 3017,-5266.54 2769.45,-5236.51 2143.26,-5272.02 1895,-5248.54 1859.24,-5245.16 1821.19,-5238.83 1785.47,-5231.64"/>
<polygon fill="black" stroke="black" points="1785.96,-5228.17 1775.46,-5229.59 1784.56,-5235.03 1785.96,-5228.17"/>
</g>
<!-- stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_6 -->
<g id="edge64" class="edge">
<title>stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3322.2,-5267.8C3325.15,-5267.35 3328.09,-5266.93 3331,-5266.54 3377.51,-5260.27 3713.52,-5273.91 3753,-5248.54 3757.17,-5245.86 3760.75,-5242.34 3763.82,-5238.39"/>
<polygon fill="blue" stroke="blue" points="3766.9,-5240.07 3769.41,-5229.78 3761.03,-5236.26 3766.9,-5240.07"/>
</g>
<!-- stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_7 -->
<g id="edge73" class="edge">
<title>stage0_qkv_layer_0_gpu_5&#45;&gt;stage0_attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3025.8,-5267.76C3022.85,-5267.33 3019.91,-5266.92 3017,-5266.54 2778.43,-5235.51 2714.42,-5280.68 2476,-5248.54 2446.76,-5244.6 2415.8,-5238.53 2386.4,-5231.85"/>
<polygon fill="blue" stroke="blue" points="2387.03,-5228.4 2376.5,-5229.56 2385.45,-5235.22 2387.03,-5228.4"/>
</g>
<!-- stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_0 -->
<g id="edge10" class="edge">
<title>stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3693.24,-5266.4C3660.82,-5255.62 3625.14,-5243.77 3592.15,-5232.8"/>
<polygon fill="blue" stroke="blue" points="3593.06,-5229.42 3582.47,-5229.59 3590.86,-5236.06 3593.06,-5229.42"/>
</g>
<!-- stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_1 -->
<g id="edge19" class="edge">
<title>stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3653.79,-5267.86C3650.84,-5267.4 3647.91,-5266.95 3645,-5266.54 3370.16,-5227.25 3293.8,-5268.88 3014.56,-5229.52"/>
<polygon fill="blue" stroke="blue" points="3014.94,-5226.04 3004.54,-5228.09 3013.95,-5232.97 3014.94,-5226.04"/>
</g>
<!-- stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_2 -->
<g id="edge28" class="edge">
<title>stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3653.76,-5268.08C3650.82,-5267.55 3647.89,-5267.03 3645,-5266.54 3505.35,-5242.63 3465.58,-5253.77 3321.67,-5229.58"/>
<polygon fill="blue" stroke="blue" points="3322.03,-5226.09 3311.58,-5227.85 3320.85,-5232.99 3322.03,-5226.09"/>
</g>
<!-- stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_3 -->
<g id="edge37" class="edge">
<title>stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3653.81,-5267.72C3650.85,-5267.3 3647.91,-5266.9 3645,-5266.54 3476.77,-5245.47 2305.15,-5251.14 2093.67,-5229.39"/>
<polygon fill="blue" stroke="blue" points="2093.86,-5225.89 2083.52,-5228.24 2093.06,-5232.85 2093.86,-5225.89"/>
</g>
<!-- stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_4 -->
<g id="edge46" class="edge">
<title>stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3653.8,-5267.79C3650.85,-5267.34 3647.91,-5266.93 3645,-5266.54 3441.35,-5239.41 2929.53,-5256.97 2707.56,-5229.47"/>
<polygon fill="blue" stroke="blue" points="2707.9,-5225.98 2697.53,-5228.17 2707,-5232.93 2707.9,-5225.98"/>
</g>
<!-- stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_5 -->
<g id="edge55" class="edge">
<title>stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3653.81,-5267.71C3650.85,-5267.29 3647.91,-5266.9 3645,-5266.54 3442.96,-5241.63 2033.17,-5254.85 1786.73,-5229.41"/>
<polygon fill="blue" stroke="blue" points="1786.85,-5225.9 1776.52,-5228.25 1786.06,-5232.86 1786.85,-5225.9"/>
</g>
<!-- stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_6 -->
<g id="edge58" class="edge">
<title>stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_6</title>
<path fill="none" stroke="black" d="M3795.01,-5266.24C3793.36,-5257.69 3791.58,-5248.47 3789.87,-5239.56"/>
<polygon fill="black" stroke="black" points="3793.29,-5238.83 3787.96,-5229.68 3786.42,-5240.16 3793.29,-5238.83"/>
</g>
<!-- stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_7 -->
<g id="edge74" class="edge">
<title>stage0_qkv_layer_0_gpu_6&#45;&gt;stage0_attention_layer_0_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3653.81,-5267.75C3650.85,-5267.32 3647.91,-5266.91 3645,-5266.54 3510.55,-5249.29 2576.69,-5247.5 2400.58,-5229.37"/>
<polygon fill="blue" stroke="blue" points="2400.86,-5225.88 2390.53,-5228.21 2400.06,-5232.83 2400.86,-5225.88"/>
</g>
<!-- stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_0 -->
<g id="edge11" class="edge">
<title>stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3008.2,-5267.79C3011.15,-5267.35 3014.09,-5266.93 3017,-5266.54 3065.17,-5260.08 3414.78,-5277.23 3454,-5248.54 3457.7,-5245.83 3460.71,-5242.38 3463.17,-5238.51"/>
<polygon fill="blue" stroke="blue" points="3466.32,-5240.05 3467.72,-5229.55 3460.07,-5236.88 3466.32,-5240.05"/>
</g>
<!-- stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_1 -->
<g id="edge20" class="edge">
<title>stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2860,-5266.24C2860,-5257.79 2860,-5248.67 2860,-5239.84"/>
<polygon fill="blue" stroke="blue" points="2863.5,-5239.68 2860,-5229.68 2856.5,-5239.68 2863.5,-5239.68"/>
</g>
<!-- stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_2 -->
<g id="edge29" class="edge">
<title>stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3008.25,-5268.13C3011.19,-5267.58 3014.11,-5267.05 3017,-5266.54 3048.32,-5260.98 3136.3,-5270.82 3159,-5248.54 3161.74,-5245.85 3163.83,-5242.66 3165.39,-5239.2"/>
<polygon fill="blue" stroke="blue" points="3168.76,-5240.13 3168.4,-5229.54 3162.08,-5238.04 3168.76,-5240.13"/>
</g>
<!-- stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_3 -->
<g id="edge38" class="edge">
<title>stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2711.8,-5267.76C2708.85,-5267.33 2705.91,-5266.92 2703,-5266.54 2467.96,-5235.91 2404.91,-5280.15 2170,-5248.54 2140.63,-5244.59 2109.55,-5238.52 2080.02,-5231.84"/>
<polygon fill="blue" stroke="blue" points="2080.61,-5228.38 2070.08,-5229.55 2079.04,-5235.2 2080.61,-5228.38"/>
</g>
<!-- stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_4 -->
<g id="edge47" class="edge">
<title>stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2711.68,-5268.48C2708.76,-5267.83 2705.87,-5267.18 2703,-5266.54 2666.16,-5258.32 2653.98,-5264.97 2620,-5248.54 2612.86,-5245.08 2605.81,-5240.72 2599.13,-5235.96"/>
<polygon fill="blue" stroke="blue" points="2600.98,-5232.98 2590.88,-5229.77 2596.78,-5238.57 2600.98,-5232.98"/>
</g>
<!-- stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_5 -->
<g id="edge56" class="edge">
<title>stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2711.81,-5267.72C2708.85,-5267.29 2705.91,-5266.9 2703,-5266.54 2341.69,-5221.62 2246.02,-5287.33 1884,-5248.54 1850.47,-5244.95 1814.85,-5238.71 1781.28,-5231.69"/>
<polygon fill="blue" stroke="blue" points="1781.92,-5228.25 1771.41,-5229.59 1780.46,-5235.09 1781.92,-5228.25"/>
</g>
<!-- stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_6 -->
<g id="edge65" class="edge">
<title>stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3008.19,-5267.73C3011.15,-5267.3 3014.09,-5266.91 3017,-5266.54 3057.09,-5261.5 3708.58,-5267.97 3744,-5248.54 3748.98,-5245.81 3753.42,-5242.08 3757.33,-5237.85"/>
<polygon fill="blue" stroke="blue" points="3760.28,-5239.77 3763.83,-5229.79 3754.83,-5235.38 3760.28,-5239.77"/>
</g>
<!-- stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_7 -->
<g id="edge67" class="edge">
<title>stage0_qkv_layer_0_gpu_7&#45;&gt;stage0_attention_layer_0_gpu_7</title>
<path fill="none" stroke="black" d="M2711.78,-5267.9C2708.84,-5267.42 2705.9,-5266.97 2703,-5266.54 2586.66,-5249.34 2554.85,-5268.77 2439,-5248.54 2415.47,-5244.43 2390.7,-5238.58 2367.05,-5232.21"/>
<polygon fill="black" stroke="black" points="2367.91,-5228.82 2357.34,-5229.55 2366.06,-5235.57 2367.91,-5228.82"/>
</g>
<!-- stage0_attention_reduce_layer_0 -->
<g id="node20" class="node">
<title>stage0_attention_reduce_layer_0</title>
<polygon fill="#ffcccc" stroke="black" points="3163.54,-5118.54 2680.68,-5118.54 2556.46,-5014.54 3039.32,-5014.54 3163.54,-5118.54"/>
<text text-anchor="middle" x="2860" y="-5080.54" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="2860" y="-5069.54" font-family="Arial" font-size="10.00">Input: [8Ã— batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2860" y="-5058.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2860" y="-5047.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (all&#45;reduce)</text>
</g>
<!-- stage0_attention_layer_0_gpu_0&#45;&gt;stage0_attention_reduce_layer_0 -->
<g id="edge75" class="edge">
<title>stage0_attention_layer_0_gpu_0&#45;&gt;stage0_attention_reduce_layer_0</title>
<path fill="none" stroke="black" d="M3329.48,-5157.36C3326.63,-5156.74 3323.8,-5156.14 3321,-5155.54 3265.06,-5143.63 3205.15,-5131.63 3147.63,-5120.49"/>
<polygon fill="black" stroke="black" points="3148.16,-5117.03 3137.68,-5118.57 3146.83,-5123.9 3148.16,-5117.03"/>
</g>
<!-- stage0_attention_layer_0_gpu_1&#45;&gt;stage0_attention_reduce_layer_0 -->
<g id="edge76" class="edge">
<title>stage0_attention_layer_0_gpu_1&#45;&gt;stage0_attention_reduce_layer_0</title>
<path fill="none" stroke="black" d="M2860,-5155.34C2860,-5147.03 2860,-5137.97 2860,-5128.92"/>
<polygon fill="black" stroke="black" points="2863.5,-5128.76 2860,-5118.76 2856.5,-5128.76 2863.5,-5128.76"/>
</g>
<!-- stage0_attention_layer_0_gpu_2&#45;&gt;stage0_attention_reduce_layer_0 -->
<g id="edge77" class="edge">
<title>stage0_attention_layer_0_gpu_2&#45;&gt;stage0_attention_reduce_layer_0</title>
<path fill="none" stroke="black" d="M3077.79,-5155.51C3052.18,-5145.16 3023.66,-5133.64 2995.92,-5122.44"/>
<polygon fill="black" stroke="black" points="2997.12,-5119.15 2986.54,-5118.65 2994.5,-5125.64 2997.12,-5119.15"/>
</g>
<!-- stage0_attention_layer_0_gpu_3&#45;&gt;stage0_attention_reduce_layer_0 -->
<g id="edge78" class="edge">
<title>stage0_attention_layer_0_gpu_3&#45;&gt;stage0_attention_reduce_layer_0</title>
<path fill="none" stroke="black" d="M2083.58,-5157.23C2086.75,-5156.64 2089.89,-5156.08 2093,-5155.54 2272.78,-5124.32 2478.25,-5101.42 2631.25,-5086.82"/>
<polygon fill="black" stroke="black" points="2631.63,-5090.3 2641.25,-5085.87 2630.97,-5083.33 2631.63,-5090.3"/>
</g>
<!-- stage0_attention_layer_0_gpu_4&#45;&gt;stage0_attention_reduce_layer_0 -->
<g id="edge79" class="edge">
<title>stage0_attention_layer_0_gpu_4&#45;&gt;stage0_attention_reduce_layer_0</title>
<path fill="none" stroke="black" d="M2642.21,-5155.51C2667.82,-5145.16 2696.34,-5133.64 2724.08,-5122.44"/>
<polygon fill="black" stroke="black" points="2725.5,-5125.64 2733.46,-5118.65 2722.88,-5119.15 2725.5,-5125.64"/>
</g>
<!-- stage0_attention_layer_0_gpu_5&#45;&gt;stage0_attention_reduce_layer_0 -->
<g id="edge80" class="edge">
<title>stage0_attention_layer_0_gpu_5&#45;&gt;stage0_attention_reduce_layer_0</title>
<path fill="none" stroke="black" d="M1776.56,-5157.09C1779.73,-5156.55 1782.88,-5156.03 1786,-5155.54 2070.87,-5110.82 2402.03,-5088.05 2620.48,-5077.01"/>
<polygon fill="black" stroke="black" points="2620.66,-5080.51 2630.47,-5076.51 2620.31,-5073.52 2620.66,-5080.51"/>
</g>
<!-- stage0_attention_layer_0_gpu_6&#45;&gt;stage0_attention_reduce_layer_0 -->
<g id="edge81" class="edge">
<title>stage0_attention_layer_0_gpu_6&#45;&gt;stage0_attention_reduce_layer_0</title>
<path fill="none" stroke="black" d="M3636.13,-5157C3633.4,-5156.49 3630.69,-5156.01 3628,-5155.54 3467.42,-5127.55 3286.33,-5106.31 3140.35,-5091.71"/>
<polygon fill="black" stroke="black" points="3140.64,-5088.22 3130.34,-5090.72 3139.94,-5095.19 3140.64,-5088.22"/>
</g>
<!-- stage0_attention_layer_0_gpu_7&#45;&gt;stage0_attention_reduce_layer_0 -->
<g id="edge82" class="edge">
<title>stage0_attention_layer_0_gpu_7&#45;&gt;stage0_attention_reduce_layer_0</title>
<path fill="none" stroke="black" d="M2390.64,-5157.55C2393.79,-5156.87 2396.91,-5156.2 2400,-5155.54 2482.37,-5138.04 2573.39,-5120.3 2652.57,-5105.37"/>
<polygon fill="black" stroke="black" points="2653.48,-5108.76 2662.66,-5103.47 2652.19,-5101.88 2653.48,-5108.76"/>
</g>
<!-- stage0_out_proj_layer_0 -->
<g id="node21" class="node">
<title>stage0_out_proj_layer_0</title>
<polygon fill="#ff0080" stroke="black" points="3476,-4977.54 3192,-4977.54 3192,-4925.54 3476,-4925.54 3476,-4977.54"/>
<text text-anchor="middle" x="3334" y="-4965.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3334" y="-4954.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3334" y="-4943.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3334" y="-4932.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (sharded)</text>
</g>
<!-- stage0_attention_reduce_layer_0&#45;&gt;stage0_out_proj_layer_0 -->
<g id="edge83" class="edge">
<title>stage0_attention_reduce_layer_0&#45;&gt;stage0_out_proj_layer_0</title>
<path fill="none" stroke="black" d="M3047,-5020.96C3105.13,-5007.1 3167.47,-4992.24 3219.15,-4979.92"/>
<polygon fill="black" stroke="black" points="3220.09,-4983.29 3229.01,-4977.57 3218.47,-4976.48 3220.09,-4983.29"/>
</g>
<!-- stage0_out_proj_layer_0&#45;&gt;stage0_residual1_layer_0 -->
<g id="edge84" class="edge">
<title>stage0_out_proj_layer_0&#45;&gt;stage0_residual1_layer_0</title>
<path fill="none" stroke="black" d="M3440.01,-4925.53C3491.95,-4913.28 3556.21,-4898.12 3616.67,-4883.86"/>
<polygon fill="black" stroke="black" points="3617.8,-4887.18 3626.73,-4881.48 3616.19,-4880.37 3617.8,-4887.18"/>
</g>
<!-- stage0_ln2_layer_0 -->
<g id="node23" class="node">
<title>stage0_ln2_layer_0</title>
<polygon fill="#ff0080" stroke="black" points="3002,-4747.54 2718,-4747.54 2718,-4695.54 3002,-4695.54 3002,-4747.54"/>
<text text-anchor="middle" x="2860" y="-4735.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2860" y="-4724.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2860" y="-4713.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2860" y="-4702.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (sharded)</text>
</g>
<!-- stage0_residual1_layer_0&#45;&gt;stage0_ln2_layer_0 -->
<g id="edge86" class="edge">
<title>stage0_residual1_layer_0&#45;&gt;stage0_ln2_layer_0</title>
<path fill="none" stroke="black" d="M3533.19,-4802.36C3362.91,-4782.17 3151.99,-4757.16 3012.09,-4740.57"/>
<polygon fill="black" stroke="black" points="3012.49,-4737.1 3002.15,-4739.39 3011.66,-4744.05 3012.49,-4737.1"/>
</g>
<!-- stage0_residual2_layer_0 -->
<g id="node42" class="node">
<title>stage0_residual2_layer_0</title>
<polygon fill="#ffffcc" stroke="black" points="4807.82,-4287.54 4329.28,-4287.54 4206.18,-4183.54 4684.72,-4183.54 4807.82,-4287.54"/>
<text text-anchor="middle" x="4507" y="-4249.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="4507" y="-4238.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4507" y="-4227.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4507" y="-4216.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (all&#45;reduce)</text>
</g>
<!-- stage0_residual1_layer_0&#45;&gt;stage0_residual2_layer_0 -->
<g id="edge137" class="edge">
<title>stage0_residual1_layer_0&#45;&gt;stage0_residual2_layer_0</title>
<path fill="none" stroke="black" d="M4051.94,-4835.97C4394.67,-4833.36 4985,-4815.39 4985,-4722.54 4985,-4722.54 4985,-4722.54 4985,-4375.54 4985,-4328.75 4899.5,-4296.68 4800.82,-4275.24"/>
<polygon fill="black" stroke="black" points="4801.43,-4271.79 4790.92,-4273.13 4799.98,-4278.64 4801.43,-4271.79"/>
</g>
<!-- stage0_gate_layer_0 -->
<g id="node24" class="node">
<title>stage0_gate_layer_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2921.38,-4658.54 2453.09,-4658.54 2332.62,-4554.54 2800.91,-4554.54 2921.38,-4658.54"/>
<text text-anchor="middle" x="2627" y="-4620.54" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="2627" y="-4609.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2627" y="-4598.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="2627" y="-4587.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (sharded)</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_gate_layer_0 -->
<g id="edge87" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_gate_layer_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2808.29,-4695.46C2788.52,-4685.87 2765.11,-4674.52 2741.79,-4663.21"/>
<polygon fill="black" stroke="black" points="2743.04,-4659.93 2732.51,-4658.71 2739.98,-4666.22 2743.04,-4659.93"/>
</g>
<!-- stage0_expert_layer_0_expert_0_gpu_0 -->
<g id="node25" class="node">
<title>stage0_expert_layer_0_expert_0_gpu_0</title>
<polygon fill="#ff0080" stroke="black" points="2796,-4517.54 2504,-4517.54 2504,-4465.54 2796,-4465.54 2796,-4517.54"/>
<text text-anchor="middle" x="2650" y="-4505.54" font-family="Arial" font-size="10.00">Expert0</text>
<text text-anchor="middle" x="2650" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2650" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2650" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_0_gpu_0 -->
<g id="edge89" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_0_gpu_0</title>
<path fill="none" stroke="black" d="M2899.62,-4695.42C2911.68,-4685.53 2923.47,-4673.05 2930,-4658.54 2948.97,-4616.39 2958.94,-4590.58 2930,-4554.54 2921.2,-4543.57 2865.65,-4530.21 2806.32,-4518.71"/>
<polygon fill="black" stroke="black" points="2806.86,-4515.25 2796.38,-4516.8 2805.54,-4522.12 2806.86,-4515.25"/>
</g>
<!-- stage0_expert_layer_0_expert_1_gpu_0 -->
<g id="node26" class="node">
<title>stage0_expert_layer_0_expert_1_gpu_0</title>
<polygon fill="#ff0080" stroke="black" points="2176,-4517.54 1884,-4517.54 1884,-4465.54 2176,-4465.54 2176,-4517.54"/>
<text text-anchor="middle" x="2030" y="-4505.54" font-family="Arial" font-size="10.00">Expert1</text>
<text text-anchor="middle" x="2030" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2030" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2030" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_1_gpu_0 -->
<g id="edge91" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_1_gpu_0</title>
<path fill="none" stroke="black" d="M2717.87,-4715.8C2618.36,-4710.64 2482.69,-4699.88 2365,-4677.54 2335.85,-4672 2328.1,-4670.61 2301,-4658.54 2215.54,-4620.47 2124.4,-4560.01 2072.6,-4523.51"/>
<polygon fill="black" stroke="black" points="2074.5,-4520.57 2064.32,-4517.65 2070.46,-4526.29 2074.5,-4520.57"/>
</g>
<!-- stage0_expert_layer_0_expert_2_gpu_1 -->
<g id="node27" class="node">
<title>stage0_expert_layer_0_expert_2_gpu_1</title>
<polygon fill="#ff1480" stroke="black" points="1246,-4517.54 954,-4517.54 954,-4465.54 1246,-4465.54 1246,-4517.54"/>
<text text-anchor="middle" x="1100" y="-4505.54" font-family="Arial" font-size="10.00">Expert2</text>
<text text-anchor="middle" x="1100" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1100" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1100" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_2_gpu_1 -->
<g id="edge93" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_2_gpu_1</title>
<path fill="none" stroke="black" d="M2717.8,-4719.47C2424.52,-4716.36 1761.44,-4704.32 1540,-4658.54 1398.73,-4629.34 1242.86,-4561.37 1159.85,-4522.06"/>
<polygon fill="black" stroke="black" points="1161.11,-4518.78 1150.58,-4517.64 1158.1,-4525.1 1161.11,-4518.78"/>
</g>
<!-- stage0_expert_layer_0_expert_3_gpu_1 -->
<g id="node28" class="node">
<title>stage0_expert_layer_0_expert_3_gpu_1</title>
<polygon fill="#ff1480" stroke="black" points="4036,-4517.54 3744,-4517.54 3744,-4465.54 4036,-4465.54 4036,-4517.54"/>
<text text-anchor="middle" x="3890" y="-4505.54" font-family="Arial" font-size="10.00">Expert3</text>
<text text-anchor="middle" x="3890" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3890" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3890" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_3_gpu_1 -->
<g id="edge95" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_3_gpu_1</title>
<path fill="none" stroke="black" d="M3002.36,-4700.73C3074.97,-4689.82 3164.51,-4675.13 3244,-4658.54 3440.59,-4617.5 3667.29,-4555.88 3793.09,-4520.4"/>
<polygon fill="black" stroke="black" points="3794.41,-4523.66 3803.08,-4517.58 3792.51,-4516.93 3794.41,-4523.66"/>
</g>
<!-- stage0_expert_layer_0_expert_4_gpu_2 -->
<g id="node29" class="node">
<title>stage0_expert_layer_0_expert_4_gpu_2</title>
<polygon fill="#ff2880" stroke="black" points="1866,-4517.54 1574,-4517.54 1574,-4465.54 1866,-4465.54 1866,-4517.54"/>
<text text-anchor="middle" x="1720" y="-4505.54" font-family="Arial" font-size="10.00">Expert4</text>
<text text-anchor="middle" x="1720" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1720" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1720" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_4_gpu_2 -->
<g id="edge97" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_4_gpu_2</title>
<path fill="none" stroke="black" d="M2717.95,-4714C2534.7,-4704.66 2226.4,-4685.56 2116,-4658.54 1989.1,-4627.48 1850.36,-4561.15 1775.46,-4522.39"/>
<polygon fill="black" stroke="black" points="1776.7,-4519.09 1766.21,-4517.58 1773.46,-4525.3 1776.7,-4519.09"/>
</g>
<!-- stage0_expert_layer_0_expert_5_gpu_2 -->
<g id="node30" class="node">
<title>stage0_expert_layer_0_expert_5_gpu_2</title>
<polygon fill="#ff2880" stroke="black" points="4656,-4517.54 4364,-4517.54 4364,-4465.54 4656,-4465.54 4656,-4517.54"/>
<text text-anchor="middle" x="4510" y="-4505.54" font-family="Arial" font-size="10.00">Expert5</text>
<text text-anchor="middle" x="4510" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4510" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4510" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_5_gpu_2 -->
<g id="edge99" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_5_gpu_2</title>
<path fill="none" stroke="black" d="M3002.31,-4715.95C3171.98,-4709.14 3463.77,-4693.23 3712,-4658.54 3960.73,-4623.77 4248.12,-4557.43 4401.03,-4520"/>
<polygon fill="black" stroke="black" points="4402.03,-4523.36 4410.9,-4517.58 4400.36,-4516.56 4402.03,-4523.36"/>
</g>
<!-- stage0_expert_layer_0_expert_6_gpu_3 -->
<g id="node31" class="node">
<title>stage0_expert_layer_0_expert_6_gpu_3</title>
<polygon fill="#ff3c80" stroke="black" points="1556,-4517.54 1264,-4517.54 1264,-4465.54 1556,-4465.54 1556,-4517.54"/>
<text text-anchor="middle" x="1410" y="-4505.54" font-family="Arial" font-size="10.00">Expert6</text>
<text text-anchor="middle" x="1410" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1410" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1410" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_6_gpu_3 -->
<g id="edge101" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_6_gpu_3</title>
<path fill="none" stroke="black" d="M2717.63,-4717.3C2477.53,-4710.93 2002.3,-4694.19 1839,-4658.54 1701.33,-4628.49 1549.63,-4561 1468.65,-4521.96"/>
<polygon fill="black" stroke="black" points="1470.13,-4518.79 1459.6,-4517.58 1467.08,-4525.09 1470.13,-4518.79"/>
</g>
<!-- stage0_expert_layer_0_expert_7_gpu_3 -->
<g id="node32" class="node">
<title>stage0_expert_layer_0_expert_7_gpu_3</title>
<polygon fill="#ff3c80" stroke="black" points="626,-4517.54 334,-4517.54 334,-4465.54 626,-4465.54 626,-4517.54"/>
<text text-anchor="middle" x="480" y="-4505.54" font-family="Arial" font-size="10.00">Expert7</text>
<text text-anchor="middle" x="480" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="480" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="480" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_7_gpu_3 -->
<g id="edge103" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_7_gpu_3</title>
<path fill="none" stroke="black" d="M2717.98,-4718.8C2299.97,-4713.3 1092.38,-4694.46 918,-4658.54 777.27,-4629.55 622.15,-4561.5 539.55,-4522.12"/>
<polygon fill="black" stroke="black" points="540.85,-4518.86 530.32,-4517.7 537.83,-4525.17 540.85,-4518.86"/>
</g>
<!-- stage0_expert_layer_0_expert_8_gpu_4 -->
<g id="node33" class="node">
<title>stage0_expert_layer_0_expert_8_gpu_4</title>
<polygon fill="#ff5080" stroke="black" points="4346,-4517.54 4054,-4517.54 4054,-4465.54 4346,-4465.54 4346,-4517.54"/>
<text text-anchor="middle" x="4200" y="-4505.54" font-family="Arial" font-size="10.00">Expert8</text>
<text text-anchor="middle" x="4200" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4200" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4200" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_8_gpu_4 -->
<g id="edge105" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_8_gpu_4</title>
<path fill="none" stroke="black" d="M3002.16,-4710.59C3124.13,-4700.92 3304.32,-4683.95 3460,-4658.54 3688.58,-4621.22 3952.41,-4556.81 4095.14,-4520.16"/>
<polygon fill="black" stroke="black" points="4096.39,-4523.45 4105.2,-4517.57 4094.64,-4516.68 4096.39,-4523.45"/>
</g>
<!-- stage0_expert_layer_0_expert_9_gpu_4 -->
<g id="node34" class="node">
<title>stage0_expert_layer_0_expert_9_gpu_4</title>
<polygon fill="#ff5080" stroke="black" points="3416,-4517.54 3124,-4517.54 3124,-4465.54 3416,-4465.54 3416,-4517.54"/>
<text text-anchor="middle" x="3270" y="-4505.54" font-family="Arial" font-size="10.00">Expert9</text>
<text text-anchor="middle" x="3270" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3270" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3270" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_9_gpu_4 -->
<g id="edge107" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_9_gpu_4</title>
<path fill="none" stroke="black" d="M2914.12,-4695.53C2926.03,-4689.79 2938.51,-4683.59 2950,-4677.54 3047.27,-4626.29 3157.66,-4560.78 3220.05,-4523.05"/>
<polygon fill="black" stroke="black" points="3222.16,-4525.86 3228.9,-4517.69 3218.54,-4519.88 3222.16,-4525.86"/>
</g>
<!-- stage0_expert_layer_0_expert_10_gpu_5 -->
<g id="node35" class="node">
<title>stage0_expert_layer_0_expert_10_gpu_5</title>
<polygon fill="#ff6480" stroke="black" points="3726,-4517.54 3434,-4517.54 3434,-4465.54 3726,-4465.54 3726,-4517.54"/>
<text text-anchor="middle" x="3580" y="-4505.54" font-family="Arial" font-size="10.00">Expert10</text>
<text text-anchor="middle" x="3580" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3580" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3580" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_10_gpu_5 -->
<g id="edge109" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_10_gpu_5</title>
<path fill="none" stroke="black" d="M2953.03,-4695.5C2992.6,-4684.57 3039.18,-4671.35 3081,-4658.54 3229.05,-4613.17 3399.95,-4555.06 3498.44,-4521"/>
<polygon fill="black" stroke="black" points="3499.73,-4524.26 3508.04,-4517.68 3497.44,-4517.64 3499.73,-4524.26"/>
</g>
<!-- stage0_expert_layer_0_expert_11_gpu_5 -->
<g id="node36" class="node">
<title>stage0_expert_layer_0_expert_11_gpu_5</title>
<polygon fill="#ff6480" stroke="black" points="936,-4517.54 644,-4517.54 644,-4465.54 936,-4465.54 936,-4517.54"/>
<text text-anchor="middle" x="790" y="-4505.54" font-family="Arial" font-size="10.00">Expert11</text>
<text text-anchor="middle" x="790" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="790" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="790" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_11_gpu_5 -->
<g id="edge111" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_11_gpu_5</title>
<path fill="none" stroke="black" d="M2717.98,-4721.11C2375.46,-4721.53 1511.42,-4716.61 1229,-4658.54 1087.98,-4629.54 932.5,-4561.5 849.69,-4522.12"/>
<polygon fill="black" stroke="black" points="850.98,-4518.85 840.45,-4517.69 847.96,-4525.17 850.98,-4518.85"/>
</g>
<!-- stage0_expert_layer_0_expert_12_gpu_6 -->
<g id="node37" class="node">
<title>stage0_expert_layer_0_expert_12_gpu_6</title>
<polygon fill="#ff7880" stroke="black" points="3106,-4517.54 2814,-4517.54 2814,-4465.54 3106,-4465.54 3106,-4517.54"/>
<text text-anchor="middle" x="2960" y="-4505.54" font-family="Arial" font-size="10.00">Expert12</text>
<text text-anchor="middle" x="2960" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2960" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2960" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_12_gpu_6 -->
<g id="edge113" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_12_gpu_6</title>
<path fill="none" stroke="black" d="M2927.17,-4695.45C2934.09,-4690.46 2940.3,-4684.54 2945,-4677.54 2975.03,-4632.86 2972.25,-4567.7 2966.7,-4527.83"/>
<polygon fill="black" stroke="black" points="2970.13,-4527.13 2965.16,-4517.77 2963.21,-4528.19 2970.13,-4527.13"/>
</g>
<!-- stage0_expert_layer_0_expert_13_gpu_6 -->
<g id="node38" class="node">
<title>stage0_expert_layer_0_expert_13_gpu_6</title>
<polygon fill="#ff7880" stroke="black" points="2486,-4517.54 2194,-4517.54 2194,-4465.54 2486,-4465.54 2486,-4517.54"/>
<text text-anchor="middle" x="2340" y="-4505.54" font-family="Arial" font-size="10.00">Expert13</text>
<text text-anchor="middle" x="2340" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2340" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2340" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_13_gpu_6 -->
<g id="edge115" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_13_gpu_6</title>
<path fill="none" stroke="black" d="M2717.77,-4713.72C2567.88,-4705.04 2349.88,-4687.59 2324,-4658.54 2292.26,-4622.92 2308.01,-4564.38 2323.26,-4527.18"/>
<polygon fill="black" stroke="black" points="2326.58,-4528.33 2327.31,-4517.76 2320.15,-4525.57 2326.58,-4528.33"/>
</g>
<!-- stage0_expert_layer_0_expert_14_gpu_7 -->
<g id="node39" class="node">
<title>stage0_expert_layer_0_expert_14_gpu_7</title>
<polygon fill="#ff8c80" stroke="black" points="316,-4517.54 24,-4517.54 24,-4465.54 316,-4465.54 316,-4517.54"/>
<text text-anchor="middle" x="170" y="-4505.54" font-family="Arial" font-size="10.00">Expert14</text>
<text text-anchor="middle" x="170" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="170" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="170" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_14_gpu_7 -->
<g id="edge117" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_14_gpu_7</title>
<path fill="none" stroke="black" d="M2717.85,-4719.46C2255.69,-4715.58 813.56,-4700.21 608,-4658.54 466.99,-4629.95 311.67,-4561.59 229.18,-4522.08"/>
<polygon fill="black" stroke="black" points="230.5,-4518.83 219.98,-4517.65 227.47,-4525.14 230.5,-4518.83"/>
</g>
<!-- stage0_expert_layer_0_expert_15_gpu_7 -->
<g id="node40" class="node">
<title>stage0_expert_layer_0_expert_15_gpu_7</title>
<polygon fill="#ff8c80" stroke="black" points="4966,-4517.54 4674,-4517.54 4674,-4465.54 4966,-4465.54 4966,-4517.54"/>
<text text-anchor="middle" x="4820" y="-4505.54" font-family="Arial" font-size="10.00">Expert15</text>
<text text-anchor="middle" x="4820" y="-4494.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4820" y="-4483.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4820" y="-4472.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_15_gpu_7 -->
<g id="edge119" class="edge">
<title>stage0_ln2_layer_0&#45;&gt;stage0_expert_layer_0_expert_15_gpu_7</title>
<path fill="none" stroke="black" d="M3002.4,-4719.08C3216.16,-4715.45 3632.35,-4702.77 3983,-4658.54 4245.19,-4625.47 4548.41,-4557.88 4708.15,-4519.94"/>
<polygon fill="black" stroke="black" points="4709.08,-4523.32 4718,-4517.6 4707.46,-4516.51 4709.08,-4523.32"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_0_gpu_0 -->
<g id="edge88" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_0_gpu_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2637.42,-4554.33C2639.27,-4545.28 2641.14,-4536.05 2642.87,-4527.57"/>
<polygon fill="red" stroke="red" points="2646.32,-4528.17 2644.88,-4517.67 2639.46,-4526.77 2646.32,-4528.17"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_1_gpu_0 -->
<g id="edge90" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_1_gpu_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2357.32,-4554.49C2293.48,-4542.41 2227.87,-4529.99 2172.31,-4519.47"/>
<polygon fill="red" stroke="red" points="2172.88,-4516.02 2162.41,-4517.6 2171.58,-4522.9 2172.88,-4516.02"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_2_gpu_1 -->
<g id="edge92" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_2_gpu_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2373.47,-4589.91C2007.03,-4567.23 1362.34,-4526.97 1256.56,-4517.53"/>
<polygon fill="red" stroke="red" points="1256.69,-4514.02 1246.39,-4516.53 1256,-4520.99 1256.69,-4514.02"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_3_gpu_1 -->
<g id="edge94" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_3_gpu_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2839.86,-4587.99C3015.35,-4573.62 3270.8,-4552.88 3494,-4535.54 3597.84,-4527.47 3626.61,-4529.94 3733.37,-4517.68"/>
<polygon fill="red" stroke="red" points="3734.07,-4521.13 3743.6,-4516.49 3733.27,-4514.17 3734.07,-4521.13"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_4_gpu_2 -->
<g id="edge96" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_4_gpu_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2351.23,-4570.74C2256.72,-4559.13 2150.28,-4546.39 2053,-4535.54 1977.06,-4527.07 1955.5,-4527.8 1876.36,-4517.68"/>
<polygon fill="red" stroke="red" points="1876.78,-4514.2 1866.41,-4516.39 1875.88,-4521.15 1876.78,-4514.2"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_5_gpu_2 -->
<g id="edge98" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_5_gpu_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2847.9,-4594.93C3283.14,-4573.95 4220.42,-4528.29 4353.31,-4517.52"/>
<polygon fill="red" stroke="red" points="4353.97,-4520.97 4363.61,-4516.59 4353.34,-4514 4353.97,-4520.97"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_6_gpu_3 -->
<g id="edge100" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_6_gpu_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2368.01,-4585.13C2089.14,-4563 1672.16,-4529.38 1566.44,-4517.62"/>
<polygon fill="red" stroke="red" points="1566.74,-4514.14 1556.4,-4516.46 1565.93,-4521.09 1566.74,-4514.14"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_7_gpu_3 -->
<g id="edge102" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_7_gpu_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2389.48,-4603.92C2017.4,-4599.4 1274.52,-4582.38 636.71,-4517.66"/>
<polygon fill="red" stroke="red" points="636.69,-4514.14 626.38,-4516.61 635.98,-4521.11 636.69,-4514.14"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_8_gpu_4 -->
<g id="edge104" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_8_gpu_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2844.95,-4592.29C3216.92,-4569.64 3943.32,-4525.23 4043.49,-4517.42"/>
<polygon fill="red" stroke="red" points="4043.95,-4520.9 4053.61,-4516.54 4043.34,-4513.92 4043.95,-4520.9"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_9_gpu_4 -->
<g id="edge106" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_9_gpu_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2820.79,-4571.48C2915.96,-4554.76 3028.95,-4534.9 3117.8,-4519.29"/>
<polygon fill="red" stroke="red" points="3118.44,-4522.73 3127.69,-4517.55 3117.23,-4515.83 3118.44,-4522.73"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_10_gpu_5 -->
<g id="edge108" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_10_gpu_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2831.96,-4581.12C2950.53,-4567.23 3102.62,-4549.81 3238,-4535.54 3317.87,-4527.12 3340.49,-4528.1 3423.45,-4517.7"/>
<polygon fill="red" stroke="red" points="3424.11,-4521.14 3433.59,-4516.41 3423.23,-4514.2 3424.11,-4521.14"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_11_gpu_5 -->
<g id="edge110" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_11_gpu_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2378.08,-4594C1953.53,-4574.11 1119.23,-4533.99 946.57,-4517.6"/>
<polygon fill="red" stroke="red" points="946.69,-4514.1 936.39,-4516.58 945.99,-4521.06 946.69,-4514.1"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_12_gpu_6 -->
<g id="edge112" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_12_gpu_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2777.43,-4554.49C2811.49,-4542.94 2846.45,-4531.07 2876.55,-4520.86"/>
<polygon fill="red" stroke="red" points="2877.8,-4524.13 2886.14,-4517.6 2875.55,-4517.5 2877.8,-4524.13"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_13_gpu_6 -->
<g id="edge114" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_13_gpu_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2497.35,-4554.49C2468.51,-4543.14 2438.91,-4531.48 2413.27,-4521.39"/>
<polygon fill="red" stroke="red" points="2414.24,-4518.01 2403.65,-4517.6 2411.68,-4524.52 2414.24,-4518.01"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_14_gpu_7 -->
<g id="edge116" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_14_gpu_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2391.89,-4605.98C1976.47,-4604.66 1085.56,-4592.45 326.43,-4517.63"/>
<polygon fill="red" stroke="red" points="326.68,-4514.14 316.38,-4516.64 325.99,-4521.1 326.68,-4514.14"/>
</g>
<!-- stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_15_gpu_7 -->
<g id="edge118" class="edge">
<title>stage0_gate_layer_0&#45;&gt;stage0_expert_layer_0_expert_15_gpu_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2858.77,-4604.32C3235.63,-4600.38 4004.6,-4584.18 4663.44,-4517.65"/>
<polygon fill="red" stroke="red" points="4664.02,-4521.11 4673.62,-4516.62 4663.31,-4514.14 4664.02,-4521.11"/>
</g>
<!-- stage0_expert_agg_layer_0 -->
<g id="node41" class="node">
<title>stage0_expert_agg_layer_0</title>
<polygon fill="#ffcccc" stroke="black" points="2959.98,-4428.54 2466.87,-4428.54 2340.02,-4324.54 2833.13,-4324.54 2959.98,-4428.54"/>
<text text-anchor="middle" x="2650" y="-4390.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2650" y="-4379.54" font-family="Arial" font-size="10.00">Input: [8Ã— batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2650" y="-4368.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2650" y="-4357.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (all&#45;reduce)</text>
</g>
<!-- stage0_expert_layer_0_expert_0_gpu_0&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge120" class="edge">
<title>stage0_expert_layer_0_expert_0_gpu_0&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M2650,-4465.46C2650,-4457.53 2650,-4448.4 2650,-4439.08"/>
<polygon fill="black" stroke="black" points="2653.5,-4438.94 2650,-4428.94 2646.5,-4438.94 2653.5,-4438.94"/>
</g>
<!-- stage0_expert_layer_0_expert_1_gpu_0&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge121" class="edge">
<title>stage0_expert_layer_0_expert_1_gpu_0&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M2167.21,-4465.53C2246.97,-4450.99 2349.16,-4432.37 2438.96,-4416"/>
<polygon fill="black" stroke="black" points="2439.79,-4419.41 2449,-4414.17 2438.54,-4412.52 2439.79,-4419.41"/>
</g>
<!-- stage0_expert_layer_0_expert_2_gpu_1&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge122" class="edge">
<title>stage0_expert_layer_0_expert_2_gpu_1&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M1246.39,-4466.54C1249.28,-4466.19 1252.16,-4465.86 1255,-4465.54 1656.1,-4420.65 2124.84,-4396.94 2404.03,-4385.84"/>
<polygon fill="black" stroke="black" points="2404.44,-4389.33 2414.29,-4385.44 2404.16,-4382.34 2404.44,-4389.33"/>
</g>
<!-- stage0_expert_layer_0_expert_3_gpu_1&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge123" class="edge">
<title>stage0_expert_layer_0_expert_3_gpu_1&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M3743.6,-4466.61C3740.71,-4466.24 3737.84,-4465.88 3735,-4465.54 3461.07,-4432.39 3146.67,-4408.43 2927.07,-4393.96"/>
<polygon fill="black" stroke="black" points="2927.22,-4390.46 2917.01,-4393.3 2926.76,-4397.45 2927.22,-4390.46"/>
</g>
<!-- stage0_expert_layer_0_expert_4_gpu_2&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge124" class="edge">
<title>stage0_expert_layer_0_expert_4_gpu_2&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M1866,-4466.79C1869.03,-4466.37 1872.03,-4465.95 1875,-4465.54 2058.29,-4440.37 2266.68,-4417 2421.17,-4400.68"/>
<polygon fill="black" stroke="black" points="2421.69,-4404.14 2431.27,-4399.61 2420.96,-4397.18 2421.69,-4404.14"/>
</g>
<!-- stage0_expert_layer_0_expert_5_gpu_2&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge125" class="edge">
<title>stage0_expert_layer_0_expert_5_gpu_2&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M4363.61,-4466.5C4360.72,-4466.16 4357.85,-4465.84 4355,-4465.54 3846.67,-4411.59 3249.43,-4390.39 2913.79,-4382.3"/>
<polygon fill="black" stroke="black" points="2913.52,-4378.79 2903.44,-4382.05 2913.35,-4385.79 2913.52,-4378.79"/>
</g>
<!-- stage0_expert_layer_0_expert_6_gpu_3&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge126" class="edge">
<title>stage0_expert_layer_0_expert_6_gpu_3&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M1556.4,-4466.61C1559.29,-4466.24 1562.16,-4465.88 1565,-4465.54 1855.1,-4430.43 2190.58,-4405.63 2410.8,-4391.49"/>
<polygon fill="black" stroke="black" points="2411.11,-4394.98 2420.87,-4390.85 2410.66,-4388 2411.11,-4394.98"/>
</g>
<!-- stage0_expert_layer_0_expert_7_gpu_3&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge127" class="edge">
<title>stage0_expert_layer_0_expert_7_gpu_3&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M626.38,-4466.46C629.28,-4466.14 632.15,-4465.83 635,-4465.54 1266.23,-4401.07 2013.42,-4383.78 2396.15,-4379.18"/>
<polygon fill="black" stroke="black" points="2396.28,-4382.67 2406.24,-4379.06 2396.2,-4375.68 2396.28,-4382.67"/>
</g>
<!-- stage0_expert_layer_0_expert_8_gpu_4&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge128" class="edge">
<title>stage0_expert_layer_0_expert_8_gpu_4&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M4053.61,-4466.54C4050.72,-4466.19 4047.84,-4465.86 4045,-4465.54 3654.77,-4421.86 3200.51,-4398.24 2919.08,-4386.77"/>
<polygon fill="black" stroke="black" points="2918.86,-4383.26 2908.72,-4386.35 2918.57,-4390.26 2918.86,-4383.26"/>
</g>
<!-- stage0_expert_layer_0_expert_9_gpu_4&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge129" class="edge">
<title>stage0_expert_layer_0_expert_9_gpu_4&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M3132.79,-4465.53C3075.76,-4455.14 3007.27,-4442.65 2940.03,-4430.4"/>
<polygon fill="black" stroke="black" points="2940.59,-4426.94 2930.12,-4428.59 2939.33,-4433.83 2940.59,-4426.94"/>
</g>
<!-- stage0_expert_layer_0_expert_10_gpu_5&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge130" class="edge">
<title>stage0_expert_layer_0_expert_10_gpu_5&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M3434,-4466.79C3430.97,-4466.37 3427.97,-4465.95 3425,-4465.54 3266.16,-4443.72 3088.46,-4423.26 2943.33,-4407.57"/>
<polygon fill="black" stroke="black" points="2943.69,-4404.09 2933.38,-4406.5 2942.94,-4411.05 2943.69,-4404.09"/>
</g>
<!-- stage0_expert_layer_0_expert_11_gpu_5&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge131" class="edge">
<title>stage0_expert_layer_0_expert_11_gpu_5&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M936.39,-4466.5C939.28,-4466.16 942.15,-4465.84 945,-4465.54 1460.07,-4410.87 2066.43,-4389.83 2399.44,-4381.99"/>
<polygon fill="black" stroke="black" points="2399.79,-4385.48 2409.7,-4381.75 2399.62,-4378.48 2399.79,-4385.48"/>
</g>
<!-- stage0_expert_layer_0_expert_12_gpu_6&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge132" class="edge">
<title>stage0_expert_layer_0_expert_12_gpu_6&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M2891.2,-4465.46C2864.01,-4455.55 2831.62,-4443.74 2799.55,-4432.05"/>
<polygon fill="black" stroke="black" points="2800.66,-4428.73 2790.07,-4428.6 2798.26,-4435.31 2800.66,-4428.73"/>
</g>
<!-- stage0_expert_layer_0_expert_13_gpu_6&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge133" class="edge">
<title>stage0_expert_layer_0_expert_13_gpu_6&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M2408.8,-4465.46C2435.99,-4455.55 2468.38,-4443.74 2500.45,-4432.05"/>
<polygon fill="black" stroke="black" points="2501.74,-4435.31 2509.93,-4428.6 2499.34,-4428.73 2501.74,-4435.31"/>
</g>
<!-- stage0_expert_layer_0_expert_14_gpu_7&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge134" class="edge">
<title>stage0_expert_layer_0_expert_14_gpu_7&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M316.38,-4466.44C319.28,-4466.12 322.15,-4465.82 325,-4465.54 1074.04,-4391.24 1964.52,-4378.48 2393.65,-4377.04"/>
<polygon fill="black" stroke="black" points="2393.71,-4380.54 2403.7,-4377 2393.69,-4373.54 2393.71,-4380.54"/>
</g>
<!-- stage0_expert_layer_0_expert_15_gpu_7&#45;&gt;stage0_expert_agg_layer_0 -->
<g id="edge135" class="edge">
<title>stage0_expert_layer_0_expert_15_gpu_7&#45;&gt;stage0_expert_agg_layer_0</title>
<path fill="none" stroke="black" d="M4673.62,-4466.46C4670.72,-4466.14 4667.85,-4465.83 4665,-4465.54 4037.23,-4401.42 3294.75,-4383.97 2910.17,-4379.25"/>
<polygon fill="black" stroke="black" points="2910.06,-4375.75 2900.02,-4379.13 2909.98,-4382.75 2910.06,-4375.75"/>
</g>
<!-- stage0_expert_agg_layer_0&#45;&gt;stage0_residual2_layer_0 -->
<g id="edge136" class="edge">
<title>stage0_expert_agg_layer_0&#45;&gt;stage0_residual2_layer_0</title>
<path fill="none" stroke="black" d="M2874.92,-4358.7C3230.8,-4332.06 3919.99,-4280.48 4278.25,-4253.66"/>
<polygon fill="black" stroke="black" points="4278.51,-4257.15 4288.22,-4252.91 4277.99,-4250.17 4278.51,-4257.15"/>
</g>
<!-- stage0_ln1_layer_1 -->
<g id="node43" class="node">
<title>stage0_ln1_layer_1</title>
<polygon fill="#ff0080" stroke="black" points="3580,-4125.54 3296,-4125.54 3296,-4073.54 3580,-4073.54 3580,-4125.54"/>
<text text-anchor="middle" x="3438" y="-4113.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="3438" y="-4102.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3438" y="-4091.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3438" y="-4080.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (sharded)</text>
</g>
<!-- stage0_residual2_layer_0&#45;&gt;stage0_ln1_layer_1 -->
<g id="edge138" class="edge">
<title>stage0_residual2_layer_0&#45;&gt;stage0_ln1_layer_1</title>
<path fill="none" stroke="black" d="M4224.38,-4199.11C4021.26,-4173.65 3755.22,-4140.3 3590.51,-4119.66"/>
<polygon fill="black" stroke="black" points="3590.66,-4116.15 3580.3,-4118.38 3589.79,-4123.09 3590.66,-4116.15"/>
</g>
<!-- stage0_residual1_layer_1 -->
<g id="node62" class="node">
<title>stage0_residual1_layer_1</title>
<polygon fill="#ffffcc" stroke="black" points="4668.82,-3584.54 4190.28,-3584.54 4067.18,-3480.54 4545.72,-3480.54 4668.82,-3584.54"/>
<text text-anchor="middle" x="4368" y="-3546.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="4368" y="-3535.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4368" y="-3524.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4368" y="-3513.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (all&#45;reduce)</text>
</g>
<!-- stage0_residual2_layer_0&#45;&gt;stage0_residual1_layer_1 -->
<g id="edge221" class="edge">
<title>stage0_residual2_layer_0&#45;&gt;stage0_residual1_layer_1</title>
<path fill="none" stroke="black" d="M4529.8,-4183.41C4538.79,-4158.86 4547,-4128.7 4547,-4100.54 4547,-4100.54 4547,-4100.54 4547,-3646.54 4547,-3624.27 4536.97,-3606.22 4521.67,-3591.63"/>
<polygon fill="black" stroke="black" points="4523.59,-3588.66 4513.75,-3584.74 4519,-3593.94 4523.59,-3588.66"/>
</g>
<!-- stage0_qkv_layer_1_gpu_0 -->
<g id="node44" class="node">
<title>stage0_qkv_layer_1_gpu_0</title>
<polygon fill="#ff0080" stroke="black" points="4214,-4036.54 3918,-4036.54 3918,-3962.54 4214,-3962.54 4214,-4036.54"/>
<text text-anchor="middle" x="4066" y="-4024.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4066" y="-4013.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4066" y="-4002.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4066" y="-3991.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4066" y="-3980.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4066" y="-3969.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_0 -->
<g id="edge139" class="edge">
<title>stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_0</title>
<path fill="none" stroke="black" d="M3580.24,-4083.36C3671.31,-4072.8 3792.15,-4057.22 3907.66,-4036.73"/>
<polygon fill="black" stroke="black" points="3908.52,-4040.13 3917.74,-4034.93 3907.28,-4033.24 3908.52,-4040.13"/>
</g>
<!-- stage0_qkv_layer_1_gpu_1 -->
<g id="node45" class="node">
<title>stage0_qkv_layer_1_gpu_1</title>
<polygon fill="#ff1480" stroke="black" points="2958,-4036.54 2662,-4036.54 2662,-3962.54 2958,-3962.54 2958,-4036.54"/>
<text text-anchor="middle" x="2810" y="-4024.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2810" y="-4013.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2810" y="-4002.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2810" y="-3991.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2810" y="-3980.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2810" y="-3969.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_1 -->
<g id="edge148" class="edge">
<title>stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_1</title>
<path fill="none" stroke="black" d="M3295.76,-4083.36C3204.69,-4072.8 3083.85,-4057.22 2968.34,-4036.73"/>
<polygon fill="black" stroke="black" points="2968.72,-4033.24 2958.26,-4034.93 2967.48,-4040.13 2968.72,-4033.24"/>
</g>
<!-- stage0_qkv_layer_1_gpu_2 -->
<g id="node46" class="node">
<title>stage0_qkv_layer_1_gpu_2</title>
<polygon fill="#ff2880" stroke="black" points="3272,-4036.54 2976,-4036.54 2976,-3962.54 3272,-3962.54 3272,-4036.54"/>
<text text-anchor="middle" x="3124" y="-4024.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3124" y="-4013.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3124" y="-4002.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3124" y="-3991.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3124" y="-3980.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3124" y="-3969.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_2 -->
<g id="edge157" class="edge">
<title>stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_2</title>
<path fill="none" stroke="black" d="M3357.54,-4073.43C3324.6,-4063.15 3285.71,-4051.01 3249.2,-4039.62"/>
<polygon fill="black" stroke="black" points="3250.07,-4036.22 3239.48,-4036.58 3247.98,-4042.9 3250.07,-4036.22"/>
</g>
<!-- stage0_qkv_layer_1_gpu_3 -->
<g id="node47" class="node">
<title>stage0_qkv_layer_1_gpu_3</title>
<polygon fill="#ff3c80" stroke="black" points="2644,-4036.54 2348,-4036.54 2348,-3962.54 2644,-3962.54 2644,-4036.54"/>
<text text-anchor="middle" x="2496" y="-4024.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2496" y="-4013.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2496" y="-4002.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2496" y="-3991.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2496" y="-3980.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2496" y="-3969.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_3 -->
<g id="edge166" class="edge">
<title>stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_3</title>
<path fill="none" stroke="black" d="M3295.82,-4093.58C3140.33,-4086.72 2883.78,-4071.21 2654.43,-4036.69"/>
<polygon fill="black" stroke="black" points="2654.63,-4033.18 2644.22,-4035.13 2653.58,-4040.1 2654.63,-4033.18"/>
</g>
<!-- stage0_qkv_layer_1_gpu_4 -->
<g id="node48" class="node">
<title>stage0_qkv_layer_1_gpu_4</title>
<polygon fill="#ff5080" stroke="black" points="2330,-4036.54 2034,-4036.54 2034,-3962.54 2330,-3962.54 2330,-4036.54"/>
<text text-anchor="middle" x="2182" y="-4024.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2182" y="-4013.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2182" y="-4002.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2182" y="-3991.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2182" y="-3980.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2182" y="-3969.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_4 -->
<g id="edge175" class="edge">
<title>stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_4</title>
<path fill="none" stroke="black" d="M3295.86,-4098.17C3087.67,-4095.92 2687.76,-4085.11 2340.22,-4036.63"/>
<polygon fill="black" stroke="black" points="2340.6,-4033.15 2330.21,-4035.22 2339.62,-4040.08 2340.6,-4033.15"/>
</g>
<!-- stage0_qkv_layer_1_gpu_5 -->
<g id="node49" class="node">
<title>stage0_qkv_layer_1_gpu_5</title>
<polygon fill="#ff6480" stroke="black" points="3900,-4036.54 3604,-4036.54 3604,-3962.54 3900,-3962.54 3900,-4036.54"/>
<text text-anchor="middle" x="3752" y="-4024.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3752" y="-4013.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3752" y="-4002.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3752" y="-3991.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3752" y="-3980.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3752" y="-3969.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_5 -->
<g id="edge184" class="edge">
<title>stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_5</title>
<path fill="none" stroke="black" d="M3518.46,-4073.43C3551.4,-4063.15 3590.29,-4051.01 3626.8,-4039.62"/>
<polygon fill="black" stroke="black" points="3628.02,-4042.9 3636.52,-4036.58 3625.93,-4036.22 3628.02,-4042.9"/>
</g>
<!-- stage0_qkv_layer_1_gpu_6 -->
<g id="node50" class="node">
<title>stage0_qkv_layer_1_gpu_6</title>
<polygon fill="#ff7880" stroke="black" points="4528,-4036.54 4232,-4036.54 4232,-3962.54 4528,-3962.54 4528,-4036.54"/>
<text text-anchor="middle" x="4380" y="-4024.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4380" y="-4013.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4380" y="-4002.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4380" y="-3991.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4380" y="-3980.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4380" y="-3969.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_6 -->
<g id="edge193" class="edge">
<title>stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_6</title>
<path fill="none" stroke="black" d="M3580.18,-4093.58C3735.67,-4086.72 3992.22,-4071.21 4221.57,-4036.69"/>
<polygon fill="black" stroke="black" points="4222.42,-4040.1 4231.78,-4035.13 4221.37,-4033.18 4222.42,-4040.1"/>
</g>
<!-- stage0_qkv_layer_1_gpu_7 -->
<g id="node51" class="node">
<title>stage0_qkv_layer_1_gpu_7</title>
<polygon fill="#ff8c80" stroke="black" points="3586,-4036.54 3290,-4036.54 3290,-3962.54 3586,-3962.54 3586,-4036.54"/>
<text text-anchor="middle" x="3438" y="-4024.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3438" y="-4013.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3438" y="-4002.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3438" y="-3991.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3438" y="-3980.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3438" y="-3969.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_7 -->
<g id="edge202" class="edge">
<title>stage0_ln1_layer_1&#45;&gt;stage0_qkv_layer_1_gpu_7</title>
<path fill="none" stroke="black" d="M3438,-4073.3C3438,-4065.23 3438,-4056.01 3438,-4046.92"/>
<polygon fill="black" stroke="black" points="3441.5,-4046.77 3438,-4036.77 3434.5,-4046.77 3441.5,-4046.77"/>
</g>
<!-- stage0_attention_layer_1_gpu_0 -->
<g id="node52" class="node">
<title>stage0_attention_layer_1_gpu_0</title>
<polygon fill="#ff0080" stroke="black" points="4196.5,-3925.54 3907.5,-3925.54 3907.5,-3851.54 4196.5,-3851.54 4196.5,-3925.54"/>
<text text-anchor="middle" x="4052" y="-3913.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4052" y="-3902.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4052" y="-3891.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4052" y="-3880.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4052" y="-3869.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4052" y="-3858.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_0 -->
<g id="edge140" class="edge">
<title>stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_0</title>
<path fill="none" stroke="black" d="M4061.34,-3962.24C4060.25,-3953.79 4059.08,-3944.67 4057.95,-3935.84"/>
<polygon fill="black" stroke="black" points="4061.39,-3935.15 4056.64,-3925.68 4054.44,-3936.04 4061.39,-3935.15"/>
</g>
<!-- stage0_attention_layer_1_gpu_1 -->
<g id="node53" class="node">
<title>stage0_attention_layer_1_gpu_1</title>
<polygon fill="#ff1480" stroke="black" points="3582.5,-3925.54 3293.5,-3925.54 3293.5,-3851.54 3582.5,-3851.54 3582.5,-3925.54"/>
<text text-anchor="middle" x="3438" y="-3913.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3438" y="-3902.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3438" y="-3891.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3438" y="-3880.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3438" y="-3869.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3438" y="-3858.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_1 -->
<g id="edge150" class="edge">
<title>stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3917.75,-3964.09C3914.81,-3963.56 3911.89,-3963.04 3909,-3962.54 3772.36,-3938.97 3733.47,-3949.45 3592.47,-3925.54"/>
<polygon fill="blue" stroke="blue" points="3593.03,-3922.09 3582.58,-3923.84 3591.84,-3928.99 3593.03,-3922.09"/>
</g>
<!-- stage0_attention_layer_1_gpu_2 -->
<g id="node54" class="node">
<title>stage0_attention_layer_1_gpu_2</title>
<polygon fill="#ff2880" stroke="black" points="3889.5,-3925.54 3600.5,-3925.54 3600.5,-3851.54 3889.5,-3851.54 3889.5,-3925.54"/>
<text text-anchor="middle" x="3745" y="-3913.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3745" y="-3902.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3745" y="-3891.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3745" y="-3880.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3745" y="-3869.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3745" y="-3858.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_2 -->
<g id="edge159" class="edge">
<title>stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3959.56,-3962.4C3927.83,-3951.62 3892.92,-3939.77 3860.63,-3928.8"/>
<polygon fill="blue" stroke="blue" points="3861.75,-3925.49 3851.15,-3925.59 3859.5,-3932.11 3861.75,-3925.49"/>
</g>
<!-- stage0_attention_layer_1_gpu_3 -->
<g id="node55" class="node">
<title>stage0_attention_layer_1_gpu_3</title>
<polygon fill="#ff3c80" stroke="black" points="2661.5,-3925.54 2372.5,-3925.54 2372.5,-3851.54 2661.5,-3851.54 2661.5,-3925.54"/>
<text text-anchor="middle" x="2517" y="-3913.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2517" y="-3902.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2517" y="-3891.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2517" y="-3880.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2517" y="-3869.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2517" y="-3858.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_3 -->
<g id="edge168" class="edge">
<title>stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3917.81,-3963.75C3914.85,-3963.32 3911.91,-3962.91 3909,-3962.54 3775.3,-3945.38 2846.69,-3943.42 2671.53,-3925.37"/>
<polygon fill="blue" stroke="blue" points="2671.86,-3921.88 2661.53,-3924.21 2671.06,-3928.83 2671.86,-3921.88"/>
</g>
<!-- stage0_attention_layer_1_gpu_4 -->
<g id="node56" class="node">
<title>stage0_attention_layer_1_gpu_4</title>
<polygon fill="#ff5080" stroke="black" points="3275.5,-3925.54 2986.5,-3925.54 2986.5,-3851.54 3275.5,-3851.54 3275.5,-3925.54"/>
<text text-anchor="middle" x="3131" y="-3913.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3131" y="-3902.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3131" y="-3891.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3131" y="-3880.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3131" y="-3869.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3131" y="-3858.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_4 -->
<g id="edge177" class="edge">
<title>stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3917.79,-3963.86C3914.84,-3963.4 3911.91,-3962.96 3909,-3962.54 3637.21,-3923.6 3561.69,-3964.54 3285.46,-3925.51"/>
<polygon fill="blue" stroke="blue" points="3285.94,-3922.04 3275.54,-3924.08 3284.95,-3928.97 3285.94,-3922.04"/>
</g>
<!-- stage0_attention_layer_1_gpu_5 -->
<g id="node57" class="node">
<title>stage0_attention_layer_1_gpu_5</title>
<polygon fill="#ff6480" stroke="black" points="2354.5,-3925.54 2065.5,-3925.54 2065.5,-3851.54 2354.5,-3851.54 2354.5,-3925.54"/>
<text text-anchor="middle" x="2210" y="-3913.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2210" y="-3902.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2210" y="-3891.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2210" y="-3880.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2210" y="-3869.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2210" y="-3858.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_5 -->
<g id="edge186" class="edge">
<title>stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3917.81,-3963.72C3914.85,-3963.3 3911.91,-3962.9 3909,-3962.54 3741.53,-3941.55 2575.2,-3947.05 2364.63,-3925.39"/>
<polygon fill="blue" stroke="blue" points="2364.86,-3921.89 2354.52,-3924.24 2364.06,-3928.85 2364.86,-3921.89"/>
</g>
<!-- stage0_attention_layer_1_gpu_6 -->
<g id="node58" class="node">
<title>stage0_attention_layer_1_gpu_6</title>
<polygon fill="#ff7880" stroke="black" points="4503.5,-3925.54 4214.5,-3925.54 4214.5,-3851.54 4503.5,-3851.54 4503.5,-3925.54"/>
<text text-anchor="middle" x="4359" y="-3913.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4359" y="-3902.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4359" y="-3891.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4359" y="-3880.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4359" y="-3869.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4359" y="-3858.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_6 -->
<g id="edge195" class="edge">
<title>stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4214.27,-3964.21C4217.2,-3963.64 4220.11,-3963.08 4223,-3962.54 4250.15,-3957.45 4325.64,-3963.21 4346,-3944.54 4348.97,-3941.82 4351.32,-3938.56 4353.17,-3935"/>
<polygon fill="blue" stroke="blue" points="4356.43,-3936.27 4356.83,-3925.69 4349.92,-3933.71 4356.43,-3936.27"/>
</g>
<!-- stage0_attention_layer_1_gpu_7 -->
<g id="node59" class="node">
<title>stage0_attention_layer_1_gpu_7</title>
<polygon fill="#ff8c80" stroke="black" points="2968.5,-3925.54 2679.5,-3925.54 2679.5,-3851.54 2968.5,-3851.54 2968.5,-3925.54"/>
<text text-anchor="middle" x="2824" y="-3913.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2824" y="-3902.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2824" y="-3891.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2824" y="-3880.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2824" y="-3869.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2824" y="-3858.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_7 -->
<g id="edge204" class="edge">
<title>stage0_qkv_layer_1_gpu_0&#45;&gt;stage0_attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3917.8,-3963.79C3914.85,-3963.34 3911.91,-3962.93 3909,-3962.54 3706.87,-3935.59 3198.86,-3952.8 2978.49,-3925.46"/>
<polygon fill="blue" stroke="blue" points="2978.9,-3921.98 2968.53,-3924.17 2978,-3928.93 2978.9,-3921.98"/>
</g>
<!-- stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_0 -->
<g id="edge141" class="edge">
<title>stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2958.19,-3963.7C2961.15,-3963.28 2964.09,-3962.89 2967,-3962.54 3023.64,-3955.62 3941.18,-3966.14 3994,-3944.54 4001.32,-3941.55 4008.25,-3937.16 4014.6,-3932.16"/>
<polygon fill="blue" stroke="blue" points="4017.01,-3934.7 4022.33,-3925.54 4012.46,-3929.39 4017.01,-3934.7"/>
</g>
<!-- stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_1 -->
<g id="edge149" class="edge">
<title>stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_1</title>
<path fill="none" stroke="black" d="M2958.21,-3963.85C2961.16,-3963.39 2964.09,-3962.95 2967,-3962.54 3109.8,-3942.35 3149.85,-3974.15 3291,-3944.54 3308.89,-3940.79 3327.5,-3935.22 3345.22,-3929.06"/>
<polygon fill="black" stroke="black" points="3346.72,-3932.24 3354.96,-3925.58 3344.36,-3925.65 3346.72,-3932.24"/>
</g>
<!-- stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_2 -->
<g id="edge160" class="edge">
<title>stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2958.19,-3963.74C2961.15,-3963.31 2964.09,-3962.91 2967,-3962.54 3105.49,-3944.85 3457.9,-3970.91 3595,-3944.54 3613.79,-3940.92 3633.34,-3935.27 3651.88,-3928.93"/>
<polygon fill="blue" stroke="blue" points="3653.2,-3932.17 3661.48,-3925.55 3650.88,-3925.57 3653.2,-3932.17"/>
</g>
<!-- stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_3 -->
<g id="edge169" class="edge">
<title>stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2694.31,-3962.46C2677.35,-3956.72 2660.16,-3950.65 2644,-3944.54 2631.82,-3939.93 2619.11,-3934.81 2606.63,-3929.6"/>
<polygon fill="blue" stroke="blue" points="2607.73,-3926.26 2597.15,-3925.61 2605.01,-3932.72 2607.73,-3926.26"/>
</g>
<!-- stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_4 -->
<g id="edge178" class="edge">
<title>stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2958.25,-3964.13C2961.19,-3963.58 2964.11,-3963.05 2967,-3962.54 2998.54,-3956.95 3084.81,-3964.32 3110,-3944.54 3113.44,-3941.84 3116.31,-3938.51 3118.72,-3934.83"/>
<polygon fill="blue" stroke="blue" points="3121.93,-3936.24 3123.52,-3925.76 3115.75,-3932.96 3121.93,-3936.24"/>
</g>
<!-- stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_5 -->
<g id="edge187" class="edge">
<title>stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2661.78,-3963.91C2658.83,-3963.43 2655.9,-3962.97 2653,-3962.54 2541.51,-3945.89 2510.98,-3964.32 2400,-3944.54 2377,-3940.44 2352.81,-3934.63 2329.68,-3928.32"/>
<polygon fill="blue" stroke="blue" points="2330.41,-3924.89 2319.84,-3925.59 2328.54,-3931.64 2330.41,-3924.89"/>
</g>
<!-- stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_6 -->
<g id="edge196" class="edge">
<title>stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2958.19,-3963.69C2961.15,-3963.28 2964.09,-3962.89 2967,-3962.54 3218.75,-3932.03 3855.77,-3970.77 4108,-3944.54 4141.72,-3941.03 4177.54,-3934.76 4211.24,-3927.67"/>
<polygon fill="blue" stroke="blue" points="4212.11,-3931.07 4221.16,-3925.55 4210.65,-3924.22 4212.11,-3931.07"/>
</g>
<!-- stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_7 -->
<g id="edge205" class="edge">
<title>stage0_qkv_layer_1_gpu_1&#45;&gt;stage0_attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2814.66,-3962.24C2815.75,-3953.79 2816.92,-3944.67 2818.05,-3935.84"/>
<polygon fill="blue" stroke="blue" points="2821.56,-3936.04 2819.36,-3925.68 2814.61,-3935.15 2821.56,-3936.04"/>
</g>
<!-- stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_0 -->
<g id="edge142" class="edge">
<title>stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3272.19,-3963.73C3275.15,-3963.3 3278.09,-3962.91 3281,-3962.54 3320.86,-3957.52 3967.63,-3961.62 4004,-3944.54 4010.17,-3941.64 4015.86,-3937.54 4021.01,-3932.86"/>
<polygon fill="blue" stroke="blue" points="4023.58,-3935.23 4028.15,-3925.67 4018.62,-3930.3 4023.58,-3935.23"/>
</g>
<!-- stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_1 -->
<g id="edge151" class="edge">
<title>stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3272.25,-3964.13C3275.19,-3963.58 3278.11,-3963.05 3281,-3962.54 3312.32,-3956.98 3398.99,-3965.4 3423,-3944.54 3426.11,-3941.84 3428.6,-3938.57 3430.59,-3934.98"/>
<polygon fill="blue" stroke="blue" points="3433.91,-3936.13 3434.6,-3925.56 3427.47,-3933.39 3433.91,-3936.13"/>
</g>
<!-- stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_2 -->
<g id="edge158" class="edge">
<title>stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_2</title>
<path fill="none" stroke="black" d="M3272.21,-3963.85C3275.16,-3963.39 3278.09,-3962.95 3281,-3962.54 3423.36,-3942.4 3463.5,-3975.04 3604,-3944.54 3621.06,-3940.83 3638.77,-3935.35 3655.64,-3929.25"/>
<polygon fill="black" stroke="black" points="3657.3,-3932.37 3665.46,-3925.6 3654.87,-3925.8 3657.3,-3932.37"/>
</g>
<!-- stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_3 -->
<g id="edge170" class="edge">
<title>stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2975.78,-3963.91C2972.83,-3963.43 2969.9,-3962.97 2967,-3962.54 2854.63,-3945.79 2823.93,-3964.06 2712,-3944.54 2688.32,-3940.41 2663.39,-3934.56 2639.56,-3928.22"/>
<polygon fill="blue" stroke="blue" points="2640.35,-3924.8 2629.78,-3925.57 2638.52,-3931.56 2640.35,-3924.8"/>
</g>
<!-- stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_4 -->
<g id="edge179" class="edge">
<title>stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3126.33,-3962.24C3126.87,-3953.79 3127.46,-3944.67 3128.03,-3935.84"/>
<polygon fill="blue" stroke="blue" points="3131.53,-3935.88 3128.68,-3925.68 3124.55,-3935.43 3131.53,-3935.88"/>
</g>
<!-- stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_5 -->
<g id="edge188" class="edge">
<title>stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2975.8,-3963.76C2972.85,-3963.33 2969.91,-3962.92 2967,-3962.54 2733.29,-3932.06 2670.52,-3976.45 2437,-3944.54 2408.12,-3940.59 2377.57,-3934.53 2348.55,-3927.84"/>
<polygon fill="blue" stroke="blue" points="2349.31,-3924.43 2338.78,-3925.55 2347.71,-3931.24 2349.31,-3924.43"/>
</g>
<!-- stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_6 -->
<g id="edge197" class="edge">
<title>stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3272.19,-3963.71C3275.15,-3963.29 3278.09,-3962.9 3281,-3962.54 3650.25,-3916.72 3748.46,-3988 4118,-3944.54 4149.44,-3940.84 4182.77,-3934.71 4214.3,-3927.85"/>
<polygon fill="blue" stroke="blue" points="4215.45,-3931.18 4224.46,-3925.6 4213.94,-3924.34 4215.45,-3931.18"/>
</g>
<!-- stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_7 -->
<g id="edge206" class="edge">
<title>stage0_qkv_layer_1_gpu_2&#45;&gt;stage0_attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2975.67,-3964.52C2972.75,-3963.85 2969.86,-3963.19 2967,-3962.54 2931.89,-3954.51 2920.16,-3960.75 2888,-3944.54 2881.1,-3941.06 2874.33,-3936.68 2867.92,-3931.92"/>
<polygon fill="blue" stroke="blue" points="2870.05,-3929.14 2860.03,-3925.72 2865.73,-3934.65 2870.05,-3929.14"/>
</g>
<!-- stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_0 -->
<g id="edge143" class="edge">
<title>stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2644.19,-3963.68C2647.14,-3963.27 2650.08,-3962.89 2653,-3962.54 2724.99,-3953.89 3888.15,-3963.99 3958,-3944.54 3969.53,-3941.33 3981.1,-3936.35 3991.99,-3930.66"/>
<polygon fill="blue" stroke="blue" points="3993.87,-3933.62 4000.96,-3925.75 3990.51,-3927.48 3993.87,-3933.62"/>
</g>
<!-- stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_1 -->
<g id="edge152" class="edge">
<title>stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2644.19,-3963.74C2647.15,-3963.31 2650.09,-3962.91 2653,-3962.54 2790.38,-3944.98 3139.69,-3969.07 3276,-3944.54 3296.22,-3940.9 3317.35,-3935.21 3337.41,-3928.85"/>
<polygon fill="blue" stroke="blue" points="3338.73,-3932.09 3347.16,-3925.67 3336.57,-3925.44 3338.73,-3932.09"/>
</g>
<!-- stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_2 -->
<g id="edge161" class="edge">
<title>stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2644.19,-3963.7C2647.15,-3963.29 2650.09,-3962.9 2653,-3962.54 2858.6,-3937.26 3381.02,-3980.65 3585,-3944.54 3605.26,-3940.95 3626.41,-3935.21 3646.44,-3928.76"/>
<polygon fill="blue" stroke="blue" points="3647.78,-3932.01 3656.18,-3925.55 3645.59,-3925.36 3647.78,-3932.01"/>
</g>
<!-- stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_3 -->
<g id="edge167" class="edge">
<title>stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_3</title>
<path fill="none" stroke="black" d="M2502.99,-3962.24C2504.64,-3953.69 2506.42,-3944.47 2508.13,-3935.56"/>
<polygon fill="black" stroke="black" points="2511.58,-3936.16 2510.04,-3925.68 2504.71,-3934.83 2511.58,-3936.16"/>
</g>
<!-- stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_4 -->
<g id="edge180" class="edge">
<title>stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2644.2,-3963.79C2647.15,-3963.35 2650.09,-3962.93 2653,-3962.54 2702.38,-3955.94 3058.68,-3970.82 3101,-3944.54 3105.45,-3941.78 3109.28,-3938.11 3112.58,-3933.97"/>
<polygon fill="blue" stroke="blue" points="3115.57,-3935.8 3118.28,-3925.56 3109.77,-3931.88 3115.57,-3935.8"/>
</g>
<!-- stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_5 -->
<g id="edge189" class="edge">
<title>stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2383.08,-3962.44C2366.53,-3956.71 2349.76,-3950.64 2334,-3944.54 2322.1,-3939.93 2309.68,-3934.81 2297.5,-3929.59"/>
<polygon fill="blue" stroke="blue" points="2298.81,-3926.35 2288.24,-3925.6 2296.04,-3932.77 2298.81,-3926.35"/>
</g>
<!-- stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_6 -->
<g id="edge198" class="edge">
<title>stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2644.19,-3963.68C2647.14,-3963.27 2650.08,-3962.89 2653,-3962.54 2971.87,-3924.44 3778.26,-3974.46 4098,-3944.54 4133.61,-3941.21 4171.49,-3934.88 4207.03,-3927.67"/>
<polygon fill="blue" stroke="blue" points="4207.91,-3931.06 4216.99,-3925.61 4206.49,-3924.2 4207.91,-3931.06"/>
</g>
<!-- stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_7 -->
<g id="edge207" class="edge">
<title>stage0_qkv_layer_1_gpu_3&#45;&gt;stage0_attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2644.25,-3964.11C2647.19,-3963.57 2650.11,-3963.04 2653,-3962.54 2685.86,-3956.8 2775.56,-3964.86 2802,-3944.54 2805.49,-3941.86 2808.42,-3938.54 2810.89,-3934.87"/>
<polygon fill="blue" stroke="blue" points="2814.12,-3936.26 2815.86,-3925.81 2807.98,-3932.9 2814.12,-3936.26"/>
</g>
<!-- stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_0 -->
<g id="edge144" class="edge">
<title>stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2330.19,-3963.72C2333.15,-3963.3 2336.09,-3962.9 2339,-3962.54 2508.1,-3941.37 3685.77,-3947.35 3897.05,-3925.58"/>
<polygon fill="blue" stroke="blue" points="3897.64,-3929.03 3907.18,-3924.42 3896.85,-3922.08 3897.64,-3929.03"/>
</g>
<!-- stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_1 -->
<g id="edge153" class="edge">
<title>stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2330.2,-3963.78C2333.15,-3963.34 2336.09,-3962.93 2339,-3962.54 2544.39,-3935.22 3060.59,-3953.31 3283.12,-3925.67"/>
<polygon fill="blue" stroke="blue" points="3283.71,-3929.12 3293.17,-3924.36 3282.8,-3922.18 3283.71,-3929.12"/>
</g>
<!-- stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_2 -->
<g id="edge162" class="edge">
<title>stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2330.19,-3963.75C2333.15,-3963.32 2336.09,-3962.91 2339,-3962.54 2612.07,-3927.54 3299.44,-3960.93 3590.01,-3925.68"/>
<polygon fill="blue" stroke="blue" points="3590.69,-3929.12 3600.18,-3924.4 3589.82,-3922.18 3590.69,-3929.12"/>
</g>
<!-- stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_3 -->
<g id="edge171" class="edge">
<title>stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2293.08,-3962.4C2326.19,-3951.62 2362.63,-3939.77 2396.32,-3928.8"/>
<polygon fill="blue" stroke="blue" points="2397.79,-3932.01 2406.22,-3925.59 2395.62,-3925.35 2397.79,-3932.01"/>
</g>
<!-- stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_4 -->
<g id="edge176" class="edge">
<title>stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_4</title>
<path fill="none" stroke="black" d="M2330.21,-3963.86C2333.16,-3963.39 2336.09,-3962.95 2339,-3962.54 2617.33,-3922.86 2694.68,-3965.47 2976.07,-3925.74"/>
<polygon fill="black" stroke="black" points="2976.76,-3929.17 2986.16,-3924.29 2975.77,-3922.25 2976.76,-3929.17"/>
</g>
<!-- stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_5 -->
<g id="edge190" class="edge">
<title>stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2191.32,-3962.24C2193.52,-3953.69 2195.89,-3944.47 2198.18,-3935.56"/>
<polygon fill="blue" stroke="blue" points="2201.62,-3936.23 2200.72,-3925.68 2194.84,-3934.49 2201.62,-3936.23"/>
</g>
<!-- stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_6 -->
<g id="edge199" class="edge">
<title>stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2330.19,-3963.71C2333.15,-3963.29 2336.09,-3962.9 2339,-3962.54 2541.91,-3937.53 3957.78,-3951.09 4203.98,-3925.6"/>
<polygon fill="blue" stroke="blue" points="4204.64,-3929.04 4214.18,-3924.43 4203.85,-3922.09 4204.64,-3929.04"/>
</g>
<!-- stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_7 -->
<g id="edge208" class="edge">
<title>stage0_qkv_layer_1_gpu_4&#45;&gt;stage0_attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2330.24,-3964.07C2333.18,-3963.54 2336.11,-3963.03 2339,-3962.54 2482.09,-3938.24 2522.88,-3950.24 2668.9,-3925.83"/>
<polygon fill="blue" stroke="blue" points="2669.86,-3929.22 2679.13,-3924.09 2668.69,-3922.32 2669.86,-3929.22"/>
</g>
<!-- stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_0 -->
<g id="edge145" class="edge">
<title>stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3900.26,-3964.19C3903.2,-3963.63 3906.11,-3963.07 3909,-3962.54 3937.03,-3957.35 4014.46,-3963.21 4036,-3944.54 4039.08,-3941.87 4041.59,-3938.64 4043.62,-3935.1"/>
<polygon fill="blue" stroke="blue" points="4046.89,-3936.37 4047.77,-3925.82 4040.49,-3933.52 4046.89,-3936.37"/>
</g>
<!-- stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_1 -->
<g id="edge154" class="edge">
<title>stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3603.75,-3963.97C3576.07,-3956.84 3551.59,-3949.89 3538,-3944.54 3527.59,-3940.44 3516.91,-3935.48 3506.58,-3930.22"/>
<polygon fill="blue" stroke="blue" points="3508.1,-3927.07 3497.61,-3925.55 3504.86,-3933.28 3508.1,-3927.07"/>
</g>
<!-- stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_2 -->
<g id="edge163" class="edge">
<title>stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3749.67,-3962.24C3749.13,-3953.79 3748.54,-3944.67 3747.97,-3935.84"/>
<polygon fill="blue" stroke="blue" points="3751.45,-3935.43 3747.32,-3925.68 3744.47,-3935.88 3751.45,-3935.43"/>
</g>
<!-- stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_3 -->
<g id="edge172" class="edge">
<title>stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3603.81,-3963.71C3600.85,-3963.29 3597.91,-3962.9 3595,-3962.54 3231.49,-3917.37 3135.3,-3982.86 2771,-3944.54 2737.1,-3940.97 2701.09,-3934.72 2667.17,-3927.68"/>
<polygon fill="blue" stroke="blue" points="2667.7,-3924.22 2657.19,-3925.58 2666.25,-3931.07 2667.7,-3924.22"/>
</g>
<!-- stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_4 -->
<g id="edge181" class="edge">
<title>stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3603.8,-3963.81C3600.84,-3963.36 3597.91,-3962.94 3595,-3962.54 3509.04,-3950.8 3286.72,-3973.69 3205,-3944.54 3196.05,-3941.35 3187.27,-3936.68 3179.06,-3931.38"/>
<polygon fill="blue" stroke="blue" points="3180.96,-3928.44 3170.73,-3925.68 3177.01,-3934.22 3180.96,-3928.44"/>
</g>
<!-- stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_5 -->
<g id="edge185" class="edge">
<title>stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_5</title>
<path fill="none" stroke="black" d="M3603.81,-3963.69C3600.85,-3963.28 3597.91,-3962.89 3595,-3962.54 3347.45,-3932.51 2721.26,-3968.02 2473,-3944.54 2437.24,-3941.16 2399.19,-3934.83 2363.47,-3927.64"/>
<polygon fill="black" stroke="black" points="2363.96,-3924.17 2353.46,-3925.59 2362.56,-3931.03 2363.96,-3924.17"/>
</g>
<!-- stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_6 -->
<g id="edge200" class="edge">
<title>stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3900.2,-3963.82C3903.16,-3963.37 3906.09,-3962.94 3909,-3962.54 3990.77,-3951.27 4201.87,-3971.16 4280,-3944.54 4289.49,-3941.31 4298.87,-3936.57 4307.68,-3931.21"/>
<polygon fill="blue" stroke="blue" points="4309.76,-3934.03 4316.27,-3925.67 4305.97,-3928.14 4309.76,-3934.03"/>
</g>
<!-- stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_7 -->
<g id="edge209" class="edge">
<title>stage0_qkv_layer_1_gpu_5&#45;&gt;stage0_attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3603.81,-3963.74C3600.85,-3963.31 3597.91,-3962.91 3595,-3962.54 3452.1,-3944.35 3087.45,-3976.56 2947,-3944.54 2931.85,-3941.08 2916.27,-3935.72 2901.52,-3929.67"/>
<polygon fill="blue" stroke="blue" points="2902.53,-3926.29 2891.95,-3925.6 2899.79,-3932.73 2902.53,-3926.29"/>
</g>
<!-- stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_0 -->
<g id="edge146" class="edge">
<title>stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4271.24,-3962.4C4238.82,-3951.62 4203.14,-3939.77 4170.15,-3928.8"/>
<polygon fill="blue" stroke="blue" points="4171.06,-3925.42 4160.47,-3925.59 4168.86,-3932.06 4171.06,-3925.42"/>
</g>
<!-- stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_1 -->
<g id="edge155" class="edge">
<title>stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4231.79,-3963.86C4228.84,-3963.4 4225.91,-3962.95 4223,-3962.54 3948.16,-3923.25 3871.8,-3964.88 3592.56,-3925.52"/>
<polygon fill="blue" stroke="blue" points="3592.94,-3922.04 3582.54,-3924.09 3591.95,-3928.97 3592.94,-3922.04"/>
</g>
<!-- stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_2 -->
<g id="edge164" class="edge">
<title>stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4231.76,-3964.08C4228.82,-3963.55 4225.89,-3963.03 4223,-3962.54 4083.35,-3938.63 4043.58,-3949.77 3899.67,-3925.58"/>
<polygon fill="blue" stroke="blue" points="3900.03,-3922.09 3889.58,-3923.85 3898.85,-3928.99 3900.03,-3922.09"/>
</g>
<!-- stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_3 -->
<g id="edge173" class="edge">
<title>stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4231.81,-3963.72C4228.85,-3963.3 4225.91,-3962.9 4223,-3962.54 4054.77,-3941.47 2883.15,-3947.14 2671.67,-3925.39"/>
<polygon fill="blue" stroke="blue" points="2671.86,-3921.89 2661.52,-3924.24 2671.06,-3928.85 2671.86,-3921.89"/>
</g>
<!-- stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_4 -->
<g id="edge182" class="edge">
<title>stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4231.8,-3963.79C4228.85,-3963.34 4225.91,-3962.93 4223,-3962.54 4019.35,-3935.41 3507.53,-3952.97 3285.56,-3925.47"/>
<polygon fill="blue" stroke="blue" points="3285.9,-3921.98 3275.53,-3924.17 3285,-3928.93 3285.9,-3921.98"/>
</g>
<!-- stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_5 -->
<g id="edge191" class="edge">
<title>stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4231.81,-3963.71C4228.85,-3963.29 4225.91,-3962.9 4223,-3962.54 4020.96,-3937.63 2611.17,-3950.85 2364.73,-3925.41"/>
<polygon fill="blue" stroke="blue" points="2364.85,-3921.9 2354.52,-3924.25 2364.06,-3928.86 2364.85,-3921.9"/>
</g>
<!-- stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_6 -->
<g id="edge194" class="edge">
<title>stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_6</title>
<path fill="none" stroke="black" d="M4373.01,-3962.24C4371.36,-3953.69 4369.58,-3944.47 4367.87,-3935.56"/>
<polygon fill="black" stroke="black" points="4371.29,-3934.83 4365.96,-3925.68 4364.42,-3936.16 4371.29,-3934.83"/>
</g>
<!-- stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_7 -->
<g id="edge210" class="edge">
<title>stage0_qkv_layer_1_gpu_6&#45;&gt;stage0_attention_layer_1_gpu_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4231.81,-3963.75C4228.85,-3963.32 4225.91,-3962.91 4223,-3962.54 4088.55,-3945.29 3154.69,-3943.5 2978.58,-3925.37"/>
<polygon fill="blue" stroke="blue" points="2978.86,-3921.88 2968.53,-3924.21 2978.06,-3928.83 2978.86,-3921.88"/>
</g>
<!-- stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_0 -->
<g id="edge147" class="edge">
<title>stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_0</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3586.2,-3963.79C3589.15,-3963.35 3592.09,-3962.93 3595,-3962.54 3642.5,-3956.16 3986.05,-3971.03 4026,-3944.54 4030.08,-3941.84 4033.53,-3938.31 4036.45,-3934.35"/>
<polygon fill="blue" stroke="blue" points="4039.49,-3936.09 4041.73,-3925.73 4033.52,-3932.43 4039.49,-3936.09"/>
</g>
<!-- stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_1 -->
<g id="edge156" class="edge">
<title>stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3438,-3962.24C3438,-3953.79 3438,-3944.67 3438,-3935.84"/>
<polygon fill="blue" stroke="blue" points="3441.5,-3935.68 3438,-3925.68 3434.5,-3935.68 3441.5,-3935.68"/>
</g>
<!-- stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_2 -->
<g id="edge165" class="edge">
<title>stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3561.13,-3962.48C3578.96,-3956.76 3597.02,-3950.69 3614,-3944.54 3626.78,-3939.91 3640.13,-3934.72 3653.22,-3929.43"/>
<polygon fill="blue" stroke="blue" points="3654.75,-3932.59 3662.68,-3925.57 3652.1,-3926.11 3654.75,-3932.59"/>
</g>
<!-- stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_3 -->
<g id="edge174" class="edge">
<title>stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3289.8,-3963.76C3286.85,-3963.33 3283.91,-3962.92 3281,-3962.54 3046.4,-3931.96 2983.48,-3975.98 2749,-3944.54 2719.51,-3940.58 2688.29,-3934.52 2658.64,-3927.83"/>
<polygon fill="blue" stroke="blue" points="2659.18,-3924.36 2648.65,-3925.54 2657.62,-3931.19 2659.18,-3924.36"/>
</g>
<!-- stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_4 -->
<g id="edge183" class="edge">
<title>stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3289.75,-3964.13C3286.81,-3963.58 3283.89,-3963.05 3281,-3962.54 3249.24,-3956.93 3159.62,-3967.52 3137,-3944.54 3134.43,-3941.93 3132.49,-3938.87 3131.05,-3935.56"/>
<polygon fill="blue" stroke="blue" points="3134.35,-3934.37 3128.22,-3925.73 3127.63,-3936.31 3134.35,-3934.37"/>
</g>
<!-- stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_5 -->
<g id="edge192" class="edge">
<title>stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3289.81,-3963.71C3286.85,-3963.29 3283.91,-3962.9 3281,-3962.54 2918.37,-3917.47 2822.23,-3984.53 2459,-3944.54 2426.1,-3940.92 2391.18,-3934.72 2358.22,-3927.76"/>
<polygon fill="blue" stroke="blue" points="2358.57,-3924.26 2348.06,-3925.58 2357.1,-3931.1 2358.57,-3924.26"/>
</g>
<!-- stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_6 -->
<g id="edge201" class="edge">
<title>stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3586.19,-3963.74C3589.15,-3963.31 3592.09,-3962.91 3595,-3962.54 3737.9,-3944.35 4102.91,-3978.12 4243,-3944.54 4257.26,-3941.12 4271.86,-3935.82 4285.68,-3929.84"/>
<polygon fill="blue" stroke="blue" points="4287.42,-3932.9 4295.1,-3925.61 4284.55,-3926.51 4287.42,-3932.9"/>
</g>
<!-- stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_7 -->
<g id="edge203" class="edge">
<title>stage0_qkv_layer_1_gpu_7&#45;&gt;stage0_attention_layer_1_gpu_7</title>
<path fill="none" stroke="black" d="M3289.79,-3963.83C3286.84,-3963.37 3283.91,-3962.94 3281,-3962.54 3202.54,-3951.65 3001.24,-3966.02 2925,-3944.54 2912.87,-3941.12 2900.58,-3936.05 2888.95,-3930.34"/>
<polygon fill="black" stroke="black" points="2890.27,-3927.08 2879.77,-3925.64 2887.08,-3933.31 2890.27,-3927.08"/>
</g>
<!-- stage0_attention_reduce_layer_1 -->
<g id="node60" class="node">
<title>stage0_attention_reduce_layer_1</title>
<polygon fill="#ffcccc" stroke="black" points="3741.54,-3814.54 3258.68,-3814.54 3134.46,-3710.54 3617.32,-3710.54 3741.54,-3814.54"/>
<text text-anchor="middle" x="3438" y="-3776.54" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="3438" y="-3765.54" font-family="Arial" font-size="10.00">Input: [8Ã— batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3438" y="-3754.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3438" y="-3743.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (all&#45;reduce)</text>
</g>
<!-- stage0_attention_layer_1_gpu_0&#45;&gt;stage0_attention_reduce_layer_1 -->
<g id="edge211" class="edge">
<title>stage0_attention_layer_1_gpu_0&#45;&gt;stage0_attention_reduce_layer_1</title>
<path fill="none" stroke="black" d="M3907.48,-3853.36C3904.63,-3852.74 3901.8,-3852.14 3899,-3851.54 3843.06,-3839.63 3783.15,-3827.63 3725.63,-3816.49"/>
<polygon fill="black" stroke="black" points="3726.16,-3813.03 3715.68,-3814.57 3724.83,-3819.9 3726.16,-3813.03"/>
</g>
<!-- stage0_attention_layer_1_gpu_1&#45;&gt;stage0_attention_reduce_layer_1 -->
<g id="edge212" class="edge">
<title>stage0_attention_layer_1_gpu_1&#45;&gt;stage0_attention_reduce_layer_1</title>
<path fill="none" stroke="black" d="M3438,-3851.34C3438,-3843.03 3438,-3833.97 3438,-3824.92"/>
<polygon fill="black" stroke="black" points="3441.5,-3824.76 3438,-3814.76 3434.5,-3824.76 3441.5,-3824.76"/>
</g>
<!-- stage0_attention_layer_1_gpu_2&#45;&gt;stage0_attention_reduce_layer_1 -->
<g id="edge213" class="edge">
<title>stage0_attention_layer_1_gpu_2&#45;&gt;stage0_attention_reduce_layer_1</title>
<path fill="none" stroke="black" d="M3655.79,-3851.51C3630.18,-3841.16 3601.66,-3829.64 3573.92,-3818.44"/>
<polygon fill="black" stroke="black" points="3575.12,-3815.15 3564.54,-3814.65 3572.5,-3821.64 3575.12,-3815.15"/>
</g>
<!-- stage0_attention_layer_1_gpu_3&#45;&gt;stage0_attention_reduce_layer_1 -->
<g id="edge214" class="edge">
<title>stage0_attention_layer_1_gpu_3&#45;&gt;stage0_attention_reduce_layer_1</title>
<path fill="none" stroke="black" d="M2661.58,-3853.23C2664.75,-3852.64 2667.89,-3852.08 2671,-3851.54 2850.78,-3820.32 3056.25,-3797.42 3209.25,-3782.82"/>
<polygon fill="black" stroke="black" points="3209.63,-3786.3 3219.25,-3781.87 3208.97,-3779.33 3209.63,-3786.3"/>
</g>
<!-- stage0_attention_layer_1_gpu_4&#45;&gt;stage0_attention_reduce_layer_1 -->
<g id="edge215" class="edge">
<title>stage0_attention_layer_1_gpu_4&#45;&gt;stage0_attention_reduce_layer_1</title>
<path fill="none" stroke="black" d="M3220.21,-3851.51C3245.82,-3841.16 3274.34,-3829.64 3302.08,-3818.44"/>
<polygon fill="black" stroke="black" points="3303.5,-3821.64 3311.46,-3814.65 3300.88,-3815.15 3303.5,-3821.64"/>
</g>
<!-- stage0_attention_layer_1_gpu_5&#45;&gt;stage0_attention_reduce_layer_1 -->
<g id="edge216" class="edge">
<title>stage0_attention_layer_1_gpu_5&#45;&gt;stage0_attention_reduce_layer_1</title>
<path fill="none" stroke="black" d="M2354.56,-3853.09C2357.73,-3852.55 2360.88,-3852.03 2364,-3851.54 2648.87,-3806.82 2980.03,-3784.05 3198.48,-3773.01"/>
<polygon fill="black" stroke="black" points="3198.66,-3776.51 3208.47,-3772.51 3198.31,-3769.52 3198.66,-3776.51"/>
</g>
<!-- stage0_attention_layer_1_gpu_6&#45;&gt;stage0_attention_reduce_layer_1 -->
<g id="edge217" class="edge">
<title>stage0_attention_layer_1_gpu_6&#45;&gt;stage0_attention_reduce_layer_1</title>
<path fill="none" stroke="black" d="M4214.13,-3853C4211.4,-3852.49 4208.69,-3852.01 4206,-3851.54 4045.42,-3823.55 3864.33,-3802.31 3718.35,-3787.71"/>
<polygon fill="black" stroke="black" points="3718.64,-3784.22 3708.34,-3786.72 3717.94,-3791.19 3718.64,-3784.22"/>
</g>
<!-- stage0_attention_layer_1_gpu_7&#45;&gt;stage0_attention_reduce_layer_1 -->
<g id="edge218" class="edge">
<title>stage0_attention_layer_1_gpu_7&#45;&gt;stage0_attention_reduce_layer_1</title>
<path fill="none" stroke="black" d="M2968.64,-3853.55C2971.79,-3852.87 2974.91,-3852.2 2978,-3851.54 3060.37,-3834.04 3151.39,-3816.3 3230.57,-3801.37"/>
<polygon fill="black" stroke="black" points="3231.48,-3804.76 3240.66,-3799.47 3230.19,-3797.88 3231.48,-3804.76"/>
</g>
<!-- stage0_out_proj_layer_1 -->
<g id="node61" class="node">
<title>stage0_out_proj_layer_1</title>
<polygon fill="#ff0080" stroke="black" points="4133,-3673.54 3849,-3673.54 3849,-3621.54 4133,-3621.54 4133,-3673.54"/>
<text text-anchor="middle" x="3991" y="-3661.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="3991" y="-3650.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3991" y="-3639.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3991" y="-3628.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (sharded)</text>
</g>
<!-- stage0_attention_reduce_layer_1&#45;&gt;stage0_out_proj_layer_1 -->
<g id="edge219" class="edge">
<title>stage0_attention_reduce_layer_1&#45;&gt;stage0_out_proj_layer_1</title>
<path fill="none" stroke="black" d="M3631.41,-3722.02C3706.52,-3706.67 3790.64,-3689.48 3858.63,-3675.59"/>
<polygon fill="black" stroke="black" points="3859.44,-3678.99 3868.54,-3673.56 3858.04,-3672.14 3859.44,-3678.99"/>
</g>
<!-- stage0_out_proj_layer_1&#45;&gt;stage0_residual1_layer_1 -->
<g id="edge220" class="edge">
<title>stage0_out_proj_layer_1&#45;&gt;stage0_residual1_layer_1</title>
<path fill="none" stroke="black" d="M4074.67,-3621.46C4108.24,-3611.4 4148.31,-3599.39 4187.88,-3587.53"/>
<polygon fill="black" stroke="black" points="4189.09,-3590.82 4197.66,-3584.6 4187.08,-3584.11 4189.09,-3590.82"/>
</g>
<!-- stage0_ln2_layer_1 -->
<g id="node63" class="node">
<title>stage0_ln2_layer_1</title>
<polygon fill="#ff0080" stroke="black" points="3002,-3443.54 2718,-3443.54 2718,-3391.54 3002,-3391.54 3002,-3443.54"/>
<text text-anchor="middle" x="2860" y="-3431.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2860" y="-3420.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2860" y="-3409.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2860" y="-3398.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (sharded)</text>
</g>
<!-- stage0_residual1_layer_1&#45;&gt;stage0_ln2_layer_1 -->
<g id="edge222" class="edge">
<title>stage0_residual1_layer_1&#45;&gt;stage0_ln2_layer_1</title>
<path fill="none" stroke="black" d="M4104.03,-3511.76C3787.77,-3488.06 3268.6,-3449.16 3012.55,-3429.97"/>
<polygon fill="black" stroke="black" points="3012.67,-3426.47 3002.43,-3429.21 3012.14,-3433.45 3012.67,-3426.47"/>
</g>
<!-- stage0_residual2_layer_1 -->
<g id="node82" class="node">
<title>stage0_residual2_layer_1</title>
<polygon fill="#ffffcc" stroke="black" points="4431.82,-2983.54 3953.28,-2983.54 3830.18,-2879.54 4308.72,-2879.54 4431.82,-2983.54"/>
<text text-anchor="middle" x="4131" y="-2945.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="4131" y="-2934.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4131" y="-2923.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4131" y="-2912.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (all&#45;reduce)</text>
</g>
<!-- stage0_residual1_layer_1&#45;&gt;stage0_residual2_layer_1 -->
<g id="edge273" class="edge">
<title>stage0_residual1_layer_1&#45;&gt;stage0_residual2_layer_1</title>
<path fill="none" stroke="black" d="M4583.36,-3512.03C4761.36,-3492.89 4985,-3460.5 4985,-3418.54 4985,-3418.54 4985,-3418.54 4985,-3071.54 4985,-3011.57 4652.74,-2972.34 4402.72,-2951.3"/>
<polygon fill="black" stroke="black" points="4403,-2947.81 4392.74,-2950.46 4402.41,-2954.78 4403,-2947.81"/>
</g>
<!-- stage0_gate_layer_1 -->
<g id="node64" class="node">
<title>stage0_gate_layer_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2921.38,-3354.54 2453.09,-3354.54 2332.62,-3250.54 2800.91,-3250.54 2921.38,-3354.54"/>
<text text-anchor="middle" x="2627" y="-3316.54" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="2627" y="-3305.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2627" y="-3294.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="2627" y="-3283.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (sharded)</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_gate_layer_1 -->
<g id="edge223" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_gate_layer_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2808.29,-3391.46C2788.52,-3381.87 2765.11,-3370.52 2741.79,-3359.21"/>
<polygon fill="black" stroke="black" points="2743.04,-3355.93 2732.51,-3354.71 2739.98,-3362.22 2743.04,-3355.93"/>
</g>
<!-- stage0_expert_layer_1_expert_0_gpu_0 -->
<g id="node65" class="node">
<title>stage0_expert_layer_1_expert_0_gpu_0</title>
<polygon fill="#ff0080" stroke="black" points="2796,-3213.54 2504,-3213.54 2504,-3161.54 2796,-3161.54 2796,-3213.54"/>
<text text-anchor="middle" x="2650" y="-3201.54" font-family="Arial" font-size="10.00">Expert0</text>
<text text-anchor="middle" x="2650" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2650" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2650" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_0_gpu_0 -->
<g id="edge225" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_0_gpu_0</title>
<path fill="none" stroke="black" d="M2899.62,-3391.42C2911.68,-3381.53 2923.47,-3369.05 2930,-3354.54 2948.97,-3312.39 2958.94,-3286.58 2930,-3250.54 2921.2,-3239.57 2865.65,-3226.21 2806.32,-3214.71"/>
<polygon fill="black" stroke="black" points="2806.86,-3211.25 2796.38,-3212.8 2805.54,-3218.12 2806.86,-3211.25"/>
</g>
<!-- stage0_expert_layer_1_expert_1_gpu_0 -->
<g id="node66" class="node">
<title>stage0_expert_layer_1_expert_1_gpu_0</title>
<polygon fill="#ff0080" stroke="black" points="2176,-3213.54 1884,-3213.54 1884,-3161.54 2176,-3161.54 2176,-3213.54"/>
<text text-anchor="middle" x="2030" y="-3201.54" font-family="Arial" font-size="10.00">Expert1</text>
<text text-anchor="middle" x="2030" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2030" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2030" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 0</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_1_gpu_0 -->
<g id="edge227" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_1_gpu_0</title>
<path fill="none" stroke="black" d="M2717.87,-3411.8C2618.36,-3406.64 2482.69,-3395.88 2365,-3373.54 2335.85,-3368 2328.1,-3366.61 2301,-3354.54 2215.54,-3316.47 2124.4,-3256.01 2072.6,-3219.51"/>
<polygon fill="black" stroke="black" points="2074.5,-3216.57 2064.32,-3213.65 2070.46,-3222.29 2074.5,-3216.57"/>
</g>
<!-- stage0_expert_layer_1_expert_2_gpu_1 -->
<g id="node67" class="node">
<title>stage0_expert_layer_1_expert_2_gpu_1</title>
<polygon fill="#ff1480" stroke="black" points="1246,-3213.54 954,-3213.54 954,-3161.54 1246,-3161.54 1246,-3213.54"/>
<text text-anchor="middle" x="1100" y="-3201.54" font-family="Arial" font-size="10.00">Expert2</text>
<text text-anchor="middle" x="1100" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1100" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1100" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_2_gpu_1 -->
<g id="edge229" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_2_gpu_1</title>
<path fill="none" stroke="black" d="M2717.8,-3415.47C2424.52,-3412.36 1761.44,-3400.32 1540,-3354.54 1398.73,-3325.34 1242.86,-3257.37 1159.85,-3218.06"/>
<polygon fill="black" stroke="black" points="1161.11,-3214.78 1150.58,-3213.64 1158.1,-3221.1 1161.11,-3214.78"/>
</g>
<!-- stage0_expert_layer_1_expert_3_gpu_1 -->
<g id="node68" class="node">
<title>stage0_expert_layer_1_expert_3_gpu_1</title>
<polygon fill="#ff1480" stroke="black" points="4036,-3213.54 3744,-3213.54 3744,-3161.54 4036,-3161.54 4036,-3213.54"/>
<text text-anchor="middle" x="3890" y="-3201.54" font-family="Arial" font-size="10.00">Expert3</text>
<text text-anchor="middle" x="3890" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3890" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3890" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 1</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_3_gpu_1 -->
<g id="edge231" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_3_gpu_1</title>
<path fill="none" stroke="black" d="M3002.36,-3396.73C3074.97,-3385.82 3164.51,-3371.13 3244,-3354.54 3440.59,-3313.5 3667.29,-3251.88 3793.09,-3216.4"/>
<polygon fill="black" stroke="black" points="3794.41,-3219.66 3803.08,-3213.58 3792.51,-3212.93 3794.41,-3219.66"/>
</g>
<!-- stage0_expert_layer_1_expert_4_gpu_2 -->
<g id="node69" class="node">
<title>stage0_expert_layer_1_expert_4_gpu_2</title>
<polygon fill="#ff2880" stroke="black" points="1866,-3213.54 1574,-3213.54 1574,-3161.54 1866,-3161.54 1866,-3213.54"/>
<text text-anchor="middle" x="1720" y="-3201.54" font-family="Arial" font-size="10.00">Expert4</text>
<text text-anchor="middle" x="1720" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1720" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1720" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_4_gpu_2 -->
<g id="edge233" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_4_gpu_2</title>
<path fill="none" stroke="black" d="M2717.95,-3410C2534.7,-3400.66 2226.4,-3381.56 2116,-3354.54 1989.1,-3323.48 1850.36,-3257.15 1775.46,-3218.39"/>
<polygon fill="black" stroke="black" points="1776.7,-3215.09 1766.21,-3213.58 1773.46,-3221.3 1776.7,-3215.09"/>
</g>
<!-- stage0_expert_layer_1_expert_5_gpu_2 -->
<g id="node70" class="node">
<title>stage0_expert_layer_1_expert_5_gpu_2</title>
<polygon fill="#ff2880" stroke="black" points="4656,-3213.54 4364,-3213.54 4364,-3161.54 4656,-3161.54 4656,-3213.54"/>
<text text-anchor="middle" x="4510" y="-3201.54" font-family="Arial" font-size="10.00">Expert5</text>
<text text-anchor="middle" x="4510" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4510" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4510" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 2</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_5_gpu_2 -->
<g id="edge235" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_5_gpu_2</title>
<path fill="none" stroke="black" d="M3002.31,-3411.95C3171.98,-3405.14 3463.77,-3389.23 3712,-3354.54 3960.73,-3319.77 4248.12,-3253.43 4401.03,-3216"/>
<polygon fill="black" stroke="black" points="4402.03,-3219.36 4410.9,-3213.58 4400.36,-3212.56 4402.03,-3219.36"/>
</g>
<!-- stage0_expert_layer_1_expert_6_gpu_3 -->
<g id="node71" class="node">
<title>stage0_expert_layer_1_expert_6_gpu_3</title>
<polygon fill="#ff3c80" stroke="black" points="1556,-3213.54 1264,-3213.54 1264,-3161.54 1556,-3161.54 1556,-3213.54"/>
<text text-anchor="middle" x="1410" y="-3201.54" font-family="Arial" font-size="10.00">Expert6</text>
<text text-anchor="middle" x="1410" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1410" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1410" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_6_gpu_3 -->
<g id="edge237" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_6_gpu_3</title>
<path fill="none" stroke="black" d="M2717.63,-3413.3C2477.53,-3406.93 2002.3,-3390.19 1839,-3354.54 1701.33,-3324.49 1549.63,-3257 1468.65,-3217.96"/>
<polygon fill="black" stroke="black" points="1470.13,-3214.79 1459.6,-3213.58 1467.08,-3221.09 1470.13,-3214.79"/>
</g>
<!-- stage0_expert_layer_1_expert_7_gpu_3 -->
<g id="node72" class="node">
<title>stage0_expert_layer_1_expert_7_gpu_3</title>
<polygon fill="#ff3c80" stroke="black" points="626,-3213.54 334,-3213.54 334,-3161.54 626,-3161.54 626,-3213.54"/>
<text text-anchor="middle" x="480" y="-3201.54" font-family="Arial" font-size="10.00">Expert7</text>
<text text-anchor="middle" x="480" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="480" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="480" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 3</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_7_gpu_3 -->
<g id="edge239" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_7_gpu_3</title>
<path fill="none" stroke="black" d="M2717.98,-3414.8C2299.97,-3409.3 1092.38,-3390.46 918,-3354.54 777.27,-3325.55 622.15,-3257.5 539.55,-3218.12"/>
<polygon fill="black" stroke="black" points="540.85,-3214.86 530.32,-3213.7 537.83,-3221.17 540.85,-3214.86"/>
</g>
<!-- stage0_expert_layer_1_expert_8_gpu_4 -->
<g id="node73" class="node">
<title>stage0_expert_layer_1_expert_8_gpu_4</title>
<polygon fill="#ff5080" stroke="black" points="4346,-3213.54 4054,-3213.54 4054,-3161.54 4346,-3161.54 4346,-3213.54"/>
<text text-anchor="middle" x="4200" y="-3201.54" font-family="Arial" font-size="10.00">Expert8</text>
<text text-anchor="middle" x="4200" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4200" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4200" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_8_gpu_4 -->
<g id="edge241" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_8_gpu_4</title>
<path fill="none" stroke="black" d="M3002.16,-3406.59C3124.13,-3396.92 3304.32,-3379.95 3460,-3354.54 3688.58,-3317.22 3952.41,-3252.81 4095.14,-3216.16"/>
<polygon fill="black" stroke="black" points="4096.39,-3219.45 4105.2,-3213.57 4094.64,-3212.68 4096.39,-3219.45"/>
</g>
<!-- stage0_expert_layer_1_expert_9_gpu_4 -->
<g id="node74" class="node">
<title>stage0_expert_layer_1_expert_9_gpu_4</title>
<polygon fill="#ff5080" stroke="black" points="3416,-3213.54 3124,-3213.54 3124,-3161.54 3416,-3161.54 3416,-3213.54"/>
<text text-anchor="middle" x="3270" y="-3201.54" font-family="Arial" font-size="10.00">Expert9</text>
<text text-anchor="middle" x="3270" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3270" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3270" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 4</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_9_gpu_4 -->
<g id="edge243" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_9_gpu_4</title>
<path fill="none" stroke="black" d="M2914.12,-3391.53C2926.03,-3385.79 2938.51,-3379.59 2950,-3373.54 3047.27,-3322.29 3157.66,-3256.78 3220.05,-3219.05"/>
<polygon fill="black" stroke="black" points="3222.16,-3221.86 3228.9,-3213.69 3218.54,-3215.88 3222.16,-3221.86"/>
</g>
<!-- stage0_expert_layer_1_expert_10_gpu_5 -->
<g id="node75" class="node">
<title>stage0_expert_layer_1_expert_10_gpu_5</title>
<polygon fill="#ff6480" stroke="black" points="3726,-3213.54 3434,-3213.54 3434,-3161.54 3726,-3161.54 3726,-3213.54"/>
<text text-anchor="middle" x="3580" y="-3201.54" font-family="Arial" font-size="10.00">Expert10</text>
<text text-anchor="middle" x="3580" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3580" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3580" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_10_gpu_5 -->
<g id="edge245" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_10_gpu_5</title>
<path fill="none" stroke="black" d="M2953.03,-3391.5C2992.6,-3380.57 3039.18,-3367.35 3081,-3354.54 3229.05,-3309.17 3399.95,-3251.06 3498.44,-3217"/>
<polygon fill="black" stroke="black" points="3499.73,-3220.26 3508.04,-3213.68 3497.44,-3213.64 3499.73,-3220.26"/>
</g>
<!-- stage0_expert_layer_1_expert_11_gpu_5 -->
<g id="node76" class="node">
<title>stage0_expert_layer_1_expert_11_gpu_5</title>
<polygon fill="#ff6480" stroke="black" points="936,-3213.54 644,-3213.54 644,-3161.54 936,-3161.54 936,-3213.54"/>
<text text-anchor="middle" x="790" y="-3201.54" font-family="Arial" font-size="10.00">Expert11</text>
<text text-anchor="middle" x="790" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="790" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="790" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 5</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_11_gpu_5 -->
<g id="edge247" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_11_gpu_5</title>
<path fill="none" stroke="black" d="M2717.98,-3417.11C2375.46,-3417.53 1511.42,-3412.61 1229,-3354.54 1087.98,-3325.54 932.5,-3257.5 849.69,-3218.12"/>
<polygon fill="black" stroke="black" points="850.98,-3214.85 840.45,-3213.69 847.96,-3221.17 850.98,-3214.85"/>
</g>
<!-- stage0_expert_layer_1_expert_12_gpu_6 -->
<g id="node77" class="node">
<title>stage0_expert_layer_1_expert_12_gpu_6</title>
<polygon fill="#ff7880" stroke="black" points="3106,-3213.54 2814,-3213.54 2814,-3161.54 3106,-3161.54 3106,-3213.54"/>
<text text-anchor="middle" x="2960" y="-3201.54" font-family="Arial" font-size="10.00">Expert12</text>
<text text-anchor="middle" x="2960" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2960" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2960" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_12_gpu_6 -->
<g id="edge249" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_12_gpu_6</title>
<path fill="none" stroke="black" d="M2927.17,-3391.45C2934.09,-3386.46 2940.3,-3380.54 2945,-3373.54 2975.03,-3328.86 2972.25,-3263.7 2966.7,-3223.83"/>
<polygon fill="black" stroke="black" points="2970.13,-3223.13 2965.16,-3213.77 2963.21,-3224.19 2970.13,-3223.13"/>
</g>
<!-- stage0_expert_layer_1_expert_13_gpu_6 -->
<g id="node78" class="node">
<title>stage0_expert_layer_1_expert_13_gpu_6</title>
<polygon fill="#ff7880" stroke="black" points="2486,-3213.54 2194,-3213.54 2194,-3161.54 2486,-3161.54 2486,-3213.54"/>
<text text-anchor="middle" x="2340" y="-3201.54" font-family="Arial" font-size="10.00">Expert13</text>
<text text-anchor="middle" x="2340" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2340" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2340" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 6</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_13_gpu_6 -->
<g id="edge251" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_13_gpu_6</title>
<path fill="none" stroke="black" d="M2717.77,-3409.72C2567.88,-3401.04 2349.88,-3383.59 2324,-3354.54 2292.26,-3318.92 2308.01,-3260.38 2323.26,-3223.18"/>
<polygon fill="black" stroke="black" points="2326.58,-3224.33 2327.31,-3213.76 2320.15,-3221.57 2326.58,-3224.33"/>
</g>
<!-- stage0_expert_layer_1_expert_14_gpu_7 -->
<g id="node79" class="node">
<title>stage0_expert_layer_1_expert_14_gpu_7</title>
<polygon fill="#ff8c80" stroke="black" points="316,-3213.54 24,-3213.54 24,-3161.54 316,-3161.54 316,-3213.54"/>
<text text-anchor="middle" x="170" y="-3201.54" font-family="Arial" font-size="10.00">Expert14</text>
<text text-anchor="middle" x="170" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="170" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="170" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_14_gpu_7 -->
<g id="edge253" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_14_gpu_7</title>
<path fill="none" stroke="black" d="M2717.85,-3415.46C2255.69,-3411.58 813.56,-3396.21 608,-3354.54 466.99,-3325.95 311.67,-3257.59 229.18,-3218.08"/>
<polygon fill="black" stroke="black" points="230.5,-3214.83 219.98,-3213.65 227.47,-3221.14 230.5,-3214.83"/>
</g>
<!-- stage0_expert_layer_1_expert_15_gpu_7 -->
<g id="node80" class="node">
<title>stage0_expert_layer_1_expert_15_gpu_7</title>
<polygon fill="#ff8c80" stroke="black" points="4966,-3213.54 4674,-3213.54 4674,-3161.54 4966,-3161.54 4966,-3213.54"/>
<text text-anchor="middle" x="4820" y="-3201.54" font-family="Arial" font-size="10.00">Expert15</text>
<text text-anchor="middle" x="4820" y="-3190.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4820" y="-3179.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4820" y="-3168.54" font-family="Arial" font-size="10.00">GPU: 7</text>
</g>
<!-- stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_15_gpu_7 -->
<g id="edge255" class="edge">
<title>stage0_ln2_layer_1&#45;&gt;stage0_expert_layer_1_expert_15_gpu_7</title>
<path fill="none" stroke="black" d="M3002.4,-3415.08C3216.16,-3411.45 3632.35,-3398.77 3983,-3354.54 4245.19,-3321.47 4548.41,-3253.88 4708.15,-3215.94"/>
<polygon fill="black" stroke="black" points="4709.08,-3219.32 4718,-3213.6 4707.46,-3212.51 4709.08,-3219.32"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_0_gpu_0 -->
<g id="edge224" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_0_gpu_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2637.42,-3250.33C2639.27,-3241.28 2641.14,-3232.05 2642.87,-3223.57"/>
<polygon fill="red" stroke="red" points="2646.32,-3224.17 2644.88,-3213.67 2639.46,-3222.77 2646.32,-3224.17"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_1_gpu_0 -->
<g id="edge226" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_1_gpu_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2357.32,-3250.49C2293.48,-3238.41 2227.87,-3225.99 2172.31,-3215.47"/>
<polygon fill="red" stroke="red" points="2172.88,-3212.02 2162.41,-3213.6 2171.58,-3218.9 2172.88,-3212.02"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_2_gpu_1 -->
<g id="edge228" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_2_gpu_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2381.64,-3292.9C2108.94,-3281.66 1655.45,-3258.11 1256.4,-3213.65"/>
<polygon fill="red" stroke="red" points="1256.72,-3210.17 1246.39,-3212.53 1255.94,-3217.13 1256.72,-3210.17"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_3_gpu_1 -->
<g id="edge230" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_3_gpu_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2846.16,-3289.36C3067.65,-3275.84 3419.84,-3251.03 3733.4,-3213.69"/>
<polygon fill="red" stroke="red" points="3734.09,-3217.14 3743.6,-3212.47 3733.26,-3210.19 3734.09,-3217.14"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_4_gpu_2 -->
<g id="edge232" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_4_gpu_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2337.66,-3255.07C2276.47,-3246.31 2212.2,-3237.92 2152,-3231.54 2032.55,-3218.88 1999.33,-3226.93 1876.57,-3213.66"/>
<polygon fill="red" stroke="red" points="1876.72,-3210.15 1866.39,-3212.53 1875.95,-3217.11 1876.72,-3210.15"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_5_gpu_2 -->
<g id="edge234" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_5_gpu_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2855.78,-3297.82C3185.16,-3290.68 3812.02,-3270.41 4353.64,-3213.64"/>
<polygon fill="red" stroke="red" points="4354.04,-3217.11 4363.61,-3212.59 4353.3,-3210.15 4354.04,-3217.11"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_6_gpu_3 -->
<g id="edge236" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_6_gpu_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2373.78,-3286.08C2160.79,-3271.77 1848.13,-3247.72 1566.41,-3213.68"/>
<polygon fill="red" stroke="red" points="1566.75,-3210.19 1556.4,-3212.46 1565.91,-3217.14 1566.75,-3210.19"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_7_gpu_3 -->
<g id="edge238" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_7_gpu_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2379.71,-3291.38C1879.31,-3270.72 782.38,-3224.86 636.41,-3213.49"/>
<polygon fill="red" stroke="red" points="636.65,-3210 626.38,-3212.61 636.04,-3216.97 636.65,-3210"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_8_gpu_4 -->
<g id="edge240" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_8_gpu_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2852,-3294.38C3129.96,-3283.98 3617.36,-3260.69 4043.55,-3213.66"/>
<polygon fill="red" stroke="red" points="4044.06,-3217.12 4053.61,-3212.54 4043.28,-3210.17 4044.06,-3217.12"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_9_gpu_4 -->
<g id="edge242" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_9_gpu_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2820.79,-3267.48C2915.96,-3250.76 3028.95,-3230.9 3117.8,-3215.29"/>
<polygon fill="red" stroke="red" points="3118.44,-3218.73 3127.69,-3213.55 3117.23,-3211.83 3118.44,-3218.73"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_10_gpu_5 -->
<g id="edge244" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_10_gpu_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2831.95,-3277.2C2950.77,-3263.31 3103.27,-3245.87 3239,-3231.54 3318.45,-3223.15 3340.94,-3224.07 3423.5,-3213.69"/>
<polygon fill="red" stroke="red" points="3424.12,-3217.14 3433.59,-3212.41 3423.23,-3210.2 3424.12,-3217.14"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_11_gpu_5 -->
<g id="edge246" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_11_gpu_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2386.47,-3297.09C2061.58,-3289.23 1464.51,-3268.3 946.68,-3213.67"/>
<polygon fill="red" stroke="red" points="946.7,-3210.15 936.39,-3212.58 945.96,-3217.12 946.7,-3210.15"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_12_gpu_6 -->
<g id="edge248" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_12_gpu_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2777.43,-3250.49C2811.49,-3238.94 2846.45,-3227.07 2876.55,-3216.86"/>
<polygon fill="red" stroke="red" points="2877.8,-3220.13 2886.14,-3213.6 2875.55,-3213.5 2877.8,-3220.13"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_13_gpu_6 -->
<g id="edge250" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_13_gpu_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2497.35,-3250.49C2468.51,-3239.14 2438.91,-3227.48 2413.27,-3217.39"/>
<polygon fill="red" stroke="red" points="2414.24,-3214.01 2403.65,-3213.6 2411.68,-3220.52 2414.24,-3214.01"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_14_gpu_7 -->
<g id="edge252" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_14_gpu_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2391.89,-3301.98C1976.47,-3300.66 1085.56,-3288.45 326.43,-3213.63"/>
<polygon fill="red" stroke="red" points="326.68,-3210.14 316.38,-3212.64 325.99,-3217.1 326.68,-3210.14"/>
</g>
<!-- stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_15_gpu_7 -->
<g id="edge254" class="edge">
<title>stage0_gate_layer_1&#45;&gt;stage0_expert_layer_1_expert_15_gpu_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2858.77,-3300.32C3235.63,-3296.38 4004.6,-3280.18 4663.44,-3213.65"/>
<polygon fill="red" stroke="red" points="4664.02,-3217.11 4673.62,-3212.62 4663.31,-3210.14 4664.02,-3217.11"/>
</g>
<!-- stage0_expert_agg_layer_1 -->
<g id="node81" class="node">
<title>stage0_expert_agg_layer_1</title>
<polygon fill="#ffcccc" stroke="black" points="2959.98,-3124.54 2466.87,-3124.54 2340.02,-3020.54 2833.13,-3020.54 2959.98,-3124.54"/>
<text text-anchor="middle" x="2650" y="-3086.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2650" y="-3075.54" font-family="Arial" font-size="10.00">Input: [8Ã— batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2650" y="-3064.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="2650" y="-3053.54" font-family="Arial" font-size="10.00">GPU: 0&#45;7 (all&#45;reduce)</text>
</g>
<!-- stage0_expert_layer_1_expert_0_gpu_0&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge256" class="edge">
<title>stage0_expert_layer_1_expert_0_gpu_0&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M2650,-3161.46C2650,-3153.53 2650,-3144.4 2650,-3135.08"/>
<polygon fill="black" stroke="black" points="2653.5,-3134.94 2650,-3124.94 2646.5,-3134.94 2653.5,-3134.94"/>
</g>
<!-- stage0_expert_layer_1_expert_1_gpu_0&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge257" class="edge">
<title>stage0_expert_layer_1_expert_1_gpu_0&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M2167.21,-3161.53C2246.97,-3146.99 2349.16,-3128.37 2438.96,-3112"/>
<polygon fill="black" stroke="black" points="2439.79,-3115.41 2449,-3110.17 2438.54,-3108.52 2439.79,-3115.41"/>
</g>
<!-- stage0_expert_layer_1_expert_2_gpu_1&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge258" class="edge">
<title>stage0_expert_layer_1_expert_2_gpu_1&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M1246.39,-3162.54C1249.28,-3162.19 1252.16,-3161.86 1255,-3161.54 1656.1,-3116.65 2124.84,-3092.94 2404.03,-3081.84"/>
<polygon fill="black" stroke="black" points="2404.44,-3085.33 2414.29,-3081.44 2404.16,-3078.34 2404.44,-3085.33"/>
</g>
<!-- stage0_expert_layer_1_expert_3_gpu_1&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge259" class="edge">
<title>stage0_expert_layer_1_expert_3_gpu_1&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M3743.6,-3162.61C3740.71,-3162.24 3737.84,-3161.88 3735,-3161.54 3461.07,-3128.39 3146.67,-3104.43 2927.07,-3089.96"/>
<polygon fill="black" stroke="black" points="2927.22,-3086.46 2917.01,-3089.3 2926.76,-3093.45 2927.22,-3086.46"/>
</g>
<!-- stage0_expert_layer_1_expert_4_gpu_2&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge260" class="edge">
<title>stage0_expert_layer_1_expert_4_gpu_2&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M1866,-3162.79C1869.03,-3162.37 1872.03,-3161.95 1875,-3161.54 2058.29,-3136.37 2266.68,-3113 2421.17,-3096.68"/>
<polygon fill="black" stroke="black" points="2421.69,-3100.14 2431.27,-3095.61 2420.96,-3093.18 2421.69,-3100.14"/>
</g>
<!-- stage0_expert_layer_1_expert_5_gpu_2&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge261" class="edge">
<title>stage0_expert_layer_1_expert_5_gpu_2&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M4363.61,-3162.5C4360.72,-3162.16 4357.85,-3161.84 4355,-3161.54 3846.67,-3107.59 3249.43,-3086.39 2913.79,-3078.3"/>
<polygon fill="black" stroke="black" points="2913.52,-3074.79 2903.44,-3078.05 2913.35,-3081.79 2913.52,-3074.79"/>
</g>
<!-- stage0_expert_layer_1_expert_6_gpu_3&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge262" class="edge">
<title>stage0_expert_layer_1_expert_6_gpu_3&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M1556.4,-3162.61C1559.29,-3162.24 1562.16,-3161.88 1565,-3161.54 1855.1,-3126.43 2190.58,-3101.63 2410.8,-3087.49"/>
<polygon fill="black" stroke="black" points="2411.11,-3090.98 2420.87,-3086.85 2410.66,-3084 2411.11,-3090.98"/>
</g>
<!-- stage0_expert_layer_1_expert_7_gpu_3&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge263" class="edge">
<title>stage0_expert_layer_1_expert_7_gpu_3&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M626.38,-3162.46C629.28,-3162.14 632.15,-3161.83 635,-3161.54 1266.23,-3097.07 2013.42,-3079.78 2396.15,-3075.18"/>
<polygon fill="black" stroke="black" points="2396.28,-3078.67 2406.24,-3075.06 2396.2,-3071.68 2396.28,-3078.67"/>
</g>
<!-- stage0_expert_layer_1_expert_8_gpu_4&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge264" class="edge">
<title>stage0_expert_layer_1_expert_8_gpu_4&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M4053.61,-3162.54C4050.72,-3162.19 4047.84,-3161.86 4045,-3161.54 3654.77,-3117.86 3200.51,-3094.24 2919.08,-3082.77"/>
<polygon fill="black" stroke="black" points="2918.86,-3079.26 2908.72,-3082.35 2918.57,-3086.26 2918.86,-3079.26"/>
</g>
<!-- stage0_expert_layer_1_expert_9_gpu_4&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge265" class="edge">
<title>stage0_expert_layer_1_expert_9_gpu_4&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M3132.79,-3161.53C3075.76,-3151.14 3007.27,-3138.65 2940.03,-3126.4"/>
<polygon fill="black" stroke="black" points="2940.59,-3122.94 2930.12,-3124.59 2939.33,-3129.83 2940.59,-3122.94"/>
</g>
<!-- stage0_expert_layer_1_expert_10_gpu_5&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge266" class="edge">
<title>stage0_expert_layer_1_expert_10_gpu_5&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M3434,-3162.79C3430.97,-3162.37 3427.97,-3161.95 3425,-3161.54 3266.16,-3139.72 3088.46,-3119.26 2943.33,-3103.57"/>
<polygon fill="black" stroke="black" points="2943.69,-3100.09 2933.38,-3102.5 2942.94,-3107.05 2943.69,-3100.09"/>
</g>
<!-- stage0_expert_layer_1_expert_11_gpu_5&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge267" class="edge">
<title>stage0_expert_layer_1_expert_11_gpu_5&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M936.39,-3162.5C939.28,-3162.16 942.15,-3161.84 945,-3161.54 1460.07,-3106.87 2066.43,-3085.83 2399.44,-3077.99"/>
<polygon fill="black" stroke="black" points="2399.79,-3081.48 2409.7,-3077.75 2399.62,-3074.48 2399.79,-3081.48"/>
</g>
<!-- stage0_expert_layer_1_expert_12_gpu_6&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge268" class="edge">
<title>stage0_expert_layer_1_expert_12_gpu_6&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M2891.2,-3161.46C2864.01,-3151.55 2831.62,-3139.74 2799.55,-3128.05"/>
<polygon fill="black" stroke="black" points="2800.66,-3124.73 2790.07,-3124.6 2798.26,-3131.31 2800.66,-3124.73"/>
</g>
<!-- stage0_expert_layer_1_expert_13_gpu_6&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge269" class="edge">
<title>stage0_expert_layer_1_expert_13_gpu_6&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M2408.8,-3161.46C2435.99,-3151.55 2468.38,-3139.74 2500.45,-3128.05"/>
<polygon fill="black" stroke="black" points="2501.74,-3131.31 2509.93,-3124.6 2499.34,-3124.73 2501.74,-3131.31"/>
</g>
<!-- stage0_expert_layer_1_expert_14_gpu_7&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge270" class="edge">
<title>stage0_expert_layer_1_expert_14_gpu_7&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M316.38,-3162.44C319.28,-3162.12 322.15,-3161.82 325,-3161.54 1074.04,-3087.24 1964.52,-3074.48 2393.65,-3073.04"/>
<polygon fill="black" stroke="black" points="2393.71,-3076.54 2403.7,-3073 2393.69,-3069.54 2393.71,-3076.54"/>
</g>
<!-- stage0_expert_layer_1_expert_15_gpu_7&#45;&gt;stage0_expert_agg_layer_1 -->
<g id="edge271" class="edge">
<title>stage0_expert_layer_1_expert_15_gpu_7&#45;&gt;stage0_expert_agg_layer_1</title>
<path fill="none" stroke="black" d="M4673.62,-3162.46C4670.72,-3162.14 4667.85,-3161.83 4665,-3161.54 4037.23,-3097.42 3294.75,-3079.97 2910.17,-3075.25"/>
<polygon fill="black" stroke="black" points="2910.06,-3071.75 2900.02,-3075.13 2909.98,-3078.75 2910.06,-3071.75"/>
</g>
<!-- stage0_expert_agg_layer_1&#45;&gt;stage0_residual2_layer_1 -->
<g id="edge272" class="edge">
<title>stage0_expert_agg_layer_1&#45;&gt;stage0_residual2_layer_1</title>
<path fill="none" stroke="black" d="M2870.52,-3050.84C3149.1,-3024.7 3625.91,-2979.94 3906.41,-2953.62"/>
<polygon fill="black" stroke="black" points="3907.09,-2957.07 3916.72,-2952.65 3906.43,-2950.1 3907.09,-2957.07"/>
</g>
<!-- stage1_ln1_layer_2 -->
<g id="node83" class="node">
<title>stage1_ln1_layer_2</title>
<polygon fill="#0080ff" stroke="black" points="4273,-2755.54 3989,-2755.54 3989,-2703.54 4273,-2703.54 4273,-2755.54"/>
<text text-anchor="middle" x="4131" y="-2743.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4131" y="-2732.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4131" y="-2721.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4131" y="-2710.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (sharded)</text>
</g>
<!-- stage0_residual2_layer_1&#45;&gt;stage1_ln1_layer_2 -->
<g id="edge274" class="edge">
<title>stage0_residual2_layer_1&#45;&gt;stage1_ln1_layer_2</title>
<path fill="none" stroke="purple" stroke-width="2" d="M4131,-2879.29C4131,-2843.73 4131,-2797.28 4131,-2765.81"/>
<polygon fill="purple" stroke="purple" stroke-width="2" points="4134.5,-2765.76 4131,-2755.76 4127.5,-2765.76 4134.5,-2765.76"/>
<text text-anchor="middle" x="4173.5" y="-2844.34" font-family="Times,serif" font-size="14.00">Send/Recv</text>
<text text-anchor="middle" x="4173.5" y="-2829.34" font-family="Times,serif" font-size="14.00">Stage 0 â†’ 1</text>
</g>
<!-- stage1_qkv_layer_2_gpu_8 -->
<g id="node84" class="node">
<title>stage1_qkv_layer_2_gpu_8</title>
<polygon fill="#0080ff" stroke="black" points="4593,-2666.54 4297,-2666.54 4297,-2592.54 4593,-2592.54 4593,-2666.54"/>
<text text-anchor="middle" x="4445" y="-2654.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4445" y="-2643.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4445" y="-2632.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4445" y="-2621.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4445" y="-2610.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4445" y="-2599.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_8 -->
<g id="edge275" class="edge">
<title>stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_8</title>
<path fill="none" stroke="black" d="M4211.46,-2703.43C4244.4,-2693.15 4283.29,-2681.01 4319.8,-2669.62"/>
<polygon fill="black" stroke="black" points="4321.02,-2672.9 4329.52,-2666.58 4318.93,-2666.22 4321.02,-2672.9"/>
</g>
<!-- stage1_qkv_layer_2_gpu_9 -->
<g id="node85" class="node">
<title>stage1_qkv_layer_2_gpu_9</title>
<polygon fill="#1e80ff" stroke="black" points="3337,-2666.54 3041,-2666.54 3041,-2592.54 3337,-2592.54 3337,-2666.54"/>
<text text-anchor="middle" x="3189" y="-2654.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3189" y="-2643.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3189" y="-2632.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3189" y="-2621.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3189" y="-2610.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3189" y="-2599.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_9 -->
<g id="edge284" class="edge">
<title>stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_9</title>
<path fill="none" stroke="black" d="M3988.82,-2723.58C3833.33,-2716.72 3576.78,-2701.21 3347.43,-2666.69"/>
<polygon fill="black" stroke="black" points="3347.63,-2663.18 3337.22,-2665.13 3346.58,-2670.1 3347.63,-2663.18"/>
</g>
<!-- stage1_qkv_layer_2_gpu_10 -->
<g id="node86" class="node">
<title>stage1_qkv_layer_2_gpu_10</title>
<polygon fill="#3c80ff" stroke="black" points="4907,-2666.54 4611,-2666.54 4611,-2592.54 4907,-2592.54 4907,-2666.54"/>
<text text-anchor="middle" x="4759" y="-2654.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4759" y="-2643.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4759" y="-2632.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4759" y="-2621.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4759" y="-2610.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4759" y="-2599.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_10 -->
<g id="edge293" class="edge">
<title>stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_10</title>
<path fill="none" stroke="black" d="M4273.24,-2713.36C4364.31,-2702.8 4485.15,-2687.22 4600.66,-2666.73"/>
<polygon fill="black" stroke="black" points="4601.52,-2670.13 4610.74,-2664.93 4600.28,-2663.24 4601.52,-2670.13"/>
</g>
<!-- stage1_qkv_layer_2_gpu_11 -->
<g id="node87" class="node">
<title>stage1_qkv_layer_2_gpu_11</title>
<polygon fill="#5a80ff" stroke="black" points="5221,-2666.54 4925,-2666.54 4925,-2592.54 5221,-2592.54 5221,-2666.54"/>
<text text-anchor="middle" x="5073" y="-2654.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="5073" y="-2643.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5073" y="-2632.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5073" y="-2621.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5073" y="-2610.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5073" y="-2599.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_11 -->
<g id="edge302" class="edge">
<title>stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_11</title>
<path fill="none" stroke="black" d="M4273.18,-2723.58C4428.67,-2716.72 4685.22,-2701.21 4914.57,-2666.69"/>
<polygon fill="black" stroke="black" points="4915.42,-2670.1 4924.78,-2665.13 4914.37,-2663.18 4915.42,-2670.1"/>
</g>
<!-- stage1_qkv_layer_2_gpu_12 -->
<g id="node88" class="node">
<title>stage1_qkv_layer_2_gpu_12</title>
<polygon fill="#7880ff" stroke="black" points="4279,-2666.54 3983,-2666.54 3983,-2592.54 4279,-2592.54 4279,-2666.54"/>
<text text-anchor="middle" x="4131" y="-2654.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4131" y="-2643.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4131" y="-2632.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4131" y="-2621.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4131" y="-2610.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4131" y="-2599.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_12 -->
<g id="edge311" class="edge">
<title>stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_12</title>
<path fill="none" stroke="black" d="M4131,-2703.3C4131,-2695.23 4131,-2686.01 4131,-2676.92"/>
<polygon fill="black" stroke="black" points="4134.5,-2676.77 4131,-2666.77 4127.5,-2676.77 4134.5,-2676.77"/>
</g>
<!-- stage1_qkv_layer_2_gpu_13 -->
<g id="node89" class="node">
<title>stage1_qkv_layer_2_gpu_13</title>
<polygon fill="#9680ff" stroke="black" points="3651,-2666.54 3355,-2666.54 3355,-2592.54 3651,-2592.54 3651,-2666.54"/>
<text text-anchor="middle" x="3503" y="-2654.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3503" y="-2643.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3503" y="-2632.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3503" y="-2621.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3503" y="-2610.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3503" y="-2599.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_13 -->
<g id="edge320" class="edge">
<title>stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_13</title>
<path fill="none" stroke="black" d="M3988.76,-2713.36C3897.69,-2702.8 3776.85,-2687.22 3661.34,-2666.73"/>
<polygon fill="black" stroke="black" points="3661.72,-2663.24 3651.26,-2664.93 3660.48,-2670.13 3661.72,-2663.24"/>
</g>
<!-- stage1_qkv_layer_2_gpu_14 -->
<g id="node90" class="node">
<title>stage1_qkv_layer_2_gpu_14</title>
<polygon fill="#b480ff" stroke="black" points="3965,-2666.54 3669,-2666.54 3669,-2592.54 3965,-2592.54 3965,-2666.54"/>
<text text-anchor="middle" x="3817" y="-2654.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3817" y="-2643.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3817" y="-2632.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3817" y="-2621.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3817" y="-2610.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3817" y="-2599.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_14 -->
<g id="edge329" class="edge">
<title>stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_14</title>
<path fill="none" stroke="black" d="M4050.54,-2703.43C4017.6,-2693.15 3978.71,-2681.01 3942.2,-2669.62"/>
<polygon fill="black" stroke="black" points="3943.07,-2666.22 3932.48,-2666.58 3940.98,-2672.9 3943.07,-2666.22"/>
</g>
<!-- stage1_qkv_layer_2_gpu_15 -->
<g id="node91" class="node">
<title>stage1_qkv_layer_2_gpu_15</title>
<polygon fill="#d280ff" stroke="black" points="3023,-2666.54 2727,-2666.54 2727,-2592.54 3023,-2592.54 3023,-2666.54"/>
<text text-anchor="middle" x="2875" y="-2654.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="2875" y="-2643.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2875" y="-2632.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2875" y="-2621.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2875" y="-2610.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2875" y="-2599.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_15 -->
<g id="edge338" class="edge">
<title>stage1_ln1_layer_2&#45;&gt;stage1_qkv_layer_2_gpu_15</title>
<path fill="none" stroke="black" d="M3988.86,-2728.17C3780.67,-2725.92 3380.76,-2715.11 3033.22,-2666.63"/>
<polygon fill="black" stroke="black" points="3033.6,-2663.15 3023.21,-2665.22 3032.62,-2670.08 3033.6,-2663.15"/>
</g>
<!-- stage1_residual1_layer_2 -->
<g id="node102" class="node">
<title>stage1_residual1_layer_2</title>
<polygon fill="#ffffcc" stroke="black" points="5380.82,-2214.54 4902.28,-2214.54 4779.18,-2110.54 5257.72,-2110.54 5380.82,-2214.54"/>
<text text-anchor="middle" x="5080" y="-2176.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="5080" y="-2165.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5080" y="-2154.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5080" y="-2143.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (all&#45;reduce)</text>
</g>
<!-- stage1_ln1_layer_2&#45;&gt;stage1_residual1_layer_2 -->
<g id="edge357" class="edge">
<title>stage1_ln1_layer_2&#45;&gt;stage1_residual1_layer_2</title>
<path fill="none" stroke="black" d="M4273.1,-2724.89C4561.9,-2716.87 5193.34,-2696.07 5230,-2666.54 5242.93,-2656.12 5240,-2647.14 5240,-2630.54 5240,-2630.54 5240,-2630.54 5240,-2276.54 5240,-2254.47 5229.72,-2236.34 5214.38,-2221.55"/>
<polygon fill="black" stroke="black" points="5216.27,-2218.55 5206.46,-2214.56 5211.64,-2223.8 5216.27,-2218.55"/>
</g>
<!-- stage1_attention_layer_2_gpu_8 -->
<g id="node92" class="node">
<title>stage1_attention_layer_2_gpu_8</title>
<polygon fill="#0080ff" stroke="black" points="4889.5,-2555.54 4600.5,-2555.54 4600.5,-2481.54 4889.5,-2481.54 4889.5,-2555.54"/>
<text text-anchor="middle" x="4745" y="-2543.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4745" y="-2532.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4745" y="-2521.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4745" y="-2510.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4745" y="-2499.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4745" y="-2488.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_8 -->
<g id="edge276" class="edge">
<title>stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_8</title>
<path fill="none" stroke="black" d="M4593.27,-2594.2C4596.2,-2593.63 4599.11,-2593.08 4602,-2592.54 4629.37,-2587.42 4704.55,-2592.29 4726,-2574.54 4729.33,-2571.79 4732.07,-2568.42 4734.34,-2564.72"/>
<polygon fill="black" stroke="black" points="4737.54,-2566.14 4738.8,-2555.62 4731.26,-2563.05 4737.54,-2566.14"/>
</g>
<!-- stage1_attention_layer_2_gpu_9 -->
<g id="node93" class="node">
<title>stage1_attention_layer_2_gpu_9</title>
<polygon fill="#1e80ff" stroke="black" points="3047.5,-2555.54 2758.5,-2555.54 2758.5,-2481.54 3047.5,-2481.54 3047.5,-2555.54"/>
<text text-anchor="middle" x="2903" y="-2543.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2903" y="-2532.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2903" y="-2521.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2903" y="-2510.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="2903" y="-2499.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="2903" y="-2488.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_9 -->
<g id="edge286" class="edge">
<title>stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4296.81,-2593.69C4293.85,-2593.28 4290.91,-2592.89 4288,-2592.54 4038.46,-2562.28 3407.06,-2600.09 3157,-2574.54 3122.89,-2571.05 3086.64,-2564.79 3052.54,-2557.71"/>
<polygon fill="blue" stroke="blue" points="3053.02,-2554.23 3042.51,-2555.59 3051.57,-2561.08 3053.02,-2554.23"/>
</g>
<!-- stage1_attention_layer_2_gpu_10 -->
<g id="node94" class="node">
<title>stage1_attention_layer_2_gpu_10</title>
<polygon fill="#3c80ff" stroke="black" points="4275.5,-2555.54 3986.5,-2555.54 3986.5,-2481.54 4275.5,-2481.54 4275.5,-2555.54"/>
<text text-anchor="middle" x="4131" y="-2543.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4131" y="-2532.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4131" y="-2521.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4131" y="-2510.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4131" y="-2499.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4131" y="-2488.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_10 -->
<g id="edge295" class="edge">
<title>stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4340.88,-2592.4C4309.98,-2581.67 4275.98,-2569.87 4244.52,-2558.94"/>
<polygon fill="blue" stroke="blue" points="4245.43,-2555.56 4234.84,-2555.59 4243.14,-2562.17 4245.43,-2555.56"/>
</g>
<!-- stage1_attention_layer_2_gpu_11 -->
<g id="node95" class="node">
<title>stage1_attention_layer_2_gpu_11</title>
<polygon fill="#5a80ff" stroke="black" points="3661.5,-2555.54 3372.5,-2555.54 3372.5,-2481.54 3661.5,-2481.54 3661.5,-2555.54"/>
<text text-anchor="middle" x="3517" y="-2543.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3517" y="-2532.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3517" y="-2521.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3517" y="-2510.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3517" y="-2499.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3517" y="-2488.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_11 -->
<g id="edge304" class="edge">
<title>stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4296.81,-2593.74C4293.85,-2593.31 4290.91,-2592.91 4288,-2592.54 4145.32,-2574.38 3781.28,-2606.3 3641,-2574.54 3625.59,-2571.05 3609.75,-2565.61 3594.75,-2559.49"/>
<polygon fill="blue" stroke="blue" points="3596.11,-2556.26 3585.53,-2555.6 3593.38,-2562.71 3596.11,-2556.26"/>
</g>
<!-- stage1_attention_layer_2_gpu_12 -->
<g id="node96" class="node">
<title>stage1_attention_layer_2_gpu_12</title>
<polygon fill="#7880ff" stroke="black" points="3354.5,-2555.54 3065.5,-2555.54 3065.5,-2481.54 3354.5,-2481.54 3354.5,-2555.54"/>
<text text-anchor="middle" x="3210" y="-2543.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3210" y="-2532.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3210" y="-2521.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3210" y="-2510.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3210" y="-2499.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3210" y="-2488.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_12 -->
<g id="edge313" class="edge">
<title>stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4296.81,-2593.71C4293.85,-2593.29 4290.91,-2592.9 4288,-2592.54 3921.84,-2547.07 3824.72,-2615.25 3458,-2574.54 3425.23,-2570.9 3390.45,-2564.7 3357.62,-2557.74"/>
<polygon fill="blue" stroke="blue" points="3358.02,-2554.24 3347.5,-2555.55 3356.54,-2561.08 3358.02,-2554.24"/>
</g>
<!-- stage1_attention_layer_2_gpu_13 -->
<g id="node97" class="node">
<title>stage1_attention_layer_2_gpu_13</title>
<polygon fill="#9680ff" stroke="black" points="4582.5,-2555.54 4293.5,-2555.54 4293.5,-2481.54 4582.5,-2481.54 4582.5,-2555.54"/>
<text text-anchor="middle" x="4438" y="-2543.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4438" y="-2532.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4438" y="-2521.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4438" y="-2510.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4438" y="-2499.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4438" y="-2488.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_13 -->
<g id="edge322" class="edge">
<title>stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4442.67,-2592.24C4442.13,-2583.79 4441.54,-2574.67 4440.97,-2565.84"/>
<polygon fill="blue" stroke="blue" points="4444.45,-2565.43 4440.32,-2555.68 4437.47,-2565.88 4444.45,-2565.43"/>
</g>
<!-- stage1_attention_layer_2_gpu_14 -->
<g id="node98" class="node">
<title>stage1_attention_layer_2_gpu_14</title>
<polygon fill="#b480ff" stroke="black" points="3968.5,-2555.54 3679.5,-2555.54 3679.5,-2481.54 3968.5,-2481.54 3968.5,-2555.54"/>
<text text-anchor="middle" x="3824" y="-2543.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3824" y="-2532.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3824" y="-2521.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3824" y="-2510.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3824" y="-2499.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3824" y="-2488.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_14 -->
<g id="edge331" class="edge">
<title>stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4296.78,-2593.9C4293.84,-2593.42 4290.9,-2592.97 4288,-2592.54 4171.66,-2575.34 4139.95,-2594.23 4024,-2574.54 3999.63,-2570.4 3973.95,-2564.53 3949.42,-2558.15"/>
<polygon fill="blue" stroke="blue" points="3950.28,-2554.75 3939.71,-2555.58 3948.49,-2561.52 3950.28,-2554.75"/>
</g>
<!-- stage1_attention_layer_2_gpu_15 -->
<g id="node99" class="node">
<title>stage1_attention_layer_2_gpu_15</title>
<polygon fill="#d280ff" stroke="black" points="5196.5,-2555.54 4907.5,-2555.54 4907.5,-2481.54 5196.5,-2481.54 5196.5,-2555.54"/>
<text text-anchor="middle" x="5052" y="-2543.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5052" y="-2532.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5052" y="-2521.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5052" y="-2510.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5052" y="-2499.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5052" y="-2488.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_15 -->
<g id="edge340" class="edge">
<title>stage1_qkv_layer_2_gpu_8&#45;&gt;stage1_attention_layer_2_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4593.2,-2593.79C4596.15,-2593.35 4599.09,-2592.93 4602,-2592.54 4649.95,-2586.11 4999.17,-2604.69 5037,-2574.54 5040.26,-2571.94 5042.85,-2568.71 5044.91,-2565.12"/>
<polygon fill="blue" stroke="blue" points="5048.25,-2566.21 5049,-2555.64 5041.82,-2563.44 5048.25,-2566.21"/>
</g>
<!-- stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_8 -->
<g id="edge277" class="edge">
<title>stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3337.19,-2593.69C3340.15,-2593.28 3343.09,-2592.89 3346,-2592.54 3595.32,-2562.31 4225.85,-2596.9 4476,-2574.54 4513.37,-2571.2 4553.2,-2564.71 4590.43,-2557.33"/>
<polygon fill="blue" stroke="blue" points="4591.23,-2560.74 4600.34,-2555.33 4589.85,-2553.88 4591.23,-2560.74"/>
</g>
<!-- stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_9 -->
<g id="edge285" class="edge">
<title>stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_9</title>
<path fill="none" stroke="black" d="M3076.08,-2592.44C3059.53,-2586.71 3042.76,-2580.64 3027,-2574.54 3015.1,-2569.93 3002.68,-2564.81 2990.5,-2559.59"/>
<polygon fill="black" stroke="black" points="2991.81,-2556.35 2981.24,-2555.6 2989.04,-2562.77 2991.81,-2556.35"/>
</g>
<!-- stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_10 -->
<g id="edge296" class="edge">
<title>stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3337.19,-2593.73C3340.15,-2593.3 3343.09,-2592.91 3346,-2592.54 3426.83,-2582.38 4004.58,-2607.68 4079,-2574.54 4085.6,-2571.6 4091.77,-2567.38 4097.38,-2562.58"/>
<polygon fill="blue" stroke="blue" points="4099.79,-2565.12 4104.68,-2555.72 4094.99,-2560.02 4099.79,-2565.12"/>
</g>
<!-- stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_11 -->
<g id="edge305" class="edge">
<title>stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3337.25,-2594.12C3340.19,-2593.57 3343.11,-2593.05 3346,-2592.54 3378.2,-2586.88 3465.65,-2593.89 3492,-2574.54 3495.76,-2571.78 3498.97,-2568.31 3501.71,-2564.47"/>
<polygon fill="blue" stroke="blue" points="3504.88,-2565.98 3506.97,-2555.59 3498.86,-2562.41 3504.88,-2565.98"/>
</g>
<!-- stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_12 -->
<g id="edge314" class="edge">
<title>stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3195.99,-2592.24C3197.64,-2583.69 3199.42,-2574.47 3201.13,-2565.56"/>
<polygon fill="blue" stroke="blue" points="3204.58,-2566.16 3203.04,-2555.68 3197.71,-2564.83 3204.58,-2566.16"/>
</g>
<!-- stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_13 -->
<g id="edge323" class="edge">
<title>stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3337.19,-2593.7C3340.15,-2593.28 3343.09,-2592.89 3346,-2592.54 3404.08,-2585.46 4347.25,-2601.84 4399,-2574.54 4404.31,-2571.74 4409.05,-2567.86 4413.25,-2563.44"/>
<polygon fill="blue" stroke="blue" points="4416.07,-2565.51 4419.79,-2555.59 4410.7,-2561.03 4416.07,-2565.51"/>
</g>
<!-- stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_14 -->
<g id="edge332" class="edge">
<title>stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3337.2,-2593.79C3340.15,-2593.34 3343.09,-2592.93 3346,-2592.54 3395.49,-2585.93 3752.77,-2601.18 3795,-2574.54 3799.23,-2571.87 3802.88,-2568.37 3806.01,-2564.42"/>
<polygon fill="blue" stroke="blue" points="3809.12,-2566.08 3811.76,-2555.82 3803.3,-2562.19 3809.12,-2566.08"/>
</g>
<!-- stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_15 -->
<g id="edge341" class="edge">
<title>stage1_qkv_layer_2_gpu_9&#45;&gt;stage1_attention_layer_2_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3337.19,-2593.68C3340.14,-2593.27 3343.08,-2592.89 3346,-2592.54 3664.43,-2554.49 4469.66,-2603.92 4789,-2574.54 4824.98,-2571.23 4863.27,-2564.88 4899.18,-2557.65"/>
<polygon fill="blue" stroke="blue" points="4900.14,-2561.02 4909.24,-2555.58 4898.74,-2554.16 4900.14,-2561.02"/>
</g>
<!-- stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_8 -->
<g id="edge278" class="edge">
<title>stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4754.34,-2592.24C4753.25,-2583.79 4752.08,-2574.67 4750.95,-2565.84"/>
<polygon fill="blue" stroke="blue" points="4754.39,-2565.15 4749.64,-2555.68 4747.44,-2566.04 4754.39,-2565.15"/>
</g>
<!-- stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_9 -->
<g id="edge287" class="edge">
<title>stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4610.81,-2593.72C4607.85,-2593.3 4604.91,-2592.9 4602,-2592.54 4434.53,-2571.55 3268.2,-2577.05 3057.63,-2555.39"/>
<polygon fill="blue" stroke="blue" points="3057.86,-2551.89 3047.52,-2554.24 3057.06,-2558.85 3057.86,-2551.89"/>
</g>
<!-- stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_10 -->
<g id="edge294" class="edge">
<title>stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_10</title>
<path fill="none" stroke="black" d="M4610.75,-2594.09C4607.81,-2593.56 4604.89,-2593.04 4602,-2592.54 4465.36,-2568.97 4426.47,-2579.45 4285.47,-2555.54"/>
<polygon fill="black" stroke="black" points="4286.03,-2552.09 4275.58,-2553.84 4284.84,-2558.99 4286.03,-2552.09"/>
</g>
<!-- stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_11 -->
<g id="edge306" class="edge">
<title>stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4610.8,-2593.79C4607.85,-2593.34 4604.91,-2592.93 4602,-2592.54 4399.87,-2565.59 3891.86,-2582.8 3671.49,-2555.46"/>
<polygon fill="blue" stroke="blue" points="3671.9,-2551.98 3661.53,-2554.17 3671,-2558.93 3671.9,-2551.98"/>
</g>
<!-- stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_12 -->
<g id="edge315" class="edge">
<title>stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4610.81,-2593.75C4607.85,-2593.32 4604.91,-2592.91 4602,-2592.54 4468.3,-2575.38 3539.69,-2573.42 3364.53,-2555.37"/>
<polygon fill="blue" stroke="blue" points="3364.86,-2551.88 3354.53,-2554.21 3364.06,-2558.83 3364.86,-2551.88"/>
</g>
<!-- stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_13 -->
<g id="edge324" class="edge">
<title>stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4652.56,-2592.4C4620.83,-2581.62 4585.92,-2569.77 4553.63,-2558.8"/>
<polygon fill="blue" stroke="blue" points="4554.75,-2555.49 4544.15,-2555.59 4552.5,-2562.11 4554.75,-2555.49"/>
</g>
<!-- stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_14 -->
<g id="edge333" class="edge">
<title>stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4610.79,-2593.86C4607.84,-2593.4 4604.91,-2592.96 4602,-2592.54 4330.21,-2553.6 4254.69,-2594.54 3978.46,-2555.51"/>
<polygon fill="blue" stroke="blue" points="3978.94,-2552.04 3968.54,-2554.08 3977.95,-2558.97 3978.94,-2552.04"/>
</g>
<!-- stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_15 -->
<g id="edge342" class="edge">
<title>stage1_qkv_layer_2_gpu_10&#45;&gt;stage1_attention_layer_2_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4907.26,-2594.18C4910.2,-2593.62 4913.11,-2593.07 4916,-2592.54 4944.69,-2587.27 5025.68,-2595.46 5046,-2574.54 5048.55,-2571.91 5050.48,-2568.84 5051.91,-2565.53"/>
<polygon fill="blue" stroke="blue" points="5055.34,-2566.26 5054.72,-2555.68 5048.61,-2564.33 5055.34,-2566.26"/>
</g>
<!-- stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_8 -->
<g id="edge279" class="edge">
<title>stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4964.24,-2592.4C4931.82,-2581.62 4896.14,-2569.77 4863.15,-2558.8"/>
<polygon fill="blue" stroke="blue" points="4864.06,-2555.42 4853.47,-2555.59 4861.86,-2562.06 4864.06,-2555.42"/>
</g>
<!-- stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_9 -->
<g id="edge288" class="edge">
<title>stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4924.81,-2593.71C4921.85,-2593.29 4918.91,-2592.9 4916,-2592.54 4713.96,-2567.63 3304.17,-2580.85 3057.73,-2555.41"/>
<polygon fill="blue" stroke="blue" points="3057.85,-2551.9 3047.52,-2554.25 3057.06,-2558.86 3057.85,-2551.9"/>
</g>
<!-- stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_10 -->
<g id="edge297" class="edge">
<title>stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4924.79,-2593.86C4921.84,-2593.4 4918.91,-2592.95 4916,-2592.54 4641.16,-2553.25 4564.8,-2594.88 4285.56,-2555.52"/>
<polygon fill="blue" stroke="blue" points="4285.94,-2552.04 4275.54,-2554.09 4284.95,-2558.97 4285.94,-2552.04"/>
</g>
<!-- stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_11 -->
<g id="edge303" class="edge">
<title>stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_11</title>
<path fill="none" stroke="black" d="M4924.81,-2593.75C4921.85,-2593.32 4918.91,-2592.91 4916,-2592.54 4781.55,-2575.29 3847.69,-2573.5 3671.58,-2555.37"/>
<polygon fill="black" stroke="black" points="3671.86,-2551.88 3661.53,-2554.21 3671.06,-2558.83 3671.86,-2551.88"/>
</g>
<!-- stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_12 -->
<g id="edge316" class="edge">
<title>stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4924.81,-2593.72C4921.85,-2593.3 4918.91,-2592.9 4916,-2592.54 4747.77,-2571.47 3576.15,-2577.14 3364.67,-2555.39"/>
<polygon fill="blue" stroke="blue" points="3364.86,-2551.89 3354.52,-2554.24 3364.06,-2558.85 3364.86,-2551.89"/>
</g>
<!-- stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_13 -->
<g id="edge325" class="edge">
<title>stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4924.76,-2594.08C4921.82,-2593.55 4918.89,-2593.03 4916,-2592.54 4776.35,-2568.63 4736.58,-2579.77 4592.67,-2555.58"/>
<polygon fill="blue" stroke="blue" points="4593.03,-2552.09 4582.58,-2553.85 4591.85,-2558.99 4593.03,-2552.09"/>
</g>
<!-- stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_14 -->
<g id="edge334" class="edge">
<title>stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4924.8,-2593.79C4921.85,-2593.34 4918.91,-2592.93 4916,-2592.54 4712.35,-2565.41 4200.53,-2582.97 3978.56,-2555.47"/>
<polygon fill="blue" stroke="blue" points="3978.9,-2551.98 3968.53,-2554.17 3978,-2558.93 3978.9,-2551.98"/>
</g>
<!-- stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_15 -->
<g id="edge343" class="edge">
<title>stage1_qkv_layer_2_gpu_11&#45;&gt;stage1_attention_layer_2_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M5068.22,-2592.37C5067.25,-2586.07 5066.17,-2579.6 5065,-2573.54 5064.5,-2570.92 5063.95,-2568.24 5063.37,-2565.54"/>
<polygon fill="blue" stroke="blue" points="5066.78,-2564.75 5061.2,-2555.75 5059.95,-2566.27 5066.78,-2564.75"/>
</g>
<!-- stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_8 -->
<g id="edge280" class="edge">
<title>stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4279.21,-2593.86C4282.16,-2593.39 4285.09,-2592.95 4288,-2592.54 4425.95,-2572.9 4464.75,-2603.74 4601,-2574.54 4618.55,-2570.78 4636.79,-2565.21 4654.16,-2559.04"/>
<polygon fill="blue" stroke="blue" points="4655.51,-2562.28 4663.7,-2555.56 4653.11,-2555.7 4655.51,-2562.28"/>
</g>
<!-- stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_9 -->
<g id="edge289" class="edge">
<title>stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3982.81,-2593.71C3979.85,-2593.29 3976.91,-2592.9 3974,-2592.54 3609.16,-2547.22 3512.22,-2616.69 3147,-2574.54 3114.94,-2570.84 3080.94,-2564.65 3048.81,-2557.74"/>
<polygon fill="blue" stroke="blue" points="3049.43,-2554.29 3038.91,-2555.57 3047.93,-2561.12 3049.43,-2554.29"/>
</g>
<!-- stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_10 -->
<g id="edge298" class="edge">
<title>stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4131,-2592.24C4131,-2583.79 4131,-2574.67 4131,-2565.84"/>
<polygon fill="blue" stroke="blue" points="4134.5,-2565.68 4131,-2555.68 4127.5,-2565.68 4134.5,-2565.68"/>
</g>
<!-- stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_11 -->
<g id="edge307" class="edge">
<title>stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3982.79,-2593.83C3979.84,-2593.37 3976.91,-2592.94 3974,-2592.54 3895.76,-2581.67 3695.07,-2595.81 3619,-2574.54 3606.77,-2571.12 3594.37,-2566.04 3582.62,-2560.33"/>
<polygon fill="blue" stroke="blue" points="3583.87,-2557.04 3573.36,-2555.64 3580.7,-2563.28 3583.87,-2557.04"/>
</g>
<!-- stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_12 -->
<g id="edge312" class="edge">
<title>stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_12</title>
<path fill="none" stroke="black" d="M3982.8,-2593.76C3979.85,-2593.33 3976.91,-2592.92 3974,-2592.54 3736.76,-2561.66 3673.03,-2607 3436,-2574.54 3407.37,-2570.62 3377.09,-2564.59 3348.31,-2557.94"/>
<polygon fill="black" stroke="black" points="3348.73,-2554.45 3338.2,-2555.57 3347.13,-2561.26 3348.73,-2554.45"/>
</g>
<!-- stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_13 -->
<g id="edge326" class="edge">
<title>stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4279.25,-2594.13C4282.19,-2593.58 4285.11,-2593.05 4288,-2592.54 4319.54,-2586.95 4408.34,-2597.17 4431,-2574.54 4433.6,-2571.94 4435.58,-2568.9 4437.07,-2565.6"/>
<polygon fill="blue" stroke="blue" points="4440.49,-2566.36 4440.06,-2555.78 4433.8,-2564.32 4440.49,-2566.36"/>
</g>
<!-- stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_14 -->
<g id="edge335" class="edge">
<title>stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4006.67,-2592.4C3988.89,-2586.71 3970.91,-2580.68 3954,-2574.54 3941.3,-2569.93 3928.05,-2564.76 3915.06,-2559.47"/>
<polygon fill="blue" stroke="blue" points="3916.24,-2556.18 3905.66,-2555.62 3913.58,-2562.65 3916.24,-2556.18"/>
</g>
<!-- stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_15 -->
<g id="edge344" class="edge">
<title>stage1_qkv_layer_2_gpu_12&#45;&gt;stage1_attention_layer_2_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4279.19,-2593.73C4282.15,-2593.3 4285.09,-2592.91 4288,-2592.54 4366.74,-2582.62 4929.84,-2607.56 5002,-2574.54 5008.31,-2571.65 5014.17,-2567.55 5019.5,-2562.88"/>
<polygon fill="blue" stroke="blue" points="5022.17,-2565.17 5026.91,-2555.69 5017.29,-2560.14 5022.17,-2565.17"/>
</g>
<!-- stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_8 -->
<g id="edge281" class="edge">
<title>stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3651.19,-2593.71C3654.15,-2593.29 3657.09,-2592.9 3660,-2592.54 3854.56,-2568.51 4347.95,-2602.38 4542,-2574.54 4568.04,-2570.8 4595.5,-2564.81 4621.52,-2558.14"/>
<polygon fill="blue" stroke="blue" points="4622.63,-2561.46 4631.42,-2555.55 4620.86,-2554.69 4622.63,-2561.46"/>
</g>
<!-- stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_9 -->
<g id="edge290" class="edge">
<title>stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3354.78,-2593.91C3351.83,-2593.43 3348.9,-2592.97 3346,-2592.54 3234.51,-2575.89 3203.98,-2594.32 3093,-2574.54 3070,-2570.44 3045.81,-2564.63 3022.68,-2558.32"/>
<polygon fill="blue" stroke="blue" points="3023.41,-2554.89 3012.84,-2555.59 3021.54,-2561.64 3023.41,-2554.89"/>
</g>
<!-- stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_10 -->
<g id="edge299" class="edge">
<title>stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3651.2,-2593.79C3654.15,-2593.35 3657.09,-2592.93 3660,-2592.54 3708.72,-2586.02 4060.44,-2600.78 4102,-2574.54 4106.23,-2571.87 4109.87,-2568.37 4113.01,-2564.42"/>
<polygon fill="blue" stroke="blue" points="4116.12,-2566.07 4118.76,-2555.81 4110.3,-2562.18 4116.12,-2566.07"/>
</g>
<!-- stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_11 -->
<g id="edge308" class="edge">
<title>stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3507.66,-2592.24C3508.75,-2583.79 3509.92,-2574.67 3511.05,-2565.84"/>
<polygon fill="blue" stroke="blue" points="3514.56,-2566.04 3512.36,-2555.68 3507.61,-2565.15 3514.56,-2566.04"/>
</g>
<!-- stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_12 -->
<g id="edge317" class="edge">
<title>stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3383.52,-2592.47C3366.46,-2586.77 3349.21,-2580.71 3333,-2574.54 3321.07,-2569.99 3308.63,-2564.88 3296.45,-2559.66"/>
<polygon fill="blue" stroke="blue" points="3297.76,-2556.42 3287.2,-2555.65 3294.98,-2562.84 3297.76,-2556.42"/>
</g>
<!-- stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_13 -->
<g id="edge321" class="edge">
<title>stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_13</title>
<path fill="none" stroke="black" d="M3651.19,-2593.72C3654.15,-2593.3 3657.09,-2592.9 3660,-2592.54 3701.52,-2587.34 4378.09,-2597.61 4413,-2574.54 4417.05,-2571.86 4420.46,-2568.35 4423.32,-2564.4"/>
<polygon fill="black" stroke="black" points="4426.33,-2566.17 4428.45,-2555.79 4420.32,-2562.59 4426.33,-2566.17"/>
</g>
<!-- stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_14 -->
<g id="edge336" class="edge">
<title>stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3651.25,-2594.13C3654.19,-2593.58 3657.11,-2593.05 3660,-2592.54 3691.76,-2586.93 3778.79,-2594.65 3804,-2574.54 3807.4,-2571.83 3810.22,-2568.49 3812.56,-2564.81"/>
<polygon fill="blue" stroke="blue" points="3815.76,-2566.23 3817.2,-2555.73 3809.53,-2563.05 3815.76,-2566.23"/>
</g>
<!-- stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_15 -->
<g id="edge345" class="edge">
<title>stage1_qkv_layer_2_gpu_13&#45;&gt;stage1_attention_layer_2_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3651.19,-2593.69C3654.15,-2593.28 3657.09,-2592.89 3660,-2592.54 3911.52,-2562.06 4547.97,-2600.51 4800,-2574.54 4833.85,-2571.05 4869.81,-2564.79 4903.65,-2557.7"/>
<polygon fill="blue" stroke="blue" points="4904.55,-2561.09 4913.6,-2555.58 4903.09,-2554.24 4904.55,-2561.09"/>
</g>
<!-- stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_8 -->
<g id="edge282" class="edge">
<title>stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3965.19,-2593.75C3968.15,-2593.32 3971.09,-2592.91 3974,-2592.54 4107.41,-2575.43 4446.55,-2597.94 4579,-2574.54 4599.78,-2570.87 4621.51,-2565.14 4642.14,-2558.74"/>
<polygon fill="blue" stroke="blue" points="4643.38,-2562.01 4651.85,-2555.65 4641.26,-2555.34 4643.38,-2562.01"/>
</g>
<!-- stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_9 -->
<g id="edge291" class="edge">
<title>stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3668.8,-2593.76C3665.85,-2593.33 3662.91,-2592.92 3660,-2592.54 3426.29,-2562.06 3363.52,-2606.45 3130,-2574.54 3101.12,-2570.59 3070.57,-2564.53 3041.55,-2557.84"/>
<polygon fill="blue" stroke="blue" points="3042.31,-2554.43 3031.78,-2555.55 3040.71,-2561.24 3042.31,-2554.43"/>
</g>
<!-- stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_10 -->
<g id="edge300" class="edge">
<title>stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3965.25,-2594.13C3968.19,-2593.58 3971.11,-2593.05 3974,-2592.54 4005.54,-2586.95 4092.99,-2595.74 4117,-2574.54 4120.03,-2571.86 4122.45,-2568.63 4124.37,-2565.1"/>
<polygon fill="blue" stroke="blue" points="4127.63,-2566.39 4128.21,-2555.81 4121.16,-2563.71 4127.63,-2566.39"/>
</g>
<!-- stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_11 -->
<g id="edge309" class="edge">
<title>stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3669,-2594.57C3622.09,-2583.8 3582.15,-2574.62 3582,-2574.54 3575.03,-2571.05 3568.17,-2566.66 3561.68,-2561.9"/>
<polygon fill="blue" stroke="blue" points="3563.71,-2559.05 3553.66,-2555.7 3559.43,-2564.59 3563.71,-2559.05"/>
</g>
<!-- stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_12 -->
<g id="edge318" class="edge">
<title>stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3668.78,-2593.9C3665.83,-2593.43 3662.9,-2592.97 3660,-2592.54 3544.98,-2575.49 3513.48,-2594.9 3399,-2574.54 3376.04,-2570.45 3351.88,-2564.64 3328.81,-2558.31"/>
<polygon fill="blue" stroke="blue" points="3329.56,-2554.88 3318.99,-2555.56 3327.68,-2561.62 3329.56,-2554.88"/>
</g>
<!-- stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_13 -->
<g id="edge327" class="edge">
<title>stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3965.2,-2593.79C3968.15,-2593.35 3971.09,-2592.93 3974,-2592.54 4023.27,-2585.96 4381.6,-2604.84 4421,-2574.54 4424.43,-2571.9 4427.19,-2568.58 4429.4,-2564.88"/>
<polygon fill="blue" stroke="blue" points="4432.62,-2566.27 4433.64,-2555.72 4426.26,-2563.33 4432.62,-2566.27"/>
</g>
<!-- stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_14 -->
<g id="edge330" class="edge">
<title>stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_14</title>
<path fill="none" stroke="black" d="M3819.33,-2592.24C3819.87,-2583.79 3820.46,-2574.67 3821.03,-2565.84"/>
<polygon fill="black" stroke="black" points="3824.53,-2565.88 3821.68,-2555.68 3817.55,-2565.43 3824.53,-2565.88"/>
</g>
<!-- stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_15 -->
<g id="edge346" class="edge">
<title>stage1_qkv_layer_2_gpu_14&#45;&gt;stage1_attention_layer_2_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3965.19,-2593.7C3968.15,-2593.29 3971.09,-2592.9 3974,-2592.54 4079.67,-2579.57 4828.2,-2598.22 4932,-2574.54 4946.94,-2571.13 4962.26,-2565.75 4976.74,-2559.66"/>
<polygon fill="blue" stroke="blue" points="4978.36,-2562.78 4986.13,-2555.58 4975.56,-2556.36 4978.36,-2562.78"/>
</g>
<!-- stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_8 -->
<g id="edge283" class="edge">
<title>stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3023.19,-2593.72C3026.15,-2593.3 3029.09,-2592.9 3032,-2592.54 3201.1,-2571.37 4378.77,-2577.35 4590.05,-2555.58"/>
<polygon fill="blue" stroke="blue" points="4590.64,-2559.03 4600.18,-2554.42 4589.85,-2552.08 4590.64,-2559.03"/>
</g>
<!-- stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_9 -->
<g id="edge292" class="edge">
<title>stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2884.32,-2592.24C2886.52,-2583.69 2888.89,-2574.47 2891.18,-2565.56"/>
<polygon fill="blue" stroke="blue" points="2894.62,-2566.23 2893.72,-2555.68 2887.84,-2564.49 2894.62,-2566.23"/>
</g>
<!-- stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_10 -->
<g id="edge301" class="edge">
<title>stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3023.2,-2593.78C3026.15,-2593.34 3029.09,-2592.93 3032,-2592.54 3237.39,-2565.22 3753.59,-2583.31 3976.12,-2555.67"/>
<polygon fill="blue" stroke="blue" points="3976.71,-2559.12 3986.17,-2554.36 3975.8,-2552.18 3976.71,-2559.12"/>
</g>
<!-- stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_11 -->
<g id="edge310" class="edge">
<title>stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3023.24,-2594.07C3026.18,-2593.54 3029.11,-2593.03 3032,-2592.54 3175.09,-2568.24 3215.88,-2580.24 3361.9,-2555.83"/>
<polygon fill="blue" stroke="blue" points="3362.86,-2559.22 3372.13,-2554.09 3361.69,-2552.32 3362.86,-2559.22"/>
</g>
<!-- stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_12 -->
<g id="edge319" class="edge">
<title>stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2986.08,-2592.4C3019.19,-2581.62 3055.63,-2569.77 3089.32,-2558.8"/>
<polygon fill="blue" stroke="blue" points="3090.79,-2562.01 3099.22,-2555.59 3088.62,-2555.35 3090.79,-2562.01"/>
</g>
<!-- stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_13 -->
<g id="edge328" class="edge">
<title>stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3023.19,-2593.75C3026.15,-2593.32 3029.09,-2592.91 3032,-2592.54 3305.07,-2557.54 3992.44,-2590.93 4283.01,-2555.68"/>
<polygon fill="blue" stroke="blue" points="4283.69,-2559.12 4293.18,-2554.4 4282.82,-2552.18 4283.69,-2559.12"/>
</g>
<!-- stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_14 -->
<g id="edge337" class="edge">
<title>stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3023.21,-2593.86C3026.16,-2593.39 3029.09,-2592.95 3032,-2592.54 3310.33,-2552.86 3387.68,-2595.47 3669.07,-2555.74"/>
<polygon fill="blue" stroke="blue" points="3669.76,-2559.17 3679.16,-2554.29 3668.77,-2552.25 3669.76,-2559.17"/>
</g>
<!-- stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_15 -->
<g id="edge339" class="edge">
<title>stage1_qkv_layer_2_gpu_15&#45;&gt;stage1_attention_layer_2_gpu_15</title>
<path fill="none" stroke="black" d="M3023.19,-2593.71C3026.15,-2593.29 3029.09,-2592.9 3032,-2592.54 3234.91,-2567.53 4650.78,-2581.09 4896.98,-2555.6"/>
<polygon fill="black" stroke="black" points="4897.64,-2559.04 4907.18,-2554.43 4896.85,-2552.09 4897.64,-2559.04"/>
</g>
<!-- stage1_attention_reduce_layer_2 -->
<g id="node100" class="node">
<title>stage1_attention_reduce_layer_2</title>
<polygon fill="#ffcccc" stroke="black" points="4434.54,-2444.54 3951.68,-2444.54 3827.46,-2340.54 4310.32,-2340.54 4434.54,-2444.54"/>
<text text-anchor="middle" x="4131" y="-2406.54" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="4131" y="-2395.54" font-family="Arial" font-size="10.00">Input: [8Ã— batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4131" y="-2384.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4131" y="-2373.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (all&#45;reduce)</text>
</g>
<!-- stage1_attention_layer_2_gpu_8&#45;&gt;stage1_attention_reduce_layer_2 -->
<g id="edge347" class="edge">
<title>stage1_attention_layer_2_gpu_8&#45;&gt;stage1_attention_reduce_layer_2</title>
<path fill="none" stroke="black" d="M4600.48,-2483.36C4597.63,-2482.74 4594.8,-2482.14 4592,-2481.54 4536.06,-2469.63 4476.15,-2457.63 4418.63,-2446.49"/>
<polygon fill="black" stroke="black" points="4419.16,-2443.03 4408.68,-2444.57 4417.83,-2449.9 4419.16,-2443.03"/>
</g>
<!-- stage1_attention_layer_2_gpu_9&#45;&gt;stage1_attention_reduce_layer_2 -->
<g id="edge348" class="edge">
<title>stage1_attention_layer_2_gpu_9&#45;&gt;stage1_attention_reduce_layer_2</title>
<path fill="none" stroke="black" d="M3047.56,-2483.09C3050.73,-2482.55 3053.88,-2482.03 3057,-2481.54 3341.87,-2436.82 3673.03,-2414.05 3891.48,-2403.01"/>
<polygon fill="black" stroke="black" points="3891.66,-2406.51 3901.47,-2402.51 3891.31,-2399.52 3891.66,-2406.51"/>
</g>
<!-- stage1_attention_layer_2_gpu_10&#45;&gt;stage1_attention_reduce_layer_2 -->
<g id="edge349" class="edge">
<title>stage1_attention_layer_2_gpu_10&#45;&gt;stage1_attention_reduce_layer_2</title>
<path fill="none" stroke="black" d="M4131,-2481.34C4131,-2473.03 4131,-2463.97 4131,-2454.92"/>
<polygon fill="black" stroke="black" points="4134.5,-2454.76 4131,-2444.76 4127.5,-2454.76 4134.5,-2454.76"/>
</g>
<!-- stage1_attention_layer_2_gpu_11&#45;&gt;stage1_attention_reduce_layer_2 -->
<g id="edge350" class="edge">
<title>stage1_attention_layer_2_gpu_11&#45;&gt;stage1_attention_reduce_layer_2</title>
<path fill="none" stroke="black" d="M3661.64,-2483.55C3664.79,-2482.87 3667.91,-2482.2 3671,-2481.54 3753.37,-2464.04 3844.39,-2446.3 3923.57,-2431.37"/>
<polygon fill="black" stroke="black" points="3924.48,-2434.76 3933.66,-2429.47 3923.19,-2427.88 3924.48,-2434.76"/>
</g>
<!-- stage1_attention_layer_2_gpu_12&#45;&gt;stage1_attention_reduce_layer_2 -->
<g id="edge351" class="edge">
<title>stage1_attention_layer_2_gpu_12&#45;&gt;stage1_attention_reduce_layer_2</title>
<path fill="none" stroke="black" d="M3354.58,-2483.23C3357.75,-2482.64 3360.89,-2482.08 3364,-2481.54 3543.78,-2450.32 3749.25,-2427.42 3902.25,-2412.82"/>
<polygon fill="black" stroke="black" points="3902.63,-2416.3 3912.25,-2411.87 3901.97,-2409.33 3902.63,-2416.3"/>
</g>
<!-- stage1_attention_layer_2_gpu_13&#45;&gt;stage1_attention_reduce_layer_2 -->
<g id="edge352" class="edge">
<title>stage1_attention_layer_2_gpu_13&#45;&gt;stage1_attention_reduce_layer_2</title>
<path fill="none" stroke="black" d="M4348.79,-2481.51C4323.18,-2471.16 4294.66,-2459.64 4266.92,-2448.44"/>
<polygon fill="black" stroke="black" points="4268.12,-2445.15 4257.54,-2444.65 4265.5,-2451.64 4268.12,-2445.15"/>
</g>
<!-- stage1_attention_layer_2_gpu_14&#45;&gt;stage1_attention_reduce_layer_2 -->
<g id="edge353" class="edge">
<title>stage1_attention_layer_2_gpu_14&#45;&gt;stage1_attention_reduce_layer_2</title>
<path fill="none" stroke="black" d="M3913.21,-2481.51C3938.82,-2471.16 3967.34,-2459.64 3995.08,-2448.44"/>
<polygon fill="black" stroke="black" points="3996.5,-2451.64 4004.46,-2444.65 3993.88,-2445.15 3996.5,-2451.64"/>
</g>
<!-- stage1_attention_layer_2_gpu_15&#45;&gt;stage1_attention_reduce_layer_2 -->
<g id="edge354" class="edge">
<title>stage1_attention_layer_2_gpu_15&#45;&gt;stage1_attention_reduce_layer_2</title>
<path fill="none" stroke="black" d="M4907.13,-2483C4904.4,-2482.49 4901.69,-2482.01 4899,-2481.54 4738.42,-2453.55 4557.33,-2432.31 4411.35,-2417.71"/>
<polygon fill="black" stroke="black" points="4411.64,-2414.22 4401.34,-2416.72 4410.94,-2421.19 4411.64,-2414.22"/>
</g>
<!-- stage1_out_proj_layer_2 -->
<g id="node101" class="node">
<title>stage1_out_proj_layer_2</title>
<polygon fill="#0080ff" stroke="black" points="4747,-2303.54 4463,-2303.54 4463,-2251.54 4747,-2251.54 4747,-2303.54"/>
<text text-anchor="middle" x="4605" y="-2291.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="4605" y="-2280.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4605" y="-2269.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4605" y="-2258.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (sharded)</text>
</g>
<!-- stage1_attention_reduce_layer_2&#45;&gt;stage1_out_proj_layer_2 -->
<g id="edge355" class="edge">
<title>stage1_attention_reduce_layer_2&#45;&gt;stage1_out_proj_layer_2</title>
<path fill="none" stroke="black" d="M4318,-2346.96C4376.13,-2333.1 4438.47,-2318.24 4490.15,-2305.92"/>
<polygon fill="black" stroke="black" points="4491.09,-2309.29 4500.01,-2303.57 4489.47,-2302.48 4491.09,-2309.29"/>
</g>
<!-- stage1_out_proj_layer_2&#45;&gt;stage1_residual1_layer_2 -->
<g id="edge356" class="edge">
<title>stage1_out_proj_layer_2&#45;&gt;stage1_residual1_layer_2</title>
<path fill="none" stroke="black" d="M4710.12,-2251.53C4761.25,-2239.37 4824.39,-2224.35 4883.95,-2210.18"/>
<polygon fill="black" stroke="black" points="4884.94,-2213.54 4893.86,-2207.82 4883.32,-2206.73 4884.94,-2213.54"/>
</g>
<!-- stage1_ln2_layer_2 -->
<g id="node103" class="node">
<title>stage1_ln2_layer_2</title>
<polygon fill="#0080ff" stroke="black" points="4269,-2073.54 3985,-2073.54 3985,-2021.54 4269,-2021.54 4269,-2073.54"/>
<text text-anchor="middle" x="4127" y="-2061.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4127" y="-2050.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4127" y="-2039.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4127" y="-2028.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (sharded)</text>
</g>
<!-- stage1_residual1_layer_2&#45;&gt;stage1_ln2_layer_2 -->
<g id="edge358" class="edge">
<title>stage1_residual1_layer_2&#45;&gt;stage1_ln2_layer_2</title>
<path fill="none" stroke="black" d="M4800.19,-2128.36C4629.91,-2108.17 4418.99,-2083.16 4279.09,-2066.57"/>
<polygon fill="black" stroke="black" points="4279.49,-2063.1 4269.15,-2065.39 4278.66,-2070.05 4279.49,-2063.1"/>
</g>
<!-- stage1_residual2_layer_2 -->
<g id="node122" class="node">
<title>stage1_residual2_layer_2</title>
<polygon fill="#ffffcc" stroke="black" points="5796.82,-1613.54 5318.28,-1613.54 5195.18,-1509.54 5673.72,-1509.54 5796.82,-1613.54"/>
<text text-anchor="middle" x="5496" y="-1575.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="5496" y="-1564.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5496" y="-1553.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5496" y="-1542.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (all&#45;reduce)</text>
</g>
<!-- stage1_residual1_layer_2&#45;&gt;stage1_residual2_layer_2 -->
<g id="edge409" class="edge">
<title>stage1_residual1_layer_2&#45;&gt;stage1_residual2_layer_2</title>
<path fill="none" stroke="black" d="M5318.94,-2161.97C5661.67,-2159.36 6252,-2141.39 6252,-2048.54 6252,-2048.54 6252,-2048.54 6252,-1701.54 6252,-1651.37 5991.19,-1612.19 5775.95,-1588.39"/>
<polygon fill="black" stroke="black" points="5776.05,-1584.88 5765.73,-1587.26 5775.29,-1591.83 5776.05,-1584.88"/>
</g>
<!-- stage1_gate_layer_2 -->
<g id="node104" class="node">
<title>stage1_gate_layer_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4188.38,-1984.54 3720.09,-1984.54 3599.62,-1880.54 4067.91,-1880.54 4188.38,-1984.54"/>
<text text-anchor="middle" x="3894" y="-1946.54" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="3894" y="-1935.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3894" y="-1924.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="3894" y="-1913.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (sharded)</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_gate_layer_2 -->
<g id="edge359" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_gate_layer_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4075.29,-2021.46C4055.52,-2011.87 4032.11,-2000.52 4008.79,-1989.21"/>
<polygon fill="black" stroke="black" points="4010.04,-1985.93 3999.51,-1984.71 4006.98,-1992.22 4010.04,-1985.93"/>
</g>
<!-- stage1_expert_layer_2_expert_0_gpu_8 -->
<g id="node105" class="node">
<title>stage1_expert_layer_2_expert_0_gpu_8</title>
<polygon fill="#0080ff" stroke="black" points="4063,-1843.54 3771,-1843.54 3771,-1791.54 4063,-1791.54 4063,-1843.54"/>
<text text-anchor="middle" x="3917" y="-1831.54" font-family="Arial" font-size="10.00">Expert0</text>
<text text-anchor="middle" x="3917" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3917" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3917" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_0_gpu_8 -->
<g id="edge361" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_0_gpu_8</title>
<path fill="none" stroke="black" d="M4166.62,-2021.42C4178.68,-2011.53 4190.47,-1999.05 4197,-1984.54 4215.97,-1942.39 4225.94,-1916.58 4197,-1880.54 4188.2,-1869.57 4132.65,-1856.21 4073.32,-1844.71"/>
<polygon fill="black" stroke="black" points="4073.86,-1841.25 4063.38,-1842.8 4072.54,-1848.12 4073.86,-1841.25"/>
</g>
<!-- stage1_expert_layer_2_expert_1_gpu_8 -->
<g id="node106" class="node">
<title>stage1_expert_layer_2_expert_1_gpu_8</title>
<polygon fill="#0080ff" stroke="black" points="3443,-1843.54 3151,-1843.54 3151,-1791.54 3443,-1791.54 3443,-1843.54"/>
<text text-anchor="middle" x="3297" y="-1831.54" font-family="Arial" font-size="10.00">Expert1</text>
<text text-anchor="middle" x="3297" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3297" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3297" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_1_gpu_8 -->
<g id="edge363" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_1_gpu_8</title>
<path fill="none" stroke="black" d="M3984.87,-2041.8C3885.36,-2036.64 3749.69,-2025.88 3632,-2003.54 3602.85,-1998 3595.1,-1996.61 3568,-1984.54 3482.54,-1946.47 3391.4,-1886.01 3339.6,-1849.51"/>
<polygon fill="black" stroke="black" points="3341.5,-1846.57 3331.32,-1843.65 3337.46,-1852.29 3341.5,-1846.57"/>
</g>
<!-- stage1_expert_layer_2_expert_2_gpu_9 -->
<g id="node107" class="node">
<title>stage1_expert_layer_2_expert_2_gpu_9</title>
<polygon fill="#1e80ff" stroke="black" points="2513,-1843.54 2221,-1843.54 2221,-1791.54 2513,-1791.54 2513,-1843.54"/>
<text text-anchor="middle" x="2367" y="-1831.54" font-family="Arial" font-size="10.00">Expert2</text>
<text text-anchor="middle" x="2367" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2367" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2367" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_2_gpu_9 -->
<g id="edge365" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_2_gpu_9</title>
<path fill="none" stroke="black" d="M3984.8,-2045.47C3691.52,-2042.36 3028.44,-2030.32 2807,-1984.54 2665.73,-1955.34 2509.86,-1887.37 2426.85,-1848.06"/>
<polygon fill="black" stroke="black" points="2428.11,-1844.78 2417.58,-1843.64 2425.1,-1851.1 2428.11,-1844.78"/>
</g>
<!-- stage1_expert_layer_2_expert_3_gpu_9 -->
<g id="node108" class="node">
<title>stage1_expert_layer_2_expert_3_gpu_9</title>
<polygon fill="#1e80ff" stroke="black" points="5303,-1843.54 5011,-1843.54 5011,-1791.54 5303,-1791.54 5303,-1843.54"/>
<text text-anchor="middle" x="5157" y="-1831.54" font-family="Arial" font-size="10.00">Expert3</text>
<text text-anchor="middle" x="5157" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5157" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5157" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_3_gpu_9 -->
<g id="edge367" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_3_gpu_9</title>
<path fill="none" stroke="black" d="M4269.36,-2026.73C4341.97,-2015.82 4431.51,-2001.13 4511,-1984.54 4707.59,-1943.5 4934.29,-1881.88 5060.09,-1846.4"/>
<polygon fill="black" stroke="black" points="5061.41,-1849.66 5070.08,-1843.58 5059.51,-1842.93 5061.41,-1849.66"/>
</g>
<!-- stage1_expert_layer_2_expert_4_gpu_10 -->
<g id="node109" class="node">
<title>stage1_expert_layer_2_expert_4_gpu_10</title>
<polygon fill="#3c80ff" stroke="black" points="3133,-1843.54 2841,-1843.54 2841,-1791.54 3133,-1791.54 3133,-1843.54"/>
<text text-anchor="middle" x="2987" y="-1831.54" font-family="Arial" font-size="10.00">Expert4</text>
<text text-anchor="middle" x="2987" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2987" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2987" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_4_gpu_10 -->
<g id="edge369" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_4_gpu_10</title>
<path fill="none" stroke="black" d="M3984.95,-2040C3801.7,-2030.66 3493.4,-2011.56 3383,-1984.54 3256.1,-1953.48 3117.36,-1887.15 3042.46,-1848.39"/>
<polygon fill="black" stroke="black" points="3043.7,-1845.09 3033.21,-1843.58 3040.46,-1851.3 3043.7,-1845.09"/>
</g>
<!-- stage1_expert_layer_2_expert_5_gpu_10 -->
<g id="node110" class="node">
<title>stage1_expert_layer_2_expert_5_gpu_10</title>
<polygon fill="#3c80ff" stroke="black" points="5923,-1843.54 5631,-1843.54 5631,-1791.54 5923,-1791.54 5923,-1843.54"/>
<text text-anchor="middle" x="5777" y="-1831.54" font-family="Arial" font-size="10.00">Expert5</text>
<text text-anchor="middle" x="5777" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5777" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5777" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_5_gpu_10 -->
<g id="edge371" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_5_gpu_10</title>
<path fill="none" stroke="black" d="M4269.31,-2041.95C4438.98,-2035.14 4730.77,-2019.23 4979,-1984.54 5227.73,-1949.77 5515.12,-1883.43 5668.03,-1846"/>
<polygon fill="black" stroke="black" points="5669.03,-1849.36 5677.9,-1843.58 5667.36,-1842.56 5669.03,-1849.36"/>
</g>
<!-- stage1_expert_layer_2_expert_6_gpu_11 -->
<g id="node111" class="node">
<title>stage1_expert_layer_2_expert_6_gpu_11</title>
<polygon fill="#5a80ff" stroke="black" points="2823,-1843.54 2531,-1843.54 2531,-1791.54 2823,-1791.54 2823,-1843.54"/>
<text text-anchor="middle" x="2677" y="-1831.54" font-family="Arial" font-size="10.00">Expert6</text>
<text text-anchor="middle" x="2677" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2677" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2677" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_6_gpu_11 -->
<g id="edge373" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_6_gpu_11</title>
<path fill="none" stroke="black" d="M3984.63,-2043.3C3744.53,-2036.93 3269.3,-2020.19 3106,-1984.54 2968.33,-1954.49 2816.63,-1887 2735.65,-1847.96"/>
<polygon fill="black" stroke="black" points="2737.13,-1844.79 2726.6,-1843.58 2734.08,-1851.09 2737.13,-1844.79"/>
</g>
<!-- stage1_expert_layer_2_expert_7_gpu_11 -->
<g id="node112" class="node">
<title>stage1_expert_layer_2_expert_7_gpu_11</title>
<polygon fill="#5a80ff" stroke="black" points="1893,-1843.54 1601,-1843.54 1601,-1791.54 1893,-1791.54 1893,-1843.54"/>
<text text-anchor="middle" x="1747" y="-1831.54" font-family="Arial" font-size="10.00">Expert7</text>
<text text-anchor="middle" x="1747" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1747" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1747" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_7_gpu_11 -->
<g id="edge375" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_7_gpu_11</title>
<path fill="none" stroke="black" d="M3984.9,-2044.81C3566.68,-2039.33 2358.46,-2020.56 2184,-1984.54 2043.56,-1955.55 1888.81,-1887.5 1806.4,-1848.12"/>
<polygon fill="black" stroke="black" points="1807.73,-1844.87 1797.2,-1843.69 1804.7,-1851.18 1807.73,-1844.87"/>
</g>
<!-- stage1_expert_layer_2_expert_8_gpu_12 -->
<g id="node113" class="node">
<title>stage1_expert_layer_2_expert_8_gpu_12</title>
<polygon fill="#7880ff" stroke="black" points="5613,-1843.54 5321,-1843.54 5321,-1791.54 5613,-1791.54 5613,-1843.54"/>
<text text-anchor="middle" x="5467" y="-1831.54" font-family="Arial" font-size="10.00">Expert8</text>
<text text-anchor="middle" x="5467" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5467" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5467" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_8_gpu_12 -->
<g id="edge377" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_8_gpu_12</title>
<path fill="none" stroke="black" d="M4269.16,-2036.59C4391.13,-2026.92 4571.32,-2009.95 4727,-1984.54 4955.58,-1947.22 5219.41,-1882.81 5362.14,-1846.16"/>
<polygon fill="black" stroke="black" points="5363.39,-1849.45 5372.2,-1843.57 5361.64,-1842.68 5363.39,-1849.45"/>
</g>
<!-- stage1_expert_layer_2_expert_9_gpu_12 -->
<g id="node114" class="node">
<title>stage1_expert_layer_2_expert_9_gpu_12</title>
<polygon fill="#7880ff" stroke="black" points="4683,-1843.54 4391,-1843.54 4391,-1791.54 4683,-1791.54 4683,-1843.54"/>
<text text-anchor="middle" x="4537" y="-1831.54" font-family="Arial" font-size="10.00">Expert9</text>
<text text-anchor="middle" x="4537" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4537" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4537" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_9_gpu_12 -->
<g id="edge379" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_9_gpu_12</title>
<path fill="none" stroke="black" d="M4181.12,-2021.53C4193.03,-2015.79 4205.51,-2009.59 4217,-2003.54 4314.27,-1952.29 4424.66,-1886.78 4487.05,-1849.05"/>
<polygon fill="black" stroke="black" points="4489.16,-1851.86 4495.9,-1843.69 4485.54,-1845.88 4489.16,-1851.86"/>
</g>
<!-- stage1_expert_layer_2_expert_10_gpu_13 -->
<g id="node115" class="node">
<title>stage1_expert_layer_2_expert_10_gpu_13</title>
<polygon fill="#9680ff" stroke="black" points="4993,-1843.54 4701,-1843.54 4701,-1791.54 4993,-1791.54 4993,-1843.54"/>
<text text-anchor="middle" x="4847" y="-1831.54" font-family="Arial" font-size="10.00">Expert10</text>
<text text-anchor="middle" x="4847" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4847" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4847" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_10_gpu_13 -->
<g id="edge381" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_10_gpu_13</title>
<path fill="none" stroke="black" d="M4220.03,-2021.5C4259.6,-2010.57 4306.18,-1997.35 4348,-1984.54 4496.05,-1939.17 4666.95,-1881.06 4765.44,-1847"/>
<polygon fill="black" stroke="black" points="4766.73,-1850.26 4775.04,-1843.68 4764.44,-1843.64 4766.73,-1850.26"/>
</g>
<!-- stage1_expert_layer_2_expert_11_gpu_13 -->
<g id="node116" class="node">
<title>stage1_expert_layer_2_expert_11_gpu_13</title>
<polygon fill="#9680ff" stroke="black" points="2203,-1843.54 1911,-1843.54 1911,-1791.54 2203,-1791.54 2203,-1843.54"/>
<text text-anchor="middle" x="2057" y="-1831.54" font-family="Arial" font-size="10.00">Expert11</text>
<text text-anchor="middle" x="2057" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2057" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2057" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_11_gpu_13 -->
<g id="edge383" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_11_gpu_13</title>
<path fill="none" stroke="black" d="M3984.89,-2047.13C3642.16,-2047.59 2777.57,-2042.73 2495,-1984.54 2354.08,-1955.52 2198.73,-1887.32 2116.21,-1847.96"/>
<polygon fill="black" stroke="black" points="2117.53,-1844.71 2107,-1843.54 2114.5,-1851.02 2117.53,-1844.71"/>
</g>
<!-- stage1_expert_layer_2_expert_12_gpu_14 -->
<g id="node117" class="node">
<title>stage1_expert_layer_2_expert_12_gpu_14</title>
<polygon fill="#b480ff" stroke="black" points="4373,-1843.54 4081,-1843.54 4081,-1791.54 4373,-1791.54 4373,-1843.54"/>
<text text-anchor="middle" x="4227" y="-1831.54" font-family="Arial" font-size="10.00">Expert12</text>
<text text-anchor="middle" x="4227" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4227" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4227" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_12_gpu_14 -->
<g id="edge385" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_12_gpu_14</title>
<path fill="none" stroke="black" d="M4194.17,-2021.45C4201.09,-2016.46 4207.3,-2010.54 4212,-2003.54 4242.03,-1958.86 4239.25,-1893.7 4233.7,-1853.83"/>
<polygon fill="black" stroke="black" points="4237.13,-1853.13 4232.16,-1843.77 4230.21,-1854.19 4237.13,-1853.13"/>
</g>
<!-- stage1_expert_layer_2_expert_13_gpu_14 -->
<g id="node118" class="node">
<title>stage1_expert_layer_2_expert_13_gpu_14</title>
<polygon fill="#b480ff" stroke="black" points="3753,-1843.54 3461,-1843.54 3461,-1791.54 3753,-1791.54 3753,-1843.54"/>
<text text-anchor="middle" x="3607" y="-1831.54" font-family="Arial" font-size="10.00">Expert13</text>
<text text-anchor="middle" x="3607" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3607" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3607" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_13_gpu_14 -->
<g id="edge387" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_13_gpu_14</title>
<path fill="none" stroke="black" d="M3984.77,-2039.72C3834.88,-2031.04 3616.88,-2013.59 3591,-1984.54 3559.26,-1948.92 3575.01,-1890.38 3590.26,-1853.18"/>
<polygon fill="black" stroke="black" points="3593.58,-1854.33 3594.31,-1843.76 3587.15,-1851.57 3593.58,-1854.33"/>
</g>
<!-- stage1_expert_layer_2_expert_14_gpu_15 -->
<g id="node119" class="node">
<title>stage1_expert_layer_2_expert_14_gpu_15</title>
<polygon fill="#d280ff" stroke="black" points="1583,-1843.54 1291,-1843.54 1291,-1791.54 1583,-1791.54 1583,-1843.54"/>
<text text-anchor="middle" x="1437" y="-1831.54" font-family="Arial" font-size="10.00">Expert14</text>
<text text-anchor="middle" x="1437" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1437" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1437" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_14_gpu_15 -->
<g id="edge389" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_14_gpu_15</title>
<path fill="none" stroke="black" d="M3984.79,-2045.47C3522.41,-2041.61 2079.63,-2026.31 1874,-1984.54 1733.28,-1955.95 1578.33,-1887.59 1496.04,-1848.08"/>
<polygon fill="black" stroke="black" points="1497.38,-1844.84 1486.85,-1843.65 1494.34,-1851.15 1497.38,-1844.84"/>
</g>
<!-- stage1_expert_layer_2_expert_15_gpu_15 -->
<g id="node120" class="node">
<title>stage1_expert_layer_2_expert_15_gpu_15</title>
<polygon fill="#d280ff" stroke="black" points="6233,-1843.54 5941,-1843.54 5941,-1791.54 6233,-1791.54 6233,-1843.54"/>
<text text-anchor="middle" x="6087" y="-1831.54" font-family="Arial" font-size="10.00">Expert15</text>
<text text-anchor="middle" x="6087" y="-1820.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="6087" y="-1809.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="6087" y="-1798.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_15_gpu_15 -->
<g id="edge391" class="edge">
<title>stage1_ln2_layer_2&#45;&gt;stage1_expert_layer_2_expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M4269.4,-2045.08C4483.16,-2041.45 4899.35,-2028.77 5250,-1984.54 5512.19,-1951.47 5815.41,-1883.88 5975.15,-1845.94"/>
<polygon fill="black" stroke="black" points="5976.08,-1849.32 5985,-1843.6 5974.46,-1842.51 5976.08,-1849.32"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_0_gpu_8 -->
<g id="edge360" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_0_gpu_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3904.42,-1880.33C3906.27,-1871.28 3908.14,-1862.05 3909.87,-1853.57"/>
<polygon fill="red" stroke="red" points="3913.32,-1854.17 3911.88,-1843.67 3906.46,-1852.77 3913.32,-1854.17"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_1_gpu_8 -->
<g id="edge362" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_1_gpu_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3624.32,-1880.49C3560.48,-1868.41 3494.87,-1855.99 3439.31,-1845.47"/>
<polygon fill="red" stroke="red" points="3439.88,-1842.02 3429.41,-1843.6 3438.58,-1848.9 3439.88,-1842.02"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_2_gpu_9 -->
<g id="edge364" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_2_gpu_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3648.64,-1922.9C3375.94,-1911.66 2922.45,-1888.11 2523.4,-1843.65"/>
<polygon fill="red" stroke="red" points="2523.72,-1840.17 2513.39,-1842.53 2522.94,-1847.13 2523.72,-1840.17"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_3_gpu_9 -->
<g id="edge366" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_3_gpu_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4106.86,-1913.99C4282.35,-1899.62 4537.8,-1878.88 4761,-1861.54 4864.84,-1853.47 4893.61,-1855.94 5000.37,-1843.68"/>
<polygon fill="red" stroke="red" points="5001.07,-1847.13 5010.6,-1842.49 5000.27,-1840.17 5001.07,-1847.13"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_4_gpu_10 -->
<g id="edge368" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_4_gpu_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3625.21,-1902.95C3484.43,-1887.27 3308.98,-1866.61 3142.92,-1843.65"/>
<polygon fill="red" stroke="red" points="3143.39,-1840.18 3133.01,-1842.27 3142.43,-1847.11 3143.39,-1840.18"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_5_gpu_10 -->
<g id="edge370" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_5_gpu_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4114.9,-1920.93C4550.14,-1899.95 5487.42,-1854.29 5620.31,-1843.52"/>
<polygon fill="red" stroke="red" points="5620.97,-1846.97 5630.61,-1842.59 5620.34,-1840 5620.97,-1846.97"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_6_gpu_11 -->
<g id="edge372" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_6_gpu_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3633.1,-1909.53C3467.74,-1895.64 3249.34,-1877.38 3056,-1861.54 2959.67,-1853.64 2932.87,-1855.37 2833.57,-1843.68"/>
<polygon fill="red" stroke="red" points="2833.74,-1840.18 2823.4,-1842.47 2832.91,-1847.13 2833.74,-1840.18"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_7_gpu_11 -->
<g id="edge374" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_7_gpu_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3656.48,-1929.92C3284.4,-1925.4 2541.52,-1908.38 1903.71,-1843.66"/>
<polygon fill="red" stroke="red" points="1903.69,-1840.14 1893.38,-1842.61 1902.98,-1847.11 1903.69,-1840.14"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_8_gpu_12 -->
<g id="edge376" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_8_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4111.95,-1918.29C4483.92,-1895.64 5210.32,-1851.23 5310.49,-1843.42"/>
<polygon fill="red" stroke="red" points="5310.95,-1846.9 5320.61,-1842.54 5310.34,-1839.92 5310.95,-1846.9"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_9_gpu_12 -->
<g id="edge378" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_9_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4087.79,-1897.48C4182.96,-1880.76 4295.95,-1860.9 4384.8,-1845.29"/>
<polygon fill="red" stroke="red" points="4385.44,-1848.73 4394.69,-1843.55 4384.23,-1841.83 4385.44,-1848.73"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_10_gpu_13 -->
<g id="edge380" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_10_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4098.96,-1907.12C4217.53,-1893.23 4369.62,-1875.81 4505,-1861.54 4584.87,-1853.12 4607.49,-1854.1 4690.45,-1843.7"/>
<polygon fill="red" stroke="red" points="4691.11,-1847.14 4700.59,-1842.41 4690.23,-1840.2 4691.11,-1847.14"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_11_gpu_13 -->
<g id="edge382" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_11_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3645.08,-1920C3220.53,-1900.11 2386.23,-1859.99 2213.57,-1843.6"/>
<polygon fill="red" stroke="red" points="2213.69,-1840.1 2203.39,-1842.58 2212.99,-1847.06 2213.69,-1840.1"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_12_gpu_14 -->
<g id="edge384" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_12_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4044.43,-1880.49C4078.49,-1868.94 4113.45,-1857.07 4143.55,-1846.86"/>
<polygon fill="red" stroke="red" points="4144.8,-1850.13 4153.14,-1843.6 4142.55,-1843.5 4144.8,-1850.13"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_13_gpu_14 -->
<g id="edge386" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_13_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3764.35,-1880.49C3735.51,-1869.14 3705.91,-1857.48 3680.27,-1847.39"/>
<polygon fill="red" stroke="red" points="3681.24,-1844.01 3670.65,-1843.6 3678.68,-1850.52 3681.24,-1844.01"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_14_gpu_15 -->
<g id="edge388" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_14_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3658.89,-1931.98C3243.47,-1930.66 2352.56,-1918.45 1593.43,-1843.63"/>
<polygon fill="red" stroke="red" points="1593.68,-1840.14 1583.38,-1842.64 1592.99,-1847.1 1593.68,-1840.14"/>
</g>
<!-- stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_15_gpu_15 -->
<g id="edge390" class="edge">
<title>stage1_gate_layer_2&#45;&gt;stage1_expert_layer_2_expert_15_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4125.77,-1930.32C4502.63,-1926.38 5271.6,-1910.18 5930.44,-1843.65"/>
<polygon fill="red" stroke="red" points="5931.02,-1847.11 5940.62,-1842.62 5930.31,-1840.14 5931.02,-1847.11"/>
</g>
<!-- stage1_expert_agg_layer_2 -->
<g id="node121" class="node">
<title>stage1_expert_agg_layer_2</title>
<polygon fill="#ffcccc" stroke="black" points="4226.98,-1754.54 3733.87,-1754.54 3607.02,-1650.54 4100.13,-1650.54 4226.98,-1754.54"/>
<text text-anchor="middle" x="3917" y="-1716.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3917" y="-1705.54" font-family="Arial" font-size="10.00">Input: [8Ã— batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3917" y="-1694.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3917" y="-1683.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (all&#45;reduce)</text>
</g>
<!-- stage1_expert_layer_2_expert_0_gpu_8&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge392" class="edge">
<title>stage1_expert_layer_2_expert_0_gpu_8&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M3917,-1791.46C3917,-1783.53 3917,-1774.4 3917,-1765.08"/>
<polygon fill="black" stroke="black" points="3920.5,-1764.94 3917,-1754.94 3913.5,-1764.94 3920.5,-1764.94"/>
</g>
<!-- stage1_expert_layer_2_expert_1_gpu_8&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge393" class="edge">
<title>stage1_expert_layer_2_expert_1_gpu_8&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M3434.21,-1791.53C3513.97,-1776.99 3616.16,-1758.37 3705.96,-1742"/>
<polygon fill="black" stroke="black" points="3706.79,-1745.41 3716,-1740.17 3705.54,-1738.52 3706.79,-1745.41"/>
</g>
<!-- stage1_expert_layer_2_expert_2_gpu_9&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge394" class="edge">
<title>stage1_expert_layer_2_expert_2_gpu_9&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M2513.39,-1792.54C2516.28,-1792.19 2519.16,-1791.86 2522,-1791.54 2923.1,-1746.65 3391.84,-1722.94 3671.03,-1711.84"/>
<polygon fill="black" stroke="black" points="3671.44,-1715.33 3681.29,-1711.44 3671.16,-1708.34 3671.44,-1715.33"/>
</g>
<!-- stage1_expert_layer_2_expert_3_gpu_9&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge395" class="edge">
<title>stage1_expert_layer_2_expert_3_gpu_9&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M5010.6,-1792.61C5007.71,-1792.24 5004.84,-1791.88 5002,-1791.54 4728.07,-1758.39 4413.67,-1734.43 4194.07,-1719.96"/>
<polygon fill="black" stroke="black" points="4194.22,-1716.46 4184.01,-1719.3 4193.76,-1723.45 4194.22,-1716.46"/>
</g>
<!-- stage1_expert_layer_2_expert_4_gpu_10&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge396" class="edge">
<title>stage1_expert_layer_2_expert_4_gpu_10&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M3133,-1792.79C3136.03,-1792.37 3139.03,-1791.95 3142,-1791.54 3325.29,-1766.37 3533.68,-1743 3688.17,-1726.68"/>
<polygon fill="black" stroke="black" points="3688.69,-1730.14 3698.27,-1725.61 3687.96,-1723.18 3688.69,-1730.14"/>
</g>
<!-- stage1_expert_layer_2_expert_5_gpu_10&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge397" class="edge">
<title>stage1_expert_layer_2_expert_5_gpu_10&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M5630.61,-1792.5C5627.72,-1792.16 5624.85,-1791.84 5622,-1791.54 5113.67,-1737.59 4516.43,-1716.39 4180.79,-1708.3"/>
<polygon fill="black" stroke="black" points="4180.52,-1704.79 4170.44,-1708.05 4180.35,-1711.79 4180.52,-1704.79"/>
</g>
<!-- stage1_expert_layer_2_expert_6_gpu_11&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge398" class="edge">
<title>stage1_expert_layer_2_expert_6_gpu_11&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M2823.4,-1792.61C2826.29,-1792.24 2829.16,-1791.88 2832,-1791.54 3122.1,-1756.43 3457.58,-1731.63 3677.8,-1717.49"/>
<polygon fill="black" stroke="black" points="3678.11,-1720.98 3687.87,-1716.85 3677.66,-1714 3678.11,-1720.98"/>
</g>
<!-- stage1_expert_layer_2_expert_7_gpu_11&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge399" class="edge">
<title>stage1_expert_layer_2_expert_7_gpu_11&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M1893.38,-1792.46C1896.28,-1792.14 1899.15,-1791.83 1902,-1791.54 2533.23,-1727.07 3280.42,-1709.78 3663.15,-1705.18"/>
<polygon fill="black" stroke="black" points="3663.28,-1708.67 3673.24,-1705.06 3663.2,-1701.68 3663.28,-1708.67"/>
</g>
<!-- stage1_expert_layer_2_expert_8_gpu_12&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge400" class="edge">
<title>stage1_expert_layer_2_expert_8_gpu_12&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M5320.61,-1792.54C5317.72,-1792.19 5314.84,-1791.86 5312,-1791.54 4921.77,-1747.86 4467.51,-1724.24 4186.08,-1712.77"/>
<polygon fill="black" stroke="black" points="4185.86,-1709.26 4175.72,-1712.35 4185.57,-1716.26 4185.86,-1709.26"/>
</g>
<!-- stage1_expert_layer_2_expert_9_gpu_12&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge401" class="edge">
<title>stage1_expert_layer_2_expert_9_gpu_12&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M4399.79,-1791.53C4342.76,-1781.14 4274.27,-1768.65 4207.03,-1756.4"/>
<polygon fill="black" stroke="black" points="4207.59,-1752.94 4197.12,-1754.59 4206.33,-1759.83 4207.59,-1752.94"/>
</g>
<!-- stage1_expert_layer_2_expert_10_gpu_13&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge402" class="edge">
<title>stage1_expert_layer_2_expert_10_gpu_13&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M4701,-1792.79C4697.97,-1792.37 4694.97,-1791.95 4692,-1791.54 4644.44,-1785.01 4411.81,-1758.71 4213.71,-1736.55"/>
<polygon fill="black" stroke="black" points="4214.04,-1733.07 4203.71,-1735.44 4213.26,-1740.03 4214.04,-1733.07"/>
</g>
<!-- stage1_expert_layer_2_expert_11_gpu_13&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge403" class="edge">
<title>stage1_expert_layer_2_expert_11_gpu_13&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M2203.39,-1792.5C2206.28,-1792.16 2209.15,-1791.84 2212,-1791.54 2727.07,-1736.87 3333.43,-1715.83 3666.44,-1707.99"/>
<polygon fill="black" stroke="black" points="3666.79,-1711.48 3676.7,-1707.75 3666.62,-1704.48 3666.79,-1711.48"/>
</g>
<!-- stage1_expert_layer_2_expert_12_gpu_14&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge404" class="edge">
<title>stage1_expert_layer_2_expert_12_gpu_14&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M4158.2,-1791.46C4131.01,-1781.55 4098.62,-1769.74 4066.55,-1758.05"/>
<polygon fill="black" stroke="black" points="4067.66,-1754.73 4057.07,-1754.6 4065.26,-1761.31 4067.66,-1754.73"/>
</g>
<!-- stage1_expert_layer_2_expert_13_gpu_14&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge405" class="edge">
<title>stage1_expert_layer_2_expert_13_gpu_14&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M3675.8,-1791.46C3702.99,-1781.55 3735.38,-1769.74 3767.45,-1758.05"/>
<polygon fill="black" stroke="black" points="3768.74,-1761.31 3776.93,-1754.6 3766.34,-1754.73 3768.74,-1761.31"/>
</g>
<!-- stage1_expert_layer_2_expert_14_gpu_15&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge406" class="edge">
<title>stage1_expert_layer_2_expert_14_gpu_15&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M1583.38,-1792.44C1586.28,-1792.12 1589.15,-1791.82 1592,-1791.54 2341.04,-1717.24 3231.52,-1704.48 3660.65,-1703.04"/>
<polygon fill="black" stroke="black" points="3660.71,-1706.54 3670.7,-1703 3660.69,-1699.54 3660.71,-1706.54"/>
</g>
<!-- stage1_expert_layer_2_expert_15_gpu_15&#45;&gt;stage1_expert_agg_layer_2 -->
<g id="edge407" class="edge">
<title>stage1_expert_layer_2_expert_15_gpu_15&#45;&gt;stage1_expert_agg_layer_2</title>
<path fill="none" stroke="black" d="M5940.62,-1792.46C5937.72,-1792.14 5934.85,-1791.83 5932,-1791.54 5304.23,-1727.42 4561.75,-1709.97 4177.17,-1705.25"/>
<polygon fill="black" stroke="black" points="4177.06,-1701.75 4167.02,-1705.13 4176.98,-1708.75 4177.06,-1701.75"/>
</g>
<!-- stage1_expert_agg_layer_2&#45;&gt;stage1_residual2_layer_2 -->
<g id="edge408" class="edge">
<title>stage1_expert_agg_layer_2&#45;&gt;stage1_residual2_layer_2</title>
<path fill="none" stroke="black" d="M4138.63,-1682.03C4437.93,-1655.68 4968.49,-1608.98 5270.02,-1582.43"/>
<polygon fill="black" stroke="black" points="5270.55,-1585.9 5280.2,-1581.54 5269.94,-1578.93 5270.55,-1585.9"/>
</g>
<!-- stage1_ln1_layer_3 -->
<g id="node123" class="node">
<title>stage1_ln1_layer_3</title>
<polygon fill="#0080ff" stroke="black" points="4529,-1451.54 4245,-1451.54 4245,-1399.54 4529,-1399.54 4529,-1451.54"/>
<text text-anchor="middle" x="4387" y="-1439.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4387" y="-1428.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4387" y="-1417.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4387" y="-1406.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (sharded)</text>
</g>
<!-- stage1_residual2_layer_2&#45;&gt;stage1_ln1_layer_3 -->
<g id="edge410" class="edge">
<title>stage1_residual2_layer_2&#45;&gt;stage1_ln1_layer_3</title>
<path fill="none" stroke="black" d="M5215.08,-1526.6C5000.43,-1500.66 4712.79,-1465.9 4539.16,-1444.92"/>
<polygon fill="black" stroke="black" points="4539.53,-1441.44 4529.18,-1443.72 4538.69,-1448.39 4539.53,-1441.44"/>
</g>
<!-- stage1_residual1_layer_3 -->
<g id="node142" class="node">
<title>stage1_residual1_layer_3</title>
<polygon fill="#ffffcc" stroke="black" points="5636.82,-910.54 5158.28,-910.54 5035.18,-806.54 5513.72,-806.54 5636.82,-910.54"/>
<text text-anchor="middle" x="5336" y="-872.54" font-family="Arial" font-size="10.00">Residual Add 1</text>
<text text-anchor="middle" x="5336" y="-861.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5336" y="-850.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5336" y="-839.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (all&#45;reduce)</text>
</g>
<!-- stage1_residual2_layer_2&#45;&gt;stage1_residual1_layer_3 -->
<g id="edge493" class="edge">
<title>stage1_residual2_layer_2&#45;&gt;stage1_residual1_layer_3</title>
<path fill="none" stroke="black" d="M5496,-1509.32C5496,-1484.35 5496,-1453.87 5496,-1426.54 5496,-1426.54 5496,-1426.54 5496,-972.54 5496,-950.47 5485.72,-932.34 5470.38,-917.55"/>
<polygon fill="black" stroke="black" points="5472.27,-914.55 5462.46,-910.56 5467.64,-919.8 5472.27,-914.55"/>
</g>
<!-- stage1_qkv_layer_3_gpu_8 -->
<g id="node124" class="node">
<title>stage1_qkv_layer_3_gpu_8</title>
<polygon fill="#0080ff" stroke="black" points="5163,-1362.54 4867,-1362.54 4867,-1288.54 5163,-1288.54 5163,-1362.54"/>
<text text-anchor="middle" x="5015" y="-1350.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="5015" y="-1339.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5015" y="-1328.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5015" y="-1317.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5015" y="-1306.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5015" y="-1295.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_8 -->
<g id="edge411" class="edge">
<title>stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_8</title>
<path fill="none" stroke="black" d="M4529.24,-1409.36C4620.31,-1398.8 4741.15,-1383.22 4856.66,-1362.73"/>
<polygon fill="black" stroke="black" points="4857.52,-1366.13 4866.74,-1360.93 4856.28,-1359.24 4857.52,-1366.13"/>
</g>
<!-- stage1_qkv_layer_3_gpu_9 -->
<g id="node125" class="node">
<title>stage1_qkv_layer_3_gpu_9</title>
<polygon fill="#1e80ff" stroke="black" points="3907,-1362.54 3611,-1362.54 3611,-1288.54 3907,-1288.54 3907,-1362.54"/>
<text text-anchor="middle" x="3759" y="-1350.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3759" y="-1339.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3759" y="-1328.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3759" y="-1317.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3759" y="-1306.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3759" y="-1295.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_9 -->
<g id="edge420" class="edge">
<title>stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_9</title>
<path fill="none" stroke="black" d="M4244.76,-1409.36C4153.69,-1398.8 4032.85,-1383.22 3917.34,-1362.73"/>
<polygon fill="black" stroke="black" points="3917.72,-1359.24 3907.26,-1360.93 3916.48,-1366.13 3917.72,-1359.24"/>
</g>
<!-- stage1_qkv_layer_3_gpu_10 -->
<g id="node126" class="node">
<title>stage1_qkv_layer_3_gpu_10</title>
<polygon fill="#3c80ff" stroke="black" points="4221,-1362.54 3925,-1362.54 3925,-1288.54 4221,-1288.54 4221,-1362.54"/>
<text text-anchor="middle" x="4073" y="-1350.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4073" y="-1339.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4073" y="-1328.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4073" y="-1317.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4073" y="-1306.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4073" y="-1295.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_10 -->
<g id="edge429" class="edge">
<title>stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_10</title>
<path fill="none" stroke="black" d="M4306.54,-1399.43C4273.6,-1389.15 4234.71,-1377.01 4198.2,-1365.62"/>
<polygon fill="black" stroke="black" points="4199.07,-1362.22 4188.48,-1362.58 4196.98,-1368.9 4199.07,-1362.22"/>
</g>
<!-- stage1_qkv_layer_3_gpu_11 -->
<g id="node127" class="node">
<title>stage1_qkv_layer_3_gpu_11</title>
<polygon fill="#5a80ff" stroke="black" points="3593,-1362.54 3297,-1362.54 3297,-1288.54 3593,-1288.54 3593,-1362.54"/>
<text text-anchor="middle" x="3445" y="-1350.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3445" y="-1339.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3445" y="-1328.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3445" y="-1317.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3445" y="-1306.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3445" y="-1295.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_11 -->
<g id="edge438" class="edge">
<title>stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_11</title>
<path fill="none" stroke="black" d="M4244.82,-1419.58C4089.33,-1412.72 3832.78,-1397.21 3603.43,-1362.69"/>
<polygon fill="black" stroke="black" points="3603.63,-1359.18 3593.22,-1361.13 3602.58,-1366.1 3603.63,-1359.18"/>
</g>
<!-- stage1_qkv_layer_3_gpu_12 -->
<g id="node128" class="node">
<title>stage1_qkv_layer_3_gpu_12</title>
<polygon fill="#7880ff" stroke="black" points="3279,-1362.54 2983,-1362.54 2983,-1288.54 3279,-1288.54 3279,-1362.54"/>
<text text-anchor="middle" x="3131" y="-1350.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="3131" y="-1339.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3131" y="-1328.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3131" y="-1317.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3131" y="-1306.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3131" y="-1295.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_12 -->
<g id="edge447" class="edge">
<title>stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_12</title>
<path fill="none" stroke="black" d="M4244.86,-1424.17C4036.67,-1421.92 3636.76,-1411.11 3289.22,-1362.63"/>
<polygon fill="black" stroke="black" points="3289.6,-1359.15 3279.21,-1361.22 3288.62,-1366.08 3289.6,-1359.15"/>
</g>
<!-- stage1_qkv_layer_3_gpu_13 -->
<g id="node129" class="node">
<title>stage1_qkv_layer_3_gpu_13</title>
<polygon fill="#9680ff" stroke="black" points="4849,-1362.54 4553,-1362.54 4553,-1288.54 4849,-1288.54 4849,-1362.54"/>
<text text-anchor="middle" x="4701" y="-1350.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4701" y="-1339.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4701" y="-1328.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4701" y="-1317.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4701" y="-1306.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4701" y="-1295.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_13 -->
<g id="edge456" class="edge">
<title>stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_13</title>
<path fill="none" stroke="black" d="M4467.46,-1399.43C4500.4,-1389.15 4539.29,-1377.01 4575.8,-1365.62"/>
<polygon fill="black" stroke="black" points="4577.02,-1368.9 4585.52,-1362.58 4574.93,-1362.22 4577.02,-1368.9"/>
</g>
<!-- stage1_qkv_layer_3_gpu_14 -->
<g id="node130" class="node">
<title>stage1_qkv_layer_3_gpu_14</title>
<polygon fill="#b480ff" stroke="black" points="5477,-1362.54 5181,-1362.54 5181,-1288.54 5477,-1288.54 5477,-1362.54"/>
<text text-anchor="middle" x="5329" y="-1350.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="5329" y="-1339.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5329" y="-1328.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5329" y="-1317.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5329" y="-1306.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5329" y="-1295.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_14 -->
<g id="edge465" class="edge">
<title>stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_14</title>
<path fill="none" stroke="black" d="M4529.18,-1419.58C4684.67,-1412.72 4941.22,-1397.21 5170.57,-1362.69"/>
<polygon fill="black" stroke="black" points="5171.42,-1366.1 5180.78,-1361.13 5170.37,-1359.18 5171.42,-1366.1"/>
</g>
<!-- stage1_qkv_layer_3_gpu_15 -->
<g id="node131" class="node">
<title>stage1_qkv_layer_3_gpu_15</title>
<polygon fill="#d280ff" stroke="black" points="4535,-1362.54 4239,-1362.54 4239,-1288.54 4535,-1288.54 4535,-1362.54"/>
<text text-anchor="middle" x="4387" y="-1350.54" font-family="Arial" font-size="10.00">QKV Projection</text>
<text text-anchor="middle" x="4387" y="-1339.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4387" y="-1328.54" font-family="Arial" font-size="10.00">Output: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4387" y="-1317.54" font-family="Arial" font-size="10.00">K:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4387" y="-1306.54" font-family="Arial" font-size="10.00">V:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4387" y="-1295.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_15 -->
<g id="edge474" class="edge">
<title>stage1_ln1_layer_3&#45;&gt;stage1_qkv_layer_3_gpu_15</title>
<path fill="none" stroke="black" d="M4387,-1399.3C4387,-1391.23 4387,-1382.01 4387,-1372.92"/>
<polygon fill="black" stroke="black" points="4390.5,-1372.77 4387,-1362.77 4383.5,-1372.77 4390.5,-1372.77"/>
</g>
<!-- stage1_attention_layer_3_gpu_8 -->
<g id="node132" class="node">
<title>stage1_attention_layer_3_gpu_8</title>
<polygon fill="#0080ff" stroke="black" points="5145.5,-1251.54 4856.5,-1251.54 4856.5,-1177.54 5145.5,-1177.54 5145.5,-1251.54"/>
<text text-anchor="middle" x="5001" y="-1239.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5001" y="-1228.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5001" y="-1217.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5001" y="-1206.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5001" y="-1195.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5001" y="-1184.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_8 -->
<g id="edge412" class="edge">
<title>stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_8</title>
<path fill="none" stroke="black" d="M5010.34,-1288.24C5009.25,-1279.79 5008.08,-1270.67 5006.95,-1261.84"/>
<polygon fill="black" stroke="black" points="5010.39,-1261.15 5005.64,-1251.68 5003.44,-1262.04 5010.39,-1261.15"/>
</g>
<!-- stage1_attention_layer_3_gpu_9 -->
<g id="node133" class="node">
<title>stage1_attention_layer_3_gpu_9</title>
<polygon fill="#1e80ff" stroke="black" points="4531.5,-1251.54 4242.5,-1251.54 4242.5,-1177.54 4531.5,-1177.54 4531.5,-1251.54"/>
<text text-anchor="middle" x="4387" y="-1239.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4387" y="-1228.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4387" y="-1217.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4387" y="-1206.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4387" y="-1195.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4387" y="-1184.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_9 -->
<g id="edge422" class="edge">
<title>stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4866.75,-1290.09C4863.81,-1289.56 4860.89,-1289.04 4858,-1288.54 4721.36,-1264.97 4682.47,-1275.45 4541.47,-1251.54"/>
<polygon fill="blue" stroke="blue" points="4542.03,-1248.09 4531.58,-1249.84 4540.84,-1254.99 4542.03,-1248.09"/>
</g>
<!-- stage1_attention_layer_3_gpu_10 -->
<g id="node134" class="node">
<title>stage1_attention_layer_3_gpu_10</title>
<polygon fill="#3c80ff" stroke="black" points="4838.5,-1251.54 4549.5,-1251.54 4549.5,-1177.54 4838.5,-1177.54 4838.5,-1251.54"/>
<text text-anchor="middle" x="4694" y="-1239.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4694" y="-1228.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4694" y="-1217.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4694" y="-1206.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4694" y="-1195.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4694" y="-1184.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_10 -->
<g id="edge431" class="edge">
<title>stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4908.56,-1288.4C4876.83,-1277.62 4841.92,-1265.77 4809.63,-1254.8"/>
<polygon fill="blue" stroke="blue" points="4810.75,-1251.49 4800.15,-1251.59 4808.5,-1258.11 4810.75,-1251.49"/>
</g>
<!-- stage1_attention_layer_3_gpu_11 -->
<g id="node135" class="node">
<title>stage1_attention_layer_3_gpu_11</title>
<polygon fill="#5a80ff" stroke="black" points="3610.5,-1251.54 3321.5,-1251.54 3321.5,-1177.54 3610.5,-1177.54 3610.5,-1251.54"/>
<text text-anchor="middle" x="3466" y="-1239.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3466" y="-1228.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3466" y="-1217.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3466" y="-1206.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3466" y="-1195.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3466" y="-1184.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_11 -->
<g id="edge440" class="edge">
<title>stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4866.81,-1289.75C4863.85,-1289.32 4860.91,-1288.91 4858,-1288.54 4724.3,-1271.38 3795.69,-1269.42 3620.53,-1251.37"/>
<polygon fill="blue" stroke="blue" points="3620.86,-1247.88 3610.53,-1250.21 3620.06,-1254.83 3620.86,-1247.88"/>
</g>
<!-- stage1_attention_layer_3_gpu_12 -->
<g id="node136" class="node">
<title>stage1_attention_layer_3_gpu_12</title>
<polygon fill="#7880ff" stroke="black" points="4224.5,-1251.54 3935.5,-1251.54 3935.5,-1177.54 4224.5,-1177.54 4224.5,-1251.54"/>
<text text-anchor="middle" x="4080" y="-1239.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4080" y="-1228.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4080" y="-1217.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4080" y="-1206.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="4080" y="-1195.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4080" y="-1184.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_12 -->
<g id="edge449" class="edge">
<title>stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4866.79,-1289.86C4863.84,-1289.4 4860.91,-1288.96 4858,-1288.54 4586.21,-1249.6 4510.69,-1290.54 4234.46,-1251.51"/>
<polygon fill="blue" stroke="blue" points="4234.94,-1248.04 4224.54,-1250.08 4233.95,-1254.97 4234.94,-1248.04"/>
</g>
<!-- stage1_attention_layer_3_gpu_13 -->
<g id="node137" class="node">
<title>stage1_attention_layer_3_gpu_13</title>
<polygon fill="#9680ff" stroke="black" points="3303.5,-1251.54 3014.5,-1251.54 3014.5,-1177.54 3303.5,-1177.54 3303.5,-1251.54"/>
<text text-anchor="middle" x="3159" y="-1239.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3159" y="-1228.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3159" y="-1217.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3159" y="-1206.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3159" y="-1195.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3159" y="-1184.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_13 -->
<g id="edge458" class="edge">
<title>stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4866.81,-1289.72C4863.85,-1289.3 4860.91,-1288.9 4858,-1288.54 4690.53,-1267.55 3524.2,-1273.05 3313.63,-1251.39"/>
<polygon fill="blue" stroke="blue" points="3313.86,-1247.89 3303.52,-1250.24 3313.06,-1254.85 3313.86,-1247.89"/>
</g>
<!-- stage1_attention_layer_3_gpu_14 -->
<g id="node138" class="node">
<title>stage1_attention_layer_3_gpu_14</title>
<polygon fill="#b480ff" stroke="black" points="5452.5,-1251.54 5163.5,-1251.54 5163.5,-1177.54 5452.5,-1177.54 5452.5,-1251.54"/>
<text text-anchor="middle" x="5308" y="-1239.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5308" y="-1228.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5308" y="-1217.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5308" y="-1206.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="5308" y="-1195.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="5308" y="-1184.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_14 -->
<g id="edge467" class="edge">
<title>stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M5125.08,-1288.46C5141.87,-1282.65 5158.94,-1276.56 5175,-1270.54 5187.61,-1265.81 5200.81,-1260.63 5213.79,-1255.4"/>
<polygon fill="blue" stroke="blue" points="5215.24,-1258.6 5223.19,-1251.6 5212.61,-1252.11 5215.24,-1258.6"/>
</g>
<!-- stage1_attention_layer_3_gpu_15 -->
<g id="node139" class="node">
<title>stage1_attention_layer_3_gpu_15</title>
<polygon fill="#d280ff" stroke="black" points="3917.5,-1251.54 3628.5,-1251.54 3628.5,-1177.54 3917.5,-1177.54 3917.5,-1251.54"/>
<text text-anchor="middle" x="3773" y="-1239.54" font-family="Arial" font-size="10.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3773" y="-1228.54" font-family="Arial" font-size="10.00">Input: Q:[batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3773" y="-1217.54" font-family="Arial" font-size="10.00">K_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3773" y="-1206.54" font-family="Arial" font-size="10.00">V_all:[batch_size=1024, seq_len=2048, heads=32, d_k=128]</text>
<text text-anchor="middle" x="3773" y="-1195.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="3773" y="-1184.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_15 -->
<g id="edge476" class="edge">
<title>stage1_qkv_layer_3_gpu_8&#45;&gt;stage1_attention_layer_3_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4866.8,-1289.79C4863.85,-1289.34 4860.91,-1288.93 4858,-1288.54 4655.87,-1261.59 4147.86,-1278.8 3927.49,-1251.46"/>
<polygon fill="blue" stroke="blue" points="3927.9,-1247.98 3917.53,-1250.17 3927,-1254.93 3927.9,-1247.98"/>
</g>
<!-- stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_8 -->
<g id="edge413" class="edge">
<title>stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3907.19,-1289.7C3910.15,-1289.28 3913.09,-1288.89 3916,-1288.54 3973.25,-1281.56 4901.83,-1295.13 4954,-1270.54 4960.11,-1267.66 4965.72,-1263.57 4970.78,-1258.89"/>
<polygon fill="blue" stroke="blue" points="4973.31,-1261.31 4977.79,-1251.71 4968.3,-1256.42 4973.31,-1261.31"/>
</g>
<!-- stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_9 -->
<g id="edge421" class="edge">
<title>stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_9</title>
<path fill="none" stroke="black" d="M3907.21,-1289.85C3910.16,-1289.39 3913.09,-1288.95 3916,-1288.54 4060.13,-1268.2 4100.64,-1300.87 4243,-1270.54 4260.56,-1266.8 4278.8,-1261.24 4296.16,-1255.08"/>
<polygon fill="black" stroke="black" points="4297.51,-1258.31 4305.71,-1251.6 4295.12,-1251.73 4297.51,-1258.31"/>
</g>
<!-- stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_10 -->
<g id="edge432" class="edge">
<title>stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3907.19,-1289.74C3910.15,-1289.31 3913.09,-1288.91 3916,-1288.54 4055.37,-1270.75 4410.14,-1297.68 4548,-1270.54 4566.16,-1266.96 4585.03,-1261.38 4602.94,-1255.11"/>
<polygon fill="blue" stroke="blue" points="4604.56,-1258.25 4612.78,-1251.56 4602.18,-1251.66 4604.56,-1258.25"/>
</g>
<!-- stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_11 -->
<g id="edge441" class="edge">
<title>stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3638.33,-1288.39C3621.32,-1282.73 3604.14,-1276.7 3588,-1270.54 3576.07,-1265.98 3563.63,-1260.85 3551.46,-1255.59"/>
<polygon fill="blue" stroke="blue" points="3552.78,-1252.35 3542.21,-1251.55 3549.98,-1258.76 3552.78,-1252.35"/>
</g>
<!-- stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_12 -->
<g id="edge450" class="edge">
<title>stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3907.26,-1290.15C3910.19,-1289.6 3913.11,-1289.06 3916,-1288.54 3946,-1283.13 4027.11,-1288.15 4052,-1270.54 4056,-1267.71 4059.46,-1264.14 4062.45,-1260.18"/>
<polygon fill="blue" stroke="blue" points="4065.49,-1261.92 4067.95,-1251.62 4059.6,-1258.14 4065.49,-1261.92"/>
</g>
<!-- stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_13 -->
<g id="edge459" class="edge">
<title>stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3610.78,-1289.91C3607.83,-1289.43 3604.9,-1288.97 3602,-1288.54 3489.63,-1271.79 3458.83,-1290.6 3347,-1270.54 3324.3,-1266.47 3300.44,-1260.69 3277.62,-1254.4"/>
<polygon fill="blue" stroke="blue" points="3278.48,-1251.01 3267.91,-1251.68 3276.59,-1257.75 3278.48,-1251.01"/>
</g>
<!-- stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_14 -->
<g id="edge468" class="edge">
<title>stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3907.19,-1289.69C3910.15,-1289.28 3913.09,-1288.89 3916,-1288.54 4173.04,-1257.43 4824.15,-1303.23 5081,-1270.54 5110.45,-1266.79 5141.63,-1260.69 5171.13,-1253.88"/>
<polygon fill="blue" stroke="blue" points="5172.13,-1257.24 5181.07,-1251.55 5170.53,-1250.43 5172.13,-1257.24"/>
</g>
<!-- stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_15 -->
<g id="edge477" class="edge">
<title>stage1_qkv_layer_3_gpu_9&#45;&gt;stage1_attention_layer_3_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3763.66,-1288.24C3764.75,-1279.79 3765.92,-1270.67 3767.05,-1261.84"/>
<polygon fill="blue" stroke="blue" points="3770.56,-1262.04 3768.36,-1251.68 3763.61,-1261.15 3770.56,-1262.04"/>
</g>
<!-- stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_8 -->
<g id="edge414" class="edge">
<title>stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4221.19,-1289.73C4224.15,-1289.3 4227.09,-1288.91 4230,-1288.54 4270.47,-1283.46 4928.23,-1290.15 4964,-1270.54 4968.98,-1267.81 4973.42,-1264.08 4977.34,-1259.85"/>
<polygon fill="blue" stroke="blue" points="4980.28,-1261.77 4983.83,-1251.79 4974.83,-1257.38 4980.28,-1261.77"/>
</g>
<!-- stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_9 -->
<g id="edge423" class="edge">
<title>stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4221.25,-1290.13C4224.19,-1289.58 4227.11,-1289.05 4230,-1288.54 4261.76,-1282.93 4350,-1292.08 4374,-1270.54 4376.91,-1267.93 4379.23,-1264.8 4381.07,-1261.37"/>
<polygon fill="blue" stroke="blue" points="4384.44,-1262.36 4384.91,-1251.77 4377.94,-1259.76 4384.44,-1262.36"/>
</g>
<!-- stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_10 -->
<g id="edge430" class="edge">
<title>stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_10</title>
<path fill="none" stroke="black" d="M4221.21,-1289.85C4224.16,-1289.39 4227.09,-1288.95 4230,-1288.54 4373.24,-1268.3 4413.7,-1301.55 4555,-1270.54 4571.85,-1266.84 4589.31,-1261.36 4605.94,-1255.26"/>
<polygon fill="black" stroke="black" points="4607.5,-1258.42 4615.63,-1251.61 4605.04,-1251.87 4607.5,-1258.42"/>
</g>
<!-- stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_11 -->
<g id="edge442" class="edge">
<title>stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3924.78,-1289.9C3921.84,-1289.42 3918.9,-1288.97 3916,-1288.54 3800.54,-1271.44 3768.9,-1291.05 3654,-1270.54 3631.15,-1266.46 3607.12,-1260.65 3584.17,-1254.32"/>
<polygon fill="blue" stroke="blue" points="3584.98,-1250.91 3574.4,-1251.57 3583.08,-1257.65 3584.98,-1250.91"/>
</g>
<!-- stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_12 -->
<g id="edge451" class="edge">
<title>stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4075.33,-1288.24C4075.87,-1279.79 4076.46,-1270.67 4077.03,-1261.84"/>
<polygon fill="blue" stroke="blue" points="4080.53,-1261.88 4077.68,-1251.68 4073.55,-1261.43 4080.53,-1261.88"/>
</g>
<!-- stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_13 -->
<g id="edge460" class="edge">
<title>stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3924.8,-1289.76C3921.85,-1289.33 3918.91,-1288.92 3916,-1288.54 3681.4,-1257.96 3618.37,-1302.8 3384,-1270.54 3355.49,-1266.62 3325.34,-1260.59 3296.69,-1253.94"/>
<polygon fill="blue" stroke="blue" points="3297.16,-1250.45 3286.62,-1251.56 3295.55,-1257.27 3297.16,-1250.45"/>
</g>
<!-- stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_14 -->
<g id="edge469" class="edge">
<title>stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4221.19,-1289.71C4224.15,-1289.29 4227.09,-1288.9 4230,-1288.54 4420.15,-1265.01 4902.15,-1296.35 5092,-1270.54 5119.78,-1266.76 5149.14,-1260.72 5176.96,-1253.99"/>
<polygon fill="blue" stroke="blue" points="5177.86,-1257.38 5186.73,-1251.59 5176.18,-1250.58 5177.86,-1257.38"/>
</g>
<!-- stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_15 -->
<g id="edge478" class="edge">
<title>stage1_qkv_layer_3_gpu_10&#45;&gt;stage1_attention_layer_3_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3950.73,-1288.47C3933.26,-1282.78 3915.6,-1276.72 3899,-1270.54 3886.79,-1266 3874.06,-1260.89 3861.58,-1255.67"/>
<polygon fill="blue" stroke="blue" points="3862.68,-1252.33 3852.1,-1251.66 3859.95,-1258.78 3862.68,-1252.33"/>
</g>
<!-- stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_8 -->
<g id="edge415" class="edge">
<title>stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3593.19,-1289.68C3596.14,-1289.27 3599.08,-1288.89 3602,-1288.54 3675.42,-1279.73 4863.45,-1295.68 4933,-1270.54 4941.31,-1267.53 4949.36,-1263.05 4956.84,-1257.92"/>
<polygon fill="blue" stroke="blue" points="4959.37,-1260.4 4965.33,-1251.64 4955.21,-1254.77 4959.37,-1260.4"/>
</g>
<!-- stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_9 -->
<g id="edge424" class="edge">
<title>stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3593.19,-1289.74C3596.15,-1289.31 3599.09,-1288.91 3602,-1288.54 3740.93,-1270.8 4094.33,-1296.27 4232,-1270.54 4251.45,-1266.9 4271.73,-1261.21 4290.96,-1254.83"/>
<polygon fill="blue" stroke="blue" points="4292.27,-1258.08 4300.6,-1251.55 4290.01,-1251.46 4292.27,-1258.08"/>
</g>
<!-- stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_10 -->
<g id="edge433" class="edge">
<title>stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3593.19,-1289.7C3596.15,-1289.29 3599.09,-1288.9 3602,-1288.54 3808.48,-1263.16 4333.29,-1307.6 4538,-1270.54 4557.79,-1266.96 4578.43,-1261.22 4597.97,-1254.77"/>
<polygon fill="blue" stroke="blue" points="4599.12,-1258.08 4607.47,-1251.55 4596.87,-1251.45 4599.12,-1258.08"/>
</g>
<!-- stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_11 -->
<g id="edge439" class="edge">
<title>stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_11</title>
<path fill="none" stroke="black" d="M3451.99,-1288.24C3453.64,-1279.69 3455.42,-1270.47 3457.13,-1261.56"/>
<polygon fill="black" stroke="black" points="3460.58,-1262.16 3459.04,-1251.68 3453.71,-1260.83 3460.58,-1262.16"/>
</g>
<!-- stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_12 -->
<g id="edge452" class="edge">
<title>stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3593.2,-1289.8C3596.15,-1289.35 3599.09,-1288.93 3602,-1288.54 3649.17,-1282.19 3986.89,-1290.71 4030,-1270.54 4036.28,-1267.6 4042.13,-1263.47 4047.45,-1258.78"/>
<polygon fill="blue" stroke="blue" points="4050.13,-1261.06 4054.86,-1251.58 4045.25,-1256.04 4050.13,-1261.06"/>
</g>
<!-- stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_13 -->
<g id="edge461" class="edge">
<title>stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3330.2,-1288.45C3313.59,-1282.73 3296.79,-1276.68 3281,-1270.54 3269.18,-1265.94 3256.85,-1260.81 3244.77,-1255.57"/>
<polygon fill="blue" stroke="blue" points="3246.16,-1252.36 3235.6,-1251.55 3243.35,-1258.77 3246.16,-1252.36"/>
</g>
<!-- stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_14 -->
<g id="edge470" class="edge">
<title>stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3593.19,-1289.68C3596.14,-1289.27 3599.08,-1288.89 3602,-1288.54 3925.06,-1249.96 4742.66,-1306.68 5066,-1270.54 5098.11,-1266.95 5132.18,-1260.74 5164.29,-1253.76"/>
<polygon fill="blue" stroke="blue" points="5165.19,-1257.15 5174.19,-1251.57 5163.67,-1250.31 5165.19,-1257.15"/>
</g>
<!-- stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_15 -->
<g id="edge479" class="edge">
<title>stage1_qkv_layer_3_gpu_11&#45;&gt;stage1_attention_layer_3_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3593.25,-1290.12C3596.19,-1289.57 3599.11,-1289.05 3602,-1288.54 3634.2,-1282.88 3721.65,-1289.89 3748,-1270.54 3751.76,-1267.78 3754.97,-1264.31 3757.71,-1260.47"/>
<polygon fill="blue" stroke="blue" points="3760.88,-1261.98 3762.97,-1251.59 3754.86,-1258.41 3760.88,-1261.98"/>
</g>
<!-- stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_8 -->
<g id="edge416" class="edge">
<title>stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3279.19,-1289.72C3282.15,-1289.3 3285.09,-1288.9 3288,-1288.54 3457.1,-1267.37 4634.77,-1273.35 4846.05,-1251.58"/>
<polygon fill="blue" stroke="blue" points="4846.64,-1255.03 4856.18,-1250.42 4845.85,-1248.08 4846.64,-1255.03"/>
</g>
<!-- stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_9 -->
<g id="edge425" class="edge">
<title>stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3279.2,-1289.78C3282.15,-1289.34 3285.09,-1288.93 3288,-1288.54 3493.39,-1261.22 4009.59,-1279.31 4232.12,-1251.67"/>
<polygon fill="blue" stroke="blue" points="4232.71,-1255.12 4242.17,-1250.36 4231.8,-1248.18 4232.71,-1255.12"/>
</g>
<!-- stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_10 -->
<g id="edge434" class="edge">
<title>stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3279.19,-1289.75C3282.15,-1289.32 3285.09,-1288.91 3288,-1288.54 3561.07,-1253.54 4248.44,-1286.93 4539.01,-1251.68"/>
<polygon fill="blue" stroke="blue" points="4539.69,-1255.12 4549.18,-1250.4 4538.82,-1248.18 4539.69,-1255.12"/>
</g>
<!-- stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_11 -->
<g id="edge443" class="edge">
<title>stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3242.08,-1288.4C3275.19,-1277.62 3311.63,-1265.77 3345.32,-1254.8"/>
<polygon fill="blue" stroke="blue" points="3346.79,-1258.01 3355.22,-1251.59 3344.62,-1251.35 3346.79,-1258.01"/>
</g>
<!-- stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_12 -->
<g id="edge448" class="edge">
<title>stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_12</title>
<path fill="none" stroke="black" d="M3279.21,-1289.86C3282.16,-1289.39 3285.09,-1288.95 3288,-1288.54 3566.33,-1248.86 3643.68,-1291.47 3925.07,-1251.74"/>
<polygon fill="black" stroke="black" points="3925.76,-1255.17 3935.16,-1250.29 3924.77,-1248.25 3925.76,-1255.17"/>
</g>
<!-- stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_13 -->
<g id="edge462" class="edge">
<title>stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3140.32,-1288.24C3142.52,-1279.69 3144.89,-1270.47 3147.18,-1261.56"/>
<polygon fill="blue" stroke="blue" points="3150.62,-1262.23 3149.72,-1251.68 3143.84,-1260.49 3150.62,-1262.23"/>
</g>
<!-- stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_14 -->
<g id="edge471" class="edge">
<title>stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3279.19,-1289.71C3282.15,-1289.29 3285.09,-1288.9 3288,-1288.54 3490.91,-1263.53 4906.78,-1277.09 5152.98,-1251.6"/>
<polygon fill="blue" stroke="blue" points="5153.64,-1255.04 5163.18,-1250.43 5152.85,-1248.09 5153.64,-1255.04"/>
</g>
<!-- stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_15 -->
<g id="edge480" class="edge">
<title>stage1_qkv_layer_3_gpu_12&#45;&gt;stage1_attention_layer_3_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3279.24,-1290.07C3282.18,-1289.54 3285.11,-1289.03 3288,-1288.54 3431.09,-1264.24 3471.88,-1276.24 3617.9,-1251.83"/>
<polygon fill="blue" stroke="blue" points="3618.86,-1255.22 3628.13,-1250.09 3617.69,-1248.32 3618.86,-1255.22"/>
</g>
<!-- stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_8 -->
<g id="edge417" class="edge">
<title>stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4849.26,-1290.19C4852.2,-1289.62 4855.11,-1289.07 4858,-1288.54 4886.25,-1283.32 4964.45,-1289.53 4986,-1270.54 4989.05,-1267.86 4991.5,-1264.62 4993.48,-1261.08"/>
<polygon fill="blue" stroke="blue" points="4996.74,-1262.36 4997.46,-1251.78 4990.3,-1259.6 4996.74,-1262.36"/>
</g>
<!-- stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_9 -->
<g id="edge426" class="edge">
<title>stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4552.74,-1289.22C4526.33,-1282.3 4503.09,-1275.62 4490,-1270.54 4479.4,-1266.42 4468.51,-1261.47 4457.95,-1256.25"/>
<polygon fill="blue" stroke="blue" points="4459.28,-1253 4448.78,-1251.6 4456.12,-1259.24 4459.28,-1253"/>
</g>
<!-- stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_10 -->
<g id="edge435" class="edge">
<title>stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4698.67,-1288.24C4698.13,-1279.79 4697.54,-1270.67 4696.97,-1261.84"/>
<polygon fill="blue" stroke="blue" points="4700.45,-1261.43 4696.32,-1251.68 4693.47,-1261.88 4700.45,-1261.43"/>
</g>
<!-- stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_11 -->
<g id="edge444" class="edge">
<title>stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4552.81,-1289.71C4549.85,-1289.29 4546.91,-1288.9 4544,-1288.54 4177.4,-1243.02 4080.12,-1311.68 3713,-1270.54 3680.46,-1266.89 3645.92,-1260.71 3613.32,-1253.77"/>
<polygon fill="blue" stroke="blue" points="3613.78,-1250.29 3603.27,-1251.59 3612.3,-1257.13 3613.78,-1250.29"/>
</g>
<!-- stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_12 -->
<g id="edge453" class="edge">
<title>stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4552.79,-1289.84C4549.84,-1289.38 4546.91,-1288.95 4544,-1288.54 4391.93,-1267.3 4348.05,-1307.41 4199,-1270.54 4184.64,-1266.99 4169.9,-1261.69 4155.9,-1255.77"/>
<polygon fill="blue" stroke="blue" points="4156.9,-1252.39 4146.34,-1251.58 4154.09,-1258.8 4156.9,-1252.39"/>
</g>
<!-- stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_13 -->
<g id="edge457" class="edge">
<title>stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_13</title>
<path fill="none" stroke="black" d="M4552.81,-1289.69C4549.85,-1289.28 4546.91,-1288.89 4544,-1288.54 4296.01,-1258.46 3668.66,-1294.45 3420,-1270.54 3384.5,-1267.13 3346.74,-1260.79 3311.29,-1253.6"/>
<polygon fill="black" stroke="black" points="3311.86,-1250.14 3301.36,-1251.55 3310.45,-1256.99 3311.86,-1250.14"/>
</g>
<!-- stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_14 -->
<g id="edge472" class="edge">
<title>stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4849.21,-1289.86C4852.16,-1289.4 4855.09,-1288.95 4858,-1288.54 4994.19,-1269.1 5032.6,-1299.9 5167,-1270.54 5184.06,-1266.81 5201.76,-1261.31 5218.63,-1255.22"/>
<polygon fill="blue" stroke="blue" points="5220.3,-1258.33 5228.45,-1251.56 5217.86,-1251.77 5220.3,-1258.33"/>
</g>
<!-- stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_15 -->
<g id="edge481" class="edge">
<title>stage1_qkv_layer_3_gpu_13&#45;&gt;stage1_attention_layer_3_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4552.8,-1289.76C4549.85,-1289.33 4546.91,-1288.92 4544,-1288.54 4305.87,-1257.56 4242,-1302.51 4004,-1270.54 3974.63,-1266.59 3943.55,-1260.53 3914.02,-1253.84"/>
<polygon fill="blue" stroke="blue" points="3914.6,-1250.39 3904.07,-1251.56 3913.04,-1257.21 3914.6,-1250.39"/>
</g>
<!-- stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_8 -->
<g id="edge418" class="edge">
<title>stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M5220.24,-1288.4C5187.82,-1277.62 5152.14,-1265.77 5119.15,-1254.8"/>
<polygon fill="blue" stroke="blue" points="5120.06,-1251.42 5109.47,-1251.59 5117.86,-1258.06 5120.06,-1251.42"/>
</g>
<!-- stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_9 -->
<g id="edge427" class="edge">
<title>stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M5180.79,-1289.86C5177.84,-1289.4 5174.91,-1288.95 5172,-1288.54 4897.16,-1249.25 4820.8,-1290.88 4541.56,-1251.52"/>
<polygon fill="blue" stroke="blue" points="4541.94,-1248.04 4531.54,-1250.09 4540.95,-1254.97 4541.94,-1248.04"/>
</g>
<!-- stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_10 -->
<g id="edge436" class="edge">
<title>stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M5180.76,-1290.08C5177.82,-1289.55 5174.89,-1289.03 5172,-1288.54 5032.35,-1264.63 4992.58,-1275.77 4848.67,-1251.58"/>
<polygon fill="blue" stroke="blue" points="4849.03,-1248.09 4838.58,-1249.85 4847.85,-1254.99 4849.03,-1248.09"/>
</g>
<!-- stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_11 -->
<g id="edge445" class="edge">
<title>stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M5180.81,-1289.72C5177.85,-1289.3 5174.91,-1288.9 5172,-1288.54 5003.77,-1267.47 3832.15,-1273.14 3620.67,-1251.39"/>
<polygon fill="blue" stroke="blue" points="3620.86,-1247.89 3610.52,-1250.24 3620.06,-1254.85 3620.86,-1247.89"/>
</g>
<!-- stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_12 -->
<g id="edge454" class="edge">
<title>stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M5180.8,-1289.79C5177.85,-1289.34 5174.91,-1288.93 5172,-1288.54 4968.35,-1261.41 4456.53,-1278.97 4234.56,-1251.47"/>
<polygon fill="blue" stroke="blue" points="4234.9,-1247.98 4224.53,-1250.17 4234,-1254.93 4234.9,-1247.98"/>
</g>
<!-- stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_13 -->
<g id="edge463" class="edge">
<title>stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M5180.81,-1289.71C5177.85,-1289.29 5174.91,-1288.9 5172,-1288.54 4969.96,-1263.63 3560.17,-1276.85 3313.73,-1251.41"/>
<polygon fill="blue" stroke="blue" points="3313.85,-1247.9 3303.52,-1250.25 3313.06,-1254.86 3313.85,-1247.9"/>
</g>
<!-- stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_14 -->
<g id="edge466" class="edge">
<title>stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_14</title>
<path fill="none" stroke="black" d="M5322.01,-1288.24C5320.36,-1279.69 5318.58,-1270.47 5316.87,-1261.56"/>
<polygon fill="black" stroke="black" points="5320.29,-1260.83 5314.96,-1251.68 5313.42,-1262.16 5320.29,-1260.83"/>
</g>
<!-- stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_15 -->
<g id="edge482" class="edge">
<title>stage1_qkv_layer_3_gpu_14&#45;&gt;stage1_attention_layer_3_gpu_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M5180.81,-1289.75C5177.85,-1289.32 5174.91,-1288.91 5172,-1288.54 5037.55,-1271.29 4103.69,-1269.5 3927.58,-1251.37"/>
<polygon fill="blue" stroke="blue" points="3927.86,-1247.88 3917.53,-1250.21 3927.06,-1254.83 3927.86,-1247.88"/>
</g>
<!-- stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_8 -->
<g id="edge419" class="edge">
<title>stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4535.2,-1289.79C4538.15,-1289.35 4541.09,-1288.93 4544,-1288.54 4591.61,-1282.14 4936.16,-1297.38 4976,-1270.54 4980.03,-1267.82 4983.42,-1264.29 4986.27,-1260.33"/>
<polygon fill="blue" stroke="blue" points="4989.29,-1262.09 4991.39,-1251.7 4983.27,-1258.51 4989.29,-1262.09"/>
</g>
<!-- stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_9 -->
<g id="edge428" class="edge">
<title>stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4387,-1288.24C4387,-1279.79 4387,-1270.67 4387,-1261.84"/>
<polygon fill="blue" stroke="blue" points="4390.5,-1261.68 4387,-1251.68 4383.5,-1261.68 4390.5,-1261.68"/>
</g>
<!-- stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_10 -->
<g id="edge437" class="edge">
<title>stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4512.05,-1288.48C4529.93,-1282.78 4548,-1276.72 4565,-1270.54 4577.61,-1265.95 4590.77,-1260.79 4603.66,-1255.52"/>
<polygon fill="blue" stroke="blue" points="4605.08,-1258.72 4612.99,-1251.66 4602.41,-1252.25 4605.08,-1258.72"/>
</g>
<!-- stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_11 -->
<g id="edge446" class="edge">
<title>stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4238.8,-1289.76C4235.85,-1289.33 4232.91,-1288.92 4230,-1288.54 3992.31,-1257.61 3928.46,-1303.17 3691,-1270.54 3662.49,-1266.62 3632.34,-1260.6 3603.69,-1253.95"/>
<polygon fill="blue" stroke="blue" points="3604.16,-1250.46 3593.62,-1251.57 3602.55,-1257.28 3604.16,-1250.46"/>
</g>
<!-- stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_12 -->
<g id="edge455" class="edge">
<title>stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4238.89,-1289.58C4212.38,-1282.62 4189.05,-1275.83 4176,-1270.54 4166.05,-1266.5 4155.87,-1261.61 4146.04,-1256.42"/>
<polygon fill="blue" stroke="blue" points="4147.57,-1253.27 4137.11,-1251.59 4144.24,-1259.43 4147.57,-1253.27"/>
</g>
<!-- stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_13 -->
<g id="edge464" class="edge">
<title>stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4238.81,-1289.71C4235.85,-1289.29 4232.91,-1288.9 4230,-1288.54 3866.49,-1243.37 3770.03,-1311.37 3406,-1270.54 3373.46,-1266.89 3338.93,-1260.7 3306.32,-1253.76"/>
<polygon fill="blue" stroke="blue" points="3306.78,-1250.28 3296.27,-1251.59 3305.3,-1257.13 3306.78,-1250.28"/>
</g>
<!-- stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_14 -->
<g id="edge473" class="edge">
<title>stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M4535.19,-1289.74C4538.15,-1289.31 4541.09,-1288.91 4544,-1288.54 4679.84,-1271.15 5025.58,-1296.74 5160,-1270.54 5178.56,-1266.92 5197.86,-1261.26 5216.16,-1254.92"/>
<polygon fill="blue" stroke="blue" points="5217.38,-1258.2 5225.63,-1251.55 5215.03,-1251.61 5217.38,-1258.2"/>
</g>
<!-- stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_15 -->
<g id="edge475" class="edge">
<title>stage1_qkv_layer_3_gpu_15&#45;&gt;stage1_attention_layer_3_gpu_15</title>
<path fill="none" stroke="black" d="M4238.78,-1289.9C4235.84,-1289.42 4232.9,-1288.97 4230,-1288.54 4114.1,-1271.39 4082.43,-1290.63 3967,-1270.54 3943.36,-1266.42 3918.46,-1260.57 3894.69,-1254.2"/>
<polygon fill="black" stroke="black" points="3895.5,-1250.79 3884.93,-1251.54 3893.66,-1257.55 3895.5,-1250.79"/>
</g>
<!-- stage1_attention_reduce_layer_3 -->
<g id="node140" class="node">
<title>stage1_attention_reduce_layer_3</title>
<polygon fill="#ffcccc" stroke="black" points="4690.54,-1140.54 4207.68,-1140.54 4083.46,-1036.54 4566.32,-1036.54 4690.54,-1140.54"/>
<text text-anchor="middle" x="4387" y="-1102.54" font-family="Arial" font-size="10.00">Attention All&#45;Reduce</text>
<text text-anchor="middle" x="4387" y="-1091.54" font-family="Arial" font-size="10.00">Input: [8Ã— batch_size=1024, seq_len=2048, heads=4, d_k=128]</text>
<text text-anchor="middle" x="4387" y="-1080.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4387" y="-1069.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (all&#45;reduce)</text>
</g>
<!-- stage1_attention_layer_3_gpu_8&#45;&gt;stage1_attention_reduce_layer_3 -->
<g id="edge483" class="edge">
<title>stage1_attention_layer_3_gpu_8&#45;&gt;stage1_attention_reduce_layer_3</title>
<path fill="none" stroke="black" d="M4856.48,-1179.36C4853.63,-1178.74 4850.8,-1178.14 4848,-1177.54 4792.06,-1165.63 4732.15,-1153.63 4674.63,-1142.49"/>
<polygon fill="black" stroke="black" points="4675.16,-1139.03 4664.68,-1140.57 4673.83,-1145.9 4675.16,-1139.03"/>
</g>
<!-- stage1_attention_layer_3_gpu_9&#45;&gt;stage1_attention_reduce_layer_3 -->
<g id="edge484" class="edge">
<title>stage1_attention_layer_3_gpu_9&#45;&gt;stage1_attention_reduce_layer_3</title>
<path fill="none" stroke="black" d="M4387,-1177.34C4387,-1169.03 4387,-1159.97 4387,-1150.92"/>
<polygon fill="black" stroke="black" points="4390.5,-1150.76 4387,-1140.76 4383.5,-1150.76 4390.5,-1150.76"/>
</g>
<!-- stage1_attention_layer_3_gpu_10&#45;&gt;stage1_attention_reduce_layer_3 -->
<g id="edge485" class="edge">
<title>stage1_attention_layer_3_gpu_10&#45;&gt;stage1_attention_reduce_layer_3</title>
<path fill="none" stroke="black" d="M4604.79,-1177.51C4579.18,-1167.16 4550.66,-1155.64 4522.92,-1144.44"/>
<polygon fill="black" stroke="black" points="4524.12,-1141.15 4513.54,-1140.65 4521.5,-1147.64 4524.12,-1141.15"/>
</g>
<!-- stage1_attention_layer_3_gpu_11&#45;&gt;stage1_attention_reduce_layer_3 -->
<g id="edge486" class="edge">
<title>stage1_attention_layer_3_gpu_11&#45;&gt;stage1_attention_reduce_layer_3</title>
<path fill="none" stroke="black" d="M3610.58,-1179.23C3613.75,-1178.64 3616.89,-1178.08 3620,-1177.54 3799.78,-1146.32 4005.25,-1123.42 4158.25,-1108.82"/>
<polygon fill="black" stroke="black" points="4158.63,-1112.3 4168.25,-1107.87 4157.97,-1105.33 4158.63,-1112.3"/>
</g>
<!-- stage1_attention_layer_3_gpu_12&#45;&gt;stage1_attention_reduce_layer_3 -->
<g id="edge487" class="edge">
<title>stage1_attention_layer_3_gpu_12&#45;&gt;stage1_attention_reduce_layer_3</title>
<path fill="none" stroke="black" d="M4169.21,-1177.51C4194.82,-1167.16 4223.34,-1155.64 4251.08,-1144.44"/>
<polygon fill="black" stroke="black" points="4252.5,-1147.64 4260.46,-1140.65 4249.88,-1141.15 4252.5,-1147.64"/>
</g>
<!-- stage1_attention_layer_3_gpu_13&#45;&gt;stage1_attention_reduce_layer_3 -->
<g id="edge488" class="edge">
<title>stage1_attention_layer_3_gpu_13&#45;&gt;stage1_attention_reduce_layer_3</title>
<path fill="none" stroke="black" d="M3303.56,-1179.09C3306.73,-1178.55 3309.88,-1178.03 3313,-1177.54 3597.87,-1132.82 3929.03,-1110.05 4147.48,-1099.01"/>
<polygon fill="black" stroke="black" points="4147.66,-1102.51 4157.47,-1098.51 4147.31,-1095.52 4147.66,-1102.51"/>
</g>
<!-- stage1_attention_layer_3_gpu_14&#45;&gt;stage1_attention_reduce_layer_3 -->
<g id="edge489" class="edge">
<title>stage1_attention_layer_3_gpu_14&#45;&gt;stage1_attention_reduce_layer_3</title>
<path fill="none" stroke="black" d="M5163.13,-1179C5160.4,-1178.49 5157.69,-1178.01 5155,-1177.54 4994.42,-1149.55 4813.33,-1128.31 4667.35,-1113.71"/>
<polygon fill="black" stroke="black" points="4667.64,-1110.22 4657.34,-1112.72 4666.94,-1117.19 4667.64,-1110.22"/>
</g>
<!-- stage1_attention_layer_3_gpu_15&#45;&gt;stage1_attention_reduce_layer_3 -->
<g id="edge490" class="edge">
<title>stage1_attention_layer_3_gpu_15&#45;&gt;stage1_attention_reduce_layer_3</title>
<path fill="none" stroke="black" d="M3917.64,-1179.55C3920.79,-1178.87 3923.91,-1178.2 3927,-1177.54 4009.37,-1160.04 4100.39,-1142.3 4179.57,-1127.37"/>
<polygon fill="black" stroke="black" points="4180.48,-1130.76 4189.66,-1125.47 4179.19,-1123.88 4180.48,-1130.76"/>
</g>
<!-- stage1_out_proj_layer_3 -->
<g id="node141" class="node">
<title>stage1_out_proj_layer_3</title>
<polygon fill="#0080ff" stroke="black" points="5003,-999.54 4719,-999.54 4719,-947.54 5003,-947.54 5003,-999.54"/>
<text text-anchor="middle" x="4861" y="-987.54" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="4861" y="-976.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4861" y="-965.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4861" y="-954.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (sharded)</text>
</g>
<!-- stage1_attention_reduce_layer_3&#45;&gt;stage1_out_proj_layer_3 -->
<g id="edge491" class="edge">
<title>stage1_attention_reduce_layer_3&#45;&gt;stage1_out_proj_layer_3</title>
<path fill="none" stroke="black" d="M4574,-1042.96C4632.13,-1029.1 4694.47,-1014.24 4746.15,-1001.92"/>
<polygon fill="black" stroke="black" points="4747.09,-1005.29 4756.01,-999.57 4745.47,-998.48 4747.09,-1005.29"/>
</g>
<!-- stage1_out_proj_layer_3&#45;&gt;stage1_residual1_layer_3 -->
<g id="edge492" class="edge">
<title>stage1_out_proj_layer_3&#45;&gt;stage1_residual1_layer_3</title>
<path fill="none" stroke="black" d="M4966.12,-947.53C5017.25,-935.37 5080.39,-920.35 5139.95,-906.18"/>
<polygon fill="black" stroke="black" points="5140.94,-909.54 5149.86,-903.82 5139.32,-902.73 5140.94,-909.54"/>
</g>
<!-- stage1_ln2_layer_3 -->
<g id="node143" class="node">
<title>stage1_ln2_layer_3</title>
<polygon fill="#0080ff" stroke="black" points="4269,-769.54 3985,-769.54 3985,-717.54 4269,-717.54 4269,-769.54"/>
<text text-anchor="middle" x="4127" y="-757.54" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4127" y="-746.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4127" y="-735.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="4127" y="-724.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (sharded)</text>
</g>
<!-- stage1_residual1_layer_3&#45;&gt;stage1_ln2_layer_3 -->
<g id="edge494" class="edge">
<title>stage1_residual1_layer_3&#45;&gt;stage1_ln2_layer_3</title>
<path fill="none" stroke="black" d="M5065.43,-832.25C4823.06,-809.6 4476.33,-777.19 4279.28,-758.77"/>
<polygon fill="black" stroke="black" points="4279.42,-755.27 4269.13,-757.82 4278.77,-762.24 4279.42,-755.27"/>
</g>
<!-- stage1_residual2_layer_3 -->
<g id="node162" class="node">
<title>stage1_residual2_layer_3</title>
<polygon fill="#ffffcc" stroke="black" points="5743.82,-309.54 5265.28,-309.54 5142.18,-205.54 5620.72,-205.54 5743.82,-309.54"/>
<text text-anchor="middle" x="5443" y="-271.54" font-family="Arial" font-size="10.00">Residual Add 2</text>
<text text-anchor="middle" x="5443" y="-260.54" font-family="Arial" font-size="10.00">Input: [2Ã— batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5443" y="-249.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5443" y="-238.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (all&#45;reduce)</text>
</g>
<!-- stage1_residual1_layer_3&#45;&gt;stage1_residual2_layer_3 -->
<g id="edge545" class="edge">
<title>stage1_residual1_layer_3&#45;&gt;stage1_residual2_layer_3</title>
<path fill="none" stroke="black" d="M5566.85,-851.29C5838.2,-840.78 6252,-813.46 6252,-744.54 6252,-744.54 6252,-744.54 6252,-397.54 6252,-342.07 5952.74,-302.65 5718.24,-280.28"/>
<polygon fill="black" stroke="black" points="5718.46,-276.79 5708.18,-279.33 5717.8,-283.76 5718.46,-276.79"/>
</g>
<!-- stage1_gate_layer_3 -->
<g id="node144" class="node">
<title>stage1_gate_layer_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4188.38,-680.54 3720.09,-680.54 3599.62,-576.54 4067.91,-576.54 4188.38,-680.54"/>
<text text-anchor="middle" x="3894" y="-642.54" font-family="Arial" font-size="10.00">Gating Network</text>
<text text-anchor="middle" x="3894" y="-631.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3894" y="-620.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, num_experts=16]</text>
<text text-anchor="middle" x="3894" y="-609.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (sharded)</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_gate_layer_3 -->
<g id="edge495" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_gate_layer_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4075.29,-717.46C4055.52,-707.87 4032.11,-696.52 4008.79,-685.21"/>
<polygon fill="black" stroke="black" points="4010.04,-681.93 3999.51,-680.71 4006.98,-688.22 4010.04,-681.93"/>
</g>
<!-- stage1_expert_layer_3_expert_0_gpu_8 -->
<g id="node145" class="node">
<title>stage1_expert_layer_3_expert_0_gpu_8</title>
<polygon fill="#0080ff" stroke="black" points="4063,-539.54 3771,-539.54 3771,-487.54 4063,-487.54 4063,-539.54"/>
<text text-anchor="middle" x="3917" y="-527.54" font-family="Arial" font-size="10.00">Expert0</text>
<text text-anchor="middle" x="3917" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3917" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3917" y="-494.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_0_gpu_8 -->
<g id="edge497" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_0_gpu_8</title>
<path fill="none" stroke="black" d="M4166.62,-717.42C4178.68,-707.53 4190.47,-695.05 4197,-680.54 4215.97,-638.39 4225.94,-612.58 4197,-576.54 4188.2,-565.57 4132.65,-552.21 4073.32,-540.71"/>
<polygon fill="black" stroke="black" points="4073.86,-537.25 4063.38,-538.8 4072.54,-544.12 4073.86,-537.25"/>
</g>
<!-- stage1_expert_layer_3_expert_1_gpu_8 -->
<g id="node146" class="node">
<title>stage1_expert_layer_3_expert_1_gpu_8</title>
<polygon fill="#0080ff" stroke="black" points="3443,-539.54 3151,-539.54 3151,-487.54 3443,-487.54 3443,-539.54"/>
<text text-anchor="middle" x="3297" y="-527.54" font-family="Arial" font-size="10.00">Expert1</text>
<text text-anchor="middle" x="3297" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3297" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3297" y="-494.54" font-family="Arial" font-size="10.00">GPU: 8</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_1_gpu_8 -->
<g id="edge499" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_1_gpu_8</title>
<path fill="none" stroke="black" d="M3984.87,-737.8C3885.36,-732.64 3749.69,-721.88 3632,-699.54 3602.85,-694 3595.1,-692.61 3568,-680.54 3482.54,-642.47 3391.4,-582.01 3339.6,-545.51"/>
<polygon fill="black" stroke="black" points="3341.5,-542.57 3331.32,-539.65 3337.46,-548.29 3341.5,-542.57"/>
</g>
<!-- stage1_expert_layer_3_expert_2_gpu_9 -->
<g id="node147" class="node">
<title>stage1_expert_layer_3_expert_2_gpu_9</title>
<polygon fill="#1e80ff" stroke="black" points="2513,-539.54 2221,-539.54 2221,-487.54 2513,-487.54 2513,-539.54"/>
<text text-anchor="middle" x="2367" y="-527.54" font-family="Arial" font-size="10.00">Expert2</text>
<text text-anchor="middle" x="2367" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2367" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2367" y="-494.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_2_gpu_9 -->
<g id="edge501" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_2_gpu_9</title>
<path fill="none" stroke="black" d="M3984.8,-741.47C3691.52,-738.36 3028.44,-726.32 2807,-680.54 2665.73,-651.34 2509.86,-583.37 2426.85,-544.06"/>
<polygon fill="black" stroke="black" points="2428.11,-540.78 2417.58,-539.64 2425.1,-547.1 2428.11,-540.78"/>
</g>
<!-- stage1_expert_layer_3_expert_3_gpu_9 -->
<g id="node148" class="node">
<title>stage1_expert_layer_3_expert_3_gpu_9</title>
<polygon fill="#1e80ff" stroke="black" points="5303,-539.54 5011,-539.54 5011,-487.54 5303,-487.54 5303,-539.54"/>
<text text-anchor="middle" x="5157" y="-527.54" font-family="Arial" font-size="10.00">Expert3</text>
<text text-anchor="middle" x="5157" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5157" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5157" y="-494.54" font-family="Arial" font-size="10.00">GPU: 9</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_3_gpu_9 -->
<g id="edge503" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_3_gpu_9</title>
<path fill="none" stroke="black" d="M4269.36,-722.73C4341.97,-711.82 4431.51,-697.13 4511,-680.54 4707.59,-639.5 4934.29,-577.88 5060.09,-542.4"/>
<polygon fill="black" stroke="black" points="5061.41,-545.66 5070.08,-539.58 5059.51,-538.93 5061.41,-545.66"/>
</g>
<!-- stage1_expert_layer_3_expert_4_gpu_10 -->
<g id="node149" class="node">
<title>stage1_expert_layer_3_expert_4_gpu_10</title>
<polygon fill="#3c80ff" stroke="black" points="3133,-539.54 2841,-539.54 2841,-487.54 3133,-487.54 3133,-539.54"/>
<text text-anchor="middle" x="2987" y="-527.54" font-family="Arial" font-size="10.00">Expert4</text>
<text text-anchor="middle" x="2987" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2987" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2987" y="-494.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_4_gpu_10 -->
<g id="edge505" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_4_gpu_10</title>
<path fill="none" stroke="black" d="M3984.95,-736C3801.7,-726.66 3493.4,-707.56 3383,-680.54 3256.1,-649.48 3117.36,-583.15 3042.46,-544.39"/>
<polygon fill="black" stroke="black" points="3043.7,-541.09 3033.21,-539.58 3040.46,-547.3 3043.7,-541.09"/>
</g>
<!-- stage1_expert_layer_3_expert_5_gpu_10 -->
<g id="node150" class="node">
<title>stage1_expert_layer_3_expert_5_gpu_10</title>
<polygon fill="#3c80ff" stroke="black" points="5923,-539.54 5631,-539.54 5631,-487.54 5923,-487.54 5923,-539.54"/>
<text text-anchor="middle" x="5777" y="-527.54" font-family="Arial" font-size="10.00">Expert5</text>
<text text-anchor="middle" x="5777" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5777" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5777" y="-494.54" font-family="Arial" font-size="10.00">GPU: 10</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_5_gpu_10 -->
<g id="edge507" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_5_gpu_10</title>
<path fill="none" stroke="black" d="M4269.12,-743.08C4424.12,-740.9 4678.6,-729.14 4892,-680.54 5040.56,-646.71 5062.84,-588.62 5212,-557.54 5387.34,-521.01 5438.7,-556.75 5620.45,-539.61"/>
<polygon fill="black" stroke="black" points="5621.01,-543.08 5630.62,-538.61 5620.32,-536.11 5621.01,-543.08"/>
</g>
<!-- stage1_expert_layer_3_expert_6_gpu_11 -->
<g id="node151" class="node">
<title>stage1_expert_layer_3_expert_6_gpu_11</title>
<polygon fill="#5a80ff" stroke="black" points="2823,-539.54 2531,-539.54 2531,-487.54 2823,-487.54 2823,-539.54"/>
<text text-anchor="middle" x="2677" y="-527.54" font-family="Arial" font-size="10.00">Expert6</text>
<text text-anchor="middle" x="2677" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2677" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2677" y="-494.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_6_gpu_11 -->
<g id="edge509" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_6_gpu_11</title>
<path fill="none" stroke="black" d="M3984.63,-739.3C3744.53,-732.93 3269.3,-716.19 3106,-680.54 2968.33,-650.49 2816.63,-583 2735.65,-543.96"/>
<polygon fill="black" stroke="black" points="2737.13,-540.79 2726.6,-539.58 2734.08,-547.09 2737.13,-540.79"/>
</g>
<!-- stage1_expert_layer_3_expert_7_gpu_11 -->
<g id="node152" class="node">
<title>stage1_expert_layer_3_expert_7_gpu_11</title>
<polygon fill="#5a80ff" stroke="black" points="1893,-539.54 1601,-539.54 1601,-487.54 1893,-487.54 1893,-539.54"/>
<text text-anchor="middle" x="1747" y="-527.54" font-family="Arial" font-size="10.00">Expert7</text>
<text text-anchor="middle" x="1747" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1747" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1747" y="-494.54" font-family="Arial" font-size="10.00">GPU: 11</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_7_gpu_11 -->
<g id="edge511" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_7_gpu_11</title>
<path fill="none" stroke="black" d="M3984.9,-740.81C3566.68,-735.33 2358.46,-716.56 2184,-680.54 2043.56,-651.55 1888.81,-583.5 1806.4,-544.12"/>
<polygon fill="black" stroke="black" points="1807.73,-540.87 1797.2,-539.69 1804.7,-547.18 1807.73,-540.87"/>
</g>
<!-- stage1_expert_layer_3_expert_8_gpu_12 -->
<g id="node153" class="node">
<title>stage1_expert_layer_3_expert_8_gpu_12</title>
<polygon fill="#7880ff" stroke="black" points="5613,-539.54 5321,-539.54 5321,-487.54 5613,-487.54 5613,-539.54"/>
<text text-anchor="middle" x="5467" y="-527.54" font-family="Arial" font-size="10.00">Expert8</text>
<text text-anchor="middle" x="5467" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5467" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="5467" y="-494.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_8_gpu_12 -->
<g id="edge513" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_8_gpu_12</title>
<path fill="none" stroke="black" d="M4269.1,-735.66C4391.43,-727.89 4572.16,-711.97 4727,-680.54 4909.69,-643.45 4945.21,-594.13 5128,-557.54 5205.42,-542.04 5228.71,-549.45 5310.34,-539.68"/>
<polygon fill="black" stroke="black" points="5311.1,-543.11 5320.59,-538.4 5310.24,-536.17 5311.1,-543.11"/>
</g>
<!-- stage1_expert_layer_3_expert_9_gpu_12 -->
<g id="node154" class="node">
<title>stage1_expert_layer_3_expert_9_gpu_12</title>
<polygon fill="#7880ff" stroke="black" points="4683,-539.54 4391,-539.54 4391,-487.54 4683,-487.54 4683,-539.54"/>
<text text-anchor="middle" x="4537" y="-527.54" font-family="Arial" font-size="10.00">Expert9</text>
<text text-anchor="middle" x="4537" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4537" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4537" y="-494.54" font-family="Arial" font-size="10.00">GPU: 12</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_9_gpu_12 -->
<g id="edge515" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_9_gpu_12</title>
<path fill="none" stroke="black" d="M4181.12,-717.53C4193.03,-711.79 4205.51,-705.59 4217,-699.54 4314.27,-648.29 4424.66,-582.78 4487.05,-545.05"/>
<polygon fill="black" stroke="black" points="4489.16,-547.86 4495.9,-539.69 4485.54,-541.88 4489.16,-547.86"/>
</g>
<!-- stage1_expert_layer_3_expert_10_gpu_13 -->
<g id="node155" class="node">
<title>stage1_expert_layer_3_expert_10_gpu_13</title>
<polygon fill="#9680ff" stroke="black" points="4993,-539.54 4701,-539.54 4701,-487.54 4993,-487.54 4993,-539.54"/>
<text text-anchor="middle" x="4847" y="-527.54" font-family="Arial" font-size="10.00">Expert10</text>
<text text-anchor="middle" x="4847" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4847" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4847" y="-494.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_10_gpu_13 -->
<g id="edge517" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_10_gpu_13</title>
<path fill="none" stroke="black" d="M4220.03,-717.5C4259.6,-706.57 4306.18,-693.35 4348,-680.54 4496.05,-635.17 4666.95,-577.06 4765.44,-543"/>
<polygon fill="black" stroke="black" points="4766.73,-546.26 4775.04,-539.68 4764.44,-539.64 4766.73,-546.26"/>
</g>
<!-- stage1_expert_layer_3_expert_11_gpu_13 -->
<g id="node156" class="node">
<title>stage1_expert_layer_3_expert_11_gpu_13</title>
<polygon fill="#9680ff" stroke="black" points="2203,-539.54 1911,-539.54 1911,-487.54 2203,-487.54 2203,-539.54"/>
<text text-anchor="middle" x="2057" y="-527.54" font-family="Arial" font-size="10.00">Expert11</text>
<text text-anchor="middle" x="2057" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2057" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="2057" y="-494.54" font-family="Arial" font-size="10.00">GPU: 13</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_11_gpu_13 -->
<g id="edge519" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_11_gpu_13</title>
<path fill="none" stroke="black" d="M3984.89,-743.13C3642.16,-743.59 2777.57,-738.73 2495,-680.54 2354.08,-651.52 2198.73,-583.32 2116.21,-543.96"/>
<polygon fill="black" stroke="black" points="2117.53,-540.71 2107,-539.54 2114.5,-547.02 2117.53,-540.71"/>
</g>
<!-- stage1_expert_layer_3_expert_12_gpu_14 -->
<g id="node157" class="node">
<title>stage1_expert_layer_3_expert_12_gpu_14</title>
<polygon fill="#b480ff" stroke="black" points="4373,-539.54 4081,-539.54 4081,-487.54 4373,-487.54 4373,-539.54"/>
<text text-anchor="middle" x="4227" y="-527.54" font-family="Arial" font-size="10.00">Expert12</text>
<text text-anchor="middle" x="4227" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4227" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="4227" y="-494.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_12_gpu_14 -->
<g id="edge521" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_12_gpu_14</title>
<path fill="none" stroke="black" d="M4194.17,-717.45C4201.09,-712.46 4207.3,-706.54 4212,-699.54 4242.03,-654.86 4239.25,-589.7 4233.7,-549.83"/>
<polygon fill="black" stroke="black" points="4237.13,-549.13 4232.16,-539.77 4230.21,-550.19 4237.13,-549.13"/>
</g>
<!-- stage1_expert_layer_3_expert_13_gpu_14 -->
<g id="node158" class="node">
<title>stage1_expert_layer_3_expert_13_gpu_14</title>
<polygon fill="#b480ff" stroke="black" points="3753,-539.54 3461,-539.54 3461,-487.54 3753,-487.54 3753,-539.54"/>
<text text-anchor="middle" x="3607" y="-527.54" font-family="Arial" font-size="10.00">Expert13</text>
<text text-anchor="middle" x="3607" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3607" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3607" y="-494.54" font-family="Arial" font-size="10.00">GPU: 14</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_13_gpu_14 -->
<g id="edge523" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_13_gpu_14</title>
<path fill="none" stroke="black" d="M3984.77,-735.72C3834.88,-727.04 3616.88,-709.59 3591,-680.54 3559.26,-644.92 3575.01,-586.38 3590.26,-549.18"/>
<polygon fill="black" stroke="black" points="3593.58,-550.33 3594.31,-539.76 3587.15,-547.57 3593.58,-550.33"/>
</g>
<!-- stage1_expert_layer_3_expert_14_gpu_15 -->
<g id="node159" class="node">
<title>stage1_expert_layer_3_expert_14_gpu_15</title>
<polygon fill="#d280ff" stroke="black" points="1583,-539.54 1291,-539.54 1291,-487.54 1583,-487.54 1583,-539.54"/>
<text text-anchor="middle" x="1437" y="-527.54" font-family="Arial" font-size="10.00">Expert14</text>
<text text-anchor="middle" x="1437" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1437" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="1437" y="-494.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_14_gpu_15 -->
<g id="edge525" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_14_gpu_15</title>
<path fill="none" stroke="black" d="M3984.79,-741.47C3522.41,-737.61 2079.63,-722.31 1874,-680.54 1733.28,-651.95 1578.33,-583.59 1496.04,-544.08"/>
<polygon fill="black" stroke="black" points="1497.38,-540.84 1486.85,-539.65 1494.34,-547.15 1497.38,-540.84"/>
</g>
<!-- stage1_expert_layer_3_expert_15_gpu_15 -->
<g id="node160" class="node">
<title>stage1_expert_layer_3_expert_15_gpu_15</title>
<polygon fill="#d280ff" stroke="black" points="6233,-539.54 5941,-539.54 5941,-487.54 6233,-487.54 6233,-539.54"/>
<text text-anchor="middle" x="6087" y="-527.54" font-family="Arial" font-size="10.00">Expert15</text>
<text text-anchor="middle" x="6087" y="-516.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="6087" y="-505.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="6087" y="-494.54" font-family="Arial" font-size="10.00">GPU: 15</text>
</g>
<!-- stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_15_gpu_15 -->
<g id="edge527" class="edge">
<title>stage1_ln2_layer_3&#45;&gt;stage1_expert_layer_3_expert_15_gpu_15</title>
<path fill="none" stroke="black" d="M4269.15,-734.59C4406.58,-726.65 4620.65,-713.63 4806,-699.54 5306.69,-661.46 5431.08,-618.96 5930.97,-539.7"/>
<polygon fill="black" stroke="black" points="5931.64,-543.14 5940.97,-538.12 5930.55,-536.23 5931.64,-543.14"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_0_gpu_8 -->
<g id="edge496" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_0_gpu_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3904.42,-576.33C3906.27,-567.28 3908.14,-558.05 3909.87,-549.57"/>
<polygon fill="red" stroke="red" points="3913.32,-550.17 3911.88,-539.67 3906.46,-548.77 3913.32,-550.17"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_1_gpu_8 -->
<g id="edge498" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_1_gpu_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3624.32,-576.49C3560.48,-564.41 3494.87,-551.99 3439.31,-541.47"/>
<polygon fill="red" stroke="red" points="3439.88,-538.02 3429.41,-539.6 3438.58,-544.9 3439.88,-538.02"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_2_gpu_9 -->
<g id="edge500" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_2_gpu_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3648.64,-618.9C3375.94,-607.66 2922.45,-584.11 2523.4,-539.65"/>
<polygon fill="red" stroke="red" points="2523.72,-536.17 2513.39,-538.53 2522.94,-543.13 2523.72,-536.17"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_3_gpu_9 -->
<g id="edge502" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_3_gpu_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4106.86,-609.99C4282.35,-595.62 4537.8,-574.88 4761,-557.54 4864.84,-549.47 4893.61,-551.94 5000.37,-539.68"/>
<polygon fill="red" stroke="red" points="5001.07,-543.13 5010.6,-538.49 5000.27,-536.17 5001.07,-543.13"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_4_gpu_10 -->
<g id="edge504" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_4_gpu_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3625.21,-598.95C3484.43,-583.27 3308.98,-562.61 3142.92,-539.65"/>
<polygon fill="red" stroke="red" points="3143.39,-536.18 3133.01,-538.27 3142.43,-543.11 3143.39,-536.18"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_5_gpu_10 -->
<g id="edge506" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_5_gpu_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4110.52,-613.2C4349.49,-597.76 4745.55,-573.3 5087,-557.54 5321.41,-546.72 5383.51,-562.1 5620.66,-539.61"/>
<polygon fill="red" stroke="red" points="5621,-543.09 5630.62,-538.65 5620.33,-536.13 5621,-543.09"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_6_gpu_11 -->
<g id="edge508" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_6_gpu_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3640.78,-612.08C3427.79,-597.77 3115.13,-573.72 2833.41,-539.68"/>
<polygon fill="red" stroke="red" points="2833.75,-536.19 2823.4,-538.46 2832.91,-543.14 2833.75,-536.19"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_7_gpu_11 -->
<g id="edge510" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_7_gpu_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3656.48,-625.92C3284.4,-621.4 2541.52,-604.38 1903.71,-539.66"/>
<polygon fill="red" stroke="red" points="1903.69,-536.14 1893.38,-538.61 1902.98,-543.11 1903.69,-536.14"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_8_gpu_12 -->
<g id="edge512" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_8_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4110.04,-612.72C4327.46,-597.99 4672.42,-575.12 4971,-557.54 5119.25,-548.81 5159.38,-555.35 5310.5,-539.65"/>
<polygon fill="red" stroke="red" points="5311.03,-543.11 5320.61,-538.58 5310.3,-536.15 5311.03,-543.11"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_9_gpu_12 -->
<g id="edge514" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_9_gpu_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4087.79,-593.48C4182.96,-576.76 4295.95,-556.9 4384.8,-541.29"/>
<polygon fill="red" stroke="red" points="4385.44,-544.73 4394.69,-539.55 4384.23,-537.83 4385.44,-544.73"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_10_gpu_13 -->
<g id="edge516" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_10_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4098.95,-603.2C4217.77,-589.31 4370.27,-571.87 4506,-557.54 4585.45,-549.15 4607.94,-550.07 4690.5,-539.69"/>
<polygon fill="red" stroke="red" points="4691.12,-543.14 4700.59,-538.41 4690.23,-536.2 4691.12,-543.14"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_11_gpu_13 -->
<g id="edge518" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_11_gpu_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3653.47,-623.09C3328.58,-615.23 2731.51,-594.3 2213.68,-539.67"/>
<polygon fill="red" stroke="red" points="2213.7,-536.15 2203.39,-538.58 2212.96,-543.12 2213.7,-536.15"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_12_gpu_14 -->
<g id="edge520" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_12_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4044.43,-576.49C4078.49,-564.94 4113.45,-553.07 4143.55,-542.86"/>
<polygon fill="red" stroke="red" points="4144.8,-546.13 4153.14,-539.6 4142.55,-539.5 4144.8,-546.13"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_13_gpu_14 -->
<g id="edge522" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_13_gpu_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3764.35,-576.49C3735.51,-565.14 3705.91,-553.48 3680.27,-543.39"/>
<polygon fill="red" stroke="red" points="3681.24,-540.01 3670.65,-539.6 3678.68,-546.52 3681.24,-540.01"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_14_gpu_15 -->
<g id="edge524" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_14_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3658.89,-627.98C3243.47,-626.66 2352.56,-614.45 1593.43,-539.63"/>
<polygon fill="red" stroke="red" points="1593.68,-536.14 1583.38,-538.64 1592.99,-543.1 1593.68,-536.14"/>
</g>
<!-- stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_15_gpu_15 -->
<g id="edge526" class="edge">
<title>stage1_gate_layer_3&#45;&gt;stage1_expert_layer_3_expert_15_gpu_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M4111.68,-614.1C4372.93,-598.41 4824.33,-572.68 5212,-557.54 5528.58,-545.18 5611.57,-568.6 5930.63,-539.61"/>
<polygon fill="red" stroke="red" points="5930.99,-543.09 5940.62,-538.69 5930.35,-536.12 5930.99,-543.09"/>
</g>
<!-- stage1_expert_agg_layer_3 -->
<g id="node161" class="node">
<title>stage1_expert_agg_layer_3</title>
<polygon fill="#ffcccc" stroke="black" points="4226.98,-450.54 3733.87,-450.54 3607.02,-346.54 4100.13,-346.54 4226.98,-450.54"/>
<text text-anchor="middle" x="3917" y="-412.54" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3917" y="-401.54" font-family="Arial" font-size="10.00">Input: [8Ã— batch_size=1024, seq_len=2048, hidden_size=4096/8]</text>
<text text-anchor="middle" x="3917" y="-390.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="3917" y="-379.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15 (all&#45;reduce)</text>
</g>
<!-- stage1_expert_layer_3_expert_0_gpu_8&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge528" class="edge">
<title>stage1_expert_layer_3_expert_0_gpu_8&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M3917,-487.46C3917,-479.53 3917,-470.4 3917,-461.08"/>
<polygon fill="black" stroke="black" points="3920.5,-460.94 3917,-450.94 3913.5,-460.94 3920.5,-460.94"/>
</g>
<!-- stage1_expert_layer_3_expert_1_gpu_8&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge529" class="edge">
<title>stage1_expert_layer_3_expert_1_gpu_8&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M3434.21,-487.53C3513.97,-472.99 3616.16,-454.37 3705.96,-438"/>
<polygon fill="black" stroke="black" points="3706.79,-441.41 3716,-436.17 3705.54,-434.52 3706.79,-441.41"/>
</g>
<!-- stage1_expert_layer_3_expert_2_gpu_9&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge530" class="edge">
<title>stage1_expert_layer_3_expert_2_gpu_9&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M2513.39,-488.54C2516.28,-488.19 2519.16,-487.86 2522,-487.54 2923.1,-442.65 3391.84,-418.94 3671.03,-407.84"/>
<polygon fill="black" stroke="black" points="3671.44,-411.33 3681.29,-407.44 3671.16,-404.34 3671.44,-411.33"/>
</g>
<!-- stage1_expert_layer_3_expert_3_gpu_9&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge531" class="edge">
<title>stage1_expert_layer_3_expert_3_gpu_9&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M5010.6,-488.61C5007.71,-488.24 5004.84,-487.88 5002,-487.54 4728.07,-454.39 4413.67,-430.43 4194.07,-415.96"/>
<polygon fill="black" stroke="black" points="4194.22,-412.46 4184.01,-415.3 4193.76,-419.45 4194.22,-412.46"/>
</g>
<!-- stage1_expert_layer_3_expert_4_gpu_10&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge532" class="edge">
<title>stage1_expert_layer_3_expert_4_gpu_10&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M3133,-488.79C3136.03,-488.37 3139.03,-487.95 3142,-487.54 3325.29,-462.37 3533.68,-439 3688.17,-422.68"/>
<polygon fill="black" stroke="black" points="3688.69,-426.14 3698.27,-421.61 3687.96,-419.18 3688.69,-426.14"/>
</g>
<!-- stage1_expert_layer_3_expert_5_gpu_10&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge533" class="edge">
<title>stage1_expert_layer_3_expert_5_gpu_10&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M5630.61,-488.5C5627.72,-488.16 5624.85,-487.84 5622,-487.54 5113.67,-433.59 4516.43,-412.39 4180.79,-404.3"/>
<polygon fill="black" stroke="black" points="4180.52,-400.79 4170.44,-404.05 4180.35,-407.79 4180.52,-400.79"/>
</g>
<!-- stage1_expert_layer_3_expert_6_gpu_11&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge534" class="edge">
<title>stage1_expert_layer_3_expert_6_gpu_11&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M2823.4,-488.61C2826.29,-488.24 2829.16,-487.88 2832,-487.54 3122.1,-452.43 3457.58,-427.63 3677.8,-413.49"/>
<polygon fill="black" stroke="black" points="3678.11,-416.98 3687.87,-412.85 3677.66,-410 3678.11,-416.98"/>
</g>
<!-- stage1_expert_layer_3_expert_7_gpu_11&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge535" class="edge">
<title>stage1_expert_layer_3_expert_7_gpu_11&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M1893.38,-488.46C1896.28,-488.14 1899.15,-487.83 1902,-487.54 2533.23,-423.07 3280.42,-405.78 3663.15,-401.18"/>
<polygon fill="black" stroke="black" points="3663.28,-404.67 3673.24,-401.06 3663.2,-397.68 3663.28,-404.67"/>
</g>
<!-- stage1_expert_layer_3_expert_8_gpu_12&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge536" class="edge">
<title>stage1_expert_layer_3_expert_8_gpu_12&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M5320.61,-488.54C5317.72,-488.19 5314.84,-487.86 5312,-487.54 4921.77,-443.86 4467.51,-420.24 4186.08,-408.77"/>
<polygon fill="black" stroke="black" points="4185.86,-405.26 4175.72,-408.35 4185.57,-412.26 4185.86,-405.26"/>
</g>
<!-- stage1_expert_layer_3_expert_9_gpu_12&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge537" class="edge">
<title>stage1_expert_layer_3_expert_9_gpu_12&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M4399.79,-487.53C4342.76,-477.14 4274.27,-464.65 4207.03,-452.4"/>
<polygon fill="black" stroke="black" points="4207.59,-448.94 4197.12,-450.59 4206.33,-455.83 4207.59,-448.94"/>
</g>
<!-- stage1_expert_layer_3_expert_10_gpu_13&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge538" class="edge">
<title>stage1_expert_layer_3_expert_10_gpu_13&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M4701,-488.79C4697.97,-488.37 4694.97,-487.95 4692,-487.54 4533.16,-465.72 4355.46,-445.26 4210.33,-429.57"/>
<polygon fill="black" stroke="black" points="4210.69,-426.09 4200.38,-428.5 4209.94,-433.05 4210.69,-426.09"/>
</g>
<!-- stage1_expert_layer_3_expert_11_gpu_13&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge539" class="edge">
<title>stage1_expert_layer_3_expert_11_gpu_13&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M2203.39,-488.5C2206.28,-488.16 2209.15,-487.84 2212,-487.54 2727.07,-432.87 3333.43,-411.83 3666.44,-403.99"/>
<polygon fill="black" stroke="black" points="3666.79,-407.48 3676.7,-403.75 3666.62,-400.48 3666.79,-407.48"/>
</g>
<!-- stage1_expert_layer_3_expert_12_gpu_14&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge540" class="edge">
<title>stage1_expert_layer_3_expert_12_gpu_14&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M4158.2,-487.46C4131.01,-477.55 4098.62,-465.74 4066.55,-454.05"/>
<polygon fill="black" stroke="black" points="4067.66,-450.73 4057.07,-450.6 4065.26,-457.31 4067.66,-450.73"/>
</g>
<!-- stage1_expert_layer_3_expert_13_gpu_14&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge541" class="edge">
<title>stage1_expert_layer_3_expert_13_gpu_14&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M3675.8,-487.46C3702.99,-477.55 3735.38,-465.74 3767.45,-454.05"/>
<polygon fill="black" stroke="black" points="3768.74,-457.31 3776.93,-450.6 3766.34,-450.73 3768.74,-457.31"/>
</g>
<!-- stage1_expert_layer_3_expert_14_gpu_15&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge542" class="edge">
<title>stage1_expert_layer_3_expert_14_gpu_15&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M1583.38,-488.44C1586.28,-488.12 1589.15,-487.82 1592,-487.54 2341.04,-413.24 3231.52,-400.48 3660.65,-399.04"/>
<polygon fill="black" stroke="black" points="3660.71,-402.54 3670.7,-399 3660.69,-395.54 3660.71,-402.54"/>
</g>
<!-- stage1_expert_layer_3_expert_15_gpu_15&#45;&gt;stage1_expert_agg_layer_3 -->
<g id="edge543" class="edge">
<title>stage1_expert_layer_3_expert_15_gpu_15&#45;&gt;stage1_expert_agg_layer_3</title>
<path fill="none" stroke="black" d="M5940.62,-488.46C5937.72,-488.14 5934.85,-487.83 5932,-487.54 5304.23,-423.42 4561.75,-405.97 4177.17,-401.25"/>
<polygon fill="black" stroke="black" points="4177.06,-397.75 4167.02,-401.13 4176.98,-404.75 4177.06,-397.75"/>
</g>
<!-- stage1_expert_agg_layer_3&#45;&gt;stage1_residual2_layer_3 -->
<g id="edge544" class="edge">
<title>stage1_expert_agg_layer_3&#45;&gt;stage1_residual2_layer_3</title>
<path fill="none" stroke="black" d="M4138.08,-377.4C4426.24,-351.15 4927.55,-305.49 5217.75,-279.06"/>
<polygon fill="black" stroke="black" points="5218.34,-282.52 5227.98,-278.12 5217.71,-275.55 5218.34,-282.52"/>
</g>
<!-- final_layernorm -->
<g id="node163" class="node">
<title>final_layernorm</title>
<polygon fill="#0080ff" stroke="black" points="5585,-162.54 5301,-162.54 5301,-110.54 5585,-110.54 5585,-162.54"/>
<text text-anchor="middle" x="5443" y="-150.54" font-family="Arial" font-size="10.00">Final LayerNorm</text>
<text text-anchor="middle" x="5443" y="-139.54" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5443" y="-128.54" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5443" y="-117.54" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
</g>
<!-- stage1_residual2_layer_3&#45;&gt;final_layernorm -->
<g id="edge546" class="edge">
<title>stage1_residual2_layer_3&#45;&gt;final_layernorm</title>
<path fill="none" stroke="black" d="M5443,-205.38C5443,-194.44 5443,-183.12 5443,-172.93"/>
<polygon fill="black" stroke="black" points="5446.5,-172.79 5443,-162.79 5439.5,-172.79 5446.5,-172.79"/>
</g>
<!-- output -->
<g id="node164" class="node">
<title>output</title>
<ellipse fill="#e6f3ff" stroke="black" cx="5443" cy="-36.77" rx="202.88" ry="36.54"/>
<text text-anchor="middle" x="5443" y="-50.77" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="5443" y="-39.77" font-family="Arial" font-size="10.00">Input: [batch_size=1024, seq_len=2048, hidden_size=4096]</text>
<text text-anchor="middle" x="5443" y="-28.77" font-family="Arial" font-size="10.00">Output: [batch_size=1024, seq_len=2048, vocab_size=50265]</text>
<text text-anchor="middle" x="5443" y="-17.77" font-family="Arial" font-size="10.00">GPU: 8&#45;15</text>
</g>
<!-- final_layernorm&#45;&gt;output -->
<g id="edge547" class="edge">
<title>final_layernorm&#45;&gt;output</title>
<path fill="none" stroke="black" d="M5443,-110.36C5443,-102.22 5443,-92.93 5443,-83.76"/>
<polygon fill="black" stroke="black" points="5446.5,-83.55 5443,-73.55 5439.5,-83.55 5446.5,-83.55"/>
</g>
</g>
</svg>
