digraph EP64_TP2_PP1_Deployment {
    rankdir=TB;
    bgcolor=white;
    fontname="Arial";
    fontsize=12;
    
    // Graph attributes
    node [fontname="Arial", fontsize=10, shape=box, style=filled, fillcolor=lightblue];
    edge [fontname="Arial", fontsize=9, arrowhead=normal, color=black];
    
    // Input node (ellipse for data)
    Input [shape=ellipse, fillcolor=lightgreen, label="Input\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]"];
    
    // Embedding layer - TP2 split across GPU 0-1
    subgraph cluster_embedding {
        label="Embedding Layer (TP2)";
        style=rounded;
        fillcolor=lightyellow;
        
        // Embedding computation nodes
        Embed_GPU0 [label="Embed_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Embed_GPU1 [label="Embed_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Embedding aggregation
        Embed_Agg [label="Embed_Aggregate\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
    }
    
    // Layer normalization after embedding
    LayerNorm_Embed [label="LayerNorm_Embed\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
    
    // Now generate all 16 layers with 64 experts each
    // Each layer has: MHA + Expert + FFN + Residual connections
    
    // Layer 0 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_0 {
        label="Layer 0 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_0 [label="MHA_Q_GPU0_L0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_0 [label="MHA_K_GPU0_L0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_0 [label="MHA_V_GPU0_L0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_0 [label="MHA_Q_GPU1_L0\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_0 [label="MHA_K_GPU1_L0\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_0 [label="MHA_V_GPU1_L0\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_0 [label="Attention_Comp_GPU0_L0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_0 [label="Attention_Comp_GPU1_L0\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_0 [label="Attention_Agg_L0\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_0 [label="Gate_Compute_L0\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_0 [label="Gate_Softmax_L0\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 0 - EP64_TP2
        Expert_0_0_GPU0 [label="Expert_L0_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_0_GPU1 [label="Expert_L0_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 0 - EP64_TP2
        Expert_0_1_GPU0 [label="Expert_L0_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_1_GPU1 [label="Expert_L0_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 0 - EP64_TP2
        Expert_0_2_GPU0 [label="Expert_L0_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_2_GPU1 [label="Expert_L0_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 0 - EP64_TP2
        Expert_0_3_GPU0 [label="Expert_L0_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_3_GPU1 [label="Expert_L0_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 0 - EP64_TP2
        Expert_0_4_GPU0 [label="Expert_L0_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_4_GPU1 [label="Expert_L0_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 0 - EP64_TP2
        Expert_0_5_GPU0 [label="Expert_L0_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_5_GPU1 [label="Expert_L0_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 0 - EP64_TP2
        Expert_0_6_GPU0 [label="Expert_L0_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_6_GPU1 [label="Expert_L0_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 0 - EP64_TP2
        Expert_0_7_GPU0 [label="Expert_L0_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_7_GPU1 [label="Expert_L0_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 0 - EP64_TP2
        Expert_0_8_GPU0 [label="Expert_L0_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_8_GPU1 [label="Expert_L0_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 0 - EP64_TP2
        Expert_0_9_GPU0 [label="Expert_L0_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_9_GPU1 [label="Expert_L0_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 0 - EP64_TP2
        Expert_0_10_GPU0 [label="Expert_L0_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_10_GPU1 [label="Expert_L0_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 0 - EP64_TP2
        Expert_0_11_GPU0 [label="Expert_L0_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_11_GPU1 [label="Expert_L0_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 0 - EP64_TP2
        Expert_0_12_GPU0 [label="Expert_L0_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_12_GPU1 [label="Expert_L0_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 0 - EP64_TP2
        Expert_0_13_GPU0 [label="Expert_L0_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_13_GPU1 [label="Expert_L0_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 0 - EP64_TP2
        Expert_0_14_GPU0 [label="Expert_L0_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_14_GPU1 [label="Expert_L0_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 0 - EP64_TP2
        Expert_0_15_GPU0 [label="Expert_L0_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_15_GPU1 [label="Expert_L0_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 0 - EP64_TP2
        Expert_0_16_GPU0 [label="Expert_L0_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_16_GPU1 [label="Expert_L0_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 0 - EP64_TP2
        Expert_0_17_GPU0 [label="Expert_L0_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_17_GPU1 [label="Expert_L0_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 0 - EP64_TP2
        Expert_0_18_GPU0 [label="Expert_L0_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_18_GPU1 [label="Expert_L0_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 0 - EP64_TP2
        Expert_0_19_GPU0 [label="Expert_L0_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_19_GPU1 [label="Expert_L0_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 0 - EP64_TP2
        Expert_0_20_GPU0 [label="Expert_L0_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_20_GPU1 [label="Expert_L0_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 0 - EP64_TP2
        Expert_0_21_GPU0 [label="Expert_L0_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_21_GPU1 [label="Expert_L0_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 0 - EP64_TP2
        Expert_0_22_GPU0 [label="Expert_L0_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_22_GPU1 [label="Expert_L0_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 0 - EP64_TP2
        Expert_0_23_GPU0 [label="Expert_L0_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_23_GPU1 [label="Expert_L0_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 0 - EP64_TP2
        Expert_0_24_GPU0 [label="Expert_L0_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_24_GPU1 [label="Expert_L0_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 0 - EP64_TP2
        Expert_0_25_GPU0 [label="Expert_L0_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_25_GPU1 [label="Expert_L0_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 0 - EP64_TP2
        Expert_0_26_GPU0 [label="Expert_L0_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_26_GPU1 [label="Expert_L0_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 0 - EP64_TP2
        Expert_0_27_GPU0 [label="Expert_L0_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_27_GPU1 [label="Expert_L0_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 0 - EP64_TP2
        Expert_0_28_GPU0 [label="Expert_L0_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_28_GPU1 [label="Expert_L0_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 0 - EP64_TP2
        Expert_0_29_GPU0 [label="Expert_L0_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_29_GPU1 [label="Expert_L0_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 0 - EP64_TP2
        Expert_0_30_GPU0 [label="Expert_L0_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_30_GPU1 [label="Expert_L0_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 0 - EP64_TP2
        Expert_0_31_GPU0 [label="Expert_L0_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_31_GPU1 [label="Expert_L0_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 0 - EP64_TP2
        Expert_0_32_GPU0 [label="Expert_L0_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_32_GPU1 [label="Expert_L0_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 0 - EP64_TP2
        Expert_0_33_GPU0 [label="Expert_L0_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_33_GPU1 [label="Expert_L0_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 0 - EP64_TP2
        Expert_0_34_GPU0 [label="Expert_L0_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_34_GPU1 [label="Expert_L0_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 0 - EP64_TP2
        Expert_0_35_GPU0 [label="Expert_L0_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_35_GPU1 [label="Expert_L0_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 0 - EP64_TP2
        Expert_0_36_GPU0 [label="Expert_L0_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_36_GPU1 [label="Expert_L0_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 0 - EP64_TP2
        Expert_0_37_GPU0 [label="Expert_L0_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_37_GPU1 [label="Expert_L0_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 0 - EP64_TP2
        Expert_0_38_GPU0 [label="Expert_L0_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_38_GPU1 [label="Expert_L0_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 0 - EP64_TP2
        Expert_0_39_GPU0 [label="Expert_L0_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_39_GPU1 [label="Expert_L0_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 0 - EP64_TP2
        Expert_0_40_GPU0 [label="Expert_L0_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_40_GPU1 [label="Expert_L0_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 0 - EP64_TP2
        Expert_0_41_GPU0 [label="Expert_L0_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_41_GPU1 [label="Expert_L0_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 0 - EP64_TP2
        Expert_0_42_GPU0 [label="Expert_L0_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_42_GPU1 [label="Expert_L0_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 0 - EP64_TP2
        Expert_0_43_GPU0 [label="Expert_L0_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_43_GPU1 [label="Expert_L0_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 0 - EP64_TP2
        Expert_0_44_GPU0 [label="Expert_L0_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_44_GPU1 [label="Expert_L0_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 0 - EP64_TP2
        Expert_0_45_GPU0 [label="Expert_L0_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_45_GPU1 [label="Expert_L0_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 0 - EP64_TP2
        Expert_0_46_GPU0 [label="Expert_L0_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_46_GPU1 [label="Expert_L0_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 0 - EP64_TP2
        Expert_0_47_GPU0 [label="Expert_L0_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_47_GPU1 [label="Expert_L0_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 0 - EP64_TP2
        Expert_0_48_GPU0 [label="Expert_L0_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_48_GPU1 [label="Expert_L0_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 0 - EP64_TP2
        Expert_0_49_GPU0 [label="Expert_L0_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_49_GPU1 [label="Expert_L0_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 0 - EP64_TP2
        Expert_0_50_GPU0 [label="Expert_L0_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_50_GPU1 [label="Expert_L0_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 0 - EP64_TP2
        Expert_0_51_GPU0 [label="Expert_L0_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_51_GPU1 [label="Expert_L0_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 0 - EP64_TP2
        Expert_0_52_GPU0 [label="Expert_L0_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_52_GPU1 [label="Expert_L0_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 0 - EP64_TP2
        Expert_0_53_GPU0 [label="Expert_L0_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_53_GPU1 [label="Expert_L0_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 0 - EP64_TP2
        Expert_0_54_GPU0 [label="Expert_L0_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_54_GPU1 [label="Expert_L0_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 0 - EP64_TP2
        Expert_0_55_GPU0 [label="Expert_L0_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_55_GPU1 [label="Expert_L0_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 0 - EP64_TP2
        Expert_0_56_GPU0 [label="Expert_L0_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_56_GPU1 [label="Expert_L0_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 0 - EP64_TP2
        Expert_0_57_GPU0 [label="Expert_L0_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_57_GPU1 [label="Expert_L0_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 0 - EP64_TP2
        Expert_0_58_GPU0 [label="Expert_L0_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_58_GPU1 [label="Expert_L0_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 0 - EP64_TP2
        Expert_0_59_GPU0 [label="Expert_L0_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_59_GPU1 [label="Expert_L0_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 0 - EP64_TP2
        Expert_0_60_GPU0 [label="Expert_L0_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_60_GPU1 [label="Expert_L0_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 0 - EP64_TP2
        Expert_0_61_GPU0 [label="Expert_L0_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_61_GPU1 [label="Expert_L0_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 0 - EP64_TP2
        Expert_0_62_GPU0 [label="Expert_L0_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_62_GPU1 [label="Expert_L0_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 0 - EP64_TP2
        Expert_0_63_GPU0 [label="Expert_L0_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_0_63_GPU1 [label="Expert_L0_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_0 [label="Expert_Route_Comm_L0\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_0 [label="Expert_Aggregate_L0\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_0 [label="FFN_GPU0_L0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_0 [label="FFN_GPU1_L0\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_0 [label="FFN_Aggregate_L0\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_0 [label="LayerNorm_L0\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 1 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_1 {
        label="Layer 1 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_1 [label="MHA_Q_GPU0_L1\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_1 [label="MHA_K_GPU0_L1\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_1 [label="MHA_V_GPU0_L1\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_1 [label="MHA_Q_GPU1_L1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_1 [label="MHA_K_GPU1_L1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_1 [label="MHA_V_GPU1_L1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_1 [label="Attention_Comp_GPU0_L1\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_1 [label="Attention_Comp_GPU1_L1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_1 [label="Attention_Agg_L1\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_1 [label="Gate_Compute_L1\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_1 [label="Gate_Softmax_L1\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 1 - EP64_TP2
        Expert_1_0_GPU0 [label="Expert_L1_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_0_GPU1 [label="Expert_L1_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 1 - EP64_TP2
        Expert_1_1_GPU0 [label="Expert_L1_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_1_GPU1 [label="Expert_L1_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 1 - EP64_TP2
        Expert_1_2_GPU0 [label="Expert_L1_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_2_GPU1 [label="Expert_L1_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 1 - EP64_TP2
        Expert_1_3_GPU0 [label="Expert_L1_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_3_GPU1 [label="Expert_L1_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 1 - EP64_TP2
        Expert_1_4_GPU0 [label="Expert_L1_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_4_GPU1 [label="Expert_L1_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 1 - EP64_TP2
        Expert_1_5_GPU0 [label="Expert_L1_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_5_GPU1 [label="Expert_L1_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 1 - EP64_TP2
        Expert_1_6_GPU0 [label="Expert_L1_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_6_GPU1 [label="Expert_L1_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 1 - EP64_TP2
        Expert_1_7_GPU0 [label="Expert_L1_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_7_GPU1 [label="Expert_L1_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 1 - EP64_TP2
        Expert_1_8_GPU0 [label="Expert_L1_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_8_GPU1 [label="Expert_L1_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 1 - EP64_TP2
        Expert_1_9_GPU0 [label="Expert_L1_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_9_GPU1 [label="Expert_L1_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 1 - EP64_TP2
        Expert_1_10_GPU0 [label="Expert_L1_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_10_GPU1 [label="Expert_L1_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 1 - EP64_TP2
        Expert_1_11_GPU0 [label="Expert_L1_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_11_GPU1 [label="Expert_L1_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 1 - EP64_TP2
        Expert_1_12_GPU0 [label="Expert_L1_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_12_GPU1 [label="Expert_L1_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 1 - EP64_TP2
        Expert_1_13_GPU0 [label="Expert_L1_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_13_GPU1 [label="Expert_L1_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 1 - EP64_TP2
        Expert_1_14_GPU0 [label="Expert_L1_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_14_GPU1 [label="Expert_L1_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 1 - EP64_TP2
        Expert_1_15_GPU0 [label="Expert_L1_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_15_GPU1 [label="Expert_L1_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 1 - EP64_TP2
        Expert_1_16_GPU0 [label="Expert_L1_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_16_GPU1 [label="Expert_L1_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 1 - EP64_TP2
        Expert_1_17_GPU0 [label="Expert_L1_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_17_GPU1 [label="Expert_L1_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 1 - EP64_TP2
        Expert_1_18_GPU0 [label="Expert_L1_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_18_GPU1 [label="Expert_L1_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 1 - EP64_TP2
        Expert_1_19_GPU0 [label="Expert_L1_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_19_GPU1 [label="Expert_L1_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 1 - EP64_TP2
        Expert_1_20_GPU0 [label="Expert_L1_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_20_GPU1 [label="Expert_L1_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 1 - EP64_TP2
        Expert_1_21_GPU0 [label="Expert_L1_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_21_GPU1 [label="Expert_L1_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 1 - EP64_TP2
        Expert_1_22_GPU0 [label="Expert_L1_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_22_GPU1 [label="Expert_L1_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 1 - EP64_TP2
        Expert_1_23_GPU0 [label="Expert_L1_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_23_GPU1 [label="Expert_L1_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 1 - EP64_TP2
        Expert_1_24_GPU0 [label="Expert_L1_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_24_GPU1 [label="Expert_L1_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 1 - EP64_TP2
        Expert_1_25_GPU0 [label="Expert_L1_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_25_GPU1 [label="Expert_L1_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 1 - EP64_TP2
        Expert_1_26_GPU0 [label="Expert_L1_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_26_GPU1 [label="Expert_L1_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 1 - EP64_TP2
        Expert_1_27_GPU0 [label="Expert_L1_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_27_GPU1 [label="Expert_L1_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 1 - EP64_TP2
        Expert_1_28_GPU0 [label="Expert_L1_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_28_GPU1 [label="Expert_L1_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 1 - EP64_TP2
        Expert_1_29_GPU0 [label="Expert_L1_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_29_GPU1 [label="Expert_L1_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 1 - EP64_TP2
        Expert_1_30_GPU0 [label="Expert_L1_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_30_GPU1 [label="Expert_L1_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 1 - EP64_TP2
        Expert_1_31_GPU0 [label="Expert_L1_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_31_GPU1 [label="Expert_L1_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 1 - EP64_TP2
        Expert_1_32_GPU0 [label="Expert_L1_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_32_GPU1 [label="Expert_L1_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 1 - EP64_TP2
        Expert_1_33_GPU0 [label="Expert_L1_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_33_GPU1 [label="Expert_L1_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 1 - EP64_TP2
        Expert_1_34_GPU0 [label="Expert_L1_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_34_GPU1 [label="Expert_L1_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 1 - EP64_TP2
        Expert_1_35_GPU0 [label="Expert_L1_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_35_GPU1 [label="Expert_L1_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 1 - EP64_TP2
        Expert_1_36_GPU0 [label="Expert_L1_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_36_GPU1 [label="Expert_L1_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 1 - EP64_TP2
        Expert_1_37_GPU0 [label="Expert_L1_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_37_GPU1 [label="Expert_L1_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 1 - EP64_TP2
        Expert_1_38_GPU0 [label="Expert_L1_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_38_GPU1 [label="Expert_L1_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 1 - EP64_TP2
        Expert_1_39_GPU0 [label="Expert_L1_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_39_GPU1 [label="Expert_L1_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 1 - EP64_TP2
        Expert_1_40_GPU0 [label="Expert_L1_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_40_GPU1 [label="Expert_L1_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 1 - EP64_TP2
        Expert_1_41_GPU0 [label="Expert_L1_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_41_GPU1 [label="Expert_L1_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 1 - EP64_TP2
        Expert_1_42_GPU0 [label="Expert_L1_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_42_GPU1 [label="Expert_L1_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 1 - EP64_TP2
        Expert_1_43_GPU0 [label="Expert_L1_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_43_GPU1 [label="Expert_L1_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 1 - EP64_TP2
        Expert_1_44_GPU0 [label="Expert_L1_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_44_GPU1 [label="Expert_L1_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 1 - EP64_TP2
        Expert_1_45_GPU0 [label="Expert_L1_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_45_GPU1 [label="Expert_L1_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 1 - EP64_TP2
        Expert_1_46_GPU0 [label="Expert_L1_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_46_GPU1 [label="Expert_L1_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 1 - EP64_TP2
        Expert_1_47_GPU0 [label="Expert_L1_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_47_GPU1 [label="Expert_L1_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 1 - EP64_TP2
        Expert_1_48_GPU0 [label="Expert_L1_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_48_GPU1 [label="Expert_L1_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 1 - EP64_TP2
        Expert_1_49_GPU0 [label="Expert_L1_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_49_GPU1 [label="Expert_L1_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 1 - EP64_TP2
        Expert_1_50_GPU0 [label="Expert_L1_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_50_GPU1 [label="Expert_L1_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 1 - EP64_TP2
        Expert_1_51_GPU0 [label="Expert_L1_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_51_GPU1 [label="Expert_L1_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 1 - EP64_TP2
        Expert_1_52_GPU0 [label="Expert_L1_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_52_GPU1 [label="Expert_L1_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 1 - EP64_TP2
        Expert_1_53_GPU0 [label="Expert_L1_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_53_GPU1 [label="Expert_L1_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 1 - EP64_TP2
        Expert_1_54_GPU0 [label="Expert_L1_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_54_GPU1 [label="Expert_L1_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 1 - EP64_TP2
        Expert_1_55_GPU0 [label="Expert_L1_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_55_GPU1 [label="Expert_L1_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 1 - EP64_TP2
        Expert_1_56_GPU0 [label="Expert_L1_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_56_GPU1 [label="Expert_L1_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 1 - EP64_TP2
        Expert_1_57_GPU0 [label="Expert_L1_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_57_GPU1 [label="Expert_L1_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 1 - EP64_TP2
        Expert_1_58_GPU0 [label="Expert_L1_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_58_GPU1 [label="Expert_L1_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 1 - EP64_TP2
        Expert_1_59_GPU0 [label="Expert_L1_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_59_GPU1 [label="Expert_L1_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 1 - EP64_TP2
        Expert_1_60_GPU0 [label="Expert_L1_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_60_GPU1 [label="Expert_L1_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 1 - EP64_TP2
        Expert_1_61_GPU0 [label="Expert_L1_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_61_GPU1 [label="Expert_L1_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 1 - EP64_TP2
        Expert_1_62_GPU0 [label="Expert_L1_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_62_GPU1 [label="Expert_L1_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 1 - EP64_TP2
        Expert_1_63_GPU0 [label="Expert_L1_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_1_63_GPU1 [label="Expert_L1_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_1 [label="Expert_Route_Comm_L1\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_1 [label="Expert_Aggregate_L1\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_1 [label="FFN_GPU0_L1\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_1 [label="FFN_GPU1_L1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_1 [label="FFN_Aggregate_L1\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_1 [label="LayerNorm_L1\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 2 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_2 {
        label="Layer 2 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_2 [label="MHA_Q_GPU0_L2\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_2 [label="MHA_K_GPU0_L2\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_2 [label="MHA_V_GPU0_L2\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_2 [label="MHA_Q_GPU1_L2\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_2 [label="MHA_K_GPU1_L2\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_2 [label="MHA_V_GPU1_L2\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_2 [label="Attention_Comp_GPU0_L2\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_2 [label="Attention_Comp_GPU1_L2\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_2 [label="Attention_Agg_L2\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_2 [label="Gate_Compute_L2\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_2 [label="Gate_Softmax_L2\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 2 - EP64_TP2
        Expert_2_0_GPU0 [label="Expert_L2_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_0_GPU1 [label="Expert_L2_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 2 - EP64_TP2
        Expert_2_1_GPU0 [label="Expert_L2_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_1_GPU1 [label="Expert_L2_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 2 - EP64_TP2
        Expert_2_2_GPU0 [label="Expert_L2_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_2_GPU1 [label="Expert_L2_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 2 - EP64_TP2
        Expert_2_3_GPU0 [label="Expert_L2_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_3_GPU1 [label="Expert_L2_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 2 - EP64_TP2
        Expert_2_4_GPU0 [label="Expert_L2_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_4_GPU1 [label="Expert_L2_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 2 - EP64_TP2
        Expert_2_5_GPU0 [label="Expert_L2_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_5_GPU1 [label="Expert_L2_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 2 - EP64_TP2
        Expert_2_6_GPU0 [label="Expert_L2_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_6_GPU1 [label="Expert_L2_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 2 - EP64_TP2
        Expert_2_7_GPU0 [label="Expert_L2_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_7_GPU1 [label="Expert_L2_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 2 - EP64_TP2
        Expert_2_8_GPU0 [label="Expert_L2_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_8_GPU1 [label="Expert_L2_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 2 - EP64_TP2
        Expert_2_9_GPU0 [label="Expert_L2_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_9_GPU1 [label="Expert_L2_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 2 - EP64_TP2
        Expert_2_10_GPU0 [label="Expert_L2_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_10_GPU1 [label="Expert_L2_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 2 - EP64_TP2
        Expert_2_11_GPU0 [label="Expert_L2_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_11_GPU1 [label="Expert_L2_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 2 - EP64_TP2
        Expert_2_12_GPU0 [label="Expert_L2_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_12_GPU1 [label="Expert_L2_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 2 - EP64_TP2
        Expert_2_13_GPU0 [label="Expert_L2_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_13_GPU1 [label="Expert_L2_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 2 - EP64_TP2
        Expert_2_14_GPU0 [label="Expert_L2_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_14_GPU1 [label="Expert_L2_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 2 - EP64_TP2
        Expert_2_15_GPU0 [label="Expert_L2_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_15_GPU1 [label="Expert_L2_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 2 - EP64_TP2
        Expert_2_16_GPU0 [label="Expert_L2_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_16_GPU1 [label="Expert_L2_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 2 - EP64_TP2
        Expert_2_17_GPU0 [label="Expert_L2_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_17_GPU1 [label="Expert_L2_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 2 - EP64_TP2
        Expert_2_18_GPU0 [label="Expert_L2_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_18_GPU1 [label="Expert_L2_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 2 - EP64_TP2
        Expert_2_19_GPU0 [label="Expert_L2_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_19_GPU1 [label="Expert_L2_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 2 - EP64_TP2
        Expert_2_20_GPU0 [label="Expert_L2_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_20_GPU1 [label="Expert_L2_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 2 - EP64_TP2
        Expert_2_21_GPU0 [label="Expert_L2_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_21_GPU1 [label="Expert_L2_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 2 - EP64_TP2
        Expert_2_22_GPU0 [label="Expert_L2_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_22_GPU1 [label="Expert_L2_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 2 - EP64_TP2
        Expert_2_23_GPU0 [label="Expert_L2_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_23_GPU1 [label="Expert_L2_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 2 - EP64_TP2
        Expert_2_24_GPU0 [label="Expert_L2_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_24_GPU1 [label="Expert_L2_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 2 - EP64_TP2
        Expert_2_25_GPU0 [label="Expert_L2_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_25_GPU1 [label="Expert_L2_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 2 - EP64_TP2
        Expert_2_26_GPU0 [label="Expert_L2_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_26_GPU1 [label="Expert_L2_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 2 - EP64_TP2
        Expert_2_27_GPU0 [label="Expert_L2_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_27_GPU1 [label="Expert_L2_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 2 - EP64_TP2
        Expert_2_28_GPU0 [label="Expert_L2_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_28_GPU1 [label="Expert_L2_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 2 - EP64_TP2
        Expert_2_29_GPU0 [label="Expert_L2_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_29_GPU1 [label="Expert_L2_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 2 - EP64_TP2
        Expert_2_30_GPU0 [label="Expert_L2_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_30_GPU1 [label="Expert_L2_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 2 - EP64_TP2
        Expert_2_31_GPU0 [label="Expert_L2_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_31_GPU1 [label="Expert_L2_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 2 - EP64_TP2
        Expert_2_32_GPU0 [label="Expert_L2_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_32_GPU1 [label="Expert_L2_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 2 - EP64_TP2
        Expert_2_33_GPU0 [label="Expert_L2_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_33_GPU1 [label="Expert_L2_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 2 - EP64_TP2
        Expert_2_34_GPU0 [label="Expert_L2_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_34_GPU1 [label="Expert_L2_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 2 - EP64_TP2
        Expert_2_35_GPU0 [label="Expert_L2_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_35_GPU1 [label="Expert_L2_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 2 - EP64_TP2
        Expert_2_36_GPU0 [label="Expert_L2_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_36_GPU1 [label="Expert_L2_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 2 - EP64_TP2
        Expert_2_37_GPU0 [label="Expert_L2_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_37_GPU1 [label="Expert_L2_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 2 - EP64_TP2
        Expert_2_38_GPU0 [label="Expert_L2_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_38_GPU1 [label="Expert_L2_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 2 - EP64_TP2
        Expert_2_39_GPU0 [label="Expert_L2_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_39_GPU1 [label="Expert_L2_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 2 - EP64_TP2
        Expert_2_40_GPU0 [label="Expert_L2_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_40_GPU1 [label="Expert_L2_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 2 - EP64_TP2
        Expert_2_41_GPU0 [label="Expert_L2_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_41_GPU1 [label="Expert_L2_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 2 - EP64_TP2
        Expert_2_42_GPU0 [label="Expert_L2_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_42_GPU1 [label="Expert_L2_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 2 - EP64_TP2
        Expert_2_43_GPU0 [label="Expert_L2_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_43_GPU1 [label="Expert_L2_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 2 - EP64_TP2
        Expert_2_44_GPU0 [label="Expert_L2_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_44_GPU1 [label="Expert_L2_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 2 - EP64_TP2
        Expert_2_45_GPU0 [label="Expert_L2_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_45_GPU1 [label="Expert_L2_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 2 - EP64_TP2
        Expert_2_46_GPU0 [label="Expert_L2_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_46_GPU1 [label="Expert_L2_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 2 - EP64_TP2
        Expert_2_47_GPU0 [label="Expert_L2_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_47_GPU1 [label="Expert_L2_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 2 - EP64_TP2
        Expert_2_48_GPU0 [label="Expert_L2_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_48_GPU1 [label="Expert_L2_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 2 - EP64_TP2
        Expert_2_49_GPU0 [label="Expert_L2_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_49_GPU1 [label="Expert_L2_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 2 - EP64_TP2
        Expert_2_50_GPU0 [label="Expert_L2_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_50_GPU1 [label="Expert_L2_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 2 - EP64_TP2
        Expert_2_51_GPU0 [label="Expert_L2_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_51_GPU1 [label="Expert_L2_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 2 - EP64_TP2
        Expert_2_52_GPU0 [label="Expert_L2_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_52_GPU1 [label="Expert_L2_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 2 - EP64_TP2
        Expert_2_53_GPU0 [label="Expert_L2_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_53_GPU1 [label="Expert_L2_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 2 - EP64_TP2
        Expert_2_54_GPU0 [label="Expert_L2_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_54_GPU1 [label="Expert_L2_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 2 - EP64_TP2
        Expert_2_55_GPU0 [label="Expert_L2_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_55_GPU1 [label="Expert_L2_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 2 - EP64_TP2
        Expert_2_56_GPU0 [label="Expert_L2_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_56_GPU1 [label="Expert_L2_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 2 - EP64_TP2
        Expert_2_57_GPU0 [label="Expert_L2_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_57_GPU1 [label="Expert_L2_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 2 - EP64_TP2
        Expert_2_58_GPU0 [label="Expert_L2_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_58_GPU1 [label="Expert_L2_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 2 - EP64_TP2
        Expert_2_59_GPU0 [label="Expert_L2_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_59_GPU1 [label="Expert_L2_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 2 - EP64_TP2
        Expert_2_60_GPU0 [label="Expert_L2_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_60_GPU1 [label="Expert_L2_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 2 - EP64_TP2
        Expert_2_61_GPU0 [label="Expert_L2_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_61_GPU1 [label="Expert_L2_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 2 - EP64_TP2
        Expert_2_62_GPU0 [label="Expert_L2_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_62_GPU1 [label="Expert_L2_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 2 - EP64_TP2
        Expert_2_63_GPU0 [label="Expert_L2_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_2_63_GPU1 [label="Expert_L2_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_2 [label="Expert_Route_Comm_L2\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_2 [label="Expert_Aggregate_L2\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_2 [label="FFN_GPU0_L2\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_2 [label="FFN_GPU1_L2\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_2 [label="FFN_Aggregate_L2\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_2 [label="LayerNorm_L2\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 3 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_3 {
        label="Layer 3 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_3 [label="MHA_Q_GPU0_L3\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_3 [label="MHA_K_GPU0_L3\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_3 [label="MHA_V_GPU0_L3\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_3 [label="MHA_Q_GPU1_L3\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_3 [label="MHA_K_GPU1_L3\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_3 [label="MHA_V_GPU1_L3\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_3 [label="Attention_Comp_GPU0_L3\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_3 [label="Attention_Comp_GPU1_L3\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_3 [label="Attention_Agg_L3\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_3 [label="Gate_Compute_L3\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_3 [label="Gate_Softmax_L3\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 3 - EP64_TP2
        Expert_3_0_GPU0 [label="Expert_L3_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_0_GPU1 [label="Expert_L3_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 3 - EP64_TP2
        Expert_3_1_GPU0 [label="Expert_L3_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_1_GPU1 [label="Expert_L3_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 3 - EP64_TP2
        Expert_3_2_GPU0 [label="Expert_L3_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_2_GPU1 [label="Expert_L3_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 3 - EP64_TP2
        Expert_3_3_GPU0 [label="Expert_L3_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_3_GPU1 [label="Expert_L3_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 3 - EP64_TP2
        Expert_3_4_GPU0 [label="Expert_L3_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_4_GPU1 [label="Expert_L3_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 3 - EP64_TP2
        Expert_3_5_GPU0 [label="Expert_L3_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_5_GPU1 [label="Expert_L3_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 3 - EP64_TP2
        Expert_3_6_GPU0 [label="Expert_L3_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_6_GPU1 [label="Expert_L3_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 3 - EP64_TP2
        Expert_3_7_GPU0 [label="Expert_L3_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_7_GPU1 [label="Expert_L3_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 3 - EP64_TP2
        Expert_3_8_GPU0 [label="Expert_L3_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_8_GPU1 [label="Expert_L3_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 3 - EP64_TP2
        Expert_3_9_GPU0 [label="Expert_L3_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_9_GPU1 [label="Expert_L3_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 3 - EP64_TP2
        Expert_3_10_GPU0 [label="Expert_L3_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_10_GPU1 [label="Expert_L3_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 3 - EP64_TP2
        Expert_3_11_GPU0 [label="Expert_L3_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_11_GPU1 [label="Expert_L3_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 3 - EP64_TP2
        Expert_3_12_GPU0 [label="Expert_L3_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_12_GPU1 [label="Expert_L3_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 3 - EP64_TP2
        Expert_3_13_GPU0 [label="Expert_L3_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_13_GPU1 [label="Expert_L3_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 3 - EP64_TP2
        Expert_3_14_GPU0 [label="Expert_L3_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_14_GPU1 [label="Expert_L3_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 3 - EP64_TP2
        Expert_3_15_GPU0 [label="Expert_L3_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_15_GPU1 [label="Expert_L3_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 3 - EP64_TP2
        Expert_3_16_GPU0 [label="Expert_L3_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_16_GPU1 [label="Expert_L3_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 3 - EP64_TP2
        Expert_3_17_GPU0 [label="Expert_L3_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_17_GPU1 [label="Expert_L3_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 3 - EP64_TP2
        Expert_3_18_GPU0 [label="Expert_L3_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_18_GPU1 [label="Expert_L3_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 3 - EP64_TP2
        Expert_3_19_GPU0 [label="Expert_L3_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_19_GPU1 [label="Expert_L3_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 3 - EP64_TP2
        Expert_3_20_GPU0 [label="Expert_L3_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_20_GPU1 [label="Expert_L3_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 3 - EP64_TP2
        Expert_3_21_GPU0 [label="Expert_L3_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_21_GPU1 [label="Expert_L3_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 3 - EP64_TP2
        Expert_3_22_GPU0 [label="Expert_L3_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_22_GPU1 [label="Expert_L3_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 3 - EP64_TP2
        Expert_3_23_GPU0 [label="Expert_L3_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_23_GPU1 [label="Expert_L3_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 3 - EP64_TP2
        Expert_3_24_GPU0 [label="Expert_L3_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_24_GPU1 [label="Expert_L3_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 3 - EP64_TP2
        Expert_3_25_GPU0 [label="Expert_L3_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_25_GPU1 [label="Expert_L3_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 3 - EP64_TP2
        Expert_3_26_GPU0 [label="Expert_L3_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_26_GPU1 [label="Expert_L3_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 3 - EP64_TP2
        Expert_3_27_GPU0 [label="Expert_L3_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_27_GPU1 [label="Expert_L3_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 3 - EP64_TP2
        Expert_3_28_GPU0 [label="Expert_L3_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_28_GPU1 [label="Expert_L3_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 3 - EP64_TP2
        Expert_3_29_GPU0 [label="Expert_L3_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_29_GPU1 [label="Expert_L3_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 3 - EP64_TP2
        Expert_3_30_GPU0 [label="Expert_L3_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_30_GPU1 [label="Expert_L3_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 3 - EP64_TP2
        Expert_3_31_GPU0 [label="Expert_L3_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_31_GPU1 [label="Expert_L3_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 3 - EP64_TP2
        Expert_3_32_GPU0 [label="Expert_L3_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_32_GPU1 [label="Expert_L3_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 3 - EP64_TP2
        Expert_3_33_GPU0 [label="Expert_L3_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_33_GPU1 [label="Expert_L3_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 3 - EP64_TP2
        Expert_3_34_GPU0 [label="Expert_L3_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_34_GPU1 [label="Expert_L3_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 3 - EP64_TP2
        Expert_3_35_GPU0 [label="Expert_L3_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_35_GPU1 [label="Expert_L3_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 3 - EP64_TP2
        Expert_3_36_GPU0 [label="Expert_L3_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_36_GPU1 [label="Expert_L3_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 3 - EP64_TP2
        Expert_3_37_GPU0 [label="Expert_L3_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_37_GPU1 [label="Expert_L3_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 3 - EP64_TP2
        Expert_3_38_GPU0 [label="Expert_L3_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_38_GPU1 [label="Expert_L3_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 3 - EP64_TP2
        Expert_3_39_GPU0 [label="Expert_L3_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_39_GPU1 [label="Expert_L3_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 3 - EP64_TP2
        Expert_3_40_GPU0 [label="Expert_L3_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_40_GPU1 [label="Expert_L3_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 3 - EP64_TP2
        Expert_3_41_GPU0 [label="Expert_L3_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_41_GPU1 [label="Expert_L3_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 3 - EP64_TP2
        Expert_3_42_GPU0 [label="Expert_L3_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_42_GPU1 [label="Expert_L3_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 3 - EP64_TP2
        Expert_3_43_GPU0 [label="Expert_L3_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_43_GPU1 [label="Expert_L3_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 3 - EP64_TP2
        Expert_3_44_GPU0 [label="Expert_L3_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_44_GPU1 [label="Expert_L3_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 3 - EP64_TP2
        Expert_3_45_GPU0 [label="Expert_L3_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_45_GPU1 [label="Expert_L3_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 3 - EP64_TP2
        Expert_3_46_GPU0 [label="Expert_L3_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_46_GPU1 [label="Expert_L3_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 3 - EP64_TP2
        Expert_3_47_GPU0 [label="Expert_L3_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_47_GPU1 [label="Expert_L3_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 3 - EP64_TP2
        Expert_3_48_GPU0 [label="Expert_L3_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_48_GPU1 [label="Expert_L3_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 3 - EP64_TP2
        Expert_3_49_GPU0 [label="Expert_L3_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_49_GPU1 [label="Expert_L3_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 3 - EP64_TP2
        Expert_3_50_GPU0 [label="Expert_L3_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_50_GPU1 [label="Expert_L3_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 3 - EP64_TP2
        Expert_3_51_GPU0 [label="Expert_L3_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_51_GPU1 [label="Expert_L3_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 3 - EP64_TP2
        Expert_3_52_GPU0 [label="Expert_L3_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_52_GPU1 [label="Expert_L3_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 3 - EP64_TP2
        Expert_3_53_GPU0 [label="Expert_L3_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_53_GPU1 [label="Expert_L3_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 3 - EP64_TP2
        Expert_3_54_GPU0 [label="Expert_L3_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_54_GPU1 [label="Expert_L3_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 3 - EP64_TP2
        Expert_3_55_GPU0 [label="Expert_L3_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_55_GPU1 [label="Expert_L3_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 3 - EP64_TP2
        Expert_3_56_GPU0 [label="Expert_L3_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_56_GPU1 [label="Expert_L3_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 3 - EP64_TP2
        Expert_3_57_GPU0 [label="Expert_L3_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_57_GPU1 [label="Expert_L3_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 3 - EP64_TP2
        Expert_3_58_GPU0 [label="Expert_L3_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_58_GPU1 [label="Expert_L3_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 3 - EP64_TP2
        Expert_3_59_GPU0 [label="Expert_L3_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_59_GPU1 [label="Expert_L3_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 3 - EP64_TP2
        Expert_3_60_GPU0 [label="Expert_L3_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_60_GPU1 [label="Expert_L3_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 3 - EP64_TP2
        Expert_3_61_GPU0 [label="Expert_L3_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_61_GPU1 [label="Expert_L3_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 3 - EP64_TP2
        Expert_3_62_GPU0 [label="Expert_L3_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_62_GPU1 [label="Expert_L3_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 3 - EP64_TP2
        Expert_3_63_GPU0 [label="Expert_L3_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_3_63_GPU1 [label="Expert_L3_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_3 [label="Expert_Route_Comm_L3\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_3 [label="Expert_Aggregate_L3\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_3 [label="FFN_GPU0_L3\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_3 [label="FFN_GPU1_L3\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_3 [label="FFN_Aggregate_L3\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_3 [label="LayerNorm_L3\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 4 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_4 {
        label="Layer 4 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_4 [label="MHA_Q_GPU0_L4\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_4 [label="MHA_K_GPU0_L4\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_4 [label="MHA_V_GPU0_L4\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_4 [label="MHA_Q_GPU1_L4\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_4 [label="MHA_K_GPU1_L4\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_4 [label="MHA_V_GPU1_L4\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_4 [label="Attention_Comp_GPU0_L4\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_4 [label="Attention_Comp_GPU1_L4\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_4 [label="Attention_Agg_L4\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_4 [label="Gate_Compute_L4\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_4 [label="Gate_Softmax_L4\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 4 - EP64_TP2
        Expert_4_0_GPU0 [label="Expert_L4_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_0_GPU1 [label="Expert_L4_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 4 - EP64_TP2
        Expert_4_1_GPU0 [label="Expert_L4_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_1_GPU1 [label="Expert_L4_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 4 - EP64_TP2
        Expert_4_2_GPU0 [label="Expert_L4_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_2_GPU1 [label="Expert_L4_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 4 - EP64_TP2
        Expert_4_3_GPU0 [label="Expert_L4_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_3_GPU1 [label="Expert_L4_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 4 - EP64_TP2
        Expert_4_4_GPU0 [label="Expert_L4_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_4_GPU1 [label="Expert_L4_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 4 - EP64_TP2
        Expert_4_5_GPU0 [label="Expert_L4_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_5_GPU1 [label="Expert_L4_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 4 - EP64_TP2
        Expert_4_6_GPU0 [label="Expert_L4_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_6_GPU1 [label="Expert_L4_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 4 - EP64_TP2
        Expert_4_7_GPU0 [label="Expert_L4_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_7_GPU1 [label="Expert_L4_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 4 - EP64_TP2
        Expert_4_8_GPU0 [label="Expert_L4_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_8_GPU1 [label="Expert_L4_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 4 - EP64_TP2
        Expert_4_9_GPU0 [label="Expert_L4_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_9_GPU1 [label="Expert_L4_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 4 - EP64_TP2
        Expert_4_10_GPU0 [label="Expert_L4_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_10_GPU1 [label="Expert_L4_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 4 - EP64_TP2
        Expert_4_11_GPU0 [label="Expert_L4_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_11_GPU1 [label="Expert_L4_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 4 - EP64_TP2
        Expert_4_12_GPU0 [label="Expert_L4_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_12_GPU1 [label="Expert_L4_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 4 - EP64_TP2
        Expert_4_13_GPU0 [label="Expert_L4_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_13_GPU1 [label="Expert_L4_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 4 - EP64_TP2
        Expert_4_14_GPU0 [label="Expert_L4_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_14_GPU1 [label="Expert_L4_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 4 - EP64_TP2
        Expert_4_15_GPU0 [label="Expert_L4_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_15_GPU1 [label="Expert_L4_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 4 - EP64_TP2
        Expert_4_16_GPU0 [label="Expert_L4_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_16_GPU1 [label="Expert_L4_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 4 - EP64_TP2
        Expert_4_17_GPU0 [label="Expert_L4_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_17_GPU1 [label="Expert_L4_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 4 - EP64_TP2
        Expert_4_18_GPU0 [label="Expert_L4_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_18_GPU1 [label="Expert_L4_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 4 - EP64_TP2
        Expert_4_19_GPU0 [label="Expert_L4_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_19_GPU1 [label="Expert_L4_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 4 - EP64_TP2
        Expert_4_20_GPU0 [label="Expert_L4_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_20_GPU1 [label="Expert_L4_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 4 - EP64_TP2
        Expert_4_21_GPU0 [label="Expert_L4_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_21_GPU1 [label="Expert_L4_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 4 - EP64_TP2
        Expert_4_22_GPU0 [label="Expert_L4_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_22_GPU1 [label="Expert_L4_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 4 - EP64_TP2
        Expert_4_23_GPU0 [label="Expert_L4_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_23_GPU1 [label="Expert_L4_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 4 - EP64_TP2
        Expert_4_24_GPU0 [label="Expert_L4_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_24_GPU1 [label="Expert_L4_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 4 - EP64_TP2
        Expert_4_25_GPU0 [label="Expert_L4_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_25_GPU1 [label="Expert_L4_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 4 - EP64_TP2
        Expert_4_26_GPU0 [label="Expert_L4_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_26_GPU1 [label="Expert_L4_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 4 - EP64_TP2
        Expert_4_27_GPU0 [label="Expert_L4_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_27_GPU1 [label="Expert_L4_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 4 - EP64_TP2
        Expert_4_28_GPU0 [label="Expert_L4_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_28_GPU1 [label="Expert_L4_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 4 - EP64_TP2
        Expert_4_29_GPU0 [label="Expert_L4_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_29_GPU1 [label="Expert_L4_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 4 - EP64_TP2
        Expert_4_30_GPU0 [label="Expert_L4_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_30_GPU1 [label="Expert_L4_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 4 - EP64_TP2
        Expert_4_31_GPU0 [label="Expert_L4_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_31_GPU1 [label="Expert_L4_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 4 - EP64_TP2
        Expert_4_32_GPU0 [label="Expert_L4_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_32_GPU1 [label="Expert_L4_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 4 - EP64_TP2
        Expert_4_33_GPU0 [label="Expert_L4_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_33_GPU1 [label="Expert_L4_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 4 - EP64_TP2
        Expert_4_34_GPU0 [label="Expert_L4_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_34_GPU1 [label="Expert_L4_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 4 - EP64_TP2
        Expert_4_35_GPU0 [label="Expert_L4_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_35_GPU1 [label="Expert_L4_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 4 - EP64_TP2
        Expert_4_36_GPU0 [label="Expert_L4_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_36_GPU1 [label="Expert_L4_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 4 - EP64_TP2
        Expert_4_37_GPU0 [label="Expert_L4_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_37_GPU1 [label="Expert_L4_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 4 - EP64_TP2
        Expert_4_38_GPU0 [label="Expert_L4_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_38_GPU1 [label="Expert_L4_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 4 - EP64_TP2
        Expert_4_39_GPU0 [label="Expert_L4_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_39_GPU1 [label="Expert_L4_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 4 - EP64_TP2
        Expert_4_40_GPU0 [label="Expert_L4_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_40_GPU1 [label="Expert_L4_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 4 - EP64_TP2
        Expert_4_41_GPU0 [label="Expert_L4_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_41_GPU1 [label="Expert_L4_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 4 - EP64_TP2
        Expert_4_42_GPU0 [label="Expert_L4_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_42_GPU1 [label="Expert_L4_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 4 - EP64_TP2
        Expert_4_43_GPU0 [label="Expert_L4_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_43_GPU1 [label="Expert_L4_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 4 - EP64_TP2
        Expert_4_44_GPU0 [label="Expert_L4_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_44_GPU1 [label="Expert_L4_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 4 - EP64_TP2
        Expert_4_45_GPU0 [label="Expert_L4_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_45_GPU1 [label="Expert_L4_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 4 - EP64_TP2
        Expert_4_46_GPU0 [label="Expert_L4_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_46_GPU1 [label="Expert_L4_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 4 - EP64_TP2
        Expert_4_47_GPU0 [label="Expert_L4_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_47_GPU1 [label="Expert_L4_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 4 - EP64_TP2
        Expert_4_48_GPU0 [label="Expert_L4_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_48_GPU1 [label="Expert_L4_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 4 - EP64_TP2
        Expert_4_49_GPU0 [label="Expert_L4_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_49_GPU1 [label="Expert_L4_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 4 - EP64_TP2
        Expert_4_50_GPU0 [label="Expert_L4_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_50_GPU1 [label="Expert_L4_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 4 - EP64_TP2
        Expert_4_51_GPU0 [label="Expert_L4_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_51_GPU1 [label="Expert_L4_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 4 - EP64_TP2
        Expert_4_52_GPU0 [label="Expert_L4_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_52_GPU1 [label="Expert_L4_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 4 - EP64_TP2
        Expert_4_53_GPU0 [label="Expert_L4_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_53_GPU1 [label="Expert_L4_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 4 - EP64_TP2
        Expert_4_54_GPU0 [label="Expert_L4_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_54_GPU1 [label="Expert_L4_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 4 - EP64_TP2
        Expert_4_55_GPU0 [label="Expert_L4_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_55_GPU1 [label="Expert_L4_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 4 - EP64_TP2
        Expert_4_56_GPU0 [label="Expert_L4_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_56_GPU1 [label="Expert_L4_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 4 - EP64_TP2
        Expert_4_57_GPU0 [label="Expert_L4_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_57_GPU1 [label="Expert_L4_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 4 - EP64_TP2
        Expert_4_58_GPU0 [label="Expert_L4_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_58_GPU1 [label="Expert_L4_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 4 - EP64_TP2
        Expert_4_59_GPU0 [label="Expert_L4_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_59_GPU1 [label="Expert_L4_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 4 - EP64_TP2
        Expert_4_60_GPU0 [label="Expert_L4_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_60_GPU1 [label="Expert_L4_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 4 - EP64_TP2
        Expert_4_61_GPU0 [label="Expert_L4_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_61_GPU1 [label="Expert_L4_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 4 - EP64_TP2
        Expert_4_62_GPU0 [label="Expert_L4_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_62_GPU1 [label="Expert_L4_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 4 - EP64_TP2
        Expert_4_63_GPU0 [label="Expert_L4_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_4_63_GPU1 [label="Expert_L4_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_4 [label="Expert_Route_Comm_L4\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_4 [label="Expert_Aggregate_L4\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_4 [label="FFN_GPU0_L4\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_4 [label="FFN_GPU1_L4\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_4 [label="FFN_Aggregate_L4\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_4 [label="LayerNorm_L4\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 5 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_5 {
        label="Layer 5 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_5 [label="MHA_Q_GPU0_L5\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_5 [label="MHA_K_GPU0_L5\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_5 [label="MHA_V_GPU0_L5\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_5 [label="MHA_Q_GPU1_L5\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_5 [label="MHA_K_GPU1_L5\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_5 [label="MHA_V_GPU1_L5\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_5 [label="Attention_Comp_GPU0_L5\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_5 [label="Attention_Comp_GPU1_L5\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_5 [label="Attention_Agg_L5\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_5 [label="Gate_Compute_L5\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_5 [label="Gate_Softmax_L5\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 5 - EP64_TP2
        Expert_5_0_GPU0 [label="Expert_L5_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_0_GPU1 [label="Expert_L5_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 5 - EP64_TP2
        Expert_5_1_GPU0 [label="Expert_L5_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_1_GPU1 [label="Expert_L5_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 5 - EP64_TP2
        Expert_5_2_GPU0 [label="Expert_L5_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_2_GPU1 [label="Expert_L5_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 5 - EP64_TP2
        Expert_5_3_GPU0 [label="Expert_L5_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_3_GPU1 [label="Expert_L5_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 5 - EP64_TP2
        Expert_5_4_GPU0 [label="Expert_L5_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_4_GPU1 [label="Expert_L5_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 5 - EP64_TP2
        Expert_5_5_GPU0 [label="Expert_L5_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_5_GPU1 [label="Expert_L5_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 5 - EP64_TP2
        Expert_5_6_GPU0 [label="Expert_L5_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_6_GPU1 [label="Expert_L5_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 5 - EP64_TP2
        Expert_5_7_GPU0 [label="Expert_L5_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_7_GPU1 [label="Expert_L5_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 5 - EP64_TP2
        Expert_5_8_GPU0 [label="Expert_L5_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_8_GPU1 [label="Expert_L5_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 5 - EP64_TP2
        Expert_5_9_GPU0 [label="Expert_L5_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_9_GPU1 [label="Expert_L5_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 5 - EP64_TP2
        Expert_5_10_GPU0 [label="Expert_L5_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_10_GPU1 [label="Expert_L5_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 5 - EP64_TP2
        Expert_5_11_GPU0 [label="Expert_L5_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_11_GPU1 [label="Expert_L5_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 5 - EP64_TP2
        Expert_5_12_GPU0 [label="Expert_L5_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_12_GPU1 [label="Expert_L5_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 5 - EP64_TP2
        Expert_5_13_GPU0 [label="Expert_L5_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_13_GPU1 [label="Expert_L5_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 5 - EP64_TP2
        Expert_5_14_GPU0 [label="Expert_L5_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_14_GPU1 [label="Expert_L5_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 5 - EP64_TP2
        Expert_5_15_GPU0 [label="Expert_L5_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_15_GPU1 [label="Expert_L5_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 5 - EP64_TP2
        Expert_5_16_GPU0 [label="Expert_L5_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_16_GPU1 [label="Expert_L5_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 5 - EP64_TP2
        Expert_5_17_GPU0 [label="Expert_L5_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_17_GPU1 [label="Expert_L5_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 5 - EP64_TP2
        Expert_5_18_GPU0 [label="Expert_L5_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_18_GPU1 [label="Expert_L5_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 5 - EP64_TP2
        Expert_5_19_GPU0 [label="Expert_L5_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_19_GPU1 [label="Expert_L5_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 5 - EP64_TP2
        Expert_5_20_GPU0 [label="Expert_L5_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_20_GPU1 [label="Expert_L5_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 5 - EP64_TP2
        Expert_5_21_GPU0 [label="Expert_L5_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_21_GPU1 [label="Expert_L5_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 5 - EP64_TP2
        Expert_5_22_GPU0 [label="Expert_L5_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_22_GPU1 [label="Expert_L5_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 5 - EP64_TP2
        Expert_5_23_GPU0 [label="Expert_L5_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_23_GPU1 [label="Expert_L5_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 5 - EP64_TP2
        Expert_5_24_GPU0 [label="Expert_L5_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_24_GPU1 [label="Expert_L5_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 5 - EP64_TP2
        Expert_5_25_GPU0 [label="Expert_L5_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_25_GPU1 [label="Expert_L5_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 5 - EP64_TP2
        Expert_5_26_GPU0 [label="Expert_L5_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_26_GPU1 [label="Expert_L5_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 5 - EP64_TP2
        Expert_5_27_GPU0 [label="Expert_L5_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_27_GPU1 [label="Expert_L5_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 5 - EP64_TP2
        Expert_5_28_GPU0 [label="Expert_L5_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_28_GPU1 [label="Expert_L5_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 5 - EP64_TP2
        Expert_5_29_GPU0 [label="Expert_L5_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_29_GPU1 [label="Expert_L5_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 5 - EP64_TP2
        Expert_5_30_GPU0 [label="Expert_L5_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_30_GPU1 [label="Expert_L5_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 5 - EP64_TP2
        Expert_5_31_GPU0 [label="Expert_L5_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_31_GPU1 [label="Expert_L5_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 5 - EP64_TP2
        Expert_5_32_GPU0 [label="Expert_L5_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_32_GPU1 [label="Expert_L5_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 5 - EP64_TP2
        Expert_5_33_GPU0 [label="Expert_L5_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_33_GPU1 [label="Expert_L5_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 5 - EP64_TP2
        Expert_5_34_GPU0 [label="Expert_L5_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_34_GPU1 [label="Expert_L5_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 5 - EP64_TP2
        Expert_5_35_GPU0 [label="Expert_L5_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_35_GPU1 [label="Expert_L5_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 5 - EP64_TP2
        Expert_5_36_GPU0 [label="Expert_L5_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_36_GPU1 [label="Expert_L5_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 5 - EP64_TP2
        Expert_5_37_GPU0 [label="Expert_L5_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_37_GPU1 [label="Expert_L5_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 5 - EP64_TP2
        Expert_5_38_GPU0 [label="Expert_L5_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_38_GPU1 [label="Expert_L5_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 5 - EP64_TP2
        Expert_5_39_GPU0 [label="Expert_L5_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_39_GPU1 [label="Expert_L5_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 5 - EP64_TP2
        Expert_5_40_GPU0 [label="Expert_L5_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_40_GPU1 [label="Expert_L5_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 5 - EP64_TP2
        Expert_5_41_GPU0 [label="Expert_L5_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_41_GPU1 [label="Expert_L5_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 5 - EP64_TP2
        Expert_5_42_GPU0 [label="Expert_L5_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_42_GPU1 [label="Expert_L5_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 5 - EP64_TP2
        Expert_5_43_GPU0 [label="Expert_L5_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_43_GPU1 [label="Expert_L5_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 5 - EP64_TP2
        Expert_5_44_GPU0 [label="Expert_L5_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_44_GPU1 [label="Expert_L5_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 5 - EP64_TP2
        Expert_5_45_GPU0 [label="Expert_L5_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_45_GPU1 [label="Expert_L5_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 5 - EP64_TP2
        Expert_5_46_GPU0 [label="Expert_L5_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_46_GPU1 [label="Expert_L5_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 5 - EP64_TP2
        Expert_5_47_GPU0 [label="Expert_L5_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_47_GPU1 [label="Expert_L5_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 5 - EP64_TP2
        Expert_5_48_GPU0 [label="Expert_L5_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_48_GPU1 [label="Expert_L5_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 5 - EP64_TP2
        Expert_5_49_GPU0 [label="Expert_L5_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_49_GPU1 [label="Expert_L5_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 5 - EP64_TP2
        Expert_5_50_GPU0 [label="Expert_L5_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_50_GPU1 [label="Expert_L5_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 5 - EP64_TP2
        Expert_5_51_GPU0 [label="Expert_L5_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_51_GPU1 [label="Expert_L5_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 5 - EP64_TP2
        Expert_5_52_GPU0 [label="Expert_L5_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_52_GPU1 [label="Expert_L5_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 5 - EP64_TP2
        Expert_5_53_GPU0 [label="Expert_L5_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_53_GPU1 [label="Expert_L5_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 5 - EP64_TP2
        Expert_5_54_GPU0 [label="Expert_L5_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_54_GPU1 [label="Expert_L5_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 5 - EP64_TP2
        Expert_5_55_GPU0 [label="Expert_L5_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_55_GPU1 [label="Expert_L5_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 5 - EP64_TP2
        Expert_5_56_GPU0 [label="Expert_L5_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_56_GPU1 [label="Expert_L5_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 5 - EP64_TP2
        Expert_5_57_GPU0 [label="Expert_L5_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_57_GPU1 [label="Expert_L5_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 5 - EP64_TP2
        Expert_5_58_GPU0 [label="Expert_L5_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_58_GPU1 [label="Expert_L5_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 5 - EP64_TP2
        Expert_5_59_GPU0 [label="Expert_L5_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_59_GPU1 [label="Expert_L5_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 5 - EP64_TP2
        Expert_5_60_GPU0 [label="Expert_L5_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_60_GPU1 [label="Expert_L5_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 5 - EP64_TP2
        Expert_5_61_GPU0 [label="Expert_L5_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_61_GPU1 [label="Expert_L5_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 5 - EP64_TP2
        Expert_5_62_GPU0 [label="Expert_L5_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_62_GPU1 [label="Expert_L5_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 5 - EP64_TP2
        Expert_5_63_GPU0 [label="Expert_L5_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_5_63_GPU1 [label="Expert_L5_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_5 [label="Expert_Route_Comm_L5\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_5 [label="Expert_Aggregate_L5\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_5 [label="FFN_GPU0_L5\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_5 [label="FFN_GPU1_L5\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_5 [label="FFN_Aggregate_L5\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_5 [label="LayerNorm_L5\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 6 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_6 {
        label="Layer 6 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_6 [label="MHA_Q_GPU0_L6\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_6 [label="MHA_K_GPU0_L6\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_6 [label="MHA_V_GPU0_L6\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_6 [label="MHA_Q_GPU1_L6\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_6 [label="MHA_K_GPU1_L6\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_6 [label="MHA_V_GPU1_L6\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_6 [label="Attention_Comp_GPU0_L6\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_6 [label="Attention_Comp_GPU1_L6\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_6 [label="Attention_Agg_L6\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_6 [label="Gate_Compute_L6\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_6 [label="Gate_Softmax_L6\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 6 - EP64_TP2
        Expert_6_0_GPU0 [label="Expert_L6_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_0_GPU1 [label="Expert_L6_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 6 - EP64_TP2
        Expert_6_1_GPU0 [label="Expert_L6_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_1_GPU1 [label="Expert_L6_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 6 - EP64_TP2
        Expert_6_2_GPU0 [label="Expert_L6_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_2_GPU1 [label="Expert_L6_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 6 - EP64_TP2
        Expert_6_3_GPU0 [label="Expert_L6_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_3_GPU1 [label="Expert_L6_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 6 - EP64_TP2
        Expert_6_4_GPU0 [label="Expert_L6_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_4_GPU1 [label="Expert_L6_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 6 - EP64_TP2
        Expert_6_5_GPU0 [label="Expert_L6_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_5_GPU1 [label="Expert_L6_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 6 - EP64_TP2
        Expert_6_6_GPU0 [label="Expert_L6_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_6_GPU1 [label="Expert_L6_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 6 - EP64_TP2
        Expert_6_7_GPU0 [label="Expert_L6_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_7_GPU1 [label="Expert_L6_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 6 - EP64_TP2
        Expert_6_8_GPU0 [label="Expert_L6_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_8_GPU1 [label="Expert_L6_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 6 - EP64_TP2
        Expert_6_9_GPU0 [label="Expert_L6_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_9_GPU1 [label="Expert_L6_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 6 - EP64_TP2
        Expert_6_10_GPU0 [label="Expert_L6_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_10_GPU1 [label="Expert_L6_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 6 - EP64_TP2
        Expert_6_11_GPU0 [label="Expert_L6_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_11_GPU1 [label="Expert_L6_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 6 - EP64_TP2
        Expert_6_12_GPU0 [label="Expert_L6_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_12_GPU1 [label="Expert_L6_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 6 - EP64_TP2
        Expert_6_13_GPU0 [label="Expert_L6_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_13_GPU1 [label="Expert_L6_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 6 - EP64_TP2
        Expert_6_14_GPU0 [label="Expert_L6_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_14_GPU1 [label="Expert_L6_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 6 - EP64_TP2
        Expert_6_15_GPU0 [label="Expert_L6_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_15_GPU1 [label="Expert_L6_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 6 - EP64_TP2
        Expert_6_16_GPU0 [label="Expert_L6_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_16_GPU1 [label="Expert_L6_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 6 - EP64_TP2
        Expert_6_17_GPU0 [label="Expert_L6_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_17_GPU1 [label="Expert_L6_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 6 - EP64_TP2
        Expert_6_18_GPU0 [label="Expert_L6_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_18_GPU1 [label="Expert_L6_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 6 - EP64_TP2
        Expert_6_19_GPU0 [label="Expert_L6_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_19_GPU1 [label="Expert_L6_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 6 - EP64_TP2
        Expert_6_20_GPU0 [label="Expert_L6_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_20_GPU1 [label="Expert_L6_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 6 - EP64_TP2
        Expert_6_21_GPU0 [label="Expert_L6_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_21_GPU1 [label="Expert_L6_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 6 - EP64_TP2
        Expert_6_22_GPU0 [label="Expert_L6_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_22_GPU1 [label="Expert_L6_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 6 - EP64_TP2
        Expert_6_23_GPU0 [label="Expert_L6_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_23_GPU1 [label="Expert_L6_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 6 - EP64_TP2
        Expert_6_24_GPU0 [label="Expert_L6_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_24_GPU1 [label="Expert_L6_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 6 - EP64_TP2
        Expert_6_25_GPU0 [label="Expert_L6_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_25_GPU1 [label="Expert_L6_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 6 - EP64_TP2
        Expert_6_26_GPU0 [label="Expert_L6_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_26_GPU1 [label="Expert_L6_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 6 - EP64_TP2
        Expert_6_27_GPU0 [label="Expert_L6_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_27_GPU1 [label="Expert_L6_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 6 - EP64_TP2
        Expert_6_28_GPU0 [label="Expert_L6_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_28_GPU1 [label="Expert_L6_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 6 - EP64_TP2
        Expert_6_29_GPU0 [label="Expert_L6_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_29_GPU1 [label="Expert_L6_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 6 - EP64_TP2
        Expert_6_30_GPU0 [label="Expert_L6_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_30_GPU1 [label="Expert_L6_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 6 - EP64_TP2
        Expert_6_31_GPU0 [label="Expert_L6_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_31_GPU1 [label="Expert_L6_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 6 - EP64_TP2
        Expert_6_32_GPU0 [label="Expert_L6_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_32_GPU1 [label="Expert_L6_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 6 - EP64_TP2
        Expert_6_33_GPU0 [label="Expert_L6_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_33_GPU1 [label="Expert_L6_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 6 - EP64_TP2
        Expert_6_34_GPU0 [label="Expert_L6_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_34_GPU1 [label="Expert_L6_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 6 - EP64_TP2
        Expert_6_35_GPU0 [label="Expert_L6_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_35_GPU1 [label="Expert_L6_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 6 - EP64_TP2
        Expert_6_36_GPU0 [label="Expert_L6_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_36_GPU1 [label="Expert_L6_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 6 - EP64_TP2
        Expert_6_37_GPU0 [label="Expert_L6_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_37_GPU1 [label="Expert_L6_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 6 - EP64_TP2
        Expert_6_38_GPU0 [label="Expert_L6_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_38_GPU1 [label="Expert_L6_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 6 - EP64_TP2
        Expert_6_39_GPU0 [label="Expert_L6_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_39_GPU1 [label="Expert_L6_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 6 - EP64_TP2
        Expert_6_40_GPU0 [label="Expert_L6_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_40_GPU1 [label="Expert_L6_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 6 - EP64_TP2
        Expert_6_41_GPU0 [label="Expert_L6_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_41_GPU1 [label="Expert_L6_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 6 - EP64_TP2
        Expert_6_42_GPU0 [label="Expert_L6_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_42_GPU1 [label="Expert_L6_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 6 - EP64_TP2
        Expert_6_43_GPU0 [label="Expert_L6_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_43_GPU1 [label="Expert_L6_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 6 - EP64_TP2
        Expert_6_44_GPU0 [label="Expert_L6_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_44_GPU1 [label="Expert_L6_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 6 - EP64_TP2
        Expert_6_45_GPU0 [label="Expert_L6_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_45_GPU1 [label="Expert_L6_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 6 - EP64_TP2
        Expert_6_46_GPU0 [label="Expert_L6_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_46_GPU1 [label="Expert_L6_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 6 - EP64_TP2
        Expert_6_47_GPU0 [label="Expert_L6_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_47_GPU1 [label="Expert_L6_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 6 - EP64_TP2
        Expert_6_48_GPU0 [label="Expert_L6_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_48_GPU1 [label="Expert_L6_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 6 - EP64_TP2
        Expert_6_49_GPU0 [label="Expert_L6_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_49_GPU1 [label="Expert_L6_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 6 - EP64_TP2
        Expert_6_50_GPU0 [label="Expert_L6_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_50_GPU1 [label="Expert_L6_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 6 - EP64_TP2
        Expert_6_51_GPU0 [label="Expert_L6_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_51_GPU1 [label="Expert_L6_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 6 - EP64_TP2
        Expert_6_52_GPU0 [label="Expert_L6_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_52_GPU1 [label="Expert_L6_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 6 - EP64_TP2
        Expert_6_53_GPU0 [label="Expert_L6_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_53_GPU1 [label="Expert_L6_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 6 - EP64_TP2
        Expert_6_54_GPU0 [label="Expert_L6_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_54_GPU1 [label="Expert_L6_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 6 - EP64_TP2
        Expert_6_55_GPU0 [label="Expert_L6_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_55_GPU1 [label="Expert_L6_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 6 - EP64_TP2
        Expert_6_56_GPU0 [label="Expert_L6_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_56_GPU1 [label="Expert_L6_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 6 - EP64_TP2
        Expert_6_57_GPU0 [label="Expert_L6_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_57_GPU1 [label="Expert_L6_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 6 - EP64_TP2
        Expert_6_58_GPU0 [label="Expert_L6_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_58_GPU1 [label="Expert_L6_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 6 - EP64_TP2
        Expert_6_59_GPU0 [label="Expert_L6_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_59_GPU1 [label="Expert_L6_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 6 - EP64_TP2
        Expert_6_60_GPU0 [label="Expert_L6_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_60_GPU1 [label="Expert_L6_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 6 - EP64_TP2
        Expert_6_61_GPU0 [label="Expert_L6_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_61_GPU1 [label="Expert_L6_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 6 - EP64_TP2
        Expert_6_62_GPU0 [label="Expert_L6_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_62_GPU1 [label="Expert_L6_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 6 - EP64_TP2
        Expert_6_63_GPU0 [label="Expert_L6_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_6_63_GPU1 [label="Expert_L6_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_6 [label="Expert_Route_Comm_L6\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_6 [label="Expert_Aggregate_L6\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_6 [label="FFN_GPU0_L6\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_6 [label="FFN_GPU1_L6\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_6 [label="FFN_Aggregate_L6\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_6 [label="LayerNorm_L6\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 7 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_7 {
        label="Layer 7 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_7 [label="MHA_Q_GPU0_L7\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_7 [label="MHA_K_GPU0_L7\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_7 [label="MHA_V_GPU0_L7\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_7 [label="MHA_Q_GPU1_L7\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_7 [label="MHA_K_GPU1_L7\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_7 [label="MHA_V_GPU1_L7\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_7 [label="Attention_Comp_GPU0_L7\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_7 [label="Attention_Comp_GPU1_L7\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_7 [label="Attention_Agg_L7\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_7 [label="Gate_Compute_L7\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_7 [label="Gate_Softmax_L7\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 7 - EP64_TP2
        Expert_7_0_GPU0 [label="Expert_L7_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_0_GPU1 [label="Expert_L7_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 7 - EP64_TP2
        Expert_7_1_GPU0 [label="Expert_L7_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_1_GPU1 [label="Expert_L7_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 7 - EP64_TP2
        Expert_7_2_GPU0 [label="Expert_L7_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_2_GPU1 [label="Expert_L7_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 7 - EP64_TP2
        Expert_7_3_GPU0 [label="Expert_L7_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_3_GPU1 [label="Expert_L7_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 7 - EP64_TP2
        Expert_7_4_GPU0 [label="Expert_L7_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_4_GPU1 [label="Expert_L7_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 7 - EP64_TP2
        Expert_7_5_GPU0 [label="Expert_L7_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_5_GPU1 [label="Expert_L7_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 7 - EP64_TP2
        Expert_7_6_GPU0 [label="Expert_L7_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_6_GPU1 [label="Expert_L7_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 7 - EP64_TP2
        Expert_7_7_GPU0 [label="Expert_L7_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_7_GPU1 [label="Expert_L7_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 7 - EP64_TP2
        Expert_7_8_GPU0 [label="Expert_L7_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_8_GPU1 [label="Expert_L7_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 7 - EP64_TP2
        Expert_7_9_GPU0 [label="Expert_L7_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_9_GPU1 [label="Expert_L7_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 7 - EP64_TP2
        Expert_7_10_GPU0 [label="Expert_L7_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_10_GPU1 [label="Expert_L7_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 7 - EP64_TP2
        Expert_7_11_GPU0 [label="Expert_L7_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_11_GPU1 [label="Expert_L7_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 7 - EP64_TP2
        Expert_7_12_GPU0 [label="Expert_L7_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_12_GPU1 [label="Expert_L7_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 7 - EP64_TP2
        Expert_7_13_GPU0 [label="Expert_L7_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_13_GPU1 [label="Expert_L7_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 7 - EP64_TP2
        Expert_7_14_GPU0 [label="Expert_L7_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_14_GPU1 [label="Expert_L7_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 7 - EP64_TP2
        Expert_7_15_GPU0 [label="Expert_L7_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_15_GPU1 [label="Expert_L7_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 7 - EP64_TP2
        Expert_7_16_GPU0 [label="Expert_L7_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_16_GPU1 [label="Expert_L7_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 7 - EP64_TP2
        Expert_7_17_GPU0 [label="Expert_L7_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_17_GPU1 [label="Expert_L7_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 7 - EP64_TP2
        Expert_7_18_GPU0 [label="Expert_L7_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_18_GPU1 [label="Expert_L7_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 7 - EP64_TP2
        Expert_7_19_GPU0 [label="Expert_L7_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_19_GPU1 [label="Expert_L7_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 7 - EP64_TP2
        Expert_7_20_GPU0 [label="Expert_L7_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_20_GPU1 [label="Expert_L7_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 7 - EP64_TP2
        Expert_7_21_GPU0 [label="Expert_L7_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_21_GPU1 [label="Expert_L7_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 7 - EP64_TP2
        Expert_7_22_GPU0 [label="Expert_L7_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_22_GPU1 [label="Expert_L7_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 7 - EP64_TP2
        Expert_7_23_GPU0 [label="Expert_L7_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_23_GPU1 [label="Expert_L7_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 7 - EP64_TP2
        Expert_7_24_GPU0 [label="Expert_L7_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_24_GPU1 [label="Expert_L7_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 7 - EP64_TP2
        Expert_7_25_GPU0 [label="Expert_L7_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_25_GPU1 [label="Expert_L7_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 7 - EP64_TP2
        Expert_7_26_GPU0 [label="Expert_L7_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_26_GPU1 [label="Expert_L7_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 7 - EP64_TP2
        Expert_7_27_GPU0 [label="Expert_L7_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_27_GPU1 [label="Expert_L7_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 7 - EP64_TP2
        Expert_7_28_GPU0 [label="Expert_L7_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_28_GPU1 [label="Expert_L7_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 7 - EP64_TP2
        Expert_7_29_GPU0 [label="Expert_L7_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_29_GPU1 [label="Expert_L7_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 7 - EP64_TP2
        Expert_7_30_GPU0 [label="Expert_L7_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_30_GPU1 [label="Expert_L7_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 7 - EP64_TP2
        Expert_7_31_GPU0 [label="Expert_L7_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_31_GPU1 [label="Expert_L7_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 7 - EP64_TP2
        Expert_7_32_GPU0 [label="Expert_L7_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_32_GPU1 [label="Expert_L7_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 7 - EP64_TP2
        Expert_7_33_GPU0 [label="Expert_L7_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_33_GPU1 [label="Expert_L7_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 7 - EP64_TP2
        Expert_7_34_GPU0 [label="Expert_L7_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_34_GPU1 [label="Expert_L7_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 7 - EP64_TP2
        Expert_7_35_GPU0 [label="Expert_L7_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_35_GPU1 [label="Expert_L7_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 7 - EP64_TP2
        Expert_7_36_GPU0 [label="Expert_L7_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_36_GPU1 [label="Expert_L7_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 7 - EP64_TP2
        Expert_7_37_GPU0 [label="Expert_L7_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_37_GPU1 [label="Expert_L7_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 7 - EP64_TP2
        Expert_7_38_GPU0 [label="Expert_L7_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_38_GPU1 [label="Expert_L7_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 7 - EP64_TP2
        Expert_7_39_GPU0 [label="Expert_L7_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_39_GPU1 [label="Expert_L7_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 7 - EP64_TP2
        Expert_7_40_GPU0 [label="Expert_L7_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_40_GPU1 [label="Expert_L7_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 7 - EP64_TP2
        Expert_7_41_GPU0 [label="Expert_L7_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_41_GPU1 [label="Expert_L7_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 7 - EP64_TP2
        Expert_7_42_GPU0 [label="Expert_L7_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_42_GPU1 [label="Expert_L7_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 7 - EP64_TP2
        Expert_7_43_GPU0 [label="Expert_L7_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_43_GPU1 [label="Expert_L7_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 7 - EP64_TP2
        Expert_7_44_GPU0 [label="Expert_L7_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_44_GPU1 [label="Expert_L7_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 7 - EP64_TP2
        Expert_7_45_GPU0 [label="Expert_L7_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_45_GPU1 [label="Expert_L7_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 7 - EP64_TP2
        Expert_7_46_GPU0 [label="Expert_L7_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_46_GPU1 [label="Expert_L7_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 7 - EP64_TP2
        Expert_7_47_GPU0 [label="Expert_L7_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_47_GPU1 [label="Expert_L7_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 7 - EP64_TP2
        Expert_7_48_GPU0 [label="Expert_L7_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_48_GPU1 [label="Expert_L7_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 7 - EP64_TP2
        Expert_7_49_GPU0 [label="Expert_L7_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_49_GPU1 [label="Expert_L7_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 7 - EP64_TP2
        Expert_7_50_GPU0 [label="Expert_L7_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_50_GPU1 [label="Expert_L7_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 7 - EP64_TP2
        Expert_7_51_GPU0 [label="Expert_L7_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_51_GPU1 [label="Expert_L7_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 7 - EP64_TP2
        Expert_7_52_GPU0 [label="Expert_L7_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_52_GPU1 [label="Expert_L7_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 7 - EP64_TP2
        Expert_7_53_GPU0 [label="Expert_L7_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_53_GPU1 [label="Expert_L7_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 7 - EP64_TP2
        Expert_7_54_GPU0 [label="Expert_L7_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_54_GPU1 [label="Expert_L7_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 7 - EP64_TP2
        Expert_7_55_GPU0 [label="Expert_L7_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_55_GPU1 [label="Expert_L7_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 7 - EP64_TP2
        Expert_7_56_GPU0 [label="Expert_L7_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_56_GPU1 [label="Expert_L7_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 7 - EP64_TP2
        Expert_7_57_GPU0 [label="Expert_L7_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_57_GPU1 [label="Expert_L7_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 7 - EP64_TP2
        Expert_7_58_GPU0 [label="Expert_L7_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_58_GPU1 [label="Expert_L7_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 7 - EP64_TP2
        Expert_7_59_GPU0 [label="Expert_L7_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_59_GPU1 [label="Expert_L7_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 7 - EP64_TP2
        Expert_7_60_GPU0 [label="Expert_L7_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_60_GPU1 [label="Expert_L7_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 7 - EP64_TP2
        Expert_7_61_GPU0 [label="Expert_L7_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_61_GPU1 [label="Expert_L7_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 7 - EP64_TP2
        Expert_7_62_GPU0 [label="Expert_L7_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_62_GPU1 [label="Expert_L7_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 7 - EP64_TP2
        Expert_7_63_GPU0 [label="Expert_L7_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_7_63_GPU1 [label="Expert_L7_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_7 [label="Expert_Route_Comm_L7\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_7 [label="Expert_Aggregate_L7\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_7 [label="FFN_GPU0_L7\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_7 [label="FFN_GPU1_L7\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_7 [label="FFN_Aggregate_L7\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_7 [label="LayerNorm_L7\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 8 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_8 {
        label="Layer 8 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_8 [label="MHA_Q_GPU0_L8\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_8 [label="MHA_K_GPU0_L8\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_8 [label="MHA_V_GPU0_L8\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_8 [label="MHA_Q_GPU1_L8\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_8 [label="MHA_K_GPU1_L8\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_8 [label="MHA_V_GPU1_L8\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_8 [label="Attention_Comp_GPU0_L8\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_8 [label="Attention_Comp_GPU1_L8\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_8 [label="Attention_Agg_L8\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_8 [label="Gate_Compute_L8\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_8 [label="Gate_Softmax_L8\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 8 - EP64_TP2
        Expert_8_0_GPU0 [label="Expert_L8_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_0_GPU1 [label="Expert_L8_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 8 - EP64_TP2
        Expert_8_1_GPU0 [label="Expert_L8_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_1_GPU1 [label="Expert_L8_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 8 - EP64_TP2
        Expert_8_2_GPU0 [label="Expert_L8_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_2_GPU1 [label="Expert_L8_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 8 - EP64_TP2
        Expert_8_3_GPU0 [label="Expert_L8_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_3_GPU1 [label="Expert_L8_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 8 - EP64_TP2
        Expert_8_4_GPU0 [label="Expert_L8_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_4_GPU1 [label="Expert_L8_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 8 - EP64_TP2
        Expert_8_5_GPU0 [label="Expert_L8_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_5_GPU1 [label="Expert_L8_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 8 - EP64_TP2
        Expert_8_6_GPU0 [label="Expert_L8_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_6_GPU1 [label="Expert_L8_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 8 - EP64_TP2
        Expert_8_7_GPU0 [label="Expert_L8_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_7_GPU1 [label="Expert_L8_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 8 - EP64_TP2
        Expert_8_8_GPU0 [label="Expert_L8_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_8_GPU1 [label="Expert_L8_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 8 - EP64_TP2
        Expert_8_9_GPU0 [label="Expert_L8_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_9_GPU1 [label="Expert_L8_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 8 - EP64_TP2
        Expert_8_10_GPU0 [label="Expert_L8_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_10_GPU1 [label="Expert_L8_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 8 - EP64_TP2
        Expert_8_11_GPU0 [label="Expert_L8_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_11_GPU1 [label="Expert_L8_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 8 - EP64_TP2
        Expert_8_12_GPU0 [label="Expert_L8_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_12_GPU1 [label="Expert_L8_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 8 - EP64_TP2
        Expert_8_13_GPU0 [label="Expert_L8_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_13_GPU1 [label="Expert_L8_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 8 - EP64_TP2
        Expert_8_14_GPU0 [label="Expert_L8_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_14_GPU1 [label="Expert_L8_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 8 - EP64_TP2
        Expert_8_15_GPU0 [label="Expert_L8_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_15_GPU1 [label="Expert_L8_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 8 - EP64_TP2
        Expert_8_16_GPU0 [label="Expert_L8_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_16_GPU1 [label="Expert_L8_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 8 - EP64_TP2
        Expert_8_17_GPU0 [label="Expert_L8_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_17_GPU1 [label="Expert_L8_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 8 - EP64_TP2
        Expert_8_18_GPU0 [label="Expert_L8_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_18_GPU1 [label="Expert_L8_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 8 - EP64_TP2
        Expert_8_19_GPU0 [label="Expert_L8_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_19_GPU1 [label="Expert_L8_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 8 - EP64_TP2
        Expert_8_20_GPU0 [label="Expert_L8_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_20_GPU1 [label="Expert_L8_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 8 - EP64_TP2
        Expert_8_21_GPU0 [label="Expert_L8_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_21_GPU1 [label="Expert_L8_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 8 - EP64_TP2
        Expert_8_22_GPU0 [label="Expert_L8_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_22_GPU1 [label="Expert_L8_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 8 - EP64_TP2
        Expert_8_23_GPU0 [label="Expert_L8_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_23_GPU1 [label="Expert_L8_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 8 - EP64_TP2
        Expert_8_24_GPU0 [label="Expert_L8_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_24_GPU1 [label="Expert_L8_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 8 - EP64_TP2
        Expert_8_25_GPU0 [label="Expert_L8_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_25_GPU1 [label="Expert_L8_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 8 - EP64_TP2
        Expert_8_26_GPU0 [label="Expert_L8_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_26_GPU1 [label="Expert_L8_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 8 - EP64_TP2
        Expert_8_27_GPU0 [label="Expert_L8_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_27_GPU1 [label="Expert_L8_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 8 - EP64_TP2
        Expert_8_28_GPU0 [label="Expert_L8_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_28_GPU1 [label="Expert_L8_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 8 - EP64_TP2
        Expert_8_29_GPU0 [label="Expert_L8_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_29_GPU1 [label="Expert_L8_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 8 - EP64_TP2
        Expert_8_30_GPU0 [label="Expert_L8_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_30_GPU1 [label="Expert_L8_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 8 - EP64_TP2
        Expert_8_31_GPU0 [label="Expert_L8_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_31_GPU1 [label="Expert_L8_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 8 - EP64_TP2
        Expert_8_32_GPU0 [label="Expert_L8_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_32_GPU1 [label="Expert_L8_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 8 - EP64_TP2
        Expert_8_33_GPU0 [label="Expert_L8_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_33_GPU1 [label="Expert_L8_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 8 - EP64_TP2
        Expert_8_34_GPU0 [label="Expert_L8_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_34_GPU1 [label="Expert_L8_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 8 - EP64_TP2
        Expert_8_35_GPU0 [label="Expert_L8_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_35_GPU1 [label="Expert_L8_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 8 - EP64_TP2
        Expert_8_36_GPU0 [label="Expert_L8_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_36_GPU1 [label="Expert_L8_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 8 - EP64_TP2
        Expert_8_37_GPU0 [label="Expert_L8_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_37_GPU1 [label="Expert_L8_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 8 - EP64_TP2
        Expert_8_38_GPU0 [label="Expert_L8_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_38_GPU1 [label="Expert_L8_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 8 - EP64_TP2
        Expert_8_39_GPU0 [label="Expert_L8_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_39_GPU1 [label="Expert_L8_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 8 - EP64_TP2
        Expert_8_40_GPU0 [label="Expert_L8_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_40_GPU1 [label="Expert_L8_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 8 - EP64_TP2
        Expert_8_41_GPU0 [label="Expert_L8_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_41_GPU1 [label="Expert_L8_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 8 - EP64_TP2
        Expert_8_42_GPU0 [label="Expert_L8_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_42_GPU1 [label="Expert_L8_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 8 - EP64_TP2
        Expert_8_43_GPU0 [label="Expert_L8_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_43_GPU1 [label="Expert_L8_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 8 - EP64_TP2
        Expert_8_44_GPU0 [label="Expert_L8_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_44_GPU1 [label="Expert_L8_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 8 - EP64_TP2
        Expert_8_45_GPU0 [label="Expert_L8_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_45_GPU1 [label="Expert_L8_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 8 - EP64_TP2
        Expert_8_46_GPU0 [label="Expert_L8_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_46_GPU1 [label="Expert_L8_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 8 - EP64_TP2
        Expert_8_47_GPU0 [label="Expert_L8_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_47_GPU1 [label="Expert_L8_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 8 - EP64_TP2
        Expert_8_48_GPU0 [label="Expert_L8_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_48_GPU1 [label="Expert_L8_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 8 - EP64_TP2
        Expert_8_49_GPU0 [label="Expert_L8_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_49_GPU1 [label="Expert_L8_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 8 - EP64_TP2
        Expert_8_50_GPU0 [label="Expert_L8_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_50_GPU1 [label="Expert_L8_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 8 - EP64_TP2
        Expert_8_51_GPU0 [label="Expert_L8_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_51_GPU1 [label="Expert_L8_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 8 - EP64_TP2
        Expert_8_52_GPU0 [label="Expert_L8_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_52_GPU1 [label="Expert_L8_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 8 - EP64_TP2
        Expert_8_53_GPU0 [label="Expert_L8_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_53_GPU1 [label="Expert_L8_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 8 - EP64_TP2
        Expert_8_54_GPU0 [label="Expert_L8_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_54_GPU1 [label="Expert_L8_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 8 - EP64_TP2
        Expert_8_55_GPU0 [label="Expert_L8_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_55_GPU1 [label="Expert_L8_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 8 - EP64_TP2
        Expert_8_56_GPU0 [label="Expert_L8_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_56_GPU1 [label="Expert_L8_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 8 - EP64_TP2
        Expert_8_57_GPU0 [label="Expert_L8_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_57_GPU1 [label="Expert_L8_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 8 - EP64_TP2
        Expert_8_58_GPU0 [label="Expert_L8_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_58_GPU1 [label="Expert_L8_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 8 - EP64_TP2
        Expert_8_59_GPU0 [label="Expert_L8_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_59_GPU1 [label="Expert_L8_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 8 - EP64_TP2
        Expert_8_60_GPU0 [label="Expert_L8_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_60_GPU1 [label="Expert_L8_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 8 - EP64_TP2
        Expert_8_61_GPU0 [label="Expert_L8_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_61_GPU1 [label="Expert_L8_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 8 - EP64_TP2
        Expert_8_62_GPU0 [label="Expert_L8_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_62_GPU1 [label="Expert_L8_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 8 - EP64_TP2
        Expert_8_63_GPU0 [label="Expert_L8_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_8_63_GPU1 [label="Expert_L8_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_8 [label="Expert_Route_Comm_L8\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_8 [label="Expert_Aggregate_L8\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_8 [label="FFN_GPU0_L8\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_8 [label="FFN_GPU1_L8\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_8 [label="FFN_Aggregate_L8\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_8 [label="LayerNorm_L8\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 9 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_9 {
        label="Layer 9 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_9 [label="MHA_Q_GPU0_L9\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_9 [label="MHA_K_GPU0_L9\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_9 [label="MHA_V_GPU0_L9\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_9 [label="MHA_Q_GPU1_L9\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_9 [label="MHA_K_GPU1_L9\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_9 [label="MHA_V_GPU1_L9\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_9 [label="Attention_Comp_GPU0_L9\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_9 [label="Attention_Comp_GPU1_L9\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_9 [label="Attention_Agg_L9\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_9 [label="Gate_Compute_L9\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_9 [label="Gate_Softmax_L9\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 9 - EP64_TP2
        Expert_9_0_GPU0 [label="Expert_L9_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_0_GPU1 [label="Expert_L9_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 9 - EP64_TP2
        Expert_9_1_GPU0 [label="Expert_L9_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_1_GPU1 [label="Expert_L9_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 9 - EP64_TP2
        Expert_9_2_GPU0 [label="Expert_L9_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_2_GPU1 [label="Expert_L9_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 9 - EP64_TP2
        Expert_9_3_GPU0 [label="Expert_L9_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_3_GPU1 [label="Expert_L9_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 9 - EP64_TP2
        Expert_9_4_GPU0 [label="Expert_L9_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_4_GPU1 [label="Expert_L9_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 9 - EP64_TP2
        Expert_9_5_GPU0 [label="Expert_L9_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_5_GPU1 [label="Expert_L9_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 9 - EP64_TP2
        Expert_9_6_GPU0 [label="Expert_L9_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_6_GPU1 [label="Expert_L9_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 9 - EP64_TP2
        Expert_9_7_GPU0 [label="Expert_L9_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_7_GPU1 [label="Expert_L9_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 9 - EP64_TP2
        Expert_9_8_GPU0 [label="Expert_L9_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_8_GPU1 [label="Expert_L9_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 9 - EP64_TP2
        Expert_9_9_GPU0 [label="Expert_L9_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_9_GPU1 [label="Expert_L9_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 9 - EP64_TP2
        Expert_9_10_GPU0 [label="Expert_L9_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_10_GPU1 [label="Expert_L9_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 9 - EP64_TP2
        Expert_9_11_GPU0 [label="Expert_L9_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_11_GPU1 [label="Expert_L9_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 9 - EP64_TP2
        Expert_9_12_GPU0 [label="Expert_L9_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_12_GPU1 [label="Expert_L9_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 9 - EP64_TP2
        Expert_9_13_GPU0 [label="Expert_L9_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_13_GPU1 [label="Expert_L9_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 9 - EP64_TP2
        Expert_9_14_GPU0 [label="Expert_L9_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_14_GPU1 [label="Expert_L9_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 9 - EP64_TP2
        Expert_9_15_GPU0 [label="Expert_L9_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_15_GPU1 [label="Expert_L9_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 9 - EP64_TP2
        Expert_9_16_GPU0 [label="Expert_L9_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_16_GPU1 [label="Expert_L9_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 9 - EP64_TP2
        Expert_9_17_GPU0 [label="Expert_L9_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_17_GPU1 [label="Expert_L9_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 9 - EP64_TP2
        Expert_9_18_GPU0 [label="Expert_L9_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_18_GPU1 [label="Expert_L9_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 9 - EP64_TP2
        Expert_9_19_GPU0 [label="Expert_L9_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_19_GPU1 [label="Expert_L9_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 9 - EP64_TP2
        Expert_9_20_GPU0 [label="Expert_L9_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_20_GPU1 [label="Expert_L9_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 9 - EP64_TP2
        Expert_9_21_GPU0 [label="Expert_L9_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_21_GPU1 [label="Expert_L9_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 9 - EP64_TP2
        Expert_9_22_GPU0 [label="Expert_L9_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_22_GPU1 [label="Expert_L9_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 9 - EP64_TP2
        Expert_9_23_GPU0 [label="Expert_L9_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_23_GPU1 [label="Expert_L9_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 9 - EP64_TP2
        Expert_9_24_GPU0 [label="Expert_L9_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_24_GPU1 [label="Expert_L9_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 9 - EP64_TP2
        Expert_9_25_GPU0 [label="Expert_L9_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_25_GPU1 [label="Expert_L9_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 9 - EP64_TP2
        Expert_9_26_GPU0 [label="Expert_L9_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_26_GPU1 [label="Expert_L9_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 9 - EP64_TP2
        Expert_9_27_GPU0 [label="Expert_L9_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_27_GPU1 [label="Expert_L9_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 9 - EP64_TP2
        Expert_9_28_GPU0 [label="Expert_L9_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_28_GPU1 [label="Expert_L9_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 9 - EP64_TP2
        Expert_9_29_GPU0 [label="Expert_L9_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_29_GPU1 [label="Expert_L9_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 9 - EP64_TP2
        Expert_9_30_GPU0 [label="Expert_L9_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_30_GPU1 [label="Expert_L9_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 9 - EP64_TP2
        Expert_9_31_GPU0 [label="Expert_L9_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_31_GPU1 [label="Expert_L9_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 9 - EP64_TP2
        Expert_9_32_GPU0 [label="Expert_L9_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_32_GPU1 [label="Expert_L9_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 9 - EP64_TP2
        Expert_9_33_GPU0 [label="Expert_L9_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_33_GPU1 [label="Expert_L9_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 9 - EP64_TP2
        Expert_9_34_GPU0 [label="Expert_L9_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_34_GPU1 [label="Expert_L9_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 9 - EP64_TP2
        Expert_9_35_GPU0 [label="Expert_L9_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_35_GPU1 [label="Expert_L9_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 9 - EP64_TP2
        Expert_9_36_GPU0 [label="Expert_L9_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_36_GPU1 [label="Expert_L9_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 9 - EP64_TP2
        Expert_9_37_GPU0 [label="Expert_L9_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_37_GPU1 [label="Expert_L9_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 9 - EP64_TP2
        Expert_9_38_GPU0 [label="Expert_L9_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_38_GPU1 [label="Expert_L9_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 9 - EP64_TP2
        Expert_9_39_GPU0 [label="Expert_L9_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_39_GPU1 [label="Expert_L9_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 9 - EP64_TP2
        Expert_9_40_GPU0 [label="Expert_L9_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_40_GPU1 [label="Expert_L9_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 9 - EP64_TP2
        Expert_9_41_GPU0 [label="Expert_L9_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_41_GPU1 [label="Expert_L9_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 9 - EP64_TP2
        Expert_9_42_GPU0 [label="Expert_L9_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_42_GPU1 [label="Expert_L9_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 9 - EP64_TP2
        Expert_9_43_GPU0 [label="Expert_L9_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_43_GPU1 [label="Expert_L9_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 9 - EP64_TP2
        Expert_9_44_GPU0 [label="Expert_L9_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_44_GPU1 [label="Expert_L9_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 9 - EP64_TP2
        Expert_9_45_GPU0 [label="Expert_L9_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_45_GPU1 [label="Expert_L9_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 9 - EP64_TP2
        Expert_9_46_GPU0 [label="Expert_L9_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_46_GPU1 [label="Expert_L9_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 9 - EP64_TP2
        Expert_9_47_GPU0 [label="Expert_L9_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_47_GPU1 [label="Expert_L9_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 9 - EP64_TP2
        Expert_9_48_GPU0 [label="Expert_L9_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_48_GPU1 [label="Expert_L9_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 9 - EP64_TP2
        Expert_9_49_GPU0 [label="Expert_L9_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_49_GPU1 [label="Expert_L9_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 9 - EP64_TP2
        Expert_9_50_GPU0 [label="Expert_L9_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_50_GPU1 [label="Expert_L9_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 9 - EP64_TP2
        Expert_9_51_GPU0 [label="Expert_L9_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_51_GPU1 [label="Expert_L9_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 9 - EP64_TP2
        Expert_9_52_GPU0 [label="Expert_L9_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_52_GPU1 [label="Expert_L9_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 9 - EP64_TP2
        Expert_9_53_GPU0 [label="Expert_L9_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_53_GPU1 [label="Expert_L9_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 9 - EP64_TP2
        Expert_9_54_GPU0 [label="Expert_L9_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_54_GPU1 [label="Expert_L9_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 9 - EP64_TP2
        Expert_9_55_GPU0 [label="Expert_L9_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_55_GPU1 [label="Expert_L9_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 9 - EP64_TP2
        Expert_9_56_GPU0 [label="Expert_L9_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_56_GPU1 [label="Expert_L9_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 9 - EP64_TP2
        Expert_9_57_GPU0 [label="Expert_L9_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_57_GPU1 [label="Expert_L9_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 9 - EP64_TP2
        Expert_9_58_GPU0 [label="Expert_L9_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_58_GPU1 [label="Expert_L9_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 9 - EP64_TP2
        Expert_9_59_GPU0 [label="Expert_L9_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_59_GPU1 [label="Expert_L9_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 9 - EP64_TP2
        Expert_9_60_GPU0 [label="Expert_L9_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_60_GPU1 [label="Expert_L9_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 9 - EP64_TP2
        Expert_9_61_GPU0 [label="Expert_L9_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_61_GPU1 [label="Expert_L9_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 9 - EP64_TP2
        Expert_9_62_GPU0 [label="Expert_L9_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_62_GPU1 [label="Expert_L9_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 9 - EP64_TP2
        Expert_9_63_GPU0 [label="Expert_L9_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_9_63_GPU1 [label="Expert_L9_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_9 [label="Expert_Route_Comm_L9\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_9 [label="Expert_Aggregate_L9\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_9 [label="FFN_GPU0_L9\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_9 [label="FFN_GPU1_L9\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_9 [label="FFN_Aggregate_L9\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_9 [label="LayerNorm_L9\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 10 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_10 {
        label="Layer 10 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_10 [label="MHA_Q_GPU0_L10\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_10 [label="MHA_K_GPU0_L10\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_10 [label="MHA_V_GPU0_L10\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_10 [label="MHA_Q_GPU1_L10\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_10 [label="MHA_K_GPU1_L10\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_10 [label="MHA_V_GPU1_L10\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_10 [label="Attention_Comp_GPU0_L10\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_10 [label="Attention_Comp_GPU1_L10\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_10 [label="Attention_Agg_L10\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_10 [label="Gate_Compute_L10\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_10 [label="Gate_Softmax_L10\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 10 - EP64_TP2
        Expert_10_0_GPU0 [label="Expert_L10_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_0_GPU1 [label="Expert_L10_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 10 - EP64_TP2
        Expert_10_1_GPU0 [label="Expert_L10_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_1_GPU1 [label="Expert_L10_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 10 - EP64_TP2
        Expert_10_2_GPU0 [label="Expert_L10_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_2_GPU1 [label="Expert_L10_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 10 - EP64_TP2
        Expert_10_3_GPU0 [label="Expert_L10_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_3_GPU1 [label="Expert_L10_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 10 - EP64_TP2
        Expert_10_4_GPU0 [label="Expert_L10_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_4_GPU1 [label="Expert_L10_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 10 - EP64_TP2
        Expert_10_5_GPU0 [label="Expert_L10_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_5_GPU1 [label="Expert_L10_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 10 - EP64_TP2
        Expert_10_6_GPU0 [label="Expert_L10_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_6_GPU1 [label="Expert_L10_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 10 - EP64_TP2
        Expert_10_7_GPU0 [label="Expert_L10_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_7_GPU1 [label="Expert_L10_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 10 - EP64_TP2
        Expert_10_8_GPU0 [label="Expert_L10_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_8_GPU1 [label="Expert_L10_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 10 - EP64_TP2
        Expert_10_9_GPU0 [label="Expert_L10_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_9_GPU1 [label="Expert_L10_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 10 - EP64_TP2
        Expert_10_10_GPU0 [label="Expert_L10_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_10_GPU1 [label="Expert_L10_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 10 - EP64_TP2
        Expert_10_11_GPU0 [label="Expert_L10_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_11_GPU1 [label="Expert_L10_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 10 - EP64_TP2
        Expert_10_12_GPU0 [label="Expert_L10_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_12_GPU1 [label="Expert_L10_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 10 - EP64_TP2
        Expert_10_13_GPU0 [label="Expert_L10_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_13_GPU1 [label="Expert_L10_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 10 - EP64_TP2
        Expert_10_14_GPU0 [label="Expert_L10_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_14_GPU1 [label="Expert_L10_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 10 - EP64_TP2
        Expert_10_15_GPU0 [label="Expert_L10_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_15_GPU1 [label="Expert_L10_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 10 - EP64_TP2
        Expert_10_16_GPU0 [label="Expert_L10_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_16_GPU1 [label="Expert_L10_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 10 - EP64_TP2
        Expert_10_17_GPU0 [label="Expert_L10_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_17_GPU1 [label="Expert_L10_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 10 - EP64_TP2
        Expert_10_18_GPU0 [label="Expert_L10_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_18_GPU1 [label="Expert_L10_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 10 - EP64_TP2
        Expert_10_19_GPU0 [label="Expert_L10_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_19_GPU1 [label="Expert_L10_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 10 - EP64_TP2
        Expert_10_20_GPU0 [label="Expert_L10_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_20_GPU1 [label="Expert_L10_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 10 - EP64_TP2
        Expert_10_21_GPU0 [label="Expert_L10_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_21_GPU1 [label="Expert_L10_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 10 - EP64_TP2
        Expert_10_22_GPU0 [label="Expert_L10_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_22_GPU1 [label="Expert_L10_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 10 - EP64_TP2
        Expert_10_23_GPU0 [label="Expert_L10_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_23_GPU1 [label="Expert_L10_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 10 - EP64_TP2
        Expert_10_24_GPU0 [label="Expert_L10_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_24_GPU1 [label="Expert_L10_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 10 - EP64_TP2
        Expert_10_25_GPU0 [label="Expert_L10_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_25_GPU1 [label="Expert_L10_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 10 - EP64_TP2
        Expert_10_26_GPU0 [label="Expert_L10_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_26_GPU1 [label="Expert_L10_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 10 - EP64_TP2
        Expert_10_27_GPU0 [label="Expert_L10_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_27_GPU1 [label="Expert_L10_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 10 - EP64_TP2
        Expert_10_28_GPU0 [label="Expert_L10_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_28_GPU1 [label="Expert_L10_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 10 - EP64_TP2
        Expert_10_29_GPU0 [label="Expert_L10_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_29_GPU1 [label="Expert_L10_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 10 - EP64_TP2
        Expert_10_30_GPU0 [label="Expert_L10_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_30_GPU1 [label="Expert_L10_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 10 - EP64_TP2
        Expert_10_31_GPU0 [label="Expert_L10_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_31_GPU1 [label="Expert_L10_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 10 - EP64_TP2
        Expert_10_32_GPU0 [label="Expert_L10_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_32_GPU1 [label="Expert_L10_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 10 - EP64_TP2
        Expert_10_33_GPU0 [label="Expert_L10_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_33_GPU1 [label="Expert_L10_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 10 - EP64_TP2
        Expert_10_34_GPU0 [label="Expert_L10_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_34_GPU1 [label="Expert_L10_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 10 - EP64_TP2
        Expert_10_35_GPU0 [label="Expert_L10_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_35_GPU1 [label="Expert_L10_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 10 - EP64_TP2
        Expert_10_36_GPU0 [label="Expert_L10_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_36_GPU1 [label="Expert_L10_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 10 - EP64_TP2
        Expert_10_37_GPU0 [label="Expert_L10_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_37_GPU1 [label="Expert_L10_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 10 - EP64_TP2
        Expert_10_38_GPU0 [label="Expert_L10_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_38_GPU1 [label="Expert_L10_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 10 - EP64_TP2
        Expert_10_39_GPU0 [label="Expert_L10_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_39_GPU1 [label="Expert_L10_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 10 - EP64_TP2
        Expert_10_40_GPU0 [label="Expert_L10_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_40_GPU1 [label="Expert_L10_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 10 - EP64_TP2
        Expert_10_41_GPU0 [label="Expert_L10_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_41_GPU1 [label="Expert_L10_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 10 - EP64_TP2
        Expert_10_42_GPU0 [label="Expert_L10_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_42_GPU1 [label="Expert_L10_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 10 - EP64_TP2
        Expert_10_43_GPU0 [label="Expert_L10_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_43_GPU1 [label="Expert_L10_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 10 - EP64_TP2
        Expert_10_44_GPU0 [label="Expert_L10_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_44_GPU1 [label="Expert_L10_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 10 - EP64_TP2
        Expert_10_45_GPU0 [label="Expert_L10_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_45_GPU1 [label="Expert_L10_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 10 - EP64_TP2
        Expert_10_46_GPU0 [label="Expert_L10_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_46_GPU1 [label="Expert_L10_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 10 - EP64_TP2
        Expert_10_47_GPU0 [label="Expert_L10_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_47_GPU1 [label="Expert_L10_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 10 - EP64_TP2
        Expert_10_48_GPU0 [label="Expert_L10_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_48_GPU1 [label="Expert_L10_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 10 - EP64_TP2
        Expert_10_49_GPU0 [label="Expert_L10_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_49_GPU1 [label="Expert_L10_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 10 - EP64_TP2
        Expert_10_50_GPU0 [label="Expert_L10_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_50_GPU1 [label="Expert_L10_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 10 - EP64_TP2
        Expert_10_51_GPU0 [label="Expert_L10_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_51_GPU1 [label="Expert_L10_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 10 - EP64_TP2
        Expert_10_52_GPU0 [label="Expert_L10_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_52_GPU1 [label="Expert_L10_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 10 - EP64_TP2
        Expert_10_53_GPU0 [label="Expert_L10_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_53_GPU1 [label="Expert_L10_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 10 - EP64_TP2
        Expert_10_54_GPU0 [label="Expert_L10_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_54_GPU1 [label="Expert_L10_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 10 - EP64_TP2
        Expert_10_55_GPU0 [label="Expert_L10_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_55_GPU1 [label="Expert_L10_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 10 - EP64_TP2
        Expert_10_56_GPU0 [label="Expert_L10_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_56_GPU1 [label="Expert_L10_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 10 - EP64_TP2
        Expert_10_57_GPU0 [label="Expert_L10_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_57_GPU1 [label="Expert_L10_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 10 - EP64_TP2
        Expert_10_58_GPU0 [label="Expert_L10_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_58_GPU1 [label="Expert_L10_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 10 - EP64_TP2
        Expert_10_59_GPU0 [label="Expert_L10_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_59_GPU1 [label="Expert_L10_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 10 - EP64_TP2
        Expert_10_60_GPU0 [label="Expert_L10_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_60_GPU1 [label="Expert_L10_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 10 - EP64_TP2
        Expert_10_61_GPU0 [label="Expert_L10_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_61_GPU1 [label="Expert_L10_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 10 - EP64_TP2
        Expert_10_62_GPU0 [label="Expert_L10_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_62_GPU1 [label="Expert_L10_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 10 - EP64_TP2
        Expert_10_63_GPU0 [label="Expert_L10_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_10_63_GPU1 [label="Expert_L10_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_10 [label="Expert_Route_Comm_L10\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_10 [label="Expert_Aggregate_L10\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_10 [label="FFN_GPU0_L10\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_10 [label="FFN_GPU1_L10\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_10 [label="FFN_Aggregate_L10\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_10 [label="LayerNorm_L10\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 11 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_11 {
        label="Layer 11 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_11 [label="MHA_Q_GPU0_L11\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_11 [label="MHA_K_GPU0_L11\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_11 [label="MHA_V_GPU0_L11\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_11 [label="MHA_Q_GPU1_L11\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_11 [label="MHA_K_GPU1_L11\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_11 [label="MHA_V_GPU1_L11\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_11 [label="Attention_Comp_GPU0_L11\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_11 [label="Attention_Comp_GPU1_L11\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_11 [label="Attention_Agg_L11\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_11 [label="Gate_Compute_L11\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_11 [label="Gate_Softmax_L11\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 11 - EP64_TP2
        Expert_11_0_GPU0 [label="Expert_L11_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_0_GPU1 [label="Expert_L11_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 11 - EP64_TP2
        Expert_11_1_GPU0 [label="Expert_L11_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_1_GPU1 [label="Expert_L11_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 11 - EP64_TP2
        Expert_11_2_GPU0 [label="Expert_L11_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_2_GPU1 [label="Expert_L11_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 11 - EP64_TP2
        Expert_11_3_GPU0 [label="Expert_L11_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_3_GPU1 [label="Expert_L11_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 11 - EP64_TP2
        Expert_11_4_GPU0 [label="Expert_L11_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_4_GPU1 [label="Expert_L11_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 11 - EP64_TP2
        Expert_11_5_GPU0 [label="Expert_L11_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_5_GPU1 [label="Expert_L11_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 11 - EP64_TP2
        Expert_11_6_GPU0 [label="Expert_L11_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_6_GPU1 [label="Expert_L11_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 11 - EP64_TP2
        Expert_11_7_GPU0 [label="Expert_L11_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_7_GPU1 [label="Expert_L11_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 11 - EP64_TP2
        Expert_11_8_GPU0 [label="Expert_L11_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_8_GPU1 [label="Expert_L11_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 11 - EP64_TP2
        Expert_11_9_GPU0 [label="Expert_L11_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_9_GPU1 [label="Expert_L11_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 11 - EP64_TP2
        Expert_11_10_GPU0 [label="Expert_L11_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_10_GPU1 [label="Expert_L11_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 11 - EP64_TP2
        Expert_11_11_GPU0 [label="Expert_L11_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_11_GPU1 [label="Expert_L11_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 11 - EP64_TP2
        Expert_11_12_GPU0 [label="Expert_L11_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_12_GPU1 [label="Expert_L11_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 11 - EP64_TP2
        Expert_11_13_GPU0 [label="Expert_L11_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_13_GPU1 [label="Expert_L11_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 11 - EP64_TP2
        Expert_11_14_GPU0 [label="Expert_L11_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_14_GPU1 [label="Expert_L11_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 11 - EP64_TP2
        Expert_11_15_GPU0 [label="Expert_L11_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_15_GPU1 [label="Expert_L11_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 11 - EP64_TP2
        Expert_11_16_GPU0 [label="Expert_L11_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_16_GPU1 [label="Expert_L11_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 11 - EP64_TP2
        Expert_11_17_GPU0 [label="Expert_L11_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_17_GPU1 [label="Expert_L11_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 11 - EP64_TP2
        Expert_11_18_GPU0 [label="Expert_L11_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_18_GPU1 [label="Expert_L11_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 11 - EP64_TP2
        Expert_11_19_GPU0 [label="Expert_L11_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_19_GPU1 [label="Expert_L11_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 11 - EP64_TP2
        Expert_11_20_GPU0 [label="Expert_L11_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_20_GPU1 [label="Expert_L11_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 11 - EP64_TP2
        Expert_11_21_GPU0 [label="Expert_L11_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_21_GPU1 [label="Expert_L11_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 11 - EP64_TP2
        Expert_11_22_GPU0 [label="Expert_L11_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_22_GPU1 [label="Expert_L11_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 11 - EP64_TP2
        Expert_11_23_GPU0 [label="Expert_L11_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_23_GPU1 [label="Expert_L11_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 11 - EP64_TP2
        Expert_11_24_GPU0 [label="Expert_L11_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_24_GPU1 [label="Expert_L11_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 11 - EP64_TP2
        Expert_11_25_GPU0 [label="Expert_L11_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_25_GPU1 [label="Expert_L11_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 11 - EP64_TP2
        Expert_11_26_GPU0 [label="Expert_L11_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_26_GPU1 [label="Expert_L11_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 11 - EP64_TP2
        Expert_11_27_GPU0 [label="Expert_L11_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_27_GPU1 [label="Expert_L11_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 11 - EP64_TP2
        Expert_11_28_GPU0 [label="Expert_L11_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_28_GPU1 [label="Expert_L11_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 11 - EP64_TP2
        Expert_11_29_GPU0 [label="Expert_L11_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_29_GPU1 [label="Expert_L11_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 11 - EP64_TP2
        Expert_11_30_GPU0 [label="Expert_L11_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_30_GPU1 [label="Expert_L11_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 11 - EP64_TP2
        Expert_11_31_GPU0 [label="Expert_L11_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_31_GPU1 [label="Expert_L11_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 11 - EP64_TP2
        Expert_11_32_GPU0 [label="Expert_L11_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_32_GPU1 [label="Expert_L11_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 11 - EP64_TP2
        Expert_11_33_GPU0 [label="Expert_L11_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_33_GPU1 [label="Expert_L11_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 11 - EP64_TP2
        Expert_11_34_GPU0 [label="Expert_L11_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_34_GPU1 [label="Expert_L11_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 11 - EP64_TP2
        Expert_11_35_GPU0 [label="Expert_L11_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_35_GPU1 [label="Expert_L11_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 11 - EP64_TP2
        Expert_11_36_GPU0 [label="Expert_L11_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_36_GPU1 [label="Expert_L11_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 11 - EP64_TP2
        Expert_11_37_GPU0 [label="Expert_L11_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_37_GPU1 [label="Expert_L11_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 11 - EP64_TP2
        Expert_11_38_GPU0 [label="Expert_L11_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_38_GPU1 [label="Expert_L11_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 11 - EP64_TP2
        Expert_11_39_GPU0 [label="Expert_L11_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_39_GPU1 [label="Expert_L11_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 11 - EP64_TP2
        Expert_11_40_GPU0 [label="Expert_L11_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_40_GPU1 [label="Expert_L11_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 11 - EP64_TP2
        Expert_11_41_GPU0 [label="Expert_L11_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_41_GPU1 [label="Expert_L11_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 11 - EP64_TP2
        Expert_11_42_GPU0 [label="Expert_L11_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_42_GPU1 [label="Expert_L11_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 11 - EP64_TP2
        Expert_11_43_GPU0 [label="Expert_L11_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_43_GPU1 [label="Expert_L11_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 11 - EP64_TP2
        Expert_11_44_GPU0 [label="Expert_L11_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_44_GPU1 [label="Expert_L11_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 11 - EP64_TP2
        Expert_11_45_GPU0 [label="Expert_L11_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_45_GPU1 [label="Expert_L11_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 11 - EP64_TP2
        Expert_11_46_GPU0 [label="Expert_L11_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_46_GPU1 [label="Expert_L11_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 11 - EP64_TP2
        Expert_11_47_GPU0 [label="Expert_L11_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_47_GPU1 [label="Expert_L11_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 11 - EP64_TP2
        Expert_11_48_GPU0 [label="Expert_L11_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_48_GPU1 [label="Expert_L11_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 11 - EP64_TP2
        Expert_11_49_GPU0 [label="Expert_L11_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_49_GPU1 [label="Expert_L11_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 11 - EP64_TP2
        Expert_11_50_GPU0 [label="Expert_L11_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_50_GPU1 [label="Expert_L11_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 11 - EP64_TP2
        Expert_11_51_GPU0 [label="Expert_L11_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_51_GPU1 [label="Expert_L11_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 11 - EP64_TP2
        Expert_11_52_GPU0 [label="Expert_L11_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_52_GPU1 [label="Expert_L11_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 11 - EP64_TP2
        Expert_11_53_GPU0 [label="Expert_L11_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_53_GPU1 [label="Expert_L11_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 11 - EP64_TP2
        Expert_11_54_GPU0 [label="Expert_L11_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_54_GPU1 [label="Expert_L11_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 11 - EP64_TP2
        Expert_11_55_GPU0 [label="Expert_L11_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_55_GPU1 [label="Expert_L11_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 11 - EP64_TP2
        Expert_11_56_GPU0 [label="Expert_L11_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_56_GPU1 [label="Expert_L11_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 11 - EP64_TP2
        Expert_11_57_GPU0 [label="Expert_L11_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_57_GPU1 [label="Expert_L11_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 11 - EP64_TP2
        Expert_11_58_GPU0 [label="Expert_L11_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_58_GPU1 [label="Expert_L11_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 11 - EP64_TP2
        Expert_11_59_GPU0 [label="Expert_L11_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_59_GPU1 [label="Expert_L11_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 11 - EP64_TP2
        Expert_11_60_GPU0 [label="Expert_L11_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_60_GPU1 [label="Expert_L11_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 11 - EP64_TP2
        Expert_11_61_GPU0 [label="Expert_L11_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_61_GPU1 [label="Expert_L11_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 11 - EP64_TP2
        Expert_11_62_GPU0 [label="Expert_L11_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_62_GPU1 [label="Expert_L11_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 11 - EP64_TP2
        Expert_11_63_GPU0 [label="Expert_L11_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_11_63_GPU1 [label="Expert_L11_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_11 [label="Expert_Route_Comm_L11\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_11 [label="Expert_Aggregate_L11\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_11 [label="FFN_GPU0_L11\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_11 [label="FFN_GPU1_L11\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_11 [label="FFN_Aggregate_L11\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_11 [label="LayerNorm_L11\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 12 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_12 {
        label="Layer 12 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_12 [label="MHA_Q_GPU0_L12\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_12 [label="MHA_K_GPU0_L12\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_12 [label="MHA_V_GPU0_L12\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_12 [label="MHA_Q_GPU1_L12\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_12 [label="MHA_K_GPU1_L12\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_12 [label="MHA_V_GPU1_L12\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_12 [label="Attention_Comp_GPU0_L12\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_12 [label="Attention_Comp_GPU1_L12\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_12 [label="Attention_Agg_L12\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_12 [label="Gate_Compute_L12\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_12 [label="Gate_Softmax_L12\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 12 - EP64_TP2
        Expert_12_0_GPU0 [label="Expert_L12_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_0_GPU1 [label="Expert_L12_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 12 - EP64_TP2
        Expert_12_1_GPU0 [label="Expert_L12_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_1_GPU1 [label="Expert_L12_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 12 - EP64_TP2
        Expert_12_2_GPU0 [label="Expert_L12_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_2_GPU1 [label="Expert_L12_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 12 - EP64_TP2
        Expert_12_3_GPU0 [label="Expert_L12_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_3_GPU1 [label="Expert_L12_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 12 - EP64_TP2
        Expert_12_4_GPU0 [label="Expert_L12_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_4_GPU1 [label="Expert_L12_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 12 - EP64_TP2
        Expert_12_5_GPU0 [label="Expert_L12_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_5_GPU1 [label="Expert_L12_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 12 - EP64_TP2
        Expert_12_6_GPU0 [label="Expert_L12_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_6_GPU1 [label="Expert_L12_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 12 - EP64_TP2
        Expert_12_7_GPU0 [label="Expert_L12_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_7_GPU1 [label="Expert_L12_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 12 - EP64_TP2
        Expert_12_8_GPU0 [label="Expert_L12_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_8_GPU1 [label="Expert_L12_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 12 - EP64_TP2
        Expert_12_9_GPU0 [label="Expert_L12_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_9_GPU1 [label="Expert_L12_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 12 - EP64_TP2
        Expert_12_10_GPU0 [label="Expert_L12_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_10_GPU1 [label="Expert_L12_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 12 - EP64_TP2
        Expert_12_11_GPU0 [label="Expert_L12_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_11_GPU1 [label="Expert_L12_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 12 - EP64_TP2
        Expert_12_12_GPU0 [label="Expert_L12_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_12_GPU1 [label="Expert_L12_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 12 - EP64_TP2
        Expert_12_13_GPU0 [label="Expert_L12_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_13_GPU1 [label="Expert_L12_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 12 - EP64_TP2
        Expert_12_14_GPU0 [label="Expert_L12_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_14_GPU1 [label="Expert_L12_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 12 - EP64_TP2
        Expert_12_15_GPU0 [label="Expert_L12_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_15_GPU1 [label="Expert_L12_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 12 - EP64_TP2
        Expert_12_16_GPU0 [label="Expert_L12_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_16_GPU1 [label="Expert_L12_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 12 - EP64_TP2
        Expert_12_17_GPU0 [label="Expert_L12_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_17_GPU1 [label="Expert_L12_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 12 - EP64_TP2
        Expert_12_18_GPU0 [label="Expert_L12_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_18_GPU1 [label="Expert_L12_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 12 - EP64_TP2
        Expert_12_19_GPU0 [label="Expert_L12_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_19_GPU1 [label="Expert_L12_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 12 - EP64_TP2
        Expert_12_20_GPU0 [label="Expert_L12_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_20_GPU1 [label="Expert_L12_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 12 - EP64_TP2
        Expert_12_21_GPU0 [label="Expert_L12_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_21_GPU1 [label="Expert_L12_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 12 - EP64_TP2
        Expert_12_22_GPU0 [label="Expert_L12_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_22_GPU1 [label="Expert_L12_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 12 - EP64_TP2
        Expert_12_23_GPU0 [label="Expert_L12_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_23_GPU1 [label="Expert_L12_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 12 - EP64_TP2
        Expert_12_24_GPU0 [label="Expert_L12_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_24_GPU1 [label="Expert_L12_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 12 - EP64_TP2
        Expert_12_25_GPU0 [label="Expert_L12_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_25_GPU1 [label="Expert_L12_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 12 - EP64_TP2
        Expert_12_26_GPU0 [label="Expert_L12_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_26_GPU1 [label="Expert_L12_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 12 - EP64_TP2
        Expert_12_27_GPU0 [label="Expert_L12_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_27_GPU1 [label="Expert_L12_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 12 - EP64_TP2
        Expert_12_28_GPU0 [label="Expert_L12_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_28_GPU1 [label="Expert_L12_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 12 - EP64_TP2
        Expert_12_29_GPU0 [label="Expert_L12_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_29_GPU1 [label="Expert_L12_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 12 - EP64_TP2
        Expert_12_30_GPU0 [label="Expert_L12_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_30_GPU1 [label="Expert_L12_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 12 - EP64_TP2
        Expert_12_31_GPU0 [label="Expert_L12_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_31_GPU1 [label="Expert_L12_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 12 - EP64_TP2
        Expert_12_32_GPU0 [label="Expert_L12_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_32_GPU1 [label="Expert_L12_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 12 - EP64_TP2
        Expert_12_33_GPU0 [label="Expert_L12_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_33_GPU1 [label="Expert_L12_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 12 - EP64_TP2
        Expert_12_34_GPU0 [label="Expert_L12_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_34_GPU1 [label="Expert_L12_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 12 - EP64_TP2
        Expert_12_35_GPU0 [label="Expert_L12_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_35_GPU1 [label="Expert_L12_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 12 - EP64_TP2
        Expert_12_36_GPU0 [label="Expert_L12_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_36_GPU1 [label="Expert_L12_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 12 - EP64_TP2
        Expert_12_37_GPU0 [label="Expert_L12_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_37_GPU1 [label="Expert_L12_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 12 - EP64_TP2
        Expert_12_38_GPU0 [label="Expert_L12_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_38_GPU1 [label="Expert_L12_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 12 - EP64_TP2
        Expert_12_39_GPU0 [label="Expert_L12_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_39_GPU1 [label="Expert_L12_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 12 - EP64_TP2
        Expert_12_40_GPU0 [label="Expert_L12_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_40_GPU1 [label="Expert_L12_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 12 - EP64_TP2
        Expert_12_41_GPU0 [label="Expert_L12_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_41_GPU1 [label="Expert_L12_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 12 - EP64_TP2
        Expert_12_42_GPU0 [label="Expert_L12_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_42_GPU1 [label="Expert_L12_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 12 - EP64_TP2
        Expert_12_43_GPU0 [label="Expert_L12_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_43_GPU1 [label="Expert_L12_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 12 - EP64_TP2
        Expert_12_44_GPU0 [label="Expert_L12_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_44_GPU1 [label="Expert_L12_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 12 - EP64_TP2
        Expert_12_45_GPU0 [label="Expert_L12_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_45_GPU1 [label="Expert_L12_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 12 - EP64_TP2
        Expert_12_46_GPU0 [label="Expert_L12_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_46_GPU1 [label="Expert_L12_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 12 - EP64_TP2
        Expert_12_47_GPU0 [label="Expert_L12_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_47_GPU1 [label="Expert_L12_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 12 - EP64_TP2
        Expert_12_48_GPU0 [label="Expert_L12_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_48_GPU1 [label="Expert_L12_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 12 - EP64_TP2
        Expert_12_49_GPU0 [label="Expert_L12_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_49_GPU1 [label="Expert_L12_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 12 - EP64_TP2
        Expert_12_50_GPU0 [label="Expert_L12_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_50_GPU1 [label="Expert_L12_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 12 - EP64_TP2
        Expert_12_51_GPU0 [label="Expert_L12_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_51_GPU1 [label="Expert_L12_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 12 - EP64_TP2
        Expert_12_52_GPU0 [label="Expert_L12_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_52_GPU1 [label="Expert_L12_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 12 - EP64_TP2
        Expert_12_53_GPU0 [label="Expert_L12_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_53_GPU1 [label="Expert_L12_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 12 - EP64_TP2
        Expert_12_54_GPU0 [label="Expert_L12_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_54_GPU1 [label="Expert_L12_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 12 - EP64_TP2
        Expert_12_55_GPU0 [label="Expert_L12_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_55_GPU1 [label="Expert_L12_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 12 - EP64_TP2
        Expert_12_56_GPU0 [label="Expert_L12_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_56_GPU1 [label="Expert_L12_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 12 - EP64_TP2
        Expert_12_57_GPU0 [label="Expert_L12_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_57_GPU1 [label="Expert_L12_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 12 - EP64_TP2
        Expert_12_58_GPU0 [label="Expert_L12_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_58_GPU1 [label="Expert_L12_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 12 - EP64_TP2
        Expert_12_59_GPU0 [label="Expert_L12_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_59_GPU1 [label="Expert_L12_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 12 - EP64_TP2
        Expert_12_60_GPU0 [label="Expert_L12_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_60_GPU1 [label="Expert_L12_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 12 - EP64_TP2
        Expert_12_61_GPU0 [label="Expert_L12_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_61_GPU1 [label="Expert_L12_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 12 - EP64_TP2
        Expert_12_62_GPU0 [label="Expert_L12_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_62_GPU1 [label="Expert_L12_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 12 - EP64_TP2
        Expert_12_63_GPU0 [label="Expert_L12_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_12_63_GPU1 [label="Expert_L12_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_12 [label="Expert_Route_Comm_L12\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_12 [label="Expert_Aggregate_L12\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_12 [label="FFN_GPU0_L12\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_12 [label="FFN_GPU1_L12\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_12 [label="FFN_Aggregate_L12\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_12 [label="LayerNorm_L12\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 13 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_13 {
        label="Layer 13 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_13 [label="MHA_Q_GPU0_L13\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_13 [label="MHA_K_GPU0_L13\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_13 [label="MHA_V_GPU0_L13\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_13 [label="MHA_Q_GPU1_L13\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_13 [label="MHA_K_GPU1_L13\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_13 [label="MHA_V_GPU1_L13\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_13 [label="Attention_Comp_GPU0_L13\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_13 [label="Attention_Comp_GPU1_L13\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_13 [label="Attention_Agg_L13\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_13 [label="Gate_Compute_L13\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_13 [label="Gate_Softmax_L13\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 13 - EP64_TP2
        Expert_13_0_GPU0 [label="Expert_L13_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_0_GPU1 [label="Expert_L13_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 13 - EP64_TP2
        Expert_13_1_GPU0 [label="Expert_L13_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_1_GPU1 [label="Expert_L13_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 13 - EP64_TP2
        Expert_13_2_GPU0 [label="Expert_L13_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_2_GPU1 [label="Expert_L13_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 13 - EP64_TP2
        Expert_13_3_GPU0 [label="Expert_L13_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_3_GPU1 [label="Expert_L13_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 13 - EP64_TP2
        Expert_13_4_GPU0 [label="Expert_L13_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_4_GPU1 [label="Expert_L13_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 13 - EP64_TP2
        Expert_13_5_GPU0 [label="Expert_L13_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_5_GPU1 [label="Expert_L13_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 13 - EP64_TP2
        Expert_13_6_GPU0 [label="Expert_L13_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_6_GPU1 [label="Expert_L13_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 13 - EP64_TP2
        Expert_13_7_GPU0 [label="Expert_L13_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_7_GPU1 [label="Expert_L13_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 13 - EP64_TP2
        Expert_13_8_GPU0 [label="Expert_L13_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_8_GPU1 [label="Expert_L13_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 13 - EP64_TP2
        Expert_13_9_GPU0 [label="Expert_L13_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_9_GPU1 [label="Expert_L13_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 13 - EP64_TP2
        Expert_13_10_GPU0 [label="Expert_L13_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_10_GPU1 [label="Expert_L13_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 13 - EP64_TP2
        Expert_13_11_GPU0 [label="Expert_L13_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_11_GPU1 [label="Expert_L13_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 13 - EP64_TP2
        Expert_13_12_GPU0 [label="Expert_L13_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_12_GPU1 [label="Expert_L13_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 13 - EP64_TP2
        Expert_13_13_GPU0 [label="Expert_L13_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_13_GPU1 [label="Expert_L13_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 13 - EP64_TP2
        Expert_13_14_GPU0 [label="Expert_L13_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_14_GPU1 [label="Expert_L13_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 13 - EP64_TP2
        Expert_13_15_GPU0 [label="Expert_L13_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_15_GPU1 [label="Expert_L13_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 13 - EP64_TP2
        Expert_13_16_GPU0 [label="Expert_L13_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_16_GPU1 [label="Expert_L13_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 13 - EP64_TP2
        Expert_13_17_GPU0 [label="Expert_L13_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_17_GPU1 [label="Expert_L13_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 13 - EP64_TP2
        Expert_13_18_GPU0 [label="Expert_L13_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_18_GPU1 [label="Expert_L13_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 13 - EP64_TP2
        Expert_13_19_GPU0 [label="Expert_L13_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_19_GPU1 [label="Expert_L13_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 13 - EP64_TP2
        Expert_13_20_GPU0 [label="Expert_L13_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_20_GPU1 [label="Expert_L13_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 13 - EP64_TP2
        Expert_13_21_GPU0 [label="Expert_L13_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_21_GPU1 [label="Expert_L13_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 13 - EP64_TP2
        Expert_13_22_GPU0 [label="Expert_L13_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_22_GPU1 [label="Expert_L13_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 13 - EP64_TP2
        Expert_13_23_GPU0 [label="Expert_L13_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_23_GPU1 [label="Expert_L13_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 13 - EP64_TP2
        Expert_13_24_GPU0 [label="Expert_L13_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_24_GPU1 [label="Expert_L13_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 13 - EP64_TP2
        Expert_13_25_GPU0 [label="Expert_L13_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_25_GPU1 [label="Expert_L13_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 13 - EP64_TP2
        Expert_13_26_GPU0 [label="Expert_L13_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_26_GPU1 [label="Expert_L13_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 13 - EP64_TP2
        Expert_13_27_GPU0 [label="Expert_L13_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_27_GPU1 [label="Expert_L13_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 13 - EP64_TP2
        Expert_13_28_GPU0 [label="Expert_L13_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_28_GPU1 [label="Expert_L13_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 13 - EP64_TP2
        Expert_13_29_GPU0 [label="Expert_L13_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_29_GPU1 [label="Expert_L13_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 13 - EP64_TP2
        Expert_13_30_GPU0 [label="Expert_L13_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_30_GPU1 [label="Expert_L13_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 13 - EP64_TP2
        Expert_13_31_GPU0 [label="Expert_L13_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_31_GPU1 [label="Expert_L13_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 13 - EP64_TP2
        Expert_13_32_GPU0 [label="Expert_L13_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_32_GPU1 [label="Expert_L13_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 13 - EP64_TP2
        Expert_13_33_GPU0 [label="Expert_L13_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_33_GPU1 [label="Expert_L13_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 13 - EP64_TP2
        Expert_13_34_GPU0 [label="Expert_L13_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_34_GPU1 [label="Expert_L13_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 13 - EP64_TP2
        Expert_13_35_GPU0 [label="Expert_L13_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_35_GPU1 [label="Expert_L13_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 13 - EP64_TP2
        Expert_13_36_GPU0 [label="Expert_L13_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_36_GPU1 [label="Expert_L13_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 13 - EP64_TP2
        Expert_13_37_GPU0 [label="Expert_L13_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_37_GPU1 [label="Expert_L13_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 13 - EP64_TP2
        Expert_13_38_GPU0 [label="Expert_L13_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_38_GPU1 [label="Expert_L13_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 13 - EP64_TP2
        Expert_13_39_GPU0 [label="Expert_L13_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_39_GPU1 [label="Expert_L13_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 13 - EP64_TP2
        Expert_13_40_GPU0 [label="Expert_L13_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_40_GPU1 [label="Expert_L13_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 13 - EP64_TP2
        Expert_13_41_GPU0 [label="Expert_L13_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_41_GPU1 [label="Expert_L13_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 13 - EP64_TP2
        Expert_13_42_GPU0 [label="Expert_L13_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_42_GPU1 [label="Expert_L13_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 13 - EP64_TP2
        Expert_13_43_GPU0 [label="Expert_L13_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_43_GPU1 [label="Expert_L13_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 13 - EP64_TP2
        Expert_13_44_GPU0 [label="Expert_L13_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_44_GPU1 [label="Expert_L13_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 13 - EP64_TP2
        Expert_13_45_GPU0 [label="Expert_L13_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_45_GPU1 [label="Expert_L13_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 13 - EP64_TP2
        Expert_13_46_GPU0 [label="Expert_L13_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_46_GPU1 [label="Expert_L13_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 13 - EP64_TP2
        Expert_13_47_GPU0 [label="Expert_L13_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_47_GPU1 [label="Expert_L13_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 13 - EP64_TP2
        Expert_13_48_GPU0 [label="Expert_L13_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_48_GPU1 [label="Expert_L13_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 13 - EP64_TP2
        Expert_13_49_GPU0 [label="Expert_L13_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_49_GPU1 [label="Expert_L13_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 13 - EP64_TP2
        Expert_13_50_GPU0 [label="Expert_L13_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_50_GPU1 [label="Expert_L13_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 13 - EP64_TP2
        Expert_13_51_GPU0 [label="Expert_L13_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_51_GPU1 [label="Expert_L13_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 13 - EP64_TP2
        Expert_13_52_GPU0 [label="Expert_L13_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_52_GPU1 [label="Expert_L13_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 13 - EP64_TP2
        Expert_13_53_GPU0 [label="Expert_L13_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_53_GPU1 [label="Expert_L13_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 13 - EP64_TP2
        Expert_13_54_GPU0 [label="Expert_L13_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_54_GPU1 [label="Expert_L13_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 13 - EP64_TP2
        Expert_13_55_GPU0 [label="Expert_L13_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_55_GPU1 [label="Expert_L13_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 13 - EP64_TP2
        Expert_13_56_GPU0 [label="Expert_L13_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_56_GPU1 [label="Expert_L13_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 13 - EP64_TP2
        Expert_13_57_GPU0 [label="Expert_L13_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_57_GPU1 [label="Expert_L13_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 13 - EP64_TP2
        Expert_13_58_GPU0 [label="Expert_L13_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_58_GPU1 [label="Expert_L13_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 13 - EP64_TP2
        Expert_13_59_GPU0 [label="Expert_L13_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_59_GPU1 [label="Expert_L13_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 13 - EP64_TP2
        Expert_13_60_GPU0 [label="Expert_L13_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_60_GPU1 [label="Expert_L13_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 13 - EP64_TP2
        Expert_13_61_GPU0 [label="Expert_L13_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_61_GPU1 [label="Expert_L13_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 13 - EP64_TP2
        Expert_13_62_GPU0 [label="Expert_L13_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_62_GPU1 [label="Expert_L13_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 13 - EP64_TP2
        Expert_13_63_GPU0 [label="Expert_L13_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_13_63_GPU1 [label="Expert_L13_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_13 [label="Expert_Route_Comm_L13\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_13 [label="Expert_Aggregate_L13\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_13 [label="FFN_GPU0_L13\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_13 [label="FFN_GPU1_L13\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_13 [label="FFN_Aggregate_L13\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_13 [label="LayerNorm_L13\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 14 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_14 {
        label="Layer 14 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_14 [label="MHA_Q_GPU0_L14\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_14 [label="MHA_K_GPU0_L14\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_14 [label="MHA_V_GPU0_L14\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_14 [label="MHA_Q_GPU1_L14\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_14 [label="MHA_K_GPU1_L14\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_14 [label="MHA_V_GPU1_L14\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_14 [label="Attention_Comp_GPU0_L14\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_14 [label="Attention_Comp_GPU1_L14\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_14 [label="Attention_Agg_L14\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_14 [label="Gate_Compute_L14\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_14 [label="Gate_Softmax_L14\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 14 - EP64_TP2
        Expert_14_0_GPU0 [label="Expert_L14_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_0_GPU1 [label="Expert_L14_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 14 - EP64_TP2
        Expert_14_1_GPU0 [label="Expert_L14_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_1_GPU1 [label="Expert_L14_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 14 - EP64_TP2
        Expert_14_2_GPU0 [label="Expert_L14_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_2_GPU1 [label="Expert_L14_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 14 - EP64_TP2
        Expert_14_3_GPU0 [label="Expert_L14_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_3_GPU1 [label="Expert_L14_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 14 - EP64_TP2
        Expert_14_4_GPU0 [label="Expert_L14_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_4_GPU1 [label="Expert_L14_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 14 - EP64_TP2
        Expert_14_5_GPU0 [label="Expert_L14_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_5_GPU1 [label="Expert_L14_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 14 - EP64_TP2
        Expert_14_6_GPU0 [label="Expert_L14_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_6_GPU1 [label="Expert_L14_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 14 - EP64_TP2
        Expert_14_7_GPU0 [label="Expert_L14_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_7_GPU1 [label="Expert_L14_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 14 - EP64_TP2
        Expert_14_8_GPU0 [label="Expert_L14_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_8_GPU1 [label="Expert_L14_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 14 - EP64_TP2
        Expert_14_9_GPU0 [label="Expert_L14_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_9_GPU1 [label="Expert_L14_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 14 - EP64_TP2
        Expert_14_10_GPU0 [label="Expert_L14_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_10_GPU1 [label="Expert_L14_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 14 - EP64_TP2
        Expert_14_11_GPU0 [label="Expert_L14_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_11_GPU1 [label="Expert_L14_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 14 - EP64_TP2
        Expert_14_12_GPU0 [label="Expert_L14_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_12_GPU1 [label="Expert_L14_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 14 - EP64_TP2
        Expert_14_13_GPU0 [label="Expert_L14_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_13_GPU1 [label="Expert_L14_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 14 - EP64_TP2
        Expert_14_14_GPU0 [label="Expert_L14_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_14_GPU1 [label="Expert_L14_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 14 - EP64_TP2
        Expert_14_15_GPU0 [label="Expert_L14_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_15_GPU1 [label="Expert_L14_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 14 - EP64_TP2
        Expert_14_16_GPU0 [label="Expert_L14_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_16_GPU1 [label="Expert_L14_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 14 - EP64_TP2
        Expert_14_17_GPU0 [label="Expert_L14_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_17_GPU1 [label="Expert_L14_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 14 - EP64_TP2
        Expert_14_18_GPU0 [label="Expert_L14_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_18_GPU1 [label="Expert_L14_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 14 - EP64_TP2
        Expert_14_19_GPU0 [label="Expert_L14_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_19_GPU1 [label="Expert_L14_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 14 - EP64_TP2
        Expert_14_20_GPU0 [label="Expert_L14_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_20_GPU1 [label="Expert_L14_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 14 - EP64_TP2
        Expert_14_21_GPU0 [label="Expert_L14_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_21_GPU1 [label="Expert_L14_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 14 - EP64_TP2
        Expert_14_22_GPU0 [label="Expert_L14_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_22_GPU1 [label="Expert_L14_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 14 - EP64_TP2
        Expert_14_23_GPU0 [label="Expert_L14_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_23_GPU1 [label="Expert_L14_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 14 - EP64_TP2
        Expert_14_24_GPU0 [label="Expert_L14_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_24_GPU1 [label="Expert_L14_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 14 - EP64_TP2
        Expert_14_25_GPU0 [label="Expert_L14_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_25_GPU1 [label="Expert_L14_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 14 - EP64_TP2
        Expert_14_26_GPU0 [label="Expert_L14_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_26_GPU1 [label="Expert_L14_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 14 - EP64_TP2
        Expert_14_27_GPU0 [label="Expert_L14_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_27_GPU1 [label="Expert_L14_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 14 - EP64_TP2
        Expert_14_28_GPU0 [label="Expert_L14_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_28_GPU1 [label="Expert_L14_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 14 - EP64_TP2
        Expert_14_29_GPU0 [label="Expert_L14_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_29_GPU1 [label="Expert_L14_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 14 - EP64_TP2
        Expert_14_30_GPU0 [label="Expert_L14_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_30_GPU1 [label="Expert_L14_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 14 - EP64_TP2
        Expert_14_31_GPU0 [label="Expert_L14_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_31_GPU1 [label="Expert_L14_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 14 - EP64_TP2
        Expert_14_32_GPU0 [label="Expert_L14_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_32_GPU1 [label="Expert_L14_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 14 - EP64_TP2
        Expert_14_33_GPU0 [label="Expert_L14_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_33_GPU1 [label="Expert_L14_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 14 - EP64_TP2
        Expert_14_34_GPU0 [label="Expert_L14_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_34_GPU1 [label="Expert_L14_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 14 - EP64_TP2
        Expert_14_35_GPU0 [label="Expert_L14_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_35_GPU1 [label="Expert_L14_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 14 - EP64_TP2
        Expert_14_36_GPU0 [label="Expert_L14_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_36_GPU1 [label="Expert_L14_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 14 - EP64_TP2
        Expert_14_37_GPU0 [label="Expert_L14_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_37_GPU1 [label="Expert_L14_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 14 - EP64_TP2
        Expert_14_38_GPU0 [label="Expert_L14_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_38_GPU1 [label="Expert_L14_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 14 - EP64_TP2
        Expert_14_39_GPU0 [label="Expert_L14_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_39_GPU1 [label="Expert_L14_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 14 - EP64_TP2
        Expert_14_40_GPU0 [label="Expert_L14_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_40_GPU1 [label="Expert_L14_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 14 - EP64_TP2
        Expert_14_41_GPU0 [label="Expert_L14_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_41_GPU1 [label="Expert_L14_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 14 - EP64_TP2
        Expert_14_42_GPU0 [label="Expert_L14_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_42_GPU1 [label="Expert_L14_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 14 - EP64_TP2
        Expert_14_43_GPU0 [label="Expert_L14_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_43_GPU1 [label="Expert_L14_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 14 - EP64_TP2
        Expert_14_44_GPU0 [label="Expert_L14_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_44_GPU1 [label="Expert_L14_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 14 - EP64_TP2
        Expert_14_45_GPU0 [label="Expert_L14_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_45_GPU1 [label="Expert_L14_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 14 - EP64_TP2
        Expert_14_46_GPU0 [label="Expert_L14_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_46_GPU1 [label="Expert_L14_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 14 - EP64_TP2
        Expert_14_47_GPU0 [label="Expert_L14_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_47_GPU1 [label="Expert_L14_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 14 - EP64_TP2
        Expert_14_48_GPU0 [label="Expert_L14_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_48_GPU1 [label="Expert_L14_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 14 - EP64_TP2
        Expert_14_49_GPU0 [label="Expert_L14_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_49_GPU1 [label="Expert_L14_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 14 - EP64_TP2
        Expert_14_50_GPU0 [label="Expert_L14_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_50_GPU1 [label="Expert_L14_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 14 - EP64_TP2
        Expert_14_51_GPU0 [label="Expert_L14_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_51_GPU1 [label="Expert_L14_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 14 - EP64_TP2
        Expert_14_52_GPU0 [label="Expert_L14_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_52_GPU1 [label="Expert_L14_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 14 - EP64_TP2
        Expert_14_53_GPU0 [label="Expert_L14_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_53_GPU1 [label="Expert_L14_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 14 - EP64_TP2
        Expert_14_54_GPU0 [label="Expert_L14_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_54_GPU1 [label="Expert_L14_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 14 - EP64_TP2
        Expert_14_55_GPU0 [label="Expert_L14_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_55_GPU1 [label="Expert_L14_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 14 - EP64_TP2
        Expert_14_56_GPU0 [label="Expert_L14_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_56_GPU1 [label="Expert_L14_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 14 - EP64_TP2
        Expert_14_57_GPU0 [label="Expert_L14_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_57_GPU1 [label="Expert_L14_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 14 - EP64_TP2
        Expert_14_58_GPU0 [label="Expert_L14_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_58_GPU1 [label="Expert_L14_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 14 - EP64_TP2
        Expert_14_59_GPU0 [label="Expert_L14_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_59_GPU1 [label="Expert_L14_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 14 - EP64_TP2
        Expert_14_60_GPU0 [label="Expert_L14_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_60_GPU1 [label="Expert_L14_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 14 - EP64_TP2
        Expert_14_61_GPU0 [label="Expert_L14_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_61_GPU1 [label="Expert_L14_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 14 - EP64_TP2
        Expert_14_62_GPU0 [label="Expert_L14_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_62_GPU1 [label="Expert_L14_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 14 - EP64_TP2
        Expert_14_63_GPU0 [label="Expert_L14_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_14_63_GPU1 [label="Expert_L14_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_14 [label="Expert_Route_Comm_L14\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_14 [label="Expert_Aggregate_L14\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_14 [label="FFN_GPU0_L14\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_14 [label="FFN_GPU1_L14\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_14 [label="FFN_Aggregate_L14\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_14 [label="LayerNorm_L14\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Layer 15 - Complete with 64 experts (EP64_TP2)
    subgraph cluster_layer_15 {
        label="Layer 15 (EP64_TP2)";
        style=rounded;
        fillcolor=lightcyan;
        
        // Multi-Head Attention - TP2 split
        MHA_Q_GPU0_15 [label="MHA_Q_GPU0_L15\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU0_15 [label="MHA_K_GPU0_L15\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU0_15 [label="MHA_V_GPU0_L15\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        MHA_Q_GPU1_15 [label="MHA_Q_GPU1_L15\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_K_GPU1_15 [label="MHA_K_GPU1_L15\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        MHA_V_GPU1_15 [label="MHA_V_GPU1_L15\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        // Attention computation and aggregation
        Attention_Comp_GPU0_15 [label="Attention_Comp_GPU0_L15\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        Attention_Comp_GPU1_15 [label="Attention_Comp_GPU1_L15\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        Attention_Agg_15 [label="Attention_Agg_L15\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Expert Gate - determines which tokens go to which experts
        Gate_Compute_15 [label="Gate_Compute_L15\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        Gate_Softmax_15 [label="Gate_Softmax_L15\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, num_experts=64]\nOutput: [batch_size=4, seq_len=2048, num_experts=64]", shape=box, fillcolor=lightblue];
        
        // Expert 0 in Layer 15 - EP64_TP2
        Expert_15_0_GPU0 [label="Expert_L15_E0_GPU0\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_0_GPU1 [label="Expert_L15_E0_GPU1\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 1 in Layer 15 - EP64_TP2
        Expert_15_1_GPU0 [label="Expert_L15_E1_GPU0\nGPU: 2\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_1_GPU1 [label="Expert_L15_E1_GPU1\nGPU: 3\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 2 in Layer 15 - EP64_TP2
        Expert_15_2_GPU0 [label="Expert_L15_E2_GPU0\nGPU: 4\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_2_GPU1 [label="Expert_L15_E2_GPU1\nGPU: 5\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 3 in Layer 15 - EP64_TP2
        Expert_15_3_GPU0 [label="Expert_L15_E3_GPU0\nGPU: 6\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_3_GPU1 [label="Expert_L15_E3_GPU1\nGPU: 7\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 4 in Layer 15 - EP64_TP2
        Expert_15_4_GPU0 [label="Expert_L15_E4_GPU0\nGPU: 8\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_4_GPU1 [label="Expert_L15_E4_GPU1\nGPU: 9\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 5 in Layer 15 - EP64_TP2
        Expert_15_5_GPU0 [label="Expert_L15_E5_GPU0\nGPU: 10\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_5_GPU1 [label="Expert_L15_E5_GPU1\nGPU: 11\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 6 in Layer 15 - EP64_TP2
        Expert_15_6_GPU0 [label="Expert_L15_E6_GPU0\nGPU: 12\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_6_GPU1 [label="Expert_L15_E6_GPU1\nGPU: 13\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 7 in Layer 15 - EP64_TP2
        Expert_15_7_GPU0 [label="Expert_L15_E7_GPU0\nGPU: 14\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_7_GPU1 [label="Expert_L15_E7_GPU1\nGPU: 15\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 8 in Layer 15 - EP64_TP2
        Expert_15_8_GPU0 [label="Expert_L15_E8_GPU0\nGPU: 16\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_8_GPU1 [label="Expert_L15_E8_GPU1\nGPU: 17\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 9 in Layer 15 - EP64_TP2
        Expert_15_9_GPU0 [label="Expert_L15_E9_GPU0\nGPU: 18\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_9_GPU1 [label="Expert_L15_E9_GPU1\nGPU: 19\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 10 in Layer 15 - EP64_TP2
        Expert_15_10_GPU0 [label="Expert_L15_E10_GPU0\nGPU: 20\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_10_GPU1 [label="Expert_L15_E10_GPU1\nGPU: 21\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 11 in Layer 15 - EP64_TP2
        Expert_15_11_GPU0 [label="Expert_L15_E11_GPU0\nGPU: 22\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_11_GPU1 [label="Expert_L15_E11_GPU1\nGPU: 23\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 12 in Layer 15 - EP64_TP2
        Expert_15_12_GPU0 [label="Expert_L15_E12_GPU0\nGPU: 24\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_12_GPU1 [label="Expert_L15_E12_GPU1\nGPU: 25\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 13 in Layer 15 - EP64_TP2
        Expert_15_13_GPU0 [label="Expert_L15_E13_GPU0\nGPU: 26\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_13_GPU1 [label="Expert_L15_E13_GPU1\nGPU: 27\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 14 in Layer 15 - EP64_TP2
        Expert_15_14_GPU0 [label="Expert_L15_E14_GPU0\nGPU: 28\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_14_GPU1 [label="Expert_L15_E14_GPU1\nGPU: 29\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 15 in Layer 15 - EP64_TP2
        Expert_15_15_GPU0 [label="Expert_L15_E15_GPU0\nGPU: 30\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_15_GPU1 [label="Expert_L15_E15_GPU1\nGPU: 31\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 16 in Layer 15 - EP64_TP2
        Expert_15_16_GPU0 [label="Expert_L15_E16_GPU0\nGPU: 32\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_16_GPU1 [label="Expert_L15_E16_GPU1\nGPU: 33\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 17 in Layer 15 - EP64_TP2
        Expert_15_17_GPU0 [label="Expert_L15_E17_GPU0\nGPU: 34\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_17_GPU1 [label="Expert_L15_E17_GPU1\nGPU: 35\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 18 in Layer 15 - EP64_TP2
        Expert_15_18_GPU0 [label="Expert_L15_E18_GPU0\nGPU: 36\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_18_GPU1 [label="Expert_L15_E18_GPU1\nGPU: 37\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 19 in Layer 15 - EP64_TP2
        Expert_15_19_GPU0 [label="Expert_L15_E19_GPU0\nGPU: 38\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_19_GPU1 [label="Expert_L15_E19_GPU1\nGPU: 39\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 20 in Layer 15 - EP64_TP2
        Expert_15_20_GPU0 [label="Expert_L15_E20_GPU0\nGPU: 40\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_20_GPU1 [label="Expert_L15_E20_GPU1\nGPU: 41\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 21 in Layer 15 - EP64_TP2
        Expert_15_21_GPU0 [label="Expert_L15_E21_GPU0\nGPU: 42\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_21_GPU1 [label="Expert_L15_E21_GPU1\nGPU: 43\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 22 in Layer 15 - EP64_TP2
        Expert_15_22_GPU0 [label="Expert_L15_E22_GPU0\nGPU: 44\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_22_GPU1 [label="Expert_L15_E22_GPU1\nGPU: 45\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 23 in Layer 15 - EP64_TP2
        Expert_15_23_GPU0 [label="Expert_L15_E23_GPU0\nGPU: 46\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_23_GPU1 [label="Expert_L15_E23_GPU1\nGPU: 47\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 24 in Layer 15 - EP64_TP2
        Expert_15_24_GPU0 [label="Expert_L15_E24_GPU0\nGPU: 48\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_24_GPU1 [label="Expert_L15_E24_GPU1\nGPU: 49\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 25 in Layer 15 - EP64_TP2
        Expert_15_25_GPU0 [label="Expert_L15_E25_GPU0\nGPU: 50\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_25_GPU1 [label="Expert_L15_E25_GPU1\nGPU: 51\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 26 in Layer 15 - EP64_TP2
        Expert_15_26_GPU0 [label="Expert_L15_E26_GPU0\nGPU: 52\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_26_GPU1 [label="Expert_L15_E26_GPU1\nGPU: 53\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 27 in Layer 15 - EP64_TP2
        Expert_15_27_GPU0 [label="Expert_L15_E27_GPU0\nGPU: 54\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_27_GPU1 [label="Expert_L15_E27_GPU1\nGPU: 55\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 28 in Layer 15 - EP64_TP2
        Expert_15_28_GPU0 [label="Expert_L15_E28_GPU0\nGPU: 56\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_28_GPU1 [label="Expert_L15_E28_GPU1\nGPU: 57\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 29 in Layer 15 - EP64_TP2
        Expert_15_29_GPU0 [label="Expert_L15_E29_GPU0\nGPU: 58\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_29_GPU1 [label="Expert_L15_E29_GPU1\nGPU: 59\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 30 in Layer 15 - EP64_TP2
        Expert_15_30_GPU0 [label="Expert_L15_E30_GPU0\nGPU: 60\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_30_GPU1 [label="Expert_L15_E30_GPU1\nGPU: 61\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 31 in Layer 15 - EP64_TP2
        Expert_15_31_GPU0 [label="Expert_L15_E31_GPU0\nGPU: 62\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_31_GPU1 [label="Expert_L15_E31_GPU1\nGPU: 63\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 32 in Layer 15 - EP64_TP2
        Expert_15_32_GPU0 [label="Expert_L15_E32_GPU0\nGPU: 64\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_32_GPU1 [label="Expert_L15_E32_GPU1\nGPU: 65\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 33 in Layer 15 - EP64_TP2
        Expert_15_33_GPU0 [label="Expert_L15_E33_GPU0\nGPU: 66\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_33_GPU1 [label="Expert_L15_E33_GPU1\nGPU: 67\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 34 in Layer 15 - EP64_TP2
        Expert_15_34_GPU0 [label="Expert_L15_E34_GPU0\nGPU: 68\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_34_GPU1 [label="Expert_L15_E34_GPU1\nGPU: 69\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 35 in Layer 15 - EP64_TP2
        Expert_15_35_GPU0 [label="Expert_L15_E35_GPU0\nGPU: 70\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_35_GPU1 [label="Expert_L15_E35_GPU1\nGPU: 71\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 36 in Layer 15 - EP64_TP2
        Expert_15_36_GPU0 [label="Expert_L15_E36_GPU0\nGPU: 72\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_36_GPU1 [label="Expert_L15_E36_GPU1\nGPU: 73\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 37 in Layer 15 - EP64_TP2
        Expert_15_37_GPU0 [label="Expert_L15_E37_GPU0\nGPU: 74\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_37_GPU1 [label="Expert_L15_E37_GPU1\nGPU: 75\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 38 in Layer 15 - EP64_TP2
        Expert_15_38_GPU0 [label="Expert_L15_E38_GPU0\nGPU: 76\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_38_GPU1 [label="Expert_L15_E38_GPU1\nGPU: 77\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 39 in Layer 15 - EP64_TP2
        Expert_15_39_GPU0 [label="Expert_L15_E39_GPU0\nGPU: 78\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_39_GPU1 [label="Expert_L15_E39_GPU1\nGPU: 79\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 40 in Layer 15 - EP64_TP2
        Expert_15_40_GPU0 [label="Expert_L15_E40_GPU0\nGPU: 80\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_40_GPU1 [label="Expert_L15_E40_GPU1\nGPU: 81\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 41 in Layer 15 - EP64_TP2
        Expert_15_41_GPU0 [label="Expert_L15_E41_GPU0\nGPU: 82\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_41_GPU1 [label="Expert_L15_E41_GPU1\nGPU: 83\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 42 in Layer 15 - EP64_TP2
        Expert_15_42_GPU0 [label="Expert_L15_E42_GPU0\nGPU: 84\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_42_GPU1 [label="Expert_L15_E42_GPU1\nGPU: 85\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 43 in Layer 15 - EP64_TP2
        Expert_15_43_GPU0 [label="Expert_L15_E43_GPU0\nGPU: 86\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_43_GPU1 [label="Expert_L15_E43_GPU1\nGPU: 87\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 44 in Layer 15 - EP64_TP2
        Expert_15_44_GPU0 [label="Expert_L15_E44_GPU0\nGPU: 88\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_44_GPU1 [label="Expert_L15_E44_GPU1\nGPU: 89\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 45 in Layer 15 - EP64_TP2
        Expert_15_45_GPU0 [label="Expert_L15_E45_GPU0\nGPU: 90\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_45_GPU1 [label="Expert_L15_E45_GPU1\nGPU: 91\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 46 in Layer 15 - EP64_TP2
        Expert_15_46_GPU0 [label="Expert_L15_E46_GPU0\nGPU: 92\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_46_GPU1 [label="Expert_L15_E46_GPU1\nGPU: 93\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 47 in Layer 15 - EP64_TP2
        Expert_15_47_GPU0 [label="Expert_L15_E47_GPU0\nGPU: 94\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_47_GPU1 [label="Expert_L15_E47_GPU1\nGPU: 95\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 48 in Layer 15 - EP64_TP2
        Expert_15_48_GPU0 [label="Expert_L15_E48_GPU0\nGPU: 96\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_48_GPU1 [label="Expert_L15_E48_GPU1\nGPU: 97\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 49 in Layer 15 - EP64_TP2
        Expert_15_49_GPU0 [label="Expert_L15_E49_GPU0\nGPU: 98\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_49_GPU1 [label="Expert_L15_E49_GPU1\nGPU: 99\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 50 in Layer 15 - EP64_TP2
        Expert_15_50_GPU0 [label="Expert_L15_E50_GPU0\nGPU: 100\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_50_GPU1 [label="Expert_L15_E50_GPU1\nGPU: 101\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 51 in Layer 15 - EP64_TP2
        Expert_15_51_GPU0 [label="Expert_L15_E51_GPU0\nGPU: 102\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_51_GPU1 [label="Expert_L15_E51_GPU1\nGPU: 103\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 52 in Layer 15 - EP64_TP2
        Expert_15_52_GPU0 [label="Expert_L15_E52_GPU0\nGPU: 104\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_52_GPU1 [label="Expert_L15_E52_GPU1\nGPU: 105\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 53 in Layer 15 - EP64_TP2
        Expert_15_53_GPU0 [label="Expert_L15_E53_GPU0\nGPU: 106\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_53_GPU1 [label="Expert_L15_E53_GPU1\nGPU: 107\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 54 in Layer 15 - EP64_TP2
        Expert_15_54_GPU0 [label="Expert_L15_E54_GPU0\nGPU: 108\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_54_GPU1 [label="Expert_L15_E54_GPU1\nGPU: 109\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 55 in Layer 15 - EP64_TP2
        Expert_15_55_GPU0 [label="Expert_L15_E55_GPU0\nGPU: 110\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_55_GPU1 [label="Expert_L15_E55_GPU1\nGPU: 111\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 56 in Layer 15 - EP64_TP2
        Expert_15_56_GPU0 [label="Expert_L15_E56_GPU0\nGPU: 112\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_56_GPU1 [label="Expert_L15_E56_GPU1\nGPU: 113\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 57 in Layer 15 - EP64_TP2
        Expert_15_57_GPU0 [label="Expert_L15_E57_GPU0\nGPU: 114\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_57_GPU1 [label="Expert_L15_E57_GPU1\nGPU: 115\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 58 in Layer 15 - EP64_TP2
        Expert_15_58_GPU0 [label="Expert_L15_E58_GPU0\nGPU: 116\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_58_GPU1 [label="Expert_L15_E58_GPU1\nGPU: 117\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 59 in Layer 15 - EP64_TP2
        Expert_15_59_GPU0 [label="Expert_L15_E59_GPU0\nGPU: 118\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_59_GPU1 [label="Expert_L15_E59_GPU1\nGPU: 119\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 60 in Layer 15 - EP64_TP2
        Expert_15_60_GPU0 [label="Expert_L15_E60_GPU0\nGPU: 120\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_60_GPU1 [label="Expert_L15_E60_GPU1\nGPU: 121\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 61 in Layer 15 - EP64_TP2
        Expert_15_61_GPU0 [label="Expert_L15_E61_GPU0\nGPU: 122\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_61_GPU1 [label="Expert_L15_E61_GPU1\nGPU: 123\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 62 in Layer 15 - EP64_TP2
        Expert_15_62_GPU0 [label="Expert_L15_E62_GPU0\nGPU: 124\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_62_GPU1 [label="Expert_L15_E62_GPU1\nGPU: 125\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert 63 in Layer 15 - EP64_TP2
        Expert_15_63_GPU0 [label="Expert_L15_E63_GPU0\nGPU: 126\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        Expert_15_63_GPU1 [label="Expert_L15_E63_GPU1\nGPU: 127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=box, fillcolor=lightgreen];
        
        // Expert routing communication
        Expert_Route_Comm_15 [label="Expert_Route_Comm_L15\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=16]", shape=ellipse, fillcolor=yellow, style="dashed,filled"];
        
        // Expert aggregation - collect outputs from all experts
        Expert_Agg_15 [label="Expert_Aggregate_L15\nGPU: 0-127\nInput: [batch_size=4, seq_len=2048, hidden=16]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // FFN - TP2 split
        FFN_GPU0_15 [label="FFN_GPU0_L15\nGPU: 0\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        FFN_GPU1_15 [label="FFN_GPU1_L15\nGPU: 1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=512]", shape=box, fillcolor=lightblue];
        
        FFN_Agg_15 [label="FFN_Aggregate_L15\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=512]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=parallelogram, fillcolor=orange];
        
        // Layer normalization
        LayerNorm_15 [label="LayerNorm_L15\nGPU: 0-1\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, hidden=1024]", shape=box, fillcolor=lightblue];
        
    }
    // Final output processing
    Output_Processing [label="Output_Processing\nCPU\nInput: [batch_size=4, seq_len=2048, hidden=1024]\nOutput: [batch_size=4, seq_len=2048, vocab_size]", shape=box, fillcolor=lightcoral];
    
    // Output node
    Output [label="Output\nInput: [batch_size=4, seq_len=2048, vocab_size]\nOutput: [batch_size=4, seq_len=2048, vocab_size]", shape=ellipse, fillcolor=lightgreen];
    
    // Connections - Input to Embedding
    Input -> Embed_GPU0;
    Input -> Embed_GPU1;
    Embed_GPU0 -> Embed_Agg;
    Embed_GPU1 -> Embed_Agg;
    Embed_Agg -> LayerNorm_Embed;
    
    // Layer 0 connections
    LayerNorm_Embed -> MHA_Q_GPU0_0;
    LayerNorm_Embed -> MHA_K_GPU0_0;
    LayerNorm_Embed -> MHA_V_GPU0_0;
    LayerNorm_Embed -> MHA_Q_GPU1_0;
    LayerNorm_Embed -> MHA_K_GPU1_0;
    LayerNorm_Embed -> MHA_V_GPU1_0;
    
    MHA_Q_GPU0_0 -> Attention_Comp_GPU0_0;
    MHA_K_GPU0_0 -> Attention_Comp_GPU0_0;
    MHA_V_GPU0_0 -> Attention_Comp_GPU0_0;
    MHA_Q_GPU1_0 -> Attention_Comp_GPU1_0;
    MHA_K_GPU1_0 -> Attention_Comp_GPU1_0;
    MHA_V_GPU1_0 -> Attention_Comp_GPU1_0;
    
    Attention_Comp_GPU0_0 -> Attention_Agg_0;
    Attention_Comp_GPU1_0 -> Attention_Agg_0;
    
    Attention_Agg_0 -> Gate_Compute_0;
    Gate_Compute_0 -> Gate_Softmax_0;
    
    Gate_Softmax_0 -> Expert_Route_Comm_0 [style=dashed];
    Attention_Agg_0 -> Expert_Route_Comm_0;
    
    Expert_Route_Comm_0 -> Expert_0_0_GPU0;
    Expert_Route_Comm_0 -> Expert_0_0_GPU1;
    Expert_0_0_GPU0 -> Expert_Agg_0;
    Expert_0_0_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_1_GPU0;
    Expert_Route_Comm_0 -> Expert_0_1_GPU1;
    Expert_0_1_GPU0 -> Expert_Agg_0;
    Expert_0_1_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_2_GPU0;
    Expert_Route_Comm_0 -> Expert_0_2_GPU1;
    Expert_0_2_GPU0 -> Expert_Agg_0;
    Expert_0_2_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_3_GPU0;
    Expert_Route_Comm_0 -> Expert_0_3_GPU1;
    Expert_0_3_GPU0 -> Expert_Agg_0;
    Expert_0_3_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_4_GPU0;
    Expert_Route_Comm_0 -> Expert_0_4_GPU1;
    Expert_0_4_GPU0 -> Expert_Agg_0;
    Expert_0_4_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_5_GPU0;
    Expert_Route_Comm_0 -> Expert_0_5_GPU1;
    Expert_0_5_GPU0 -> Expert_Agg_0;
    Expert_0_5_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_6_GPU0;
    Expert_Route_Comm_0 -> Expert_0_6_GPU1;
    Expert_0_6_GPU0 -> Expert_Agg_0;
    Expert_0_6_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_7_GPU0;
    Expert_Route_Comm_0 -> Expert_0_7_GPU1;
    Expert_0_7_GPU0 -> Expert_Agg_0;
    Expert_0_7_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_8_GPU0;
    Expert_Route_Comm_0 -> Expert_0_8_GPU1;
    Expert_0_8_GPU0 -> Expert_Agg_0;
    Expert_0_8_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_9_GPU0;
    Expert_Route_Comm_0 -> Expert_0_9_GPU1;
    Expert_0_9_GPU0 -> Expert_Agg_0;
    Expert_0_9_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_10_GPU0;
    Expert_Route_Comm_0 -> Expert_0_10_GPU1;
    Expert_0_10_GPU0 -> Expert_Agg_0;
    Expert_0_10_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_11_GPU0;
    Expert_Route_Comm_0 -> Expert_0_11_GPU1;
    Expert_0_11_GPU0 -> Expert_Agg_0;
    Expert_0_11_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_12_GPU0;
    Expert_Route_Comm_0 -> Expert_0_12_GPU1;
    Expert_0_12_GPU0 -> Expert_Agg_0;
    Expert_0_12_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_13_GPU0;
    Expert_Route_Comm_0 -> Expert_0_13_GPU1;
    Expert_0_13_GPU0 -> Expert_Agg_0;
    Expert_0_13_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_14_GPU0;
    Expert_Route_Comm_0 -> Expert_0_14_GPU1;
    Expert_0_14_GPU0 -> Expert_Agg_0;
    Expert_0_14_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_15_GPU0;
    Expert_Route_Comm_0 -> Expert_0_15_GPU1;
    Expert_0_15_GPU0 -> Expert_Agg_0;
    Expert_0_15_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_16_GPU0;
    Expert_Route_Comm_0 -> Expert_0_16_GPU1;
    Expert_0_16_GPU0 -> Expert_Agg_0;
    Expert_0_16_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_17_GPU0;
    Expert_Route_Comm_0 -> Expert_0_17_GPU1;
    Expert_0_17_GPU0 -> Expert_Agg_0;
    Expert_0_17_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_18_GPU0;
    Expert_Route_Comm_0 -> Expert_0_18_GPU1;
    Expert_0_18_GPU0 -> Expert_Agg_0;
    Expert_0_18_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_19_GPU0;
    Expert_Route_Comm_0 -> Expert_0_19_GPU1;
    Expert_0_19_GPU0 -> Expert_Agg_0;
    Expert_0_19_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_20_GPU0;
    Expert_Route_Comm_0 -> Expert_0_20_GPU1;
    Expert_0_20_GPU0 -> Expert_Agg_0;
    Expert_0_20_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_21_GPU0;
    Expert_Route_Comm_0 -> Expert_0_21_GPU1;
    Expert_0_21_GPU0 -> Expert_Agg_0;
    Expert_0_21_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_22_GPU0;
    Expert_Route_Comm_0 -> Expert_0_22_GPU1;
    Expert_0_22_GPU0 -> Expert_Agg_0;
    Expert_0_22_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_23_GPU0;
    Expert_Route_Comm_0 -> Expert_0_23_GPU1;
    Expert_0_23_GPU0 -> Expert_Agg_0;
    Expert_0_23_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_24_GPU0;
    Expert_Route_Comm_0 -> Expert_0_24_GPU1;
    Expert_0_24_GPU0 -> Expert_Agg_0;
    Expert_0_24_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_25_GPU0;
    Expert_Route_Comm_0 -> Expert_0_25_GPU1;
    Expert_0_25_GPU0 -> Expert_Agg_0;
    Expert_0_25_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_26_GPU0;
    Expert_Route_Comm_0 -> Expert_0_26_GPU1;
    Expert_0_26_GPU0 -> Expert_Agg_0;
    Expert_0_26_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_27_GPU0;
    Expert_Route_Comm_0 -> Expert_0_27_GPU1;
    Expert_0_27_GPU0 -> Expert_Agg_0;
    Expert_0_27_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_28_GPU0;
    Expert_Route_Comm_0 -> Expert_0_28_GPU1;
    Expert_0_28_GPU0 -> Expert_Agg_0;
    Expert_0_28_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_29_GPU0;
    Expert_Route_Comm_0 -> Expert_0_29_GPU1;
    Expert_0_29_GPU0 -> Expert_Agg_0;
    Expert_0_29_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_30_GPU0;
    Expert_Route_Comm_0 -> Expert_0_30_GPU1;
    Expert_0_30_GPU0 -> Expert_Agg_0;
    Expert_0_30_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_31_GPU0;
    Expert_Route_Comm_0 -> Expert_0_31_GPU1;
    Expert_0_31_GPU0 -> Expert_Agg_0;
    Expert_0_31_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_32_GPU0;
    Expert_Route_Comm_0 -> Expert_0_32_GPU1;
    Expert_0_32_GPU0 -> Expert_Agg_0;
    Expert_0_32_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_33_GPU0;
    Expert_Route_Comm_0 -> Expert_0_33_GPU1;
    Expert_0_33_GPU0 -> Expert_Agg_0;
    Expert_0_33_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_34_GPU0;
    Expert_Route_Comm_0 -> Expert_0_34_GPU1;
    Expert_0_34_GPU0 -> Expert_Agg_0;
    Expert_0_34_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_35_GPU0;
    Expert_Route_Comm_0 -> Expert_0_35_GPU1;
    Expert_0_35_GPU0 -> Expert_Agg_0;
    Expert_0_35_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_36_GPU0;
    Expert_Route_Comm_0 -> Expert_0_36_GPU1;
    Expert_0_36_GPU0 -> Expert_Agg_0;
    Expert_0_36_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_37_GPU0;
    Expert_Route_Comm_0 -> Expert_0_37_GPU1;
    Expert_0_37_GPU0 -> Expert_Agg_0;
    Expert_0_37_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_38_GPU0;
    Expert_Route_Comm_0 -> Expert_0_38_GPU1;
    Expert_0_38_GPU0 -> Expert_Agg_0;
    Expert_0_38_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_39_GPU0;
    Expert_Route_Comm_0 -> Expert_0_39_GPU1;
    Expert_0_39_GPU0 -> Expert_Agg_0;
    Expert_0_39_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_40_GPU0;
    Expert_Route_Comm_0 -> Expert_0_40_GPU1;
    Expert_0_40_GPU0 -> Expert_Agg_0;
    Expert_0_40_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_41_GPU0;
    Expert_Route_Comm_0 -> Expert_0_41_GPU1;
    Expert_0_41_GPU0 -> Expert_Agg_0;
    Expert_0_41_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_42_GPU0;
    Expert_Route_Comm_0 -> Expert_0_42_GPU1;
    Expert_0_42_GPU0 -> Expert_Agg_0;
    Expert_0_42_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_43_GPU0;
    Expert_Route_Comm_0 -> Expert_0_43_GPU1;
    Expert_0_43_GPU0 -> Expert_Agg_0;
    Expert_0_43_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_44_GPU0;
    Expert_Route_Comm_0 -> Expert_0_44_GPU1;
    Expert_0_44_GPU0 -> Expert_Agg_0;
    Expert_0_44_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_45_GPU0;
    Expert_Route_Comm_0 -> Expert_0_45_GPU1;
    Expert_0_45_GPU0 -> Expert_Agg_0;
    Expert_0_45_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_46_GPU0;
    Expert_Route_Comm_0 -> Expert_0_46_GPU1;
    Expert_0_46_GPU0 -> Expert_Agg_0;
    Expert_0_46_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_47_GPU0;
    Expert_Route_Comm_0 -> Expert_0_47_GPU1;
    Expert_0_47_GPU0 -> Expert_Agg_0;
    Expert_0_47_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_48_GPU0;
    Expert_Route_Comm_0 -> Expert_0_48_GPU1;
    Expert_0_48_GPU0 -> Expert_Agg_0;
    Expert_0_48_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_49_GPU0;
    Expert_Route_Comm_0 -> Expert_0_49_GPU1;
    Expert_0_49_GPU0 -> Expert_Agg_0;
    Expert_0_49_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_50_GPU0;
    Expert_Route_Comm_0 -> Expert_0_50_GPU1;
    Expert_0_50_GPU0 -> Expert_Agg_0;
    Expert_0_50_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_51_GPU0;
    Expert_Route_Comm_0 -> Expert_0_51_GPU1;
    Expert_0_51_GPU0 -> Expert_Agg_0;
    Expert_0_51_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_52_GPU0;
    Expert_Route_Comm_0 -> Expert_0_52_GPU1;
    Expert_0_52_GPU0 -> Expert_Agg_0;
    Expert_0_52_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_53_GPU0;
    Expert_Route_Comm_0 -> Expert_0_53_GPU1;
    Expert_0_53_GPU0 -> Expert_Agg_0;
    Expert_0_53_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_54_GPU0;
    Expert_Route_Comm_0 -> Expert_0_54_GPU1;
    Expert_0_54_GPU0 -> Expert_Agg_0;
    Expert_0_54_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_55_GPU0;
    Expert_Route_Comm_0 -> Expert_0_55_GPU1;
    Expert_0_55_GPU0 -> Expert_Agg_0;
    Expert_0_55_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_56_GPU0;
    Expert_Route_Comm_0 -> Expert_0_56_GPU1;
    Expert_0_56_GPU0 -> Expert_Agg_0;
    Expert_0_56_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_57_GPU0;
    Expert_Route_Comm_0 -> Expert_0_57_GPU1;
    Expert_0_57_GPU0 -> Expert_Agg_0;
    Expert_0_57_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_58_GPU0;
    Expert_Route_Comm_0 -> Expert_0_58_GPU1;
    Expert_0_58_GPU0 -> Expert_Agg_0;
    Expert_0_58_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_59_GPU0;
    Expert_Route_Comm_0 -> Expert_0_59_GPU1;
    Expert_0_59_GPU0 -> Expert_Agg_0;
    Expert_0_59_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_60_GPU0;
    Expert_Route_Comm_0 -> Expert_0_60_GPU1;
    Expert_0_60_GPU0 -> Expert_Agg_0;
    Expert_0_60_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_61_GPU0;
    Expert_Route_Comm_0 -> Expert_0_61_GPU1;
    Expert_0_61_GPU0 -> Expert_Agg_0;
    Expert_0_61_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_62_GPU0;
    Expert_Route_Comm_0 -> Expert_0_62_GPU1;
    Expert_0_62_GPU0 -> Expert_Agg_0;
    Expert_0_62_GPU1 -> Expert_Agg_0;
    
    Expert_Route_Comm_0 -> Expert_0_63_GPU0;
    Expert_Route_Comm_0 -> Expert_0_63_GPU1;
    Expert_0_63_GPU0 -> Expert_Agg_0;
    Expert_0_63_GPU1 -> Expert_Agg_0;
    
    Expert_Agg_0 -> FFN_GPU0_0;
    Expert_Agg_0 -> FFN_GPU1_0;
    FFN_GPU0_0 -> FFN_Agg_0;
    FFN_GPU1_0 -> FFN_Agg_0;
    FFN_Agg_0 -> LayerNorm_0;
    
    // Layer 1 connections
    LayerNorm_0 -> MHA_Q_GPU0_1;
    LayerNorm_0 -> MHA_K_GPU0_1;
    LayerNorm_0 -> MHA_V_GPU0_1;
    LayerNorm_0 -> MHA_Q_GPU1_1;
    LayerNorm_0 -> MHA_K_GPU1_1;
    LayerNorm_0 -> MHA_V_GPU1_1;
    
    MHA_Q_GPU0_1 -> Attention_Comp_GPU0_1;
    MHA_K_GPU0_1 -> Attention_Comp_GPU0_1;
    MHA_V_GPU0_1 -> Attention_Comp_GPU0_1;
    MHA_Q_GPU1_1 -> Attention_Comp_GPU1_1;
    MHA_K_GPU1_1 -> Attention_Comp_GPU1_1;
    MHA_V_GPU1_1 -> Attention_Comp_GPU1_1;
    
    Attention_Comp_GPU0_1 -> Attention_Agg_1;
    Attention_Comp_GPU1_1 -> Attention_Agg_1;
    
    Attention_Agg_1 -> Gate_Compute_1;
    Gate_Compute_1 -> Gate_Softmax_1;
    
    Gate_Softmax_1 -> Expert_Route_Comm_1 [style=dashed];
    Attention_Agg_1 -> Expert_Route_Comm_1;
    
    Expert_Route_Comm_1 -> Expert_1_0_GPU0;
    Expert_Route_Comm_1 -> Expert_1_0_GPU1;
    Expert_1_0_GPU0 -> Expert_Agg_1;
    Expert_1_0_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_1_GPU0;
    Expert_Route_Comm_1 -> Expert_1_1_GPU1;
    Expert_1_1_GPU0 -> Expert_Agg_1;
    Expert_1_1_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_2_GPU0;
    Expert_Route_Comm_1 -> Expert_1_2_GPU1;
    Expert_1_2_GPU0 -> Expert_Agg_1;
    Expert_1_2_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_3_GPU0;
    Expert_Route_Comm_1 -> Expert_1_3_GPU1;
    Expert_1_3_GPU0 -> Expert_Agg_1;
    Expert_1_3_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_4_GPU0;
    Expert_Route_Comm_1 -> Expert_1_4_GPU1;
    Expert_1_4_GPU0 -> Expert_Agg_1;
    Expert_1_4_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_5_GPU0;
    Expert_Route_Comm_1 -> Expert_1_5_GPU1;
    Expert_1_5_GPU0 -> Expert_Agg_1;
    Expert_1_5_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_6_GPU0;
    Expert_Route_Comm_1 -> Expert_1_6_GPU1;
    Expert_1_6_GPU0 -> Expert_Agg_1;
    Expert_1_6_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_7_GPU0;
    Expert_Route_Comm_1 -> Expert_1_7_GPU1;
    Expert_1_7_GPU0 -> Expert_Agg_1;
    Expert_1_7_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_8_GPU0;
    Expert_Route_Comm_1 -> Expert_1_8_GPU1;
    Expert_1_8_GPU0 -> Expert_Agg_1;
    Expert_1_8_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_9_GPU0;
    Expert_Route_Comm_1 -> Expert_1_9_GPU1;
    Expert_1_9_GPU0 -> Expert_Agg_1;
    Expert_1_9_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_10_GPU0;
    Expert_Route_Comm_1 -> Expert_1_10_GPU1;
    Expert_1_10_GPU0 -> Expert_Agg_1;
    Expert_1_10_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_11_GPU0;
    Expert_Route_Comm_1 -> Expert_1_11_GPU1;
    Expert_1_11_GPU0 -> Expert_Agg_1;
    Expert_1_11_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_12_GPU0;
    Expert_Route_Comm_1 -> Expert_1_12_GPU1;
    Expert_1_12_GPU0 -> Expert_Agg_1;
    Expert_1_12_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_13_GPU0;
    Expert_Route_Comm_1 -> Expert_1_13_GPU1;
    Expert_1_13_GPU0 -> Expert_Agg_1;
    Expert_1_13_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_14_GPU0;
    Expert_Route_Comm_1 -> Expert_1_14_GPU1;
    Expert_1_14_GPU0 -> Expert_Agg_1;
    Expert_1_14_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_15_GPU0;
    Expert_Route_Comm_1 -> Expert_1_15_GPU1;
    Expert_1_15_GPU0 -> Expert_Agg_1;
    Expert_1_15_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_16_GPU0;
    Expert_Route_Comm_1 -> Expert_1_16_GPU1;
    Expert_1_16_GPU0 -> Expert_Agg_1;
    Expert_1_16_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_17_GPU0;
    Expert_Route_Comm_1 -> Expert_1_17_GPU1;
    Expert_1_17_GPU0 -> Expert_Agg_1;
    Expert_1_17_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_18_GPU0;
    Expert_Route_Comm_1 -> Expert_1_18_GPU1;
    Expert_1_18_GPU0 -> Expert_Agg_1;
    Expert_1_18_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_19_GPU0;
    Expert_Route_Comm_1 -> Expert_1_19_GPU1;
    Expert_1_19_GPU0 -> Expert_Agg_1;
    Expert_1_19_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_20_GPU0;
    Expert_Route_Comm_1 -> Expert_1_20_GPU1;
    Expert_1_20_GPU0 -> Expert_Agg_1;
    Expert_1_20_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_21_GPU0;
    Expert_Route_Comm_1 -> Expert_1_21_GPU1;
    Expert_1_21_GPU0 -> Expert_Agg_1;
    Expert_1_21_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_22_GPU0;
    Expert_Route_Comm_1 -> Expert_1_22_GPU1;
    Expert_1_22_GPU0 -> Expert_Agg_1;
    Expert_1_22_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_23_GPU0;
    Expert_Route_Comm_1 -> Expert_1_23_GPU1;
    Expert_1_23_GPU0 -> Expert_Agg_1;
    Expert_1_23_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_24_GPU0;
    Expert_Route_Comm_1 -> Expert_1_24_GPU1;
    Expert_1_24_GPU0 -> Expert_Agg_1;
    Expert_1_24_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_25_GPU0;
    Expert_Route_Comm_1 -> Expert_1_25_GPU1;
    Expert_1_25_GPU0 -> Expert_Agg_1;
    Expert_1_25_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_26_GPU0;
    Expert_Route_Comm_1 -> Expert_1_26_GPU1;
    Expert_1_26_GPU0 -> Expert_Agg_1;
    Expert_1_26_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_27_GPU0;
    Expert_Route_Comm_1 -> Expert_1_27_GPU1;
    Expert_1_27_GPU0 -> Expert_Agg_1;
    Expert_1_27_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_28_GPU0;
    Expert_Route_Comm_1 -> Expert_1_28_GPU1;
    Expert_1_28_GPU0 -> Expert_Agg_1;
    Expert_1_28_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_29_GPU0;
    Expert_Route_Comm_1 -> Expert_1_29_GPU1;
    Expert_1_29_GPU0 -> Expert_Agg_1;
    Expert_1_29_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_30_GPU0;
    Expert_Route_Comm_1 -> Expert_1_30_GPU1;
    Expert_1_30_GPU0 -> Expert_Agg_1;
    Expert_1_30_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_31_GPU0;
    Expert_Route_Comm_1 -> Expert_1_31_GPU1;
    Expert_1_31_GPU0 -> Expert_Agg_1;
    Expert_1_31_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_32_GPU0;
    Expert_Route_Comm_1 -> Expert_1_32_GPU1;
    Expert_1_32_GPU0 -> Expert_Agg_1;
    Expert_1_32_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_33_GPU0;
    Expert_Route_Comm_1 -> Expert_1_33_GPU1;
    Expert_1_33_GPU0 -> Expert_Agg_1;
    Expert_1_33_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_34_GPU0;
    Expert_Route_Comm_1 -> Expert_1_34_GPU1;
    Expert_1_34_GPU0 -> Expert_Agg_1;
    Expert_1_34_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_35_GPU0;
    Expert_Route_Comm_1 -> Expert_1_35_GPU1;
    Expert_1_35_GPU0 -> Expert_Agg_1;
    Expert_1_35_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_36_GPU0;
    Expert_Route_Comm_1 -> Expert_1_36_GPU1;
    Expert_1_36_GPU0 -> Expert_Agg_1;
    Expert_1_36_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_37_GPU0;
    Expert_Route_Comm_1 -> Expert_1_37_GPU1;
    Expert_1_37_GPU0 -> Expert_Agg_1;
    Expert_1_37_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_38_GPU0;
    Expert_Route_Comm_1 -> Expert_1_38_GPU1;
    Expert_1_38_GPU0 -> Expert_Agg_1;
    Expert_1_38_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_39_GPU0;
    Expert_Route_Comm_1 -> Expert_1_39_GPU1;
    Expert_1_39_GPU0 -> Expert_Agg_1;
    Expert_1_39_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_40_GPU0;
    Expert_Route_Comm_1 -> Expert_1_40_GPU1;
    Expert_1_40_GPU0 -> Expert_Agg_1;
    Expert_1_40_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_41_GPU0;
    Expert_Route_Comm_1 -> Expert_1_41_GPU1;
    Expert_1_41_GPU0 -> Expert_Agg_1;
    Expert_1_41_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_42_GPU0;
    Expert_Route_Comm_1 -> Expert_1_42_GPU1;
    Expert_1_42_GPU0 -> Expert_Agg_1;
    Expert_1_42_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_43_GPU0;
    Expert_Route_Comm_1 -> Expert_1_43_GPU1;
    Expert_1_43_GPU0 -> Expert_Agg_1;
    Expert_1_43_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_44_GPU0;
    Expert_Route_Comm_1 -> Expert_1_44_GPU1;
    Expert_1_44_GPU0 -> Expert_Agg_1;
    Expert_1_44_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_45_GPU0;
    Expert_Route_Comm_1 -> Expert_1_45_GPU1;
    Expert_1_45_GPU0 -> Expert_Agg_1;
    Expert_1_45_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_46_GPU0;
    Expert_Route_Comm_1 -> Expert_1_46_GPU1;
    Expert_1_46_GPU0 -> Expert_Agg_1;
    Expert_1_46_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_47_GPU0;
    Expert_Route_Comm_1 -> Expert_1_47_GPU1;
    Expert_1_47_GPU0 -> Expert_Agg_1;
    Expert_1_47_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_48_GPU0;
    Expert_Route_Comm_1 -> Expert_1_48_GPU1;
    Expert_1_48_GPU0 -> Expert_Agg_1;
    Expert_1_48_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_49_GPU0;
    Expert_Route_Comm_1 -> Expert_1_49_GPU1;
    Expert_1_49_GPU0 -> Expert_Agg_1;
    Expert_1_49_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_50_GPU0;
    Expert_Route_Comm_1 -> Expert_1_50_GPU1;
    Expert_1_50_GPU0 -> Expert_Agg_1;
    Expert_1_50_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_51_GPU0;
    Expert_Route_Comm_1 -> Expert_1_51_GPU1;
    Expert_1_51_GPU0 -> Expert_Agg_1;
    Expert_1_51_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_52_GPU0;
    Expert_Route_Comm_1 -> Expert_1_52_GPU1;
    Expert_1_52_GPU0 -> Expert_Agg_1;
    Expert_1_52_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_53_GPU0;
    Expert_Route_Comm_1 -> Expert_1_53_GPU1;
    Expert_1_53_GPU0 -> Expert_Agg_1;
    Expert_1_53_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_54_GPU0;
    Expert_Route_Comm_1 -> Expert_1_54_GPU1;
    Expert_1_54_GPU0 -> Expert_Agg_1;
    Expert_1_54_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_55_GPU0;
    Expert_Route_Comm_1 -> Expert_1_55_GPU1;
    Expert_1_55_GPU0 -> Expert_Agg_1;
    Expert_1_55_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_56_GPU0;
    Expert_Route_Comm_1 -> Expert_1_56_GPU1;
    Expert_1_56_GPU0 -> Expert_Agg_1;
    Expert_1_56_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_57_GPU0;
    Expert_Route_Comm_1 -> Expert_1_57_GPU1;
    Expert_1_57_GPU0 -> Expert_Agg_1;
    Expert_1_57_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_58_GPU0;
    Expert_Route_Comm_1 -> Expert_1_58_GPU1;
    Expert_1_58_GPU0 -> Expert_Agg_1;
    Expert_1_58_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_59_GPU0;
    Expert_Route_Comm_1 -> Expert_1_59_GPU1;
    Expert_1_59_GPU0 -> Expert_Agg_1;
    Expert_1_59_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_60_GPU0;
    Expert_Route_Comm_1 -> Expert_1_60_GPU1;
    Expert_1_60_GPU0 -> Expert_Agg_1;
    Expert_1_60_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_61_GPU0;
    Expert_Route_Comm_1 -> Expert_1_61_GPU1;
    Expert_1_61_GPU0 -> Expert_Agg_1;
    Expert_1_61_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_62_GPU0;
    Expert_Route_Comm_1 -> Expert_1_62_GPU1;
    Expert_1_62_GPU0 -> Expert_Agg_1;
    Expert_1_62_GPU1 -> Expert_Agg_1;
    
    Expert_Route_Comm_1 -> Expert_1_63_GPU0;
    Expert_Route_Comm_1 -> Expert_1_63_GPU1;
    Expert_1_63_GPU0 -> Expert_Agg_1;
    Expert_1_63_GPU1 -> Expert_Agg_1;
    
    Expert_Agg_1 -> FFN_GPU0_1;
    Expert_Agg_1 -> FFN_GPU1_1;
    FFN_GPU0_1 -> FFN_Agg_1;
    FFN_GPU1_1 -> FFN_Agg_1;
    FFN_Agg_1 -> LayerNorm_1;
    
    // Layer 2 connections
    LayerNorm_1 -> MHA_Q_GPU0_2;
    LayerNorm_1 -> MHA_K_GPU0_2;
    LayerNorm_1 -> MHA_V_GPU0_2;
    LayerNorm_1 -> MHA_Q_GPU1_2;
    LayerNorm_1 -> MHA_K_GPU1_2;
    LayerNorm_1 -> MHA_V_GPU1_2;
    
    MHA_Q_GPU0_2 -> Attention_Comp_GPU0_2;
    MHA_K_GPU0_2 -> Attention_Comp_GPU0_2;
    MHA_V_GPU0_2 -> Attention_Comp_GPU0_2;
    MHA_Q_GPU1_2 -> Attention_Comp_GPU1_2;
    MHA_K_GPU1_2 -> Attention_Comp_GPU1_2;
    MHA_V_GPU1_2 -> Attention_Comp_GPU1_2;
    
    Attention_Comp_GPU0_2 -> Attention_Agg_2;
    Attention_Comp_GPU1_2 -> Attention_Agg_2;
    
    Attention_Agg_2 -> Gate_Compute_2;
    Gate_Compute_2 -> Gate_Softmax_2;
    
    Gate_Softmax_2 -> Expert_Route_Comm_2 [style=dashed];
    Attention_Agg_2 -> Expert_Route_Comm_2;
    
    Expert_Route_Comm_2 -> Expert_2_0_GPU0;
    Expert_Route_Comm_2 -> Expert_2_0_GPU1;
    Expert_2_0_GPU0 -> Expert_Agg_2;
    Expert_2_0_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_1_GPU0;
    Expert_Route_Comm_2 -> Expert_2_1_GPU1;
    Expert_2_1_GPU0 -> Expert_Agg_2;
    Expert_2_1_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_2_GPU0;
    Expert_Route_Comm_2 -> Expert_2_2_GPU1;
    Expert_2_2_GPU0 -> Expert_Agg_2;
    Expert_2_2_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_3_GPU0;
    Expert_Route_Comm_2 -> Expert_2_3_GPU1;
    Expert_2_3_GPU0 -> Expert_Agg_2;
    Expert_2_3_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_4_GPU0;
    Expert_Route_Comm_2 -> Expert_2_4_GPU1;
    Expert_2_4_GPU0 -> Expert_Agg_2;
    Expert_2_4_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_5_GPU0;
    Expert_Route_Comm_2 -> Expert_2_5_GPU1;
    Expert_2_5_GPU0 -> Expert_Agg_2;
    Expert_2_5_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_6_GPU0;
    Expert_Route_Comm_2 -> Expert_2_6_GPU1;
    Expert_2_6_GPU0 -> Expert_Agg_2;
    Expert_2_6_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_7_GPU0;
    Expert_Route_Comm_2 -> Expert_2_7_GPU1;
    Expert_2_7_GPU0 -> Expert_Agg_2;
    Expert_2_7_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_8_GPU0;
    Expert_Route_Comm_2 -> Expert_2_8_GPU1;
    Expert_2_8_GPU0 -> Expert_Agg_2;
    Expert_2_8_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_9_GPU0;
    Expert_Route_Comm_2 -> Expert_2_9_GPU1;
    Expert_2_9_GPU0 -> Expert_Agg_2;
    Expert_2_9_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_10_GPU0;
    Expert_Route_Comm_2 -> Expert_2_10_GPU1;
    Expert_2_10_GPU0 -> Expert_Agg_2;
    Expert_2_10_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_11_GPU0;
    Expert_Route_Comm_2 -> Expert_2_11_GPU1;
    Expert_2_11_GPU0 -> Expert_Agg_2;
    Expert_2_11_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_12_GPU0;
    Expert_Route_Comm_2 -> Expert_2_12_GPU1;
    Expert_2_12_GPU0 -> Expert_Agg_2;
    Expert_2_12_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_13_GPU0;
    Expert_Route_Comm_2 -> Expert_2_13_GPU1;
    Expert_2_13_GPU0 -> Expert_Agg_2;
    Expert_2_13_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_14_GPU0;
    Expert_Route_Comm_2 -> Expert_2_14_GPU1;
    Expert_2_14_GPU0 -> Expert_Agg_2;
    Expert_2_14_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_15_GPU0;
    Expert_Route_Comm_2 -> Expert_2_15_GPU1;
    Expert_2_15_GPU0 -> Expert_Agg_2;
    Expert_2_15_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_16_GPU0;
    Expert_Route_Comm_2 -> Expert_2_16_GPU1;
    Expert_2_16_GPU0 -> Expert_Agg_2;
    Expert_2_16_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_17_GPU0;
    Expert_Route_Comm_2 -> Expert_2_17_GPU1;
    Expert_2_17_GPU0 -> Expert_Agg_2;
    Expert_2_17_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_18_GPU0;
    Expert_Route_Comm_2 -> Expert_2_18_GPU1;
    Expert_2_18_GPU0 -> Expert_Agg_2;
    Expert_2_18_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_19_GPU0;
    Expert_Route_Comm_2 -> Expert_2_19_GPU1;
    Expert_2_19_GPU0 -> Expert_Agg_2;
    Expert_2_19_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_20_GPU0;
    Expert_Route_Comm_2 -> Expert_2_20_GPU1;
    Expert_2_20_GPU0 -> Expert_Agg_2;
    Expert_2_20_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_21_GPU0;
    Expert_Route_Comm_2 -> Expert_2_21_GPU1;
    Expert_2_21_GPU0 -> Expert_Agg_2;
    Expert_2_21_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_22_GPU0;
    Expert_Route_Comm_2 -> Expert_2_22_GPU1;
    Expert_2_22_GPU0 -> Expert_Agg_2;
    Expert_2_22_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_23_GPU0;
    Expert_Route_Comm_2 -> Expert_2_23_GPU1;
    Expert_2_23_GPU0 -> Expert_Agg_2;
    Expert_2_23_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_24_GPU0;
    Expert_Route_Comm_2 -> Expert_2_24_GPU1;
    Expert_2_24_GPU0 -> Expert_Agg_2;
    Expert_2_24_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_25_GPU0;
    Expert_Route_Comm_2 -> Expert_2_25_GPU1;
    Expert_2_25_GPU0 -> Expert_Agg_2;
    Expert_2_25_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_26_GPU0;
    Expert_Route_Comm_2 -> Expert_2_26_GPU1;
    Expert_2_26_GPU0 -> Expert_Agg_2;
    Expert_2_26_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_27_GPU0;
    Expert_Route_Comm_2 -> Expert_2_27_GPU1;
    Expert_2_27_GPU0 -> Expert_Agg_2;
    Expert_2_27_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_28_GPU0;
    Expert_Route_Comm_2 -> Expert_2_28_GPU1;
    Expert_2_28_GPU0 -> Expert_Agg_2;
    Expert_2_28_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_29_GPU0;
    Expert_Route_Comm_2 -> Expert_2_29_GPU1;
    Expert_2_29_GPU0 -> Expert_Agg_2;
    Expert_2_29_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_30_GPU0;
    Expert_Route_Comm_2 -> Expert_2_30_GPU1;
    Expert_2_30_GPU0 -> Expert_Agg_2;
    Expert_2_30_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_31_GPU0;
    Expert_Route_Comm_2 -> Expert_2_31_GPU1;
    Expert_2_31_GPU0 -> Expert_Agg_2;
    Expert_2_31_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_32_GPU0;
    Expert_Route_Comm_2 -> Expert_2_32_GPU1;
    Expert_2_32_GPU0 -> Expert_Agg_2;
    Expert_2_32_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_33_GPU0;
    Expert_Route_Comm_2 -> Expert_2_33_GPU1;
    Expert_2_33_GPU0 -> Expert_Agg_2;
    Expert_2_33_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_34_GPU0;
    Expert_Route_Comm_2 -> Expert_2_34_GPU1;
    Expert_2_34_GPU0 -> Expert_Agg_2;
    Expert_2_34_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_35_GPU0;
    Expert_Route_Comm_2 -> Expert_2_35_GPU1;
    Expert_2_35_GPU0 -> Expert_Agg_2;
    Expert_2_35_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_36_GPU0;
    Expert_Route_Comm_2 -> Expert_2_36_GPU1;
    Expert_2_36_GPU0 -> Expert_Agg_2;
    Expert_2_36_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_37_GPU0;
    Expert_Route_Comm_2 -> Expert_2_37_GPU1;
    Expert_2_37_GPU0 -> Expert_Agg_2;
    Expert_2_37_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_38_GPU0;
    Expert_Route_Comm_2 -> Expert_2_38_GPU1;
    Expert_2_38_GPU0 -> Expert_Agg_2;
    Expert_2_38_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_39_GPU0;
    Expert_Route_Comm_2 -> Expert_2_39_GPU1;
    Expert_2_39_GPU0 -> Expert_Agg_2;
    Expert_2_39_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_40_GPU0;
    Expert_Route_Comm_2 -> Expert_2_40_GPU1;
    Expert_2_40_GPU0 -> Expert_Agg_2;
    Expert_2_40_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_41_GPU0;
    Expert_Route_Comm_2 -> Expert_2_41_GPU1;
    Expert_2_41_GPU0 -> Expert_Agg_2;
    Expert_2_41_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_42_GPU0;
    Expert_Route_Comm_2 -> Expert_2_42_GPU1;
    Expert_2_42_GPU0 -> Expert_Agg_2;
    Expert_2_42_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_43_GPU0;
    Expert_Route_Comm_2 -> Expert_2_43_GPU1;
    Expert_2_43_GPU0 -> Expert_Agg_2;
    Expert_2_43_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_44_GPU0;
    Expert_Route_Comm_2 -> Expert_2_44_GPU1;
    Expert_2_44_GPU0 -> Expert_Agg_2;
    Expert_2_44_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_45_GPU0;
    Expert_Route_Comm_2 -> Expert_2_45_GPU1;
    Expert_2_45_GPU0 -> Expert_Agg_2;
    Expert_2_45_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_46_GPU0;
    Expert_Route_Comm_2 -> Expert_2_46_GPU1;
    Expert_2_46_GPU0 -> Expert_Agg_2;
    Expert_2_46_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_47_GPU0;
    Expert_Route_Comm_2 -> Expert_2_47_GPU1;
    Expert_2_47_GPU0 -> Expert_Agg_2;
    Expert_2_47_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_48_GPU0;
    Expert_Route_Comm_2 -> Expert_2_48_GPU1;
    Expert_2_48_GPU0 -> Expert_Agg_2;
    Expert_2_48_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_49_GPU0;
    Expert_Route_Comm_2 -> Expert_2_49_GPU1;
    Expert_2_49_GPU0 -> Expert_Agg_2;
    Expert_2_49_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_50_GPU0;
    Expert_Route_Comm_2 -> Expert_2_50_GPU1;
    Expert_2_50_GPU0 -> Expert_Agg_2;
    Expert_2_50_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_51_GPU0;
    Expert_Route_Comm_2 -> Expert_2_51_GPU1;
    Expert_2_51_GPU0 -> Expert_Agg_2;
    Expert_2_51_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_52_GPU0;
    Expert_Route_Comm_2 -> Expert_2_52_GPU1;
    Expert_2_52_GPU0 -> Expert_Agg_2;
    Expert_2_52_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_53_GPU0;
    Expert_Route_Comm_2 -> Expert_2_53_GPU1;
    Expert_2_53_GPU0 -> Expert_Agg_2;
    Expert_2_53_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_54_GPU0;
    Expert_Route_Comm_2 -> Expert_2_54_GPU1;
    Expert_2_54_GPU0 -> Expert_Agg_2;
    Expert_2_54_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_55_GPU0;
    Expert_Route_Comm_2 -> Expert_2_55_GPU1;
    Expert_2_55_GPU0 -> Expert_Agg_2;
    Expert_2_55_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_56_GPU0;
    Expert_Route_Comm_2 -> Expert_2_56_GPU1;
    Expert_2_56_GPU0 -> Expert_Agg_2;
    Expert_2_56_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_57_GPU0;
    Expert_Route_Comm_2 -> Expert_2_57_GPU1;
    Expert_2_57_GPU0 -> Expert_Agg_2;
    Expert_2_57_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_58_GPU0;
    Expert_Route_Comm_2 -> Expert_2_58_GPU1;
    Expert_2_58_GPU0 -> Expert_Agg_2;
    Expert_2_58_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_59_GPU0;
    Expert_Route_Comm_2 -> Expert_2_59_GPU1;
    Expert_2_59_GPU0 -> Expert_Agg_2;
    Expert_2_59_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_60_GPU0;
    Expert_Route_Comm_2 -> Expert_2_60_GPU1;
    Expert_2_60_GPU0 -> Expert_Agg_2;
    Expert_2_60_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_61_GPU0;
    Expert_Route_Comm_2 -> Expert_2_61_GPU1;
    Expert_2_61_GPU0 -> Expert_Agg_2;
    Expert_2_61_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_62_GPU0;
    Expert_Route_Comm_2 -> Expert_2_62_GPU1;
    Expert_2_62_GPU0 -> Expert_Agg_2;
    Expert_2_62_GPU1 -> Expert_Agg_2;
    
    Expert_Route_Comm_2 -> Expert_2_63_GPU0;
    Expert_Route_Comm_2 -> Expert_2_63_GPU1;
    Expert_2_63_GPU0 -> Expert_Agg_2;
    Expert_2_63_GPU1 -> Expert_Agg_2;
    
    Expert_Agg_2 -> FFN_GPU0_2;
    Expert_Agg_2 -> FFN_GPU1_2;
    FFN_GPU0_2 -> FFN_Agg_2;
    FFN_GPU1_2 -> FFN_Agg_2;
    FFN_Agg_2 -> LayerNorm_2;
    
    // Layer 3 connections
    LayerNorm_2 -> MHA_Q_GPU0_3;
    LayerNorm_2 -> MHA_K_GPU0_3;
    LayerNorm_2 -> MHA_V_GPU0_3;
    LayerNorm_2 -> MHA_Q_GPU1_3;
    LayerNorm_2 -> MHA_K_GPU1_3;
    LayerNorm_2 -> MHA_V_GPU1_3;
    
    MHA_Q_GPU0_3 -> Attention_Comp_GPU0_3;
    MHA_K_GPU0_3 -> Attention_Comp_GPU0_3;
    MHA_V_GPU0_3 -> Attention_Comp_GPU0_3;
    MHA_Q_GPU1_3 -> Attention_Comp_GPU1_3;
    MHA_K_GPU1_3 -> Attention_Comp_GPU1_3;
    MHA_V_GPU1_3 -> Attention_Comp_GPU1_3;
    
    Attention_Comp_GPU0_3 -> Attention_Agg_3;
    Attention_Comp_GPU1_3 -> Attention_Agg_3;
    
    Attention_Agg_3 -> Gate_Compute_3;
    Gate_Compute_3 -> Gate_Softmax_3;
    
    Gate_Softmax_3 -> Expert_Route_Comm_3 [style=dashed];
    Attention_Agg_3 -> Expert_Route_Comm_3;
    
    Expert_Route_Comm_3 -> Expert_3_0_GPU0;
    Expert_Route_Comm_3 -> Expert_3_0_GPU1;
    Expert_3_0_GPU0 -> Expert_Agg_3;
    Expert_3_0_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_1_GPU0;
    Expert_Route_Comm_3 -> Expert_3_1_GPU1;
    Expert_3_1_GPU0 -> Expert_Agg_3;
    Expert_3_1_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_2_GPU0;
    Expert_Route_Comm_3 -> Expert_3_2_GPU1;
    Expert_3_2_GPU0 -> Expert_Agg_3;
    Expert_3_2_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_3_GPU0;
    Expert_Route_Comm_3 -> Expert_3_3_GPU1;
    Expert_3_3_GPU0 -> Expert_Agg_3;
    Expert_3_3_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_4_GPU0;
    Expert_Route_Comm_3 -> Expert_3_4_GPU1;
    Expert_3_4_GPU0 -> Expert_Agg_3;
    Expert_3_4_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_5_GPU0;
    Expert_Route_Comm_3 -> Expert_3_5_GPU1;
    Expert_3_5_GPU0 -> Expert_Agg_3;
    Expert_3_5_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_6_GPU0;
    Expert_Route_Comm_3 -> Expert_3_6_GPU1;
    Expert_3_6_GPU0 -> Expert_Agg_3;
    Expert_3_6_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_7_GPU0;
    Expert_Route_Comm_3 -> Expert_3_7_GPU1;
    Expert_3_7_GPU0 -> Expert_Agg_3;
    Expert_3_7_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_8_GPU0;
    Expert_Route_Comm_3 -> Expert_3_8_GPU1;
    Expert_3_8_GPU0 -> Expert_Agg_3;
    Expert_3_8_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_9_GPU0;
    Expert_Route_Comm_3 -> Expert_3_9_GPU1;
    Expert_3_9_GPU0 -> Expert_Agg_3;
    Expert_3_9_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_10_GPU0;
    Expert_Route_Comm_3 -> Expert_3_10_GPU1;
    Expert_3_10_GPU0 -> Expert_Agg_3;
    Expert_3_10_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_11_GPU0;
    Expert_Route_Comm_3 -> Expert_3_11_GPU1;
    Expert_3_11_GPU0 -> Expert_Agg_3;
    Expert_3_11_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_12_GPU0;
    Expert_Route_Comm_3 -> Expert_3_12_GPU1;
    Expert_3_12_GPU0 -> Expert_Agg_3;
    Expert_3_12_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_13_GPU0;
    Expert_Route_Comm_3 -> Expert_3_13_GPU1;
    Expert_3_13_GPU0 -> Expert_Agg_3;
    Expert_3_13_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_14_GPU0;
    Expert_Route_Comm_3 -> Expert_3_14_GPU1;
    Expert_3_14_GPU0 -> Expert_Agg_3;
    Expert_3_14_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_15_GPU0;
    Expert_Route_Comm_3 -> Expert_3_15_GPU1;
    Expert_3_15_GPU0 -> Expert_Agg_3;
    Expert_3_15_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_16_GPU0;
    Expert_Route_Comm_3 -> Expert_3_16_GPU1;
    Expert_3_16_GPU0 -> Expert_Agg_3;
    Expert_3_16_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_17_GPU0;
    Expert_Route_Comm_3 -> Expert_3_17_GPU1;
    Expert_3_17_GPU0 -> Expert_Agg_3;
    Expert_3_17_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_18_GPU0;
    Expert_Route_Comm_3 -> Expert_3_18_GPU1;
    Expert_3_18_GPU0 -> Expert_Agg_3;
    Expert_3_18_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_19_GPU0;
    Expert_Route_Comm_3 -> Expert_3_19_GPU1;
    Expert_3_19_GPU0 -> Expert_Agg_3;
    Expert_3_19_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_20_GPU0;
    Expert_Route_Comm_3 -> Expert_3_20_GPU1;
    Expert_3_20_GPU0 -> Expert_Agg_3;
    Expert_3_20_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_21_GPU0;
    Expert_Route_Comm_3 -> Expert_3_21_GPU1;
    Expert_3_21_GPU0 -> Expert_Agg_3;
    Expert_3_21_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_22_GPU0;
    Expert_Route_Comm_3 -> Expert_3_22_GPU1;
    Expert_3_22_GPU0 -> Expert_Agg_3;
    Expert_3_22_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_23_GPU0;
    Expert_Route_Comm_3 -> Expert_3_23_GPU1;
    Expert_3_23_GPU0 -> Expert_Agg_3;
    Expert_3_23_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_24_GPU0;
    Expert_Route_Comm_3 -> Expert_3_24_GPU1;
    Expert_3_24_GPU0 -> Expert_Agg_3;
    Expert_3_24_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_25_GPU0;
    Expert_Route_Comm_3 -> Expert_3_25_GPU1;
    Expert_3_25_GPU0 -> Expert_Agg_3;
    Expert_3_25_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_26_GPU0;
    Expert_Route_Comm_3 -> Expert_3_26_GPU1;
    Expert_3_26_GPU0 -> Expert_Agg_3;
    Expert_3_26_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_27_GPU0;
    Expert_Route_Comm_3 -> Expert_3_27_GPU1;
    Expert_3_27_GPU0 -> Expert_Agg_3;
    Expert_3_27_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_28_GPU0;
    Expert_Route_Comm_3 -> Expert_3_28_GPU1;
    Expert_3_28_GPU0 -> Expert_Agg_3;
    Expert_3_28_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_29_GPU0;
    Expert_Route_Comm_3 -> Expert_3_29_GPU1;
    Expert_3_29_GPU0 -> Expert_Agg_3;
    Expert_3_29_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_30_GPU0;
    Expert_Route_Comm_3 -> Expert_3_30_GPU1;
    Expert_3_30_GPU0 -> Expert_Agg_3;
    Expert_3_30_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_31_GPU0;
    Expert_Route_Comm_3 -> Expert_3_31_GPU1;
    Expert_3_31_GPU0 -> Expert_Agg_3;
    Expert_3_31_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_32_GPU0;
    Expert_Route_Comm_3 -> Expert_3_32_GPU1;
    Expert_3_32_GPU0 -> Expert_Agg_3;
    Expert_3_32_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_33_GPU0;
    Expert_Route_Comm_3 -> Expert_3_33_GPU1;
    Expert_3_33_GPU0 -> Expert_Agg_3;
    Expert_3_33_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_34_GPU0;
    Expert_Route_Comm_3 -> Expert_3_34_GPU1;
    Expert_3_34_GPU0 -> Expert_Agg_3;
    Expert_3_34_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_35_GPU0;
    Expert_Route_Comm_3 -> Expert_3_35_GPU1;
    Expert_3_35_GPU0 -> Expert_Agg_3;
    Expert_3_35_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_36_GPU0;
    Expert_Route_Comm_3 -> Expert_3_36_GPU1;
    Expert_3_36_GPU0 -> Expert_Agg_3;
    Expert_3_36_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_37_GPU0;
    Expert_Route_Comm_3 -> Expert_3_37_GPU1;
    Expert_3_37_GPU0 -> Expert_Agg_3;
    Expert_3_37_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_38_GPU0;
    Expert_Route_Comm_3 -> Expert_3_38_GPU1;
    Expert_3_38_GPU0 -> Expert_Agg_3;
    Expert_3_38_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_39_GPU0;
    Expert_Route_Comm_3 -> Expert_3_39_GPU1;
    Expert_3_39_GPU0 -> Expert_Agg_3;
    Expert_3_39_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_40_GPU0;
    Expert_Route_Comm_3 -> Expert_3_40_GPU1;
    Expert_3_40_GPU0 -> Expert_Agg_3;
    Expert_3_40_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_41_GPU0;
    Expert_Route_Comm_3 -> Expert_3_41_GPU1;
    Expert_3_41_GPU0 -> Expert_Agg_3;
    Expert_3_41_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_42_GPU0;
    Expert_Route_Comm_3 -> Expert_3_42_GPU1;
    Expert_3_42_GPU0 -> Expert_Agg_3;
    Expert_3_42_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_43_GPU0;
    Expert_Route_Comm_3 -> Expert_3_43_GPU1;
    Expert_3_43_GPU0 -> Expert_Agg_3;
    Expert_3_43_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_44_GPU0;
    Expert_Route_Comm_3 -> Expert_3_44_GPU1;
    Expert_3_44_GPU0 -> Expert_Agg_3;
    Expert_3_44_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_45_GPU0;
    Expert_Route_Comm_3 -> Expert_3_45_GPU1;
    Expert_3_45_GPU0 -> Expert_Agg_3;
    Expert_3_45_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_46_GPU0;
    Expert_Route_Comm_3 -> Expert_3_46_GPU1;
    Expert_3_46_GPU0 -> Expert_Agg_3;
    Expert_3_46_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_47_GPU0;
    Expert_Route_Comm_3 -> Expert_3_47_GPU1;
    Expert_3_47_GPU0 -> Expert_Agg_3;
    Expert_3_47_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_48_GPU0;
    Expert_Route_Comm_3 -> Expert_3_48_GPU1;
    Expert_3_48_GPU0 -> Expert_Agg_3;
    Expert_3_48_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_49_GPU0;
    Expert_Route_Comm_3 -> Expert_3_49_GPU1;
    Expert_3_49_GPU0 -> Expert_Agg_3;
    Expert_3_49_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_50_GPU0;
    Expert_Route_Comm_3 -> Expert_3_50_GPU1;
    Expert_3_50_GPU0 -> Expert_Agg_3;
    Expert_3_50_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_51_GPU0;
    Expert_Route_Comm_3 -> Expert_3_51_GPU1;
    Expert_3_51_GPU0 -> Expert_Agg_3;
    Expert_3_51_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_52_GPU0;
    Expert_Route_Comm_3 -> Expert_3_52_GPU1;
    Expert_3_52_GPU0 -> Expert_Agg_3;
    Expert_3_52_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_53_GPU0;
    Expert_Route_Comm_3 -> Expert_3_53_GPU1;
    Expert_3_53_GPU0 -> Expert_Agg_3;
    Expert_3_53_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_54_GPU0;
    Expert_Route_Comm_3 -> Expert_3_54_GPU1;
    Expert_3_54_GPU0 -> Expert_Agg_3;
    Expert_3_54_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_55_GPU0;
    Expert_Route_Comm_3 -> Expert_3_55_GPU1;
    Expert_3_55_GPU0 -> Expert_Agg_3;
    Expert_3_55_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_56_GPU0;
    Expert_Route_Comm_3 -> Expert_3_56_GPU1;
    Expert_3_56_GPU0 -> Expert_Agg_3;
    Expert_3_56_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_57_GPU0;
    Expert_Route_Comm_3 -> Expert_3_57_GPU1;
    Expert_3_57_GPU0 -> Expert_Agg_3;
    Expert_3_57_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_58_GPU0;
    Expert_Route_Comm_3 -> Expert_3_58_GPU1;
    Expert_3_58_GPU0 -> Expert_Agg_3;
    Expert_3_58_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_59_GPU0;
    Expert_Route_Comm_3 -> Expert_3_59_GPU1;
    Expert_3_59_GPU0 -> Expert_Agg_3;
    Expert_3_59_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_60_GPU0;
    Expert_Route_Comm_3 -> Expert_3_60_GPU1;
    Expert_3_60_GPU0 -> Expert_Agg_3;
    Expert_3_60_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_61_GPU0;
    Expert_Route_Comm_3 -> Expert_3_61_GPU1;
    Expert_3_61_GPU0 -> Expert_Agg_3;
    Expert_3_61_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_62_GPU0;
    Expert_Route_Comm_3 -> Expert_3_62_GPU1;
    Expert_3_62_GPU0 -> Expert_Agg_3;
    Expert_3_62_GPU1 -> Expert_Agg_3;
    
    Expert_Route_Comm_3 -> Expert_3_63_GPU0;
    Expert_Route_Comm_3 -> Expert_3_63_GPU1;
    Expert_3_63_GPU0 -> Expert_Agg_3;
    Expert_3_63_GPU1 -> Expert_Agg_3;
    
    Expert_Agg_3 -> FFN_GPU0_3;
    Expert_Agg_3 -> FFN_GPU1_3;
    FFN_GPU0_3 -> FFN_Agg_3;
    FFN_GPU1_3 -> FFN_Agg_3;
    FFN_Agg_3 -> LayerNorm_3;
    
    // Layer 4 connections
    LayerNorm_3 -> MHA_Q_GPU0_4;
    LayerNorm_3 -> MHA_K_GPU0_4;
    LayerNorm_3 -> MHA_V_GPU0_4;
    LayerNorm_3 -> MHA_Q_GPU1_4;
    LayerNorm_3 -> MHA_K_GPU1_4;
    LayerNorm_3 -> MHA_V_GPU1_4;
    
    MHA_Q_GPU0_4 -> Attention_Comp_GPU0_4;
    MHA_K_GPU0_4 -> Attention_Comp_GPU0_4;
    MHA_V_GPU0_4 -> Attention_Comp_GPU0_4;
    MHA_Q_GPU1_4 -> Attention_Comp_GPU1_4;
    MHA_K_GPU1_4 -> Attention_Comp_GPU1_4;
    MHA_V_GPU1_4 -> Attention_Comp_GPU1_4;
    
    Attention_Comp_GPU0_4 -> Attention_Agg_4;
    Attention_Comp_GPU1_4 -> Attention_Agg_4;
    
    Attention_Agg_4 -> Gate_Compute_4;
    Gate_Compute_4 -> Gate_Softmax_4;
    
    Gate_Softmax_4 -> Expert_Route_Comm_4 [style=dashed];
    Attention_Agg_4 -> Expert_Route_Comm_4;
    
    Expert_Route_Comm_4 -> Expert_4_0_GPU0;
    Expert_Route_Comm_4 -> Expert_4_0_GPU1;
    Expert_4_0_GPU0 -> Expert_Agg_4;
    Expert_4_0_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_1_GPU0;
    Expert_Route_Comm_4 -> Expert_4_1_GPU1;
    Expert_4_1_GPU0 -> Expert_Agg_4;
    Expert_4_1_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_2_GPU0;
    Expert_Route_Comm_4 -> Expert_4_2_GPU1;
    Expert_4_2_GPU0 -> Expert_Agg_4;
    Expert_4_2_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_3_GPU0;
    Expert_Route_Comm_4 -> Expert_4_3_GPU1;
    Expert_4_3_GPU0 -> Expert_Agg_4;
    Expert_4_3_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_4_GPU0;
    Expert_Route_Comm_4 -> Expert_4_4_GPU1;
    Expert_4_4_GPU0 -> Expert_Agg_4;
    Expert_4_4_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_5_GPU0;
    Expert_Route_Comm_4 -> Expert_4_5_GPU1;
    Expert_4_5_GPU0 -> Expert_Agg_4;
    Expert_4_5_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_6_GPU0;
    Expert_Route_Comm_4 -> Expert_4_6_GPU1;
    Expert_4_6_GPU0 -> Expert_Agg_4;
    Expert_4_6_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_7_GPU0;
    Expert_Route_Comm_4 -> Expert_4_7_GPU1;
    Expert_4_7_GPU0 -> Expert_Agg_4;
    Expert_4_7_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_8_GPU0;
    Expert_Route_Comm_4 -> Expert_4_8_GPU1;
    Expert_4_8_GPU0 -> Expert_Agg_4;
    Expert_4_8_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_9_GPU0;
    Expert_Route_Comm_4 -> Expert_4_9_GPU1;
    Expert_4_9_GPU0 -> Expert_Agg_4;
    Expert_4_9_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_10_GPU0;
    Expert_Route_Comm_4 -> Expert_4_10_GPU1;
    Expert_4_10_GPU0 -> Expert_Agg_4;
    Expert_4_10_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_11_GPU0;
    Expert_Route_Comm_4 -> Expert_4_11_GPU1;
    Expert_4_11_GPU0 -> Expert_Agg_4;
    Expert_4_11_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_12_GPU0;
    Expert_Route_Comm_4 -> Expert_4_12_GPU1;
    Expert_4_12_GPU0 -> Expert_Agg_4;
    Expert_4_12_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_13_GPU0;
    Expert_Route_Comm_4 -> Expert_4_13_GPU1;
    Expert_4_13_GPU0 -> Expert_Agg_4;
    Expert_4_13_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_14_GPU0;
    Expert_Route_Comm_4 -> Expert_4_14_GPU1;
    Expert_4_14_GPU0 -> Expert_Agg_4;
    Expert_4_14_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_15_GPU0;
    Expert_Route_Comm_4 -> Expert_4_15_GPU1;
    Expert_4_15_GPU0 -> Expert_Agg_4;
    Expert_4_15_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_16_GPU0;
    Expert_Route_Comm_4 -> Expert_4_16_GPU1;
    Expert_4_16_GPU0 -> Expert_Agg_4;
    Expert_4_16_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_17_GPU0;
    Expert_Route_Comm_4 -> Expert_4_17_GPU1;
    Expert_4_17_GPU0 -> Expert_Agg_4;
    Expert_4_17_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_18_GPU0;
    Expert_Route_Comm_4 -> Expert_4_18_GPU1;
    Expert_4_18_GPU0 -> Expert_Agg_4;
    Expert_4_18_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_19_GPU0;
    Expert_Route_Comm_4 -> Expert_4_19_GPU1;
    Expert_4_19_GPU0 -> Expert_Agg_4;
    Expert_4_19_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_20_GPU0;
    Expert_Route_Comm_4 -> Expert_4_20_GPU1;
    Expert_4_20_GPU0 -> Expert_Agg_4;
    Expert_4_20_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_21_GPU0;
    Expert_Route_Comm_4 -> Expert_4_21_GPU1;
    Expert_4_21_GPU0 -> Expert_Agg_4;
    Expert_4_21_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_22_GPU0;
    Expert_Route_Comm_4 -> Expert_4_22_GPU1;
    Expert_4_22_GPU0 -> Expert_Agg_4;
    Expert_4_22_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_23_GPU0;
    Expert_Route_Comm_4 -> Expert_4_23_GPU1;
    Expert_4_23_GPU0 -> Expert_Agg_4;
    Expert_4_23_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_24_GPU0;
    Expert_Route_Comm_4 -> Expert_4_24_GPU1;
    Expert_4_24_GPU0 -> Expert_Agg_4;
    Expert_4_24_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_25_GPU0;
    Expert_Route_Comm_4 -> Expert_4_25_GPU1;
    Expert_4_25_GPU0 -> Expert_Agg_4;
    Expert_4_25_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_26_GPU0;
    Expert_Route_Comm_4 -> Expert_4_26_GPU1;
    Expert_4_26_GPU0 -> Expert_Agg_4;
    Expert_4_26_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_27_GPU0;
    Expert_Route_Comm_4 -> Expert_4_27_GPU1;
    Expert_4_27_GPU0 -> Expert_Agg_4;
    Expert_4_27_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_28_GPU0;
    Expert_Route_Comm_4 -> Expert_4_28_GPU1;
    Expert_4_28_GPU0 -> Expert_Agg_4;
    Expert_4_28_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_29_GPU0;
    Expert_Route_Comm_4 -> Expert_4_29_GPU1;
    Expert_4_29_GPU0 -> Expert_Agg_4;
    Expert_4_29_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_30_GPU0;
    Expert_Route_Comm_4 -> Expert_4_30_GPU1;
    Expert_4_30_GPU0 -> Expert_Agg_4;
    Expert_4_30_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_31_GPU0;
    Expert_Route_Comm_4 -> Expert_4_31_GPU1;
    Expert_4_31_GPU0 -> Expert_Agg_4;
    Expert_4_31_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_32_GPU0;
    Expert_Route_Comm_4 -> Expert_4_32_GPU1;
    Expert_4_32_GPU0 -> Expert_Agg_4;
    Expert_4_32_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_33_GPU0;
    Expert_Route_Comm_4 -> Expert_4_33_GPU1;
    Expert_4_33_GPU0 -> Expert_Agg_4;
    Expert_4_33_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_34_GPU0;
    Expert_Route_Comm_4 -> Expert_4_34_GPU1;
    Expert_4_34_GPU0 -> Expert_Agg_4;
    Expert_4_34_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_35_GPU0;
    Expert_Route_Comm_4 -> Expert_4_35_GPU1;
    Expert_4_35_GPU0 -> Expert_Agg_4;
    Expert_4_35_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_36_GPU0;
    Expert_Route_Comm_4 -> Expert_4_36_GPU1;
    Expert_4_36_GPU0 -> Expert_Agg_4;
    Expert_4_36_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_37_GPU0;
    Expert_Route_Comm_4 -> Expert_4_37_GPU1;
    Expert_4_37_GPU0 -> Expert_Agg_4;
    Expert_4_37_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_38_GPU0;
    Expert_Route_Comm_4 -> Expert_4_38_GPU1;
    Expert_4_38_GPU0 -> Expert_Agg_4;
    Expert_4_38_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_39_GPU0;
    Expert_Route_Comm_4 -> Expert_4_39_GPU1;
    Expert_4_39_GPU0 -> Expert_Agg_4;
    Expert_4_39_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_40_GPU0;
    Expert_Route_Comm_4 -> Expert_4_40_GPU1;
    Expert_4_40_GPU0 -> Expert_Agg_4;
    Expert_4_40_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_41_GPU0;
    Expert_Route_Comm_4 -> Expert_4_41_GPU1;
    Expert_4_41_GPU0 -> Expert_Agg_4;
    Expert_4_41_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_42_GPU0;
    Expert_Route_Comm_4 -> Expert_4_42_GPU1;
    Expert_4_42_GPU0 -> Expert_Agg_4;
    Expert_4_42_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_43_GPU0;
    Expert_Route_Comm_4 -> Expert_4_43_GPU1;
    Expert_4_43_GPU0 -> Expert_Agg_4;
    Expert_4_43_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_44_GPU0;
    Expert_Route_Comm_4 -> Expert_4_44_GPU1;
    Expert_4_44_GPU0 -> Expert_Agg_4;
    Expert_4_44_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_45_GPU0;
    Expert_Route_Comm_4 -> Expert_4_45_GPU1;
    Expert_4_45_GPU0 -> Expert_Agg_4;
    Expert_4_45_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_46_GPU0;
    Expert_Route_Comm_4 -> Expert_4_46_GPU1;
    Expert_4_46_GPU0 -> Expert_Agg_4;
    Expert_4_46_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_47_GPU0;
    Expert_Route_Comm_4 -> Expert_4_47_GPU1;
    Expert_4_47_GPU0 -> Expert_Agg_4;
    Expert_4_47_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_48_GPU0;
    Expert_Route_Comm_4 -> Expert_4_48_GPU1;
    Expert_4_48_GPU0 -> Expert_Agg_4;
    Expert_4_48_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_49_GPU0;
    Expert_Route_Comm_4 -> Expert_4_49_GPU1;
    Expert_4_49_GPU0 -> Expert_Agg_4;
    Expert_4_49_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_50_GPU0;
    Expert_Route_Comm_4 -> Expert_4_50_GPU1;
    Expert_4_50_GPU0 -> Expert_Agg_4;
    Expert_4_50_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_51_GPU0;
    Expert_Route_Comm_4 -> Expert_4_51_GPU1;
    Expert_4_51_GPU0 -> Expert_Agg_4;
    Expert_4_51_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_52_GPU0;
    Expert_Route_Comm_4 -> Expert_4_52_GPU1;
    Expert_4_52_GPU0 -> Expert_Agg_4;
    Expert_4_52_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_53_GPU0;
    Expert_Route_Comm_4 -> Expert_4_53_GPU1;
    Expert_4_53_GPU0 -> Expert_Agg_4;
    Expert_4_53_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_54_GPU0;
    Expert_Route_Comm_4 -> Expert_4_54_GPU1;
    Expert_4_54_GPU0 -> Expert_Agg_4;
    Expert_4_54_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_55_GPU0;
    Expert_Route_Comm_4 -> Expert_4_55_GPU1;
    Expert_4_55_GPU0 -> Expert_Agg_4;
    Expert_4_55_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_56_GPU0;
    Expert_Route_Comm_4 -> Expert_4_56_GPU1;
    Expert_4_56_GPU0 -> Expert_Agg_4;
    Expert_4_56_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_57_GPU0;
    Expert_Route_Comm_4 -> Expert_4_57_GPU1;
    Expert_4_57_GPU0 -> Expert_Agg_4;
    Expert_4_57_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_58_GPU0;
    Expert_Route_Comm_4 -> Expert_4_58_GPU1;
    Expert_4_58_GPU0 -> Expert_Agg_4;
    Expert_4_58_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_59_GPU0;
    Expert_Route_Comm_4 -> Expert_4_59_GPU1;
    Expert_4_59_GPU0 -> Expert_Agg_4;
    Expert_4_59_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_60_GPU0;
    Expert_Route_Comm_4 -> Expert_4_60_GPU1;
    Expert_4_60_GPU0 -> Expert_Agg_4;
    Expert_4_60_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_61_GPU0;
    Expert_Route_Comm_4 -> Expert_4_61_GPU1;
    Expert_4_61_GPU0 -> Expert_Agg_4;
    Expert_4_61_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_62_GPU0;
    Expert_Route_Comm_4 -> Expert_4_62_GPU1;
    Expert_4_62_GPU0 -> Expert_Agg_4;
    Expert_4_62_GPU1 -> Expert_Agg_4;
    
    Expert_Route_Comm_4 -> Expert_4_63_GPU0;
    Expert_Route_Comm_4 -> Expert_4_63_GPU1;
    Expert_4_63_GPU0 -> Expert_Agg_4;
    Expert_4_63_GPU1 -> Expert_Agg_4;
    
    Expert_Agg_4 -> FFN_GPU0_4;
    Expert_Agg_4 -> FFN_GPU1_4;
    FFN_GPU0_4 -> FFN_Agg_4;
    FFN_GPU1_4 -> FFN_Agg_4;
    FFN_Agg_4 -> LayerNorm_4;
    
    // Layer 5 connections
    LayerNorm_4 -> MHA_Q_GPU0_5;
    LayerNorm_4 -> MHA_K_GPU0_5;
    LayerNorm_4 -> MHA_V_GPU0_5;
    LayerNorm_4 -> MHA_Q_GPU1_5;
    LayerNorm_4 -> MHA_K_GPU1_5;
    LayerNorm_4 -> MHA_V_GPU1_5;
    
    MHA_Q_GPU0_5 -> Attention_Comp_GPU0_5;
    MHA_K_GPU0_5 -> Attention_Comp_GPU0_5;
    MHA_V_GPU0_5 -> Attention_Comp_GPU0_5;
    MHA_Q_GPU1_5 -> Attention_Comp_GPU1_5;
    MHA_K_GPU1_5 -> Attention_Comp_GPU1_5;
    MHA_V_GPU1_5 -> Attention_Comp_GPU1_5;
    
    Attention_Comp_GPU0_5 -> Attention_Agg_5;
    Attention_Comp_GPU1_5 -> Attention_Agg_5;
    
    Attention_Agg_5 -> Gate_Compute_5;
    Gate_Compute_5 -> Gate_Softmax_5;
    
    Gate_Softmax_5 -> Expert_Route_Comm_5 [style=dashed];
    Attention_Agg_5 -> Expert_Route_Comm_5;
    
    Expert_Route_Comm_5 -> Expert_5_0_GPU0;
    Expert_Route_Comm_5 -> Expert_5_0_GPU1;
    Expert_5_0_GPU0 -> Expert_Agg_5;
    Expert_5_0_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_1_GPU0;
    Expert_Route_Comm_5 -> Expert_5_1_GPU1;
    Expert_5_1_GPU0 -> Expert_Agg_5;
    Expert_5_1_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_2_GPU0;
    Expert_Route_Comm_5 -> Expert_5_2_GPU1;
    Expert_5_2_GPU0 -> Expert_Agg_5;
    Expert_5_2_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_3_GPU0;
    Expert_Route_Comm_5 -> Expert_5_3_GPU1;
    Expert_5_3_GPU0 -> Expert_Agg_5;
    Expert_5_3_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_4_GPU0;
    Expert_Route_Comm_5 -> Expert_5_4_GPU1;
    Expert_5_4_GPU0 -> Expert_Agg_5;
    Expert_5_4_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_5_GPU0;
    Expert_Route_Comm_5 -> Expert_5_5_GPU1;
    Expert_5_5_GPU0 -> Expert_Agg_5;
    Expert_5_5_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_6_GPU0;
    Expert_Route_Comm_5 -> Expert_5_6_GPU1;
    Expert_5_6_GPU0 -> Expert_Agg_5;
    Expert_5_6_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_7_GPU0;
    Expert_Route_Comm_5 -> Expert_5_7_GPU1;
    Expert_5_7_GPU0 -> Expert_Agg_5;
    Expert_5_7_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_8_GPU0;
    Expert_Route_Comm_5 -> Expert_5_8_GPU1;
    Expert_5_8_GPU0 -> Expert_Agg_5;
    Expert_5_8_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_9_GPU0;
    Expert_Route_Comm_5 -> Expert_5_9_GPU1;
    Expert_5_9_GPU0 -> Expert_Agg_5;
    Expert_5_9_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_10_GPU0;
    Expert_Route_Comm_5 -> Expert_5_10_GPU1;
    Expert_5_10_GPU0 -> Expert_Agg_5;
    Expert_5_10_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_11_GPU0;
    Expert_Route_Comm_5 -> Expert_5_11_GPU1;
    Expert_5_11_GPU0 -> Expert_Agg_5;
    Expert_5_11_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_12_GPU0;
    Expert_Route_Comm_5 -> Expert_5_12_GPU1;
    Expert_5_12_GPU0 -> Expert_Agg_5;
    Expert_5_12_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_13_GPU0;
    Expert_Route_Comm_5 -> Expert_5_13_GPU1;
    Expert_5_13_GPU0 -> Expert_Agg_5;
    Expert_5_13_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_14_GPU0;
    Expert_Route_Comm_5 -> Expert_5_14_GPU1;
    Expert_5_14_GPU0 -> Expert_Agg_5;
    Expert_5_14_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_15_GPU0;
    Expert_Route_Comm_5 -> Expert_5_15_GPU1;
    Expert_5_15_GPU0 -> Expert_Agg_5;
    Expert_5_15_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_16_GPU0;
    Expert_Route_Comm_5 -> Expert_5_16_GPU1;
    Expert_5_16_GPU0 -> Expert_Agg_5;
    Expert_5_16_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_17_GPU0;
    Expert_Route_Comm_5 -> Expert_5_17_GPU1;
    Expert_5_17_GPU0 -> Expert_Agg_5;
    Expert_5_17_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_18_GPU0;
    Expert_Route_Comm_5 -> Expert_5_18_GPU1;
    Expert_5_18_GPU0 -> Expert_Agg_5;
    Expert_5_18_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_19_GPU0;
    Expert_Route_Comm_5 -> Expert_5_19_GPU1;
    Expert_5_19_GPU0 -> Expert_Agg_5;
    Expert_5_19_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_20_GPU0;
    Expert_Route_Comm_5 -> Expert_5_20_GPU1;
    Expert_5_20_GPU0 -> Expert_Agg_5;
    Expert_5_20_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_21_GPU0;
    Expert_Route_Comm_5 -> Expert_5_21_GPU1;
    Expert_5_21_GPU0 -> Expert_Agg_5;
    Expert_5_21_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_22_GPU0;
    Expert_Route_Comm_5 -> Expert_5_22_GPU1;
    Expert_5_22_GPU0 -> Expert_Agg_5;
    Expert_5_22_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_23_GPU0;
    Expert_Route_Comm_5 -> Expert_5_23_GPU1;
    Expert_5_23_GPU0 -> Expert_Agg_5;
    Expert_5_23_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_24_GPU0;
    Expert_Route_Comm_5 -> Expert_5_24_GPU1;
    Expert_5_24_GPU0 -> Expert_Agg_5;
    Expert_5_24_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_25_GPU0;
    Expert_Route_Comm_5 -> Expert_5_25_GPU1;
    Expert_5_25_GPU0 -> Expert_Agg_5;
    Expert_5_25_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_26_GPU0;
    Expert_Route_Comm_5 -> Expert_5_26_GPU1;
    Expert_5_26_GPU0 -> Expert_Agg_5;
    Expert_5_26_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_27_GPU0;
    Expert_Route_Comm_5 -> Expert_5_27_GPU1;
    Expert_5_27_GPU0 -> Expert_Agg_5;
    Expert_5_27_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_28_GPU0;
    Expert_Route_Comm_5 -> Expert_5_28_GPU1;
    Expert_5_28_GPU0 -> Expert_Agg_5;
    Expert_5_28_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_29_GPU0;
    Expert_Route_Comm_5 -> Expert_5_29_GPU1;
    Expert_5_29_GPU0 -> Expert_Agg_5;
    Expert_5_29_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_30_GPU0;
    Expert_Route_Comm_5 -> Expert_5_30_GPU1;
    Expert_5_30_GPU0 -> Expert_Agg_5;
    Expert_5_30_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_31_GPU0;
    Expert_Route_Comm_5 -> Expert_5_31_GPU1;
    Expert_5_31_GPU0 -> Expert_Agg_5;
    Expert_5_31_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_32_GPU0;
    Expert_Route_Comm_5 -> Expert_5_32_GPU1;
    Expert_5_32_GPU0 -> Expert_Agg_5;
    Expert_5_32_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_33_GPU0;
    Expert_Route_Comm_5 -> Expert_5_33_GPU1;
    Expert_5_33_GPU0 -> Expert_Agg_5;
    Expert_5_33_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_34_GPU0;
    Expert_Route_Comm_5 -> Expert_5_34_GPU1;
    Expert_5_34_GPU0 -> Expert_Agg_5;
    Expert_5_34_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_35_GPU0;
    Expert_Route_Comm_5 -> Expert_5_35_GPU1;
    Expert_5_35_GPU0 -> Expert_Agg_5;
    Expert_5_35_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_36_GPU0;
    Expert_Route_Comm_5 -> Expert_5_36_GPU1;
    Expert_5_36_GPU0 -> Expert_Agg_5;
    Expert_5_36_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_37_GPU0;
    Expert_Route_Comm_5 -> Expert_5_37_GPU1;
    Expert_5_37_GPU0 -> Expert_Agg_5;
    Expert_5_37_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_38_GPU0;
    Expert_Route_Comm_5 -> Expert_5_38_GPU1;
    Expert_5_38_GPU0 -> Expert_Agg_5;
    Expert_5_38_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_39_GPU0;
    Expert_Route_Comm_5 -> Expert_5_39_GPU1;
    Expert_5_39_GPU0 -> Expert_Agg_5;
    Expert_5_39_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_40_GPU0;
    Expert_Route_Comm_5 -> Expert_5_40_GPU1;
    Expert_5_40_GPU0 -> Expert_Agg_5;
    Expert_5_40_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_41_GPU0;
    Expert_Route_Comm_5 -> Expert_5_41_GPU1;
    Expert_5_41_GPU0 -> Expert_Agg_5;
    Expert_5_41_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_42_GPU0;
    Expert_Route_Comm_5 -> Expert_5_42_GPU1;
    Expert_5_42_GPU0 -> Expert_Agg_5;
    Expert_5_42_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_43_GPU0;
    Expert_Route_Comm_5 -> Expert_5_43_GPU1;
    Expert_5_43_GPU0 -> Expert_Agg_5;
    Expert_5_43_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_44_GPU0;
    Expert_Route_Comm_5 -> Expert_5_44_GPU1;
    Expert_5_44_GPU0 -> Expert_Agg_5;
    Expert_5_44_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_45_GPU0;
    Expert_Route_Comm_5 -> Expert_5_45_GPU1;
    Expert_5_45_GPU0 -> Expert_Agg_5;
    Expert_5_45_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_46_GPU0;
    Expert_Route_Comm_5 -> Expert_5_46_GPU1;
    Expert_5_46_GPU0 -> Expert_Agg_5;
    Expert_5_46_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_47_GPU0;
    Expert_Route_Comm_5 -> Expert_5_47_GPU1;
    Expert_5_47_GPU0 -> Expert_Agg_5;
    Expert_5_47_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_48_GPU0;
    Expert_Route_Comm_5 -> Expert_5_48_GPU1;
    Expert_5_48_GPU0 -> Expert_Agg_5;
    Expert_5_48_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_49_GPU0;
    Expert_Route_Comm_5 -> Expert_5_49_GPU1;
    Expert_5_49_GPU0 -> Expert_Agg_5;
    Expert_5_49_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_50_GPU0;
    Expert_Route_Comm_5 -> Expert_5_50_GPU1;
    Expert_5_50_GPU0 -> Expert_Agg_5;
    Expert_5_50_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_51_GPU0;
    Expert_Route_Comm_5 -> Expert_5_51_GPU1;
    Expert_5_51_GPU0 -> Expert_Agg_5;
    Expert_5_51_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_52_GPU0;
    Expert_Route_Comm_5 -> Expert_5_52_GPU1;
    Expert_5_52_GPU0 -> Expert_Agg_5;
    Expert_5_52_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_53_GPU0;
    Expert_Route_Comm_5 -> Expert_5_53_GPU1;
    Expert_5_53_GPU0 -> Expert_Agg_5;
    Expert_5_53_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_54_GPU0;
    Expert_Route_Comm_5 -> Expert_5_54_GPU1;
    Expert_5_54_GPU0 -> Expert_Agg_5;
    Expert_5_54_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_55_GPU0;
    Expert_Route_Comm_5 -> Expert_5_55_GPU1;
    Expert_5_55_GPU0 -> Expert_Agg_5;
    Expert_5_55_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_56_GPU0;
    Expert_Route_Comm_5 -> Expert_5_56_GPU1;
    Expert_5_56_GPU0 -> Expert_Agg_5;
    Expert_5_56_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_57_GPU0;
    Expert_Route_Comm_5 -> Expert_5_57_GPU1;
    Expert_5_57_GPU0 -> Expert_Agg_5;
    Expert_5_57_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_58_GPU0;
    Expert_Route_Comm_5 -> Expert_5_58_GPU1;
    Expert_5_58_GPU0 -> Expert_Agg_5;
    Expert_5_58_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_59_GPU0;
    Expert_Route_Comm_5 -> Expert_5_59_GPU1;
    Expert_5_59_GPU0 -> Expert_Agg_5;
    Expert_5_59_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_60_GPU0;
    Expert_Route_Comm_5 -> Expert_5_60_GPU1;
    Expert_5_60_GPU0 -> Expert_Agg_5;
    Expert_5_60_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_61_GPU0;
    Expert_Route_Comm_5 -> Expert_5_61_GPU1;
    Expert_5_61_GPU0 -> Expert_Agg_5;
    Expert_5_61_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_62_GPU0;
    Expert_Route_Comm_5 -> Expert_5_62_GPU1;
    Expert_5_62_GPU0 -> Expert_Agg_5;
    Expert_5_62_GPU1 -> Expert_Agg_5;
    
    Expert_Route_Comm_5 -> Expert_5_63_GPU0;
    Expert_Route_Comm_5 -> Expert_5_63_GPU1;
    Expert_5_63_GPU0 -> Expert_Agg_5;
    Expert_5_63_GPU1 -> Expert_Agg_5;
    
    Expert_Agg_5 -> FFN_GPU0_5;
    Expert_Agg_5 -> FFN_GPU1_5;
    FFN_GPU0_5 -> FFN_Agg_5;
    FFN_GPU1_5 -> FFN_Agg_5;
    FFN_Agg_5 -> LayerNorm_5;
    
    // Layer 6 connections
    LayerNorm_5 -> MHA_Q_GPU0_6;
    LayerNorm_5 -> MHA_K_GPU0_6;
    LayerNorm_5 -> MHA_V_GPU0_6;
    LayerNorm_5 -> MHA_Q_GPU1_6;
    LayerNorm_5 -> MHA_K_GPU1_6;
    LayerNorm_5 -> MHA_V_GPU1_6;
    
    MHA_Q_GPU0_6 -> Attention_Comp_GPU0_6;
    MHA_K_GPU0_6 -> Attention_Comp_GPU0_6;
    MHA_V_GPU0_6 -> Attention_Comp_GPU0_6;
    MHA_Q_GPU1_6 -> Attention_Comp_GPU1_6;
    MHA_K_GPU1_6 -> Attention_Comp_GPU1_6;
    MHA_V_GPU1_6 -> Attention_Comp_GPU1_6;
    
    Attention_Comp_GPU0_6 -> Attention_Agg_6;
    Attention_Comp_GPU1_6 -> Attention_Agg_6;
    
    Attention_Agg_6 -> Gate_Compute_6;
    Gate_Compute_6 -> Gate_Softmax_6;
    
    Gate_Softmax_6 -> Expert_Route_Comm_6 [style=dashed];
    Attention_Agg_6 -> Expert_Route_Comm_6;
    
    Expert_Route_Comm_6 -> Expert_6_0_GPU0;
    Expert_Route_Comm_6 -> Expert_6_0_GPU1;
    Expert_6_0_GPU0 -> Expert_Agg_6;
    Expert_6_0_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_1_GPU0;
    Expert_Route_Comm_6 -> Expert_6_1_GPU1;
    Expert_6_1_GPU0 -> Expert_Agg_6;
    Expert_6_1_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_2_GPU0;
    Expert_Route_Comm_6 -> Expert_6_2_GPU1;
    Expert_6_2_GPU0 -> Expert_Agg_6;
    Expert_6_2_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_3_GPU0;
    Expert_Route_Comm_6 -> Expert_6_3_GPU1;
    Expert_6_3_GPU0 -> Expert_Agg_6;
    Expert_6_3_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_4_GPU0;
    Expert_Route_Comm_6 -> Expert_6_4_GPU1;
    Expert_6_4_GPU0 -> Expert_Agg_6;
    Expert_6_4_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_5_GPU0;
    Expert_Route_Comm_6 -> Expert_6_5_GPU1;
    Expert_6_5_GPU0 -> Expert_Agg_6;
    Expert_6_5_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_6_GPU0;
    Expert_Route_Comm_6 -> Expert_6_6_GPU1;
    Expert_6_6_GPU0 -> Expert_Agg_6;
    Expert_6_6_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_7_GPU0;
    Expert_Route_Comm_6 -> Expert_6_7_GPU1;
    Expert_6_7_GPU0 -> Expert_Agg_6;
    Expert_6_7_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_8_GPU0;
    Expert_Route_Comm_6 -> Expert_6_8_GPU1;
    Expert_6_8_GPU0 -> Expert_Agg_6;
    Expert_6_8_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_9_GPU0;
    Expert_Route_Comm_6 -> Expert_6_9_GPU1;
    Expert_6_9_GPU0 -> Expert_Agg_6;
    Expert_6_9_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_10_GPU0;
    Expert_Route_Comm_6 -> Expert_6_10_GPU1;
    Expert_6_10_GPU0 -> Expert_Agg_6;
    Expert_6_10_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_11_GPU0;
    Expert_Route_Comm_6 -> Expert_6_11_GPU1;
    Expert_6_11_GPU0 -> Expert_Agg_6;
    Expert_6_11_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_12_GPU0;
    Expert_Route_Comm_6 -> Expert_6_12_GPU1;
    Expert_6_12_GPU0 -> Expert_Agg_6;
    Expert_6_12_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_13_GPU0;
    Expert_Route_Comm_6 -> Expert_6_13_GPU1;
    Expert_6_13_GPU0 -> Expert_Agg_6;
    Expert_6_13_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_14_GPU0;
    Expert_Route_Comm_6 -> Expert_6_14_GPU1;
    Expert_6_14_GPU0 -> Expert_Agg_6;
    Expert_6_14_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_15_GPU0;
    Expert_Route_Comm_6 -> Expert_6_15_GPU1;
    Expert_6_15_GPU0 -> Expert_Agg_6;
    Expert_6_15_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_16_GPU0;
    Expert_Route_Comm_6 -> Expert_6_16_GPU1;
    Expert_6_16_GPU0 -> Expert_Agg_6;
    Expert_6_16_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_17_GPU0;
    Expert_Route_Comm_6 -> Expert_6_17_GPU1;
    Expert_6_17_GPU0 -> Expert_Agg_6;
    Expert_6_17_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_18_GPU0;
    Expert_Route_Comm_6 -> Expert_6_18_GPU1;
    Expert_6_18_GPU0 -> Expert_Agg_6;
    Expert_6_18_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_19_GPU0;
    Expert_Route_Comm_6 -> Expert_6_19_GPU1;
    Expert_6_19_GPU0 -> Expert_Agg_6;
    Expert_6_19_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_20_GPU0;
    Expert_Route_Comm_6 -> Expert_6_20_GPU1;
    Expert_6_20_GPU0 -> Expert_Agg_6;
    Expert_6_20_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_21_GPU0;
    Expert_Route_Comm_6 -> Expert_6_21_GPU1;
    Expert_6_21_GPU0 -> Expert_Agg_6;
    Expert_6_21_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_22_GPU0;
    Expert_Route_Comm_6 -> Expert_6_22_GPU1;
    Expert_6_22_GPU0 -> Expert_Agg_6;
    Expert_6_22_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_23_GPU0;
    Expert_Route_Comm_6 -> Expert_6_23_GPU1;
    Expert_6_23_GPU0 -> Expert_Agg_6;
    Expert_6_23_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_24_GPU0;
    Expert_Route_Comm_6 -> Expert_6_24_GPU1;
    Expert_6_24_GPU0 -> Expert_Agg_6;
    Expert_6_24_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_25_GPU0;
    Expert_Route_Comm_6 -> Expert_6_25_GPU1;
    Expert_6_25_GPU0 -> Expert_Agg_6;
    Expert_6_25_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_26_GPU0;
    Expert_Route_Comm_6 -> Expert_6_26_GPU1;
    Expert_6_26_GPU0 -> Expert_Agg_6;
    Expert_6_26_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_27_GPU0;
    Expert_Route_Comm_6 -> Expert_6_27_GPU1;
    Expert_6_27_GPU0 -> Expert_Agg_6;
    Expert_6_27_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_28_GPU0;
    Expert_Route_Comm_6 -> Expert_6_28_GPU1;
    Expert_6_28_GPU0 -> Expert_Agg_6;
    Expert_6_28_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_29_GPU0;
    Expert_Route_Comm_6 -> Expert_6_29_GPU1;
    Expert_6_29_GPU0 -> Expert_Agg_6;
    Expert_6_29_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_30_GPU0;
    Expert_Route_Comm_6 -> Expert_6_30_GPU1;
    Expert_6_30_GPU0 -> Expert_Agg_6;
    Expert_6_30_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_31_GPU0;
    Expert_Route_Comm_6 -> Expert_6_31_GPU1;
    Expert_6_31_GPU0 -> Expert_Agg_6;
    Expert_6_31_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_32_GPU0;
    Expert_Route_Comm_6 -> Expert_6_32_GPU1;
    Expert_6_32_GPU0 -> Expert_Agg_6;
    Expert_6_32_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_33_GPU0;
    Expert_Route_Comm_6 -> Expert_6_33_GPU1;
    Expert_6_33_GPU0 -> Expert_Agg_6;
    Expert_6_33_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_34_GPU0;
    Expert_Route_Comm_6 -> Expert_6_34_GPU1;
    Expert_6_34_GPU0 -> Expert_Agg_6;
    Expert_6_34_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_35_GPU0;
    Expert_Route_Comm_6 -> Expert_6_35_GPU1;
    Expert_6_35_GPU0 -> Expert_Agg_6;
    Expert_6_35_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_36_GPU0;
    Expert_Route_Comm_6 -> Expert_6_36_GPU1;
    Expert_6_36_GPU0 -> Expert_Agg_6;
    Expert_6_36_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_37_GPU0;
    Expert_Route_Comm_6 -> Expert_6_37_GPU1;
    Expert_6_37_GPU0 -> Expert_Agg_6;
    Expert_6_37_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_38_GPU0;
    Expert_Route_Comm_6 -> Expert_6_38_GPU1;
    Expert_6_38_GPU0 -> Expert_Agg_6;
    Expert_6_38_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_39_GPU0;
    Expert_Route_Comm_6 -> Expert_6_39_GPU1;
    Expert_6_39_GPU0 -> Expert_Agg_6;
    Expert_6_39_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_40_GPU0;
    Expert_Route_Comm_6 -> Expert_6_40_GPU1;
    Expert_6_40_GPU0 -> Expert_Agg_6;
    Expert_6_40_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_41_GPU0;
    Expert_Route_Comm_6 -> Expert_6_41_GPU1;
    Expert_6_41_GPU0 -> Expert_Agg_6;
    Expert_6_41_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_42_GPU0;
    Expert_Route_Comm_6 -> Expert_6_42_GPU1;
    Expert_6_42_GPU0 -> Expert_Agg_6;
    Expert_6_42_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_43_GPU0;
    Expert_Route_Comm_6 -> Expert_6_43_GPU1;
    Expert_6_43_GPU0 -> Expert_Agg_6;
    Expert_6_43_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_44_GPU0;
    Expert_Route_Comm_6 -> Expert_6_44_GPU1;
    Expert_6_44_GPU0 -> Expert_Agg_6;
    Expert_6_44_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_45_GPU0;
    Expert_Route_Comm_6 -> Expert_6_45_GPU1;
    Expert_6_45_GPU0 -> Expert_Agg_6;
    Expert_6_45_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_46_GPU0;
    Expert_Route_Comm_6 -> Expert_6_46_GPU1;
    Expert_6_46_GPU0 -> Expert_Agg_6;
    Expert_6_46_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_47_GPU0;
    Expert_Route_Comm_6 -> Expert_6_47_GPU1;
    Expert_6_47_GPU0 -> Expert_Agg_6;
    Expert_6_47_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_48_GPU0;
    Expert_Route_Comm_6 -> Expert_6_48_GPU1;
    Expert_6_48_GPU0 -> Expert_Agg_6;
    Expert_6_48_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_49_GPU0;
    Expert_Route_Comm_6 -> Expert_6_49_GPU1;
    Expert_6_49_GPU0 -> Expert_Agg_6;
    Expert_6_49_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_50_GPU0;
    Expert_Route_Comm_6 -> Expert_6_50_GPU1;
    Expert_6_50_GPU0 -> Expert_Agg_6;
    Expert_6_50_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_51_GPU0;
    Expert_Route_Comm_6 -> Expert_6_51_GPU1;
    Expert_6_51_GPU0 -> Expert_Agg_6;
    Expert_6_51_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_52_GPU0;
    Expert_Route_Comm_6 -> Expert_6_52_GPU1;
    Expert_6_52_GPU0 -> Expert_Agg_6;
    Expert_6_52_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_53_GPU0;
    Expert_Route_Comm_6 -> Expert_6_53_GPU1;
    Expert_6_53_GPU0 -> Expert_Agg_6;
    Expert_6_53_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_54_GPU0;
    Expert_Route_Comm_6 -> Expert_6_54_GPU1;
    Expert_6_54_GPU0 -> Expert_Agg_6;
    Expert_6_54_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_55_GPU0;
    Expert_Route_Comm_6 -> Expert_6_55_GPU1;
    Expert_6_55_GPU0 -> Expert_Agg_6;
    Expert_6_55_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_56_GPU0;
    Expert_Route_Comm_6 -> Expert_6_56_GPU1;
    Expert_6_56_GPU0 -> Expert_Agg_6;
    Expert_6_56_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_57_GPU0;
    Expert_Route_Comm_6 -> Expert_6_57_GPU1;
    Expert_6_57_GPU0 -> Expert_Agg_6;
    Expert_6_57_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_58_GPU0;
    Expert_Route_Comm_6 -> Expert_6_58_GPU1;
    Expert_6_58_GPU0 -> Expert_Agg_6;
    Expert_6_58_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_59_GPU0;
    Expert_Route_Comm_6 -> Expert_6_59_GPU1;
    Expert_6_59_GPU0 -> Expert_Agg_6;
    Expert_6_59_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_60_GPU0;
    Expert_Route_Comm_6 -> Expert_6_60_GPU1;
    Expert_6_60_GPU0 -> Expert_Agg_6;
    Expert_6_60_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_61_GPU0;
    Expert_Route_Comm_6 -> Expert_6_61_GPU1;
    Expert_6_61_GPU0 -> Expert_Agg_6;
    Expert_6_61_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_62_GPU0;
    Expert_Route_Comm_6 -> Expert_6_62_GPU1;
    Expert_6_62_GPU0 -> Expert_Agg_6;
    Expert_6_62_GPU1 -> Expert_Agg_6;
    
    Expert_Route_Comm_6 -> Expert_6_63_GPU0;
    Expert_Route_Comm_6 -> Expert_6_63_GPU1;
    Expert_6_63_GPU0 -> Expert_Agg_6;
    Expert_6_63_GPU1 -> Expert_Agg_6;
    
    Expert_Agg_6 -> FFN_GPU0_6;
    Expert_Agg_6 -> FFN_GPU1_6;
    FFN_GPU0_6 -> FFN_Agg_6;
    FFN_GPU1_6 -> FFN_Agg_6;
    FFN_Agg_6 -> LayerNorm_6;
    
    // Layer 7 connections
    LayerNorm_6 -> MHA_Q_GPU0_7;
    LayerNorm_6 -> MHA_K_GPU0_7;
    LayerNorm_6 -> MHA_V_GPU0_7;
    LayerNorm_6 -> MHA_Q_GPU1_7;
    LayerNorm_6 -> MHA_K_GPU1_7;
    LayerNorm_6 -> MHA_V_GPU1_7;
    
    MHA_Q_GPU0_7 -> Attention_Comp_GPU0_7;
    MHA_K_GPU0_7 -> Attention_Comp_GPU0_7;
    MHA_V_GPU0_7 -> Attention_Comp_GPU0_7;
    MHA_Q_GPU1_7 -> Attention_Comp_GPU1_7;
    MHA_K_GPU1_7 -> Attention_Comp_GPU1_7;
    MHA_V_GPU1_7 -> Attention_Comp_GPU1_7;
    
    Attention_Comp_GPU0_7 -> Attention_Agg_7;
    Attention_Comp_GPU1_7 -> Attention_Agg_7;
    
    Attention_Agg_7 -> Gate_Compute_7;
    Gate_Compute_7 -> Gate_Softmax_7;
    
    Gate_Softmax_7 -> Expert_Route_Comm_7 [style=dashed];
    Attention_Agg_7 -> Expert_Route_Comm_7;
    
    Expert_Route_Comm_7 -> Expert_7_0_GPU0;
    Expert_Route_Comm_7 -> Expert_7_0_GPU1;
    Expert_7_0_GPU0 -> Expert_Agg_7;
    Expert_7_0_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_1_GPU0;
    Expert_Route_Comm_7 -> Expert_7_1_GPU1;
    Expert_7_1_GPU0 -> Expert_Agg_7;
    Expert_7_1_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_2_GPU0;
    Expert_Route_Comm_7 -> Expert_7_2_GPU1;
    Expert_7_2_GPU0 -> Expert_Agg_7;
    Expert_7_2_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_3_GPU0;
    Expert_Route_Comm_7 -> Expert_7_3_GPU1;
    Expert_7_3_GPU0 -> Expert_Agg_7;
    Expert_7_3_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_4_GPU0;
    Expert_Route_Comm_7 -> Expert_7_4_GPU1;
    Expert_7_4_GPU0 -> Expert_Agg_7;
    Expert_7_4_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_5_GPU0;
    Expert_Route_Comm_7 -> Expert_7_5_GPU1;
    Expert_7_5_GPU0 -> Expert_Agg_7;
    Expert_7_5_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_6_GPU0;
    Expert_Route_Comm_7 -> Expert_7_6_GPU1;
    Expert_7_6_GPU0 -> Expert_Agg_7;
    Expert_7_6_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_7_GPU0;
    Expert_Route_Comm_7 -> Expert_7_7_GPU1;
    Expert_7_7_GPU0 -> Expert_Agg_7;
    Expert_7_7_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_8_GPU0;
    Expert_Route_Comm_7 -> Expert_7_8_GPU1;
    Expert_7_8_GPU0 -> Expert_Agg_7;
    Expert_7_8_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_9_GPU0;
    Expert_Route_Comm_7 -> Expert_7_9_GPU1;
    Expert_7_9_GPU0 -> Expert_Agg_7;
    Expert_7_9_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_10_GPU0;
    Expert_Route_Comm_7 -> Expert_7_10_GPU1;
    Expert_7_10_GPU0 -> Expert_Agg_7;
    Expert_7_10_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_11_GPU0;
    Expert_Route_Comm_7 -> Expert_7_11_GPU1;
    Expert_7_11_GPU0 -> Expert_Agg_7;
    Expert_7_11_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_12_GPU0;
    Expert_Route_Comm_7 -> Expert_7_12_GPU1;
    Expert_7_12_GPU0 -> Expert_Agg_7;
    Expert_7_12_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_13_GPU0;
    Expert_Route_Comm_7 -> Expert_7_13_GPU1;
    Expert_7_13_GPU0 -> Expert_Agg_7;
    Expert_7_13_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_14_GPU0;
    Expert_Route_Comm_7 -> Expert_7_14_GPU1;
    Expert_7_14_GPU0 -> Expert_Agg_7;
    Expert_7_14_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_15_GPU0;
    Expert_Route_Comm_7 -> Expert_7_15_GPU1;
    Expert_7_15_GPU0 -> Expert_Agg_7;
    Expert_7_15_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_16_GPU0;
    Expert_Route_Comm_7 -> Expert_7_16_GPU1;
    Expert_7_16_GPU0 -> Expert_Agg_7;
    Expert_7_16_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_17_GPU0;
    Expert_Route_Comm_7 -> Expert_7_17_GPU1;
    Expert_7_17_GPU0 -> Expert_Agg_7;
    Expert_7_17_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_18_GPU0;
    Expert_Route_Comm_7 -> Expert_7_18_GPU1;
    Expert_7_18_GPU0 -> Expert_Agg_7;
    Expert_7_18_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_19_GPU0;
    Expert_Route_Comm_7 -> Expert_7_19_GPU1;
    Expert_7_19_GPU0 -> Expert_Agg_7;
    Expert_7_19_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_20_GPU0;
    Expert_Route_Comm_7 -> Expert_7_20_GPU1;
    Expert_7_20_GPU0 -> Expert_Agg_7;
    Expert_7_20_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_21_GPU0;
    Expert_Route_Comm_7 -> Expert_7_21_GPU1;
    Expert_7_21_GPU0 -> Expert_Agg_7;
    Expert_7_21_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_22_GPU0;
    Expert_Route_Comm_7 -> Expert_7_22_GPU1;
    Expert_7_22_GPU0 -> Expert_Agg_7;
    Expert_7_22_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_23_GPU0;
    Expert_Route_Comm_7 -> Expert_7_23_GPU1;
    Expert_7_23_GPU0 -> Expert_Agg_7;
    Expert_7_23_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_24_GPU0;
    Expert_Route_Comm_7 -> Expert_7_24_GPU1;
    Expert_7_24_GPU0 -> Expert_Agg_7;
    Expert_7_24_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_25_GPU0;
    Expert_Route_Comm_7 -> Expert_7_25_GPU1;
    Expert_7_25_GPU0 -> Expert_Agg_7;
    Expert_7_25_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_26_GPU0;
    Expert_Route_Comm_7 -> Expert_7_26_GPU1;
    Expert_7_26_GPU0 -> Expert_Agg_7;
    Expert_7_26_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_27_GPU0;
    Expert_Route_Comm_7 -> Expert_7_27_GPU1;
    Expert_7_27_GPU0 -> Expert_Agg_7;
    Expert_7_27_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_28_GPU0;
    Expert_Route_Comm_7 -> Expert_7_28_GPU1;
    Expert_7_28_GPU0 -> Expert_Agg_7;
    Expert_7_28_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_29_GPU0;
    Expert_Route_Comm_7 -> Expert_7_29_GPU1;
    Expert_7_29_GPU0 -> Expert_Agg_7;
    Expert_7_29_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_30_GPU0;
    Expert_Route_Comm_7 -> Expert_7_30_GPU1;
    Expert_7_30_GPU0 -> Expert_Agg_7;
    Expert_7_30_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_31_GPU0;
    Expert_Route_Comm_7 -> Expert_7_31_GPU1;
    Expert_7_31_GPU0 -> Expert_Agg_7;
    Expert_7_31_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_32_GPU0;
    Expert_Route_Comm_7 -> Expert_7_32_GPU1;
    Expert_7_32_GPU0 -> Expert_Agg_7;
    Expert_7_32_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_33_GPU0;
    Expert_Route_Comm_7 -> Expert_7_33_GPU1;
    Expert_7_33_GPU0 -> Expert_Agg_7;
    Expert_7_33_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_34_GPU0;
    Expert_Route_Comm_7 -> Expert_7_34_GPU1;
    Expert_7_34_GPU0 -> Expert_Agg_7;
    Expert_7_34_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_35_GPU0;
    Expert_Route_Comm_7 -> Expert_7_35_GPU1;
    Expert_7_35_GPU0 -> Expert_Agg_7;
    Expert_7_35_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_36_GPU0;
    Expert_Route_Comm_7 -> Expert_7_36_GPU1;
    Expert_7_36_GPU0 -> Expert_Agg_7;
    Expert_7_36_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_37_GPU0;
    Expert_Route_Comm_7 -> Expert_7_37_GPU1;
    Expert_7_37_GPU0 -> Expert_Agg_7;
    Expert_7_37_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_38_GPU0;
    Expert_Route_Comm_7 -> Expert_7_38_GPU1;
    Expert_7_38_GPU0 -> Expert_Agg_7;
    Expert_7_38_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_39_GPU0;
    Expert_Route_Comm_7 -> Expert_7_39_GPU1;
    Expert_7_39_GPU0 -> Expert_Agg_7;
    Expert_7_39_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_40_GPU0;
    Expert_Route_Comm_7 -> Expert_7_40_GPU1;
    Expert_7_40_GPU0 -> Expert_Agg_7;
    Expert_7_40_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_41_GPU0;
    Expert_Route_Comm_7 -> Expert_7_41_GPU1;
    Expert_7_41_GPU0 -> Expert_Agg_7;
    Expert_7_41_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_42_GPU0;
    Expert_Route_Comm_7 -> Expert_7_42_GPU1;
    Expert_7_42_GPU0 -> Expert_Agg_7;
    Expert_7_42_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_43_GPU0;
    Expert_Route_Comm_7 -> Expert_7_43_GPU1;
    Expert_7_43_GPU0 -> Expert_Agg_7;
    Expert_7_43_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_44_GPU0;
    Expert_Route_Comm_7 -> Expert_7_44_GPU1;
    Expert_7_44_GPU0 -> Expert_Agg_7;
    Expert_7_44_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_45_GPU0;
    Expert_Route_Comm_7 -> Expert_7_45_GPU1;
    Expert_7_45_GPU0 -> Expert_Agg_7;
    Expert_7_45_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_46_GPU0;
    Expert_Route_Comm_7 -> Expert_7_46_GPU1;
    Expert_7_46_GPU0 -> Expert_Agg_7;
    Expert_7_46_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_47_GPU0;
    Expert_Route_Comm_7 -> Expert_7_47_GPU1;
    Expert_7_47_GPU0 -> Expert_Agg_7;
    Expert_7_47_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_48_GPU0;
    Expert_Route_Comm_7 -> Expert_7_48_GPU1;
    Expert_7_48_GPU0 -> Expert_Agg_7;
    Expert_7_48_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_49_GPU0;
    Expert_Route_Comm_7 -> Expert_7_49_GPU1;
    Expert_7_49_GPU0 -> Expert_Agg_7;
    Expert_7_49_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_50_GPU0;
    Expert_Route_Comm_7 -> Expert_7_50_GPU1;
    Expert_7_50_GPU0 -> Expert_Agg_7;
    Expert_7_50_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_51_GPU0;
    Expert_Route_Comm_7 -> Expert_7_51_GPU1;
    Expert_7_51_GPU0 -> Expert_Agg_7;
    Expert_7_51_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_52_GPU0;
    Expert_Route_Comm_7 -> Expert_7_52_GPU1;
    Expert_7_52_GPU0 -> Expert_Agg_7;
    Expert_7_52_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_53_GPU0;
    Expert_Route_Comm_7 -> Expert_7_53_GPU1;
    Expert_7_53_GPU0 -> Expert_Agg_7;
    Expert_7_53_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_54_GPU0;
    Expert_Route_Comm_7 -> Expert_7_54_GPU1;
    Expert_7_54_GPU0 -> Expert_Agg_7;
    Expert_7_54_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_55_GPU0;
    Expert_Route_Comm_7 -> Expert_7_55_GPU1;
    Expert_7_55_GPU0 -> Expert_Agg_7;
    Expert_7_55_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_56_GPU0;
    Expert_Route_Comm_7 -> Expert_7_56_GPU1;
    Expert_7_56_GPU0 -> Expert_Agg_7;
    Expert_7_56_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_57_GPU0;
    Expert_Route_Comm_7 -> Expert_7_57_GPU1;
    Expert_7_57_GPU0 -> Expert_Agg_7;
    Expert_7_57_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_58_GPU0;
    Expert_Route_Comm_7 -> Expert_7_58_GPU1;
    Expert_7_58_GPU0 -> Expert_Agg_7;
    Expert_7_58_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_59_GPU0;
    Expert_Route_Comm_7 -> Expert_7_59_GPU1;
    Expert_7_59_GPU0 -> Expert_Agg_7;
    Expert_7_59_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_60_GPU0;
    Expert_Route_Comm_7 -> Expert_7_60_GPU1;
    Expert_7_60_GPU0 -> Expert_Agg_7;
    Expert_7_60_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_61_GPU0;
    Expert_Route_Comm_7 -> Expert_7_61_GPU1;
    Expert_7_61_GPU0 -> Expert_Agg_7;
    Expert_7_61_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_62_GPU0;
    Expert_Route_Comm_7 -> Expert_7_62_GPU1;
    Expert_7_62_GPU0 -> Expert_Agg_7;
    Expert_7_62_GPU1 -> Expert_Agg_7;
    
    Expert_Route_Comm_7 -> Expert_7_63_GPU0;
    Expert_Route_Comm_7 -> Expert_7_63_GPU1;
    Expert_7_63_GPU0 -> Expert_Agg_7;
    Expert_7_63_GPU1 -> Expert_Agg_7;
    
    Expert_Agg_7 -> FFN_GPU0_7;
    Expert_Agg_7 -> FFN_GPU1_7;
    FFN_GPU0_7 -> FFN_Agg_7;
    FFN_GPU1_7 -> FFN_Agg_7;
    FFN_Agg_7 -> LayerNorm_7;
    
    // Layer 8 connections
    LayerNorm_7 -> MHA_Q_GPU0_8;
    LayerNorm_7 -> MHA_K_GPU0_8;
    LayerNorm_7 -> MHA_V_GPU0_8;
    LayerNorm_7 -> MHA_Q_GPU1_8;
    LayerNorm_7 -> MHA_K_GPU1_8;
    LayerNorm_7 -> MHA_V_GPU1_8;
    
    MHA_Q_GPU0_8 -> Attention_Comp_GPU0_8;
    MHA_K_GPU0_8 -> Attention_Comp_GPU0_8;
    MHA_V_GPU0_8 -> Attention_Comp_GPU0_8;
    MHA_Q_GPU1_8 -> Attention_Comp_GPU1_8;
    MHA_K_GPU1_8 -> Attention_Comp_GPU1_8;
    MHA_V_GPU1_8 -> Attention_Comp_GPU1_8;
    
    Attention_Comp_GPU0_8 -> Attention_Agg_8;
    Attention_Comp_GPU1_8 -> Attention_Agg_8;
    
    Attention_Agg_8 -> Gate_Compute_8;
    Gate_Compute_8 -> Gate_Softmax_8;
    
    Gate_Softmax_8 -> Expert_Route_Comm_8 [style=dashed];
    Attention_Agg_8 -> Expert_Route_Comm_8;
    
    Expert_Route_Comm_8 -> Expert_8_0_GPU0;
    Expert_Route_Comm_8 -> Expert_8_0_GPU1;
    Expert_8_0_GPU0 -> Expert_Agg_8;
    Expert_8_0_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_1_GPU0;
    Expert_Route_Comm_8 -> Expert_8_1_GPU1;
    Expert_8_1_GPU0 -> Expert_Agg_8;
    Expert_8_1_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_2_GPU0;
    Expert_Route_Comm_8 -> Expert_8_2_GPU1;
    Expert_8_2_GPU0 -> Expert_Agg_8;
    Expert_8_2_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_3_GPU0;
    Expert_Route_Comm_8 -> Expert_8_3_GPU1;
    Expert_8_3_GPU0 -> Expert_Agg_8;
    Expert_8_3_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_4_GPU0;
    Expert_Route_Comm_8 -> Expert_8_4_GPU1;
    Expert_8_4_GPU0 -> Expert_Agg_8;
    Expert_8_4_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_5_GPU0;
    Expert_Route_Comm_8 -> Expert_8_5_GPU1;
    Expert_8_5_GPU0 -> Expert_Agg_8;
    Expert_8_5_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_6_GPU0;
    Expert_Route_Comm_8 -> Expert_8_6_GPU1;
    Expert_8_6_GPU0 -> Expert_Agg_8;
    Expert_8_6_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_7_GPU0;
    Expert_Route_Comm_8 -> Expert_8_7_GPU1;
    Expert_8_7_GPU0 -> Expert_Agg_8;
    Expert_8_7_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_8_GPU0;
    Expert_Route_Comm_8 -> Expert_8_8_GPU1;
    Expert_8_8_GPU0 -> Expert_Agg_8;
    Expert_8_8_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_9_GPU0;
    Expert_Route_Comm_8 -> Expert_8_9_GPU1;
    Expert_8_9_GPU0 -> Expert_Agg_8;
    Expert_8_9_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_10_GPU0;
    Expert_Route_Comm_8 -> Expert_8_10_GPU1;
    Expert_8_10_GPU0 -> Expert_Agg_8;
    Expert_8_10_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_11_GPU0;
    Expert_Route_Comm_8 -> Expert_8_11_GPU1;
    Expert_8_11_GPU0 -> Expert_Agg_8;
    Expert_8_11_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_12_GPU0;
    Expert_Route_Comm_8 -> Expert_8_12_GPU1;
    Expert_8_12_GPU0 -> Expert_Agg_8;
    Expert_8_12_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_13_GPU0;
    Expert_Route_Comm_8 -> Expert_8_13_GPU1;
    Expert_8_13_GPU0 -> Expert_Agg_8;
    Expert_8_13_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_14_GPU0;
    Expert_Route_Comm_8 -> Expert_8_14_GPU1;
    Expert_8_14_GPU0 -> Expert_Agg_8;
    Expert_8_14_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_15_GPU0;
    Expert_Route_Comm_8 -> Expert_8_15_GPU1;
    Expert_8_15_GPU0 -> Expert_Agg_8;
    Expert_8_15_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_16_GPU0;
    Expert_Route_Comm_8 -> Expert_8_16_GPU1;
    Expert_8_16_GPU0 -> Expert_Agg_8;
    Expert_8_16_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_17_GPU0;
    Expert_Route_Comm_8 -> Expert_8_17_GPU1;
    Expert_8_17_GPU0 -> Expert_Agg_8;
    Expert_8_17_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_18_GPU0;
    Expert_Route_Comm_8 -> Expert_8_18_GPU1;
    Expert_8_18_GPU0 -> Expert_Agg_8;
    Expert_8_18_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_19_GPU0;
    Expert_Route_Comm_8 -> Expert_8_19_GPU1;
    Expert_8_19_GPU0 -> Expert_Agg_8;
    Expert_8_19_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_20_GPU0;
    Expert_Route_Comm_8 -> Expert_8_20_GPU1;
    Expert_8_20_GPU0 -> Expert_Agg_8;
    Expert_8_20_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_21_GPU0;
    Expert_Route_Comm_8 -> Expert_8_21_GPU1;
    Expert_8_21_GPU0 -> Expert_Agg_8;
    Expert_8_21_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_22_GPU0;
    Expert_Route_Comm_8 -> Expert_8_22_GPU1;
    Expert_8_22_GPU0 -> Expert_Agg_8;
    Expert_8_22_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_23_GPU0;
    Expert_Route_Comm_8 -> Expert_8_23_GPU1;
    Expert_8_23_GPU0 -> Expert_Agg_8;
    Expert_8_23_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_24_GPU0;
    Expert_Route_Comm_8 -> Expert_8_24_GPU1;
    Expert_8_24_GPU0 -> Expert_Agg_8;
    Expert_8_24_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_25_GPU0;
    Expert_Route_Comm_8 -> Expert_8_25_GPU1;
    Expert_8_25_GPU0 -> Expert_Agg_8;
    Expert_8_25_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_26_GPU0;
    Expert_Route_Comm_8 -> Expert_8_26_GPU1;
    Expert_8_26_GPU0 -> Expert_Agg_8;
    Expert_8_26_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_27_GPU0;
    Expert_Route_Comm_8 -> Expert_8_27_GPU1;
    Expert_8_27_GPU0 -> Expert_Agg_8;
    Expert_8_27_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_28_GPU0;
    Expert_Route_Comm_8 -> Expert_8_28_GPU1;
    Expert_8_28_GPU0 -> Expert_Agg_8;
    Expert_8_28_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_29_GPU0;
    Expert_Route_Comm_8 -> Expert_8_29_GPU1;
    Expert_8_29_GPU0 -> Expert_Agg_8;
    Expert_8_29_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_30_GPU0;
    Expert_Route_Comm_8 -> Expert_8_30_GPU1;
    Expert_8_30_GPU0 -> Expert_Agg_8;
    Expert_8_30_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_31_GPU0;
    Expert_Route_Comm_8 -> Expert_8_31_GPU1;
    Expert_8_31_GPU0 -> Expert_Agg_8;
    Expert_8_31_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_32_GPU0;
    Expert_Route_Comm_8 -> Expert_8_32_GPU1;
    Expert_8_32_GPU0 -> Expert_Agg_8;
    Expert_8_32_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_33_GPU0;
    Expert_Route_Comm_8 -> Expert_8_33_GPU1;
    Expert_8_33_GPU0 -> Expert_Agg_8;
    Expert_8_33_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_34_GPU0;
    Expert_Route_Comm_8 -> Expert_8_34_GPU1;
    Expert_8_34_GPU0 -> Expert_Agg_8;
    Expert_8_34_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_35_GPU0;
    Expert_Route_Comm_8 -> Expert_8_35_GPU1;
    Expert_8_35_GPU0 -> Expert_Agg_8;
    Expert_8_35_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_36_GPU0;
    Expert_Route_Comm_8 -> Expert_8_36_GPU1;
    Expert_8_36_GPU0 -> Expert_Agg_8;
    Expert_8_36_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_37_GPU0;
    Expert_Route_Comm_8 -> Expert_8_37_GPU1;
    Expert_8_37_GPU0 -> Expert_Agg_8;
    Expert_8_37_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_38_GPU0;
    Expert_Route_Comm_8 -> Expert_8_38_GPU1;
    Expert_8_38_GPU0 -> Expert_Agg_8;
    Expert_8_38_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_39_GPU0;
    Expert_Route_Comm_8 -> Expert_8_39_GPU1;
    Expert_8_39_GPU0 -> Expert_Agg_8;
    Expert_8_39_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_40_GPU0;
    Expert_Route_Comm_8 -> Expert_8_40_GPU1;
    Expert_8_40_GPU0 -> Expert_Agg_8;
    Expert_8_40_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_41_GPU0;
    Expert_Route_Comm_8 -> Expert_8_41_GPU1;
    Expert_8_41_GPU0 -> Expert_Agg_8;
    Expert_8_41_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_42_GPU0;
    Expert_Route_Comm_8 -> Expert_8_42_GPU1;
    Expert_8_42_GPU0 -> Expert_Agg_8;
    Expert_8_42_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_43_GPU0;
    Expert_Route_Comm_8 -> Expert_8_43_GPU1;
    Expert_8_43_GPU0 -> Expert_Agg_8;
    Expert_8_43_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_44_GPU0;
    Expert_Route_Comm_8 -> Expert_8_44_GPU1;
    Expert_8_44_GPU0 -> Expert_Agg_8;
    Expert_8_44_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_45_GPU0;
    Expert_Route_Comm_8 -> Expert_8_45_GPU1;
    Expert_8_45_GPU0 -> Expert_Agg_8;
    Expert_8_45_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_46_GPU0;
    Expert_Route_Comm_8 -> Expert_8_46_GPU1;
    Expert_8_46_GPU0 -> Expert_Agg_8;
    Expert_8_46_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_47_GPU0;
    Expert_Route_Comm_8 -> Expert_8_47_GPU1;
    Expert_8_47_GPU0 -> Expert_Agg_8;
    Expert_8_47_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_48_GPU0;
    Expert_Route_Comm_8 -> Expert_8_48_GPU1;
    Expert_8_48_GPU0 -> Expert_Agg_8;
    Expert_8_48_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_49_GPU0;
    Expert_Route_Comm_8 -> Expert_8_49_GPU1;
    Expert_8_49_GPU0 -> Expert_Agg_8;
    Expert_8_49_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_50_GPU0;
    Expert_Route_Comm_8 -> Expert_8_50_GPU1;
    Expert_8_50_GPU0 -> Expert_Agg_8;
    Expert_8_50_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_51_GPU0;
    Expert_Route_Comm_8 -> Expert_8_51_GPU1;
    Expert_8_51_GPU0 -> Expert_Agg_8;
    Expert_8_51_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_52_GPU0;
    Expert_Route_Comm_8 -> Expert_8_52_GPU1;
    Expert_8_52_GPU0 -> Expert_Agg_8;
    Expert_8_52_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_53_GPU0;
    Expert_Route_Comm_8 -> Expert_8_53_GPU1;
    Expert_8_53_GPU0 -> Expert_Agg_8;
    Expert_8_53_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_54_GPU0;
    Expert_Route_Comm_8 -> Expert_8_54_GPU1;
    Expert_8_54_GPU0 -> Expert_Agg_8;
    Expert_8_54_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_55_GPU0;
    Expert_Route_Comm_8 -> Expert_8_55_GPU1;
    Expert_8_55_GPU0 -> Expert_Agg_8;
    Expert_8_55_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_56_GPU0;
    Expert_Route_Comm_8 -> Expert_8_56_GPU1;
    Expert_8_56_GPU0 -> Expert_Agg_8;
    Expert_8_56_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_57_GPU0;
    Expert_Route_Comm_8 -> Expert_8_57_GPU1;
    Expert_8_57_GPU0 -> Expert_Agg_8;
    Expert_8_57_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_58_GPU0;
    Expert_Route_Comm_8 -> Expert_8_58_GPU1;
    Expert_8_58_GPU0 -> Expert_Agg_8;
    Expert_8_58_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_59_GPU0;
    Expert_Route_Comm_8 -> Expert_8_59_GPU1;
    Expert_8_59_GPU0 -> Expert_Agg_8;
    Expert_8_59_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_60_GPU0;
    Expert_Route_Comm_8 -> Expert_8_60_GPU1;
    Expert_8_60_GPU0 -> Expert_Agg_8;
    Expert_8_60_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_61_GPU0;
    Expert_Route_Comm_8 -> Expert_8_61_GPU1;
    Expert_8_61_GPU0 -> Expert_Agg_8;
    Expert_8_61_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_62_GPU0;
    Expert_Route_Comm_8 -> Expert_8_62_GPU1;
    Expert_8_62_GPU0 -> Expert_Agg_8;
    Expert_8_62_GPU1 -> Expert_Agg_8;
    
    Expert_Route_Comm_8 -> Expert_8_63_GPU0;
    Expert_Route_Comm_8 -> Expert_8_63_GPU1;
    Expert_8_63_GPU0 -> Expert_Agg_8;
    Expert_8_63_GPU1 -> Expert_Agg_8;
    
    Expert_Agg_8 -> FFN_GPU0_8;
    Expert_Agg_8 -> FFN_GPU1_8;
    FFN_GPU0_8 -> FFN_Agg_8;
    FFN_GPU1_8 -> FFN_Agg_8;
    FFN_Agg_8 -> LayerNorm_8;
    
    // Layer 9 connections
    LayerNorm_8 -> MHA_Q_GPU0_9;
    LayerNorm_8 -> MHA_K_GPU0_9;
    LayerNorm_8 -> MHA_V_GPU0_9;
    LayerNorm_8 -> MHA_Q_GPU1_9;
    LayerNorm_8 -> MHA_K_GPU1_9;
    LayerNorm_8 -> MHA_V_GPU1_9;
    
    MHA_Q_GPU0_9 -> Attention_Comp_GPU0_9;
    MHA_K_GPU0_9 -> Attention_Comp_GPU0_9;
    MHA_V_GPU0_9 -> Attention_Comp_GPU0_9;
    MHA_Q_GPU1_9 -> Attention_Comp_GPU1_9;
    MHA_K_GPU1_9 -> Attention_Comp_GPU1_9;
    MHA_V_GPU1_9 -> Attention_Comp_GPU1_9;
    
    Attention_Comp_GPU0_9 -> Attention_Agg_9;
    Attention_Comp_GPU1_9 -> Attention_Agg_9;
    
    Attention_Agg_9 -> Gate_Compute_9;
    Gate_Compute_9 -> Gate_Softmax_9;
    
    Gate_Softmax_9 -> Expert_Route_Comm_9 [style=dashed];
    Attention_Agg_9 -> Expert_Route_Comm_9;
    
    Expert_Route_Comm_9 -> Expert_9_0_GPU0;
    Expert_Route_Comm_9 -> Expert_9_0_GPU1;
    Expert_9_0_GPU0 -> Expert_Agg_9;
    Expert_9_0_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_1_GPU0;
    Expert_Route_Comm_9 -> Expert_9_1_GPU1;
    Expert_9_1_GPU0 -> Expert_Agg_9;
    Expert_9_1_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_2_GPU0;
    Expert_Route_Comm_9 -> Expert_9_2_GPU1;
    Expert_9_2_GPU0 -> Expert_Agg_9;
    Expert_9_2_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_3_GPU0;
    Expert_Route_Comm_9 -> Expert_9_3_GPU1;
    Expert_9_3_GPU0 -> Expert_Agg_9;
    Expert_9_3_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_4_GPU0;
    Expert_Route_Comm_9 -> Expert_9_4_GPU1;
    Expert_9_4_GPU0 -> Expert_Agg_9;
    Expert_9_4_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_5_GPU0;
    Expert_Route_Comm_9 -> Expert_9_5_GPU1;
    Expert_9_5_GPU0 -> Expert_Agg_9;
    Expert_9_5_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_6_GPU0;
    Expert_Route_Comm_9 -> Expert_9_6_GPU1;
    Expert_9_6_GPU0 -> Expert_Agg_9;
    Expert_9_6_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_7_GPU0;
    Expert_Route_Comm_9 -> Expert_9_7_GPU1;
    Expert_9_7_GPU0 -> Expert_Agg_9;
    Expert_9_7_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_8_GPU0;
    Expert_Route_Comm_9 -> Expert_9_8_GPU1;
    Expert_9_8_GPU0 -> Expert_Agg_9;
    Expert_9_8_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_9_GPU0;
    Expert_Route_Comm_9 -> Expert_9_9_GPU1;
    Expert_9_9_GPU0 -> Expert_Agg_9;
    Expert_9_9_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_10_GPU0;
    Expert_Route_Comm_9 -> Expert_9_10_GPU1;
    Expert_9_10_GPU0 -> Expert_Agg_9;
    Expert_9_10_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_11_GPU0;
    Expert_Route_Comm_9 -> Expert_9_11_GPU1;
    Expert_9_11_GPU0 -> Expert_Agg_9;
    Expert_9_11_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_12_GPU0;
    Expert_Route_Comm_9 -> Expert_9_12_GPU1;
    Expert_9_12_GPU0 -> Expert_Agg_9;
    Expert_9_12_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_13_GPU0;
    Expert_Route_Comm_9 -> Expert_9_13_GPU1;
    Expert_9_13_GPU0 -> Expert_Agg_9;
    Expert_9_13_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_14_GPU0;
    Expert_Route_Comm_9 -> Expert_9_14_GPU1;
    Expert_9_14_GPU0 -> Expert_Agg_9;
    Expert_9_14_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_15_GPU0;
    Expert_Route_Comm_9 -> Expert_9_15_GPU1;
    Expert_9_15_GPU0 -> Expert_Agg_9;
    Expert_9_15_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_16_GPU0;
    Expert_Route_Comm_9 -> Expert_9_16_GPU1;
    Expert_9_16_GPU0 -> Expert_Agg_9;
    Expert_9_16_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_17_GPU0;
    Expert_Route_Comm_9 -> Expert_9_17_GPU1;
    Expert_9_17_GPU0 -> Expert_Agg_9;
    Expert_9_17_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_18_GPU0;
    Expert_Route_Comm_9 -> Expert_9_18_GPU1;
    Expert_9_18_GPU0 -> Expert_Agg_9;
    Expert_9_18_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_19_GPU0;
    Expert_Route_Comm_9 -> Expert_9_19_GPU1;
    Expert_9_19_GPU0 -> Expert_Agg_9;
    Expert_9_19_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_20_GPU0;
    Expert_Route_Comm_9 -> Expert_9_20_GPU1;
    Expert_9_20_GPU0 -> Expert_Agg_9;
    Expert_9_20_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_21_GPU0;
    Expert_Route_Comm_9 -> Expert_9_21_GPU1;
    Expert_9_21_GPU0 -> Expert_Agg_9;
    Expert_9_21_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_22_GPU0;
    Expert_Route_Comm_9 -> Expert_9_22_GPU1;
    Expert_9_22_GPU0 -> Expert_Agg_9;
    Expert_9_22_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_23_GPU0;
    Expert_Route_Comm_9 -> Expert_9_23_GPU1;
    Expert_9_23_GPU0 -> Expert_Agg_9;
    Expert_9_23_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_24_GPU0;
    Expert_Route_Comm_9 -> Expert_9_24_GPU1;
    Expert_9_24_GPU0 -> Expert_Agg_9;
    Expert_9_24_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_25_GPU0;
    Expert_Route_Comm_9 -> Expert_9_25_GPU1;
    Expert_9_25_GPU0 -> Expert_Agg_9;
    Expert_9_25_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_26_GPU0;
    Expert_Route_Comm_9 -> Expert_9_26_GPU1;
    Expert_9_26_GPU0 -> Expert_Agg_9;
    Expert_9_26_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_27_GPU0;
    Expert_Route_Comm_9 -> Expert_9_27_GPU1;
    Expert_9_27_GPU0 -> Expert_Agg_9;
    Expert_9_27_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_28_GPU0;
    Expert_Route_Comm_9 -> Expert_9_28_GPU1;
    Expert_9_28_GPU0 -> Expert_Agg_9;
    Expert_9_28_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_29_GPU0;
    Expert_Route_Comm_9 -> Expert_9_29_GPU1;
    Expert_9_29_GPU0 -> Expert_Agg_9;
    Expert_9_29_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_30_GPU0;
    Expert_Route_Comm_9 -> Expert_9_30_GPU1;
    Expert_9_30_GPU0 -> Expert_Agg_9;
    Expert_9_30_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_31_GPU0;
    Expert_Route_Comm_9 -> Expert_9_31_GPU1;
    Expert_9_31_GPU0 -> Expert_Agg_9;
    Expert_9_31_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_32_GPU0;
    Expert_Route_Comm_9 -> Expert_9_32_GPU1;
    Expert_9_32_GPU0 -> Expert_Agg_9;
    Expert_9_32_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_33_GPU0;
    Expert_Route_Comm_9 -> Expert_9_33_GPU1;
    Expert_9_33_GPU0 -> Expert_Agg_9;
    Expert_9_33_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_34_GPU0;
    Expert_Route_Comm_9 -> Expert_9_34_GPU1;
    Expert_9_34_GPU0 -> Expert_Agg_9;
    Expert_9_34_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_35_GPU0;
    Expert_Route_Comm_9 -> Expert_9_35_GPU1;
    Expert_9_35_GPU0 -> Expert_Agg_9;
    Expert_9_35_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_36_GPU0;
    Expert_Route_Comm_9 -> Expert_9_36_GPU1;
    Expert_9_36_GPU0 -> Expert_Agg_9;
    Expert_9_36_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_37_GPU0;
    Expert_Route_Comm_9 -> Expert_9_37_GPU1;
    Expert_9_37_GPU0 -> Expert_Agg_9;
    Expert_9_37_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_38_GPU0;
    Expert_Route_Comm_9 -> Expert_9_38_GPU1;
    Expert_9_38_GPU0 -> Expert_Agg_9;
    Expert_9_38_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_39_GPU0;
    Expert_Route_Comm_9 -> Expert_9_39_GPU1;
    Expert_9_39_GPU0 -> Expert_Agg_9;
    Expert_9_39_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_40_GPU0;
    Expert_Route_Comm_9 -> Expert_9_40_GPU1;
    Expert_9_40_GPU0 -> Expert_Agg_9;
    Expert_9_40_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_41_GPU0;
    Expert_Route_Comm_9 -> Expert_9_41_GPU1;
    Expert_9_41_GPU0 -> Expert_Agg_9;
    Expert_9_41_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_42_GPU0;
    Expert_Route_Comm_9 -> Expert_9_42_GPU1;
    Expert_9_42_GPU0 -> Expert_Agg_9;
    Expert_9_42_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_43_GPU0;
    Expert_Route_Comm_9 -> Expert_9_43_GPU1;
    Expert_9_43_GPU0 -> Expert_Agg_9;
    Expert_9_43_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_44_GPU0;
    Expert_Route_Comm_9 -> Expert_9_44_GPU1;
    Expert_9_44_GPU0 -> Expert_Agg_9;
    Expert_9_44_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_45_GPU0;
    Expert_Route_Comm_9 -> Expert_9_45_GPU1;
    Expert_9_45_GPU0 -> Expert_Agg_9;
    Expert_9_45_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_46_GPU0;
    Expert_Route_Comm_9 -> Expert_9_46_GPU1;
    Expert_9_46_GPU0 -> Expert_Agg_9;
    Expert_9_46_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_47_GPU0;
    Expert_Route_Comm_9 -> Expert_9_47_GPU1;
    Expert_9_47_GPU0 -> Expert_Agg_9;
    Expert_9_47_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_48_GPU0;
    Expert_Route_Comm_9 -> Expert_9_48_GPU1;
    Expert_9_48_GPU0 -> Expert_Agg_9;
    Expert_9_48_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_49_GPU0;
    Expert_Route_Comm_9 -> Expert_9_49_GPU1;
    Expert_9_49_GPU0 -> Expert_Agg_9;
    Expert_9_49_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_50_GPU0;
    Expert_Route_Comm_9 -> Expert_9_50_GPU1;
    Expert_9_50_GPU0 -> Expert_Agg_9;
    Expert_9_50_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_51_GPU0;
    Expert_Route_Comm_9 -> Expert_9_51_GPU1;
    Expert_9_51_GPU0 -> Expert_Agg_9;
    Expert_9_51_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_52_GPU0;
    Expert_Route_Comm_9 -> Expert_9_52_GPU1;
    Expert_9_52_GPU0 -> Expert_Agg_9;
    Expert_9_52_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_53_GPU0;
    Expert_Route_Comm_9 -> Expert_9_53_GPU1;
    Expert_9_53_GPU0 -> Expert_Agg_9;
    Expert_9_53_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_54_GPU0;
    Expert_Route_Comm_9 -> Expert_9_54_GPU1;
    Expert_9_54_GPU0 -> Expert_Agg_9;
    Expert_9_54_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_55_GPU0;
    Expert_Route_Comm_9 -> Expert_9_55_GPU1;
    Expert_9_55_GPU0 -> Expert_Agg_9;
    Expert_9_55_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_56_GPU0;
    Expert_Route_Comm_9 -> Expert_9_56_GPU1;
    Expert_9_56_GPU0 -> Expert_Agg_9;
    Expert_9_56_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_57_GPU0;
    Expert_Route_Comm_9 -> Expert_9_57_GPU1;
    Expert_9_57_GPU0 -> Expert_Agg_9;
    Expert_9_57_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_58_GPU0;
    Expert_Route_Comm_9 -> Expert_9_58_GPU1;
    Expert_9_58_GPU0 -> Expert_Agg_9;
    Expert_9_58_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_59_GPU0;
    Expert_Route_Comm_9 -> Expert_9_59_GPU1;
    Expert_9_59_GPU0 -> Expert_Agg_9;
    Expert_9_59_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_60_GPU0;
    Expert_Route_Comm_9 -> Expert_9_60_GPU1;
    Expert_9_60_GPU0 -> Expert_Agg_9;
    Expert_9_60_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_61_GPU0;
    Expert_Route_Comm_9 -> Expert_9_61_GPU1;
    Expert_9_61_GPU0 -> Expert_Agg_9;
    Expert_9_61_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_62_GPU0;
    Expert_Route_Comm_9 -> Expert_9_62_GPU1;
    Expert_9_62_GPU0 -> Expert_Agg_9;
    Expert_9_62_GPU1 -> Expert_Agg_9;
    
    Expert_Route_Comm_9 -> Expert_9_63_GPU0;
    Expert_Route_Comm_9 -> Expert_9_63_GPU1;
    Expert_9_63_GPU0 -> Expert_Agg_9;
    Expert_9_63_GPU1 -> Expert_Agg_9;
    
    Expert_Agg_9 -> FFN_GPU0_9;
    Expert_Agg_9 -> FFN_GPU1_9;
    FFN_GPU0_9 -> FFN_Agg_9;
    FFN_GPU1_9 -> FFN_Agg_9;
    FFN_Agg_9 -> LayerNorm_9;
    
    // Layer 10 connections
    LayerNorm_9 -> MHA_Q_GPU0_10;
    LayerNorm_9 -> MHA_K_GPU0_10;
    LayerNorm_9 -> MHA_V_GPU0_10;
    LayerNorm_9 -> MHA_Q_GPU1_10;
    LayerNorm_9 -> MHA_K_GPU1_10;
    LayerNorm_9 -> MHA_V_GPU1_10;
    
    MHA_Q_GPU0_10 -> Attention_Comp_GPU0_10;
    MHA_K_GPU0_10 -> Attention_Comp_GPU0_10;
    MHA_V_GPU0_10 -> Attention_Comp_GPU0_10;
    MHA_Q_GPU1_10 -> Attention_Comp_GPU1_10;
    MHA_K_GPU1_10 -> Attention_Comp_GPU1_10;
    MHA_V_GPU1_10 -> Attention_Comp_GPU1_10;
    
    Attention_Comp_GPU0_10 -> Attention_Agg_10;
    Attention_Comp_GPU1_10 -> Attention_Agg_10;
    
    Attention_Agg_10 -> Gate_Compute_10;
    Gate_Compute_10 -> Gate_Softmax_10;
    
    Gate_Softmax_10 -> Expert_Route_Comm_10 [style=dashed];
    Attention_Agg_10 -> Expert_Route_Comm_10;
    
    Expert_Route_Comm_10 -> Expert_10_0_GPU0;
    Expert_Route_Comm_10 -> Expert_10_0_GPU1;
    Expert_10_0_GPU0 -> Expert_Agg_10;
    Expert_10_0_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_1_GPU0;
    Expert_Route_Comm_10 -> Expert_10_1_GPU1;
    Expert_10_1_GPU0 -> Expert_Agg_10;
    Expert_10_1_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_2_GPU0;
    Expert_Route_Comm_10 -> Expert_10_2_GPU1;
    Expert_10_2_GPU0 -> Expert_Agg_10;
    Expert_10_2_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_3_GPU0;
    Expert_Route_Comm_10 -> Expert_10_3_GPU1;
    Expert_10_3_GPU0 -> Expert_Agg_10;
    Expert_10_3_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_4_GPU0;
    Expert_Route_Comm_10 -> Expert_10_4_GPU1;
    Expert_10_4_GPU0 -> Expert_Agg_10;
    Expert_10_4_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_5_GPU0;
    Expert_Route_Comm_10 -> Expert_10_5_GPU1;
    Expert_10_5_GPU0 -> Expert_Agg_10;
    Expert_10_5_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_6_GPU0;
    Expert_Route_Comm_10 -> Expert_10_6_GPU1;
    Expert_10_6_GPU0 -> Expert_Agg_10;
    Expert_10_6_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_7_GPU0;
    Expert_Route_Comm_10 -> Expert_10_7_GPU1;
    Expert_10_7_GPU0 -> Expert_Agg_10;
    Expert_10_7_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_8_GPU0;
    Expert_Route_Comm_10 -> Expert_10_8_GPU1;
    Expert_10_8_GPU0 -> Expert_Agg_10;
    Expert_10_8_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_9_GPU0;
    Expert_Route_Comm_10 -> Expert_10_9_GPU1;
    Expert_10_9_GPU0 -> Expert_Agg_10;
    Expert_10_9_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_10_GPU0;
    Expert_Route_Comm_10 -> Expert_10_10_GPU1;
    Expert_10_10_GPU0 -> Expert_Agg_10;
    Expert_10_10_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_11_GPU0;
    Expert_Route_Comm_10 -> Expert_10_11_GPU1;
    Expert_10_11_GPU0 -> Expert_Agg_10;
    Expert_10_11_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_12_GPU0;
    Expert_Route_Comm_10 -> Expert_10_12_GPU1;
    Expert_10_12_GPU0 -> Expert_Agg_10;
    Expert_10_12_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_13_GPU0;
    Expert_Route_Comm_10 -> Expert_10_13_GPU1;
    Expert_10_13_GPU0 -> Expert_Agg_10;
    Expert_10_13_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_14_GPU0;
    Expert_Route_Comm_10 -> Expert_10_14_GPU1;
    Expert_10_14_GPU0 -> Expert_Agg_10;
    Expert_10_14_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_15_GPU0;
    Expert_Route_Comm_10 -> Expert_10_15_GPU1;
    Expert_10_15_GPU0 -> Expert_Agg_10;
    Expert_10_15_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_16_GPU0;
    Expert_Route_Comm_10 -> Expert_10_16_GPU1;
    Expert_10_16_GPU0 -> Expert_Agg_10;
    Expert_10_16_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_17_GPU0;
    Expert_Route_Comm_10 -> Expert_10_17_GPU1;
    Expert_10_17_GPU0 -> Expert_Agg_10;
    Expert_10_17_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_18_GPU0;
    Expert_Route_Comm_10 -> Expert_10_18_GPU1;
    Expert_10_18_GPU0 -> Expert_Agg_10;
    Expert_10_18_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_19_GPU0;
    Expert_Route_Comm_10 -> Expert_10_19_GPU1;
    Expert_10_19_GPU0 -> Expert_Agg_10;
    Expert_10_19_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_20_GPU0;
    Expert_Route_Comm_10 -> Expert_10_20_GPU1;
    Expert_10_20_GPU0 -> Expert_Agg_10;
    Expert_10_20_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_21_GPU0;
    Expert_Route_Comm_10 -> Expert_10_21_GPU1;
    Expert_10_21_GPU0 -> Expert_Agg_10;
    Expert_10_21_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_22_GPU0;
    Expert_Route_Comm_10 -> Expert_10_22_GPU1;
    Expert_10_22_GPU0 -> Expert_Agg_10;
    Expert_10_22_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_23_GPU0;
    Expert_Route_Comm_10 -> Expert_10_23_GPU1;
    Expert_10_23_GPU0 -> Expert_Agg_10;
    Expert_10_23_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_24_GPU0;
    Expert_Route_Comm_10 -> Expert_10_24_GPU1;
    Expert_10_24_GPU0 -> Expert_Agg_10;
    Expert_10_24_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_25_GPU0;
    Expert_Route_Comm_10 -> Expert_10_25_GPU1;
    Expert_10_25_GPU0 -> Expert_Agg_10;
    Expert_10_25_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_26_GPU0;
    Expert_Route_Comm_10 -> Expert_10_26_GPU1;
    Expert_10_26_GPU0 -> Expert_Agg_10;
    Expert_10_26_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_27_GPU0;
    Expert_Route_Comm_10 -> Expert_10_27_GPU1;
    Expert_10_27_GPU0 -> Expert_Agg_10;
    Expert_10_27_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_28_GPU0;
    Expert_Route_Comm_10 -> Expert_10_28_GPU1;
    Expert_10_28_GPU0 -> Expert_Agg_10;
    Expert_10_28_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_29_GPU0;
    Expert_Route_Comm_10 -> Expert_10_29_GPU1;
    Expert_10_29_GPU0 -> Expert_Agg_10;
    Expert_10_29_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_30_GPU0;
    Expert_Route_Comm_10 -> Expert_10_30_GPU1;
    Expert_10_30_GPU0 -> Expert_Agg_10;
    Expert_10_30_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_31_GPU0;
    Expert_Route_Comm_10 -> Expert_10_31_GPU1;
    Expert_10_31_GPU0 -> Expert_Agg_10;
    Expert_10_31_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_32_GPU0;
    Expert_Route_Comm_10 -> Expert_10_32_GPU1;
    Expert_10_32_GPU0 -> Expert_Agg_10;
    Expert_10_32_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_33_GPU0;
    Expert_Route_Comm_10 -> Expert_10_33_GPU1;
    Expert_10_33_GPU0 -> Expert_Agg_10;
    Expert_10_33_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_34_GPU0;
    Expert_Route_Comm_10 -> Expert_10_34_GPU1;
    Expert_10_34_GPU0 -> Expert_Agg_10;
    Expert_10_34_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_35_GPU0;
    Expert_Route_Comm_10 -> Expert_10_35_GPU1;
    Expert_10_35_GPU0 -> Expert_Agg_10;
    Expert_10_35_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_36_GPU0;
    Expert_Route_Comm_10 -> Expert_10_36_GPU1;
    Expert_10_36_GPU0 -> Expert_Agg_10;
    Expert_10_36_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_37_GPU0;
    Expert_Route_Comm_10 -> Expert_10_37_GPU1;
    Expert_10_37_GPU0 -> Expert_Agg_10;
    Expert_10_37_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_38_GPU0;
    Expert_Route_Comm_10 -> Expert_10_38_GPU1;
    Expert_10_38_GPU0 -> Expert_Agg_10;
    Expert_10_38_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_39_GPU0;
    Expert_Route_Comm_10 -> Expert_10_39_GPU1;
    Expert_10_39_GPU0 -> Expert_Agg_10;
    Expert_10_39_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_40_GPU0;
    Expert_Route_Comm_10 -> Expert_10_40_GPU1;
    Expert_10_40_GPU0 -> Expert_Agg_10;
    Expert_10_40_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_41_GPU0;
    Expert_Route_Comm_10 -> Expert_10_41_GPU1;
    Expert_10_41_GPU0 -> Expert_Agg_10;
    Expert_10_41_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_42_GPU0;
    Expert_Route_Comm_10 -> Expert_10_42_GPU1;
    Expert_10_42_GPU0 -> Expert_Agg_10;
    Expert_10_42_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_43_GPU0;
    Expert_Route_Comm_10 -> Expert_10_43_GPU1;
    Expert_10_43_GPU0 -> Expert_Agg_10;
    Expert_10_43_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_44_GPU0;
    Expert_Route_Comm_10 -> Expert_10_44_GPU1;
    Expert_10_44_GPU0 -> Expert_Agg_10;
    Expert_10_44_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_45_GPU0;
    Expert_Route_Comm_10 -> Expert_10_45_GPU1;
    Expert_10_45_GPU0 -> Expert_Agg_10;
    Expert_10_45_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_46_GPU0;
    Expert_Route_Comm_10 -> Expert_10_46_GPU1;
    Expert_10_46_GPU0 -> Expert_Agg_10;
    Expert_10_46_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_47_GPU0;
    Expert_Route_Comm_10 -> Expert_10_47_GPU1;
    Expert_10_47_GPU0 -> Expert_Agg_10;
    Expert_10_47_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_48_GPU0;
    Expert_Route_Comm_10 -> Expert_10_48_GPU1;
    Expert_10_48_GPU0 -> Expert_Agg_10;
    Expert_10_48_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_49_GPU0;
    Expert_Route_Comm_10 -> Expert_10_49_GPU1;
    Expert_10_49_GPU0 -> Expert_Agg_10;
    Expert_10_49_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_50_GPU0;
    Expert_Route_Comm_10 -> Expert_10_50_GPU1;
    Expert_10_50_GPU0 -> Expert_Agg_10;
    Expert_10_50_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_51_GPU0;
    Expert_Route_Comm_10 -> Expert_10_51_GPU1;
    Expert_10_51_GPU0 -> Expert_Agg_10;
    Expert_10_51_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_52_GPU0;
    Expert_Route_Comm_10 -> Expert_10_52_GPU1;
    Expert_10_52_GPU0 -> Expert_Agg_10;
    Expert_10_52_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_53_GPU0;
    Expert_Route_Comm_10 -> Expert_10_53_GPU1;
    Expert_10_53_GPU0 -> Expert_Agg_10;
    Expert_10_53_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_54_GPU0;
    Expert_Route_Comm_10 -> Expert_10_54_GPU1;
    Expert_10_54_GPU0 -> Expert_Agg_10;
    Expert_10_54_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_55_GPU0;
    Expert_Route_Comm_10 -> Expert_10_55_GPU1;
    Expert_10_55_GPU0 -> Expert_Agg_10;
    Expert_10_55_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_56_GPU0;
    Expert_Route_Comm_10 -> Expert_10_56_GPU1;
    Expert_10_56_GPU0 -> Expert_Agg_10;
    Expert_10_56_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_57_GPU0;
    Expert_Route_Comm_10 -> Expert_10_57_GPU1;
    Expert_10_57_GPU0 -> Expert_Agg_10;
    Expert_10_57_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_58_GPU0;
    Expert_Route_Comm_10 -> Expert_10_58_GPU1;
    Expert_10_58_GPU0 -> Expert_Agg_10;
    Expert_10_58_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_59_GPU0;
    Expert_Route_Comm_10 -> Expert_10_59_GPU1;
    Expert_10_59_GPU0 -> Expert_Agg_10;
    Expert_10_59_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_60_GPU0;
    Expert_Route_Comm_10 -> Expert_10_60_GPU1;
    Expert_10_60_GPU0 -> Expert_Agg_10;
    Expert_10_60_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_61_GPU0;
    Expert_Route_Comm_10 -> Expert_10_61_GPU1;
    Expert_10_61_GPU0 -> Expert_Agg_10;
    Expert_10_61_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_62_GPU0;
    Expert_Route_Comm_10 -> Expert_10_62_GPU1;
    Expert_10_62_GPU0 -> Expert_Agg_10;
    Expert_10_62_GPU1 -> Expert_Agg_10;
    
    Expert_Route_Comm_10 -> Expert_10_63_GPU0;
    Expert_Route_Comm_10 -> Expert_10_63_GPU1;
    Expert_10_63_GPU0 -> Expert_Agg_10;
    Expert_10_63_GPU1 -> Expert_Agg_10;
    
    Expert_Agg_10 -> FFN_GPU0_10;
    Expert_Agg_10 -> FFN_GPU1_10;
    FFN_GPU0_10 -> FFN_Agg_10;
    FFN_GPU1_10 -> FFN_Agg_10;
    FFN_Agg_10 -> LayerNorm_10;
    
    // Layer 11 connections
    LayerNorm_10 -> MHA_Q_GPU0_11;
    LayerNorm_10 -> MHA_K_GPU0_11;
    LayerNorm_10 -> MHA_V_GPU0_11;
    LayerNorm_10 -> MHA_Q_GPU1_11;
    LayerNorm_10 -> MHA_K_GPU1_11;
    LayerNorm_10 -> MHA_V_GPU1_11;
    
    MHA_Q_GPU0_11 -> Attention_Comp_GPU0_11;
    MHA_K_GPU0_11 -> Attention_Comp_GPU0_11;
    MHA_V_GPU0_11 -> Attention_Comp_GPU0_11;
    MHA_Q_GPU1_11 -> Attention_Comp_GPU1_11;
    MHA_K_GPU1_11 -> Attention_Comp_GPU1_11;
    MHA_V_GPU1_11 -> Attention_Comp_GPU1_11;
    
    Attention_Comp_GPU0_11 -> Attention_Agg_11;
    Attention_Comp_GPU1_11 -> Attention_Agg_11;
    
    Attention_Agg_11 -> Gate_Compute_11;
    Gate_Compute_11 -> Gate_Softmax_11;
    
    Gate_Softmax_11 -> Expert_Route_Comm_11 [style=dashed];
    Attention_Agg_11 -> Expert_Route_Comm_11;
    
    Expert_Route_Comm_11 -> Expert_11_0_GPU0;
    Expert_Route_Comm_11 -> Expert_11_0_GPU1;
    Expert_11_0_GPU0 -> Expert_Agg_11;
    Expert_11_0_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_1_GPU0;
    Expert_Route_Comm_11 -> Expert_11_1_GPU1;
    Expert_11_1_GPU0 -> Expert_Agg_11;
    Expert_11_1_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_2_GPU0;
    Expert_Route_Comm_11 -> Expert_11_2_GPU1;
    Expert_11_2_GPU0 -> Expert_Agg_11;
    Expert_11_2_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_3_GPU0;
    Expert_Route_Comm_11 -> Expert_11_3_GPU1;
    Expert_11_3_GPU0 -> Expert_Agg_11;
    Expert_11_3_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_4_GPU0;
    Expert_Route_Comm_11 -> Expert_11_4_GPU1;
    Expert_11_4_GPU0 -> Expert_Agg_11;
    Expert_11_4_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_5_GPU0;
    Expert_Route_Comm_11 -> Expert_11_5_GPU1;
    Expert_11_5_GPU0 -> Expert_Agg_11;
    Expert_11_5_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_6_GPU0;
    Expert_Route_Comm_11 -> Expert_11_6_GPU1;
    Expert_11_6_GPU0 -> Expert_Agg_11;
    Expert_11_6_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_7_GPU0;
    Expert_Route_Comm_11 -> Expert_11_7_GPU1;
    Expert_11_7_GPU0 -> Expert_Agg_11;
    Expert_11_7_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_8_GPU0;
    Expert_Route_Comm_11 -> Expert_11_8_GPU1;
    Expert_11_8_GPU0 -> Expert_Agg_11;
    Expert_11_8_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_9_GPU0;
    Expert_Route_Comm_11 -> Expert_11_9_GPU1;
    Expert_11_9_GPU0 -> Expert_Agg_11;
    Expert_11_9_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_10_GPU0;
    Expert_Route_Comm_11 -> Expert_11_10_GPU1;
    Expert_11_10_GPU0 -> Expert_Agg_11;
    Expert_11_10_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_11_GPU0;
    Expert_Route_Comm_11 -> Expert_11_11_GPU1;
    Expert_11_11_GPU0 -> Expert_Agg_11;
    Expert_11_11_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_12_GPU0;
    Expert_Route_Comm_11 -> Expert_11_12_GPU1;
    Expert_11_12_GPU0 -> Expert_Agg_11;
    Expert_11_12_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_13_GPU0;
    Expert_Route_Comm_11 -> Expert_11_13_GPU1;
    Expert_11_13_GPU0 -> Expert_Agg_11;
    Expert_11_13_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_14_GPU0;
    Expert_Route_Comm_11 -> Expert_11_14_GPU1;
    Expert_11_14_GPU0 -> Expert_Agg_11;
    Expert_11_14_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_15_GPU0;
    Expert_Route_Comm_11 -> Expert_11_15_GPU1;
    Expert_11_15_GPU0 -> Expert_Agg_11;
    Expert_11_15_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_16_GPU0;
    Expert_Route_Comm_11 -> Expert_11_16_GPU1;
    Expert_11_16_GPU0 -> Expert_Agg_11;
    Expert_11_16_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_17_GPU0;
    Expert_Route_Comm_11 -> Expert_11_17_GPU1;
    Expert_11_17_GPU0 -> Expert_Agg_11;
    Expert_11_17_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_18_GPU0;
    Expert_Route_Comm_11 -> Expert_11_18_GPU1;
    Expert_11_18_GPU0 -> Expert_Agg_11;
    Expert_11_18_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_19_GPU0;
    Expert_Route_Comm_11 -> Expert_11_19_GPU1;
    Expert_11_19_GPU0 -> Expert_Agg_11;
    Expert_11_19_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_20_GPU0;
    Expert_Route_Comm_11 -> Expert_11_20_GPU1;
    Expert_11_20_GPU0 -> Expert_Agg_11;
    Expert_11_20_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_21_GPU0;
    Expert_Route_Comm_11 -> Expert_11_21_GPU1;
    Expert_11_21_GPU0 -> Expert_Agg_11;
    Expert_11_21_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_22_GPU0;
    Expert_Route_Comm_11 -> Expert_11_22_GPU1;
    Expert_11_22_GPU0 -> Expert_Agg_11;
    Expert_11_22_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_23_GPU0;
    Expert_Route_Comm_11 -> Expert_11_23_GPU1;
    Expert_11_23_GPU0 -> Expert_Agg_11;
    Expert_11_23_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_24_GPU0;
    Expert_Route_Comm_11 -> Expert_11_24_GPU1;
    Expert_11_24_GPU0 -> Expert_Agg_11;
    Expert_11_24_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_25_GPU0;
    Expert_Route_Comm_11 -> Expert_11_25_GPU1;
    Expert_11_25_GPU0 -> Expert_Agg_11;
    Expert_11_25_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_26_GPU0;
    Expert_Route_Comm_11 -> Expert_11_26_GPU1;
    Expert_11_26_GPU0 -> Expert_Agg_11;
    Expert_11_26_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_27_GPU0;
    Expert_Route_Comm_11 -> Expert_11_27_GPU1;
    Expert_11_27_GPU0 -> Expert_Agg_11;
    Expert_11_27_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_28_GPU0;
    Expert_Route_Comm_11 -> Expert_11_28_GPU1;
    Expert_11_28_GPU0 -> Expert_Agg_11;
    Expert_11_28_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_29_GPU0;
    Expert_Route_Comm_11 -> Expert_11_29_GPU1;
    Expert_11_29_GPU0 -> Expert_Agg_11;
    Expert_11_29_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_30_GPU0;
    Expert_Route_Comm_11 -> Expert_11_30_GPU1;
    Expert_11_30_GPU0 -> Expert_Agg_11;
    Expert_11_30_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_31_GPU0;
    Expert_Route_Comm_11 -> Expert_11_31_GPU1;
    Expert_11_31_GPU0 -> Expert_Agg_11;
    Expert_11_31_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_32_GPU0;
    Expert_Route_Comm_11 -> Expert_11_32_GPU1;
    Expert_11_32_GPU0 -> Expert_Agg_11;
    Expert_11_32_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_33_GPU0;
    Expert_Route_Comm_11 -> Expert_11_33_GPU1;
    Expert_11_33_GPU0 -> Expert_Agg_11;
    Expert_11_33_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_34_GPU0;
    Expert_Route_Comm_11 -> Expert_11_34_GPU1;
    Expert_11_34_GPU0 -> Expert_Agg_11;
    Expert_11_34_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_35_GPU0;
    Expert_Route_Comm_11 -> Expert_11_35_GPU1;
    Expert_11_35_GPU0 -> Expert_Agg_11;
    Expert_11_35_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_36_GPU0;
    Expert_Route_Comm_11 -> Expert_11_36_GPU1;
    Expert_11_36_GPU0 -> Expert_Agg_11;
    Expert_11_36_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_37_GPU0;
    Expert_Route_Comm_11 -> Expert_11_37_GPU1;
    Expert_11_37_GPU0 -> Expert_Agg_11;
    Expert_11_37_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_38_GPU0;
    Expert_Route_Comm_11 -> Expert_11_38_GPU1;
    Expert_11_38_GPU0 -> Expert_Agg_11;
    Expert_11_38_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_39_GPU0;
    Expert_Route_Comm_11 -> Expert_11_39_GPU1;
    Expert_11_39_GPU0 -> Expert_Agg_11;
    Expert_11_39_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_40_GPU0;
    Expert_Route_Comm_11 -> Expert_11_40_GPU1;
    Expert_11_40_GPU0 -> Expert_Agg_11;
    Expert_11_40_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_41_GPU0;
    Expert_Route_Comm_11 -> Expert_11_41_GPU1;
    Expert_11_41_GPU0 -> Expert_Agg_11;
    Expert_11_41_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_42_GPU0;
    Expert_Route_Comm_11 -> Expert_11_42_GPU1;
    Expert_11_42_GPU0 -> Expert_Agg_11;
    Expert_11_42_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_43_GPU0;
    Expert_Route_Comm_11 -> Expert_11_43_GPU1;
    Expert_11_43_GPU0 -> Expert_Agg_11;
    Expert_11_43_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_44_GPU0;
    Expert_Route_Comm_11 -> Expert_11_44_GPU1;
    Expert_11_44_GPU0 -> Expert_Agg_11;
    Expert_11_44_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_45_GPU0;
    Expert_Route_Comm_11 -> Expert_11_45_GPU1;
    Expert_11_45_GPU0 -> Expert_Agg_11;
    Expert_11_45_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_46_GPU0;
    Expert_Route_Comm_11 -> Expert_11_46_GPU1;
    Expert_11_46_GPU0 -> Expert_Agg_11;
    Expert_11_46_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_47_GPU0;
    Expert_Route_Comm_11 -> Expert_11_47_GPU1;
    Expert_11_47_GPU0 -> Expert_Agg_11;
    Expert_11_47_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_48_GPU0;
    Expert_Route_Comm_11 -> Expert_11_48_GPU1;
    Expert_11_48_GPU0 -> Expert_Agg_11;
    Expert_11_48_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_49_GPU0;
    Expert_Route_Comm_11 -> Expert_11_49_GPU1;
    Expert_11_49_GPU0 -> Expert_Agg_11;
    Expert_11_49_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_50_GPU0;
    Expert_Route_Comm_11 -> Expert_11_50_GPU1;
    Expert_11_50_GPU0 -> Expert_Agg_11;
    Expert_11_50_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_51_GPU0;
    Expert_Route_Comm_11 -> Expert_11_51_GPU1;
    Expert_11_51_GPU0 -> Expert_Agg_11;
    Expert_11_51_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_52_GPU0;
    Expert_Route_Comm_11 -> Expert_11_52_GPU1;
    Expert_11_52_GPU0 -> Expert_Agg_11;
    Expert_11_52_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_53_GPU0;
    Expert_Route_Comm_11 -> Expert_11_53_GPU1;
    Expert_11_53_GPU0 -> Expert_Agg_11;
    Expert_11_53_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_54_GPU0;
    Expert_Route_Comm_11 -> Expert_11_54_GPU1;
    Expert_11_54_GPU0 -> Expert_Agg_11;
    Expert_11_54_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_55_GPU0;
    Expert_Route_Comm_11 -> Expert_11_55_GPU1;
    Expert_11_55_GPU0 -> Expert_Agg_11;
    Expert_11_55_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_56_GPU0;
    Expert_Route_Comm_11 -> Expert_11_56_GPU1;
    Expert_11_56_GPU0 -> Expert_Agg_11;
    Expert_11_56_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_57_GPU0;
    Expert_Route_Comm_11 -> Expert_11_57_GPU1;
    Expert_11_57_GPU0 -> Expert_Agg_11;
    Expert_11_57_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_58_GPU0;
    Expert_Route_Comm_11 -> Expert_11_58_GPU1;
    Expert_11_58_GPU0 -> Expert_Agg_11;
    Expert_11_58_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_59_GPU0;
    Expert_Route_Comm_11 -> Expert_11_59_GPU1;
    Expert_11_59_GPU0 -> Expert_Agg_11;
    Expert_11_59_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_60_GPU0;
    Expert_Route_Comm_11 -> Expert_11_60_GPU1;
    Expert_11_60_GPU0 -> Expert_Agg_11;
    Expert_11_60_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_61_GPU0;
    Expert_Route_Comm_11 -> Expert_11_61_GPU1;
    Expert_11_61_GPU0 -> Expert_Agg_11;
    Expert_11_61_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_62_GPU0;
    Expert_Route_Comm_11 -> Expert_11_62_GPU1;
    Expert_11_62_GPU0 -> Expert_Agg_11;
    Expert_11_62_GPU1 -> Expert_Agg_11;
    
    Expert_Route_Comm_11 -> Expert_11_63_GPU0;
    Expert_Route_Comm_11 -> Expert_11_63_GPU1;
    Expert_11_63_GPU0 -> Expert_Agg_11;
    Expert_11_63_GPU1 -> Expert_Agg_11;
    
    Expert_Agg_11 -> FFN_GPU0_11;
    Expert_Agg_11 -> FFN_GPU1_11;
    FFN_GPU0_11 -> FFN_Agg_11;
    FFN_GPU1_11 -> FFN_Agg_11;
    FFN_Agg_11 -> LayerNorm_11;
    
    // Layer 12 connections
    LayerNorm_11 -> MHA_Q_GPU0_12;
    LayerNorm_11 -> MHA_K_GPU0_12;
    LayerNorm_11 -> MHA_V_GPU0_12;
    LayerNorm_11 -> MHA_Q_GPU1_12;
    LayerNorm_11 -> MHA_K_GPU1_12;
    LayerNorm_11 -> MHA_V_GPU1_12;
    
    MHA_Q_GPU0_12 -> Attention_Comp_GPU0_12;
    MHA_K_GPU0_12 -> Attention_Comp_GPU0_12;
    MHA_V_GPU0_12 -> Attention_Comp_GPU0_12;
    MHA_Q_GPU1_12 -> Attention_Comp_GPU1_12;
    MHA_K_GPU1_12 -> Attention_Comp_GPU1_12;
    MHA_V_GPU1_12 -> Attention_Comp_GPU1_12;
    
    Attention_Comp_GPU0_12 -> Attention_Agg_12;
    Attention_Comp_GPU1_12 -> Attention_Agg_12;
    
    Attention_Agg_12 -> Gate_Compute_12;
    Gate_Compute_12 -> Gate_Softmax_12;
    
    Gate_Softmax_12 -> Expert_Route_Comm_12 [style=dashed];
    Attention_Agg_12 -> Expert_Route_Comm_12;
    
    Expert_Route_Comm_12 -> Expert_12_0_GPU0;
    Expert_Route_Comm_12 -> Expert_12_0_GPU1;
    Expert_12_0_GPU0 -> Expert_Agg_12;
    Expert_12_0_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_1_GPU0;
    Expert_Route_Comm_12 -> Expert_12_1_GPU1;
    Expert_12_1_GPU0 -> Expert_Agg_12;
    Expert_12_1_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_2_GPU0;
    Expert_Route_Comm_12 -> Expert_12_2_GPU1;
    Expert_12_2_GPU0 -> Expert_Agg_12;
    Expert_12_2_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_3_GPU0;
    Expert_Route_Comm_12 -> Expert_12_3_GPU1;
    Expert_12_3_GPU0 -> Expert_Agg_12;
    Expert_12_3_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_4_GPU0;
    Expert_Route_Comm_12 -> Expert_12_4_GPU1;
    Expert_12_4_GPU0 -> Expert_Agg_12;
    Expert_12_4_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_5_GPU0;
    Expert_Route_Comm_12 -> Expert_12_5_GPU1;
    Expert_12_5_GPU0 -> Expert_Agg_12;
    Expert_12_5_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_6_GPU0;
    Expert_Route_Comm_12 -> Expert_12_6_GPU1;
    Expert_12_6_GPU0 -> Expert_Agg_12;
    Expert_12_6_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_7_GPU0;
    Expert_Route_Comm_12 -> Expert_12_7_GPU1;
    Expert_12_7_GPU0 -> Expert_Agg_12;
    Expert_12_7_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_8_GPU0;
    Expert_Route_Comm_12 -> Expert_12_8_GPU1;
    Expert_12_8_GPU0 -> Expert_Agg_12;
    Expert_12_8_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_9_GPU0;
    Expert_Route_Comm_12 -> Expert_12_9_GPU1;
    Expert_12_9_GPU0 -> Expert_Agg_12;
    Expert_12_9_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_10_GPU0;
    Expert_Route_Comm_12 -> Expert_12_10_GPU1;
    Expert_12_10_GPU0 -> Expert_Agg_12;
    Expert_12_10_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_11_GPU0;
    Expert_Route_Comm_12 -> Expert_12_11_GPU1;
    Expert_12_11_GPU0 -> Expert_Agg_12;
    Expert_12_11_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_12_GPU0;
    Expert_Route_Comm_12 -> Expert_12_12_GPU1;
    Expert_12_12_GPU0 -> Expert_Agg_12;
    Expert_12_12_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_13_GPU0;
    Expert_Route_Comm_12 -> Expert_12_13_GPU1;
    Expert_12_13_GPU0 -> Expert_Agg_12;
    Expert_12_13_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_14_GPU0;
    Expert_Route_Comm_12 -> Expert_12_14_GPU1;
    Expert_12_14_GPU0 -> Expert_Agg_12;
    Expert_12_14_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_15_GPU0;
    Expert_Route_Comm_12 -> Expert_12_15_GPU1;
    Expert_12_15_GPU0 -> Expert_Agg_12;
    Expert_12_15_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_16_GPU0;
    Expert_Route_Comm_12 -> Expert_12_16_GPU1;
    Expert_12_16_GPU0 -> Expert_Agg_12;
    Expert_12_16_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_17_GPU0;
    Expert_Route_Comm_12 -> Expert_12_17_GPU1;
    Expert_12_17_GPU0 -> Expert_Agg_12;
    Expert_12_17_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_18_GPU0;
    Expert_Route_Comm_12 -> Expert_12_18_GPU1;
    Expert_12_18_GPU0 -> Expert_Agg_12;
    Expert_12_18_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_19_GPU0;
    Expert_Route_Comm_12 -> Expert_12_19_GPU1;
    Expert_12_19_GPU0 -> Expert_Agg_12;
    Expert_12_19_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_20_GPU0;
    Expert_Route_Comm_12 -> Expert_12_20_GPU1;
    Expert_12_20_GPU0 -> Expert_Agg_12;
    Expert_12_20_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_21_GPU0;
    Expert_Route_Comm_12 -> Expert_12_21_GPU1;
    Expert_12_21_GPU0 -> Expert_Agg_12;
    Expert_12_21_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_22_GPU0;
    Expert_Route_Comm_12 -> Expert_12_22_GPU1;
    Expert_12_22_GPU0 -> Expert_Agg_12;
    Expert_12_22_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_23_GPU0;
    Expert_Route_Comm_12 -> Expert_12_23_GPU1;
    Expert_12_23_GPU0 -> Expert_Agg_12;
    Expert_12_23_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_24_GPU0;
    Expert_Route_Comm_12 -> Expert_12_24_GPU1;
    Expert_12_24_GPU0 -> Expert_Agg_12;
    Expert_12_24_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_25_GPU0;
    Expert_Route_Comm_12 -> Expert_12_25_GPU1;
    Expert_12_25_GPU0 -> Expert_Agg_12;
    Expert_12_25_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_26_GPU0;
    Expert_Route_Comm_12 -> Expert_12_26_GPU1;
    Expert_12_26_GPU0 -> Expert_Agg_12;
    Expert_12_26_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_27_GPU0;
    Expert_Route_Comm_12 -> Expert_12_27_GPU1;
    Expert_12_27_GPU0 -> Expert_Agg_12;
    Expert_12_27_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_28_GPU0;
    Expert_Route_Comm_12 -> Expert_12_28_GPU1;
    Expert_12_28_GPU0 -> Expert_Agg_12;
    Expert_12_28_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_29_GPU0;
    Expert_Route_Comm_12 -> Expert_12_29_GPU1;
    Expert_12_29_GPU0 -> Expert_Agg_12;
    Expert_12_29_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_30_GPU0;
    Expert_Route_Comm_12 -> Expert_12_30_GPU1;
    Expert_12_30_GPU0 -> Expert_Agg_12;
    Expert_12_30_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_31_GPU0;
    Expert_Route_Comm_12 -> Expert_12_31_GPU1;
    Expert_12_31_GPU0 -> Expert_Agg_12;
    Expert_12_31_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_32_GPU0;
    Expert_Route_Comm_12 -> Expert_12_32_GPU1;
    Expert_12_32_GPU0 -> Expert_Agg_12;
    Expert_12_32_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_33_GPU0;
    Expert_Route_Comm_12 -> Expert_12_33_GPU1;
    Expert_12_33_GPU0 -> Expert_Agg_12;
    Expert_12_33_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_34_GPU0;
    Expert_Route_Comm_12 -> Expert_12_34_GPU1;
    Expert_12_34_GPU0 -> Expert_Agg_12;
    Expert_12_34_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_35_GPU0;
    Expert_Route_Comm_12 -> Expert_12_35_GPU1;
    Expert_12_35_GPU0 -> Expert_Agg_12;
    Expert_12_35_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_36_GPU0;
    Expert_Route_Comm_12 -> Expert_12_36_GPU1;
    Expert_12_36_GPU0 -> Expert_Agg_12;
    Expert_12_36_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_37_GPU0;
    Expert_Route_Comm_12 -> Expert_12_37_GPU1;
    Expert_12_37_GPU0 -> Expert_Agg_12;
    Expert_12_37_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_38_GPU0;
    Expert_Route_Comm_12 -> Expert_12_38_GPU1;
    Expert_12_38_GPU0 -> Expert_Agg_12;
    Expert_12_38_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_39_GPU0;
    Expert_Route_Comm_12 -> Expert_12_39_GPU1;
    Expert_12_39_GPU0 -> Expert_Agg_12;
    Expert_12_39_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_40_GPU0;
    Expert_Route_Comm_12 -> Expert_12_40_GPU1;
    Expert_12_40_GPU0 -> Expert_Agg_12;
    Expert_12_40_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_41_GPU0;
    Expert_Route_Comm_12 -> Expert_12_41_GPU1;
    Expert_12_41_GPU0 -> Expert_Agg_12;
    Expert_12_41_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_42_GPU0;
    Expert_Route_Comm_12 -> Expert_12_42_GPU1;
    Expert_12_42_GPU0 -> Expert_Agg_12;
    Expert_12_42_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_43_GPU0;
    Expert_Route_Comm_12 -> Expert_12_43_GPU1;
    Expert_12_43_GPU0 -> Expert_Agg_12;
    Expert_12_43_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_44_GPU0;
    Expert_Route_Comm_12 -> Expert_12_44_GPU1;
    Expert_12_44_GPU0 -> Expert_Agg_12;
    Expert_12_44_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_45_GPU0;
    Expert_Route_Comm_12 -> Expert_12_45_GPU1;
    Expert_12_45_GPU0 -> Expert_Agg_12;
    Expert_12_45_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_46_GPU0;
    Expert_Route_Comm_12 -> Expert_12_46_GPU1;
    Expert_12_46_GPU0 -> Expert_Agg_12;
    Expert_12_46_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_47_GPU0;
    Expert_Route_Comm_12 -> Expert_12_47_GPU1;
    Expert_12_47_GPU0 -> Expert_Agg_12;
    Expert_12_47_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_48_GPU0;
    Expert_Route_Comm_12 -> Expert_12_48_GPU1;
    Expert_12_48_GPU0 -> Expert_Agg_12;
    Expert_12_48_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_49_GPU0;
    Expert_Route_Comm_12 -> Expert_12_49_GPU1;
    Expert_12_49_GPU0 -> Expert_Agg_12;
    Expert_12_49_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_50_GPU0;
    Expert_Route_Comm_12 -> Expert_12_50_GPU1;
    Expert_12_50_GPU0 -> Expert_Agg_12;
    Expert_12_50_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_51_GPU0;
    Expert_Route_Comm_12 -> Expert_12_51_GPU1;
    Expert_12_51_GPU0 -> Expert_Agg_12;
    Expert_12_51_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_52_GPU0;
    Expert_Route_Comm_12 -> Expert_12_52_GPU1;
    Expert_12_52_GPU0 -> Expert_Agg_12;
    Expert_12_52_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_53_GPU0;
    Expert_Route_Comm_12 -> Expert_12_53_GPU1;
    Expert_12_53_GPU0 -> Expert_Agg_12;
    Expert_12_53_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_54_GPU0;
    Expert_Route_Comm_12 -> Expert_12_54_GPU1;
    Expert_12_54_GPU0 -> Expert_Agg_12;
    Expert_12_54_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_55_GPU0;
    Expert_Route_Comm_12 -> Expert_12_55_GPU1;
    Expert_12_55_GPU0 -> Expert_Agg_12;
    Expert_12_55_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_56_GPU0;
    Expert_Route_Comm_12 -> Expert_12_56_GPU1;
    Expert_12_56_GPU0 -> Expert_Agg_12;
    Expert_12_56_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_57_GPU0;
    Expert_Route_Comm_12 -> Expert_12_57_GPU1;
    Expert_12_57_GPU0 -> Expert_Agg_12;
    Expert_12_57_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_58_GPU0;
    Expert_Route_Comm_12 -> Expert_12_58_GPU1;
    Expert_12_58_GPU0 -> Expert_Agg_12;
    Expert_12_58_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_59_GPU0;
    Expert_Route_Comm_12 -> Expert_12_59_GPU1;
    Expert_12_59_GPU0 -> Expert_Agg_12;
    Expert_12_59_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_60_GPU0;
    Expert_Route_Comm_12 -> Expert_12_60_GPU1;
    Expert_12_60_GPU0 -> Expert_Agg_12;
    Expert_12_60_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_61_GPU0;
    Expert_Route_Comm_12 -> Expert_12_61_GPU1;
    Expert_12_61_GPU0 -> Expert_Agg_12;
    Expert_12_61_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_62_GPU0;
    Expert_Route_Comm_12 -> Expert_12_62_GPU1;
    Expert_12_62_GPU0 -> Expert_Agg_12;
    Expert_12_62_GPU1 -> Expert_Agg_12;
    
    Expert_Route_Comm_12 -> Expert_12_63_GPU0;
    Expert_Route_Comm_12 -> Expert_12_63_GPU1;
    Expert_12_63_GPU0 -> Expert_Agg_12;
    Expert_12_63_GPU1 -> Expert_Agg_12;
    
    Expert_Agg_12 -> FFN_GPU0_12;
    Expert_Agg_12 -> FFN_GPU1_12;
    FFN_GPU0_12 -> FFN_Agg_12;
    FFN_GPU1_12 -> FFN_Agg_12;
    FFN_Agg_12 -> LayerNorm_12;
    
    // Layer 13 connections
    LayerNorm_12 -> MHA_Q_GPU0_13;
    LayerNorm_12 -> MHA_K_GPU0_13;
    LayerNorm_12 -> MHA_V_GPU0_13;
    LayerNorm_12 -> MHA_Q_GPU1_13;
    LayerNorm_12 -> MHA_K_GPU1_13;
    LayerNorm_12 -> MHA_V_GPU1_13;
    
    MHA_Q_GPU0_13 -> Attention_Comp_GPU0_13;
    MHA_K_GPU0_13 -> Attention_Comp_GPU0_13;
    MHA_V_GPU0_13 -> Attention_Comp_GPU0_13;
    MHA_Q_GPU1_13 -> Attention_Comp_GPU1_13;
    MHA_K_GPU1_13 -> Attention_Comp_GPU1_13;
    MHA_V_GPU1_13 -> Attention_Comp_GPU1_13;
    
    Attention_Comp_GPU0_13 -> Attention_Agg_13;
    Attention_Comp_GPU1_13 -> Attention_Agg_13;
    
    Attention_Agg_13 -> Gate_Compute_13;
    Gate_Compute_13 -> Gate_Softmax_13;
    
    Gate_Softmax_13 -> Expert_Route_Comm_13 [style=dashed];
    Attention_Agg_13 -> Expert_Route_Comm_13;
    
    Expert_Route_Comm_13 -> Expert_13_0_GPU0;
    Expert_Route_Comm_13 -> Expert_13_0_GPU1;
    Expert_13_0_GPU0 -> Expert_Agg_13;
    Expert_13_0_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_1_GPU0;
    Expert_Route_Comm_13 -> Expert_13_1_GPU1;
    Expert_13_1_GPU0 -> Expert_Agg_13;
    Expert_13_1_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_2_GPU0;
    Expert_Route_Comm_13 -> Expert_13_2_GPU1;
    Expert_13_2_GPU0 -> Expert_Agg_13;
    Expert_13_2_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_3_GPU0;
    Expert_Route_Comm_13 -> Expert_13_3_GPU1;
    Expert_13_3_GPU0 -> Expert_Agg_13;
    Expert_13_3_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_4_GPU0;
    Expert_Route_Comm_13 -> Expert_13_4_GPU1;
    Expert_13_4_GPU0 -> Expert_Agg_13;
    Expert_13_4_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_5_GPU0;
    Expert_Route_Comm_13 -> Expert_13_5_GPU1;
    Expert_13_5_GPU0 -> Expert_Agg_13;
    Expert_13_5_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_6_GPU0;
    Expert_Route_Comm_13 -> Expert_13_6_GPU1;
    Expert_13_6_GPU0 -> Expert_Agg_13;
    Expert_13_6_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_7_GPU0;
    Expert_Route_Comm_13 -> Expert_13_7_GPU1;
    Expert_13_7_GPU0 -> Expert_Agg_13;
    Expert_13_7_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_8_GPU0;
    Expert_Route_Comm_13 -> Expert_13_8_GPU1;
    Expert_13_8_GPU0 -> Expert_Agg_13;
    Expert_13_8_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_9_GPU0;
    Expert_Route_Comm_13 -> Expert_13_9_GPU1;
    Expert_13_9_GPU0 -> Expert_Agg_13;
    Expert_13_9_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_10_GPU0;
    Expert_Route_Comm_13 -> Expert_13_10_GPU1;
    Expert_13_10_GPU0 -> Expert_Agg_13;
    Expert_13_10_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_11_GPU0;
    Expert_Route_Comm_13 -> Expert_13_11_GPU1;
    Expert_13_11_GPU0 -> Expert_Agg_13;
    Expert_13_11_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_12_GPU0;
    Expert_Route_Comm_13 -> Expert_13_12_GPU1;
    Expert_13_12_GPU0 -> Expert_Agg_13;
    Expert_13_12_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_13_GPU0;
    Expert_Route_Comm_13 -> Expert_13_13_GPU1;
    Expert_13_13_GPU0 -> Expert_Agg_13;
    Expert_13_13_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_14_GPU0;
    Expert_Route_Comm_13 -> Expert_13_14_GPU1;
    Expert_13_14_GPU0 -> Expert_Agg_13;
    Expert_13_14_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_15_GPU0;
    Expert_Route_Comm_13 -> Expert_13_15_GPU1;
    Expert_13_15_GPU0 -> Expert_Agg_13;
    Expert_13_15_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_16_GPU0;
    Expert_Route_Comm_13 -> Expert_13_16_GPU1;
    Expert_13_16_GPU0 -> Expert_Agg_13;
    Expert_13_16_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_17_GPU0;
    Expert_Route_Comm_13 -> Expert_13_17_GPU1;
    Expert_13_17_GPU0 -> Expert_Agg_13;
    Expert_13_17_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_18_GPU0;
    Expert_Route_Comm_13 -> Expert_13_18_GPU1;
    Expert_13_18_GPU0 -> Expert_Agg_13;
    Expert_13_18_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_19_GPU0;
    Expert_Route_Comm_13 -> Expert_13_19_GPU1;
    Expert_13_19_GPU0 -> Expert_Agg_13;
    Expert_13_19_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_20_GPU0;
    Expert_Route_Comm_13 -> Expert_13_20_GPU1;
    Expert_13_20_GPU0 -> Expert_Agg_13;
    Expert_13_20_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_21_GPU0;
    Expert_Route_Comm_13 -> Expert_13_21_GPU1;
    Expert_13_21_GPU0 -> Expert_Agg_13;
    Expert_13_21_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_22_GPU0;
    Expert_Route_Comm_13 -> Expert_13_22_GPU1;
    Expert_13_22_GPU0 -> Expert_Agg_13;
    Expert_13_22_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_23_GPU0;
    Expert_Route_Comm_13 -> Expert_13_23_GPU1;
    Expert_13_23_GPU0 -> Expert_Agg_13;
    Expert_13_23_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_24_GPU0;
    Expert_Route_Comm_13 -> Expert_13_24_GPU1;
    Expert_13_24_GPU0 -> Expert_Agg_13;
    Expert_13_24_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_25_GPU0;
    Expert_Route_Comm_13 -> Expert_13_25_GPU1;
    Expert_13_25_GPU0 -> Expert_Agg_13;
    Expert_13_25_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_26_GPU0;
    Expert_Route_Comm_13 -> Expert_13_26_GPU1;
    Expert_13_26_GPU0 -> Expert_Agg_13;
    Expert_13_26_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_27_GPU0;
    Expert_Route_Comm_13 -> Expert_13_27_GPU1;
    Expert_13_27_GPU0 -> Expert_Agg_13;
    Expert_13_27_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_28_GPU0;
    Expert_Route_Comm_13 -> Expert_13_28_GPU1;
    Expert_13_28_GPU0 -> Expert_Agg_13;
    Expert_13_28_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_29_GPU0;
    Expert_Route_Comm_13 -> Expert_13_29_GPU1;
    Expert_13_29_GPU0 -> Expert_Agg_13;
    Expert_13_29_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_30_GPU0;
    Expert_Route_Comm_13 -> Expert_13_30_GPU1;
    Expert_13_30_GPU0 -> Expert_Agg_13;
    Expert_13_30_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_31_GPU0;
    Expert_Route_Comm_13 -> Expert_13_31_GPU1;
    Expert_13_31_GPU0 -> Expert_Agg_13;
    Expert_13_31_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_32_GPU0;
    Expert_Route_Comm_13 -> Expert_13_32_GPU1;
    Expert_13_32_GPU0 -> Expert_Agg_13;
    Expert_13_32_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_33_GPU0;
    Expert_Route_Comm_13 -> Expert_13_33_GPU1;
    Expert_13_33_GPU0 -> Expert_Agg_13;
    Expert_13_33_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_34_GPU0;
    Expert_Route_Comm_13 -> Expert_13_34_GPU1;
    Expert_13_34_GPU0 -> Expert_Agg_13;
    Expert_13_34_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_35_GPU0;
    Expert_Route_Comm_13 -> Expert_13_35_GPU1;
    Expert_13_35_GPU0 -> Expert_Agg_13;
    Expert_13_35_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_36_GPU0;
    Expert_Route_Comm_13 -> Expert_13_36_GPU1;
    Expert_13_36_GPU0 -> Expert_Agg_13;
    Expert_13_36_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_37_GPU0;
    Expert_Route_Comm_13 -> Expert_13_37_GPU1;
    Expert_13_37_GPU0 -> Expert_Agg_13;
    Expert_13_37_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_38_GPU0;
    Expert_Route_Comm_13 -> Expert_13_38_GPU1;
    Expert_13_38_GPU0 -> Expert_Agg_13;
    Expert_13_38_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_39_GPU0;
    Expert_Route_Comm_13 -> Expert_13_39_GPU1;
    Expert_13_39_GPU0 -> Expert_Agg_13;
    Expert_13_39_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_40_GPU0;
    Expert_Route_Comm_13 -> Expert_13_40_GPU1;
    Expert_13_40_GPU0 -> Expert_Agg_13;
    Expert_13_40_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_41_GPU0;
    Expert_Route_Comm_13 -> Expert_13_41_GPU1;
    Expert_13_41_GPU0 -> Expert_Agg_13;
    Expert_13_41_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_42_GPU0;
    Expert_Route_Comm_13 -> Expert_13_42_GPU1;
    Expert_13_42_GPU0 -> Expert_Agg_13;
    Expert_13_42_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_43_GPU0;
    Expert_Route_Comm_13 -> Expert_13_43_GPU1;
    Expert_13_43_GPU0 -> Expert_Agg_13;
    Expert_13_43_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_44_GPU0;
    Expert_Route_Comm_13 -> Expert_13_44_GPU1;
    Expert_13_44_GPU0 -> Expert_Agg_13;
    Expert_13_44_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_45_GPU0;
    Expert_Route_Comm_13 -> Expert_13_45_GPU1;
    Expert_13_45_GPU0 -> Expert_Agg_13;
    Expert_13_45_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_46_GPU0;
    Expert_Route_Comm_13 -> Expert_13_46_GPU1;
    Expert_13_46_GPU0 -> Expert_Agg_13;
    Expert_13_46_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_47_GPU0;
    Expert_Route_Comm_13 -> Expert_13_47_GPU1;
    Expert_13_47_GPU0 -> Expert_Agg_13;
    Expert_13_47_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_48_GPU0;
    Expert_Route_Comm_13 -> Expert_13_48_GPU1;
    Expert_13_48_GPU0 -> Expert_Agg_13;
    Expert_13_48_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_49_GPU0;
    Expert_Route_Comm_13 -> Expert_13_49_GPU1;
    Expert_13_49_GPU0 -> Expert_Agg_13;
    Expert_13_49_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_50_GPU0;
    Expert_Route_Comm_13 -> Expert_13_50_GPU1;
    Expert_13_50_GPU0 -> Expert_Agg_13;
    Expert_13_50_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_51_GPU0;
    Expert_Route_Comm_13 -> Expert_13_51_GPU1;
    Expert_13_51_GPU0 -> Expert_Agg_13;
    Expert_13_51_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_52_GPU0;
    Expert_Route_Comm_13 -> Expert_13_52_GPU1;
    Expert_13_52_GPU0 -> Expert_Agg_13;
    Expert_13_52_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_53_GPU0;
    Expert_Route_Comm_13 -> Expert_13_53_GPU1;
    Expert_13_53_GPU0 -> Expert_Agg_13;
    Expert_13_53_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_54_GPU0;
    Expert_Route_Comm_13 -> Expert_13_54_GPU1;
    Expert_13_54_GPU0 -> Expert_Agg_13;
    Expert_13_54_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_55_GPU0;
    Expert_Route_Comm_13 -> Expert_13_55_GPU1;
    Expert_13_55_GPU0 -> Expert_Agg_13;
    Expert_13_55_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_56_GPU0;
    Expert_Route_Comm_13 -> Expert_13_56_GPU1;
    Expert_13_56_GPU0 -> Expert_Agg_13;
    Expert_13_56_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_57_GPU0;
    Expert_Route_Comm_13 -> Expert_13_57_GPU1;
    Expert_13_57_GPU0 -> Expert_Agg_13;
    Expert_13_57_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_58_GPU0;
    Expert_Route_Comm_13 -> Expert_13_58_GPU1;
    Expert_13_58_GPU0 -> Expert_Agg_13;
    Expert_13_58_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_59_GPU0;
    Expert_Route_Comm_13 -> Expert_13_59_GPU1;
    Expert_13_59_GPU0 -> Expert_Agg_13;
    Expert_13_59_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_60_GPU0;
    Expert_Route_Comm_13 -> Expert_13_60_GPU1;
    Expert_13_60_GPU0 -> Expert_Agg_13;
    Expert_13_60_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_61_GPU0;
    Expert_Route_Comm_13 -> Expert_13_61_GPU1;
    Expert_13_61_GPU0 -> Expert_Agg_13;
    Expert_13_61_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_62_GPU0;
    Expert_Route_Comm_13 -> Expert_13_62_GPU1;
    Expert_13_62_GPU0 -> Expert_Agg_13;
    Expert_13_62_GPU1 -> Expert_Agg_13;
    
    Expert_Route_Comm_13 -> Expert_13_63_GPU0;
    Expert_Route_Comm_13 -> Expert_13_63_GPU1;
    Expert_13_63_GPU0 -> Expert_Agg_13;
    Expert_13_63_GPU1 -> Expert_Agg_13;
    
    Expert_Agg_13 -> FFN_GPU0_13;
    Expert_Agg_13 -> FFN_GPU1_13;
    FFN_GPU0_13 -> FFN_Agg_13;
    FFN_GPU1_13 -> FFN_Agg_13;
    FFN_Agg_13 -> LayerNorm_13;
    
    // Layer 14 connections
    LayerNorm_13 -> MHA_Q_GPU0_14;
    LayerNorm_13 -> MHA_K_GPU0_14;
    LayerNorm_13 -> MHA_V_GPU0_14;
    LayerNorm_13 -> MHA_Q_GPU1_14;
    LayerNorm_13 -> MHA_K_GPU1_14;
    LayerNorm_13 -> MHA_V_GPU1_14;
    
    MHA_Q_GPU0_14 -> Attention_Comp_GPU0_14;
    MHA_K_GPU0_14 -> Attention_Comp_GPU0_14;
    MHA_V_GPU0_14 -> Attention_Comp_GPU0_14;
    MHA_Q_GPU1_14 -> Attention_Comp_GPU1_14;
    MHA_K_GPU1_14 -> Attention_Comp_GPU1_14;
    MHA_V_GPU1_14 -> Attention_Comp_GPU1_14;
    
    Attention_Comp_GPU0_14 -> Attention_Agg_14;
    Attention_Comp_GPU1_14 -> Attention_Agg_14;
    
    Attention_Agg_14 -> Gate_Compute_14;
    Gate_Compute_14 -> Gate_Softmax_14;
    
    Gate_Softmax_14 -> Expert_Route_Comm_14 [style=dashed];
    Attention_Agg_14 -> Expert_Route_Comm_14;
    
    Expert_Route_Comm_14 -> Expert_14_0_GPU0;
    Expert_Route_Comm_14 -> Expert_14_0_GPU1;
    Expert_14_0_GPU0 -> Expert_Agg_14;
    Expert_14_0_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_1_GPU0;
    Expert_Route_Comm_14 -> Expert_14_1_GPU1;
    Expert_14_1_GPU0 -> Expert_Agg_14;
    Expert_14_1_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_2_GPU0;
    Expert_Route_Comm_14 -> Expert_14_2_GPU1;
    Expert_14_2_GPU0 -> Expert_Agg_14;
    Expert_14_2_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_3_GPU0;
    Expert_Route_Comm_14 -> Expert_14_3_GPU1;
    Expert_14_3_GPU0 -> Expert_Agg_14;
    Expert_14_3_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_4_GPU0;
    Expert_Route_Comm_14 -> Expert_14_4_GPU1;
    Expert_14_4_GPU0 -> Expert_Agg_14;
    Expert_14_4_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_5_GPU0;
    Expert_Route_Comm_14 -> Expert_14_5_GPU1;
    Expert_14_5_GPU0 -> Expert_Agg_14;
    Expert_14_5_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_6_GPU0;
    Expert_Route_Comm_14 -> Expert_14_6_GPU1;
    Expert_14_6_GPU0 -> Expert_Agg_14;
    Expert_14_6_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_7_GPU0;
    Expert_Route_Comm_14 -> Expert_14_7_GPU1;
    Expert_14_7_GPU0 -> Expert_Agg_14;
    Expert_14_7_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_8_GPU0;
    Expert_Route_Comm_14 -> Expert_14_8_GPU1;
    Expert_14_8_GPU0 -> Expert_Agg_14;
    Expert_14_8_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_9_GPU0;
    Expert_Route_Comm_14 -> Expert_14_9_GPU1;
    Expert_14_9_GPU0 -> Expert_Agg_14;
    Expert_14_9_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_10_GPU0;
    Expert_Route_Comm_14 -> Expert_14_10_GPU1;
    Expert_14_10_GPU0 -> Expert_Agg_14;
    Expert_14_10_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_11_GPU0;
    Expert_Route_Comm_14 -> Expert_14_11_GPU1;
    Expert_14_11_GPU0 -> Expert_Agg_14;
    Expert_14_11_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_12_GPU0;
    Expert_Route_Comm_14 -> Expert_14_12_GPU1;
    Expert_14_12_GPU0 -> Expert_Agg_14;
    Expert_14_12_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_13_GPU0;
    Expert_Route_Comm_14 -> Expert_14_13_GPU1;
    Expert_14_13_GPU0 -> Expert_Agg_14;
    Expert_14_13_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_14_GPU0;
    Expert_Route_Comm_14 -> Expert_14_14_GPU1;
    Expert_14_14_GPU0 -> Expert_Agg_14;
    Expert_14_14_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_15_GPU0;
    Expert_Route_Comm_14 -> Expert_14_15_GPU1;
    Expert_14_15_GPU0 -> Expert_Agg_14;
    Expert_14_15_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_16_GPU0;
    Expert_Route_Comm_14 -> Expert_14_16_GPU1;
    Expert_14_16_GPU0 -> Expert_Agg_14;
    Expert_14_16_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_17_GPU0;
    Expert_Route_Comm_14 -> Expert_14_17_GPU1;
    Expert_14_17_GPU0 -> Expert_Agg_14;
    Expert_14_17_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_18_GPU0;
    Expert_Route_Comm_14 -> Expert_14_18_GPU1;
    Expert_14_18_GPU0 -> Expert_Agg_14;
    Expert_14_18_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_19_GPU0;
    Expert_Route_Comm_14 -> Expert_14_19_GPU1;
    Expert_14_19_GPU0 -> Expert_Agg_14;
    Expert_14_19_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_20_GPU0;
    Expert_Route_Comm_14 -> Expert_14_20_GPU1;
    Expert_14_20_GPU0 -> Expert_Agg_14;
    Expert_14_20_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_21_GPU0;
    Expert_Route_Comm_14 -> Expert_14_21_GPU1;
    Expert_14_21_GPU0 -> Expert_Agg_14;
    Expert_14_21_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_22_GPU0;
    Expert_Route_Comm_14 -> Expert_14_22_GPU1;
    Expert_14_22_GPU0 -> Expert_Agg_14;
    Expert_14_22_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_23_GPU0;
    Expert_Route_Comm_14 -> Expert_14_23_GPU1;
    Expert_14_23_GPU0 -> Expert_Agg_14;
    Expert_14_23_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_24_GPU0;
    Expert_Route_Comm_14 -> Expert_14_24_GPU1;
    Expert_14_24_GPU0 -> Expert_Agg_14;
    Expert_14_24_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_25_GPU0;
    Expert_Route_Comm_14 -> Expert_14_25_GPU1;
    Expert_14_25_GPU0 -> Expert_Agg_14;
    Expert_14_25_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_26_GPU0;
    Expert_Route_Comm_14 -> Expert_14_26_GPU1;
    Expert_14_26_GPU0 -> Expert_Agg_14;
    Expert_14_26_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_27_GPU0;
    Expert_Route_Comm_14 -> Expert_14_27_GPU1;
    Expert_14_27_GPU0 -> Expert_Agg_14;
    Expert_14_27_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_28_GPU0;
    Expert_Route_Comm_14 -> Expert_14_28_GPU1;
    Expert_14_28_GPU0 -> Expert_Agg_14;
    Expert_14_28_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_29_GPU0;
    Expert_Route_Comm_14 -> Expert_14_29_GPU1;
    Expert_14_29_GPU0 -> Expert_Agg_14;
    Expert_14_29_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_30_GPU0;
    Expert_Route_Comm_14 -> Expert_14_30_GPU1;
    Expert_14_30_GPU0 -> Expert_Agg_14;
    Expert_14_30_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_31_GPU0;
    Expert_Route_Comm_14 -> Expert_14_31_GPU1;
    Expert_14_31_GPU0 -> Expert_Agg_14;
    Expert_14_31_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_32_GPU0;
    Expert_Route_Comm_14 -> Expert_14_32_GPU1;
    Expert_14_32_GPU0 -> Expert_Agg_14;
    Expert_14_32_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_33_GPU0;
    Expert_Route_Comm_14 -> Expert_14_33_GPU1;
    Expert_14_33_GPU0 -> Expert_Agg_14;
    Expert_14_33_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_34_GPU0;
    Expert_Route_Comm_14 -> Expert_14_34_GPU1;
    Expert_14_34_GPU0 -> Expert_Agg_14;
    Expert_14_34_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_35_GPU0;
    Expert_Route_Comm_14 -> Expert_14_35_GPU1;
    Expert_14_35_GPU0 -> Expert_Agg_14;
    Expert_14_35_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_36_GPU0;
    Expert_Route_Comm_14 -> Expert_14_36_GPU1;
    Expert_14_36_GPU0 -> Expert_Agg_14;
    Expert_14_36_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_37_GPU0;
    Expert_Route_Comm_14 -> Expert_14_37_GPU1;
    Expert_14_37_GPU0 -> Expert_Agg_14;
    Expert_14_37_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_38_GPU0;
    Expert_Route_Comm_14 -> Expert_14_38_GPU1;
    Expert_14_38_GPU0 -> Expert_Agg_14;
    Expert_14_38_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_39_GPU0;
    Expert_Route_Comm_14 -> Expert_14_39_GPU1;
    Expert_14_39_GPU0 -> Expert_Agg_14;
    Expert_14_39_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_40_GPU0;
    Expert_Route_Comm_14 -> Expert_14_40_GPU1;
    Expert_14_40_GPU0 -> Expert_Agg_14;
    Expert_14_40_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_41_GPU0;
    Expert_Route_Comm_14 -> Expert_14_41_GPU1;
    Expert_14_41_GPU0 -> Expert_Agg_14;
    Expert_14_41_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_42_GPU0;
    Expert_Route_Comm_14 -> Expert_14_42_GPU1;
    Expert_14_42_GPU0 -> Expert_Agg_14;
    Expert_14_42_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_43_GPU0;
    Expert_Route_Comm_14 -> Expert_14_43_GPU1;
    Expert_14_43_GPU0 -> Expert_Agg_14;
    Expert_14_43_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_44_GPU0;
    Expert_Route_Comm_14 -> Expert_14_44_GPU1;
    Expert_14_44_GPU0 -> Expert_Agg_14;
    Expert_14_44_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_45_GPU0;
    Expert_Route_Comm_14 -> Expert_14_45_GPU1;
    Expert_14_45_GPU0 -> Expert_Agg_14;
    Expert_14_45_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_46_GPU0;
    Expert_Route_Comm_14 -> Expert_14_46_GPU1;
    Expert_14_46_GPU0 -> Expert_Agg_14;
    Expert_14_46_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_47_GPU0;
    Expert_Route_Comm_14 -> Expert_14_47_GPU1;
    Expert_14_47_GPU0 -> Expert_Agg_14;
    Expert_14_47_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_48_GPU0;
    Expert_Route_Comm_14 -> Expert_14_48_GPU1;
    Expert_14_48_GPU0 -> Expert_Agg_14;
    Expert_14_48_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_49_GPU0;
    Expert_Route_Comm_14 -> Expert_14_49_GPU1;
    Expert_14_49_GPU0 -> Expert_Agg_14;
    Expert_14_49_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_50_GPU0;
    Expert_Route_Comm_14 -> Expert_14_50_GPU1;
    Expert_14_50_GPU0 -> Expert_Agg_14;
    Expert_14_50_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_51_GPU0;
    Expert_Route_Comm_14 -> Expert_14_51_GPU1;
    Expert_14_51_GPU0 -> Expert_Agg_14;
    Expert_14_51_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_52_GPU0;
    Expert_Route_Comm_14 -> Expert_14_52_GPU1;
    Expert_14_52_GPU0 -> Expert_Agg_14;
    Expert_14_52_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_53_GPU0;
    Expert_Route_Comm_14 -> Expert_14_53_GPU1;
    Expert_14_53_GPU0 -> Expert_Agg_14;
    Expert_14_53_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_54_GPU0;
    Expert_Route_Comm_14 -> Expert_14_54_GPU1;
    Expert_14_54_GPU0 -> Expert_Agg_14;
    Expert_14_54_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_55_GPU0;
    Expert_Route_Comm_14 -> Expert_14_55_GPU1;
    Expert_14_55_GPU0 -> Expert_Agg_14;
    Expert_14_55_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_56_GPU0;
    Expert_Route_Comm_14 -> Expert_14_56_GPU1;
    Expert_14_56_GPU0 -> Expert_Agg_14;
    Expert_14_56_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_57_GPU0;
    Expert_Route_Comm_14 -> Expert_14_57_GPU1;
    Expert_14_57_GPU0 -> Expert_Agg_14;
    Expert_14_57_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_58_GPU0;
    Expert_Route_Comm_14 -> Expert_14_58_GPU1;
    Expert_14_58_GPU0 -> Expert_Agg_14;
    Expert_14_58_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_59_GPU0;
    Expert_Route_Comm_14 -> Expert_14_59_GPU1;
    Expert_14_59_GPU0 -> Expert_Agg_14;
    Expert_14_59_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_60_GPU0;
    Expert_Route_Comm_14 -> Expert_14_60_GPU1;
    Expert_14_60_GPU0 -> Expert_Agg_14;
    Expert_14_60_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_61_GPU0;
    Expert_Route_Comm_14 -> Expert_14_61_GPU1;
    Expert_14_61_GPU0 -> Expert_Agg_14;
    Expert_14_61_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_62_GPU0;
    Expert_Route_Comm_14 -> Expert_14_62_GPU1;
    Expert_14_62_GPU0 -> Expert_Agg_14;
    Expert_14_62_GPU1 -> Expert_Agg_14;
    
    Expert_Route_Comm_14 -> Expert_14_63_GPU0;
    Expert_Route_Comm_14 -> Expert_14_63_GPU1;
    Expert_14_63_GPU0 -> Expert_Agg_14;
    Expert_14_63_GPU1 -> Expert_Agg_14;
    
    Expert_Agg_14 -> FFN_GPU0_14;
    Expert_Agg_14 -> FFN_GPU1_14;
    FFN_GPU0_14 -> FFN_Agg_14;
    FFN_GPU1_14 -> FFN_Agg_14;
    FFN_Agg_14 -> LayerNorm_14;
    
    // Layer 15 connections
    LayerNorm_14 -> MHA_Q_GPU0_15;
    LayerNorm_14 -> MHA_K_GPU0_15;
    LayerNorm_14 -> MHA_V_GPU0_15;
    LayerNorm_14 -> MHA_Q_GPU1_15;
    LayerNorm_14 -> MHA_K_GPU1_15;
    LayerNorm_14 -> MHA_V_GPU1_15;
    
    MHA_Q_GPU0_15 -> Attention_Comp_GPU0_15;
    MHA_K_GPU0_15 -> Attention_Comp_GPU0_15;
    MHA_V_GPU0_15 -> Attention_Comp_GPU0_15;
    MHA_Q_GPU1_15 -> Attention_Comp_GPU1_15;
    MHA_K_GPU1_15 -> Attention_Comp_GPU1_15;
    MHA_V_GPU1_15 -> Attention_Comp_GPU1_15;
    
    Attention_Comp_GPU0_15 -> Attention_Agg_15;
    Attention_Comp_GPU1_15 -> Attention_Agg_15;
    
    Attention_Agg_15 -> Gate_Compute_15;
    Gate_Compute_15 -> Gate_Softmax_15;
    
    Gate_Softmax_15 -> Expert_Route_Comm_15 [style=dashed];
    Attention_Agg_15 -> Expert_Route_Comm_15;
    
    Expert_Route_Comm_15 -> Expert_15_0_GPU0;
    Expert_Route_Comm_15 -> Expert_15_0_GPU1;
    Expert_15_0_GPU0 -> Expert_Agg_15;
    Expert_15_0_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_1_GPU0;
    Expert_Route_Comm_15 -> Expert_15_1_GPU1;
    Expert_15_1_GPU0 -> Expert_Agg_15;
    Expert_15_1_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_2_GPU0;
    Expert_Route_Comm_15 -> Expert_15_2_GPU1;
    Expert_15_2_GPU0 -> Expert_Agg_15;
    Expert_15_2_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_3_GPU0;
    Expert_Route_Comm_15 -> Expert_15_3_GPU1;
    Expert_15_3_GPU0 -> Expert_Agg_15;
    Expert_15_3_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_4_GPU0;
    Expert_Route_Comm_15 -> Expert_15_4_GPU1;
    Expert_15_4_GPU0 -> Expert_Agg_15;
    Expert_15_4_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_5_GPU0;
    Expert_Route_Comm_15 -> Expert_15_5_GPU1;
    Expert_15_5_GPU0 -> Expert_Agg_15;
    Expert_15_5_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_6_GPU0;
    Expert_Route_Comm_15 -> Expert_15_6_GPU1;
    Expert_15_6_GPU0 -> Expert_Agg_15;
    Expert_15_6_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_7_GPU0;
    Expert_Route_Comm_15 -> Expert_15_7_GPU1;
    Expert_15_7_GPU0 -> Expert_Agg_15;
    Expert_15_7_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_8_GPU0;
    Expert_Route_Comm_15 -> Expert_15_8_GPU1;
    Expert_15_8_GPU0 -> Expert_Agg_15;
    Expert_15_8_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_9_GPU0;
    Expert_Route_Comm_15 -> Expert_15_9_GPU1;
    Expert_15_9_GPU0 -> Expert_Agg_15;
    Expert_15_9_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_10_GPU0;
    Expert_Route_Comm_15 -> Expert_15_10_GPU1;
    Expert_15_10_GPU0 -> Expert_Agg_15;
    Expert_15_10_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_11_GPU0;
    Expert_Route_Comm_15 -> Expert_15_11_GPU1;
    Expert_15_11_GPU0 -> Expert_Agg_15;
    Expert_15_11_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_12_GPU0;
    Expert_Route_Comm_15 -> Expert_15_12_GPU1;
    Expert_15_12_GPU0 -> Expert_Agg_15;
    Expert_15_12_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_13_GPU0;
    Expert_Route_Comm_15 -> Expert_15_13_GPU1;
    Expert_15_13_GPU0 -> Expert_Agg_15;
    Expert_15_13_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_14_GPU0;
    Expert_Route_Comm_15 -> Expert_15_14_GPU1;
    Expert_15_14_GPU0 -> Expert_Agg_15;
    Expert_15_14_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_15_GPU0;
    Expert_Route_Comm_15 -> Expert_15_15_GPU1;
    Expert_15_15_GPU0 -> Expert_Agg_15;
    Expert_15_15_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_16_GPU0;
    Expert_Route_Comm_15 -> Expert_15_16_GPU1;
    Expert_15_16_GPU0 -> Expert_Agg_15;
    Expert_15_16_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_17_GPU0;
    Expert_Route_Comm_15 -> Expert_15_17_GPU1;
    Expert_15_17_GPU0 -> Expert_Agg_15;
    Expert_15_17_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_18_GPU0;
    Expert_Route_Comm_15 -> Expert_15_18_GPU1;
    Expert_15_18_GPU0 -> Expert_Agg_15;
    Expert_15_18_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_19_GPU0;
    Expert_Route_Comm_15 -> Expert_15_19_GPU1;
    Expert_15_19_GPU0 -> Expert_Agg_15;
    Expert_15_19_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_20_GPU0;
    Expert_Route_Comm_15 -> Expert_15_20_GPU1;
    Expert_15_20_GPU0 -> Expert_Agg_15;
    Expert_15_20_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_21_GPU0;
    Expert_Route_Comm_15 -> Expert_15_21_GPU1;
    Expert_15_21_GPU0 -> Expert_Agg_15;
    Expert_15_21_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_22_GPU0;
    Expert_Route_Comm_15 -> Expert_15_22_GPU1;
    Expert_15_22_GPU0 -> Expert_Agg_15;
    Expert_15_22_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_23_GPU0;
    Expert_Route_Comm_15 -> Expert_15_23_GPU1;
    Expert_15_23_GPU0 -> Expert_Agg_15;
    Expert_15_23_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_24_GPU0;
    Expert_Route_Comm_15 -> Expert_15_24_GPU1;
    Expert_15_24_GPU0 -> Expert_Agg_15;
    Expert_15_24_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_25_GPU0;
    Expert_Route_Comm_15 -> Expert_15_25_GPU1;
    Expert_15_25_GPU0 -> Expert_Agg_15;
    Expert_15_25_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_26_GPU0;
    Expert_Route_Comm_15 -> Expert_15_26_GPU1;
    Expert_15_26_GPU0 -> Expert_Agg_15;
    Expert_15_26_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_27_GPU0;
    Expert_Route_Comm_15 -> Expert_15_27_GPU1;
    Expert_15_27_GPU0 -> Expert_Agg_15;
    Expert_15_27_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_28_GPU0;
    Expert_Route_Comm_15 -> Expert_15_28_GPU1;
    Expert_15_28_GPU0 -> Expert_Agg_15;
    Expert_15_28_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_29_GPU0;
    Expert_Route_Comm_15 -> Expert_15_29_GPU1;
    Expert_15_29_GPU0 -> Expert_Agg_15;
    Expert_15_29_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_30_GPU0;
    Expert_Route_Comm_15 -> Expert_15_30_GPU1;
    Expert_15_30_GPU0 -> Expert_Agg_15;
    Expert_15_30_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_31_GPU0;
    Expert_Route_Comm_15 -> Expert_15_31_GPU1;
    Expert_15_31_GPU0 -> Expert_Agg_15;
    Expert_15_31_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_32_GPU0;
    Expert_Route_Comm_15 -> Expert_15_32_GPU1;
    Expert_15_32_GPU0 -> Expert_Agg_15;
    Expert_15_32_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_33_GPU0;
    Expert_Route_Comm_15 -> Expert_15_33_GPU1;
    Expert_15_33_GPU0 -> Expert_Agg_15;
    Expert_15_33_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_34_GPU0;
    Expert_Route_Comm_15 -> Expert_15_34_GPU1;
    Expert_15_34_GPU0 -> Expert_Agg_15;
    Expert_15_34_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_35_GPU0;
    Expert_Route_Comm_15 -> Expert_15_35_GPU1;
    Expert_15_35_GPU0 -> Expert_Agg_15;
    Expert_15_35_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_36_GPU0;
    Expert_Route_Comm_15 -> Expert_15_36_GPU1;
    Expert_15_36_GPU0 -> Expert_Agg_15;
    Expert_15_36_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_37_GPU0;
    Expert_Route_Comm_15 -> Expert_15_37_GPU1;
    Expert_15_37_GPU0 -> Expert_Agg_15;
    Expert_15_37_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_38_GPU0;
    Expert_Route_Comm_15 -> Expert_15_38_GPU1;
    Expert_15_38_GPU0 -> Expert_Agg_15;
    Expert_15_38_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_39_GPU0;
    Expert_Route_Comm_15 -> Expert_15_39_GPU1;
    Expert_15_39_GPU0 -> Expert_Agg_15;
    Expert_15_39_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_40_GPU0;
    Expert_Route_Comm_15 -> Expert_15_40_GPU1;
    Expert_15_40_GPU0 -> Expert_Agg_15;
    Expert_15_40_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_41_GPU0;
    Expert_Route_Comm_15 -> Expert_15_41_GPU1;
    Expert_15_41_GPU0 -> Expert_Agg_15;
    Expert_15_41_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_42_GPU0;
    Expert_Route_Comm_15 -> Expert_15_42_GPU1;
    Expert_15_42_GPU0 -> Expert_Agg_15;
    Expert_15_42_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_43_GPU0;
    Expert_Route_Comm_15 -> Expert_15_43_GPU1;
    Expert_15_43_GPU0 -> Expert_Agg_15;
    Expert_15_43_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_44_GPU0;
    Expert_Route_Comm_15 -> Expert_15_44_GPU1;
    Expert_15_44_GPU0 -> Expert_Agg_15;
    Expert_15_44_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_45_GPU0;
    Expert_Route_Comm_15 -> Expert_15_45_GPU1;
    Expert_15_45_GPU0 -> Expert_Agg_15;
    Expert_15_45_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_46_GPU0;
    Expert_Route_Comm_15 -> Expert_15_46_GPU1;
    Expert_15_46_GPU0 -> Expert_Agg_15;
    Expert_15_46_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_47_GPU0;
    Expert_Route_Comm_15 -> Expert_15_47_GPU1;
    Expert_15_47_GPU0 -> Expert_Agg_15;
    Expert_15_47_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_48_GPU0;
    Expert_Route_Comm_15 -> Expert_15_48_GPU1;
    Expert_15_48_GPU0 -> Expert_Agg_15;
    Expert_15_48_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_49_GPU0;
    Expert_Route_Comm_15 -> Expert_15_49_GPU1;
    Expert_15_49_GPU0 -> Expert_Agg_15;
    Expert_15_49_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_50_GPU0;
    Expert_Route_Comm_15 -> Expert_15_50_GPU1;
    Expert_15_50_GPU0 -> Expert_Agg_15;
    Expert_15_50_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_51_GPU0;
    Expert_Route_Comm_15 -> Expert_15_51_GPU1;
    Expert_15_51_GPU0 -> Expert_Agg_15;
    Expert_15_51_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_52_GPU0;
    Expert_Route_Comm_15 -> Expert_15_52_GPU1;
    Expert_15_52_GPU0 -> Expert_Agg_15;
    Expert_15_52_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_53_GPU0;
    Expert_Route_Comm_15 -> Expert_15_53_GPU1;
    Expert_15_53_GPU0 -> Expert_Agg_15;
    Expert_15_53_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_54_GPU0;
    Expert_Route_Comm_15 -> Expert_15_54_GPU1;
    Expert_15_54_GPU0 -> Expert_Agg_15;
    Expert_15_54_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_55_GPU0;
    Expert_Route_Comm_15 -> Expert_15_55_GPU1;
    Expert_15_55_GPU0 -> Expert_Agg_15;
    Expert_15_55_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_56_GPU0;
    Expert_Route_Comm_15 -> Expert_15_56_GPU1;
    Expert_15_56_GPU0 -> Expert_Agg_15;
    Expert_15_56_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_57_GPU0;
    Expert_Route_Comm_15 -> Expert_15_57_GPU1;
    Expert_15_57_GPU0 -> Expert_Agg_15;
    Expert_15_57_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_58_GPU0;
    Expert_Route_Comm_15 -> Expert_15_58_GPU1;
    Expert_15_58_GPU0 -> Expert_Agg_15;
    Expert_15_58_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_59_GPU0;
    Expert_Route_Comm_15 -> Expert_15_59_GPU1;
    Expert_15_59_GPU0 -> Expert_Agg_15;
    Expert_15_59_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_60_GPU0;
    Expert_Route_Comm_15 -> Expert_15_60_GPU1;
    Expert_15_60_GPU0 -> Expert_Agg_15;
    Expert_15_60_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_61_GPU0;
    Expert_Route_Comm_15 -> Expert_15_61_GPU1;
    Expert_15_61_GPU0 -> Expert_Agg_15;
    Expert_15_61_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_62_GPU0;
    Expert_Route_Comm_15 -> Expert_15_62_GPU1;
    Expert_15_62_GPU0 -> Expert_Agg_15;
    Expert_15_62_GPU1 -> Expert_Agg_15;
    
    Expert_Route_Comm_15 -> Expert_15_63_GPU0;
    Expert_Route_Comm_15 -> Expert_15_63_GPU1;
    Expert_15_63_GPU0 -> Expert_Agg_15;
    Expert_15_63_GPU1 -> Expert_Agg_15;
    
    Expert_Agg_15 -> FFN_GPU0_15;
    Expert_Agg_15 -> FFN_GPU1_15;
    FFN_GPU0_15 -> FFN_Agg_15;
    FFN_GPU1_15 -> FFN_Agg_15;
    FFN_Agg_15 -> LayerNorm_15;
    
    // Final output connections
    LayerNorm_15 -> Output_Processing;
    Output_Processing -> Output;
    
}