<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1642pt" height="2326pt"
 viewBox="0.00 0.00 394.00 558.25" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(4.17 4.17) rotate(0) translate(4 554.25)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-554.25 390,-554.25 390,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-76.08 8,-422.17 378,-422.17 378,-76.08 8,-76.08"/>
<text text-anchor="middle" x="193" y="-406.97" font-family="Times,serif" font-size="14.00">Transformer Layer (Ã—16)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="193" cy="-526.21" rx="59.29" ry="24.08"/>
<text text-anchor="middle" x="193" y="-529.61" font-family="Arial" font-size="12.00">Input Tokens</text>
<text text-anchor="middle" x="193" y="-516.61" font-family="Arial" font-size="12.00">[128, 10000]</text>
</g>
<!-- embedding -->
<g id="node2" class="node">
<title>embedding</title>
<polygon fill="none" stroke="black" points="251,-466.17 135,-466.17 135,-430.17 251,-430.17 251,-466.17"/>
<text text-anchor="middle" x="193" y="-451.57" font-family="Arial" font-size="12.00">Token Embedding</text>
<text text-anchor="middle" x="193" y="-438.57" font-family="Arial" font-size="12.00">[128, 10000, 4096]</text>
</g>
<!-- input&#45;&gt;embedding -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embedding</title>
<path fill="none" stroke="black" d="M193,-501.98C193,-493.87 193,-484.7 193,-476.3"/>
<polygon fill="black" stroke="black" points="196.5,-476.22 193,-466.22 189.5,-476.22 196.5,-476.22"/>
</g>
<!-- mha -->
<g id="node3" class="node">
<title>mha</title>
<polygon fill="none" stroke="black" points="255.5,-391.17 130.5,-391.17 130.5,-355.17 255.5,-355.17 255.5,-391.17"/>
<text text-anchor="middle" x="193" y="-376.57" font-family="Arial" font-size="12.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="193" y="-363.57" font-family="Arial" font-size="12.00">TP=2 on GPUs 0,1</text>
</g>
<!-- embedding&#45;&gt;mha -->
<g id="edge2" class="edge">
<title>embedding&#45;&gt;mha</title>
<path fill="none" stroke="black" d="M193,-429.87C193,-421.41 193,-411.04 193,-401.54"/>
<polygon fill="black" stroke="black" points="196.5,-401.34 193,-391.34 189.5,-401.34 196.5,-401.34"/>
</g>
<!-- gate -->
<g id="node5" class="node">
<title>gate</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="370.07,-319.17 88.39,-319.17 15.93,-251.17 297.61,-251.17 370.07,-319.17"/>
<text text-anchor="middle" x="193" y="-288.57" font-family="Arial" font-size="12.00">Expert Router</text>
<text text-anchor="middle" x="193" y="-275.57" font-family="Arial" font-size="12.00">Selects 1&#45;2 experts per token</text>
</g>
<!-- mha&#45;&gt;gate -->
<g id="edge3" class="edge">
<title>mha&#45;&gt;gate</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M193,-354.76C193,-347.35 193,-338.33 193,-329.31"/>
<polygon fill="red" stroke="red" points="196.5,-329.2 193,-319.2 189.5,-329.2 196.5,-329.2"/>
</g>
<!-- moe -->
<g id="node4" class="node">
<title>moe</title>
<polygon fill="none" stroke="black" points="266.5,-131.08 119.5,-131.08 119.5,-84.08 266.5,-84.08 266.5,-131.08"/>
<text text-anchor="middle" x="193" y="-117.48" font-family="Arial" font-size="12.00">Mixture of Experts</text>
<text text-anchor="middle" x="193" y="-104.48" font-family="Arial" font-size="12.00">EP=64, TP=2</text>
<text text-anchor="middle" x="193" y="-91.48" font-family="Arial" font-size="12.00">64 experts on 128 GPUs</text>
</g>
<!-- output -->
<g id="node7" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="193" cy="-24.04" rx="86.03" ry="24.08"/>
<text text-anchor="middle" x="193" y="-27.44" font-family="Arial" font-size="12.00">Output Logits</text>
<text text-anchor="middle" x="193" y="-14.44" font-family="Arial" font-size="12.00">[128, 10000, 51200]</text>
</g>
<!-- moe&#45;&gt;output -->
<g id="edge6" class="edge">
<title>moe&#45;&gt;output</title>
<path fill="none" stroke="black" d="M193,-83.87C193,-75.96 193,-66.92 193,-58.34"/>
<polygon fill="black" stroke="black" points="196.5,-58.2 193,-48.2 189.5,-58.2 196.5,-58.2"/>
</g>
<!-- comm -->
<g id="node6" class="node">
<title>comm</title>
<ellipse fill="none" stroke="black" cx="193" cy="-191.12" rx="105.22" ry="24.08"/>
<text text-anchor="middle" x="193" y="-194.52" font-family="Arial" font-size="12.00">All&#45;to&#45;All Communication</text>
<text text-anchor="middle" x="193" y="-181.52" font-family="Arial" font-size="12.00">Token redistribution</text>
</g>
<!-- gate&#45;&gt;comm -->
<g id="edge4" class="edge">
<title>gate&#45;&gt;comm</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M193,-250.94C193,-242.61 193,-233.68 193,-225.35"/>
<polygon fill="red" stroke="red" points="196.5,-225.22 193,-215.22 189.5,-225.22 196.5,-225.22"/>
</g>
<!-- comm&#45;&gt;moe -->
<g id="edge5" class="edge">
<title>comm&#45;&gt;moe</title>
<path fill="none" stroke="black" d="M193,-166.98C193,-159.01 193,-149.93 193,-141.35"/>
<polygon fill="black" stroke="black" points="196.5,-141.23 193,-131.23 189.5,-141.23 196.5,-141.23"/>
</g>
</g>
</svg>
