<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="3008pt" height="24000pt"
 viewBox="0.00 0.00 721.90 5760.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.96 0.96) rotate(0) translate(4 24970.06)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-24970.06 3126,-24970.06 3126,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_main</title>
<path fill="none" stroke="black" d="M20,-8C20,-8 3102,-8 3102,-8 3108,-8 3114,-14 3114,-20 3114,-20 3114,-24946.06 3114,-24946.06 3114,-24952.06 3108,-24958.06 3102,-24958.06 3102,-24958.06 20,-24958.06 20,-24958.06 14,-24958.06 8,-24952.06 8,-24946.06 8,-24946.06 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="1561" y="-24941.26" font-family="Arial Bold" font-size="16.00">LLM Model Deployment &#45; EP64_TP2 Configuration</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0</title>
<path fill="none" stroke="black" d="M28,-23239.61C28,-23239.61 3094,-23239.61 3094,-23239.61 3100,-23239.61 3106,-23245.61 3106,-23251.61 3106,-23251.61 3106,-24761.83 3106,-24761.83 3106,-24767.83 3100,-24773.83 3094,-24773.83 3094,-24773.83 28,-24773.83 28,-24773.83 22,-24773.83 16,-24767.83 16,-24761.83 16,-24761.83 16,-23251.61 16,-23251.61 16,-23245.61 22,-23239.61 28,-23239.61"/>
<text text-anchor="middle" x="1561" y="-24757.03" font-family="Arial Bold" font-size="16.00">Transformer Layer 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_mha_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2471,-24193.83 2471,-24687.83 2950,-24687.83 2950,-24193.83 2471,-24193.83"/>
<text text-anchor="middle" x="2710.5" y="-24671.03" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_moe_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-23319.61 24,-23811.61 3088,-23811.61 3088,-23319.61 24,-23319.61"/>
<text text-anchor="middle" x="1556" y="-23794.81" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_expert_0_0</title>
<path fill="none" stroke="black" d="M2824,-23443.61C2824,-23443.61 3068,-23443.61 3068,-23443.61 3074,-23443.61 3080,-23449.61 3080,-23455.61 3080,-23455.61 3080,-23743.61 3080,-23743.61 3080,-23749.61 3074,-23755.61 3068,-23755.61 3068,-23755.61 2824,-23755.61 2824,-23755.61 2818,-23755.61 2812,-23749.61 2812,-23743.61 2812,-23743.61 2812,-23455.61 2812,-23455.61 2812,-23449.61 2818,-23443.61 2824,-23443.61"/>
<text text-anchor="middle" x="2946" y="-23738.81" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_expert_0_1</title>
<path fill="none" stroke="black" d="M2268,-23647.61C2268,-23647.61 2792,-23647.61 2792,-23647.61 2798,-23647.61 2804,-23653.61 2804,-23659.61 2804,-23659.61 2804,-23765.61 2804,-23765.61 2804,-23771.61 2798,-23777.61 2792,-23777.61 2792,-23777.61 2268,-23777.61 2268,-23777.61 2262,-23777.61 2256,-23771.61 2256,-23765.61 2256,-23765.61 2256,-23659.61 2256,-23659.61 2256,-23653.61 2262,-23647.61 2268,-23647.61"/>
<text text-anchor="middle" x="2530" y="-23760.81" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_expert_0_2</title>
<path fill="none" stroke="black" d="M1712,-23647.61C1712,-23647.61 2236,-23647.61 2236,-23647.61 2242,-23647.61 2248,-23653.61 2248,-23659.61 2248,-23659.61 2248,-23765.61 2248,-23765.61 2248,-23771.61 2242,-23777.61 2236,-23777.61 2236,-23777.61 1712,-23777.61 1712,-23777.61 1706,-23777.61 1700,-23771.61 1700,-23765.61 1700,-23765.61 1700,-23659.61 1700,-23659.61 1700,-23653.61 1706,-23647.61 1712,-23647.61"/>
<text text-anchor="middle" x="1974" y="-23760.81" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_expert_0_61</title>
<path fill="none" stroke="black" d="M1156,-23647.61C1156,-23647.61 1680,-23647.61 1680,-23647.61 1686,-23647.61 1692,-23653.61 1692,-23659.61 1692,-23659.61 1692,-23765.61 1692,-23765.61 1692,-23771.61 1686,-23777.61 1680,-23777.61 1680,-23777.61 1156,-23777.61 1156,-23777.61 1150,-23777.61 1144,-23771.61 1144,-23765.61 1144,-23765.61 1144,-23659.61 1144,-23659.61 1144,-23653.61 1150,-23647.61 1156,-23647.61"/>
<text text-anchor="middle" x="1418" y="-23760.81" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_expert_0_62</title>
<path fill="none" stroke="black" d="M600,-23647.61C600,-23647.61 1124,-23647.61 1124,-23647.61 1130,-23647.61 1136,-23653.61 1136,-23659.61 1136,-23659.61 1136,-23765.61 1136,-23765.61 1136,-23771.61 1130,-23777.61 1124,-23777.61 1124,-23777.61 600,-23777.61 600,-23777.61 594,-23777.61 588,-23771.61 588,-23765.61 588,-23765.61 588,-23659.61 588,-23659.61 588,-23653.61 594,-23647.61 600,-23647.61"/>
<text text-anchor="middle" x="862" y="-23760.81" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_expert_0_63</title>
<path fill="none" stroke="black" d="M44,-23647.61C44,-23647.61 568,-23647.61 568,-23647.61 574,-23647.61 580,-23653.61 580,-23659.61 580,-23659.61 580,-23765.61 580,-23765.61 580,-23771.61 574,-23777.61 568,-23777.61 568,-23777.61 44,-23777.61 44,-23777.61 38,-23777.61 32,-23771.61 32,-23765.61 32,-23765.61 32,-23659.61 32,-23659.61 32,-23653.61 38,-23647.61 44,-23647.61"/>
<text text-anchor="middle" x="306" y="-23760.81" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_1</title>
<path fill="none" stroke="black" d="M28,-21697.38C28,-21697.38 3094,-21697.38 3094,-21697.38 3100,-21697.38 3106,-21703.38 3106,-21709.38 3106,-21709.38 3106,-23219.61 3106,-23219.61 3106,-23225.61 3100,-23231.61 3094,-23231.61 3094,-23231.61 28,-23231.61 28,-23231.61 22,-23231.61 16,-23225.61 16,-23219.61 16,-23219.61 16,-21709.38 16,-21709.38 16,-21703.38 22,-21697.38 28,-21697.38"/>
<text text-anchor="middle" x="1561" y="-23214.81" font-family="Arial Bold" font-size="16.00">Transformer Layer 1</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_mha_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2573,-22651.61 2573,-23145.61 3052,-23145.61 3052,-22651.61 2573,-22651.61"/>
<text text-anchor="middle" x="2812.5" y="-23128.81" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_moe_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-21777.38 24,-22269.38 3088,-22269.38 3088,-21777.38 24,-21777.38"/>
<text text-anchor="middle" x="1556" y="-22252.58" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_expert_1_0</title>
<path fill="none" stroke="black" d="M2824,-21901.38C2824,-21901.38 3068,-21901.38 3068,-21901.38 3074,-21901.38 3080,-21907.38 3080,-21913.38 3080,-21913.38 3080,-22201.38 3080,-22201.38 3080,-22207.38 3074,-22213.38 3068,-22213.38 3068,-22213.38 2824,-22213.38 2824,-22213.38 2818,-22213.38 2812,-22207.38 2812,-22201.38 2812,-22201.38 2812,-21913.38 2812,-21913.38 2812,-21907.38 2818,-21901.38 2824,-21901.38"/>
<text text-anchor="middle" x="2946" y="-22196.58" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_expert_1_1</title>
<path fill="none" stroke="black" d="M2268,-22105.38C2268,-22105.38 2792,-22105.38 2792,-22105.38 2798,-22105.38 2804,-22111.38 2804,-22117.38 2804,-22117.38 2804,-22223.38 2804,-22223.38 2804,-22229.38 2798,-22235.38 2792,-22235.38 2792,-22235.38 2268,-22235.38 2268,-22235.38 2262,-22235.38 2256,-22229.38 2256,-22223.38 2256,-22223.38 2256,-22117.38 2256,-22117.38 2256,-22111.38 2262,-22105.38 2268,-22105.38"/>
<text text-anchor="middle" x="2530" y="-22218.58" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_expert_1_2</title>
<path fill="none" stroke="black" d="M1712,-22105.38C1712,-22105.38 2236,-22105.38 2236,-22105.38 2242,-22105.38 2248,-22111.38 2248,-22117.38 2248,-22117.38 2248,-22223.38 2248,-22223.38 2248,-22229.38 2242,-22235.38 2236,-22235.38 2236,-22235.38 1712,-22235.38 1712,-22235.38 1706,-22235.38 1700,-22229.38 1700,-22223.38 1700,-22223.38 1700,-22117.38 1700,-22117.38 1700,-22111.38 1706,-22105.38 1712,-22105.38"/>
<text text-anchor="middle" x="1974" y="-22218.58" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_expert_1_61</title>
<path fill="none" stroke="black" d="M1156,-22105.38C1156,-22105.38 1680,-22105.38 1680,-22105.38 1686,-22105.38 1692,-22111.38 1692,-22117.38 1692,-22117.38 1692,-22223.38 1692,-22223.38 1692,-22229.38 1686,-22235.38 1680,-22235.38 1680,-22235.38 1156,-22235.38 1156,-22235.38 1150,-22235.38 1144,-22229.38 1144,-22223.38 1144,-22223.38 1144,-22117.38 1144,-22117.38 1144,-22111.38 1150,-22105.38 1156,-22105.38"/>
<text text-anchor="middle" x="1418" y="-22218.58" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_expert_1_62</title>
<path fill="none" stroke="black" d="M600,-22105.38C600,-22105.38 1124,-22105.38 1124,-22105.38 1130,-22105.38 1136,-22111.38 1136,-22117.38 1136,-22117.38 1136,-22223.38 1136,-22223.38 1136,-22229.38 1130,-22235.38 1124,-22235.38 1124,-22235.38 600,-22235.38 600,-22235.38 594,-22235.38 588,-22229.38 588,-22223.38 588,-22223.38 588,-22117.38 588,-22117.38 588,-22111.38 594,-22105.38 600,-22105.38"/>
<text text-anchor="middle" x="862" y="-22218.58" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_expert_1_63</title>
<path fill="none" stroke="black" d="M44,-22105.38C44,-22105.38 568,-22105.38 568,-22105.38 574,-22105.38 580,-22111.38 580,-22117.38 580,-22117.38 580,-22223.38 580,-22223.38 580,-22229.38 574,-22235.38 568,-22235.38 568,-22235.38 44,-22235.38 44,-22235.38 38,-22235.38 32,-22229.38 32,-22223.38 32,-22223.38 32,-22117.38 32,-22117.38 32,-22111.38 38,-22105.38 44,-22105.38"/>
<text text-anchor="middle" x="306" y="-22218.58" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_layer_2</title>
<path fill="none" stroke="black" d="M28,-20155.16C28,-20155.16 3094,-20155.16 3094,-20155.16 3100,-20155.16 3106,-20161.16 3106,-20167.16 3106,-20167.16 3106,-21677.38 3106,-21677.38 3106,-21683.38 3100,-21689.38 3094,-21689.38 3094,-21689.38 28,-21689.38 28,-21689.38 22,-21689.38 16,-21683.38 16,-21677.38 16,-21677.38 16,-20167.16 16,-20167.16 16,-20161.16 22,-20155.16 28,-20155.16"/>
<text text-anchor="middle" x="1561" y="-21672.58" font-family="Arial Bold" font-size="16.00">Transformer Layer 2</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_mha_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2534,-21109.38 2534,-21603.38 3013,-21603.38 3013,-21109.38 2534,-21109.38"/>
<text text-anchor="middle" x="2773.5" y="-21586.58" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_moe_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-20235.16 24,-20727.16 3088,-20727.16 3088,-20235.16 24,-20235.16"/>
<text text-anchor="middle" x="1556" y="-20710.36" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_expert_2_0</title>
<path fill="none" stroke="black" d="M2824,-20359.16C2824,-20359.16 3068,-20359.16 3068,-20359.16 3074,-20359.16 3080,-20365.16 3080,-20371.16 3080,-20371.16 3080,-20659.16 3080,-20659.16 3080,-20665.16 3074,-20671.16 3068,-20671.16 3068,-20671.16 2824,-20671.16 2824,-20671.16 2818,-20671.16 2812,-20665.16 2812,-20659.16 2812,-20659.16 2812,-20371.16 2812,-20371.16 2812,-20365.16 2818,-20359.16 2824,-20359.16"/>
<text text-anchor="middle" x="2946" y="-20654.36" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_expert_2_1</title>
<path fill="none" stroke="black" d="M2268,-20563.16C2268,-20563.16 2792,-20563.16 2792,-20563.16 2798,-20563.16 2804,-20569.16 2804,-20575.16 2804,-20575.16 2804,-20681.16 2804,-20681.16 2804,-20687.16 2798,-20693.16 2792,-20693.16 2792,-20693.16 2268,-20693.16 2268,-20693.16 2262,-20693.16 2256,-20687.16 2256,-20681.16 2256,-20681.16 2256,-20575.16 2256,-20575.16 2256,-20569.16 2262,-20563.16 2268,-20563.16"/>
<text text-anchor="middle" x="2530" y="-20676.36" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_expert_2_2</title>
<path fill="none" stroke="black" d="M1712,-20563.16C1712,-20563.16 2236,-20563.16 2236,-20563.16 2242,-20563.16 2248,-20569.16 2248,-20575.16 2248,-20575.16 2248,-20681.16 2248,-20681.16 2248,-20687.16 2242,-20693.16 2236,-20693.16 2236,-20693.16 1712,-20693.16 1712,-20693.16 1706,-20693.16 1700,-20687.16 1700,-20681.16 1700,-20681.16 1700,-20575.16 1700,-20575.16 1700,-20569.16 1706,-20563.16 1712,-20563.16"/>
<text text-anchor="middle" x="1974" y="-20676.36" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_expert_2_61</title>
<path fill="none" stroke="black" d="M1156,-20563.16C1156,-20563.16 1680,-20563.16 1680,-20563.16 1686,-20563.16 1692,-20569.16 1692,-20575.16 1692,-20575.16 1692,-20681.16 1692,-20681.16 1692,-20687.16 1686,-20693.16 1680,-20693.16 1680,-20693.16 1156,-20693.16 1156,-20693.16 1150,-20693.16 1144,-20687.16 1144,-20681.16 1144,-20681.16 1144,-20575.16 1144,-20575.16 1144,-20569.16 1150,-20563.16 1156,-20563.16"/>
<text text-anchor="middle" x="1418" y="-20676.36" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_expert_2_62</title>
<path fill="none" stroke="black" d="M600,-20563.16C600,-20563.16 1124,-20563.16 1124,-20563.16 1130,-20563.16 1136,-20569.16 1136,-20575.16 1136,-20575.16 1136,-20681.16 1136,-20681.16 1136,-20687.16 1130,-20693.16 1124,-20693.16 1124,-20693.16 600,-20693.16 600,-20693.16 594,-20693.16 588,-20687.16 588,-20681.16 588,-20681.16 588,-20575.16 588,-20575.16 588,-20569.16 594,-20563.16 600,-20563.16"/>
<text text-anchor="middle" x="862" y="-20676.36" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_expert_2_63</title>
<path fill="none" stroke="black" d="M44,-20563.16C44,-20563.16 568,-20563.16 568,-20563.16 574,-20563.16 580,-20569.16 580,-20575.16 580,-20575.16 580,-20681.16 580,-20681.16 580,-20687.16 574,-20693.16 568,-20693.16 568,-20693.16 44,-20693.16 44,-20693.16 38,-20693.16 32,-20687.16 32,-20681.16 32,-20681.16 32,-20575.16 32,-20575.16 32,-20569.16 38,-20563.16 44,-20563.16"/>
<text text-anchor="middle" x="306" y="-20676.36" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_layer_3</title>
<path fill="none" stroke="black" d="M28,-18612.93C28,-18612.93 3094,-18612.93 3094,-18612.93 3100,-18612.93 3106,-18618.93 3106,-18624.93 3106,-18624.93 3106,-20135.16 3106,-20135.16 3106,-20141.16 3100,-20147.16 3094,-20147.16 3094,-20147.16 28,-20147.16 28,-20147.16 22,-20147.16 16,-20141.16 16,-20135.16 16,-20135.16 16,-18624.93 16,-18624.93 16,-18618.93 22,-18612.93 28,-18612.93"/>
<text text-anchor="middle" x="1561" y="-20130.36" font-family="Arial Bold" font-size="16.00">Transformer Layer 3</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_mha_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2573,-19567.16 2573,-20061.16 3052,-20061.16 3052,-19567.16 2573,-19567.16"/>
<text text-anchor="middle" x="2812.5" y="-20044.36" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_moe_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-18692.93 24,-19184.93 3088,-19184.93 3088,-18692.93 24,-18692.93"/>
<text text-anchor="middle" x="1556" y="-19168.13" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_expert_3_0</title>
<path fill="none" stroke="black" d="M2824,-18816.93C2824,-18816.93 3068,-18816.93 3068,-18816.93 3074,-18816.93 3080,-18822.93 3080,-18828.93 3080,-18828.93 3080,-19116.93 3080,-19116.93 3080,-19122.93 3074,-19128.93 3068,-19128.93 3068,-19128.93 2824,-19128.93 2824,-19128.93 2818,-19128.93 2812,-19122.93 2812,-19116.93 2812,-19116.93 2812,-18828.93 2812,-18828.93 2812,-18822.93 2818,-18816.93 2824,-18816.93"/>
<text text-anchor="middle" x="2946" y="-19112.13" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_expert_3_1</title>
<path fill="none" stroke="black" d="M2268,-19020.93C2268,-19020.93 2792,-19020.93 2792,-19020.93 2798,-19020.93 2804,-19026.93 2804,-19032.93 2804,-19032.93 2804,-19138.93 2804,-19138.93 2804,-19144.93 2798,-19150.93 2792,-19150.93 2792,-19150.93 2268,-19150.93 2268,-19150.93 2262,-19150.93 2256,-19144.93 2256,-19138.93 2256,-19138.93 2256,-19032.93 2256,-19032.93 2256,-19026.93 2262,-19020.93 2268,-19020.93"/>
<text text-anchor="middle" x="2530" y="-19134.13" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_expert_3_2</title>
<path fill="none" stroke="black" d="M1712,-19020.93C1712,-19020.93 2236,-19020.93 2236,-19020.93 2242,-19020.93 2248,-19026.93 2248,-19032.93 2248,-19032.93 2248,-19138.93 2248,-19138.93 2248,-19144.93 2242,-19150.93 2236,-19150.93 2236,-19150.93 1712,-19150.93 1712,-19150.93 1706,-19150.93 1700,-19144.93 1700,-19138.93 1700,-19138.93 1700,-19032.93 1700,-19032.93 1700,-19026.93 1706,-19020.93 1712,-19020.93"/>
<text text-anchor="middle" x="1974" y="-19134.13" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust35" class="cluster">
<title>cluster_expert_3_61</title>
<path fill="none" stroke="black" d="M1156,-19020.93C1156,-19020.93 1680,-19020.93 1680,-19020.93 1686,-19020.93 1692,-19026.93 1692,-19032.93 1692,-19032.93 1692,-19138.93 1692,-19138.93 1692,-19144.93 1686,-19150.93 1680,-19150.93 1680,-19150.93 1156,-19150.93 1156,-19150.93 1150,-19150.93 1144,-19144.93 1144,-19138.93 1144,-19138.93 1144,-19032.93 1144,-19032.93 1144,-19026.93 1150,-19020.93 1156,-19020.93"/>
<text text-anchor="middle" x="1418" y="-19134.13" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_expert_3_62</title>
<path fill="none" stroke="black" d="M600,-19020.93C600,-19020.93 1124,-19020.93 1124,-19020.93 1130,-19020.93 1136,-19026.93 1136,-19032.93 1136,-19032.93 1136,-19138.93 1136,-19138.93 1136,-19144.93 1130,-19150.93 1124,-19150.93 1124,-19150.93 600,-19150.93 600,-19150.93 594,-19150.93 588,-19144.93 588,-19138.93 588,-19138.93 588,-19032.93 588,-19032.93 588,-19026.93 594,-19020.93 600,-19020.93"/>
<text text-anchor="middle" x="862" y="-19134.13" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust37" class="cluster">
<title>cluster_expert_3_63</title>
<path fill="none" stroke="black" d="M44,-19020.93C44,-19020.93 568,-19020.93 568,-19020.93 574,-19020.93 580,-19026.93 580,-19032.93 580,-19032.93 580,-19138.93 580,-19138.93 580,-19144.93 574,-19150.93 568,-19150.93 568,-19150.93 44,-19150.93 44,-19150.93 38,-19150.93 32,-19144.93 32,-19138.93 32,-19138.93 32,-19032.93 32,-19032.93 32,-19026.93 38,-19020.93 44,-19020.93"/>
<text text-anchor="middle" x="306" y="-19134.13" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust38" class="cluster">
<title>cluster_layer_4</title>
<path fill="none" stroke="black" d="M28,-17070.7C28,-17070.7 3094,-17070.7 3094,-17070.7 3100,-17070.7 3106,-17076.7 3106,-17082.7 3106,-17082.7 3106,-18592.93 3106,-18592.93 3106,-18598.93 3100,-18604.93 3094,-18604.93 3094,-18604.93 28,-18604.93 28,-18604.93 22,-18604.93 16,-18598.93 16,-18592.93 16,-18592.93 16,-17082.7 16,-17082.7 16,-17076.7 22,-17070.7 28,-17070.7"/>
<text text-anchor="middle" x="1561" y="-18588.13" font-family="Arial Bold" font-size="16.00">Transformer Layer 4</text>
</g>
<g id="clust39" class="cluster">
<title>cluster_mha_4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2495,-18024.93 2495,-18518.93 2974,-18518.93 2974,-18024.93 2495,-18024.93"/>
<text text-anchor="middle" x="2734.5" y="-18502.13" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust40" class="cluster">
<title>cluster_moe_4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-17150.7 24,-17642.7 3088,-17642.7 3088,-17150.7 24,-17150.7"/>
<text text-anchor="middle" x="1556" y="-17625.9" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_expert_4_0</title>
<path fill="none" stroke="black" d="M2824,-17274.7C2824,-17274.7 3068,-17274.7 3068,-17274.7 3074,-17274.7 3080,-17280.7 3080,-17286.7 3080,-17286.7 3080,-17574.7 3080,-17574.7 3080,-17580.7 3074,-17586.7 3068,-17586.7 3068,-17586.7 2824,-17586.7 2824,-17586.7 2818,-17586.7 2812,-17580.7 2812,-17574.7 2812,-17574.7 2812,-17286.7 2812,-17286.7 2812,-17280.7 2818,-17274.7 2824,-17274.7"/>
<text text-anchor="middle" x="2946" y="-17569.9" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust42" class="cluster">
<title>cluster_expert_4_1</title>
<path fill="none" stroke="black" d="M2268,-17478.7C2268,-17478.7 2792,-17478.7 2792,-17478.7 2798,-17478.7 2804,-17484.7 2804,-17490.7 2804,-17490.7 2804,-17596.7 2804,-17596.7 2804,-17602.7 2798,-17608.7 2792,-17608.7 2792,-17608.7 2268,-17608.7 2268,-17608.7 2262,-17608.7 2256,-17602.7 2256,-17596.7 2256,-17596.7 2256,-17490.7 2256,-17490.7 2256,-17484.7 2262,-17478.7 2268,-17478.7"/>
<text text-anchor="middle" x="2530" y="-17591.9" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust43" class="cluster">
<title>cluster_expert_4_2</title>
<path fill="none" stroke="black" d="M1712,-17478.7C1712,-17478.7 2236,-17478.7 2236,-17478.7 2242,-17478.7 2248,-17484.7 2248,-17490.7 2248,-17490.7 2248,-17596.7 2248,-17596.7 2248,-17602.7 2242,-17608.7 2236,-17608.7 2236,-17608.7 1712,-17608.7 1712,-17608.7 1706,-17608.7 1700,-17602.7 1700,-17596.7 1700,-17596.7 1700,-17490.7 1700,-17490.7 1700,-17484.7 1706,-17478.7 1712,-17478.7"/>
<text text-anchor="middle" x="1974" y="-17591.9" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust44" class="cluster">
<title>cluster_expert_4_61</title>
<path fill="none" stroke="black" d="M1156,-17478.7C1156,-17478.7 1680,-17478.7 1680,-17478.7 1686,-17478.7 1692,-17484.7 1692,-17490.7 1692,-17490.7 1692,-17596.7 1692,-17596.7 1692,-17602.7 1686,-17608.7 1680,-17608.7 1680,-17608.7 1156,-17608.7 1156,-17608.7 1150,-17608.7 1144,-17602.7 1144,-17596.7 1144,-17596.7 1144,-17490.7 1144,-17490.7 1144,-17484.7 1150,-17478.7 1156,-17478.7"/>
<text text-anchor="middle" x="1418" y="-17591.9" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust45" class="cluster">
<title>cluster_expert_4_62</title>
<path fill="none" stroke="black" d="M600,-17478.7C600,-17478.7 1124,-17478.7 1124,-17478.7 1130,-17478.7 1136,-17484.7 1136,-17490.7 1136,-17490.7 1136,-17596.7 1136,-17596.7 1136,-17602.7 1130,-17608.7 1124,-17608.7 1124,-17608.7 600,-17608.7 600,-17608.7 594,-17608.7 588,-17602.7 588,-17596.7 588,-17596.7 588,-17490.7 588,-17490.7 588,-17484.7 594,-17478.7 600,-17478.7"/>
<text text-anchor="middle" x="862" y="-17591.9" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_expert_4_63</title>
<path fill="none" stroke="black" d="M44,-17478.7C44,-17478.7 568,-17478.7 568,-17478.7 574,-17478.7 580,-17484.7 580,-17490.7 580,-17490.7 580,-17596.7 580,-17596.7 580,-17602.7 574,-17608.7 568,-17608.7 568,-17608.7 44,-17608.7 44,-17608.7 38,-17608.7 32,-17602.7 32,-17596.7 32,-17596.7 32,-17490.7 32,-17490.7 32,-17484.7 38,-17478.7 44,-17478.7"/>
<text text-anchor="middle" x="306" y="-17591.9" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust47" class="cluster">
<title>cluster_layer_5</title>
<path fill="none" stroke="black" d="M28,-15528.48C28,-15528.48 3094,-15528.48 3094,-15528.48 3100,-15528.48 3106,-15534.48 3106,-15540.48 3106,-15540.48 3106,-17050.7 3106,-17050.7 3106,-17056.7 3100,-17062.7 3094,-17062.7 3094,-17062.7 28,-17062.7 28,-17062.7 22,-17062.7 16,-17056.7 16,-17050.7 16,-17050.7 16,-15540.48 16,-15540.48 16,-15534.48 22,-15528.48 28,-15528.48"/>
<text text-anchor="middle" x="1561" y="-17045.9" font-family="Arial Bold" font-size="16.00">Transformer Layer 5</text>
</g>
<g id="clust48" class="cluster">
<title>cluster_mha_5</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2495,-16482.7 2495,-16976.7 2974,-16976.7 2974,-16482.7 2495,-16482.7"/>
<text text-anchor="middle" x="2734.5" y="-16959.9" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust49" class="cluster">
<title>cluster_moe_5</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-15608.48 24,-16100.48 3088,-16100.48 3088,-15608.48 24,-15608.48"/>
<text text-anchor="middle" x="1556" y="-16083.68" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust50" class="cluster">
<title>cluster_expert_5_0</title>
<path fill="none" stroke="black" d="M2824,-15732.48C2824,-15732.48 3068,-15732.48 3068,-15732.48 3074,-15732.48 3080,-15738.48 3080,-15744.48 3080,-15744.48 3080,-16032.48 3080,-16032.48 3080,-16038.48 3074,-16044.48 3068,-16044.48 3068,-16044.48 2824,-16044.48 2824,-16044.48 2818,-16044.48 2812,-16038.48 2812,-16032.48 2812,-16032.48 2812,-15744.48 2812,-15744.48 2812,-15738.48 2818,-15732.48 2824,-15732.48"/>
<text text-anchor="middle" x="2946" y="-16027.68" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_expert_5_1</title>
<path fill="none" stroke="black" d="M2268,-15936.48C2268,-15936.48 2792,-15936.48 2792,-15936.48 2798,-15936.48 2804,-15942.48 2804,-15948.48 2804,-15948.48 2804,-16054.48 2804,-16054.48 2804,-16060.48 2798,-16066.48 2792,-16066.48 2792,-16066.48 2268,-16066.48 2268,-16066.48 2262,-16066.48 2256,-16060.48 2256,-16054.48 2256,-16054.48 2256,-15948.48 2256,-15948.48 2256,-15942.48 2262,-15936.48 2268,-15936.48"/>
<text text-anchor="middle" x="2530" y="-16049.68" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust52" class="cluster">
<title>cluster_expert_5_2</title>
<path fill="none" stroke="black" d="M1712,-15936.48C1712,-15936.48 2236,-15936.48 2236,-15936.48 2242,-15936.48 2248,-15942.48 2248,-15948.48 2248,-15948.48 2248,-16054.48 2248,-16054.48 2248,-16060.48 2242,-16066.48 2236,-16066.48 2236,-16066.48 1712,-16066.48 1712,-16066.48 1706,-16066.48 1700,-16060.48 1700,-16054.48 1700,-16054.48 1700,-15948.48 1700,-15948.48 1700,-15942.48 1706,-15936.48 1712,-15936.48"/>
<text text-anchor="middle" x="1974" y="-16049.68" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust53" class="cluster">
<title>cluster_expert_5_61</title>
<path fill="none" stroke="black" d="M1156,-15936.48C1156,-15936.48 1680,-15936.48 1680,-15936.48 1686,-15936.48 1692,-15942.48 1692,-15948.48 1692,-15948.48 1692,-16054.48 1692,-16054.48 1692,-16060.48 1686,-16066.48 1680,-16066.48 1680,-16066.48 1156,-16066.48 1156,-16066.48 1150,-16066.48 1144,-16060.48 1144,-16054.48 1144,-16054.48 1144,-15948.48 1144,-15948.48 1144,-15942.48 1150,-15936.48 1156,-15936.48"/>
<text text-anchor="middle" x="1418" y="-16049.68" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust54" class="cluster">
<title>cluster_expert_5_62</title>
<path fill="none" stroke="black" d="M600,-15936.48C600,-15936.48 1124,-15936.48 1124,-15936.48 1130,-15936.48 1136,-15942.48 1136,-15948.48 1136,-15948.48 1136,-16054.48 1136,-16054.48 1136,-16060.48 1130,-16066.48 1124,-16066.48 1124,-16066.48 600,-16066.48 600,-16066.48 594,-16066.48 588,-16060.48 588,-16054.48 588,-16054.48 588,-15948.48 588,-15948.48 588,-15942.48 594,-15936.48 600,-15936.48"/>
<text text-anchor="middle" x="862" y="-16049.68" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust55" class="cluster">
<title>cluster_expert_5_63</title>
<path fill="none" stroke="black" d="M44,-15936.48C44,-15936.48 568,-15936.48 568,-15936.48 574,-15936.48 580,-15942.48 580,-15948.48 580,-15948.48 580,-16054.48 580,-16054.48 580,-16060.48 574,-16066.48 568,-16066.48 568,-16066.48 44,-16066.48 44,-16066.48 38,-16066.48 32,-16060.48 32,-16054.48 32,-16054.48 32,-15948.48 32,-15948.48 32,-15942.48 38,-15936.48 44,-15936.48"/>
<text text-anchor="middle" x="306" y="-16049.68" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_layer_6</title>
<path fill="none" stroke="black" d="M28,-13986.25C28,-13986.25 3094,-13986.25 3094,-13986.25 3100,-13986.25 3106,-13992.25 3106,-13998.25 3106,-13998.25 3106,-15508.48 3106,-15508.48 3106,-15514.48 3100,-15520.48 3094,-15520.48 3094,-15520.48 28,-15520.48 28,-15520.48 22,-15520.48 16,-15514.48 16,-15508.48 16,-15508.48 16,-13998.25 16,-13998.25 16,-13992.25 22,-13986.25 28,-13986.25"/>
<text text-anchor="middle" x="1561" y="-15503.68" font-family="Arial Bold" font-size="16.00">Transformer Layer 6</text>
</g>
<g id="clust57" class="cluster">
<title>cluster_mha_6</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2573,-14940.48 2573,-15434.48 3052,-15434.48 3052,-14940.48 2573,-14940.48"/>
<text text-anchor="middle" x="2812.5" y="-15417.68" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust58" class="cluster">
<title>cluster_moe_6</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-14066.25 24,-14558.25 3088,-14558.25 3088,-14066.25 24,-14066.25"/>
<text text-anchor="middle" x="1556" y="-14541.45" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust59" class="cluster">
<title>cluster_expert_6_0</title>
<path fill="none" stroke="black" d="M2824,-14190.25C2824,-14190.25 3068,-14190.25 3068,-14190.25 3074,-14190.25 3080,-14196.25 3080,-14202.25 3080,-14202.25 3080,-14490.25 3080,-14490.25 3080,-14496.25 3074,-14502.25 3068,-14502.25 3068,-14502.25 2824,-14502.25 2824,-14502.25 2818,-14502.25 2812,-14496.25 2812,-14490.25 2812,-14490.25 2812,-14202.25 2812,-14202.25 2812,-14196.25 2818,-14190.25 2824,-14190.25"/>
<text text-anchor="middle" x="2946" y="-14485.45" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust60" class="cluster">
<title>cluster_expert_6_1</title>
<path fill="none" stroke="black" d="M2268,-14394.25C2268,-14394.25 2792,-14394.25 2792,-14394.25 2798,-14394.25 2804,-14400.25 2804,-14406.25 2804,-14406.25 2804,-14512.25 2804,-14512.25 2804,-14518.25 2798,-14524.25 2792,-14524.25 2792,-14524.25 2268,-14524.25 2268,-14524.25 2262,-14524.25 2256,-14518.25 2256,-14512.25 2256,-14512.25 2256,-14406.25 2256,-14406.25 2256,-14400.25 2262,-14394.25 2268,-14394.25"/>
<text text-anchor="middle" x="2530" y="-14507.45" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_expert_6_2</title>
<path fill="none" stroke="black" d="M1712,-14394.25C1712,-14394.25 2236,-14394.25 2236,-14394.25 2242,-14394.25 2248,-14400.25 2248,-14406.25 2248,-14406.25 2248,-14512.25 2248,-14512.25 2248,-14518.25 2242,-14524.25 2236,-14524.25 2236,-14524.25 1712,-14524.25 1712,-14524.25 1706,-14524.25 1700,-14518.25 1700,-14512.25 1700,-14512.25 1700,-14406.25 1700,-14406.25 1700,-14400.25 1706,-14394.25 1712,-14394.25"/>
<text text-anchor="middle" x="1974" y="-14507.45" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust62" class="cluster">
<title>cluster_expert_6_61</title>
<path fill="none" stroke="black" d="M1156,-14394.25C1156,-14394.25 1680,-14394.25 1680,-14394.25 1686,-14394.25 1692,-14400.25 1692,-14406.25 1692,-14406.25 1692,-14512.25 1692,-14512.25 1692,-14518.25 1686,-14524.25 1680,-14524.25 1680,-14524.25 1156,-14524.25 1156,-14524.25 1150,-14524.25 1144,-14518.25 1144,-14512.25 1144,-14512.25 1144,-14406.25 1144,-14406.25 1144,-14400.25 1150,-14394.25 1156,-14394.25"/>
<text text-anchor="middle" x="1418" y="-14507.45" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust63" class="cluster">
<title>cluster_expert_6_62</title>
<path fill="none" stroke="black" d="M600,-14394.25C600,-14394.25 1124,-14394.25 1124,-14394.25 1130,-14394.25 1136,-14400.25 1136,-14406.25 1136,-14406.25 1136,-14512.25 1136,-14512.25 1136,-14518.25 1130,-14524.25 1124,-14524.25 1124,-14524.25 600,-14524.25 600,-14524.25 594,-14524.25 588,-14518.25 588,-14512.25 588,-14512.25 588,-14406.25 588,-14406.25 588,-14400.25 594,-14394.25 600,-14394.25"/>
<text text-anchor="middle" x="862" y="-14507.45" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust64" class="cluster">
<title>cluster_expert_6_63</title>
<path fill="none" stroke="black" d="M44,-14394.25C44,-14394.25 568,-14394.25 568,-14394.25 574,-14394.25 580,-14400.25 580,-14406.25 580,-14406.25 580,-14512.25 580,-14512.25 580,-14518.25 574,-14524.25 568,-14524.25 568,-14524.25 44,-14524.25 44,-14524.25 38,-14524.25 32,-14518.25 32,-14512.25 32,-14512.25 32,-14406.25 32,-14406.25 32,-14400.25 38,-14394.25 44,-14394.25"/>
<text text-anchor="middle" x="306" y="-14507.45" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust65" class="cluster">
<title>cluster_layer_7</title>
<path fill="none" stroke="black" d="M28,-12444.03C28,-12444.03 3094,-12444.03 3094,-12444.03 3100,-12444.03 3106,-12450.03 3106,-12456.03 3106,-12456.03 3106,-13966.25 3106,-13966.25 3106,-13972.25 3100,-13978.25 3094,-13978.25 3094,-13978.25 28,-13978.25 28,-13978.25 22,-13978.25 16,-13972.25 16,-13966.25 16,-13966.25 16,-12456.03 16,-12456.03 16,-12450.03 22,-12444.03 28,-12444.03"/>
<text text-anchor="middle" x="1561" y="-13961.45" font-family="Arial Bold" font-size="16.00">Transformer Layer 7</text>
</g>
<g id="clust66" class="cluster">
<title>cluster_mha_7</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2495,-13398.25 2495,-13892.25 2974,-13892.25 2974,-13398.25 2495,-13398.25"/>
<text text-anchor="middle" x="2734.5" y="-13875.45" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust67" class="cluster">
<title>cluster_moe_7</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-12524.03 24,-13016.03 3088,-13016.03 3088,-12524.03 24,-12524.03"/>
<text text-anchor="middle" x="1556" y="-12999.23" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust68" class="cluster">
<title>cluster_expert_7_0</title>
<path fill="none" stroke="black" d="M2824,-12648.03C2824,-12648.03 3068,-12648.03 3068,-12648.03 3074,-12648.03 3080,-12654.03 3080,-12660.03 3080,-12660.03 3080,-12948.03 3080,-12948.03 3080,-12954.03 3074,-12960.03 3068,-12960.03 3068,-12960.03 2824,-12960.03 2824,-12960.03 2818,-12960.03 2812,-12954.03 2812,-12948.03 2812,-12948.03 2812,-12660.03 2812,-12660.03 2812,-12654.03 2818,-12648.03 2824,-12648.03"/>
<text text-anchor="middle" x="2946" y="-12943.23" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust69" class="cluster">
<title>cluster_expert_7_1</title>
<path fill="none" stroke="black" d="M2268,-12852.03C2268,-12852.03 2792,-12852.03 2792,-12852.03 2798,-12852.03 2804,-12858.03 2804,-12864.03 2804,-12864.03 2804,-12970.03 2804,-12970.03 2804,-12976.03 2798,-12982.03 2792,-12982.03 2792,-12982.03 2268,-12982.03 2268,-12982.03 2262,-12982.03 2256,-12976.03 2256,-12970.03 2256,-12970.03 2256,-12864.03 2256,-12864.03 2256,-12858.03 2262,-12852.03 2268,-12852.03"/>
<text text-anchor="middle" x="2530" y="-12965.23" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust70" class="cluster">
<title>cluster_expert_7_2</title>
<path fill="none" stroke="black" d="M1712,-12852.03C1712,-12852.03 2236,-12852.03 2236,-12852.03 2242,-12852.03 2248,-12858.03 2248,-12864.03 2248,-12864.03 2248,-12970.03 2248,-12970.03 2248,-12976.03 2242,-12982.03 2236,-12982.03 2236,-12982.03 1712,-12982.03 1712,-12982.03 1706,-12982.03 1700,-12976.03 1700,-12970.03 1700,-12970.03 1700,-12864.03 1700,-12864.03 1700,-12858.03 1706,-12852.03 1712,-12852.03"/>
<text text-anchor="middle" x="1974" y="-12965.23" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust71" class="cluster">
<title>cluster_expert_7_61</title>
<path fill="none" stroke="black" d="M1156,-12852.03C1156,-12852.03 1680,-12852.03 1680,-12852.03 1686,-12852.03 1692,-12858.03 1692,-12864.03 1692,-12864.03 1692,-12970.03 1692,-12970.03 1692,-12976.03 1686,-12982.03 1680,-12982.03 1680,-12982.03 1156,-12982.03 1156,-12982.03 1150,-12982.03 1144,-12976.03 1144,-12970.03 1144,-12970.03 1144,-12864.03 1144,-12864.03 1144,-12858.03 1150,-12852.03 1156,-12852.03"/>
<text text-anchor="middle" x="1418" y="-12965.23" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust72" class="cluster">
<title>cluster_expert_7_62</title>
<path fill="none" stroke="black" d="M600,-12852.03C600,-12852.03 1124,-12852.03 1124,-12852.03 1130,-12852.03 1136,-12858.03 1136,-12864.03 1136,-12864.03 1136,-12970.03 1136,-12970.03 1136,-12976.03 1130,-12982.03 1124,-12982.03 1124,-12982.03 600,-12982.03 600,-12982.03 594,-12982.03 588,-12976.03 588,-12970.03 588,-12970.03 588,-12864.03 588,-12864.03 588,-12858.03 594,-12852.03 600,-12852.03"/>
<text text-anchor="middle" x="862" y="-12965.23" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust73" class="cluster">
<title>cluster_expert_7_63</title>
<path fill="none" stroke="black" d="M44,-12852.03C44,-12852.03 568,-12852.03 568,-12852.03 574,-12852.03 580,-12858.03 580,-12864.03 580,-12864.03 580,-12970.03 580,-12970.03 580,-12976.03 574,-12982.03 568,-12982.03 568,-12982.03 44,-12982.03 44,-12982.03 38,-12982.03 32,-12976.03 32,-12970.03 32,-12970.03 32,-12864.03 32,-12864.03 32,-12858.03 38,-12852.03 44,-12852.03"/>
<text text-anchor="middle" x="306" y="-12965.23" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust74" class="cluster">
<title>cluster_layer_8</title>
<path fill="none" stroke="black" d="M28,-10901.8C28,-10901.8 3094,-10901.8 3094,-10901.8 3100,-10901.8 3106,-10907.8 3106,-10913.8 3106,-10913.8 3106,-12424.03 3106,-12424.03 3106,-12430.03 3100,-12436.03 3094,-12436.03 3094,-12436.03 28,-12436.03 28,-12436.03 22,-12436.03 16,-12430.03 16,-12424.03 16,-12424.03 16,-10913.8 16,-10913.8 16,-10907.8 22,-10901.8 28,-10901.8"/>
<text text-anchor="middle" x="1561" y="-12419.23" font-family="Arial Bold" font-size="16.00">Transformer Layer 8</text>
</g>
<g id="clust75" class="cluster">
<title>cluster_mha_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2495,-11856.03 2495,-12350.03 2974,-12350.03 2974,-11856.03 2495,-11856.03"/>
<text text-anchor="middle" x="2734.5" y="-12333.23" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust76" class="cluster">
<title>cluster_moe_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-10981.8 24,-11473.8 3088,-11473.8 3088,-10981.8 24,-10981.8"/>
<text text-anchor="middle" x="1556" y="-11457" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust77" class="cluster">
<title>cluster_expert_8_0</title>
<path fill="none" stroke="black" d="M2824,-11105.8C2824,-11105.8 3068,-11105.8 3068,-11105.8 3074,-11105.8 3080,-11111.8 3080,-11117.8 3080,-11117.8 3080,-11405.8 3080,-11405.8 3080,-11411.8 3074,-11417.8 3068,-11417.8 3068,-11417.8 2824,-11417.8 2824,-11417.8 2818,-11417.8 2812,-11411.8 2812,-11405.8 2812,-11405.8 2812,-11117.8 2812,-11117.8 2812,-11111.8 2818,-11105.8 2824,-11105.8"/>
<text text-anchor="middle" x="2946" y="-11401" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust78" class="cluster">
<title>cluster_expert_8_1</title>
<path fill="none" stroke="black" d="M2268,-11309.8C2268,-11309.8 2792,-11309.8 2792,-11309.8 2798,-11309.8 2804,-11315.8 2804,-11321.8 2804,-11321.8 2804,-11427.8 2804,-11427.8 2804,-11433.8 2798,-11439.8 2792,-11439.8 2792,-11439.8 2268,-11439.8 2268,-11439.8 2262,-11439.8 2256,-11433.8 2256,-11427.8 2256,-11427.8 2256,-11321.8 2256,-11321.8 2256,-11315.8 2262,-11309.8 2268,-11309.8"/>
<text text-anchor="middle" x="2530" y="-11423" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust79" class="cluster">
<title>cluster_expert_8_2</title>
<path fill="none" stroke="black" d="M1712,-11309.8C1712,-11309.8 2236,-11309.8 2236,-11309.8 2242,-11309.8 2248,-11315.8 2248,-11321.8 2248,-11321.8 2248,-11427.8 2248,-11427.8 2248,-11433.8 2242,-11439.8 2236,-11439.8 2236,-11439.8 1712,-11439.8 1712,-11439.8 1706,-11439.8 1700,-11433.8 1700,-11427.8 1700,-11427.8 1700,-11321.8 1700,-11321.8 1700,-11315.8 1706,-11309.8 1712,-11309.8"/>
<text text-anchor="middle" x="1974" y="-11423" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust80" class="cluster">
<title>cluster_expert_8_61</title>
<path fill="none" stroke="black" d="M1156,-11309.8C1156,-11309.8 1680,-11309.8 1680,-11309.8 1686,-11309.8 1692,-11315.8 1692,-11321.8 1692,-11321.8 1692,-11427.8 1692,-11427.8 1692,-11433.8 1686,-11439.8 1680,-11439.8 1680,-11439.8 1156,-11439.8 1156,-11439.8 1150,-11439.8 1144,-11433.8 1144,-11427.8 1144,-11427.8 1144,-11321.8 1144,-11321.8 1144,-11315.8 1150,-11309.8 1156,-11309.8"/>
<text text-anchor="middle" x="1418" y="-11423" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust81" class="cluster">
<title>cluster_expert_8_62</title>
<path fill="none" stroke="black" d="M600,-11309.8C600,-11309.8 1124,-11309.8 1124,-11309.8 1130,-11309.8 1136,-11315.8 1136,-11321.8 1136,-11321.8 1136,-11427.8 1136,-11427.8 1136,-11433.8 1130,-11439.8 1124,-11439.8 1124,-11439.8 600,-11439.8 600,-11439.8 594,-11439.8 588,-11433.8 588,-11427.8 588,-11427.8 588,-11321.8 588,-11321.8 588,-11315.8 594,-11309.8 600,-11309.8"/>
<text text-anchor="middle" x="862" y="-11423" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust82" class="cluster">
<title>cluster_expert_8_63</title>
<path fill="none" stroke="black" d="M44,-11309.8C44,-11309.8 568,-11309.8 568,-11309.8 574,-11309.8 580,-11315.8 580,-11321.8 580,-11321.8 580,-11427.8 580,-11427.8 580,-11433.8 574,-11439.8 568,-11439.8 568,-11439.8 44,-11439.8 44,-11439.8 38,-11439.8 32,-11433.8 32,-11427.8 32,-11427.8 32,-11321.8 32,-11321.8 32,-11315.8 38,-11309.8 44,-11309.8"/>
<text text-anchor="middle" x="306" y="-11423" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust83" class="cluster">
<title>cluster_layer_9</title>
<path fill="none" stroke="black" d="M28,-9359.58C28,-9359.58 3094,-9359.58 3094,-9359.58 3100,-9359.58 3106,-9365.58 3106,-9371.58 3106,-9371.58 3106,-10881.8 3106,-10881.8 3106,-10887.8 3100,-10893.8 3094,-10893.8 3094,-10893.8 28,-10893.8 28,-10893.8 22,-10893.8 16,-10887.8 16,-10881.8 16,-10881.8 16,-9371.58 16,-9371.58 16,-9365.58 22,-9359.58 28,-9359.58"/>
<text text-anchor="middle" x="1561" y="-10877" font-family="Arial Bold" font-size="16.00">Transformer Layer 9</text>
</g>
<g id="clust84" class="cluster">
<title>cluster_mha_9</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2573,-10313.8 2573,-10807.8 3052,-10807.8 3052,-10313.8 2573,-10313.8"/>
<text text-anchor="middle" x="2812.5" y="-10791" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust85" class="cluster">
<title>cluster_moe_9</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-9439.58 24,-9931.58 3088,-9931.58 3088,-9439.58 24,-9439.58"/>
<text text-anchor="middle" x="1556" y="-9914.78" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust86" class="cluster">
<title>cluster_expert_9_0</title>
<path fill="none" stroke="black" d="M2824,-9563.58C2824,-9563.58 3068,-9563.58 3068,-9563.58 3074,-9563.58 3080,-9569.58 3080,-9575.58 3080,-9575.58 3080,-9863.58 3080,-9863.58 3080,-9869.58 3074,-9875.58 3068,-9875.58 3068,-9875.58 2824,-9875.58 2824,-9875.58 2818,-9875.58 2812,-9869.58 2812,-9863.58 2812,-9863.58 2812,-9575.58 2812,-9575.58 2812,-9569.58 2818,-9563.58 2824,-9563.58"/>
<text text-anchor="middle" x="2946" y="-9858.78" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust87" class="cluster">
<title>cluster_expert_9_1</title>
<path fill="none" stroke="black" d="M2268,-9767.58C2268,-9767.58 2792,-9767.58 2792,-9767.58 2798,-9767.58 2804,-9773.58 2804,-9779.58 2804,-9779.58 2804,-9885.58 2804,-9885.58 2804,-9891.58 2798,-9897.58 2792,-9897.58 2792,-9897.58 2268,-9897.58 2268,-9897.58 2262,-9897.58 2256,-9891.58 2256,-9885.58 2256,-9885.58 2256,-9779.58 2256,-9779.58 2256,-9773.58 2262,-9767.58 2268,-9767.58"/>
<text text-anchor="middle" x="2530" y="-9880.78" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust88" class="cluster">
<title>cluster_expert_9_2</title>
<path fill="none" stroke="black" d="M1712,-9767.58C1712,-9767.58 2236,-9767.58 2236,-9767.58 2242,-9767.58 2248,-9773.58 2248,-9779.58 2248,-9779.58 2248,-9885.58 2248,-9885.58 2248,-9891.58 2242,-9897.58 2236,-9897.58 2236,-9897.58 1712,-9897.58 1712,-9897.58 1706,-9897.58 1700,-9891.58 1700,-9885.58 1700,-9885.58 1700,-9779.58 1700,-9779.58 1700,-9773.58 1706,-9767.58 1712,-9767.58"/>
<text text-anchor="middle" x="1974" y="-9880.78" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust89" class="cluster">
<title>cluster_expert_9_61</title>
<path fill="none" stroke="black" d="M1156,-9767.58C1156,-9767.58 1680,-9767.58 1680,-9767.58 1686,-9767.58 1692,-9773.58 1692,-9779.58 1692,-9779.58 1692,-9885.58 1692,-9885.58 1692,-9891.58 1686,-9897.58 1680,-9897.58 1680,-9897.58 1156,-9897.58 1156,-9897.58 1150,-9897.58 1144,-9891.58 1144,-9885.58 1144,-9885.58 1144,-9779.58 1144,-9779.58 1144,-9773.58 1150,-9767.58 1156,-9767.58"/>
<text text-anchor="middle" x="1418" y="-9880.78" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust90" class="cluster">
<title>cluster_expert_9_62</title>
<path fill="none" stroke="black" d="M600,-9767.58C600,-9767.58 1124,-9767.58 1124,-9767.58 1130,-9767.58 1136,-9773.58 1136,-9779.58 1136,-9779.58 1136,-9885.58 1136,-9885.58 1136,-9891.58 1130,-9897.58 1124,-9897.58 1124,-9897.58 600,-9897.58 600,-9897.58 594,-9897.58 588,-9891.58 588,-9885.58 588,-9885.58 588,-9779.58 588,-9779.58 588,-9773.58 594,-9767.58 600,-9767.58"/>
<text text-anchor="middle" x="862" y="-9880.78" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust91" class="cluster">
<title>cluster_expert_9_63</title>
<path fill="none" stroke="black" d="M44,-9767.58C44,-9767.58 568,-9767.58 568,-9767.58 574,-9767.58 580,-9773.58 580,-9779.58 580,-9779.58 580,-9885.58 580,-9885.58 580,-9891.58 574,-9897.58 568,-9897.58 568,-9897.58 44,-9897.58 44,-9897.58 38,-9897.58 32,-9891.58 32,-9885.58 32,-9885.58 32,-9779.58 32,-9779.58 32,-9773.58 38,-9767.58 44,-9767.58"/>
<text text-anchor="middle" x="306" y="-9880.78" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust92" class="cluster">
<title>cluster_layer_10</title>
<path fill="none" stroke="black" d="M28,-7817.35C28,-7817.35 3094,-7817.35 3094,-7817.35 3100,-7817.35 3106,-7823.35 3106,-7829.35 3106,-7829.35 3106,-9339.58 3106,-9339.58 3106,-9345.58 3100,-9351.58 3094,-9351.58 3094,-9351.58 28,-9351.58 28,-9351.58 22,-9351.58 16,-9345.58 16,-9339.58 16,-9339.58 16,-7829.35 16,-7829.35 16,-7823.35 22,-7817.35 28,-7817.35"/>
<text text-anchor="middle" x="1561" y="-9334.78" font-family="Arial Bold" font-size="16.00">Transformer Layer 10</text>
</g>
<g id="clust93" class="cluster">
<title>cluster_mha_10</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2573,-8771.58 2573,-9265.58 3052,-9265.58 3052,-8771.58 2573,-8771.58"/>
<text text-anchor="middle" x="2812.5" y="-9248.78" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust94" class="cluster">
<title>cluster_moe_10</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-7897.35 24,-8389.35 3088,-8389.35 3088,-7897.35 24,-7897.35"/>
<text text-anchor="middle" x="1556" y="-8372.55" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust95" class="cluster">
<title>cluster_expert_10_0</title>
<path fill="none" stroke="black" d="M2824,-8021.35C2824,-8021.35 3068,-8021.35 3068,-8021.35 3074,-8021.35 3080,-8027.35 3080,-8033.35 3080,-8033.35 3080,-8321.35 3080,-8321.35 3080,-8327.35 3074,-8333.35 3068,-8333.35 3068,-8333.35 2824,-8333.35 2824,-8333.35 2818,-8333.35 2812,-8327.35 2812,-8321.35 2812,-8321.35 2812,-8033.35 2812,-8033.35 2812,-8027.35 2818,-8021.35 2824,-8021.35"/>
<text text-anchor="middle" x="2946" y="-8316.55" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust96" class="cluster">
<title>cluster_expert_10_1</title>
<path fill="none" stroke="black" d="M2268,-8225.35C2268,-8225.35 2792,-8225.35 2792,-8225.35 2798,-8225.35 2804,-8231.35 2804,-8237.35 2804,-8237.35 2804,-8343.35 2804,-8343.35 2804,-8349.35 2798,-8355.35 2792,-8355.35 2792,-8355.35 2268,-8355.35 2268,-8355.35 2262,-8355.35 2256,-8349.35 2256,-8343.35 2256,-8343.35 2256,-8237.35 2256,-8237.35 2256,-8231.35 2262,-8225.35 2268,-8225.35"/>
<text text-anchor="middle" x="2530" y="-8338.55" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust97" class="cluster">
<title>cluster_expert_10_2</title>
<path fill="none" stroke="black" d="M1712,-8225.35C1712,-8225.35 2236,-8225.35 2236,-8225.35 2242,-8225.35 2248,-8231.35 2248,-8237.35 2248,-8237.35 2248,-8343.35 2248,-8343.35 2248,-8349.35 2242,-8355.35 2236,-8355.35 2236,-8355.35 1712,-8355.35 1712,-8355.35 1706,-8355.35 1700,-8349.35 1700,-8343.35 1700,-8343.35 1700,-8237.35 1700,-8237.35 1700,-8231.35 1706,-8225.35 1712,-8225.35"/>
<text text-anchor="middle" x="1974" y="-8338.55" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust98" class="cluster">
<title>cluster_expert_10_61</title>
<path fill="none" stroke="black" d="M1156,-8225.35C1156,-8225.35 1680,-8225.35 1680,-8225.35 1686,-8225.35 1692,-8231.35 1692,-8237.35 1692,-8237.35 1692,-8343.35 1692,-8343.35 1692,-8349.35 1686,-8355.35 1680,-8355.35 1680,-8355.35 1156,-8355.35 1156,-8355.35 1150,-8355.35 1144,-8349.35 1144,-8343.35 1144,-8343.35 1144,-8237.35 1144,-8237.35 1144,-8231.35 1150,-8225.35 1156,-8225.35"/>
<text text-anchor="middle" x="1418" y="-8338.55" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust99" class="cluster">
<title>cluster_expert_10_62</title>
<path fill="none" stroke="black" d="M600,-8225.35C600,-8225.35 1124,-8225.35 1124,-8225.35 1130,-8225.35 1136,-8231.35 1136,-8237.35 1136,-8237.35 1136,-8343.35 1136,-8343.35 1136,-8349.35 1130,-8355.35 1124,-8355.35 1124,-8355.35 600,-8355.35 600,-8355.35 594,-8355.35 588,-8349.35 588,-8343.35 588,-8343.35 588,-8237.35 588,-8237.35 588,-8231.35 594,-8225.35 600,-8225.35"/>
<text text-anchor="middle" x="862" y="-8338.55" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust100" class="cluster">
<title>cluster_expert_10_63</title>
<path fill="none" stroke="black" d="M44,-8225.35C44,-8225.35 568,-8225.35 568,-8225.35 574,-8225.35 580,-8231.35 580,-8237.35 580,-8237.35 580,-8343.35 580,-8343.35 580,-8349.35 574,-8355.35 568,-8355.35 568,-8355.35 44,-8355.35 44,-8355.35 38,-8355.35 32,-8349.35 32,-8343.35 32,-8343.35 32,-8237.35 32,-8237.35 32,-8231.35 38,-8225.35 44,-8225.35"/>
<text text-anchor="middle" x="306" y="-8338.55" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust101" class="cluster">
<title>cluster_layer_11</title>
<path fill="none" stroke="black" d="M28,-6275.13C28,-6275.13 3094,-6275.13 3094,-6275.13 3100,-6275.13 3106,-6281.13 3106,-6287.13 3106,-6287.13 3106,-7797.35 3106,-7797.35 3106,-7803.35 3100,-7809.35 3094,-7809.35 3094,-7809.35 28,-7809.35 28,-7809.35 22,-7809.35 16,-7803.35 16,-7797.35 16,-7797.35 16,-6287.13 16,-6287.13 16,-6281.13 22,-6275.13 28,-6275.13"/>
<text text-anchor="middle" x="1561" y="-7792.55" font-family="Arial Bold" font-size="16.00">Transformer Layer 11</text>
</g>
<g id="clust102" class="cluster">
<title>cluster_mha_11</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2495,-7229.35 2495,-7723.35 2974,-7723.35 2974,-7229.35 2495,-7229.35"/>
<text text-anchor="middle" x="2734.5" y="-7706.55" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust103" class="cluster">
<title>cluster_moe_11</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-6355.13 24,-6847.13 3088,-6847.13 3088,-6355.13 24,-6355.13"/>
<text text-anchor="middle" x="1556" y="-6830.33" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust104" class="cluster">
<title>cluster_expert_11_0</title>
<path fill="none" stroke="black" d="M2824,-6479.13C2824,-6479.13 3068,-6479.13 3068,-6479.13 3074,-6479.13 3080,-6485.13 3080,-6491.13 3080,-6491.13 3080,-6779.13 3080,-6779.13 3080,-6785.13 3074,-6791.13 3068,-6791.13 3068,-6791.13 2824,-6791.13 2824,-6791.13 2818,-6791.13 2812,-6785.13 2812,-6779.13 2812,-6779.13 2812,-6491.13 2812,-6491.13 2812,-6485.13 2818,-6479.13 2824,-6479.13"/>
<text text-anchor="middle" x="2946" y="-6774.33" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust105" class="cluster">
<title>cluster_expert_11_1</title>
<path fill="none" stroke="black" d="M2268,-6683.13C2268,-6683.13 2792,-6683.13 2792,-6683.13 2798,-6683.13 2804,-6689.13 2804,-6695.13 2804,-6695.13 2804,-6801.13 2804,-6801.13 2804,-6807.13 2798,-6813.13 2792,-6813.13 2792,-6813.13 2268,-6813.13 2268,-6813.13 2262,-6813.13 2256,-6807.13 2256,-6801.13 2256,-6801.13 2256,-6695.13 2256,-6695.13 2256,-6689.13 2262,-6683.13 2268,-6683.13"/>
<text text-anchor="middle" x="2530" y="-6796.33" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust106" class="cluster">
<title>cluster_expert_11_2</title>
<path fill="none" stroke="black" d="M1712,-6683.13C1712,-6683.13 2236,-6683.13 2236,-6683.13 2242,-6683.13 2248,-6689.13 2248,-6695.13 2248,-6695.13 2248,-6801.13 2248,-6801.13 2248,-6807.13 2242,-6813.13 2236,-6813.13 2236,-6813.13 1712,-6813.13 1712,-6813.13 1706,-6813.13 1700,-6807.13 1700,-6801.13 1700,-6801.13 1700,-6695.13 1700,-6695.13 1700,-6689.13 1706,-6683.13 1712,-6683.13"/>
<text text-anchor="middle" x="1974" y="-6796.33" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust107" class="cluster">
<title>cluster_expert_11_61</title>
<path fill="none" stroke="black" d="M1156,-6683.13C1156,-6683.13 1680,-6683.13 1680,-6683.13 1686,-6683.13 1692,-6689.13 1692,-6695.13 1692,-6695.13 1692,-6801.13 1692,-6801.13 1692,-6807.13 1686,-6813.13 1680,-6813.13 1680,-6813.13 1156,-6813.13 1156,-6813.13 1150,-6813.13 1144,-6807.13 1144,-6801.13 1144,-6801.13 1144,-6695.13 1144,-6695.13 1144,-6689.13 1150,-6683.13 1156,-6683.13"/>
<text text-anchor="middle" x="1418" y="-6796.33" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust108" class="cluster">
<title>cluster_expert_11_62</title>
<path fill="none" stroke="black" d="M600,-6683.13C600,-6683.13 1124,-6683.13 1124,-6683.13 1130,-6683.13 1136,-6689.13 1136,-6695.13 1136,-6695.13 1136,-6801.13 1136,-6801.13 1136,-6807.13 1130,-6813.13 1124,-6813.13 1124,-6813.13 600,-6813.13 600,-6813.13 594,-6813.13 588,-6807.13 588,-6801.13 588,-6801.13 588,-6695.13 588,-6695.13 588,-6689.13 594,-6683.13 600,-6683.13"/>
<text text-anchor="middle" x="862" y="-6796.33" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust109" class="cluster">
<title>cluster_expert_11_63</title>
<path fill="none" stroke="black" d="M44,-6683.13C44,-6683.13 568,-6683.13 568,-6683.13 574,-6683.13 580,-6689.13 580,-6695.13 580,-6695.13 580,-6801.13 580,-6801.13 580,-6807.13 574,-6813.13 568,-6813.13 568,-6813.13 44,-6813.13 44,-6813.13 38,-6813.13 32,-6807.13 32,-6801.13 32,-6801.13 32,-6695.13 32,-6695.13 32,-6689.13 38,-6683.13 44,-6683.13"/>
<text text-anchor="middle" x="306" y="-6796.33" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust110" class="cluster">
<title>cluster_layer_12</title>
<path fill="none" stroke="black" d="M28,-4732.9C28,-4732.9 3094,-4732.9 3094,-4732.9 3100,-4732.9 3106,-4738.9 3106,-4744.9 3106,-4744.9 3106,-6255.13 3106,-6255.13 3106,-6261.13 3100,-6267.13 3094,-6267.13 3094,-6267.13 28,-6267.13 28,-6267.13 22,-6267.13 16,-6261.13 16,-6255.13 16,-6255.13 16,-4744.9 16,-4744.9 16,-4738.9 22,-4732.9 28,-4732.9"/>
<text text-anchor="middle" x="1561" y="-6250.33" font-family="Arial Bold" font-size="16.00">Transformer Layer 12</text>
</g>
<g id="clust111" class="cluster">
<title>cluster_mha_12</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2573,-5687.13 2573,-6181.13 3052,-6181.13 3052,-5687.13 2573,-5687.13"/>
<text text-anchor="middle" x="2812.5" y="-6164.33" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust112" class="cluster">
<title>cluster_moe_12</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-4812.9 24,-5304.9 3088,-5304.9 3088,-4812.9 24,-4812.9"/>
<text text-anchor="middle" x="1556" y="-5288.1" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust113" class="cluster">
<title>cluster_expert_12_0</title>
<path fill="none" stroke="black" d="M2824,-4936.9C2824,-4936.9 3068,-4936.9 3068,-4936.9 3074,-4936.9 3080,-4942.9 3080,-4948.9 3080,-4948.9 3080,-5236.9 3080,-5236.9 3080,-5242.9 3074,-5248.9 3068,-5248.9 3068,-5248.9 2824,-5248.9 2824,-5248.9 2818,-5248.9 2812,-5242.9 2812,-5236.9 2812,-5236.9 2812,-4948.9 2812,-4948.9 2812,-4942.9 2818,-4936.9 2824,-4936.9"/>
<text text-anchor="middle" x="2946" y="-5232.1" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust114" class="cluster">
<title>cluster_expert_12_1</title>
<path fill="none" stroke="black" d="M2268,-5140.9C2268,-5140.9 2792,-5140.9 2792,-5140.9 2798,-5140.9 2804,-5146.9 2804,-5152.9 2804,-5152.9 2804,-5258.9 2804,-5258.9 2804,-5264.9 2798,-5270.9 2792,-5270.9 2792,-5270.9 2268,-5270.9 2268,-5270.9 2262,-5270.9 2256,-5264.9 2256,-5258.9 2256,-5258.9 2256,-5152.9 2256,-5152.9 2256,-5146.9 2262,-5140.9 2268,-5140.9"/>
<text text-anchor="middle" x="2530" y="-5254.1" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust115" class="cluster">
<title>cluster_expert_12_2</title>
<path fill="none" stroke="black" d="M1712,-5140.9C1712,-5140.9 2236,-5140.9 2236,-5140.9 2242,-5140.9 2248,-5146.9 2248,-5152.9 2248,-5152.9 2248,-5258.9 2248,-5258.9 2248,-5264.9 2242,-5270.9 2236,-5270.9 2236,-5270.9 1712,-5270.9 1712,-5270.9 1706,-5270.9 1700,-5264.9 1700,-5258.9 1700,-5258.9 1700,-5152.9 1700,-5152.9 1700,-5146.9 1706,-5140.9 1712,-5140.9"/>
<text text-anchor="middle" x="1974" y="-5254.1" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust116" class="cluster">
<title>cluster_expert_12_61</title>
<path fill="none" stroke="black" d="M1156,-5140.9C1156,-5140.9 1680,-5140.9 1680,-5140.9 1686,-5140.9 1692,-5146.9 1692,-5152.9 1692,-5152.9 1692,-5258.9 1692,-5258.9 1692,-5264.9 1686,-5270.9 1680,-5270.9 1680,-5270.9 1156,-5270.9 1156,-5270.9 1150,-5270.9 1144,-5264.9 1144,-5258.9 1144,-5258.9 1144,-5152.9 1144,-5152.9 1144,-5146.9 1150,-5140.9 1156,-5140.9"/>
<text text-anchor="middle" x="1418" y="-5254.1" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust117" class="cluster">
<title>cluster_expert_12_62</title>
<path fill="none" stroke="black" d="M600,-5140.9C600,-5140.9 1124,-5140.9 1124,-5140.9 1130,-5140.9 1136,-5146.9 1136,-5152.9 1136,-5152.9 1136,-5258.9 1136,-5258.9 1136,-5264.9 1130,-5270.9 1124,-5270.9 1124,-5270.9 600,-5270.9 600,-5270.9 594,-5270.9 588,-5264.9 588,-5258.9 588,-5258.9 588,-5152.9 588,-5152.9 588,-5146.9 594,-5140.9 600,-5140.9"/>
<text text-anchor="middle" x="862" y="-5254.1" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust118" class="cluster">
<title>cluster_expert_12_63</title>
<path fill="none" stroke="black" d="M44,-5140.9C44,-5140.9 568,-5140.9 568,-5140.9 574,-5140.9 580,-5146.9 580,-5152.9 580,-5152.9 580,-5258.9 580,-5258.9 580,-5264.9 574,-5270.9 568,-5270.9 568,-5270.9 44,-5270.9 44,-5270.9 38,-5270.9 32,-5264.9 32,-5258.9 32,-5258.9 32,-5152.9 32,-5152.9 32,-5146.9 38,-5140.9 44,-5140.9"/>
<text text-anchor="middle" x="306" y="-5254.1" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust119" class="cluster">
<title>cluster_layer_13</title>
<path fill="none" stroke="black" d="M28,-3190.68C28,-3190.68 3094,-3190.68 3094,-3190.68 3100,-3190.68 3106,-3196.68 3106,-3202.68 3106,-3202.68 3106,-4712.9 3106,-4712.9 3106,-4718.9 3100,-4724.9 3094,-4724.9 3094,-4724.9 28,-4724.9 28,-4724.9 22,-4724.9 16,-4718.9 16,-4712.9 16,-4712.9 16,-3202.68 16,-3202.68 16,-3196.68 22,-3190.68 28,-3190.68"/>
<text text-anchor="middle" x="1561" y="-4708.1" font-family="Arial Bold" font-size="16.00">Transformer Layer 13</text>
</g>
<g id="clust120" class="cluster">
<title>cluster_mha_13</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2573,-4144.9 2573,-4638.9 3052,-4638.9 3052,-4144.9 2573,-4144.9"/>
<text text-anchor="middle" x="2812.5" y="-4622.1" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust121" class="cluster">
<title>cluster_moe_13</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-3270.68 24,-3762.68 3088,-3762.68 3088,-3270.68 24,-3270.68"/>
<text text-anchor="middle" x="1556" y="-3745.88" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust122" class="cluster">
<title>cluster_expert_13_0</title>
<path fill="none" stroke="black" d="M2824,-3394.68C2824,-3394.68 3068,-3394.68 3068,-3394.68 3074,-3394.68 3080,-3400.68 3080,-3406.68 3080,-3406.68 3080,-3694.68 3080,-3694.68 3080,-3700.68 3074,-3706.68 3068,-3706.68 3068,-3706.68 2824,-3706.68 2824,-3706.68 2818,-3706.68 2812,-3700.68 2812,-3694.68 2812,-3694.68 2812,-3406.68 2812,-3406.68 2812,-3400.68 2818,-3394.68 2824,-3394.68"/>
<text text-anchor="middle" x="2946" y="-3689.88" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust123" class="cluster">
<title>cluster_expert_13_1</title>
<path fill="none" stroke="black" d="M2268,-3598.68C2268,-3598.68 2792,-3598.68 2792,-3598.68 2798,-3598.68 2804,-3604.68 2804,-3610.68 2804,-3610.68 2804,-3716.68 2804,-3716.68 2804,-3722.68 2798,-3728.68 2792,-3728.68 2792,-3728.68 2268,-3728.68 2268,-3728.68 2262,-3728.68 2256,-3722.68 2256,-3716.68 2256,-3716.68 2256,-3610.68 2256,-3610.68 2256,-3604.68 2262,-3598.68 2268,-3598.68"/>
<text text-anchor="middle" x="2530" y="-3711.88" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust124" class="cluster">
<title>cluster_expert_13_2</title>
<path fill="none" stroke="black" d="M1712,-3598.68C1712,-3598.68 2236,-3598.68 2236,-3598.68 2242,-3598.68 2248,-3604.68 2248,-3610.68 2248,-3610.68 2248,-3716.68 2248,-3716.68 2248,-3722.68 2242,-3728.68 2236,-3728.68 2236,-3728.68 1712,-3728.68 1712,-3728.68 1706,-3728.68 1700,-3722.68 1700,-3716.68 1700,-3716.68 1700,-3610.68 1700,-3610.68 1700,-3604.68 1706,-3598.68 1712,-3598.68"/>
<text text-anchor="middle" x="1974" y="-3711.88" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust125" class="cluster">
<title>cluster_expert_13_61</title>
<path fill="none" stroke="black" d="M1156,-3598.68C1156,-3598.68 1680,-3598.68 1680,-3598.68 1686,-3598.68 1692,-3604.68 1692,-3610.68 1692,-3610.68 1692,-3716.68 1692,-3716.68 1692,-3722.68 1686,-3728.68 1680,-3728.68 1680,-3728.68 1156,-3728.68 1156,-3728.68 1150,-3728.68 1144,-3722.68 1144,-3716.68 1144,-3716.68 1144,-3610.68 1144,-3610.68 1144,-3604.68 1150,-3598.68 1156,-3598.68"/>
<text text-anchor="middle" x="1418" y="-3711.88" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust126" class="cluster">
<title>cluster_expert_13_62</title>
<path fill="none" stroke="black" d="M600,-3598.68C600,-3598.68 1124,-3598.68 1124,-3598.68 1130,-3598.68 1136,-3604.68 1136,-3610.68 1136,-3610.68 1136,-3716.68 1136,-3716.68 1136,-3722.68 1130,-3728.68 1124,-3728.68 1124,-3728.68 600,-3728.68 600,-3728.68 594,-3728.68 588,-3722.68 588,-3716.68 588,-3716.68 588,-3610.68 588,-3610.68 588,-3604.68 594,-3598.68 600,-3598.68"/>
<text text-anchor="middle" x="862" y="-3711.88" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust127" class="cluster">
<title>cluster_expert_13_63</title>
<path fill="none" stroke="black" d="M44,-3598.68C44,-3598.68 568,-3598.68 568,-3598.68 574,-3598.68 580,-3604.68 580,-3610.68 580,-3610.68 580,-3716.68 580,-3716.68 580,-3722.68 574,-3728.68 568,-3728.68 568,-3728.68 44,-3728.68 44,-3728.68 38,-3728.68 32,-3722.68 32,-3716.68 32,-3716.68 32,-3610.68 32,-3610.68 32,-3604.68 38,-3598.68 44,-3598.68"/>
<text text-anchor="middle" x="306" y="-3711.88" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust128" class="cluster">
<title>cluster_layer_14</title>
<path fill="none" stroke="black" d="M28,-1648.45C28,-1648.45 3094,-1648.45 3094,-1648.45 3100,-1648.45 3106,-1654.45 3106,-1660.45 3106,-1660.45 3106,-3170.68 3106,-3170.68 3106,-3176.68 3100,-3182.68 3094,-3182.68 3094,-3182.68 28,-3182.68 28,-3182.68 22,-3182.68 16,-3176.68 16,-3170.68 16,-3170.68 16,-1660.45 16,-1660.45 16,-1654.45 22,-1648.45 28,-1648.45"/>
<text text-anchor="middle" x="1561" y="-3165.88" font-family="Arial Bold" font-size="16.00">Transformer Layer 14</text>
</g>
<g id="clust129" class="cluster">
<title>cluster_mha_14</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2573,-2602.68 2573,-3096.68 3052,-3096.68 3052,-2602.68 2573,-2602.68"/>
<text text-anchor="middle" x="2812.5" y="-3079.88" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust130" class="cluster">
<title>cluster_moe_14</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-1728.45 24,-2220.45 3088,-2220.45 3088,-1728.45 24,-1728.45"/>
<text text-anchor="middle" x="1556" y="-2203.65" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust131" class="cluster">
<title>cluster_expert_14_0</title>
<path fill="none" stroke="black" d="M2824,-1852.45C2824,-1852.45 3068,-1852.45 3068,-1852.45 3074,-1852.45 3080,-1858.45 3080,-1864.45 3080,-1864.45 3080,-2152.45 3080,-2152.45 3080,-2158.45 3074,-2164.45 3068,-2164.45 3068,-2164.45 2824,-2164.45 2824,-2164.45 2818,-2164.45 2812,-2158.45 2812,-2152.45 2812,-2152.45 2812,-1864.45 2812,-1864.45 2812,-1858.45 2818,-1852.45 2824,-1852.45"/>
<text text-anchor="middle" x="2946" y="-2147.65" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust132" class="cluster">
<title>cluster_expert_14_1</title>
<path fill="none" stroke="black" d="M2268,-2056.45C2268,-2056.45 2792,-2056.45 2792,-2056.45 2798,-2056.45 2804,-2062.45 2804,-2068.45 2804,-2068.45 2804,-2174.45 2804,-2174.45 2804,-2180.45 2798,-2186.45 2792,-2186.45 2792,-2186.45 2268,-2186.45 2268,-2186.45 2262,-2186.45 2256,-2180.45 2256,-2174.45 2256,-2174.45 2256,-2068.45 2256,-2068.45 2256,-2062.45 2262,-2056.45 2268,-2056.45"/>
<text text-anchor="middle" x="2530" y="-2169.65" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust133" class="cluster">
<title>cluster_expert_14_2</title>
<path fill="none" stroke="black" d="M1712,-2056.45C1712,-2056.45 2236,-2056.45 2236,-2056.45 2242,-2056.45 2248,-2062.45 2248,-2068.45 2248,-2068.45 2248,-2174.45 2248,-2174.45 2248,-2180.45 2242,-2186.45 2236,-2186.45 2236,-2186.45 1712,-2186.45 1712,-2186.45 1706,-2186.45 1700,-2180.45 1700,-2174.45 1700,-2174.45 1700,-2068.45 1700,-2068.45 1700,-2062.45 1706,-2056.45 1712,-2056.45"/>
<text text-anchor="middle" x="1974" y="-2169.65" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust134" class="cluster">
<title>cluster_expert_14_61</title>
<path fill="none" stroke="black" d="M1156,-2056.45C1156,-2056.45 1680,-2056.45 1680,-2056.45 1686,-2056.45 1692,-2062.45 1692,-2068.45 1692,-2068.45 1692,-2174.45 1692,-2174.45 1692,-2180.45 1686,-2186.45 1680,-2186.45 1680,-2186.45 1156,-2186.45 1156,-2186.45 1150,-2186.45 1144,-2180.45 1144,-2174.45 1144,-2174.45 1144,-2068.45 1144,-2068.45 1144,-2062.45 1150,-2056.45 1156,-2056.45"/>
<text text-anchor="middle" x="1418" y="-2169.65" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust135" class="cluster">
<title>cluster_expert_14_62</title>
<path fill="none" stroke="black" d="M600,-2056.45C600,-2056.45 1124,-2056.45 1124,-2056.45 1130,-2056.45 1136,-2062.45 1136,-2068.45 1136,-2068.45 1136,-2174.45 1136,-2174.45 1136,-2180.45 1130,-2186.45 1124,-2186.45 1124,-2186.45 600,-2186.45 600,-2186.45 594,-2186.45 588,-2180.45 588,-2174.45 588,-2174.45 588,-2068.45 588,-2068.45 588,-2062.45 594,-2056.45 600,-2056.45"/>
<text text-anchor="middle" x="862" y="-2169.65" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust136" class="cluster">
<title>cluster_expert_14_63</title>
<path fill="none" stroke="black" d="M44,-2056.45C44,-2056.45 568,-2056.45 568,-2056.45 574,-2056.45 580,-2062.45 580,-2068.45 580,-2068.45 580,-2174.45 580,-2174.45 580,-2180.45 574,-2186.45 568,-2186.45 568,-2186.45 44,-2186.45 44,-2186.45 38,-2186.45 32,-2180.45 32,-2174.45 32,-2174.45 32,-2068.45 32,-2068.45 32,-2062.45 38,-2056.45 44,-2056.45"/>
<text text-anchor="middle" x="306" y="-2169.65" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust137" class="cluster">
<title>cluster_layer_15</title>
<path fill="none" stroke="black" d="M28,-106.23C28,-106.23 3094,-106.23 3094,-106.23 3100,-106.23 3106,-112.23 3106,-118.23 3106,-118.23 3106,-1628.45 3106,-1628.45 3106,-1634.45 3100,-1640.45 3094,-1640.45 3094,-1640.45 28,-1640.45 28,-1640.45 22,-1640.45 16,-1634.45 16,-1628.45 16,-1628.45 16,-118.23 16,-118.23 16,-112.23 22,-106.23 28,-106.23"/>
<text text-anchor="middle" x="1561" y="-1623.65" font-family="Arial Bold" font-size="16.00">Transformer Layer 15</text>
</g>
<g id="clust138" class="cluster">
<title>cluster_mha_15</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="2495,-1060.45 2495,-1554.45 2974,-1554.45 2974,-1060.45 2495,-1060.45"/>
<text text-anchor="middle" x="2734.5" y="-1537.65" font-family="Arial Bold" font-size="16.00">Multi&#45;Head Attention (TP=2)</text>
</g>
<g id="clust139" class="cluster">
<title>cluster_moe_15</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="24,-186.23 24,-678.23 3088,-678.23 3088,-186.23 24,-186.23"/>
<text text-anchor="middle" x="1556" y="-661.43" font-family="Arial Bold" font-size="16.00">Mixture of Experts (EP=64, TP=2)</text>
</g>
<g id="clust140" class="cluster">
<title>cluster_expert_15_0</title>
<path fill="none" stroke="black" d="M2824,-310.23C2824,-310.23 3068,-310.23 3068,-310.23 3074,-310.23 3080,-316.23 3080,-322.23 3080,-322.23 3080,-610.23 3080,-610.23 3080,-616.23 3074,-622.23 3068,-622.23 3068,-622.23 2824,-622.23 2824,-622.23 2818,-622.23 2812,-616.23 2812,-610.23 2812,-610.23 2812,-322.23 2812,-322.23 2812,-316.23 2818,-310.23 2824,-310.23"/>
<text text-anchor="middle" x="2946" y="-605.43" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust141" class="cluster">
<title>cluster_expert_15_1</title>
<path fill="none" stroke="black" d="M2268,-514.23C2268,-514.23 2792,-514.23 2792,-514.23 2798,-514.23 2804,-520.23 2804,-526.23 2804,-526.23 2804,-632.23 2804,-632.23 2804,-638.23 2798,-644.23 2792,-644.23 2792,-644.23 2268,-644.23 2268,-644.23 2262,-644.23 2256,-638.23 2256,-632.23 2256,-632.23 2256,-526.23 2256,-526.23 2256,-520.23 2262,-514.23 2268,-514.23"/>
<text text-anchor="middle" x="2530" y="-627.43" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust142" class="cluster">
<title>cluster_expert_15_2</title>
<path fill="none" stroke="black" d="M1712,-514.23C1712,-514.23 2236,-514.23 2236,-514.23 2242,-514.23 2248,-520.23 2248,-526.23 2248,-526.23 2248,-632.23 2248,-632.23 2248,-638.23 2242,-644.23 2236,-644.23 2236,-644.23 1712,-644.23 1712,-644.23 1706,-644.23 1700,-638.23 1700,-632.23 1700,-632.23 1700,-526.23 1700,-526.23 1700,-520.23 1706,-514.23 1712,-514.23"/>
<text text-anchor="middle" x="1974" y="-627.43" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust143" class="cluster">
<title>cluster_expert_15_61</title>
<path fill="none" stroke="black" d="M1156,-514.23C1156,-514.23 1680,-514.23 1680,-514.23 1686,-514.23 1692,-520.23 1692,-526.23 1692,-526.23 1692,-632.23 1692,-632.23 1692,-638.23 1686,-644.23 1680,-644.23 1680,-644.23 1156,-644.23 1156,-644.23 1150,-644.23 1144,-638.23 1144,-632.23 1144,-632.23 1144,-526.23 1144,-526.23 1144,-520.23 1150,-514.23 1156,-514.23"/>
<text text-anchor="middle" x="1418" y="-627.43" font-family="Arial Bold" font-size="16.00">Expert 61 (GPUs 122,123)</text>
</g>
<g id="clust144" class="cluster">
<title>cluster_expert_15_62</title>
<path fill="none" stroke="black" d="M600,-514.23C600,-514.23 1124,-514.23 1124,-514.23 1130,-514.23 1136,-520.23 1136,-526.23 1136,-526.23 1136,-632.23 1136,-632.23 1136,-638.23 1130,-644.23 1124,-644.23 1124,-644.23 600,-644.23 600,-644.23 594,-644.23 588,-638.23 588,-632.23 588,-632.23 588,-526.23 588,-526.23 588,-520.23 594,-514.23 600,-514.23"/>
<text text-anchor="middle" x="862" y="-627.43" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust145" class="cluster">
<title>cluster_expert_15_63</title>
<path fill="none" stroke="black" d="M44,-514.23C44,-514.23 568,-514.23 568,-514.23 574,-514.23 580,-520.23 580,-526.23 580,-526.23 580,-632.23 580,-632.23 580,-638.23 574,-644.23 568,-644.23 568,-644.23 44,-644.23 44,-644.23 38,-644.23 32,-638.23 32,-632.23 32,-632.23 32,-526.23 32,-526.23 32,-520.23 38,-514.23 44,-514.23"/>
<text text-anchor="middle" x="306" y="-627.43" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="2883" cy="-24892.94" rx="208.69" ry="31.23"/>
<text text-anchor="middle" x="2883" y="-24902.14" font-family="Arial" font-size="11.00">Model Input</text>
<text text-anchor="middle" x="2883" y="-24890.14" font-family="Arial" font-size="11.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="2883" y="-24878.14" font-family="Arial" font-size="11.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- embedding -->
<g id="node2" class="node">
<title>embedding</title>
<polygon fill="lightgreen" stroke="black" points="2955.5,-24825.83 2810.5,-24825.83 2810.5,-24781.83 2955.5,-24781.83 2955.5,-24825.83"/>
<text text-anchor="middle" x="2883" y="-24813.03" font-family="Arial" font-size="11.00">Token Embedding</text>
<text text-anchor="middle" x="2883" y="-24801.03" font-family="Arial" font-size="11.00">Input: [128, 10000]</text>
<text text-anchor="middle" x="2883" y="-24789.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- input&#45;&gt;embedding -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embedding</title>
<path fill="none" stroke="black" d="M2883,-24861.48C2883,-24853.2 2883,-24844.22 2883,-24835.91"/>
<polygon fill="black" stroke="black" points="2886.5,-24835.84 2883,-24825.84 2879.5,-24835.84 2886.5,-24835.84"/>
</g>
<!-- pre_ln_0 -->
<g id="node3" class="node">
<title>pre_ln_0</title>
<polygon fill="lightgreen" stroke="black" points="2903.5,-24739.83 2758.5,-24739.83 2758.5,-24695.83 2903.5,-24695.83 2903.5,-24739.83"/>
<text text-anchor="middle" x="2831" y="-24727.03" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_0</text>
<text text-anchor="middle" x="2831" y="-24715.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2831" y="-24703.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- embedding&#45;&gt;pre_ln_0 -->
<g id="edge2" class="edge">
<title>embedding&#45;&gt;pre_ln_0</title>
<path fill="none" stroke="black" d="M2869.88,-24781.63C2863.72,-24771.69 2856.27,-24759.66 2849.55,-24748.8"/>
<polygon fill="black" stroke="black" points="2852.36,-24746.68 2844.12,-24740.02 2846.41,-24750.37 2852.36,-24746.68"/>
</g>
<!-- add_1_0 -->
<g id="node12" class="node">
<title>add_1_0</title>
<polygon fill="lightgreen" stroke="black" points="3055.5,-24165.83 2816.5,-24165.83 2816.5,-24121.83 3055.5,-24121.83 3055.5,-24165.83"/>
<text text-anchor="middle" x="2936" y="-24153.03" font-family="Arial" font-size="11.00">Residual_Add1_0</text>
<text text-anchor="middle" x="2936" y="-24141.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2936" y="-24129.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- embedding&#45;&gt;add_1_0 -->
<g id="edge13" class="edge">
<title>embedding&#45;&gt;add_1_0</title>
<path fill="none" stroke="black" d="M2906.51,-24781.77C2908.84,-24779.21 2911.05,-24776.54 2913,-24773.83 2957.18,-24712.42 2962,-24686.48 2962,-24610.83 2962,-24610.83 2962,-24610.83 2962,-24346.83 2962,-24278.74 2967.67,-24260.54 2954,-24193.83 2952.76,-24187.8 2950.92,-24181.52 2948.87,-24175.55"/>
<polygon fill="black" stroke="black" points="2952.05,-24174.07 2945.31,-24165.89 2945.49,-24176.49 2952.05,-24174.07"/>
</g>
<!-- mha_input_0 -->
<g id="node4" class="node">
<title>mha_input_0</title>
<polygon fill="yellow" stroke="black" points="2942.16,-24653.83 2703.29,-24653.83 2641.84,-24565.83 2880.71,-24565.83 2942.16,-24653.83"/>
<text text-anchor="middle" x="2792" y="-24619.03" font-family="Arial" font-size="11.00">MHA_Input_0</text>
<text text-anchor="middle" x="2792" y="-24607.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2792" y="-24595.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_0&#45;&gt;mha_input_0 -->
<g id="edge3" class="edge">
<title>pre_ln_0&#45;&gt;mha_input_0</title>
<path fill="none" stroke="black" d="M2823.2,-24695.64C2819.76,-24686.29 2815.55,-24674.85 2811.35,-24663.44"/>
<polygon fill="black" stroke="black" points="2814.58,-24662.08 2807.85,-24653.9 2808.01,-24664.49 2814.58,-24662.08"/>
</g>
<!-- qkv_proj_0_gpu0 -->
<g id="node5" class="node">
<title>qkv_proj_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2701.5,-24529.83 2478.5,-24529.83 2478.5,-24485.83 2701.5,-24485.83 2701.5,-24529.83"/>
<text text-anchor="middle" x="2590" y="-24517.03" font-family="Arial" font-size="11.00">QKV_Proj_0_GPU0</text>
<text text-anchor="middle" x="2590" y="-24505.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2590" y="-24493.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_0&#45;&gt;qkv_proj_0_gpu0 -->
<g id="edge4" class="edge">
<title>mha_input_0&#45;&gt;qkv_proj_0_gpu0</title>
<path fill="none" stroke="black" d="M2704.87,-24565.7C2683.3,-24555.02 2660.88,-24543.92 2641.63,-24534.39"/>
<polygon fill="black" stroke="black" points="2642.97,-24531.15 2632.45,-24529.85 2639.86,-24537.42 2642.97,-24531.15"/>
</g>
<!-- qkv_proj_0_gpu1 -->
<g id="node6" class="node">
<title>qkv_proj_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2942.5,-24529.83 2719.5,-24529.83 2719.5,-24485.83 2942.5,-24485.83 2942.5,-24529.83"/>
<text text-anchor="middle" x="2831" y="-24517.03" font-family="Arial" font-size="11.00">QKV_Proj_0_GPU1</text>
<text text-anchor="middle" x="2831" y="-24505.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2831" y="-24493.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_0&#45;&gt;qkv_proj_0_gpu1 -->
<g id="edge5" class="edge">
<title>mha_input_0&#45;&gt;qkv_proj_0_gpu1</title>
<path fill="none" stroke="black" d="M2808.88,-24565.55C2812.3,-24556.77 2815.84,-24547.71 2819.05,-24539.47"/>
<polygon fill="black" stroke="black" points="2822.41,-24540.5 2822.78,-24529.91 2815.88,-24537.96 2822.41,-24540.5"/>
</g>
<!-- attn_0_gpu0 -->
<g id="node7" class="node">
<title>attn_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2671.5,-24449.83 2538.5,-24449.83 2538.5,-24405.83 2671.5,-24405.83 2671.5,-24449.83"/>
<text text-anchor="middle" x="2605" y="-24437.03" font-family="Arial" font-size="11.00">Attention_0_GPU0</text>
<text text-anchor="middle" x="2605" y="-24425.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2605" y="-24413.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_0_gpu0&#45;&gt;attn_0_gpu0 -->
<g id="edge6" class="edge">
<title>qkv_proj_0_gpu0&#45;&gt;attn_0_gpu0</title>
<path fill="none" stroke="black" d="M2594.1,-24485.52C2595.62,-24477.63 2597.37,-24468.52 2599.02,-24459.93"/>
<polygon fill="black" stroke="black" points="2602.51,-24460.33 2600.96,-24449.85 2595.63,-24459.01 2602.51,-24460.33"/>
</g>
<!-- attn_0_gpu1 -->
<g id="node8" class="node">
<title>attn_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2887.5,-24449.83 2754.5,-24449.83 2754.5,-24405.83 2887.5,-24405.83 2887.5,-24449.83"/>
<text text-anchor="middle" x="2821" y="-24437.03" font-family="Arial" font-size="11.00">Attention_0_GPU1</text>
<text text-anchor="middle" x="2821" y="-24425.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2821" y="-24413.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_0_gpu1&#45;&gt;attn_0_gpu1 -->
<g id="edge7" class="edge">
<title>qkv_proj_0_gpu1&#45;&gt;attn_0_gpu1</title>
<path fill="none" stroke="black" d="M2828.27,-24485.52C2827.26,-24477.63 2826.09,-24468.52 2824.99,-24459.93"/>
<polygon fill="black" stroke="black" points="2828.44,-24459.32 2823.69,-24449.85 2821.49,-24460.21 2828.44,-24459.32"/>
</g>
<!-- out_proj_0_gpu0 -->
<g id="node9" class="node">
<title>out_proj_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2706.5,-24369.83 2561.5,-24369.83 2561.5,-24325.83 2706.5,-24325.83 2706.5,-24369.83"/>
<text text-anchor="middle" x="2634" y="-24357.03" font-family="Arial" font-size="11.00">Output_Proj_0_GPU0</text>
<text text-anchor="middle" x="2634" y="-24345.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2634" y="-24333.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_0_gpu0&#45;&gt;out_proj_0_gpu0 -->
<g id="edge8" class="edge">
<title>attn_0_gpu0&#45;&gt;out_proj_0_gpu0</title>
<path fill="none" stroke="black" d="M2612.92,-24405.52C2615.92,-24397.46 2619.39,-24388.11 2622.65,-24379.37"/>
<polygon fill="black" stroke="black" points="2625.98,-24380.44 2626.19,-24369.85 2619.42,-24378 2625.98,-24380.44"/>
</g>
<!-- out_proj_0_gpu1 -->
<g id="node10" class="node">
<title>out_proj_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2883.5,-24369.83 2738.5,-24369.83 2738.5,-24325.83 2883.5,-24325.83 2883.5,-24369.83"/>
<text text-anchor="middle" x="2811" y="-24357.03" font-family="Arial" font-size="11.00">Output_Proj_0_GPU1</text>
<text text-anchor="middle" x="2811" y="-24345.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2811" y="-24333.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_0_gpu1&#45;&gt;out_proj_0_gpu1 -->
<g id="edge9" class="edge">
<title>attn_0_gpu1&#45;&gt;out_proj_0_gpu1</title>
<path fill="none" stroke="black" d="M2818.27,-24405.52C2817.26,-24397.63 2816.09,-24388.52 2814.99,-24379.93"/>
<polygon fill="black" stroke="black" points="2818.44,-24379.32 2813.69,-24369.85 2811.49,-24380.21 2818.44,-24379.32"/>
</g>
<!-- mha_merge_0 -->
<g id="node11" class="node">
<title>mha_merge_0</title>
<polygon fill="yellow" stroke="black" points="2942.16,-24289.83 2703.29,-24289.83 2641.84,-24201.83 2880.71,-24201.83 2942.16,-24289.83"/>
<text text-anchor="middle" x="2792" y="-24255.03" font-family="Arial" font-size="11.00">MHA_Merge_0</text>
<text text-anchor="middle" x="2792" y="-24243.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2792" y="-24231.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_0_gpu0&#45;&gt;mha_merge_0 -->
<g id="edge10" class="edge">
<title>out_proj_0_gpu0&#45;&gt;mha_merge_0</title>
<path fill="none" stroke="black" d="M2667.51,-24325.62C2681.47,-24316.79 2698.31,-24306.13 2715.02,-24295.55"/>
<polygon fill="black" stroke="black" points="2717.16,-24298.34 2723.74,-24290.03 2713.42,-24292.42 2717.16,-24298.34"/>
</g>
<!-- out_proj_0_gpu1&#45;&gt;mha_merge_0 -->
<g id="edge11" class="edge">
<title>out_proj_0_gpu1&#45;&gt;mha_merge_0</title>
<path fill="none" stroke="black" d="M2806.97,-24325.62C2805.53,-24318.05 2803.84,-24309.13 2802.12,-24300.07"/>
<polygon fill="black" stroke="black" points="2805.55,-24299.41 2800.25,-24290.24 2798.68,-24300.72 2805.55,-24299.41"/>
</g>
<!-- mha_merge_0&#45;&gt;add_1_0 -->
<g id="edge12" class="edge">
<title>mha_merge_0&#45;&gt;add_1_0</title>
<path fill="none" stroke="black" d="M2854.32,-24201.55C2868.91,-24191.42 2884.04,-24180.91 2897.26,-24171.74"/>
<polygon fill="black" stroke="black" points="2899.42,-24174.49 2905.64,-24165.91 2895.43,-24168.74 2899.42,-24174.49"/>
</g>
<!-- post_ln_0 -->
<g id="node13" class="node">
<title>post_ln_0</title>
<polygon fill="lightgreen" stroke="black" points="2952.5,-24085.83 2807.5,-24085.83 2807.5,-24041.83 2952.5,-24041.83 2952.5,-24085.83"/>
<text text-anchor="middle" x="2880" y="-24073.03" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_0</text>
<text text-anchor="middle" x="2880" y="-24061.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2880" y="-24049.03" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_0&#45;&gt;post_ln_0 -->
<g id="edge14" class="edge">
<title>add_1_0&#45;&gt;post_ln_0</title>
<path fill="none" stroke="black" d="M2920.7,-24121.52C2914.66,-24113.11 2907.62,-24103.31 2901.12,-24094.24"/>
<polygon fill="black" stroke="black" points="2903.77,-24091.93 2895.09,-24085.85 2898.08,-24096.01 2903.77,-24091.93"/>
</g>
<!-- add_2_0 -->
<g id="node35" class="node">
<title>add_2_0</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-23291.61 2828.5,-23291.61 2828.5,-23247.61 3067.5,-23247.61 3067.5,-23291.61"/>
<text text-anchor="middle" x="2948" y="-23278.81" font-family="Arial" font-size="11.00">Residual_Add2_0</text>
<text text-anchor="middle" x="2948" y="-23266.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-23254.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_0&#45;&gt;add_2_0 -->
<g id="edge23" class="edge">
<title>add_1_0&#45;&gt;add_2_0</title>
<path fill="none" stroke="black" d="M2974.97,-24121.71C3022.62,-24092.72 3097,-24035.78 3097,-23962.83 3097,-23962.83 3097,-23962.83 3097,-23494.61 3097,-23416.8 3138.2,-23382.22 3092,-23319.61 3085.15,-23310.32 3076.44,-23302.78 3066.71,-23296.65"/>
<polygon fill="black" stroke="black" points="3068.33,-23293.55 3057.91,-23291.63 3064.86,-23299.63 3068.33,-23293.55"/>
</g>
<!-- gate_0 -->
<g id="node14" class="node">
<title>gate_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-24005.83 2742.05,-24005.83 2655.5,-23917.83 2991.95,-23917.83 3078.5,-24005.83"/>
<text text-anchor="middle" x="2867" y="-23971.03" font-family="Arial" font-size="11.00">Expert_Gate_0</text>
<text text-anchor="middle" x="2867" y="-23959.03" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-23947.03" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_0&#45;&gt;gate_0 -->
<g id="edge15" class="edge">
<title>post_ln_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M2877.24,-24041.62C2876.27,-24034.13 2875.12,-24025.32 2873.96,-24016.36"/>
<polygon fill="black" stroke="black" points="2877.4,-24015.7 2872.64,-24006.24 2870.46,-24016.61 2877.4,-24015.7"/>
</g>
<!-- token_dist_0 -->
<g id="node15" class="node">
<title>token_dist_0</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-23850.72" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-23859.92" font-family="Arial" font-size="11.00">Token_Distribution_0</text>
<text text-anchor="middle" x="2881" y="-23847.92" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-23835.92" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_0&#45;&gt;token_dist_0 -->
<g id="edge16" class="edge">
<title>gate_0&#45;&gt;token_dist_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-23917.71C2873.61,-23909.33 2874.73,-23900.58 2875.79,-23892.29"/>
<polygon fill="red" stroke="red" points="2879.3,-23892.46 2877.1,-23882.09 2872.36,-23891.57 2879.3,-23892.46"/>
</g>
<!-- expert_0_0_gpu0 -->
<g id="node16" class="node">
<title>expert_0_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-23721.61 2820,-23721.61 2820,-23677.61 2942,-23677.61 2942,-23721.61"/>
<text text-anchor="middle" x="2881" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_0&#45;&gt;expert_0_0_gpu0 -->
<g id="edge17" class="edge">
<title>token_dist_0&#45;&gt;expert_0_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-23819.54C2881,-23793.96 2881,-23757.43 2881,-23731.61"/>
<polygon fill="black" stroke="black" points="2884.5,-23731.61 2881,-23721.61 2877.5,-23731.61 2884.5,-23731.61"/>
</g>
<!-- expert_0_0_gpu1 -->
<g id="node17" class="node">
<title>expert_0_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-23619.61 2885,-23619.61 2885,-23575.61 3007,-23575.61 3007,-23619.61"/>
<text text-anchor="middle" x="2946" y="-23606.81" font-family="Arial" font-size="11.00">Expert_0_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-23594.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-23582.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_0&#45;&gt;expert_0_0_gpu1 -->
<g id="edge18" class="edge">
<title>token_dist_0&#45;&gt;expert_0_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-23822.28C2945.77,-23819.08 2948.67,-23815.53 2951,-23811.61 2984.76,-23754.79 2968.96,-23673.52 2956.33,-23629.61"/>
<polygon fill="black" stroke="black" points="2959.62,-23628.37 2953.38,-23619.81 2952.91,-23630.39 2959.62,-23628.37"/>
</g>
<!-- expert_0_0_gpu0&#45;&gt;expert_0_0_gpu1 -->
<g id="edge19" class="edge">
<title>expert_0_0_gpu0&#45;&gt;expert_0_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-23677.4C2904.09,-23663.08 2916.51,-23643.98 2926.78,-23628.18"/>
<polygon fill="black" stroke="black" points="2929.72,-23630.08 2932.24,-23619.78 2923.85,-23626.26 2929.72,-23630.08"/>
</g>
<!-- expert_merge_0_0 -->
<g id="node18" class="node">
<title>expert_merge_0_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-23539.61 2871.29,-23539.61 2819.53,-23451.61 3020.71,-23451.61 3072.47,-23539.61"/>
<text text-anchor="middle" x="2946" y="-23504.81" font-family="Arial" font-size="11.00">Expert_Merge_0_0</text>
<text text-anchor="middle" x="2946" y="-23492.81" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-23480.81" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_0_0_gpu1&#45;&gt;expert_merge_0_0 -->
<g id="edge20" class="edge">
<title>expert_0_0_gpu1&#45;&gt;expert_merge_0_0</title>
<path fill="none" stroke="black" d="M2946,-23575.4C2946,-23567.9 2946,-23559.09 2946,-23550.13"/>
<polygon fill="black" stroke="black" points="2949.5,-23550.01 2946,-23540.01 2942.5,-23550.01 2949.5,-23550.01"/>
</g>
<!-- expert_agg_0 -->
<g id="node34" class="node">
<title>expert_agg_0</title>
<polygon fill="yellow" stroke="black" points="3077.82,-23415.61 2823.58,-23415.61 2758.18,-23327.61 3012.42,-23327.61 3077.82,-23415.61"/>
<text text-anchor="middle" x="2918" y="-23380.81" font-family="Arial" font-size="11.00">Expert_Aggregation_0</text>
<text text-anchor="middle" x="2918" y="-23368.81" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-23356.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge21" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="black" d="M2936.13,-23451.59C2934.2,-23443.21 2932.17,-23434.33 2930.18,-23425.67"/>
<polygon fill="black" stroke="black" points="2933.53,-23424.61 2927.88,-23415.64 2926.7,-23426.17 2933.53,-23424.61"/>
</g>
<!-- expert_0_1_gpu0 -->
<g id="node19" class="node">
<title>expert_0_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-23721.61 2674,-23721.61 2674,-23677.61 2796,-23677.61 2796,-23721.61"/>
<text text-anchor="middle" x="2735" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_1_gpu1 -->
<g id="node20" class="node">
<title>expert_0_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-23721.61 2534,-23721.61 2534,-23677.61 2656,-23677.61 2656,-23721.61"/>
<text text-anchor="middle" x="2595" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_1 -->
<g id="node21" class="node">
<title>expert_merge_0_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-23743.61 2315.29,-23743.61 2263.53,-23655.61 2464.71,-23655.61 2516.47,-23743.61"/>
<text text-anchor="middle" x="2390" y="-23708.81" font-family="Arial" font-size="11.00">Expert_Merge_0_1</text>
<text text-anchor="middle" x="2390" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_0_2_gpu0 -->
<g id="node22" class="node">
<title>expert_0_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-23721.61 2118,-23721.61 2118,-23677.61 2240,-23677.61 2240,-23721.61"/>
<text text-anchor="middle" x="2179" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_2_gpu1 -->
<g id="node23" class="node">
<title>expert_0_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-23721.61 1978,-23721.61 1978,-23677.61 2100,-23677.61 2100,-23721.61"/>
<text text-anchor="middle" x="2039" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_2 -->
<g id="node24" class="node">
<title>expert_merge_0_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-23743.61 1759.29,-23743.61 1707.53,-23655.61 1908.71,-23655.61 1960.47,-23743.61"/>
<text text-anchor="middle" x="1834" y="-23708.81" font-family="Arial" font-size="11.00">Expert_Merge_0_2</text>
<text text-anchor="middle" x="1834" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_0_61_gpu0 -->
<g id="node25" class="node">
<title>expert_0_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-23721.61 1562,-23721.61 1562,-23677.61 1684,-23677.61 1684,-23721.61"/>
<text text-anchor="middle" x="1623" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_61_gpu1 -->
<g id="node26" class="node">
<title>expert_0_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-23721.61 1422,-23721.61 1422,-23677.61 1544,-23677.61 1544,-23721.61"/>
<text text-anchor="middle" x="1483" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_61 -->
<g id="node27" class="node">
<title>expert_merge_0_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-23743.61 1203.29,-23743.61 1151.53,-23655.61 1352.71,-23655.61 1404.47,-23743.61"/>
<text text-anchor="middle" x="1278" y="-23708.81" font-family="Arial" font-size="11.00">Expert_Merge_0_61</text>
<text text-anchor="middle" x="1278" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_0_62_gpu0 -->
<g id="node28" class="node">
<title>expert_0_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-23721.61 1006,-23721.61 1006,-23677.61 1128,-23677.61 1128,-23721.61"/>
<text text-anchor="middle" x="1067" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_62_gpu1 -->
<g id="node29" class="node">
<title>expert_0_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-23721.61 866,-23721.61 866,-23677.61 988,-23677.61 988,-23721.61"/>
<text text-anchor="middle" x="927" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_62_GPU1</text>
<text text-anchor="middle" x="927" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_62 -->
<g id="node30" class="node">
<title>expert_merge_0_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-23743.61 647.29,-23743.61 595.53,-23655.61 796.71,-23655.61 848.47,-23743.61"/>
<text text-anchor="middle" x="722" y="-23708.81" font-family="Arial" font-size="11.00">Expert_Merge_0_62</text>
<text text-anchor="middle" x="722" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_0_63_gpu0 -->
<g id="node31" class="node">
<title>expert_0_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-23721.61 450,-23721.61 450,-23677.61 572,-23677.61 572,-23721.61"/>
<text text-anchor="middle" x="511" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_63_GPU0</text>
<text text-anchor="middle" x="511" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_63_gpu1 -->
<g id="node32" class="node">
<title>expert_0_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-23721.61 310,-23721.61 310,-23677.61 432,-23677.61 432,-23721.61"/>
<text text-anchor="middle" x="371" y="-23708.81" font-family="Arial" font-size="11.00">Expert_0_63_GPU1</text>
<text text-anchor="middle" x="371" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_63 -->
<g id="node33" class="node">
<title>expert_merge_0_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-23743.61 91.29,-23743.61 39.53,-23655.61 240.71,-23655.61 292.47,-23743.61"/>
<text text-anchor="middle" x="166" y="-23708.81" font-family="Arial" font-size="11.00">Expert_Merge_0_63</text>
<text text-anchor="middle" x="166" y="-23696.81" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-23684.81" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_0&#45;&gt;add_2_0 -->
<g id="edge22" class="edge">
<title>expert_agg_0&#45;&gt;add_2_0</title>
<path fill="none" stroke="black" d="M2930.98,-23327.33C2933.59,-23318.64 2936.28,-23309.68 2938.73,-23301.52"/>
<polygon fill="black" stroke="black" points="2942.15,-23302.27 2941.68,-23291.69 2935.45,-23300.26 2942.15,-23302.27"/>
</g>
<!-- pre_ln_1 -->
<g id="node36" class="node">
<title>pre_ln_1</title>
<polygon fill="lightgreen" stroke="black" points="3005.5,-23197.61 2860.5,-23197.61 2860.5,-23153.61 3005.5,-23153.61 3005.5,-23197.61"/>
<text text-anchor="middle" x="2933" y="-23184.81" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_1</text>
<text text-anchor="middle" x="2933" y="-23172.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-23160.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_0&#45;&gt;pre_ln_1 -->
<g id="edge24" class="edge">
<title>add_2_0&#45;&gt;pre_ln_1</title>
<path fill="none" stroke="black" d="M2944.52,-23247.27C2942.61,-23235.54 2940.2,-23220.78 2938.08,-23207.78"/>
<polygon fill="black" stroke="black" points="2941.52,-23207.13 2936.46,-23197.83 2934.62,-23208.26 2941.52,-23207.13"/>
</g>
<!-- add_1_1 -->
<g id="node45" class="node">
<title>add_1_1</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-22623.61 2831.5,-22623.61 2831.5,-22579.61 3070.5,-22579.61 3070.5,-22623.61"/>
<text text-anchor="middle" x="2951" y="-22610.81" font-family="Arial" font-size="11.00">Residual_Add1_1</text>
<text text-anchor="middle" x="2951" y="-22598.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-22586.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_0&#45;&gt;add_1_1 -->
<g id="edge35" class="edge">
<title>add_2_0&#45;&gt;add_1_1</title>
<path fill="none" stroke="black" d="M2995.38,-23247.4C3002.51,-23242.87 3009.35,-23237.6 3015,-23231.61 3066.87,-23176.54 3064,-23144.25 3064,-23068.61 3064,-23068.61 3064,-23068.61 3064,-22804.61 3064,-22736.51 3094.07,-22708.07 3056,-22651.61 3049.84,-22642.48 3041.52,-22635.01 3032.24,-22628.91"/>
<polygon fill="black" stroke="black" points="3033.86,-22625.8 3023.47,-22623.69 3030.27,-22631.82 3033.86,-22625.8"/>
</g>
<!-- mha_input_1 -->
<g id="node37" class="node">
<title>mha_input_1</title>
<polygon fill="yellow" stroke="black" points="3044.16,-23111.61 2805.29,-23111.61 2743.84,-23023.61 2982.71,-23023.61 3044.16,-23111.61"/>
<text text-anchor="middle" x="2894" y="-23076.81" font-family="Arial" font-size="11.00">MHA_Input_1</text>
<text text-anchor="middle" x="2894" y="-23064.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2894" y="-23052.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_1&#45;&gt;mha_input_1 -->
<g id="edge25" class="edge">
<title>pre_ln_1&#45;&gt;mha_input_1</title>
<path fill="none" stroke="black" d="M2925.2,-23153.41C2921.76,-23144.06 2917.55,-23132.63 2913.35,-23121.21"/>
<polygon fill="black" stroke="black" points="2916.58,-23119.85 2909.85,-23111.67 2910.01,-23122.27 2916.58,-23119.85"/>
</g>
<!-- qkv_proj_1_gpu0 -->
<g id="node38" class="node">
<title>qkv_proj_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-22987.61 2580.5,-22987.61 2580.5,-22943.61 2803.5,-22943.61 2803.5,-22987.61"/>
<text text-anchor="middle" x="2692" y="-22974.81" font-family="Arial" font-size="11.00">QKV_Proj_1_GPU0</text>
<text text-anchor="middle" x="2692" y="-22962.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2692" y="-22950.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_1&#45;&gt;qkv_proj_1_gpu0 -->
<g id="edge26" class="edge">
<title>mha_input_1&#45;&gt;qkv_proj_1_gpu0</title>
<path fill="none" stroke="black" d="M2806.87,-23023.47C2785.3,-23012.8 2762.88,-23001.7 2743.63,-22992.17"/>
<polygon fill="black" stroke="black" points="2744.97,-22988.92 2734.45,-22987.62 2741.86,-22995.2 2744.97,-22988.92"/>
</g>
<!-- qkv_proj_1_gpu1 -->
<g id="node39" class="node">
<title>qkv_proj_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3044.5,-22987.61 2821.5,-22987.61 2821.5,-22943.61 3044.5,-22943.61 3044.5,-22987.61"/>
<text text-anchor="middle" x="2933" y="-22974.81" font-family="Arial" font-size="11.00">QKV_Proj_1_GPU1</text>
<text text-anchor="middle" x="2933" y="-22962.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-22950.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_1&#45;&gt;qkv_proj_1_gpu1 -->
<g id="edge27" class="edge">
<title>mha_input_1&#45;&gt;qkv_proj_1_gpu1</title>
<path fill="none" stroke="black" d="M2910.88,-23023.33C2914.3,-23014.55 2917.84,-23005.48 2921.05,-22997.25"/>
<polygon fill="black" stroke="black" points="2924.41,-22998.28 2924.78,-22987.69 2917.88,-22995.73 2924.41,-22998.28"/>
</g>
<!-- attn_1_gpu0 -->
<g id="node40" class="node">
<title>attn_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2787.5,-22907.61 2654.5,-22907.61 2654.5,-22863.61 2787.5,-22863.61 2787.5,-22907.61"/>
<text text-anchor="middle" x="2721" y="-22894.81" font-family="Arial" font-size="11.00">Attention_1_GPU0</text>
<text text-anchor="middle" x="2721" y="-22882.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2721" y="-22870.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_1_gpu0&#45;&gt;attn_1_gpu0 -->
<g id="edge28" class="edge">
<title>qkv_proj_1_gpu0&#45;&gt;attn_1_gpu0</title>
<path fill="none" stroke="black" d="M2699.92,-22943.29C2702.92,-22935.23 2706.39,-22925.89 2709.65,-22917.14"/>
<polygon fill="black" stroke="black" points="2712.98,-22918.22 2713.19,-22907.62 2706.42,-22915.78 2712.98,-22918.22"/>
</g>
<!-- attn_1_gpu1 -->
<g id="node41" class="node">
<title>attn_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-22907.61 2856.5,-22907.61 2856.5,-22863.61 2989.5,-22863.61 2989.5,-22907.61"/>
<text text-anchor="middle" x="2923" y="-22894.81" font-family="Arial" font-size="11.00">Attention_1_GPU1</text>
<text text-anchor="middle" x="2923" y="-22882.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2923" y="-22870.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_1_gpu1&#45;&gt;attn_1_gpu1 -->
<g id="edge29" class="edge">
<title>qkv_proj_1_gpu1&#45;&gt;attn_1_gpu1</title>
<path fill="none" stroke="black" d="M2930.27,-22943.29C2929.26,-22935.4 2928.09,-22926.29 2926.99,-22917.71"/>
<polygon fill="black" stroke="black" points="2930.44,-22917.1 2925.69,-22907.62 2923.49,-22917.99 2930.44,-22917.1"/>
</g>
<!-- out_proj_1_gpu0 -->
<g id="node42" class="node">
<title>out_proj_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2812.5,-22827.61 2667.5,-22827.61 2667.5,-22783.61 2812.5,-22783.61 2812.5,-22827.61"/>
<text text-anchor="middle" x="2740" y="-22814.81" font-family="Arial" font-size="11.00">Output_Proj_1_GPU0</text>
<text text-anchor="middle" x="2740" y="-22802.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2740" y="-22790.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_1_gpu0&#45;&gt;out_proj_1_gpu0 -->
<g id="edge30" class="edge">
<title>attn_1_gpu0&#45;&gt;out_proj_1_gpu0</title>
<path fill="none" stroke="black" d="M2726.19,-22863.29C2728.13,-22855.32 2730.38,-22846.09 2732.49,-22837.43"/>
<polygon fill="black" stroke="black" points="2735.91,-22838.17 2734.88,-22827.62 2729.11,-22836.51 2735.91,-22838.17"/>
</g>
<!-- out_proj_1_gpu1 -->
<g id="node43" class="node">
<title>out_proj_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2985.5,-22827.61 2840.5,-22827.61 2840.5,-22783.61 2985.5,-22783.61 2985.5,-22827.61"/>
<text text-anchor="middle" x="2913" y="-22814.81" font-family="Arial" font-size="11.00">Output_Proj_1_GPU1</text>
<text text-anchor="middle" x="2913" y="-22802.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2913" y="-22790.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_1_gpu1&#45;&gt;out_proj_1_gpu1 -->
<g id="edge31" class="edge">
<title>attn_1_gpu1&#45;&gt;out_proj_1_gpu1</title>
<path fill="none" stroke="black" d="M2920.27,-22863.29C2919.26,-22855.4 2918.09,-22846.29 2916.99,-22837.71"/>
<polygon fill="black" stroke="black" points="2920.44,-22837.1 2915.69,-22827.62 2913.49,-22837.99 2920.44,-22837.1"/>
</g>
<!-- mha_merge_1 -->
<g id="node44" class="node">
<title>mha_merge_1</title>
<polygon fill="yellow" stroke="black" points="3044.16,-22747.61 2805.29,-22747.61 2743.84,-22659.61 2982.71,-22659.61 3044.16,-22747.61"/>
<text text-anchor="middle" x="2894" y="-22712.81" font-family="Arial" font-size="11.00">MHA_Merge_1</text>
<text text-anchor="middle" x="2894" y="-22700.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2894" y="-22688.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_1_gpu0&#45;&gt;mha_merge_1 -->
<g id="edge32" class="edge">
<title>out_proj_1_gpu0&#45;&gt;mha_merge_1</title>
<path fill="none" stroke="black" d="M2772.66,-22783.4C2786.27,-22774.56 2802.68,-22763.91 2818.97,-22753.32"/>
<polygon fill="black" stroke="black" points="2820.99,-22756.19 2827.47,-22747.81 2817.17,-22750.32 2820.99,-22756.19"/>
</g>
<!-- out_proj_1_gpu1&#45;&gt;mha_merge_1 -->
<g id="edge33" class="edge">
<title>out_proj_1_gpu1&#45;&gt;mha_merge_1</title>
<path fill="none" stroke="black" d="M2908.97,-22783.4C2907.53,-22775.82 2905.84,-22766.9 2904.12,-22757.84"/>
<polygon fill="black" stroke="black" points="2907.55,-22757.18 2902.25,-22748.01 2900.68,-22758.49 2907.55,-22757.18"/>
</g>
<!-- mha_merge_1&#45;&gt;add_1_1 -->
<g id="edge34" class="edge">
<title>mha_merge_1&#45;&gt;add_1_1</title>
<path fill="none" stroke="black" d="M2918.67,-22659.33C2923.84,-22650.26 2929.18,-22640.88 2934,-22632.44"/>
<polygon fill="black" stroke="black" points="2937.07,-22634.11 2938.98,-22623.69 2930.99,-22630.64 2937.07,-22634.11"/>
</g>
<!-- post_ln_1 -->
<g id="node46" class="node">
<title>post_ln_1</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-22543.61 2822.5,-22543.61 2822.5,-22499.61 2967.5,-22499.61 2967.5,-22543.61"/>
<text text-anchor="middle" x="2895" y="-22530.81" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_1</text>
<text text-anchor="middle" x="2895" y="-22518.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-22506.81" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_1&#45;&gt;post_ln_1 -->
<g id="edge36" class="edge">
<title>add_1_1&#45;&gt;post_ln_1</title>
<path fill="none" stroke="black" d="M2935.7,-22579.29C2929.66,-22570.88 2922.62,-22561.08 2916.12,-22552.02"/>
<polygon fill="black" stroke="black" points="2918.77,-22549.71 2910.09,-22543.62 2913.08,-22553.79 2918.77,-22549.71"/>
</g>
<!-- add_2_1 -->
<g id="node68" class="node">
<title>add_2_1</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-21749.38 2828.5,-21749.38 2828.5,-21705.38 3067.5,-21705.38 3067.5,-21749.38"/>
<text text-anchor="middle" x="2948" y="-21736.58" font-family="Arial" font-size="11.00">Residual_Add2_1</text>
<text text-anchor="middle" x="2948" y="-21724.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-21712.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_1&#45;&gt;add_2_1 -->
<g id="edge45" class="edge">
<title>add_1_1&#45;&gt;add_2_1</title>
<path fill="none" stroke="black" d="M2984.86,-22579.61C3027.99,-22549.95 3097,-22491.42 3097,-22420.61 3097,-22420.61 3097,-22420.61 3097,-21952.38 3097,-21874.57 3138.2,-21839.99 3092,-21777.38 3085.15,-21768.1 3076.44,-21760.55 3066.71,-21754.43"/>
<polygon fill="black" stroke="black" points="3068.33,-21751.32 3057.91,-21749.4 3064.86,-21757.4 3068.33,-21751.32"/>
</g>
<!-- gate_1 -->
<g id="node47" class="node">
<title>gate_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-22463.61 2742.05,-22463.61 2655.5,-22375.61 2991.95,-22375.61 3078.5,-22463.61"/>
<text text-anchor="middle" x="2867" y="-22428.81" font-family="Arial" font-size="11.00">Expert_Gate_1</text>
<text text-anchor="middle" x="2867" y="-22416.81" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-22404.81" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_1&#45;&gt;gate_1 -->
<g id="edge37" class="edge">
<title>post_ln_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M2889.06,-22499.4C2886.94,-22491.82 2884.44,-22482.9 2881.91,-22473.84"/>
<polygon fill="black" stroke="black" points="2885.22,-22472.7 2879.15,-22464.01 2878.48,-22474.59 2885.22,-22472.7"/>
</g>
<!-- token_dist_1 -->
<g id="node48" class="node">
<title>token_dist_1</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-22308.49" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-22317.69" font-family="Arial" font-size="11.00">Token_Distribution_1</text>
<text text-anchor="middle" x="2881" y="-22305.69" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-22293.69" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_1&#45;&gt;token_dist_1 -->
<g id="edge38" class="edge">
<title>gate_1&#45;&gt;token_dist_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-22375.48C2873.61,-22367.11 2874.73,-22358.35 2875.79,-22350.06"/>
<polygon fill="red" stroke="red" points="2879.3,-22350.23 2877.1,-22339.87 2872.36,-22349.34 2879.3,-22350.23"/>
</g>
<!-- expert_1_0_gpu0 -->
<g id="node49" class="node">
<title>expert_1_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-22179.38 2820,-22179.38 2820,-22135.38 2942,-22135.38 2942,-22179.38"/>
<text text-anchor="middle" x="2881" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_1&#45;&gt;expert_1_0_gpu0 -->
<g id="edge39" class="edge">
<title>token_dist_1&#45;&gt;expert_1_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-22277.32C2881,-22251.74 2881,-22215.2 2881,-22189.39"/>
<polygon fill="black" stroke="black" points="2884.5,-22189.38 2881,-22179.38 2877.5,-22189.38 2884.5,-22189.38"/>
</g>
<!-- expert_1_0_gpu1 -->
<g id="node50" class="node">
<title>expert_1_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-22077.38 2885,-22077.38 2885,-22033.38 3007,-22033.38 3007,-22077.38"/>
<text text-anchor="middle" x="2946" y="-22064.58" font-family="Arial" font-size="11.00">Expert_1_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-22052.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-22040.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_1&#45;&gt;expert_1_0_gpu1 -->
<g id="edge40" class="edge">
<title>token_dist_1&#45;&gt;expert_1_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-22280.05C2945.77,-22276.85 2948.67,-22273.31 2951,-22269.38 2984.76,-22212.56 2968.96,-22131.3 2956.33,-22087.39"/>
<polygon fill="black" stroke="black" points="2959.62,-22086.15 2953.38,-22077.58 2952.91,-22088.16 2959.62,-22086.15"/>
</g>
<!-- expert_1_0_gpu0&#45;&gt;expert_1_0_gpu1 -->
<g id="edge41" class="edge">
<title>expert_1_0_gpu0&#45;&gt;expert_1_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-22135.17C2904.09,-22120.85 2916.51,-22101.76 2926.78,-22085.95"/>
<polygon fill="black" stroke="black" points="2929.72,-22087.85 2932.24,-22077.56 2923.85,-22084.03 2929.72,-22087.85"/>
</g>
<!-- expert_merge_1_0 -->
<g id="node51" class="node">
<title>expert_merge_1_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-21997.38 2871.29,-21997.38 2819.53,-21909.38 3020.71,-21909.38 3072.47,-21997.38"/>
<text text-anchor="middle" x="2946" y="-21962.58" font-family="Arial" font-size="11.00">Expert_Merge_1_0</text>
<text text-anchor="middle" x="2946" y="-21950.58" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-21938.58" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_1_0_gpu1&#45;&gt;expert_merge_1_0 -->
<g id="edge42" class="edge">
<title>expert_1_0_gpu1&#45;&gt;expert_merge_1_0</title>
<path fill="none" stroke="black" d="M2946,-22033.17C2946,-22025.68 2946,-22016.87 2946,-22007.91"/>
<polygon fill="black" stroke="black" points="2949.5,-22007.79 2946,-21997.79 2942.5,-22007.79 2949.5,-22007.79"/>
</g>
<!-- expert_agg_1 -->
<g id="node67" class="node">
<title>expert_agg_1</title>
<polygon fill="yellow" stroke="black" points="3077.82,-21873.38 2823.58,-21873.38 2758.18,-21785.38 3012.42,-21785.38 3077.82,-21873.38"/>
<text text-anchor="middle" x="2918" y="-21838.58" font-family="Arial" font-size="11.00">Expert_Aggregation_1</text>
<text text-anchor="middle" x="2918" y="-21826.58" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-21814.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_1_0&#45;&gt;expert_agg_1 -->
<g id="edge43" class="edge">
<title>expert_merge_1_0&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2936.13,-21909.37C2934.2,-21900.99 2932.17,-21892.11 2930.18,-21883.44"/>
<polygon fill="black" stroke="black" points="2933.53,-21882.38 2927.88,-21873.42 2926.7,-21883.95 2933.53,-21882.38"/>
</g>
<!-- expert_1_1_gpu0 -->
<g id="node52" class="node">
<title>expert_1_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-22179.38 2674,-22179.38 2674,-22135.38 2796,-22135.38 2796,-22179.38"/>
<text text-anchor="middle" x="2735" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_1_gpu1 -->
<g id="node53" class="node">
<title>expert_1_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-22179.38 2534,-22179.38 2534,-22135.38 2656,-22135.38 2656,-22179.38"/>
<text text-anchor="middle" x="2595" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_1 -->
<g id="node54" class="node">
<title>expert_merge_1_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-22201.38 2315.29,-22201.38 2263.53,-22113.38 2464.71,-22113.38 2516.47,-22201.38"/>
<text text-anchor="middle" x="2390" y="-22166.58" font-family="Arial" font-size="11.00">Expert_Merge_1_1</text>
<text text-anchor="middle" x="2390" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_1_2_gpu0 -->
<g id="node55" class="node">
<title>expert_1_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-22179.38 2118,-22179.38 2118,-22135.38 2240,-22135.38 2240,-22179.38"/>
<text text-anchor="middle" x="2179" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_2_gpu1 -->
<g id="node56" class="node">
<title>expert_1_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-22179.38 1978,-22179.38 1978,-22135.38 2100,-22135.38 2100,-22179.38"/>
<text text-anchor="middle" x="2039" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_2 -->
<g id="node57" class="node">
<title>expert_merge_1_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-22201.38 1759.29,-22201.38 1707.53,-22113.38 1908.71,-22113.38 1960.47,-22201.38"/>
<text text-anchor="middle" x="1834" y="-22166.58" font-family="Arial" font-size="11.00">Expert_Merge_1_2</text>
<text text-anchor="middle" x="1834" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_1_61_gpu0 -->
<g id="node58" class="node">
<title>expert_1_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-22179.38 1562,-22179.38 1562,-22135.38 1684,-22135.38 1684,-22179.38"/>
<text text-anchor="middle" x="1623" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_61_gpu1 -->
<g id="node59" class="node">
<title>expert_1_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-22179.38 1422,-22179.38 1422,-22135.38 1544,-22135.38 1544,-22179.38"/>
<text text-anchor="middle" x="1483" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_61 -->
<g id="node60" class="node">
<title>expert_merge_1_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-22201.38 1203.29,-22201.38 1151.53,-22113.38 1352.71,-22113.38 1404.47,-22201.38"/>
<text text-anchor="middle" x="1278" y="-22166.58" font-family="Arial" font-size="11.00">Expert_Merge_1_61</text>
<text text-anchor="middle" x="1278" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_1_62_gpu0 -->
<g id="node61" class="node">
<title>expert_1_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-22179.38 1006,-22179.38 1006,-22135.38 1128,-22135.38 1128,-22179.38"/>
<text text-anchor="middle" x="1067" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_62_gpu1 -->
<g id="node62" class="node">
<title>expert_1_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-22179.38 866,-22179.38 866,-22135.38 988,-22135.38 988,-22179.38"/>
<text text-anchor="middle" x="927" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_62_GPU1</text>
<text text-anchor="middle" x="927" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_62 -->
<g id="node63" class="node">
<title>expert_merge_1_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-22201.38 647.29,-22201.38 595.53,-22113.38 796.71,-22113.38 848.47,-22201.38"/>
<text text-anchor="middle" x="722" y="-22166.58" font-family="Arial" font-size="11.00">Expert_Merge_1_62</text>
<text text-anchor="middle" x="722" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_1_63_gpu0 -->
<g id="node64" class="node">
<title>expert_1_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-22179.38 450,-22179.38 450,-22135.38 572,-22135.38 572,-22179.38"/>
<text text-anchor="middle" x="511" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_63_GPU0</text>
<text text-anchor="middle" x="511" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_63_gpu1 -->
<g id="node65" class="node">
<title>expert_1_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-22179.38 310,-22179.38 310,-22135.38 432,-22135.38 432,-22179.38"/>
<text text-anchor="middle" x="371" y="-22166.58" font-family="Arial" font-size="11.00">Expert_1_63_GPU1</text>
<text text-anchor="middle" x="371" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_63 -->
<g id="node66" class="node">
<title>expert_merge_1_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-22201.38 91.29,-22201.38 39.53,-22113.38 240.71,-22113.38 292.47,-22201.38"/>
<text text-anchor="middle" x="166" y="-22166.58" font-family="Arial" font-size="11.00">Expert_Merge_1_63</text>
<text text-anchor="middle" x="166" y="-22154.58" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-22142.58" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_1&#45;&gt;add_2_1 -->
<g id="edge44" class="edge">
<title>expert_agg_1&#45;&gt;add_2_1</title>
<path fill="none" stroke="black" d="M2930.98,-21785.1C2933.59,-21776.42 2936.28,-21767.46 2938.73,-21759.29"/>
<polygon fill="black" stroke="black" points="2942.15,-21760.05 2941.68,-21749.46 2935.45,-21758.04 2942.15,-21760.05"/>
</g>
<!-- pre_ln_2 -->
<g id="node69" class="node">
<title>pre_ln_2</title>
<polygon fill="lightgreen" stroke="black" points="2966.5,-21655.38 2821.5,-21655.38 2821.5,-21611.38 2966.5,-21611.38 2966.5,-21655.38"/>
<text text-anchor="middle" x="2894" y="-21642.58" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_2</text>
<text text-anchor="middle" x="2894" y="-21630.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2894" y="-21618.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_1&#45;&gt;pre_ln_2 -->
<g id="edge46" class="edge">
<title>add_2_1&#45;&gt;pre_ln_2</title>
<path fill="none" stroke="black" d="M2935.48,-21705.04C2928.39,-21692.97 2919.41,-21677.67 2911.62,-21664.4"/>
<polygon fill="black" stroke="black" points="2914.54,-21662.46 2906.46,-21655.6 2908.5,-21666 2914.54,-21662.46"/>
</g>
<!-- add_1_2 -->
<g id="node78" class="node">
<title>add_1_2</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-21081.38 2831.5,-21081.38 2831.5,-21037.38 3070.5,-21037.38 3070.5,-21081.38"/>
<text text-anchor="middle" x="2951" y="-21068.58" font-family="Arial" font-size="11.00">Residual_Add1_2</text>
<text text-anchor="middle" x="2951" y="-21056.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-21044.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_1&#45;&gt;add_1_2 -->
<g id="edge57" class="edge">
<title>add_2_1&#45;&gt;add_1_2</title>
<path fill="none" stroke="black" d="M2965.05,-21705.38C2968.86,-21700.28 2972.74,-21694.75 2976,-21689.38 3015.3,-21624.75 3025,-21602.03 3025,-21526.38 3025,-21526.38 3025,-21526.38 3025,-21262.38 3025,-21194.29 3049.18,-21169.39 3017,-21109.38 3012.59,-21101.16 3006.13,-21093.94 2998.96,-21087.75"/>
<polygon fill="black" stroke="black" points="3000.97,-21084.89 2990.95,-21081.44 2996.64,-21090.38 3000.97,-21084.89"/>
</g>
<!-- mha_input_2 -->
<g id="node70" class="node">
<title>mha_input_2</title>
<polygon fill="yellow" stroke="black" points="3005.16,-21569.38 2766.29,-21569.38 2704.84,-21481.38 2943.71,-21481.38 3005.16,-21569.38"/>
<text text-anchor="middle" x="2855" y="-21534.58" font-family="Arial" font-size="11.00">MHA_Input_2</text>
<text text-anchor="middle" x="2855" y="-21522.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-21510.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_2&#45;&gt;mha_input_2 -->
<g id="edge47" class="edge">
<title>pre_ln_2&#45;&gt;mha_input_2</title>
<path fill="none" stroke="black" d="M2886.2,-21611.19C2882.76,-21601.84 2878.55,-21590.4 2874.35,-21578.98"/>
<polygon fill="black" stroke="black" points="2877.58,-21577.63 2870.85,-21569.45 2871.01,-21580.04 2877.58,-21577.63"/>
</g>
<!-- qkv_proj_2_gpu0 -->
<g id="node71" class="node">
<title>qkv_proj_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2764.5,-21445.38 2541.5,-21445.38 2541.5,-21401.38 2764.5,-21401.38 2764.5,-21445.38"/>
<text text-anchor="middle" x="2653" y="-21432.58" font-family="Arial" font-size="11.00">QKV_Proj_2_GPU0</text>
<text text-anchor="middle" x="2653" y="-21420.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2653" y="-21408.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_2&#45;&gt;qkv_proj_2_gpu0 -->
<g id="edge48" class="edge">
<title>mha_input_2&#45;&gt;qkv_proj_2_gpu0</title>
<path fill="none" stroke="black" d="M2767.87,-21481.25C2746.3,-21470.57 2723.88,-21459.47 2704.63,-21449.94"/>
<polygon fill="black" stroke="black" points="2705.97,-21446.7 2695.45,-21445.4 2702.86,-21452.97 2705.97,-21446.7"/>
</g>
<!-- qkv_proj_2_gpu1 -->
<g id="node72" class="node">
<title>qkv_proj_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3005.5,-21445.38 2782.5,-21445.38 2782.5,-21401.38 3005.5,-21401.38 3005.5,-21445.38"/>
<text text-anchor="middle" x="2894" y="-21432.58" font-family="Arial" font-size="11.00">QKV_Proj_2_GPU1</text>
<text text-anchor="middle" x="2894" y="-21420.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2894" y="-21408.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_2&#45;&gt;qkv_proj_2_gpu1 -->
<g id="edge49" class="edge">
<title>mha_input_2&#45;&gt;qkv_proj_2_gpu1</title>
<path fill="none" stroke="black" d="M2871.88,-21481.1C2875.3,-21472.32 2878.84,-21463.26 2882.05,-21455.02"/>
<polygon fill="black" stroke="black" points="2885.41,-21456.05 2885.78,-21445.46 2878.88,-21453.51 2885.41,-21456.05"/>
</g>
<!-- attn_2_gpu0 -->
<g id="node73" class="node">
<title>attn_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2748.5,-21365.38 2615.5,-21365.38 2615.5,-21321.38 2748.5,-21321.38 2748.5,-21365.38"/>
<text text-anchor="middle" x="2682" y="-21352.58" font-family="Arial" font-size="11.00">Attention_2_GPU0</text>
<text text-anchor="middle" x="2682" y="-21340.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2682" y="-21328.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_2_gpu0&#45;&gt;attn_2_gpu0 -->
<g id="edge50" class="edge">
<title>qkv_proj_2_gpu0&#45;&gt;attn_2_gpu0</title>
<path fill="none" stroke="black" d="M2660.92,-21401.07C2663.92,-21393.01 2667.39,-21383.66 2670.65,-21374.92"/>
<polygon fill="black" stroke="black" points="2673.98,-21375.99 2674.19,-21365.4 2667.42,-21373.55 2673.98,-21375.99"/>
</g>
<!-- attn_2_gpu1 -->
<g id="node74" class="node">
<title>attn_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2950.5,-21365.38 2817.5,-21365.38 2817.5,-21321.38 2950.5,-21321.38 2950.5,-21365.38"/>
<text text-anchor="middle" x="2884" y="-21352.58" font-family="Arial" font-size="11.00">Attention_2_GPU1</text>
<text text-anchor="middle" x="2884" y="-21340.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2884" y="-21328.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_2_gpu1&#45;&gt;attn_2_gpu1 -->
<g id="edge51" class="edge">
<title>qkv_proj_2_gpu1&#45;&gt;attn_2_gpu1</title>
<path fill="none" stroke="black" d="M2891.27,-21401.07C2890.26,-21393.18 2889.09,-21384.06 2887.99,-21375.48"/>
<polygon fill="black" stroke="black" points="2891.44,-21374.87 2886.69,-21365.4 2884.49,-21375.76 2891.44,-21374.87"/>
</g>
<!-- out_proj_2_gpu0 -->
<g id="node75" class="node">
<title>out_proj_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2773.5,-21285.38 2628.5,-21285.38 2628.5,-21241.38 2773.5,-21241.38 2773.5,-21285.38"/>
<text text-anchor="middle" x="2701" y="-21272.58" font-family="Arial" font-size="11.00">Output_Proj_2_GPU0</text>
<text text-anchor="middle" x="2701" y="-21260.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2701" y="-21248.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_2_gpu0&#45;&gt;out_proj_2_gpu0 -->
<g id="edge52" class="edge">
<title>attn_2_gpu0&#45;&gt;out_proj_2_gpu0</title>
<path fill="none" stroke="black" d="M2687.19,-21321.07C2689.13,-21313.09 2691.38,-21303.86 2693.49,-21295.2"/>
<polygon fill="black" stroke="black" points="2696.91,-21295.94 2695.88,-21285.4 2690.11,-21294.29 2696.91,-21295.94"/>
</g>
<!-- out_proj_2_gpu1 -->
<g id="node76" class="node">
<title>out_proj_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2946.5,-21285.38 2801.5,-21285.38 2801.5,-21241.38 2946.5,-21241.38 2946.5,-21285.38"/>
<text text-anchor="middle" x="2874" y="-21272.58" font-family="Arial" font-size="11.00">Output_Proj_2_GPU1</text>
<text text-anchor="middle" x="2874" y="-21260.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2874" y="-21248.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_2_gpu1&#45;&gt;out_proj_2_gpu1 -->
<g id="edge53" class="edge">
<title>attn_2_gpu1&#45;&gt;out_proj_2_gpu1</title>
<path fill="none" stroke="black" d="M2881.27,-21321.07C2880.26,-21313.18 2879.09,-21304.06 2877.99,-21295.48"/>
<polygon fill="black" stroke="black" points="2881.44,-21294.87 2876.69,-21285.4 2874.49,-21295.76 2881.44,-21294.87"/>
</g>
<!-- mha_merge_2 -->
<g id="node77" class="node">
<title>mha_merge_2</title>
<polygon fill="yellow" stroke="black" points="3005.16,-21205.38 2766.29,-21205.38 2704.84,-21117.38 2943.71,-21117.38 3005.16,-21205.38"/>
<text text-anchor="middle" x="2855" y="-21170.58" font-family="Arial" font-size="11.00">MHA_Merge_2</text>
<text text-anchor="middle" x="2855" y="-21158.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2855" y="-21146.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_2_gpu0&#45;&gt;mha_merge_2 -->
<g id="edge54" class="edge">
<title>out_proj_2_gpu0&#45;&gt;mha_merge_2</title>
<path fill="none" stroke="black" d="M2733.66,-21241.17C2747.27,-21232.34 2763.68,-21221.68 2779.97,-21211.1"/>
<polygon fill="black" stroke="black" points="2781.99,-21213.97 2788.47,-21205.58 2778.17,-21208.09 2781.99,-21213.97"/>
</g>
<!-- out_proj_2_gpu1&#45;&gt;mha_merge_2 -->
<g id="edge55" class="edge">
<title>out_proj_2_gpu1&#45;&gt;mha_merge_2</title>
<path fill="none" stroke="black" d="M2869.97,-21241.17C2868.53,-21233.59 2866.84,-21224.68 2865.12,-21215.62"/>
<polygon fill="black" stroke="black" points="2868.55,-21214.96 2863.25,-21205.79 2861.68,-21216.27 2868.55,-21214.96"/>
</g>
<!-- mha_merge_2&#45;&gt;add_1_2 -->
<g id="edge56" class="edge">
<title>mha_merge_2&#45;&gt;add_1_2</title>
<path fill="none" stroke="black" d="M2896.55,-21117.1C2905.72,-21107.55 2915.21,-21097.66 2923.65,-21088.87"/>
<polygon fill="black" stroke="black" points="2926.36,-21091.1 2930.76,-21081.46 2921.31,-21086.25 2926.36,-21091.1"/>
</g>
<!-- post_ln_2 -->
<g id="node79" class="node">
<title>post_ln_2</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-21001.38 2822.5,-21001.38 2822.5,-20957.38 2967.5,-20957.38 2967.5,-21001.38"/>
<text text-anchor="middle" x="2895" y="-20988.58" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_2</text>
<text text-anchor="middle" x="2895" y="-20976.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-20964.58" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_2&#45;&gt;post_ln_2 -->
<g id="edge58" class="edge">
<title>add_1_2&#45;&gt;post_ln_2</title>
<path fill="none" stroke="black" d="M2935.7,-21037.07C2929.66,-21028.66 2922.62,-21018.86 2916.12,-21009.79"/>
<polygon fill="black" stroke="black" points="2918.77,-21007.48 2910.09,-21001.4 2913.08,-21011.56 2918.77,-21007.48"/>
</g>
<!-- add_2_2 -->
<g id="node101" class="node">
<title>add_2_2</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-20207.16 2828.5,-20207.16 2828.5,-20163.16 3067.5,-20163.16 3067.5,-20207.16"/>
<text text-anchor="middle" x="2948" y="-20194.36" font-family="Arial" font-size="11.00">Residual_Add2_2</text>
<text text-anchor="middle" x="2948" y="-20182.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-20170.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_2&#45;&gt;add_2_2 -->
<g id="edge67" class="edge">
<title>add_1_2&#45;&gt;add_2_2</title>
<path fill="none" stroke="black" d="M2984.86,-21037.38C3027.99,-21007.72 3097,-20949.2 3097,-20878.38 3097,-20878.38 3097,-20878.38 3097,-20410.16 3097,-20332.35 3138.2,-20297.77 3092,-20235.16 3085.15,-20225.87 3076.44,-20218.33 3066.71,-20212.2"/>
<polygon fill="black" stroke="black" points="3068.33,-20209.1 3057.91,-20207.18 3064.86,-20215.18 3068.33,-20209.1"/>
</g>
<!-- gate_2 -->
<g id="node80" class="node">
<title>gate_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-20921.38 2742.05,-20921.38 2655.5,-20833.38 2991.95,-20833.38 3078.5,-20921.38"/>
<text text-anchor="middle" x="2867" y="-20886.58" font-family="Arial" font-size="11.00">Expert_Gate_2</text>
<text text-anchor="middle" x="2867" y="-20874.58" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-20862.58" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_2&#45;&gt;gate_2 -->
<g id="edge59" class="edge">
<title>post_ln_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M2889.06,-20957.17C2886.94,-20949.59 2884.44,-20940.68 2881.91,-20931.62"/>
<polygon fill="black" stroke="black" points="2885.22,-20930.47 2879.15,-20921.79 2878.48,-20932.36 2885.22,-20930.47"/>
</g>
<!-- token_dist_2 -->
<g id="node81" class="node">
<title>token_dist_2</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-20766.27" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-20775.47" font-family="Arial" font-size="11.00">Token_Distribution_2</text>
<text text-anchor="middle" x="2881" y="-20763.47" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-20751.47" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_2&#45;&gt;token_dist_2 -->
<g id="edge60" class="edge">
<title>gate_2&#45;&gt;token_dist_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-20833.26C2873.61,-20824.88 2874.73,-20816.13 2875.79,-20807.84"/>
<polygon fill="red" stroke="red" points="2879.3,-20808.01 2877.1,-20797.64 2872.36,-20807.12 2879.3,-20808.01"/>
</g>
<!-- expert_2_0_gpu0 -->
<g id="node82" class="node">
<title>expert_2_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-20637.16 2820,-20637.16 2820,-20593.16 2942,-20593.16 2942,-20637.16"/>
<text text-anchor="middle" x="2881" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_2&#45;&gt;expert_2_0_gpu0 -->
<g id="edge61" class="edge">
<title>token_dist_2&#45;&gt;expert_2_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-20735.09C2881,-20709.51 2881,-20672.97 2881,-20647.16"/>
<polygon fill="black" stroke="black" points="2884.5,-20647.16 2881,-20637.16 2877.5,-20647.16 2884.5,-20647.16"/>
</g>
<!-- expert_2_0_gpu1 -->
<g id="node83" class="node">
<title>expert_2_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-20535.16 2885,-20535.16 2885,-20491.16 3007,-20491.16 3007,-20535.16"/>
<text text-anchor="middle" x="2946" y="-20522.36" font-family="Arial" font-size="11.00">Expert_2_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-20510.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-20498.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_2&#45;&gt;expert_2_0_gpu1 -->
<g id="edge62" class="edge">
<title>token_dist_2&#45;&gt;expert_2_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-20737.83C2945.77,-20734.63 2948.67,-20731.08 2951,-20727.16 2984.76,-20670.34 2968.96,-20589.07 2956.33,-20545.16"/>
<polygon fill="black" stroke="black" points="2959.62,-20543.92 2953.38,-20535.35 2952.91,-20545.94 2959.62,-20543.92"/>
</g>
<!-- expert_2_0_gpu0&#45;&gt;expert_2_0_gpu1 -->
<g id="edge63" class="edge">
<title>expert_2_0_gpu0&#45;&gt;expert_2_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-20592.95C2904.09,-20578.63 2916.51,-20559.53 2926.78,-20543.72"/>
<polygon fill="black" stroke="black" points="2929.72,-20545.62 2932.24,-20535.33 2923.85,-20541.81 2929.72,-20545.62"/>
</g>
<!-- expert_merge_2_0 -->
<g id="node84" class="node">
<title>expert_merge_2_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-20455.16 2871.29,-20455.16 2819.53,-20367.16 3020.71,-20367.16 3072.47,-20455.16"/>
<text text-anchor="middle" x="2946" y="-20420.36" font-family="Arial" font-size="11.00">Expert_Merge_2_0</text>
<text text-anchor="middle" x="2946" y="-20408.36" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-20396.36" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_2_0_gpu1&#45;&gt;expert_merge_2_0 -->
<g id="edge64" class="edge">
<title>expert_2_0_gpu1&#45;&gt;expert_merge_2_0</title>
<path fill="none" stroke="black" d="M2946,-20490.95C2946,-20483.45 2946,-20474.64 2946,-20465.68"/>
<polygon fill="black" stroke="black" points="2949.5,-20465.56 2946,-20455.56 2942.5,-20465.56 2949.5,-20465.56"/>
</g>
<!-- expert_agg_2 -->
<g id="node100" class="node">
<title>expert_agg_2</title>
<polygon fill="yellow" stroke="black" points="3077.82,-20331.16 2823.58,-20331.16 2758.18,-20243.16 3012.42,-20243.16 3077.82,-20331.16"/>
<text text-anchor="middle" x="2918" y="-20296.36" font-family="Arial" font-size="11.00">Expert_Aggregation_2</text>
<text text-anchor="middle" x="2918" y="-20284.36" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-20272.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_2_0&#45;&gt;expert_agg_2 -->
<g id="edge65" class="edge">
<title>expert_merge_2_0&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M2936.13,-20367.14C2934.2,-20358.76 2932.17,-20349.88 2930.18,-20341.22"/>
<polygon fill="black" stroke="black" points="2933.53,-20340.15 2927.88,-20331.19 2926.7,-20341.72 2933.53,-20340.15"/>
</g>
<!-- expert_2_1_gpu0 -->
<g id="node85" class="node">
<title>expert_2_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-20637.16 2674,-20637.16 2674,-20593.16 2796,-20593.16 2796,-20637.16"/>
<text text-anchor="middle" x="2735" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_1_gpu1 -->
<g id="node86" class="node">
<title>expert_2_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-20637.16 2534,-20637.16 2534,-20593.16 2656,-20593.16 2656,-20637.16"/>
<text text-anchor="middle" x="2595" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_1 -->
<g id="node87" class="node">
<title>expert_merge_2_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-20659.16 2315.29,-20659.16 2263.53,-20571.16 2464.71,-20571.16 2516.47,-20659.16"/>
<text text-anchor="middle" x="2390" y="-20624.36" font-family="Arial" font-size="11.00">Expert_Merge_2_1</text>
<text text-anchor="middle" x="2390" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_2_2_gpu0 -->
<g id="node88" class="node">
<title>expert_2_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-20637.16 2118,-20637.16 2118,-20593.16 2240,-20593.16 2240,-20637.16"/>
<text text-anchor="middle" x="2179" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_2_gpu1 -->
<g id="node89" class="node">
<title>expert_2_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-20637.16 1978,-20637.16 1978,-20593.16 2100,-20593.16 2100,-20637.16"/>
<text text-anchor="middle" x="2039" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_2 -->
<g id="node90" class="node">
<title>expert_merge_2_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-20659.16 1759.29,-20659.16 1707.53,-20571.16 1908.71,-20571.16 1960.47,-20659.16"/>
<text text-anchor="middle" x="1834" y="-20624.36" font-family="Arial" font-size="11.00">Expert_Merge_2_2</text>
<text text-anchor="middle" x="1834" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_2_61_gpu0 -->
<g id="node91" class="node">
<title>expert_2_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-20637.16 1562,-20637.16 1562,-20593.16 1684,-20593.16 1684,-20637.16"/>
<text text-anchor="middle" x="1623" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_61_gpu1 -->
<g id="node92" class="node">
<title>expert_2_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-20637.16 1422,-20637.16 1422,-20593.16 1544,-20593.16 1544,-20637.16"/>
<text text-anchor="middle" x="1483" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_61 -->
<g id="node93" class="node">
<title>expert_merge_2_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-20659.16 1203.29,-20659.16 1151.53,-20571.16 1352.71,-20571.16 1404.47,-20659.16"/>
<text text-anchor="middle" x="1278" y="-20624.36" font-family="Arial" font-size="11.00">Expert_Merge_2_61</text>
<text text-anchor="middle" x="1278" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_2_62_gpu0 -->
<g id="node94" class="node">
<title>expert_2_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-20637.16 1006,-20637.16 1006,-20593.16 1128,-20593.16 1128,-20637.16"/>
<text text-anchor="middle" x="1067" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_62_gpu1 -->
<g id="node95" class="node">
<title>expert_2_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-20637.16 866,-20637.16 866,-20593.16 988,-20593.16 988,-20637.16"/>
<text text-anchor="middle" x="927" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_62_GPU1</text>
<text text-anchor="middle" x="927" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_62 -->
<g id="node96" class="node">
<title>expert_merge_2_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-20659.16 647.29,-20659.16 595.53,-20571.16 796.71,-20571.16 848.47,-20659.16"/>
<text text-anchor="middle" x="722" y="-20624.36" font-family="Arial" font-size="11.00">Expert_Merge_2_62</text>
<text text-anchor="middle" x="722" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_2_63_gpu0 -->
<g id="node97" class="node">
<title>expert_2_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-20637.16 450,-20637.16 450,-20593.16 572,-20593.16 572,-20637.16"/>
<text text-anchor="middle" x="511" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_63_GPU0</text>
<text text-anchor="middle" x="511" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_63_gpu1 -->
<g id="node98" class="node">
<title>expert_2_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-20637.16 310,-20637.16 310,-20593.16 432,-20593.16 432,-20637.16"/>
<text text-anchor="middle" x="371" y="-20624.36" font-family="Arial" font-size="11.00">Expert_2_63_GPU1</text>
<text text-anchor="middle" x="371" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_63 -->
<g id="node99" class="node">
<title>expert_merge_2_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-20659.16 91.29,-20659.16 39.53,-20571.16 240.71,-20571.16 292.47,-20659.16"/>
<text text-anchor="middle" x="166" y="-20624.36" font-family="Arial" font-size="11.00">Expert_Merge_2_63</text>
<text text-anchor="middle" x="166" y="-20612.36" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-20600.36" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_2&#45;&gt;add_2_2 -->
<g id="edge66" class="edge">
<title>expert_agg_2&#45;&gt;add_2_2</title>
<path fill="none" stroke="black" d="M2930.98,-20242.88C2933.59,-20234.19 2936.28,-20225.23 2938.73,-20217.07"/>
<polygon fill="black" stroke="black" points="2942.15,-20217.82 2941.68,-20207.24 2935.45,-20215.81 2942.15,-20217.82"/>
</g>
<!-- pre_ln_3 -->
<g id="node102" class="node">
<title>pre_ln_3</title>
<polygon fill="lightgreen" stroke="black" points="3005.5,-20113.16 2860.5,-20113.16 2860.5,-20069.16 3005.5,-20069.16 3005.5,-20113.16"/>
<text text-anchor="middle" x="2933" y="-20100.36" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_3</text>
<text text-anchor="middle" x="2933" y="-20088.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-20076.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_2&#45;&gt;pre_ln_3 -->
<g id="edge68" class="edge">
<title>add_2_2&#45;&gt;pre_ln_3</title>
<path fill="none" stroke="black" d="M2944.52,-20162.82C2942.61,-20151.09 2940.2,-20136.33 2938.08,-20123.33"/>
<polygon fill="black" stroke="black" points="2941.52,-20122.68 2936.46,-20113.38 2934.62,-20123.81 2941.52,-20122.68"/>
</g>
<!-- add_1_3 -->
<g id="node111" class="node">
<title>add_1_3</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-19539.16 2831.5,-19539.16 2831.5,-19495.16 3070.5,-19495.16 3070.5,-19539.16"/>
<text text-anchor="middle" x="2951" y="-19526.36" font-family="Arial" font-size="11.00">Residual_Add1_3</text>
<text text-anchor="middle" x="2951" y="-19514.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-19502.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_2&#45;&gt;add_1_3 -->
<g id="edge79" class="edge">
<title>add_2_2&#45;&gt;add_1_3</title>
<path fill="none" stroke="black" d="M2995.38,-20162.95C3002.51,-20158.41 3009.35,-20153.15 3015,-20147.16 3066.87,-20092.09 3064,-20059.8 3064,-19984.16 3064,-19984.16 3064,-19984.16 3064,-19720.16 3064,-19652.06 3094.07,-19623.62 3056,-19567.16 3049.84,-19558.02 3041.52,-19550.56 3032.24,-19544.46"/>
<polygon fill="black" stroke="black" points="3033.86,-19541.35 3023.47,-19539.24 3030.27,-19547.37 3033.86,-19541.35"/>
</g>
<!-- mha_input_3 -->
<g id="node103" class="node">
<title>mha_input_3</title>
<polygon fill="yellow" stroke="black" points="3044.16,-20027.16 2805.29,-20027.16 2743.84,-19939.16 2982.71,-19939.16 3044.16,-20027.16"/>
<text text-anchor="middle" x="2894" y="-19992.36" font-family="Arial" font-size="11.00">MHA_Input_3</text>
<text text-anchor="middle" x="2894" y="-19980.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2894" y="-19968.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_3&#45;&gt;mha_input_3 -->
<g id="edge69" class="edge">
<title>pre_ln_3&#45;&gt;mha_input_3</title>
<path fill="none" stroke="black" d="M2925.2,-20068.96C2921.76,-20059.61 2917.55,-20048.17 2913.35,-20036.76"/>
<polygon fill="black" stroke="black" points="2916.58,-20035.4 2909.85,-20027.22 2910.01,-20037.82 2916.58,-20035.4"/>
</g>
<!-- qkv_proj_3_gpu0 -->
<g id="node104" class="node">
<title>qkv_proj_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-19903.16 2580.5,-19903.16 2580.5,-19859.16 2803.5,-19859.16 2803.5,-19903.16"/>
<text text-anchor="middle" x="2692" y="-19890.36" font-family="Arial" font-size="11.00">QKV_Proj_3_GPU0</text>
<text text-anchor="middle" x="2692" y="-19878.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2692" y="-19866.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_3&#45;&gt;qkv_proj_3_gpu0 -->
<g id="edge70" class="edge">
<title>mha_input_3&#45;&gt;qkv_proj_3_gpu0</title>
<path fill="none" stroke="black" d="M2806.87,-19939.02C2785.3,-19928.35 2762.88,-19917.24 2743.63,-19907.71"/>
<polygon fill="black" stroke="black" points="2744.97,-19904.47 2734.45,-19903.17 2741.86,-19910.74 2744.97,-19904.47"/>
</g>
<!-- qkv_proj_3_gpu1 -->
<g id="node105" class="node">
<title>qkv_proj_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3044.5,-19903.16 2821.5,-19903.16 2821.5,-19859.16 3044.5,-19859.16 3044.5,-19903.16"/>
<text text-anchor="middle" x="2933" y="-19890.36" font-family="Arial" font-size="11.00">QKV_Proj_3_GPU1</text>
<text text-anchor="middle" x="2933" y="-19878.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-19866.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_3&#45;&gt;qkv_proj_3_gpu1 -->
<g id="edge71" class="edge">
<title>mha_input_3&#45;&gt;qkv_proj_3_gpu1</title>
<path fill="none" stroke="black" d="M2910.88,-19938.88C2914.3,-19930.09 2917.84,-19921.03 2921.05,-19912.8"/>
<polygon fill="black" stroke="black" points="2924.41,-19913.83 2924.78,-19903.24 2917.88,-19911.28 2924.41,-19913.83"/>
</g>
<!-- attn_3_gpu0 -->
<g id="node106" class="node">
<title>attn_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2777.5,-19823.16 2644.5,-19823.16 2644.5,-19779.16 2777.5,-19779.16 2777.5,-19823.16"/>
<text text-anchor="middle" x="2711" y="-19810.36" font-family="Arial" font-size="11.00">Attention_3_GPU0</text>
<text text-anchor="middle" x="2711" y="-19798.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2711" y="-19786.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_3_gpu0&#45;&gt;attn_3_gpu0 -->
<g id="edge72" class="edge">
<title>qkv_proj_3_gpu0&#45;&gt;attn_3_gpu0</title>
<path fill="none" stroke="black" d="M2697.19,-19858.84C2699.13,-19850.87 2701.38,-19841.64 2703.49,-19832.98"/>
<polygon fill="black" stroke="black" points="2706.91,-19833.72 2705.88,-19823.17 2700.11,-19832.06 2706.91,-19833.72"/>
</g>
<!-- attn_3_gpu1 -->
<g id="node107" class="node">
<title>attn_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-19823.16 2856.5,-19823.16 2856.5,-19779.16 2989.5,-19779.16 2989.5,-19823.16"/>
<text text-anchor="middle" x="2923" y="-19810.36" font-family="Arial" font-size="11.00">Attention_3_GPU1</text>
<text text-anchor="middle" x="2923" y="-19798.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2923" y="-19786.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_3_gpu1&#45;&gt;attn_3_gpu1 -->
<g id="edge73" class="edge">
<title>qkv_proj_3_gpu1&#45;&gt;attn_3_gpu1</title>
<path fill="none" stroke="black" d="M2930.27,-19858.84C2929.26,-19850.95 2928.09,-19841.84 2926.99,-19833.26"/>
<polygon fill="black" stroke="black" points="2930.44,-19832.65 2925.69,-19823.17 2923.49,-19833.54 2930.44,-19832.65"/>
</g>
<!-- out_proj_3_gpu0 -->
<g id="node108" class="node">
<title>out_proj_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-19743.16 2658.5,-19743.16 2658.5,-19699.16 2803.5,-19699.16 2803.5,-19743.16"/>
<text text-anchor="middle" x="2731" y="-19730.36" font-family="Arial" font-size="11.00">Output_Proj_3_GPU0</text>
<text text-anchor="middle" x="2731" y="-19718.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2731" y="-19706.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_3_gpu0&#45;&gt;out_proj_3_gpu0 -->
<g id="edge74" class="edge">
<title>attn_3_gpu0&#45;&gt;out_proj_3_gpu0</title>
<path fill="none" stroke="black" d="M2716.47,-19778.84C2718.51,-19770.87 2720.88,-19761.64 2723.1,-19752.98"/>
<polygon fill="black" stroke="black" points="2726.52,-19753.73 2725.61,-19743.17 2719.74,-19751.99 2726.52,-19753.73"/>
</g>
<!-- out_proj_3_gpu1 -->
<g id="node109" class="node">
<title>out_proj_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2985.5,-19743.16 2840.5,-19743.16 2840.5,-19699.16 2985.5,-19699.16 2985.5,-19743.16"/>
<text text-anchor="middle" x="2913" y="-19730.36" font-family="Arial" font-size="11.00">Output_Proj_3_GPU1</text>
<text text-anchor="middle" x="2913" y="-19718.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2913" y="-19706.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_3_gpu1&#45;&gt;out_proj_3_gpu1 -->
<g id="edge75" class="edge">
<title>attn_3_gpu1&#45;&gt;out_proj_3_gpu1</title>
<path fill="none" stroke="black" d="M2920.27,-19778.84C2919.26,-19770.95 2918.09,-19761.84 2916.99,-19753.26"/>
<polygon fill="black" stroke="black" points="2920.44,-19752.65 2915.69,-19743.17 2913.49,-19753.54 2920.44,-19752.65"/>
</g>
<!-- mha_merge_3 -->
<g id="node110" class="node">
<title>mha_merge_3</title>
<polygon fill="yellow" stroke="black" points="3044.16,-19663.16 2805.29,-19663.16 2743.84,-19575.16 2982.71,-19575.16 3044.16,-19663.16"/>
<text text-anchor="middle" x="2894" y="-19628.36" font-family="Arial" font-size="11.00">MHA_Merge_3</text>
<text text-anchor="middle" x="2894" y="-19616.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2894" y="-19604.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_3_gpu0&#45;&gt;mha_merge_3 -->
<g id="edge76" class="edge">
<title>out_proj_3_gpu0&#45;&gt;mha_merge_3</title>
<path fill="none" stroke="black" d="M2765.57,-19698.95C2779.97,-19690.11 2797.34,-19679.45 2814.59,-19668.87"/>
<polygon fill="black" stroke="black" points="2816.89,-19671.57 2823.58,-19663.36 2813.23,-19665.6 2816.89,-19671.57"/>
</g>
<!-- out_proj_3_gpu1&#45;&gt;mha_merge_3 -->
<g id="edge77" class="edge">
<title>out_proj_3_gpu1&#45;&gt;mha_merge_3</title>
<path fill="none" stroke="black" d="M2908.97,-19698.95C2907.53,-19691.37 2905.84,-19682.45 2904.12,-19673.39"/>
<polygon fill="black" stroke="black" points="2907.55,-19672.73 2902.25,-19663.56 2900.68,-19674.04 2907.55,-19672.73"/>
</g>
<!-- mha_merge_3&#45;&gt;add_1_3 -->
<g id="edge78" class="edge">
<title>mha_merge_3&#45;&gt;add_1_3</title>
<path fill="none" stroke="black" d="M2918.67,-19574.88C2923.84,-19565.8 2929.18,-19556.43 2934,-19547.99"/>
<polygon fill="black" stroke="black" points="2937.07,-19549.66 2938.98,-19539.24 2930.99,-19546.19 2937.07,-19549.66"/>
</g>
<!-- post_ln_3 -->
<g id="node112" class="node">
<title>post_ln_3</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-19459.16 2822.5,-19459.16 2822.5,-19415.16 2967.5,-19415.16 2967.5,-19459.16"/>
<text text-anchor="middle" x="2895" y="-19446.36" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_3</text>
<text text-anchor="middle" x="2895" y="-19434.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-19422.36" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_3&#45;&gt;post_ln_3 -->
<g id="edge80" class="edge">
<title>add_1_3&#45;&gt;post_ln_3</title>
<path fill="none" stroke="black" d="M2935.7,-19494.84C2929.66,-19486.43 2922.62,-19476.63 2916.12,-19467.57"/>
<polygon fill="black" stroke="black" points="2918.77,-19465.26 2910.09,-19459.17 2913.08,-19469.34 2918.77,-19465.26"/>
</g>
<!-- add_2_3 -->
<g id="node134" class="node">
<title>add_2_3</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-18664.93 2828.5,-18664.93 2828.5,-18620.93 3067.5,-18620.93 3067.5,-18664.93"/>
<text text-anchor="middle" x="2948" y="-18652.13" font-family="Arial" font-size="11.00">Residual_Add2_3</text>
<text text-anchor="middle" x="2948" y="-18640.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-18628.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_3&#45;&gt;add_2_3 -->
<g id="edge89" class="edge">
<title>add_1_3&#45;&gt;add_2_3</title>
<path fill="none" stroke="black" d="M2984.86,-19495.15C3027.99,-19465.49 3097,-19406.97 3097,-19336.16 3097,-19336.16 3097,-19336.16 3097,-18867.93 3097,-18790.12 3138.2,-18755.54 3092,-18692.93 3085.15,-18683.64 3076.44,-18676.1 3066.71,-18669.98"/>
<polygon fill="black" stroke="black" points="3068.33,-18666.87 3057.91,-18664.95 3064.86,-18672.95 3068.33,-18666.87"/>
</g>
<!-- gate_3 -->
<g id="node113" class="node">
<title>gate_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-19379.16 2742.05,-19379.16 2655.5,-19291.16 2991.95,-19291.16 3078.5,-19379.16"/>
<text text-anchor="middle" x="2867" y="-19344.36" font-family="Arial" font-size="11.00">Expert_Gate_3</text>
<text text-anchor="middle" x="2867" y="-19332.36" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-19320.36" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_3&#45;&gt;gate_3 -->
<g id="edge81" class="edge">
<title>post_ln_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M2889.06,-19414.95C2886.94,-19407.37 2884.44,-19398.45 2881.91,-19389.39"/>
<polygon fill="black" stroke="black" points="2885.22,-19388.25 2879.15,-19379.56 2878.48,-19390.14 2885.22,-19388.25"/>
</g>
<!-- token_dist_3 -->
<g id="node114" class="node">
<title>token_dist_3</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-19224.04" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-19233.24" font-family="Arial" font-size="11.00">Token_Distribution_3</text>
<text text-anchor="middle" x="2881" y="-19221.24" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-19209.24" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_3&#45;&gt;token_dist_3 -->
<g id="edge82" class="edge">
<title>gate_3&#45;&gt;token_dist_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-19291.03C2873.61,-19282.65 2874.73,-19273.9 2875.79,-19265.61"/>
<polygon fill="red" stroke="red" points="2879.3,-19265.78 2877.1,-19255.42 2872.36,-19264.89 2879.3,-19265.78"/>
</g>
<!-- expert_3_0_gpu0 -->
<g id="node115" class="node">
<title>expert_3_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-19094.93 2820,-19094.93 2820,-19050.93 2942,-19050.93 2942,-19094.93"/>
<text text-anchor="middle" x="2881" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_3&#45;&gt;expert_3_0_gpu0 -->
<g id="edge83" class="edge">
<title>token_dist_3&#45;&gt;expert_3_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-19192.87C2881,-19167.29 2881,-19130.75 2881,-19104.94"/>
<polygon fill="black" stroke="black" points="2884.5,-19104.93 2881,-19094.93 2877.5,-19104.93 2884.5,-19104.93"/>
</g>
<!-- expert_3_0_gpu1 -->
<g id="node116" class="node">
<title>expert_3_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-18992.93 2885,-18992.93 2885,-18948.93 3007,-18948.93 3007,-18992.93"/>
<text text-anchor="middle" x="2946" y="-18980.13" font-family="Arial" font-size="11.00">Expert_3_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-18968.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-18956.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_3&#45;&gt;expert_3_0_gpu1 -->
<g id="edge84" class="edge">
<title>token_dist_3&#45;&gt;expert_3_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-19195.6C2945.77,-19192.4 2948.67,-19188.86 2951,-19184.93 2984.76,-19128.11 2968.96,-19046.85 2956.33,-19002.94"/>
<polygon fill="black" stroke="black" points="2959.62,-19001.7 2953.38,-18993.13 2952.91,-19003.71 2959.62,-19001.7"/>
</g>
<!-- expert_3_0_gpu0&#45;&gt;expert_3_0_gpu1 -->
<g id="edge85" class="edge">
<title>expert_3_0_gpu0&#45;&gt;expert_3_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-19050.72C2904.09,-19036.4 2916.51,-19017.31 2926.78,-19001.5"/>
<polygon fill="black" stroke="black" points="2929.72,-19003.4 2932.24,-18993.11 2923.85,-18999.58 2929.72,-19003.4"/>
</g>
<!-- expert_merge_3_0 -->
<g id="node117" class="node">
<title>expert_merge_3_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-18912.93 2871.29,-18912.93 2819.53,-18824.93 3020.71,-18824.93 3072.47,-18912.93"/>
<text text-anchor="middle" x="2946" y="-18878.13" font-family="Arial" font-size="11.00">Expert_Merge_3_0</text>
<text text-anchor="middle" x="2946" y="-18866.13" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-18854.13" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_3_0_gpu1&#45;&gt;expert_merge_3_0 -->
<g id="edge86" class="edge">
<title>expert_3_0_gpu1&#45;&gt;expert_merge_3_0</title>
<path fill="none" stroke="black" d="M2946,-18948.72C2946,-18941.22 2946,-18932.42 2946,-18923.46"/>
<polygon fill="black" stroke="black" points="2949.5,-18923.34 2946,-18913.34 2942.5,-18923.34 2949.5,-18923.34"/>
</g>
<!-- expert_agg_3 -->
<g id="node133" class="node">
<title>expert_agg_3</title>
<polygon fill="yellow" stroke="black" points="3077.82,-18788.93 2823.58,-18788.93 2758.18,-18700.93 3012.42,-18700.93 3077.82,-18788.93"/>
<text text-anchor="middle" x="2918" y="-18754.13" font-family="Arial" font-size="11.00">Expert_Aggregation_3</text>
<text text-anchor="middle" x="2918" y="-18742.13" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-18730.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_3_0&#45;&gt;expert_agg_3 -->
<g id="edge87" class="edge">
<title>expert_merge_3_0&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M2936.13,-18824.92C2934.2,-18816.54 2932.17,-18807.66 2930.18,-18798.99"/>
<polygon fill="black" stroke="black" points="2933.53,-18797.93 2927.88,-18788.97 2926.7,-18799.5 2933.53,-18797.93"/>
</g>
<!-- expert_3_1_gpu0 -->
<g id="node118" class="node">
<title>expert_3_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-19094.93 2674,-19094.93 2674,-19050.93 2796,-19050.93 2796,-19094.93"/>
<text text-anchor="middle" x="2735" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_1_gpu1 -->
<g id="node119" class="node">
<title>expert_3_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-19094.93 2534,-19094.93 2534,-19050.93 2656,-19050.93 2656,-19094.93"/>
<text text-anchor="middle" x="2595" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_1 -->
<g id="node120" class="node">
<title>expert_merge_3_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-19116.93 2315.29,-19116.93 2263.53,-19028.93 2464.71,-19028.93 2516.47,-19116.93"/>
<text text-anchor="middle" x="2390" y="-19082.13" font-family="Arial" font-size="11.00">Expert_Merge_3_1</text>
<text text-anchor="middle" x="2390" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_3_2_gpu0 -->
<g id="node121" class="node">
<title>expert_3_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-19094.93 2118,-19094.93 2118,-19050.93 2240,-19050.93 2240,-19094.93"/>
<text text-anchor="middle" x="2179" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_2_gpu1 -->
<g id="node122" class="node">
<title>expert_3_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-19094.93 1978,-19094.93 1978,-19050.93 2100,-19050.93 2100,-19094.93"/>
<text text-anchor="middle" x="2039" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_2 -->
<g id="node123" class="node">
<title>expert_merge_3_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-19116.93 1759.29,-19116.93 1707.53,-19028.93 1908.71,-19028.93 1960.47,-19116.93"/>
<text text-anchor="middle" x="1834" y="-19082.13" font-family="Arial" font-size="11.00">Expert_Merge_3_2</text>
<text text-anchor="middle" x="1834" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_3_61_gpu0 -->
<g id="node124" class="node">
<title>expert_3_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-19094.93 1562,-19094.93 1562,-19050.93 1684,-19050.93 1684,-19094.93"/>
<text text-anchor="middle" x="1623" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_61_gpu1 -->
<g id="node125" class="node">
<title>expert_3_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-19094.93 1422,-19094.93 1422,-19050.93 1544,-19050.93 1544,-19094.93"/>
<text text-anchor="middle" x="1483" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_61 -->
<g id="node126" class="node">
<title>expert_merge_3_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-19116.93 1203.29,-19116.93 1151.53,-19028.93 1352.71,-19028.93 1404.47,-19116.93"/>
<text text-anchor="middle" x="1278" y="-19082.13" font-family="Arial" font-size="11.00">Expert_Merge_3_61</text>
<text text-anchor="middle" x="1278" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_3_62_gpu0 -->
<g id="node127" class="node">
<title>expert_3_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-19094.93 1006,-19094.93 1006,-19050.93 1128,-19050.93 1128,-19094.93"/>
<text text-anchor="middle" x="1067" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_62_gpu1 -->
<g id="node128" class="node">
<title>expert_3_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-19094.93 866,-19094.93 866,-19050.93 988,-19050.93 988,-19094.93"/>
<text text-anchor="middle" x="927" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_62_GPU1</text>
<text text-anchor="middle" x="927" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_62 -->
<g id="node129" class="node">
<title>expert_merge_3_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-19116.93 647.29,-19116.93 595.53,-19028.93 796.71,-19028.93 848.47,-19116.93"/>
<text text-anchor="middle" x="722" y="-19082.13" font-family="Arial" font-size="11.00">Expert_Merge_3_62</text>
<text text-anchor="middle" x="722" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_3_63_gpu0 -->
<g id="node130" class="node">
<title>expert_3_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-19094.93 450,-19094.93 450,-19050.93 572,-19050.93 572,-19094.93"/>
<text text-anchor="middle" x="511" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_63_GPU0</text>
<text text-anchor="middle" x="511" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_63_gpu1 -->
<g id="node131" class="node">
<title>expert_3_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-19094.93 310,-19094.93 310,-19050.93 432,-19050.93 432,-19094.93"/>
<text text-anchor="middle" x="371" y="-19082.13" font-family="Arial" font-size="11.00">Expert_3_63_GPU1</text>
<text text-anchor="middle" x="371" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_63 -->
<g id="node132" class="node">
<title>expert_merge_3_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-19116.93 91.29,-19116.93 39.53,-19028.93 240.71,-19028.93 292.47,-19116.93"/>
<text text-anchor="middle" x="166" y="-19082.13" font-family="Arial" font-size="11.00">Expert_Merge_3_63</text>
<text text-anchor="middle" x="166" y="-19070.13" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-19058.13" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_3&#45;&gt;add_2_3 -->
<g id="edge88" class="edge">
<title>expert_agg_3&#45;&gt;add_2_3</title>
<path fill="none" stroke="black" d="M2930.98,-18700.65C2933.59,-18691.97 2936.28,-18683.01 2938.73,-18674.84"/>
<polygon fill="black" stroke="black" points="2942.15,-18675.6 2941.68,-18665.01 2935.45,-18673.59 2942.15,-18675.6"/>
</g>
<!-- pre_ln_4 -->
<g id="node135" class="node">
<title>pre_ln_4</title>
<polygon fill="lightgreen" stroke="black" points="2927.5,-18570.93 2782.5,-18570.93 2782.5,-18526.93 2927.5,-18526.93 2927.5,-18570.93"/>
<text text-anchor="middle" x="2855" y="-18558.13" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_4</text>
<text text-anchor="middle" x="2855" y="-18546.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-18534.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_3&#45;&gt;pre_ln_4 -->
<g id="edge90" class="edge">
<title>add_2_3&#45;&gt;pre_ln_4</title>
<path fill="none" stroke="black" d="M2926.43,-18620.59C2913.75,-18608.05 2897.57,-18592.04 2883.81,-18578.43"/>
<polygon fill="black" stroke="black" points="2886.02,-18575.7 2876.45,-18571.15 2881.1,-18580.67 2886.02,-18575.7"/>
</g>
<!-- add_1_4 -->
<g id="node144" class="node">
<title>add_1_4</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-17996.93 2831.5,-17996.93 2831.5,-17952.93 3070.5,-17952.93 3070.5,-17996.93"/>
<text text-anchor="middle" x="2951" y="-17984.13" font-family="Arial" font-size="11.00">Residual_Add1_4</text>
<text text-anchor="middle" x="2951" y="-17972.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-17960.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_3&#45;&gt;add_1_4 -->
<g id="edge101" class="edge">
<title>add_2_3&#45;&gt;add_1_4</title>
<path fill="none" stroke="black" d="M2954.71,-18620.87C2965.62,-18584.68 2986,-18508.2 2986,-18441.93 2986,-18441.93 2986,-18441.93 2986,-18177.93 2986,-18109.84 2996.68,-18090.41 2978,-18024.93 2976.18,-18018.56 2973.41,-18012.1 2970.33,-18006.05"/>
<polygon fill="black" stroke="black" points="2973.21,-18004.03 2965.32,-17996.97 2967.08,-18007.41 2973.21,-18004.03"/>
</g>
<!-- mha_input_4 -->
<g id="node136" class="node">
<title>mha_input_4</title>
<polygon fill="yellow" stroke="black" points="2966.16,-18484.93 2727.29,-18484.93 2665.84,-18396.93 2904.71,-18396.93 2966.16,-18484.93"/>
<text text-anchor="middle" x="2816" y="-18450.13" font-family="Arial" font-size="11.00">MHA_Input_4</text>
<text text-anchor="middle" x="2816" y="-18438.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2816" y="-18426.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_4&#45;&gt;mha_input_4 -->
<g id="edge91" class="edge">
<title>pre_ln_4&#45;&gt;mha_input_4</title>
<path fill="none" stroke="black" d="M2847.2,-18526.73C2843.76,-18517.39 2839.55,-18505.95 2835.35,-18494.53"/>
<polygon fill="black" stroke="black" points="2838.58,-18493.17 2831.85,-18485 2832.01,-18495.59 2838.58,-18493.17"/>
</g>
<!-- qkv_proj_4_gpu0 -->
<g id="node137" class="node">
<title>qkv_proj_4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2725.5,-18360.93 2502.5,-18360.93 2502.5,-18316.93 2725.5,-18316.93 2725.5,-18360.93"/>
<text text-anchor="middle" x="2614" y="-18348.13" font-family="Arial" font-size="11.00">QKV_Proj_4_GPU0</text>
<text text-anchor="middle" x="2614" y="-18336.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2614" y="-18324.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_4&#45;&gt;qkv_proj_4_gpu0 -->
<g id="edge92" class="edge">
<title>mha_input_4&#45;&gt;qkv_proj_4_gpu0</title>
<path fill="none" stroke="black" d="M2728.87,-18396.8C2707.3,-18386.12 2684.88,-18375.02 2665.63,-18365.49"/>
<polygon fill="black" stroke="black" points="2666.97,-18362.25 2656.45,-18360.95 2663.86,-18368.52 2666.97,-18362.25"/>
</g>
<!-- qkv_proj_4_gpu1 -->
<g id="node138" class="node">
<title>qkv_proj_4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2966.5,-18360.93 2743.5,-18360.93 2743.5,-18316.93 2966.5,-18316.93 2966.5,-18360.93"/>
<text text-anchor="middle" x="2855" y="-18348.13" font-family="Arial" font-size="11.00">QKV_Proj_4_GPU1</text>
<text text-anchor="middle" x="2855" y="-18336.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-18324.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_4&#45;&gt;qkv_proj_4_gpu1 -->
<g id="edge93" class="edge">
<title>mha_input_4&#45;&gt;qkv_proj_4_gpu1</title>
<path fill="none" stroke="black" d="M2832.88,-18396.65C2836.3,-18387.87 2839.84,-18378.81 2843.05,-18370.57"/>
<polygon fill="black" stroke="black" points="2846.41,-18371.6 2846.78,-18361.01 2839.88,-18369.06 2846.41,-18371.6"/>
</g>
<!-- attn_4_gpu0 -->
<g id="node139" class="node">
<title>attn_4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2709.5,-18280.93 2576.5,-18280.93 2576.5,-18236.93 2709.5,-18236.93 2709.5,-18280.93"/>
<text text-anchor="middle" x="2643" y="-18268.13" font-family="Arial" font-size="11.00">Attention_4_GPU0</text>
<text text-anchor="middle" x="2643" y="-18256.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2643" y="-18244.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_4_gpu0&#45;&gt;attn_4_gpu0 -->
<g id="edge94" class="edge">
<title>qkv_proj_4_gpu0&#45;&gt;attn_4_gpu0</title>
<path fill="none" stroke="black" d="M2621.92,-18316.62C2624.92,-18308.55 2628.39,-18299.21 2631.65,-18290.47"/>
<polygon fill="black" stroke="black" points="2634.98,-18291.54 2635.19,-18280.95 2628.42,-18289.1 2634.98,-18291.54"/>
</g>
<!-- attn_4_gpu1 -->
<g id="node140" class="node">
<title>attn_4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2911.5,-18280.93 2778.5,-18280.93 2778.5,-18236.93 2911.5,-18236.93 2911.5,-18280.93"/>
<text text-anchor="middle" x="2845" y="-18268.13" font-family="Arial" font-size="11.00">Attention_4_GPU1</text>
<text text-anchor="middle" x="2845" y="-18256.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2845" y="-18244.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_4_gpu1&#45;&gt;attn_4_gpu1 -->
<g id="edge95" class="edge">
<title>qkv_proj_4_gpu1&#45;&gt;attn_4_gpu1</title>
<path fill="none" stroke="black" d="M2852.27,-18316.62C2851.26,-18308.73 2850.09,-18299.61 2848.99,-18291.03"/>
<polygon fill="black" stroke="black" points="2852.44,-18290.42 2847.69,-18280.95 2845.49,-18291.31 2852.44,-18290.42"/>
</g>
<!-- out_proj_4_gpu0 -->
<g id="node141" class="node">
<title>out_proj_4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2734.5,-18200.93 2589.5,-18200.93 2589.5,-18156.93 2734.5,-18156.93 2734.5,-18200.93"/>
<text text-anchor="middle" x="2662" y="-18188.13" font-family="Arial" font-size="11.00">Output_Proj_4_GPU0</text>
<text text-anchor="middle" x="2662" y="-18176.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2662" y="-18164.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_4_gpu0&#45;&gt;out_proj_4_gpu0 -->
<g id="edge96" class="edge">
<title>attn_4_gpu0&#45;&gt;out_proj_4_gpu0</title>
<path fill="none" stroke="black" d="M2648.19,-18236.62C2650.13,-18228.64 2652.38,-18219.41 2654.49,-18210.75"/>
<polygon fill="black" stroke="black" points="2657.91,-18211.49 2656.88,-18200.95 2651.11,-18209.84 2657.91,-18211.49"/>
</g>
<!-- out_proj_4_gpu1 -->
<g id="node142" class="node">
<title>out_proj_4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2907.5,-18200.93 2762.5,-18200.93 2762.5,-18156.93 2907.5,-18156.93 2907.5,-18200.93"/>
<text text-anchor="middle" x="2835" y="-18188.13" font-family="Arial" font-size="11.00">Output_Proj_4_GPU1</text>
<text text-anchor="middle" x="2835" y="-18176.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2835" y="-18164.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_4_gpu1&#45;&gt;out_proj_4_gpu1 -->
<g id="edge97" class="edge">
<title>attn_4_gpu1&#45;&gt;out_proj_4_gpu1</title>
<path fill="none" stroke="black" d="M2842.27,-18236.62C2841.26,-18228.73 2840.09,-18219.61 2838.99,-18211.03"/>
<polygon fill="black" stroke="black" points="2842.44,-18210.42 2837.69,-18200.95 2835.49,-18211.31 2842.44,-18210.42"/>
</g>
<!-- mha_merge_4 -->
<g id="node143" class="node">
<title>mha_merge_4</title>
<polygon fill="yellow" stroke="black" points="2966.16,-18120.93 2727.29,-18120.93 2665.84,-18032.93 2904.71,-18032.93 2966.16,-18120.93"/>
<text text-anchor="middle" x="2816" y="-18086.13" font-family="Arial" font-size="11.00">MHA_Merge_4</text>
<text text-anchor="middle" x="2816" y="-18074.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2816" y="-18062.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_4_gpu0&#45;&gt;mha_merge_4 -->
<g id="edge98" class="edge">
<title>out_proj_4_gpu0&#45;&gt;mha_merge_4</title>
<path fill="none" stroke="black" d="M2694.66,-18156.72C2708.27,-18147.89 2724.68,-18137.23 2740.97,-18126.65"/>
<polygon fill="black" stroke="black" points="2742.99,-18129.51 2749.47,-18121.13 2739.17,-18123.64 2742.99,-18129.51"/>
</g>
<!-- out_proj_4_gpu1&#45;&gt;mha_merge_4 -->
<g id="edge99" class="edge">
<title>out_proj_4_gpu1&#45;&gt;mha_merge_4</title>
<path fill="none" stroke="black" d="M2830.97,-18156.72C2829.53,-18149.14 2827.84,-18140.23 2826.12,-18131.17"/>
<polygon fill="black" stroke="black" points="2829.55,-18130.51 2824.25,-18121.34 2822.68,-18131.81 2829.55,-18130.51"/>
</g>
<!-- mha_merge_4&#45;&gt;add_1_4 -->
<g id="edge100" class="edge">
<title>mha_merge_4&#45;&gt;add_1_4</title>
<path fill="none" stroke="black" d="M2874.43,-18032.65C2887.98,-18022.61 2902.02,-18012.21 2914.33,-18003.1"/>
<polygon fill="black" stroke="black" points="2916.59,-18005.78 2922.54,-17997.01 2912.42,-18000.15 2916.59,-18005.78"/>
</g>
<!-- post_ln_4 -->
<g id="node145" class="node">
<title>post_ln_4</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-17916.93 2822.5,-17916.93 2822.5,-17872.93 2967.5,-17872.93 2967.5,-17916.93"/>
<text text-anchor="middle" x="2895" y="-17904.13" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_4</text>
<text text-anchor="middle" x="2895" y="-17892.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-17880.13" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_4&#45;&gt;post_ln_4 -->
<g id="edge102" class="edge">
<title>add_1_4&#45;&gt;post_ln_4</title>
<path fill="none" stroke="black" d="M2935.7,-17952.62C2929.66,-17944.21 2922.62,-17934.41 2916.12,-17925.34"/>
<polygon fill="black" stroke="black" points="2918.77,-17923.03 2910.09,-17916.95 2913.08,-17927.11 2918.77,-17923.03"/>
</g>
<!-- add_2_4 -->
<g id="node167" class="node">
<title>add_2_4</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-17122.7 2828.5,-17122.7 2828.5,-17078.7 3067.5,-17078.7 3067.5,-17122.7"/>
<text text-anchor="middle" x="2948" y="-17109.9" font-family="Arial" font-size="11.00">Residual_Add2_4</text>
<text text-anchor="middle" x="2948" y="-17097.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-17085.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_4&#45;&gt;add_2_4 -->
<g id="edge111" class="edge">
<title>add_1_4&#45;&gt;add_2_4</title>
<path fill="none" stroke="black" d="M2984.86,-17952.93C3027.99,-17923.27 3097,-17864.75 3097,-17793.93 3097,-17793.93 3097,-17793.93 3097,-17325.7 3097,-17247.9 3138.2,-17213.32 3092,-17150.7 3085.15,-17141.42 3076.44,-17133.88 3066.71,-17127.75"/>
<polygon fill="black" stroke="black" points="3068.33,-17124.65 3057.91,-17122.72 3064.86,-17130.72 3068.33,-17124.65"/>
</g>
<!-- gate_4 -->
<g id="node146" class="node">
<title>gate_4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-17836.93 2742.05,-17836.93 2655.5,-17748.93 2991.95,-17748.93 3078.5,-17836.93"/>
<text text-anchor="middle" x="2867" y="-17802.13" font-family="Arial" font-size="11.00">Expert_Gate_4</text>
<text text-anchor="middle" x="2867" y="-17790.13" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-17778.13" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_4&#45;&gt;gate_4 -->
<g id="edge103" class="edge">
<title>post_ln_4&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M2889.06,-17872.72C2886.94,-17865.14 2884.44,-17856.23 2881.91,-17847.17"/>
<polygon fill="black" stroke="black" points="2885.22,-17846.02 2879.15,-17837.34 2878.48,-17847.91 2885.22,-17846.02"/>
</g>
<!-- token_dist_4 -->
<g id="node147" class="node">
<title>token_dist_4</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-17681.82" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-17691.02" font-family="Arial" font-size="11.00">Token_Distribution_4</text>
<text text-anchor="middle" x="2881" y="-17679.02" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-17667.02" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_4&#45;&gt;token_dist_4 -->
<g id="edge104" class="edge">
<title>gate_4&#45;&gt;token_dist_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-17748.81C2873.61,-17740.43 2874.73,-17731.68 2875.79,-17723.38"/>
<polygon fill="red" stroke="red" points="2879.3,-17723.56 2877.1,-17713.19 2872.36,-17722.67 2879.3,-17723.56"/>
</g>
<!-- expert_4_0_gpu0 -->
<g id="node148" class="node">
<title>expert_4_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-17552.7 2820,-17552.7 2820,-17508.7 2942,-17508.7 2942,-17552.7"/>
<text text-anchor="middle" x="2881" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_4&#45;&gt;expert_4_0_gpu0 -->
<g id="edge105" class="edge">
<title>token_dist_4&#45;&gt;expert_4_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-17650.64C2881,-17625.06 2881,-17588.52 2881,-17562.71"/>
<polygon fill="black" stroke="black" points="2884.5,-17562.71 2881,-17552.71 2877.5,-17562.71 2884.5,-17562.71"/>
</g>
<!-- expert_4_0_gpu1 -->
<g id="node149" class="node">
<title>expert_4_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-17450.7 2885,-17450.7 2885,-17406.7 3007,-17406.7 3007,-17450.7"/>
<text text-anchor="middle" x="2946" y="-17437.9" font-family="Arial" font-size="11.00">Expert_4_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-17425.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-17413.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_4&#45;&gt;expert_4_0_gpu1 -->
<g id="edge106" class="edge">
<title>token_dist_4&#45;&gt;expert_4_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-17653.38C2945.77,-17650.18 2948.67,-17646.63 2951,-17642.7 2984.76,-17585.89 2968.96,-17504.62 2956.33,-17460.71"/>
<polygon fill="black" stroke="black" points="2959.62,-17459.47 2953.38,-17450.9 2952.91,-17461.49 2959.62,-17459.47"/>
</g>
<!-- expert_4_0_gpu0&#45;&gt;expert_4_0_gpu1 -->
<g id="edge107" class="edge">
<title>expert_4_0_gpu0&#45;&gt;expert_4_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-17508.5C2904.09,-17494.18 2916.51,-17475.08 2926.78,-17459.27"/>
<polygon fill="black" stroke="black" points="2929.72,-17461.17 2932.24,-17450.88 2923.85,-17457.36 2929.72,-17461.17"/>
</g>
<!-- expert_merge_4_0 -->
<g id="node150" class="node">
<title>expert_merge_4_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-17370.7 2871.29,-17370.7 2819.53,-17282.7 3020.71,-17282.7 3072.47,-17370.7"/>
<text text-anchor="middle" x="2946" y="-17335.9" font-family="Arial" font-size="11.00">Expert_Merge_4_0</text>
<text text-anchor="middle" x="2946" y="-17323.9" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-17311.9" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_4_0_gpu1&#45;&gt;expert_merge_4_0 -->
<g id="edge108" class="edge">
<title>expert_4_0_gpu1&#45;&gt;expert_merge_4_0</title>
<path fill="none" stroke="black" d="M2946,-17406.5C2946,-17399 2946,-17390.19 2946,-17381.23"/>
<polygon fill="black" stroke="black" points="2949.5,-17381.11 2946,-17371.11 2942.5,-17381.11 2949.5,-17381.11"/>
</g>
<!-- expert_agg_4 -->
<g id="node166" class="node">
<title>expert_agg_4</title>
<polygon fill="yellow" stroke="black" points="3077.82,-17246.7 2823.58,-17246.7 2758.18,-17158.7 3012.42,-17158.7 3077.82,-17246.7"/>
<text text-anchor="middle" x="2918" y="-17211.9" font-family="Arial" font-size="11.00">Expert_Aggregation_4</text>
<text text-anchor="middle" x="2918" y="-17199.9" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-17187.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_4_0&#45;&gt;expert_agg_4 -->
<g id="edge109" class="edge">
<title>expert_merge_4_0&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M2936.13,-17282.69C2934.2,-17274.31 2932.17,-17265.43 2930.18,-17256.77"/>
<polygon fill="black" stroke="black" points="2933.53,-17255.7 2927.88,-17246.74 2926.7,-17257.27 2933.53,-17255.7"/>
</g>
<!-- expert_4_1_gpu0 -->
<g id="node151" class="node">
<title>expert_4_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-17552.7 2674,-17552.7 2674,-17508.7 2796,-17508.7 2796,-17552.7"/>
<text text-anchor="middle" x="2735" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_1_gpu1 -->
<g id="node152" class="node">
<title>expert_4_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-17552.7 2534,-17552.7 2534,-17508.7 2656,-17508.7 2656,-17552.7"/>
<text text-anchor="middle" x="2595" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_1 -->
<g id="node153" class="node">
<title>expert_merge_4_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-17574.7 2315.29,-17574.7 2263.53,-17486.7 2464.71,-17486.7 2516.47,-17574.7"/>
<text text-anchor="middle" x="2390" y="-17539.9" font-family="Arial" font-size="11.00">Expert_Merge_4_1</text>
<text text-anchor="middle" x="2390" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_4_2_gpu0 -->
<g id="node154" class="node">
<title>expert_4_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-17552.7 2118,-17552.7 2118,-17508.7 2240,-17508.7 2240,-17552.7"/>
<text text-anchor="middle" x="2179" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_2_gpu1 -->
<g id="node155" class="node">
<title>expert_4_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-17552.7 1978,-17552.7 1978,-17508.7 2100,-17508.7 2100,-17552.7"/>
<text text-anchor="middle" x="2039" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_2 -->
<g id="node156" class="node">
<title>expert_merge_4_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-17574.7 1759.29,-17574.7 1707.53,-17486.7 1908.71,-17486.7 1960.47,-17574.7"/>
<text text-anchor="middle" x="1834" y="-17539.9" font-family="Arial" font-size="11.00">Expert_Merge_4_2</text>
<text text-anchor="middle" x="1834" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_4_61_gpu0 -->
<g id="node157" class="node">
<title>expert_4_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-17552.7 1562,-17552.7 1562,-17508.7 1684,-17508.7 1684,-17552.7"/>
<text text-anchor="middle" x="1623" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_61_gpu1 -->
<g id="node158" class="node">
<title>expert_4_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-17552.7 1422,-17552.7 1422,-17508.7 1544,-17508.7 1544,-17552.7"/>
<text text-anchor="middle" x="1483" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_61 -->
<g id="node159" class="node">
<title>expert_merge_4_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-17574.7 1203.29,-17574.7 1151.53,-17486.7 1352.71,-17486.7 1404.47,-17574.7"/>
<text text-anchor="middle" x="1278" y="-17539.9" font-family="Arial" font-size="11.00">Expert_Merge_4_61</text>
<text text-anchor="middle" x="1278" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_4_62_gpu0 -->
<g id="node160" class="node">
<title>expert_4_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-17552.7 1006,-17552.7 1006,-17508.7 1128,-17508.7 1128,-17552.7"/>
<text text-anchor="middle" x="1067" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_62_gpu1 -->
<g id="node161" class="node">
<title>expert_4_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-17552.7 866,-17552.7 866,-17508.7 988,-17508.7 988,-17552.7"/>
<text text-anchor="middle" x="927" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_62_GPU1</text>
<text text-anchor="middle" x="927" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_62 -->
<g id="node162" class="node">
<title>expert_merge_4_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-17574.7 647.29,-17574.7 595.53,-17486.7 796.71,-17486.7 848.47,-17574.7"/>
<text text-anchor="middle" x="722" y="-17539.9" font-family="Arial" font-size="11.00">Expert_Merge_4_62</text>
<text text-anchor="middle" x="722" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_4_63_gpu0 -->
<g id="node163" class="node">
<title>expert_4_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-17552.7 450,-17552.7 450,-17508.7 572,-17508.7 572,-17552.7"/>
<text text-anchor="middle" x="511" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_63_GPU0</text>
<text text-anchor="middle" x="511" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_63_gpu1 -->
<g id="node164" class="node">
<title>expert_4_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-17552.7 310,-17552.7 310,-17508.7 432,-17508.7 432,-17552.7"/>
<text text-anchor="middle" x="371" y="-17539.9" font-family="Arial" font-size="11.00">Expert_4_63_GPU1</text>
<text text-anchor="middle" x="371" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_63 -->
<g id="node165" class="node">
<title>expert_merge_4_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-17574.7 91.29,-17574.7 39.53,-17486.7 240.71,-17486.7 292.47,-17574.7"/>
<text text-anchor="middle" x="166" y="-17539.9" font-family="Arial" font-size="11.00">Expert_Merge_4_63</text>
<text text-anchor="middle" x="166" y="-17527.9" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-17515.9" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_4&#45;&gt;add_2_4 -->
<g id="edge110" class="edge">
<title>expert_agg_4&#45;&gt;add_2_4</title>
<path fill="none" stroke="black" d="M2930.98,-17158.42C2933.59,-17149.74 2936.28,-17140.78 2938.73,-17132.62"/>
<polygon fill="black" stroke="black" points="2942.15,-17133.37 2941.68,-17122.79 2935.45,-17131.36 2942.15,-17133.37"/>
</g>
<!-- pre_ln_5 -->
<g id="node168" class="node">
<title>pre_ln_5</title>
<polygon fill="lightgreen" stroke="black" points="2927.5,-17028.7 2782.5,-17028.7 2782.5,-16984.7 2927.5,-16984.7 2927.5,-17028.7"/>
<text text-anchor="middle" x="2855" y="-17015.9" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_5</text>
<text text-anchor="middle" x="2855" y="-17003.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-16991.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_4&#45;&gt;pre_ln_5 -->
<g id="edge112" class="edge">
<title>add_2_4&#45;&gt;pre_ln_5</title>
<path fill="none" stroke="black" d="M2926.43,-17078.37C2913.75,-17065.83 2897.57,-17049.81 2883.81,-17036.2"/>
<polygon fill="black" stroke="black" points="2886.02,-17033.47 2876.45,-17028.93 2881.1,-17038.45 2886.02,-17033.47"/>
</g>
<!-- add_1_5 -->
<g id="node177" class="node">
<title>add_1_5</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-16454.7 2831.5,-16454.7 2831.5,-16410.7 3070.5,-16410.7 3070.5,-16454.7"/>
<text text-anchor="middle" x="2951" y="-16441.9" font-family="Arial" font-size="11.00">Residual_Add1_5</text>
<text text-anchor="middle" x="2951" y="-16429.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-16417.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_4&#45;&gt;add_1_5 -->
<g id="edge123" class="edge">
<title>add_2_4&#45;&gt;add_1_5</title>
<path fill="none" stroke="black" d="M2954.71,-17078.64C2965.62,-17042.46 2986,-16965.97 2986,-16899.7 2986,-16899.7 2986,-16899.7 2986,-16635.7 2986,-16567.61 2996.68,-16548.18 2978,-16482.7 2976.18,-16476.33 2973.41,-16469.87 2970.33,-16463.83"/>
<polygon fill="black" stroke="black" points="2973.21,-16461.81 2965.32,-16454.74 2967.08,-16465.19 2973.21,-16461.81"/>
</g>
<!-- mha_input_5 -->
<g id="node169" class="node">
<title>mha_input_5</title>
<polygon fill="yellow" stroke="black" points="2966.16,-16942.7 2727.29,-16942.7 2665.84,-16854.7 2904.71,-16854.7 2966.16,-16942.7"/>
<text text-anchor="middle" x="2816" y="-16907.9" font-family="Arial" font-size="11.00">MHA_Input_5</text>
<text text-anchor="middle" x="2816" y="-16895.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2816" y="-16883.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_5&#45;&gt;mha_input_5 -->
<g id="edge113" class="edge">
<title>pre_ln_5&#45;&gt;mha_input_5</title>
<path fill="none" stroke="black" d="M2847.2,-16984.51C2843.76,-16975.16 2839.55,-16963.72 2835.35,-16952.31"/>
<polygon fill="black" stroke="black" points="2838.58,-16950.95 2831.85,-16942.77 2832.01,-16953.37 2838.58,-16950.95"/>
</g>
<!-- qkv_proj_5_gpu0 -->
<g id="node170" class="node">
<title>qkv_proj_5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2725.5,-16818.7 2502.5,-16818.7 2502.5,-16774.7 2725.5,-16774.7 2725.5,-16818.7"/>
<text text-anchor="middle" x="2614" y="-16805.9" font-family="Arial" font-size="11.00">QKV_Proj_5_GPU0</text>
<text text-anchor="middle" x="2614" y="-16793.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2614" y="-16781.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_5&#45;&gt;qkv_proj_5_gpu0 -->
<g id="edge114" class="edge">
<title>mha_input_5&#45;&gt;qkv_proj_5_gpu0</title>
<path fill="none" stroke="black" d="M2728.87,-16854.57C2707.3,-16843.89 2684.88,-16832.79 2665.63,-16823.26"/>
<polygon fill="black" stroke="black" points="2666.97,-16820.02 2656.45,-16818.72 2663.86,-16826.29 2666.97,-16820.02"/>
</g>
<!-- qkv_proj_5_gpu1 -->
<g id="node171" class="node">
<title>qkv_proj_5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2966.5,-16818.7 2743.5,-16818.7 2743.5,-16774.7 2966.5,-16774.7 2966.5,-16818.7"/>
<text text-anchor="middle" x="2855" y="-16805.9" font-family="Arial" font-size="11.00">QKV_Proj_5_GPU1</text>
<text text-anchor="middle" x="2855" y="-16793.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-16781.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_5&#45;&gt;qkv_proj_5_gpu1 -->
<g id="edge115" class="edge">
<title>mha_input_5&#45;&gt;qkv_proj_5_gpu1</title>
<path fill="none" stroke="black" d="M2832.88,-16854.42C2836.3,-16845.64 2839.84,-16836.58 2843.05,-16828.35"/>
<polygon fill="black" stroke="black" points="2846.41,-16829.38 2846.78,-16818.79 2839.88,-16826.83 2846.41,-16829.38"/>
</g>
<!-- attn_5_gpu0 -->
<g id="node172" class="node">
<title>attn_5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2709.5,-16738.7 2576.5,-16738.7 2576.5,-16694.7 2709.5,-16694.7 2709.5,-16738.7"/>
<text text-anchor="middle" x="2643" y="-16725.9" font-family="Arial" font-size="11.00">Attention_5_GPU0</text>
<text text-anchor="middle" x="2643" y="-16713.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2643" y="-16701.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_5_gpu0&#45;&gt;attn_5_gpu0 -->
<g id="edge116" class="edge">
<title>qkv_proj_5_gpu0&#45;&gt;attn_5_gpu0</title>
<path fill="none" stroke="black" d="M2621.92,-16774.39C2624.92,-16766.33 2628.39,-16756.99 2631.65,-16748.24"/>
<polygon fill="black" stroke="black" points="2634.98,-16749.32 2635.19,-16738.72 2628.42,-16746.88 2634.98,-16749.32"/>
</g>
<!-- attn_5_gpu1 -->
<g id="node173" class="node">
<title>attn_5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2911.5,-16738.7 2778.5,-16738.7 2778.5,-16694.7 2911.5,-16694.7 2911.5,-16738.7"/>
<text text-anchor="middle" x="2845" y="-16725.9" font-family="Arial" font-size="11.00">Attention_5_GPU1</text>
<text text-anchor="middle" x="2845" y="-16713.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2845" y="-16701.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_5_gpu1&#45;&gt;attn_5_gpu1 -->
<g id="edge117" class="edge">
<title>qkv_proj_5_gpu1&#45;&gt;attn_5_gpu1</title>
<path fill="none" stroke="black" d="M2852.27,-16774.39C2851.26,-16766.5 2850.09,-16757.39 2848.99,-16748.81"/>
<polygon fill="black" stroke="black" points="2852.44,-16748.2 2847.69,-16738.72 2845.49,-16749.09 2852.44,-16748.2"/>
</g>
<!-- out_proj_5_gpu0 -->
<g id="node174" class="node">
<title>out_proj_5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2734.5,-16658.7 2589.5,-16658.7 2589.5,-16614.7 2734.5,-16614.7 2734.5,-16658.7"/>
<text text-anchor="middle" x="2662" y="-16645.9" font-family="Arial" font-size="11.00">Output_Proj_5_GPU0</text>
<text text-anchor="middle" x="2662" y="-16633.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2662" y="-16621.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_5_gpu0&#45;&gt;out_proj_5_gpu0 -->
<g id="edge118" class="edge">
<title>attn_5_gpu0&#45;&gt;out_proj_5_gpu0</title>
<path fill="none" stroke="black" d="M2648.19,-16694.39C2650.13,-16686.42 2652.38,-16677.19 2654.49,-16668.52"/>
<polygon fill="black" stroke="black" points="2657.91,-16669.27 2656.88,-16658.72 2651.11,-16667.61 2657.91,-16669.27"/>
</g>
<!-- out_proj_5_gpu1 -->
<g id="node175" class="node">
<title>out_proj_5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2907.5,-16658.7 2762.5,-16658.7 2762.5,-16614.7 2907.5,-16614.7 2907.5,-16658.7"/>
<text text-anchor="middle" x="2835" y="-16645.9" font-family="Arial" font-size="11.00">Output_Proj_5_GPU1</text>
<text text-anchor="middle" x="2835" y="-16633.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2835" y="-16621.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_5_gpu1&#45;&gt;out_proj_5_gpu1 -->
<g id="edge119" class="edge">
<title>attn_5_gpu1&#45;&gt;out_proj_5_gpu1</title>
<path fill="none" stroke="black" d="M2842.27,-16694.39C2841.26,-16686.5 2840.09,-16677.39 2838.99,-16668.81"/>
<polygon fill="black" stroke="black" points="2842.44,-16668.2 2837.69,-16658.72 2835.49,-16669.09 2842.44,-16668.2"/>
</g>
<!-- mha_merge_5 -->
<g id="node176" class="node">
<title>mha_merge_5</title>
<polygon fill="yellow" stroke="black" points="2966.16,-16578.7 2727.29,-16578.7 2665.84,-16490.7 2904.71,-16490.7 2966.16,-16578.7"/>
<text text-anchor="middle" x="2816" y="-16543.9" font-family="Arial" font-size="11.00">MHA_Merge_5</text>
<text text-anchor="middle" x="2816" y="-16531.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2816" y="-16519.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_5_gpu0&#45;&gt;mha_merge_5 -->
<g id="edge120" class="edge">
<title>out_proj_5_gpu0&#45;&gt;mha_merge_5</title>
<path fill="none" stroke="black" d="M2694.66,-16614.5C2708.27,-16605.66 2724.68,-16595 2740.97,-16584.42"/>
<polygon fill="black" stroke="black" points="2742.99,-16587.29 2749.47,-16578.91 2739.17,-16581.42 2742.99,-16587.29"/>
</g>
<!-- out_proj_5_gpu1&#45;&gt;mha_merge_5 -->
<g id="edge121" class="edge">
<title>out_proj_5_gpu1&#45;&gt;mha_merge_5</title>
<path fill="none" stroke="black" d="M2830.97,-16614.5C2829.53,-16606.92 2827.84,-16598 2826.12,-16588.94"/>
<polygon fill="black" stroke="black" points="2829.55,-16588.28 2824.25,-16579.11 2822.68,-16589.59 2829.55,-16588.28"/>
</g>
<!-- mha_merge_5&#45;&gt;add_1_5 -->
<g id="edge122" class="edge">
<title>mha_merge_5&#45;&gt;add_1_5</title>
<path fill="none" stroke="black" d="M2874.43,-16490.42C2887.98,-16480.39 2902.02,-16469.99 2914.33,-16460.87"/>
<polygon fill="black" stroke="black" points="2916.59,-16463.55 2922.54,-16454.79 2912.42,-16457.93 2916.59,-16463.55"/>
</g>
<!-- post_ln_5 -->
<g id="node178" class="node">
<title>post_ln_5</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-16374.7 2822.5,-16374.7 2822.5,-16330.7 2967.5,-16330.7 2967.5,-16374.7"/>
<text text-anchor="middle" x="2895" y="-16361.9" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_5</text>
<text text-anchor="middle" x="2895" y="-16349.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-16337.9" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_5&#45;&gt;post_ln_5 -->
<g id="edge124" class="edge">
<title>add_1_5&#45;&gt;post_ln_5</title>
<path fill="none" stroke="black" d="M2935.7,-16410.39C2929.66,-16401.98 2922.62,-16392.18 2916.12,-16383.12"/>
<polygon fill="black" stroke="black" points="2918.77,-16380.8 2910.09,-16374.72 2913.08,-16384.89 2918.77,-16380.8"/>
</g>
<!-- add_2_5 -->
<g id="node200" class="node">
<title>add_2_5</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-15580.48 2828.5,-15580.48 2828.5,-15536.48 3067.5,-15536.48 3067.5,-15580.48"/>
<text text-anchor="middle" x="2948" y="-15567.68" font-family="Arial" font-size="11.00">Residual_Add2_5</text>
<text text-anchor="middle" x="2948" y="-15555.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-15543.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_5&#45;&gt;add_2_5 -->
<g id="edge133" class="edge">
<title>add_1_5&#45;&gt;add_2_5</title>
<path fill="none" stroke="black" d="M2984.86,-16410.7C3027.99,-16381.04 3097,-16322.52 3097,-16251.7 3097,-16251.7 3097,-16251.7 3097,-15783.48 3097,-15705.67 3138.2,-15671.09 3092,-15608.48 3085.15,-15599.19 3076.44,-15591.65 3066.71,-15585.52"/>
<polygon fill="black" stroke="black" points="3068.33,-15582.42 3057.91,-15580.5 3064.86,-15588.5 3068.33,-15582.42"/>
</g>
<!-- gate_5 -->
<g id="node179" class="node">
<title>gate_5</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-16294.7 2742.05,-16294.7 2655.5,-16206.7 2991.95,-16206.7 3078.5,-16294.7"/>
<text text-anchor="middle" x="2867" y="-16259.9" font-family="Arial" font-size="11.00">Expert_Gate_5</text>
<text text-anchor="middle" x="2867" y="-16247.9" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-16235.9" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_5&#45;&gt;gate_5 -->
<g id="edge125" class="edge">
<title>post_ln_5&#45;&gt;gate_5</title>
<path fill="none" stroke="black" d="M2889.06,-16330.5C2886.94,-16322.92 2884.44,-16314 2881.91,-16304.94"/>
<polygon fill="black" stroke="black" points="2885.22,-16303.8 2879.15,-16295.11 2878.48,-16305.69 2885.22,-16303.8"/>
</g>
<!-- token_dist_5 -->
<g id="node180" class="node">
<title>token_dist_5</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-16139.59" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-16148.79" font-family="Arial" font-size="11.00">Token_Distribution_5</text>
<text text-anchor="middle" x="2881" y="-16136.79" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-16124.79" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_5&#45;&gt;token_dist_5 -->
<g id="edge126" class="edge">
<title>gate_5&#45;&gt;token_dist_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-16206.58C2873.61,-16198.2 2874.73,-16189.45 2875.79,-16181.16"/>
<polygon fill="red" stroke="red" points="2879.3,-16181.33 2877.1,-16170.97 2872.36,-16180.44 2879.3,-16181.33"/>
</g>
<!-- expert_5_0_gpu0 -->
<g id="node181" class="node">
<title>expert_5_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-16010.48 2820,-16010.48 2820,-15966.48 2942,-15966.48 2942,-16010.48"/>
<text text-anchor="middle" x="2881" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_5&#45;&gt;expert_5_0_gpu0 -->
<g id="edge127" class="edge">
<title>token_dist_5&#45;&gt;expert_5_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-16108.42C2881,-16082.84 2881,-16046.3 2881,-16020.49"/>
<polygon fill="black" stroke="black" points="2884.5,-16020.48 2881,-16010.48 2877.5,-16020.48 2884.5,-16020.48"/>
</g>
<!-- expert_5_0_gpu1 -->
<g id="node182" class="node">
<title>expert_5_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-15908.48 2885,-15908.48 2885,-15864.48 3007,-15864.48 3007,-15908.48"/>
<text text-anchor="middle" x="2946" y="-15895.68" font-family="Arial" font-size="11.00">Expert_5_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-15883.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-15871.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_5&#45;&gt;expert_5_0_gpu1 -->
<g id="edge128" class="edge">
<title>token_dist_5&#45;&gt;expert_5_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-16111.15C2945.77,-16107.95 2948.67,-16104.41 2951,-16100.48 2984.76,-16043.66 2968.96,-15962.4 2956.33,-15918.49"/>
<polygon fill="black" stroke="black" points="2959.62,-15917.25 2953.38,-15908.68 2952.91,-15919.26 2959.62,-15917.25"/>
</g>
<!-- expert_5_0_gpu0&#45;&gt;expert_5_0_gpu1 -->
<g id="edge129" class="edge">
<title>expert_5_0_gpu0&#45;&gt;expert_5_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-15966.27C2904.09,-15951.95 2916.51,-15932.86 2926.78,-15917.05"/>
<polygon fill="black" stroke="black" points="2929.72,-15918.95 2932.24,-15908.66 2923.85,-15915.13 2929.72,-15918.95"/>
</g>
<!-- expert_merge_5_0 -->
<g id="node183" class="node">
<title>expert_merge_5_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-15828.48 2871.29,-15828.48 2819.53,-15740.48 3020.71,-15740.48 3072.47,-15828.48"/>
<text text-anchor="middle" x="2946" y="-15793.68" font-family="Arial" font-size="11.00">Expert_Merge_5_0</text>
<text text-anchor="middle" x="2946" y="-15781.68" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-15769.68" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_5_0_gpu1&#45;&gt;expert_merge_5_0 -->
<g id="edge130" class="edge">
<title>expert_5_0_gpu1&#45;&gt;expert_merge_5_0</title>
<path fill="none" stroke="black" d="M2946,-15864.27C2946,-15856.77 2946,-15847.97 2946,-15839.01"/>
<polygon fill="black" stroke="black" points="2949.5,-15838.89 2946,-15828.89 2942.5,-15838.89 2949.5,-15838.89"/>
</g>
<!-- expert_agg_5 -->
<g id="node199" class="node">
<title>expert_agg_5</title>
<polygon fill="yellow" stroke="black" points="3077.82,-15704.48 2823.58,-15704.48 2758.18,-15616.48 3012.42,-15616.48 3077.82,-15704.48"/>
<text text-anchor="middle" x="2918" y="-15669.68" font-family="Arial" font-size="11.00">Expert_Aggregation_5</text>
<text text-anchor="middle" x="2918" y="-15657.68" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-15645.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_5_0&#45;&gt;expert_agg_5 -->
<g id="edge131" class="edge">
<title>expert_merge_5_0&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M2936.13,-15740.47C2934.2,-15732.08 2932.17,-15723.2 2930.18,-15714.54"/>
<polygon fill="black" stroke="black" points="2933.53,-15713.48 2927.88,-15704.51 2926.7,-15715.04 2933.53,-15713.48"/>
</g>
<!-- expert_5_1_gpu0 -->
<g id="node184" class="node">
<title>expert_5_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-16010.48 2674,-16010.48 2674,-15966.48 2796,-15966.48 2796,-16010.48"/>
<text text-anchor="middle" x="2735" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_1_gpu1 -->
<g id="node185" class="node">
<title>expert_5_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-16010.48 2534,-16010.48 2534,-15966.48 2656,-15966.48 2656,-16010.48"/>
<text text-anchor="middle" x="2595" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_1 -->
<g id="node186" class="node">
<title>expert_merge_5_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-16032.48 2315.29,-16032.48 2263.53,-15944.48 2464.71,-15944.48 2516.47,-16032.48"/>
<text text-anchor="middle" x="2390" y="-15997.68" font-family="Arial" font-size="11.00">Expert_Merge_5_1</text>
<text text-anchor="middle" x="2390" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_5_2_gpu0 -->
<g id="node187" class="node">
<title>expert_5_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-16010.48 2118,-16010.48 2118,-15966.48 2240,-15966.48 2240,-16010.48"/>
<text text-anchor="middle" x="2179" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_2_gpu1 -->
<g id="node188" class="node">
<title>expert_5_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-16010.48 1978,-16010.48 1978,-15966.48 2100,-15966.48 2100,-16010.48"/>
<text text-anchor="middle" x="2039" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_2 -->
<g id="node189" class="node">
<title>expert_merge_5_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-16032.48 1759.29,-16032.48 1707.53,-15944.48 1908.71,-15944.48 1960.47,-16032.48"/>
<text text-anchor="middle" x="1834" y="-15997.68" font-family="Arial" font-size="11.00">Expert_Merge_5_2</text>
<text text-anchor="middle" x="1834" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_5_61_gpu0 -->
<g id="node190" class="node">
<title>expert_5_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-16010.48 1562,-16010.48 1562,-15966.48 1684,-15966.48 1684,-16010.48"/>
<text text-anchor="middle" x="1623" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_61_gpu1 -->
<g id="node191" class="node">
<title>expert_5_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-16010.48 1422,-16010.48 1422,-15966.48 1544,-15966.48 1544,-16010.48"/>
<text text-anchor="middle" x="1483" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_61 -->
<g id="node192" class="node">
<title>expert_merge_5_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-16032.48 1203.29,-16032.48 1151.53,-15944.48 1352.71,-15944.48 1404.47,-16032.48"/>
<text text-anchor="middle" x="1278" y="-15997.68" font-family="Arial" font-size="11.00">Expert_Merge_5_61</text>
<text text-anchor="middle" x="1278" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_5_62_gpu0 -->
<g id="node193" class="node">
<title>expert_5_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-16010.48 1006,-16010.48 1006,-15966.48 1128,-15966.48 1128,-16010.48"/>
<text text-anchor="middle" x="1067" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_62_gpu1 -->
<g id="node194" class="node">
<title>expert_5_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-16010.48 866,-16010.48 866,-15966.48 988,-15966.48 988,-16010.48"/>
<text text-anchor="middle" x="927" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_62_GPU1</text>
<text text-anchor="middle" x="927" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_62 -->
<g id="node195" class="node">
<title>expert_merge_5_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-16032.48 647.29,-16032.48 595.53,-15944.48 796.71,-15944.48 848.47,-16032.48"/>
<text text-anchor="middle" x="722" y="-15997.68" font-family="Arial" font-size="11.00">Expert_Merge_5_62</text>
<text text-anchor="middle" x="722" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_5_63_gpu0 -->
<g id="node196" class="node">
<title>expert_5_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-16010.48 450,-16010.48 450,-15966.48 572,-15966.48 572,-16010.48"/>
<text text-anchor="middle" x="511" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_63_GPU0</text>
<text text-anchor="middle" x="511" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_63_gpu1 -->
<g id="node197" class="node">
<title>expert_5_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-16010.48 310,-16010.48 310,-15966.48 432,-15966.48 432,-16010.48"/>
<text text-anchor="middle" x="371" y="-15997.68" font-family="Arial" font-size="11.00">Expert_5_63_GPU1</text>
<text text-anchor="middle" x="371" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_63 -->
<g id="node198" class="node">
<title>expert_merge_5_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-16032.48 91.29,-16032.48 39.53,-15944.48 240.71,-15944.48 292.47,-16032.48"/>
<text text-anchor="middle" x="166" y="-15997.68" font-family="Arial" font-size="11.00">Expert_Merge_5_63</text>
<text text-anchor="middle" x="166" y="-15985.68" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-15973.68" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_5&#45;&gt;add_2_5 -->
<g id="edge132" class="edge">
<title>expert_agg_5&#45;&gt;add_2_5</title>
<path fill="none" stroke="black" d="M2930.98,-15616.2C2933.59,-15607.51 2936.28,-15598.55 2938.73,-15590.39"/>
<polygon fill="black" stroke="black" points="2942.15,-15591.15 2941.68,-15580.56 2935.45,-15589.13 2942.15,-15591.15"/>
</g>
<!-- pre_ln_6 -->
<g id="node201" class="node">
<title>pre_ln_6</title>
<polygon fill="lightgreen" stroke="black" points="3005.5,-15486.48 2860.5,-15486.48 2860.5,-15442.48 3005.5,-15442.48 3005.5,-15486.48"/>
<text text-anchor="middle" x="2933" y="-15473.68" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_6</text>
<text text-anchor="middle" x="2933" y="-15461.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-15449.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_5&#45;&gt;pre_ln_6 -->
<g id="edge134" class="edge">
<title>add_2_5&#45;&gt;pre_ln_6</title>
<path fill="none" stroke="black" d="M2944.52,-15536.14C2942.61,-15524.41 2940.2,-15509.65 2938.08,-15496.65"/>
<polygon fill="black" stroke="black" points="2941.52,-15496.01 2936.46,-15486.7 2934.62,-15497.13 2941.52,-15496.01"/>
</g>
<!-- add_1_6 -->
<g id="node210" class="node">
<title>add_1_6</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-14912.48 2831.5,-14912.48 2831.5,-14868.48 3070.5,-14868.48 3070.5,-14912.48"/>
<text text-anchor="middle" x="2951" y="-14899.68" font-family="Arial" font-size="11.00">Residual_Add1_6</text>
<text text-anchor="middle" x="2951" y="-14887.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-14875.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_5&#45;&gt;add_1_6 -->
<g id="edge145" class="edge">
<title>add_2_5&#45;&gt;add_1_6</title>
<path fill="none" stroke="black" d="M2995.38,-15536.27C3002.51,-15531.74 3009.35,-15526.48 3015,-15520.48 3066.87,-15465.42 3064,-15433.13 3064,-15357.48 3064,-15357.48 3064,-15357.48 3064,-15093.48 3064,-15025.39 3094.07,-14996.94 3056,-14940.48 3049.84,-14931.35 3041.52,-14923.88 3032.24,-14917.79"/>
<polygon fill="black" stroke="black" points="3033.86,-14914.68 3023.47,-14912.56 3030.27,-14920.69 3033.86,-14914.68"/>
</g>
<!-- mha_input_6 -->
<g id="node202" class="node">
<title>mha_input_6</title>
<polygon fill="yellow" stroke="black" points="3044.16,-15400.48 2805.29,-15400.48 2743.84,-15312.48 2982.71,-15312.48 3044.16,-15400.48"/>
<text text-anchor="middle" x="2894" y="-15365.68" font-family="Arial" font-size="11.00">MHA_Input_6</text>
<text text-anchor="middle" x="2894" y="-15353.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2894" y="-15341.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_6&#45;&gt;mha_input_6 -->
<g id="edge135" class="edge">
<title>pre_ln_6&#45;&gt;mha_input_6</title>
<path fill="none" stroke="black" d="M2925.2,-15442.28C2921.76,-15432.94 2917.55,-15421.5 2913.35,-15410.08"/>
<polygon fill="black" stroke="black" points="2916.58,-15408.72 2909.85,-15400.55 2910.01,-15411.14 2916.58,-15408.72"/>
</g>
<!-- qkv_proj_6_gpu0 -->
<g id="node203" class="node">
<title>qkv_proj_6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-15276.48 2580.5,-15276.48 2580.5,-15232.48 2803.5,-15232.48 2803.5,-15276.48"/>
<text text-anchor="middle" x="2692" y="-15263.68" font-family="Arial" font-size="11.00">QKV_Proj_6_GPU0</text>
<text text-anchor="middle" x="2692" y="-15251.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2692" y="-15239.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_6&#45;&gt;qkv_proj_6_gpu0 -->
<g id="edge136" class="edge">
<title>mha_input_6&#45;&gt;qkv_proj_6_gpu0</title>
<path fill="none" stroke="black" d="M2806.87,-15312.34C2785.3,-15301.67 2762.88,-15290.57 2743.63,-15281.04"/>
<polygon fill="black" stroke="black" points="2744.97,-15277.79 2734.45,-15276.49 2741.86,-15284.07 2744.97,-15277.79"/>
</g>
<!-- qkv_proj_6_gpu1 -->
<g id="node204" class="node">
<title>qkv_proj_6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3044.5,-15276.48 2821.5,-15276.48 2821.5,-15232.48 3044.5,-15232.48 3044.5,-15276.48"/>
<text text-anchor="middle" x="2933" y="-15263.68" font-family="Arial" font-size="11.00">QKV_Proj_6_GPU1</text>
<text text-anchor="middle" x="2933" y="-15251.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-15239.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_6&#45;&gt;qkv_proj_6_gpu1 -->
<g id="edge137" class="edge">
<title>mha_input_6&#45;&gt;qkv_proj_6_gpu1</title>
<path fill="none" stroke="black" d="M2910.88,-15312.2C2914.3,-15303.42 2917.84,-15294.36 2921.05,-15286.12"/>
<polygon fill="black" stroke="black" points="2924.41,-15287.15 2924.78,-15276.56 2917.88,-15284.61 2924.41,-15287.15"/>
</g>
<!-- attn_6_gpu0 -->
<g id="node205" class="node">
<title>attn_6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2777.5,-15196.48 2644.5,-15196.48 2644.5,-15152.48 2777.5,-15152.48 2777.5,-15196.48"/>
<text text-anchor="middle" x="2711" y="-15183.68" font-family="Arial" font-size="11.00">Attention_6_GPU0</text>
<text text-anchor="middle" x="2711" y="-15171.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2711" y="-15159.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_6_gpu0&#45;&gt;attn_6_gpu0 -->
<g id="edge138" class="edge">
<title>qkv_proj_6_gpu0&#45;&gt;attn_6_gpu0</title>
<path fill="none" stroke="black" d="M2697.19,-15232.17C2699.13,-15224.19 2701.38,-15214.96 2703.49,-15206.3"/>
<polygon fill="black" stroke="black" points="2706.91,-15207.04 2705.88,-15196.5 2700.11,-15205.38 2706.91,-15207.04"/>
</g>
<!-- attn_6_gpu1 -->
<g id="node206" class="node">
<title>attn_6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-15196.48 2856.5,-15196.48 2856.5,-15152.48 2989.5,-15152.48 2989.5,-15196.48"/>
<text text-anchor="middle" x="2923" y="-15183.68" font-family="Arial" font-size="11.00">Attention_6_GPU1</text>
<text text-anchor="middle" x="2923" y="-15171.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2923" y="-15159.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_6_gpu1&#45;&gt;attn_6_gpu1 -->
<g id="edge139" class="edge">
<title>qkv_proj_6_gpu1&#45;&gt;attn_6_gpu1</title>
<path fill="none" stroke="black" d="M2930.27,-15232.17C2929.26,-15224.28 2928.09,-15215.16 2926.99,-15206.58"/>
<polygon fill="black" stroke="black" points="2930.44,-15205.97 2925.69,-15196.5 2923.49,-15206.86 2930.44,-15205.97"/>
</g>
<!-- out_proj_6_gpu0 -->
<g id="node207" class="node">
<title>out_proj_6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-15116.48 2658.5,-15116.48 2658.5,-15072.48 2803.5,-15072.48 2803.5,-15116.48"/>
<text text-anchor="middle" x="2731" y="-15103.68" font-family="Arial" font-size="11.00">Output_Proj_6_GPU0</text>
<text text-anchor="middle" x="2731" y="-15091.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2731" y="-15079.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_6_gpu0&#45;&gt;out_proj_6_gpu0 -->
<g id="edge140" class="edge">
<title>attn_6_gpu0&#45;&gt;out_proj_6_gpu0</title>
<path fill="none" stroke="black" d="M2716.47,-15152.17C2718.51,-15144.19 2720.88,-15134.96 2723.1,-15126.3"/>
<polygon fill="black" stroke="black" points="2726.52,-15127.05 2725.61,-15116.5 2719.74,-15125.31 2726.52,-15127.05"/>
</g>
<!-- out_proj_6_gpu1 -->
<g id="node208" class="node">
<title>out_proj_6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2985.5,-15116.48 2840.5,-15116.48 2840.5,-15072.48 2985.5,-15072.48 2985.5,-15116.48"/>
<text text-anchor="middle" x="2913" y="-15103.68" font-family="Arial" font-size="11.00">Output_Proj_6_GPU1</text>
<text text-anchor="middle" x="2913" y="-15091.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2913" y="-15079.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_6_gpu1&#45;&gt;out_proj_6_gpu1 -->
<g id="edge141" class="edge">
<title>attn_6_gpu1&#45;&gt;out_proj_6_gpu1</title>
<path fill="none" stroke="black" d="M2920.27,-15152.17C2919.26,-15144.28 2918.09,-15135.16 2916.99,-15126.58"/>
<polygon fill="black" stroke="black" points="2920.44,-15125.97 2915.69,-15116.5 2913.49,-15126.86 2920.44,-15125.97"/>
</g>
<!-- mha_merge_6 -->
<g id="node209" class="node">
<title>mha_merge_6</title>
<polygon fill="yellow" stroke="black" points="3044.16,-15036.48 2805.29,-15036.48 2743.84,-14948.48 2982.71,-14948.48 3044.16,-15036.48"/>
<text text-anchor="middle" x="2894" y="-15001.68" font-family="Arial" font-size="11.00">MHA_Merge_6</text>
<text text-anchor="middle" x="2894" y="-14989.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2894" y="-14977.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_6_gpu0&#45;&gt;mha_merge_6 -->
<g id="edge142" class="edge">
<title>out_proj_6_gpu0&#45;&gt;mha_merge_6</title>
<path fill="none" stroke="black" d="M2765.57,-15072.27C2779.97,-15063.44 2797.34,-15052.78 2814.59,-15042.2"/>
<polygon fill="black" stroke="black" points="2816.89,-15044.89 2823.58,-15036.68 2813.23,-15038.93 2816.89,-15044.89"/>
</g>
<!-- out_proj_6_gpu1&#45;&gt;mha_merge_6 -->
<g id="edge143" class="edge">
<title>out_proj_6_gpu1&#45;&gt;mha_merge_6</title>
<path fill="none" stroke="black" d="M2908.97,-15072.27C2907.53,-15064.69 2905.84,-15055.78 2904.12,-15046.72"/>
<polygon fill="black" stroke="black" points="2907.55,-15046.06 2902.25,-15036.89 2900.68,-15047.36 2907.55,-15046.06"/>
</g>
<!-- mha_merge_6&#45;&gt;add_1_6 -->
<g id="edge144" class="edge">
<title>mha_merge_6&#45;&gt;add_1_6</title>
<path fill="none" stroke="black" d="M2918.67,-14948.2C2923.84,-14939.13 2929.18,-14929.76 2934,-14921.31"/>
<polygon fill="black" stroke="black" points="2937.07,-14922.98 2938.98,-14912.56 2930.99,-14919.52 2937.07,-14922.98"/>
</g>
<!-- post_ln_6 -->
<g id="node211" class="node">
<title>post_ln_6</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-14832.48 2822.5,-14832.48 2822.5,-14788.48 2967.5,-14788.48 2967.5,-14832.48"/>
<text text-anchor="middle" x="2895" y="-14819.68" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_6</text>
<text text-anchor="middle" x="2895" y="-14807.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-14795.68" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_6&#45;&gt;post_ln_6 -->
<g id="edge146" class="edge">
<title>add_1_6&#45;&gt;post_ln_6</title>
<path fill="none" stroke="black" d="M2935.7,-14868.17C2929.66,-14859.76 2922.62,-14849.96 2916.12,-14840.89"/>
<polygon fill="black" stroke="black" points="2918.77,-14838.58 2910.09,-14832.5 2913.08,-14842.66 2918.77,-14838.58"/>
</g>
<!-- add_2_6 -->
<g id="node233" class="node">
<title>add_2_6</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-14038.25 2828.5,-14038.25 2828.5,-13994.25 3067.5,-13994.25 3067.5,-14038.25"/>
<text text-anchor="middle" x="2948" y="-14025.45" font-family="Arial" font-size="11.00">Residual_Add2_6</text>
<text text-anchor="middle" x="2948" y="-14013.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-14001.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_6&#45;&gt;add_2_6 -->
<g id="edge155" class="edge">
<title>add_1_6&#45;&gt;add_2_6</title>
<path fill="none" stroke="black" d="M2984.86,-14868.48C3027.99,-14838.82 3097,-14780.3 3097,-14709.48 3097,-14709.48 3097,-14709.48 3097,-14241.25 3097,-14163.44 3138.2,-14128.86 3092,-14066.25 3085.15,-14056.97 3076.44,-14049.42 3066.71,-14043.3"/>
<polygon fill="black" stroke="black" points="3068.33,-14040.2 3057.91,-14038.27 3064.86,-14046.27 3068.33,-14040.2"/>
</g>
<!-- gate_6 -->
<g id="node212" class="node">
<title>gate_6</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-14752.48 2742.05,-14752.48 2655.5,-14664.48 2991.95,-14664.48 3078.5,-14752.48"/>
<text text-anchor="middle" x="2867" y="-14717.68" font-family="Arial" font-size="11.00">Expert_Gate_6</text>
<text text-anchor="middle" x="2867" y="-14705.68" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-14693.68" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_6&#45;&gt;gate_6 -->
<g id="edge147" class="edge">
<title>post_ln_6&#45;&gt;gate_6</title>
<path fill="none" stroke="black" d="M2889.06,-14788.27C2886.94,-14780.69 2884.44,-14771.78 2881.91,-14762.72"/>
<polygon fill="black" stroke="black" points="2885.22,-14761.57 2879.15,-14752.89 2878.48,-14763.46 2885.22,-14761.57"/>
</g>
<!-- token_dist_6 -->
<g id="node213" class="node">
<title>token_dist_6</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-14597.37" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-14606.57" font-family="Arial" font-size="11.00">Token_Distribution_6</text>
<text text-anchor="middle" x="2881" y="-14594.57" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-14582.57" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_6&#45;&gt;token_dist_6 -->
<g id="edge148" class="edge">
<title>gate_6&#45;&gt;token_dist_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-14664.36C2873.61,-14655.98 2874.73,-14647.23 2875.79,-14638.93"/>
<polygon fill="red" stroke="red" points="2879.3,-14639.11 2877.1,-14628.74 2872.36,-14638.22 2879.3,-14639.11"/>
</g>
<!-- expert_6_0_gpu0 -->
<g id="node214" class="node">
<title>expert_6_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-14468.25 2820,-14468.25 2820,-14424.25 2942,-14424.25 2942,-14468.25"/>
<text text-anchor="middle" x="2881" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_6&#45;&gt;expert_6_0_gpu0 -->
<g id="edge149" class="edge">
<title>token_dist_6&#45;&gt;expert_6_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-14566.19C2881,-14540.61 2881,-14504.07 2881,-14478.26"/>
<polygon fill="black" stroke="black" points="2884.5,-14478.26 2881,-14468.26 2877.5,-14478.26 2884.5,-14478.26"/>
</g>
<!-- expert_6_0_gpu1 -->
<g id="node215" class="node">
<title>expert_6_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-14366.25 2885,-14366.25 2885,-14322.25 3007,-14322.25 3007,-14366.25"/>
<text text-anchor="middle" x="2946" y="-14353.45" font-family="Arial" font-size="11.00">Expert_6_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-14341.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-14329.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_6&#45;&gt;expert_6_0_gpu1 -->
<g id="edge150" class="edge">
<title>token_dist_6&#45;&gt;expert_6_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-14568.93C2945.77,-14565.73 2948.67,-14562.18 2951,-14558.25 2984.76,-14501.44 2968.96,-14420.17 2956.33,-14376.26"/>
<polygon fill="black" stroke="black" points="2959.62,-14375.02 2953.38,-14366.45 2952.91,-14377.04 2959.62,-14375.02"/>
</g>
<!-- expert_6_0_gpu0&#45;&gt;expert_6_0_gpu1 -->
<g id="edge151" class="edge">
<title>expert_6_0_gpu0&#45;&gt;expert_6_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-14424.05C2904.09,-14409.73 2916.51,-14390.63 2926.78,-14374.82"/>
<polygon fill="black" stroke="black" points="2929.72,-14376.72 2932.24,-14366.43 2923.85,-14372.91 2929.72,-14376.72"/>
</g>
<!-- expert_merge_6_0 -->
<g id="node216" class="node">
<title>expert_merge_6_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-14286.25 2871.29,-14286.25 2819.53,-14198.25 3020.71,-14198.25 3072.47,-14286.25"/>
<text text-anchor="middle" x="2946" y="-14251.45" font-family="Arial" font-size="11.00">Expert_Merge_6_0</text>
<text text-anchor="middle" x="2946" y="-14239.45" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-14227.45" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_6_0_gpu1&#45;&gt;expert_merge_6_0 -->
<g id="edge152" class="edge">
<title>expert_6_0_gpu1&#45;&gt;expert_merge_6_0</title>
<path fill="none" stroke="black" d="M2946,-14322.05C2946,-14314.55 2946,-14305.74 2946,-14296.78"/>
<polygon fill="black" stroke="black" points="2949.5,-14296.66 2946,-14286.66 2942.5,-14296.66 2949.5,-14296.66"/>
</g>
<!-- expert_agg_6 -->
<g id="node232" class="node">
<title>expert_agg_6</title>
<polygon fill="yellow" stroke="black" points="3077.82,-14162.25 2823.58,-14162.25 2758.18,-14074.25 3012.42,-14074.25 3077.82,-14162.25"/>
<text text-anchor="middle" x="2918" y="-14127.45" font-family="Arial" font-size="11.00">Expert_Aggregation_6</text>
<text text-anchor="middle" x="2918" y="-14115.45" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-14103.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_6_0&#45;&gt;expert_agg_6 -->
<g id="edge153" class="edge">
<title>expert_merge_6_0&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M2936.13,-14198.24C2934.2,-14189.86 2932.17,-14180.98 2930.18,-14172.32"/>
<polygon fill="black" stroke="black" points="2933.53,-14171.25 2927.88,-14162.29 2926.7,-14172.82 2933.53,-14171.25"/>
</g>
<!-- expert_6_1_gpu0 -->
<g id="node217" class="node">
<title>expert_6_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-14468.25 2674,-14468.25 2674,-14424.25 2796,-14424.25 2796,-14468.25"/>
<text text-anchor="middle" x="2735" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_1_gpu1 -->
<g id="node218" class="node">
<title>expert_6_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-14468.25 2534,-14468.25 2534,-14424.25 2656,-14424.25 2656,-14468.25"/>
<text text-anchor="middle" x="2595" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_1 -->
<g id="node219" class="node">
<title>expert_merge_6_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-14490.25 2315.29,-14490.25 2263.53,-14402.25 2464.71,-14402.25 2516.47,-14490.25"/>
<text text-anchor="middle" x="2390" y="-14455.45" font-family="Arial" font-size="11.00">Expert_Merge_6_1</text>
<text text-anchor="middle" x="2390" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_6_2_gpu0 -->
<g id="node220" class="node">
<title>expert_6_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-14468.25 2118,-14468.25 2118,-14424.25 2240,-14424.25 2240,-14468.25"/>
<text text-anchor="middle" x="2179" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_2_gpu1 -->
<g id="node221" class="node">
<title>expert_6_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-14468.25 1978,-14468.25 1978,-14424.25 2100,-14424.25 2100,-14468.25"/>
<text text-anchor="middle" x="2039" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_2 -->
<g id="node222" class="node">
<title>expert_merge_6_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-14490.25 1759.29,-14490.25 1707.53,-14402.25 1908.71,-14402.25 1960.47,-14490.25"/>
<text text-anchor="middle" x="1834" y="-14455.45" font-family="Arial" font-size="11.00">Expert_Merge_6_2</text>
<text text-anchor="middle" x="1834" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_6_61_gpu0 -->
<g id="node223" class="node">
<title>expert_6_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-14468.25 1562,-14468.25 1562,-14424.25 1684,-14424.25 1684,-14468.25"/>
<text text-anchor="middle" x="1623" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_61_gpu1 -->
<g id="node224" class="node">
<title>expert_6_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-14468.25 1422,-14468.25 1422,-14424.25 1544,-14424.25 1544,-14468.25"/>
<text text-anchor="middle" x="1483" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_61 -->
<g id="node225" class="node">
<title>expert_merge_6_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-14490.25 1203.29,-14490.25 1151.53,-14402.25 1352.71,-14402.25 1404.47,-14490.25"/>
<text text-anchor="middle" x="1278" y="-14455.45" font-family="Arial" font-size="11.00">Expert_Merge_6_61</text>
<text text-anchor="middle" x="1278" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_6_62_gpu0 -->
<g id="node226" class="node">
<title>expert_6_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-14468.25 1006,-14468.25 1006,-14424.25 1128,-14424.25 1128,-14468.25"/>
<text text-anchor="middle" x="1067" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_62_gpu1 -->
<g id="node227" class="node">
<title>expert_6_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-14468.25 866,-14468.25 866,-14424.25 988,-14424.25 988,-14468.25"/>
<text text-anchor="middle" x="927" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_62_GPU1</text>
<text text-anchor="middle" x="927" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_62 -->
<g id="node228" class="node">
<title>expert_merge_6_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-14490.25 647.29,-14490.25 595.53,-14402.25 796.71,-14402.25 848.47,-14490.25"/>
<text text-anchor="middle" x="722" y="-14455.45" font-family="Arial" font-size="11.00">Expert_Merge_6_62</text>
<text text-anchor="middle" x="722" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_6_63_gpu0 -->
<g id="node229" class="node">
<title>expert_6_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-14468.25 450,-14468.25 450,-14424.25 572,-14424.25 572,-14468.25"/>
<text text-anchor="middle" x="511" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_63_GPU0</text>
<text text-anchor="middle" x="511" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_63_gpu1 -->
<g id="node230" class="node">
<title>expert_6_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-14468.25 310,-14468.25 310,-14424.25 432,-14424.25 432,-14468.25"/>
<text text-anchor="middle" x="371" y="-14455.45" font-family="Arial" font-size="11.00">Expert_6_63_GPU1</text>
<text text-anchor="middle" x="371" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_63 -->
<g id="node231" class="node">
<title>expert_merge_6_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-14490.25 91.29,-14490.25 39.53,-14402.25 240.71,-14402.25 292.47,-14490.25"/>
<text text-anchor="middle" x="166" y="-14455.45" font-family="Arial" font-size="11.00">Expert_Merge_6_63</text>
<text text-anchor="middle" x="166" y="-14443.45" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-14431.45" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_6&#45;&gt;add_2_6 -->
<g id="edge154" class="edge">
<title>expert_agg_6&#45;&gt;add_2_6</title>
<path fill="none" stroke="black" d="M2930.98,-14073.97C2933.59,-14065.29 2936.28,-14056.33 2938.73,-14048.17"/>
<polygon fill="black" stroke="black" points="2942.15,-14048.92 2941.68,-14038.34 2935.45,-14046.91 2942.15,-14048.92"/>
</g>
<!-- pre_ln_7 -->
<g id="node234" class="node">
<title>pre_ln_7</title>
<polygon fill="lightgreen" stroke="black" points="2927.5,-13944.25 2782.5,-13944.25 2782.5,-13900.25 2927.5,-13900.25 2927.5,-13944.25"/>
<text text-anchor="middle" x="2855" y="-13931.45" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_7</text>
<text text-anchor="middle" x="2855" y="-13919.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-13907.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_6&#45;&gt;pre_ln_7 -->
<g id="edge156" class="edge">
<title>add_2_6&#45;&gt;pre_ln_7</title>
<path fill="none" stroke="black" d="M2926.43,-13993.92C2913.75,-13981.38 2897.57,-13965.36 2883.81,-13951.75"/>
<polygon fill="black" stroke="black" points="2886.02,-13949.02 2876.45,-13944.48 2881.1,-13954 2886.02,-13949.02"/>
</g>
<!-- add_1_7 -->
<g id="node243" class="node">
<title>add_1_7</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-13370.25 2831.5,-13370.25 2831.5,-13326.25 3070.5,-13326.25 3070.5,-13370.25"/>
<text text-anchor="middle" x="2951" y="-13357.45" font-family="Arial" font-size="11.00">Residual_Add1_7</text>
<text text-anchor="middle" x="2951" y="-13345.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-13333.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_6&#45;&gt;add_1_7 -->
<g id="edge167" class="edge">
<title>add_2_6&#45;&gt;add_1_7</title>
<path fill="none" stroke="black" d="M2954.71,-13994.19C2965.62,-13958.01 2986,-13881.52 2986,-13815.25 2986,-13815.25 2986,-13815.25 2986,-13551.25 2986,-13483.16 2996.68,-13463.73 2978,-13398.25 2976.18,-13391.88 2973.41,-13385.42 2970.33,-13379.38"/>
<polygon fill="black" stroke="black" points="2973.21,-13377.36 2965.32,-13370.29 2967.08,-13380.74 2973.21,-13377.36"/>
</g>
<!-- mha_input_7 -->
<g id="node235" class="node">
<title>mha_input_7</title>
<polygon fill="yellow" stroke="black" points="2966.16,-13858.25 2727.29,-13858.25 2665.84,-13770.25 2904.71,-13770.25 2966.16,-13858.25"/>
<text text-anchor="middle" x="2816" y="-13823.45" font-family="Arial" font-size="11.00">MHA_Input_7</text>
<text text-anchor="middle" x="2816" y="-13811.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2816" y="-13799.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_7&#45;&gt;mha_input_7 -->
<g id="edge157" class="edge">
<title>pre_ln_7&#45;&gt;mha_input_7</title>
<path fill="none" stroke="black" d="M2847.2,-13900.06C2843.76,-13890.71 2839.55,-13879.27 2835.35,-13867.86"/>
<polygon fill="black" stroke="black" points="2838.58,-13866.5 2831.85,-13858.32 2832.01,-13868.92 2838.58,-13866.5"/>
</g>
<!-- qkv_proj_7_gpu0 -->
<g id="node236" class="node">
<title>qkv_proj_7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2725.5,-13734.25 2502.5,-13734.25 2502.5,-13690.25 2725.5,-13690.25 2725.5,-13734.25"/>
<text text-anchor="middle" x="2614" y="-13721.45" font-family="Arial" font-size="11.00">QKV_Proj_7_GPU0</text>
<text text-anchor="middle" x="2614" y="-13709.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2614" y="-13697.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_7&#45;&gt;qkv_proj_7_gpu0 -->
<g id="edge158" class="edge">
<title>mha_input_7&#45;&gt;qkv_proj_7_gpu0</title>
<path fill="none" stroke="black" d="M2728.87,-13770.12C2707.3,-13759.44 2684.88,-13748.34 2665.63,-13738.81"/>
<polygon fill="black" stroke="black" points="2666.97,-13735.57 2656.45,-13734.27 2663.86,-13741.84 2666.97,-13735.57"/>
</g>
<!-- qkv_proj_7_gpu1 -->
<g id="node237" class="node">
<title>qkv_proj_7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2966.5,-13734.25 2743.5,-13734.25 2743.5,-13690.25 2966.5,-13690.25 2966.5,-13734.25"/>
<text text-anchor="middle" x="2855" y="-13721.45" font-family="Arial" font-size="11.00">QKV_Proj_7_GPU1</text>
<text text-anchor="middle" x="2855" y="-13709.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-13697.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_7&#45;&gt;qkv_proj_7_gpu1 -->
<g id="edge159" class="edge">
<title>mha_input_7&#45;&gt;qkv_proj_7_gpu1</title>
<path fill="none" stroke="black" d="M2832.88,-13769.97C2836.3,-13761.19 2839.84,-13752.13 2843.05,-13743.9"/>
<polygon fill="black" stroke="black" points="2846.41,-13744.92 2846.78,-13734.34 2839.88,-13742.38 2846.41,-13744.92"/>
</g>
<!-- attn_7_gpu0 -->
<g id="node238" class="node">
<title>attn_7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2695.5,-13654.25 2562.5,-13654.25 2562.5,-13610.25 2695.5,-13610.25 2695.5,-13654.25"/>
<text text-anchor="middle" x="2629" y="-13641.45" font-family="Arial" font-size="11.00">Attention_7_GPU0</text>
<text text-anchor="middle" x="2629" y="-13629.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2629" y="-13617.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_7_gpu0&#45;&gt;attn_7_gpu0 -->
<g id="edge160" class="edge">
<title>qkv_proj_7_gpu0&#45;&gt;attn_7_gpu0</title>
<path fill="none" stroke="black" d="M2618.1,-13689.94C2619.62,-13682.05 2621.37,-13672.94 2623.02,-13664.36"/>
<polygon fill="black" stroke="black" points="2626.51,-13664.75 2624.96,-13654.27 2619.63,-13663.43 2626.51,-13664.75"/>
</g>
<!-- attn_7_gpu1 -->
<g id="node239" class="node">
<title>attn_7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2911.5,-13654.25 2778.5,-13654.25 2778.5,-13610.25 2911.5,-13610.25 2911.5,-13654.25"/>
<text text-anchor="middle" x="2845" y="-13641.45" font-family="Arial" font-size="11.00">Attention_7_GPU1</text>
<text text-anchor="middle" x="2845" y="-13629.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2845" y="-13617.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_7_gpu1&#45;&gt;attn_7_gpu1 -->
<g id="edge161" class="edge">
<title>qkv_proj_7_gpu1&#45;&gt;attn_7_gpu1</title>
<path fill="none" stroke="black" d="M2852.27,-13689.94C2851.26,-13682.05 2850.09,-13672.94 2848.99,-13664.36"/>
<polygon fill="black" stroke="black" points="2852.44,-13663.75 2847.69,-13654.27 2845.49,-13664.64 2852.44,-13663.75"/>
</g>
<!-- out_proj_7_gpu0 -->
<g id="node240" class="node">
<title>out_proj_7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2730.5,-13574.25 2585.5,-13574.25 2585.5,-13530.25 2730.5,-13530.25 2730.5,-13574.25"/>
<text text-anchor="middle" x="2658" y="-13561.45" font-family="Arial" font-size="11.00">Output_Proj_7_GPU0</text>
<text text-anchor="middle" x="2658" y="-13549.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2658" y="-13537.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_7_gpu0&#45;&gt;out_proj_7_gpu0 -->
<g id="edge162" class="edge">
<title>attn_7_gpu0&#45;&gt;out_proj_7_gpu0</title>
<path fill="none" stroke="black" d="M2636.92,-13609.94C2639.92,-13601.88 2643.39,-13592.54 2646.65,-13583.79"/>
<polygon fill="black" stroke="black" points="2649.98,-13584.86 2650.19,-13574.27 2643.42,-13582.43 2649.98,-13584.86"/>
</g>
<!-- out_proj_7_gpu1 -->
<g id="node241" class="node">
<title>out_proj_7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2907.5,-13574.25 2762.5,-13574.25 2762.5,-13530.25 2907.5,-13530.25 2907.5,-13574.25"/>
<text text-anchor="middle" x="2835" y="-13561.45" font-family="Arial" font-size="11.00">Output_Proj_7_GPU1</text>
<text text-anchor="middle" x="2835" y="-13549.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2835" y="-13537.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_7_gpu1&#45;&gt;out_proj_7_gpu1 -->
<g id="edge163" class="edge">
<title>attn_7_gpu1&#45;&gt;out_proj_7_gpu1</title>
<path fill="none" stroke="black" d="M2842.27,-13609.94C2841.26,-13602.05 2840.09,-13592.94 2838.99,-13584.36"/>
<polygon fill="black" stroke="black" points="2842.44,-13583.75 2837.69,-13574.27 2835.49,-13584.64 2842.44,-13583.75"/>
</g>
<!-- mha_merge_7 -->
<g id="node242" class="node">
<title>mha_merge_7</title>
<polygon fill="yellow" stroke="black" points="2966.16,-13494.25 2727.29,-13494.25 2665.84,-13406.25 2904.71,-13406.25 2966.16,-13494.25"/>
<text text-anchor="middle" x="2816" y="-13459.45" font-family="Arial" font-size="11.00">MHA_Merge_7</text>
<text text-anchor="middle" x="2816" y="-13447.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2816" y="-13435.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_7_gpu0&#45;&gt;mha_merge_7 -->
<g id="edge164" class="edge">
<title>out_proj_7_gpu0&#45;&gt;mha_merge_7</title>
<path fill="none" stroke="black" d="M2691.51,-13530.05C2705.47,-13521.21 2722.31,-13510.55 2739.02,-13499.97"/>
<polygon fill="black" stroke="black" points="2741.16,-13502.76 2747.74,-13494.46 2737.42,-13496.85 2741.16,-13502.76"/>
</g>
<!-- out_proj_7_gpu1&#45;&gt;mha_merge_7 -->
<g id="edge165" class="edge">
<title>out_proj_7_gpu1&#45;&gt;mha_merge_7</title>
<path fill="none" stroke="black" d="M2830.97,-13530.05C2829.53,-13522.47 2827.84,-13513.55 2826.12,-13504.49"/>
<polygon fill="black" stroke="black" points="2829.55,-13503.83 2824.25,-13494.66 2822.68,-13505.14 2829.55,-13503.83"/>
</g>
<!-- mha_merge_7&#45;&gt;add_1_7 -->
<g id="edge166" class="edge">
<title>mha_merge_7&#45;&gt;add_1_7</title>
<path fill="none" stroke="black" d="M2874.43,-13405.97C2887.98,-13395.94 2902.02,-13385.53 2914.33,-13376.42"/>
<polygon fill="black" stroke="black" points="2916.59,-13379.1 2922.54,-13370.34 2912.42,-13373.48 2916.59,-13379.1"/>
</g>
<!-- post_ln_7 -->
<g id="node244" class="node">
<title>post_ln_7</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-13290.25 2822.5,-13290.25 2822.5,-13246.25 2967.5,-13246.25 2967.5,-13290.25"/>
<text text-anchor="middle" x="2895" y="-13277.45" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_7</text>
<text text-anchor="middle" x="2895" y="-13265.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-13253.45" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_7&#45;&gt;post_ln_7 -->
<g id="edge168" class="edge">
<title>add_1_7&#45;&gt;post_ln_7</title>
<path fill="none" stroke="black" d="M2935.7,-13325.94C2929.66,-13317.53 2922.62,-13307.73 2916.12,-13298.67"/>
<polygon fill="black" stroke="black" points="2918.77,-13296.35 2910.09,-13290.27 2913.08,-13300.44 2918.77,-13296.35"/>
</g>
<!-- add_2_7 -->
<g id="node266" class="node">
<title>add_2_7</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-12496.03 2828.5,-12496.03 2828.5,-12452.03 3067.5,-12452.03 3067.5,-12496.03"/>
<text text-anchor="middle" x="2948" y="-12483.23" font-family="Arial" font-size="11.00">Residual_Add2_7</text>
<text text-anchor="middle" x="2948" y="-12471.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-12459.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_7&#45;&gt;add_2_7 -->
<g id="edge177" class="edge">
<title>add_1_7&#45;&gt;add_2_7</title>
<path fill="none" stroke="black" d="M2984.86,-13326.25C3027.99,-13296.59 3097,-13238.07 3097,-13167.25 3097,-13167.25 3097,-13167.25 3097,-12699.03 3097,-12621.22 3138.2,-12586.64 3092,-12524.03 3085.15,-12514.74 3076.44,-12507.2 3066.71,-12501.07"/>
<polygon fill="black" stroke="black" points="3068.33,-12497.97 3057.91,-12496.05 3064.86,-12504.05 3068.33,-12497.97"/>
</g>
<!-- gate_7 -->
<g id="node245" class="node">
<title>gate_7</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-13210.25 2742.05,-13210.25 2655.5,-13122.25 2991.95,-13122.25 3078.5,-13210.25"/>
<text text-anchor="middle" x="2867" y="-13175.45" font-family="Arial" font-size="11.00">Expert_Gate_7</text>
<text text-anchor="middle" x="2867" y="-13163.45" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-13151.45" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_7&#45;&gt;gate_7 -->
<g id="edge169" class="edge">
<title>post_ln_7&#45;&gt;gate_7</title>
<path fill="none" stroke="black" d="M2889.06,-13246.05C2886.94,-13238.47 2884.44,-13229.55 2881.91,-13220.49"/>
<polygon fill="black" stroke="black" points="2885.22,-13219.35 2879.15,-13210.66 2878.48,-13221.23 2885.22,-13219.35"/>
</g>
<!-- token_dist_7 -->
<g id="node246" class="node">
<title>token_dist_7</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-13055.14" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-13064.34" font-family="Arial" font-size="11.00">Token_Distribution_7</text>
<text text-anchor="middle" x="2881" y="-13052.34" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-13040.34" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_7&#45;&gt;token_dist_7 -->
<g id="edge170" class="edge">
<title>gate_7&#45;&gt;token_dist_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-13122.13C2873.61,-13113.75 2874.73,-13105 2875.79,-13096.71"/>
<polygon fill="red" stroke="red" points="2879.3,-13096.88 2877.1,-13086.52 2872.36,-13095.99 2879.3,-13096.88"/>
</g>
<!-- expert_7_0_gpu0 -->
<g id="node247" class="node">
<title>expert_7_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-12926.03 2820,-12926.03 2820,-12882.03 2942,-12882.03 2942,-12926.03"/>
<text text-anchor="middle" x="2881" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_7&#45;&gt;expert_7_0_gpu0 -->
<g id="edge171" class="edge">
<title>token_dist_7&#45;&gt;expert_7_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-13023.97C2881,-12998.39 2881,-12961.85 2881,-12936.03"/>
<polygon fill="black" stroke="black" points="2884.5,-12936.03 2881,-12926.03 2877.5,-12936.03 2884.5,-12936.03"/>
</g>
<!-- expert_7_0_gpu1 -->
<g id="node248" class="node">
<title>expert_7_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-12824.03 2885,-12824.03 2885,-12780.03 3007,-12780.03 3007,-12824.03"/>
<text text-anchor="middle" x="2946" y="-12811.23" font-family="Arial" font-size="11.00">Expert_7_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-12799.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-12787.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_7&#45;&gt;expert_7_0_gpu1 -->
<g id="edge172" class="edge">
<title>token_dist_7&#45;&gt;expert_7_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-13026.7C2945.77,-13023.5 2948.67,-13019.95 2951,-13016.03 2984.76,-12959.21 2968.96,-12877.94 2956.33,-12834.04"/>
<polygon fill="black" stroke="black" points="2959.62,-12832.8 2953.38,-12824.23 2952.91,-12834.81 2959.62,-12832.8"/>
</g>
<!-- expert_7_0_gpu0&#45;&gt;expert_7_0_gpu1 -->
<g id="edge173" class="edge">
<title>expert_7_0_gpu0&#45;&gt;expert_7_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-12881.82C2904.09,-12867.5 2916.51,-12848.4 2926.78,-12832.6"/>
<polygon fill="black" stroke="black" points="2929.72,-12834.5 2932.24,-12824.21 2923.85,-12830.68 2929.72,-12834.5"/>
</g>
<!-- expert_merge_7_0 -->
<g id="node249" class="node">
<title>expert_merge_7_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-12744.03 2871.29,-12744.03 2819.53,-12656.03 3020.71,-12656.03 3072.47,-12744.03"/>
<text text-anchor="middle" x="2946" y="-12709.23" font-family="Arial" font-size="11.00">Expert_Merge_7_0</text>
<text text-anchor="middle" x="2946" y="-12697.23" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-12685.23" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_7_0_gpu1&#45;&gt;expert_merge_7_0 -->
<g id="edge174" class="edge">
<title>expert_7_0_gpu1&#45;&gt;expert_merge_7_0</title>
<path fill="none" stroke="black" d="M2946,-12779.82C2946,-12772.32 2946,-12763.51 2946,-12754.55"/>
<polygon fill="black" stroke="black" points="2949.5,-12754.44 2946,-12744.44 2942.5,-12754.44 2949.5,-12754.44"/>
</g>
<!-- expert_agg_7 -->
<g id="node265" class="node">
<title>expert_agg_7</title>
<polygon fill="yellow" stroke="black" points="3077.82,-12620.03 2823.58,-12620.03 2758.18,-12532.03 3012.42,-12532.03 3077.82,-12620.03"/>
<text text-anchor="middle" x="2918" y="-12585.23" font-family="Arial" font-size="11.00">Expert_Aggregation_7</text>
<text text-anchor="middle" x="2918" y="-12573.23" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-12561.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_7_0&#45;&gt;expert_agg_7 -->
<g id="edge175" class="edge">
<title>expert_merge_7_0&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M2936.13,-12656.02C2934.2,-12647.63 2932.17,-12638.75 2930.18,-12630.09"/>
<polygon fill="black" stroke="black" points="2933.53,-12629.03 2927.88,-12620.06 2926.7,-12630.59 2933.53,-12629.03"/>
</g>
<!-- expert_7_1_gpu0 -->
<g id="node250" class="node">
<title>expert_7_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-12926.03 2674,-12926.03 2674,-12882.03 2796,-12882.03 2796,-12926.03"/>
<text text-anchor="middle" x="2735" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_1_gpu1 -->
<g id="node251" class="node">
<title>expert_7_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-12926.03 2534,-12926.03 2534,-12882.03 2656,-12882.03 2656,-12926.03"/>
<text text-anchor="middle" x="2595" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_1 -->
<g id="node252" class="node">
<title>expert_merge_7_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-12948.03 2315.29,-12948.03 2263.53,-12860.03 2464.71,-12860.03 2516.47,-12948.03"/>
<text text-anchor="middle" x="2390" y="-12913.23" font-family="Arial" font-size="11.00">Expert_Merge_7_1</text>
<text text-anchor="middle" x="2390" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_7_2_gpu0 -->
<g id="node253" class="node">
<title>expert_7_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-12926.03 2118,-12926.03 2118,-12882.03 2240,-12882.03 2240,-12926.03"/>
<text text-anchor="middle" x="2179" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_2_gpu1 -->
<g id="node254" class="node">
<title>expert_7_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-12926.03 1978,-12926.03 1978,-12882.03 2100,-12882.03 2100,-12926.03"/>
<text text-anchor="middle" x="2039" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_2 -->
<g id="node255" class="node">
<title>expert_merge_7_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-12948.03 1759.29,-12948.03 1707.53,-12860.03 1908.71,-12860.03 1960.47,-12948.03"/>
<text text-anchor="middle" x="1834" y="-12913.23" font-family="Arial" font-size="11.00">Expert_Merge_7_2</text>
<text text-anchor="middle" x="1834" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_7_61_gpu0 -->
<g id="node256" class="node">
<title>expert_7_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-12926.03 1562,-12926.03 1562,-12882.03 1684,-12882.03 1684,-12926.03"/>
<text text-anchor="middle" x="1623" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_61_gpu1 -->
<g id="node257" class="node">
<title>expert_7_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-12926.03 1422,-12926.03 1422,-12882.03 1544,-12882.03 1544,-12926.03"/>
<text text-anchor="middle" x="1483" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_61 -->
<g id="node258" class="node">
<title>expert_merge_7_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-12948.03 1203.29,-12948.03 1151.53,-12860.03 1352.71,-12860.03 1404.47,-12948.03"/>
<text text-anchor="middle" x="1278" y="-12913.23" font-family="Arial" font-size="11.00">Expert_Merge_7_61</text>
<text text-anchor="middle" x="1278" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_7_62_gpu0 -->
<g id="node259" class="node">
<title>expert_7_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-12926.03 1006,-12926.03 1006,-12882.03 1128,-12882.03 1128,-12926.03"/>
<text text-anchor="middle" x="1067" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_62_gpu1 -->
<g id="node260" class="node">
<title>expert_7_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-12926.03 866,-12926.03 866,-12882.03 988,-12882.03 988,-12926.03"/>
<text text-anchor="middle" x="927" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_62_GPU1</text>
<text text-anchor="middle" x="927" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_62 -->
<g id="node261" class="node">
<title>expert_merge_7_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-12948.03 647.29,-12948.03 595.53,-12860.03 796.71,-12860.03 848.47,-12948.03"/>
<text text-anchor="middle" x="722" y="-12913.23" font-family="Arial" font-size="11.00">Expert_Merge_7_62</text>
<text text-anchor="middle" x="722" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_7_63_gpu0 -->
<g id="node262" class="node">
<title>expert_7_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-12926.03 450,-12926.03 450,-12882.03 572,-12882.03 572,-12926.03"/>
<text text-anchor="middle" x="511" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_63_GPU0</text>
<text text-anchor="middle" x="511" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_63_gpu1 -->
<g id="node263" class="node">
<title>expert_7_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-12926.03 310,-12926.03 310,-12882.03 432,-12882.03 432,-12926.03"/>
<text text-anchor="middle" x="371" y="-12913.23" font-family="Arial" font-size="11.00">Expert_7_63_GPU1</text>
<text text-anchor="middle" x="371" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_63 -->
<g id="node264" class="node">
<title>expert_merge_7_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-12948.03 91.29,-12948.03 39.53,-12860.03 240.71,-12860.03 292.47,-12948.03"/>
<text text-anchor="middle" x="166" y="-12913.23" font-family="Arial" font-size="11.00">Expert_Merge_7_63</text>
<text text-anchor="middle" x="166" y="-12901.23" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-12889.23" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_7&#45;&gt;add_2_7 -->
<g id="edge176" class="edge">
<title>expert_agg_7&#45;&gt;add_2_7</title>
<path fill="none" stroke="black" d="M2930.98,-12531.75C2933.59,-12523.06 2936.28,-12514.1 2938.73,-12505.94"/>
<polygon fill="black" stroke="black" points="2942.15,-12506.69 2941.68,-12496.11 2935.45,-12504.68 2942.15,-12506.69"/>
</g>
<!-- pre_ln_8 -->
<g id="node267" class="node">
<title>pre_ln_8</title>
<polygon fill="lightgreen" stroke="black" points="2927.5,-12402.03 2782.5,-12402.03 2782.5,-12358.03 2927.5,-12358.03 2927.5,-12402.03"/>
<text text-anchor="middle" x="2855" y="-12389.23" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_8</text>
<text text-anchor="middle" x="2855" y="-12377.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-12365.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_7&#45;&gt;pre_ln_8 -->
<g id="edge178" class="edge">
<title>add_2_7&#45;&gt;pre_ln_8</title>
<path fill="none" stroke="black" d="M2926.43,-12451.69C2913.75,-12439.15 2897.57,-12423.14 2883.81,-12409.53"/>
<polygon fill="black" stroke="black" points="2886.02,-12406.8 2876.45,-12402.25 2881.1,-12411.77 2886.02,-12406.8"/>
</g>
<!-- add_1_8 -->
<g id="node276" class="node">
<title>add_1_8</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-11828.03 2831.5,-11828.03 2831.5,-11784.03 3070.5,-11784.03 3070.5,-11828.03"/>
<text text-anchor="middle" x="2951" y="-11815.23" font-family="Arial" font-size="11.00">Residual_Add1_8</text>
<text text-anchor="middle" x="2951" y="-11803.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-11791.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_7&#45;&gt;add_1_8 -->
<g id="edge189" class="edge">
<title>add_2_7&#45;&gt;add_1_8</title>
<path fill="none" stroke="black" d="M2954.71,-12451.97C2965.62,-12415.78 2986,-12339.3 2986,-12273.03 2986,-12273.03 2986,-12273.03 2986,-12009.03 2986,-11940.94 2996.68,-11921.51 2978,-11856.03 2976.18,-11849.65 2973.41,-11843.2 2970.33,-11837.15"/>
<polygon fill="black" stroke="black" points="2973.21,-11835.13 2965.32,-11828.06 2967.08,-11838.51 2973.21,-11835.13"/>
</g>
<!-- mha_input_8 -->
<g id="node268" class="node">
<title>mha_input_8</title>
<polygon fill="yellow" stroke="black" points="2966.16,-12316.03 2727.29,-12316.03 2665.84,-12228.03 2904.71,-12228.03 2966.16,-12316.03"/>
<text text-anchor="middle" x="2816" y="-12281.23" font-family="Arial" font-size="11.00">MHA_Input_8</text>
<text text-anchor="middle" x="2816" y="-12269.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2816" y="-12257.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_8&#45;&gt;mha_input_8 -->
<g id="edge179" class="edge">
<title>pre_ln_8&#45;&gt;mha_input_8</title>
<path fill="none" stroke="black" d="M2847.2,-12357.83C2843.76,-12348.49 2839.55,-12337.05 2835.35,-12325.63"/>
<polygon fill="black" stroke="black" points="2838.58,-12324.27 2831.85,-12316.1 2832.01,-12326.69 2838.58,-12324.27"/>
</g>
<!-- qkv_proj_8_gpu0 -->
<g id="node269" class="node">
<title>qkv_proj_8_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2725.5,-12192.03 2502.5,-12192.03 2502.5,-12148.03 2725.5,-12148.03 2725.5,-12192.03"/>
<text text-anchor="middle" x="2614" y="-12179.23" font-family="Arial" font-size="11.00">QKV_Proj_8_GPU0</text>
<text text-anchor="middle" x="2614" y="-12167.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2614" y="-12155.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_8&#45;&gt;qkv_proj_8_gpu0 -->
<g id="edge180" class="edge">
<title>mha_input_8&#45;&gt;qkv_proj_8_gpu0</title>
<path fill="none" stroke="black" d="M2728.87,-12227.89C2707.3,-12217.22 2684.88,-12206.12 2665.63,-12196.59"/>
<polygon fill="black" stroke="black" points="2666.97,-12193.34 2656.45,-12192.04 2663.86,-12199.62 2666.97,-12193.34"/>
</g>
<!-- qkv_proj_8_gpu1 -->
<g id="node270" class="node">
<title>qkv_proj_8_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2966.5,-12192.03 2743.5,-12192.03 2743.5,-12148.03 2966.5,-12148.03 2966.5,-12192.03"/>
<text text-anchor="middle" x="2855" y="-12179.23" font-family="Arial" font-size="11.00">QKV_Proj_8_GPU1</text>
<text text-anchor="middle" x="2855" y="-12167.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-12155.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_8&#45;&gt;qkv_proj_8_gpu1 -->
<g id="edge181" class="edge">
<title>mha_input_8&#45;&gt;qkv_proj_8_gpu1</title>
<path fill="none" stroke="black" d="M2832.88,-12227.75C2836.3,-12218.97 2839.84,-12209.9 2843.05,-12201.67"/>
<polygon fill="black" stroke="black" points="2846.41,-12202.7 2846.78,-12192.11 2839.88,-12200.16 2846.41,-12202.7"/>
</g>
<!-- attn_8_gpu0 -->
<g id="node271" class="node">
<title>attn_8_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2694.5,-12112.03 2561.5,-12112.03 2561.5,-12068.03 2694.5,-12068.03 2694.5,-12112.03"/>
<text text-anchor="middle" x="2628" y="-12099.23" font-family="Arial" font-size="11.00">Attention_8_GPU0</text>
<text text-anchor="middle" x="2628" y="-12087.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2628" y="-12075.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_8_gpu0&#45;&gt;attn_8_gpu0 -->
<g id="edge182" class="edge">
<title>qkv_proj_8_gpu0&#45;&gt;attn_8_gpu0</title>
<path fill="none" stroke="black" d="M2617.83,-12147.71C2619.24,-12139.83 2620.88,-12130.71 2622.42,-12122.13"/>
<polygon fill="black" stroke="black" points="2625.91,-12122.51 2624.23,-12112.05 2619.02,-12121.27 2625.91,-12122.51"/>
</g>
<!-- attn_8_gpu1 -->
<g id="node272" class="node">
<title>attn_8_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2911.5,-12112.03 2778.5,-12112.03 2778.5,-12068.03 2911.5,-12068.03 2911.5,-12112.03"/>
<text text-anchor="middle" x="2845" y="-12099.23" font-family="Arial" font-size="11.00">Attention_8_GPU1</text>
<text text-anchor="middle" x="2845" y="-12087.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2845" y="-12075.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_8_gpu1&#45;&gt;attn_8_gpu1 -->
<g id="edge183" class="edge">
<title>qkv_proj_8_gpu1&#45;&gt;attn_8_gpu1</title>
<path fill="none" stroke="black" d="M2852.27,-12147.71C2851.26,-12139.83 2850.09,-12130.71 2848.99,-12122.13"/>
<polygon fill="black" stroke="black" points="2852.44,-12121.52 2847.69,-12112.05 2845.49,-12122.41 2852.44,-12121.52"/>
</g>
<!-- out_proj_8_gpu0 -->
<g id="node273" class="node">
<title>out_proj_8_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2715.5,-12032.03 2570.5,-12032.03 2570.5,-11988.03 2715.5,-11988.03 2715.5,-12032.03"/>
<text text-anchor="middle" x="2643" y="-12019.23" font-family="Arial" font-size="11.00">Output_Proj_8_GPU0</text>
<text text-anchor="middle" x="2643" y="-12007.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2643" y="-11995.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_8_gpu0&#45;&gt;out_proj_8_gpu0 -->
<g id="edge184" class="edge">
<title>attn_8_gpu0&#45;&gt;out_proj_8_gpu0</title>
<path fill="none" stroke="black" d="M2632.1,-12067.71C2633.62,-12059.83 2635.37,-12050.71 2637.02,-12042.13"/>
<polygon fill="black" stroke="black" points="2640.51,-12042.53 2638.96,-12032.05 2633.63,-12041.21 2640.51,-12042.53"/>
</g>
<!-- out_proj_8_gpu1 -->
<g id="node274" class="node">
<title>out_proj_8_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2907.5,-12032.03 2762.5,-12032.03 2762.5,-11988.03 2907.5,-11988.03 2907.5,-12032.03"/>
<text text-anchor="middle" x="2835" y="-12019.23" font-family="Arial" font-size="11.00">Output_Proj_8_GPU1</text>
<text text-anchor="middle" x="2835" y="-12007.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2835" y="-11995.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_8_gpu1&#45;&gt;out_proj_8_gpu1 -->
<g id="edge185" class="edge">
<title>attn_8_gpu1&#45;&gt;out_proj_8_gpu1</title>
<path fill="none" stroke="black" d="M2842.27,-12067.71C2841.26,-12059.83 2840.09,-12050.71 2838.99,-12042.13"/>
<polygon fill="black" stroke="black" points="2842.44,-12041.52 2837.69,-12032.05 2835.49,-12042.41 2842.44,-12041.52"/>
</g>
<!-- mha_merge_8 -->
<g id="node275" class="node">
<title>mha_merge_8</title>
<polygon fill="yellow" stroke="black" points="2966.16,-11952.03 2727.29,-11952.03 2665.84,-11864.03 2904.71,-11864.03 2966.16,-11952.03"/>
<text text-anchor="middle" x="2816" y="-11917.23" font-family="Arial" font-size="11.00">MHA_Merge_8</text>
<text text-anchor="middle" x="2816" y="-11905.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2816" y="-11893.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_8_gpu0&#45;&gt;mha_merge_8 -->
<g id="edge186" class="edge">
<title>out_proj_8_gpu0&#45;&gt;mha_merge_8</title>
<path fill="none" stroke="black" d="M2679.69,-11987.82C2695.19,-11978.86 2713.92,-11968.03 2732.47,-11957.31"/>
<polygon fill="black" stroke="black" points="2734.35,-11960.27 2741.26,-11952.23 2730.85,-11954.21 2734.35,-11960.27"/>
</g>
<!-- out_proj_8_gpu1&#45;&gt;mha_merge_8 -->
<g id="edge187" class="edge">
<title>out_proj_8_gpu1&#45;&gt;mha_merge_8</title>
<path fill="none" stroke="black" d="M2830.97,-11987.82C2829.53,-11980.24 2827.84,-11971.33 2826.12,-11962.27"/>
<polygon fill="black" stroke="black" points="2829.55,-11961.61 2824.25,-11952.44 2822.68,-11962.91 2829.55,-11961.61"/>
</g>
<!-- mha_merge_8&#45;&gt;add_1_8 -->
<g id="edge188" class="edge">
<title>mha_merge_8&#45;&gt;add_1_8</title>
<path fill="none" stroke="black" d="M2874.43,-11863.75C2887.98,-11853.71 2902.02,-11843.31 2914.33,-11834.19"/>
<polygon fill="black" stroke="black" points="2916.59,-11836.88 2922.54,-11828.11 2912.42,-11831.25 2916.59,-11836.88"/>
</g>
<!-- post_ln_8 -->
<g id="node277" class="node">
<title>post_ln_8</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-11748.03 2822.5,-11748.03 2822.5,-11704.03 2967.5,-11704.03 2967.5,-11748.03"/>
<text text-anchor="middle" x="2895" y="-11735.23" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_8</text>
<text text-anchor="middle" x="2895" y="-11723.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-11711.23" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_8&#45;&gt;post_ln_8 -->
<g id="edge190" class="edge">
<title>add_1_8&#45;&gt;post_ln_8</title>
<path fill="none" stroke="black" d="M2935.7,-11783.71C2929.66,-11775.31 2922.62,-11765.51 2916.12,-11756.44"/>
<polygon fill="black" stroke="black" points="2918.77,-11754.13 2910.09,-11748.05 2913.08,-11758.21 2918.77,-11754.13"/>
</g>
<!-- add_2_8 -->
<g id="node299" class="node">
<title>add_2_8</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-10953.8 2828.5,-10953.8 2828.5,-10909.8 3067.5,-10909.8 3067.5,-10953.8"/>
<text text-anchor="middle" x="2948" y="-10941" font-family="Arial" font-size="11.00">Residual_Add2_8</text>
<text text-anchor="middle" x="2948" y="-10929" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-10917" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_8&#45;&gt;add_2_8 -->
<g id="edge199" class="edge">
<title>add_1_8&#45;&gt;add_2_8</title>
<path fill="none" stroke="black" d="M2984.86,-11784.03C3027.99,-11754.37 3097,-11695.85 3097,-11625.03 3097,-11625.03 3097,-11625.03 3097,-11156.8 3097,-11078.99 3138.2,-11044.41 3092,-10981.8 3085.15,-10972.52 3076.44,-10964.97 3066.71,-10958.85"/>
<polygon fill="black" stroke="black" points="3068.33,-10955.75 3057.91,-10953.82 3064.86,-10961.82 3068.33,-10955.75"/>
</g>
<!-- gate_8 -->
<g id="node278" class="node">
<title>gate_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-11668.03 2742.05,-11668.03 2655.5,-11580.03 2991.95,-11580.03 3078.5,-11668.03"/>
<text text-anchor="middle" x="2867" y="-11633.23" font-family="Arial" font-size="11.00">Expert_Gate_8</text>
<text text-anchor="middle" x="2867" y="-11621.23" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-11609.23" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_8&#45;&gt;gate_8 -->
<g id="edge191" class="edge">
<title>post_ln_8&#45;&gt;gate_8</title>
<path fill="none" stroke="black" d="M2889.06,-11703.82C2886.94,-11696.24 2884.44,-11687.33 2881.91,-11678.27"/>
<polygon fill="black" stroke="black" points="2885.22,-11677.12 2879.15,-11668.44 2878.48,-11679.01 2885.22,-11677.12"/>
</g>
<!-- token_dist_8 -->
<g id="node279" class="node">
<title>token_dist_8</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-11512.92" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-11522.12" font-family="Arial" font-size="11.00">Token_Distribution_8</text>
<text text-anchor="middle" x="2881" y="-11510.12" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-11498.12" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_8&#45;&gt;token_dist_8 -->
<g id="edge192" class="edge">
<title>gate_8&#45;&gt;token_dist_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-11579.9C2873.61,-11571.53 2874.73,-11562.77 2875.79,-11554.48"/>
<polygon fill="red" stroke="red" points="2879.3,-11554.66 2877.1,-11544.29 2872.36,-11553.76 2879.3,-11554.66"/>
</g>
<!-- expert_8_0_gpu0 -->
<g id="node280" class="node">
<title>expert_8_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-11383.8 2820,-11383.8 2820,-11339.8 2942,-11339.8 2942,-11383.8"/>
<text text-anchor="middle" x="2881" y="-11371" font-family="Arial" font-size="11.00">Expert_8_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_8&#45;&gt;expert_8_0_gpu0 -->
<g id="edge193" class="edge">
<title>token_dist_8&#45;&gt;expert_8_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-11481.74C2881,-11456.16 2881,-11419.62 2881,-11393.81"/>
<polygon fill="black" stroke="black" points="2884.5,-11393.81 2881,-11383.81 2877.5,-11393.81 2884.5,-11393.81"/>
</g>
<!-- expert_8_0_gpu1 -->
<g id="node281" class="node">
<title>expert_8_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-11281.8 2885,-11281.8 2885,-11237.8 3007,-11237.8 3007,-11281.8"/>
<text text-anchor="middle" x="2946" y="-11269" font-family="Arial" font-size="11.00">Expert_8_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-11257" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-11245" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_8&#45;&gt;expert_8_0_gpu1 -->
<g id="edge194" class="edge">
<title>token_dist_8&#45;&gt;expert_8_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-11484.48C2945.77,-11481.28 2948.67,-11477.73 2951,-11473.8 2984.76,-11416.98 2968.96,-11335.72 2956.33,-11291.81"/>
<polygon fill="black" stroke="black" points="2959.62,-11290.57 2953.38,-11282 2952.91,-11292.59 2959.62,-11290.57"/>
</g>
<!-- expert_8_0_gpu0&#45;&gt;expert_8_0_gpu1 -->
<g id="edge195" class="edge">
<title>expert_8_0_gpu0&#45;&gt;expert_8_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-11339.6C2904.09,-11325.28 2916.51,-11306.18 2926.78,-11290.37"/>
<polygon fill="black" stroke="black" points="2929.72,-11292.27 2932.24,-11281.98 2923.85,-11288.46 2929.72,-11292.27"/>
</g>
<!-- expert_merge_8_0 -->
<g id="node282" class="node">
<title>expert_merge_8_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-11201.8 2871.29,-11201.8 2819.53,-11113.8 3020.71,-11113.8 3072.47,-11201.8"/>
<text text-anchor="middle" x="2946" y="-11167" font-family="Arial" font-size="11.00">Expert_Merge_8_0</text>
<text text-anchor="middle" x="2946" y="-11155" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-11143" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_8_0_gpu1&#45;&gt;expert_merge_8_0 -->
<g id="edge196" class="edge">
<title>expert_8_0_gpu1&#45;&gt;expert_merge_8_0</title>
<path fill="none" stroke="black" d="M2946,-11237.6C2946,-11230.1 2946,-11221.29 2946,-11212.33"/>
<polygon fill="black" stroke="black" points="2949.5,-11212.21 2946,-11202.21 2942.5,-11212.21 2949.5,-11212.21"/>
</g>
<!-- expert_agg_8 -->
<g id="node298" class="node">
<title>expert_agg_8</title>
<polygon fill="yellow" stroke="black" points="3077.82,-11077.8 2823.58,-11077.8 2758.18,-10989.8 3012.42,-10989.8 3077.82,-11077.8"/>
<text text-anchor="middle" x="2918" y="-11043" font-family="Arial" font-size="11.00">Expert_Aggregation_8</text>
<text text-anchor="middle" x="2918" y="-11031" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-11019" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_8_0&#45;&gt;expert_agg_8 -->
<g id="edge197" class="edge">
<title>expert_merge_8_0&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M2936.13,-11113.79C2934.2,-11105.41 2932.17,-11096.53 2930.18,-11087.87"/>
<polygon fill="black" stroke="black" points="2933.53,-11086.8 2927.88,-11077.84 2926.7,-11088.37 2933.53,-11086.8"/>
</g>
<!-- expert_8_1_gpu0 -->
<g id="node283" class="node">
<title>expert_8_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-11383.8 2674,-11383.8 2674,-11339.8 2796,-11339.8 2796,-11383.8"/>
<text text-anchor="middle" x="2735" y="-11371" font-family="Arial" font-size="11.00">Expert_8_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_1_gpu1 -->
<g id="node284" class="node">
<title>expert_8_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-11383.8 2534,-11383.8 2534,-11339.8 2656,-11339.8 2656,-11383.8"/>
<text text-anchor="middle" x="2595" y="-11371" font-family="Arial" font-size="11.00">Expert_8_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_1 -->
<g id="node285" class="node">
<title>expert_merge_8_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-11405.8 2315.29,-11405.8 2263.53,-11317.8 2464.71,-11317.8 2516.47,-11405.8"/>
<text text-anchor="middle" x="2390" y="-11371" font-family="Arial" font-size="11.00">Expert_Merge_8_1</text>
<text text-anchor="middle" x="2390" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_8_2_gpu0 -->
<g id="node286" class="node">
<title>expert_8_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-11383.8 2118,-11383.8 2118,-11339.8 2240,-11339.8 2240,-11383.8"/>
<text text-anchor="middle" x="2179" y="-11371" font-family="Arial" font-size="11.00">Expert_8_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_2_gpu1 -->
<g id="node287" class="node">
<title>expert_8_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-11383.8 1978,-11383.8 1978,-11339.8 2100,-11339.8 2100,-11383.8"/>
<text text-anchor="middle" x="2039" y="-11371" font-family="Arial" font-size="11.00">Expert_8_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_2 -->
<g id="node288" class="node">
<title>expert_merge_8_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-11405.8 1759.29,-11405.8 1707.53,-11317.8 1908.71,-11317.8 1960.47,-11405.8"/>
<text text-anchor="middle" x="1834" y="-11371" font-family="Arial" font-size="11.00">Expert_Merge_8_2</text>
<text text-anchor="middle" x="1834" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_8_61_gpu0 -->
<g id="node289" class="node">
<title>expert_8_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-11383.8 1562,-11383.8 1562,-11339.8 1684,-11339.8 1684,-11383.8"/>
<text text-anchor="middle" x="1623" y="-11371" font-family="Arial" font-size="11.00">Expert_8_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_61_gpu1 -->
<g id="node290" class="node">
<title>expert_8_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-11383.8 1422,-11383.8 1422,-11339.8 1544,-11339.8 1544,-11383.8"/>
<text text-anchor="middle" x="1483" y="-11371" font-family="Arial" font-size="11.00">Expert_8_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_61 -->
<g id="node291" class="node">
<title>expert_merge_8_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-11405.8 1203.29,-11405.8 1151.53,-11317.8 1352.71,-11317.8 1404.47,-11405.8"/>
<text text-anchor="middle" x="1278" y="-11371" font-family="Arial" font-size="11.00">Expert_Merge_8_61</text>
<text text-anchor="middle" x="1278" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_8_62_gpu0 -->
<g id="node292" class="node">
<title>expert_8_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-11383.8 1006,-11383.8 1006,-11339.8 1128,-11339.8 1128,-11383.8"/>
<text text-anchor="middle" x="1067" y="-11371" font-family="Arial" font-size="11.00">Expert_8_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_62_gpu1 -->
<g id="node293" class="node">
<title>expert_8_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-11383.8 866,-11383.8 866,-11339.8 988,-11339.8 988,-11383.8"/>
<text text-anchor="middle" x="927" y="-11371" font-family="Arial" font-size="11.00">Expert_8_62_GPU1</text>
<text text-anchor="middle" x="927" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_62 -->
<g id="node294" class="node">
<title>expert_merge_8_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-11405.8 647.29,-11405.8 595.53,-11317.8 796.71,-11317.8 848.47,-11405.8"/>
<text text-anchor="middle" x="722" y="-11371" font-family="Arial" font-size="11.00">Expert_Merge_8_62</text>
<text text-anchor="middle" x="722" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_8_63_gpu0 -->
<g id="node295" class="node">
<title>expert_8_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-11383.8 450,-11383.8 450,-11339.8 572,-11339.8 572,-11383.8"/>
<text text-anchor="middle" x="511" y="-11371" font-family="Arial" font-size="11.00">Expert_8_63_GPU0</text>
<text text-anchor="middle" x="511" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_63_gpu1 -->
<g id="node296" class="node">
<title>expert_8_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-11383.8 310,-11383.8 310,-11339.8 432,-11339.8 432,-11383.8"/>
<text text-anchor="middle" x="371" y="-11371" font-family="Arial" font-size="11.00">Expert_8_63_GPU1</text>
<text text-anchor="middle" x="371" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_63 -->
<g id="node297" class="node">
<title>expert_merge_8_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-11405.8 91.29,-11405.8 39.53,-11317.8 240.71,-11317.8 292.47,-11405.8"/>
<text text-anchor="middle" x="166" y="-11371" font-family="Arial" font-size="11.00">Expert_Merge_8_63</text>
<text text-anchor="middle" x="166" y="-11359" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-11347" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_8&#45;&gt;add_2_8 -->
<g id="edge198" class="edge">
<title>expert_agg_8&#45;&gt;add_2_8</title>
<path fill="none" stroke="black" d="M2930.98,-10989.52C2933.59,-10980.84 2936.28,-10971.88 2938.73,-10963.72"/>
<polygon fill="black" stroke="black" points="2942.15,-10964.47 2941.68,-10953.89 2935.45,-10962.46 2942.15,-10964.47"/>
</g>
<!-- pre_ln_9 -->
<g id="node300" class="node">
<title>pre_ln_9</title>
<polygon fill="lightgreen" stroke="black" points="3005.5,-10859.8 2860.5,-10859.8 2860.5,-10815.8 3005.5,-10815.8 3005.5,-10859.8"/>
<text text-anchor="middle" x="2933" y="-10847" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_9</text>
<text text-anchor="middle" x="2933" y="-10835" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-10823" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_8&#45;&gt;pre_ln_9 -->
<g id="edge200" class="edge">
<title>add_2_8&#45;&gt;pre_ln_9</title>
<path fill="none" stroke="black" d="M2944.52,-10909.47C2942.61,-10897.74 2940.2,-10882.97 2938.08,-10869.98"/>
<polygon fill="black" stroke="black" points="2941.52,-10869.33 2936.46,-10860.03 2934.62,-10870.46 2941.52,-10869.33"/>
</g>
<!-- add_1_9 -->
<g id="node309" class="node">
<title>add_1_9</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-10285.8 2831.5,-10285.8 2831.5,-10241.8 3070.5,-10241.8 3070.5,-10285.8"/>
<text text-anchor="middle" x="2951" y="-10273" font-family="Arial" font-size="11.00">Residual_Add1_9</text>
<text text-anchor="middle" x="2951" y="-10261" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-10249" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_8&#45;&gt;add_1_9 -->
<g id="edge211" class="edge">
<title>add_2_8&#45;&gt;add_1_9</title>
<path fill="none" stroke="black" d="M2995.38,-10909.59C3002.51,-10905.06 3009.35,-10899.8 3015,-10893.8 3066.87,-10838.74 3064,-10806.45 3064,-10730.8 3064,-10730.8 3064,-10730.8 3064,-10466.8 3064,-10398.71 3094.07,-10370.26 3056,-10313.8 3049.84,-10304.67 3041.52,-10297.21 3032.24,-10291.11"/>
<polygon fill="black" stroke="black" points="3033.86,-10288 3023.47,-10285.89 3030.27,-10294.01 3033.86,-10288"/>
</g>
<!-- mha_input_9 -->
<g id="node301" class="node">
<title>mha_input_9</title>
<polygon fill="yellow" stroke="black" points="3044.16,-10773.8 2805.29,-10773.8 2743.84,-10685.8 2982.71,-10685.8 3044.16,-10773.8"/>
<text text-anchor="middle" x="2894" y="-10739" font-family="Arial" font-size="11.00">MHA_Input_9</text>
<text text-anchor="middle" x="2894" y="-10727" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2894" y="-10715" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_9&#45;&gt;mha_input_9 -->
<g id="edge201" class="edge">
<title>pre_ln_9&#45;&gt;mha_input_9</title>
<path fill="none" stroke="black" d="M2925.2,-10815.61C2921.76,-10806.26 2917.55,-10794.82 2913.35,-10783.41"/>
<polygon fill="black" stroke="black" points="2916.58,-10782.05 2909.85,-10773.87 2910.01,-10784.46 2916.58,-10782.05"/>
</g>
<!-- qkv_proj_9_gpu0 -->
<g id="node302" class="node">
<title>qkv_proj_9_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-10649.8 2580.5,-10649.8 2580.5,-10605.8 2803.5,-10605.8 2803.5,-10649.8"/>
<text text-anchor="middle" x="2692" y="-10637" font-family="Arial" font-size="11.00">QKV_Proj_9_GPU0</text>
<text text-anchor="middle" x="2692" y="-10625" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2692" y="-10613" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_9&#45;&gt;qkv_proj_9_gpu0 -->
<g id="edge202" class="edge">
<title>mha_input_9&#45;&gt;qkv_proj_9_gpu0</title>
<path fill="none" stroke="black" d="M2806.87,-10685.67C2785.3,-10674.99 2762.88,-10663.89 2743.63,-10654.36"/>
<polygon fill="black" stroke="black" points="2744.97,-10651.12 2734.45,-10649.82 2741.86,-10657.39 2744.97,-10651.12"/>
</g>
<!-- qkv_proj_9_gpu1 -->
<g id="node303" class="node">
<title>qkv_proj_9_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3044.5,-10649.8 2821.5,-10649.8 2821.5,-10605.8 3044.5,-10605.8 3044.5,-10649.8"/>
<text text-anchor="middle" x="2933" y="-10637" font-family="Arial" font-size="11.00">QKV_Proj_9_GPU1</text>
<text text-anchor="middle" x="2933" y="-10625" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-10613" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_9&#45;&gt;qkv_proj_9_gpu1 -->
<g id="edge203" class="edge">
<title>mha_input_9&#45;&gt;qkv_proj_9_gpu1</title>
<path fill="none" stroke="black" d="M2910.88,-10685.52C2914.3,-10676.74 2917.84,-10667.68 2921.05,-10659.44"/>
<polygon fill="black" stroke="black" points="2924.41,-10660.47 2924.78,-10649.89 2917.88,-10657.93 2924.41,-10660.47"/>
</g>
<!-- attn_9_gpu0 -->
<g id="node304" class="node">
<title>attn_9_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2772.5,-10569.8 2639.5,-10569.8 2639.5,-10525.8 2772.5,-10525.8 2772.5,-10569.8"/>
<text text-anchor="middle" x="2706" y="-10557" font-family="Arial" font-size="11.00">Attention_9_GPU0</text>
<text text-anchor="middle" x="2706" y="-10545" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2706" y="-10533" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_9_gpu0&#45;&gt;attn_9_gpu0 -->
<g id="edge204" class="edge">
<title>qkv_proj_9_gpu0&#45;&gt;attn_9_gpu0</title>
<path fill="none" stroke="black" d="M2695.83,-10605.49C2697.24,-10597.6 2698.88,-10588.49 2700.42,-10579.91"/>
<polygon fill="black" stroke="black" points="2703.91,-10580.28 2702.23,-10569.82 2697.02,-10579.05 2703.91,-10580.28"/>
</g>
<!-- attn_9_gpu1 -->
<g id="node305" class="node">
<title>attn_9_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-10569.8 2856.5,-10569.8 2856.5,-10525.8 2989.5,-10525.8 2989.5,-10569.8"/>
<text text-anchor="middle" x="2923" y="-10557" font-family="Arial" font-size="11.00">Attention_9_GPU1</text>
<text text-anchor="middle" x="2923" y="-10545" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2923" y="-10533" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_9_gpu1&#45;&gt;attn_9_gpu1 -->
<g id="edge205" class="edge">
<title>qkv_proj_9_gpu1&#45;&gt;attn_9_gpu1</title>
<path fill="none" stroke="black" d="M2930.27,-10605.49C2929.26,-10597.6 2928.09,-10588.49 2926.99,-10579.91"/>
<polygon fill="black" stroke="black" points="2930.44,-10579.29 2925.69,-10569.82 2923.49,-10580.19 2930.44,-10579.29"/>
</g>
<!-- out_proj_9_gpu0 -->
<g id="node306" class="node">
<title>out_proj_9_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2793.5,-10489.8 2648.5,-10489.8 2648.5,-10445.8 2793.5,-10445.8 2793.5,-10489.8"/>
<text text-anchor="middle" x="2721" y="-10477" font-family="Arial" font-size="11.00">Output_Proj_9_GPU0</text>
<text text-anchor="middle" x="2721" y="-10465" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2721" y="-10453" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_9_gpu0&#45;&gt;out_proj_9_gpu0 -->
<g id="edge206" class="edge">
<title>attn_9_gpu0&#45;&gt;out_proj_9_gpu0</title>
<path fill="none" stroke="black" d="M2710.1,-10525.49C2711.62,-10517.6 2713.37,-10508.49 2715.02,-10499.91"/>
<polygon fill="black" stroke="black" points="2718.51,-10500.3 2716.96,-10489.82 2711.63,-10498.98 2718.51,-10500.3"/>
</g>
<!-- out_proj_9_gpu1 -->
<g id="node307" class="node">
<title>out_proj_9_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2985.5,-10489.8 2840.5,-10489.8 2840.5,-10445.8 2985.5,-10445.8 2985.5,-10489.8"/>
<text text-anchor="middle" x="2913" y="-10477" font-family="Arial" font-size="11.00">Output_Proj_9_GPU1</text>
<text text-anchor="middle" x="2913" y="-10465" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2913" y="-10453" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_9_gpu1&#45;&gt;out_proj_9_gpu1 -->
<g id="edge207" class="edge">
<title>attn_9_gpu1&#45;&gt;out_proj_9_gpu1</title>
<path fill="none" stroke="black" d="M2920.27,-10525.49C2919.26,-10517.6 2918.09,-10508.49 2916.99,-10499.91"/>
<polygon fill="black" stroke="black" points="2920.44,-10499.29 2915.69,-10489.82 2913.49,-10500.19 2920.44,-10499.29"/>
</g>
<!-- mha_merge_9 -->
<g id="node308" class="node">
<title>mha_merge_9</title>
<polygon fill="yellow" stroke="black" points="3044.16,-10409.8 2805.29,-10409.8 2743.84,-10321.8 2982.71,-10321.8 3044.16,-10409.8"/>
<text text-anchor="middle" x="2894" y="-10375" font-family="Arial" font-size="11.00">MHA_Merge_9</text>
<text text-anchor="middle" x="2894" y="-10363" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2894" y="-10351" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_9_gpu0&#45;&gt;mha_merge_9 -->
<g id="edge208" class="edge">
<title>out_proj_9_gpu0&#45;&gt;mha_merge_9</title>
<path fill="none" stroke="black" d="M2757.69,-10445.6C2773.19,-10436.64 2791.92,-10425.81 2810.47,-10415.08"/>
<polygon fill="black" stroke="black" points="2812.35,-10418.04 2819.26,-10410.01 2808.85,-10411.98 2812.35,-10418.04"/>
</g>
<!-- out_proj_9_gpu1&#45;&gt;mha_merge_9 -->
<g id="edge209" class="edge">
<title>out_proj_9_gpu1&#45;&gt;mha_merge_9</title>
<path fill="none" stroke="black" d="M2908.97,-10445.6C2907.53,-10438.02 2905.84,-10429.1 2904.12,-10420.04"/>
<polygon fill="black" stroke="black" points="2907.55,-10419.38 2902.25,-10410.21 2900.68,-10420.69 2907.55,-10419.38"/>
</g>
<!-- mha_merge_9&#45;&gt;add_1_9 -->
<g id="edge210" class="edge">
<title>mha_merge_9&#45;&gt;add_1_9</title>
<path fill="none" stroke="black" d="M2918.67,-10321.52C2923.84,-10312.45 2929.18,-10303.08 2934,-10294.63"/>
<polygon fill="black" stroke="black" points="2937.07,-10296.31 2938.98,-10285.89 2930.99,-10292.84 2937.07,-10296.31"/>
</g>
<!-- post_ln_9 -->
<g id="node310" class="node">
<title>post_ln_9</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-10205.8 2822.5,-10205.8 2822.5,-10161.8 2967.5,-10161.8 2967.5,-10205.8"/>
<text text-anchor="middle" x="2895" y="-10193" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_9</text>
<text text-anchor="middle" x="2895" y="-10181" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-10169" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_9&#45;&gt;post_ln_9 -->
<g id="edge212" class="edge">
<title>add_1_9&#45;&gt;post_ln_9</title>
<path fill="none" stroke="black" d="M2935.7,-10241.49C2929.66,-10233.08 2922.62,-10223.28 2916.12,-10214.22"/>
<polygon fill="black" stroke="black" points="2918.77,-10211.9 2910.09,-10205.82 2913.08,-10215.99 2918.77,-10211.9"/>
</g>
<!-- add_2_9 -->
<g id="node332" class="node">
<title>add_2_9</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-9411.58 2828.5,-9411.58 2828.5,-9367.58 3067.5,-9367.58 3067.5,-9411.58"/>
<text text-anchor="middle" x="2948" y="-9398.78" font-family="Arial" font-size="11.00">Residual_Add2_9</text>
<text text-anchor="middle" x="2948" y="-9386.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-9374.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_9&#45;&gt;add_2_9 -->
<g id="edge221" class="edge">
<title>add_1_9&#45;&gt;add_2_9</title>
<path fill="none" stroke="black" d="M2984.86,-10241.8C3027.99,-10212.14 3097,-10153.62 3097,-10082.8 3097,-10082.8 3097,-10082.8 3097,-9614.58 3097,-9536.77 3138.2,-9502.19 3092,-9439.58 3085.15,-9430.29 3076.44,-9422.75 3066.71,-9416.62"/>
<polygon fill="black" stroke="black" points="3068.33,-9413.52 3057.91,-9411.6 3064.86,-9419.6 3068.33,-9413.52"/>
</g>
<!-- gate_9 -->
<g id="node311" class="node">
<title>gate_9</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-10125.8 2742.05,-10125.8 2655.5,-10037.8 2991.95,-10037.8 3078.5,-10125.8"/>
<text text-anchor="middle" x="2867" y="-10091" font-family="Arial" font-size="11.00">Expert_Gate_9</text>
<text text-anchor="middle" x="2867" y="-10079" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-10067" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_9&#45;&gt;gate_9 -->
<g id="edge213" class="edge">
<title>post_ln_9&#45;&gt;gate_9</title>
<path fill="none" stroke="black" d="M2889.06,-10161.6C2886.94,-10154.02 2884.44,-10145.1 2881.91,-10136.04"/>
<polygon fill="black" stroke="black" points="2885.22,-10134.9 2879.15,-10126.21 2878.48,-10136.78 2885.22,-10134.9"/>
</g>
<!-- token_dist_9 -->
<g id="node312" class="node">
<title>token_dist_9</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-9970.69" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-9979.89" font-family="Arial" font-size="11.00">Token_Distribution_9</text>
<text text-anchor="middle" x="2881" y="-9967.89" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-9955.89" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_9&#45;&gt;token_dist_9 -->
<g id="edge214" class="edge">
<title>gate_9&#45;&gt;token_dist_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-10037.68C2873.61,-10029.3 2874.73,-10020.55 2875.79,-10012.26"/>
<polygon fill="red" stroke="red" points="2879.3,-10012.43 2877.1,-10002.07 2872.36,-10011.54 2879.3,-10012.43"/>
</g>
<!-- expert_9_0_gpu0 -->
<g id="node313" class="node">
<title>expert_9_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-9841.58 2820,-9841.58 2820,-9797.58 2942,-9797.58 2942,-9841.58"/>
<text text-anchor="middle" x="2881" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_9&#45;&gt;expert_9_0_gpu0 -->
<g id="edge215" class="edge">
<title>token_dist_9&#45;&gt;expert_9_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-9939.52C2881,-9913.94 2881,-9877.4 2881,-9851.58"/>
<polygon fill="black" stroke="black" points="2884.5,-9851.58 2881,-9841.58 2877.5,-9851.58 2884.5,-9851.58"/>
</g>
<!-- expert_9_0_gpu1 -->
<g id="node314" class="node">
<title>expert_9_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-9739.58 2885,-9739.58 2885,-9695.58 3007,-9695.58 3007,-9739.58"/>
<text text-anchor="middle" x="2946" y="-9726.78" font-family="Arial" font-size="11.00">Expert_9_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-9714.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-9702.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_9&#45;&gt;expert_9_0_gpu1 -->
<g id="edge216" class="edge">
<title>token_dist_9&#45;&gt;expert_9_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-9942.25C2945.77,-9939.05 2948.67,-9935.5 2951,-9931.58 2984.76,-9874.76 2968.96,-9793.49 2956.33,-9749.59"/>
<polygon fill="black" stroke="black" points="2959.62,-9748.35 2953.38,-9739.78 2952.91,-9750.36 2959.62,-9748.35"/>
</g>
<!-- expert_9_0_gpu0&#45;&gt;expert_9_0_gpu1 -->
<g id="edge217" class="edge">
<title>expert_9_0_gpu0&#45;&gt;expert_9_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-9797.37C2904.09,-9783.05 2916.51,-9763.95 2926.78,-9748.15"/>
<polygon fill="black" stroke="black" points="2929.72,-9750.05 2932.24,-9739.75 2923.85,-9746.23 2929.72,-9750.05"/>
</g>
<!-- expert_merge_9_0 -->
<g id="node315" class="node">
<title>expert_merge_9_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-9659.58 2871.29,-9659.58 2819.53,-9571.58 3020.71,-9571.58 3072.47,-9659.58"/>
<text text-anchor="middle" x="2946" y="-9624.78" font-family="Arial" font-size="11.00">Expert_Merge_9_0</text>
<text text-anchor="middle" x="2946" y="-9612.78" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-9600.78" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_9_0_gpu1&#45;&gt;expert_merge_9_0 -->
<g id="edge218" class="edge">
<title>expert_9_0_gpu1&#45;&gt;expert_merge_9_0</title>
<path fill="none" stroke="black" d="M2946,-9695.37C2946,-9687.87 2946,-9679.06 2946,-9670.1"/>
<polygon fill="black" stroke="black" points="2949.5,-9669.98 2946,-9659.98 2942.5,-9669.98 2949.5,-9669.98"/>
</g>
<!-- expert_agg_9 -->
<g id="node331" class="node">
<title>expert_agg_9</title>
<polygon fill="yellow" stroke="black" points="3077.82,-9535.58 2823.58,-9535.58 2758.18,-9447.58 3012.42,-9447.58 3077.82,-9535.58"/>
<text text-anchor="middle" x="2918" y="-9500.78" font-family="Arial" font-size="11.00">Expert_Aggregation_9</text>
<text text-anchor="middle" x="2918" y="-9488.78" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-9476.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_9_0&#45;&gt;expert_agg_9 -->
<g id="edge219" class="edge">
<title>expert_merge_9_0&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M2936.13,-9571.57C2934.2,-9563.18 2932.17,-9554.3 2930.18,-9545.64"/>
<polygon fill="black" stroke="black" points="2933.53,-9544.58 2927.88,-9535.61 2926.7,-9546.14 2933.53,-9544.58"/>
</g>
<!-- expert_9_1_gpu0 -->
<g id="node316" class="node">
<title>expert_9_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-9841.58 2674,-9841.58 2674,-9797.58 2796,-9797.58 2796,-9841.58"/>
<text text-anchor="middle" x="2735" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_1_gpu1 -->
<g id="node317" class="node">
<title>expert_9_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-9841.58 2534,-9841.58 2534,-9797.58 2656,-9797.58 2656,-9841.58"/>
<text text-anchor="middle" x="2595" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_1 -->
<g id="node318" class="node">
<title>expert_merge_9_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-9863.58 2315.29,-9863.58 2263.53,-9775.58 2464.71,-9775.58 2516.47,-9863.58"/>
<text text-anchor="middle" x="2390" y="-9828.78" font-family="Arial" font-size="11.00">Expert_Merge_9_1</text>
<text text-anchor="middle" x="2390" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_9_2_gpu0 -->
<g id="node319" class="node">
<title>expert_9_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-9841.58 2118,-9841.58 2118,-9797.58 2240,-9797.58 2240,-9841.58"/>
<text text-anchor="middle" x="2179" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_2_gpu1 -->
<g id="node320" class="node">
<title>expert_9_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-9841.58 1978,-9841.58 1978,-9797.58 2100,-9797.58 2100,-9841.58"/>
<text text-anchor="middle" x="2039" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_2 -->
<g id="node321" class="node">
<title>expert_merge_9_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-9863.58 1759.29,-9863.58 1707.53,-9775.58 1908.71,-9775.58 1960.47,-9863.58"/>
<text text-anchor="middle" x="1834" y="-9828.78" font-family="Arial" font-size="11.00">Expert_Merge_9_2</text>
<text text-anchor="middle" x="1834" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_9_61_gpu0 -->
<g id="node322" class="node">
<title>expert_9_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-9841.58 1562,-9841.58 1562,-9797.58 1684,-9797.58 1684,-9841.58"/>
<text text-anchor="middle" x="1623" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_61_gpu1 -->
<g id="node323" class="node">
<title>expert_9_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-9841.58 1422,-9841.58 1422,-9797.58 1544,-9797.58 1544,-9841.58"/>
<text text-anchor="middle" x="1483" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_61 -->
<g id="node324" class="node">
<title>expert_merge_9_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-9863.58 1203.29,-9863.58 1151.53,-9775.58 1352.71,-9775.58 1404.47,-9863.58"/>
<text text-anchor="middle" x="1278" y="-9828.78" font-family="Arial" font-size="11.00">Expert_Merge_9_61</text>
<text text-anchor="middle" x="1278" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_9_62_gpu0 -->
<g id="node325" class="node">
<title>expert_9_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-9841.58 1006,-9841.58 1006,-9797.58 1128,-9797.58 1128,-9841.58"/>
<text text-anchor="middle" x="1067" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_62_gpu1 -->
<g id="node326" class="node">
<title>expert_9_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-9841.58 866,-9841.58 866,-9797.58 988,-9797.58 988,-9841.58"/>
<text text-anchor="middle" x="927" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_62_GPU1</text>
<text text-anchor="middle" x="927" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_62 -->
<g id="node327" class="node">
<title>expert_merge_9_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-9863.58 647.29,-9863.58 595.53,-9775.58 796.71,-9775.58 848.47,-9863.58"/>
<text text-anchor="middle" x="722" y="-9828.78" font-family="Arial" font-size="11.00">Expert_Merge_9_62</text>
<text text-anchor="middle" x="722" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_9_63_gpu0 -->
<g id="node328" class="node">
<title>expert_9_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-9841.58 450,-9841.58 450,-9797.58 572,-9797.58 572,-9841.58"/>
<text text-anchor="middle" x="511" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_63_GPU0</text>
<text text-anchor="middle" x="511" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_63_gpu1 -->
<g id="node329" class="node">
<title>expert_9_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-9841.58 310,-9841.58 310,-9797.58 432,-9797.58 432,-9841.58"/>
<text text-anchor="middle" x="371" y="-9828.78" font-family="Arial" font-size="11.00">Expert_9_63_GPU1</text>
<text text-anchor="middle" x="371" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_63 -->
<g id="node330" class="node">
<title>expert_merge_9_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-9863.58 91.29,-9863.58 39.53,-9775.58 240.71,-9775.58 292.47,-9863.58"/>
<text text-anchor="middle" x="166" y="-9828.78" font-family="Arial" font-size="11.00">Expert_Merge_9_63</text>
<text text-anchor="middle" x="166" y="-9816.78" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-9804.78" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_9&#45;&gt;add_2_9 -->
<g id="edge220" class="edge">
<title>expert_agg_9&#45;&gt;add_2_9</title>
<path fill="none" stroke="black" d="M2930.98,-9447.3C2933.59,-9438.61 2936.28,-9429.65 2938.73,-9421.49"/>
<polygon fill="black" stroke="black" points="2942.15,-9422.24 2941.68,-9411.66 2935.45,-9420.23 2942.15,-9422.24"/>
</g>
<!-- pre_ln_10 -->
<g id="node333" class="node">
<title>pre_ln_10</title>
<polygon fill="lightgreen" stroke="black" points="3005.5,-9317.58 2860.5,-9317.58 2860.5,-9273.58 3005.5,-9273.58 3005.5,-9317.58"/>
<text text-anchor="middle" x="2933" y="-9304.78" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_10</text>
<text text-anchor="middle" x="2933" y="-9292.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-9280.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_9&#45;&gt;pre_ln_10 -->
<g id="edge222" class="edge">
<title>add_2_9&#45;&gt;pre_ln_10</title>
<path fill="none" stroke="black" d="M2944.52,-9367.24C2942.61,-9355.51 2940.2,-9340.75 2938.08,-9327.75"/>
<polygon fill="black" stroke="black" points="2941.52,-9327.11 2936.46,-9317.8 2934.62,-9328.23 2941.52,-9327.11"/>
</g>
<!-- add_1_10 -->
<g id="node342" class="node">
<title>add_1_10</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-8743.58 2831.5,-8743.58 2831.5,-8699.58 3070.5,-8699.58 3070.5,-8743.58"/>
<text text-anchor="middle" x="2951" y="-8730.78" font-family="Arial" font-size="11.00">Residual_Add1_10</text>
<text text-anchor="middle" x="2951" y="-8718.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-8706.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_9&#45;&gt;add_1_10 -->
<g id="edge233" class="edge">
<title>add_2_9&#45;&gt;add_1_10</title>
<path fill="none" stroke="black" d="M2995.38,-9367.37C3002.51,-9362.84 3009.35,-9357.57 3015,-9351.58 3066.87,-9296.51 3064,-9264.22 3064,-9188.58 3064,-9188.58 3064,-9188.58 3064,-8924.58 3064,-8856.48 3094.07,-8828.04 3056,-8771.58 3049.84,-8762.45 3041.52,-8754.98 3032.24,-8748.88"/>
<polygon fill="black" stroke="black" points="3033.86,-8745.78 3023.47,-8743.66 3030.27,-8751.79 3033.86,-8745.78"/>
</g>
<!-- mha_input_10 -->
<g id="node334" class="node">
<title>mha_input_10</title>
<polygon fill="yellow" stroke="black" points="3044.16,-9231.58 2805.29,-9231.58 2743.84,-9143.58 2982.71,-9143.58 3044.16,-9231.58"/>
<text text-anchor="middle" x="2894" y="-9196.78" font-family="Arial" font-size="11.00">MHA_Input_10</text>
<text text-anchor="middle" x="2894" y="-9184.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2894" y="-9172.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_10&#45;&gt;mha_input_10 -->
<g id="edge223" class="edge">
<title>pre_ln_10&#45;&gt;mha_input_10</title>
<path fill="none" stroke="black" d="M2925.2,-9273.38C2921.76,-9264.04 2917.55,-9252.6 2913.35,-9241.18"/>
<polygon fill="black" stroke="black" points="2916.58,-9239.82 2909.85,-9231.65 2910.01,-9242.24 2916.58,-9239.82"/>
</g>
<!-- qkv_proj_10_gpu0 -->
<g id="node335" class="node">
<title>qkv_proj_10_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-9107.58 2580.5,-9107.58 2580.5,-9063.58 2803.5,-9063.58 2803.5,-9107.58"/>
<text text-anchor="middle" x="2692" y="-9094.78" font-family="Arial" font-size="11.00">QKV_Proj_10_GPU0</text>
<text text-anchor="middle" x="2692" y="-9082.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2692" y="-9070.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_10&#45;&gt;qkv_proj_10_gpu0 -->
<g id="edge224" class="edge">
<title>mha_input_10&#45;&gt;qkv_proj_10_gpu0</title>
<path fill="none" stroke="black" d="M2806.87,-9143.44C2785.3,-9132.77 2762.88,-9121.67 2743.63,-9112.14"/>
<polygon fill="black" stroke="black" points="2744.97,-9108.89 2734.45,-9107.59 2741.86,-9115.17 2744.97,-9108.89"/>
</g>
<!-- qkv_proj_10_gpu1 -->
<g id="node336" class="node">
<title>qkv_proj_10_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3044.5,-9107.58 2821.5,-9107.58 2821.5,-9063.58 3044.5,-9063.58 3044.5,-9107.58"/>
<text text-anchor="middle" x="2933" y="-9094.78" font-family="Arial" font-size="11.00">QKV_Proj_10_GPU1</text>
<text text-anchor="middle" x="2933" y="-9082.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-9070.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_10&#45;&gt;qkv_proj_10_gpu1 -->
<g id="edge225" class="edge">
<title>mha_input_10&#45;&gt;qkv_proj_10_gpu1</title>
<path fill="none" stroke="black" d="M2910.88,-9143.3C2914.3,-9134.52 2917.84,-9125.45 2921.05,-9117.22"/>
<polygon fill="black" stroke="black" points="2924.41,-9118.25 2924.78,-9107.66 2917.88,-9115.7 2924.41,-9118.25"/>
</g>
<!-- attn_10_gpu0 -->
<g id="node337" class="node">
<title>attn_10_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2787.5,-9027.58 2654.5,-9027.58 2654.5,-8983.58 2787.5,-8983.58 2787.5,-9027.58"/>
<text text-anchor="middle" x="2721" y="-9014.78" font-family="Arial" font-size="11.00">Attention_10_GPU0</text>
<text text-anchor="middle" x="2721" y="-9002.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2721" y="-8990.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_10_gpu0&#45;&gt;attn_10_gpu0 -->
<g id="edge226" class="edge">
<title>qkv_proj_10_gpu0&#45;&gt;attn_10_gpu0</title>
<path fill="none" stroke="black" d="M2699.92,-9063.26C2702.92,-9055.2 2706.39,-9045.86 2709.65,-9037.12"/>
<polygon fill="black" stroke="black" points="2712.98,-9038.19 2713.19,-9027.6 2706.42,-9035.75 2712.98,-9038.19"/>
</g>
<!-- attn_10_gpu1 -->
<g id="node338" class="node">
<title>attn_10_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-9027.58 2856.5,-9027.58 2856.5,-8983.58 2989.5,-8983.58 2989.5,-9027.58"/>
<text text-anchor="middle" x="2923" y="-9014.78" font-family="Arial" font-size="11.00">Attention_10_GPU1</text>
<text text-anchor="middle" x="2923" y="-9002.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2923" y="-8990.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_10_gpu1&#45;&gt;attn_10_gpu1 -->
<g id="edge227" class="edge">
<title>qkv_proj_10_gpu1&#45;&gt;attn_10_gpu1</title>
<path fill="none" stroke="black" d="M2930.27,-9063.26C2929.26,-9055.38 2928.09,-9046.26 2926.99,-9037.68"/>
<polygon fill="black" stroke="black" points="2930.44,-9037.07 2925.69,-9027.6 2923.49,-9037.96 2930.44,-9037.07"/>
</g>
<!-- out_proj_10_gpu0 -->
<g id="node339" class="node">
<title>out_proj_10_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2812.5,-8947.58 2667.5,-8947.58 2667.5,-8903.58 2812.5,-8903.58 2812.5,-8947.58"/>
<text text-anchor="middle" x="2740" y="-8934.78" font-family="Arial" font-size="11.00">Output_Proj_10_GPU0</text>
<text text-anchor="middle" x="2740" y="-8922.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2740" y="-8910.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_10_gpu0&#45;&gt;out_proj_10_gpu0 -->
<g id="edge228" class="edge">
<title>attn_10_gpu0&#45;&gt;out_proj_10_gpu0</title>
<path fill="none" stroke="black" d="M2726.19,-8983.26C2728.13,-8975.29 2730.38,-8966.06 2732.49,-8957.4"/>
<polygon fill="black" stroke="black" points="2735.91,-8958.14 2734.88,-8947.6 2729.11,-8956.48 2735.91,-8958.14"/>
</g>
<!-- out_proj_10_gpu1 -->
<g id="node340" class="node">
<title>out_proj_10_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2985.5,-8947.58 2840.5,-8947.58 2840.5,-8903.58 2985.5,-8903.58 2985.5,-8947.58"/>
<text text-anchor="middle" x="2913" y="-8934.78" font-family="Arial" font-size="11.00">Output_Proj_10_GPU1</text>
<text text-anchor="middle" x="2913" y="-8922.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2913" y="-8910.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_10_gpu1&#45;&gt;out_proj_10_gpu1 -->
<g id="edge229" class="edge">
<title>attn_10_gpu1&#45;&gt;out_proj_10_gpu1</title>
<path fill="none" stroke="black" d="M2920.27,-8983.26C2919.26,-8975.38 2918.09,-8966.26 2916.99,-8957.68"/>
<polygon fill="black" stroke="black" points="2920.44,-8957.07 2915.69,-8947.6 2913.49,-8957.96 2920.44,-8957.07"/>
</g>
<!-- mha_merge_10 -->
<g id="node341" class="node">
<title>mha_merge_10</title>
<polygon fill="yellow" stroke="black" points="3044.16,-8867.58 2805.29,-8867.58 2743.84,-8779.58 2982.71,-8779.58 3044.16,-8867.58"/>
<text text-anchor="middle" x="2894" y="-8832.78" font-family="Arial" font-size="11.00">MHA_Merge_10</text>
<text text-anchor="middle" x="2894" y="-8820.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2894" y="-8808.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_10_gpu0&#45;&gt;mha_merge_10 -->
<g id="edge230" class="edge">
<title>out_proj_10_gpu0&#45;&gt;mha_merge_10</title>
<path fill="none" stroke="black" d="M2772.66,-8903.37C2786.27,-8894.53 2802.68,-8883.88 2818.97,-8873.3"/>
<polygon fill="black" stroke="black" points="2820.99,-8876.16 2827.47,-8867.78 2817.17,-8870.29 2820.99,-8876.16"/>
</g>
<!-- out_proj_10_gpu1&#45;&gt;mha_merge_10 -->
<g id="edge231" class="edge">
<title>out_proj_10_gpu1&#45;&gt;mha_merge_10</title>
<path fill="none" stroke="black" d="M2908.97,-8903.37C2907.53,-8895.79 2905.84,-8886.87 2904.12,-8877.81"/>
<polygon fill="black" stroke="black" points="2907.55,-8877.16 2902.25,-8867.98 2900.68,-8878.46 2907.55,-8877.16"/>
</g>
<!-- mha_merge_10&#45;&gt;add_1_10 -->
<g id="edge232" class="edge">
<title>mha_merge_10&#45;&gt;add_1_10</title>
<path fill="none" stroke="black" d="M2918.67,-8779.3C2923.84,-8770.23 2929.18,-8760.86 2934,-8752.41"/>
<polygon fill="black" stroke="black" points="2937.07,-8754.08 2938.98,-8743.66 2930.99,-8750.61 2937.07,-8754.08"/>
</g>
<!-- post_ln_10 -->
<g id="node343" class="node">
<title>post_ln_10</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-8663.58 2822.5,-8663.58 2822.5,-8619.58 2967.5,-8619.58 2967.5,-8663.58"/>
<text text-anchor="middle" x="2895" y="-8650.78" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_10</text>
<text text-anchor="middle" x="2895" y="-8638.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-8626.78" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_10&#45;&gt;post_ln_10 -->
<g id="edge234" class="edge">
<title>add_1_10&#45;&gt;post_ln_10</title>
<path fill="none" stroke="black" d="M2935.7,-8699.26C2929.66,-8690.86 2922.62,-8681.05 2916.12,-8671.99"/>
<polygon fill="black" stroke="black" points="2918.77,-8669.68 2910.09,-8663.6 2913.08,-8673.76 2918.77,-8669.68"/>
</g>
<!-- add_2_10 -->
<g id="node365" class="node">
<title>add_2_10</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-7869.35 2828.5,-7869.35 2828.5,-7825.35 3067.5,-7825.35 3067.5,-7869.35"/>
<text text-anchor="middle" x="2948" y="-7856.55" font-family="Arial" font-size="11.00">Residual_Add2_10</text>
<text text-anchor="middle" x="2948" y="-7844.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-7832.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_10&#45;&gt;add_2_10 -->
<g id="edge243" class="edge">
<title>add_1_10&#45;&gt;add_2_10</title>
<path fill="none" stroke="black" d="M2984.86,-8699.58C3027.99,-8669.92 3097,-8611.4 3097,-8540.58 3097,-8540.58 3097,-8540.58 3097,-8072.35 3097,-7994.54 3138.2,-7959.96 3092,-7897.35 3085.15,-7888.07 3076.44,-7880.52 3066.71,-7874.4"/>
<polygon fill="black" stroke="black" points="3068.33,-7871.29 3057.91,-7869.37 3064.86,-7877.37 3068.33,-7871.29"/>
</g>
<!-- gate_10 -->
<g id="node344" class="node">
<title>gate_10</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-8583.58 2742.05,-8583.58 2655.5,-8495.58 2991.95,-8495.58 3078.5,-8583.58"/>
<text text-anchor="middle" x="2867" y="-8548.78" font-family="Arial" font-size="11.00">Expert_Gate_10</text>
<text text-anchor="middle" x="2867" y="-8536.78" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-8524.78" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_10&#45;&gt;gate_10 -->
<g id="edge235" class="edge">
<title>post_ln_10&#45;&gt;gate_10</title>
<path fill="none" stroke="black" d="M2889.06,-8619.37C2886.94,-8611.79 2884.44,-8602.87 2881.91,-8593.81"/>
<polygon fill="black" stroke="black" points="2885.22,-8592.67 2879.15,-8583.98 2878.48,-8594.56 2885.22,-8592.67"/>
</g>
<!-- token_dist_10 -->
<g id="node345" class="node">
<title>token_dist_10</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-8428.47" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-8437.67" font-family="Arial" font-size="11.00">Token_Distribution_10</text>
<text text-anchor="middle" x="2881" y="-8425.67" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-8413.67" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_10&#45;&gt;token_dist_10 -->
<g id="edge236" class="edge">
<title>gate_10&#45;&gt;token_dist_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-8495.45C2873.61,-8487.08 2874.73,-8478.32 2875.79,-8470.03"/>
<polygon fill="red" stroke="red" points="2879.3,-8470.21 2877.1,-8459.84 2872.36,-8469.31 2879.3,-8470.21"/>
</g>
<!-- expert_10_0_gpu0 -->
<g id="node346" class="node">
<title>expert_10_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-8299.35 2820,-8299.35 2820,-8255.35 2942,-8255.35 2942,-8299.35"/>
<text text-anchor="middle" x="2881" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_10&#45;&gt;expert_10_0_gpu0 -->
<g id="edge237" class="edge">
<title>token_dist_10&#45;&gt;expert_10_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-8397.29C2881,-8371.71 2881,-8335.17 2881,-8309.36"/>
<polygon fill="black" stroke="black" points="2884.5,-8309.36 2881,-8299.36 2877.5,-8309.36 2884.5,-8309.36"/>
</g>
<!-- expert_10_0_gpu1 -->
<g id="node347" class="node">
<title>expert_10_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-8197.35 2885,-8197.35 2885,-8153.35 3007,-8153.35 3007,-8197.35"/>
<text text-anchor="middle" x="2946" y="-8184.55" font-family="Arial" font-size="11.00">Expert_10_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-8172.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-8160.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_10&#45;&gt;expert_10_0_gpu1 -->
<g id="edge238" class="edge">
<title>token_dist_10&#45;&gt;expert_10_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-8400.03C2945.77,-8396.82 2948.67,-8393.28 2951,-8389.35 2984.76,-8332.53 2968.96,-8251.27 2956.33,-8207.36"/>
<polygon fill="black" stroke="black" points="2959.62,-8206.12 2953.38,-8197.55 2952.91,-8208.14 2959.62,-8206.12"/>
</g>
<!-- expert_10_0_gpu0&#45;&gt;expert_10_0_gpu1 -->
<g id="edge239" class="edge">
<title>expert_10_0_gpu0&#45;&gt;expert_10_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-8255.14C2904.09,-8240.83 2916.51,-8221.73 2926.78,-8205.92"/>
<polygon fill="black" stroke="black" points="2929.72,-8207.82 2932.24,-8197.53 2923.85,-8204.01 2929.72,-8207.82"/>
</g>
<!-- expert_merge_10_0 -->
<g id="node348" class="node">
<title>expert_merge_10_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-8117.35 2871.29,-8117.35 2819.53,-8029.35 3020.71,-8029.35 3072.47,-8117.35"/>
<text text-anchor="middle" x="2946" y="-8082.55" font-family="Arial" font-size="11.00">Expert_Merge_10_0</text>
<text text-anchor="middle" x="2946" y="-8070.55" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-8058.55" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_10_0_gpu1&#45;&gt;expert_merge_10_0 -->
<g id="edge240" class="edge">
<title>expert_10_0_gpu1&#45;&gt;expert_merge_10_0</title>
<path fill="none" stroke="black" d="M2946,-8153.14C2946,-8145.65 2946,-8136.84 2946,-8127.88"/>
<polygon fill="black" stroke="black" points="2949.5,-8127.76 2946,-8117.76 2942.5,-8127.76 2949.5,-8127.76"/>
</g>
<!-- expert_agg_10 -->
<g id="node364" class="node">
<title>expert_agg_10</title>
<polygon fill="yellow" stroke="black" points="3077.82,-7993.35 2823.58,-7993.35 2758.18,-7905.35 3012.42,-7905.35 3077.82,-7993.35"/>
<text text-anchor="middle" x="2918" y="-7958.55" font-family="Arial" font-size="11.00">Expert_Aggregation_10</text>
<text text-anchor="middle" x="2918" y="-7946.55" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-7934.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_10_0&#45;&gt;expert_agg_10 -->
<g id="edge241" class="edge">
<title>expert_merge_10_0&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M2936.13,-8029.34C2934.2,-8020.96 2932.17,-8012.08 2930.18,-8003.41"/>
<polygon fill="black" stroke="black" points="2933.53,-8002.35 2927.88,-7993.39 2926.7,-8003.92 2933.53,-8002.35"/>
</g>
<!-- expert_10_1_gpu0 -->
<g id="node349" class="node">
<title>expert_10_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-8299.35 2674,-8299.35 2674,-8255.35 2796,-8255.35 2796,-8299.35"/>
<text text-anchor="middle" x="2735" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_1_gpu1 -->
<g id="node350" class="node">
<title>expert_10_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-8299.35 2534,-8299.35 2534,-8255.35 2656,-8255.35 2656,-8299.35"/>
<text text-anchor="middle" x="2595" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_1 -->
<g id="node351" class="node">
<title>expert_merge_10_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-8321.35 2315.29,-8321.35 2263.53,-8233.35 2464.71,-8233.35 2516.47,-8321.35"/>
<text text-anchor="middle" x="2390" y="-8286.55" font-family="Arial" font-size="11.00">Expert_Merge_10_1</text>
<text text-anchor="middle" x="2390" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_10_2_gpu0 -->
<g id="node352" class="node">
<title>expert_10_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-8299.35 2118,-8299.35 2118,-8255.35 2240,-8255.35 2240,-8299.35"/>
<text text-anchor="middle" x="2179" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_2_gpu1 -->
<g id="node353" class="node">
<title>expert_10_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-8299.35 1978,-8299.35 1978,-8255.35 2100,-8255.35 2100,-8299.35"/>
<text text-anchor="middle" x="2039" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_2 -->
<g id="node354" class="node">
<title>expert_merge_10_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-8321.35 1759.29,-8321.35 1707.53,-8233.35 1908.71,-8233.35 1960.47,-8321.35"/>
<text text-anchor="middle" x="1834" y="-8286.55" font-family="Arial" font-size="11.00">Expert_Merge_10_2</text>
<text text-anchor="middle" x="1834" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_10_61_gpu0 -->
<g id="node355" class="node">
<title>expert_10_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-8299.35 1562,-8299.35 1562,-8255.35 1684,-8255.35 1684,-8299.35"/>
<text text-anchor="middle" x="1623" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_61_gpu1 -->
<g id="node356" class="node">
<title>expert_10_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-8299.35 1422,-8299.35 1422,-8255.35 1544,-8255.35 1544,-8299.35"/>
<text text-anchor="middle" x="1483" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_61 -->
<g id="node357" class="node">
<title>expert_merge_10_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-8321.35 1203.29,-8321.35 1151.53,-8233.35 1352.71,-8233.35 1404.47,-8321.35"/>
<text text-anchor="middle" x="1278" y="-8286.55" font-family="Arial" font-size="11.00">Expert_Merge_10_61</text>
<text text-anchor="middle" x="1278" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_10_62_gpu0 -->
<g id="node358" class="node">
<title>expert_10_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-8299.35 1006,-8299.35 1006,-8255.35 1128,-8255.35 1128,-8299.35"/>
<text text-anchor="middle" x="1067" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_62_gpu1 -->
<g id="node359" class="node">
<title>expert_10_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-8299.35 866,-8299.35 866,-8255.35 988,-8255.35 988,-8299.35"/>
<text text-anchor="middle" x="927" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_62_GPU1</text>
<text text-anchor="middle" x="927" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_62 -->
<g id="node360" class="node">
<title>expert_merge_10_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-8321.35 647.29,-8321.35 595.53,-8233.35 796.71,-8233.35 848.47,-8321.35"/>
<text text-anchor="middle" x="722" y="-8286.55" font-family="Arial" font-size="11.00">Expert_Merge_10_62</text>
<text text-anchor="middle" x="722" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_10_63_gpu0 -->
<g id="node361" class="node">
<title>expert_10_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-8299.35 450,-8299.35 450,-8255.35 572,-8255.35 572,-8299.35"/>
<text text-anchor="middle" x="511" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_63_GPU0</text>
<text text-anchor="middle" x="511" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_63_gpu1 -->
<g id="node362" class="node">
<title>expert_10_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-8299.35 310,-8299.35 310,-8255.35 432,-8255.35 432,-8299.35"/>
<text text-anchor="middle" x="371" y="-8286.55" font-family="Arial" font-size="11.00">Expert_10_63_GPU1</text>
<text text-anchor="middle" x="371" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_63 -->
<g id="node363" class="node">
<title>expert_merge_10_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-8321.35 91.29,-8321.35 39.53,-8233.35 240.71,-8233.35 292.47,-8321.35"/>
<text text-anchor="middle" x="166" y="-8286.55" font-family="Arial" font-size="11.00">Expert_Merge_10_63</text>
<text text-anchor="middle" x="166" y="-8274.55" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-8262.55" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_10&#45;&gt;add_2_10 -->
<g id="edge242" class="edge">
<title>expert_agg_10&#45;&gt;add_2_10</title>
<path fill="none" stroke="black" d="M2930.98,-7905.07C2933.59,-7896.39 2936.28,-7887.43 2938.73,-7879.27"/>
<polygon fill="black" stroke="black" points="2942.15,-7880.02 2941.68,-7869.43 2935.45,-7878.01 2942.15,-7880.02"/>
</g>
<!-- pre_ln_11 -->
<g id="node366" class="node">
<title>pre_ln_11</title>
<polygon fill="lightgreen" stroke="black" points="2927.5,-7775.35 2782.5,-7775.35 2782.5,-7731.35 2927.5,-7731.35 2927.5,-7775.35"/>
<text text-anchor="middle" x="2855" y="-7762.55" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_11</text>
<text text-anchor="middle" x="2855" y="-7750.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-7738.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_10&#45;&gt;pre_ln_11 -->
<g id="edge244" class="edge">
<title>add_2_10&#45;&gt;pre_ln_11</title>
<path fill="none" stroke="black" d="M2926.43,-7825.01C2913.75,-7812.47 2897.57,-7796.46 2883.81,-7782.85"/>
<polygon fill="black" stroke="black" points="2886.02,-7780.12 2876.45,-7775.57 2881.1,-7785.1 2886.02,-7780.12"/>
</g>
<!-- add_1_11 -->
<g id="node375" class="node">
<title>add_1_11</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-7201.35 2831.5,-7201.35 2831.5,-7157.35 3070.5,-7157.35 3070.5,-7201.35"/>
<text text-anchor="middle" x="2951" y="-7188.55" font-family="Arial" font-size="11.00">Residual_Add1_11</text>
<text text-anchor="middle" x="2951" y="-7176.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-7164.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_10&#45;&gt;add_1_11 -->
<g id="edge255" class="edge">
<title>add_2_10&#45;&gt;add_1_11</title>
<path fill="none" stroke="black" d="M2954.71,-7825.29C2965.62,-7789.1 2986,-7712.62 2986,-7646.35 2986,-7646.35 2986,-7646.35 2986,-7382.35 2986,-7314.26 2996.68,-7294.83 2978,-7229.35 2976.18,-7222.98 2973.41,-7216.52 2970.33,-7210.47"/>
<polygon fill="black" stroke="black" points="2973.21,-7208.46 2965.32,-7201.39 2967.08,-7211.84 2973.21,-7208.46"/>
</g>
<!-- mha_input_11 -->
<g id="node367" class="node">
<title>mha_input_11</title>
<polygon fill="yellow" stroke="black" points="2966.16,-7689.35 2727.29,-7689.35 2665.84,-7601.35 2904.71,-7601.35 2966.16,-7689.35"/>
<text text-anchor="middle" x="2816" y="-7654.55" font-family="Arial" font-size="11.00">MHA_Input_11</text>
<text text-anchor="middle" x="2816" y="-7642.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2816" y="-7630.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_11&#45;&gt;mha_input_11 -->
<g id="edge245" class="edge">
<title>pre_ln_11&#45;&gt;mha_input_11</title>
<path fill="none" stroke="black" d="M2847.2,-7731.16C2843.76,-7721.81 2839.55,-7710.37 2835.35,-7698.96"/>
<polygon fill="black" stroke="black" points="2838.58,-7697.6 2831.85,-7689.42 2832.01,-7700.01 2838.58,-7697.6"/>
</g>
<!-- qkv_proj_11_gpu0 -->
<g id="node368" class="node">
<title>qkv_proj_11_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2725.5,-7565.35 2502.5,-7565.35 2502.5,-7521.35 2725.5,-7521.35 2725.5,-7565.35"/>
<text text-anchor="middle" x="2614" y="-7552.55" font-family="Arial" font-size="11.00">QKV_Proj_11_GPU0</text>
<text text-anchor="middle" x="2614" y="-7540.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2614" y="-7528.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_11&#45;&gt;qkv_proj_11_gpu0 -->
<g id="edge246" class="edge">
<title>mha_input_11&#45;&gt;qkv_proj_11_gpu0</title>
<path fill="none" stroke="black" d="M2728.87,-7601.22C2707.3,-7590.54 2684.88,-7579.44 2665.63,-7569.91"/>
<polygon fill="black" stroke="black" points="2666.97,-7566.67 2656.45,-7565.37 2663.86,-7572.94 2666.97,-7566.67"/>
</g>
<!-- qkv_proj_11_gpu1 -->
<g id="node369" class="node">
<title>qkv_proj_11_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2966.5,-7565.35 2743.5,-7565.35 2743.5,-7521.35 2966.5,-7521.35 2966.5,-7565.35"/>
<text text-anchor="middle" x="2855" y="-7552.55" font-family="Arial" font-size="11.00">QKV_Proj_11_GPU1</text>
<text text-anchor="middle" x="2855" y="-7540.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-7528.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_11&#45;&gt;qkv_proj_11_gpu1 -->
<g id="edge247" class="edge">
<title>mha_input_11&#45;&gt;qkv_proj_11_gpu1</title>
<path fill="none" stroke="black" d="M2832.88,-7601.07C2836.3,-7592.29 2839.84,-7583.23 2843.05,-7574.99"/>
<polygon fill="black" stroke="black" points="2846.41,-7576.02 2846.78,-7565.43 2839.88,-7573.48 2846.41,-7576.02"/>
</g>
<!-- attn_11_gpu0 -->
<g id="node370" class="node">
<title>attn_11_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2709.5,-7485.35 2576.5,-7485.35 2576.5,-7441.35 2709.5,-7441.35 2709.5,-7485.35"/>
<text text-anchor="middle" x="2643" y="-7472.55" font-family="Arial" font-size="11.00">Attention_11_GPU0</text>
<text text-anchor="middle" x="2643" y="-7460.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2643" y="-7448.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_11_gpu0&#45;&gt;attn_11_gpu0 -->
<g id="edge248" class="edge">
<title>qkv_proj_11_gpu0&#45;&gt;attn_11_gpu0</title>
<path fill="none" stroke="black" d="M2621.92,-7521.04C2624.92,-7512.98 2628.39,-7503.64 2631.65,-7494.89"/>
<polygon fill="black" stroke="black" points="2634.98,-7495.96 2635.19,-7485.37 2628.42,-7493.52 2634.98,-7495.96"/>
</g>
<!-- attn_11_gpu1 -->
<g id="node371" class="node">
<title>attn_11_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2911.5,-7485.35 2778.5,-7485.35 2778.5,-7441.35 2911.5,-7441.35 2911.5,-7485.35"/>
<text text-anchor="middle" x="2845" y="-7472.55" font-family="Arial" font-size="11.00">Attention_11_GPU1</text>
<text text-anchor="middle" x="2845" y="-7460.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2845" y="-7448.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_11_gpu1&#45;&gt;attn_11_gpu1 -->
<g id="edge249" class="edge">
<title>qkv_proj_11_gpu1&#45;&gt;attn_11_gpu1</title>
<path fill="none" stroke="black" d="M2852.27,-7521.04C2851.26,-7513.15 2850.09,-7504.04 2848.99,-7495.46"/>
<polygon fill="black" stroke="black" points="2852.44,-7494.84 2847.69,-7485.37 2845.49,-7495.73 2852.44,-7494.84"/>
</g>
<!-- out_proj_11_gpu0 -->
<g id="node372" class="node">
<title>out_proj_11_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2734.5,-7405.35 2589.5,-7405.35 2589.5,-7361.35 2734.5,-7361.35 2734.5,-7405.35"/>
<text text-anchor="middle" x="2662" y="-7392.55" font-family="Arial" font-size="11.00">Output_Proj_11_GPU0</text>
<text text-anchor="middle" x="2662" y="-7380.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2662" y="-7368.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_11_gpu0&#45;&gt;out_proj_11_gpu0 -->
<g id="edge250" class="edge">
<title>attn_11_gpu0&#45;&gt;out_proj_11_gpu0</title>
<path fill="none" stroke="black" d="M2648.19,-7441.04C2650.13,-7433.06 2652.38,-7423.84 2654.49,-7415.17"/>
<polygon fill="black" stroke="black" points="2657.91,-7415.91 2656.88,-7405.37 2651.11,-7414.26 2657.91,-7415.91"/>
</g>
<!-- out_proj_11_gpu1 -->
<g id="node373" class="node">
<title>out_proj_11_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2907.5,-7405.35 2762.5,-7405.35 2762.5,-7361.35 2907.5,-7361.35 2907.5,-7405.35"/>
<text text-anchor="middle" x="2835" y="-7392.55" font-family="Arial" font-size="11.00">Output_Proj_11_GPU1</text>
<text text-anchor="middle" x="2835" y="-7380.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2835" y="-7368.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_11_gpu1&#45;&gt;out_proj_11_gpu1 -->
<g id="edge251" class="edge">
<title>attn_11_gpu1&#45;&gt;out_proj_11_gpu1</title>
<path fill="none" stroke="black" d="M2842.27,-7441.04C2841.26,-7433.15 2840.09,-7424.04 2838.99,-7415.46"/>
<polygon fill="black" stroke="black" points="2842.44,-7414.84 2837.69,-7405.37 2835.49,-7415.73 2842.44,-7414.84"/>
</g>
<!-- mha_merge_11 -->
<g id="node374" class="node">
<title>mha_merge_11</title>
<polygon fill="yellow" stroke="black" points="2966.16,-7325.35 2727.29,-7325.35 2665.84,-7237.35 2904.71,-7237.35 2966.16,-7325.35"/>
<text text-anchor="middle" x="2816" y="-7290.55" font-family="Arial" font-size="11.00">MHA_Merge_11</text>
<text text-anchor="middle" x="2816" y="-7278.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2816" y="-7266.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_11_gpu0&#45;&gt;mha_merge_11 -->
<g id="edge252" class="edge">
<title>out_proj_11_gpu0&#45;&gt;mha_merge_11</title>
<path fill="none" stroke="black" d="M2694.66,-7361.14C2708.27,-7352.31 2724.68,-7341.65 2740.97,-7331.07"/>
<polygon fill="black" stroke="black" points="2742.99,-7333.94 2749.47,-7325.56 2739.17,-7328.07 2742.99,-7333.94"/>
</g>
<!-- out_proj_11_gpu1&#45;&gt;mha_merge_11 -->
<g id="edge253" class="edge">
<title>out_proj_11_gpu1&#45;&gt;mha_merge_11</title>
<path fill="none" stroke="black" d="M2830.97,-7361.14C2829.53,-7353.57 2827.84,-7344.65 2826.12,-7335.59"/>
<polygon fill="black" stroke="black" points="2829.55,-7334.93 2824.25,-7325.76 2822.68,-7336.24 2829.55,-7334.93"/>
</g>
<!-- mha_merge_11&#45;&gt;add_1_11 -->
<g id="edge254" class="edge">
<title>mha_merge_11&#45;&gt;add_1_11</title>
<path fill="none" stroke="black" d="M2874.43,-7237.07C2887.98,-7227.04 2902.02,-7216.63 2914.33,-7207.52"/>
<polygon fill="black" stroke="black" points="2916.59,-7210.2 2922.54,-7201.43 2912.42,-7204.57 2916.59,-7210.2"/>
</g>
<!-- post_ln_11 -->
<g id="node376" class="node">
<title>post_ln_11</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-7121.35 2822.5,-7121.35 2822.5,-7077.35 2967.5,-7077.35 2967.5,-7121.35"/>
<text text-anchor="middle" x="2895" y="-7108.55" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_11</text>
<text text-anchor="middle" x="2895" y="-7096.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-7084.55" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_11&#45;&gt;post_ln_11 -->
<g id="edge256" class="edge">
<title>add_1_11&#45;&gt;post_ln_11</title>
<path fill="none" stroke="black" d="M2935.7,-7157.04C2929.66,-7148.63 2922.62,-7138.83 2916.12,-7129.77"/>
<polygon fill="black" stroke="black" points="2918.77,-7127.45 2910.09,-7121.37 2913.08,-7131.53 2918.77,-7127.45"/>
</g>
<!-- add_2_11 -->
<g id="node398" class="node">
<title>add_2_11</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-6327.13 2828.5,-6327.13 2828.5,-6283.13 3067.5,-6283.13 3067.5,-6327.13"/>
<text text-anchor="middle" x="2948" y="-6314.33" font-family="Arial" font-size="11.00">Residual_Add2_11</text>
<text text-anchor="middle" x="2948" y="-6302.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-6290.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_11&#45;&gt;add_2_11 -->
<g id="edge265" class="edge">
<title>add_1_11&#45;&gt;add_2_11</title>
<path fill="none" stroke="black" d="M2984.86,-7157.35C3027.99,-7127.69 3097,-7069.17 3097,-6998.35 3097,-6998.35 3097,-6998.35 3097,-6530.13 3097,-6452.32 3138.2,-6417.74 3092,-6355.13 3085.15,-6345.84 3076.44,-6338.3 3066.71,-6332.17"/>
<polygon fill="black" stroke="black" points="3068.33,-6329.07 3057.91,-6327.15 3064.86,-6335.15 3068.33,-6329.07"/>
</g>
<!-- gate_11 -->
<g id="node377" class="node">
<title>gate_11</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-7041.35 2742.05,-7041.35 2655.5,-6953.35 2991.95,-6953.35 3078.5,-7041.35"/>
<text text-anchor="middle" x="2867" y="-7006.55" font-family="Arial" font-size="11.00">Expert_Gate_11</text>
<text text-anchor="middle" x="2867" y="-6994.55" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-6982.55" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_11&#45;&gt;gate_11 -->
<g id="edge257" class="edge">
<title>post_ln_11&#45;&gt;gate_11</title>
<path fill="none" stroke="black" d="M2889.06,-7077.14C2886.94,-7069.57 2884.44,-7060.65 2881.91,-7051.59"/>
<polygon fill="black" stroke="black" points="2885.22,-7050.45 2879.15,-7041.76 2878.48,-7052.33 2885.22,-7050.45"/>
</g>
<!-- token_dist_11 -->
<g id="node378" class="node">
<title>token_dist_11</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-6886.24" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-6895.44" font-family="Arial" font-size="11.00">Token_Distribution_11</text>
<text text-anchor="middle" x="2881" y="-6883.44" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-6871.44" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_11&#45;&gt;token_dist_11 -->
<g id="edge258" class="edge">
<title>gate_11&#45;&gt;token_dist_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-6953.23C2873.61,-6944.85 2874.73,-6936.1 2875.79,-6927.81"/>
<polygon fill="red" stroke="red" points="2879.3,-6927.98 2877.1,-6917.62 2872.36,-6927.09 2879.3,-6927.98"/>
</g>
<!-- expert_11_0_gpu0 -->
<g id="node379" class="node">
<title>expert_11_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-6757.13 2820,-6757.13 2820,-6713.13 2942,-6713.13 2942,-6757.13"/>
<text text-anchor="middle" x="2881" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_11&#45;&gt;expert_11_0_gpu0 -->
<g id="edge259" class="edge">
<title>token_dist_11&#45;&gt;expert_11_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-6855.06C2881,-6829.48 2881,-6792.95 2881,-6767.13"/>
<polygon fill="black" stroke="black" points="2884.5,-6767.13 2881,-6757.13 2877.5,-6767.13 2884.5,-6767.13"/>
</g>
<!-- expert_11_0_gpu1 -->
<g id="node380" class="node">
<title>expert_11_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-6655.13 2885,-6655.13 2885,-6611.13 3007,-6611.13 3007,-6655.13"/>
<text text-anchor="middle" x="2946" y="-6642.33" font-family="Arial" font-size="11.00">Expert_11_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-6630.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-6618.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_11&#45;&gt;expert_11_0_gpu1 -->
<g id="edge260" class="edge">
<title>token_dist_11&#45;&gt;expert_11_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-6857.8C2945.77,-6854.6 2948.67,-6851.05 2951,-6847.13 2984.76,-6790.31 2968.96,-6709.04 2956.33,-6665.13"/>
<polygon fill="black" stroke="black" points="2959.62,-6663.9 2953.38,-6655.33 2952.91,-6665.91 2959.62,-6663.9"/>
</g>
<!-- expert_11_0_gpu0&#45;&gt;expert_11_0_gpu1 -->
<g id="edge261" class="edge">
<title>expert_11_0_gpu0&#45;&gt;expert_11_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-6712.92C2904.09,-6698.6 2916.51,-6679.5 2926.78,-6663.7"/>
<polygon fill="black" stroke="black" points="2929.72,-6665.6 2932.24,-6655.3 2923.85,-6661.78 2929.72,-6665.6"/>
</g>
<!-- expert_merge_11_0 -->
<g id="node381" class="node">
<title>expert_merge_11_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-6575.13 2871.29,-6575.13 2819.53,-6487.13 3020.71,-6487.13 3072.47,-6575.13"/>
<text text-anchor="middle" x="2946" y="-6540.33" font-family="Arial" font-size="11.00">Expert_Merge_11_0</text>
<text text-anchor="middle" x="2946" y="-6528.33" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-6516.33" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_11_0_gpu1&#45;&gt;expert_merge_11_0 -->
<g id="edge262" class="edge">
<title>expert_11_0_gpu1&#45;&gt;expert_merge_11_0</title>
<path fill="none" stroke="black" d="M2946,-6610.92C2946,-6603.42 2946,-6594.61 2946,-6585.65"/>
<polygon fill="black" stroke="black" points="2949.5,-6585.53 2946,-6575.53 2942.5,-6585.53 2949.5,-6585.53"/>
</g>
<!-- expert_agg_11 -->
<g id="node397" class="node">
<title>expert_agg_11</title>
<polygon fill="yellow" stroke="black" points="3077.82,-6451.13 2823.58,-6451.13 2758.18,-6363.13 3012.42,-6363.13 3077.82,-6451.13"/>
<text text-anchor="middle" x="2918" y="-6416.33" font-family="Arial" font-size="11.00">Expert_Aggregation_11</text>
<text text-anchor="middle" x="2918" y="-6404.33" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-6392.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_11_0&#45;&gt;expert_agg_11 -->
<g id="edge263" class="edge">
<title>expert_merge_11_0&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M2936.13,-6487.11C2934.2,-6478.73 2932.17,-6469.85 2930.18,-6461.19"/>
<polygon fill="black" stroke="black" points="2933.53,-6460.13 2927.88,-6451.16 2926.7,-6461.69 2933.53,-6460.13"/>
</g>
<!-- expert_11_1_gpu0 -->
<g id="node382" class="node">
<title>expert_11_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-6757.13 2674,-6757.13 2674,-6713.13 2796,-6713.13 2796,-6757.13"/>
<text text-anchor="middle" x="2735" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_1_gpu1 -->
<g id="node383" class="node">
<title>expert_11_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-6757.13 2534,-6757.13 2534,-6713.13 2656,-6713.13 2656,-6757.13"/>
<text text-anchor="middle" x="2595" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_1 -->
<g id="node384" class="node">
<title>expert_merge_11_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-6779.13 2315.29,-6779.13 2263.53,-6691.13 2464.71,-6691.13 2516.47,-6779.13"/>
<text text-anchor="middle" x="2390" y="-6744.33" font-family="Arial" font-size="11.00">Expert_Merge_11_1</text>
<text text-anchor="middle" x="2390" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_11_2_gpu0 -->
<g id="node385" class="node">
<title>expert_11_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-6757.13 2118,-6757.13 2118,-6713.13 2240,-6713.13 2240,-6757.13"/>
<text text-anchor="middle" x="2179" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_2_gpu1 -->
<g id="node386" class="node">
<title>expert_11_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-6757.13 1978,-6757.13 1978,-6713.13 2100,-6713.13 2100,-6757.13"/>
<text text-anchor="middle" x="2039" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_2 -->
<g id="node387" class="node">
<title>expert_merge_11_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-6779.13 1759.29,-6779.13 1707.53,-6691.13 1908.71,-6691.13 1960.47,-6779.13"/>
<text text-anchor="middle" x="1834" y="-6744.33" font-family="Arial" font-size="11.00">Expert_Merge_11_2</text>
<text text-anchor="middle" x="1834" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_11_61_gpu0 -->
<g id="node388" class="node">
<title>expert_11_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-6757.13 1562,-6757.13 1562,-6713.13 1684,-6713.13 1684,-6757.13"/>
<text text-anchor="middle" x="1623" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_61_gpu1 -->
<g id="node389" class="node">
<title>expert_11_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-6757.13 1422,-6757.13 1422,-6713.13 1544,-6713.13 1544,-6757.13"/>
<text text-anchor="middle" x="1483" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_61 -->
<g id="node390" class="node">
<title>expert_merge_11_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-6779.13 1203.29,-6779.13 1151.53,-6691.13 1352.71,-6691.13 1404.47,-6779.13"/>
<text text-anchor="middle" x="1278" y="-6744.33" font-family="Arial" font-size="11.00">Expert_Merge_11_61</text>
<text text-anchor="middle" x="1278" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_11_62_gpu0 -->
<g id="node391" class="node">
<title>expert_11_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-6757.13 1006,-6757.13 1006,-6713.13 1128,-6713.13 1128,-6757.13"/>
<text text-anchor="middle" x="1067" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_62_gpu1 -->
<g id="node392" class="node">
<title>expert_11_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-6757.13 866,-6757.13 866,-6713.13 988,-6713.13 988,-6757.13"/>
<text text-anchor="middle" x="927" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_62_GPU1</text>
<text text-anchor="middle" x="927" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_62 -->
<g id="node393" class="node">
<title>expert_merge_11_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-6779.13 647.29,-6779.13 595.53,-6691.13 796.71,-6691.13 848.47,-6779.13"/>
<text text-anchor="middle" x="722" y="-6744.33" font-family="Arial" font-size="11.00">Expert_Merge_11_62</text>
<text text-anchor="middle" x="722" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_11_63_gpu0 -->
<g id="node394" class="node">
<title>expert_11_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-6757.13 450,-6757.13 450,-6713.13 572,-6713.13 572,-6757.13"/>
<text text-anchor="middle" x="511" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_63_GPU0</text>
<text text-anchor="middle" x="511" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_63_gpu1 -->
<g id="node395" class="node">
<title>expert_11_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-6757.13 310,-6757.13 310,-6713.13 432,-6713.13 432,-6757.13"/>
<text text-anchor="middle" x="371" y="-6744.33" font-family="Arial" font-size="11.00">Expert_11_63_GPU1</text>
<text text-anchor="middle" x="371" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_63 -->
<g id="node396" class="node">
<title>expert_merge_11_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-6779.13 91.29,-6779.13 39.53,-6691.13 240.71,-6691.13 292.47,-6779.13"/>
<text text-anchor="middle" x="166" y="-6744.33" font-family="Arial" font-size="11.00">Expert_Merge_11_63</text>
<text text-anchor="middle" x="166" y="-6732.33" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-6720.33" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_11&#45;&gt;add_2_11 -->
<g id="edge264" class="edge">
<title>expert_agg_11&#45;&gt;add_2_11</title>
<path fill="none" stroke="black" d="M2930.98,-6362.85C2933.59,-6354.16 2936.28,-6345.2 2938.73,-6337.04"/>
<polygon fill="black" stroke="black" points="2942.15,-6337.79 2941.68,-6327.21 2935.45,-6335.78 2942.15,-6337.79"/>
</g>
<!-- pre_ln_12 -->
<g id="node399" class="node">
<title>pre_ln_12</title>
<polygon fill="lightgreen" stroke="black" points="3005.5,-6233.13 2860.5,-6233.13 2860.5,-6189.13 3005.5,-6189.13 3005.5,-6233.13"/>
<text text-anchor="middle" x="2933" y="-6220.33" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_12</text>
<text text-anchor="middle" x="2933" y="-6208.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-6196.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_11&#45;&gt;pre_ln_12 -->
<g id="edge266" class="edge">
<title>add_2_11&#45;&gt;pre_ln_12</title>
<path fill="none" stroke="black" d="M2944.52,-6282.79C2942.61,-6271.06 2940.2,-6256.3 2938.08,-6243.3"/>
<polygon fill="black" stroke="black" points="2941.52,-6242.66 2936.46,-6233.35 2934.62,-6243.78 2941.52,-6242.66"/>
</g>
<!-- add_1_12 -->
<g id="node408" class="node">
<title>add_1_12</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-5659.13 2831.5,-5659.13 2831.5,-5615.13 3070.5,-5615.13 3070.5,-5659.13"/>
<text text-anchor="middle" x="2951" y="-5646.33" font-family="Arial" font-size="11.00">Residual_Add1_12</text>
<text text-anchor="middle" x="2951" y="-5634.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-5622.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_11&#45;&gt;add_1_12 -->
<g id="edge277" class="edge">
<title>add_2_11&#45;&gt;add_1_12</title>
<path fill="none" stroke="black" d="M2995.38,-6282.92C3002.51,-6278.39 3009.35,-6273.12 3015,-6267.13 3066.87,-6212.06 3064,-6179.77 3064,-6104.13 3064,-6104.13 3064,-6104.13 3064,-5840.13 3064,-5772.03 3094.07,-5743.59 3056,-5687.13 3049.84,-5678 3041.52,-5670.53 3032.24,-5664.43"/>
<polygon fill="black" stroke="black" points="3033.86,-5661.33 3023.47,-5659.21 3030.27,-5667.34 3033.86,-5661.33"/>
</g>
<!-- mha_input_12 -->
<g id="node400" class="node">
<title>mha_input_12</title>
<polygon fill="yellow" stroke="black" points="3044.16,-6147.13 2805.29,-6147.13 2743.84,-6059.13 2982.71,-6059.13 3044.16,-6147.13"/>
<text text-anchor="middle" x="2894" y="-6112.33" font-family="Arial" font-size="11.00">MHA_Input_12</text>
<text text-anchor="middle" x="2894" y="-6100.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2894" y="-6088.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_12&#45;&gt;mha_input_12 -->
<g id="edge267" class="edge">
<title>pre_ln_12&#45;&gt;mha_input_12</title>
<path fill="none" stroke="black" d="M2925.2,-6188.93C2921.76,-6179.59 2917.55,-6168.15 2913.35,-6156.73"/>
<polygon fill="black" stroke="black" points="2916.58,-6155.37 2909.85,-6147.19 2910.01,-6157.79 2916.58,-6155.37"/>
</g>
<!-- qkv_proj_12_gpu0 -->
<g id="node401" class="node">
<title>qkv_proj_12_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-6023.13 2580.5,-6023.13 2580.5,-5979.13 2803.5,-5979.13 2803.5,-6023.13"/>
<text text-anchor="middle" x="2692" y="-6010.33" font-family="Arial" font-size="11.00">QKV_Proj_12_GPU0</text>
<text text-anchor="middle" x="2692" y="-5998.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2692" y="-5986.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_12&#45;&gt;qkv_proj_12_gpu0 -->
<g id="edge268" class="edge">
<title>mha_input_12&#45;&gt;qkv_proj_12_gpu0</title>
<path fill="none" stroke="black" d="M2806.87,-6058.99C2785.3,-6048.32 2762.88,-6037.22 2743.63,-6027.69"/>
<polygon fill="black" stroke="black" points="2744.97,-6024.44 2734.45,-6023.14 2741.86,-6030.72 2744.97,-6024.44"/>
</g>
<!-- qkv_proj_12_gpu1 -->
<g id="node402" class="node">
<title>qkv_proj_12_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3044.5,-6023.13 2821.5,-6023.13 2821.5,-5979.13 3044.5,-5979.13 3044.5,-6023.13"/>
<text text-anchor="middle" x="2933" y="-6010.33" font-family="Arial" font-size="11.00">QKV_Proj_12_GPU1</text>
<text text-anchor="middle" x="2933" y="-5998.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-5986.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_12&#45;&gt;qkv_proj_12_gpu1 -->
<g id="edge269" class="edge">
<title>mha_input_12&#45;&gt;qkv_proj_12_gpu1</title>
<path fill="none" stroke="black" d="M2910.88,-6058.85C2914.3,-6050.07 2917.84,-6041 2921.05,-6032.77"/>
<polygon fill="black" stroke="black" points="2924.41,-6033.8 2924.78,-6023.21 2917.88,-6031.25 2924.41,-6033.8"/>
</g>
<!-- attn_12_gpu0 -->
<g id="node403" class="node">
<title>attn_12_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2777.5,-5943.13 2644.5,-5943.13 2644.5,-5899.13 2777.5,-5899.13 2777.5,-5943.13"/>
<text text-anchor="middle" x="2711" y="-5930.33" font-family="Arial" font-size="11.00">Attention_12_GPU0</text>
<text text-anchor="middle" x="2711" y="-5918.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2711" y="-5906.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_12_gpu0&#45;&gt;attn_12_gpu0 -->
<g id="edge270" class="edge">
<title>qkv_proj_12_gpu0&#45;&gt;attn_12_gpu0</title>
<path fill="none" stroke="black" d="M2697.19,-5978.81C2699.13,-5970.84 2701.38,-5961.61 2703.49,-5952.95"/>
<polygon fill="black" stroke="black" points="2706.91,-5953.69 2705.88,-5943.14 2700.11,-5952.03 2706.91,-5953.69"/>
</g>
<!-- attn_12_gpu1 -->
<g id="node404" class="node">
<title>attn_12_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-5943.13 2856.5,-5943.13 2856.5,-5899.13 2989.5,-5899.13 2989.5,-5943.13"/>
<text text-anchor="middle" x="2923" y="-5930.33" font-family="Arial" font-size="11.00">Attention_12_GPU1</text>
<text text-anchor="middle" x="2923" y="-5918.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2923" y="-5906.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_12_gpu1&#45;&gt;attn_12_gpu1 -->
<g id="edge271" class="edge">
<title>qkv_proj_12_gpu1&#45;&gt;attn_12_gpu1</title>
<path fill="none" stroke="black" d="M2930.27,-5978.81C2929.26,-5970.92 2928.09,-5961.81 2926.99,-5953.23"/>
<polygon fill="black" stroke="black" points="2930.44,-5952.62 2925.69,-5943.14 2923.49,-5953.51 2930.44,-5952.62"/>
</g>
<!-- out_proj_12_gpu0 -->
<g id="node405" class="node">
<title>out_proj_12_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-5863.13 2658.5,-5863.13 2658.5,-5819.13 2803.5,-5819.13 2803.5,-5863.13"/>
<text text-anchor="middle" x="2731" y="-5850.33" font-family="Arial" font-size="11.00">Output_Proj_12_GPU0</text>
<text text-anchor="middle" x="2731" y="-5838.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2731" y="-5826.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_12_gpu0&#45;&gt;out_proj_12_gpu0 -->
<g id="edge272" class="edge">
<title>attn_12_gpu0&#45;&gt;out_proj_12_gpu0</title>
<path fill="none" stroke="black" d="M2716.47,-5898.81C2718.51,-5890.84 2720.88,-5881.61 2723.1,-5872.95"/>
<polygon fill="black" stroke="black" points="2726.52,-5873.7 2725.61,-5863.14 2719.74,-5871.96 2726.52,-5873.7"/>
</g>
<!-- out_proj_12_gpu1 -->
<g id="node406" class="node">
<title>out_proj_12_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2985.5,-5863.13 2840.5,-5863.13 2840.5,-5819.13 2985.5,-5819.13 2985.5,-5863.13"/>
<text text-anchor="middle" x="2913" y="-5850.33" font-family="Arial" font-size="11.00">Output_Proj_12_GPU1</text>
<text text-anchor="middle" x="2913" y="-5838.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2913" y="-5826.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_12_gpu1&#45;&gt;out_proj_12_gpu1 -->
<g id="edge273" class="edge">
<title>attn_12_gpu1&#45;&gt;out_proj_12_gpu1</title>
<path fill="none" stroke="black" d="M2920.27,-5898.81C2919.26,-5890.92 2918.09,-5881.81 2916.99,-5873.23"/>
<polygon fill="black" stroke="black" points="2920.44,-5872.62 2915.69,-5863.14 2913.49,-5873.51 2920.44,-5872.62"/>
</g>
<!-- mha_merge_12 -->
<g id="node407" class="node">
<title>mha_merge_12</title>
<polygon fill="yellow" stroke="black" points="3044.16,-5783.13 2805.29,-5783.13 2743.84,-5695.13 2982.71,-5695.13 3044.16,-5783.13"/>
<text text-anchor="middle" x="2894" y="-5748.33" font-family="Arial" font-size="11.00">MHA_Merge_12</text>
<text text-anchor="middle" x="2894" y="-5736.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2894" y="-5724.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_12_gpu0&#45;&gt;mha_merge_12 -->
<g id="edge274" class="edge">
<title>out_proj_12_gpu0&#45;&gt;mha_merge_12</title>
<path fill="none" stroke="black" d="M2765.57,-5818.92C2779.97,-5810.08 2797.34,-5799.43 2814.59,-5788.85"/>
<polygon fill="black" stroke="black" points="2816.89,-5791.54 2823.58,-5783.33 2813.23,-5785.58 2816.89,-5791.54"/>
</g>
<!-- out_proj_12_gpu1&#45;&gt;mha_merge_12 -->
<g id="edge275" class="edge">
<title>out_proj_12_gpu1&#45;&gt;mha_merge_12</title>
<path fill="none" stroke="black" d="M2908.97,-5818.92C2907.53,-5811.34 2905.84,-5802.42 2904.12,-5793.36"/>
<polygon fill="black" stroke="black" points="2907.55,-5792.7 2902.25,-5783.53 2900.68,-5794.01 2907.55,-5792.7"/>
</g>
<!-- mha_merge_12&#45;&gt;add_1_12 -->
<g id="edge276" class="edge">
<title>mha_merge_12&#45;&gt;add_1_12</title>
<path fill="none" stroke="black" d="M2918.67,-5694.85C2923.84,-5685.78 2929.18,-5676.4 2934,-5667.96"/>
<polygon fill="black" stroke="black" points="2937.07,-5669.63 2938.98,-5659.21 2930.99,-5666.16 2937.07,-5669.63"/>
</g>
<!-- post_ln_12 -->
<g id="node409" class="node">
<title>post_ln_12</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-5579.13 2822.5,-5579.13 2822.5,-5535.13 2967.5,-5535.13 2967.5,-5579.13"/>
<text text-anchor="middle" x="2895" y="-5566.33" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_12</text>
<text text-anchor="middle" x="2895" y="-5554.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-5542.33" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_12&#45;&gt;post_ln_12 -->
<g id="edge278" class="edge">
<title>add_1_12&#45;&gt;post_ln_12</title>
<path fill="none" stroke="black" d="M2935.7,-5614.81C2929.66,-5606.4 2922.62,-5596.6 2916.12,-5587.54"/>
<polygon fill="black" stroke="black" points="2918.77,-5585.23 2910.09,-5579.14 2913.08,-5589.31 2918.77,-5585.23"/>
</g>
<!-- add_2_12 -->
<g id="node431" class="node">
<title>add_2_12</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-4784.9 2828.5,-4784.9 2828.5,-4740.9 3067.5,-4740.9 3067.5,-4784.9"/>
<text text-anchor="middle" x="2948" y="-4772.1" font-family="Arial" font-size="11.00">Residual_Add2_12</text>
<text text-anchor="middle" x="2948" y="-4760.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-4748.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_12&#45;&gt;add_2_12 -->
<g id="edge287" class="edge">
<title>add_1_12&#45;&gt;add_2_12</title>
<path fill="none" stroke="black" d="M2984.86,-5615.13C3027.99,-5585.47 3097,-5526.94 3097,-5456.13 3097,-5456.13 3097,-5456.13 3097,-4987.9 3097,-4910.09 3138.2,-4875.51 3092,-4812.9 3085.15,-4803.62 3076.44,-4796.07 3066.71,-4789.95"/>
<polygon fill="black" stroke="black" points="3068.33,-4786.84 3057.91,-4784.92 3064.86,-4792.92 3068.33,-4786.84"/>
</g>
<!-- gate_12 -->
<g id="node410" class="node">
<title>gate_12</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-5499.13 2742.05,-5499.13 2655.5,-5411.13 2991.95,-5411.13 3078.5,-5499.13"/>
<text text-anchor="middle" x="2867" y="-5464.33" font-family="Arial" font-size="11.00">Expert_Gate_12</text>
<text text-anchor="middle" x="2867" y="-5452.33" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-5440.33" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_12&#45;&gt;gate_12 -->
<g id="edge279" class="edge">
<title>post_ln_12&#45;&gt;gate_12</title>
<path fill="none" stroke="black" d="M2889.06,-5534.92C2886.94,-5527.34 2884.44,-5518.42 2881.91,-5509.36"/>
<polygon fill="black" stroke="black" points="2885.22,-5508.22 2879.15,-5499.53 2878.48,-5510.11 2885.22,-5508.22"/>
</g>
<!-- token_dist_12 -->
<g id="node411" class="node">
<title>token_dist_12</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-5344.01" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-5353.21" font-family="Arial" font-size="11.00">Token_Distribution_12</text>
<text text-anchor="middle" x="2881" y="-5341.21" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-5329.21" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_12&#45;&gt;token_dist_12 -->
<g id="edge280" class="edge">
<title>gate_12&#45;&gt;token_dist_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-5411C2873.61,-5402.63 2874.73,-5393.87 2875.79,-5385.58"/>
<polygon fill="red" stroke="red" points="2879.3,-5385.75 2877.1,-5375.39 2872.36,-5384.86 2879.3,-5385.75"/>
</g>
<!-- expert_12_0_gpu0 -->
<g id="node412" class="node">
<title>expert_12_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-5214.9 2820,-5214.9 2820,-5170.9 2942,-5170.9 2942,-5214.9"/>
<text text-anchor="middle" x="2881" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_12&#45;&gt;expert_12_0_gpu0 -->
<g id="edge281" class="edge">
<title>token_dist_12&#45;&gt;expert_12_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-5312.84C2881,-5287.26 2881,-5250.72 2881,-5224.91"/>
<polygon fill="black" stroke="black" points="2884.5,-5224.91 2881,-5214.91 2877.5,-5224.91 2884.5,-5224.91"/>
</g>
<!-- expert_12_0_gpu1 -->
<g id="node413" class="node">
<title>expert_12_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-5112.9 2885,-5112.9 2885,-5068.9 3007,-5068.9 3007,-5112.9"/>
<text text-anchor="middle" x="2946" y="-5100.1" font-family="Arial" font-size="11.00">Expert_12_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-5088.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-5076.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_12&#45;&gt;expert_12_0_gpu1 -->
<g id="edge282" class="edge">
<title>token_dist_12&#45;&gt;expert_12_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-5315.57C2945.77,-5312.37 2948.67,-5308.83 2951,-5304.9 2984.76,-5248.08 2968.96,-5166.82 2956.33,-5122.91"/>
<polygon fill="black" stroke="black" points="2959.62,-5121.67 2953.38,-5113.1 2952.91,-5123.69 2959.62,-5121.67"/>
</g>
<!-- expert_12_0_gpu0&#45;&gt;expert_12_0_gpu1 -->
<g id="edge283" class="edge">
<title>expert_12_0_gpu0&#45;&gt;expert_12_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-5170.69C2904.09,-5156.38 2916.51,-5137.28 2926.78,-5121.47"/>
<polygon fill="black" stroke="black" points="2929.72,-5123.37 2932.24,-5113.08 2923.85,-5119.56 2929.72,-5123.37"/>
</g>
<!-- expert_merge_12_0 -->
<g id="node414" class="node">
<title>expert_merge_12_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-5032.9 2871.29,-5032.9 2819.53,-4944.9 3020.71,-4944.9 3072.47,-5032.9"/>
<text text-anchor="middle" x="2946" y="-4998.1" font-family="Arial" font-size="11.00">Expert_Merge_12_0</text>
<text text-anchor="middle" x="2946" y="-4986.1" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-4974.1" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_12_0_gpu1&#45;&gt;expert_merge_12_0 -->
<g id="edge284" class="edge">
<title>expert_12_0_gpu1&#45;&gt;expert_merge_12_0</title>
<path fill="none" stroke="black" d="M2946,-5068.69C2946,-5061.2 2946,-5052.39 2946,-5043.43"/>
<polygon fill="black" stroke="black" points="2949.5,-5043.31 2946,-5033.31 2942.5,-5043.31 2949.5,-5043.31"/>
</g>
<!-- expert_agg_12 -->
<g id="node430" class="node">
<title>expert_agg_12</title>
<polygon fill="yellow" stroke="black" points="3077.82,-4908.9 2823.58,-4908.9 2758.18,-4820.9 3012.42,-4820.9 3077.82,-4908.9"/>
<text text-anchor="middle" x="2918" y="-4874.1" font-family="Arial" font-size="11.00">Expert_Aggregation_12</text>
<text text-anchor="middle" x="2918" y="-4862.1" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-4850.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_12_0&#45;&gt;expert_agg_12 -->
<g id="edge285" class="edge">
<title>expert_merge_12_0&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M2936.13,-4944.89C2934.2,-4936.51 2932.17,-4927.63 2930.18,-4918.96"/>
<polygon fill="black" stroke="black" points="2933.53,-4917.9 2927.88,-4908.94 2926.7,-4919.47 2933.53,-4917.9"/>
</g>
<!-- expert_12_1_gpu0 -->
<g id="node415" class="node">
<title>expert_12_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-5214.9 2674,-5214.9 2674,-5170.9 2796,-5170.9 2796,-5214.9"/>
<text text-anchor="middle" x="2735" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_1_gpu1 -->
<g id="node416" class="node">
<title>expert_12_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-5214.9 2534,-5214.9 2534,-5170.9 2656,-5170.9 2656,-5214.9"/>
<text text-anchor="middle" x="2595" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_1 -->
<g id="node417" class="node">
<title>expert_merge_12_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-5236.9 2315.29,-5236.9 2263.53,-5148.9 2464.71,-5148.9 2516.47,-5236.9"/>
<text text-anchor="middle" x="2390" y="-5202.1" font-family="Arial" font-size="11.00">Expert_Merge_12_1</text>
<text text-anchor="middle" x="2390" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_12_2_gpu0 -->
<g id="node418" class="node">
<title>expert_12_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-5214.9 2118,-5214.9 2118,-5170.9 2240,-5170.9 2240,-5214.9"/>
<text text-anchor="middle" x="2179" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_2_gpu1 -->
<g id="node419" class="node">
<title>expert_12_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-5214.9 1978,-5214.9 1978,-5170.9 2100,-5170.9 2100,-5214.9"/>
<text text-anchor="middle" x="2039" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_2 -->
<g id="node420" class="node">
<title>expert_merge_12_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-5236.9 1759.29,-5236.9 1707.53,-5148.9 1908.71,-5148.9 1960.47,-5236.9"/>
<text text-anchor="middle" x="1834" y="-5202.1" font-family="Arial" font-size="11.00">Expert_Merge_12_2</text>
<text text-anchor="middle" x="1834" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_12_61_gpu0 -->
<g id="node421" class="node">
<title>expert_12_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-5214.9 1562,-5214.9 1562,-5170.9 1684,-5170.9 1684,-5214.9"/>
<text text-anchor="middle" x="1623" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_61_gpu1 -->
<g id="node422" class="node">
<title>expert_12_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-5214.9 1422,-5214.9 1422,-5170.9 1544,-5170.9 1544,-5214.9"/>
<text text-anchor="middle" x="1483" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_61 -->
<g id="node423" class="node">
<title>expert_merge_12_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-5236.9 1203.29,-5236.9 1151.53,-5148.9 1352.71,-5148.9 1404.47,-5236.9"/>
<text text-anchor="middle" x="1278" y="-5202.1" font-family="Arial" font-size="11.00">Expert_Merge_12_61</text>
<text text-anchor="middle" x="1278" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_12_62_gpu0 -->
<g id="node424" class="node">
<title>expert_12_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-5214.9 1006,-5214.9 1006,-5170.9 1128,-5170.9 1128,-5214.9"/>
<text text-anchor="middle" x="1067" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_62_gpu1 -->
<g id="node425" class="node">
<title>expert_12_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-5214.9 866,-5214.9 866,-5170.9 988,-5170.9 988,-5214.9"/>
<text text-anchor="middle" x="927" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_62_GPU1</text>
<text text-anchor="middle" x="927" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_62 -->
<g id="node426" class="node">
<title>expert_merge_12_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-5236.9 647.29,-5236.9 595.53,-5148.9 796.71,-5148.9 848.47,-5236.9"/>
<text text-anchor="middle" x="722" y="-5202.1" font-family="Arial" font-size="11.00">Expert_Merge_12_62</text>
<text text-anchor="middle" x="722" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_12_63_gpu0 -->
<g id="node427" class="node">
<title>expert_12_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-5214.9 450,-5214.9 450,-5170.9 572,-5170.9 572,-5214.9"/>
<text text-anchor="middle" x="511" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_63_GPU0</text>
<text text-anchor="middle" x="511" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_63_gpu1 -->
<g id="node428" class="node">
<title>expert_12_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-5214.9 310,-5214.9 310,-5170.9 432,-5170.9 432,-5214.9"/>
<text text-anchor="middle" x="371" y="-5202.1" font-family="Arial" font-size="11.00">Expert_12_63_GPU1</text>
<text text-anchor="middle" x="371" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_63 -->
<g id="node429" class="node">
<title>expert_merge_12_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-5236.9 91.29,-5236.9 39.53,-5148.9 240.71,-5148.9 292.47,-5236.9"/>
<text text-anchor="middle" x="166" y="-5202.1" font-family="Arial" font-size="11.00">Expert_Merge_12_63</text>
<text text-anchor="middle" x="166" y="-5190.1" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-5178.1" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_12&#45;&gt;add_2_12 -->
<g id="edge286" class="edge">
<title>expert_agg_12&#45;&gt;add_2_12</title>
<path fill="none" stroke="black" d="M2930.98,-4820.62C2933.59,-4811.94 2936.28,-4802.98 2938.73,-4794.81"/>
<polygon fill="black" stroke="black" points="2942.15,-4795.57 2941.68,-4784.98 2935.45,-4793.56 2942.15,-4795.57"/>
</g>
<!-- pre_ln_13 -->
<g id="node432" class="node">
<title>pre_ln_13</title>
<polygon fill="lightgreen" stroke="black" points="3005.5,-4690.9 2860.5,-4690.9 2860.5,-4646.9 3005.5,-4646.9 3005.5,-4690.9"/>
<text text-anchor="middle" x="2933" y="-4678.1" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_13</text>
<text text-anchor="middle" x="2933" y="-4666.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-4654.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_12&#45;&gt;pre_ln_13 -->
<g id="edge288" class="edge">
<title>add_2_12&#45;&gt;pre_ln_13</title>
<path fill="none" stroke="black" d="M2944.52,-4740.56C2942.61,-4728.84 2940.2,-4714.07 2938.08,-4701.08"/>
<polygon fill="black" stroke="black" points="2941.52,-4700.43 2936.46,-4691.12 2934.62,-4701.56 2941.52,-4700.43"/>
</g>
<!-- add_1_13 -->
<g id="node441" class="node">
<title>add_1_13</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-4116.9 2831.5,-4116.9 2831.5,-4072.9 3070.5,-4072.9 3070.5,-4116.9"/>
<text text-anchor="middle" x="2951" y="-4104.1" font-family="Arial" font-size="11.00">Residual_Add1_13</text>
<text text-anchor="middle" x="2951" y="-4092.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-4080.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_12&#45;&gt;add_1_13 -->
<g id="edge299" class="edge">
<title>add_2_12&#45;&gt;add_1_13</title>
<path fill="none" stroke="black" d="M2995.38,-4740.69C3002.51,-4736.16 3009.35,-4730.9 3015,-4724.9 3066.87,-4669.84 3064,-4637.55 3064,-4561.9 3064,-4561.9 3064,-4561.9 3064,-4297.9 3064,-4229.81 3094.07,-4201.36 3056,-4144.9 3049.84,-4135.77 3041.52,-4128.3 3032.24,-4122.21"/>
<polygon fill="black" stroke="black" points="3033.86,-4119.1 3023.47,-4116.99 3030.27,-4125.11 3033.86,-4119.1"/>
</g>
<!-- mha_input_13 -->
<g id="node433" class="node">
<title>mha_input_13</title>
<polygon fill="yellow" stroke="black" points="3044.16,-4604.9 2805.29,-4604.9 2743.84,-4516.9 2982.71,-4516.9 3044.16,-4604.9"/>
<text text-anchor="middle" x="2894" y="-4570.1" font-family="Arial" font-size="11.00">MHA_Input_13</text>
<text text-anchor="middle" x="2894" y="-4558.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2894" y="-4546.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_13&#45;&gt;mha_input_13 -->
<g id="edge289" class="edge">
<title>pre_ln_13&#45;&gt;mha_input_13</title>
<path fill="none" stroke="black" d="M2925.2,-4646.71C2921.76,-4637.36 2917.55,-4625.92 2913.35,-4614.51"/>
<polygon fill="black" stroke="black" points="2916.58,-4613.15 2909.85,-4604.97 2910.01,-4615.56 2916.58,-4613.15"/>
</g>
<!-- qkv_proj_13_gpu0 -->
<g id="node434" class="node">
<title>qkv_proj_13_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-4480.9 2580.5,-4480.9 2580.5,-4436.9 2803.5,-4436.9 2803.5,-4480.9"/>
<text text-anchor="middle" x="2692" y="-4468.1" font-family="Arial" font-size="11.00">QKV_Proj_13_GPU0</text>
<text text-anchor="middle" x="2692" y="-4456.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2692" y="-4444.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_13&#45;&gt;qkv_proj_13_gpu0 -->
<g id="edge290" class="edge">
<title>mha_input_13&#45;&gt;qkv_proj_13_gpu0</title>
<path fill="none" stroke="black" d="M2806.87,-4516.77C2785.3,-4506.09 2762.88,-4494.99 2743.63,-4485.46"/>
<polygon fill="black" stroke="black" points="2744.97,-4482.22 2734.45,-4480.92 2741.86,-4488.49 2744.97,-4482.22"/>
</g>
<!-- qkv_proj_13_gpu1 -->
<g id="node435" class="node">
<title>qkv_proj_13_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3044.5,-4480.9 2821.5,-4480.9 2821.5,-4436.9 3044.5,-4436.9 3044.5,-4480.9"/>
<text text-anchor="middle" x="2933" y="-4468.1" font-family="Arial" font-size="11.00">QKV_Proj_13_GPU1</text>
<text text-anchor="middle" x="2933" y="-4456.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-4444.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_13&#45;&gt;qkv_proj_13_gpu1 -->
<g id="edge291" class="edge">
<title>mha_input_13&#45;&gt;qkv_proj_13_gpu1</title>
<path fill="none" stroke="black" d="M2910.88,-4516.62C2914.3,-4507.84 2917.84,-4498.78 2921.05,-4490.54"/>
<polygon fill="black" stroke="black" points="2924.41,-4491.57 2924.78,-4480.98 2917.88,-4489.03 2924.41,-4491.57"/>
</g>
<!-- attn_13_gpu0 -->
<g id="node436" class="node">
<title>attn_13_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2787.5,-4400.9 2654.5,-4400.9 2654.5,-4356.9 2787.5,-4356.9 2787.5,-4400.9"/>
<text text-anchor="middle" x="2721" y="-4388.1" font-family="Arial" font-size="11.00">Attention_13_GPU0</text>
<text text-anchor="middle" x="2721" y="-4376.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2721" y="-4364.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_13_gpu0&#45;&gt;attn_13_gpu0 -->
<g id="edge292" class="edge">
<title>qkv_proj_13_gpu0&#45;&gt;attn_13_gpu0</title>
<path fill="none" stroke="black" d="M2699.92,-4436.59C2702.92,-4428.53 2706.39,-4419.18 2709.65,-4410.44"/>
<polygon fill="black" stroke="black" points="2712.98,-4411.51 2713.19,-4400.92 2706.42,-4409.07 2712.98,-4411.51"/>
</g>
<!-- attn_13_gpu1 -->
<g id="node437" class="node">
<title>attn_13_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-4400.9 2856.5,-4400.9 2856.5,-4356.9 2989.5,-4356.9 2989.5,-4400.9"/>
<text text-anchor="middle" x="2923" y="-4388.1" font-family="Arial" font-size="11.00">Attention_13_GPU1</text>
<text text-anchor="middle" x="2923" y="-4376.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2923" y="-4364.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_13_gpu1&#45;&gt;attn_13_gpu1 -->
<g id="edge293" class="edge">
<title>qkv_proj_13_gpu1&#45;&gt;attn_13_gpu1</title>
<path fill="none" stroke="black" d="M2930.27,-4436.59C2929.26,-4428.7 2928.09,-4419.59 2926.99,-4411"/>
<polygon fill="black" stroke="black" points="2930.44,-4410.39 2925.69,-4400.92 2923.49,-4411.28 2930.44,-4410.39"/>
</g>
<!-- out_proj_13_gpu0 -->
<g id="node438" class="node">
<title>out_proj_13_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2812.5,-4320.9 2667.5,-4320.9 2667.5,-4276.9 2812.5,-4276.9 2812.5,-4320.9"/>
<text text-anchor="middle" x="2740" y="-4308.1" font-family="Arial" font-size="11.00">Output_Proj_13_GPU0</text>
<text text-anchor="middle" x="2740" y="-4296.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2740" y="-4284.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_13_gpu0&#45;&gt;out_proj_13_gpu0 -->
<g id="edge294" class="edge">
<title>attn_13_gpu0&#45;&gt;out_proj_13_gpu0</title>
<path fill="none" stroke="black" d="M2726.19,-4356.59C2728.13,-4348.61 2730.38,-4339.39 2732.49,-4330.72"/>
<polygon fill="black" stroke="black" points="2735.91,-4331.46 2734.88,-4320.92 2729.11,-4329.81 2735.91,-4331.46"/>
</g>
<!-- out_proj_13_gpu1 -->
<g id="node439" class="node">
<title>out_proj_13_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2985.5,-4320.9 2840.5,-4320.9 2840.5,-4276.9 2985.5,-4276.9 2985.5,-4320.9"/>
<text text-anchor="middle" x="2913" y="-4308.1" font-family="Arial" font-size="11.00">Output_Proj_13_GPU1</text>
<text text-anchor="middle" x="2913" y="-4296.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2913" y="-4284.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_13_gpu1&#45;&gt;out_proj_13_gpu1 -->
<g id="edge295" class="edge">
<title>attn_13_gpu1&#45;&gt;out_proj_13_gpu1</title>
<path fill="none" stroke="black" d="M2920.27,-4356.59C2919.26,-4348.7 2918.09,-4339.59 2916.99,-4331"/>
<polygon fill="black" stroke="black" points="2920.44,-4330.39 2915.69,-4320.92 2913.49,-4331.28 2920.44,-4330.39"/>
</g>
<!-- mha_merge_13 -->
<g id="node440" class="node">
<title>mha_merge_13</title>
<polygon fill="yellow" stroke="black" points="3044.16,-4240.9 2805.29,-4240.9 2743.84,-4152.9 2982.71,-4152.9 3044.16,-4240.9"/>
<text text-anchor="middle" x="2894" y="-4206.1" font-family="Arial" font-size="11.00">MHA_Merge_13</text>
<text text-anchor="middle" x="2894" y="-4194.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2894" y="-4182.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_13_gpu0&#45;&gt;mha_merge_13 -->
<g id="edge296" class="edge">
<title>out_proj_13_gpu0&#45;&gt;mha_merge_13</title>
<path fill="none" stroke="black" d="M2772.66,-4276.69C2786.27,-4267.86 2802.68,-4257.2 2818.97,-4246.62"/>
<polygon fill="black" stroke="black" points="2820.99,-4249.49 2827.47,-4241.1 2817.17,-4243.61 2820.99,-4249.49"/>
</g>
<!-- out_proj_13_gpu1&#45;&gt;mha_merge_13 -->
<g id="edge297" class="edge">
<title>out_proj_13_gpu1&#45;&gt;mha_merge_13</title>
<path fill="none" stroke="black" d="M2908.97,-4276.69C2907.53,-4269.12 2905.84,-4260.2 2904.12,-4251.14"/>
<polygon fill="black" stroke="black" points="2907.55,-4250.48 2902.25,-4241.31 2900.68,-4251.79 2907.55,-4250.48"/>
</g>
<!-- mha_merge_13&#45;&gt;add_1_13 -->
<g id="edge298" class="edge">
<title>mha_merge_13&#45;&gt;add_1_13</title>
<path fill="none" stroke="black" d="M2918.67,-4152.62C2923.84,-4143.55 2929.18,-4134.18 2934,-4125.73"/>
<polygon fill="black" stroke="black" points="2937.07,-4127.4 2938.98,-4116.98 2930.99,-4123.94 2937.07,-4127.4"/>
</g>
<!-- post_ln_13 -->
<g id="node442" class="node">
<title>post_ln_13</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-4036.9 2822.5,-4036.9 2822.5,-3992.9 2967.5,-3992.9 2967.5,-4036.9"/>
<text text-anchor="middle" x="2895" y="-4024.1" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_13</text>
<text text-anchor="middle" x="2895" y="-4012.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-4000.1" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_13&#45;&gt;post_ln_13 -->
<g id="edge300" class="edge">
<title>add_1_13&#45;&gt;post_ln_13</title>
<path fill="none" stroke="black" d="M2935.7,-4072.59C2929.66,-4064.18 2922.62,-4054.38 2916.12,-4045.31"/>
<polygon fill="black" stroke="black" points="2918.77,-4043 2910.09,-4036.92 2913.08,-4047.08 2918.77,-4043"/>
</g>
<!-- add_2_13 -->
<g id="node464" class="node">
<title>add_2_13</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-3242.68 2828.5,-3242.68 2828.5,-3198.68 3067.5,-3198.68 3067.5,-3242.68"/>
<text text-anchor="middle" x="2948" y="-3229.88" font-family="Arial" font-size="11.00">Residual_Add2_13</text>
<text text-anchor="middle" x="2948" y="-3217.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-3205.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_13&#45;&gt;add_2_13 -->
<g id="edge309" class="edge">
<title>add_1_13&#45;&gt;add_2_13</title>
<path fill="none" stroke="black" d="M2984.86,-4072.9C3027.99,-4043.24 3097,-3984.72 3097,-3913.9 3097,-3913.9 3097,-3913.9 3097,-3445.68 3097,-3367.87 3138.2,-3333.29 3092,-3270.68 3085.15,-3261.39 3076.44,-3253.85 3066.71,-3247.72"/>
<polygon fill="black" stroke="black" points="3068.33,-3244.62 3057.91,-3242.7 3064.86,-3250.7 3068.33,-3244.62"/>
</g>
<!-- gate_13 -->
<g id="node443" class="node">
<title>gate_13</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-3956.9 2742.05,-3956.9 2655.5,-3868.9 2991.95,-3868.9 3078.5,-3956.9"/>
<text text-anchor="middle" x="2867" y="-3922.1" font-family="Arial" font-size="11.00">Expert_Gate_13</text>
<text text-anchor="middle" x="2867" y="-3910.1" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-3898.1" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_13&#45;&gt;gate_13 -->
<g id="edge301" class="edge">
<title>post_ln_13&#45;&gt;gate_13</title>
<path fill="none" stroke="black" d="M2889.06,-3992.69C2886.94,-3985.12 2884.44,-3976.2 2881.91,-3967.14"/>
<polygon fill="black" stroke="black" points="2885.22,-3965.99 2879.15,-3957.31 2878.48,-3967.88 2885.22,-3965.99"/>
</g>
<!-- token_dist_13 -->
<g id="node444" class="node">
<title>token_dist_13</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-3801.79" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-3810.99" font-family="Arial" font-size="11.00">Token_Distribution_13</text>
<text text-anchor="middle" x="2881" y="-3798.99" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-3786.99" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_13&#45;&gt;token_dist_13 -->
<g id="edge302" class="edge">
<title>gate_13&#45;&gt;token_dist_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-3868.78C2873.61,-3860.4 2874.73,-3851.65 2875.79,-3843.36"/>
<polygon fill="red" stroke="red" points="2879.3,-3843.53 2877.1,-3833.16 2872.36,-3842.64 2879.3,-3843.53"/>
</g>
<!-- expert_13_0_gpu0 -->
<g id="node445" class="node">
<title>expert_13_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-3672.68 2820,-3672.68 2820,-3628.68 2942,-3628.68 2942,-3672.68"/>
<text text-anchor="middle" x="2881" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_13&#45;&gt;expert_13_0_gpu0 -->
<g id="edge303" class="edge">
<title>token_dist_13&#45;&gt;expert_13_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-3770.61C2881,-3745.03 2881,-3708.5 2881,-3682.68"/>
<polygon fill="black" stroke="black" points="2884.5,-3682.68 2881,-3672.68 2877.5,-3682.68 2884.5,-3682.68"/>
</g>
<!-- expert_13_0_gpu1 -->
<g id="node446" class="node">
<title>expert_13_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-3570.68 2885,-3570.68 2885,-3526.68 3007,-3526.68 3007,-3570.68"/>
<text text-anchor="middle" x="2946" y="-3557.88" font-family="Arial" font-size="11.00">Expert_13_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-3545.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-3533.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_13&#45;&gt;expert_13_0_gpu1 -->
<g id="edge304" class="edge">
<title>token_dist_13&#45;&gt;expert_13_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-3773.35C2945.77,-3770.15 2948.67,-3766.6 2951,-3762.68 2984.76,-3705.86 2968.96,-3624.59 2956.33,-3580.68"/>
<polygon fill="black" stroke="black" points="2959.62,-3579.44 2953.38,-3570.88 2952.91,-3581.46 2959.62,-3579.44"/>
</g>
<!-- expert_13_0_gpu0&#45;&gt;expert_13_0_gpu1 -->
<g id="edge305" class="edge">
<title>expert_13_0_gpu0&#45;&gt;expert_13_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-3628.47C2904.09,-3614.15 2916.51,-3595.05 2926.78,-3579.25"/>
<polygon fill="black" stroke="black" points="2929.72,-3581.14 2932.24,-3570.85 2923.85,-3577.33 2929.72,-3581.14"/>
</g>
<!-- expert_merge_13_0 -->
<g id="node447" class="node">
<title>expert_merge_13_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-3490.68 2871.29,-3490.68 2819.53,-3402.68 3020.71,-3402.68 3072.47,-3490.68"/>
<text text-anchor="middle" x="2946" y="-3455.88" font-family="Arial" font-size="11.00">Expert_Merge_13_0</text>
<text text-anchor="middle" x="2946" y="-3443.88" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-3431.88" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_13_0_gpu1&#45;&gt;expert_merge_13_0 -->
<g id="edge306" class="edge">
<title>expert_13_0_gpu1&#45;&gt;expert_merge_13_0</title>
<path fill="none" stroke="black" d="M2946,-3526.47C2946,-3518.97 2946,-3510.16 2946,-3501.2"/>
<polygon fill="black" stroke="black" points="2949.5,-3501.08 2946,-3491.08 2942.5,-3501.08 2949.5,-3501.08"/>
</g>
<!-- expert_agg_13 -->
<g id="node463" class="node">
<title>expert_agg_13</title>
<polygon fill="yellow" stroke="black" points="3077.82,-3366.68 2823.58,-3366.68 2758.18,-3278.68 3012.42,-3278.68 3077.82,-3366.68"/>
<text text-anchor="middle" x="2918" y="-3331.88" font-family="Arial" font-size="11.00">Expert_Aggregation_13</text>
<text text-anchor="middle" x="2918" y="-3319.88" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-3307.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_13_0&#45;&gt;expert_agg_13 -->
<g id="edge307" class="edge">
<title>expert_merge_13_0&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M2936.13,-3402.66C2934.2,-3394.28 2932.17,-3385.4 2930.18,-3376.74"/>
<polygon fill="black" stroke="black" points="2933.53,-3375.68 2927.88,-3366.71 2926.7,-3377.24 2933.53,-3375.68"/>
</g>
<!-- expert_13_1_gpu0 -->
<g id="node448" class="node">
<title>expert_13_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-3672.68 2674,-3672.68 2674,-3628.68 2796,-3628.68 2796,-3672.68"/>
<text text-anchor="middle" x="2735" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_1_gpu1 -->
<g id="node449" class="node">
<title>expert_13_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-3672.68 2534,-3672.68 2534,-3628.68 2656,-3628.68 2656,-3672.68"/>
<text text-anchor="middle" x="2595" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_1 -->
<g id="node450" class="node">
<title>expert_merge_13_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-3694.68 2315.29,-3694.68 2263.53,-3606.68 2464.71,-3606.68 2516.47,-3694.68"/>
<text text-anchor="middle" x="2390" y="-3659.88" font-family="Arial" font-size="11.00">Expert_Merge_13_1</text>
<text text-anchor="middle" x="2390" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_13_2_gpu0 -->
<g id="node451" class="node">
<title>expert_13_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-3672.68 2118,-3672.68 2118,-3628.68 2240,-3628.68 2240,-3672.68"/>
<text text-anchor="middle" x="2179" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_2_gpu1 -->
<g id="node452" class="node">
<title>expert_13_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-3672.68 1978,-3672.68 1978,-3628.68 2100,-3628.68 2100,-3672.68"/>
<text text-anchor="middle" x="2039" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_2 -->
<g id="node453" class="node">
<title>expert_merge_13_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-3694.68 1759.29,-3694.68 1707.53,-3606.68 1908.71,-3606.68 1960.47,-3694.68"/>
<text text-anchor="middle" x="1834" y="-3659.88" font-family="Arial" font-size="11.00">Expert_Merge_13_2</text>
<text text-anchor="middle" x="1834" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_13_61_gpu0 -->
<g id="node454" class="node">
<title>expert_13_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-3672.68 1562,-3672.68 1562,-3628.68 1684,-3628.68 1684,-3672.68"/>
<text text-anchor="middle" x="1623" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_61_gpu1 -->
<g id="node455" class="node">
<title>expert_13_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-3672.68 1422,-3672.68 1422,-3628.68 1544,-3628.68 1544,-3672.68"/>
<text text-anchor="middle" x="1483" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_61 -->
<g id="node456" class="node">
<title>expert_merge_13_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-3694.68 1203.29,-3694.68 1151.53,-3606.68 1352.71,-3606.68 1404.47,-3694.68"/>
<text text-anchor="middle" x="1278" y="-3659.88" font-family="Arial" font-size="11.00">Expert_Merge_13_61</text>
<text text-anchor="middle" x="1278" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_13_62_gpu0 -->
<g id="node457" class="node">
<title>expert_13_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-3672.68 1006,-3672.68 1006,-3628.68 1128,-3628.68 1128,-3672.68"/>
<text text-anchor="middle" x="1067" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_62_gpu1 -->
<g id="node458" class="node">
<title>expert_13_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-3672.68 866,-3672.68 866,-3628.68 988,-3628.68 988,-3672.68"/>
<text text-anchor="middle" x="927" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_62_GPU1</text>
<text text-anchor="middle" x="927" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_62 -->
<g id="node459" class="node">
<title>expert_merge_13_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-3694.68 647.29,-3694.68 595.53,-3606.68 796.71,-3606.68 848.47,-3694.68"/>
<text text-anchor="middle" x="722" y="-3659.88" font-family="Arial" font-size="11.00">Expert_Merge_13_62</text>
<text text-anchor="middle" x="722" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_13_63_gpu0 -->
<g id="node460" class="node">
<title>expert_13_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-3672.68 450,-3672.68 450,-3628.68 572,-3628.68 572,-3672.68"/>
<text text-anchor="middle" x="511" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_63_GPU0</text>
<text text-anchor="middle" x="511" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_63_gpu1 -->
<g id="node461" class="node">
<title>expert_13_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-3672.68 310,-3672.68 310,-3628.68 432,-3628.68 432,-3672.68"/>
<text text-anchor="middle" x="371" y="-3659.88" font-family="Arial" font-size="11.00">Expert_13_63_GPU1</text>
<text text-anchor="middle" x="371" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_63 -->
<g id="node462" class="node">
<title>expert_merge_13_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-3694.68 91.29,-3694.68 39.53,-3606.68 240.71,-3606.68 292.47,-3694.68"/>
<text text-anchor="middle" x="166" y="-3659.88" font-family="Arial" font-size="11.00">Expert_Merge_13_63</text>
<text text-anchor="middle" x="166" y="-3647.88" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-3635.88" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_13&#45;&gt;add_2_13 -->
<g id="edge308" class="edge">
<title>expert_agg_13&#45;&gt;add_2_13</title>
<path fill="none" stroke="black" d="M2930.98,-3278.4C2933.59,-3269.71 2936.28,-3260.75 2938.73,-3252.59"/>
<polygon fill="black" stroke="black" points="2942.15,-3253.34 2941.68,-3242.76 2935.45,-3251.33 2942.15,-3253.34"/>
</g>
<!-- pre_ln_14 -->
<g id="node465" class="node">
<title>pre_ln_14</title>
<polygon fill="lightgreen" stroke="black" points="3005.5,-3148.68 2860.5,-3148.68 2860.5,-3104.68 3005.5,-3104.68 3005.5,-3148.68"/>
<text text-anchor="middle" x="2933" y="-3135.88" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_14</text>
<text text-anchor="middle" x="2933" y="-3123.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-3111.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_13&#45;&gt;pre_ln_14 -->
<g id="edge310" class="edge">
<title>add_2_13&#45;&gt;pre_ln_14</title>
<path fill="none" stroke="black" d="M2944.52,-3198.34C2942.61,-3186.61 2940.2,-3171.85 2938.08,-3158.85"/>
<polygon fill="black" stroke="black" points="2941.52,-3158.2 2936.46,-3148.9 2934.62,-3159.33 2941.52,-3158.2"/>
</g>
<!-- add_1_14 -->
<g id="node474" class="node">
<title>add_1_14</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-2574.68 2831.5,-2574.68 2831.5,-2530.68 3070.5,-2530.68 3070.5,-2574.68"/>
<text text-anchor="middle" x="2951" y="-2561.88" font-family="Arial" font-size="11.00">Residual_Add1_14</text>
<text text-anchor="middle" x="2951" y="-2549.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-2537.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_13&#45;&gt;add_1_14 -->
<g id="edge321" class="edge">
<title>add_2_13&#45;&gt;add_1_14</title>
<path fill="none" stroke="black" d="M2995.38,-3198.47C3002.51,-3193.94 3009.35,-3188.67 3015,-3182.68 3066.87,-3127.61 3064,-3095.32 3064,-3019.68 3064,-3019.68 3064,-3019.68 3064,-2755.68 3064,-2687.58 3094.07,-2659.14 3056,-2602.68 3049.84,-2593.55 3041.52,-2586.08 3032.24,-2579.98"/>
<polygon fill="black" stroke="black" points="3033.86,-2576.87 3023.47,-2574.76 3030.27,-2582.89 3033.86,-2576.87"/>
</g>
<!-- mha_input_14 -->
<g id="node466" class="node">
<title>mha_input_14</title>
<polygon fill="yellow" stroke="black" points="3044.16,-3062.68 2805.29,-3062.68 2743.84,-2974.68 2982.71,-2974.68 3044.16,-3062.68"/>
<text text-anchor="middle" x="2894" y="-3027.88" font-family="Arial" font-size="11.00">MHA_Input_14</text>
<text text-anchor="middle" x="2894" y="-3015.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2894" y="-3003.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_14&#45;&gt;mha_input_14 -->
<g id="edge311" class="edge">
<title>pre_ln_14&#45;&gt;mha_input_14</title>
<path fill="none" stroke="black" d="M2925.2,-3104.48C2921.76,-3095.13 2917.55,-3083.7 2913.35,-3072.28"/>
<polygon fill="black" stroke="black" points="2916.58,-3070.92 2909.85,-3062.74 2910.01,-3073.34 2916.58,-3070.92"/>
</g>
<!-- qkv_proj_14_gpu0 -->
<g id="node467" class="node">
<title>qkv_proj_14_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2803.5,-2938.68 2580.5,-2938.68 2580.5,-2894.68 2803.5,-2894.68 2803.5,-2938.68"/>
<text text-anchor="middle" x="2692" y="-2925.88" font-family="Arial" font-size="11.00">QKV_Proj_14_GPU0</text>
<text text-anchor="middle" x="2692" y="-2913.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2692" y="-2901.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_14&#45;&gt;qkv_proj_14_gpu0 -->
<g id="edge312" class="edge">
<title>mha_input_14&#45;&gt;qkv_proj_14_gpu0</title>
<path fill="none" stroke="black" d="M2806.87,-2974.54C2785.3,-2963.87 2762.88,-2952.77 2743.63,-2943.24"/>
<polygon fill="black" stroke="black" points="2744.97,-2939.99 2734.45,-2938.69 2741.86,-2946.26 2744.97,-2939.99"/>
</g>
<!-- qkv_proj_14_gpu1 -->
<g id="node468" class="node">
<title>qkv_proj_14_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3044.5,-2938.68 2821.5,-2938.68 2821.5,-2894.68 3044.5,-2894.68 3044.5,-2938.68"/>
<text text-anchor="middle" x="2933" y="-2925.88" font-family="Arial" font-size="11.00">QKV_Proj_14_GPU1</text>
<text text-anchor="middle" x="2933" y="-2913.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2933" y="-2901.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_14&#45;&gt;qkv_proj_14_gpu1 -->
<g id="edge313" class="edge">
<title>mha_input_14&#45;&gt;qkv_proj_14_gpu1</title>
<path fill="none" stroke="black" d="M2910.88,-2974.4C2914.3,-2965.61 2917.84,-2956.55 2921.05,-2948.32"/>
<polygon fill="black" stroke="black" points="2924.41,-2949.35 2924.78,-2938.76 2917.88,-2946.8 2924.41,-2949.35"/>
</g>
<!-- attn_14_gpu0 -->
<g id="node469" class="node">
<title>attn_14_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2787.5,-2858.68 2654.5,-2858.68 2654.5,-2814.68 2787.5,-2814.68 2787.5,-2858.68"/>
<text text-anchor="middle" x="2721" y="-2845.88" font-family="Arial" font-size="11.00">Attention_14_GPU0</text>
<text text-anchor="middle" x="2721" y="-2833.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2721" y="-2821.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_14_gpu0&#45;&gt;attn_14_gpu0 -->
<g id="edge314" class="edge">
<title>qkv_proj_14_gpu0&#45;&gt;attn_14_gpu0</title>
<path fill="none" stroke="black" d="M2699.92,-2894.36C2702.92,-2886.3 2706.39,-2876.96 2709.65,-2868.21"/>
<polygon fill="black" stroke="black" points="2712.98,-2869.29 2713.19,-2858.69 2706.42,-2866.85 2712.98,-2869.29"/>
</g>
<!-- attn_14_gpu1 -->
<g id="node470" class="node">
<title>attn_14_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-2858.68 2856.5,-2858.68 2856.5,-2814.68 2989.5,-2814.68 2989.5,-2858.68"/>
<text text-anchor="middle" x="2923" y="-2845.88" font-family="Arial" font-size="11.00">Attention_14_GPU1</text>
<text text-anchor="middle" x="2923" y="-2833.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2923" y="-2821.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_14_gpu1&#45;&gt;attn_14_gpu1 -->
<g id="edge315" class="edge">
<title>qkv_proj_14_gpu1&#45;&gt;attn_14_gpu1</title>
<path fill="none" stroke="black" d="M2930.27,-2894.36C2929.26,-2886.47 2928.09,-2877.36 2926.99,-2868.78"/>
<polygon fill="black" stroke="black" points="2930.44,-2868.17 2925.69,-2858.69 2923.49,-2869.06 2930.44,-2868.17"/>
</g>
<!-- out_proj_14_gpu0 -->
<g id="node471" class="node">
<title>out_proj_14_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2812.5,-2778.68 2667.5,-2778.68 2667.5,-2734.68 2812.5,-2734.68 2812.5,-2778.68"/>
<text text-anchor="middle" x="2740" y="-2765.88" font-family="Arial" font-size="11.00">Output_Proj_14_GPU0</text>
<text text-anchor="middle" x="2740" y="-2753.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2740" y="-2741.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_14_gpu0&#45;&gt;out_proj_14_gpu0 -->
<g id="edge316" class="edge">
<title>attn_14_gpu0&#45;&gt;out_proj_14_gpu0</title>
<path fill="none" stroke="black" d="M2726.19,-2814.36C2728.13,-2806.39 2730.38,-2797.16 2732.49,-2788.5"/>
<polygon fill="black" stroke="black" points="2735.91,-2789.24 2734.88,-2778.69 2729.11,-2787.58 2735.91,-2789.24"/>
</g>
<!-- out_proj_14_gpu1 -->
<g id="node472" class="node">
<title>out_proj_14_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2985.5,-2778.68 2840.5,-2778.68 2840.5,-2734.68 2985.5,-2734.68 2985.5,-2778.68"/>
<text text-anchor="middle" x="2913" y="-2765.88" font-family="Arial" font-size="11.00">Output_Proj_14_GPU1</text>
<text text-anchor="middle" x="2913" y="-2753.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2913" y="-2741.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_14_gpu1&#45;&gt;out_proj_14_gpu1 -->
<g id="edge317" class="edge">
<title>attn_14_gpu1&#45;&gt;out_proj_14_gpu1</title>
<path fill="none" stroke="black" d="M2920.27,-2814.36C2919.26,-2806.47 2918.09,-2797.36 2916.99,-2788.78"/>
<polygon fill="black" stroke="black" points="2920.44,-2788.17 2915.69,-2778.69 2913.49,-2789.06 2920.44,-2788.17"/>
</g>
<!-- mha_merge_14 -->
<g id="node473" class="node">
<title>mha_merge_14</title>
<polygon fill="yellow" stroke="black" points="3044.16,-2698.68 2805.29,-2698.68 2743.84,-2610.68 2982.71,-2610.68 3044.16,-2698.68"/>
<text text-anchor="middle" x="2894" y="-2663.88" font-family="Arial" font-size="11.00">MHA_Merge_14</text>
<text text-anchor="middle" x="2894" y="-2651.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2894" y="-2639.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_14_gpu0&#45;&gt;mha_merge_14 -->
<g id="edge318" class="edge">
<title>out_proj_14_gpu0&#45;&gt;mha_merge_14</title>
<path fill="none" stroke="black" d="M2772.66,-2734.47C2786.27,-2725.63 2802.68,-2714.98 2818.97,-2704.39"/>
<polygon fill="black" stroke="black" points="2820.99,-2707.26 2827.47,-2698.88 2817.17,-2701.39 2820.99,-2707.26"/>
</g>
<!-- out_proj_14_gpu1&#45;&gt;mha_merge_14 -->
<g id="edge319" class="edge">
<title>out_proj_14_gpu1&#45;&gt;mha_merge_14</title>
<path fill="none" stroke="black" d="M2908.97,-2734.47C2907.53,-2726.89 2905.84,-2717.97 2904.12,-2708.91"/>
<polygon fill="black" stroke="black" points="2907.55,-2708.25 2902.25,-2699.08 2900.68,-2709.56 2907.55,-2708.25"/>
</g>
<!-- mha_merge_14&#45;&gt;add_1_14 -->
<g id="edge320" class="edge">
<title>mha_merge_14&#45;&gt;add_1_14</title>
<path fill="none" stroke="black" d="M2918.67,-2610.4C2923.84,-2601.33 2929.18,-2591.95 2934,-2583.51"/>
<polygon fill="black" stroke="black" points="2937.07,-2585.18 2938.98,-2574.76 2930.99,-2581.71 2937.07,-2585.18"/>
</g>
<!-- post_ln_14 -->
<g id="node475" class="node">
<title>post_ln_14</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-2494.68 2822.5,-2494.68 2822.5,-2450.68 2967.5,-2450.68 2967.5,-2494.68"/>
<text text-anchor="middle" x="2895" y="-2481.88" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_14</text>
<text text-anchor="middle" x="2895" y="-2469.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-2457.88" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_14&#45;&gt;post_ln_14 -->
<g id="edge322" class="edge">
<title>add_1_14&#45;&gt;post_ln_14</title>
<path fill="none" stroke="black" d="M2935.7,-2530.36C2929.66,-2521.95 2922.62,-2512.15 2916.12,-2503.09"/>
<polygon fill="black" stroke="black" points="2918.77,-2500.78 2910.09,-2494.69 2913.08,-2504.86 2918.77,-2500.78"/>
</g>
<!-- add_2_14 -->
<g id="node497" class="node">
<title>add_2_14</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-1700.45 2828.5,-1700.45 2828.5,-1656.45 3067.5,-1656.45 3067.5,-1700.45"/>
<text text-anchor="middle" x="2948" y="-1687.65" font-family="Arial" font-size="11.00">Residual_Add2_14</text>
<text text-anchor="middle" x="2948" y="-1675.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-1663.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_14&#45;&gt;add_2_14 -->
<g id="edge331" class="edge">
<title>add_1_14&#45;&gt;add_2_14</title>
<path fill="none" stroke="black" d="M2984.86,-2530.68C3027.99,-2501.02 3097,-2442.49 3097,-2371.68 3097,-2371.68 3097,-2371.68 3097,-1903.45 3097,-1825.64 3138.2,-1791.06 3092,-1728.45 3085.15,-1719.16 3076.44,-1711.62 3066.71,-1705.5"/>
<polygon fill="black" stroke="black" points="3068.33,-1702.39 3057.91,-1700.47 3064.86,-1708.47 3068.33,-1702.39"/>
</g>
<!-- gate_14 -->
<g id="node476" class="node">
<title>gate_14</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-2414.68 2742.05,-2414.68 2655.5,-2326.68 2991.95,-2326.68 3078.5,-2414.68"/>
<text text-anchor="middle" x="2867" y="-2379.88" font-family="Arial" font-size="11.00">Expert_Gate_14</text>
<text text-anchor="middle" x="2867" y="-2367.88" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-2355.88" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_14&#45;&gt;gate_14 -->
<g id="edge323" class="edge">
<title>post_ln_14&#45;&gt;gate_14</title>
<path fill="none" stroke="black" d="M2889.06,-2450.47C2886.94,-2442.89 2884.44,-2433.97 2881.91,-2424.91"/>
<polygon fill="black" stroke="black" points="2885.22,-2423.77 2879.15,-2415.08 2878.48,-2425.66 2885.22,-2423.77"/>
</g>
<!-- token_dist_14 -->
<g id="node477" class="node">
<title>token_dist_14</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-2259.56" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-2268.76" font-family="Arial" font-size="11.00">Token_Distribution_14</text>
<text text-anchor="middle" x="2881" y="-2256.76" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-2244.76" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_14&#45;&gt;token_dist_14 -->
<g id="edge324" class="edge">
<title>gate_14&#45;&gt;token_dist_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-2326.55C2873.61,-2318.18 2874.73,-2309.42 2875.79,-2301.13"/>
<polygon fill="red" stroke="red" points="2879.3,-2301.3 2877.1,-2290.94 2872.36,-2300.41 2879.3,-2301.3"/>
</g>
<!-- expert_14_0_gpu0 -->
<g id="node478" class="node">
<title>expert_14_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-2130.45 2820,-2130.45 2820,-2086.45 2942,-2086.45 2942,-2130.45"/>
<text text-anchor="middle" x="2881" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_14&#45;&gt;expert_14_0_gpu0 -->
<g id="edge325" class="edge">
<title>token_dist_14&#45;&gt;expert_14_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-2228.39C2881,-2202.81 2881,-2166.27 2881,-2140.46"/>
<polygon fill="black" stroke="black" points="2884.5,-2140.45 2881,-2130.45 2877.5,-2140.45 2884.5,-2140.45"/>
</g>
<!-- expert_14_0_gpu1 -->
<g id="node479" class="node">
<title>expert_14_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-2028.45 2885,-2028.45 2885,-1984.45 3007,-1984.45 3007,-2028.45"/>
<text text-anchor="middle" x="2946" y="-2015.65" font-family="Arial" font-size="11.00">Expert_14_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-2003.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-1991.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_14&#45;&gt;expert_14_0_gpu1 -->
<g id="edge326" class="edge">
<title>token_dist_14&#45;&gt;expert_14_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-2231.12C2945.77,-2227.92 2948.67,-2224.38 2951,-2220.45 2984.76,-2163.63 2968.96,-2082.37 2956.33,-2038.46"/>
<polygon fill="black" stroke="black" points="2959.62,-2037.22 2953.38,-2028.65 2952.91,-2039.23 2959.62,-2037.22"/>
</g>
<!-- expert_14_0_gpu0&#45;&gt;expert_14_0_gpu1 -->
<g id="edge327" class="edge">
<title>expert_14_0_gpu0&#45;&gt;expert_14_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-2086.24C2904.09,-2071.92 2916.51,-2052.83 2926.78,-2037.02"/>
<polygon fill="black" stroke="black" points="2929.72,-2038.92 2932.24,-2028.63 2923.85,-2035.1 2929.72,-2038.92"/>
</g>
<!-- expert_merge_14_0 -->
<g id="node480" class="node">
<title>expert_merge_14_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-1948.45 2871.29,-1948.45 2819.53,-1860.45 3020.71,-1860.45 3072.47,-1948.45"/>
<text text-anchor="middle" x="2946" y="-1913.65" font-family="Arial" font-size="11.00">Expert_Merge_14_0</text>
<text text-anchor="middle" x="2946" y="-1901.65" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-1889.65" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_14_0_gpu1&#45;&gt;expert_merge_14_0 -->
<g id="edge328" class="edge">
<title>expert_14_0_gpu1&#45;&gt;expert_merge_14_0</title>
<path fill="none" stroke="black" d="M2946,-1984.24C2946,-1976.75 2946,-1967.94 2946,-1958.98"/>
<polygon fill="black" stroke="black" points="2949.5,-1958.86 2946,-1948.86 2942.5,-1958.86 2949.5,-1958.86"/>
</g>
<!-- expert_agg_14 -->
<g id="node496" class="node">
<title>expert_agg_14</title>
<polygon fill="yellow" stroke="black" points="3077.82,-1824.45 2823.58,-1824.45 2758.18,-1736.45 3012.42,-1736.45 3077.82,-1824.45"/>
<text text-anchor="middle" x="2918" y="-1789.65" font-family="Arial" font-size="11.00">Expert_Aggregation_14</text>
<text text-anchor="middle" x="2918" y="-1777.65" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-1765.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_14_0&#45;&gt;expert_agg_14 -->
<g id="edge329" class="edge">
<title>expert_merge_14_0&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2936.13,-1860.44C2934.2,-1852.06 2932.17,-1843.18 2930.18,-1834.51"/>
<polygon fill="black" stroke="black" points="2933.53,-1833.45 2927.88,-1824.49 2926.7,-1835.02 2933.53,-1833.45"/>
</g>
<!-- expert_14_1_gpu0 -->
<g id="node481" class="node">
<title>expert_14_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-2130.45 2674,-2130.45 2674,-2086.45 2796,-2086.45 2796,-2130.45"/>
<text text-anchor="middle" x="2735" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_1_gpu1 -->
<g id="node482" class="node">
<title>expert_14_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-2130.45 2534,-2130.45 2534,-2086.45 2656,-2086.45 2656,-2130.45"/>
<text text-anchor="middle" x="2595" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_1 -->
<g id="node483" class="node">
<title>expert_merge_14_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-2152.45 2315.29,-2152.45 2263.53,-2064.45 2464.71,-2064.45 2516.47,-2152.45"/>
<text text-anchor="middle" x="2390" y="-2117.65" font-family="Arial" font-size="11.00">Expert_Merge_14_1</text>
<text text-anchor="middle" x="2390" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_14_2_gpu0 -->
<g id="node484" class="node">
<title>expert_14_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-2130.45 2118,-2130.45 2118,-2086.45 2240,-2086.45 2240,-2130.45"/>
<text text-anchor="middle" x="2179" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_2_gpu1 -->
<g id="node485" class="node">
<title>expert_14_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-2130.45 1978,-2130.45 1978,-2086.45 2100,-2086.45 2100,-2130.45"/>
<text text-anchor="middle" x="2039" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_2 -->
<g id="node486" class="node">
<title>expert_merge_14_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-2152.45 1759.29,-2152.45 1707.53,-2064.45 1908.71,-2064.45 1960.47,-2152.45"/>
<text text-anchor="middle" x="1834" y="-2117.65" font-family="Arial" font-size="11.00">Expert_Merge_14_2</text>
<text text-anchor="middle" x="1834" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_14_61_gpu0 -->
<g id="node487" class="node">
<title>expert_14_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-2130.45 1562,-2130.45 1562,-2086.45 1684,-2086.45 1684,-2130.45"/>
<text text-anchor="middle" x="1623" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_61_gpu1 -->
<g id="node488" class="node">
<title>expert_14_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-2130.45 1422,-2130.45 1422,-2086.45 1544,-2086.45 1544,-2130.45"/>
<text text-anchor="middle" x="1483" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_61 -->
<g id="node489" class="node">
<title>expert_merge_14_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-2152.45 1203.29,-2152.45 1151.53,-2064.45 1352.71,-2064.45 1404.47,-2152.45"/>
<text text-anchor="middle" x="1278" y="-2117.65" font-family="Arial" font-size="11.00">Expert_Merge_14_61</text>
<text text-anchor="middle" x="1278" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_14_62_gpu0 -->
<g id="node490" class="node">
<title>expert_14_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-2130.45 1006,-2130.45 1006,-2086.45 1128,-2086.45 1128,-2130.45"/>
<text text-anchor="middle" x="1067" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_62_gpu1 -->
<g id="node491" class="node">
<title>expert_14_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-2130.45 866,-2130.45 866,-2086.45 988,-2086.45 988,-2130.45"/>
<text text-anchor="middle" x="927" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_62_GPU1</text>
<text text-anchor="middle" x="927" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_62 -->
<g id="node492" class="node">
<title>expert_merge_14_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-2152.45 647.29,-2152.45 595.53,-2064.45 796.71,-2064.45 848.47,-2152.45"/>
<text text-anchor="middle" x="722" y="-2117.65" font-family="Arial" font-size="11.00">Expert_Merge_14_62</text>
<text text-anchor="middle" x="722" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_14_63_gpu0 -->
<g id="node493" class="node">
<title>expert_14_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-2130.45 450,-2130.45 450,-2086.45 572,-2086.45 572,-2130.45"/>
<text text-anchor="middle" x="511" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_63_GPU0</text>
<text text-anchor="middle" x="511" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_63_gpu1 -->
<g id="node494" class="node">
<title>expert_14_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-2130.45 310,-2130.45 310,-2086.45 432,-2086.45 432,-2130.45"/>
<text text-anchor="middle" x="371" y="-2117.65" font-family="Arial" font-size="11.00">Expert_14_63_GPU1</text>
<text text-anchor="middle" x="371" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_63 -->
<g id="node495" class="node">
<title>expert_merge_14_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-2152.45 91.29,-2152.45 39.53,-2064.45 240.71,-2064.45 292.47,-2152.45"/>
<text text-anchor="middle" x="166" y="-2117.65" font-family="Arial" font-size="11.00">Expert_Merge_14_63</text>
<text text-anchor="middle" x="166" y="-2105.65" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-2093.65" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_14&#45;&gt;add_2_14 -->
<g id="edge330" class="edge">
<title>expert_agg_14&#45;&gt;add_2_14</title>
<path fill="none" stroke="black" d="M2930.98,-1736.17C2933.59,-1727.49 2936.28,-1718.53 2938.73,-1710.36"/>
<polygon fill="black" stroke="black" points="2942.15,-1711.12 2941.68,-1700.53 2935.45,-1709.11 2942.15,-1711.12"/>
</g>
<!-- pre_ln_15 -->
<g id="node498" class="node">
<title>pre_ln_15</title>
<polygon fill="lightgreen" stroke="black" points="2927.5,-1606.45 2782.5,-1606.45 2782.5,-1562.45 2927.5,-1562.45 2927.5,-1606.45"/>
<text text-anchor="middle" x="2855" y="-1593.65" font-family="Arial" font-size="11.00">Pre&#45;LayerNorm_15</text>
<text text-anchor="middle" x="2855" y="-1581.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-1569.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_14&#45;&gt;pre_ln_15 -->
<g id="edge332" class="edge">
<title>add_2_14&#45;&gt;pre_ln_15</title>
<path fill="none" stroke="black" d="M2926.43,-1656.11C2913.75,-1643.57 2897.57,-1627.56 2883.81,-1613.95"/>
<polygon fill="black" stroke="black" points="2886.02,-1611.22 2876.45,-1606.67 2881.1,-1616.19 2886.02,-1611.22"/>
</g>
<!-- add_1_15 -->
<g id="node507" class="node">
<title>add_1_15</title>
<polygon fill="lightgreen" stroke="black" points="3070.5,-1032.45 2831.5,-1032.45 2831.5,-988.45 3070.5,-988.45 3070.5,-1032.45"/>
<text text-anchor="middle" x="2951" y="-1019.65" font-family="Arial" font-size="11.00">Residual_Add1_15</text>
<text text-anchor="middle" x="2951" y="-1007.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2951" y="-995.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_2_14&#45;&gt;add_1_15 -->
<g id="edge343" class="edge">
<title>add_2_14&#45;&gt;add_1_15</title>
<path fill="none" stroke="black" d="M2954.71,-1656.39C2965.62,-1620.2 2986,-1543.72 2986,-1477.45 2986,-1477.45 2986,-1477.45 2986,-1213.45 2986,-1145.36 2996.68,-1125.93 2978,-1060.45 2976.18,-1054.08 2973.41,-1047.62 2970.33,-1041.57"/>
<polygon fill="black" stroke="black" points="2973.21,-1039.55 2965.32,-1032.49 2967.08,-1042.93 2973.21,-1039.55"/>
</g>
<!-- mha_input_15 -->
<g id="node499" class="node">
<title>mha_input_15</title>
<polygon fill="yellow" stroke="black" points="2966.16,-1520.45 2727.29,-1520.45 2665.84,-1432.45 2904.71,-1432.45 2966.16,-1520.45"/>
<text text-anchor="middle" x="2816" y="-1485.65" font-family="Arial" font-size="11.00">MHA_Input_15</text>
<text text-anchor="middle" x="2816" y="-1473.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2816" y="-1461.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- pre_ln_15&#45;&gt;mha_input_15 -->
<g id="edge333" class="edge">
<title>pre_ln_15&#45;&gt;mha_input_15</title>
<path fill="none" stroke="black" d="M2847.2,-1562.25C2843.76,-1552.91 2839.55,-1541.47 2835.35,-1530.05"/>
<polygon fill="black" stroke="black" points="2838.58,-1528.69 2831.85,-1520.52 2832.01,-1531.11 2838.58,-1528.69"/>
</g>
<!-- qkv_proj_15_gpu0 -->
<g id="node500" class="node">
<title>qkv_proj_15_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2725.5,-1396.45 2502.5,-1396.45 2502.5,-1352.45 2725.5,-1352.45 2725.5,-1396.45"/>
<text text-anchor="middle" x="2614" y="-1383.65" font-family="Arial" font-size="11.00">QKV_Proj_15_GPU0</text>
<text text-anchor="middle" x="2614" y="-1371.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2614" y="-1359.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_15&#45;&gt;qkv_proj_15_gpu0 -->
<g id="edge334" class="edge">
<title>mha_input_15&#45;&gt;qkv_proj_15_gpu0</title>
<path fill="none" stroke="black" d="M2728.87,-1432.32C2707.3,-1421.64 2684.88,-1410.54 2665.63,-1401.01"/>
<polygon fill="black" stroke="black" points="2666.97,-1397.77 2656.45,-1396.47 2663.86,-1404.04 2666.97,-1397.77"/>
</g>
<!-- qkv_proj_15_gpu1 -->
<g id="node501" class="node">
<title>qkv_proj_15_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2966.5,-1396.45 2743.5,-1396.45 2743.5,-1352.45 2966.5,-1352.45 2966.5,-1396.45"/>
<text text-anchor="middle" x="2855" y="-1383.65" font-family="Arial" font-size="11.00">QKV_Proj_15_GPU1</text>
<text text-anchor="middle" x="2855" y="-1371.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2855" y="-1359.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 192] (Q:64,K:64,V:64)</text>
</g>
<!-- mha_input_15&#45;&gt;qkv_proj_15_gpu1 -->
<g id="edge335" class="edge">
<title>mha_input_15&#45;&gt;qkv_proj_15_gpu1</title>
<path fill="none" stroke="black" d="M2832.88,-1432.17C2836.3,-1423.39 2839.84,-1414.33 2843.05,-1406.09"/>
<polygon fill="black" stroke="black" points="2846.41,-1407.12 2846.78,-1396.53 2839.88,-1404.58 2846.41,-1407.12"/>
</g>
<!-- attn_15_gpu0 -->
<g id="node502" class="node">
<title>attn_15_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2699.5,-1316.45 2566.5,-1316.45 2566.5,-1272.45 2699.5,-1272.45 2699.5,-1316.45"/>
<text text-anchor="middle" x="2633" y="-1303.65" font-family="Arial" font-size="11.00">Attention_15_GPU0</text>
<text text-anchor="middle" x="2633" y="-1291.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2633" y="-1279.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_15_gpu0&#45;&gt;attn_15_gpu0 -->
<g id="edge336" class="edge">
<title>qkv_proj_15_gpu0&#45;&gt;attn_15_gpu0</title>
<path fill="none" stroke="black" d="M2619.19,-1352.14C2621.13,-1344.16 2623.38,-1334.93 2625.49,-1326.27"/>
<polygon fill="black" stroke="black" points="2628.91,-1327.01 2627.88,-1316.47 2622.11,-1325.36 2628.91,-1327.01"/>
</g>
<!-- attn_15_gpu1 -->
<g id="node503" class="node">
<title>attn_15_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2911.5,-1316.45 2778.5,-1316.45 2778.5,-1272.45 2911.5,-1272.45 2911.5,-1316.45"/>
<text text-anchor="middle" x="2845" y="-1303.65" font-family="Arial" font-size="11.00">Attention_15_GPU1</text>
<text text-anchor="middle" x="2845" y="-1291.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2845" y="-1279.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_15_gpu1&#45;&gt;attn_15_gpu1 -->
<g id="edge337" class="edge">
<title>qkv_proj_15_gpu1&#45;&gt;attn_15_gpu1</title>
<path fill="none" stroke="black" d="M2852.27,-1352.14C2851.26,-1344.25 2850.09,-1335.13 2848.99,-1326.55"/>
<polygon fill="black" stroke="black" points="2852.44,-1325.94 2847.69,-1316.47 2845.49,-1326.83 2852.44,-1325.94"/>
</g>
<!-- out_proj_15_gpu0 -->
<g id="node504" class="node">
<title>out_proj_15_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2725.5,-1236.45 2580.5,-1236.45 2580.5,-1192.45 2725.5,-1192.45 2725.5,-1236.45"/>
<text text-anchor="middle" x="2653" y="-1223.65" font-family="Arial" font-size="11.00">Output_Proj_15_GPU0</text>
<text text-anchor="middle" x="2653" y="-1211.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2653" y="-1199.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_15_gpu0&#45;&gt;out_proj_15_gpu0 -->
<g id="edge338" class="edge">
<title>attn_15_gpu0&#45;&gt;out_proj_15_gpu0</title>
<path fill="none" stroke="black" d="M2638.47,-1272.14C2640.51,-1264.16 2642.88,-1254.93 2645.1,-1246.27"/>
<polygon fill="black" stroke="black" points="2648.52,-1247.02 2647.61,-1236.47 2641.74,-1245.29 2648.52,-1247.02"/>
</g>
<!-- out_proj_15_gpu1 -->
<g id="node505" class="node">
<title>out_proj_15_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2907.5,-1236.45 2762.5,-1236.45 2762.5,-1192.45 2907.5,-1192.45 2907.5,-1236.45"/>
<text text-anchor="middle" x="2835" y="-1223.65" font-family="Arial" font-size="11.00">Output_Proj_15_GPU1</text>
<text text-anchor="middle" x="2835" y="-1211.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="2835" y="-1199.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_15_gpu1&#45;&gt;out_proj_15_gpu1 -->
<g id="edge339" class="edge">
<title>attn_15_gpu1&#45;&gt;out_proj_15_gpu1</title>
<path fill="none" stroke="black" d="M2842.27,-1272.14C2841.26,-1264.25 2840.09,-1255.13 2838.99,-1246.55"/>
<polygon fill="black" stroke="black" points="2842.44,-1245.94 2837.69,-1236.47 2835.49,-1246.83 2842.44,-1245.94"/>
</g>
<!-- mha_merge_15 -->
<g id="node506" class="node">
<title>mha_merge_15</title>
<polygon fill="yellow" stroke="black" points="2966.16,-1156.45 2727.29,-1156.45 2665.84,-1068.45 2904.71,-1068.45 2966.16,-1156.45"/>
<text text-anchor="middle" x="2816" y="-1121.65" font-family="Arial" font-size="11.00">MHA_Merge_15</text>
<text text-anchor="middle" x="2816" y="-1109.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="2816" y="-1097.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_15_gpu0&#45;&gt;mha_merge_15 -->
<g id="edge340" class="edge">
<title>out_proj_15_gpu0&#45;&gt;mha_merge_15</title>
<path fill="none" stroke="black" d="M2687.57,-1192.24C2701.97,-1183.41 2719.34,-1172.75 2736.59,-1162.17"/>
<polygon fill="black" stroke="black" points="2738.89,-1164.87 2745.58,-1156.65 2735.23,-1158.9 2738.89,-1164.87"/>
</g>
<!-- out_proj_15_gpu1&#45;&gt;mha_merge_15 -->
<g id="edge341" class="edge">
<title>out_proj_15_gpu1&#45;&gt;mha_merge_15</title>
<path fill="none" stroke="black" d="M2830.97,-1192.24C2829.53,-1184.66 2827.84,-1175.75 2826.12,-1166.69"/>
<polygon fill="black" stroke="black" points="2829.55,-1166.03 2824.25,-1156.86 2822.68,-1167.34 2829.55,-1166.03"/>
</g>
<!-- mha_merge_15&#45;&gt;add_1_15 -->
<g id="edge342" class="edge">
<title>mha_merge_15&#45;&gt;add_1_15</title>
<path fill="none" stroke="black" d="M2874.43,-1068.17C2887.98,-1058.14 2902.02,-1047.73 2914.33,-1038.62"/>
<polygon fill="black" stroke="black" points="2916.59,-1041.3 2922.54,-1032.53 2912.42,-1035.67 2916.59,-1041.3"/>
</g>
<!-- post_ln_15 -->
<g id="node508" class="node">
<title>post_ln_15</title>
<polygon fill="lightgreen" stroke="black" points="2967.5,-952.45 2822.5,-952.45 2822.5,-908.45 2967.5,-908.45 2967.5,-952.45"/>
<text text-anchor="middle" x="2895" y="-939.65" font-family="Arial" font-size="11.00">Post&#45;LayerNorm_15</text>
<text text-anchor="middle" x="2895" y="-927.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2895" y="-915.65" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_15&#45;&gt;post_ln_15 -->
<g id="edge344" class="edge">
<title>add_1_15&#45;&gt;post_ln_15</title>
<path fill="none" stroke="black" d="M2935.7,-988.14C2929.66,-979.73 2922.62,-969.93 2916.12,-960.86"/>
<polygon fill="black" stroke="black" points="2918.77,-958.55 2910.09,-952.47 2913.08,-962.63 2918.77,-958.55"/>
</g>
<!-- add_2_15 -->
<g id="node530" class="node">
<title>add_2_15</title>
<polygon fill="lightgreen" stroke="black" points="3067.5,-158.23 2828.5,-158.23 2828.5,-114.23 3067.5,-114.23 3067.5,-158.23"/>
<text text-anchor="middle" x="2948" y="-145.43" font-family="Arial" font-size="11.00">Residual_Add2_15</text>
<text text-anchor="middle" x="2948" y="-133.43" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096] + [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-121.43" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_1_15&#45;&gt;add_2_15 -->
<g id="edge353" class="edge">
<title>add_1_15&#45;&gt;add_2_15</title>
<path fill="none" stroke="black" d="M2984.86,-988.45C3027.99,-958.79 3097,-900.27 3097,-829.45 3097,-829.45 3097,-829.45 3097,-361.23 3097,-283.42 3138.2,-248.84 3092,-186.23 3085.15,-176.94 3076.44,-169.4 3066.71,-163.27"/>
<polygon fill="black" stroke="black" points="3068.33,-160.17 3057.91,-158.24 3064.86,-166.25 3068.33,-160.17"/>
</g>
<!-- gate_15 -->
<g id="node509" class="node">
<title>gate_15</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3078.5,-872.45 2742.05,-872.45 2655.5,-784.45 2991.95,-784.45 3078.5,-872.45"/>
<text text-anchor="middle" x="2867" y="-837.65" font-family="Arial" font-size="11.00">Expert_Gate_15</text>
<text text-anchor="middle" x="2867" y="-825.65" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2867" y="-813.65" font-family="Arial" font-size="11.00">Output: Routing_Decisions[64_experts]</text>
</g>
<!-- post_ln_15&#45;&gt;gate_15 -->
<g id="edge345" class="edge">
<title>post_ln_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M2889.06,-908.24C2886.94,-900.66 2884.44,-891.75 2881.91,-882.69"/>
<polygon fill="black" stroke="black" points="2885.22,-881.54 2879.15,-872.86 2878.48,-883.43 2885.22,-881.54"/>
</g>
<!-- token_dist_15 -->
<g id="node510" class="node">
<title>token_dist_15</title>
<ellipse fill="lightcoral" stroke="black" cx="2881" cy="-717.34" rx="145.83" ry="31.23"/>
<text text-anchor="middle" x="2881" y="-726.54" font-family="Arial" font-size="11.00">Token_Distribution_15</text>
<text text-anchor="middle" x="2881" y="-714.54" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2881" y="-702.54" font-family="Arial" font-size="11.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_15&#45;&gt;token_dist_15 -->
<g id="edge346" class="edge">
<title>gate_15&#45;&gt;token_dist_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2872.53,-784.33C2873.61,-775.95 2874.73,-767.2 2875.79,-758.91"/>
<polygon fill="red" stroke="red" points="2879.3,-759.08 2877.1,-748.71 2872.36,-758.19 2879.3,-759.08"/>
</g>
<!-- expert_15_0_gpu0 -->
<g id="node511" class="node">
<title>expert_15_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2942,-588.23 2820,-588.23 2820,-544.23 2942,-544.23 2942,-588.23"/>
<text text-anchor="middle" x="2881" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_0_GPU0</text>
<text text-anchor="middle" x="2881" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2881" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_15&#45;&gt;expert_15_0_gpu0 -->
<g id="edge347" class="edge">
<title>token_dist_15&#45;&gt;expert_15_0_gpu0</title>
<path fill="none" stroke="black" d="M2881,-686.16C2881,-660.58 2881,-624.04 2881,-598.23"/>
<polygon fill="black" stroke="black" points="2884.5,-598.23 2881,-588.23 2877.5,-598.23 2884.5,-598.23"/>
</g>
<!-- expert_15_0_gpu1 -->
<g id="node512" class="node">
<title>expert_15_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3007,-486.23 2885,-486.23 2885,-442.23 3007,-442.23 3007,-486.23"/>
<text text-anchor="middle" x="2946" y="-473.43" font-family="Arial" font-size="11.00">Expert_15_0_GPU1</text>
<text text-anchor="middle" x="2946" y="-461.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2946" y="-449.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- token_dist_15&#45;&gt;expert_15_0_gpu1 -->
<g id="edge348" class="edge">
<title>token_dist_15&#45;&gt;expert_15_0_gpu1</title>
<path fill="none" stroke="black" d="M2942.5,-688.9C2945.77,-685.7 2948.67,-682.15 2951,-678.23 2984.76,-621.41 2968.96,-540.14 2956.33,-496.23"/>
<polygon fill="black" stroke="black" points="2959.62,-494.99 2953.38,-486.42 2952.91,-497.01 2959.62,-494.99"/>
</g>
<!-- expert_15_0_gpu0&#45;&gt;expert_15_0_gpu1 -->
<g id="edge349" class="edge">
<title>expert_15_0_gpu0&#45;&gt;expert_15_0_gpu1</title>
<path fill="none" stroke="black" d="M2894.78,-544.02C2904.09,-529.7 2916.51,-510.6 2926.78,-494.79"/>
<polygon fill="black" stroke="black" points="2929.72,-496.69 2932.24,-486.4 2923.85,-492.88 2929.72,-496.69"/>
</g>
<!-- expert_merge_15_0 -->
<g id="node513" class="node">
<title>expert_merge_15_0</title>
<polygon fill="yellow" stroke="black" points="3072.47,-406.23 2871.29,-406.23 2819.53,-318.23 3020.71,-318.23 3072.47,-406.23"/>
<text text-anchor="middle" x="2946" y="-371.43" font-family="Arial" font-size="11.00">Expert_Merge_15_0</text>
<text text-anchor="middle" x="2946" y="-359.43" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2946" y="-347.43" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_15_0_gpu1&#45;&gt;expert_merge_15_0 -->
<g id="edge350" class="edge">
<title>expert_15_0_gpu1&#45;&gt;expert_merge_15_0</title>
<path fill="none" stroke="black" d="M2946,-442.02C2946,-434.52 2946,-425.71 2946,-416.75"/>
<polygon fill="black" stroke="black" points="2949.5,-416.63 2946,-406.63 2942.5,-416.63 2949.5,-416.63"/>
</g>
<!-- expert_agg_15 -->
<g id="node529" class="node">
<title>expert_agg_15</title>
<polygon fill="yellow" stroke="black" points="3077.82,-282.23 2823.58,-282.23 2758.18,-194.23 3012.42,-194.23 3077.82,-282.23"/>
<text text-anchor="middle" x="2918" y="-247.43" font-family="Arial" font-size="11.00">Expert_Aggregation_15</text>
<text text-anchor="middle" x="2918" y="-235.43" font-family="Arial" font-size="11.00">Input: [expert_outputs, 4096]</text>
<text text-anchor="middle" x="2918" y="-223.43" font-family="Arial" font-size="11.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_15_0&#45;&gt;expert_agg_15 -->
<g id="edge351" class="edge">
<title>expert_merge_15_0&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M2936.13,-318.21C2934.2,-309.83 2932.17,-300.95 2930.18,-292.29"/>
<polygon fill="black" stroke="black" points="2933.53,-291.22 2927.88,-282.26 2926.7,-292.79 2933.53,-291.22"/>
</g>
<!-- expert_15_1_gpu0 -->
<g id="node514" class="node">
<title>expert_15_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2796,-588.23 2674,-588.23 2674,-544.23 2796,-544.23 2796,-588.23"/>
<text text-anchor="middle" x="2735" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_1_GPU0</text>
<text text-anchor="middle" x="2735" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2735" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_1_gpu1 -->
<g id="node515" class="node">
<title>expert_15_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2656,-588.23 2534,-588.23 2534,-544.23 2656,-544.23 2656,-588.23"/>
<text text-anchor="middle" x="2595" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_1_GPU1</text>
<text text-anchor="middle" x="2595" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2595" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_1 -->
<g id="node516" class="node">
<title>expert_merge_15_1</title>
<polygon fill="yellow" stroke="black" points="2516.47,-610.23 2315.29,-610.23 2263.53,-522.23 2464.71,-522.23 2516.47,-610.23"/>
<text text-anchor="middle" x="2390" y="-575.43" font-family="Arial" font-size="11.00">Expert_Merge_15_1</text>
<text text-anchor="middle" x="2390" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2390" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_15_2_gpu0 -->
<g id="node517" class="node">
<title>expert_15_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2240,-588.23 2118,-588.23 2118,-544.23 2240,-544.23 2240,-588.23"/>
<text text-anchor="middle" x="2179" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_2_GPU0</text>
<text text-anchor="middle" x="2179" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2179" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_2_gpu1 -->
<g id="node518" class="node">
<title>expert_15_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2100,-588.23 1978,-588.23 1978,-544.23 2100,-544.23 2100,-588.23"/>
<text text-anchor="middle" x="2039" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_2_GPU1</text>
<text text-anchor="middle" x="2039" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2039" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_2 -->
<g id="node519" class="node">
<title>expert_merge_15_2</title>
<polygon fill="yellow" stroke="black" points="1960.47,-610.23 1759.29,-610.23 1707.53,-522.23 1908.71,-522.23 1960.47,-610.23"/>
<text text-anchor="middle" x="1834" y="-575.43" font-family="Arial" font-size="11.00">Expert_Merge_15_2</text>
<text text-anchor="middle" x="1834" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1834" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_15_61_gpu0 -->
<g id="node520" class="node">
<title>expert_15_61_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1684,-588.23 1562,-588.23 1562,-544.23 1684,-544.23 1684,-588.23"/>
<text text-anchor="middle" x="1623" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_61_GPU0</text>
<text text-anchor="middle" x="1623" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1623" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_61_gpu1 -->
<g id="node521" class="node">
<title>expert_15_61_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1544,-588.23 1422,-588.23 1422,-544.23 1544,-544.23 1544,-588.23"/>
<text text-anchor="middle" x="1483" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_61_GPU1</text>
<text text-anchor="middle" x="1483" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1483" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_61 -->
<g id="node522" class="node">
<title>expert_merge_15_61</title>
<polygon fill="yellow" stroke="black" points="1404.47,-610.23 1203.29,-610.23 1151.53,-522.23 1352.71,-522.23 1404.47,-610.23"/>
<text text-anchor="middle" x="1278" y="-575.43" font-family="Arial" font-size="11.00">Expert_Merge_15_61</text>
<text text-anchor="middle" x="1278" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1278" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_15_62_gpu0 -->
<g id="node523" class="node">
<title>expert_15_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1128,-588.23 1006,-588.23 1006,-544.23 1128,-544.23 1128,-588.23"/>
<text text-anchor="middle" x="1067" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_62_GPU0</text>
<text text-anchor="middle" x="1067" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1067" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_62_gpu1 -->
<g id="node524" class="node">
<title>expert_15_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="988,-588.23 866,-588.23 866,-544.23 988,-544.23 988,-588.23"/>
<text text-anchor="middle" x="927" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_62_GPU1</text>
<text text-anchor="middle" x="927" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="927" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_62 -->
<g id="node525" class="node">
<title>expert_merge_15_62</title>
<polygon fill="yellow" stroke="black" points="848.47,-610.23 647.29,-610.23 595.53,-522.23 796.71,-522.23 848.47,-610.23"/>
<text text-anchor="middle" x="722" y="-575.43" font-family="Arial" font-size="11.00">Expert_Merge_15_62</text>
<text text-anchor="middle" x="722" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="722" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_15_63_gpu0 -->
<g id="node526" class="node">
<title>expert_15_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="572,-588.23 450,-588.23 450,-544.23 572,-544.23 572,-588.23"/>
<text text-anchor="middle" x="511" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_63_GPU0</text>
<text text-anchor="middle" x="511" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="511" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_63_gpu1 -->
<g id="node527" class="node">
<title>expert_15_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="432,-588.23 310,-588.23 310,-544.23 432,-544.23 432,-588.23"/>
<text text-anchor="middle" x="371" y="-575.43" font-family="Arial" font-size="11.00">Expert_15_63_GPU1</text>
<text text-anchor="middle" x="371" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="371" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_63 -->
<g id="node528" class="node">
<title>expert_merge_15_63</title>
<polygon fill="yellow" stroke="black" points="292.47,-610.23 91.29,-610.23 39.53,-522.23 240.71,-522.23 292.47,-610.23"/>
<text text-anchor="middle" x="166" y="-575.43" font-family="Arial" font-size="11.00">Expert_Merge_15_63</text>
<text text-anchor="middle" x="166" y="-563.43" font-family="Arial" font-size="11.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="166" y="-551.43" font-family="Arial" font-size="11.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_15&#45;&gt;add_2_15 -->
<g id="edge352" class="edge">
<title>expert_agg_15&#45;&gt;add_2_15</title>
<path fill="none" stroke="black" d="M2930.98,-193.95C2933.59,-185.26 2936.28,-176.3 2938.73,-168.14"/>
<polygon fill="black" stroke="black" points="2942.15,-168.89 2941.68,-158.31 2935.45,-166.88 2942.15,-168.89"/>
</g>
<!-- output -->
<g id="node531" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="2948" cy="-47.11" rx="106.55" ry="31.23"/>
<text text-anchor="middle" x="2948" y="-56.31" font-family="Arial" font-size="11.00">Model Output</text>
<text text-anchor="middle" x="2948" y="-44.31" font-family="Arial" font-size="11.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2948" y="-32.31" font-family="Arial" font-size="11.00">Output: [128, 10000, 51200]</text>
</g>
<!-- add_2_15&#45;&gt;output -->
<g id="edge354" class="edge">
<title>add_2_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2948,-114.14C2948,-106.47 2948,-97.51 2948,-88.72"/>
<polygon fill="black" stroke="black" points="2951.5,-88.56 2948,-78.56 2944.5,-88.56 2951.5,-88.56"/>
</g>
</g>
</svg>
