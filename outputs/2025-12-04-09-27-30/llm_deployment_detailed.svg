<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="8262pt" height="30000pt"
 viewBox="0.00 0.00 1982.80 7200.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.85 1.85) rotate(0) translate(4 16211.97)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-16211.97 4461.7,-16211.97 4461.7,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_main</title>
<polygon fill="none" stroke="black" points="14.94,-77.98 14.94,-16199.97 3948.94,-16199.97 3948.94,-77.98 14.94,-77.98"/>
<text text-anchor="middle" x="1981.94" y="-16183.17" font-family="Arial Bold" font-size="16.00">LLM Model &#45; 16 Layers with EP64_TP2</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0</title>
<path fill="none" stroke="black" d="M207.94,-14995.98C207.94,-14995.98 3755.94,-14995.98 3755.94,-14995.98 3761.94,-14995.98 3767.94,-15001.98 3767.94,-15007.98 3767.94,-15007.98 3767.94,-16087.98 3767.94,-16087.98 3767.94,-16093.98 3761.94,-16099.98 3755.94,-16099.98 3755.94,-16099.98 207.94,-16099.98 207.94,-16099.98 201.94,-16099.98 195.94,-16093.98 195.94,-16087.98 195.94,-16087.98 195.94,-15007.98 195.94,-15007.98 195.94,-15001.98 201.94,-14995.98 207.94,-14995.98"/>
<text text-anchor="middle" x="1981.94" y="-16083.18" font-family="Arial Bold" font-size="16.00">Layer 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_mha_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="244.94,-15543.98 244.94,-16016.98 697.94,-16016.98 697.94,-15543.98 244.94,-15543.98"/>
<text text-anchor="middle" x="471.44" y="-16000.18" font-family="Arial Bold" font-size="16.00">MHA Layer 0 (TP=2)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_moe_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="203.94,-15072.98 203.94,-15348.98 3759.94,-15348.98 3759.94,-15072.98 203.94,-15072.98"/>
<text text-anchor="middle" x="1981.94" y="-15332.18" font-family="Arial Bold" font-size="16.00">MoE Layer 0 (EP=64, TP=2)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_expert_0_0</title>
<path fill="none" stroke="black" d="M3247.94,-15190.98C3247.94,-15190.98 3739.94,-15190.98 3739.94,-15190.98 3745.94,-15190.98 3751.94,-15196.98 3751.94,-15202.98 3751.94,-15202.98 3751.94,-15302.98 3751.94,-15302.98 3751.94,-15308.98 3745.94,-15314.98 3739.94,-15314.98 3739.94,-15314.98 3247.94,-15314.98 3247.94,-15314.98 3241.94,-15314.98 3235.94,-15308.98 3235.94,-15302.98 3235.94,-15302.98 3235.94,-15202.98 3235.94,-15202.98 3235.94,-15196.98 3241.94,-15190.98 3247.94,-15190.98"/>
<text text-anchor="middle" x="3493.94" y="-15298.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_expert_0_1</title>
<path fill="none" stroke="black" d="M2723.94,-15190.98C2723.94,-15190.98 3215.94,-15190.98 3215.94,-15190.98 3221.94,-15190.98 3227.94,-15196.98 3227.94,-15202.98 3227.94,-15202.98 3227.94,-15302.98 3227.94,-15302.98 3227.94,-15308.98 3221.94,-15314.98 3215.94,-15314.98 3215.94,-15314.98 2723.94,-15314.98 2723.94,-15314.98 2717.94,-15314.98 2711.94,-15308.98 2711.94,-15302.98 2711.94,-15302.98 2711.94,-15202.98 2711.94,-15202.98 2711.94,-15196.98 2717.94,-15190.98 2723.94,-15190.98"/>
<text text-anchor="middle" x="2969.94" y="-15298.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_expert_0_2</title>
<path fill="none" stroke="black" d="M2199.94,-15190.98C2199.94,-15190.98 2691.94,-15190.98 2691.94,-15190.98 2697.94,-15190.98 2703.94,-15196.98 2703.94,-15202.98 2703.94,-15202.98 2703.94,-15302.98 2703.94,-15302.98 2703.94,-15308.98 2697.94,-15314.98 2691.94,-15314.98 2691.94,-15314.98 2199.94,-15314.98 2199.94,-15314.98 2193.94,-15314.98 2187.94,-15308.98 2187.94,-15302.98 2187.94,-15302.98 2187.94,-15202.98 2187.94,-15202.98 2187.94,-15196.98 2193.94,-15190.98 2199.94,-15190.98"/>
<text text-anchor="middle" x="2445.94" y="-15298.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_expert_0_3</title>
<path fill="none" stroke="black" d="M1675.94,-15190.98C1675.94,-15190.98 2167.94,-15190.98 2167.94,-15190.98 2173.94,-15190.98 2179.94,-15196.98 2179.94,-15202.98 2179.94,-15202.98 2179.94,-15302.98 2179.94,-15302.98 2179.94,-15308.98 2173.94,-15314.98 2167.94,-15314.98 2167.94,-15314.98 1675.94,-15314.98 1675.94,-15314.98 1669.94,-15314.98 1663.94,-15308.98 1663.94,-15302.98 1663.94,-15302.98 1663.94,-15202.98 1663.94,-15202.98 1663.94,-15196.98 1669.94,-15190.98 1675.94,-15190.98"/>
<text text-anchor="middle" x="1921.94" y="-15298.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_expert_0_62</title>
<path fill="none" stroke="black" d="M1151.94,-15190.98C1151.94,-15190.98 1643.94,-15190.98 1643.94,-15190.98 1649.94,-15190.98 1655.94,-15196.98 1655.94,-15202.98 1655.94,-15202.98 1655.94,-15302.98 1655.94,-15302.98 1655.94,-15308.98 1649.94,-15314.98 1643.94,-15314.98 1643.94,-15314.98 1151.94,-15314.98 1151.94,-15314.98 1145.94,-15314.98 1139.94,-15308.98 1139.94,-15302.98 1139.94,-15302.98 1139.94,-15202.98 1139.94,-15202.98 1139.94,-15196.98 1145.94,-15190.98 1151.94,-15190.98"/>
<text text-anchor="middle" x="1397.94" y="-15298.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_expert_0_63</title>
<path fill="none" stroke="black" d="M627.94,-15190.98C627.94,-15190.98 1119.94,-15190.98 1119.94,-15190.98 1125.94,-15190.98 1131.94,-15196.98 1131.94,-15202.98 1131.94,-15202.98 1131.94,-15302.98 1131.94,-15302.98 1131.94,-15308.98 1125.94,-15314.98 1119.94,-15314.98 1119.94,-15314.98 627.94,-15314.98 627.94,-15314.98 621.94,-15314.98 615.94,-15308.98 615.94,-15302.98 615.94,-15302.98 615.94,-15202.98 615.94,-15202.98 615.94,-15196.98 621.94,-15190.98 627.94,-15190.98"/>
<text text-anchor="middle" x="873.94" y="-15298.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_1</title>
<path fill="none" stroke="black" d="M34.94,-14001.98C34.94,-14001.98 3928.94,-14001.98 3928.94,-14001.98 3934.94,-14001.98 3940.94,-14007.98 3940.94,-14013.98 3940.94,-14013.98 3940.94,-14975.98 3940.94,-14975.98 3940.94,-14981.98 3934.94,-14987.98 3928.94,-14987.98 3928.94,-14987.98 34.94,-14987.98 34.94,-14987.98 28.94,-14987.98 22.94,-14981.98 22.94,-14975.98 22.94,-14975.98 22.94,-14013.98 22.94,-14013.98 22.94,-14007.98 28.94,-14001.98 34.94,-14001.98"/>
<text text-anchor="middle" x="1981.94" y="-14971.18" font-family="Arial Bold" font-size="16.00">Layer 1</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_mha_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1336.94,-14431.98 1336.94,-14904.98 1789.94,-14904.98 1789.94,-14431.98 1336.94,-14431.98"/>
<text text-anchor="middle" x="1563.44" y="-14888.18" font-family="Arial Bold" font-size="16.00">MHA Layer 1 (TP=2)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_moe_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-14070.98 30.94,-14236.98 3932.94,-14236.98 3932.94,-14070.98 30.94,-14070.98"/>
<text text-anchor="middle" x="1981.94" y="-14220.18" font-family="Arial Bold" font-size="16.00">MoE Layer 1 (EP=64, TP=2)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_expert_1_0</title>
<path fill="none" stroke="black" d="M3420.94,-14078.98C3420.94,-14078.98 3912.94,-14078.98 3912.94,-14078.98 3918.94,-14078.98 3924.94,-14084.98 3924.94,-14090.98 3924.94,-14090.98 3924.94,-14190.98 3924.94,-14190.98 3924.94,-14196.98 3918.94,-14202.98 3912.94,-14202.98 3912.94,-14202.98 3420.94,-14202.98 3420.94,-14202.98 3414.94,-14202.98 3408.94,-14196.98 3408.94,-14190.98 3408.94,-14190.98 3408.94,-14090.98 3408.94,-14090.98 3408.94,-14084.98 3414.94,-14078.98 3420.94,-14078.98"/>
<text text-anchor="middle" x="3666.94" y="-14186.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_expert_1_1</title>
<path fill="none" stroke="black" d="M2896.94,-14078.98C2896.94,-14078.98 3388.94,-14078.98 3388.94,-14078.98 3394.94,-14078.98 3400.94,-14084.98 3400.94,-14090.98 3400.94,-14090.98 3400.94,-14190.98 3400.94,-14190.98 3400.94,-14196.98 3394.94,-14202.98 3388.94,-14202.98 3388.94,-14202.98 2896.94,-14202.98 2896.94,-14202.98 2890.94,-14202.98 2884.94,-14196.98 2884.94,-14190.98 2884.94,-14190.98 2884.94,-14090.98 2884.94,-14090.98 2884.94,-14084.98 2890.94,-14078.98 2896.94,-14078.98"/>
<text text-anchor="middle" x="3142.94" y="-14186.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_expert_1_2</title>
<path fill="none" stroke="black" d="M2372.94,-14078.98C2372.94,-14078.98 2864.94,-14078.98 2864.94,-14078.98 2870.94,-14078.98 2876.94,-14084.98 2876.94,-14090.98 2876.94,-14090.98 2876.94,-14190.98 2876.94,-14190.98 2876.94,-14196.98 2870.94,-14202.98 2864.94,-14202.98 2864.94,-14202.98 2372.94,-14202.98 2372.94,-14202.98 2366.94,-14202.98 2360.94,-14196.98 2360.94,-14190.98 2360.94,-14190.98 2360.94,-14090.98 2360.94,-14090.98 2360.94,-14084.98 2366.94,-14078.98 2372.94,-14078.98"/>
<text text-anchor="middle" x="2618.94" y="-14186.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_expert_1_3</title>
<path fill="none" stroke="black" d="M1848.94,-14078.98C1848.94,-14078.98 2340.94,-14078.98 2340.94,-14078.98 2346.94,-14078.98 2352.94,-14084.98 2352.94,-14090.98 2352.94,-14090.98 2352.94,-14190.98 2352.94,-14190.98 2352.94,-14196.98 2346.94,-14202.98 2340.94,-14202.98 2340.94,-14202.98 1848.94,-14202.98 1848.94,-14202.98 1842.94,-14202.98 1836.94,-14196.98 1836.94,-14190.98 1836.94,-14190.98 1836.94,-14090.98 1836.94,-14090.98 1836.94,-14084.98 1842.94,-14078.98 1848.94,-14078.98"/>
<text text-anchor="middle" x="2094.94" y="-14186.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_expert_1_62</title>
<path fill="none" stroke="black" d="M1324.94,-14078.98C1324.94,-14078.98 1816.94,-14078.98 1816.94,-14078.98 1822.94,-14078.98 1828.94,-14084.98 1828.94,-14090.98 1828.94,-14090.98 1828.94,-14190.98 1828.94,-14190.98 1828.94,-14196.98 1822.94,-14202.98 1816.94,-14202.98 1816.94,-14202.98 1324.94,-14202.98 1324.94,-14202.98 1318.94,-14202.98 1312.94,-14196.98 1312.94,-14190.98 1312.94,-14190.98 1312.94,-14090.98 1312.94,-14090.98 1312.94,-14084.98 1318.94,-14078.98 1324.94,-14078.98"/>
<text text-anchor="middle" x="1570.94" y="-14186.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_expert_1_63</title>
<path fill="none" stroke="black" d="M800.94,-14078.98C800.94,-14078.98 1292.94,-14078.98 1292.94,-14078.98 1298.94,-14078.98 1304.94,-14084.98 1304.94,-14090.98 1304.94,-14090.98 1304.94,-14190.98 1304.94,-14190.98 1304.94,-14196.98 1298.94,-14202.98 1292.94,-14202.98 1292.94,-14202.98 800.94,-14202.98 800.94,-14202.98 794.94,-14202.98 788.94,-14196.98 788.94,-14190.98 788.94,-14190.98 788.94,-14090.98 788.94,-14090.98 788.94,-14084.98 794.94,-14078.98 800.94,-14078.98"/>
<text text-anchor="middle" x="1046.94" y="-14186.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_layer_2</title>
<path fill="none" stroke="black" d="M34.94,-13007.98C34.94,-13007.98 3928.94,-13007.98 3928.94,-13007.98 3934.94,-13007.98 3940.94,-13013.98 3940.94,-13019.98 3940.94,-13019.98 3940.94,-13981.98 3940.94,-13981.98 3940.94,-13987.98 3934.94,-13993.98 3928.94,-13993.98 3928.94,-13993.98 34.94,-13993.98 34.94,-13993.98 28.94,-13993.98 22.94,-13987.98 22.94,-13981.98 22.94,-13981.98 22.94,-13019.98 22.94,-13019.98 22.94,-13013.98 28.94,-13007.98 34.94,-13007.98"/>
<text text-anchor="middle" x="1981.94" y="-13977.18" font-family="Arial Bold" font-size="16.00">Layer 2</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_mha_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="199.94,-13437.98 199.94,-13910.98 652.94,-13910.98 652.94,-13437.98 199.94,-13437.98"/>
<text text-anchor="middle" x="426.44" y="-13894.18" font-family="Arial Bold" font-size="16.00">MHA Layer 2 (TP=2)</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_moe_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-13076.98 30.94,-13242.98 3932.94,-13242.98 3932.94,-13076.98 30.94,-13076.98"/>
<text text-anchor="middle" x="1981.94" y="-13226.18" font-family="Arial Bold" font-size="16.00">MoE Layer 2 (EP=64, TP=2)</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_expert_2_0</title>
<path fill="none" stroke="black" d="M3420.94,-13084.98C3420.94,-13084.98 3912.94,-13084.98 3912.94,-13084.98 3918.94,-13084.98 3924.94,-13090.98 3924.94,-13096.98 3924.94,-13096.98 3924.94,-13196.98 3924.94,-13196.98 3924.94,-13202.98 3918.94,-13208.98 3912.94,-13208.98 3912.94,-13208.98 3420.94,-13208.98 3420.94,-13208.98 3414.94,-13208.98 3408.94,-13202.98 3408.94,-13196.98 3408.94,-13196.98 3408.94,-13096.98 3408.94,-13096.98 3408.94,-13090.98 3414.94,-13084.98 3420.94,-13084.98"/>
<text text-anchor="middle" x="3666.94" y="-13192.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_expert_2_1</title>
<path fill="none" stroke="black" d="M2896.94,-13084.98C2896.94,-13084.98 3388.94,-13084.98 3388.94,-13084.98 3394.94,-13084.98 3400.94,-13090.98 3400.94,-13096.98 3400.94,-13096.98 3400.94,-13196.98 3400.94,-13196.98 3400.94,-13202.98 3394.94,-13208.98 3388.94,-13208.98 3388.94,-13208.98 2896.94,-13208.98 2896.94,-13208.98 2890.94,-13208.98 2884.94,-13202.98 2884.94,-13196.98 2884.94,-13196.98 2884.94,-13096.98 2884.94,-13096.98 2884.94,-13090.98 2890.94,-13084.98 2896.94,-13084.98"/>
<text text-anchor="middle" x="3142.94" y="-13192.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_expert_2_2</title>
<path fill="none" stroke="black" d="M2372.94,-13084.98C2372.94,-13084.98 2864.94,-13084.98 2864.94,-13084.98 2870.94,-13084.98 2876.94,-13090.98 2876.94,-13096.98 2876.94,-13096.98 2876.94,-13196.98 2876.94,-13196.98 2876.94,-13202.98 2870.94,-13208.98 2864.94,-13208.98 2864.94,-13208.98 2372.94,-13208.98 2372.94,-13208.98 2366.94,-13208.98 2360.94,-13202.98 2360.94,-13196.98 2360.94,-13196.98 2360.94,-13096.98 2360.94,-13096.98 2360.94,-13090.98 2366.94,-13084.98 2372.94,-13084.98"/>
<text text-anchor="middle" x="2618.94" y="-13192.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_expert_2_3</title>
<path fill="none" stroke="black" d="M1848.94,-13084.98C1848.94,-13084.98 2340.94,-13084.98 2340.94,-13084.98 2346.94,-13084.98 2352.94,-13090.98 2352.94,-13096.98 2352.94,-13096.98 2352.94,-13196.98 2352.94,-13196.98 2352.94,-13202.98 2346.94,-13208.98 2340.94,-13208.98 2340.94,-13208.98 1848.94,-13208.98 1848.94,-13208.98 1842.94,-13208.98 1836.94,-13202.98 1836.94,-13196.98 1836.94,-13196.98 1836.94,-13096.98 1836.94,-13096.98 1836.94,-13090.98 1842.94,-13084.98 1848.94,-13084.98"/>
<text text-anchor="middle" x="2094.94" y="-13192.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_expert_2_62</title>
<path fill="none" stroke="black" d="M1324.94,-13084.98C1324.94,-13084.98 1816.94,-13084.98 1816.94,-13084.98 1822.94,-13084.98 1828.94,-13090.98 1828.94,-13096.98 1828.94,-13096.98 1828.94,-13196.98 1828.94,-13196.98 1828.94,-13202.98 1822.94,-13208.98 1816.94,-13208.98 1816.94,-13208.98 1324.94,-13208.98 1324.94,-13208.98 1318.94,-13208.98 1312.94,-13202.98 1312.94,-13196.98 1312.94,-13196.98 1312.94,-13096.98 1312.94,-13096.98 1312.94,-13090.98 1318.94,-13084.98 1324.94,-13084.98"/>
<text text-anchor="middle" x="1570.94" y="-13192.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_expert_2_63</title>
<path fill="none" stroke="black" d="M800.94,-13084.98C800.94,-13084.98 1292.94,-13084.98 1292.94,-13084.98 1298.94,-13084.98 1304.94,-13090.98 1304.94,-13096.98 1304.94,-13096.98 1304.94,-13196.98 1304.94,-13196.98 1304.94,-13202.98 1298.94,-13208.98 1292.94,-13208.98 1292.94,-13208.98 800.94,-13208.98 800.94,-13208.98 794.94,-13208.98 788.94,-13202.98 788.94,-13196.98 788.94,-13196.98 788.94,-13096.98 788.94,-13096.98 788.94,-13090.98 794.94,-13084.98 800.94,-13084.98"/>
<text text-anchor="middle" x="1046.94" y="-13192.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_layer_3</title>
<path fill="none" stroke="black" d="M34.94,-12013.98C34.94,-12013.98 3928.94,-12013.98 3928.94,-12013.98 3934.94,-12013.98 3940.94,-12019.98 3940.94,-12025.98 3940.94,-12025.98 3940.94,-12987.98 3940.94,-12987.98 3940.94,-12993.98 3934.94,-12999.98 3928.94,-12999.98 3928.94,-12999.98 34.94,-12999.98 34.94,-12999.98 28.94,-12999.98 22.94,-12993.98 22.94,-12987.98 22.94,-12987.98 22.94,-12025.98 22.94,-12025.98 22.94,-12019.98 28.94,-12013.98 34.94,-12013.98"/>
<text text-anchor="middle" x="1981.94" y="-12983.18" font-family="Arial Bold" font-size="16.00">Layer 3</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_mha_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-12443.98 226.94,-12916.98 679.94,-12916.98 679.94,-12443.98 226.94,-12443.98"/>
<text text-anchor="middle" x="453.44" y="-12900.18" font-family="Arial Bold" font-size="16.00">MHA Layer 3 (TP=2)</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_moe_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-12082.98 30.94,-12248.98 3932.94,-12248.98 3932.94,-12082.98 30.94,-12082.98"/>
<text text-anchor="middle" x="1981.94" y="-12232.18" font-family="Arial Bold" font-size="16.00">MoE Layer 3 (EP=64, TP=2)</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_expert_3_0</title>
<path fill="none" stroke="black" d="M3420.94,-12090.98C3420.94,-12090.98 3912.94,-12090.98 3912.94,-12090.98 3918.94,-12090.98 3924.94,-12096.98 3924.94,-12102.98 3924.94,-12102.98 3924.94,-12202.98 3924.94,-12202.98 3924.94,-12208.98 3918.94,-12214.98 3912.94,-12214.98 3912.94,-12214.98 3420.94,-12214.98 3420.94,-12214.98 3414.94,-12214.98 3408.94,-12208.98 3408.94,-12202.98 3408.94,-12202.98 3408.94,-12102.98 3408.94,-12102.98 3408.94,-12096.98 3414.94,-12090.98 3420.94,-12090.98"/>
<text text-anchor="middle" x="3666.94" y="-12198.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_expert_3_1</title>
<path fill="none" stroke="black" d="M2896.94,-12090.98C2896.94,-12090.98 3388.94,-12090.98 3388.94,-12090.98 3394.94,-12090.98 3400.94,-12096.98 3400.94,-12102.98 3400.94,-12102.98 3400.94,-12202.98 3400.94,-12202.98 3400.94,-12208.98 3394.94,-12214.98 3388.94,-12214.98 3388.94,-12214.98 2896.94,-12214.98 2896.94,-12214.98 2890.94,-12214.98 2884.94,-12208.98 2884.94,-12202.98 2884.94,-12202.98 2884.94,-12102.98 2884.94,-12102.98 2884.94,-12096.98 2890.94,-12090.98 2896.94,-12090.98"/>
<text text-anchor="middle" x="3142.94" y="-12198.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_expert_3_2</title>
<path fill="none" stroke="black" d="M2372.94,-12090.98C2372.94,-12090.98 2864.94,-12090.98 2864.94,-12090.98 2870.94,-12090.98 2876.94,-12096.98 2876.94,-12102.98 2876.94,-12102.98 2876.94,-12202.98 2876.94,-12202.98 2876.94,-12208.98 2870.94,-12214.98 2864.94,-12214.98 2864.94,-12214.98 2372.94,-12214.98 2372.94,-12214.98 2366.94,-12214.98 2360.94,-12208.98 2360.94,-12202.98 2360.94,-12202.98 2360.94,-12102.98 2360.94,-12102.98 2360.94,-12096.98 2366.94,-12090.98 2372.94,-12090.98"/>
<text text-anchor="middle" x="2618.94" y="-12198.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust35" class="cluster">
<title>cluster_expert_3_3</title>
<path fill="none" stroke="black" d="M1848.94,-12090.98C1848.94,-12090.98 2340.94,-12090.98 2340.94,-12090.98 2346.94,-12090.98 2352.94,-12096.98 2352.94,-12102.98 2352.94,-12102.98 2352.94,-12202.98 2352.94,-12202.98 2352.94,-12208.98 2346.94,-12214.98 2340.94,-12214.98 2340.94,-12214.98 1848.94,-12214.98 1848.94,-12214.98 1842.94,-12214.98 1836.94,-12208.98 1836.94,-12202.98 1836.94,-12202.98 1836.94,-12102.98 1836.94,-12102.98 1836.94,-12096.98 1842.94,-12090.98 1848.94,-12090.98"/>
<text text-anchor="middle" x="2094.94" y="-12198.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_expert_3_62</title>
<path fill="none" stroke="black" d="M1324.94,-12090.98C1324.94,-12090.98 1816.94,-12090.98 1816.94,-12090.98 1822.94,-12090.98 1828.94,-12096.98 1828.94,-12102.98 1828.94,-12102.98 1828.94,-12202.98 1828.94,-12202.98 1828.94,-12208.98 1822.94,-12214.98 1816.94,-12214.98 1816.94,-12214.98 1324.94,-12214.98 1324.94,-12214.98 1318.94,-12214.98 1312.94,-12208.98 1312.94,-12202.98 1312.94,-12202.98 1312.94,-12102.98 1312.94,-12102.98 1312.94,-12096.98 1318.94,-12090.98 1324.94,-12090.98"/>
<text text-anchor="middle" x="1570.94" y="-12198.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust37" class="cluster">
<title>cluster_expert_3_63</title>
<path fill="none" stroke="black" d="M800.94,-12090.98C800.94,-12090.98 1292.94,-12090.98 1292.94,-12090.98 1298.94,-12090.98 1304.94,-12096.98 1304.94,-12102.98 1304.94,-12102.98 1304.94,-12202.98 1304.94,-12202.98 1304.94,-12208.98 1298.94,-12214.98 1292.94,-12214.98 1292.94,-12214.98 800.94,-12214.98 800.94,-12214.98 794.94,-12214.98 788.94,-12208.98 788.94,-12202.98 788.94,-12202.98 788.94,-12102.98 788.94,-12102.98 788.94,-12096.98 794.94,-12090.98 800.94,-12090.98"/>
<text text-anchor="middle" x="1046.94" y="-12198.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust38" class="cluster">
<title>cluster_layer_4</title>
<path fill="none" stroke="black" d="M34.94,-11019.98C34.94,-11019.98 3928.94,-11019.98 3928.94,-11019.98 3934.94,-11019.98 3940.94,-11025.98 3940.94,-11031.98 3940.94,-11031.98 3940.94,-11993.98 3940.94,-11993.98 3940.94,-11999.98 3934.94,-12005.98 3928.94,-12005.98 3928.94,-12005.98 34.94,-12005.98 34.94,-12005.98 28.94,-12005.98 22.94,-11999.98 22.94,-11993.98 22.94,-11993.98 22.94,-11031.98 22.94,-11031.98 22.94,-11025.98 28.94,-11019.98 34.94,-11019.98"/>
<text text-anchor="middle" x="1981.94" y="-11989.18" font-family="Arial Bold" font-size="16.00">Layer 4</text>
</g>
<g id="clust39" class="cluster">
<title>cluster_mha_4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-11449.98 226.94,-11922.98 679.94,-11922.98 679.94,-11449.98 226.94,-11449.98"/>
<text text-anchor="middle" x="453.44" y="-11906.18" font-family="Arial Bold" font-size="16.00">MHA Layer 4 (TP=2)</text>
</g>
<g id="clust40" class="cluster">
<title>cluster_moe_4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-11088.98 30.94,-11254.98 3932.94,-11254.98 3932.94,-11088.98 30.94,-11088.98"/>
<text text-anchor="middle" x="1981.94" y="-11238.18" font-family="Arial Bold" font-size="16.00">MoE Layer 4 (EP=64, TP=2)</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_expert_4_0</title>
<path fill="none" stroke="black" d="M3420.94,-11096.98C3420.94,-11096.98 3912.94,-11096.98 3912.94,-11096.98 3918.94,-11096.98 3924.94,-11102.98 3924.94,-11108.98 3924.94,-11108.98 3924.94,-11208.98 3924.94,-11208.98 3924.94,-11214.98 3918.94,-11220.98 3912.94,-11220.98 3912.94,-11220.98 3420.94,-11220.98 3420.94,-11220.98 3414.94,-11220.98 3408.94,-11214.98 3408.94,-11208.98 3408.94,-11208.98 3408.94,-11108.98 3408.94,-11108.98 3408.94,-11102.98 3414.94,-11096.98 3420.94,-11096.98"/>
<text text-anchor="middle" x="3666.94" y="-11204.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust42" class="cluster">
<title>cluster_expert_4_1</title>
<path fill="none" stroke="black" d="M2896.94,-11096.98C2896.94,-11096.98 3388.94,-11096.98 3388.94,-11096.98 3394.94,-11096.98 3400.94,-11102.98 3400.94,-11108.98 3400.94,-11108.98 3400.94,-11208.98 3400.94,-11208.98 3400.94,-11214.98 3394.94,-11220.98 3388.94,-11220.98 3388.94,-11220.98 2896.94,-11220.98 2896.94,-11220.98 2890.94,-11220.98 2884.94,-11214.98 2884.94,-11208.98 2884.94,-11208.98 2884.94,-11108.98 2884.94,-11108.98 2884.94,-11102.98 2890.94,-11096.98 2896.94,-11096.98"/>
<text text-anchor="middle" x="3142.94" y="-11204.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust43" class="cluster">
<title>cluster_expert_4_2</title>
<path fill="none" stroke="black" d="M2372.94,-11096.98C2372.94,-11096.98 2864.94,-11096.98 2864.94,-11096.98 2870.94,-11096.98 2876.94,-11102.98 2876.94,-11108.98 2876.94,-11108.98 2876.94,-11208.98 2876.94,-11208.98 2876.94,-11214.98 2870.94,-11220.98 2864.94,-11220.98 2864.94,-11220.98 2372.94,-11220.98 2372.94,-11220.98 2366.94,-11220.98 2360.94,-11214.98 2360.94,-11208.98 2360.94,-11208.98 2360.94,-11108.98 2360.94,-11108.98 2360.94,-11102.98 2366.94,-11096.98 2372.94,-11096.98"/>
<text text-anchor="middle" x="2618.94" y="-11204.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust44" class="cluster">
<title>cluster_expert_4_3</title>
<path fill="none" stroke="black" d="M1848.94,-11096.98C1848.94,-11096.98 2340.94,-11096.98 2340.94,-11096.98 2346.94,-11096.98 2352.94,-11102.98 2352.94,-11108.98 2352.94,-11108.98 2352.94,-11208.98 2352.94,-11208.98 2352.94,-11214.98 2346.94,-11220.98 2340.94,-11220.98 2340.94,-11220.98 1848.94,-11220.98 1848.94,-11220.98 1842.94,-11220.98 1836.94,-11214.98 1836.94,-11208.98 1836.94,-11208.98 1836.94,-11108.98 1836.94,-11108.98 1836.94,-11102.98 1842.94,-11096.98 1848.94,-11096.98"/>
<text text-anchor="middle" x="2094.94" y="-11204.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust45" class="cluster">
<title>cluster_expert_4_62</title>
<path fill="none" stroke="black" d="M1324.94,-11096.98C1324.94,-11096.98 1816.94,-11096.98 1816.94,-11096.98 1822.94,-11096.98 1828.94,-11102.98 1828.94,-11108.98 1828.94,-11108.98 1828.94,-11208.98 1828.94,-11208.98 1828.94,-11214.98 1822.94,-11220.98 1816.94,-11220.98 1816.94,-11220.98 1324.94,-11220.98 1324.94,-11220.98 1318.94,-11220.98 1312.94,-11214.98 1312.94,-11208.98 1312.94,-11208.98 1312.94,-11108.98 1312.94,-11108.98 1312.94,-11102.98 1318.94,-11096.98 1324.94,-11096.98"/>
<text text-anchor="middle" x="1570.94" y="-11204.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_expert_4_63</title>
<path fill="none" stroke="black" d="M800.94,-11096.98C800.94,-11096.98 1292.94,-11096.98 1292.94,-11096.98 1298.94,-11096.98 1304.94,-11102.98 1304.94,-11108.98 1304.94,-11108.98 1304.94,-11208.98 1304.94,-11208.98 1304.94,-11214.98 1298.94,-11220.98 1292.94,-11220.98 1292.94,-11220.98 800.94,-11220.98 800.94,-11220.98 794.94,-11220.98 788.94,-11214.98 788.94,-11208.98 788.94,-11208.98 788.94,-11108.98 788.94,-11108.98 788.94,-11102.98 794.94,-11096.98 800.94,-11096.98"/>
<text text-anchor="middle" x="1046.94" y="-11204.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust47" class="cluster">
<title>cluster_layer_5</title>
<path fill="none" stroke="black" d="M34.94,-10025.98C34.94,-10025.98 3928.94,-10025.98 3928.94,-10025.98 3934.94,-10025.98 3940.94,-10031.98 3940.94,-10037.98 3940.94,-10037.98 3940.94,-10999.98 3940.94,-10999.98 3940.94,-11005.98 3934.94,-11011.98 3928.94,-11011.98 3928.94,-11011.98 34.94,-11011.98 34.94,-11011.98 28.94,-11011.98 22.94,-11005.98 22.94,-10999.98 22.94,-10999.98 22.94,-10037.98 22.94,-10037.98 22.94,-10031.98 28.94,-10025.98 34.94,-10025.98"/>
<text text-anchor="middle" x="1981.94" y="-10995.18" font-family="Arial Bold" font-size="16.00">Layer 5</text>
</g>
<g id="clust48" class="cluster">
<title>cluster_mha_5</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-10455.98 226.94,-10928.98 679.94,-10928.98 679.94,-10455.98 226.94,-10455.98"/>
<text text-anchor="middle" x="453.44" y="-10912.18" font-family="Arial Bold" font-size="16.00">MHA Layer 5 (TP=2)</text>
</g>
<g id="clust49" class="cluster">
<title>cluster_moe_5</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-10094.98 30.94,-10260.98 3932.94,-10260.98 3932.94,-10094.98 30.94,-10094.98"/>
<text text-anchor="middle" x="1981.94" y="-10244.18" font-family="Arial Bold" font-size="16.00">MoE Layer 5 (EP=64, TP=2)</text>
</g>
<g id="clust50" class="cluster">
<title>cluster_expert_5_0</title>
<path fill="none" stroke="black" d="M3420.94,-10102.98C3420.94,-10102.98 3912.94,-10102.98 3912.94,-10102.98 3918.94,-10102.98 3924.94,-10108.98 3924.94,-10114.98 3924.94,-10114.98 3924.94,-10214.98 3924.94,-10214.98 3924.94,-10220.98 3918.94,-10226.98 3912.94,-10226.98 3912.94,-10226.98 3420.94,-10226.98 3420.94,-10226.98 3414.94,-10226.98 3408.94,-10220.98 3408.94,-10214.98 3408.94,-10214.98 3408.94,-10114.98 3408.94,-10114.98 3408.94,-10108.98 3414.94,-10102.98 3420.94,-10102.98"/>
<text text-anchor="middle" x="3666.94" y="-10210.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_expert_5_1</title>
<path fill="none" stroke="black" d="M2896.94,-10102.98C2896.94,-10102.98 3388.94,-10102.98 3388.94,-10102.98 3394.94,-10102.98 3400.94,-10108.98 3400.94,-10114.98 3400.94,-10114.98 3400.94,-10214.98 3400.94,-10214.98 3400.94,-10220.98 3394.94,-10226.98 3388.94,-10226.98 3388.94,-10226.98 2896.94,-10226.98 2896.94,-10226.98 2890.94,-10226.98 2884.94,-10220.98 2884.94,-10214.98 2884.94,-10214.98 2884.94,-10114.98 2884.94,-10114.98 2884.94,-10108.98 2890.94,-10102.98 2896.94,-10102.98"/>
<text text-anchor="middle" x="3142.94" y="-10210.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust52" class="cluster">
<title>cluster_expert_5_2</title>
<path fill="none" stroke="black" d="M2372.94,-10102.98C2372.94,-10102.98 2864.94,-10102.98 2864.94,-10102.98 2870.94,-10102.98 2876.94,-10108.98 2876.94,-10114.98 2876.94,-10114.98 2876.94,-10214.98 2876.94,-10214.98 2876.94,-10220.98 2870.94,-10226.98 2864.94,-10226.98 2864.94,-10226.98 2372.94,-10226.98 2372.94,-10226.98 2366.94,-10226.98 2360.94,-10220.98 2360.94,-10214.98 2360.94,-10214.98 2360.94,-10114.98 2360.94,-10114.98 2360.94,-10108.98 2366.94,-10102.98 2372.94,-10102.98"/>
<text text-anchor="middle" x="2618.94" y="-10210.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust53" class="cluster">
<title>cluster_expert_5_3</title>
<path fill="none" stroke="black" d="M1848.94,-10102.98C1848.94,-10102.98 2340.94,-10102.98 2340.94,-10102.98 2346.94,-10102.98 2352.94,-10108.98 2352.94,-10114.98 2352.94,-10114.98 2352.94,-10214.98 2352.94,-10214.98 2352.94,-10220.98 2346.94,-10226.98 2340.94,-10226.98 2340.94,-10226.98 1848.94,-10226.98 1848.94,-10226.98 1842.94,-10226.98 1836.94,-10220.98 1836.94,-10214.98 1836.94,-10214.98 1836.94,-10114.98 1836.94,-10114.98 1836.94,-10108.98 1842.94,-10102.98 1848.94,-10102.98"/>
<text text-anchor="middle" x="2094.94" y="-10210.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust54" class="cluster">
<title>cluster_expert_5_62</title>
<path fill="none" stroke="black" d="M1324.94,-10102.98C1324.94,-10102.98 1816.94,-10102.98 1816.94,-10102.98 1822.94,-10102.98 1828.94,-10108.98 1828.94,-10114.98 1828.94,-10114.98 1828.94,-10214.98 1828.94,-10214.98 1828.94,-10220.98 1822.94,-10226.98 1816.94,-10226.98 1816.94,-10226.98 1324.94,-10226.98 1324.94,-10226.98 1318.94,-10226.98 1312.94,-10220.98 1312.94,-10214.98 1312.94,-10214.98 1312.94,-10114.98 1312.94,-10114.98 1312.94,-10108.98 1318.94,-10102.98 1324.94,-10102.98"/>
<text text-anchor="middle" x="1570.94" y="-10210.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust55" class="cluster">
<title>cluster_expert_5_63</title>
<path fill="none" stroke="black" d="M800.94,-10102.98C800.94,-10102.98 1292.94,-10102.98 1292.94,-10102.98 1298.94,-10102.98 1304.94,-10108.98 1304.94,-10114.98 1304.94,-10114.98 1304.94,-10214.98 1304.94,-10214.98 1304.94,-10220.98 1298.94,-10226.98 1292.94,-10226.98 1292.94,-10226.98 800.94,-10226.98 800.94,-10226.98 794.94,-10226.98 788.94,-10220.98 788.94,-10214.98 788.94,-10214.98 788.94,-10114.98 788.94,-10114.98 788.94,-10108.98 794.94,-10102.98 800.94,-10102.98"/>
<text text-anchor="middle" x="1046.94" y="-10210.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_layer_6</title>
<path fill="none" stroke="black" d="M34.94,-9031.98C34.94,-9031.98 3928.94,-9031.98 3928.94,-9031.98 3934.94,-9031.98 3940.94,-9037.98 3940.94,-9043.98 3940.94,-9043.98 3940.94,-10005.98 3940.94,-10005.98 3940.94,-10011.98 3934.94,-10017.98 3928.94,-10017.98 3928.94,-10017.98 34.94,-10017.98 34.94,-10017.98 28.94,-10017.98 22.94,-10011.98 22.94,-10005.98 22.94,-10005.98 22.94,-9043.98 22.94,-9043.98 22.94,-9037.98 28.94,-9031.98 34.94,-9031.98"/>
<text text-anchor="middle" x="1981.94" y="-10001.18" font-family="Arial Bold" font-size="16.00">Layer 6</text>
</g>
<g id="clust57" class="cluster">
<title>cluster_mha_6</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-9461.98 226.94,-9934.98 679.94,-9934.98 679.94,-9461.98 226.94,-9461.98"/>
<text text-anchor="middle" x="453.44" y="-9918.18" font-family="Arial Bold" font-size="16.00">MHA Layer 6 (TP=2)</text>
</g>
<g id="clust58" class="cluster">
<title>cluster_moe_6</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-9100.98 30.94,-9266.98 3932.94,-9266.98 3932.94,-9100.98 30.94,-9100.98"/>
<text text-anchor="middle" x="1981.94" y="-9250.18" font-family="Arial Bold" font-size="16.00">MoE Layer 6 (EP=64, TP=2)</text>
</g>
<g id="clust59" class="cluster">
<title>cluster_expert_6_0</title>
<path fill="none" stroke="black" d="M3420.94,-9108.98C3420.94,-9108.98 3912.94,-9108.98 3912.94,-9108.98 3918.94,-9108.98 3924.94,-9114.98 3924.94,-9120.98 3924.94,-9120.98 3924.94,-9220.98 3924.94,-9220.98 3924.94,-9226.98 3918.94,-9232.98 3912.94,-9232.98 3912.94,-9232.98 3420.94,-9232.98 3420.94,-9232.98 3414.94,-9232.98 3408.94,-9226.98 3408.94,-9220.98 3408.94,-9220.98 3408.94,-9120.98 3408.94,-9120.98 3408.94,-9114.98 3414.94,-9108.98 3420.94,-9108.98"/>
<text text-anchor="middle" x="3666.94" y="-9216.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust60" class="cluster">
<title>cluster_expert_6_1</title>
<path fill="none" stroke="black" d="M2896.94,-9108.98C2896.94,-9108.98 3388.94,-9108.98 3388.94,-9108.98 3394.94,-9108.98 3400.94,-9114.98 3400.94,-9120.98 3400.94,-9120.98 3400.94,-9220.98 3400.94,-9220.98 3400.94,-9226.98 3394.94,-9232.98 3388.94,-9232.98 3388.94,-9232.98 2896.94,-9232.98 2896.94,-9232.98 2890.94,-9232.98 2884.94,-9226.98 2884.94,-9220.98 2884.94,-9220.98 2884.94,-9120.98 2884.94,-9120.98 2884.94,-9114.98 2890.94,-9108.98 2896.94,-9108.98"/>
<text text-anchor="middle" x="3142.94" y="-9216.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_expert_6_2</title>
<path fill="none" stroke="black" d="M2372.94,-9108.98C2372.94,-9108.98 2864.94,-9108.98 2864.94,-9108.98 2870.94,-9108.98 2876.94,-9114.98 2876.94,-9120.98 2876.94,-9120.98 2876.94,-9220.98 2876.94,-9220.98 2876.94,-9226.98 2870.94,-9232.98 2864.94,-9232.98 2864.94,-9232.98 2372.94,-9232.98 2372.94,-9232.98 2366.94,-9232.98 2360.94,-9226.98 2360.94,-9220.98 2360.94,-9220.98 2360.94,-9120.98 2360.94,-9120.98 2360.94,-9114.98 2366.94,-9108.98 2372.94,-9108.98"/>
<text text-anchor="middle" x="2618.94" y="-9216.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust62" class="cluster">
<title>cluster_expert_6_3</title>
<path fill="none" stroke="black" d="M1848.94,-9108.98C1848.94,-9108.98 2340.94,-9108.98 2340.94,-9108.98 2346.94,-9108.98 2352.94,-9114.98 2352.94,-9120.98 2352.94,-9120.98 2352.94,-9220.98 2352.94,-9220.98 2352.94,-9226.98 2346.94,-9232.98 2340.94,-9232.98 2340.94,-9232.98 1848.94,-9232.98 1848.94,-9232.98 1842.94,-9232.98 1836.94,-9226.98 1836.94,-9220.98 1836.94,-9220.98 1836.94,-9120.98 1836.94,-9120.98 1836.94,-9114.98 1842.94,-9108.98 1848.94,-9108.98"/>
<text text-anchor="middle" x="2094.94" y="-9216.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust63" class="cluster">
<title>cluster_expert_6_62</title>
<path fill="none" stroke="black" d="M1324.94,-9108.98C1324.94,-9108.98 1816.94,-9108.98 1816.94,-9108.98 1822.94,-9108.98 1828.94,-9114.98 1828.94,-9120.98 1828.94,-9120.98 1828.94,-9220.98 1828.94,-9220.98 1828.94,-9226.98 1822.94,-9232.98 1816.94,-9232.98 1816.94,-9232.98 1324.94,-9232.98 1324.94,-9232.98 1318.94,-9232.98 1312.94,-9226.98 1312.94,-9220.98 1312.94,-9220.98 1312.94,-9120.98 1312.94,-9120.98 1312.94,-9114.98 1318.94,-9108.98 1324.94,-9108.98"/>
<text text-anchor="middle" x="1570.94" y="-9216.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust64" class="cluster">
<title>cluster_expert_6_63</title>
<path fill="none" stroke="black" d="M800.94,-9108.98C800.94,-9108.98 1292.94,-9108.98 1292.94,-9108.98 1298.94,-9108.98 1304.94,-9114.98 1304.94,-9120.98 1304.94,-9120.98 1304.94,-9220.98 1304.94,-9220.98 1304.94,-9226.98 1298.94,-9232.98 1292.94,-9232.98 1292.94,-9232.98 800.94,-9232.98 800.94,-9232.98 794.94,-9232.98 788.94,-9226.98 788.94,-9220.98 788.94,-9220.98 788.94,-9120.98 788.94,-9120.98 788.94,-9114.98 794.94,-9108.98 800.94,-9108.98"/>
<text text-anchor="middle" x="1046.94" y="-9216.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust65" class="cluster">
<title>cluster_layer_7</title>
<path fill="none" stroke="black" d="M34.94,-8037.98C34.94,-8037.98 3928.94,-8037.98 3928.94,-8037.98 3934.94,-8037.98 3940.94,-8043.98 3940.94,-8049.98 3940.94,-8049.98 3940.94,-9011.98 3940.94,-9011.98 3940.94,-9017.98 3934.94,-9023.98 3928.94,-9023.98 3928.94,-9023.98 34.94,-9023.98 34.94,-9023.98 28.94,-9023.98 22.94,-9017.98 22.94,-9011.98 22.94,-9011.98 22.94,-8049.98 22.94,-8049.98 22.94,-8043.98 28.94,-8037.98 34.94,-8037.98"/>
<text text-anchor="middle" x="1981.94" y="-9007.18" font-family="Arial Bold" font-size="16.00">Layer 7</text>
</g>
<g id="clust66" class="cluster">
<title>cluster_mha_7</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-8467.98 226.94,-8940.98 679.94,-8940.98 679.94,-8467.98 226.94,-8467.98"/>
<text text-anchor="middle" x="453.44" y="-8924.18" font-family="Arial Bold" font-size="16.00">MHA Layer 7 (TP=2)</text>
</g>
<g id="clust67" class="cluster">
<title>cluster_moe_7</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-8106.98 30.94,-8272.98 3932.94,-8272.98 3932.94,-8106.98 30.94,-8106.98"/>
<text text-anchor="middle" x="1981.94" y="-8256.18" font-family="Arial Bold" font-size="16.00">MoE Layer 7 (EP=64, TP=2)</text>
</g>
<g id="clust68" class="cluster">
<title>cluster_expert_7_0</title>
<path fill="none" stroke="black" d="M3420.94,-8114.98C3420.94,-8114.98 3912.94,-8114.98 3912.94,-8114.98 3918.94,-8114.98 3924.94,-8120.98 3924.94,-8126.98 3924.94,-8126.98 3924.94,-8226.98 3924.94,-8226.98 3924.94,-8232.98 3918.94,-8238.98 3912.94,-8238.98 3912.94,-8238.98 3420.94,-8238.98 3420.94,-8238.98 3414.94,-8238.98 3408.94,-8232.98 3408.94,-8226.98 3408.94,-8226.98 3408.94,-8126.98 3408.94,-8126.98 3408.94,-8120.98 3414.94,-8114.98 3420.94,-8114.98"/>
<text text-anchor="middle" x="3666.94" y="-8222.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust69" class="cluster">
<title>cluster_expert_7_1</title>
<path fill="none" stroke="black" d="M2896.94,-8114.98C2896.94,-8114.98 3388.94,-8114.98 3388.94,-8114.98 3394.94,-8114.98 3400.94,-8120.98 3400.94,-8126.98 3400.94,-8126.98 3400.94,-8226.98 3400.94,-8226.98 3400.94,-8232.98 3394.94,-8238.98 3388.94,-8238.98 3388.94,-8238.98 2896.94,-8238.98 2896.94,-8238.98 2890.94,-8238.98 2884.94,-8232.98 2884.94,-8226.98 2884.94,-8226.98 2884.94,-8126.98 2884.94,-8126.98 2884.94,-8120.98 2890.94,-8114.98 2896.94,-8114.98"/>
<text text-anchor="middle" x="3142.94" y="-8222.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust70" class="cluster">
<title>cluster_expert_7_2</title>
<path fill="none" stroke="black" d="M2372.94,-8114.98C2372.94,-8114.98 2864.94,-8114.98 2864.94,-8114.98 2870.94,-8114.98 2876.94,-8120.98 2876.94,-8126.98 2876.94,-8126.98 2876.94,-8226.98 2876.94,-8226.98 2876.94,-8232.98 2870.94,-8238.98 2864.94,-8238.98 2864.94,-8238.98 2372.94,-8238.98 2372.94,-8238.98 2366.94,-8238.98 2360.94,-8232.98 2360.94,-8226.98 2360.94,-8226.98 2360.94,-8126.98 2360.94,-8126.98 2360.94,-8120.98 2366.94,-8114.98 2372.94,-8114.98"/>
<text text-anchor="middle" x="2618.94" y="-8222.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust71" class="cluster">
<title>cluster_expert_7_3</title>
<path fill="none" stroke="black" d="M1848.94,-8114.98C1848.94,-8114.98 2340.94,-8114.98 2340.94,-8114.98 2346.94,-8114.98 2352.94,-8120.98 2352.94,-8126.98 2352.94,-8126.98 2352.94,-8226.98 2352.94,-8226.98 2352.94,-8232.98 2346.94,-8238.98 2340.94,-8238.98 2340.94,-8238.98 1848.94,-8238.98 1848.94,-8238.98 1842.94,-8238.98 1836.94,-8232.98 1836.94,-8226.98 1836.94,-8226.98 1836.94,-8126.98 1836.94,-8126.98 1836.94,-8120.98 1842.94,-8114.98 1848.94,-8114.98"/>
<text text-anchor="middle" x="2094.94" y="-8222.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust72" class="cluster">
<title>cluster_expert_7_62</title>
<path fill="none" stroke="black" d="M1324.94,-8114.98C1324.94,-8114.98 1816.94,-8114.98 1816.94,-8114.98 1822.94,-8114.98 1828.94,-8120.98 1828.94,-8126.98 1828.94,-8126.98 1828.94,-8226.98 1828.94,-8226.98 1828.94,-8232.98 1822.94,-8238.98 1816.94,-8238.98 1816.94,-8238.98 1324.94,-8238.98 1324.94,-8238.98 1318.94,-8238.98 1312.94,-8232.98 1312.94,-8226.98 1312.94,-8226.98 1312.94,-8126.98 1312.94,-8126.98 1312.94,-8120.98 1318.94,-8114.98 1324.94,-8114.98"/>
<text text-anchor="middle" x="1570.94" y="-8222.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust73" class="cluster">
<title>cluster_expert_7_63</title>
<path fill="none" stroke="black" d="M800.94,-8114.98C800.94,-8114.98 1292.94,-8114.98 1292.94,-8114.98 1298.94,-8114.98 1304.94,-8120.98 1304.94,-8126.98 1304.94,-8126.98 1304.94,-8226.98 1304.94,-8226.98 1304.94,-8232.98 1298.94,-8238.98 1292.94,-8238.98 1292.94,-8238.98 800.94,-8238.98 800.94,-8238.98 794.94,-8238.98 788.94,-8232.98 788.94,-8226.98 788.94,-8226.98 788.94,-8126.98 788.94,-8126.98 788.94,-8120.98 794.94,-8114.98 800.94,-8114.98"/>
<text text-anchor="middle" x="1046.94" y="-8222.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust74" class="cluster">
<title>cluster_layer_8</title>
<path fill="none" stroke="black" d="M34.94,-7043.98C34.94,-7043.98 3928.94,-7043.98 3928.94,-7043.98 3934.94,-7043.98 3940.94,-7049.98 3940.94,-7055.98 3940.94,-7055.98 3940.94,-8017.98 3940.94,-8017.98 3940.94,-8023.98 3934.94,-8029.98 3928.94,-8029.98 3928.94,-8029.98 34.94,-8029.98 34.94,-8029.98 28.94,-8029.98 22.94,-8023.98 22.94,-8017.98 22.94,-8017.98 22.94,-7055.98 22.94,-7055.98 22.94,-7049.98 28.94,-7043.98 34.94,-7043.98"/>
<text text-anchor="middle" x="1981.94" y="-8013.18" font-family="Arial Bold" font-size="16.00">Layer 8</text>
</g>
<g id="clust75" class="cluster">
<title>cluster_mha_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-7473.98 226.94,-7946.98 679.94,-7946.98 679.94,-7473.98 226.94,-7473.98"/>
<text text-anchor="middle" x="453.44" y="-7930.18" font-family="Arial Bold" font-size="16.00">MHA Layer 8 (TP=2)</text>
</g>
<g id="clust76" class="cluster">
<title>cluster_moe_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-7112.98 30.94,-7278.98 3932.94,-7278.98 3932.94,-7112.98 30.94,-7112.98"/>
<text text-anchor="middle" x="1981.94" y="-7262.18" font-family="Arial Bold" font-size="16.00">MoE Layer 8 (EP=64, TP=2)</text>
</g>
<g id="clust77" class="cluster">
<title>cluster_expert_8_0</title>
<path fill="none" stroke="black" d="M3420.94,-7120.98C3420.94,-7120.98 3912.94,-7120.98 3912.94,-7120.98 3918.94,-7120.98 3924.94,-7126.98 3924.94,-7132.98 3924.94,-7132.98 3924.94,-7232.98 3924.94,-7232.98 3924.94,-7238.98 3918.94,-7244.98 3912.94,-7244.98 3912.94,-7244.98 3420.94,-7244.98 3420.94,-7244.98 3414.94,-7244.98 3408.94,-7238.98 3408.94,-7232.98 3408.94,-7232.98 3408.94,-7132.98 3408.94,-7132.98 3408.94,-7126.98 3414.94,-7120.98 3420.94,-7120.98"/>
<text text-anchor="middle" x="3666.94" y="-7228.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust78" class="cluster">
<title>cluster_expert_8_1</title>
<path fill="none" stroke="black" d="M2896.94,-7120.98C2896.94,-7120.98 3388.94,-7120.98 3388.94,-7120.98 3394.94,-7120.98 3400.94,-7126.98 3400.94,-7132.98 3400.94,-7132.98 3400.94,-7232.98 3400.94,-7232.98 3400.94,-7238.98 3394.94,-7244.98 3388.94,-7244.98 3388.94,-7244.98 2896.94,-7244.98 2896.94,-7244.98 2890.94,-7244.98 2884.94,-7238.98 2884.94,-7232.98 2884.94,-7232.98 2884.94,-7132.98 2884.94,-7132.98 2884.94,-7126.98 2890.94,-7120.98 2896.94,-7120.98"/>
<text text-anchor="middle" x="3142.94" y="-7228.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust79" class="cluster">
<title>cluster_expert_8_2</title>
<path fill="none" stroke="black" d="M2372.94,-7120.98C2372.94,-7120.98 2864.94,-7120.98 2864.94,-7120.98 2870.94,-7120.98 2876.94,-7126.98 2876.94,-7132.98 2876.94,-7132.98 2876.94,-7232.98 2876.94,-7232.98 2876.94,-7238.98 2870.94,-7244.98 2864.94,-7244.98 2864.94,-7244.98 2372.94,-7244.98 2372.94,-7244.98 2366.94,-7244.98 2360.94,-7238.98 2360.94,-7232.98 2360.94,-7232.98 2360.94,-7132.98 2360.94,-7132.98 2360.94,-7126.98 2366.94,-7120.98 2372.94,-7120.98"/>
<text text-anchor="middle" x="2618.94" y="-7228.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust80" class="cluster">
<title>cluster_expert_8_3</title>
<path fill="none" stroke="black" d="M1848.94,-7120.98C1848.94,-7120.98 2340.94,-7120.98 2340.94,-7120.98 2346.94,-7120.98 2352.94,-7126.98 2352.94,-7132.98 2352.94,-7132.98 2352.94,-7232.98 2352.94,-7232.98 2352.94,-7238.98 2346.94,-7244.98 2340.94,-7244.98 2340.94,-7244.98 1848.94,-7244.98 1848.94,-7244.98 1842.94,-7244.98 1836.94,-7238.98 1836.94,-7232.98 1836.94,-7232.98 1836.94,-7132.98 1836.94,-7132.98 1836.94,-7126.98 1842.94,-7120.98 1848.94,-7120.98"/>
<text text-anchor="middle" x="2094.94" y="-7228.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust81" class="cluster">
<title>cluster_expert_8_62</title>
<path fill="none" stroke="black" d="M1324.94,-7120.98C1324.94,-7120.98 1816.94,-7120.98 1816.94,-7120.98 1822.94,-7120.98 1828.94,-7126.98 1828.94,-7132.98 1828.94,-7132.98 1828.94,-7232.98 1828.94,-7232.98 1828.94,-7238.98 1822.94,-7244.98 1816.94,-7244.98 1816.94,-7244.98 1324.94,-7244.98 1324.94,-7244.98 1318.94,-7244.98 1312.94,-7238.98 1312.94,-7232.98 1312.94,-7232.98 1312.94,-7132.98 1312.94,-7132.98 1312.94,-7126.98 1318.94,-7120.98 1324.94,-7120.98"/>
<text text-anchor="middle" x="1570.94" y="-7228.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust82" class="cluster">
<title>cluster_expert_8_63</title>
<path fill="none" stroke="black" d="M800.94,-7120.98C800.94,-7120.98 1292.94,-7120.98 1292.94,-7120.98 1298.94,-7120.98 1304.94,-7126.98 1304.94,-7132.98 1304.94,-7132.98 1304.94,-7232.98 1304.94,-7232.98 1304.94,-7238.98 1298.94,-7244.98 1292.94,-7244.98 1292.94,-7244.98 800.94,-7244.98 800.94,-7244.98 794.94,-7244.98 788.94,-7238.98 788.94,-7232.98 788.94,-7232.98 788.94,-7132.98 788.94,-7132.98 788.94,-7126.98 794.94,-7120.98 800.94,-7120.98"/>
<text text-anchor="middle" x="1046.94" y="-7228.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust83" class="cluster">
<title>cluster_layer_9</title>
<path fill="none" stroke="black" d="M34.94,-6049.98C34.94,-6049.98 3928.94,-6049.98 3928.94,-6049.98 3934.94,-6049.98 3940.94,-6055.98 3940.94,-6061.98 3940.94,-6061.98 3940.94,-7023.98 3940.94,-7023.98 3940.94,-7029.98 3934.94,-7035.98 3928.94,-7035.98 3928.94,-7035.98 34.94,-7035.98 34.94,-7035.98 28.94,-7035.98 22.94,-7029.98 22.94,-7023.98 22.94,-7023.98 22.94,-6061.98 22.94,-6061.98 22.94,-6055.98 28.94,-6049.98 34.94,-6049.98"/>
<text text-anchor="middle" x="1981.94" y="-7019.18" font-family="Arial Bold" font-size="16.00">Layer 9</text>
</g>
<g id="clust84" class="cluster">
<title>cluster_mha_9</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-6479.98 226.94,-6952.98 679.94,-6952.98 679.94,-6479.98 226.94,-6479.98"/>
<text text-anchor="middle" x="453.44" y="-6936.18" font-family="Arial Bold" font-size="16.00">MHA Layer 9 (TP=2)</text>
</g>
<g id="clust85" class="cluster">
<title>cluster_moe_9</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-6118.98 30.94,-6284.98 3932.94,-6284.98 3932.94,-6118.98 30.94,-6118.98"/>
<text text-anchor="middle" x="1981.94" y="-6268.18" font-family="Arial Bold" font-size="16.00">MoE Layer 9 (EP=64, TP=2)</text>
</g>
<g id="clust86" class="cluster">
<title>cluster_expert_9_0</title>
<path fill="none" stroke="black" d="M3420.94,-6126.98C3420.94,-6126.98 3912.94,-6126.98 3912.94,-6126.98 3918.94,-6126.98 3924.94,-6132.98 3924.94,-6138.98 3924.94,-6138.98 3924.94,-6238.98 3924.94,-6238.98 3924.94,-6244.98 3918.94,-6250.98 3912.94,-6250.98 3912.94,-6250.98 3420.94,-6250.98 3420.94,-6250.98 3414.94,-6250.98 3408.94,-6244.98 3408.94,-6238.98 3408.94,-6238.98 3408.94,-6138.98 3408.94,-6138.98 3408.94,-6132.98 3414.94,-6126.98 3420.94,-6126.98"/>
<text text-anchor="middle" x="3666.94" y="-6234.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust87" class="cluster">
<title>cluster_expert_9_1</title>
<path fill="none" stroke="black" d="M2896.94,-6126.98C2896.94,-6126.98 3388.94,-6126.98 3388.94,-6126.98 3394.94,-6126.98 3400.94,-6132.98 3400.94,-6138.98 3400.94,-6138.98 3400.94,-6238.98 3400.94,-6238.98 3400.94,-6244.98 3394.94,-6250.98 3388.94,-6250.98 3388.94,-6250.98 2896.94,-6250.98 2896.94,-6250.98 2890.94,-6250.98 2884.94,-6244.98 2884.94,-6238.98 2884.94,-6238.98 2884.94,-6138.98 2884.94,-6138.98 2884.94,-6132.98 2890.94,-6126.98 2896.94,-6126.98"/>
<text text-anchor="middle" x="3142.94" y="-6234.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust88" class="cluster">
<title>cluster_expert_9_2</title>
<path fill="none" stroke="black" d="M2372.94,-6126.98C2372.94,-6126.98 2864.94,-6126.98 2864.94,-6126.98 2870.94,-6126.98 2876.94,-6132.98 2876.94,-6138.98 2876.94,-6138.98 2876.94,-6238.98 2876.94,-6238.98 2876.94,-6244.98 2870.94,-6250.98 2864.94,-6250.98 2864.94,-6250.98 2372.94,-6250.98 2372.94,-6250.98 2366.94,-6250.98 2360.94,-6244.98 2360.94,-6238.98 2360.94,-6238.98 2360.94,-6138.98 2360.94,-6138.98 2360.94,-6132.98 2366.94,-6126.98 2372.94,-6126.98"/>
<text text-anchor="middle" x="2618.94" y="-6234.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust89" class="cluster">
<title>cluster_expert_9_3</title>
<path fill="none" stroke="black" d="M1848.94,-6126.98C1848.94,-6126.98 2340.94,-6126.98 2340.94,-6126.98 2346.94,-6126.98 2352.94,-6132.98 2352.94,-6138.98 2352.94,-6138.98 2352.94,-6238.98 2352.94,-6238.98 2352.94,-6244.98 2346.94,-6250.98 2340.94,-6250.98 2340.94,-6250.98 1848.94,-6250.98 1848.94,-6250.98 1842.94,-6250.98 1836.94,-6244.98 1836.94,-6238.98 1836.94,-6238.98 1836.94,-6138.98 1836.94,-6138.98 1836.94,-6132.98 1842.94,-6126.98 1848.94,-6126.98"/>
<text text-anchor="middle" x="2094.94" y="-6234.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust90" class="cluster">
<title>cluster_expert_9_62</title>
<path fill="none" stroke="black" d="M1324.94,-6126.98C1324.94,-6126.98 1816.94,-6126.98 1816.94,-6126.98 1822.94,-6126.98 1828.94,-6132.98 1828.94,-6138.98 1828.94,-6138.98 1828.94,-6238.98 1828.94,-6238.98 1828.94,-6244.98 1822.94,-6250.98 1816.94,-6250.98 1816.94,-6250.98 1324.94,-6250.98 1324.94,-6250.98 1318.94,-6250.98 1312.94,-6244.98 1312.94,-6238.98 1312.94,-6238.98 1312.94,-6138.98 1312.94,-6138.98 1312.94,-6132.98 1318.94,-6126.98 1324.94,-6126.98"/>
<text text-anchor="middle" x="1570.94" y="-6234.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust91" class="cluster">
<title>cluster_expert_9_63</title>
<path fill="none" stroke="black" d="M800.94,-6126.98C800.94,-6126.98 1292.94,-6126.98 1292.94,-6126.98 1298.94,-6126.98 1304.94,-6132.98 1304.94,-6138.98 1304.94,-6138.98 1304.94,-6238.98 1304.94,-6238.98 1304.94,-6244.98 1298.94,-6250.98 1292.94,-6250.98 1292.94,-6250.98 800.94,-6250.98 800.94,-6250.98 794.94,-6250.98 788.94,-6244.98 788.94,-6238.98 788.94,-6238.98 788.94,-6138.98 788.94,-6138.98 788.94,-6132.98 794.94,-6126.98 800.94,-6126.98"/>
<text text-anchor="middle" x="1046.94" y="-6234.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust92" class="cluster">
<title>cluster_layer_10</title>
<path fill="none" stroke="black" d="M34.94,-5055.98C34.94,-5055.98 3928.94,-5055.98 3928.94,-5055.98 3934.94,-5055.98 3940.94,-5061.98 3940.94,-5067.98 3940.94,-5067.98 3940.94,-6029.98 3940.94,-6029.98 3940.94,-6035.98 3934.94,-6041.98 3928.94,-6041.98 3928.94,-6041.98 34.94,-6041.98 34.94,-6041.98 28.94,-6041.98 22.94,-6035.98 22.94,-6029.98 22.94,-6029.98 22.94,-5067.98 22.94,-5067.98 22.94,-5061.98 28.94,-5055.98 34.94,-5055.98"/>
<text text-anchor="middle" x="1981.94" y="-6025.18" font-family="Arial Bold" font-size="16.00">Layer 10</text>
</g>
<g id="clust93" class="cluster">
<title>cluster_mha_10</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-5485.98 226.94,-5958.98 679.94,-5958.98 679.94,-5485.98 226.94,-5485.98"/>
<text text-anchor="middle" x="453.44" y="-5942.18" font-family="Arial Bold" font-size="16.00">MHA Layer 10 (TP=2)</text>
</g>
<g id="clust94" class="cluster">
<title>cluster_moe_10</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-5124.98 30.94,-5290.98 3932.94,-5290.98 3932.94,-5124.98 30.94,-5124.98"/>
<text text-anchor="middle" x="1981.94" y="-5274.18" font-family="Arial Bold" font-size="16.00">MoE Layer 10 (EP=64, TP=2)</text>
</g>
<g id="clust95" class="cluster">
<title>cluster_expert_10_0</title>
<path fill="none" stroke="black" d="M3420.94,-5132.98C3420.94,-5132.98 3912.94,-5132.98 3912.94,-5132.98 3918.94,-5132.98 3924.94,-5138.98 3924.94,-5144.98 3924.94,-5144.98 3924.94,-5244.98 3924.94,-5244.98 3924.94,-5250.98 3918.94,-5256.98 3912.94,-5256.98 3912.94,-5256.98 3420.94,-5256.98 3420.94,-5256.98 3414.94,-5256.98 3408.94,-5250.98 3408.94,-5244.98 3408.94,-5244.98 3408.94,-5144.98 3408.94,-5144.98 3408.94,-5138.98 3414.94,-5132.98 3420.94,-5132.98"/>
<text text-anchor="middle" x="3666.94" y="-5240.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust96" class="cluster">
<title>cluster_expert_10_1</title>
<path fill="none" stroke="black" d="M2896.94,-5132.98C2896.94,-5132.98 3388.94,-5132.98 3388.94,-5132.98 3394.94,-5132.98 3400.94,-5138.98 3400.94,-5144.98 3400.94,-5144.98 3400.94,-5244.98 3400.94,-5244.98 3400.94,-5250.98 3394.94,-5256.98 3388.94,-5256.98 3388.94,-5256.98 2896.94,-5256.98 2896.94,-5256.98 2890.94,-5256.98 2884.94,-5250.98 2884.94,-5244.98 2884.94,-5244.98 2884.94,-5144.98 2884.94,-5144.98 2884.94,-5138.98 2890.94,-5132.98 2896.94,-5132.98"/>
<text text-anchor="middle" x="3142.94" y="-5240.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust97" class="cluster">
<title>cluster_expert_10_2</title>
<path fill="none" stroke="black" d="M2372.94,-5132.98C2372.94,-5132.98 2864.94,-5132.98 2864.94,-5132.98 2870.94,-5132.98 2876.94,-5138.98 2876.94,-5144.98 2876.94,-5144.98 2876.94,-5244.98 2876.94,-5244.98 2876.94,-5250.98 2870.94,-5256.98 2864.94,-5256.98 2864.94,-5256.98 2372.94,-5256.98 2372.94,-5256.98 2366.94,-5256.98 2360.94,-5250.98 2360.94,-5244.98 2360.94,-5244.98 2360.94,-5144.98 2360.94,-5144.98 2360.94,-5138.98 2366.94,-5132.98 2372.94,-5132.98"/>
<text text-anchor="middle" x="2618.94" y="-5240.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust98" class="cluster">
<title>cluster_expert_10_3</title>
<path fill="none" stroke="black" d="M1848.94,-5132.98C1848.94,-5132.98 2340.94,-5132.98 2340.94,-5132.98 2346.94,-5132.98 2352.94,-5138.98 2352.94,-5144.98 2352.94,-5144.98 2352.94,-5244.98 2352.94,-5244.98 2352.94,-5250.98 2346.94,-5256.98 2340.94,-5256.98 2340.94,-5256.98 1848.94,-5256.98 1848.94,-5256.98 1842.94,-5256.98 1836.94,-5250.98 1836.94,-5244.98 1836.94,-5244.98 1836.94,-5144.98 1836.94,-5144.98 1836.94,-5138.98 1842.94,-5132.98 1848.94,-5132.98"/>
<text text-anchor="middle" x="2094.94" y="-5240.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust99" class="cluster">
<title>cluster_expert_10_62</title>
<path fill="none" stroke="black" d="M1324.94,-5132.98C1324.94,-5132.98 1816.94,-5132.98 1816.94,-5132.98 1822.94,-5132.98 1828.94,-5138.98 1828.94,-5144.98 1828.94,-5144.98 1828.94,-5244.98 1828.94,-5244.98 1828.94,-5250.98 1822.94,-5256.98 1816.94,-5256.98 1816.94,-5256.98 1324.94,-5256.98 1324.94,-5256.98 1318.94,-5256.98 1312.94,-5250.98 1312.94,-5244.98 1312.94,-5244.98 1312.94,-5144.98 1312.94,-5144.98 1312.94,-5138.98 1318.94,-5132.98 1324.94,-5132.98"/>
<text text-anchor="middle" x="1570.94" y="-5240.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust100" class="cluster">
<title>cluster_expert_10_63</title>
<path fill="none" stroke="black" d="M800.94,-5132.98C800.94,-5132.98 1292.94,-5132.98 1292.94,-5132.98 1298.94,-5132.98 1304.94,-5138.98 1304.94,-5144.98 1304.94,-5144.98 1304.94,-5244.98 1304.94,-5244.98 1304.94,-5250.98 1298.94,-5256.98 1292.94,-5256.98 1292.94,-5256.98 800.94,-5256.98 800.94,-5256.98 794.94,-5256.98 788.94,-5250.98 788.94,-5244.98 788.94,-5244.98 788.94,-5144.98 788.94,-5144.98 788.94,-5138.98 794.94,-5132.98 800.94,-5132.98"/>
<text text-anchor="middle" x="1046.94" y="-5240.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust101" class="cluster">
<title>cluster_layer_11</title>
<path fill="none" stroke="black" d="M34.94,-4061.98C34.94,-4061.98 3928.94,-4061.98 3928.94,-4061.98 3934.94,-4061.98 3940.94,-4067.98 3940.94,-4073.98 3940.94,-4073.98 3940.94,-5035.98 3940.94,-5035.98 3940.94,-5041.98 3934.94,-5047.98 3928.94,-5047.98 3928.94,-5047.98 34.94,-5047.98 34.94,-5047.98 28.94,-5047.98 22.94,-5041.98 22.94,-5035.98 22.94,-5035.98 22.94,-4073.98 22.94,-4073.98 22.94,-4067.98 28.94,-4061.98 34.94,-4061.98"/>
<text text-anchor="middle" x="1981.94" y="-5031.18" font-family="Arial Bold" font-size="16.00">Layer 11</text>
</g>
<g id="clust102" class="cluster">
<title>cluster_mha_11</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-4491.98 226.94,-4964.98 679.94,-4964.98 679.94,-4491.98 226.94,-4491.98"/>
<text text-anchor="middle" x="453.44" y="-4948.18" font-family="Arial Bold" font-size="16.00">MHA Layer 11 (TP=2)</text>
</g>
<g id="clust103" class="cluster">
<title>cluster_moe_11</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-4130.98 30.94,-4296.98 3932.94,-4296.98 3932.94,-4130.98 30.94,-4130.98"/>
<text text-anchor="middle" x="1981.94" y="-4280.18" font-family="Arial Bold" font-size="16.00">MoE Layer 11 (EP=64, TP=2)</text>
</g>
<g id="clust104" class="cluster">
<title>cluster_expert_11_0</title>
<path fill="none" stroke="black" d="M3420.94,-4138.98C3420.94,-4138.98 3912.94,-4138.98 3912.94,-4138.98 3918.94,-4138.98 3924.94,-4144.98 3924.94,-4150.98 3924.94,-4150.98 3924.94,-4250.98 3924.94,-4250.98 3924.94,-4256.98 3918.94,-4262.98 3912.94,-4262.98 3912.94,-4262.98 3420.94,-4262.98 3420.94,-4262.98 3414.94,-4262.98 3408.94,-4256.98 3408.94,-4250.98 3408.94,-4250.98 3408.94,-4150.98 3408.94,-4150.98 3408.94,-4144.98 3414.94,-4138.98 3420.94,-4138.98"/>
<text text-anchor="middle" x="3666.94" y="-4246.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust105" class="cluster">
<title>cluster_expert_11_1</title>
<path fill="none" stroke="black" d="M2896.94,-4138.98C2896.94,-4138.98 3388.94,-4138.98 3388.94,-4138.98 3394.94,-4138.98 3400.94,-4144.98 3400.94,-4150.98 3400.94,-4150.98 3400.94,-4250.98 3400.94,-4250.98 3400.94,-4256.98 3394.94,-4262.98 3388.94,-4262.98 3388.94,-4262.98 2896.94,-4262.98 2896.94,-4262.98 2890.94,-4262.98 2884.94,-4256.98 2884.94,-4250.98 2884.94,-4250.98 2884.94,-4150.98 2884.94,-4150.98 2884.94,-4144.98 2890.94,-4138.98 2896.94,-4138.98"/>
<text text-anchor="middle" x="3142.94" y="-4246.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust106" class="cluster">
<title>cluster_expert_11_2</title>
<path fill="none" stroke="black" d="M2372.94,-4138.98C2372.94,-4138.98 2864.94,-4138.98 2864.94,-4138.98 2870.94,-4138.98 2876.94,-4144.98 2876.94,-4150.98 2876.94,-4150.98 2876.94,-4250.98 2876.94,-4250.98 2876.94,-4256.98 2870.94,-4262.98 2864.94,-4262.98 2864.94,-4262.98 2372.94,-4262.98 2372.94,-4262.98 2366.94,-4262.98 2360.94,-4256.98 2360.94,-4250.98 2360.94,-4250.98 2360.94,-4150.98 2360.94,-4150.98 2360.94,-4144.98 2366.94,-4138.98 2372.94,-4138.98"/>
<text text-anchor="middle" x="2618.94" y="-4246.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust107" class="cluster">
<title>cluster_expert_11_3</title>
<path fill="none" stroke="black" d="M1848.94,-4138.98C1848.94,-4138.98 2340.94,-4138.98 2340.94,-4138.98 2346.94,-4138.98 2352.94,-4144.98 2352.94,-4150.98 2352.94,-4150.98 2352.94,-4250.98 2352.94,-4250.98 2352.94,-4256.98 2346.94,-4262.98 2340.94,-4262.98 2340.94,-4262.98 1848.94,-4262.98 1848.94,-4262.98 1842.94,-4262.98 1836.94,-4256.98 1836.94,-4250.98 1836.94,-4250.98 1836.94,-4150.98 1836.94,-4150.98 1836.94,-4144.98 1842.94,-4138.98 1848.94,-4138.98"/>
<text text-anchor="middle" x="2094.94" y="-4246.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust108" class="cluster">
<title>cluster_expert_11_62</title>
<path fill="none" stroke="black" d="M1324.94,-4138.98C1324.94,-4138.98 1816.94,-4138.98 1816.94,-4138.98 1822.94,-4138.98 1828.94,-4144.98 1828.94,-4150.98 1828.94,-4150.98 1828.94,-4250.98 1828.94,-4250.98 1828.94,-4256.98 1822.94,-4262.98 1816.94,-4262.98 1816.94,-4262.98 1324.94,-4262.98 1324.94,-4262.98 1318.94,-4262.98 1312.94,-4256.98 1312.94,-4250.98 1312.94,-4250.98 1312.94,-4150.98 1312.94,-4150.98 1312.94,-4144.98 1318.94,-4138.98 1324.94,-4138.98"/>
<text text-anchor="middle" x="1570.94" y="-4246.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust109" class="cluster">
<title>cluster_expert_11_63</title>
<path fill="none" stroke="black" d="M800.94,-4138.98C800.94,-4138.98 1292.94,-4138.98 1292.94,-4138.98 1298.94,-4138.98 1304.94,-4144.98 1304.94,-4150.98 1304.94,-4150.98 1304.94,-4250.98 1304.94,-4250.98 1304.94,-4256.98 1298.94,-4262.98 1292.94,-4262.98 1292.94,-4262.98 800.94,-4262.98 800.94,-4262.98 794.94,-4262.98 788.94,-4256.98 788.94,-4250.98 788.94,-4250.98 788.94,-4150.98 788.94,-4150.98 788.94,-4144.98 794.94,-4138.98 800.94,-4138.98"/>
<text text-anchor="middle" x="1046.94" y="-4246.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust110" class="cluster">
<title>cluster_layer_12</title>
<path fill="none" stroke="black" d="M34.94,-3067.98C34.94,-3067.98 3928.94,-3067.98 3928.94,-3067.98 3934.94,-3067.98 3940.94,-3073.98 3940.94,-3079.98 3940.94,-3079.98 3940.94,-4041.98 3940.94,-4041.98 3940.94,-4047.98 3934.94,-4053.98 3928.94,-4053.98 3928.94,-4053.98 34.94,-4053.98 34.94,-4053.98 28.94,-4053.98 22.94,-4047.98 22.94,-4041.98 22.94,-4041.98 22.94,-3079.98 22.94,-3079.98 22.94,-3073.98 28.94,-3067.98 34.94,-3067.98"/>
<text text-anchor="middle" x="1981.94" y="-4037.18" font-family="Arial Bold" font-size="16.00">Layer 12</text>
</g>
<g id="clust111" class="cluster">
<title>cluster_mha_12</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-3497.98 226.94,-3970.98 679.94,-3970.98 679.94,-3497.98 226.94,-3497.98"/>
<text text-anchor="middle" x="453.44" y="-3954.18" font-family="Arial Bold" font-size="16.00">MHA Layer 12 (TP=2)</text>
</g>
<g id="clust112" class="cluster">
<title>cluster_moe_12</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-3136.98 30.94,-3302.98 3932.94,-3302.98 3932.94,-3136.98 30.94,-3136.98"/>
<text text-anchor="middle" x="1981.94" y="-3286.18" font-family="Arial Bold" font-size="16.00">MoE Layer 12 (EP=64, TP=2)</text>
</g>
<g id="clust113" class="cluster">
<title>cluster_expert_12_0</title>
<path fill="none" stroke="black" d="M3420.94,-3144.98C3420.94,-3144.98 3912.94,-3144.98 3912.94,-3144.98 3918.94,-3144.98 3924.94,-3150.98 3924.94,-3156.98 3924.94,-3156.98 3924.94,-3256.98 3924.94,-3256.98 3924.94,-3262.98 3918.94,-3268.98 3912.94,-3268.98 3912.94,-3268.98 3420.94,-3268.98 3420.94,-3268.98 3414.94,-3268.98 3408.94,-3262.98 3408.94,-3256.98 3408.94,-3256.98 3408.94,-3156.98 3408.94,-3156.98 3408.94,-3150.98 3414.94,-3144.98 3420.94,-3144.98"/>
<text text-anchor="middle" x="3666.94" y="-3252.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust114" class="cluster">
<title>cluster_expert_12_1</title>
<path fill="none" stroke="black" d="M2896.94,-3144.98C2896.94,-3144.98 3388.94,-3144.98 3388.94,-3144.98 3394.94,-3144.98 3400.94,-3150.98 3400.94,-3156.98 3400.94,-3156.98 3400.94,-3256.98 3400.94,-3256.98 3400.94,-3262.98 3394.94,-3268.98 3388.94,-3268.98 3388.94,-3268.98 2896.94,-3268.98 2896.94,-3268.98 2890.94,-3268.98 2884.94,-3262.98 2884.94,-3256.98 2884.94,-3256.98 2884.94,-3156.98 2884.94,-3156.98 2884.94,-3150.98 2890.94,-3144.98 2896.94,-3144.98"/>
<text text-anchor="middle" x="3142.94" y="-3252.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust115" class="cluster">
<title>cluster_expert_12_2</title>
<path fill="none" stroke="black" d="M2372.94,-3144.98C2372.94,-3144.98 2864.94,-3144.98 2864.94,-3144.98 2870.94,-3144.98 2876.94,-3150.98 2876.94,-3156.98 2876.94,-3156.98 2876.94,-3256.98 2876.94,-3256.98 2876.94,-3262.98 2870.94,-3268.98 2864.94,-3268.98 2864.94,-3268.98 2372.94,-3268.98 2372.94,-3268.98 2366.94,-3268.98 2360.94,-3262.98 2360.94,-3256.98 2360.94,-3256.98 2360.94,-3156.98 2360.94,-3156.98 2360.94,-3150.98 2366.94,-3144.98 2372.94,-3144.98"/>
<text text-anchor="middle" x="2618.94" y="-3252.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust116" class="cluster">
<title>cluster_expert_12_3</title>
<path fill="none" stroke="black" d="M1848.94,-3144.98C1848.94,-3144.98 2340.94,-3144.98 2340.94,-3144.98 2346.94,-3144.98 2352.94,-3150.98 2352.94,-3156.98 2352.94,-3156.98 2352.94,-3256.98 2352.94,-3256.98 2352.94,-3262.98 2346.94,-3268.98 2340.94,-3268.98 2340.94,-3268.98 1848.94,-3268.98 1848.94,-3268.98 1842.94,-3268.98 1836.94,-3262.98 1836.94,-3256.98 1836.94,-3256.98 1836.94,-3156.98 1836.94,-3156.98 1836.94,-3150.98 1842.94,-3144.98 1848.94,-3144.98"/>
<text text-anchor="middle" x="2094.94" y="-3252.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust117" class="cluster">
<title>cluster_expert_12_62</title>
<path fill="none" stroke="black" d="M1324.94,-3144.98C1324.94,-3144.98 1816.94,-3144.98 1816.94,-3144.98 1822.94,-3144.98 1828.94,-3150.98 1828.94,-3156.98 1828.94,-3156.98 1828.94,-3256.98 1828.94,-3256.98 1828.94,-3262.98 1822.94,-3268.98 1816.94,-3268.98 1816.94,-3268.98 1324.94,-3268.98 1324.94,-3268.98 1318.94,-3268.98 1312.94,-3262.98 1312.94,-3256.98 1312.94,-3256.98 1312.94,-3156.98 1312.94,-3156.98 1312.94,-3150.98 1318.94,-3144.98 1324.94,-3144.98"/>
<text text-anchor="middle" x="1570.94" y="-3252.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust118" class="cluster">
<title>cluster_expert_12_63</title>
<path fill="none" stroke="black" d="M800.94,-3144.98C800.94,-3144.98 1292.94,-3144.98 1292.94,-3144.98 1298.94,-3144.98 1304.94,-3150.98 1304.94,-3156.98 1304.94,-3156.98 1304.94,-3256.98 1304.94,-3256.98 1304.94,-3262.98 1298.94,-3268.98 1292.94,-3268.98 1292.94,-3268.98 800.94,-3268.98 800.94,-3268.98 794.94,-3268.98 788.94,-3262.98 788.94,-3256.98 788.94,-3256.98 788.94,-3156.98 788.94,-3156.98 788.94,-3150.98 794.94,-3144.98 800.94,-3144.98"/>
<text text-anchor="middle" x="1046.94" y="-3252.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust119" class="cluster">
<title>cluster_layer_13</title>
<path fill="none" stroke="black" d="M34.94,-2073.98C34.94,-2073.98 3928.94,-2073.98 3928.94,-2073.98 3934.94,-2073.98 3940.94,-2079.98 3940.94,-2085.98 3940.94,-2085.98 3940.94,-3047.98 3940.94,-3047.98 3940.94,-3053.98 3934.94,-3059.98 3928.94,-3059.98 3928.94,-3059.98 34.94,-3059.98 34.94,-3059.98 28.94,-3059.98 22.94,-3053.98 22.94,-3047.98 22.94,-3047.98 22.94,-2085.98 22.94,-2085.98 22.94,-2079.98 28.94,-2073.98 34.94,-2073.98"/>
<text text-anchor="middle" x="1981.94" y="-3043.18" font-family="Arial Bold" font-size="16.00">Layer 13</text>
</g>
<g id="clust120" class="cluster">
<title>cluster_mha_13</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-2503.98 226.94,-2976.98 679.94,-2976.98 679.94,-2503.98 226.94,-2503.98"/>
<text text-anchor="middle" x="453.44" y="-2960.18" font-family="Arial Bold" font-size="16.00">MHA Layer 13 (TP=2)</text>
</g>
<g id="clust121" class="cluster">
<title>cluster_moe_13</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-2142.98 30.94,-2308.98 3932.94,-2308.98 3932.94,-2142.98 30.94,-2142.98"/>
<text text-anchor="middle" x="1981.94" y="-2292.18" font-family="Arial Bold" font-size="16.00">MoE Layer 13 (EP=64, TP=2)</text>
</g>
<g id="clust122" class="cluster">
<title>cluster_expert_13_0</title>
<path fill="none" stroke="black" d="M3420.94,-2150.98C3420.94,-2150.98 3912.94,-2150.98 3912.94,-2150.98 3918.94,-2150.98 3924.94,-2156.98 3924.94,-2162.98 3924.94,-2162.98 3924.94,-2262.98 3924.94,-2262.98 3924.94,-2268.98 3918.94,-2274.98 3912.94,-2274.98 3912.94,-2274.98 3420.94,-2274.98 3420.94,-2274.98 3414.94,-2274.98 3408.94,-2268.98 3408.94,-2262.98 3408.94,-2262.98 3408.94,-2162.98 3408.94,-2162.98 3408.94,-2156.98 3414.94,-2150.98 3420.94,-2150.98"/>
<text text-anchor="middle" x="3666.94" y="-2258.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust123" class="cluster">
<title>cluster_expert_13_1</title>
<path fill="none" stroke="black" d="M2896.94,-2150.98C2896.94,-2150.98 3388.94,-2150.98 3388.94,-2150.98 3394.94,-2150.98 3400.94,-2156.98 3400.94,-2162.98 3400.94,-2162.98 3400.94,-2262.98 3400.94,-2262.98 3400.94,-2268.98 3394.94,-2274.98 3388.94,-2274.98 3388.94,-2274.98 2896.94,-2274.98 2896.94,-2274.98 2890.94,-2274.98 2884.94,-2268.98 2884.94,-2262.98 2884.94,-2262.98 2884.94,-2162.98 2884.94,-2162.98 2884.94,-2156.98 2890.94,-2150.98 2896.94,-2150.98"/>
<text text-anchor="middle" x="3142.94" y="-2258.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust124" class="cluster">
<title>cluster_expert_13_2</title>
<path fill="none" stroke="black" d="M2372.94,-2150.98C2372.94,-2150.98 2864.94,-2150.98 2864.94,-2150.98 2870.94,-2150.98 2876.94,-2156.98 2876.94,-2162.98 2876.94,-2162.98 2876.94,-2262.98 2876.94,-2262.98 2876.94,-2268.98 2870.94,-2274.98 2864.94,-2274.98 2864.94,-2274.98 2372.94,-2274.98 2372.94,-2274.98 2366.94,-2274.98 2360.94,-2268.98 2360.94,-2262.98 2360.94,-2262.98 2360.94,-2162.98 2360.94,-2162.98 2360.94,-2156.98 2366.94,-2150.98 2372.94,-2150.98"/>
<text text-anchor="middle" x="2618.94" y="-2258.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust125" class="cluster">
<title>cluster_expert_13_3</title>
<path fill="none" stroke="black" d="M1848.94,-2150.98C1848.94,-2150.98 2340.94,-2150.98 2340.94,-2150.98 2346.94,-2150.98 2352.94,-2156.98 2352.94,-2162.98 2352.94,-2162.98 2352.94,-2262.98 2352.94,-2262.98 2352.94,-2268.98 2346.94,-2274.98 2340.94,-2274.98 2340.94,-2274.98 1848.94,-2274.98 1848.94,-2274.98 1842.94,-2274.98 1836.94,-2268.98 1836.94,-2262.98 1836.94,-2262.98 1836.94,-2162.98 1836.94,-2162.98 1836.94,-2156.98 1842.94,-2150.98 1848.94,-2150.98"/>
<text text-anchor="middle" x="2094.94" y="-2258.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust126" class="cluster">
<title>cluster_expert_13_62</title>
<path fill="none" stroke="black" d="M1324.94,-2150.98C1324.94,-2150.98 1816.94,-2150.98 1816.94,-2150.98 1822.94,-2150.98 1828.94,-2156.98 1828.94,-2162.98 1828.94,-2162.98 1828.94,-2262.98 1828.94,-2262.98 1828.94,-2268.98 1822.94,-2274.98 1816.94,-2274.98 1816.94,-2274.98 1324.94,-2274.98 1324.94,-2274.98 1318.94,-2274.98 1312.94,-2268.98 1312.94,-2262.98 1312.94,-2262.98 1312.94,-2162.98 1312.94,-2162.98 1312.94,-2156.98 1318.94,-2150.98 1324.94,-2150.98"/>
<text text-anchor="middle" x="1570.94" y="-2258.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust127" class="cluster">
<title>cluster_expert_13_63</title>
<path fill="none" stroke="black" d="M800.94,-2150.98C800.94,-2150.98 1292.94,-2150.98 1292.94,-2150.98 1298.94,-2150.98 1304.94,-2156.98 1304.94,-2162.98 1304.94,-2162.98 1304.94,-2262.98 1304.94,-2262.98 1304.94,-2268.98 1298.94,-2274.98 1292.94,-2274.98 1292.94,-2274.98 800.94,-2274.98 800.94,-2274.98 794.94,-2274.98 788.94,-2268.98 788.94,-2262.98 788.94,-2262.98 788.94,-2162.98 788.94,-2162.98 788.94,-2156.98 794.94,-2150.98 800.94,-2150.98"/>
<text text-anchor="middle" x="1046.94" y="-2258.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust128" class="cluster">
<title>cluster_layer_14</title>
<path fill="none" stroke="black" d="M34.94,-1079.98C34.94,-1079.98 3928.94,-1079.98 3928.94,-1079.98 3934.94,-1079.98 3940.94,-1085.98 3940.94,-1091.98 3940.94,-1091.98 3940.94,-2053.98 3940.94,-2053.98 3940.94,-2059.98 3934.94,-2065.98 3928.94,-2065.98 3928.94,-2065.98 34.94,-2065.98 34.94,-2065.98 28.94,-2065.98 22.94,-2059.98 22.94,-2053.98 22.94,-2053.98 22.94,-1091.98 22.94,-1091.98 22.94,-1085.98 28.94,-1079.98 34.94,-1079.98"/>
<text text-anchor="middle" x="1981.94" y="-2049.18" font-family="Arial Bold" font-size="16.00">Layer 14</text>
</g>
<g id="clust129" class="cluster">
<title>cluster_mha_14</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="226.94,-1509.98 226.94,-1982.98 679.94,-1982.98 679.94,-1509.98 226.94,-1509.98"/>
<text text-anchor="middle" x="453.44" y="-1966.18" font-family="Arial Bold" font-size="16.00">MHA Layer 14 (TP=2)</text>
</g>
<g id="clust130" class="cluster">
<title>cluster_moe_14</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-1148.98 30.94,-1314.98 3932.94,-1314.98 3932.94,-1148.98 30.94,-1148.98"/>
<text text-anchor="middle" x="1981.94" y="-1298.18" font-family="Arial Bold" font-size="16.00">MoE Layer 14 (EP=64, TP=2)</text>
</g>
<g id="clust131" class="cluster">
<title>cluster_expert_14_0</title>
<path fill="none" stroke="black" d="M3420.94,-1156.98C3420.94,-1156.98 3912.94,-1156.98 3912.94,-1156.98 3918.94,-1156.98 3924.94,-1162.98 3924.94,-1168.98 3924.94,-1168.98 3924.94,-1268.98 3924.94,-1268.98 3924.94,-1274.98 3918.94,-1280.98 3912.94,-1280.98 3912.94,-1280.98 3420.94,-1280.98 3420.94,-1280.98 3414.94,-1280.98 3408.94,-1274.98 3408.94,-1268.98 3408.94,-1268.98 3408.94,-1168.98 3408.94,-1168.98 3408.94,-1162.98 3414.94,-1156.98 3420.94,-1156.98"/>
<text text-anchor="middle" x="3666.94" y="-1264.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust132" class="cluster">
<title>cluster_expert_14_1</title>
<path fill="none" stroke="black" d="M2896.94,-1156.98C2896.94,-1156.98 3388.94,-1156.98 3388.94,-1156.98 3394.94,-1156.98 3400.94,-1162.98 3400.94,-1168.98 3400.94,-1168.98 3400.94,-1268.98 3400.94,-1268.98 3400.94,-1274.98 3394.94,-1280.98 3388.94,-1280.98 3388.94,-1280.98 2896.94,-1280.98 2896.94,-1280.98 2890.94,-1280.98 2884.94,-1274.98 2884.94,-1268.98 2884.94,-1268.98 2884.94,-1168.98 2884.94,-1168.98 2884.94,-1162.98 2890.94,-1156.98 2896.94,-1156.98"/>
<text text-anchor="middle" x="3142.94" y="-1264.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust133" class="cluster">
<title>cluster_expert_14_2</title>
<path fill="none" stroke="black" d="M2372.94,-1156.98C2372.94,-1156.98 2864.94,-1156.98 2864.94,-1156.98 2870.94,-1156.98 2876.94,-1162.98 2876.94,-1168.98 2876.94,-1168.98 2876.94,-1268.98 2876.94,-1268.98 2876.94,-1274.98 2870.94,-1280.98 2864.94,-1280.98 2864.94,-1280.98 2372.94,-1280.98 2372.94,-1280.98 2366.94,-1280.98 2360.94,-1274.98 2360.94,-1268.98 2360.94,-1268.98 2360.94,-1168.98 2360.94,-1168.98 2360.94,-1162.98 2366.94,-1156.98 2372.94,-1156.98"/>
<text text-anchor="middle" x="2618.94" y="-1264.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust134" class="cluster">
<title>cluster_expert_14_3</title>
<path fill="none" stroke="black" d="M1848.94,-1156.98C1848.94,-1156.98 2340.94,-1156.98 2340.94,-1156.98 2346.94,-1156.98 2352.94,-1162.98 2352.94,-1168.98 2352.94,-1168.98 2352.94,-1268.98 2352.94,-1268.98 2352.94,-1274.98 2346.94,-1280.98 2340.94,-1280.98 2340.94,-1280.98 1848.94,-1280.98 1848.94,-1280.98 1842.94,-1280.98 1836.94,-1274.98 1836.94,-1268.98 1836.94,-1268.98 1836.94,-1168.98 1836.94,-1168.98 1836.94,-1162.98 1842.94,-1156.98 1848.94,-1156.98"/>
<text text-anchor="middle" x="2094.94" y="-1264.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust135" class="cluster">
<title>cluster_expert_14_62</title>
<path fill="none" stroke="black" d="M1324.94,-1156.98C1324.94,-1156.98 1816.94,-1156.98 1816.94,-1156.98 1822.94,-1156.98 1828.94,-1162.98 1828.94,-1168.98 1828.94,-1168.98 1828.94,-1268.98 1828.94,-1268.98 1828.94,-1274.98 1822.94,-1280.98 1816.94,-1280.98 1816.94,-1280.98 1324.94,-1280.98 1324.94,-1280.98 1318.94,-1280.98 1312.94,-1274.98 1312.94,-1268.98 1312.94,-1268.98 1312.94,-1168.98 1312.94,-1168.98 1312.94,-1162.98 1318.94,-1156.98 1324.94,-1156.98"/>
<text text-anchor="middle" x="1570.94" y="-1264.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust136" class="cluster">
<title>cluster_expert_14_63</title>
<path fill="none" stroke="black" d="M800.94,-1156.98C800.94,-1156.98 1292.94,-1156.98 1292.94,-1156.98 1298.94,-1156.98 1304.94,-1162.98 1304.94,-1168.98 1304.94,-1168.98 1304.94,-1268.98 1304.94,-1268.98 1304.94,-1274.98 1298.94,-1280.98 1292.94,-1280.98 1292.94,-1280.98 800.94,-1280.98 800.94,-1280.98 794.94,-1280.98 788.94,-1274.98 788.94,-1268.98 788.94,-1268.98 788.94,-1168.98 788.94,-1168.98 788.94,-1162.98 794.94,-1156.98 800.94,-1156.98"/>
<text text-anchor="middle" x="1046.94" y="-1264.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<g id="clust137" class="cluster">
<title>cluster_layer_15</title>
<path fill="none" stroke="black" d="M34.94,-85.98C34.94,-85.98 3928.94,-85.98 3928.94,-85.98 3934.94,-85.98 3940.94,-91.98 3940.94,-97.98 3940.94,-97.98 3940.94,-1059.98 3940.94,-1059.98 3940.94,-1065.98 3934.94,-1071.98 3928.94,-1071.98 3928.94,-1071.98 34.94,-1071.98 34.94,-1071.98 28.94,-1071.98 22.94,-1065.98 22.94,-1059.98 22.94,-1059.98 22.94,-97.98 22.94,-97.98 22.94,-91.98 28.94,-85.98 34.94,-85.98"/>
<text text-anchor="middle" x="1981.94" y="-1055.18" font-family="Arial Bold" font-size="16.00">Layer 15</text>
</g>
<g id="clust138" class="cluster">
<title>cluster_mha_15</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="246.94,-515.98 246.94,-988.98 699.94,-988.98 699.94,-515.98 246.94,-515.98"/>
<text text-anchor="middle" x="473.44" y="-972.18" font-family="Arial Bold" font-size="16.00">MHA Layer 15 (TP=2)</text>
</g>
<g id="clust139" class="cluster">
<title>cluster_moe_15</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="30.94,-154.98 30.94,-320.98 3932.94,-320.98 3932.94,-154.98 30.94,-154.98"/>
<text text-anchor="middle" x="1981.94" y="-304.18" font-family="Arial Bold" font-size="16.00">MoE Layer 15 (EP=64, TP=2)</text>
</g>
<g id="clust140" class="cluster">
<title>cluster_expert_15_0</title>
<path fill="none" stroke="black" d="M3420.94,-162.98C3420.94,-162.98 3912.94,-162.98 3912.94,-162.98 3918.94,-162.98 3924.94,-168.98 3924.94,-174.98 3924.94,-174.98 3924.94,-274.98 3924.94,-274.98 3924.94,-280.98 3918.94,-286.98 3912.94,-286.98 3912.94,-286.98 3420.94,-286.98 3420.94,-286.98 3414.94,-286.98 3408.94,-280.98 3408.94,-274.98 3408.94,-274.98 3408.94,-174.98 3408.94,-174.98 3408.94,-168.98 3414.94,-162.98 3420.94,-162.98"/>
<text text-anchor="middle" x="3666.94" y="-270.18" font-family="Arial Bold" font-size="16.00">Expert 0 (GPUs 0,1)</text>
</g>
<g id="clust141" class="cluster">
<title>cluster_expert_15_1</title>
<path fill="none" stroke="black" d="M2896.94,-162.98C2896.94,-162.98 3388.94,-162.98 3388.94,-162.98 3394.94,-162.98 3400.94,-168.98 3400.94,-174.98 3400.94,-174.98 3400.94,-274.98 3400.94,-274.98 3400.94,-280.98 3394.94,-286.98 3388.94,-286.98 3388.94,-286.98 2896.94,-286.98 2896.94,-286.98 2890.94,-286.98 2884.94,-280.98 2884.94,-274.98 2884.94,-274.98 2884.94,-174.98 2884.94,-174.98 2884.94,-168.98 2890.94,-162.98 2896.94,-162.98"/>
<text text-anchor="middle" x="3142.94" y="-270.18" font-family="Arial Bold" font-size="16.00">Expert 1 (GPUs 2,3)</text>
</g>
<g id="clust142" class="cluster">
<title>cluster_expert_15_2</title>
<path fill="none" stroke="black" d="M2372.94,-162.98C2372.94,-162.98 2864.94,-162.98 2864.94,-162.98 2870.94,-162.98 2876.94,-168.98 2876.94,-174.98 2876.94,-174.98 2876.94,-274.98 2876.94,-274.98 2876.94,-280.98 2870.94,-286.98 2864.94,-286.98 2864.94,-286.98 2372.94,-286.98 2372.94,-286.98 2366.94,-286.98 2360.94,-280.98 2360.94,-274.98 2360.94,-274.98 2360.94,-174.98 2360.94,-174.98 2360.94,-168.98 2366.94,-162.98 2372.94,-162.98"/>
<text text-anchor="middle" x="2618.94" y="-270.18" font-family="Arial Bold" font-size="16.00">Expert 2 (GPUs 4,5)</text>
</g>
<g id="clust143" class="cluster">
<title>cluster_expert_15_3</title>
<path fill="none" stroke="black" d="M1848.94,-162.98C1848.94,-162.98 2340.94,-162.98 2340.94,-162.98 2346.94,-162.98 2352.94,-168.98 2352.94,-174.98 2352.94,-174.98 2352.94,-274.98 2352.94,-274.98 2352.94,-280.98 2346.94,-286.98 2340.94,-286.98 2340.94,-286.98 1848.94,-286.98 1848.94,-286.98 1842.94,-286.98 1836.94,-280.98 1836.94,-274.98 1836.94,-274.98 1836.94,-174.98 1836.94,-174.98 1836.94,-168.98 1842.94,-162.98 1848.94,-162.98"/>
<text text-anchor="middle" x="2094.94" y="-270.18" font-family="Arial Bold" font-size="16.00">Expert 3 (GPUs 6,7)</text>
</g>
<g id="clust144" class="cluster">
<title>cluster_expert_15_62</title>
<path fill="none" stroke="black" d="M1324.94,-162.98C1324.94,-162.98 1816.94,-162.98 1816.94,-162.98 1822.94,-162.98 1828.94,-168.98 1828.94,-174.98 1828.94,-174.98 1828.94,-274.98 1828.94,-274.98 1828.94,-280.98 1822.94,-286.98 1816.94,-286.98 1816.94,-286.98 1324.94,-286.98 1324.94,-286.98 1318.94,-286.98 1312.94,-280.98 1312.94,-274.98 1312.94,-274.98 1312.94,-174.98 1312.94,-174.98 1312.94,-168.98 1318.94,-162.98 1324.94,-162.98"/>
<text text-anchor="middle" x="1570.94" y="-270.18" font-family="Arial Bold" font-size="16.00">Expert 62 (GPUs 124,125)</text>
</g>
<g id="clust145" class="cluster">
<title>cluster_expert_15_63</title>
<path fill="none" stroke="black" d="M800.94,-162.98C800.94,-162.98 1292.94,-162.98 1292.94,-162.98 1298.94,-162.98 1304.94,-168.98 1304.94,-174.98 1304.94,-174.98 1304.94,-274.98 1304.94,-274.98 1304.94,-280.98 1298.94,-286.98 1292.94,-286.98 1292.94,-286.98 800.94,-286.98 800.94,-286.98 794.94,-286.98 788.94,-280.98 788.94,-274.98 788.94,-274.98 788.94,-174.98 788.94,-174.98 788.94,-168.98 794.94,-162.98 800.94,-162.98"/>
<text text-anchor="middle" x="1046.94" y="-270.18" font-family="Arial Bold" font-size="16.00">Expert 63 (GPUs 126,127)</text>
</g>
<!-- output -->
<g id="node1" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="202.94" cy="-28.99" rx="202.88" ry="28.98"/>
<text text-anchor="middle" x="202.94" y="-37.49" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="202.94" y="-26.49" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="202.94" y="-15.49" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, vocab_size=51200]</text>
</g>
<!-- input -->
<g id="node2" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="470.94" cy="-16136.97" rx="190.42" ry="28.98"/>
<text text-anchor="middle" x="470.94" y="-16145.47" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="470.94" y="-16134.47" font-family="Arial" font-size="10.00">Input: [batch_size=128, seq_len=10000, d_model=4096]</text>
<text text-anchor="middle" x="470.94" y="-16123.47" font-family="Arial" font-size="10.00">Output: [batch_size=128, seq_len=10000, d_model=4096]</text>
</g>
<!-- layer_norm_0 -->
<g id="node3" class="node">
<title>layer_norm_0</title>
<polygon fill="lightgreen" stroke="black" points="537.44,-16065.98 404.44,-16065.98 404.44,-16024.98 537.44,-16024.98 537.44,-16065.98"/>
<text text-anchor="middle" x="470.94" y="-16053.98" font-family="Arial" font-size="10.00">LayerNorm_0</text>
<text text-anchor="middle" x="470.94" y="-16042.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="470.94" y="-16031.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- input&#45;&gt;layer_norm_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_norm_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M470.94,-16107.66C470.94,-16097.63 470.94,-16086.31 470.94,-16076.17"/>
<polygon fill="red" stroke="red" points="474.44,-16076.12 470.94,-16066.12 467.44,-16076.12 474.44,-16076.12"/>
</g>
<!-- mha_split_0 -->
<g id="node4" class="node">
<title>mha_split_0</title>
<polygon fill="yellow" stroke="black" points="608.72,-15982.98 389.54,-15982.98 333.16,-15900.98 552.33,-15900.98 608.72,-15982.98"/>
<text text-anchor="middle" x="470.94" y="-15950.48" font-family="Arial" font-size="10.00">MHA_Split_0</text>
<text text-anchor="middle" x="470.94" y="-15939.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="470.94" y="-15928.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_0&#45;&gt;mha_split_0 -->
<g id="edge2" class="edge">
<title>layer_norm_0&#45;&gt;mha_split_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M470.94,-16024.91C470.94,-16015.83 470.94,-16004.56 470.94,-15993.33"/>
<polygon fill="red" stroke="red" points="474.44,-15993.08 470.94,-15983.08 467.44,-15993.08 474.44,-15993.08"/>
</g>
<!-- qkv_proj_0_gpu0 -->
<g id="node5" class="node">
<title>qkv_proj_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="462.44,-15864.98 253.44,-15864.98 253.44,-15823.98 462.44,-15823.98 462.44,-15864.98"/>
<text text-anchor="middle" x="357.94" y="-15852.98" font-family="Arial" font-size="10.00">QKV_Proj_0_GPU0</text>
<text text-anchor="middle" x="357.94" y="-15841.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="357.94" y="-15830.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_0&#45;&gt;qkv_proj_0_gpu0 -->
<g id="edge3" class="edge">
<title>mha_split_0&#45;&gt;qkv_proj_0_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M423.34,-15900.76C411.71,-15890.93 399.57,-15880.66 388.94,-15871.68"/>
<polygon fill="red" stroke="red" points="391.04,-15868.88 381.14,-15865.09 386.52,-15874.22 391.04,-15868.88"/>
</g>
<!-- qkv_proj_0_gpu1 -->
<g id="node6" class="node">
<title>qkv_proj_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="689.44,-15864.98 480.44,-15864.98 480.44,-15823.98 689.44,-15823.98 689.44,-15864.98"/>
<text text-anchor="middle" x="584.94" y="-15852.98" font-family="Arial" font-size="10.00">QKV_Proj_0_GPU1</text>
<text text-anchor="middle" x="584.94" y="-15841.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="584.94" y="-15830.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_0&#45;&gt;qkv_proj_0_gpu1 -->
<g id="edge4" class="edge">
<title>mha_split_0&#45;&gt;qkv_proj_0_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M518.96,-15900.76C530.69,-15890.93 542.95,-15880.66 553.67,-15871.68"/>
<polygon fill="red" stroke="red" points="556.11,-15874.2 561.53,-15865.09 551.62,-15868.83 556.11,-15874.2"/>
</g>
<!-- attn_0_gpu0 -->
<g id="node7" class="node">
<title>attn_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="425.94,-15787.98 303.94,-15787.98 303.94,-15746.98 425.94,-15746.98 425.94,-15787.98"/>
<text text-anchor="middle" x="364.94" y="-15775.98" font-family="Arial" font-size="10.00">Attention_0_GPU0</text>
<text text-anchor="middle" x="364.94" y="-15764.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="364.94" y="-15753.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_0_gpu0&#45;&gt;attn_0_gpu0 -->
<g id="edge5" class="edge">
<title>qkv_proj_0_gpu0&#45;&gt;attn_0_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.78,-15823.78C360.51,-15815.94 361.37,-15806.75 362.17,-15798.14"/>
<polygon fill="red" stroke="red" points="365.67,-15798.34 363.11,-15788.06 358.7,-15797.69 365.67,-15798.34"/>
</g>
<!-- attn_0_gpu1 -->
<g id="node8" class="node">
<title>attn_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="637.94,-15787.98 515.94,-15787.98 515.94,-15746.98 637.94,-15746.98 637.94,-15787.98"/>
<text text-anchor="middle" x="576.94" y="-15775.98" font-family="Arial" font-size="10.00">Attention_0_GPU1</text>
<text text-anchor="middle" x="576.94" y="-15764.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="576.94" y="-15753.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_0_gpu1&#45;&gt;attn_0_gpu1 -->
<g id="edge6" class="edge">
<title>qkv_proj_0_gpu1&#45;&gt;attn_0_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M582.84,-15823.78C582,-15815.94 581.02,-15806.75 580.1,-15798.14"/>
<polygon fill="red" stroke="red" points="583.57,-15797.63 579.03,-15788.06 576.61,-15798.37 583.57,-15797.63"/>
</g>
<!-- out_proj_0_gpu0 -->
<g id="node9" class="node">
<title>out_proj_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="447.44,-15710.98 314.44,-15710.98 314.44,-15669.98 447.44,-15669.98 447.44,-15710.98"/>
<text text-anchor="middle" x="380.94" y="-15698.98" font-family="Arial" font-size="10.00">Output_Proj_0_GPU0</text>
<text text-anchor="middle" x="380.94" y="-15687.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="380.94" y="-15676.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_0_gpu0&#45;&gt;out_proj_0_gpu0 -->
<g id="edge7" class="edge">
<title>attn_0_gpu0&#45;&gt;out_proj_0_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M369.14,-15746.78C370.83,-15738.85 372.82,-15729.55 374.67,-15720.86"/>
<polygon fill="red" stroke="red" points="378.1,-15721.57 376.76,-15711.06 371.25,-15720.11 378.1,-15721.57"/>
</g>
<!-- out_proj_0_gpu1 -->
<g id="node10" class="node">
<title>out_proj_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="628.44,-15710.98 495.44,-15710.98 495.44,-15669.98 628.44,-15669.98 628.44,-15710.98"/>
<text text-anchor="middle" x="561.94" y="-15698.98" font-family="Arial" font-size="10.00">Output_Proj_0_GPU1</text>
<text text-anchor="middle" x="561.94" y="-15687.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="561.94" y="-15676.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_0_gpu1&#45;&gt;out_proj_0_gpu1 -->
<g id="edge8" class="edge">
<title>attn_0_gpu1&#45;&gt;out_proj_0_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M573,-15746.78C571.43,-15738.94 569.59,-15729.75 567.87,-15721.14"/>
<polygon fill="red" stroke="red" points="571.25,-15720.18 565.85,-15711.06 564.38,-15721.55 571.25,-15720.18"/>
</g>
<!-- mha_merge_0 -->
<g id="node11" class="node">
<title>mha_merge_0</title>
<polygon fill="yellow" stroke="black" points="568.72,-15633.98 349.54,-15633.98 293.16,-15551.98 512.33,-15551.98 568.72,-15633.98"/>
<text text-anchor="middle" x="430.94" y="-15601.48" font-family="Arial" font-size="10.00">MHA_Merge_0</text>
<text text-anchor="middle" x="430.94" y="-15590.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="430.94" y="-15579.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_0_gpu0&#45;&gt;mha_merge_0 -->
<g id="edge9" class="edge">
<title>out_proj_0_gpu0&#45;&gt;mha_merge_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M391.3,-15669.7C395.37,-15661.91 400.25,-15652.6 405.17,-15643.21"/>
<polygon fill="red" stroke="red" points="408.33,-15644.71 409.87,-15634.23 402.13,-15641.46 408.33,-15644.71"/>
</g>
<!-- out_proj_0_gpu1&#45;&gt;mha_merge_0 -->
<g id="edge10" class="edge">
<title>out_proj_0_gpu1&#45;&gt;mha_merge_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M535.11,-15669.93C523.22,-15661.26 508.69,-15650.66 494.29,-15640.16"/>
<polygon fill="red" stroke="red" points="495.99,-15637.07 485.85,-15634.01 491.87,-15642.73 495.99,-15637.07"/>
</g>
<!-- add_norm_1_0 -->
<g id="node12" class="node">
<title>add_norm_1_0</title>
<polygon fill="lightgreen" stroke="black" points="497.44,-15515.98 364.44,-15515.98 364.44,-15474.98 497.44,-15474.98 497.44,-15515.98"/>
<text text-anchor="middle" x="430.94" y="-15503.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_0</text>
<text text-anchor="middle" x="430.94" y="-15492.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="430.94" y="-15481.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_0&#45;&gt;add_norm_1_0 -->
<g id="edge11" class="edge">
<title>mha_merge_0&#45;&gt;add_norm_1_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M430.94,-15551.76C430.94,-15543.18 430.94,-15534.27 430.94,-15526.17"/>
<polygon fill="red" stroke="red" points="434.44,-15526.09 430.94,-15516.09 427.44,-15526.09 434.44,-15526.09"/>
</g>
<!-- gate_0 -->
<g id="node13" class="node">
<title>gate_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="658.04,-15438.98 296.78,-15438.98 203.84,-15356.98 565.1,-15356.98 658.04,-15438.98"/>
<text text-anchor="middle" x="430.94" y="-15406.48" font-family="Arial" font-size="10.00">Expert_Gate_0</text>
<text text-anchor="middle" x="430.94" y="-15395.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="430.94" y="-15384.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_0&#45;&gt;gate_0 -->
<g id="edge12" class="edge">
<title>add_norm_1_0&#45;&gt;gate_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M430.94,-15474.7C430.94,-15467.23 430.94,-15458.36 430.94,-15449.37"/>
<polygon fill="red" stroke="red" points="434.44,-15449.23 430.94,-15439.23 427.44,-15449.23 434.44,-15449.23"/>
</g>
<!-- token_dist_0 -->
<g id="node14" class="node">
<title>token_dist_0</title>
<polygon fill="yellow" stroke="black" points="605.91,-15280.98 292.58,-15280.98 211.97,-15198.98 525.3,-15198.98 605.91,-15280.98"/>
<text text-anchor="middle" x="408.94" y="-15248.48" font-family="Arial" font-size="10.00">Token_Distribution_0</text>
<text text-anchor="middle" x="408.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="408.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_0&#45;&gt;token_dist_0 -->
<g id="edge13" class="edge">
<title>gate_0&#45;&gt;token_dist_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M425.27,-15356.81C422.45,-15336.79 419.01,-15312.39 416.02,-15291.16"/>
<polygon fill="red" stroke="red" points="419.45,-15290.43 414.59,-15281.02 412.52,-15291.41 419.45,-15290.43"/>
</g>
<!-- expert_0_0 -->
<g id="node515" class="node">
<title>expert_0_0</title>
<ellipse fill="lightcoral" stroke="black" cx="4167.94" cy="-1108.48" rx="38.03" ry="18"/>
<text text-anchor="middle" x="4167.94" y="-1105.98" font-family="Arial" font-size="10.00">expert_0_0</text>
</g>
<!-- token_dist_0&#45;&gt;expert_0_0 -->
<g id="edge14" class="edge">
<title>token_dist_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M531.6,-15205.35C557.91,-15199.44 585.7,-15194.17 611.94,-15190.98 934.36,-15151.82 3211.16,-15188.66 3534.94,-15162.98 3740.57,-15146.68 4452.94,-15231.76 4452.94,-15025.48 4452.94,-15025.48 4452.94,-15025.48 4452.94,-1362.98 4452.94,-1265.7 4477.36,-1216.1 4406.94,-1148.98 4380.32,-1123.61 4278.54,-1114.47 4216.7,-1111.22"/>
<polygon fill="red" stroke="red" points="4216.56,-1107.71 4206.4,-1110.72 4216.21,-1114.7 4216.56,-1107.71"/>
</g>
<!-- expert_0_0_gpu0 -->
<g id="node15" class="node">
<title>expert_0_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3743.94,-15260.48 3629.94,-15260.48 3629.94,-15219.48 3743.94,-15219.48 3743.94,-15260.48"/>
<text text-anchor="middle" x="3686.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_0_GPU0</text>
<text text-anchor="middle" x="3686.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3686.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_0_gpu1 -->
<g id="node16" class="node">
<title>expert_0_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3611.94,-15260.48 3497.94,-15260.48 3497.94,-15219.48 3611.94,-15219.48 3611.94,-15260.48"/>
<text text-anchor="middle" x="3554.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_0_GPU1</text>
<text text-anchor="middle" x="3554.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3554.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_0 -->
<g id="node17" class="node">
<title>expert_merge_0_0</title>
<polygon fill="yellow" stroke="black" points="3480.32,-15280.98 3292,-15280.98 3243.56,-15198.98 3431.88,-15198.98 3480.32,-15280.98"/>
<text text-anchor="middle" x="3361.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_Merge_0_0</text>
<text text-anchor="middle" x="3361.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3361.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_0 -->
<g id="node33" class="node">
<title>expert_agg_0</title>
<polygon fill="yellow" stroke="black" points="3525.55,-15162.98 3265.28,-15162.98 3198.33,-15080.98 3458.6,-15080.98 3525.55,-15162.98"/>
<text text-anchor="middle" x="3361.94" y="-15130.48" font-family="Arial" font-size="10.00">Expert_Aggregation_0</text>
<text text-anchor="middle" x="3361.94" y="-15119.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="3361.94" y="-15108.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge15" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3265.03,-15198.74C3260.82,-15190.37 3259.67,-15181.46 3261.59,-15172.79"/>
<polygon fill="red" stroke="red" points="3264.97,-15173.75 3265.07,-15163.16 3258.38,-15171.38 3264.97,-15173.75"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge31" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3277.95,-15198.74C3274.3,-15190.37 3273.31,-15181.46 3274.97,-15172.79"/>
<polygon fill="red" stroke="red" points="3278.34,-15173.75 3277.98,-15163.16 3271.66,-15171.66 3278.34,-15173.75"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge47" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3290.87,-15198.74C3287.82,-15190.46 3286.96,-15181.65 3288.31,-15173.07"/>
<polygon fill="red" stroke="red" points="3291.76,-15173.72 3290.9,-15163.16 3284.98,-15171.95 3291.76,-15173.72"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge63" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3303.79,-15198.74C3301.29,-15190.46 3300.59,-15181.65 3301.69,-15173.07"/>
<polygon fill="red" stroke="red" points="3305.15,-15173.67 3303.82,-15163.16 3298.3,-15172.2 3305.15,-15173.67"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge79" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3316.71,-15198.74C3314.77,-15190.46 3314.23,-15181.65 3315.08,-15173.07"/>
<polygon fill="red" stroke="red" points="3318.54,-15173.6 3316.73,-15163.16 3311.64,-15172.45 3318.54,-15173.6"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge95" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3329.64,-15198.74C3328.26,-15190.55 3327.87,-15181.84 3328.45,-15173.35"/>
<polygon fill="red" stroke="red" points="3331.96,-15173.5 3329.65,-15163.16 3325.01,-15172.68 3331.96,-15173.5"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge111" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3342.56,-15198.74C3341.73,-15190.55 3341.5,-15181.84 3341.85,-15173.35"/>
<polygon fill="red" stroke="red" points="3345.35,-15173.38 3342.56,-15163.16 3338.37,-15172.89 3345.35,-15173.38"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge127" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3355.48,-15198.74C3355.2,-15190.55 3355.13,-15181.84 3355.24,-15173.35"/>
<polygon fill="red" stroke="red" points="3358.75,-15173.24 3355.48,-15163.16 3351.75,-15173.07 3358.75,-15173.24"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge143" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3368.4,-15198.74C3368.68,-15190.55 3368.75,-15181.84 3368.64,-15173.35"/>
<polygon fill="red" stroke="red" points="3372.13,-15173.07 3368.4,-15163.16 3365.13,-15173.24 3372.13,-15173.07"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge159" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3381.32,-15198.74C3382.15,-15190.55 3382.38,-15181.84 3382.03,-15173.35"/>
<polygon fill="red" stroke="red" points="3385.51,-15172.89 3381.31,-15163.16 3378.53,-15173.38 3385.51,-15172.89"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge175" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3394.24,-15198.74C3395.62,-15190.55 3396.01,-15181.84 3395.43,-15173.35"/>
<polygon fill="red" stroke="red" points="3398.87,-15172.68 3394.23,-15163.16 3391.92,-15173.5 3398.87,-15172.68"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge191" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3407.16,-15198.74C3409.11,-15190.46 3409.65,-15181.65 3408.8,-15173.07"/>
<polygon fill="red" stroke="red" points="3412.24,-15172.45 3407.15,-15163.16 3405.34,-15173.6 3412.24,-15172.45"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge207" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3420.09,-15198.74C3422.59,-15190.46 3423.29,-15181.65 3422.18,-15173.07"/>
<polygon fill="red" stroke="red" points="3425.58,-15172.2 3420.06,-15163.16 3418.73,-15173.67 3425.58,-15172.2"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge223" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3432.51,-15200.03C3435.99,-15191.33 3437,-15181.99 3435.55,-15172.91"/>
<polygon fill="red" stroke="red" points="3438.93,-15172 3433,-15163.22 3432.16,-15173.78 3438.93,-15172"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge239" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3438.84,-15210.31C3448.02,-15198.97 3451.37,-15185.61 3448.91,-15172.79"/>
<polygon fill="red" stroke="red" points="3452.21,-15171.64 3445.89,-15163.14 3445.53,-15173.73 3452.21,-15171.64"/>
</g>
<!-- expert_merge_0_0&#45;&gt;expert_agg_0 -->
<g id="edge255" class="edge">
<title>expert_merge_0_0&#45;&gt;expert_agg_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3443.11,-15217.16C3459.41,-15204.55 3465.79,-15188.15 3462.24,-15172.57"/>
<polygon fill="red" stroke="red" points="3465.46,-15171.2 3458.74,-15163.02 3458.89,-15173.61 3465.46,-15171.2"/>
</g>
<!-- expert_0_1_gpu0 -->
<g id="node18" class="node">
<title>expert_0_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3219.94,-15260.48 3105.94,-15260.48 3105.94,-15219.48 3219.94,-15219.48 3219.94,-15260.48"/>
<text text-anchor="middle" x="3162.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_1_GPU0</text>
<text text-anchor="middle" x="3162.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3162.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_1_gpu1 -->
<g id="node19" class="node">
<title>expert_0_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3087.94,-15260.48 2973.94,-15260.48 2973.94,-15219.48 3087.94,-15219.48 3087.94,-15260.48"/>
<text text-anchor="middle" x="3030.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_1_GPU1</text>
<text text-anchor="middle" x="3030.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3030.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_1 -->
<g id="node20" class="node">
<title>expert_merge_0_1</title>
<polygon fill="yellow" stroke="black" points="2956.32,-15280.98 2768,-15280.98 2719.56,-15198.98 2907.88,-15198.98 2956.32,-15280.98"/>
<text text-anchor="middle" x="2837.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_Merge_0_1</text>
<text text-anchor="middle" x="2837.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2837.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_0_2_gpu0 -->
<g id="node21" class="node">
<title>expert_0_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2695.94,-15260.48 2581.94,-15260.48 2581.94,-15219.48 2695.94,-15219.48 2695.94,-15260.48"/>
<text text-anchor="middle" x="2638.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_2_GPU0</text>
<text text-anchor="middle" x="2638.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2638.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_2_gpu1 -->
<g id="node22" class="node">
<title>expert_0_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2563.94,-15260.48 2449.94,-15260.48 2449.94,-15219.48 2563.94,-15219.48 2563.94,-15260.48"/>
<text text-anchor="middle" x="2506.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_2_GPU1</text>
<text text-anchor="middle" x="2506.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2506.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_2 -->
<g id="node23" class="node">
<title>expert_merge_0_2</title>
<polygon fill="yellow" stroke="black" points="2432.32,-15280.98 2244,-15280.98 2195.56,-15198.98 2383.88,-15198.98 2432.32,-15280.98"/>
<text text-anchor="middle" x="2313.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_Merge_0_2</text>
<text text-anchor="middle" x="2313.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2313.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_0_3_gpu0 -->
<g id="node24" class="node">
<title>expert_0_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2171.94,-15260.48 2057.94,-15260.48 2057.94,-15219.48 2171.94,-15219.48 2171.94,-15260.48"/>
<text text-anchor="middle" x="2114.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_3_GPU0</text>
<text text-anchor="middle" x="2114.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2114.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_3_gpu1 -->
<g id="node25" class="node">
<title>expert_0_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2039.94,-15260.48 1925.94,-15260.48 1925.94,-15219.48 2039.94,-15219.48 2039.94,-15260.48"/>
<text text-anchor="middle" x="1982.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_3_GPU1</text>
<text text-anchor="middle" x="1982.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1982.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_3 -->
<g id="node26" class="node">
<title>expert_merge_0_3</title>
<polygon fill="yellow" stroke="black" points="1908.32,-15280.98 1720,-15280.98 1671.56,-15198.98 1859.88,-15198.98 1908.32,-15280.98"/>
<text text-anchor="middle" x="1789.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_Merge_0_3</text>
<text text-anchor="middle" x="1789.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1789.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_0_62_gpu0 -->
<g id="node27" class="node">
<title>expert_0_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1647.94,-15260.48 1533.94,-15260.48 1533.94,-15219.48 1647.94,-15219.48 1647.94,-15260.48"/>
<text text-anchor="middle" x="1590.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_62_GPU0</text>
<text text-anchor="middle" x="1590.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1590.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_62_gpu1 -->
<g id="node28" class="node">
<title>expert_0_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1515.94,-15260.48 1401.94,-15260.48 1401.94,-15219.48 1515.94,-15219.48 1515.94,-15260.48"/>
<text text-anchor="middle" x="1458.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_62_GPU1</text>
<text text-anchor="middle" x="1458.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1458.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_62 -->
<g id="node29" class="node">
<title>expert_merge_0_62</title>
<polygon fill="yellow" stroke="black" points="1384.32,-15280.98 1196,-15280.98 1147.56,-15198.98 1335.88,-15198.98 1384.32,-15280.98"/>
<text text-anchor="middle" x="1265.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_Merge_0_62</text>
<text text-anchor="middle" x="1265.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1265.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_0_63_gpu0 -->
<g id="node30" class="node">
<title>expert_0_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1123.94,-15260.48 1009.94,-15260.48 1009.94,-15219.48 1123.94,-15219.48 1123.94,-15260.48"/>
<text text-anchor="middle" x="1066.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_63_GPU0</text>
<text text-anchor="middle" x="1066.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1066.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_0_63_gpu1 -->
<g id="node31" class="node">
<title>expert_0_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="991.94,-15260.48 877.94,-15260.48 877.94,-15219.48 991.94,-15219.48 991.94,-15260.48"/>
<text text-anchor="middle" x="934.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_0_63_GPU1</text>
<text text-anchor="middle" x="934.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="934.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_0_63 -->
<g id="node32" class="node">
<title>expert_merge_0_63</title>
<polygon fill="yellow" stroke="black" points="860.32,-15280.98 672,-15280.98 623.56,-15198.98 811.88,-15198.98 860.32,-15280.98"/>
<text text-anchor="middle" x="741.94" y="-15248.48" font-family="Arial" font-size="10.00">Expert_Merge_0_63</text>
<text text-anchor="middle" x="741.94" y="-15237.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="741.94" y="-15226.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- add_norm_2_0 -->
<g id="node34" class="node">
<title>add_norm_2_0</title>
<polygon fill="lightgreen" stroke="black" points="2119.44,-15044.98 1986.44,-15044.98 1986.44,-15003.98 2119.44,-15003.98 2119.44,-15044.98"/>
<text text-anchor="middle" x="2052.94" y="-15032.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_0</text>
<text text-anchor="middle" x="2052.94" y="-15021.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="2052.94" y="-15010.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_0&#45;&gt;add_norm_2_0 -->
<g id="edge16" class="edge">
<title>expert_agg_0&#45;&gt;add_norm_2_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3222.47,-15110.81C2947.5,-15090.75 2343.54,-15046.68 2129.78,-15031.09"/>
<polygon fill="red" stroke="red" points="2129.82,-15027.58 2119.6,-15030.35 2129.31,-15034.56 2129.82,-15027.58"/>
</g>
<!-- layer_norm_1 -->
<g id="node35" class="node">
<title>layer_norm_1</title>
<polygon fill="lightgreen" stroke="black" points="2037.44,-14953.98 1904.44,-14953.98 1904.44,-14912.98 2037.44,-14912.98 2037.44,-14953.98"/>
<text text-anchor="middle" x="1970.94" y="-14941.98" font-family="Arial" font-size="10.00">LayerNorm_1</text>
<text text-anchor="middle" x="1970.94" y="-14930.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="1970.94" y="-14919.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_0&#45;&gt;layer_norm_1 -->
<g id="edge17" class="edge">
<title>add_norm_2_0&#45;&gt;layer_norm_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2034.74,-15003.73C2023.38,-14991.4 2008.6,-14975.36 1996.12,-14961.82"/>
<polygon fill="red" stroke="red" points="1998.44,-14959.16 1989.09,-14954.18 1993.29,-14963.91 1998.44,-14959.16"/>
</g>
<!-- mha_split_1 -->
<g id="node36" class="node">
<title>mha_split_1</title>
<polygon fill="yellow" stroke="black" points="1781.72,-14870.98 1562.54,-14870.98 1506.16,-14788.98 1725.33,-14788.98 1781.72,-14870.98"/>
<text text-anchor="middle" x="1643.94" y="-14838.48" font-family="Arial" font-size="10.00">MHA_Split_1</text>
<text text-anchor="middle" x="1643.94" y="-14827.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="1643.94" y="-14816.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_1&#45;&gt;mha_split_1 -->
<g id="edge18" class="edge">
<title>layer_norm_1&#45;&gt;mha_split_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1907.89,-14912.91C1872.27,-14901.86 1826.27,-14887.58 1782.67,-14874.05"/>
<polygon fill="red" stroke="red" points="1783.71,-14870.7 1773.12,-14871.08 1781.63,-14877.39 1783.71,-14870.7"/>
</g>
<!-- qkv_proj_1_gpu0 -->
<g id="node37" class="node">
<title>qkv_proj_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1554.44,-14752.98 1345.44,-14752.98 1345.44,-14711.98 1554.44,-14711.98 1554.44,-14752.98"/>
<text text-anchor="middle" x="1449.94" y="-14740.98" font-family="Arial" font-size="10.00">QKV_Proj_1_GPU0</text>
<text text-anchor="middle" x="1449.94" y="-14729.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="1449.94" y="-14718.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_1&#45;&gt;qkv_proj_1_gpu0 -->
<g id="edge19" class="edge">
<title>mha_split_1&#45;&gt;qkv_proj_1_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1562.51,-14788.9C1540.86,-14778.24 1518.14,-14767.06 1498.83,-14757.55"/>
<polygon fill="red" stroke="red" points="1500.16,-14754.3 1489.64,-14753.03 1497.07,-14760.58 1500.16,-14754.3"/>
</g>
<!-- qkv_proj_1_gpu1 -->
<g id="node38" class="node">
<title>qkv_proj_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1781.44,-14752.98 1572.44,-14752.98 1572.44,-14711.98 1781.44,-14711.98 1781.44,-14752.98"/>
<text text-anchor="middle" x="1676.94" y="-14740.98" font-family="Arial" font-size="10.00">QKV_Proj_1_GPU1</text>
<text text-anchor="middle" x="1676.94" y="-14729.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="1676.94" y="-14718.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_1&#45;&gt;qkv_proj_1_gpu1 -->
<g id="edge20" class="edge">
<title>mha_split_1&#45;&gt;qkv_proj_1_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1657.84,-14788.76C1660.87,-14779.99 1664.02,-14770.87 1666.87,-14762.63"/>
<polygon fill="red" stroke="red" points="1670.2,-14763.69 1670.16,-14753.09 1663.59,-14761.4 1670.2,-14763.69"/>
</g>
<!-- attn_1_gpu0 -->
<g id="node39" class="node">
<title>attn_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1517.94,-14675.98 1395.94,-14675.98 1395.94,-14634.98 1517.94,-14634.98 1517.94,-14675.98"/>
<text text-anchor="middle" x="1456.94" y="-14663.98" font-family="Arial" font-size="10.00">Attention_1_GPU0</text>
<text text-anchor="middle" x="1456.94" y="-14652.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="1456.94" y="-14641.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_1_gpu0&#45;&gt;attn_1_gpu0 -->
<g id="edge21" class="edge">
<title>qkv_proj_1_gpu0&#45;&gt;attn_1_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1451.78,-14711.78C1452.51,-14703.94 1453.37,-14694.75 1454.17,-14686.14"/>
<polygon fill="red" stroke="red" points="1457.67,-14686.34 1455.11,-14676.06 1450.7,-14685.69 1457.67,-14686.34"/>
</g>
<!-- attn_1_gpu1 -->
<g id="node40" class="node">
<title>attn_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1729.94,-14675.98 1607.94,-14675.98 1607.94,-14634.98 1729.94,-14634.98 1729.94,-14675.98"/>
<text text-anchor="middle" x="1668.94" y="-14663.98" font-family="Arial" font-size="10.00">Attention_1_GPU1</text>
<text text-anchor="middle" x="1668.94" y="-14652.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="1668.94" y="-14641.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_1_gpu1&#45;&gt;attn_1_gpu1 -->
<g id="edge22" class="edge">
<title>qkv_proj_1_gpu1&#45;&gt;attn_1_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1674.84,-14711.78C1674,-14703.94 1673.02,-14694.75 1672.1,-14686.14"/>
<polygon fill="red" stroke="red" points="1675.57,-14685.63 1671.03,-14676.06 1668.61,-14686.37 1675.57,-14685.63"/>
</g>
<!-- out_proj_1_gpu0 -->
<g id="node41" class="node">
<title>out_proj_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1539.44,-14598.98 1406.44,-14598.98 1406.44,-14557.98 1539.44,-14557.98 1539.44,-14598.98"/>
<text text-anchor="middle" x="1472.94" y="-14586.98" font-family="Arial" font-size="10.00">Output_Proj_1_GPU0</text>
<text text-anchor="middle" x="1472.94" y="-14575.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="1472.94" y="-14564.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_1_gpu0&#45;&gt;out_proj_1_gpu0 -->
<g id="edge23" class="edge">
<title>attn_1_gpu0&#45;&gt;out_proj_1_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1461.14,-14634.78C1462.83,-14626.85 1464.82,-14617.55 1466.67,-14608.86"/>
<polygon fill="red" stroke="red" points="1470.1,-14609.57 1468.76,-14599.06 1463.25,-14608.11 1470.1,-14609.57"/>
</g>
<!-- out_proj_1_gpu1 -->
<g id="node42" class="node">
<title>out_proj_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1720.44,-14598.98 1587.44,-14598.98 1587.44,-14557.98 1720.44,-14557.98 1720.44,-14598.98"/>
<text text-anchor="middle" x="1653.94" y="-14586.98" font-family="Arial" font-size="10.00">Output_Proj_1_GPU1</text>
<text text-anchor="middle" x="1653.94" y="-14575.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="1653.94" y="-14564.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_1_gpu1&#45;&gt;out_proj_1_gpu1 -->
<g id="edge24" class="edge">
<title>attn_1_gpu1&#45;&gt;out_proj_1_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1665,-14634.78C1663.43,-14626.94 1661.59,-14617.75 1659.87,-14609.14"/>
<polygon fill="red" stroke="red" points="1663.25,-14608.18 1657.85,-14599.06 1656.38,-14609.55 1663.25,-14608.18"/>
</g>
<!-- mha_merge_1 -->
<g id="node43" class="node">
<title>mha_merge_1</title>
<polygon fill="yellow" stroke="black" points="1620.72,-14521.98 1401.54,-14521.98 1345.16,-14439.98 1564.33,-14439.98 1620.72,-14521.98"/>
<text text-anchor="middle" x="1482.94" y="-14489.48" font-family="Arial" font-size="10.00">MHA_Merge_1</text>
<text text-anchor="middle" x="1482.94" y="-14478.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="1482.94" y="-14467.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_1_gpu0&#45;&gt;mha_merge_1 -->
<g id="edge25" class="edge">
<title>out_proj_1_gpu0&#45;&gt;mha_merge_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1475.01,-14557.7C1475.79,-14550.23 1476.72,-14541.36 1477.66,-14532.37"/>
<polygon fill="red" stroke="red" points="1481.16,-14532.54 1478.73,-14522.23 1474.2,-14531.81 1481.16,-14532.54"/>
</g>
<!-- out_proj_1_gpu1&#45;&gt;mha_merge_1 -->
<g id="edge26" class="edge">
<title>out_proj_1_gpu1&#45;&gt;mha_merge_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1618.92,-14557.93C1602.82,-14548.94 1583,-14537.87 1563.52,-14526.99"/>
<polygon fill="red" stroke="red" points="1565.05,-14523.83 1554.61,-14522.01 1561.64,-14529.94 1565.05,-14523.83"/>
</g>
<!-- add_norm_1_1 -->
<g id="node44" class="node">
<title>add_norm_1_1</title>
<polygon fill="lightgreen" stroke="black" points="894.44,-14403.98 761.44,-14403.98 761.44,-14362.98 894.44,-14362.98 894.44,-14403.98"/>
<text text-anchor="middle" x="827.94" y="-14391.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_1</text>
<text text-anchor="middle" x="827.94" y="-14380.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="827.94" y="-14369.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_1&#45;&gt;add_norm_1_1 -->
<g id="edge27" class="edge">
<title>mha_merge_1&#45;&gt;add_norm_1_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1360.12,-14462.08C1226.5,-14442.59 1016.98,-14412.05 904.85,-14395.7"/>
<polygon fill="red" stroke="red" points="905.04,-14392.19 894.64,-14394.21 904.03,-14399.11 905.04,-14392.19"/>
</g>
<!-- gate_1 -->
<g id="node45" class="node">
<title>gate_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="973.04,-14326.98 611.78,-14326.98 518.84,-14244.98 880.1,-14244.98 973.04,-14326.98"/>
<text text-anchor="middle" x="745.94" y="-14294.48" font-family="Arial" font-size="10.00">Expert_Gate_1</text>
<text text-anchor="middle" x="745.94" y="-14283.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="745.94" y="-14272.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_1&#45;&gt;gate_1 -->
<g id="edge28" class="edge">
<title>add_norm_1_1&#45;&gt;gate_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M810.95,-14362.7C803.99,-14354.59 795.61,-14344.83 787.21,-14335.05"/>
<polygon fill="red" stroke="red" points="789.67,-14332.54 780.5,-14327.23 784.35,-14337.1 789.67,-14332.54"/>
</g>
<!-- token_dist_1 -->
<g id="node46" class="node">
<title>token_dist_1</title>
<polygon fill="yellow" stroke="black" points="778.91,-14168.98 465.58,-14168.98 384.97,-14086.98 698.3,-14086.98 778.91,-14168.98"/>
<text text-anchor="middle" x="581.94" y="-14136.48" font-family="Arial" font-size="10.00">Token_Distribution_1</text>
<text text-anchor="middle" x="581.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_1&#45;&gt;token_dist_1 -->
<g id="edge29" class="edge">
<title>gate_1&#45;&gt;token_dist_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M703.71,-14244.81C681.61,-14223.79 654.43,-14197.94 631.36,-14176"/>
<polygon fill="red" stroke="red" points="633.69,-14173.38 624.03,-14169.02 628.86,-14178.45 633.69,-14173.38"/>
</g>
<!-- token_dist_1&#45;&gt;expert_0_0 -->
<g id="edge30" class="edge">
<title>token_dist_1&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-14088.73C727.77,-14081.41 757.15,-14074.84 784.94,-14070.98 1132.73,-14022.77 3596.29,-14092.54 3944.94,-14050.98 4158.02,-14025.59 4414.94,-14155.07 4414.94,-13940.48 4414.94,-13940.48 4414.94,-13940.48 4414.94,-1362.98 4414.94,-1265.7 4438.34,-1217.16 4368.94,-1148.98 4347.71,-1128.13 4268.35,-1117.66 4215.93,-1112.91"/>
<polygon fill="red" stroke="red" points="4216.09,-1109.41 4205.82,-1112.04 4215.49,-1116.39 4216.09,-1109.41"/>
</g>
<!-- expert_1_0_gpu0 -->
<g id="node47" class="node">
<title>expert_1_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-14148.48 3802.94,-14148.48 3802.94,-14107.48 3916.94,-14107.48 3916.94,-14148.48"/>
<text text-anchor="middle" x="3859.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_0_gpu1 -->
<g id="node48" class="node">
<title>expert_1_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-14148.48 3670.94,-14148.48 3670.94,-14107.48 3784.94,-14107.48 3784.94,-14148.48"/>
<text text-anchor="middle" x="3727.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_0 -->
<g id="node49" class="node">
<title>expert_merge_1_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-14168.98 3465,-14168.98 3416.56,-14086.98 3604.88,-14086.98 3653.32,-14168.98"/>
<text text-anchor="middle" x="3534.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_Merge_1_0</text>
<text text-anchor="middle" x="3534.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_1_1_gpu0 -->
<g id="node50" class="node">
<title>expert_1_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-14148.48 3278.94,-14148.48 3278.94,-14107.48 3392.94,-14107.48 3392.94,-14148.48"/>
<text text-anchor="middle" x="3335.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_1_gpu1 -->
<g id="node51" class="node">
<title>expert_1_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-14148.48 3146.94,-14148.48 3146.94,-14107.48 3260.94,-14107.48 3260.94,-14148.48"/>
<text text-anchor="middle" x="3203.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_1 -->
<g id="node52" class="node">
<title>expert_merge_1_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-14168.98 2941,-14168.98 2892.56,-14086.98 3080.88,-14086.98 3129.32,-14168.98"/>
<text text-anchor="middle" x="3010.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_Merge_1_1</text>
<text text-anchor="middle" x="3010.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_1_2_gpu0 -->
<g id="node53" class="node">
<title>expert_1_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-14148.48 2754.94,-14148.48 2754.94,-14107.48 2868.94,-14107.48 2868.94,-14148.48"/>
<text text-anchor="middle" x="2811.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_2_gpu1 -->
<g id="node54" class="node">
<title>expert_1_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-14148.48 2622.94,-14148.48 2622.94,-14107.48 2736.94,-14107.48 2736.94,-14148.48"/>
<text text-anchor="middle" x="2679.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_2 -->
<g id="node55" class="node">
<title>expert_merge_1_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-14168.98 2417,-14168.98 2368.56,-14086.98 2556.88,-14086.98 2605.32,-14168.98"/>
<text text-anchor="middle" x="2486.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_Merge_1_2</text>
<text text-anchor="middle" x="2486.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_1_3_gpu0 -->
<g id="node56" class="node">
<title>expert_1_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-14148.48 2230.94,-14148.48 2230.94,-14107.48 2344.94,-14107.48 2344.94,-14148.48"/>
<text text-anchor="middle" x="2287.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_3_gpu1 -->
<g id="node57" class="node">
<title>expert_1_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-14148.48 2098.94,-14148.48 2098.94,-14107.48 2212.94,-14107.48 2212.94,-14148.48"/>
<text text-anchor="middle" x="2155.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_3 -->
<g id="node58" class="node">
<title>expert_merge_1_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-14168.98 1893,-14168.98 1844.56,-14086.98 2032.88,-14086.98 2081.32,-14168.98"/>
<text text-anchor="middle" x="1962.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_Merge_1_3</text>
<text text-anchor="middle" x="1962.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_1_62_gpu0 -->
<g id="node59" class="node">
<title>expert_1_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-14148.48 1706.94,-14148.48 1706.94,-14107.48 1820.94,-14107.48 1820.94,-14148.48"/>
<text text-anchor="middle" x="1763.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_62_gpu1 -->
<g id="node60" class="node">
<title>expert_1_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-14148.48 1574.94,-14148.48 1574.94,-14107.48 1688.94,-14107.48 1688.94,-14148.48"/>
<text text-anchor="middle" x="1631.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_62 -->
<g id="node61" class="node">
<title>expert_merge_1_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-14168.98 1369,-14168.98 1320.56,-14086.98 1508.88,-14086.98 1557.32,-14168.98"/>
<text text-anchor="middle" x="1438.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_Merge_1_62</text>
<text text-anchor="middle" x="1438.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_1_63_gpu0 -->
<g id="node62" class="node">
<title>expert_1_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-14148.48 1182.94,-14148.48 1182.94,-14107.48 1296.94,-14107.48 1296.94,-14148.48"/>
<text text-anchor="middle" x="1239.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_1_63_gpu1 -->
<g id="node63" class="node">
<title>expert_1_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-14148.48 1050.94,-14148.48 1050.94,-14107.48 1164.94,-14107.48 1164.94,-14148.48"/>
<text text-anchor="middle" x="1107.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_1_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_1_63 -->
<g id="node64" class="node">
<title>expert_merge_1_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-14168.98 845,-14168.98 796.56,-14086.98 984.88,-14086.98 1033.32,-14168.98"/>
<text text-anchor="middle" x="914.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_Merge_1_63</text>
<text text-anchor="middle" x="914.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_1 -->
<g id="node65" class="node">
<title>expert_agg_1</title>
<polygon fill="yellow" stroke="black" points="366.55,-14168.98 106.28,-14168.98 39.33,-14086.98 299.6,-14086.98 366.55,-14168.98"/>
<text text-anchor="middle" x="202.94" y="-14136.48" font-family="Arial" font-size="10.00">Expert_Aggregation_1</text>
<text text-anchor="middle" x="202.94" y="-14125.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-14114.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_1 -->
<g id="node66" class="node">
<title>add_norm_2_1</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-14050.98 143.44,-14050.98 143.44,-14009.98 276.44,-14009.98 276.44,-14050.98"/>
<text text-anchor="middle" x="209.94" y="-14038.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_1</text>
<text text-anchor="middle" x="209.94" y="-14027.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-14016.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_1&#45;&gt;add_norm_2_1 -->
<g id="edge32" class="edge">
<title>expert_agg_1&#45;&gt;add_norm_2_1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-14086.76C206.52,-14078.18 207.17,-14069.27 207.76,-14061.17"/>
<polygon fill="red" stroke="red" points="211.26,-14061.32 208.5,-14051.09 204.28,-14060.81 211.26,-14061.32"/>
</g>
<!-- layer_norm_2 -->
<g id="node67" class="node">
<title>layer_norm_2</title>
<polygon fill="lightgreen" stroke="black" points="303.44,-13959.98 170.44,-13959.98 170.44,-13918.98 303.44,-13918.98 303.44,-13959.98"/>
<text text-anchor="middle" x="236.94" y="-13947.98" font-family="Arial" font-size="10.00">LayerNorm_2</text>
<text text-anchor="middle" x="236.94" y="-13936.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="236.94" y="-13925.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_1&#45;&gt;layer_norm_2 -->
<g id="edge33" class="edge">
<title>add_norm_2_1&#45;&gt;layer_norm_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M215.93,-14009.73C219.46,-13998.09 224,-13983.14 227.95,-13970.12"/>
<polygon fill="red" stroke="red" points="231.41,-13970.76 230.96,-13960.18 224.71,-13968.73 231.41,-13970.76"/>
</g>
<!-- mha_split_2 -->
<g id="node68" class="node">
<title>mha_split_2</title>
<polygon fill="yellow" stroke="black" points="483.72,-13876.98 264.54,-13876.98 208.16,-13794.98 427.33,-13794.98 483.72,-13876.98"/>
<text text-anchor="middle" x="345.94" y="-13844.48" font-family="Arial" font-size="10.00">MHA_Split_2</text>
<text text-anchor="middle" x="345.94" y="-13833.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="345.94" y="-13822.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_2&#45;&gt;mha_split_2 -->
<g id="edge34" class="edge">
<title>layer_norm_2&#45;&gt;mha_split_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M257.96,-13918.91C268.61,-13908.99 282.05,-13896.48 295.2,-13884.23"/>
<polygon fill="red" stroke="red" points="297.95,-13886.46 302.88,-13877.08 293.18,-13881.33 297.95,-13886.46"/>
</g>
<!-- qkv_proj_2_gpu0 -->
<g id="node69" class="node">
<title>qkv_proj_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="417.44,-13758.98 208.44,-13758.98 208.44,-13717.98 417.44,-13717.98 417.44,-13758.98"/>
<text text-anchor="middle" x="312.94" y="-13746.98" font-family="Arial" font-size="10.00">QKV_Proj_2_GPU0</text>
<text text-anchor="middle" x="312.94" y="-13735.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="312.94" y="-13724.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_2&#45;&gt;qkv_proj_2_gpu0 -->
<g id="edge35" class="edge">
<title>mha_split_2&#45;&gt;qkv_proj_2_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M332.04,-13794.76C329.01,-13785.99 325.86,-13776.87 323.01,-13768.63"/>
<polygon fill="red" stroke="red" points="326.29,-13767.4 319.72,-13759.09 319.67,-13769.69 326.29,-13767.4"/>
</g>
<!-- qkv_proj_2_gpu1 -->
<g id="node70" class="node">
<title>qkv_proj_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="644.44,-13758.98 435.44,-13758.98 435.44,-13717.98 644.44,-13717.98 644.44,-13758.98"/>
<text text-anchor="middle" x="539.94" y="-13746.98" font-family="Arial" font-size="10.00">QKV_Proj_2_GPU1</text>
<text text-anchor="middle" x="539.94" y="-13735.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="539.94" y="-13724.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_2&#45;&gt;qkv_proj_2_gpu1 -->
<g id="edge36" class="edge">
<title>mha_split_2&#45;&gt;qkv_proj_2_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M427.37,-13794.9C449.02,-13784.24 471.74,-13773.06 491.05,-13763.55"/>
<polygon fill="red" stroke="red" points="492.81,-13766.58 500.24,-13759.03 489.72,-13760.3 492.81,-13766.58"/>
</g>
<!-- attn_2_gpu0 -->
<g id="node71" class="node">
<title>attn_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="388.94,-13681.98 266.94,-13681.98 266.94,-13640.98 388.94,-13640.98 388.94,-13681.98"/>
<text text-anchor="middle" x="327.94" y="-13669.98" font-family="Arial" font-size="10.00">Attention_2_GPU0</text>
<text text-anchor="middle" x="327.94" y="-13658.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="327.94" y="-13647.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_2_gpu0&#45;&gt;attn_2_gpu0 -->
<g id="edge37" class="edge">
<title>qkv_proj_2_gpu0&#45;&gt;attn_2_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M316.88,-13717.78C318.45,-13709.94 320.29,-13700.75 322.01,-13692.14"/>
<polygon fill="red" stroke="red" points="325.5,-13692.55 324.02,-13682.06 318.63,-13691.18 325.5,-13692.55"/>
</g>
<!-- attn_2_gpu1 -->
<g id="node72" class="node">
<title>attn_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="591.94,-13681.98 469.94,-13681.98 469.94,-13640.98 591.94,-13640.98 591.94,-13681.98"/>
<text text-anchor="middle" x="530.94" y="-13669.98" font-family="Arial" font-size="10.00">Attention_2_GPU1</text>
<text text-anchor="middle" x="530.94" y="-13658.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="530.94" y="-13647.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_2_gpu1&#45;&gt;attn_2_gpu1 -->
<g id="edge38" class="edge">
<title>qkv_proj_2_gpu1&#45;&gt;attn_2_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M537.58,-13717.78C536.63,-13709.94 535.53,-13700.75 534.5,-13692.14"/>
<polygon fill="red" stroke="red" points="537.96,-13691.57 533.29,-13682.06 531,-13692.4 537.96,-13691.57"/>
</g>
<!-- out_proj_2_gpu0 -->
<g id="node73" class="node">
<title>out_proj_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="423.44,-13604.98 290.44,-13604.98 290.44,-13563.98 423.44,-13563.98 423.44,-13604.98"/>
<text text-anchor="middle" x="356.94" y="-13592.98" font-family="Arial" font-size="10.00">Output_Proj_2_GPU0</text>
<text text-anchor="middle" x="356.94" y="-13581.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="356.94" y="-13570.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_2_gpu0&#45;&gt;out_proj_2_gpu0 -->
<g id="edge39" class="edge">
<title>attn_2_gpu0&#45;&gt;out_proj_2_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M335.56,-13640.78C338.66,-13632.77 342.3,-13623.35 345.69,-13614.58"/>
<polygon fill="red" stroke="red" points="349.03,-13615.65 349.37,-13605.06 342.5,-13613.12 349.03,-13615.65"/>
</g>
<!-- out_proj_2_gpu1 -->
<g id="node74" class="node">
<title>out_proj_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="589.44,-13604.98 456.44,-13604.98 456.44,-13563.98 589.44,-13563.98 589.44,-13604.98"/>
<text text-anchor="middle" x="522.94" y="-13592.98" font-family="Arial" font-size="10.00">Output_Proj_2_GPU1</text>
<text text-anchor="middle" x="522.94" y="-13581.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="522.94" y="-13570.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_2_gpu1&#45;&gt;out_proj_2_gpu1 -->
<g id="edge40" class="edge">
<title>attn_2_gpu1&#45;&gt;out_proj_2_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M528.84,-13640.78C528,-13632.94 527.02,-13623.75 526.1,-13615.14"/>
<polygon fill="red" stroke="red" points="529.57,-13614.63 525.03,-13605.06 522.61,-13615.37 529.57,-13614.63"/>
</g>
<!-- mha_merge_2 -->
<g id="node75" class="node">
<title>mha_merge_2</title>
<polygon fill="yellow" stroke="black" points="644.72,-13527.98 425.54,-13527.98 369.16,-13445.98 588.33,-13445.98 644.72,-13527.98"/>
<text text-anchor="middle" x="506.94" y="-13495.48" font-family="Arial" font-size="10.00">MHA_Merge_2</text>
<text text-anchor="middle" x="506.94" y="-13484.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="506.94" y="-13473.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_2_gpu0&#45;&gt;mha_merge_2 -->
<g id="edge41" class="edge">
<title>out_proj_2_gpu0&#45;&gt;mha_merge_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M387.66,-13563.93C401.52,-13555.1 418.54,-13544.26 435.33,-13533.58"/>
<polygon fill="red" stroke="red" points="437.51,-13536.33 444.07,-13528.01 433.75,-13530.43 437.51,-13536.33"/>
</g>
<!-- out_proj_2_gpu1&#45;&gt;mha_merge_2 -->
<g id="edge42" class="edge">
<title>out_proj_2_gpu1&#45;&gt;mha_merge_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M519.62,-13563.7C518.37,-13556.23 516.89,-13547.36 515.38,-13538.37"/>
<polygon fill="red" stroke="red" points="518.79,-13537.51 513.68,-13528.23 511.88,-13538.67 518.79,-13537.51"/>
</g>
<!-- add_norm_1_2 -->
<g id="node76" class="node">
<title>add_norm_1_2</title>
<polygon fill="lightgreen" stroke="black" points="587.44,-13409.98 454.44,-13409.98 454.44,-13368.98 587.44,-13368.98 587.44,-13409.98"/>
<text text-anchor="middle" x="520.94" y="-13397.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_2</text>
<text text-anchor="middle" x="520.94" y="-13386.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="520.94" y="-13375.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_2&#45;&gt;add_norm_1_2 -->
<g id="edge43" class="edge">
<title>mha_merge_2&#45;&gt;add_norm_1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M512.84,-13445.76C514.09,-13437.18 515.4,-13428.27 516.59,-13420.17"/>
<polygon fill="red" stroke="red" points="520.08,-13420.5 518.06,-13410.09 513.15,-13419.48 520.08,-13420.5"/>
</g>
<!-- gate_2 -->
<g id="node77" class="node">
<title>gate_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-13332.98 440.78,-13332.98 347.84,-13250.98 709.1,-13250.98 802.04,-13332.98"/>
<text text-anchor="middle" x="574.94" y="-13300.48" font-family="Arial" font-size="10.00">Expert_Gate_2</text>
<text text-anchor="middle" x="574.94" y="-13289.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-13278.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_2&#45;&gt;gate_2 -->
<g id="edge44" class="edge">
<title>add_norm_1_2&#45;&gt;gate_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M532.13,-13368.7C536.53,-13360.91 541.8,-13351.6 547.11,-13342.21"/>
<polygon fill="red" stroke="red" points="550.31,-13343.66 552.18,-13333.23 544.21,-13340.21 550.31,-13343.66"/>
</g>
<!-- token_dist_2 -->
<g id="node78" class="node">
<title>token_dist_2</title>
<polygon fill="yellow" stroke="black" points="778.91,-13174.98 465.58,-13174.98 384.97,-13092.98 698.3,-13092.98 778.91,-13174.98"/>
<text text-anchor="middle" x="581.94" y="-13142.48" font-family="Arial" font-size="10.00">Token_Distribution_2</text>
<text text-anchor="middle" x="581.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_2&#45;&gt;token_dist_2 -->
<g id="edge45" class="edge">
<title>gate_2&#45;&gt;token_dist_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-13250.81C577.64,-13230.79 578.74,-13206.39 579.69,-13185.16"/>
<polygon fill="red" stroke="red" points="583.19,-13185.17 580.14,-13175.02 576.2,-13184.85 583.19,-13185.17"/>
</g>
<!-- token_dist_2&#45;&gt;expert_0_0 -->
<g id="edge46" class="edge">
<title>token_dist_2&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-13094.73C727.77,-13087.41 757.15,-13080.84 784.94,-13076.98 1132.73,-13028.77 3596.71,-13101.93 3944.94,-13056.98 4141.49,-13031.61 4376.94,-13144.66 4376.94,-12946.48 4376.94,-12946.48 4376.94,-12946.48 4376.94,-1362.98 4376.94,-1265.7 4398.83,-1218.66 4330.94,-1148.98 4314.94,-1132.56 4256.92,-1121.39 4214.65,-1115.23"/>
<polygon fill="red" stroke="red" points="4214.93,-1111.74 4204.54,-1113.81 4213.96,-1118.67 4214.93,-1111.74"/>
</g>
<!-- expert_2_0_gpu0 -->
<g id="node79" class="node">
<title>expert_2_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-13154.48 3802.94,-13154.48 3802.94,-13113.48 3916.94,-13113.48 3916.94,-13154.48"/>
<text text-anchor="middle" x="3859.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_0_gpu1 -->
<g id="node80" class="node">
<title>expert_2_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-13154.48 3670.94,-13154.48 3670.94,-13113.48 3784.94,-13113.48 3784.94,-13154.48"/>
<text text-anchor="middle" x="3727.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_0 -->
<g id="node81" class="node">
<title>expert_merge_2_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-13174.98 3465,-13174.98 3416.56,-13092.98 3604.88,-13092.98 3653.32,-13174.98"/>
<text text-anchor="middle" x="3534.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_Merge_2_0</text>
<text text-anchor="middle" x="3534.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_2_1_gpu0 -->
<g id="node82" class="node">
<title>expert_2_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-13154.48 3278.94,-13154.48 3278.94,-13113.48 3392.94,-13113.48 3392.94,-13154.48"/>
<text text-anchor="middle" x="3335.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_1_gpu1 -->
<g id="node83" class="node">
<title>expert_2_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-13154.48 3146.94,-13154.48 3146.94,-13113.48 3260.94,-13113.48 3260.94,-13154.48"/>
<text text-anchor="middle" x="3203.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_1 -->
<g id="node84" class="node">
<title>expert_merge_2_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-13174.98 2941,-13174.98 2892.56,-13092.98 3080.88,-13092.98 3129.32,-13174.98"/>
<text text-anchor="middle" x="3010.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_Merge_2_1</text>
<text text-anchor="middle" x="3010.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_2_2_gpu0 -->
<g id="node85" class="node">
<title>expert_2_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-13154.48 2754.94,-13154.48 2754.94,-13113.48 2868.94,-13113.48 2868.94,-13154.48"/>
<text text-anchor="middle" x="2811.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_2_gpu1 -->
<g id="node86" class="node">
<title>expert_2_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-13154.48 2622.94,-13154.48 2622.94,-13113.48 2736.94,-13113.48 2736.94,-13154.48"/>
<text text-anchor="middle" x="2679.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_2 -->
<g id="node87" class="node">
<title>expert_merge_2_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-13174.98 2417,-13174.98 2368.56,-13092.98 2556.88,-13092.98 2605.32,-13174.98"/>
<text text-anchor="middle" x="2486.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_Merge_2_2</text>
<text text-anchor="middle" x="2486.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_2_3_gpu0 -->
<g id="node88" class="node">
<title>expert_2_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-13154.48 2230.94,-13154.48 2230.94,-13113.48 2344.94,-13113.48 2344.94,-13154.48"/>
<text text-anchor="middle" x="2287.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_3_gpu1 -->
<g id="node89" class="node">
<title>expert_2_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-13154.48 2098.94,-13154.48 2098.94,-13113.48 2212.94,-13113.48 2212.94,-13154.48"/>
<text text-anchor="middle" x="2155.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_3 -->
<g id="node90" class="node">
<title>expert_merge_2_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-13174.98 1893,-13174.98 1844.56,-13092.98 2032.88,-13092.98 2081.32,-13174.98"/>
<text text-anchor="middle" x="1962.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_Merge_2_3</text>
<text text-anchor="middle" x="1962.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_2_62_gpu0 -->
<g id="node91" class="node">
<title>expert_2_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-13154.48 1706.94,-13154.48 1706.94,-13113.48 1820.94,-13113.48 1820.94,-13154.48"/>
<text text-anchor="middle" x="1763.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_62_gpu1 -->
<g id="node92" class="node">
<title>expert_2_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-13154.48 1574.94,-13154.48 1574.94,-13113.48 1688.94,-13113.48 1688.94,-13154.48"/>
<text text-anchor="middle" x="1631.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_62 -->
<g id="node93" class="node">
<title>expert_merge_2_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-13174.98 1369,-13174.98 1320.56,-13092.98 1508.88,-13092.98 1557.32,-13174.98"/>
<text text-anchor="middle" x="1438.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_Merge_2_62</text>
<text text-anchor="middle" x="1438.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_2_63_gpu0 -->
<g id="node94" class="node">
<title>expert_2_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-13154.48 1182.94,-13154.48 1182.94,-13113.48 1296.94,-13113.48 1296.94,-13154.48"/>
<text text-anchor="middle" x="1239.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_2_63_gpu1 -->
<g id="node95" class="node">
<title>expert_2_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-13154.48 1050.94,-13154.48 1050.94,-13113.48 1164.94,-13113.48 1164.94,-13154.48"/>
<text text-anchor="middle" x="1107.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_2_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_2_63 -->
<g id="node96" class="node">
<title>expert_merge_2_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-13174.98 845,-13174.98 796.56,-13092.98 984.88,-13092.98 1033.32,-13174.98"/>
<text text-anchor="middle" x="914.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_Merge_2_63</text>
<text text-anchor="middle" x="914.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_2 -->
<g id="node97" class="node">
<title>expert_agg_2</title>
<polygon fill="yellow" stroke="black" points="366.55,-13174.98 106.28,-13174.98 39.33,-13092.98 299.6,-13092.98 366.55,-13174.98"/>
<text text-anchor="middle" x="202.94" y="-13142.48" font-family="Arial" font-size="10.00">Expert_Aggregation_2</text>
<text text-anchor="middle" x="202.94" y="-13131.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-13120.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_2 -->
<g id="node98" class="node">
<title>add_norm_2_2</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-13056.98 143.44,-13056.98 143.44,-13015.98 276.44,-13015.98 276.44,-13056.98"/>
<text text-anchor="middle" x="209.94" y="-13044.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_2</text>
<text text-anchor="middle" x="209.94" y="-13033.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-13022.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_2&#45;&gt;add_norm_2_2 -->
<g id="edge48" class="edge">
<title>expert_agg_2&#45;&gt;add_norm_2_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-13092.76C206.52,-13084.18 207.17,-13075.27 207.76,-13067.17"/>
<polygon fill="red" stroke="red" points="211.26,-13067.32 208.5,-13057.09 204.28,-13066.81 211.26,-13067.32"/>
</g>
<!-- layer_norm_3 -->
<g id="node99" class="node">
<title>layer_norm_3</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-12965.98 252.44,-12965.98 252.44,-12924.98 385.44,-12924.98 385.44,-12965.98"/>
<text text-anchor="middle" x="318.94" y="-12953.98" font-family="Arial" font-size="10.00">LayerNorm_3</text>
<text text-anchor="middle" x="318.94" y="-12942.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-12931.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_2&#45;&gt;layer_norm_3 -->
<g id="edge49" class="edge">
<title>add_norm_2_2&#45;&gt;layer_norm_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-13015.95C249.37,-13003.29 269.77,-12986.63 286.7,-12972.81"/>
<polygon fill="red" stroke="red" points="289.17,-12975.31 294.7,-12966.28 284.74,-12969.89 289.17,-12975.31"/>
</g>
<!-- mha_split_3 -->
<g id="node100" class="node">
<title>mha_split_3</title>
<polygon fill="yellow" stroke="black" points="510.72,-12882.98 291.54,-12882.98 235.16,-12800.98 454.33,-12800.98 510.72,-12882.98"/>
<text text-anchor="middle" x="372.94" y="-12850.48" font-family="Arial" font-size="10.00">MHA_Split_3</text>
<text text-anchor="middle" x="372.94" y="-12839.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-12828.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_3&#45;&gt;mha_split_3 -->
<g id="edge50" class="edge">
<title>layer_norm_3&#45;&gt;mha_split_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-12924.91C334.38,-12915.46 340.67,-12903.64 346.89,-12891.95"/>
<polygon fill="red" stroke="red" points="350,-12893.55 351.61,-12883.08 343.82,-12890.26 350,-12893.55"/>
</g>
<!-- qkv_proj_3_gpu0 -->
<g id="node101" class="node">
<title>qkv_proj_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-12764.98 235.44,-12764.98 235.44,-12723.98 444.44,-12723.98 444.44,-12764.98"/>
<text text-anchor="middle" x="339.94" y="-12752.98" font-family="Arial" font-size="10.00">QKV_Proj_3_GPU0</text>
<text text-anchor="middle" x="339.94" y="-12741.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-12730.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_3&#45;&gt;qkv_proj_3_gpu0 -->
<g id="edge51" class="edge">
<title>mha_split_3&#45;&gt;qkv_proj_3_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-12800.76C356.01,-12791.99 352.86,-12782.87 350.01,-12774.63"/>
<polygon fill="red" stroke="red" points="353.29,-12773.4 346.72,-12765.09 346.67,-12775.69 353.29,-12773.4"/>
</g>
<!-- qkv_proj_3_gpu1 -->
<g id="node102" class="node">
<title>qkv_proj_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-12764.98 462.44,-12764.98 462.44,-12723.98 671.44,-12723.98 671.44,-12764.98"/>
<text text-anchor="middle" x="566.94" y="-12752.98" font-family="Arial" font-size="10.00">QKV_Proj_3_GPU1</text>
<text text-anchor="middle" x="566.94" y="-12741.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-12730.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_3&#45;&gt;qkv_proj_3_gpu1 -->
<g id="edge52" class="edge">
<title>mha_split_3&#45;&gt;qkv_proj_3_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-12800.9C476.02,-12790.24 498.74,-12779.06 518.05,-12769.55"/>
<polygon fill="red" stroke="red" points="519.81,-12772.58 527.24,-12765.03 516.72,-12766.3 519.81,-12772.58"/>
</g>
<!-- attn_3_gpu0 -->
<g id="node103" class="node">
<title>attn_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-12687.98 293.94,-12687.98 293.94,-12646.98 415.94,-12646.98 415.94,-12687.98"/>
<text text-anchor="middle" x="354.94" y="-12675.98" font-family="Arial" font-size="10.00">Attention_3_GPU0</text>
<text text-anchor="middle" x="354.94" y="-12664.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-12653.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_3_gpu0&#45;&gt;attn_3_gpu0 -->
<g id="edge53" class="edge">
<title>qkv_proj_3_gpu0&#45;&gt;attn_3_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-12723.78C345.45,-12715.94 347.29,-12706.75 349.01,-12698.14"/>
<polygon fill="red" stroke="red" points="352.5,-12698.55 351.02,-12688.06 345.63,-12697.18 352.5,-12698.55"/>
</g>
<!-- attn_3_gpu1 -->
<g id="node104" class="node">
<title>attn_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-12687.98 496.94,-12687.98 496.94,-12646.98 618.94,-12646.98 618.94,-12687.98"/>
<text text-anchor="middle" x="557.94" y="-12675.98" font-family="Arial" font-size="10.00">Attention_3_GPU1</text>
<text text-anchor="middle" x="557.94" y="-12664.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-12653.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_3_gpu1&#45;&gt;attn_3_gpu1 -->
<g id="edge54" class="edge">
<title>qkv_proj_3_gpu1&#45;&gt;attn_3_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-12723.78C563.63,-12715.94 562.53,-12706.75 561.5,-12698.14"/>
<polygon fill="red" stroke="red" points="564.96,-12697.57 560.29,-12688.06 558,-12698.4 564.96,-12697.57"/>
</g>
<!-- out_proj_3_gpu0 -->
<g id="node105" class="node">
<title>out_proj_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-12610.98 303.44,-12610.98 303.44,-12569.98 436.44,-12569.98 436.44,-12610.98"/>
<text text-anchor="middle" x="369.94" y="-12598.98" font-family="Arial" font-size="10.00">Output_Proj_3_GPU0</text>
<text text-anchor="middle" x="369.94" y="-12587.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-12576.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_3_gpu0&#45;&gt;out_proj_3_gpu0 -->
<g id="edge55" class="edge">
<title>attn_3_gpu0&#45;&gt;out_proj_3_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-12646.78C360.45,-12638.94 362.29,-12629.75 364.01,-12621.14"/>
<polygon fill="red" stroke="red" points="367.5,-12621.55 366.02,-12611.06 360.63,-12620.18 367.5,-12621.55"/>
</g>
<!-- out_proj_3_gpu1 -->
<g id="node106" class="node">
<title>out_proj_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-12610.98 483.44,-12610.98 483.44,-12569.98 616.44,-12569.98 616.44,-12610.98"/>
<text text-anchor="middle" x="549.94" y="-12598.98" font-family="Arial" font-size="10.00">Output_Proj_3_GPU1</text>
<text text-anchor="middle" x="549.94" y="-12587.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-12576.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_3_gpu1&#45;&gt;out_proj_3_gpu1 -->
<g id="edge56" class="edge">
<title>attn_3_gpu1&#45;&gt;out_proj_3_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-12646.78C555,-12638.94 554.02,-12629.75 553.1,-12621.14"/>
<polygon fill="red" stroke="red" points="556.57,-12620.63 552.03,-12611.06 549.61,-12621.37 556.57,-12620.63"/>
</g>
<!-- mha_merge_3 -->
<g id="node107" class="node">
<title>mha_merge_3</title>
<polygon fill="yellow" stroke="black" points="671.72,-12533.98 452.54,-12533.98 396.16,-12451.98 615.33,-12451.98 671.72,-12533.98"/>
<text text-anchor="middle" x="533.94" y="-12501.48" font-family="Arial" font-size="10.00">MHA_Merge_3</text>
<text text-anchor="middle" x="533.94" y="-12490.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-12479.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_3_gpu0&#45;&gt;mha_merge_3 -->
<g id="edge57" class="edge">
<title>out_proj_3_gpu0&#45;&gt;mha_merge_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-12569.93C418.89,-12560.98 437.8,-12549.97 456.4,-12539.13"/>
<polygon fill="red" stroke="red" points="458.32,-12542.07 465.2,-12534.01 454.8,-12536.02 458.32,-12542.07"/>
</g>
<!-- out_proj_3_gpu1&#45;&gt;mha_merge_3 -->
<g id="edge58" class="edge">
<title>out_proj_3_gpu1&#45;&gt;mha_merge_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-12569.7C545.37,-12562.23 543.89,-12553.36 542.38,-12544.37"/>
<polygon fill="red" stroke="red" points="545.79,-12543.51 540.68,-12534.23 538.88,-12544.67 545.79,-12543.51"/>
</g>
<!-- add_norm_1_3 -->
<g id="node108" class="node">
<title>add_norm_1_3</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-12415.98 481.44,-12415.98 481.44,-12374.98 614.44,-12374.98 614.44,-12415.98"/>
<text text-anchor="middle" x="547.94" y="-12403.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_3</text>
<text text-anchor="middle" x="547.94" y="-12392.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-12381.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_3&#45;&gt;add_norm_1_3 -->
<g id="edge59" class="edge">
<title>mha_merge_3&#45;&gt;add_norm_1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-12451.76C541.09,-12443.18 542.4,-12434.27 543.59,-12426.17"/>
<polygon fill="red" stroke="red" points="547.08,-12426.5 545.06,-12416.09 540.15,-12425.48 547.08,-12426.5"/>
</g>
<!-- gate_3 -->
<g id="node109" class="node">
<title>gate_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-12338.98 440.78,-12338.98 347.84,-12256.98 709.1,-12256.98 802.04,-12338.98"/>
<text text-anchor="middle" x="574.94" y="-12306.48" font-family="Arial" font-size="10.00">Expert_Gate_3</text>
<text text-anchor="middle" x="574.94" y="-12295.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-12284.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_3&#45;&gt;gate_3 -->
<g id="edge60" class="edge">
<title>add_norm_1_3&#45;&gt;gate_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-12374.7C555.67,-12367.15 558.21,-12358.17 560.78,-12349.08"/>
<polygon fill="red" stroke="red" points="564.21,-12349.8 563.56,-12339.23 557.47,-12347.9 564.21,-12349.8"/>
</g>
<!-- token_dist_3 -->
<g id="node110" class="node">
<title>token_dist_3</title>
<polygon fill="yellow" stroke="black" points="778.91,-12180.98 465.58,-12180.98 384.97,-12098.98 698.3,-12098.98 778.91,-12180.98"/>
<text text-anchor="middle" x="581.94" y="-12148.48" font-family="Arial" font-size="10.00">Token_Distribution_3</text>
<text text-anchor="middle" x="581.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_3&#45;&gt;token_dist_3 -->
<g id="edge61" class="edge">
<title>gate_3&#45;&gt;token_dist_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-12256.81C577.64,-12236.79 578.74,-12212.39 579.69,-12191.16"/>
<polygon fill="red" stroke="red" points="583.19,-12191.17 580.14,-12181.02 576.2,-12190.85 583.19,-12191.17"/>
</g>
<!-- token_dist_3&#45;&gt;expert_0_0 -->
<g id="edge62" class="edge">
<title>token_dist_3&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-12100.73C727.77,-12093.41 757.15,-12086.84 784.94,-12082.98 1132.73,-12034.77 3597.25,-12111.94 3944.94,-12062.98 4125.03,-12037.63 4338.94,-12134.35 4338.94,-11952.48 4338.94,-11952.48 4338.94,-11952.48 4338.94,-1362.98 4338.94,-1265.7 4358.41,-1220.94 4292.94,-1148.98 4273.4,-1127.51 4242.3,-1117.63 4216,-1113.12"/>
<polygon fill="red" stroke="red" points="4216.23,-1109.61 4205.83,-1111.59 4215.2,-1116.54 4216.23,-1109.61"/>
</g>
<!-- expert_3_0_gpu0 -->
<g id="node111" class="node">
<title>expert_3_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-12160.48 3802.94,-12160.48 3802.94,-12119.48 3916.94,-12119.48 3916.94,-12160.48"/>
<text text-anchor="middle" x="3859.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_0_gpu1 -->
<g id="node112" class="node">
<title>expert_3_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-12160.48 3670.94,-12160.48 3670.94,-12119.48 3784.94,-12119.48 3784.94,-12160.48"/>
<text text-anchor="middle" x="3727.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_0 -->
<g id="node113" class="node">
<title>expert_merge_3_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-12180.98 3465,-12180.98 3416.56,-12098.98 3604.88,-12098.98 3653.32,-12180.98"/>
<text text-anchor="middle" x="3534.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_Merge_3_0</text>
<text text-anchor="middle" x="3534.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_3_1_gpu0 -->
<g id="node114" class="node">
<title>expert_3_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-12160.48 3278.94,-12160.48 3278.94,-12119.48 3392.94,-12119.48 3392.94,-12160.48"/>
<text text-anchor="middle" x="3335.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_1_gpu1 -->
<g id="node115" class="node">
<title>expert_3_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-12160.48 3146.94,-12160.48 3146.94,-12119.48 3260.94,-12119.48 3260.94,-12160.48"/>
<text text-anchor="middle" x="3203.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_1 -->
<g id="node116" class="node">
<title>expert_merge_3_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-12180.98 2941,-12180.98 2892.56,-12098.98 3080.88,-12098.98 3129.32,-12180.98"/>
<text text-anchor="middle" x="3010.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_Merge_3_1</text>
<text text-anchor="middle" x="3010.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_3_2_gpu0 -->
<g id="node117" class="node">
<title>expert_3_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-12160.48 2754.94,-12160.48 2754.94,-12119.48 2868.94,-12119.48 2868.94,-12160.48"/>
<text text-anchor="middle" x="2811.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_2_gpu1 -->
<g id="node118" class="node">
<title>expert_3_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-12160.48 2622.94,-12160.48 2622.94,-12119.48 2736.94,-12119.48 2736.94,-12160.48"/>
<text text-anchor="middle" x="2679.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_2 -->
<g id="node119" class="node">
<title>expert_merge_3_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-12180.98 2417,-12180.98 2368.56,-12098.98 2556.88,-12098.98 2605.32,-12180.98"/>
<text text-anchor="middle" x="2486.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_Merge_3_2</text>
<text text-anchor="middle" x="2486.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_3_3_gpu0 -->
<g id="node120" class="node">
<title>expert_3_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-12160.48 2230.94,-12160.48 2230.94,-12119.48 2344.94,-12119.48 2344.94,-12160.48"/>
<text text-anchor="middle" x="2287.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_3_gpu1 -->
<g id="node121" class="node">
<title>expert_3_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-12160.48 2098.94,-12160.48 2098.94,-12119.48 2212.94,-12119.48 2212.94,-12160.48"/>
<text text-anchor="middle" x="2155.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_3 -->
<g id="node122" class="node">
<title>expert_merge_3_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-12180.98 1893,-12180.98 1844.56,-12098.98 2032.88,-12098.98 2081.32,-12180.98"/>
<text text-anchor="middle" x="1962.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_Merge_3_3</text>
<text text-anchor="middle" x="1962.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_3_62_gpu0 -->
<g id="node123" class="node">
<title>expert_3_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-12160.48 1706.94,-12160.48 1706.94,-12119.48 1820.94,-12119.48 1820.94,-12160.48"/>
<text text-anchor="middle" x="1763.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_62_gpu1 -->
<g id="node124" class="node">
<title>expert_3_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-12160.48 1574.94,-12160.48 1574.94,-12119.48 1688.94,-12119.48 1688.94,-12160.48"/>
<text text-anchor="middle" x="1631.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_62 -->
<g id="node125" class="node">
<title>expert_merge_3_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-12180.98 1369,-12180.98 1320.56,-12098.98 1508.88,-12098.98 1557.32,-12180.98"/>
<text text-anchor="middle" x="1438.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_Merge_3_62</text>
<text text-anchor="middle" x="1438.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_3_63_gpu0 -->
<g id="node126" class="node">
<title>expert_3_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-12160.48 1182.94,-12160.48 1182.94,-12119.48 1296.94,-12119.48 1296.94,-12160.48"/>
<text text-anchor="middle" x="1239.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_3_63_gpu1 -->
<g id="node127" class="node">
<title>expert_3_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-12160.48 1050.94,-12160.48 1050.94,-12119.48 1164.94,-12119.48 1164.94,-12160.48"/>
<text text-anchor="middle" x="1107.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_3_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_3_63 -->
<g id="node128" class="node">
<title>expert_merge_3_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-12180.98 845,-12180.98 796.56,-12098.98 984.88,-12098.98 1033.32,-12180.98"/>
<text text-anchor="middle" x="914.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_Merge_3_63</text>
<text text-anchor="middle" x="914.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_3 -->
<g id="node129" class="node">
<title>expert_agg_3</title>
<polygon fill="yellow" stroke="black" points="366.55,-12180.98 106.28,-12180.98 39.33,-12098.98 299.6,-12098.98 366.55,-12180.98"/>
<text text-anchor="middle" x="202.94" y="-12148.48" font-family="Arial" font-size="10.00">Expert_Aggregation_3</text>
<text text-anchor="middle" x="202.94" y="-12137.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-12126.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_3 -->
<g id="node130" class="node">
<title>add_norm_2_3</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-12062.98 143.44,-12062.98 143.44,-12021.98 276.44,-12021.98 276.44,-12062.98"/>
<text text-anchor="middle" x="209.94" y="-12050.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_3</text>
<text text-anchor="middle" x="209.94" y="-12039.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-12028.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_3&#45;&gt;add_norm_2_3 -->
<g id="edge64" class="edge">
<title>expert_agg_3&#45;&gt;add_norm_2_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-12098.76C206.52,-12090.18 207.17,-12081.27 207.76,-12073.17"/>
<polygon fill="red" stroke="red" points="211.26,-12073.32 208.5,-12063.09 204.28,-12072.81 211.26,-12073.32"/>
</g>
<!-- layer_norm_4 -->
<g id="node131" class="node">
<title>layer_norm_4</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-11971.98 252.44,-11971.98 252.44,-11930.98 385.44,-11930.98 385.44,-11971.98"/>
<text text-anchor="middle" x="318.94" y="-11959.98" font-family="Arial" font-size="10.00">LayerNorm_4</text>
<text text-anchor="middle" x="318.94" y="-11948.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-11937.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_3&#45;&gt;layer_norm_4 -->
<g id="edge65" class="edge">
<title>add_norm_2_3&#45;&gt;layer_norm_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-12021.95C249.37,-12009.29 269.77,-11992.63 286.7,-11978.81"/>
<polygon fill="red" stroke="red" points="289.17,-11981.31 294.7,-11972.28 284.74,-11975.89 289.17,-11981.31"/>
</g>
<!-- mha_split_4 -->
<g id="node132" class="node">
<title>mha_split_4</title>
<polygon fill="yellow" stroke="black" points="510.72,-11888.98 291.54,-11888.98 235.16,-11806.98 454.33,-11806.98 510.72,-11888.98"/>
<text text-anchor="middle" x="372.94" y="-11856.48" font-family="Arial" font-size="10.00">MHA_Split_4</text>
<text text-anchor="middle" x="372.94" y="-11845.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-11834.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_4&#45;&gt;mha_split_4 -->
<g id="edge66" class="edge">
<title>layer_norm_4&#45;&gt;mha_split_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-11930.91C334.38,-11921.46 340.67,-11909.64 346.89,-11897.95"/>
<polygon fill="red" stroke="red" points="350,-11899.55 351.61,-11889.08 343.82,-11896.26 350,-11899.55"/>
</g>
<!-- qkv_proj_4_gpu0 -->
<g id="node133" class="node">
<title>qkv_proj_4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-11770.98 235.44,-11770.98 235.44,-11729.98 444.44,-11729.98 444.44,-11770.98"/>
<text text-anchor="middle" x="339.94" y="-11758.98" font-family="Arial" font-size="10.00">QKV_Proj_4_GPU0</text>
<text text-anchor="middle" x="339.94" y="-11747.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-11736.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_4&#45;&gt;qkv_proj_4_gpu0 -->
<g id="edge67" class="edge">
<title>mha_split_4&#45;&gt;qkv_proj_4_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-11806.76C356.01,-11797.99 352.86,-11788.87 350.01,-11780.63"/>
<polygon fill="red" stroke="red" points="353.29,-11779.4 346.72,-11771.09 346.67,-11781.69 353.29,-11779.4"/>
</g>
<!-- qkv_proj_4_gpu1 -->
<g id="node134" class="node">
<title>qkv_proj_4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-11770.98 462.44,-11770.98 462.44,-11729.98 671.44,-11729.98 671.44,-11770.98"/>
<text text-anchor="middle" x="566.94" y="-11758.98" font-family="Arial" font-size="10.00">QKV_Proj_4_GPU1</text>
<text text-anchor="middle" x="566.94" y="-11747.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-11736.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_4&#45;&gt;qkv_proj_4_gpu1 -->
<g id="edge68" class="edge">
<title>mha_split_4&#45;&gt;qkv_proj_4_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-11806.9C476.02,-11796.24 498.74,-11785.06 518.05,-11775.55"/>
<polygon fill="red" stroke="red" points="519.81,-11778.58 527.24,-11771.03 516.72,-11772.3 519.81,-11778.58"/>
</g>
<!-- attn_4_gpu0 -->
<g id="node135" class="node">
<title>attn_4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-11693.98 293.94,-11693.98 293.94,-11652.98 415.94,-11652.98 415.94,-11693.98"/>
<text text-anchor="middle" x="354.94" y="-11681.98" font-family="Arial" font-size="10.00">Attention_4_GPU0</text>
<text text-anchor="middle" x="354.94" y="-11670.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-11659.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_4_gpu0&#45;&gt;attn_4_gpu0 -->
<g id="edge69" class="edge">
<title>qkv_proj_4_gpu0&#45;&gt;attn_4_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-11729.78C345.45,-11721.94 347.29,-11712.75 349.01,-11704.14"/>
<polygon fill="red" stroke="red" points="352.5,-11704.55 351.02,-11694.06 345.63,-11703.18 352.5,-11704.55"/>
</g>
<!-- attn_4_gpu1 -->
<g id="node136" class="node">
<title>attn_4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-11693.98 496.94,-11693.98 496.94,-11652.98 618.94,-11652.98 618.94,-11693.98"/>
<text text-anchor="middle" x="557.94" y="-11681.98" font-family="Arial" font-size="10.00">Attention_4_GPU1</text>
<text text-anchor="middle" x="557.94" y="-11670.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-11659.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_4_gpu1&#45;&gt;attn_4_gpu1 -->
<g id="edge70" class="edge">
<title>qkv_proj_4_gpu1&#45;&gt;attn_4_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-11729.78C563.63,-11721.94 562.53,-11712.75 561.5,-11704.14"/>
<polygon fill="red" stroke="red" points="564.96,-11703.57 560.29,-11694.06 558,-11704.4 564.96,-11703.57"/>
</g>
<!-- out_proj_4_gpu0 -->
<g id="node137" class="node">
<title>out_proj_4_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-11616.98 303.44,-11616.98 303.44,-11575.98 436.44,-11575.98 436.44,-11616.98"/>
<text text-anchor="middle" x="369.94" y="-11604.98" font-family="Arial" font-size="10.00">Output_Proj_4_GPU0</text>
<text text-anchor="middle" x="369.94" y="-11593.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-11582.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_4_gpu0&#45;&gt;out_proj_4_gpu0 -->
<g id="edge71" class="edge">
<title>attn_4_gpu0&#45;&gt;out_proj_4_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-11652.78C360.45,-11644.94 362.29,-11635.75 364.01,-11627.14"/>
<polygon fill="red" stroke="red" points="367.5,-11627.55 366.02,-11617.06 360.63,-11626.18 367.5,-11627.55"/>
</g>
<!-- out_proj_4_gpu1 -->
<g id="node138" class="node">
<title>out_proj_4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-11616.98 483.44,-11616.98 483.44,-11575.98 616.44,-11575.98 616.44,-11616.98"/>
<text text-anchor="middle" x="549.94" y="-11604.98" font-family="Arial" font-size="10.00">Output_Proj_4_GPU1</text>
<text text-anchor="middle" x="549.94" y="-11593.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-11582.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_4_gpu1&#45;&gt;out_proj_4_gpu1 -->
<g id="edge72" class="edge">
<title>attn_4_gpu1&#45;&gt;out_proj_4_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-11652.78C555,-11644.94 554.02,-11635.75 553.1,-11627.14"/>
<polygon fill="red" stroke="red" points="556.57,-11626.63 552.03,-11617.06 549.61,-11627.37 556.57,-11626.63"/>
</g>
<!-- mha_merge_4 -->
<g id="node139" class="node">
<title>mha_merge_4</title>
<polygon fill="yellow" stroke="black" points="671.72,-11539.98 452.54,-11539.98 396.16,-11457.98 615.33,-11457.98 671.72,-11539.98"/>
<text text-anchor="middle" x="533.94" y="-11507.48" font-family="Arial" font-size="10.00">MHA_Merge_4</text>
<text text-anchor="middle" x="533.94" y="-11496.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-11485.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_4_gpu0&#45;&gt;mha_merge_4 -->
<g id="edge73" class="edge">
<title>out_proj_4_gpu0&#45;&gt;mha_merge_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-11575.93C418.89,-11566.98 437.8,-11555.97 456.4,-11545.13"/>
<polygon fill="red" stroke="red" points="458.32,-11548.07 465.2,-11540.01 454.8,-11542.02 458.32,-11548.07"/>
</g>
<!-- out_proj_4_gpu1&#45;&gt;mha_merge_4 -->
<g id="edge74" class="edge">
<title>out_proj_4_gpu1&#45;&gt;mha_merge_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-11575.7C545.37,-11568.23 543.89,-11559.36 542.38,-11550.37"/>
<polygon fill="red" stroke="red" points="545.79,-11549.51 540.68,-11540.23 538.88,-11550.67 545.79,-11549.51"/>
</g>
<!-- add_norm_1_4 -->
<g id="node140" class="node">
<title>add_norm_1_4</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-11421.98 481.44,-11421.98 481.44,-11380.98 614.44,-11380.98 614.44,-11421.98"/>
<text text-anchor="middle" x="547.94" y="-11409.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_4</text>
<text text-anchor="middle" x="547.94" y="-11398.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-11387.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_4&#45;&gt;add_norm_1_4 -->
<g id="edge75" class="edge">
<title>mha_merge_4&#45;&gt;add_norm_1_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-11457.76C541.09,-11449.18 542.4,-11440.27 543.59,-11432.17"/>
<polygon fill="red" stroke="red" points="547.08,-11432.5 545.06,-11422.09 540.15,-11431.48 547.08,-11432.5"/>
</g>
<!-- gate_4 -->
<g id="node141" class="node">
<title>gate_4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-11344.98 440.78,-11344.98 347.84,-11262.98 709.1,-11262.98 802.04,-11344.98"/>
<text text-anchor="middle" x="574.94" y="-11312.48" font-family="Arial" font-size="10.00">Expert_Gate_4</text>
<text text-anchor="middle" x="574.94" y="-11301.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-11290.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_4&#45;&gt;gate_4 -->
<g id="edge76" class="edge">
<title>add_norm_1_4&#45;&gt;gate_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-11380.7C555.67,-11373.15 558.21,-11364.17 560.78,-11355.08"/>
<polygon fill="red" stroke="red" points="564.21,-11355.8 563.56,-11345.23 557.47,-11353.9 564.21,-11355.8"/>
</g>
<!-- token_dist_4 -->
<g id="node142" class="node">
<title>token_dist_4</title>
<polygon fill="yellow" stroke="black" points="778.91,-11186.98 465.58,-11186.98 384.97,-11104.98 698.3,-11104.98 778.91,-11186.98"/>
<text text-anchor="middle" x="581.94" y="-11154.48" font-family="Arial" font-size="10.00">Token_Distribution_4</text>
<text text-anchor="middle" x="581.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_4&#45;&gt;token_dist_4 -->
<g id="edge77" class="edge">
<title>gate_4&#45;&gt;token_dist_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-11262.81C577.64,-11242.79 578.74,-11218.39 579.69,-11197.16"/>
<polygon fill="red" stroke="red" points="583.19,-11197.17 580.14,-11187.02 576.2,-11196.85 583.19,-11197.17"/>
</g>
<!-- token_dist_4&#45;&gt;expert_0_0 -->
<g id="edge78" class="edge">
<title>token_dist_4&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-11106.73C727.77,-11099.41 757.15,-11092.84 784.94,-11088.98 1132.73,-11040.77 3597.96,-11122.72 3944.94,-11068.98 4108.66,-11043.63 4300.94,-11124.15 4300.94,-10958.48 4300.94,-10958.48 4300.94,-10958.48 4300.94,-1362.98 4300.94,-1265.79 4316.91,-1224.67 4255.94,-1148.98 4244.89,-1135.27 4228.07,-1126.15 4212.08,-1120.18"/>
<polygon fill="red" stroke="red" points="4212.89,-1116.75 4202.29,-1116.85 4210.63,-1123.38 4212.89,-1116.75"/>
</g>
<!-- expert_4_0_gpu0 -->
<g id="node143" class="node">
<title>expert_4_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-11166.48 3802.94,-11166.48 3802.94,-11125.48 3916.94,-11125.48 3916.94,-11166.48"/>
<text text-anchor="middle" x="3859.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_0_gpu1 -->
<g id="node144" class="node">
<title>expert_4_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-11166.48 3670.94,-11166.48 3670.94,-11125.48 3784.94,-11125.48 3784.94,-11166.48"/>
<text text-anchor="middle" x="3727.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_0 -->
<g id="node145" class="node">
<title>expert_merge_4_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-11186.98 3465,-11186.98 3416.56,-11104.98 3604.88,-11104.98 3653.32,-11186.98"/>
<text text-anchor="middle" x="3534.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_Merge_4_0</text>
<text text-anchor="middle" x="3534.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_4_1_gpu0 -->
<g id="node146" class="node">
<title>expert_4_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-11166.48 3278.94,-11166.48 3278.94,-11125.48 3392.94,-11125.48 3392.94,-11166.48"/>
<text text-anchor="middle" x="3335.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_1_gpu1 -->
<g id="node147" class="node">
<title>expert_4_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-11166.48 3146.94,-11166.48 3146.94,-11125.48 3260.94,-11125.48 3260.94,-11166.48"/>
<text text-anchor="middle" x="3203.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_1 -->
<g id="node148" class="node">
<title>expert_merge_4_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-11186.98 2941,-11186.98 2892.56,-11104.98 3080.88,-11104.98 3129.32,-11186.98"/>
<text text-anchor="middle" x="3010.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_Merge_4_1</text>
<text text-anchor="middle" x="3010.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_4_2_gpu0 -->
<g id="node149" class="node">
<title>expert_4_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-11166.48 2754.94,-11166.48 2754.94,-11125.48 2868.94,-11125.48 2868.94,-11166.48"/>
<text text-anchor="middle" x="2811.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_2_gpu1 -->
<g id="node150" class="node">
<title>expert_4_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-11166.48 2622.94,-11166.48 2622.94,-11125.48 2736.94,-11125.48 2736.94,-11166.48"/>
<text text-anchor="middle" x="2679.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_2 -->
<g id="node151" class="node">
<title>expert_merge_4_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-11186.98 2417,-11186.98 2368.56,-11104.98 2556.88,-11104.98 2605.32,-11186.98"/>
<text text-anchor="middle" x="2486.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_Merge_4_2</text>
<text text-anchor="middle" x="2486.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_4_3_gpu0 -->
<g id="node152" class="node">
<title>expert_4_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-11166.48 2230.94,-11166.48 2230.94,-11125.48 2344.94,-11125.48 2344.94,-11166.48"/>
<text text-anchor="middle" x="2287.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_3_gpu1 -->
<g id="node153" class="node">
<title>expert_4_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-11166.48 2098.94,-11166.48 2098.94,-11125.48 2212.94,-11125.48 2212.94,-11166.48"/>
<text text-anchor="middle" x="2155.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_3 -->
<g id="node154" class="node">
<title>expert_merge_4_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-11186.98 1893,-11186.98 1844.56,-11104.98 2032.88,-11104.98 2081.32,-11186.98"/>
<text text-anchor="middle" x="1962.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_Merge_4_3</text>
<text text-anchor="middle" x="1962.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_4_62_gpu0 -->
<g id="node155" class="node">
<title>expert_4_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-11166.48 1706.94,-11166.48 1706.94,-11125.48 1820.94,-11125.48 1820.94,-11166.48"/>
<text text-anchor="middle" x="1763.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_62_gpu1 -->
<g id="node156" class="node">
<title>expert_4_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-11166.48 1574.94,-11166.48 1574.94,-11125.48 1688.94,-11125.48 1688.94,-11166.48"/>
<text text-anchor="middle" x="1631.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_62 -->
<g id="node157" class="node">
<title>expert_merge_4_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-11186.98 1369,-11186.98 1320.56,-11104.98 1508.88,-11104.98 1557.32,-11186.98"/>
<text text-anchor="middle" x="1438.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_Merge_4_62</text>
<text text-anchor="middle" x="1438.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_4_63_gpu0 -->
<g id="node158" class="node">
<title>expert_4_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-11166.48 1182.94,-11166.48 1182.94,-11125.48 1296.94,-11125.48 1296.94,-11166.48"/>
<text text-anchor="middle" x="1239.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_4_63_gpu1 -->
<g id="node159" class="node">
<title>expert_4_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-11166.48 1050.94,-11166.48 1050.94,-11125.48 1164.94,-11125.48 1164.94,-11166.48"/>
<text text-anchor="middle" x="1107.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_4_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_4_63 -->
<g id="node160" class="node">
<title>expert_merge_4_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-11186.98 845,-11186.98 796.56,-11104.98 984.88,-11104.98 1033.32,-11186.98"/>
<text text-anchor="middle" x="914.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_Merge_4_63</text>
<text text-anchor="middle" x="914.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_4 -->
<g id="node161" class="node">
<title>expert_agg_4</title>
<polygon fill="yellow" stroke="black" points="366.55,-11186.98 106.28,-11186.98 39.33,-11104.98 299.6,-11104.98 366.55,-11186.98"/>
<text text-anchor="middle" x="202.94" y="-11154.48" font-family="Arial" font-size="10.00">Expert_Aggregation_4</text>
<text text-anchor="middle" x="202.94" y="-11143.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-11132.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_4 -->
<g id="node162" class="node">
<title>add_norm_2_4</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-11068.98 143.44,-11068.98 143.44,-11027.98 276.44,-11027.98 276.44,-11068.98"/>
<text text-anchor="middle" x="209.94" y="-11056.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_4</text>
<text text-anchor="middle" x="209.94" y="-11045.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-11034.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_4&#45;&gt;add_norm_2_4 -->
<g id="edge80" class="edge">
<title>expert_agg_4&#45;&gt;add_norm_2_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-11104.76C206.52,-11096.18 207.17,-11087.27 207.76,-11079.17"/>
<polygon fill="red" stroke="red" points="211.26,-11079.32 208.5,-11069.09 204.28,-11078.81 211.26,-11079.32"/>
</g>
<!-- layer_norm_5 -->
<g id="node163" class="node">
<title>layer_norm_5</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-10977.98 252.44,-10977.98 252.44,-10936.98 385.44,-10936.98 385.44,-10977.98"/>
<text text-anchor="middle" x="318.94" y="-10965.98" font-family="Arial" font-size="10.00">LayerNorm_5</text>
<text text-anchor="middle" x="318.94" y="-10954.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-10943.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_4&#45;&gt;layer_norm_5 -->
<g id="edge81" class="edge">
<title>add_norm_2_4&#45;&gt;layer_norm_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-11027.95C249.37,-11015.29 269.77,-10998.63 286.7,-10984.81"/>
<polygon fill="red" stroke="red" points="289.17,-10987.31 294.7,-10978.28 284.74,-10981.89 289.17,-10987.31"/>
</g>
<!-- mha_split_5 -->
<g id="node164" class="node">
<title>mha_split_5</title>
<polygon fill="yellow" stroke="black" points="510.72,-10894.98 291.54,-10894.98 235.16,-10812.98 454.33,-10812.98 510.72,-10894.98"/>
<text text-anchor="middle" x="372.94" y="-10862.48" font-family="Arial" font-size="10.00">MHA_Split_5</text>
<text text-anchor="middle" x="372.94" y="-10851.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-10840.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_5&#45;&gt;mha_split_5 -->
<g id="edge82" class="edge">
<title>layer_norm_5&#45;&gt;mha_split_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-10936.91C334.38,-10927.46 340.67,-10915.64 346.89,-10903.95"/>
<polygon fill="red" stroke="red" points="350,-10905.55 351.61,-10895.08 343.82,-10902.26 350,-10905.55"/>
</g>
<!-- qkv_proj_5_gpu0 -->
<g id="node165" class="node">
<title>qkv_proj_5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-10776.98 235.44,-10776.98 235.44,-10735.98 444.44,-10735.98 444.44,-10776.98"/>
<text text-anchor="middle" x="339.94" y="-10764.98" font-family="Arial" font-size="10.00">QKV_Proj_5_GPU0</text>
<text text-anchor="middle" x="339.94" y="-10753.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-10742.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_5&#45;&gt;qkv_proj_5_gpu0 -->
<g id="edge83" class="edge">
<title>mha_split_5&#45;&gt;qkv_proj_5_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-10812.76C356.01,-10803.99 352.86,-10794.87 350.01,-10786.63"/>
<polygon fill="red" stroke="red" points="353.29,-10785.4 346.72,-10777.09 346.67,-10787.69 353.29,-10785.4"/>
</g>
<!-- qkv_proj_5_gpu1 -->
<g id="node166" class="node">
<title>qkv_proj_5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-10776.98 462.44,-10776.98 462.44,-10735.98 671.44,-10735.98 671.44,-10776.98"/>
<text text-anchor="middle" x="566.94" y="-10764.98" font-family="Arial" font-size="10.00">QKV_Proj_5_GPU1</text>
<text text-anchor="middle" x="566.94" y="-10753.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-10742.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_5&#45;&gt;qkv_proj_5_gpu1 -->
<g id="edge84" class="edge">
<title>mha_split_5&#45;&gt;qkv_proj_5_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-10812.9C476.02,-10802.24 498.74,-10791.06 518.05,-10781.55"/>
<polygon fill="red" stroke="red" points="519.81,-10784.58 527.24,-10777.03 516.72,-10778.3 519.81,-10784.58"/>
</g>
<!-- attn_5_gpu0 -->
<g id="node167" class="node">
<title>attn_5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-10699.98 293.94,-10699.98 293.94,-10658.98 415.94,-10658.98 415.94,-10699.98"/>
<text text-anchor="middle" x="354.94" y="-10687.98" font-family="Arial" font-size="10.00">Attention_5_GPU0</text>
<text text-anchor="middle" x="354.94" y="-10676.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-10665.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_5_gpu0&#45;&gt;attn_5_gpu0 -->
<g id="edge85" class="edge">
<title>qkv_proj_5_gpu0&#45;&gt;attn_5_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-10735.78C345.45,-10727.94 347.29,-10718.75 349.01,-10710.14"/>
<polygon fill="red" stroke="red" points="352.5,-10710.55 351.02,-10700.06 345.63,-10709.18 352.5,-10710.55"/>
</g>
<!-- attn_5_gpu1 -->
<g id="node168" class="node">
<title>attn_5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-10699.98 496.94,-10699.98 496.94,-10658.98 618.94,-10658.98 618.94,-10699.98"/>
<text text-anchor="middle" x="557.94" y="-10687.98" font-family="Arial" font-size="10.00">Attention_5_GPU1</text>
<text text-anchor="middle" x="557.94" y="-10676.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-10665.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_5_gpu1&#45;&gt;attn_5_gpu1 -->
<g id="edge86" class="edge">
<title>qkv_proj_5_gpu1&#45;&gt;attn_5_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-10735.78C563.63,-10727.94 562.53,-10718.75 561.5,-10710.14"/>
<polygon fill="red" stroke="red" points="564.96,-10709.57 560.29,-10700.06 558,-10710.4 564.96,-10709.57"/>
</g>
<!-- out_proj_5_gpu0 -->
<g id="node169" class="node">
<title>out_proj_5_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-10622.98 303.44,-10622.98 303.44,-10581.98 436.44,-10581.98 436.44,-10622.98"/>
<text text-anchor="middle" x="369.94" y="-10610.98" font-family="Arial" font-size="10.00">Output_Proj_5_GPU0</text>
<text text-anchor="middle" x="369.94" y="-10599.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-10588.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_5_gpu0&#45;&gt;out_proj_5_gpu0 -->
<g id="edge87" class="edge">
<title>attn_5_gpu0&#45;&gt;out_proj_5_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-10658.78C360.45,-10650.94 362.29,-10641.75 364.01,-10633.14"/>
<polygon fill="red" stroke="red" points="367.5,-10633.55 366.02,-10623.06 360.63,-10632.18 367.5,-10633.55"/>
</g>
<!-- out_proj_5_gpu1 -->
<g id="node170" class="node">
<title>out_proj_5_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-10622.98 483.44,-10622.98 483.44,-10581.98 616.44,-10581.98 616.44,-10622.98"/>
<text text-anchor="middle" x="549.94" y="-10610.98" font-family="Arial" font-size="10.00">Output_Proj_5_GPU1</text>
<text text-anchor="middle" x="549.94" y="-10599.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-10588.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_5_gpu1&#45;&gt;out_proj_5_gpu1 -->
<g id="edge88" class="edge">
<title>attn_5_gpu1&#45;&gt;out_proj_5_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-10658.78C555,-10650.94 554.02,-10641.75 553.1,-10633.14"/>
<polygon fill="red" stroke="red" points="556.57,-10632.63 552.03,-10623.06 549.61,-10633.37 556.57,-10632.63"/>
</g>
<!-- mha_merge_5 -->
<g id="node171" class="node">
<title>mha_merge_5</title>
<polygon fill="yellow" stroke="black" points="671.72,-10545.98 452.54,-10545.98 396.16,-10463.98 615.33,-10463.98 671.72,-10545.98"/>
<text text-anchor="middle" x="533.94" y="-10513.48" font-family="Arial" font-size="10.00">MHA_Merge_5</text>
<text text-anchor="middle" x="533.94" y="-10502.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-10491.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_5_gpu0&#45;&gt;mha_merge_5 -->
<g id="edge89" class="edge">
<title>out_proj_5_gpu0&#45;&gt;mha_merge_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-10581.93C418.89,-10572.98 437.8,-10561.97 456.4,-10551.13"/>
<polygon fill="red" stroke="red" points="458.32,-10554.07 465.2,-10546.01 454.8,-10548.02 458.32,-10554.07"/>
</g>
<!-- out_proj_5_gpu1&#45;&gt;mha_merge_5 -->
<g id="edge90" class="edge">
<title>out_proj_5_gpu1&#45;&gt;mha_merge_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-10581.7C545.37,-10574.23 543.89,-10565.36 542.38,-10556.37"/>
<polygon fill="red" stroke="red" points="545.79,-10555.51 540.68,-10546.23 538.88,-10556.67 545.79,-10555.51"/>
</g>
<!-- add_norm_1_5 -->
<g id="node172" class="node">
<title>add_norm_1_5</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-10427.98 481.44,-10427.98 481.44,-10386.98 614.44,-10386.98 614.44,-10427.98"/>
<text text-anchor="middle" x="547.94" y="-10415.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_5</text>
<text text-anchor="middle" x="547.94" y="-10404.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-10393.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_5&#45;&gt;add_norm_1_5 -->
<g id="edge91" class="edge">
<title>mha_merge_5&#45;&gt;add_norm_1_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-10463.76C541.09,-10455.18 542.4,-10446.27 543.59,-10438.17"/>
<polygon fill="red" stroke="red" points="547.08,-10438.5 545.06,-10428.09 540.15,-10437.48 547.08,-10438.5"/>
</g>
<!-- gate_5 -->
<g id="node173" class="node">
<title>gate_5</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-10350.98 440.78,-10350.98 347.84,-10268.98 709.1,-10268.98 802.04,-10350.98"/>
<text text-anchor="middle" x="574.94" y="-10318.48" font-family="Arial" font-size="10.00">Expert_Gate_5</text>
<text text-anchor="middle" x="574.94" y="-10307.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-10296.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_5&#45;&gt;gate_5 -->
<g id="edge92" class="edge">
<title>add_norm_1_5&#45;&gt;gate_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-10386.7C555.67,-10379.15 558.21,-10370.17 560.78,-10361.08"/>
<polygon fill="red" stroke="red" points="564.21,-10361.8 563.56,-10351.23 557.47,-10359.9 564.21,-10361.8"/>
</g>
<!-- token_dist_5 -->
<g id="node174" class="node">
<title>token_dist_5</title>
<polygon fill="yellow" stroke="black" points="778.91,-10192.98 465.58,-10192.98 384.97,-10110.98 698.3,-10110.98 778.91,-10192.98"/>
<text text-anchor="middle" x="581.94" y="-10160.48" font-family="Arial" font-size="10.00">Token_Distribution_5</text>
<text text-anchor="middle" x="581.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_5&#45;&gt;token_dist_5 -->
<g id="edge93" class="edge">
<title>gate_5&#45;&gt;token_dist_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-10268.81C577.64,-10248.79 578.74,-10224.39 579.69,-10203.16"/>
<polygon fill="red" stroke="red" points="583.19,-10203.17 580.14,-10193.02 576.2,-10202.85 583.19,-10203.17"/>
</g>
<!-- token_dist_5&#45;&gt;expert_0_0 -->
<g id="edge94" class="edge">
<title>token_dist_5&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-10112.73C727.77,-10105.41 757.15,-10098.84 784.94,-10094.98 958.84,-10070.88 3771.92,-10104.75 3944.94,-10074.98 4092.4,-10049.61 4262.94,-10114.11 4262.94,-9964.48 4262.94,-9964.48 4262.94,-9964.48 4262.94,-1362.98 4262.94,-1266.14 4273.73,-1230.81 4221.94,-1148.98 4216.78,-1140.84 4209.3,-1133.82 4201.53,-1128.06"/>
<polygon fill="red" stroke="red" points="4203.33,-1125.05 4193.09,-1122.31 4199.38,-1130.83 4203.33,-1125.05"/>
</g>
<!-- expert_5_0_gpu0 -->
<g id="node175" class="node">
<title>expert_5_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-10172.48 3802.94,-10172.48 3802.94,-10131.48 3916.94,-10131.48 3916.94,-10172.48"/>
<text text-anchor="middle" x="3859.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_0_gpu1 -->
<g id="node176" class="node">
<title>expert_5_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-10172.48 3670.94,-10172.48 3670.94,-10131.48 3784.94,-10131.48 3784.94,-10172.48"/>
<text text-anchor="middle" x="3727.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_0 -->
<g id="node177" class="node">
<title>expert_merge_5_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-10192.98 3465,-10192.98 3416.56,-10110.98 3604.88,-10110.98 3653.32,-10192.98"/>
<text text-anchor="middle" x="3534.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_Merge_5_0</text>
<text text-anchor="middle" x="3534.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_5_1_gpu0 -->
<g id="node178" class="node">
<title>expert_5_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-10172.48 3278.94,-10172.48 3278.94,-10131.48 3392.94,-10131.48 3392.94,-10172.48"/>
<text text-anchor="middle" x="3335.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_1_gpu1 -->
<g id="node179" class="node">
<title>expert_5_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-10172.48 3146.94,-10172.48 3146.94,-10131.48 3260.94,-10131.48 3260.94,-10172.48"/>
<text text-anchor="middle" x="3203.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_1 -->
<g id="node180" class="node">
<title>expert_merge_5_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-10192.98 2941,-10192.98 2892.56,-10110.98 3080.88,-10110.98 3129.32,-10192.98"/>
<text text-anchor="middle" x="3010.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_Merge_5_1</text>
<text text-anchor="middle" x="3010.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_5_2_gpu0 -->
<g id="node181" class="node">
<title>expert_5_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-10172.48 2754.94,-10172.48 2754.94,-10131.48 2868.94,-10131.48 2868.94,-10172.48"/>
<text text-anchor="middle" x="2811.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_2_gpu1 -->
<g id="node182" class="node">
<title>expert_5_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-10172.48 2622.94,-10172.48 2622.94,-10131.48 2736.94,-10131.48 2736.94,-10172.48"/>
<text text-anchor="middle" x="2679.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_2 -->
<g id="node183" class="node">
<title>expert_merge_5_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-10192.98 2417,-10192.98 2368.56,-10110.98 2556.88,-10110.98 2605.32,-10192.98"/>
<text text-anchor="middle" x="2486.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_Merge_5_2</text>
<text text-anchor="middle" x="2486.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_5_3_gpu0 -->
<g id="node184" class="node">
<title>expert_5_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-10172.48 2230.94,-10172.48 2230.94,-10131.48 2344.94,-10131.48 2344.94,-10172.48"/>
<text text-anchor="middle" x="2287.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_3_gpu1 -->
<g id="node185" class="node">
<title>expert_5_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-10172.48 2098.94,-10172.48 2098.94,-10131.48 2212.94,-10131.48 2212.94,-10172.48"/>
<text text-anchor="middle" x="2155.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_3 -->
<g id="node186" class="node">
<title>expert_merge_5_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-10192.98 1893,-10192.98 1844.56,-10110.98 2032.88,-10110.98 2081.32,-10192.98"/>
<text text-anchor="middle" x="1962.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_Merge_5_3</text>
<text text-anchor="middle" x="1962.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_5_62_gpu0 -->
<g id="node187" class="node">
<title>expert_5_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-10172.48 1706.94,-10172.48 1706.94,-10131.48 1820.94,-10131.48 1820.94,-10172.48"/>
<text text-anchor="middle" x="1763.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_62_gpu1 -->
<g id="node188" class="node">
<title>expert_5_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-10172.48 1574.94,-10172.48 1574.94,-10131.48 1688.94,-10131.48 1688.94,-10172.48"/>
<text text-anchor="middle" x="1631.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_62 -->
<g id="node189" class="node">
<title>expert_merge_5_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-10192.98 1369,-10192.98 1320.56,-10110.98 1508.88,-10110.98 1557.32,-10192.98"/>
<text text-anchor="middle" x="1438.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_Merge_5_62</text>
<text text-anchor="middle" x="1438.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_5_63_gpu0 -->
<g id="node190" class="node">
<title>expert_5_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-10172.48 1182.94,-10172.48 1182.94,-10131.48 1296.94,-10131.48 1296.94,-10172.48"/>
<text text-anchor="middle" x="1239.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_5_63_gpu1 -->
<g id="node191" class="node">
<title>expert_5_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-10172.48 1050.94,-10172.48 1050.94,-10131.48 1164.94,-10131.48 1164.94,-10172.48"/>
<text text-anchor="middle" x="1107.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_5_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_5_63 -->
<g id="node192" class="node">
<title>expert_merge_5_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-10192.98 845,-10192.98 796.56,-10110.98 984.88,-10110.98 1033.32,-10192.98"/>
<text text-anchor="middle" x="914.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_Merge_5_63</text>
<text text-anchor="middle" x="914.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_5 -->
<g id="node193" class="node">
<title>expert_agg_5</title>
<polygon fill="yellow" stroke="black" points="366.55,-10192.98 106.28,-10192.98 39.33,-10110.98 299.6,-10110.98 366.55,-10192.98"/>
<text text-anchor="middle" x="202.94" y="-10160.48" font-family="Arial" font-size="10.00">Expert_Aggregation_5</text>
<text text-anchor="middle" x="202.94" y="-10149.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-10138.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_5 -->
<g id="node194" class="node">
<title>add_norm_2_5</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-10074.98 143.44,-10074.98 143.44,-10033.98 276.44,-10033.98 276.44,-10074.98"/>
<text text-anchor="middle" x="209.94" y="-10062.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_5</text>
<text text-anchor="middle" x="209.94" y="-10051.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-10040.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_5&#45;&gt;add_norm_2_5 -->
<g id="edge96" class="edge">
<title>expert_agg_5&#45;&gt;add_norm_2_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-10110.76C206.52,-10102.18 207.17,-10093.27 207.76,-10085.17"/>
<polygon fill="red" stroke="red" points="211.26,-10085.32 208.5,-10075.09 204.28,-10084.81 211.26,-10085.32"/>
</g>
<!-- layer_norm_6 -->
<g id="node195" class="node">
<title>layer_norm_6</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-9983.98 252.44,-9983.98 252.44,-9942.98 385.44,-9942.98 385.44,-9983.98"/>
<text text-anchor="middle" x="318.94" y="-9971.98" font-family="Arial" font-size="10.00">LayerNorm_6</text>
<text text-anchor="middle" x="318.94" y="-9960.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-9949.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_5&#45;&gt;layer_norm_6 -->
<g id="edge97" class="edge">
<title>add_norm_2_5&#45;&gt;layer_norm_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-10033.95C249.37,-10021.29 269.77,-10004.63 286.7,-9990.81"/>
<polygon fill="red" stroke="red" points="289.17,-9993.31 294.7,-9984.28 284.74,-9987.89 289.17,-9993.31"/>
</g>
<!-- mha_split_6 -->
<g id="node196" class="node">
<title>mha_split_6</title>
<polygon fill="yellow" stroke="black" points="510.72,-9900.98 291.54,-9900.98 235.16,-9818.98 454.33,-9818.98 510.72,-9900.98"/>
<text text-anchor="middle" x="372.94" y="-9868.48" font-family="Arial" font-size="10.00">MHA_Split_6</text>
<text text-anchor="middle" x="372.94" y="-9857.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-9846.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_6&#45;&gt;mha_split_6 -->
<g id="edge98" class="edge">
<title>layer_norm_6&#45;&gt;mha_split_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-9942.91C334.38,-9933.46 340.67,-9921.64 346.89,-9909.95"/>
<polygon fill="red" stroke="red" points="350,-9911.55 351.61,-9901.08 343.82,-9908.26 350,-9911.55"/>
</g>
<!-- qkv_proj_6_gpu0 -->
<g id="node197" class="node">
<title>qkv_proj_6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-9782.98 235.44,-9782.98 235.44,-9741.98 444.44,-9741.98 444.44,-9782.98"/>
<text text-anchor="middle" x="339.94" y="-9770.98" font-family="Arial" font-size="10.00">QKV_Proj_6_GPU0</text>
<text text-anchor="middle" x="339.94" y="-9759.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-9748.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_6&#45;&gt;qkv_proj_6_gpu0 -->
<g id="edge99" class="edge">
<title>mha_split_6&#45;&gt;qkv_proj_6_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-9818.76C356.01,-9809.99 352.86,-9800.87 350.01,-9792.63"/>
<polygon fill="red" stroke="red" points="353.29,-9791.4 346.72,-9783.09 346.67,-9793.69 353.29,-9791.4"/>
</g>
<!-- qkv_proj_6_gpu1 -->
<g id="node198" class="node">
<title>qkv_proj_6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-9782.98 462.44,-9782.98 462.44,-9741.98 671.44,-9741.98 671.44,-9782.98"/>
<text text-anchor="middle" x="566.94" y="-9770.98" font-family="Arial" font-size="10.00">QKV_Proj_6_GPU1</text>
<text text-anchor="middle" x="566.94" y="-9759.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-9748.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_6&#45;&gt;qkv_proj_6_gpu1 -->
<g id="edge100" class="edge">
<title>mha_split_6&#45;&gt;qkv_proj_6_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-9818.9C476.02,-9808.24 498.74,-9797.06 518.05,-9787.55"/>
<polygon fill="red" stroke="red" points="519.81,-9790.58 527.24,-9783.03 516.72,-9784.3 519.81,-9790.58"/>
</g>
<!-- attn_6_gpu0 -->
<g id="node199" class="node">
<title>attn_6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-9705.98 293.94,-9705.98 293.94,-9664.98 415.94,-9664.98 415.94,-9705.98"/>
<text text-anchor="middle" x="354.94" y="-9693.98" font-family="Arial" font-size="10.00">Attention_6_GPU0</text>
<text text-anchor="middle" x="354.94" y="-9682.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-9671.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_6_gpu0&#45;&gt;attn_6_gpu0 -->
<g id="edge101" class="edge">
<title>qkv_proj_6_gpu0&#45;&gt;attn_6_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-9741.78C345.45,-9733.94 347.29,-9724.75 349.01,-9716.14"/>
<polygon fill="red" stroke="red" points="352.5,-9716.55 351.02,-9706.06 345.63,-9715.18 352.5,-9716.55"/>
</g>
<!-- attn_6_gpu1 -->
<g id="node200" class="node">
<title>attn_6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-9705.98 496.94,-9705.98 496.94,-9664.98 618.94,-9664.98 618.94,-9705.98"/>
<text text-anchor="middle" x="557.94" y="-9693.98" font-family="Arial" font-size="10.00">Attention_6_GPU1</text>
<text text-anchor="middle" x="557.94" y="-9682.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-9671.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_6_gpu1&#45;&gt;attn_6_gpu1 -->
<g id="edge102" class="edge">
<title>qkv_proj_6_gpu1&#45;&gt;attn_6_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-9741.78C563.63,-9733.94 562.53,-9724.75 561.5,-9716.14"/>
<polygon fill="red" stroke="red" points="564.96,-9715.57 560.29,-9706.06 558,-9716.4 564.96,-9715.57"/>
</g>
<!-- out_proj_6_gpu0 -->
<g id="node201" class="node">
<title>out_proj_6_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-9628.98 303.44,-9628.98 303.44,-9587.98 436.44,-9587.98 436.44,-9628.98"/>
<text text-anchor="middle" x="369.94" y="-9616.98" font-family="Arial" font-size="10.00">Output_Proj_6_GPU0</text>
<text text-anchor="middle" x="369.94" y="-9605.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-9594.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_6_gpu0&#45;&gt;out_proj_6_gpu0 -->
<g id="edge103" class="edge">
<title>attn_6_gpu0&#45;&gt;out_proj_6_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-9664.78C360.45,-9656.94 362.29,-9647.75 364.01,-9639.14"/>
<polygon fill="red" stroke="red" points="367.5,-9639.55 366.02,-9629.06 360.63,-9638.18 367.5,-9639.55"/>
</g>
<!-- out_proj_6_gpu1 -->
<g id="node202" class="node">
<title>out_proj_6_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-9628.98 483.44,-9628.98 483.44,-9587.98 616.44,-9587.98 616.44,-9628.98"/>
<text text-anchor="middle" x="549.94" y="-9616.98" font-family="Arial" font-size="10.00">Output_Proj_6_GPU1</text>
<text text-anchor="middle" x="549.94" y="-9605.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-9594.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_6_gpu1&#45;&gt;out_proj_6_gpu1 -->
<g id="edge104" class="edge">
<title>attn_6_gpu1&#45;&gt;out_proj_6_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-9664.78C555,-9656.94 554.02,-9647.75 553.1,-9639.14"/>
<polygon fill="red" stroke="red" points="556.57,-9638.63 552.03,-9629.06 549.61,-9639.37 556.57,-9638.63"/>
</g>
<!-- mha_merge_6 -->
<g id="node203" class="node">
<title>mha_merge_6</title>
<polygon fill="yellow" stroke="black" points="671.72,-9551.98 452.54,-9551.98 396.16,-9469.98 615.33,-9469.98 671.72,-9551.98"/>
<text text-anchor="middle" x="533.94" y="-9519.48" font-family="Arial" font-size="10.00">MHA_Merge_6</text>
<text text-anchor="middle" x="533.94" y="-9508.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-9497.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_6_gpu0&#45;&gt;mha_merge_6 -->
<g id="edge105" class="edge">
<title>out_proj_6_gpu0&#45;&gt;mha_merge_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-9587.93C418.89,-9578.98 437.8,-9567.97 456.4,-9557.13"/>
<polygon fill="red" stroke="red" points="458.32,-9560.07 465.2,-9552.01 454.8,-9554.02 458.32,-9560.07"/>
</g>
<!-- out_proj_6_gpu1&#45;&gt;mha_merge_6 -->
<g id="edge106" class="edge">
<title>out_proj_6_gpu1&#45;&gt;mha_merge_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-9587.7C545.37,-9580.23 543.89,-9571.36 542.38,-9562.37"/>
<polygon fill="red" stroke="red" points="545.79,-9561.51 540.68,-9552.23 538.88,-9562.67 545.79,-9561.51"/>
</g>
<!-- add_norm_1_6 -->
<g id="node204" class="node">
<title>add_norm_1_6</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-9433.98 481.44,-9433.98 481.44,-9392.98 614.44,-9392.98 614.44,-9433.98"/>
<text text-anchor="middle" x="547.94" y="-9421.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_6</text>
<text text-anchor="middle" x="547.94" y="-9410.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-9399.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_6&#45;&gt;add_norm_1_6 -->
<g id="edge107" class="edge">
<title>mha_merge_6&#45;&gt;add_norm_1_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-9469.76C541.09,-9461.18 542.4,-9452.27 543.59,-9444.17"/>
<polygon fill="red" stroke="red" points="547.08,-9444.5 545.06,-9434.09 540.15,-9443.48 547.08,-9444.5"/>
</g>
<!-- gate_6 -->
<g id="node205" class="node">
<title>gate_6</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-9356.98 440.78,-9356.98 347.84,-9274.98 709.1,-9274.98 802.04,-9356.98"/>
<text text-anchor="middle" x="574.94" y="-9324.48" font-family="Arial" font-size="10.00">Expert_Gate_6</text>
<text text-anchor="middle" x="574.94" y="-9313.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-9302.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_6&#45;&gt;gate_6 -->
<g id="edge108" class="edge">
<title>add_norm_1_6&#45;&gt;gate_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-9392.7C555.67,-9385.15 558.21,-9376.17 560.78,-9367.08"/>
<polygon fill="red" stroke="red" points="564.21,-9367.8 563.56,-9357.23 557.47,-9365.9 564.21,-9367.8"/>
</g>
<!-- token_dist_6 -->
<g id="node206" class="node">
<title>token_dist_6</title>
<polygon fill="yellow" stroke="black" points="778.91,-9198.98 465.58,-9198.98 384.97,-9116.98 698.3,-9116.98 778.91,-9198.98"/>
<text text-anchor="middle" x="581.94" y="-9166.48" font-family="Arial" font-size="10.00">Token_Distribution_6</text>
<text text-anchor="middle" x="581.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_6&#45;&gt;token_dist_6 -->
<g id="edge109" class="edge">
<title>gate_6&#45;&gt;token_dist_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-9274.81C577.64,-9254.79 578.74,-9230.39 579.69,-9209.16"/>
<polygon fill="red" stroke="red" points="583.19,-9209.17 580.14,-9199.02 576.2,-9208.85 583.19,-9209.17"/>
</g>
<!-- token_dist_6&#45;&gt;expert_0_0 -->
<g id="edge110" class="edge">
<title>token_dist_6&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-9118.73C727.77,-9111.41 757.15,-9104.84 784.94,-9100.98 958.84,-9076.88 3772.58,-9114.33 3944.94,-9080.98 4076.29,-9055.57 4224.94,-9104.27 4224.94,-8970.48 4224.94,-8970.48 4224.94,-8970.48 4224.94,-1362.98 4224.94,-1266.81 4226.49,-1239.11 4192.94,-1148.98 4191.08,-1143.98 4188.52,-1138.93 4185.75,-1134.21"/>
<polygon fill="red" stroke="red" points="4188.59,-1132.16 4180.28,-1125.59 4182.68,-1135.91 4188.59,-1132.16"/>
</g>
<!-- expert_6_0_gpu0 -->
<g id="node207" class="node">
<title>expert_6_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-9178.48 3802.94,-9178.48 3802.94,-9137.48 3916.94,-9137.48 3916.94,-9178.48"/>
<text text-anchor="middle" x="3859.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_0_gpu1 -->
<g id="node208" class="node">
<title>expert_6_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-9178.48 3670.94,-9178.48 3670.94,-9137.48 3784.94,-9137.48 3784.94,-9178.48"/>
<text text-anchor="middle" x="3727.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_0 -->
<g id="node209" class="node">
<title>expert_merge_6_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-9198.98 3465,-9198.98 3416.56,-9116.98 3604.88,-9116.98 3653.32,-9198.98"/>
<text text-anchor="middle" x="3534.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_Merge_6_0</text>
<text text-anchor="middle" x="3534.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_6_1_gpu0 -->
<g id="node210" class="node">
<title>expert_6_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-9178.48 3278.94,-9178.48 3278.94,-9137.48 3392.94,-9137.48 3392.94,-9178.48"/>
<text text-anchor="middle" x="3335.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_1_gpu1 -->
<g id="node211" class="node">
<title>expert_6_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-9178.48 3146.94,-9178.48 3146.94,-9137.48 3260.94,-9137.48 3260.94,-9178.48"/>
<text text-anchor="middle" x="3203.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_1 -->
<g id="node212" class="node">
<title>expert_merge_6_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-9198.98 2941,-9198.98 2892.56,-9116.98 3080.88,-9116.98 3129.32,-9198.98"/>
<text text-anchor="middle" x="3010.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_Merge_6_1</text>
<text text-anchor="middle" x="3010.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_6_2_gpu0 -->
<g id="node213" class="node">
<title>expert_6_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-9178.48 2754.94,-9178.48 2754.94,-9137.48 2868.94,-9137.48 2868.94,-9178.48"/>
<text text-anchor="middle" x="2811.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_2_gpu1 -->
<g id="node214" class="node">
<title>expert_6_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-9178.48 2622.94,-9178.48 2622.94,-9137.48 2736.94,-9137.48 2736.94,-9178.48"/>
<text text-anchor="middle" x="2679.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_2 -->
<g id="node215" class="node">
<title>expert_merge_6_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-9198.98 2417,-9198.98 2368.56,-9116.98 2556.88,-9116.98 2605.32,-9198.98"/>
<text text-anchor="middle" x="2486.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_Merge_6_2</text>
<text text-anchor="middle" x="2486.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_6_3_gpu0 -->
<g id="node216" class="node">
<title>expert_6_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-9178.48 2230.94,-9178.48 2230.94,-9137.48 2344.94,-9137.48 2344.94,-9178.48"/>
<text text-anchor="middle" x="2287.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_3_gpu1 -->
<g id="node217" class="node">
<title>expert_6_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-9178.48 2098.94,-9178.48 2098.94,-9137.48 2212.94,-9137.48 2212.94,-9178.48"/>
<text text-anchor="middle" x="2155.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_3 -->
<g id="node218" class="node">
<title>expert_merge_6_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-9198.98 1893,-9198.98 1844.56,-9116.98 2032.88,-9116.98 2081.32,-9198.98"/>
<text text-anchor="middle" x="1962.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_Merge_6_3</text>
<text text-anchor="middle" x="1962.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_6_62_gpu0 -->
<g id="node219" class="node">
<title>expert_6_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-9178.48 1706.94,-9178.48 1706.94,-9137.48 1820.94,-9137.48 1820.94,-9178.48"/>
<text text-anchor="middle" x="1763.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_62_gpu1 -->
<g id="node220" class="node">
<title>expert_6_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-9178.48 1574.94,-9178.48 1574.94,-9137.48 1688.94,-9137.48 1688.94,-9178.48"/>
<text text-anchor="middle" x="1631.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_62 -->
<g id="node221" class="node">
<title>expert_merge_6_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-9198.98 1369,-9198.98 1320.56,-9116.98 1508.88,-9116.98 1557.32,-9198.98"/>
<text text-anchor="middle" x="1438.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_Merge_6_62</text>
<text text-anchor="middle" x="1438.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_6_63_gpu0 -->
<g id="node222" class="node">
<title>expert_6_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-9178.48 1182.94,-9178.48 1182.94,-9137.48 1296.94,-9137.48 1296.94,-9178.48"/>
<text text-anchor="middle" x="1239.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_6_63_gpu1 -->
<g id="node223" class="node">
<title>expert_6_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-9178.48 1050.94,-9178.48 1050.94,-9137.48 1164.94,-9137.48 1164.94,-9178.48"/>
<text text-anchor="middle" x="1107.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_6_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_6_63 -->
<g id="node224" class="node">
<title>expert_merge_6_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-9198.98 845,-9198.98 796.56,-9116.98 984.88,-9116.98 1033.32,-9198.98"/>
<text text-anchor="middle" x="914.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_Merge_6_63</text>
<text text-anchor="middle" x="914.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_6 -->
<g id="node225" class="node">
<title>expert_agg_6</title>
<polygon fill="yellow" stroke="black" points="366.55,-9198.98 106.28,-9198.98 39.33,-9116.98 299.6,-9116.98 366.55,-9198.98"/>
<text text-anchor="middle" x="202.94" y="-9166.48" font-family="Arial" font-size="10.00">Expert_Aggregation_6</text>
<text text-anchor="middle" x="202.94" y="-9155.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-9144.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_6 -->
<g id="node226" class="node">
<title>add_norm_2_6</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-9080.98 143.44,-9080.98 143.44,-9039.98 276.44,-9039.98 276.44,-9080.98"/>
<text text-anchor="middle" x="209.94" y="-9068.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_6</text>
<text text-anchor="middle" x="209.94" y="-9057.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-9046.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_6&#45;&gt;add_norm_2_6 -->
<g id="edge112" class="edge">
<title>expert_agg_6&#45;&gt;add_norm_2_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-9116.76C206.52,-9108.18 207.17,-9099.27 207.76,-9091.17"/>
<polygon fill="red" stroke="red" points="211.26,-9091.32 208.5,-9081.09 204.28,-9090.81 211.26,-9091.32"/>
</g>
<!-- layer_norm_7 -->
<g id="node227" class="node">
<title>layer_norm_7</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-8989.98 252.44,-8989.98 252.44,-8948.98 385.44,-8948.98 385.44,-8989.98"/>
<text text-anchor="middle" x="318.94" y="-8977.98" font-family="Arial" font-size="10.00">LayerNorm_7</text>
<text text-anchor="middle" x="318.94" y="-8966.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-8955.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_6&#45;&gt;layer_norm_7 -->
<g id="edge113" class="edge">
<title>add_norm_2_6&#45;&gt;layer_norm_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-9039.95C249.37,-9027.29 269.77,-9010.63 286.7,-8996.81"/>
<polygon fill="red" stroke="red" points="289.17,-8999.31 294.7,-8990.28 284.74,-8993.89 289.17,-8999.31"/>
</g>
<!-- mha_split_7 -->
<g id="node228" class="node">
<title>mha_split_7</title>
<polygon fill="yellow" stroke="black" points="510.72,-8906.98 291.54,-8906.98 235.16,-8824.98 454.33,-8824.98 510.72,-8906.98"/>
<text text-anchor="middle" x="372.94" y="-8874.48" font-family="Arial" font-size="10.00">MHA_Split_7</text>
<text text-anchor="middle" x="372.94" y="-8863.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-8852.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_7&#45;&gt;mha_split_7 -->
<g id="edge114" class="edge">
<title>layer_norm_7&#45;&gt;mha_split_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-8948.91C334.38,-8939.46 340.67,-8927.64 346.89,-8915.95"/>
<polygon fill="red" stroke="red" points="350,-8917.55 351.61,-8907.08 343.82,-8914.26 350,-8917.55"/>
</g>
<!-- qkv_proj_7_gpu0 -->
<g id="node229" class="node">
<title>qkv_proj_7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-8788.98 235.44,-8788.98 235.44,-8747.98 444.44,-8747.98 444.44,-8788.98"/>
<text text-anchor="middle" x="339.94" y="-8776.98" font-family="Arial" font-size="10.00">QKV_Proj_7_GPU0</text>
<text text-anchor="middle" x="339.94" y="-8765.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-8754.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_7&#45;&gt;qkv_proj_7_gpu0 -->
<g id="edge115" class="edge">
<title>mha_split_7&#45;&gt;qkv_proj_7_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-8824.76C356.01,-8815.99 352.86,-8806.87 350.01,-8798.63"/>
<polygon fill="red" stroke="red" points="353.29,-8797.4 346.72,-8789.09 346.67,-8799.69 353.29,-8797.4"/>
</g>
<!-- qkv_proj_7_gpu1 -->
<g id="node230" class="node">
<title>qkv_proj_7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-8788.98 462.44,-8788.98 462.44,-8747.98 671.44,-8747.98 671.44,-8788.98"/>
<text text-anchor="middle" x="566.94" y="-8776.98" font-family="Arial" font-size="10.00">QKV_Proj_7_GPU1</text>
<text text-anchor="middle" x="566.94" y="-8765.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-8754.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_7&#45;&gt;qkv_proj_7_gpu1 -->
<g id="edge116" class="edge">
<title>mha_split_7&#45;&gt;qkv_proj_7_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-8824.9C476.02,-8814.24 498.74,-8803.06 518.05,-8793.55"/>
<polygon fill="red" stroke="red" points="519.81,-8796.58 527.24,-8789.03 516.72,-8790.3 519.81,-8796.58"/>
</g>
<!-- attn_7_gpu0 -->
<g id="node231" class="node">
<title>attn_7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-8711.98 293.94,-8711.98 293.94,-8670.98 415.94,-8670.98 415.94,-8711.98"/>
<text text-anchor="middle" x="354.94" y="-8699.98" font-family="Arial" font-size="10.00">Attention_7_GPU0</text>
<text text-anchor="middle" x="354.94" y="-8688.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-8677.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_7_gpu0&#45;&gt;attn_7_gpu0 -->
<g id="edge117" class="edge">
<title>qkv_proj_7_gpu0&#45;&gt;attn_7_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-8747.78C345.45,-8739.94 347.29,-8730.75 349.01,-8722.14"/>
<polygon fill="red" stroke="red" points="352.5,-8722.55 351.02,-8712.06 345.63,-8721.18 352.5,-8722.55"/>
</g>
<!-- attn_7_gpu1 -->
<g id="node232" class="node">
<title>attn_7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-8711.98 496.94,-8711.98 496.94,-8670.98 618.94,-8670.98 618.94,-8711.98"/>
<text text-anchor="middle" x="557.94" y="-8699.98" font-family="Arial" font-size="10.00">Attention_7_GPU1</text>
<text text-anchor="middle" x="557.94" y="-8688.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-8677.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_7_gpu1&#45;&gt;attn_7_gpu1 -->
<g id="edge118" class="edge">
<title>qkv_proj_7_gpu1&#45;&gt;attn_7_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-8747.78C563.63,-8739.94 562.53,-8730.75 561.5,-8722.14"/>
<polygon fill="red" stroke="red" points="564.96,-8721.57 560.29,-8712.06 558,-8722.4 564.96,-8721.57"/>
</g>
<!-- out_proj_7_gpu0 -->
<g id="node233" class="node">
<title>out_proj_7_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-8634.98 303.44,-8634.98 303.44,-8593.98 436.44,-8593.98 436.44,-8634.98"/>
<text text-anchor="middle" x="369.94" y="-8622.98" font-family="Arial" font-size="10.00">Output_Proj_7_GPU0</text>
<text text-anchor="middle" x="369.94" y="-8611.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-8600.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_7_gpu0&#45;&gt;out_proj_7_gpu0 -->
<g id="edge119" class="edge">
<title>attn_7_gpu0&#45;&gt;out_proj_7_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-8670.78C360.45,-8662.94 362.29,-8653.75 364.01,-8645.14"/>
<polygon fill="red" stroke="red" points="367.5,-8645.55 366.02,-8635.06 360.63,-8644.18 367.5,-8645.55"/>
</g>
<!-- out_proj_7_gpu1 -->
<g id="node234" class="node">
<title>out_proj_7_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-8634.98 483.44,-8634.98 483.44,-8593.98 616.44,-8593.98 616.44,-8634.98"/>
<text text-anchor="middle" x="549.94" y="-8622.98" font-family="Arial" font-size="10.00">Output_Proj_7_GPU1</text>
<text text-anchor="middle" x="549.94" y="-8611.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-8600.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_7_gpu1&#45;&gt;out_proj_7_gpu1 -->
<g id="edge120" class="edge">
<title>attn_7_gpu1&#45;&gt;out_proj_7_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-8670.78C555,-8662.94 554.02,-8653.75 553.1,-8645.14"/>
<polygon fill="red" stroke="red" points="556.57,-8644.63 552.03,-8635.06 549.61,-8645.37 556.57,-8644.63"/>
</g>
<!-- mha_merge_7 -->
<g id="node235" class="node">
<title>mha_merge_7</title>
<polygon fill="yellow" stroke="black" points="671.72,-8557.98 452.54,-8557.98 396.16,-8475.98 615.33,-8475.98 671.72,-8557.98"/>
<text text-anchor="middle" x="533.94" y="-8525.48" font-family="Arial" font-size="10.00">MHA_Merge_7</text>
<text text-anchor="middle" x="533.94" y="-8514.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-8503.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_7_gpu0&#45;&gt;mha_merge_7 -->
<g id="edge121" class="edge">
<title>out_proj_7_gpu0&#45;&gt;mha_merge_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-8593.93C418.89,-8584.98 437.8,-8573.97 456.4,-8563.13"/>
<polygon fill="red" stroke="red" points="458.32,-8566.07 465.2,-8558.01 454.8,-8560.02 458.32,-8566.07"/>
</g>
<!-- out_proj_7_gpu1&#45;&gt;mha_merge_7 -->
<g id="edge122" class="edge">
<title>out_proj_7_gpu1&#45;&gt;mha_merge_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-8593.7C545.37,-8586.23 543.89,-8577.36 542.38,-8568.37"/>
<polygon fill="red" stroke="red" points="545.79,-8567.51 540.68,-8558.23 538.88,-8568.67 545.79,-8567.51"/>
</g>
<!-- add_norm_1_7 -->
<g id="node236" class="node">
<title>add_norm_1_7</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-8439.98 481.44,-8439.98 481.44,-8398.98 614.44,-8398.98 614.44,-8439.98"/>
<text text-anchor="middle" x="547.94" y="-8427.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_7</text>
<text text-anchor="middle" x="547.94" y="-8416.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-8405.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_7&#45;&gt;add_norm_1_7 -->
<g id="edge123" class="edge">
<title>mha_merge_7&#45;&gt;add_norm_1_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-8475.76C541.09,-8467.18 542.4,-8458.27 543.59,-8450.17"/>
<polygon fill="red" stroke="red" points="547.08,-8450.5 545.06,-8440.09 540.15,-8449.48 547.08,-8450.5"/>
</g>
<!-- gate_7 -->
<g id="node237" class="node">
<title>gate_7</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-8362.98 440.78,-8362.98 347.84,-8280.98 709.1,-8280.98 802.04,-8362.98"/>
<text text-anchor="middle" x="574.94" y="-8330.48" font-family="Arial" font-size="10.00">Expert_Gate_7</text>
<text text-anchor="middle" x="574.94" y="-8319.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-8308.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_7&#45;&gt;gate_7 -->
<g id="edge124" class="edge">
<title>add_norm_1_7&#45;&gt;gate_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-8398.7C555.67,-8391.15 558.21,-8382.17 560.78,-8373.08"/>
<polygon fill="red" stroke="red" points="564.21,-8373.8 563.56,-8363.23 557.47,-8371.9 564.21,-8373.8"/>
</g>
<!-- token_dist_7 -->
<g id="node238" class="node">
<title>token_dist_7</title>
<polygon fill="yellow" stroke="black" points="778.91,-8204.98 465.58,-8204.98 384.97,-8122.98 698.3,-8122.98 778.91,-8204.98"/>
<text text-anchor="middle" x="581.94" y="-8172.48" font-family="Arial" font-size="10.00">Token_Distribution_7</text>
<text text-anchor="middle" x="581.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_7&#45;&gt;token_dist_7 -->
<g id="edge125" class="edge">
<title>gate_7&#45;&gt;token_dist_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-8280.81C577.64,-8260.79 578.74,-8236.39 579.69,-8215.16"/>
<polygon fill="red" stroke="red" points="583.19,-8215.17 580.14,-8205.02 576.2,-8214.85 583.19,-8215.17"/>
</g>
<!-- token_dist_7&#45;&gt;expert_0_0 -->
<g id="edge126" class="edge">
<title>token_dist_7&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-8124.73C727.77,-8117.41 757.15,-8110.84 784.94,-8106.98 958.84,-8082.88 3773.51,-8124.84 3944.94,-8086.98 4060.4,-8061.49 4186.94,-8094.72 4186.94,-7976.48 4186.94,-7976.48 4186.94,-7976.48 4186.94,-1362.98 4186.94,-1280.45 4176.8,-1183.22 4171.34,-1136.81"/>
<polygon fill="red" stroke="red" points="4174.78,-1136.17 4170.12,-1126.66 4167.83,-1137.01 4174.78,-1136.17"/>
</g>
<!-- expert_7_0_gpu0 -->
<g id="node239" class="node">
<title>expert_7_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-8184.48 3802.94,-8184.48 3802.94,-8143.48 3916.94,-8143.48 3916.94,-8184.48"/>
<text text-anchor="middle" x="3859.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_0_gpu1 -->
<g id="node240" class="node">
<title>expert_7_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-8184.48 3670.94,-8184.48 3670.94,-8143.48 3784.94,-8143.48 3784.94,-8184.48"/>
<text text-anchor="middle" x="3727.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_0 -->
<g id="node241" class="node">
<title>expert_merge_7_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-8204.98 3465,-8204.98 3416.56,-8122.98 3604.88,-8122.98 3653.32,-8204.98"/>
<text text-anchor="middle" x="3534.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_Merge_7_0</text>
<text text-anchor="middle" x="3534.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_7_1_gpu0 -->
<g id="node242" class="node">
<title>expert_7_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-8184.48 3278.94,-8184.48 3278.94,-8143.48 3392.94,-8143.48 3392.94,-8184.48"/>
<text text-anchor="middle" x="3335.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_1_gpu1 -->
<g id="node243" class="node">
<title>expert_7_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-8184.48 3146.94,-8184.48 3146.94,-8143.48 3260.94,-8143.48 3260.94,-8184.48"/>
<text text-anchor="middle" x="3203.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_1 -->
<g id="node244" class="node">
<title>expert_merge_7_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-8204.98 2941,-8204.98 2892.56,-8122.98 3080.88,-8122.98 3129.32,-8204.98"/>
<text text-anchor="middle" x="3010.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_Merge_7_1</text>
<text text-anchor="middle" x="3010.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_7_2_gpu0 -->
<g id="node245" class="node">
<title>expert_7_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-8184.48 2754.94,-8184.48 2754.94,-8143.48 2868.94,-8143.48 2868.94,-8184.48"/>
<text text-anchor="middle" x="2811.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_2_gpu1 -->
<g id="node246" class="node">
<title>expert_7_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-8184.48 2622.94,-8184.48 2622.94,-8143.48 2736.94,-8143.48 2736.94,-8184.48"/>
<text text-anchor="middle" x="2679.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_2 -->
<g id="node247" class="node">
<title>expert_merge_7_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-8204.98 2417,-8204.98 2368.56,-8122.98 2556.88,-8122.98 2605.32,-8204.98"/>
<text text-anchor="middle" x="2486.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_Merge_7_2</text>
<text text-anchor="middle" x="2486.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_7_3_gpu0 -->
<g id="node248" class="node">
<title>expert_7_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-8184.48 2230.94,-8184.48 2230.94,-8143.48 2344.94,-8143.48 2344.94,-8184.48"/>
<text text-anchor="middle" x="2287.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_3_gpu1 -->
<g id="node249" class="node">
<title>expert_7_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-8184.48 2098.94,-8184.48 2098.94,-8143.48 2212.94,-8143.48 2212.94,-8184.48"/>
<text text-anchor="middle" x="2155.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_3 -->
<g id="node250" class="node">
<title>expert_merge_7_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-8204.98 1893,-8204.98 1844.56,-8122.98 2032.88,-8122.98 2081.32,-8204.98"/>
<text text-anchor="middle" x="1962.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_Merge_7_3</text>
<text text-anchor="middle" x="1962.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_7_62_gpu0 -->
<g id="node251" class="node">
<title>expert_7_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-8184.48 1706.94,-8184.48 1706.94,-8143.48 1820.94,-8143.48 1820.94,-8184.48"/>
<text text-anchor="middle" x="1763.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_62_gpu1 -->
<g id="node252" class="node">
<title>expert_7_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-8184.48 1574.94,-8184.48 1574.94,-8143.48 1688.94,-8143.48 1688.94,-8184.48"/>
<text text-anchor="middle" x="1631.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_62 -->
<g id="node253" class="node">
<title>expert_merge_7_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-8204.98 1369,-8204.98 1320.56,-8122.98 1508.88,-8122.98 1557.32,-8204.98"/>
<text text-anchor="middle" x="1438.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_Merge_7_62</text>
<text text-anchor="middle" x="1438.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_7_63_gpu0 -->
<g id="node254" class="node">
<title>expert_7_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-8184.48 1182.94,-8184.48 1182.94,-8143.48 1296.94,-8143.48 1296.94,-8184.48"/>
<text text-anchor="middle" x="1239.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_7_63_gpu1 -->
<g id="node255" class="node">
<title>expert_7_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-8184.48 1050.94,-8184.48 1050.94,-8143.48 1164.94,-8143.48 1164.94,-8184.48"/>
<text text-anchor="middle" x="1107.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_7_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_7_63 -->
<g id="node256" class="node">
<title>expert_merge_7_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-8204.98 845,-8204.98 796.56,-8122.98 984.88,-8122.98 1033.32,-8204.98"/>
<text text-anchor="middle" x="914.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_Merge_7_63</text>
<text text-anchor="middle" x="914.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_7 -->
<g id="node257" class="node">
<title>expert_agg_7</title>
<polygon fill="yellow" stroke="black" points="366.55,-8204.98 106.28,-8204.98 39.33,-8122.98 299.6,-8122.98 366.55,-8204.98"/>
<text text-anchor="middle" x="202.94" y="-8172.48" font-family="Arial" font-size="10.00">Expert_Aggregation_7</text>
<text text-anchor="middle" x="202.94" y="-8161.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-8150.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_7 -->
<g id="node258" class="node">
<title>add_norm_2_7</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-8086.98 143.44,-8086.98 143.44,-8045.98 276.44,-8045.98 276.44,-8086.98"/>
<text text-anchor="middle" x="209.94" y="-8074.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_7</text>
<text text-anchor="middle" x="209.94" y="-8063.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-8052.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_7&#45;&gt;add_norm_2_7 -->
<g id="edge128" class="edge">
<title>expert_agg_7&#45;&gt;add_norm_2_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-8122.76C206.52,-8114.18 207.17,-8105.27 207.76,-8097.17"/>
<polygon fill="red" stroke="red" points="211.26,-8097.32 208.5,-8087.09 204.28,-8096.81 211.26,-8097.32"/>
</g>
<!-- layer_norm_8 -->
<g id="node259" class="node">
<title>layer_norm_8</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-7995.98 252.44,-7995.98 252.44,-7954.98 385.44,-7954.98 385.44,-7995.98"/>
<text text-anchor="middle" x="318.94" y="-7983.98" font-family="Arial" font-size="10.00">LayerNorm_8</text>
<text text-anchor="middle" x="318.94" y="-7972.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-7961.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_7&#45;&gt;layer_norm_8 -->
<g id="edge129" class="edge">
<title>add_norm_2_7&#45;&gt;layer_norm_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-8045.95C249.37,-8033.29 269.77,-8016.63 286.7,-8002.81"/>
<polygon fill="red" stroke="red" points="289.17,-8005.31 294.7,-7996.28 284.74,-7999.89 289.17,-8005.31"/>
</g>
<!-- mha_split_8 -->
<g id="node260" class="node">
<title>mha_split_8</title>
<polygon fill="yellow" stroke="black" points="510.72,-7912.98 291.54,-7912.98 235.16,-7830.98 454.33,-7830.98 510.72,-7912.98"/>
<text text-anchor="middle" x="372.94" y="-7880.48" font-family="Arial" font-size="10.00">MHA_Split_8</text>
<text text-anchor="middle" x="372.94" y="-7869.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-7858.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_8&#45;&gt;mha_split_8 -->
<g id="edge130" class="edge">
<title>layer_norm_8&#45;&gt;mha_split_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-7954.91C334.38,-7945.46 340.67,-7933.64 346.89,-7921.95"/>
<polygon fill="red" stroke="red" points="350,-7923.55 351.61,-7913.08 343.82,-7920.26 350,-7923.55"/>
</g>
<!-- qkv_proj_8_gpu0 -->
<g id="node261" class="node">
<title>qkv_proj_8_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-7794.98 235.44,-7794.98 235.44,-7753.98 444.44,-7753.98 444.44,-7794.98"/>
<text text-anchor="middle" x="339.94" y="-7782.98" font-family="Arial" font-size="10.00">QKV_Proj_8_GPU0</text>
<text text-anchor="middle" x="339.94" y="-7771.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-7760.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_8&#45;&gt;qkv_proj_8_gpu0 -->
<g id="edge131" class="edge">
<title>mha_split_8&#45;&gt;qkv_proj_8_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-7830.76C356.01,-7821.99 352.86,-7812.87 350.01,-7804.63"/>
<polygon fill="red" stroke="red" points="353.29,-7803.4 346.72,-7795.09 346.67,-7805.69 353.29,-7803.4"/>
</g>
<!-- qkv_proj_8_gpu1 -->
<g id="node262" class="node">
<title>qkv_proj_8_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-7794.98 462.44,-7794.98 462.44,-7753.98 671.44,-7753.98 671.44,-7794.98"/>
<text text-anchor="middle" x="566.94" y="-7782.98" font-family="Arial" font-size="10.00">QKV_Proj_8_GPU1</text>
<text text-anchor="middle" x="566.94" y="-7771.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-7760.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_8&#45;&gt;qkv_proj_8_gpu1 -->
<g id="edge132" class="edge">
<title>mha_split_8&#45;&gt;qkv_proj_8_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-7830.9C476.02,-7820.24 498.74,-7809.06 518.05,-7799.55"/>
<polygon fill="red" stroke="red" points="519.81,-7802.58 527.24,-7795.03 516.72,-7796.3 519.81,-7802.58"/>
</g>
<!-- attn_8_gpu0 -->
<g id="node263" class="node">
<title>attn_8_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-7717.98 293.94,-7717.98 293.94,-7676.98 415.94,-7676.98 415.94,-7717.98"/>
<text text-anchor="middle" x="354.94" y="-7705.98" font-family="Arial" font-size="10.00">Attention_8_GPU0</text>
<text text-anchor="middle" x="354.94" y="-7694.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-7683.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_8_gpu0&#45;&gt;attn_8_gpu0 -->
<g id="edge133" class="edge">
<title>qkv_proj_8_gpu0&#45;&gt;attn_8_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-7753.78C345.45,-7745.94 347.29,-7736.75 349.01,-7728.14"/>
<polygon fill="red" stroke="red" points="352.5,-7728.55 351.02,-7718.06 345.63,-7727.18 352.5,-7728.55"/>
</g>
<!-- attn_8_gpu1 -->
<g id="node264" class="node">
<title>attn_8_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-7717.98 496.94,-7717.98 496.94,-7676.98 618.94,-7676.98 618.94,-7717.98"/>
<text text-anchor="middle" x="557.94" y="-7705.98" font-family="Arial" font-size="10.00">Attention_8_GPU1</text>
<text text-anchor="middle" x="557.94" y="-7694.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-7683.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_8_gpu1&#45;&gt;attn_8_gpu1 -->
<g id="edge134" class="edge">
<title>qkv_proj_8_gpu1&#45;&gt;attn_8_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-7753.78C563.63,-7745.94 562.53,-7736.75 561.5,-7728.14"/>
<polygon fill="red" stroke="red" points="564.96,-7727.57 560.29,-7718.06 558,-7728.4 564.96,-7727.57"/>
</g>
<!-- out_proj_8_gpu0 -->
<g id="node265" class="node">
<title>out_proj_8_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-7640.98 303.44,-7640.98 303.44,-7599.98 436.44,-7599.98 436.44,-7640.98"/>
<text text-anchor="middle" x="369.94" y="-7628.98" font-family="Arial" font-size="10.00">Output_Proj_8_GPU0</text>
<text text-anchor="middle" x="369.94" y="-7617.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-7606.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_8_gpu0&#45;&gt;out_proj_8_gpu0 -->
<g id="edge135" class="edge">
<title>attn_8_gpu0&#45;&gt;out_proj_8_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-7676.78C360.45,-7668.94 362.29,-7659.75 364.01,-7651.14"/>
<polygon fill="red" stroke="red" points="367.5,-7651.55 366.02,-7641.06 360.63,-7650.18 367.5,-7651.55"/>
</g>
<!-- out_proj_8_gpu1 -->
<g id="node266" class="node">
<title>out_proj_8_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-7640.98 483.44,-7640.98 483.44,-7599.98 616.44,-7599.98 616.44,-7640.98"/>
<text text-anchor="middle" x="549.94" y="-7628.98" font-family="Arial" font-size="10.00">Output_Proj_8_GPU1</text>
<text text-anchor="middle" x="549.94" y="-7617.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-7606.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_8_gpu1&#45;&gt;out_proj_8_gpu1 -->
<g id="edge136" class="edge">
<title>attn_8_gpu1&#45;&gt;out_proj_8_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-7676.78C555,-7668.94 554.02,-7659.75 553.1,-7651.14"/>
<polygon fill="red" stroke="red" points="556.57,-7650.63 552.03,-7641.06 549.61,-7651.37 556.57,-7650.63"/>
</g>
<!-- mha_merge_8 -->
<g id="node267" class="node">
<title>mha_merge_8</title>
<polygon fill="yellow" stroke="black" points="671.72,-7563.98 452.54,-7563.98 396.16,-7481.98 615.33,-7481.98 671.72,-7563.98"/>
<text text-anchor="middle" x="533.94" y="-7531.48" font-family="Arial" font-size="10.00">MHA_Merge_8</text>
<text text-anchor="middle" x="533.94" y="-7520.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-7509.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_8_gpu0&#45;&gt;mha_merge_8 -->
<g id="edge137" class="edge">
<title>out_proj_8_gpu0&#45;&gt;mha_merge_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-7599.93C418.89,-7590.98 437.8,-7579.97 456.4,-7569.13"/>
<polygon fill="red" stroke="red" points="458.32,-7572.07 465.2,-7564.01 454.8,-7566.02 458.32,-7572.07"/>
</g>
<!-- out_proj_8_gpu1&#45;&gt;mha_merge_8 -->
<g id="edge138" class="edge">
<title>out_proj_8_gpu1&#45;&gt;mha_merge_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-7599.7C545.37,-7592.23 543.89,-7583.36 542.38,-7574.37"/>
<polygon fill="red" stroke="red" points="545.79,-7573.51 540.68,-7564.23 538.88,-7574.67 545.79,-7573.51"/>
</g>
<!-- add_norm_1_8 -->
<g id="node268" class="node">
<title>add_norm_1_8</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-7445.98 481.44,-7445.98 481.44,-7404.98 614.44,-7404.98 614.44,-7445.98"/>
<text text-anchor="middle" x="547.94" y="-7433.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_8</text>
<text text-anchor="middle" x="547.94" y="-7422.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-7411.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_8&#45;&gt;add_norm_1_8 -->
<g id="edge139" class="edge">
<title>mha_merge_8&#45;&gt;add_norm_1_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-7481.76C541.09,-7473.18 542.4,-7464.27 543.59,-7456.17"/>
<polygon fill="red" stroke="red" points="547.08,-7456.5 545.06,-7446.09 540.15,-7455.48 547.08,-7456.5"/>
</g>
<!-- gate_8 -->
<g id="node269" class="node">
<title>gate_8</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-7368.98 440.78,-7368.98 347.84,-7286.98 709.1,-7286.98 802.04,-7368.98"/>
<text text-anchor="middle" x="574.94" y="-7336.48" font-family="Arial" font-size="10.00">Expert_Gate_8</text>
<text text-anchor="middle" x="574.94" y="-7325.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-7314.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_8&#45;&gt;gate_8 -->
<g id="edge140" class="edge">
<title>add_norm_1_8&#45;&gt;gate_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-7404.7C555.67,-7397.15 558.21,-7388.17 560.78,-7379.08"/>
<polygon fill="red" stroke="red" points="564.21,-7379.8 563.56,-7369.23 557.47,-7377.9 564.21,-7379.8"/>
</g>
<!-- token_dist_8 -->
<g id="node270" class="node">
<title>token_dist_8</title>
<polygon fill="yellow" stroke="black" points="778.91,-7210.98 465.58,-7210.98 384.97,-7128.98 698.3,-7128.98 778.91,-7210.98"/>
<text text-anchor="middle" x="581.94" y="-7178.48" font-family="Arial" font-size="10.00">Token_Distribution_8</text>
<text text-anchor="middle" x="581.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_8&#45;&gt;token_dist_8 -->
<g id="edge141" class="edge">
<title>gate_8&#45;&gt;token_dist_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-7286.81C577.64,-7266.79 578.74,-7242.39 579.69,-7221.16"/>
<polygon fill="red" stroke="red" points="583.19,-7221.17 580.14,-7211.02 576.2,-7220.85 583.19,-7221.17"/>
</g>
<!-- token_dist_8&#45;&gt;expert_0_0 -->
<g id="edge142" class="edge">
<title>token_dist_8&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-7130.73C727.77,-7123.41 757.15,-7116.84 784.94,-7112.98 958.84,-7088.88 3774.9,-7136.65 3944.94,-7092.98 4044.81,-7067.33 4148.94,-7085.6 4148.94,-6982.48 4148.94,-6982.48 4148.94,-6982.48 4148.94,-1362.98 4148.94,-1280.45 4159.08,-1183.22 4164.54,-1136.81"/>
<polygon fill="red" stroke="red" points="4168.04,-1137.01 4165.76,-1126.66 4161.09,-1136.17 4168.04,-1137.01"/>
</g>
<!-- expert_8_0_gpu0 -->
<g id="node271" class="node">
<title>expert_8_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-7190.48 3802.94,-7190.48 3802.94,-7149.48 3916.94,-7149.48 3916.94,-7190.48"/>
<text text-anchor="middle" x="3859.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_0_gpu1 -->
<g id="node272" class="node">
<title>expert_8_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-7190.48 3670.94,-7190.48 3670.94,-7149.48 3784.94,-7149.48 3784.94,-7190.48"/>
<text text-anchor="middle" x="3727.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_0 -->
<g id="node273" class="node">
<title>expert_merge_8_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-7210.98 3465,-7210.98 3416.56,-7128.98 3604.88,-7128.98 3653.32,-7210.98"/>
<text text-anchor="middle" x="3534.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_Merge_8_0</text>
<text text-anchor="middle" x="3534.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_8_1_gpu0 -->
<g id="node274" class="node">
<title>expert_8_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-7190.48 3278.94,-7190.48 3278.94,-7149.48 3392.94,-7149.48 3392.94,-7190.48"/>
<text text-anchor="middle" x="3335.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_1_gpu1 -->
<g id="node275" class="node">
<title>expert_8_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-7190.48 3146.94,-7190.48 3146.94,-7149.48 3260.94,-7149.48 3260.94,-7190.48"/>
<text text-anchor="middle" x="3203.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_1 -->
<g id="node276" class="node">
<title>expert_merge_8_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-7210.98 2941,-7210.98 2892.56,-7128.98 3080.88,-7128.98 3129.32,-7210.98"/>
<text text-anchor="middle" x="3010.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_Merge_8_1</text>
<text text-anchor="middle" x="3010.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_8_2_gpu0 -->
<g id="node277" class="node">
<title>expert_8_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-7190.48 2754.94,-7190.48 2754.94,-7149.48 2868.94,-7149.48 2868.94,-7190.48"/>
<text text-anchor="middle" x="2811.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_2_gpu1 -->
<g id="node278" class="node">
<title>expert_8_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-7190.48 2622.94,-7190.48 2622.94,-7149.48 2736.94,-7149.48 2736.94,-7190.48"/>
<text text-anchor="middle" x="2679.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_2 -->
<g id="node279" class="node">
<title>expert_merge_8_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-7210.98 2417,-7210.98 2368.56,-7128.98 2556.88,-7128.98 2605.32,-7210.98"/>
<text text-anchor="middle" x="2486.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_Merge_8_2</text>
<text text-anchor="middle" x="2486.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_8_3_gpu0 -->
<g id="node280" class="node">
<title>expert_8_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-7190.48 2230.94,-7190.48 2230.94,-7149.48 2344.94,-7149.48 2344.94,-7190.48"/>
<text text-anchor="middle" x="2287.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_3_gpu1 -->
<g id="node281" class="node">
<title>expert_8_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-7190.48 2098.94,-7190.48 2098.94,-7149.48 2212.94,-7149.48 2212.94,-7190.48"/>
<text text-anchor="middle" x="2155.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_3 -->
<g id="node282" class="node">
<title>expert_merge_8_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-7210.98 1893,-7210.98 1844.56,-7128.98 2032.88,-7128.98 2081.32,-7210.98"/>
<text text-anchor="middle" x="1962.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_Merge_8_3</text>
<text text-anchor="middle" x="1962.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_8_62_gpu0 -->
<g id="node283" class="node">
<title>expert_8_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-7190.48 1706.94,-7190.48 1706.94,-7149.48 1820.94,-7149.48 1820.94,-7190.48"/>
<text text-anchor="middle" x="1763.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_62_gpu1 -->
<g id="node284" class="node">
<title>expert_8_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-7190.48 1574.94,-7190.48 1574.94,-7149.48 1688.94,-7149.48 1688.94,-7190.48"/>
<text text-anchor="middle" x="1631.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_62 -->
<g id="node285" class="node">
<title>expert_merge_8_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-7210.98 1369,-7210.98 1320.56,-7128.98 1508.88,-7128.98 1557.32,-7210.98"/>
<text text-anchor="middle" x="1438.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_Merge_8_62</text>
<text text-anchor="middle" x="1438.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_8_63_gpu0 -->
<g id="node286" class="node">
<title>expert_8_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-7190.48 1182.94,-7190.48 1182.94,-7149.48 1296.94,-7149.48 1296.94,-7190.48"/>
<text text-anchor="middle" x="1239.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_8_63_gpu1 -->
<g id="node287" class="node">
<title>expert_8_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-7190.48 1050.94,-7190.48 1050.94,-7149.48 1164.94,-7149.48 1164.94,-7190.48"/>
<text text-anchor="middle" x="1107.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_8_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_8_63 -->
<g id="node288" class="node">
<title>expert_merge_8_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-7210.98 845,-7210.98 796.56,-7128.98 984.88,-7128.98 1033.32,-7210.98"/>
<text text-anchor="middle" x="914.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_Merge_8_63</text>
<text text-anchor="middle" x="914.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_8 -->
<g id="node289" class="node">
<title>expert_agg_8</title>
<polygon fill="yellow" stroke="black" points="366.55,-7210.98 106.28,-7210.98 39.33,-7128.98 299.6,-7128.98 366.55,-7210.98"/>
<text text-anchor="middle" x="202.94" y="-7178.48" font-family="Arial" font-size="10.00">Expert_Aggregation_8</text>
<text text-anchor="middle" x="202.94" y="-7167.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-7156.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_8 -->
<g id="node290" class="node">
<title>add_norm_2_8</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-7092.98 143.44,-7092.98 143.44,-7051.98 276.44,-7051.98 276.44,-7092.98"/>
<text text-anchor="middle" x="209.94" y="-7080.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_8</text>
<text text-anchor="middle" x="209.94" y="-7069.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-7058.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_8&#45;&gt;add_norm_2_8 -->
<g id="edge144" class="edge">
<title>expert_agg_8&#45;&gt;add_norm_2_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-7128.76C206.52,-7120.18 207.17,-7111.27 207.76,-7103.17"/>
<polygon fill="red" stroke="red" points="211.26,-7103.32 208.5,-7093.09 204.28,-7102.81 211.26,-7103.32"/>
</g>
<!-- layer_norm_9 -->
<g id="node291" class="node">
<title>layer_norm_9</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-7001.98 252.44,-7001.98 252.44,-6960.98 385.44,-6960.98 385.44,-7001.98"/>
<text text-anchor="middle" x="318.94" y="-6989.98" font-family="Arial" font-size="10.00">LayerNorm_9</text>
<text text-anchor="middle" x="318.94" y="-6978.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-6967.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_8&#45;&gt;layer_norm_9 -->
<g id="edge145" class="edge">
<title>add_norm_2_8&#45;&gt;layer_norm_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-7051.95C249.37,-7039.29 269.77,-7022.63 286.7,-7008.81"/>
<polygon fill="red" stroke="red" points="289.17,-7011.31 294.7,-7002.28 284.74,-7005.89 289.17,-7011.31"/>
</g>
<!-- mha_split_9 -->
<g id="node292" class="node">
<title>mha_split_9</title>
<polygon fill="yellow" stroke="black" points="510.72,-6918.98 291.54,-6918.98 235.16,-6836.98 454.33,-6836.98 510.72,-6918.98"/>
<text text-anchor="middle" x="372.94" y="-6886.48" font-family="Arial" font-size="10.00">MHA_Split_9</text>
<text text-anchor="middle" x="372.94" y="-6875.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-6864.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_9&#45;&gt;mha_split_9 -->
<g id="edge146" class="edge">
<title>layer_norm_9&#45;&gt;mha_split_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-6960.91C334.38,-6951.46 340.67,-6939.64 346.89,-6927.95"/>
<polygon fill="red" stroke="red" points="350,-6929.55 351.61,-6919.08 343.82,-6926.26 350,-6929.55"/>
</g>
<!-- qkv_proj_9_gpu0 -->
<g id="node293" class="node">
<title>qkv_proj_9_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-6800.98 235.44,-6800.98 235.44,-6759.98 444.44,-6759.98 444.44,-6800.98"/>
<text text-anchor="middle" x="339.94" y="-6788.98" font-family="Arial" font-size="10.00">QKV_Proj_9_GPU0</text>
<text text-anchor="middle" x="339.94" y="-6777.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-6766.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_9&#45;&gt;qkv_proj_9_gpu0 -->
<g id="edge147" class="edge">
<title>mha_split_9&#45;&gt;qkv_proj_9_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-6836.76C356.01,-6827.99 352.86,-6818.87 350.01,-6810.63"/>
<polygon fill="red" stroke="red" points="353.29,-6809.4 346.72,-6801.09 346.67,-6811.69 353.29,-6809.4"/>
</g>
<!-- qkv_proj_9_gpu1 -->
<g id="node294" class="node">
<title>qkv_proj_9_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-6800.98 462.44,-6800.98 462.44,-6759.98 671.44,-6759.98 671.44,-6800.98"/>
<text text-anchor="middle" x="566.94" y="-6788.98" font-family="Arial" font-size="10.00">QKV_Proj_9_GPU1</text>
<text text-anchor="middle" x="566.94" y="-6777.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-6766.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_9&#45;&gt;qkv_proj_9_gpu1 -->
<g id="edge148" class="edge">
<title>mha_split_9&#45;&gt;qkv_proj_9_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-6836.9C476.02,-6826.24 498.74,-6815.06 518.05,-6805.55"/>
<polygon fill="red" stroke="red" points="519.81,-6808.58 527.24,-6801.03 516.72,-6802.3 519.81,-6808.58"/>
</g>
<!-- attn_9_gpu0 -->
<g id="node295" class="node">
<title>attn_9_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-6723.98 293.94,-6723.98 293.94,-6682.98 415.94,-6682.98 415.94,-6723.98"/>
<text text-anchor="middle" x="354.94" y="-6711.98" font-family="Arial" font-size="10.00">Attention_9_GPU0</text>
<text text-anchor="middle" x="354.94" y="-6700.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-6689.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_9_gpu0&#45;&gt;attn_9_gpu0 -->
<g id="edge149" class="edge">
<title>qkv_proj_9_gpu0&#45;&gt;attn_9_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-6759.78C345.45,-6751.94 347.29,-6742.75 349.01,-6734.14"/>
<polygon fill="red" stroke="red" points="352.5,-6734.55 351.02,-6724.06 345.63,-6733.18 352.5,-6734.55"/>
</g>
<!-- attn_9_gpu1 -->
<g id="node296" class="node">
<title>attn_9_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-6723.98 496.94,-6723.98 496.94,-6682.98 618.94,-6682.98 618.94,-6723.98"/>
<text text-anchor="middle" x="557.94" y="-6711.98" font-family="Arial" font-size="10.00">Attention_9_GPU1</text>
<text text-anchor="middle" x="557.94" y="-6700.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-6689.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_9_gpu1&#45;&gt;attn_9_gpu1 -->
<g id="edge150" class="edge">
<title>qkv_proj_9_gpu1&#45;&gt;attn_9_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-6759.78C563.63,-6751.94 562.53,-6742.75 561.5,-6734.14"/>
<polygon fill="red" stroke="red" points="564.96,-6733.57 560.29,-6724.06 558,-6734.4 564.96,-6733.57"/>
</g>
<!-- out_proj_9_gpu0 -->
<g id="node297" class="node">
<title>out_proj_9_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-6646.98 303.44,-6646.98 303.44,-6605.98 436.44,-6605.98 436.44,-6646.98"/>
<text text-anchor="middle" x="369.94" y="-6634.98" font-family="Arial" font-size="10.00">Output_Proj_9_GPU0</text>
<text text-anchor="middle" x="369.94" y="-6623.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-6612.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_9_gpu0&#45;&gt;out_proj_9_gpu0 -->
<g id="edge151" class="edge">
<title>attn_9_gpu0&#45;&gt;out_proj_9_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-6682.78C360.45,-6674.94 362.29,-6665.75 364.01,-6657.14"/>
<polygon fill="red" stroke="red" points="367.5,-6657.55 366.02,-6647.06 360.63,-6656.18 367.5,-6657.55"/>
</g>
<!-- out_proj_9_gpu1 -->
<g id="node298" class="node">
<title>out_proj_9_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-6646.98 483.44,-6646.98 483.44,-6605.98 616.44,-6605.98 616.44,-6646.98"/>
<text text-anchor="middle" x="549.94" y="-6634.98" font-family="Arial" font-size="10.00">Output_Proj_9_GPU1</text>
<text text-anchor="middle" x="549.94" y="-6623.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-6612.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_9_gpu1&#45;&gt;out_proj_9_gpu1 -->
<g id="edge152" class="edge">
<title>attn_9_gpu1&#45;&gt;out_proj_9_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-6682.78C555,-6674.94 554.02,-6665.75 553.1,-6657.14"/>
<polygon fill="red" stroke="red" points="556.57,-6656.63 552.03,-6647.06 549.61,-6657.37 556.57,-6656.63"/>
</g>
<!-- mha_merge_9 -->
<g id="node299" class="node">
<title>mha_merge_9</title>
<polygon fill="yellow" stroke="black" points="671.72,-6569.98 452.54,-6569.98 396.16,-6487.98 615.33,-6487.98 671.72,-6569.98"/>
<text text-anchor="middle" x="533.94" y="-6537.48" font-family="Arial" font-size="10.00">MHA_Merge_9</text>
<text text-anchor="middle" x="533.94" y="-6526.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-6515.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_9_gpu0&#45;&gt;mha_merge_9 -->
<g id="edge153" class="edge">
<title>out_proj_9_gpu0&#45;&gt;mha_merge_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-6605.93C418.89,-6596.98 437.8,-6585.97 456.4,-6575.13"/>
<polygon fill="red" stroke="red" points="458.32,-6578.07 465.2,-6570.01 454.8,-6572.02 458.32,-6578.07"/>
</g>
<!-- out_proj_9_gpu1&#45;&gt;mha_merge_9 -->
<g id="edge154" class="edge">
<title>out_proj_9_gpu1&#45;&gt;mha_merge_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-6605.7C545.37,-6598.23 543.89,-6589.36 542.38,-6580.37"/>
<polygon fill="red" stroke="red" points="545.79,-6579.51 540.68,-6570.23 538.88,-6580.67 545.79,-6579.51"/>
</g>
<!-- add_norm_1_9 -->
<g id="node300" class="node">
<title>add_norm_1_9</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-6451.98 481.44,-6451.98 481.44,-6410.98 614.44,-6410.98 614.44,-6451.98"/>
<text text-anchor="middle" x="547.94" y="-6439.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_9</text>
<text text-anchor="middle" x="547.94" y="-6428.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-6417.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_9&#45;&gt;add_norm_1_9 -->
<g id="edge155" class="edge">
<title>mha_merge_9&#45;&gt;add_norm_1_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-6487.76C541.09,-6479.18 542.4,-6470.27 543.59,-6462.17"/>
<polygon fill="red" stroke="red" points="547.08,-6462.5 545.06,-6452.09 540.15,-6461.48 547.08,-6462.5"/>
</g>
<!-- gate_9 -->
<g id="node301" class="node">
<title>gate_9</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-6374.98 440.78,-6374.98 347.84,-6292.98 709.1,-6292.98 802.04,-6374.98"/>
<text text-anchor="middle" x="574.94" y="-6342.48" font-family="Arial" font-size="10.00">Expert_Gate_9</text>
<text text-anchor="middle" x="574.94" y="-6331.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-6320.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_9&#45;&gt;gate_9 -->
<g id="edge156" class="edge">
<title>add_norm_1_9&#45;&gt;gate_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-6410.7C555.67,-6403.15 558.21,-6394.17 560.78,-6385.08"/>
<polygon fill="red" stroke="red" points="564.21,-6385.8 563.56,-6375.23 557.47,-6383.9 564.21,-6385.8"/>
</g>
<!-- token_dist_9 -->
<g id="node302" class="node">
<title>token_dist_9</title>
<polygon fill="yellow" stroke="black" points="778.91,-6216.98 465.58,-6216.98 384.97,-6134.98 698.3,-6134.98 778.91,-6216.98"/>
<text text-anchor="middle" x="581.94" y="-6184.48" font-family="Arial" font-size="10.00">Token_Distribution_9</text>
<text text-anchor="middle" x="581.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_9&#45;&gt;token_dist_9 -->
<g id="edge157" class="edge">
<title>gate_9&#45;&gt;token_dist_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-6292.81C577.64,-6272.79 578.74,-6248.39 579.69,-6227.16"/>
<polygon fill="red" stroke="red" points="583.19,-6227.17 580.14,-6217.02 576.2,-6226.85 583.19,-6227.17"/>
</g>
<!-- token_dist_9&#45;&gt;expert_0_0 -->
<g id="edge158" class="edge">
<title>token_dist_9&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-6136.73C727.77,-6129.41 757.15,-6122.84 784.94,-6118.98 871.89,-6106.93 3861,-6124.66 3944.94,-6098.98 4029.69,-6073.06 4110.94,-6077.11 4110.94,-5988.48 4110.94,-5988.48 4110.94,-5988.48 4110.94,-1362.98 4110.94,-1267.28 4097.33,-1236.99 4134.94,-1148.98 4137.37,-1143.3 4140.9,-1137.8 4144.75,-1132.8"/>
<polygon fill="red" stroke="red" points="4147.63,-1134.82 4151.41,-1124.93 4142.28,-1130.3 4147.63,-1134.82"/>
</g>
<!-- expert_9_0_gpu0 -->
<g id="node303" class="node">
<title>expert_9_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-6196.48 3802.94,-6196.48 3802.94,-6155.48 3916.94,-6155.48 3916.94,-6196.48"/>
<text text-anchor="middle" x="3859.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_0_gpu1 -->
<g id="node304" class="node">
<title>expert_9_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-6196.48 3670.94,-6196.48 3670.94,-6155.48 3784.94,-6155.48 3784.94,-6196.48"/>
<text text-anchor="middle" x="3727.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_0 -->
<g id="node305" class="node">
<title>expert_merge_9_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-6216.98 3465,-6216.98 3416.56,-6134.98 3604.88,-6134.98 3653.32,-6216.98"/>
<text text-anchor="middle" x="3534.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_Merge_9_0</text>
<text text-anchor="middle" x="3534.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_9_1_gpu0 -->
<g id="node306" class="node">
<title>expert_9_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-6196.48 3278.94,-6196.48 3278.94,-6155.48 3392.94,-6155.48 3392.94,-6196.48"/>
<text text-anchor="middle" x="3335.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_1_gpu1 -->
<g id="node307" class="node">
<title>expert_9_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-6196.48 3146.94,-6196.48 3146.94,-6155.48 3260.94,-6155.48 3260.94,-6196.48"/>
<text text-anchor="middle" x="3203.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_1 -->
<g id="node308" class="node">
<title>expert_merge_9_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-6216.98 2941,-6216.98 2892.56,-6134.98 3080.88,-6134.98 3129.32,-6216.98"/>
<text text-anchor="middle" x="3010.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_Merge_9_1</text>
<text text-anchor="middle" x="3010.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_9_2_gpu0 -->
<g id="node309" class="node">
<title>expert_9_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-6196.48 2754.94,-6196.48 2754.94,-6155.48 2868.94,-6155.48 2868.94,-6196.48"/>
<text text-anchor="middle" x="2811.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_2_gpu1 -->
<g id="node310" class="node">
<title>expert_9_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-6196.48 2622.94,-6196.48 2622.94,-6155.48 2736.94,-6155.48 2736.94,-6196.48"/>
<text text-anchor="middle" x="2679.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_2 -->
<g id="node311" class="node">
<title>expert_merge_9_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-6216.98 2417,-6216.98 2368.56,-6134.98 2556.88,-6134.98 2605.32,-6216.98"/>
<text text-anchor="middle" x="2486.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_Merge_9_2</text>
<text text-anchor="middle" x="2486.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_9_3_gpu0 -->
<g id="node312" class="node">
<title>expert_9_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-6196.48 2230.94,-6196.48 2230.94,-6155.48 2344.94,-6155.48 2344.94,-6196.48"/>
<text text-anchor="middle" x="2287.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_3_gpu1 -->
<g id="node313" class="node">
<title>expert_9_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-6196.48 2098.94,-6196.48 2098.94,-6155.48 2212.94,-6155.48 2212.94,-6196.48"/>
<text text-anchor="middle" x="2155.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_3 -->
<g id="node314" class="node">
<title>expert_merge_9_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-6216.98 1893,-6216.98 1844.56,-6134.98 2032.88,-6134.98 2081.32,-6216.98"/>
<text text-anchor="middle" x="1962.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_Merge_9_3</text>
<text text-anchor="middle" x="1962.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_9_62_gpu0 -->
<g id="node315" class="node">
<title>expert_9_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-6196.48 1706.94,-6196.48 1706.94,-6155.48 1820.94,-6155.48 1820.94,-6196.48"/>
<text text-anchor="middle" x="1763.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_62_gpu1 -->
<g id="node316" class="node">
<title>expert_9_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-6196.48 1574.94,-6196.48 1574.94,-6155.48 1688.94,-6155.48 1688.94,-6196.48"/>
<text text-anchor="middle" x="1631.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_62 -->
<g id="node317" class="node">
<title>expert_merge_9_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-6216.98 1369,-6216.98 1320.56,-6134.98 1508.88,-6134.98 1557.32,-6216.98"/>
<text text-anchor="middle" x="1438.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_Merge_9_62</text>
<text text-anchor="middle" x="1438.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_9_63_gpu0 -->
<g id="node318" class="node">
<title>expert_9_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-6196.48 1182.94,-6196.48 1182.94,-6155.48 1296.94,-6155.48 1296.94,-6196.48"/>
<text text-anchor="middle" x="1239.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_9_63_gpu1 -->
<g id="node319" class="node">
<title>expert_9_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-6196.48 1050.94,-6196.48 1050.94,-6155.48 1164.94,-6155.48 1164.94,-6196.48"/>
<text text-anchor="middle" x="1107.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_9_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_9_63 -->
<g id="node320" class="node">
<title>expert_merge_9_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-6216.98 845,-6216.98 796.56,-6134.98 984.88,-6134.98 1033.32,-6216.98"/>
<text text-anchor="middle" x="914.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_Merge_9_63</text>
<text text-anchor="middle" x="914.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_9 -->
<g id="node321" class="node">
<title>expert_agg_9</title>
<polygon fill="yellow" stroke="black" points="366.55,-6216.98 106.28,-6216.98 39.33,-6134.98 299.6,-6134.98 366.55,-6216.98"/>
<text text-anchor="middle" x="202.94" y="-6184.48" font-family="Arial" font-size="10.00">Expert_Aggregation_9</text>
<text text-anchor="middle" x="202.94" y="-6173.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-6162.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_9 -->
<g id="node322" class="node">
<title>add_norm_2_9</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-6098.98 143.44,-6098.98 143.44,-6057.98 276.44,-6057.98 276.44,-6098.98"/>
<text text-anchor="middle" x="209.94" y="-6086.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_9</text>
<text text-anchor="middle" x="209.94" y="-6075.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-6064.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_9&#45;&gt;add_norm_2_9 -->
<g id="edge160" class="edge">
<title>expert_agg_9&#45;&gt;add_norm_2_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-6134.76C206.52,-6126.18 207.17,-6117.27 207.76,-6109.17"/>
<polygon fill="red" stroke="red" points="211.26,-6109.32 208.5,-6099.09 204.28,-6108.81 211.26,-6109.32"/>
</g>
<!-- layer_norm_10 -->
<g id="node323" class="node">
<title>layer_norm_10</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-6007.98 252.44,-6007.98 252.44,-5966.98 385.44,-5966.98 385.44,-6007.98"/>
<text text-anchor="middle" x="318.94" y="-5995.98" font-family="Arial" font-size="10.00">LayerNorm_10</text>
<text text-anchor="middle" x="318.94" y="-5984.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-5973.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_9&#45;&gt;layer_norm_10 -->
<g id="edge161" class="edge">
<title>add_norm_2_9&#45;&gt;layer_norm_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-6057.95C249.37,-6045.29 269.77,-6028.63 286.7,-6014.81"/>
<polygon fill="red" stroke="red" points="289.17,-6017.31 294.7,-6008.28 284.74,-6011.89 289.17,-6017.31"/>
</g>
<!-- mha_split_10 -->
<g id="node324" class="node">
<title>mha_split_10</title>
<polygon fill="yellow" stroke="black" points="510.72,-5924.98 291.54,-5924.98 235.16,-5842.98 454.33,-5842.98 510.72,-5924.98"/>
<text text-anchor="middle" x="372.94" y="-5892.48" font-family="Arial" font-size="10.00">MHA_Split_10</text>
<text text-anchor="middle" x="372.94" y="-5881.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-5870.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_10&#45;&gt;mha_split_10 -->
<g id="edge162" class="edge">
<title>layer_norm_10&#45;&gt;mha_split_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-5966.91C334.38,-5957.46 340.67,-5945.64 346.89,-5933.95"/>
<polygon fill="red" stroke="red" points="350,-5935.55 351.61,-5925.08 343.82,-5932.26 350,-5935.55"/>
</g>
<!-- qkv_proj_10_gpu0 -->
<g id="node325" class="node">
<title>qkv_proj_10_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-5806.98 235.44,-5806.98 235.44,-5765.98 444.44,-5765.98 444.44,-5806.98"/>
<text text-anchor="middle" x="339.94" y="-5794.98" font-family="Arial" font-size="10.00">QKV_Proj_10_GPU0</text>
<text text-anchor="middle" x="339.94" y="-5783.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-5772.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_10&#45;&gt;qkv_proj_10_gpu0 -->
<g id="edge163" class="edge">
<title>mha_split_10&#45;&gt;qkv_proj_10_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-5842.76C356.01,-5833.99 352.86,-5824.87 350.01,-5816.63"/>
<polygon fill="red" stroke="red" points="353.29,-5815.4 346.72,-5807.09 346.67,-5817.69 353.29,-5815.4"/>
</g>
<!-- qkv_proj_10_gpu1 -->
<g id="node326" class="node">
<title>qkv_proj_10_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-5806.98 462.44,-5806.98 462.44,-5765.98 671.44,-5765.98 671.44,-5806.98"/>
<text text-anchor="middle" x="566.94" y="-5794.98" font-family="Arial" font-size="10.00">QKV_Proj_10_GPU1</text>
<text text-anchor="middle" x="566.94" y="-5783.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-5772.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_10&#45;&gt;qkv_proj_10_gpu1 -->
<g id="edge164" class="edge">
<title>mha_split_10&#45;&gt;qkv_proj_10_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-5842.9C476.02,-5832.24 498.74,-5821.06 518.05,-5811.55"/>
<polygon fill="red" stroke="red" points="519.81,-5814.58 527.24,-5807.03 516.72,-5808.3 519.81,-5814.58"/>
</g>
<!-- attn_10_gpu0 -->
<g id="node327" class="node">
<title>attn_10_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-5729.98 293.94,-5729.98 293.94,-5688.98 415.94,-5688.98 415.94,-5729.98"/>
<text text-anchor="middle" x="354.94" y="-5717.98" font-family="Arial" font-size="10.00">Attention_10_GPU0</text>
<text text-anchor="middle" x="354.94" y="-5706.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-5695.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_10_gpu0&#45;&gt;attn_10_gpu0 -->
<g id="edge165" class="edge">
<title>qkv_proj_10_gpu0&#45;&gt;attn_10_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-5765.78C345.45,-5757.94 347.29,-5748.75 349.01,-5740.14"/>
<polygon fill="red" stroke="red" points="352.5,-5740.55 351.02,-5730.06 345.63,-5739.18 352.5,-5740.55"/>
</g>
<!-- attn_10_gpu1 -->
<g id="node328" class="node">
<title>attn_10_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-5729.98 496.94,-5729.98 496.94,-5688.98 618.94,-5688.98 618.94,-5729.98"/>
<text text-anchor="middle" x="557.94" y="-5717.98" font-family="Arial" font-size="10.00">Attention_10_GPU1</text>
<text text-anchor="middle" x="557.94" y="-5706.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-5695.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_10_gpu1&#45;&gt;attn_10_gpu1 -->
<g id="edge166" class="edge">
<title>qkv_proj_10_gpu1&#45;&gt;attn_10_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-5765.78C563.63,-5757.94 562.53,-5748.75 561.5,-5740.14"/>
<polygon fill="red" stroke="red" points="564.96,-5739.57 560.29,-5730.06 558,-5740.4 564.96,-5739.57"/>
</g>
<!-- out_proj_10_gpu0 -->
<g id="node329" class="node">
<title>out_proj_10_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-5652.98 303.44,-5652.98 303.44,-5611.98 436.44,-5611.98 436.44,-5652.98"/>
<text text-anchor="middle" x="369.94" y="-5640.98" font-family="Arial" font-size="10.00">Output_Proj_10_GPU0</text>
<text text-anchor="middle" x="369.94" y="-5629.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-5618.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_10_gpu0&#45;&gt;out_proj_10_gpu0 -->
<g id="edge167" class="edge">
<title>attn_10_gpu0&#45;&gt;out_proj_10_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-5688.78C360.45,-5680.94 362.29,-5671.75 364.01,-5663.14"/>
<polygon fill="red" stroke="red" points="367.5,-5663.55 366.02,-5653.06 360.63,-5662.18 367.5,-5663.55"/>
</g>
<!-- out_proj_10_gpu1 -->
<g id="node330" class="node">
<title>out_proj_10_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-5652.98 483.44,-5652.98 483.44,-5611.98 616.44,-5611.98 616.44,-5652.98"/>
<text text-anchor="middle" x="549.94" y="-5640.98" font-family="Arial" font-size="10.00">Output_Proj_10_GPU1</text>
<text text-anchor="middle" x="549.94" y="-5629.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-5618.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_10_gpu1&#45;&gt;out_proj_10_gpu1 -->
<g id="edge168" class="edge">
<title>attn_10_gpu1&#45;&gt;out_proj_10_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-5688.78C555,-5680.94 554.02,-5671.75 553.1,-5663.14"/>
<polygon fill="red" stroke="red" points="556.57,-5662.63 552.03,-5653.06 549.61,-5663.37 556.57,-5662.63"/>
</g>
<!-- mha_merge_10 -->
<g id="node331" class="node">
<title>mha_merge_10</title>
<polygon fill="yellow" stroke="black" points="671.72,-5575.98 452.54,-5575.98 396.16,-5493.98 615.33,-5493.98 671.72,-5575.98"/>
<text text-anchor="middle" x="533.94" y="-5543.48" font-family="Arial" font-size="10.00">MHA_Merge_10</text>
<text text-anchor="middle" x="533.94" y="-5532.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-5521.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_10_gpu0&#45;&gt;mha_merge_10 -->
<g id="edge169" class="edge">
<title>out_proj_10_gpu0&#45;&gt;mha_merge_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-5611.93C418.89,-5602.98 437.8,-5591.97 456.4,-5581.13"/>
<polygon fill="red" stroke="red" points="458.32,-5584.07 465.2,-5576.01 454.8,-5578.02 458.32,-5584.07"/>
</g>
<!-- out_proj_10_gpu1&#45;&gt;mha_merge_10 -->
<g id="edge170" class="edge">
<title>out_proj_10_gpu1&#45;&gt;mha_merge_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-5611.7C545.37,-5604.23 543.89,-5595.36 542.38,-5586.37"/>
<polygon fill="red" stroke="red" points="545.79,-5585.51 540.68,-5576.23 538.88,-5586.67 545.79,-5585.51"/>
</g>
<!-- add_norm_1_10 -->
<g id="node332" class="node">
<title>add_norm_1_10</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-5457.98 481.44,-5457.98 481.44,-5416.98 614.44,-5416.98 614.44,-5457.98"/>
<text text-anchor="middle" x="547.94" y="-5445.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_10</text>
<text text-anchor="middle" x="547.94" y="-5434.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-5423.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_10&#45;&gt;add_norm_1_10 -->
<g id="edge171" class="edge">
<title>mha_merge_10&#45;&gt;add_norm_1_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-5493.76C541.09,-5485.18 542.4,-5476.27 543.59,-5468.17"/>
<polygon fill="red" stroke="red" points="547.08,-5468.5 545.06,-5458.09 540.15,-5467.48 547.08,-5468.5"/>
</g>
<!-- gate_10 -->
<g id="node333" class="node">
<title>gate_10</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-5380.98 440.78,-5380.98 347.84,-5298.98 709.1,-5298.98 802.04,-5380.98"/>
<text text-anchor="middle" x="574.94" y="-5348.48" font-family="Arial" font-size="10.00">Expert_Gate_10</text>
<text text-anchor="middle" x="574.94" y="-5337.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-5326.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_10&#45;&gt;gate_10 -->
<g id="edge172" class="edge">
<title>add_norm_1_10&#45;&gt;gate_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-5416.7C555.67,-5409.15 558.21,-5400.17 560.78,-5391.08"/>
<polygon fill="red" stroke="red" points="564.21,-5391.8 563.56,-5381.23 557.47,-5389.9 564.21,-5391.8"/>
</g>
<!-- token_dist_10 -->
<g id="node334" class="node">
<title>token_dist_10</title>
<polygon fill="yellow" stroke="black" points="778.91,-5222.98 465.58,-5222.98 384.97,-5140.98 698.3,-5140.98 778.91,-5222.98"/>
<text text-anchor="middle" x="581.94" y="-5190.48" font-family="Arial" font-size="10.00">Token_Distribution_10</text>
<text text-anchor="middle" x="581.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_10&#45;&gt;token_dist_10 -->
<g id="edge173" class="edge">
<title>gate_10&#45;&gt;token_dist_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-5298.81C577.64,-5278.79 578.74,-5254.39 579.69,-5233.16"/>
<polygon fill="red" stroke="red" points="583.19,-5233.17 580.14,-5223.02 576.2,-5232.85 583.19,-5233.17"/>
</g>
<!-- token_dist_10&#45;&gt;expert_0_0 -->
<g id="edge174" class="edge">
<title>token_dist_10&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-5142.73C727.77,-5135.41 757.15,-5128.84 784.94,-5124.98 871.89,-5112.93 3862.76,-5135.84 3944.94,-5104.98 4015.3,-5078.56 4072.94,-5069.64 4072.94,-4994.48 4072.94,-4994.48 4072.94,-4994.48 4072.94,-1362.98 4072.94,-1267.28 4043.9,-1228.65 4096.94,-1148.98 4104.34,-1137.87 4115.98,-1129.57 4127.71,-1123.53"/>
<polygon fill="red" stroke="red" points="4129.48,-1126.56 4137.06,-1119.15 4126.52,-1120.22 4129.48,-1126.56"/>
</g>
<!-- expert_10_0_gpu0 -->
<g id="node335" class="node">
<title>expert_10_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-5202.48 3802.94,-5202.48 3802.94,-5161.48 3916.94,-5161.48 3916.94,-5202.48"/>
<text text-anchor="middle" x="3859.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_0_gpu1 -->
<g id="node336" class="node">
<title>expert_10_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-5202.48 3670.94,-5202.48 3670.94,-5161.48 3784.94,-5161.48 3784.94,-5202.48"/>
<text text-anchor="middle" x="3727.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_0 -->
<g id="node337" class="node">
<title>expert_merge_10_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-5222.98 3465,-5222.98 3416.56,-5140.98 3604.88,-5140.98 3653.32,-5222.98"/>
<text text-anchor="middle" x="3534.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_Merge_10_0</text>
<text text-anchor="middle" x="3534.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_10_1_gpu0 -->
<g id="node338" class="node">
<title>expert_10_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-5202.48 3278.94,-5202.48 3278.94,-5161.48 3392.94,-5161.48 3392.94,-5202.48"/>
<text text-anchor="middle" x="3335.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_1_gpu1 -->
<g id="node339" class="node">
<title>expert_10_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-5202.48 3146.94,-5202.48 3146.94,-5161.48 3260.94,-5161.48 3260.94,-5202.48"/>
<text text-anchor="middle" x="3203.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_1 -->
<g id="node340" class="node">
<title>expert_merge_10_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-5222.98 2941,-5222.98 2892.56,-5140.98 3080.88,-5140.98 3129.32,-5222.98"/>
<text text-anchor="middle" x="3010.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_Merge_10_1</text>
<text text-anchor="middle" x="3010.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_10_2_gpu0 -->
<g id="node341" class="node">
<title>expert_10_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-5202.48 2754.94,-5202.48 2754.94,-5161.48 2868.94,-5161.48 2868.94,-5202.48"/>
<text text-anchor="middle" x="2811.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_2_gpu1 -->
<g id="node342" class="node">
<title>expert_10_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-5202.48 2622.94,-5202.48 2622.94,-5161.48 2736.94,-5161.48 2736.94,-5202.48"/>
<text text-anchor="middle" x="2679.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_2 -->
<g id="node343" class="node">
<title>expert_merge_10_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-5222.98 2417,-5222.98 2368.56,-5140.98 2556.88,-5140.98 2605.32,-5222.98"/>
<text text-anchor="middle" x="2486.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_Merge_10_2</text>
<text text-anchor="middle" x="2486.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_10_3_gpu0 -->
<g id="node344" class="node">
<title>expert_10_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-5202.48 2230.94,-5202.48 2230.94,-5161.48 2344.94,-5161.48 2344.94,-5202.48"/>
<text text-anchor="middle" x="2287.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_3_gpu1 -->
<g id="node345" class="node">
<title>expert_10_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-5202.48 2098.94,-5202.48 2098.94,-5161.48 2212.94,-5161.48 2212.94,-5202.48"/>
<text text-anchor="middle" x="2155.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_3 -->
<g id="node346" class="node">
<title>expert_merge_10_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-5222.98 1893,-5222.98 1844.56,-5140.98 2032.88,-5140.98 2081.32,-5222.98"/>
<text text-anchor="middle" x="1962.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_Merge_10_3</text>
<text text-anchor="middle" x="1962.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_10_62_gpu0 -->
<g id="node347" class="node">
<title>expert_10_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-5202.48 1706.94,-5202.48 1706.94,-5161.48 1820.94,-5161.48 1820.94,-5202.48"/>
<text text-anchor="middle" x="1763.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_62_gpu1 -->
<g id="node348" class="node">
<title>expert_10_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-5202.48 1574.94,-5202.48 1574.94,-5161.48 1688.94,-5161.48 1688.94,-5202.48"/>
<text text-anchor="middle" x="1631.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_62 -->
<g id="node349" class="node">
<title>expert_merge_10_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-5222.98 1369,-5222.98 1320.56,-5140.98 1508.88,-5140.98 1557.32,-5222.98"/>
<text text-anchor="middle" x="1438.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_Merge_10_62</text>
<text text-anchor="middle" x="1438.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_10_63_gpu0 -->
<g id="node350" class="node">
<title>expert_10_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-5202.48 1182.94,-5202.48 1182.94,-5161.48 1296.94,-5161.48 1296.94,-5202.48"/>
<text text-anchor="middle" x="1239.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_10_63_gpu1 -->
<g id="node351" class="node">
<title>expert_10_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-5202.48 1050.94,-5202.48 1050.94,-5161.48 1164.94,-5161.48 1164.94,-5202.48"/>
<text text-anchor="middle" x="1107.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_10_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_10_63 -->
<g id="node352" class="node">
<title>expert_merge_10_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-5222.98 845,-5222.98 796.56,-5140.98 984.88,-5140.98 1033.32,-5222.98"/>
<text text-anchor="middle" x="914.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_Merge_10_63</text>
<text text-anchor="middle" x="914.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_10 -->
<g id="node353" class="node">
<title>expert_agg_10</title>
<polygon fill="yellow" stroke="black" points="366.55,-5222.98 106.28,-5222.98 39.33,-5140.98 299.6,-5140.98 366.55,-5222.98"/>
<text text-anchor="middle" x="202.94" y="-5190.48" font-family="Arial" font-size="10.00">Expert_Aggregation_10</text>
<text text-anchor="middle" x="202.94" y="-5179.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-5168.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_10 -->
<g id="node354" class="node">
<title>add_norm_2_10</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-5104.98 143.44,-5104.98 143.44,-5063.98 276.44,-5063.98 276.44,-5104.98"/>
<text text-anchor="middle" x="209.94" y="-5092.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_10</text>
<text text-anchor="middle" x="209.94" y="-5081.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-5070.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_10&#45;&gt;add_norm_2_10 -->
<g id="edge176" class="edge">
<title>expert_agg_10&#45;&gt;add_norm_2_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-5140.76C206.52,-5132.18 207.17,-5123.27 207.76,-5115.17"/>
<polygon fill="red" stroke="red" points="211.26,-5115.32 208.5,-5105.09 204.28,-5114.81 211.26,-5115.32"/>
</g>
<!-- layer_norm_11 -->
<g id="node355" class="node">
<title>layer_norm_11</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-5013.98 252.44,-5013.98 252.44,-4972.98 385.44,-4972.98 385.44,-5013.98"/>
<text text-anchor="middle" x="318.94" y="-5001.98" font-family="Arial" font-size="10.00">LayerNorm_11</text>
<text text-anchor="middle" x="318.94" y="-4990.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-4979.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_10&#45;&gt;layer_norm_11 -->
<g id="edge177" class="edge">
<title>add_norm_2_10&#45;&gt;layer_norm_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-5063.95C249.37,-5051.29 269.77,-5034.63 286.7,-5020.81"/>
<polygon fill="red" stroke="red" points="289.17,-5023.31 294.7,-5014.28 284.74,-5017.89 289.17,-5023.31"/>
</g>
<!-- mha_split_11 -->
<g id="node356" class="node">
<title>mha_split_11</title>
<polygon fill="yellow" stroke="black" points="510.72,-4930.98 291.54,-4930.98 235.16,-4848.98 454.33,-4848.98 510.72,-4930.98"/>
<text text-anchor="middle" x="372.94" y="-4898.48" font-family="Arial" font-size="10.00">MHA_Split_11</text>
<text text-anchor="middle" x="372.94" y="-4887.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-4876.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_11&#45;&gt;mha_split_11 -->
<g id="edge178" class="edge">
<title>layer_norm_11&#45;&gt;mha_split_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-4972.91C334.38,-4963.46 340.67,-4951.64 346.89,-4939.95"/>
<polygon fill="red" stroke="red" points="350,-4941.55 351.61,-4931.08 343.82,-4938.26 350,-4941.55"/>
</g>
<!-- qkv_proj_11_gpu0 -->
<g id="node357" class="node">
<title>qkv_proj_11_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-4812.98 235.44,-4812.98 235.44,-4771.98 444.44,-4771.98 444.44,-4812.98"/>
<text text-anchor="middle" x="339.94" y="-4800.98" font-family="Arial" font-size="10.00">QKV_Proj_11_GPU0</text>
<text text-anchor="middle" x="339.94" y="-4789.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-4778.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_11&#45;&gt;qkv_proj_11_gpu0 -->
<g id="edge179" class="edge">
<title>mha_split_11&#45;&gt;qkv_proj_11_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-4848.76C356.01,-4839.99 352.86,-4830.87 350.01,-4822.63"/>
<polygon fill="red" stroke="red" points="353.29,-4821.4 346.72,-4813.09 346.67,-4823.69 353.29,-4821.4"/>
</g>
<!-- qkv_proj_11_gpu1 -->
<g id="node358" class="node">
<title>qkv_proj_11_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-4812.98 462.44,-4812.98 462.44,-4771.98 671.44,-4771.98 671.44,-4812.98"/>
<text text-anchor="middle" x="566.94" y="-4800.98" font-family="Arial" font-size="10.00">QKV_Proj_11_GPU1</text>
<text text-anchor="middle" x="566.94" y="-4789.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-4778.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_11&#45;&gt;qkv_proj_11_gpu1 -->
<g id="edge180" class="edge">
<title>mha_split_11&#45;&gt;qkv_proj_11_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-4848.9C476.02,-4838.24 498.74,-4827.06 518.05,-4817.55"/>
<polygon fill="red" stroke="red" points="519.81,-4820.58 527.24,-4813.03 516.72,-4814.3 519.81,-4820.58"/>
</g>
<!-- attn_11_gpu0 -->
<g id="node359" class="node">
<title>attn_11_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-4735.98 293.94,-4735.98 293.94,-4694.98 415.94,-4694.98 415.94,-4735.98"/>
<text text-anchor="middle" x="354.94" y="-4723.98" font-family="Arial" font-size="10.00">Attention_11_GPU0</text>
<text text-anchor="middle" x="354.94" y="-4712.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-4701.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_11_gpu0&#45;&gt;attn_11_gpu0 -->
<g id="edge181" class="edge">
<title>qkv_proj_11_gpu0&#45;&gt;attn_11_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-4771.78C345.45,-4763.94 347.29,-4754.75 349.01,-4746.14"/>
<polygon fill="red" stroke="red" points="352.5,-4746.55 351.02,-4736.06 345.63,-4745.18 352.5,-4746.55"/>
</g>
<!-- attn_11_gpu1 -->
<g id="node360" class="node">
<title>attn_11_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-4735.98 496.94,-4735.98 496.94,-4694.98 618.94,-4694.98 618.94,-4735.98"/>
<text text-anchor="middle" x="557.94" y="-4723.98" font-family="Arial" font-size="10.00">Attention_11_GPU1</text>
<text text-anchor="middle" x="557.94" y="-4712.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-4701.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_11_gpu1&#45;&gt;attn_11_gpu1 -->
<g id="edge182" class="edge">
<title>qkv_proj_11_gpu1&#45;&gt;attn_11_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-4771.78C563.63,-4763.94 562.53,-4754.75 561.5,-4746.14"/>
<polygon fill="red" stroke="red" points="564.96,-4745.57 560.29,-4736.06 558,-4746.4 564.96,-4745.57"/>
</g>
<!-- out_proj_11_gpu0 -->
<g id="node361" class="node">
<title>out_proj_11_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-4658.98 303.44,-4658.98 303.44,-4617.98 436.44,-4617.98 436.44,-4658.98"/>
<text text-anchor="middle" x="369.94" y="-4646.98" font-family="Arial" font-size="10.00">Output_Proj_11_GPU0</text>
<text text-anchor="middle" x="369.94" y="-4635.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-4624.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_11_gpu0&#45;&gt;out_proj_11_gpu0 -->
<g id="edge183" class="edge">
<title>attn_11_gpu0&#45;&gt;out_proj_11_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-4694.78C360.45,-4686.94 362.29,-4677.75 364.01,-4669.14"/>
<polygon fill="red" stroke="red" points="367.5,-4669.55 366.02,-4659.06 360.63,-4668.18 367.5,-4669.55"/>
</g>
<!-- out_proj_11_gpu1 -->
<g id="node362" class="node">
<title>out_proj_11_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-4658.98 483.44,-4658.98 483.44,-4617.98 616.44,-4617.98 616.44,-4658.98"/>
<text text-anchor="middle" x="549.94" y="-4646.98" font-family="Arial" font-size="10.00">Output_Proj_11_GPU1</text>
<text text-anchor="middle" x="549.94" y="-4635.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-4624.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_11_gpu1&#45;&gt;out_proj_11_gpu1 -->
<g id="edge184" class="edge">
<title>attn_11_gpu1&#45;&gt;out_proj_11_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-4694.78C555,-4686.94 554.02,-4677.75 553.1,-4669.14"/>
<polygon fill="red" stroke="red" points="556.57,-4668.63 552.03,-4659.06 549.61,-4669.37 556.57,-4668.63"/>
</g>
<!-- mha_merge_11 -->
<g id="node363" class="node">
<title>mha_merge_11</title>
<polygon fill="yellow" stroke="black" points="671.72,-4581.98 452.54,-4581.98 396.16,-4499.98 615.33,-4499.98 671.72,-4581.98"/>
<text text-anchor="middle" x="533.94" y="-4549.48" font-family="Arial" font-size="10.00">MHA_Merge_11</text>
<text text-anchor="middle" x="533.94" y="-4538.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-4527.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_11_gpu0&#45;&gt;mha_merge_11 -->
<g id="edge185" class="edge">
<title>out_proj_11_gpu0&#45;&gt;mha_merge_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-4617.93C418.89,-4608.98 437.8,-4597.97 456.4,-4587.13"/>
<polygon fill="red" stroke="red" points="458.32,-4590.07 465.2,-4582.01 454.8,-4584.02 458.32,-4590.07"/>
</g>
<!-- out_proj_11_gpu1&#45;&gt;mha_merge_11 -->
<g id="edge186" class="edge">
<title>out_proj_11_gpu1&#45;&gt;mha_merge_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-4617.7C545.37,-4610.23 543.89,-4601.36 542.38,-4592.37"/>
<polygon fill="red" stroke="red" points="545.79,-4591.51 540.68,-4582.23 538.88,-4592.67 545.79,-4591.51"/>
</g>
<!-- add_norm_1_11 -->
<g id="node364" class="node">
<title>add_norm_1_11</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-4463.98 481.44,-4463.98 481.44,-4422.98 614.44,-4422.98 614.44,-4463.98"/>
<text text-anchor="middle" x="547.94" y="-4451.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_11</text>
<text text-anchor="middle" x="547.94" y="-4440.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-4429.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_11&#45;&gt;add_norm_1_11 -->
<g id="edge187" class="edge">
<title>mha_merge_11&#45;&gt;add_norm_1_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-4499.76C541.09,-4491.18 542.4,-4482.27 543.59,-4474.17"/>
<polygon fill="red" stroke="red" points="547.08,-4474.5 545.06,-4464.09 540.15,-4473.48 547.08,-4474.5"/>
</g>
<!-- gate_11 -->
<g id="node365" class="node">
<title>gate_11</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-4386.98 440.78,-4386.98 347.84,-4304.98 709.1,-4304.98 802.04,-4386.98"/>
<text text-anchor="middle" x="574.94" y="-4354.48" font-family="Arial" font-size="10.00">Expert_Gate_11</text>
<text text-anchor="middle" x="574.94" y="-4343.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-4332.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_11&#45;&gt;gate_11 -->
<g id="edge188" class="edge">
<title>add_norm_1_11&#45;&gt;gate_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-4422.7C555.67,-4415.15 558.21,-4406.17 560.78,-4397.08"/>
<polygon fill="red" stroke="red" points="564.21,-4397.8 563.56,-4387.23 557.47,-4395.9 564.21,-4397.8"/>
</g>
<!-- token_dist_11 -->
<g id="node366" class="node">
<title>token_dist_11</title>
<polygon fill="yellow" stroke="black" points="778.91,-4228.98 465.58,-4228.98 384.97,-4146.98 698.3,-4146.98 778.91,-4228.98"/>
<text text-anchor="middle" x="581.94" y="-4196.48" font-family="Arial" font-size="10.00">Token_Distribution_11</text>
<text text-anchor="middle" x="581.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_11&#45;&gt;token_dist_11 -->
<g id="edge189" class="edge">
<title>gate_11&#45;&gt;token_dist_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-4304.81C577.64,-4284.79 578.74,-4260.39 579.69,-4239.16"/>
<polygon fill="red" stroke="red" points="583.19,-4239.17 580.14,-4229.02 576.2,-4238.85 583.19,-4239.17"/>
</g>
<!-- token_dist_11&#45;&gt;expert_0_0 -->
<g id="edge190" class="edge">
<title>token_dist_11&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-4148.73C727.77,-4141.41 757.15,-4134.84 784.94,-4130.98 828.41,-4124.96 3905.36,-4129.95 3944.94,-4110.98 4002.06,-4083.61 4034.94,-4063.82 4034.94,-4000.48 4034.94,-4000.48 4034.94,-4000.48 4034.94,-1362.98 4034.94,-1267.28 3999.7,-1224.15 4058.94,-1148.98 4073.85,-1130.06 4098.64,-1120.2 4120.81,-1115.06"/>
<polygon fill="red" stroke="red" points="4121.68,-1118.46 4130.77,-1113.02 4120.27,-1111.6 4121.68,-1118.46"/>
</g>
<!-- expert_11_0_gpu0 -->
<g id="node367" class="node">
<title>expert_11_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-4208.48 3802.94,-4208.48 3802.94,-4167.48 3916.94,-4167.48 3916.94,-4208.48"/>
<text text-anchor="middle" x="3859.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_0_gpu1 -->
<g id="node368" class="node">
<title>expert_11_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-4208.48 3670.94,-4208.48 3670.94,-4167.48 3784.94,-4167.48 3784.94,-4208.48"/>
<text text-anchor="middle" x="3727.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_0 -->
<g id="node369" class="node">
<title>expert_merge_11_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-4228.98 3465,-4228.98 3416.56,-4146.98 3604.88,-4146.98 3653.32,-4228.98"/>
<text text-anchor="middle" x="3534.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_Merge_11_0</text>
<text text-anchor="middle" x="3534.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_11_1_gpu0 -->
<g id="node370" class="node">
<title>expert_11_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-4208.48 3278.94,-4208.48 3278.94,-4167.48 3392.94,-4167.48 3392.94,-4208.48"/>
<text text-anchor="middle" x="3335.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_1_gpu1 -->
<g id="node371" class="node">
<title>expert_11_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-4208.48 3146.94,-4208.48 3146.94,-4167.48 3260.94,-4167.48 3260.94,-4208.48"/>
<text text-anchor="middle" x="3203.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_1 -->
<g id="node372" class="node">
<title>expert_merge_11_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-4228.98 2941,-4228.98 2892.56,-4146.98 3080.88,-4146.98 3129.32,-4228.98"/>
<text text-anchor="middle" x="3010.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_Merge_11_1</text>
<text text-anchor="middle" x="3010.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_11_2_gpu0 -->
<g id="node373" class="node">
<title>expert_11_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-4208.48 2754.94,-4208.48 2754.94,-4167.48 2868.94,-4167.48 2868.94,-4208.48"/>
<text text-anchor="middle" x="2811.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_2_gpu1 -->
<g id="node374" class="node">
<title>expert_11_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-4208.48 2622.94,-4208.48 2622.94,-4167.48 2736.94,-4167.48 2736.94,-4208.48"/>
<text text-anchor="middle" x="2679.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_2 -->
<g id="node375" class="node">
<title>expert_merge_11_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-4228.98 2417,-4228.98 2368.56,-4146.98 2556.88,-4146.98 2605.32,-4228.98"/>
<text text-anchor="middle" x="2486.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_Merge_11_2</text>
<text text-anchor="middle" x="2486.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_11_3_gpu0 -->
<g id="node376" class="node">
<title>expert_11_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-4208.48 2230.94,-4208.48 2230.94,-4167.48 2344.94,-4167.48 2344.94,-4208.48"/>
<text text-anchor="middle" x="2287.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_3_gpu1 -->
<g id="node377" class="node">
<title>expert_11_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-4208.48 2098.94,-4208.48 2098.94,-4167.48 2212.94,-4167.48 2212.94,-4208.48"/>
<text text-anchor="middle" x="2155.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_3 -->
<g id="node378" class="node">
<title>expert_merge_11_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-4228.98 1893,-4228.98 1844.56,-4146.98 2032.88,-4146.98 2081.32,-4228.98"/>
<text text-anchor="middle" x="1962.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_Merge_11_3</text>
<text text-anchor="middle" x="1962.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_11_62_gpu0 -->
<g id="node379" class="node">
<title>expert_11_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-4208.48 1706.94,-4208.48 1706.94,-4167.48 1820.94,-4167.48 1820.94,-4208.48"/>
<text text-anchor="middle" x="1763.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_62_gpu1 -->
<g id="node380" class="node">
<title>expert_11_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-4208.48 1574.94,-4208.48 1574.94,-4167.48 1688.94,-4167.48 1688.94,-4208.48"/>
<text text-anchor="middle" x="1631.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_62 -->
<g id="node381" class="node">
<title>expert_merge_11_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-4228.98 1369,-4228.98 1320.56,-4146.98 1508.88,-4146.98 1557.32,-4228.98"/>
<text text-anchor="middle" x="1438.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_Merge_11_62</text>
<text text-anchor="middle" x="1438.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_11_63_gpu0 -->
<g id="node382" class="node">
<title>expert_11_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-4208.48 1182.94,-4208.48 1182.94,-4167.48 1296.94,-4167.48 1296.94,-4208.48"/>
<text text-anchor="middle" x="1239.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_11_63_gpu1 -->
<g id="node383" class="node">
<title>expert_11_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-4208.48 1050.94,-4208.48 1050.94,-4167.48 1164.94,-4167.48 1164.94,-4208.48"/>
<text text-anchor="middle" x="1107.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_11_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_11_63 -->
<g id="node384" class="node">
<title>expert_merge_11_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-4228.98 845,-4228.98 796.56,-4146.98 984.88,-4146.98 1033.32,-4228.98"/>
<text text-anchor="middle" x="914.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_Merge_11_63</text>
<text text-anchor="middle" x="914.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_11 -->
<g id="node385" class="node">
<title>expert_agg_11</title>
<polygon fill="yellow" stroke="black" points="366.55,-4228.98 106.28,-4228.98 39.33,-4146.98 299.6,-4146.98 366.55,-4228.98"/>
<text text-anchor="middle" x="202.94" y="-4196.48" font-family="Arial" font-size="10.00">Expert_Aggregation_11</text>
<text text-anchor="middle" x="202.94" y="-4185.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-4174.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_11 -->
<g id="node386" class="node">
<title>add_norm_2_11</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-4110.98 143.44,-4110.98 143.44,-4069.98 276.44,-4069.98 276.44,-4110.98"/>
<text text-anchor="middle" x="209.94" y="-4098.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_11</text>
<text text-anchor="middle" x="209.94" y="-4087.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-4076.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_11&#45;&gt;add_norm_2_11 -->
<g id="edge192" class="edge">
<title>expert_agg_11&#45;&gt;add_norm_2_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-4146.76C206.52,-4138.18 207.17,-4129.27 207.76,-4121.17"/>
<polygon fill="red" stroke="red" points="211.26,-4121.32 208.5,-4111.09 204.28,-4120.81 211.26,-4121.32"/>
</g>
<!-- layer_norm_12 -->
<g id="node387" class="node">
<title>layer_norm_12</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-4019.98 252.44,-4019.98 252.44,-3978.98 385.44,-3978.98 385.44,-4019.98"/>
<text text-anchor="middle" x="318.94" y="-4007.98" font-family="Arial" font-size="10.00">LayerNorm_12</text>
<text text-anchor="middle" x="318.94" y="-3996.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-3985.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_11&#45;&gt;layer_norm_12 -->
<g id="edge193" class="edge">
<title>add_norm_2_11&#45;&gt;layer_norm_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-4069.95C249.37,-4057.29 269.77,-4040.63 286.7,-4026.81"/>
<polygon fill="red" stroke="red" points="289.17,-4029.31 294.7,-4020.28 284.74,-4023.89 289.17,-4029.31"/>
</g>
<!-- mha_split_12 -->
<g id="node388" class="node">
<title>mha_split_12</title>
<polygon fill="yellow" stroke="black" points="510.72,-3936.98 291.54,-3936.98 235.16,-3854.98 454.33,-3854.98 510.72,-3936.98"/>
<text text-anchor="middle" x="372.94" y="-3904.48" font-family="Arial" font-size="10.00">MHA_Split_12</text>
<text text-anchor="middle" x="372.94" y="-3893.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-3882.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_12&#45;&gt;mha_split_12 -->
<g id="edge194" class="edge">
<title>layer_norm_12&#45;&gt;mha_split_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-3978.91C334.38,-3969.46 340.67,-3957.64 346.89,-3945.95"/>
<polygon fill="red" stroke="red" points="350,-3947.55 351.61,-3937.08 343.82,-3944.26 350,-3947.55"/>
</g>
<!-- qkv_proj_12_gpu0 -->
<g id="node389" class="node">
<title>qkv_proj_12_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-3818.98 235.44,-3818.98 235.44,-3777.98 444.44,-3777.98 444.44,-3818.98"/>
<text text-anchor="middle" x="339.94" y="-3806.98" font-family="Arial" font-size="10.00">QKV_Proj_12_GPU0</text>
<text text-anchor="middle" x="339.94" y="-3795.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-3784.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_12&#45;&gt;qkv_proj_12_gpu0 -->
<g id="edge195" class="edge">
<title>mha_split_12&#45;&gt;qkv_proj_12_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-3854.76C356.01,-3845.99 352.86,-3836.87 350.01,-3828.63"/>
<polygon fill="red" stroke="red" points="353.29,-3827.4 346.72,-3819.09 346.67,-3829.69 353.29,-3827.4"/>
</g>
<!-- qkv_proj_12_gpu1 -->
<g id="node390" class="node">
<title>qkv_proj_12_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-3818.98 462.44,-3818.98 462.44,-3777.98 671.44,-3777.98 671.44,-3818.98"/>
<text text-anchor="middle" x="566.94" y="-3806.98" font-family="Arial" font-size="10.00">QKV_Proj_12_GPU1</text>
<text text-anchor="middle" x="566.94" y="-3795.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-3784.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_12&#45;&gt;qkv_proj_12_gpu1 -->
<g id="edge196" class="edge">
<title>mha_split_12&#45;&gt;qkv_proj_12_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-3854.9C476.02,-3844.24 498.74,-3833.06 518.05,-3823.55"/>
<polygon fill="red" stroke="red" points="519.81,-3826.58 527.24,-3819.03 516.72,-3820.3 519.81,-3826.58"/>
</g>
<!-- attn_12_gpu0 -->
<g id="node391" class="node">
<title>attn_12_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-3741.98 293.94,-3741.98 293.94,-3700.98 415.94,-3700.98 415.94,-3741.98"/>
<text text-anchor="middle" x="354.94" y="-3729.98" font-family="Arial" font-size="10.00">Attention_12_GPU0</text>
<text text-anchor="middle" x="354.94" y="-3718.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-3707.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_12_gpu0&#45;&gt;attn_12_gpu0 -->
<g id="edge197" class="edge">
<title>qkv_proj_12_gpu0&#45;&gt;attn_12_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-3777.78C345.45,-3769.94 347.29,-3760.75 349.01,-3752.14"/>
<polygon fill="red" stroke="red" points="352.5,-3752.55 351.02,-3742.06 345.63,-3751.18 352.5,-3752.55"/>
</g>
<!-- attn_12_gpu1 -->
<g id="node392" class="node">
<title>attn_12_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-3741.98 496.94,-3741.98 496.94,-3700.98 618.94,-3700.98 618.94,-3741.98"/>
<text text-anchor="middle" x="557.94" y="-3729.98" font-family="Arial" font-size="10.00">Attention_12_GPU1</text>
<text text-anchor="middle" x="557.94" y="-3718.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-3707.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_12_gpu1&#45;&gt;attn_12_gpu1 -->
<g id="edge198" class="edge">
<title>qkv_proj_12_gpu1&#45;&gt;attn_12_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-3777.78C563.63,-3769.94 562.53,-3760.75 561.5,-3752.14"/>
<polygon fill="red" stroke="red" points="564.96,-3751.57 560.29,-3742.06 558,-3752.4 564.96,-3751.57"/>
</g>
<!-- out_proj_12_gpu0 -->
<g id="node393" class="node">
<title>out_proj_12_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-3664.98 303.44,-3664.98 303.44,-3623.98 436.44,-3623.98 436.44,-3664.98"/>
<text text-anchor="middle" x="369.94" y="-3652.98" font-family="Arial" font-size="10.00">Output_Proj_12_GPU0</text>
<text text-anchor="middle" x="369.94" y="-3641.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-3630.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_12_gpu0&#45;&gt;out_proj_12_gpu0 -->
<g id="edge199" class="edge">
<title>attn_12_gpu0&#45;&gt;out_proj_12_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-3700.78C360.45,-3692.94 362.29,-3683.75 364.01,-3675.14"/>
<polygon fill="red" stroke="red" points="367.5,-3675.55 366.02,-3665.06 360.63,-3674.18 367.5,-3675.55"/>
</g>
<!-- out_proj_12_gpu1 -->
<g id="node394" class="node">
<title>out_proj_12_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-3664.98 483.44,-3664.98 483.44,-3623.98 616.44,-3623.98 616.44,-3664.98"/>
<text text-anchor="middle" x="549.94" y="-3652.98" font-family="Arial" font-size="10.00">Output_Proj_12_GPU1</text>
<text text-anchor="middle" x="549.94" y="-3641.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-3630.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_12_gpu1&#45;&gt;out_proj_12_gpu1 -->
<g id="edge200" class="edge">
<title>attn_12_gpu1&#45;&gt;out_proj_12_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-3700.78C555,-3692.94 554.02,-3683.75 553.1,-3675.14"/>
<polygon fill="red" stroke="red" points="556.57,-3674.63 552.03,-3665.06 549.61,-3675.37 556.57,-3674.63"/>
</g>
<!-- mha_merge_12 -->
<g id="node395" class="node">
<title>mha_merge_12</title>
<polygon fill="yellow" stroke="black" points="671.72,-3587.98 452.54,-3587.98 396.16,-3505.98 615.33,-3505.98 671.72,-3587.98"/>
<text text-anchor="middle" x="533.94" y="-3555.48" font-family="Arial" font-size="10.00">MHA_Merge_12</text>
<text text-anchor="middle" x="533.94" y="-3544.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-3533.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_12_gpu0&#45;&gt;mha_merge_12 -->
<g id="edge201" class="edge">
<title>out_proj_12_gpu0&#45;&gt;mha_merge_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-3623.93C418.89,-3614.98 437.8,-3603.97 456.4,-3593.13"/>
<polygon fill="red" stroke="red" points="458.32,-3596.07 465.2,-3588.01 454.8,-3590.02 458.32,-3596.07"/>
</g>
<!-- out_proj_12_gpu1&#45;&gt;mha_merge_12 -->
<g id="edge202" class="edge">
<title>out_proj_12_gpu1&#45;&gt;mha_merge_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-3623.7C545.37,-3616.23 543.89,-3607.36 542.38,-3598.37"/>
<polygon fill="red" stroke="red" points="545.79,-3597.51 540.68,-3588.23 538.88,-3598.67 545.79,-3597.51"/>
</g>
<!-- add_norm_1_12 -->
<g id="node396" class="node">
<title>add_norm_1_12</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-3469.98 481.44,-3469.98 481.44,-3428.98 614.44,-3428.98 614.44,-3469.98"/>
<text text-anchor="middle" x="547.94" y="-3457.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_12</text>
<text text-anchor="middle" x="547.94" y="-3446.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-3435.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_12&#45;&gt;add_norm_1_12 -->
<g id="edge203" class="edge">
<title>mha_merge_12&#45;&gt;add_norm_1_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-3505.76C541.09,-3497.18 542.4,-3488.27 543.59,-3480.17"/>
<polygon fill="red" stroke="red" points="547.08,-3480.5 545.06,-3470.09 540.15,-3479.48 547.08,-3480.5"/>
</g>
<!-- gate_12 -->
<g id="node397" class="node">
<title>gate_12</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-3392.98 440.78,-3392.98 347.84,-3310.98 709.1,-3310.98 802.04,-3392.98"/>
<text text-anchor="middle" x="574.94" y="-3360.48" font-family="Arial" font-size="10.00">Expert_Gate_12</text>
<text text-anchor="middle" x="574.94" y="-3349.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-3338.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_12&#45;&gt;gate_12 -->
<g id="edge204" class="edge">
<title>add_norm_1_12&#45;&gt;gate_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-3428.7C555.67,-3421.15 558.21,-3412.17 560.78,-3403.08"/>
<polygon fill="red" stroke="red" points="564.21,-3403.8 563.56,-3393.23 557.47,-3401.9 564.21,-3403.8"/>
</g>
<!-- token_dist_12 -->
<g id="node398" class="node">
<title>token_dist_12</title>
<polygon fill="yellow" stroke="black" points="778.91,-3234.98 465.58,-3234.98 384.97,-3152.98 698.3,-3152.98 778.91,-3234.98"/>
<text text-anchor="middle" x="581.94" y="-3202.48" font-family="Arial" font-size="10.00">Token_Distribution_12</text>
<text text-anchor="middle" x="581.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_12&#45;&gt;token_dist_12 -->
<g id="edge205" class="edge">
<title>gate_12&#45;&gt;token_dist_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-3310.81C577.64,-3290.79 578.74,-3266.39 579.69,-3245.16"/>
<polygon fill="red" stroke="red" points="583.19,-3245.17 580.14,-3235.02 576.2,-3244.85 583.19,-3245.17"/>
</g>
<!-- token_dist_12&#45;&gt;expert_0_0 -->
<g id="edge206" class="edge">
<title>token_dist_12&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-3154.73C727.77,-3147.41 757.15,-3140.84 784.94,-3136.98 828.41,-3130.96 3907.96,-3140.62 3944.94,-3116.98 3990.68,-3087.76 3996.94,-3060.76 3996.94,-3006.48 3996.94,-3006.48 3996.94,-3006.48 3996.94,-1362.98 3996.94,-1267.28 3958.56,-1221.56 4020.94,-1148.98 4034.06,-1133.71 4083.65,-1122.63 4121.64,-1116.15"/>
<polygon fill="red" stroke="red" points="4122.21,-1119.61 4131.51,-1114.53 4121.07,-1112.7 4122.21,-1119.61"/>
</g>
<!-- expert_12_0_gpu0 -->
<g id="node399" class="node">
<title>expert_12_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-3214.48 3802.94,-3214.48 3802.94,-3173.48 3916.94,-3173.48 3916.94,-3214.48"/>
<text text-anchor="middle" x="3859.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_0_gpu1 -->
<g id="node400" class="node">
<title>expert_12_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-3214.48 3670.94,-3214.48 3670.94,-3173.48 3784.94,-3173.48 3784.94,-3214.48"/>
<text text-anchor="middle" x="3727.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_0 -->
<g id="node401" class="node">
<title>expert_merge_12_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-3234.98 3465,-3234.98 3416.56,-3152.98 3604.88,-3152.98 3653.32,-3234.98"/>
<text text-anchor="middle" x="3534.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_Merge_12_0</text>
<text text-anchor="middle" x="3534.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_12_1_gpu0 -->
<g id="node402" class="node">
<title>expert_12_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-3214.48 3278.94,-3214.48 3278.94,-3173.48 3392.94,-3173.48 3392.94,-3214.48"/>
<text text-anchor="middle" x="3335.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_1_gpu1 -->
<g id="node403" class="node">
<title>expert_12_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-3214.48 3146.94,-3214.48 3146.94,-3173.48 3260.94,-3173.48 3260.94,-3214.48"/>
<text text-anchor="middle" x="3203.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_1 -->
<g id="node404" class="node">
<title>expert_merge_12_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-3234.98 2941,-3234.98 2892.56,-3152.98 3080.88,-3152.98 3129.32,-3234.98"/>
<text text-anchor="middle" x="3010.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_Merge_12_1</text>
<text text-anchor="middle" x="3010.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_12_2_gpu0 -->
<g id="node405" class="node">
<title>expert_12_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-3214.48 2754.94,-3214.48 2754.94,-3173.48 2868.94,-3173.48 2868.94,-3214.48"/>
<text text-anchor="middle" x="2811.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_2_gpu1 -->
<g id="node406" class="node">
<title>expert_12_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-3214.48 2622.94,-3214.48 2622.94,-3173.48 2736.94,-3173.48 2736.94,-3214.48"/>
<text text-anchor="middle" x="2679.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_2 -->
<g id="node407" class="node">
<title>expert_merge_12_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-3234.98 2417,-3234.98 2368.56,-3152.98 2556.88,-3152.98 2605.32,-3234.98"/>
<text text-anchor="middle" x="2486.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_Merge_12_2</text>
<text text-anchor="middle" x="2486.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_12_3_gpu0 -->
<g id="node408" class="node">
<title>expert_12_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-3214.48 2230.94,-3214.48 2230.94,-3173.48 2344.94,-3173.48 2344.94,-3214.48"/>
<text text-anchor="middle" x="2287.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_3_gpu1 -->
<g id="node409" class="node">
<title>expert_12_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-3214.48 2098.94,-3214.48 2098.94,-3173.48 2212.94,-3173.48 2212.94,-3214.48"/>
<text text-anchor="middle" x="2155.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_3 -->
<g id="node410" class="node">
<title>expert_merge_12_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-3234.98 1893,-3234.98 1844.56,-3152.98 2032.88,-3152.98 2081.32,-3234.98"/>
<text text-anchor="middle" x="1962.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_Merge_12_3</text>
<text text-anchor="middle" x="1962.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_12_62_gpu0 -->
<g id="node411" class="node">
<title>expert_12_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-3214.48 1706.94,-3214.48 1706.94,-3173.48 1820.94,-3173.48 1820.94,-3214.48"/>
<text text-anchor="middle" x="1763.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_62_gpu1 -->
<g id="node412" class="node">
<title>expert_12_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-3214.48 1574.94,-3214.48 1574.94,-3173.48 1688.94,-3173.48 1688.94,-3214.48"/>
<text text-anchor="middle" x="1631.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_62 -->
<g id="node413" class="node">
<title>expert_merge_12_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-3234.98 1369,-3234.98 1320.56,-3152.98 1508.88,-3152.98 1557.32,-3234.98"/>
<text text-anchor="middle" x="1438.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_Merge_12_62</text>
<text text-anchor="middle" x="1438.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_12_63_gpu0 -->
<g id="node414" class="node">
<title>expert_12_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-3214.48 1182.94,-3214.48 1182.94,-3173.48 1296.94,-3173.48 1296.94,-3214.48"/>
<text text-anchor="middle" x="1239.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_12_63_gpu1 -->
<g id="node415" class="node">
<title>expert_12_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-3214.48 1050.94,-3214.48 1050.94,-3173.48 1164.94,-3173.48 1164.94,-3214.48"/>
<text text-anchor="middle" x="1107.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_12_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_12_63 -->
<g id="node416" class="node">
<title>expert_merge_12_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-3234.98 845,-3234.98 796.56,-3152.98 984.88,-3152.98 1033.32,-3234.98"/>
<text text-anchor="middle" x="914.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_Merge_12_63</text>
<text text-anchor="middle" x="914.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_12 -->
<g id="node417" class="node">
<title>expert_agg_12</title>
<polygon fill="yellow" stroke="black" points="366.55,-3234.98 106.28,-3234.98 39.33,-3152.98 299.6,-3152.98 366.55,-3234.98"/>
<text text-anchor="middle" x="202.94" y="-3202.48" font-family="Arial" font-size="10.00">Expert_Aggregation_12</text>
<text text-anchor="middle" x="202.94" y="-3191.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-3180.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_12 -->
<g id="node418" class="node">
<title>add_norm_2_12</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-3116.98 143.44,-3116.98 143.44,-3075.98 276.44,-3075.98 276.44,-3116.98"/>
<text text-anchor="middle" x="209.94" y="-3104.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_12</text>
<text text-anchor="middle" x="209.94" y="-3093.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-3082.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_12&#45;&gt;add_norm_2_12 -->
<g id="edge208" class="edge">
<title>expert_agg_12&#45;&gt;add_norm_2_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-3152.76C206.52,-3144.18 207.17,-3135.27 207.76,-3127.17"/>
<polygon fill="red" stroke="red" points="211.26,-3127.32 208.5,-3117.09 204.28,-3126.81 211.26,-3127.32"/>
</g>
<!-- layer_norm_13 -->
<g id="node419" class="node">
<title>layer_norm_13</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-3025.98 252.44,-3025.98 252.44,-2984.98 385.44,-2984.98 385.44,-3025.98"/>
<text text-anchor="middle" x="318.94" y="-3013.98" font-family="Arial" font-size="10.00">LayerNorm_13</text>
<text text-anchor="middle" x="318.94" y="-3002.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-2991.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_12&#45;&gt;layer_norm_13 -->
<g id="edge209" class="edge">
<title>add_norm_2_12&#45;&gt;layer_norm_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-3075.95C249.37,-3063.29 269.77,-3046.63 286.7,-3032.81"/>
<polygon fill="red" stroke="red" points="289.17,-3035.31 294.7,-3026.28 284.74,-3029.89 289.17,-3035.31"/>
</g>
<!-- mha_split_13 -->
<g id="node420" class="node">
<title>mha_split_13</title>
<polygon fill="yellow" stroke="black" points="510.72,-2942.98 291.54,-2942.98 235.16,-2860.98 454.33,-2860.98 510.72,-2942.98"/>
<text text-anchor="middle" x="372.94" y="-2910.48" font-family="Arial" font-size="10.00">MHA_Split_13</text>
<text text-anchor="middle" x="372.94" y="-2899.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-2888.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_13&#45;&gt;mha_split_13 -->
<g id="edge210" class="edge">
<title>layer_norm_13&#45;&gt;mha_split_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-2984.91C334.38,-2975.46 340.67,-2963.64 346.89,-2951.95"/>
<polygon fill="red" stroke="red" points="350,-2953.55 351.61,-2943.08 343.82,-2950.26 350,-2953.55"/>
</g>
<!-- qkv_proj_13_gpu0 -->
<g id="node421" class="node">
<title>qkv_proj_13_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-2824.98 235.44,-2824.98 235.44,-2783.98 444.44,-2783.98 444.44,-2824.98"/>
<text text-anchor="middle" x="339.94" y="-2812.98" font-family="Arial" font-size="10.00">QKV_Proj_13_GPU0</text>
<text text-anchor="middle" x="339.94" y="-2801.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-2790.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_13&#45;&gt;qkv_proj_13_gpu0 -->
<g id="edge211" class="edge">
<title>mha_split_13&#45;&gt;qkv_proj_13_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-2860.76C356.01,-2851.99 352.86,-2842.87 350.01,-2834.63"/>
<polygon fill="red" stroke="red" points="353.29,-2833.4 346.72,-2825.09 346.67,-2835.69 353.29,-2833.4"/>
</g>
<!-- qkv_proj_13_gpu1 -->
<g id="node422" class="node">
<title>qkv_proj_13_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-2824.98 462.44,-2824.98 462.44,-2783.98 671.44,-2783.98 671.44,-2824.98"/>
<text text-anchor="middle" x="566.94" y="-2812.98" font-family="Arial" font-size="10.00">QKV_Proj_13_GPU1</text>
<text text-anchor="middle" x="566.94" y="-2801.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-2790.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_13&#45;&gt;qkv_proj_13_gpu1 -->
<g id="edge212" class="edge">
<title>mha_split_13&#45;&gt;qkv_proj_13_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-2860.9C476.02,-2850.24 498.74,-2839.06 518.05,-2829.55"/>
<polygon fill="red" stroke="red" points="519.81,-2832.58 527.24,-2825.03 516.72,-2826.3 519.81,-2832.58"/>
</g>
<!-- attn_13_gpu0 -->
<g id="node423" class="node">
<title>attn_13_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-2747.98 293.94,-2747.98 293.94,-2706.98 415.94,-2706.98 415.94,-2747.98"/>
<text text-anchor="middle" x="354.94" y="-2735.98" font-family="Arial" font-size="10.00">Attention_13_GPU0</text>
<text text-anchor="middle" x="354.94" y="-2724.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-2713.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_13_gpu0&#45;&gt;attn_13_gpu0 -->
<g id="edge213" class="edge">
<title>qkv_proj_13_gpu0&#45;&gt;attn_13_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-2783.78C345.45,-2775.94 347.29,-2766.75 349.01,-2758.14"/>
<polygon fill="red" stroke="red" points="352.5,-2758.55 351.02,-2748.06 345.63,-2757.18 352.5,-2758.55"/>
</g>
<!-- attn_13_gpu1 -->
<g id="node424" class="node">
<title>attn_13_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-2747.98 496.94,-2747.98 496.94,-2706.98 618.94,-2706.98 618.94,-2747.98"/>
<text text-anchor="middle" x="557.94" y="-2735.98" font-family="Arial" font-size="10.00">Attention_13_GPU1</text>
<text text-anchor="middle" x="557.94" y="-2724.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-2713.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_13_gpu1&#45;&gt;attn_13_gpu1 -->
<g id="edge214" class="edge">
<title>qkv_proj_13_gpu1&#45;&gt;attn_13_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-2783.78C563.63,-2775.94 562.53,-2766.75 561.5,-2758.14"/>
<polygon fill="red" stroke="red" points="564.96,-2757.57 560.29,-2748.06 558,-2758.4 564.96,-2757.57"/>
</g>
<!-- out_proj_13_gpu0 -->
<g id="node425" class="node">
<title>out_proj_13_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-2670.98 303.44,-2670.98 303.44,-2629.98 436.44,-2629.98 436.44,-2670.98"/>
<text text-anchor="middle" x="369.94" y="-2658.98" font-family="Arial" font-size="10.00">Output_Proj_13_GPU0</text>
<text text-anchor="middle" x="369.94" y="-2647.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-2636.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_13_gpu0&#45;&gt;out_proj_13_gpu0 -->
<g id="edge215" class="edge">
<title>attn_13_gpu0&#45;&gt;out_proj_13_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-2706.78C360.45,-2698.94 362.29,-2689.75 364.01,-2681.14"/>
<polygon fill="red" stroke="red" points="367.5,-2681.55 366.02,-2671.06 360.63,-2680.18 367.5,-2681.55"/>
</g>
<!-- out_proj_13_gpu1 -->
<g id="node426" class="node">
<title>out_proj_13_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-2670.98 483.44,-2670.98 483.44,-2629.98 616.44,-2629.98 616.44,-2670.98"/>
<text text-anchor="middle" x="549.94" y="-2658.98" font-family="Arial" font-size="10.00">Output_Proj_13_GPU1</text>
<text text-anchor="middle" x="549.94" y="-2647.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-2636.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_13_gpu1&#45;&gt;out_proj_13_gpu1 -->
<g id="edge216" class="edge">
<title>attn_13_gpu1&#45;&gt;out_proj_13_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-2706.78C555,-2698.94 554.02,-2689.75 553.1,-2681.14"/>
<polygon fill="red" stroke="red" points="556.57,-2680.63 552.03,-2671.06 549.61,-2681.37 556.57,-2680.63"/>
</g>
<!-- mha_merge_13 -->
<g id="node427" class="node">
<title>mha_merge_13</title>
<polygon fill="yellow" stroke="black" points="671.72,-2593.98 452.54,-2593.98 396.16,-2511.98 615.33,-2511.98 671.72,-2593.98"/>
<text text-anchor="middle" x="533.94" y="-2561.48" font-family="Arial" font-size="10.00">MHA_Merge_13</text>
<text text-anchor="middle" x="533.94" y="-2550.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-2539.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_13_gpu0&#45;&gt;mha_merge_13 -->
<g id="edge217" class="edge">
<title>out_proj_13_gpu0&#45;&gt;mha_merge_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-2629.93C418.89,-2620.98 437.8,-2609.97 456.4,-2599.13"/>
<polygon fill="red" stroke="red" points="458.32,-2602.07 465.2,-2594.01 454.8,-2596.02 458.32,-2602.07"/>
</g>
<!-- out_proj_13_gpu1&#45;&gt;mha_merge_13 -->
<g id="edge218" class="edge">
<title>out_proj_13_gpu1&#45;&gt;mha_merge_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-2629.7C545.37,-2622.23 543.89,-2613.36 542.38,-2604.37"/>
<polygon fill="red" stroke="red" points="545.79,-2603.51 540.68,-2594.23 538.88,-2604.67 545.79,-2603.51"/>
</g>
<!-- add_norm_1_13 -->
<g id="node428" class="node">
<title>add_norm_1_13</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-2475.98 481.44,-2475.98 481.44,-2434.98 614.44,-2434.98 614.44,-2475.98"/>
<text text-anchor="middle" x="547.94" y="-2463.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_13</text>
<text text-anchor="middle" x="547.94" y="-2452.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-2441.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_13&#45;&gt;add_norm_1_13 -->
<g id="edge219" class="edge">
<title>mha_merge_13&#45;&gt;add_norm_1_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-2511.76C541.09,-2503.18 542.4,-2494.27 543.59,-2486.17"/>
<polygon fill="red" stroke="red" points="547.08,-2486.5 545.06,-2476.09 540.15,-2485.48 547.08,-2486.5"/>
</g>
<!-- gate_13 -->
<g id="node429" class="node">
<title>gate_13</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-2398.98 440.78,-2398.98 347.84,-2316.98 709.1,-2316.98 802.04,-2398.98"/>
<text text-anchor="middle" x="574.94" y="-2366.48" font-family="Arial" font-size="10.00">Expert_Gate_13</text>
<text text-anchor="middle" x="574.94" y="-2355.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-2344.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_13&#45;&gt;gate_13 -->
<g id="edge220" class="edge">
<title>add_norm_1_13&#45;&gt;gate_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-2434.7C555.67,-2427.15 558.21,-2418.17 560.78,-2409.08"/>
<polygon fill="red" stroke="red" points="564.21,-2409.8 563.56,-2399.23 557.47,-2407.9 564.21,-2409.8"/>
</g>
<!-- token_dist_13 -->
<g id="node430" class="node">
<title>token_dist_13</title>
<polygon fill="yellow" stroke="black" points="778.91,-2240.98 465.58,-2240.98 384.97,-2158.98 698.3,-2158.98 778.91,-2240.98"/>
<text text-anchor="middle" x="581.94" y="-2208.48" font-family="Arial" font-size="10.00">Token_Distribution_13</text>
<text text-anchor="middle" x="581.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_13&#45;&gt;token_dist_13 -->
<g id="edge221" class="edge">
<title>gate_13&#45;&gt;token_dist_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-2316.81C577.64,-2296.79 578.74,-2272.39 579.69,-2251.16"/>
<polygon fill="red" stroke="red" points="583.19,-2251.17 580.14,-2241.02 576.2,-2250.85 583.19,-2251.17"/>
</g>
<!-- token_dist_13&#45;&gt;expert_0_0 -->
<g id="edge222" class="edge">
<title>token_dist_13&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-2160.73C727.77,-2153.41 757.15,-2146.84 784.94,-2142.98 828.41,-2136.96 3912.1,-2152.11 3944.94,-2122.98 3981.98,-2090.13 3958.94,-2061.99 3958.94,-2012.48 3958.94,-2012.48 3958.94,-2012.48 3958.94,-1362.98 3958.94,-1267.28 3918.68,-1219.91 3982.94,-1148.98 4001,-1129.04 4071.73,-1118.45 4120.3,-1113.4"/>
<polygon fill="red" stroke="red" points="4120.7,-1116.88 4130.3,-1112.41 4120.01,-1109.91 4120.7,-1116.88"/>
</g>
<!-- expert_13_0_gpu0 -->
<g id="node431" class="node">
<title>expert_13_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-2220.48 3802.94,-2220.48 3802.94,-2179.48 3916.94,-2179.48 3916.94,-2220.48"/>
<text text-anchor="middle" x="3859.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_0_gpu1 -->
<g id="node432" class="node">
<title>expert_13_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-2220.48 3670.94,-2220.48 3670.94,-2179.48 3784.94,-2179.48 3784.94,-2220.48"/>
<text text-anchor="middle" x="3727.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_0 -->
<g id="node433" class="node">
<title>expert_merge_13_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-2240.98 3465,-2240.98 3416.56,-2158.98 3604.88,-2158.98 3653.32,-2240.98"/>
<text text-anchor="middle" x="3534.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_Merge_13_0</text>
<text text-anchor="middle" x="3534.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_13_1_gpu0 -->
<g id="node434" class="node">
<title>expert_13_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-2220.48 3278.94,-2220.48 3278.94,-2179.48 3392.94,-2179.48 3392.94,-2220.48"/>
<text text-anchor="middle" x="3335.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_1_gpu1 -->
<g id="node435" class="node">
<title>expert_13_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-2220.48 3146.94,-2220.48 3146.94,-2179.48 3260.94,-2179.48 3260.94,-2220.48"/>
<text text-anchor="middle" x="3203.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_1 -->
<g id="node436" class="node">
<title>expert_merge_13_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-2240.98 2941,-2240.98 2892.56,-2158.98 3080.88,-2158.98 3129.32,-2240.98"/>
<text text-anchor="middle" x="3010.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_Merge_13_1</text>
<text text-anchor="middle" x="3010.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_13_2_gpu0 -->
<g id="node437" class="node">
<title>expert_13_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-2220.48 2754.94,-2220.48 2754.94,-2179.48 2868.94,-2179.48 2868.94,-2220.48"/>
<text text-anchor="middle" x="2811.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_2_gpu1 -->
<g id="node438" class="node">
<title>expert_13_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-2220.48 2622.94,-2220.48 2622.94,-2179.48 2736.94,-2179.48 2736.94,-2220.48"/>
<text text-anchor="middle" x="2679.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_2 -->
<g id="node439" class="node">
<title>expert_merge_13_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-2240.98 2417,-2240.98 2368.56,-2158.98 2556.88,-2158.98 2605.32,-2240.98"/>
<text text-anchor="middle" x="2486.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_Merge_13_2</text>
<text text-anchor="middle" x="2486.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_13_3_gpu0 -->
<g id="node440" class="node">
<title>expert_13_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-2220.48 2230.94,-2220.48 2230.94,-2179.48 2344.94,-2179.48 2344.94,-2220.48"/>
<text text-anchor="middle" x="2287.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_3_gpu1 -->
<g id="node441" class="node">
<title>expert_13_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-2220.48 2098.94,-2220.48 2098.94,-2179.48 2212.94,-2179.48 2212.94,-2220.48"/>
<text text-anchor="middle" x="2155.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_3 -->
<g id="node442" class="node">
<title>expert_merge_13_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-2240.98 1893,-2240.98 1844.56,-2158.98 2032.88,-2158.98 2081.32,-2240.98"/>
<text text-anchor="middle" x="1962.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_Merge_13_3</text>
<text text-anchor="middle" x="1962.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_13_62_gpu0 -->
<g id="node443" class="node">
<title>expert_13_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-2220.48 1706.94,-2220.48 1706.94,-2179.48 1820.94,-2179.48 1820.94,-2220.48"/>
<text text-anchor="middle" x="1763.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_62_gpu1 -->
<g id="node444" class="node">
<title>expert_13_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-2220.48 1574.94,-2220.48 1574.94,-2179.48 1688.94,-2179.48 1688.94,-2220.48"/>
<text text-anchor="middle" x="1631.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_62 -->
<g id="node445" class="node">
<title>expert_merge_13_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-2240.98 1369,-2240.98 1320.56,-2158.98 1508.88,-2158.98 1557.32,-2240.98"/>
<text text-anchor="middle" x="1438.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_Merge_13_62</text>
<text text-anchor="middle" x="1438.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_13_63_gpu0 -->
<g id="node446" class="node">
<title>expert_13_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-2220.48 1182.94,-2220.48 1182.94,-2179.48 1296.94,-2179.48 1296.94,-2220.48"/>
<text text-anchor="middle" x="1239.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_13_63_gpu1 -->
<g id="node447" class="node">
<title>expert_13_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-2220.48 1050.94,-2220.48 1050.94,-2179.48 1164.94,-2179.48 1164.94,-2220.48"/>
<text text-anchor="middle" x="1107.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_13_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_13_63 -->
<g id="node448" class="node">
<title>expert_merge_13_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-2240.98 845,-2240.98 796.56,-2158.98 984.88,-2158.98 1033.32,-2240.98"/>
<text text-anchor="middle" x="914.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_Merge_13_63</text>
<text text-anchor="middle" x="914.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_13 -->
<g id="node449" class="node">
<title>expert_agg_13</title>
<polygon fill="yellow" stroke="black" points="366.55,-2240.98 106.28,-2240.98 39.33,-2158.98 299.6,-2158.98 366.55,-2240.98"/>
<text text-anchor="middle" x="202.94" y="-2208.48" font-family="Arial" font-size="10.00">Expert_Aggregation_13</text>
<text text-anchor="middle" x="202.94" y="-2197.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-2186.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_13 -->
<g id="node450" class="node">
<title>add_norm_2_13</title>
<polygon fill="lightgreen" stroke="black" points="276.44,-2122.98 143.44,-2122.98 143.44,-2081.98 276.44,-2081.98 276.44,-2122.98"/>
<text text-anchor="middle" x="209.94" y="-2110.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_13</text>
<text text-anchor="middle" x="209.94" y="-2099.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="209.94" y="-2088.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_13&#45;&gt;add_norm_2_13 -->
<g id="edge224" class="edge">
<title>expert_agg_13&#45;&gt;add_norm_2_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M205.89,-2158.76C206.52,-2150.18 207.17,-2141.27 207.76,-2133.17"/>
<polygon fill="red" stroke="red" points="211.26,-2133.32 208.5,-2123.09 204.28,-2132.81 211.26,-2133.32"/>
</g>
<!-- layer_norm_14 -->
<g id="node451" class="node">
<title>layer_norm_14</title>
<polygon fill="lightgreen" stroke="black" points="385.44,-2031.98 252.44,-2031.98 252.44,-1990.98 385.44,-1990.98 385.44,-2031.98"/>
<text text-anchor="middle" x="318.94" y="-2019.98" font-family="Arial" font-size="10.00">LayerNorm_14</text>
<text text-anchor="middle" x="318.94" y="-2008.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="318.94" y="-1997.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_13&#45;&gt;layer_norm_14 -->
<g id="edge225" class="edge">
<title>add_norm_2_13&#45;&gt;layer_norm_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M233.86,-2081.95C249.37,-2069.29 269.77,-2052.63 286.7,-2038.81"/>
<polygon fill="red" stroke="red" points="289.17,-2041.31 294.7,-2032.28 284.74,-2035.89 289.17,-2041.31"/>
</g>
<!-- mha_split_14 -->
<g id="node452" class="node">
<title>mha_split_14</title>
<polygon fill="yellow" stroke="black" points="510.72,-1948.98 291.54,-1948.98 235.16,-1866.98 454.33,-1866.98 510.72,-1948.98"/>
<text text-anchor="middle" x="372.94" y="-1916.48" font-family="Arial" font-size="10.00">MHA_Split_14</text>
<text text-anchor="middle" x="372.94" y="-1905.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="372.94" y="-1894.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_14&#45;&gt;mha_split_14 -->
<g id="edge226" class="edge">
<title>layer_norm_14&#45;&gt;mha_split_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M329.35,-1990.91C334.38,-1981.46 340.67,-1969.64 346.89,-1957.95"/>
<polygon fill="red" stroke="red" points="350,-1959.55 351.61,-1949.08 343.82,-1956.26 350,-1959.55"/>
</g>
<!-- qkv_proj_14_gpu0 -->
<g id="node453" class="node">
<title>qkv_proj_14_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="444.44,-1830.98 235.44,-1830.98 235.44,-1789.98 444.44,-1789.98 444.44,-1830.98"/>
<text text-anchor="middle" x="339.94" y="-1818.98" font-family="Arial" font-size="10.00">QKV_Proj_14_GPU0</text>
<text text-anchor="middle" x="339.94" y="-1807.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="339.94" y="-1796.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_14&#45;&gt;qkv_proj_14_gpu0 -->
<g id="edge227" class="edge">
<title>mha_split_14&#45;&gt;qkv_proj_14_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M359.04,-1866.76C356.01,-1857.99 352.86,-1848.87 350.01,-1840.63"/>
<polygon fill="red" stroke="red" points="353.29,-1839.4 346.72,-1831.09 346.67,-1841.69 353.29,-1839.4"/>
</g>
<!-- qkv_proj_14_gpu1 -->
<g id="node454" class="node">
<title>qkv_proj_14_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="671.44,-1830.98 462.44,-1830.98 462.44,-1789.98 671.44,-1789.98 671.44,-1830.98"/>
<text text-anchor="middle" x="566.94" y="-1818.98" font-family="Arial" font-size="10.00">QKV_Proj_14_GPU1</text>
<text text-anchor="middle" x="566.94" y="-1807.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="566.94" y="-1796.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_14&#45;&gt;qkv_proj_14_gpu1 -->
<g id="edge228" class="edge">
<title>mha_split_14&#45;&gt;qkv_proj_14_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M454.37,-1866.9C476.02,-1856.24 498.74,-1845.06 518.05,-1835.55"/>
<polygon fill="red" stroke="red" points="519.81,-1838.58 527.24,-1831.03 516.72,-1832.3 519.81,-1838.58"/>
</g>
<!-- attn_14_gpu0 -->
<g id="node455" class="node">
<title>attn_14_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="415.94,-1753.98 293.94,-1753.98 293.94,-1712.98 415.94,-1712.98 415.94,-1753.98"/>
<text text-anchor="middle" x="354.94" y="-1741.98" font-family="Arial" font-size="10.00">Attention_14_GPU0</text>
<text text-anchor="middle" x="354.94" y="-1730.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="354.94" y="-1719.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_14_gpu0&#45;&gt;attn_14_gpu0 -->
<g id="edge229" class="edge">
<title>qkv_proj_14_gpu0&#45;&gt;attn_14_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M343.88,-1789.78C345.45,-1781.94 347.29,-1772.75 349.01,-1764.14"/>
<polygon fill="red" stroke="red" points="352.5,-1764.55 351.02,-1754.06 345.63,-1763.18 352.5,-1764.55"/>
</g>
<!-- attn_14_gpu1 -->
<g id="node456" class="node">
<title>attn_14_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="618.94,-1753.98 496.94,-1753.98 496.94,-1712.98 618.94,-1712.98 618.94,-1753.98"/>
<text text-anchor="middle" x="557.94" y="-1741.98" font-family="Arial" font-size="10.00">Attention_14_GPU1</text>
<text text-anchor="middle" x="557.94" y="-1730.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="557.94" y="-1719.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_14_gpu1&#45;&gt;attn_14_gpu1 -->
<g id="edge230" class="edge">
<title>qkv_proj_14_gpu1&#45;&gt;attn_14_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M564.58,-1789.78C563.63,-1781.94 562.53,-1772.75 561.5,-1764.14"/>
<polygon fill="red" stroke="red" points="564.96,-1763.57 560.29,-1754.06 558,-1764.4 564.96,-1763.57"/>
</g>
<!-- out_proj_14_gpu0 -->
<g id="node457" class="node">
<title>out_proj_14_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="436.44,-1676.98 303.44,-1676.98 303.44,-1635.98 436.44,-1635.98 436.44,-1676.98"/>
<text text-anchor="middle" x="369.94" y="-1664.98" font-family="Arial" font-size="10.00">Output_Proj_14_GPU0</text>
<text text-anchor="middle" x="369.94" y="-1653.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="369.94" y="-1642.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_14_gpu0&#45;&gt;out_proj_14_gpu0 -->
<g id="edge231" class="edge">
<title>attn_14_gpu0&#45;&gt;out_proj_14_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M358.88,-1712.78C360.45,-1704.94 362.29,-1695.75 364.01,-1687.14"/>
<polygon fill="red" stroke="red" points="367.5,-1687.55 366.02,-1677.06 360.63,-1686.18 367.5,-1687.55"/>
</g>
<!-- out_proj_14_gpu1 -->
<g id="node458" class="node">
<title>out_proj_14_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="616.44,-1676.98 483.44,-1676.98 483.44,-1635.98 616.44,-1635.98 616.44,-1676.98"/>
<text text-anchor="middle" x="549.94" y="-1664.98" font-family="Arial" font-size="10.00">Output_Proj_14_GPU1</text>
<text text-anchor="middle" x="549.94" y="-1653.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="549.94" y="-1642.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_14_gpu1&#45;&gt;out_proj_14_gpu1 -->
<g id="edge232" class="edge">
<title>attn_14_gpu1&#45;&gt;out_proj_14_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M555.84,-1712.78C555,-1704.94 554.02,-1695.75 553.1,-1687.14"/>
<polygon fill="red" stroke="red" points="556.57,-1686.63 552.03,-1677.06 549.61,-1687.37 556.57,-1686.63"/>
</g>
<!-- mha_merge_14 -->
<g id="node459" class="node">
<title>mha_merge_14</title>
<polygon fill="yellow" stroke="black" points="671.72,-1599.98 452.54,-1599.98 396.16,-1517.98 615.33,-1517.98 671.72,-1599.98"/>
<text text-anchor="middle" x="533.94" y="-1567.48" font-family="Arial" font-size="10.00">MHA_Merge_14</text>
<text text-anchor="middle" x="533.94" y="-1556.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="533.94" y="-1545.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_14_gpu0&#45;&gt;mha_merge_14 -->
<g id="edge233" class="edge">
<title>out_proj_14_gpu0&#45;&gt;mha_merge_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M403.52,-1635.93C418.89,-1626.98 437.8,-1615.97 456.4,-1605.13"/>
<polygon fill="red" stroke="red" points="458.32,-1608.07 465.2,-1600.01 454.8,-1602.02 458.32,-1608.07"/>
</g>
<!-- out_proj_14_gpu1&#45;&gt;mha_merge_14 -->
<g id="edge234" class="edge">
<title>out_proj_14_gpu1&#45;&gt;mha_merge_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M546.62,-1635.7C545.37,-1628.23 543.89,-1619.36 542.38,-1610.37"/>
<polygon fill="red" stroke="red" points="545.79,-1609.51 540.68,-1600.23 538.88,-1610.67 545.79,-1609.51"/>
</g>
<!-- add_norm_1_14 -->
<g id="node460" class="node">
<title>add_norm_1_14</title>
<polygon fill="lightgreen" stroke="black" points="614.44,-1481.98 481.44,-1481.98 481.44,-1440.98 614.44,-1440.98 614.44,-1481.98"/>
<text text-anchor="middle" x="547.94" y="-1469.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_14</text>
<text text-anchor="middle" x="547.94" y="-1458.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="547.94" y="-1447.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_14&#45;&gt;add_norm_1_14 -->
<g id="edge235" class="edge">
<title>mha_merge_14&#45;&gt;add_norm_1_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M539.84,-1517.76C541.09,-1509.18 542.4,-1500.27 543.59,-1492.17"/>
<polygon fill="red" stroke="red" points="547.08,-1492.5 545.06,-1482.09 540.15,-1491.48 547.08,-1492.5"/>
</g>
<!-- gate_14 -->
<g id="node461" class="node">
<title>gate_14</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-1404.98 440.78,-1404.98 347.84,-1322.98 709.1,-1322.98 802.04,-1404.98"/>
<text text-anchor="middle" x="574.94" y="-1372.48" font-family="Arial" font-size="10.00">Expert_Gate_14</text>
<text text-anchor="middle" x="574.94" y="-1361.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-1350.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_14&#45;&gt;gate_14 -->
<g id="edge236" class="edge">
<title>add_norm_1_14&#45;&gt;gate_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M553.53,-1440.7C555.67,-1433.15 558.21,-1424.17 560.78,-1415.08"/>
<polygon fill="red" stroke="red" points="564.21,-1415.8 563.56,-1405.23 557.47,-1413.9 564.21,-1415.8"/>
</g>
<!-- token_dist_14 -->
<g id="node462" class="node">
<title>token_dist_14</title>
<polygon fill="yellow" stroke="black" points="778.91,-1246.98 465.58,-1246.98 384.97,-1164.98 698.3,-1164.98 778.91,-1246.98"/>
<text text-anchor="middle" x="581.94" y="-1214.48" font-family="Arial" font-size="10.00">Token_Distribution_14</text>
<text text-anchor="middle" x="581.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_14&#45;&gt;token_dist_14 -->
<g id="edge237" class="edge">
<title>gate_14&#45;&gt;token_dist_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-1322.81C577.64,-1302.79 578.74,-1278.39 579.69,-1257.16"/>
<polygon fill="red" stroke="red" points="583.19,-1257.17 580.14,-1247.02 576.2,-1256.85 583.19,-1257.17"/>
</g>
<!-- token_dist_14&#45;&gt;expert_0_0 -->
<g id="edge238" class="edge">
<title>token_dist_14&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M700.26,-1166.73C727.77,-1159.41 757.15,-1152.84 784.94,-1148.98 958.84,-1124.88 3769.57,-1137.19 3944.94,-1128.98 4005.81,-1126.13 4075.76,-1119.46 4120.85,-1114.72"/>
<polygon fill="red" stroke="red" points="4121.34,-1118.18 4130.91,-1113.64 4120.6,-1111.22 4121.34,-1118.18"/>
</g>
<!-- expert_14_0_gpu0 -->
<g id="node463" class="node">
<title>expert_14_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-1226.48 3802.94,-1226.48 3802.94,-1185.48 3916.94,-1185.48 3916.94,-1226.48"/>
<text text-anchor="middle" x="3859.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_0_gpu1 -->
<g id="node464" class="node">
<title>expert_14_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-1226.48 3670.94,-1226.48 3670.94,-1185.48 3784.94,-1185.48 3784.94,-1226.48"/>
<text text-anchor="middle" x="3727.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_0 -->
<g id="node465" class="node">
<title>expert_merge_14_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-1246.98 3465,-1246.98 3416.56,-1164.98 3604.88,-1164.98 3653.32,-1246.98"/>
<text text-anchor="middle" x="3534.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_Merge_14_0</text>
<text text-anchor="middle" x="3534.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_14_1_gpu0 -->
<g id="node466" class="node">
<title>expert_14_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-1226.48 3278.94,-1226.48 3278.94,-1185.48 3392.94,-1185.48 3392.94,-1226.48"/>
<text text-anchor="middle" x="3335.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_1_gpu1 -->
<g id="node467" class="node">
<title>expert_14_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-1226.48 3146.94,-1226.48 3146.94,-1185.48 3260.94,-1185.48 3260.94,-1226.48"/>
<text text-anchor="middle" x="3203.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_1 -->
<g id="node468" class="node">
<title>expert_merge_14_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-1246.98 2941,-1246.98 2892.56,-1164.98 3080.88,-1164.98 3129.32,-1246.98"/>
<text text-anchor="middle" x="3010.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_Merge_14_1</text>
<text text-anchor="middle" x="3010.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_14_2_gpu0 -->
<g id="node469" class="node">
<title>expert_14_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-1226.48 2754.94,-1226.48 2754.94,-1185.48 2868.94,-1185.48 2868.94,-1226.48"/>
<text text-anchor="middle" x="2811.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_2_gpu1 -->
<g id="node470" class="node">
<title>expert_14_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-1226.48 2622.94,-1226.48 2622.94,-1185.48 2736.94,-1185.48 2736.94,-1226.48"/>
<text text-anchor="middle" x="2679.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_2 -->
<g id="node471" class="node">
<title>expert_merge_14_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-1246.98 2417,-1246.98 2368.56,-1164.98 2556.88,-1164.98 2605.32,-1246.98"/>
<text text-anchor="middle" x="2486.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_Merge_14_2</text>
<text text-anchor="middle" x="2486.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_14_3_gpu0 -->
<g id="node472" class="node">
<title>expert_14_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-1226.48 2230.94,-1226.48 2230.94,-1185.48 2344.94,-1185.48 2344.94,-1226.48"/>
<text text-anchor="middle" x="2287.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_3_gpu1 -->
<g id="node473" class="node">
<title>expert_14_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-1226.48 2098.94,-1226.48 2098.94,-1185.48 2212.94,-1185.48 2212.94,-1226.48"/>
<text text-anchor="middle" x="2155.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_3 -->
<g id="node474" class="node">
<title>expert_merge_14_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-1246.98 1893,-1246.98 1844.56,-1164.98 2032.88,-1164.98 2081.32,-1246.98"/>
<text text-anchor="middle" x="1962.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_Merge_14_3</text>
<text text-anchor="middle" x="1962.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_14_62_gpu0 -->
<g id="node475" class="node">
<title>expert_14_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-1226.48 1706.94,-1226.48 1706.94,-1185.48 1820.94,-1185.48 1820.94,-1226.48"/>
<text text-anchor="middle" x="1763.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_62_gpu1 -->
<g id="node476" class="node">
<title>expert_14_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-1226.48 1574.94,-1226.48 1574.94,-1185.48 1688.94,-1185.48 1688.94,-1226.48"/>
<text text-anchor="middle" x="1631.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_62 -->
<g id="node477" class="node">
<title>expert_merge_14_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-1246.98 1369,-1246.98 1320.56,-1164.98 1508.88,-1164.98 1557.32,-1246.98"/>
<text text-anchor="middle" x="1438.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_Merge_14_62</text>
<text text-anchor="middle" x="1438.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_14_63_gpu0 -->
<g id="node478" class="node">
<title>expert_14_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-1226.48 1182.94,-1226.48 1182.94,-1185.48 1296.94,-1185.48 1296.94,-1226.48"/>
<text text-anchor="middle" x="1239.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_14_63_gpu1 -->
<g id="node479" class="node">
<title>expert_14_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-1226.48 1050.94,-1226.48 1050.94,-1185.48 1164.94,-1185.48 1164.94,-1226.48"/>
<text text-anchor="middle" x="1107.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_14_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_14_63 -->
<g id="node480" class="node">
<title>expert_merge_14_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-1246.98 845,-1246.98 796.56,-1164.98 984.88,-1164.98 1033.32,-1246.98"/>
<text text-anchor="middle" x="914.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_Merge_14_63</text>
<text text-anchor="middle" x="914.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_14 -->
<g id="node481" class="node">
<title>expert_agg_14</title>
<polygon fill="yellow" stroke="black" points="366.55,-1246.98 106.28,-1246.98 39.33,-1164.98 299.6,-1164.98 366.55,-1246.98"/>
<text text-anchor="middle" x="202.94" y="-1214.48" font-family="Arial" font-size="10.00">Expert_Aggregation_14</text>
<text text-anchor="middle" x="202.94" y="-1203.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-1192.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_14 -->
<g id="node482" class="node">
<title>add_norm_2_14</title>
<polygon fill="lightgreen" stroke="black" points="296.44,-1128.98 163.44,-1128.98 163.44,-1087.98 296.44,-1087.98 296.44,-1128.98"/>
<text text-anchor="middle" x="229.94" y="-1116.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_14</text>
<text text-anchor="middle" x="229.94" y="-1105.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="229.94" y="-1094.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_14&#45;&gt;add_norm_2_14 -->
<g id="edge240" class="edge">
<title>expert_agg_14&#45;&gt;add_norm_2_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M214.31,-1164.76C216.76,-1156.09 219.31,-1147.07 221.62,-1138.9"/>
<polygon fill="red" stroke="red" points="225.04,-1139.67 224.4,-1129.09 218.31,-1137.76 225.04,-1139.67"/>
</g>
<!-- layer_norm_15 -->
<g id="node483" class="node">
<title>layer_norm_15</title>
<polygon fill="lightgreen" stroke="black" points="405.44,-1037.98 272.44,-1037.98 272.44,-996.98 405.44,-996.98 405.44,-1037.98"/>
<text text-anchor="middle" x="338.94" y="-1025.98" font-family="Arial" font-size="10.00">LayerNorm_15</text>
<text text-anchor="middle" x="338.94" y="-1014.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="338.94" y="-1003.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_14&#45;&gt;layer_norm_15 -->
<g id="edge241" class="edge">
<title>add_norm_2_14&#45;&gt;layer_norm_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M253.86,-1087.95C269.37,-1075.29 289.77,-1058.63 306.7,-1044.81"/>
<polygon fill="red" stroke="red" points="309.17,-1047.31 314.7,-1038.28 304.74,-1041.89 309.17,-1047.31"/>
</g>
<!-- mha_split_15 -->
<g id="node484" class="node">
<title>mha_split_15</title>
<polygon fill="yellow" stroke="black" points="530.72,-954.98 311.54,-954.98 255.16,-872.98 474.33,-872.98 530.72,-954.98"/>
<text text-anchor="middle" x="392.94" y="-922.48" font-family="Arial" font-size="10.00">MHA_Split_15</text>
<text text-anchor="middle" x="392.94" y="-911.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="392.94" y="-900.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- layer_norm_15&#45;&gt;mha_split_15 -->
<g id="edge242" class="edge">
<title>layer_norm_15&#45;&gt;mha_split_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M349.35,-996.91C354.38,-987.46 360.67,-975.64 366.89,-963.95"/>
<polygon fill="red" stroke="red" points="370,-965.55 371.61,-955.08 363.82,-962.26 370,-965.55"/>
</g>
<!-- qkv_proj_15_gpu0 -->
<g id="node485" class="node">
<title>qkv_proj_15_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="464.44,-836.98 255.44,-836.98 255.44,-795.98 464.44,-795.98 464.44,-836.98"/>
<text text-anchor="middle" x="359.94" y="-824.98" font-family="Arial" font-size="10.00">QKV_Proj_15_GPU0</text>
<text text-anchor="middle" x="359.94" y="-813.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="359.94" y="-802.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_15&#45;&gt;qkv_proj_15_gpu0 -->
<g id="edge243" class="edge">
<title>mha_split_15&#45;&gt;qkv_proj_15_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M379.04,-872.76C376.01,-863.99 372.86,-854.87 370.01,-846.63"/>
<polygon fill="red" stroke="red" points="373.29,-845.4 366.72,-837.09 366.67,-847.69 373.29,-845.4"/>
</g>
<!-- qkv_proj_15_gpu1 -->
<g id="node486" class="node">
<title>qkv_proj_15_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="691.44,-836.98 482.44,-836.98 482.44,-795.98 691.44,-795.98 691.44,-836.98"/>
<text text-anchor="middle" x="586.94" y="-824.98" font-family="Arial" font-size="10.00">QKV_Proj_15_GPU1</text>
<text text-anchor="middle" x="586.94" y="-813.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="586.94" y="-802.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 192] (Q:64, K:64, V:64)</text>
</g>
<!-- mha_split_15&#45;&gt;qkv_proj_15_gpu1 -->
<g id="edge244" class="edge">
<title>mha_split_15&#45;&gt;qkv_proj_15_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M474.37,-872.9C496.02,-862.24 518.74,-851.06 538.05,-841.55"/>
<polygon fill="red" stroke="red" points="539.81,-844.58 547.24,-837.03 536.72,-838.3 539.81,-844.58"/>
</g>
<!-- attn_15_gpu0 -->
<g id="node487" class="node">
<title>attn_15_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="435.94,-759.98 313.94,-759.98 313.94,-718.98 435.94,-718.98 435.94,-759.98"/>
<text text-anchor="middle" x="374.94" y="-747.98" font-family="Arial" font-size="10.00">Attention_15_GPU0</text>
<text text-anchor="middle" x="374.94" y="-736.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="374.94" y="-725.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_15_gpu0&#45;&gt;attn_15_gpu0 -->
<g id="edge245" class="edge">
<title>qkv_proj_15_gpu0&#45;&gt;attn_15_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M363.88,-795.78C365.45,-787.94 367.29,-778.75 369.01,-770.14"/>
<polygon fill="red" stroke="red" points="372.5,-770.55 371.02,-760.06 365.63,-769.18 372.5,-770.55"/>
</g>
<!-- attn_15_gpu1 -->
<g id="node488" class="node">
<title>attn_15_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="638.94,-759.98 516.94,-759.98 516.94,-718.98 638.94,-718.98 638.94,-759.98"/>
<text text-anchor="middle" x="577.94" y="-747.98" font-family="Arial" font-size="10.00">Attention_15_GPU1</text>
<text text-anchor="middle" x="577.94" y="-736.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="577.94" y="-725.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 64]</text>
</g>
<!-- qkv_proj_15_gpu1&#45;&gt;attn_15_gpu1 -->
<g id="edge246" class="edge">
<title>qkv_proj_15_gpu1&#45;&gt;attn_15_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M584.58,-795.78C583.63,-787.94 582.53,-778.75 581.5,-770.14"/>
<polygon fill="red" stroke="red" points="584.96,-769.57 580.29,-760.06 578,-770.4 584.96,-769.57"/>
</g>
<!-- out_proj_15_gpu0 -->
<g id="node489" class="node">
<title>out_proj_15_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="456.44,-682.98 323.44,-682.98 323.44,-641.98 456.44,-641.98 456.44,-682.98"/>
<text text-anchor="middle" x="389.94" y="-670.98" font-family="Arial" font-size="10.00">Output_Proj_15_GPU0</text>
<text text-anchor="middle" x="389.94" y="-659.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="389.94" y="-648.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_15_gpu0&#45;&gt;out_proj_15_gpu0 -->
<g id="edge247" class="edge">
<title>attn_15_gpu0&#45;&gt;out_proj_15_gpu0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M378.88,-718.78C380.45,-710.94 382.29,-701.75 384.01,-693.14"/>
<polygon fill="red" stroke="red" points="387.5,-693.55 386.02,-683.06 380.63,-692.18 387.5,-693.55"/>
</g>
<!-- out_proj_15_gpu1 -->
<g id="node490" class="node">
<title>out_proj_15_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="636.44,-682.98 503.44,-682.98 503.44,-641.98 636.44,-641.98 636.44,-682.98"/>
<text text-anchor="middle" x="569.94" y="-670.98" font-family="Arial" font-size="10.00">Output_Proj_15_GPU1</text>
<text text-anchor="middle" x="569.94" y="-659.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 64]</text>
<text text-anchor="middle" x="569.94" y="-648.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 2048]</text>
</g>
<!-- attn_15_gpu1&#45;&gt;out_proj_15_gpu1 -->
<g id="edge248" class="edge">
<title>attn_15_gpu1&#45;&gt;out_proj_15_gpu1</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M575.84,-718.78C575,-710.94 574.02,-701.75 573.1,-693.14"/>
<polygon fill="red" stroke="red" points="576.57,-692.63 572.03,-683.06 569.61,-693.37 576.57,-692.63"/>
</g>
<!-- mha_merge_15 -->
<g id="node491" class="node">
<title>mha_merge_15</title>
<polygon fill="yellow" stroke="black" points="691.72,-605.98 472.54,-605.98 416.16,-523.98 635.33,-523.98 691.72,-605.98"/>
<text text-anchor="middle" x="553.94" y="-573.48" font-family="Arial" font-size="10.00">MHA_Merge_15</text>
<text text-anchor="middle" x="553.94" y="-562.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 2048]</text>
<text text-anchor="middle" x="553.94" y="-551.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- out_proj_15_gpu0&#45;&gt;mha_merge_15 -->
<g id="edge249" class="edge">
<title>out_proj_15_gpu0&#45;&gt;mha_merge_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M423.52,-641.93C438.89,-632.98 457.8,-621.97 476.4,-611.13"/>
<polygon fill="red" stroke="red" points="478.32,-614.07 485.2,-606.01 474.8,-608.02 478.32,-614.07"/>
</g>
<!-- out_proj_15_gpu1&#45;&gt;mha_merge_15 -->
<g id="edge250" class="edge">
<title>out_proj_15_gpu1&#45;&gt;mha_merge_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M566.62,-641.7C565.37,-634.23 563.89,-625.36 562.38,-616.37"/>
<polygon fill="red" stroke="red" points="565.79,-615.51 560.68,-606.23 558.88,-616.67 565.79,-615.51"/>
</g>
<!-- add_norm_1_15 -->
<g id="node492" class="node">
<title>add_norm_1_15</title>
<polygon fill="lightgreen" stroke="black" points="627.44,-487.98 494.44,-487.98 494.44,-446.98 627.44,-446.98 627.44,-487.98"/>
<text text-anchor="middle" x="560.94" y="-475.98" font-family="Arial" font-size="10.00">Add&amp;Norm1_15</text>
<text text-anchor="middle" x="560.94" y="-464.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="560.94" y="-453.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- mha_merge_15&#45;&gt;add_norm_1_15 -->
<g id="edge251" class="edge">
<title>mha_merge_15&#45;&gt;add_norm_1_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M556.89,-523.76C557.52,-515.18 558.17,-506.27 558.76,-498.17"/>
<polygon fill="red" stroke="red" points="562.26,-498.32 559.5,-488.09 555.28,-497.81 562.26,-498.32"/>
</g>
<!-- gate_15 -->
<g id="node493" class="node">
<title>gate_15</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="802.04,-410.98 440.78,-410.98 347.84,-328.98 709.1,-328.98 802.04,-410.98"/>
<text text-anchor="middle" x="574.94" y="-378.48" font-family="Arial" font-size="10.00">Expert_Gate_15</text>
<text text-anchor="middle" x="574.94" y="-367.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="574.94" y="-356.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096] + Routing_Weights</text>
</g>
<!-- add_norm_1_15&#45;&gt;gate_15 -->
<g id="edge252" class="edge">
<title>add_norm_1_15&#45;&gt;gate_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M563.84,-446.7C564.93,-439.23 566.23,-430.36 567.55,-421.37"/>
<polygon fill="red" stroke="red" points="571.05,-421.63 569.04,-411.23 564.13,-420.61 571.05,-421.63"/>
</g>
<!-- token_dist_15 -->
<g id="node494" class="node">
<title>token_dist_15</title>
<polygon fill="yellow" stroke="black" points="778.91,-252.98 465.58,-252.98 384.97,-170.98 698.3,-170.98 778.91,-252.98"/>
<text text-anchor="middle" x="581.94" y="-220.48" font-family="Arial" font-size="10.00">Token_Distribution_15</text>
<text text-anchor="middle" x="581.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="581.94" y="-198.48" font-family="Arial" font-size="10.00">Output: Distributed_Tokens[64_experts]</text>
</g>
<!-- gate_15&#45;&gt;token_dist_15 -->
<g id="edge253" class="edge">
<title>gate_15&#45;&gt;token_dist_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M576.74,-328.81C577.64,-308.79 578.74,-284.39 579.69,-263.16"/>
<polygon fill="red" stroke="red" points="583.19,-263.17 580.14,-253.02 576.2,-262.85 583.19,-263.17"/>
</g>
<!-- token_dist_15&#45;&gt;expert_0_0 -->
<g id="edge254" class="edge">
<title>token_dist_15&#45;&gt;expert_0_0</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M639.23,-253.18C678.29,-278.07 732.29,-307.72 784.94,-320.98 796.48,-323.89 2490.13,-320.98 2498.94,-328.98 2544.43,-370.27 2512.94,-405.06 2512.94,-466.48 2512.94,-914.98 2512.94,-914.98 2512.94,-914.98 2512.94,-1075.15 3785.9,-1061.01 3944.94,-1079.98 4005.85,-1087.25 4076.07,-1095.96 4121.18,-1101.61"/>
<polygon fill="red" stroke="red" points="4120.9,-1105.1 4131.25,-1102.87 4121.76,-1098.15 4120.9,-1105.1"/>
</g>
<!-- expert_15_0_gpu0 -->
<g id="node495" class="node">
<title>expert_15_0_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3916.94,-232.48 3802.94,-232.48 3802.94,-191.48 3916.94,-191.48 3916.94,-232.48"/>
<text text-anchor="middle" x="3859.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_0_GPU0</text>
<text text-anchor="middle" x="3859.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3859.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_0_gpu1 -->
<g id="node496" class="node">
<title>expert_15_0_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3784.94,-232.48 3670.94,-232.48 3670.94,-191.48 3784.94,-191.48 3784.94,-232.48"/>
<text text-anchor="middle" x="3727.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_0_GPU1</text>
<text text-anchor="middle" x="3727.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3727.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_0 -->
<g id="node497" class="node">
<title>expert_merge_15_0</title>
<polygon fill="yellow" stroke="black" points="3653.32,-252.98 3465,-252.98 3416.56,-170.98 3604.88,-170.98 3653.32,-252.98"/>
<text text-anchor="middle" x="3534.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_Merge_15_0</text>
<text text-anchor="middle" x="3534.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3534.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_15_1_gpu0 -->
<g id="node498" class="node">
<title>expert_15_1_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="3392.94,-232.48 3278.94,-232.48 3278.94,-191.48 3392.94,-191.48 3392.94,-232.48"/>
<text text-anchor="middle" x="3335.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_1_GPU0</text>
<text text-anchor="middle" x="3335.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3335.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_1_gpu1 -->
<g id="node499" class="node">
<title>expert_15_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="3260.94,-232.48 3146.94,-232.48 3146.94,-191.48 3260.94,-191.48 3260.94,-232.48"/>
<text text-anchor="middle" x="3203.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_1_GPU1</text>
<text text-anchor="middle" x="3203.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="3203.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_1 -->
<g id="node500" class="node">
<title>expert_merge_15_1</title>
<polygon fill="yellow" stroke="black" points="3129.32,-252.98 2941,-252.98 2892.56,-170.98 3080.88,-170.98 3129.32,-252.98"/>
<text text-anchor="middle" x="3010.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_Merge_15_1</text>
<text text-anchor="middle" x="3010.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="3010.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_15_2_gpu0 -->
<g id="node501" class="node">
<title>expert_15_2_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2868.94,-232.48 2754.94,-232.48 2754.94,-191.48 2868.94,-191.48 2868.94,-232.48"/>
<text text-anchor="middle" x="2811.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_2_GPU0</text>
<text text-anchor="middle" x="2811.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2811.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_2_gpu1 -->
<g id="node502" class="node">
<title>expert_15_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2736.94,-232.48 2622.94,-232.48 2622.94,-191.48 2736.94,-191.48 2736.94,-232.48"/>
<text text-anchor="middle" x="2679.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_2_GPU1</text>
<text text-anchor="middle" x="2679.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2679.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_2 -->
<g id="node503" class="node">
<title>expert_merge_15_2</title>
<polygon fill="yellow" stroke="black" points="2605.32,-252.98 2417,-252.98 2368.56,-170.98 2556.88,-170.98 2605.32,-252.98"/>
<text text-anchor="middle" x="2486.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_Merge_15_2</text>
<text text-anchor="middle" x="2486.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="2486.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_15_3_gpu0 -->
<g id="node504" class="node">
<title>expert_15_3_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="2344.94,-232.48 2230.94,-232.48 2230.94,-191.48 2344.94,-191.48 2344.94,-232.48"/>
<text text-anchor="middle" x="2287.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_3_GPU0</text>
<text text-anchor="middle" x="2287.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2287.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_3_gpu1 -->
<g id="node505" class="node">
<title>expert_15_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="2212.94,-232.48 2098.94,-232.48 2098.94,-191.48 2212.94,-191.48 2212.94,-232.48"/>
<text text-anchor="middle" x="2155.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_3_GPU1</text>
<text text-anchor="middle" x="2155.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="2155.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_3 -->
<g id="node506" class="node">
<title>expert_merge_15_3</title>
<polygon fill="yellow" stroke="black" points="2081.32,-252.98 1893,-252.98 1844.56,-170.98 2032.88,-170.98 2081.32,-252.98"/>
<text text-anchor="middle" x="1962.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_Merge_15_3</text>
<text text-anchor="middle" x="1962.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1962.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_15_62_gpu0 -->
<g id="node507" class="node">
<title>expert_15_62_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1820.94,-232.48 1706.94,-232.48 1706.94,-191.48 1820.94,-191.48 1820.94,-232.48"/>
<text text-anchor="middle" x="1763.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_62_GPU0</text>
<text text-anchor="middle" x="1763.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1763.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_62_gpu1 -->
<g id="node508" class="node">
<title>expert_15_62_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1688.94,-232.48 1574.94,-232.48 1574.94,-191.48 1688.94,-191.48 1688.94,-232.48"/>
<text text-anchor="middle" x="1631.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_62_GPU1</text>
<text text-anchor="middle" x="1631.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1631.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_62 -->
<g id="node509" class="node">
<title>expert_merge_15_62</title>
<polygon fill="yellow" stroke="black" points="1557.32,-252.98 1369,-252.98 1320.56,-170.98 1508.88,-170.98 1557.32,-252.98"/>
<text text-anchor="middle" x="1438.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_Merge_15_62</text>
<text text-anchor="middle" x="1438.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="1438.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_15_63_gpu0 -->
<g id="node510" class="node">
<title>expert_15_63_gpu0</title>
<polygon fill="lightgreen" stroke="black" points="1296.94,-232.48 1182.94,-232.48 1182.94,-191.48 1296.94,-191.48 1296.94,-232.48"/>
<text text-anchor="middle" x="1239.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_63_GPU0</text>
<text text-anchor="middle" x="1239.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1239.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_15_63_gpu1 -->
<g id="node511" class="node">
<title>expert_15_63_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1164.94,-232.48 1050.94,-232.48 1050.94,-191.48 1164.94,-191.48 1164.94,-232.48"/>
<text text-anchor="middle" x="1107.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_15_63_GPU1</text>
<text text-anchor="middle" x="1107.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 4096]</text>
<text text-anchor="middle" x="1107.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 8192]</text>
</g>
<!-- expert_merge_15_63 -->
<g id="node512" class="node">
<title>expert_merge_15_63</title>
<polygon fill="yellow" stroke="black" points="1033.32,-252.98 845,-252.98 796.56,-170.98 984.88,-170.98 1033.32,-252.98"/>
<text text-anchor="middle" x="914.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_Merge_15_63</text>
<text text-anchor="middle" x="914.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [tokens, 8192]</text>
<text text-anchor="middle" x="914.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [tokens, 4096]</text>
</g>
<!-- expert_agg_15 -->
<g id="node513" class="node">
<title>expert_agg_15</title>
<polygon fill="yellow" stroke="black" points="366.55,-252.98 106.28,-252.98 39.33,-170.98 299.6,-170.98 366.55,-252.98"/>
<text text-anchor="middle" x="202.94" y="-220.48" font-family="Arial" font-size="10.00">Expert_Aggregation_15</text>
<text text-anchor="middle" x="202.94" y="-209.48" font-family="Arial" font-size="10.00">Input: [64_expert_outputs, 4096]</text>
<text text-anchor="middle" x="202.94" y="-198.48" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- add_norm_2_15 -->
<g id="node514" class="node">
<title>add_norm_2_15</title>
<polygon fill="lightgreen" stroke="black" points="269.44,-134.98 136.44,-134.98 136.44,-93.98 269.44,-93.98 269.44,-134.98"/>
<text text-anchor="middle" x="202.94" y="-122.98" font-family="Arial" font-size="10.00">Add&amp;Norm2_15</text>
<text text-anchor="middle" x="202.94" y="-111.98" font-family="Arial" font-size="10.00">Input: [128, 10000, 4096]</text>
<text text-anchor="middle" x="202.94" y="-100.98" font-family="Arial" font-size="10.00">Output: [128, 10000, 4096]</text>
</g>
<!-- expert_agg_15&#45;&gt;add_norm_2_15 -->
<g id="edge256" class="edge">
<title>expert_agg_15&#45;&gt;add_norm_2_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M202.94,-170.76C202.94,-162.18 202.94,-153.27 202.94,-145.17"/>
<polygon fill="red" stroke="red" points="206.44,-145.09 202.94,-135.09 199.44,-145.09 206.44,-145.09"/>
</g>
<!-- add_norm_2_15&#45;&gt;output -->
<g id="edge257" class="edge">
<title>add_norm_2_15&#45;&gt;output</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M202.94,-93.7C202.94,-86.07 202.94,-77.08 202.94,-68.29"/>
<polygon fill="red" stroke="red" points="206.44,-68.17 202.94,-58.17 199.44,-68.17 206.44,-68.17"/>
</g>
</g>
</svg>
