digraph {
	graph [bb="0,0,7650,46181",
		bgcolor=white,
		rankdir=TB,
		splines=ortho
	];
	node [fontname=Arial,
		fontsize=10,
		label="\N"
	];
	input	[fillcolor=lightgreen,
		height=1.0214,
		label="INPUT\nGPU: Host\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4794,46144",
		shape=ellipse,
		style=filled,
		width=4.9694];
	layer0_dense_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L0\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4794,46046",
		shape=rectangle,
		style=filled,
		width=3.6111];
	input -> layer0_dense_mha	[pos="e,4794,46072 4794,46108 4794,46108 4794,46082 4794,46082"];
	layer0_dense_mlp	[fillcolor=lightblue,
		height=0.72222,
		label="MLP L0\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4794,45958",
		shape=rectangle,
		style=filled,
		width=3.5139];
	layer0_dense_mha -> layer0_dense_mlp	[pos="e,4794,45984 4794,46019 4794,46019 4794,45994 4794,45994"];
	layer1_dense_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L1\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4794,45870",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer0_dense_mlp -> layer1_dense_mha	[pos="e,4794,45896 4794,45931 4794,45931 4794,45906 4794,45906"];
	layer1_dense_mlp	[fillcolor=lightblue,
		height=0.72222,
		label="MLP L1\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4794,45782",
		shape=rectangle,
		style=filled,
		width=3.5139];
	layer1_dense_mha -> layer1_dense_mlp	[pos="e,4794,45808 4794,45843 4794,45843 4794,45818 4794,45818"];
	layer2_dense_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L2\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4794,45694",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer1_dense_mlp -> layer2_dense_mha	[pos="e,4794,45720 4794,45755 4794,45755 4794,45730 4794,45730"];
	layer2_dense_mlp	[fillcolor=lightblue,
		height=0.72222,
		label="MLP L2\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4794,45606",
		shape=rectangle,
		style=filled,
		width=3.5139];
	layer2_dense_mha -> layer2_dense_mlp	[pos="e,4794,45632 4794,45667 4794,45667 4794,45642 4794,45642"];
	layer3_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L3\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4794,45518",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer2_dense_mlp -> layer3_moe_mha	[pos="e,4794,45544 4794,45579 4794,45579 4794,45554 4794,45554"];
	layer3_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L3\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4794,45404",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer3_moe_mha -> layer3_moe_gate	[pos="e,4794,45456 4794,45491 4794,45491 4794,45466 4794,45466"];
	layer3_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L3\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4794,45264",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer3_moe_gate -> layer3_moe_split	[pos="e,4794,45316 4794,45351 4794,45351 4794,45326 4794,45326"];
	layer3_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2402,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer3_moe_split -> layer3_moe_comm_to_expert0	[pos="e,2402,45176 4628.2,45300 4086.2,45300 2402,45300 2402,45300 2402,45300 2402,45186 2402,45186",
		style=dashed];
	layer3_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2748,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer3_moe_split -> layer3_moe_comm_to_expert1	[pos="e,2748,45176 4613.3,45285 4113.3,45285 2748,45285 2748,45285 2748,45285 2748,45186 2748,45186",
		style=dashed];
	layer3_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="3020,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer3_moe_split -> layer3_moe_comm_to_expert2	[pos="e,3020,45176 4598.2,45270 4136.9,45270 3020,45270 3020,45270 3020,45270 3020,45186 3020,45186",
		style=dashed];
	layer3_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3348,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer3_moe_split -> layer3_moe_comm_to_expert3	[pos="e,3348,45176 4584.1,45256 4183.2,45256 3348,45256 3348,45256 3348,45256 3348,45186 3348,45186",
		style=dashed];
	layer3_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3841,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer3_moe_split -> layer3_moe_comm_to_expert4	[pos="e,3841,45176 4569.4,45241 4287.6,45241 3841,45241 3841,45241 3841,45241 3841,45186 3841,45186",
		style=dashed];
	layer3_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="4187,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer3_moe_split -> layer3_moe_comm_to_expert5	[pos="e,4187,45176 4554.1,45226 4384.4,45226 4187,45226 4187,45226 4187,45226 4187,45186 4187,45186",
		style=dashed];
	layer3_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4459,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer3_moe_split -> layer3_moe_comm_to_expert6	[pos="e,4544.8,45156 4544.8,45263 4544.8,45263 4544.8,45166 4544.8,45166",
		style=dashed];
	layer3_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4695,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer3_moe_split -> layer3_moe_comm_to_expert7	[pos="e,4695,45176 4695,45211 4695,45211 4695,45186 4695,45186",
		style=dashed];
	layer3_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4967,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer3_moe_split -> layer3_moe_comm_to_expert8	[pos="e,4962.2,45176 4962.2,45230 4962.2,45230 4962.2,45186 4962.2,45186",
		style=dashed];
	layer3_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="5276,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer3_moe_split -> layer3_moe_comm_to_expert9	[pos="e,5276,45176 4956.8,45224 5096.7,45224 5276,45224 5276,45224 5276,45224 5276,45186 5276,45186",
		style=dashed];
	layer3_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5608,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer3_moe_split -> layer3_moe_comm_to_expert10	[pos="e,5608,45176 4969.6,45237 5208.9,45237 5608,45237 5608,45237 5608,45237 5608,45186 5608,45186",
		style=dashed];
	layer3_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5954,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer3_moe_split -> layer3_moe_comm_to_expert11	[pos="e,5954,45176 4982.6,45250 5311.2,45250 5954,45250 5954,45250 5954,45250 5954,45186 5954,45186",
		style=dashed];
	layer3_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="6305,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer3_moe_split -> layer3_moe_comm_to_expert12	[pos="e,6305,45176 4995.8,45263 5407.4,45263 6305,45263 6305,45263 6305,45263 6305,45186 6305,45186",
		style=dashed];
	layer3_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6658,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer3_moe_split -> layer3_moe_comm_to_expert13	[pos="e,6658,45176 5008.7,45276 5498.9,45276 6658,45276 6658,45276 6658,45276 6658,45186 6658,45186",
		style=dashed];
	layer3_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="7013,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer3_moe_split -> layer3_moe_comm_to_expert14	[pos="e,7013,45176 5021.6,45289 5587.5,45289 7013,45289 7013,45289 7013,45289 7013,45186 7013,45186",
		style=dashed];
	layer3_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7368,45147",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer3_moe_split -> layer3_moe_comm_to_expert15	[pos="e,7368,45176 5034.7,45302 5674.4,45302 7368,45302 7368,45302 7368,45302 7368,45186 7368,45186",
		style=dashed];
	layer3_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L3\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=S_\
expert0, hidden_dim=7168]",
		pos="2236,45056",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer3_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2332,44965",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer3_moe_expert0 -> layer3_moe_comm_from_expert0	[pos="e,2320.7,44993 2320.7,45029 2320.7,45029 2320.7,45003 2320.7,45003"];
	layer3_moe_comm_to_expert0 -> layer3_moe_expert0	[pos="e,2355.7,45082 2355.7,45121 2355.7,45121 2355.7,45092 2355.7,45092"];
	layer3_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L3\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=S_\
expert1, hidden_dim=7168]",
		pos="2582,45056",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer3_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2898,44965",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer3_moe_expert1 -> layer3_moe_comm_from_expert1	[pos="e,2807.4,44964 2685.2,45029 2685.2,45002 2685.2,44964 2685.2,44964 2685.2,44964 2797.4,44964 2797.4,44964"];
	layer3_moe_comm_to_expert1 -> layer3_moe_expert1	[pos="e,2701.7,45082 2701.7,45121 2701.7,45121 2701.7,45092 2701.7,45092"];
	layer3_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L3\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=S_\
expert2, hidden_dim=7168]",
		pos="2928,45056",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer3_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="3281,44965",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer3_moe_expert2 -> layer3_moe_comm_from_expert2	[pos="e,3190.3,44964 3057.2,45029 3057.2,45002 3057.2,44964 3057.2,44964 3057.2,44964 3180.3,44964 3180.3,44964"];
	layer3_moe_comm_to_expert2 -> layer3_moe_expert2	[pos="e,3010.7,45082 3010.7,45118 3010.7,45118 3010.7,45092 3010.7,45092"];
	layer3_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L3\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=S_\
expert3, hidden_dim=7168]",
		pos="3274,45056",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer3_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3572,44965",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer3_moe_expert3 -> layer3_moe_comm_from_expert3	[pos="e,3481,44964 3404.8,45029 3404.8,45002 3404.8,44964 3404.8,44964 3404.8,44964 3471,44964 3471,44964"];
	layer3_moe_comm_to_expert3 -> layer3_moe_expert3	[pos="e,3347.7,45082 3347.7,45118 3347.7,45118 3347.7,45092 3347.7,45092"];
	layer3_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L3\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=S_\
expert4, hidden_dim=7168]",
		pos="3620,45056",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer3_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3817,44965",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer3_moe_expert4 -> layer3_moe_comm_from_expert4	[pos="e,3755.2,44986 3755.2,45029 3755.2,45029 3755.2,44996 3755.2,44996"];
	layer3_moe_comm_to_expert4 -> layer3_moe_expert4	[pos="e,3767.2,45082 3767.2,45129 3767.2,45129 3767.2,45092 3767.2,45092"];
	layer3_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L3\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=S_\
expert5, hidden_dim=7168]",
		pos="3966,45056",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer3_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="4039,44965",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer3_moe_expert5 -> layer3_moe_comm_from_expert5	[pos="e,4039,44994 4039,45029 4039,45029 4039,45004 4039,45004"];
	layer3_moe_comm_to_expert5 -> layer3_moe_expert5	[pos="e,4113.2,45082 4113.2,45129 4113.2,45129 4113.2,45092 4113.2,45092"];
	layer3_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L3\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=S_\
expert6, hidden_dim=7168]",
		pos="4312,45056",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer3_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4385,44965",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer3_moe_expert6 -> layer3_moe_comm_from_expert6	[pos="e,4385,44994 4385,45029 4385,45029 4385,45004 4385,45004"];
	layer3_moe_comm_to_expert6 -> layer3_moe_expert6	[pos="e,4422.2,45082 4422.2,45120 4422.2,45120 4422.2,45092 4422.2,45092"];
	layer3_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L3\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=S_\
expert7, hidden_dim=7168]",
		pos="4658,45056",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer3_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4695,44965",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer3_moe_expert7 -> layer3_moe_comm_from_expert7	[pos="e,4695,44994 4695,45029 4695,45029 4695,45004 4695,45004"];
	layer3_moe_comm_to_expert7 -> layer3_moe_expert7	[pos="e,4695,45082 4695,45118 4695,45118 4695,45092 4695,45092"];
	layer3_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L3\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=S_\
expert8, hidden_dim=7168]",
		pos="5004,45056",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer3_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4967,44965",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer3_moe_expert8 -> layer3_moe_comm_from_expert8	[pos="e,4967,44994 4967,45029 4967,45029 4967,45004 4967,45004"];
	layer3_moe_comm_to_expert8 -> layer3_moe_expert8	[pos="e,4967,45082 4967,45118 4967,45118 4967,45092 4967,45092"];
	layer3_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L3\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=S_\
expert9, hidden_dim=7168]",
		pos="5350,45056",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer3_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="5276,44965",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer3_moe_expert9 -> layer3_moe_comm_from_expert9	[pos="e,5276.3,44994 5276.3,45029 5276.3,45029 5276.3,45004 5276.3,45004"];
	layer3_moe_comm_to_expert9 -> layer3_moe_expert9	[pos="e,5276.3,45082 5276.3,45118 5276.3,45118 5276.3,45092 5276.3,45092"];
	layer3_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L3\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5701,45056",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer3_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5608,44965",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer3_moe_expert10 -> layer3_moe_comm_from_expert10	[pos="e,5617.4,44994 5617.4,45029 5617.4,45029 5617.4,45004 5617.4,45004"];
	layer3_moe_comm_to_expert10 -> layer3_moe_expert10	[pos="e,5617,45082 5617,45118 5617,45118 5617,45092 5617,45092"];
	layer3_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L3\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="6057,45056",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer3_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5955,44965",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer3_moe_expert11 -> layer3_moe_comm_from_expert11	[pos="e,5968.9,44993 5968.9,45029 5968.9,45029 5968.9,45003 5968.9,45003"];
	layer3_moe_comm_to_expert11 -> layer3_moe_expert11	[pos="e,5968,45082 5968,45118 5968,45118 5968,45092 5968,45092"];
	layer3_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L3\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6413,45056",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer3_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="6306,44965",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer3_moe_expert12 -> layer3_moe_comm_from_expert12	[pos="e,6322.4,44993 6322.4,45029 6322.4,45029 6322.4,45003 6322.4,45003"];
	layer3_moe_comm_to_expert12 -> layer3_moe_expert12	[pos="e,6321.5,45082 6321.5,45118 6321.5,45118 6321.5,45092 6321.5,45092"];
	layer3_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L3\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6769,45056",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer3_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6660,44965",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer3_moe_expert13 -> layer3_moe_comm_from_expert13	[pos="e,6677.4,44993 6677.4,45029 6677.4,45029 6677.4,45003 6677.4,45003"];
	layer3_moe_comm_to_expert13 -> layer3_moe_expert13	[pos="e,6676,45082 6676,45118 6676,45118 6676,45092 6676,45092"];
	layer3_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L3\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="7125,45056",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer3_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="7015,44965",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer3_moe_expert14 -> layer3_moe_comm_from_expert14	[pos="e,7032.9,44993 7032.9,45029 7032.9,45029 7032.9,45003 7032.9,45003"];
	layer3_moe_comm_to_expert14 -> layer3_moe_expert14	[pos="e,7031.5,45082 7031.5,45118 7031.5,45118 7031.5,45092 7031.5,45092"];
	layer3_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L3\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7481,45056",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer3_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7370,44965",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer3_moe_expert15 -> layer3_moe_comm_from_expert15	[pos="e,7388.4,44993 7388.4,45029 7388.4,45029 7388.4,45003 7388.4,45003"];
	layer3_moe_comm_to_expert15 -> layer3_moe_expert15	[pos="e,7387,45082 7387,45118 7387,45118 7387,45092 7387,45092"];
	layer3_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L3\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4831,44848",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer4_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L4\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4831,44734",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer3_moe_aggregate -> layer4_moe_mha	[pos="e,4831,44760 4831,44795 4831,44795 4831,44770 4831,44770"];
	layer3_moe_comm_from_expert0 -> layer3_moe_aggregate	[pos="e,4583.6,44810 2357.5,44937 2357.5,44892 2357.5,44810 2357.5,44810 2357.5,44810 4573.6,44810 4573.6,44810"];
	layer3_moe_comm_from_expert1 -> layer3_moe_aggregate	[pos="e,4598.9,44825 2949.5,44941 2949.5,44901 2949.5,44825 2949.5,44825 2949.5,44825 4588.9,44825 4588.9,44825"];
	layer3_moe_comm_from_expert2 -> layer3_moe_aggregate	[pos="e,4614.5,44840 3328,44940 3328,44903 3328,44840 3328,44840 3328,44840 4604.5,44840 4604.5,44840"];
	layer3_moe_comm_from_expert3 -> layer3_moe_aggregate	[pos="e,4630.1,44855 3642.5,44946 3642.5,44915 3642.5,44855 3642.5,44855 3642.5,44855 4620.1,44855 4620.1,44855"];
	layer3_moe_comm_from_expert4 -> layer3_moe_aggregate	[pos="e,4644.4,44869 3855.5,44938 3855.5,44910 3855.5,44869 3855.5,44869 3855.5,44869 4634.4,44869 4634.4,44869"];
	layer3_moe_comm_from_expert5 -> layer3_moe_aggregate	[pos="e,4660,44884 4085.5,44940 4085.5,44916 4085.5,44884 4085.5,44884 4085.5,44884 4650,44884 4650,44884"];
	layer3_moe_comm_from_expert6 -> layer3_moe_aggregate	[pos="e,4586.6,44848 4475.8,44964 4529.3,44964 4586.6,44964 4586.6,44964 4586.6,44964 4586.6,44858 4586.6,44858"];
	layer3_moe_comm_from_expert7 -> layer3_moe_aggregate	[pos="e,4695,44900 4695,44935 4695,44935 4695,44910 4695,44910"];
	layer3_moe_comm_from_expert8 -> layer3_moe_aggregate	[pos="e,4967,44900 4967,44935 4967,44935 4967,44910 4967,44910"];
	layer3_moe_comm_from_expert9 -> layer3_moe_aggregate	[pos="e,5075.4,44848 5185.4,44964 5132.2,44964 5075.4,44964 5075.4,44964 5075.4,44964 5075.4,44858 5075.4,44858"];
	layer3_moe_comm_from_expert10 -> layer3_moe_aggregate	[pos="e,5077.1,44884 5639.3,44937 5639.3,44914 5639.3,44884 5639.3,44884 5639.3,44884 5087.1,44884 5087.1,44884"];
	layer3_moe_comm_from_expert11 -> layer3_moe_aggregate	[pos="e,5061.9,44869 5922.8,44937 5922.8,44909 5922.8,44869 5922.8,44869 5922.8,44869 5071.9,44869 5071.9,44869"];
	layer3_moe_comm_from_expert12 -> layer3_moe_aggregate	[pos="e,5047.4,44855 6273.8,44937 6273.8,44905 6273.8,44855 6273.8,44855 6273.8,44855 5057.4,44855 5057.4,44855"];
	layer3_moe_comm_from_expert13 -> layer3_moe_aggregate	[pos="e,5031.9,44840 6627.5,44937 6627.5,44901 6627.5,44840 6627.5,44840 6627.5,44840 5041.9,44840 5041.9,44840"];
	layer3_moe_comm_from_expert14 -> layer3_moe_aggregate	[pos="e,5016.3,44825 6982.5,44937 6982.5,44897 6982.5,44825 6982.5,44825 6982.5,44825 5026.3,44825 5026.3,44825"];
	layer3_moe_comm_from_expert15 -> layer3_moe_aggregate	[pos="e,5000.8,44810 7337.5,44937 7337.5,44893 7337.5,44810 7337.5,44810 7337.5,44810 5010.8,44810 5010.8,44810"];
	layer4_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L4\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4831,44620",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer4_moe_mha -> layer4_moe_gate	[pos="e,4831,44672 4831,44707 4831,44707 4831,44682 4831,44682"];
	layer4_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L4\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4831,44480",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer4_moe_gate -> layer4_moe_split	[pos="e,4831,44532 4831,44567 4831,44567 4831,44542 4831,44542"];
	layer4_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2383,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer4_moe_split -> layer4_moe_comm_to_expert0	[pos="e,2448,44383 4665.3,44516 4124.9,44516 2448,44516 2448,44516 2448,44516 2448,44393 2448,44393",
		style=dashed];
	layer4_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2655,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer4_moe_split -> layer4_moe_comm_to_expert1	[pos="e,2624.8,44390 4650,44501 4122.7,44501 2624.8,44501 2624.8,44501 2624.8,44501 2624.8,44400 2624.8,44400",
		style=dashed];
	layer4_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="3001,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer4_moe_split -> layer4_moe_comm_to_expert2	[pos="e,3022.8,44391 4636.2,44487 4168.9,44487 3022.8,44487 3022.8,44487 3022.8,44487 3022.8,44401 3022.8,44401",
		style=dashed];
	layer4_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3375,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer4_moe_split -> layer4_moe_comm_to_expert3	[pos="e,3460.8,44372 4621,44472 4237,44472 3460.8,44472 3460.8,44472 3460.8,44472 3460.8,44382 3460.8,44382",
		style=dashed];
	layer4_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3713,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer4_moe_split -> layer4_moe_comm_to_expert4	[pos="e,3765,44386 4606.2,44457 4293.5,44457 3765,44457 3765,44457 3765,44457 3765,44396 3765,44396",
		style=dashed];
	layer4_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="4132,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer4_moe_split -> layer4_moe_comm_to_expert5	[pos="e,4185.3,44386 4591,44442 4407.3,44442 4185.3,44442 4185.3,44442 4185.3,44442 4185.3,44396 4185.3,44396",
		style=dashed];
	layer4_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4441,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer4_moe_split -> layer4_moe_comm_to_expert6	[pos="e,4531.6,44362 4590.7,44479 4590.7,44476 4590.7,44362 4590.7,44362 4590.7,44362 4541.6,44362 4541.6,44362",
		style=dashed];
	layer4_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4695,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer4_moe_split -> layer4_moe_comm_to_expert7	[pos="e,4695,44392 4695,44427 4695,44427 4695,44402 4695,44402",
		style=dashed];
	layer4_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4967,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer4_moe_split -> layer4_moe_comm_to_expert8	[pos="e,4967,44392 4967,44427 4967,44427 4967,44402 4967,44402",
		style=dashed];
	layer4_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="5276,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer4_moe_split -> layer4_moe_comm_to_expert9	[pos="e,5185.3,44362 5071.3,44479 5071.3,44476 5071.3,44362 5071.3,44362 5071.3,44362 5175.3,44362 5175.3,44362",
		style=dashed];
	layer4_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5608,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer4_moe_split -> layer4_moe_comm_to_expert10	[pos="e,5576.7,44390 4995.6,44442 5215.1,44442 5576.7,44442 5576.7,44442 5576.7,44442 5576.7,44400 5576.7,44400",
		style=dashed];
	layer4_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5954,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer4_moe_split -> layer4_moe_comm_to_expert11	[pos="e,5985.4,44390 5010.7,44457 5335.2,44457 5985.4,44457 5985.4,44457 5985.4,44457 5985.4,44400 5985.4,44400",
		style=dashed];
	layer4_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="6305,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer4_moe_split -> layer4_moe_comm_to_expert12	[pos="e,6336.4,44390 5025.5,44472 5432.5,44472 6336.4,44472 6336.4,44472 6336.4,44472 6336.4,44400 6336.4,44400",
		style=dashed];
	layer4_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6658,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer4_moe_split -> layer4_moe_comm_to_expert13	[pos="e,6689.8,44390 5040.6,44487 5526.7,44487 6689.8,44487 6689.8,44487 6689.8,44487 6689.8,44400 6689.8,44400",
		style=dashed];
	layer4_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="7013,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer4_moe_split -> layer4_moe_comm_to_expert14	[pos="e,7044.8,44390 5054.7,44501 5617,44501 7044.8,44501 7044.8,44501 7044.8,44501 7044.8,44400 7044.8,44400",
		style=dashed];
	layer4_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7368,44363",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer4_moe_split -> layer4_moe_comm_to_expert15	[pos="e,7399.8,44390 5069.5,44516 5706.5,44516 7399.8,44516 7399.8,44516 7399.8,44516 7399.8,44400 7399.8,44400",
		style=dashed];
	layer4_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L4\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=S_\
expert0, hidden_dim=7168]",
		pos="2236,44272",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer4_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2309,44181",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer4_moe_expert0 -> layer4_moe_comm_from_expert0	[pos="e,2309,44210 2309,44245 2309,44245 2309,44220 2309,44220"];
	layer4_moe_comm_to_expert0 -> layer4_moe_expert0	[pos="e,2346.2,44298 2346.2,44336 2346.2,44336 2346.2,44308 2346.2,44308"];
	layer4_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L4\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=S_\
expert1, hidden_dim=7168]",
		pos="2582,44272",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer4_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2692,44181",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer4_moe_expert1 -> layer4_moe_comm_from_expert1	[pos="e,2673.7,44209 2673.7,44245 2673.7,44245 2673.7,44219 2673.7,44219"];
	layer4_moe_comm_to_expert1 -> layer4_moe_expert1	[pos="e,2655,44298 2655,44334 2655,44334 2655,44308 2655,44308"];
	layer4_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L4\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=S_\
expert2, hidden_dim=7168]",
		pos="2928,44272",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer4_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="3112,44181",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer4_moe_expert2 -> layer4_moe_comm_from_expert2	[pos="e,3056.7,44204 3056.7,44245 3056.7,44245 3056.7,44214 3056.7,44214"];
	layer4_moe_comm_to_expert2 -> layer4_moe_expert2	[pos="e,3001,44298 3001,44334 3001,44334 3001,44308 3001,44308"];
	layer4_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L4\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=S_\
expert3, hidden_dim=7168]",
		pos="3274,44272",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer4_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3458,44181",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer4_moe_expert3 -> layer4_moe_comm_from_expert3	[pos="e,3402.7,44204 3402.7,44245 3402.7,44245 3402.7,44214 3402.7,44214"];
	layer4_moe_comm_to_expert3 -> layer4_moe_expert3	[pos="e,3361.2,44298 3361.2,44334 3361.2,44334 3361.2,44308 3361.2,44308"];
	layer4_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L4\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=S_\
expert4, hidden_dim=7168]",
		pos="3620,44272",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer4_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3730,44181",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer4_moe_expert4 -> layer4_moe_comm_from_expert4	[pos="e,3711.7,44209 3711.7,44245 3711.7,44245 3711.7,44219 3711.7,44219"];
	layer4_moe_comm_to_expert4 -> layer4_moe_expert4	[pos="e,3703.2,44298 3703.2,44334 3703.2,44334 3703.2,44308 3703.2,44308"];
	layer4_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L4\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=S_\
expert5, hidden_dim=7168]",
		pos="3966,44272",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer4_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="4077,44181",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer4_moe_expert5 -> layer4_moe_comm_from_expert5	[pos="e,4058.2,44209 4058.2,44245 4058.2,44245 4058.2,44219 4058.2,44219"];
	layer4_moe_comm_to_expert5 -> layer4_moe_expert5	[pos="e,4085.7,44298 4085.7,44337 4085.7,44337 4085.7,44308 4085.7,44308"];
	layer4_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L4\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=S_\
expert6, hidden_dim=7168]",
		pos="4312,44272",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer4_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4423,44181",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer4_moe_expert6 -> layer4_moe_comm_from_expert6	[pos="e,4404.2,44209 4404.2,44245 4404.2,44245 4404.2,44219 4404.2,44219"];
	layer4_moe_comm_to_expert6 -> layer4_moe_expert6	[pos="e,4413.2,44298 4413.2,44335 4413.2,44335 4413.2,44308 4413.2,44308"];
	layer4_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L4\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=S_\
expert7, hidden_dim=7168]",
		pos="4658,44272",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer4_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4695,44181",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer4_moe_expert7 -> layer4_moe_comm_from_expert7	[pos="e,4695,44210 4695,44245 4695,44245 4695,44220 4695,44220"];
	layer4_moe_comm_to_expert7 -> layer4_moe_expert7	[pos="e,4695,44298 4695,44334 4695,44334 4695,44308 4695,44308"];
	layer4_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L4\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=S_\
expert8, hidden_dim=7168]",
		pos="5004,44272",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer4_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4967,44181",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer4_moe_expert8 -> layer4_moe_comm_from_expert8	[pos="e,4967,44210 4967,44245 4967,44245 4967,44220 4967,44220"];
	layer4_moe_comm_to_expert8 -> layer4_moe_expert8	[pos="e,4967,44298 4967,44334 4967,44334 4967,44308 4967,44308"];
	layer4_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L4\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=S_\
expert9, hidden_dim=7168]",
		pos="5350,44272",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer4_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="5276,44181",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer4_moe_expert9 -> layer4_moe_comm_from_expert9	[pos="e,5276.3,44210 5276.3,44245 5276.3,44245 5276.3,44220 5276.3,44220"];
	layer4_moe_comm_to_expert9 -> layer4_moe_expert9	[pos="e,5276.3,44298 5276.3,44334 5276.3,44334 5276.3,44308 5276.3,44308"];
	layer4_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L4\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5701,44272",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer4_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5608,44181",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer4_moe_expert10 -> layer4_moe_comm_from_expert10	[pos="e,5617.4,44210 5617.4,44245 5617.4,44245 5617.4,44220 5617.4,44220"];
	layer4_moe_comm_to_expert10 -> layer4_moe_expert10	[pos="e,5617,44298 5617,44334 5617,44334 5617,44308 5617,44308"];
	layer4_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L4\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="6057,44272",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer4_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5955,44181",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer4_moe_expert11 -> layer4_moe_comm_from_expert11	[pos="e,5968.9,44209 5968.9,44245 5968.9,44245 5968.9,44219 5968.9,44219"];
	layer4_moe_comm_to_expert11 -> layer4_moe_expert11	[pos="e,5968,44298 5968,44334 5968,44334 5968,44308 5968,44308"];
	layer4_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L4\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6413,44272",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer4_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="6306,44181",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer4_moe_expert12 -> layer4_moe_comm_from_expert12	[pos="e,6322.4,44209 6322.4,44245 6322.4,44245 6322.4,44219 6322.4,44219"];
	layer4_moe_comm_to_expert12 -> layer4_moe_expert12	[pos="e,6321.5,44298 6321.5,44334 6321.5,44334 6321.5,44308 6321.5,44308"];
	layer4_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L4\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6769,44272",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer4_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6660,44181",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer4_moe_expert13 -> layer4_moe_comm_from_expert13	[pos="e,6677.4,44209 6677.4,44245 6677.4,44245 6677.4,44219 6677.4,44219"];
	layer4_moe_comm_to_expert13 -> layer4_moe_expert13	[pos="e,6676,44298 6676,44334 6676,44334 6676,44308 6676,44308"];
	layer4_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L4\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="7125,44272",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer4_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="7015,44181",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer4_moe_expert14 -> layer4_moe_comm_from_expert14	[pos="e,7032.9,44209 7032.9,44245 7032.9,44245 7032.9,44219 7032.9,44219"];
	layer4_moe_comm_to_expert14 -> layer4_moe_expert14	[pos="e,7031.5,44298 7031.5,44334 7031.5,44334 7031.5,44308 7031.5,44308"];
	layer4_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L4\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7481,44272",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer4_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7370,44181",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer4_moe_expert15 -> layer4_moe_comm_from_expert15	[pos="e,7388.4,44209 7388.4,44245 7388.4,44245 7388.4,44219 7388.4,44219"];
	layer4_moe_comm_to_expert15 -> layer4_moe_expert15	[pos="e,7387,44298 7387,44334 7387,44334 7387,44308 7387,44308"];
	layer4_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L4\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4794,44064",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer5_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L5\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4794,43950",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer4_moe_aggregate -> layer5_moe_mha	[pos="e,4794,43976 4794,44011 4794,44011 4794,43986 4794,43986"];
	layer4_moe_comm_from_expert0 -> layer4_moe_aggregate	[pos="e,4546.5,44026 2333.5,44153 2333.5,44108 2333.5,44026 2333.5,44026 2333.5,44026 4536.5,44026 4536.5,44026"];
	layer4_moe_comm_from_expert1 -> layer4_moe_aggregate	[pos="e,4562.1,44041 2754.8,44160 2754.8,44121 2754.8,44041 2754.8,44041 2754.8,44041 4552.1,44041 4552.1,44041"];
	layer4_moe_comm_from_expert2 -> layer4_moe_aggregate	[pos="e,4577.5,44056 3137.8,44153 3137.8,44116 3137.8,44056 3137.8,44056 3137.8,44056 4567.5,44056 4567.5,44056"];
	layer4_moe_comm_from_expert3 -> layer4_moe_aggregate	[pos="e,4593.1,44071 3487.5,44153 3487.5,44120 3487.5,44071 3487.5,44071 3487.5,44071 4583.1,44071 4583.1,44071"];
	layer4_moe_comm_from_expert4 -> layer4_moe_aggregate	[pos="e,4607.6,44085 3815,44170 3815,44146 3815,44085 3815,44085 3815,44085 4597.6,44085 4597.6,44085"];
	layer4_moe_comm_from_expert5 -> layer4_moe_aggregate	[pos="e,4622.7,44100 4134,44158 4134,44134 4134,44100 4134,44100 4134,44100 4612.7,44100 4612.7,44100"];
	layer4_moe_comm_from_expert6 -> layer4_moe_aggregate	[pos="e,4568.1,44064 4513.7,44180 4543,44180 4568.1,44180 4568.1,44180 4568.1,44180 4568.1,44074 4568.1,44074"];
	layer4_moe_comm_from_expert7 -> layer4_moe_aggregate	[pos="e,4695,44116 4695,44151 4695,44151 4695,44126 4695,44126"];
	layer4_moe_comm_from_expert8 -> layer4_moe_aggregate	[pos="e,4966.4,44116 4966.4,44151 4966.4,44151 4966.4,44126 4966.4,44126"];
	layer4_moe_comm_from_expert9 -> layer4_moe_aggregate	[pos="e,5042.4,44102 5257.5,44152 5257.5,44129 5257.5,44102 5257.5,44102 5257.5,44102 5052.4,44102 5052.4,44102"];
	layer4_moe_comm_from_expert10 -> layer4_moe_aggregate	[pos="e,5028.8,44089 5589.1,44152 5589.1,44125 5589.1,44089 5589.1,44089 5589.1,44089 5038.8,44089 5038.8,44089"];
	layer4_moe_comm_from_expert11 -> layer4_moe_aggregate	[pos="e,5015.5,44076 5935.6,44152 5935.6,44121 5935.6,44076 5935.6,44076 5935.6,44076 5025.5,44076 5025.5,44076"];
	layer4_moe_comm_from_expert12 -> layer4_moe_aggregate	[pos="e,5001.9,44063 6286.6,44152 6286.6,44117 6286.6,44063 6286.6,44063 6286.6,44063 5011.9,44063 5011.9,44063"];
	layer4_moe_comm_from_expert13 -> layer4_moe_aggregate	[pos="e,4988.5,44050 6640.1,44152 6640.1,44113 6640.1,44050 6640.1,44050 6640.1,44050 4998.5,44050 4998.5,44050"];
	layer4_moe_comm_from_expert14 -> layer4_moe_aggregate	[pos="e,4975.1,44037 6995.1,44152 6995.1,44110 6995.1,44037 6995.1,44037 6995.1,44037 4985.1,44037 4985.1,44037"];
	layer4_moe_comm_from_expert15 -> layer4_moe_aggregate	[pos="e,4961.7,44024 7350.1,44152 7350.1,44107 7350.1,44024 7350.1,44024 7350.1,44024 4971.7,44024 4971.7,44024"];
	layer5_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L5\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4794,43836",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer5_moe_mha -> layer5_moe_gate	[pos="e,4794,43888 4794,43923 4794,43923 4794,43898 4794,43898"];
	layer5_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L5\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4794,43696",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer5_moe_gate -> layer5_moe_split	[pos="e,4794,43748 4794,43783 4794,43783 4794,43758 4794,43758"];
	layer5_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2358,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer5_moe_split -> layer5_moe_comm_to_expert0	[pos="e,2433.3,43595 4628,43732 4090.6,43732 2433.3,43732 2433.3,43732 2433.3,43732 2433.3,43605 2433.3,43605",
		style=dashed];
	layer5_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2630,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer5_moe_split -> layer5_moe_comm_to_expert1	[pos="e,2661,43606 4613.1,43717 4098,43717 2661,43717 2661,43717 2661,43717 2661,43616 2661,43616",
		style=dashed];
	layer5_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2951,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer5_moe_split -> layer5_moe_comm_to_expert2	[pos="e,3031.5,43592 4599.1,43703 4140.4,43703 3031.5,43703 3031.5,43703 3031.5,43703 3031.5,43602 3031.5,43602",
		style=dashed];
	layer5_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3517,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer5_moe_split -> layer5_moe_comm_to_expert3	[pos="e,3578,43600 4584.3,43688 4236.4,43688 3578,43688 3578,43688 3578,43688 3578,43610 3578,43610",
		style=dashed];
	layer5_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3900,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer5_moe_split -> layer5_moe_comm_to_expert4	[pos="e,3903.5,43608 4569.3,43673 4305.5,43673 3903.5,43673 3903.5,43673 3903.5,43673 3903.5,43618 3903.5,43618",
		style=dashed];
	layer5_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="4191,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer5_moe_split -> layer5_moe_comm_to_expert5	[pos="e,4224.5,43606 4554.1,43658 4398.5,43658 4224.5,43658 4224.5,43658 4224.5,43658 4224.5,43616 4224.5,43616",
		style=dashed];
	layer5_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4436,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer5_moe_split -> layer5_moe_comm_to_expert6	[pos="e,4526.7,43578 4553.7,43696 4553.7,43692 4553.7,43578 4553.7,43578 4553.7,43578 4536.7,43578 4536.7,43578",
		style=dashed];
	layer5_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4658,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer5_moe_split -> layer5_moe_comm_to_expert7	[pos="e,4658,43608 4658,43643 4658,43643 4658,43618 4658,43618",
		style=dashed];
	layer5_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4930,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer5_moe_split -> layer5_moe_comm_to_expert8	[pos="e,4930,43608 4930,43643 4930,43643 4930,43618 4930,43618",
		style=dashed];
	layer5_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="5239,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer5_moe_split -> layer5_moe_comm_to_expert9	[pos="e,5148.3,43578 5034.3,43696 5034.3,43692 5034.3,43578 5034.3,43578 5034.3,43578 5138.3,43578 5138.3,43578",
		style=dashed];
	layer5_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5571,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer5_moe_split -> layer5_moe_comm_to_expert10	[pos="e,5495.1,43596 4958.8,43658 5166.1,43658 5495.1,43658 5495.1,43658 5495.1,43658 5495.1,43606 5495.1,43606",
		style=dashed];
	layer5_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5917,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer5_moe_split -> layer5_moe_comm_to_expert11	[pos="e,5841.6,43596 4973.5,43673 5272.9,43673 5841.6,43673 5841.6,43673 5841.6,43673 5841.6,43606 5841.6,43606",
		style=dashed];
	layer5_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="6268,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer5_moe_split -> layer5_moe_comm_to_expert12	[pos="e,6192.6,43596 4988.5,43688 5372.8,43688 6192.6,43688 6192.6,43688 6192.6,43688 6192.6,43606 6192.6,43606",
		style=dashed];
	layer5_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6621,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer5_moe_split -> layer5_moe_comm_to_expert13	[pos="e,6546.1,43596 5003.6,43703 5468.7,43703 6546.1,43703 6546.1,43703 6546.1,43703 6546.1,43606 6546.1,43606",
		style=dashed];
	layer5_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6976,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer5_moe_split -> layer5_moe_comm_to_expert14	[pos="e,6901.1,43596 5017.5,43717 5559.8,43717 6901.1,43717 6901.1,43717 6901.1,43717 6901.1,43606 6901.1,43606",
		style=dashed];
	layer5_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7331,43579",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer5_moe_split -> layer5_moe_comm_to_expert15	[pos="e,7256.1,43596 5032.6,43732 5650.7,43732 7256.1,43732 7256.1,43732 7256.1,43732 7256.1,43606 7256.1,43606",
		style=dashed];
	layer5_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L5\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=S_\
expert0, hidden_dim=7168]",
		pos="2199,43488",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer5_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2374,43397",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer5_moe_expert0 -> layer5_moe_comm_from_expert0	[pos="e,2323.2,43421 2323.2,43461 2323.2,43461 2323.2,43431 2323.2,43431"];
	layer5_moe_comm_to_expert0 -> layer5_moe_expert0	[pos="e,2315.2,43514 2315.2,43553 2315.2,43553 2315.2,43524 2315.2,43524"];
	layer5_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L5\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=S_\
expert1, hidden_dim=7168]",
		pos="2545,43488",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer5_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2646,43397",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer5_moe_expert1 -> layer5_moe_comm_from_expert1	[pos="e,2632.2,43425 2632.2,43461 2632.2,43461 2632.2,43435 2632.2,43435"];
	layer5_moe_comm_to_expert1 -> layer5_moe_expert1	[pos="e,2624.2,43514 2624.2,43550 2624.2,43550 2624.2,43524 2624.2,43524"];
	layer5_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L5\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=S_\
expert2, hidden_dim=7168]",
		pos="2891,43488",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer5_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="3057,43397",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer5_moe_expert2 -> layer5_moe_comm_from_expert2	[pos="e,3010.7,43422 3010.7,43461 3010.7,43461 3010.7,43432 3010.7,43432"];
	layer5_moe_comm_to_expert2 -> layer5_moe_expert2	[pos="e,2951,43514 2951,43550 2951,43550 2951,43524 2951,43524"];
	layer5_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L5\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=S_\
expert3, hidden_dim=7168]",
		pos="3237,43488",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer5_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3476,43397",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer5_moe_expert3 -> layer5_moe_comm_from_expert3	[pos="e,3393.2,43409 3393.2,43461 3393.2,43461 3393.2,43419 3393.2,43419"];
	layer5_moe_comm_to_expert3 -> layer5_moe_expert3	[pos="e,3384.2,43514 3426.2,43578 3402.9,43578 3384.2,43578 3384.2,43578 3384.2,43578 3384.2,43524 3384.2,43524"];
	layer5_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L5\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=S_\
expert4, hidden_dim=7168]",
		pos="3583,43488",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer5_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3785,43397",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer5_moe_expert4 -> layer5_moe_comm_from_expert4	[pos="e,3720.7,43417 3720.7,43461 3720.7,43461 3720.7,43427 3720.7,43427"];
	layer5_moe_comm_to_expert4 -> layer5_moe_expert4	[pos="e,3693.2,43514 3809.3,43578 3753.8,43578 3693.2,43578 3693.2,43578 3693.2,43578 3693.2,43524 3693.2,43524"];
	layer5_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L5\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=S_\
expert5, hidden_dim=7168]",
		pos="3929,43488",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer5_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="4039,43397",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer5_moe_expert5 -> layer5_moe_comm_from_expert5	[pos="e,4020.7,43425 4020.7,43461 4020.7,43461 4020.7,43435 4020.7,43435"];
	layer5_moe_comm_to_expert5 -> layer5_moe_expert5	[pos="e,4093,43487 4105.7,43569 4105.7,43545 4105.7,43487 4105.7,43487 4105.7,43487 4103,43487 4103,43487"];
	layer5_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L5\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=S_\
expert6, hidden_dim=7168]",
		pos="4275,43488",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer5_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4386,43397",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer5_moe_expert6 -> layer5_moe_comm_from_expert6	[pos="e,4367.2,43425 4367.2,43461 4367.2,43461 4367.2,43435 4367.2,43435"];
	layer5_moe_comm_to_expert6 -> layer5_moe_expert6	[pos="e,4392.2,43514 4392.2,43553 4392.2,43553 4392.2,43524 4392.2,43524"];
	layer5_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L5\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=S_\
expert7, hidden_dim=7168]",
		pos="4621,43488",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer5_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4658,43397",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer5_moe_expert7 -> layer5_moe_comm_from_expert7	[pos="e,4658,43426 4658,43461 4658,43461 4658,43436 4658,43436"];
	layer5_moe_comm_to_expert7 -> layer5_moe_expert7	[pos="e,4658,43514 4658,43550 4658,43550 4658,43524 4658,43524"];
	layer5_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L5\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=S_\
expert8, hidden_dim=7168]",
		pos="4967,43488",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer5_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4930,43397",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer5_moe_expert8 -> layer5_moe_comm_from_expert8	[pos="e,4930,43426 4930,43461 4930,43461 4930,43436 4930,43436"];
	layer5_moe_comm_to_expert8 -> layer5_moe_expert8	[pos="e,4930,43514 4930,43550 4930,43550 4930,43524 4930,43524"];
	layer5_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L5\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=S_\
expert9, hidden_dim=7168]",
		pos="5313,43488",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer5_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="5239,43397",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer5_moe_expert9 -> layer5_moe_comm_from_expert9	[pos="e,5239.3,43426 5239.3,43461 5239.3,43461 5239.3,43436 5239.3,43436"];
	layer5_moe_comm_to_expert9 -> layer5_moe_expert9	[pos="e,5239.3,43514 5239.3,43550 5239.3,43550 5239.3,43524 5239.3,43524"];
	layer5_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L5\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5664,43488",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer5_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5571,43397",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer5_moe_expert10 -> layer5_moe_comm_from_expert10	[pos="e,5580.4,43426 5580.4,43461 5580.4,43461 5580.4,43436 5580.4,43436"];
	layer5_moe_comm_to_expert10 -> layer5_moe_expert10	[pos="e,5580,43514 5580,43550 5580,43550 5580,43524 5580,43524"];
	layer5_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L5\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="6020,43488",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer5_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5918,43397",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer5_moe_expert11 -> layer5_moe_comm_from_expert11	[pos="e,5931.9,43425 5931.9,43461 5931.9,43461 5931.9,43435 5931.9,43435"];
	layer5_moe_comm_to_expert11 -> layer5_moe_expert11	[pos="e,5931,43514 5931,43550 5931,43550 5931,43524 5931,43524"];
	layer5_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L5\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6376,43488",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer5_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="6269,43397",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer5_moe_expert12 -> layer5_moe_comm_from_expert12	[pos="e,6285.4,43425 6285.4,43461 6285.4,43461 6285.4,43435 6285.4,43435"];
	layer5_moe_comm_to_expert12 -> layer5_moe_expert12	[pos="e,6284.5,43514 6284.5,43550 6284.5,43550 6284.5,43524 6284.5,43524"];
	layer5_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L5\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6732,43488",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer5_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6623,43397",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer5_moe_expert13 -> layer5_moe_comm_from_expert13	[pos="e,6640.4,43425 6640.4,43461 6640.4,43461 6640.4,43435 6640.4,43435"];
	layer5_moe_comm_to_expert13 -> layer5_moe_expert13	[pos="e,6639,43514 6639,43550 6639,43550 6639,43524 6639,43524"];
	layer5_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L5\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="7088,43488",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer5_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6978,43397",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer5_moe_expert14 -> layer5_moe_comm_from_expert14	[pos="e,6995.9,43425 6995.9,43461 6995.9,43461 6995.9,43435 6995.9,43435"];
	layer5_moe_comm_to_expert14 -> layer5_moe_expert14	[pos="e,6994.5,43514 6994.5,43550 6994.5,43550 6994.5,43524 6994.5,43524"];
	layer5_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L5\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7444,43488",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer5_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7333,43397",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer5_moe_expert15 -> layer5_moe_comm_from_expert15	[pos="e,7351.4,43425 7351.4,43461 7351.4,43461 7351.4,43435 7351.4,43435"];
	layer5_moe_comm_to_expert15 -> layer5_moe_expert15	[pos="e,7350,43514 7350,43550 7350,43550 7350,43524 7350,43524"];
	layer5_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L5\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4757,43280",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer6_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L6\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4757,43166",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer5_moe_aggregate -> layer6_moe_mha	[pos="e,4757,43192 4757,43227 4757,43227 4757,43202 4757,43202"];
	layer5_moe_comm_from_expert0 -> layer5_moe_aggregate	[pos="e,4509.6,43242 2450.5,43381 2450.5,43342 2450.5,43242 2450.5,43242 2450.5,43242 4499.6,43242 4499.6,43242"];
	layer5_moe_comm_from_expert1 -> layer5_moe_aggregate	[pos="e,4525.1,43257 2722.5,43381 2722.5,43344 2722.5,43257 2722.5,43257 2722.5,43257 4515.1,43257 4515.1,43257"];
	layer5_moe_comm_from_expert2 -> layer5_moe_aggregate	[pos="e,4540.3,43272 3138,43383 3138,43351 3138,43272 3138,43272 3138,43272 4530.3,43272 4530.3,43272"];
	layer5_moe_comm_from_expert3 -> layer5_moe_aggregate	[pos="e,4555.9,43287 3483.5,43368 3483.5,43335 3483.5,43287 3483.5,43287 3483.5,43287 4545.9,43287 4545.9,43287"];
	layer5_moe_comm_from_expert4 -> layer5_moe_aggregate	[pos="e,4570.4,43301 3829.5,43371 3829.5,43343 3829.5,43301 3829.5,43301 3829.5,43301 4560.4,43301 4560.4,43301"];
	layer5_moe_comm_from_expert5 -> layer5_moe_aggregate	[pos="e,4585.6,43316 4069.2,43369 4069.2,43346 4069.2,43316 4069.2,43316 4069.2,43316 4575.6,43316 4575.6,43316"];
	layer5_moe_comm_from_expert6 -> layer5_moe_aggregate	[pos="e,4531.1,43280 4476.7,43396 4506,43396 4531.1,43396 4531.1,43396 4531.1,43396 4531.1,43290 4531.1,43290"];
	layer5_moe_comm_from_expert7 -> layer5_moe_aggregate	[pos="e,4658,43332 4658,43367 4658,43367 4658,43342 4658,43342"];
	layer5_moe_comm_from_expert8 -> layer5_moe_aggregate	[pos="e,4929.4,43332 4929.4,43367 4929.4,43367 4929.4,43342 4929.4,43342"];
	layer5_moe_comm_from_expert9 -> layer5_moe_aggregate	[pos="e,5005,43318 5220.5,43368 5220.5,43346 5220.5,43318 5220.5,43318 5220.5,43318 5015,43318 5015,43318"];
	layer5_moe_comm_from_expert10 -> layer5_moe_aggregate	[pos="e,4991.8,43305 5552.1,43368 5552.1,43341 5552.1,43305 5552.1,43305 5552.1,43305 5001.8,43305 5001.8,43305"];
	layer5_moe_comm_from_expert11 -> layer5_moe_aggregate	[pos="e,4978.5,43292 5898.6,43368 5898.6,43337 5898.6,43292 5898.6,43292 5898.6,43292 4988.5,43292 4988.5,43292"];
	layer5_moe_comm_from_expert12 -> layer5_moe_aggregate	[pos="e,4964.9,43279 6249.6,43368 6249.6,43333 6249.6,43279 6249.6,43279 6249.6,43279 4974.9,43279 4974.9,43279"];
	layer5_moe_comm_from_expert13 -> layer5_moe_aggregate	[pos="e,4951.5,43266 6603.1,43368 6603.1,43330 6603.1,43266 6603.1,43266 6603.1,43266 4961.5,43266 4961.5,43266"];
	layer5_moe_comm_from_expert14 -> layer5_moe_aggregate	[pos="e,4938.1,43253 6958.1,43368 6958.1,43326 6958.1,43253 6958.1,43253 6958.1,43253 4948.1,43253 4948.1,43253"];
	layer5_moe_comm_from_expert15 -> layer5_moe_aggregate	[pos="e,4924.7,43240 7313.1,43368 7313.1,43323 7313.1,43240 7313.1,43240 7313.1,43240 4934.7,43240 4934.7,43240"];
	layer6_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L6\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4757,43052",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer6_moe_mha -> layer6_moe_gate	[pos="e,4757,43104 4757,43139 4757,43139 4757,43114 4757,43114"];
	layer6_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L6\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4757,42912",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer6_moe_gate -> layer6_moe_split	[pos="e,4757,42964 4757,43000 4757,43000 4757,42974 4757,42974"];
	layer6_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2346,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer6_moe_split -> layer6_moe_comm_to_expert0	[pos="e,2360,42823 4591.3,42948 4048.7,42948 2360,42948 2360,42948 2360,42948 2360,42833 2360,42833",
		style=dashed];
	layer6_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2618,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer6_moe_split -> layer6_moe_comm_to_expert1	[pos="e,2632,42823 4576.3,42933 4062.8,42933 2632,42933 2632,42933 2632,42933 2632,42833 2632,42833",
		style=dashed];
	layer6_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="3038,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer6_moe_split -> layer6_moe_comm_to_expert2	[pos="e,3047.5,42823 4562.1,42919 4113.8,42919 3047.5,42919 3047.5,42919 3047.5,42919 3047.5,42833 3047.5,42833",
		style=dashed];
	layer6_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3310,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer6_moe_split -> layer6_moe_comm_to_expert3	[pos="e,3393,42806 4547.2,42904 4164.8,42904 3393,42904 3393,42904 3393,42904 3393,42816 3393,42816",
		style=dashed];
	layer6_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3693,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer6_moe_split -> layer6_moe_comm_to_expert4	[pos="e,3739,42820 4532,42889 4232.2,42889 3739,42889 3739,42889 3739,42889 3739,42830 3739,42830",
		style=dashed];
	layer6_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="4039,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer6_moe_split -> layer6_moe_comm_to_expert5	[pos="e,4008.8,42822 4517.2,42874 4298.4,42874 4008.8,42874 4008.8,42874 4008.8,42874 4008.8,42832 4008.8,42832",
		style=dashed];
	layer6_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4311,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer6_moe_split -> layer6_moe_comm_to_expert6	[pos="e,4401.5,42794 4516.7,42912 4516.7,42908 4516.7,42794 4516.7,42794 4516.7,42794 4411.5,42794 4411.5,42794",
		style=dashed];
	layer6_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4621,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer6_moe_split -> layer6_moe_comm_to_expert7	[pos="e,4621,42824 4621,42859 4621,42859 4621,42834 4621,42834",
		style=dashed];
	layer6_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4893,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer6_moe_split -> layer6_moe_comm_to_expert8	[pos="e,4893,42824 4893,42859 4893,42859 4893,42834 4893,42834",
		style=dashed];
	layer6_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="5202,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer6_moe_split -> layer6_moe_comm_to_expert9	[pos="e,5111.3,42794 4997.3,42912 4997.3,42908 4997.3,42794 4997.3,42794 4997.3,42794 5101.3,42794 5101.3,42794",
		style=dashed];
	layer6_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5534,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer6_moe_split -> layer6_moe_comm_to_expert10	[pos="e,5458.1,42812 4921.8,42874 5129.1,42874 5458.1,42874 5458.1,42874 5458.1,42874 5458.1,42822 5458.1,42822",
		style=dashed];
	layer6_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5880,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer6_moe_split -> layer6_moe_comm_to_expert11	[pos="e,5804.6,42812 4936.5,42889 5235.9,42889 5804.6,42889 5804.6,42889 5804.6,42889 5804.6,42822 5804.6,42822",
		style=dashed];
	layer6_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="6231,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer6_moe_split -> layer6_moe_comm_to_expert12	[pos="e,6155.6,42812 4951.5,42904 5335.8,42904 6155.6,42904 6155.6,42904 6155.6,42904 6155.6,42822 6155.6,42822",
		style=dashed];
	layer6_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6584,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer6_moe_split -> layer6_moe_comm_to_expert13	[pos="e,6509.1,42812 4966.6,42919 5431.7,42919 6509.1,42919 6509.1,42919 6509.1,42919 6509.1,42822 6509.1,42822",
		style=dashed];
	layer6_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6939,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer6_moe_split -> layer6_moe_comm_to_expert14	[pos="e,6864.1,42812 4980.5,42933 5522.8,42933 6864.1,42933 6864.1,42933 6864.1,42933 6864.1,42822 6864.1,42822",
		style=dashed];
	layer6_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7294,42795",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer6_moe_split -> layer6_moe_comm_to_expert15	[pos="e,7219.1,42812 4995.6,42948 5613.7,42948 7219.1,42948 7219.1,42948 7219.1,42948 7219.1,42822 7219.1,42822",
		style=dashed];
	layer6_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L6\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=S_\
expert0, hidden_dim=7168]",
		pos="2162,42704",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer6_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2321,42613",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer6_moe_expert0 -> layer6_moe_comm_from_expert0	[pos="e,2278.2,42638 2278.2,42677 2278.2,42677 2278.2,42648 2278.2,42648"];
	layer6_moe_comm_to_expert0 -> layer6_moe_expert0	[pos="e,2290.7,42730 2290.7,42771 2290.7,42771 2290.7,42740 2290.7,42740"];
	layer6_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L6\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=S_\
expert1, hidden_dim=7168]",
		pos="2508,42704",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer6_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2593,42613",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer6_moe_expert1 -> layer6_moe_comm_from_expert1	[pos="e,2587.2,42642 2587.2,42677 2587.2,42677 2587.2,42652 2587.2,42652"];
	layer6_moe_comm_to_expert1 -> layer6_moe_expert1	[pos="e,2599.7,42730 2599.7,42766 2599.7,42766 2599.7,42740 2599.7,42740"];
	layer6_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L6\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=S_\
expert2, hidden_dim=7168]",
		pos="2854,42704",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer6_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2914,42613",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer6_moe_expert2 -> layer6_moe_comm_from_expert2	[pos="e,2914,42642 2914,42677 2914,42677 2914,42652 2914,42652"];
	layer6_moe_comm_to_expert2 -> layer6_moe_expert2	[pos="e,2982.7,42730 2982.7,42771 2982.7,42771 2982.7,42740 2982.7,42740"];
	layer6_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L6\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=S_\
expert3, hidden_dim=7168]",
		pos="3200,42704",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer6_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3480,42613",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer6_moe_expert3 -> layer6_moe_comm_from_expert3	[pos="e,3389.2,42612 3310.2,42678 3310.2,42651 3310.2,42612 3310.2,42612 3310.2,42612 3379.2,42612 3379.2,42612"];
	layer6_moe_comm_to_expert3 -> layer6_moe_expert3	[pos="e,3291.7,42730 3291.7,42766 3291.7,42766 3291.7,42740 3291.7,42740"];
	layer6_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L6\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=S_\
expert4, hidden_dim=7168]",
		pos="3546,42704",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer6_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3863,42613",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer6_moe_expert4 -> layer6_moe_comm_from_expert4	[pos="e,3772.4,42612 3663.2,42678 3663.2,42651 3663.2,42612 3663.2,42612 3663.2,42612 3762.4,42612 3762.4,42612"];
	layer6_moe_comm_to_expert4 -> layer6_moe_expert4	[pos="e,3656.2,42730 3656.2,42768 3656.2,42768 3656.2,42740 3656.2,42740"];
	layer6_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L6\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=S_\
expert5, hidden_dim=7168]",
		pos="3892,42704",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer6_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="4154,42613",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer6_moe_expert5 -> layer6_moe_comm_from_expert5	[pos="e,4068.7,42623 4056,42703 4064,42703 4068.7,42703 4068.7,42703 4068.7,42703 4068.7,42633 4068.7,42633"];
	layer6_moe_comm_to_expert5 -> layer6_moe_expert5	[pos="e,4002.2,42730 4002.2,42768 4002.2,42768 4002.2,42740 4002.2,42740"];
	layer6_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L6\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=S_\
expert6, hidden_dim=7168]",
		pos="4238,42704",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer6_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4399,42613",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer6_moe_expert6 -> layer6_moe_comm_from_expert6	[pos="e,4355.2,42638 4355.2,42677 4355.2,42677 4355.2,42648 4355.2,42648"];
	layer6_moe_comm_to_expert6 -> layer6_moe_expert6	[pos="e,4311,42730 4311,42766 4311,42766 4311,42740 4311,42740"];
	layer6_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L6\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=S_\
expert7, hidden_dim=7168]",
		pos="4584,42704",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer6_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4621,42613",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer6_moe_expert7 -> layer6_moe_comm_from_expert7	[pos="e,4621,42642 4621,42677 4621,42677 4621,42652 4621,42652"];
	layer6_moe_comm_to_expert7 -> layer6_moe_expert7	[pos="e,4621,42730 4621,42766 4621,42766 4621,42740 4621,42740"];
	layer6_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L6\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=S_\
expert8, hidden_dim=7168]",
		pos="4930,42704",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer6_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4893,42613",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer6_moe_expert8 -> layer6_moe_comm_from_expert8	[pos="e,4893,42642 4893,42677 4893,42677 4893,42652 4893,42652"];
	layer6_moe_comm_to_expert8 -> layer6_moe_expert8	[pos="e,4893,42730 4893,42766 4893,42766 4893,42740 4893,42740"];
	layer6_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L6\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=S_\
expert9, hidden_dim=7168]",
		pos="5276,42704",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer6_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="5202,42613",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer6_moe_expert9 -> layer6_moe_comm_from_expert9	[pos="e,5202.3,42642 5202.3,42677 5202.3,42677 5202.3,42652 5202.3,42652"];
	layer6_moe_comm_to_expert9 -> layer6_moe_expert9	[pos="e,5202.3,42730 5202.3,42766 5202.3,42766 5202.3,42740 5202.3,42740"];
	layer6_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L6\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5627,42704",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer6_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5534,42613",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer6_moe_expert10 -> layer6_moe_comm_from_expert10	[pos="e,5543.4,42642 5543.4,42677 5543.4,42677 5543.4,42652 5543.4,42652"];
	layer6_moe_comm_to_expert10 -> layer6_moe_expert10	[pos="e,5543,42730 5543,42766 5543,42766 5543,42740 5543,42740"];
	layer6_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L6\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5983,42704",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer6_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5881,42613",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer6_moe_expert11 -> layer6_moe_comm_from_expert11	[pos="e,5894.9,42641 5894.9,42677 5894.9,42677 5894.9,42651 5894.9,42651"];
	layer6_moe_comm_to_expert11 -> layer6_moe_expert11	[pos="e,5894,42730 5894,42766 5894,42766 5894,42740 5894,42740"];
	layer6_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L6\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6339,42704",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer6_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="6232,42613",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer6_moe_expert12 -> layer6_moe_comm_from_expert12	[pos="e,6248.4,42641 6248.4,42677 6248.4,42677 6248.4,42651 6248.4,42651"];
	layer6_moe_comm_to_expert12 -> layer6_moe_expert12	[pos="e,6247.5,42730 6247.5,42766 6247.5,42766 6247.5,42740 6247.5,42740"];
	layer6_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L6\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6695,42704",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer6_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6586,42613",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer6_moe_expert13 -> layer6_moe_comm_from_expert13	[pos="e,6603.4,42641 6603.4,42677 6603.4,42677 6603.4,42651 6603.4,42651"];
	layer6_moe_comm_to_expert13 -> layer6_moe_expert13	[pos="e,6602,42730 6602,42766 6602,42766 6602,42740 6602,42740"];
	layer6_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L6\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="7051,42704",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer6_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6941,42613",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer6_moe_expert14 -> layer6_moe_comm_from_expert14	[pos="e,6958.9,42641 6958.9,42677 6958.9,42677 6958.9,42651 6958.9,42651"];
	layer6_moe_comm_to_expert14 -> layer6_moe_expert14	[pos="e,6957.5,42730 6957.5,42766 6957.5,42766 6957.5,42740 6957.5,42740"];
	layer6_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L6\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7407,42704",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer6_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7296,42613",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer6_moe_expert15 -> layer6_moe_comm_from_expert15	[pos="e,7314.4,42641 7314.4,42677 7314.4,42677 7314.4,42651 7314.4,42651"];
	layer6_moe_comm_to_expert15 -> layer6_moe_expert15	[pos="e,7313,42730 7313,42766 7313,42766 7313,42740 7313,42740"];
	layer6_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L6\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4720,42496",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer7_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L7\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4720,42382",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer6_moe_aggregate -> layer7_moe_mha	[pos="e,4720,42408 4720,42443 4720,42443 4720,42418 4720,42418"];
	layer6_moe_comm_from_expert0 -> layer6_moe_aggregate	[pos="e,4472.5,42458 2387,42593 2387,42551 2387,42458 2387,42458 2387,42458 4462.5,42458 4462.5,42458"];
	layer6_moe_comm_from_expert1 -> layer6_moe_aggregate	[pos="e,4488.1,42473 2668.3,42596 2668.3,42560 2668.3,42473 2668.3,42473 2668.3,42473 4478.1,42473 4478.1,42473"];
	layer6_moe_comm_from_expert2 -> layer6_moe_aggregate	[pos="e,4503.4,42488 2920.5,42583 2920.5,42547 2920.5,42488 2920.5,42488 2920.5,42488 4493.4,42488 4493.4,42488"];
	layer6_moe_comm_from_expert3 -> layer6_moe_aggregate	[pos="e,4518.8,42503 3549.5,42594 3549.5,42563 3549.5,42503 3549.5,42503 3549.5,42503 4508.8,42503 4508.8,42503"];
	layer6_moe_comm_from_expert4 -> layer6_moe_aggregate	[pos="e,4533.4,42517 3932.5,42594 3932.5,42566 3932.5,42517 3932.5,42517 3932.5,42517 4523.4,42517 4523.4,42517"];
	layer6_moe_comm_from_expert5 -> layer6_moe_aggregate	[pos="e,4548.7,42532 4214,42591 4214,42567 4214,42532 4214,42532 4214,42532 4538.7,42532 4538.7,42532"];
	layer6_moe_comm_from_expert6 -> layer6_moe_aggregate	[pos="e,4473.6,42496 4473.6,42596 4473.6,42596 4473.6,42506 4473.6,42506"];
	layer6_moe_comm_from_expert7 -> layer6_moe_aggregate	[pos="e,4621,42548 4621,42583 4621,42583 4621,42558 4621,42558"];
	layer6_moe_comm_from_expert8 -> layer6_moe_aggregate	[pos="e,4892.4,42548 4892.4,42583 4892.4,42583 4892.4,42558 4892.4,42558"];
	layer6_moe_comm_from_expert9 -> layer6_moe_aggregate	[pos="e,4968,42534 5183.5,42584 5183.5,42562 5183.5,42534 5183.5,42534 5183.5,42534 4978,42534 4978,42534"];
	layer6_moe_comm_from_expert10 -> layer6_moe_aggregate	[pos="e,4954.8,42521 5515.1,42584 5515.1,42557 5515.1,42521 5515.1,42521 5515.1,42521 4964.8,42521 4964.8,42521"];
	layer6_moe_comm_from_expert11 -> layer6_moe_aggregate	[pos="e,4941.5,42508 5861.6,42584 5861.6,42553 5861.6,42508 5861.6,42508 5861.6,42508 4951.5,42508 4951.5,42508"];
	layer6_moe_comm_from_expert12 -> layer6_moe_aggregate	[pos="e,4927.9,42495 6212.6,42584 6212.6,42549 6212.6,42495 6212.6,42495 6212.6,42495 4937.9,42495 4937.9,42495"];
	layer6_moe_comm_from_expert13 -> layer6_moe_aggregate	[pos="e,4914.5,42482 6566.1,42584 6566.1,42546 6566.1,42482 6566.1,42482 6566.1,42482 4924.5,42482 4924.5,42482"];
	layer6_moe_comm_from_expert14 -> layer6_moe_aggregate	[pos="e,4901.1,42469 6921.1,42584 6921.1,42542 6921.1,42469 6921.1,42469 6921.1,42469 4911.1,42469 4911.1,42469"];
	layer6_moe_comm_from_expert15 -> layer6_moe_aggregate	[pos="e,4887.7,42456 7276.1,42584 7276.1,42539 7276.1,42456 7276.1,42456 7276.1,42456 4897.7,42456 4897.7,42456"];
	layer7_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L7\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4720,42268",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer7_moe_mha -> layer7_moe_gate	[pos="e,4720,42320 4720,42356 4720,42356 4720,42330 4720,42330"];
	layer7_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L7\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4720,42128",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer7_moe_gate -> layer7_moe_split	[pos="e,4720,42180 4720,42216 4720,42216 4720,42190 4720,42190"];
	layer7_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2272,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer7_moe_split -> layer7_moe_comm_to_expert0	[pos="e,2296.5,42039 4553.9,42164 4006.9,42164 2296.5,42164 2296.5,42164 2296.5,42164 2296.5,42049 2296.5,42049",
		style=dashed];
	layer7_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2544,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer7_moe_split -> layer7_moe_comm_to_expert1	[pos="e,2568.5,42039 4538.9,42149 4020.6,42149 2568.5,42149 2568.5,42149 2568.5,42149 2568.5,42049 2568.5,42049",
		style=dashed];
	layer7_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2927,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer7_moe_split -> layer7_moe_comm_to_expert2	[pos="e,3011,42022 4525.2,42135 4077,42135 3011,42135 3011,42135 3011,42135 3011,42032 3011,42032",
		style=dashed];
	layer7_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3347,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer7_moe_split -> layer7_moe_comm_to_expert3	[pos="e,3413.5,42030 4510.1,42120 4140.8,42120 3413.5,42120 3413.5,42120 3413.5,42120 3413.5,42040 3413.5,42040",
		style=dashed];
	layer7_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3619,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer7_moe_split -> layer7_moe_comm_to_expert4	[pos="e,3616.8,42040 4495.1,42105 4172.5,42105 3616.8,42105 3616.8,42105 3616.8,42105 3616.8,42050 3616.8,42050",
		style=dashed];
	layer7_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="4002,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer7_moe_split -> layer7_moe_comm_to_expert5	[pos="e,4078,42027 4480,42090 4297.7,42090 4078,42090 4078,42090 4078,42090 4078,42037 4078,42037",
		style=dashed];
	layer7_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4274,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer7_moe_split -> layer7_moe_comm_to_expert6	[pos="e,4364.5,42010 4479.7,42128 4479.7,42124 4479.7,42010 4479.7,42010 4479.7,42010 4374.5,42010 4374.5,42010",
		style=dashed];
	layer7_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4584,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer7_moe_split -> layer7_moe_comm_to_expert7	[pos="e,4584,42040 4584,42075 4584,42075 4584,42050 4584,42050",
		style=dashed];
	layer7_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4856,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer7_moe_split -> layer7_moe_comm_to_expert8	[pos="e,4856,42040 4856,42075 4856,42075 4856,42050 4856,42050",
		style=dashed];
	layer7_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="5165,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer7_moe_split -> layer7_moe_comm_to_expert9	[pos="e,5074.3,42010 4960.3,42128 4960.3,42124 4960.3,42010 4960.3,42010 4960.3,42010 5064.3,42010 5064.3,42010",
		style=dashed];
	layer7_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5497,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer7_moe_split -> layer7_moe_comm_to_expert10	[pos="e,5421.1,42028 4884.8,42090 5092.1,42090 5421.1,42090 5421.1,42090 5421.1,42090 5421.1,42038 5421.1,42038",
		style=dashed];
	layer7_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5843,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer7_moe_split -> layer7_moe_comm_to_expert11	[pos="e,5767.6,42028 4899.5,42105 5198.9,42105 5767.6,42105 5767.6,42105 5767.6,42105 5767.6,42038 5767.6,42038",
		style=dashed];
	layer7_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="6194,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer7_moe_split -> layer7_moe_comm_to_expert12	[pos="e,6118.6,42028 4914.5,42120 5298.8,42120 6118.6,42120 6118.6,42120 6118.6,42120 6118.6,42038 6118.6,42038",
		style=dashed];
	layer7_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6547,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer7_moe_split -> layer7_moe_comm_to_expert13	[pos="e,6472.1,42028 4929.6,42135 5394.7,42135 6472.1,42135 6472.1,42135 6472.1,42135 6472.1,42038 6472.1,42038",
		style=dashed];
	layer7_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6902,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer7_moe_split -> layer7_moe_comm_to_expert14	[pos="e,6827.1,42028 4943.5,42149 5485.8,42149 6827.1,42149 6827.1,42149 6827.1,42149 6827.1,42038 6827.1,42038",
		style=dashed];
	layer7_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7257,42011",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer7_moe_split -> layer7_moe_comm_to_expert15	[pos="e,7182.1,42028 4958.6,42164 5576.7,42164 7182.1,42164 7182.1,42164 7182.1,42164 7182.1,42038 7182.1,42038",
		style=dashed];
	layer7_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L7\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=S_\
expert0, hidden_dim=7168]",
		pos="2125,41920",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer7_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2198,41829",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer7_moe_expert0 -> layer7_moe_comm_from_expert0	[pos="e,2198,41858 2198,41893 2198,41893 2198,41868 2198,41868"];
	layer7_moe_comm_to_expert0 -> layer7_moe_expert0	[pos="e,2235.2,41946 2235.2,41984 2235.2,41984 2235.2,41956 2235.2,41956"];
	layer7_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L7\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=S_\
expert1, hidden_dim=7168]",
		pos="2471,41920",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer7_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2581,41829",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer7_moe_expert1 -> layer7_moe_comm_from_expert1	[pos="e,2562.7,41857 2562.7,41893 2562.7,41893 2562.7,41867 2562.7,41867"];
	layer7_moe_comm_to_expert1 -> layer7_moe_expert1	[pos="e,2544,41946 2544,41982 2544,41982 2544,41956 2544,41956"];
	layer7_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L7\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=S_\
expert2, hidden_dim=7168]",
		pos="2817,41920",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer7_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="3001,41829",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer7_moe_expert2 -> layer7_moe_comm_from_expert2	[pos="e,2945.7,41852 2945.7,41893 2945.7,41893 2945.7,41862 2945.7,41862"];
	layer7_moe_comm_to_expert2 -> layer7_moe_expert2	[pos="e,2908.7,41946 2908.7,41982 2908.7,41982 2908.7,41956 2908.7,41956"];
	layer7_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L7\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=S_\
expert3, hidden_dim=7168]",
		pos="3163,41920",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer7_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3347,41829",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer7_moe_expert3 -> layer7_moe_comm_from_expert3	[pos="e,3291.7,41852 3291.7,41893 3291.7,41893 3291.7,41862 3291.7,41862"];
	layer7_moe_comm_to_expert3 -> layer7_moe_expert3	[pos="e,3291.7,41946 3291.7,41987 3291.7,41987 3291.7,41956 3291.7,41956"];
	layer7_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L7\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=S_\
expert4, hidden_dim=7168]",
		pos="3509,41920",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer7_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3619,41829",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer7_moe_expert4 -> layer7_moe_comm_from_expert4	[pos="e,3600.7,41857 3600.7,41893 3600.7,41893 3600.7,41867 3600.7,41867"];
	layer7_moe_comm_to_expert4 -> layer7_moe_expert4	[pos="e,3600.7,41946 3600.7,41982 3600.7,41982 3600.7,41956 3600.7,41956"];
	layer7_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L7\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=S_\
expert5, hidden_dim=7168]",
		pos="3855,41920",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer7_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3966,41829",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer7_moe_expert5 -> layer7_moe_comm_from_expert5	[pos="e,3947.2,41857 3947.2,41893 3947.2,41893 3947.2,41867 3947.2,41867"];
	layer7_moe_comm_to_expert5 -> layer7_moe_expert5	[pos="e,3965.2,41946 3965.2,41984 3965.2,41984 3965.2,41956 3965.2,41956"];
	layer7_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L7\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=S_\
expert6, hidden_dim=7168]",
		pos="4201,41920",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer7_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4312,41829",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer7_moe_expert6 -> layer7_moe_comm_from_expert6	[pos="e,4293.2,41857 4293.2,41893 4293.2,41893 4293.2,41867 4293.2,41867"];
	layer7_moe_comm_to_expert6 -> layer7_moe_expert6	[pos="e,4274,41946 4274,41982 4274,41982 4274,41956 4274,41956"];
	layer7_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L7\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=S_\
expert7, hidden_dim=7168]",
		pos="4547,41920",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer7_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4584,41829",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer7_moe_expert7 -> layer7_moe_comm_from_expert7	[pos="e,4584,41858 4584,41893 4584,41893 4584,41868 4584,41868"];
	layer7_moe_comm_to_expert7 -> layer7_moe_expert7	[pos="e,4584,41946 4584,41982 4584,41982 4584,41956 4584,41956"];
	layer7_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L7\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=S_\
expert8, hidden_dim=7168]",
		pos="4893,41920",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer7_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4856,41829",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer7_moe_expert8 -> layer7_moe_comm_from_expert8	[pos="e,4856,41858 4856,41893 4856,41893 4856,41868 4856,41868"];
	layer7_moe_comm_to_expert8 -> layer7_moe_expert8	[pos="e,4856,41946 4856,41982 4856,41982 4856,41956 4856,41956"];
	layer7_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L7\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=S_\
expert9, hidden_dim=7168]",
		pos="5239,41920",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer7_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="5165,41829",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer7_moe_expert9 -> layer7_moe_comm_from_expert9	[pos="e,5165.3,41858 5165.3,41893 5165.3,41893 5165.3,41868 5165.3,41868"];
	layer7_moe_comm_to_expert9 -> layer7_moe_expert9	[pos="e,5165.3,41946 5165.3,41982 5165.3,41982 5165.3,41956 5165.3,41956"];
	layer7_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L7\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5590,41920",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer7_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5497,41829",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer7_moe_expert10 -> layer7_moe_comm_from_expert10	[pos="e,5506.4,41858 5506.4,41893 5506.4,41893 5506.4,41868 5506.4,41868"];
	layer7_moe_comm_to_expert10 -> layer7_moe_expert10	[pos="e,5506,41946 5506,41982 5506,41982 5506,41956 5506,41956"];
	layer7_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L7\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5946,41920",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer7_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5844,41829",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer7_moe_expert11 -> layer7_moe_comm_from_expert11	[pos="e,5857.9,41858 5857.9,41893 5857.9,41893 5857.9,41868 5857.9,41868"];
	layer7_moe_comm_to_expert11 -> layer7_moe_expert11	[pos="e,5857,41946 5857,41982 5857,41982 5857,41956 5857,41956"];
	layer7_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L7\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6302,41920",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer7_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="6195,41829",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer7_moe_expert12 -> layer7_moe_comm_from_expert12	[pos="e,6211.4,41858 6211.4,41893 6211.4,41893 6211.4,41868 6211.4,41868"];
	layer7_moe_comm_to_expert12 -> layer7_moe_expert12	[pos="e,6210.5,41946 6210.5,41982 6210.5,41982 6210.5,41956 6210.5,41956"];
	layer7_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L7\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6658,41920",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer7_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6549,41829",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer7_moe_expert13 -> layer7_moe_comm_from_expert13	[pos="e,6566.4,41858 6566.4,41893 6566.4,41893 6566.4,41868 6566.4,41868"];
	layer7_moe_comm_to_expert13 -> layer7_moe_expert13	[pos="e,6565,41946 6565,41982 6565,41982 6565,41956 6565,41956"];
	layer7_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L7\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="7014,41920",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer7_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6904,41829",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer7_moe_expert14 -> layer7_moe_comm_from_expert14	[pos="e,6921.9,41857 6921.9,41893 6921.9,41893 6921.9,41867 6921.9,41867"];
	layer7_moe_comm_to_expert14 -> layer7_moe_expert14	[pos="e,6920.5,41946 6920.5,41982 6920.5,41982 6920.5,41956 6920.5,41956"];
	layer7_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L7\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7370,41920",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer7_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7259,41829",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer7_moe_expert15 -> layer7_moe_comm_from_expert15	[pos="e,7277.4,41857 7277.4,41893 7277.4,41893 7277.4,41867 7277.4,41867"];
	layer7_moe_comm_to_expert15 -> layer7_moe_expert15	[pos="e,7276,41946 7276,41982 7276,41982 7276,41956 7276,41956"];
	layer7_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L7\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4683,41712",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer8_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L8\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4683,41598",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer7_moe_aggregate -> layer8_moe_mha	[pos="e,4683,41624 4683,41659 4683,41659 4683,41634 4683,41634"];
	layer7_moe_comm_from_expert0 -> layer7_moe_aggregate	[pos="e,4435.5,41674 2216.5,41800 2216.5,41755 2216.5,41674 2216.5,41674 2216.5,41674 4425.5,41674 4425.5,41674"];
	layer7_moe_comm_from_expert1 -> layer7_moe_aggregate	[pos="e,4450.8,41689 2654.5,41812 2654.5,41774 2654.5,41689 2654.5,41689 2654.5,41689 4440.8,41689 4440.8,41689"];
	layer7_moe_comm_from_expert2 -> layer7_moe_aggregate	[pos="e,4466.2,41704 3037.5,41802 3037.5,41765 3037.5,41704 3037.5,41704 3037.5,41704 4456.2,41704 4456.2,41704"];
	layer7_moe_comm_from_expert3 -> layer7_moe_aggregate	[pos="e,4481.7,41719 3376.5,41801 3376.5,41769 3376.5,41719 3376.5,41719 3376.5,41719 4471.7,41719 4471.7,41719"];
	layer7_moe_comm_from_expert4 -> layer7_moe_aggregate	[pos="e,4496.4,41733 3691,41811 3691,41783 3691,41733 3691,41733 3691,41733 4486.4,41733 4486.4,41733"];
	layer7_moe_comm_from_expert5 -> layer7_moe_aggregate	[pos="e,4511.8,41748 4038,41811 4038,41787 4038,41748 4038,41748 4038,41748 4501.8,41748 4501.8,41748"];
	layer7_moe_comm_from_expert6 -> layer7_moe_aggregate	[pos="e,4457.1,41712 4402.7,41828 4432,41828 4457.1,41828 4457.1,41828 4457.1,41828 4457.1,41722 4457.1,41722"];
	layer7_moe_comm_from_expert7 -> layer7_moe_aggregate	[pos="e,4584,41764 4584,41799 4584,41799 4584,41774 4584,41774"];
	layer7_moe_comm_from_expert8 -> layer7_moe_aggregate	[pos="e,4855.4,41764 4855.4,41799 4855.4,41799 4855.4,41774 4855.4,41774"];
	layer7_moe_comm_from_expert9 -> layer7_moe_aggregate	[pos="e,4931,41750 5146.5,41800 5146.5,41778 5146.5,41750 5146.5,41750 5146.5,41750 4941,41750 4941,41750"];
	layer7_moe_comm_from_expert10 -> layer7_moe_aggregate	[pos="e,4917.8,41737 5478.1,41800 5478.1,41773 5478.1,41737 5478.1,41737 5478.1,41737 4927.8,41737 4927.8,41737"];
	layer7_moe_comm_from_expert11 -> layer7_moe_aggregate	[pos="e,4904.5,41724 5824.6,41800 5824.6,41769 5824.6,41724 5824.6,41724 5824.6,41724 4914.5,41724 4914.5,41724"];
	layer7_moe_comm_from_expert12 -> layer7_moe_aggregate	[pos="e,4890.9,41711 6175.6,41800 6175.6,41765 6175.6,41711 6175.6,41711 6175.6,41711 4900.9,41711 4900.9,41711"];
	layer7_moe_comm_from_expert13 -> layer7_moe_aggregate	[pos="e,4877.5,41698 6529.1,41800 6529.1,41762 6529.1,41698 6529.1,41698 6529.1,41698 4887.5,41698 4887.5,41698"];
	layer7_moe_comm_from_expert14 -> layer7_moe_aggregate	[pos="e,4864.1,41685 6884.1,41800 6884.1,41758 6884.1,41685 6884.1,41685 6884.1,41685 4874.1,41685 4874.1,41685"];
	layer7_moe_comm_from_expert15 -> layer7_moe_aggregate	[pos="e,4850.7,41672 7239.1,41800 7239.1,41755 7239.1,41672 7239.1,41672 7239.1,41672 4860.7,41672 4860.7,41672"];
	layer8_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L8\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4683,41484",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer8_moe_mha -> layer8_moe_gate	[pos="e,4683,41536 4683,41572 4683,41572 4683,41546 4683,41546"];
	layer8_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L8\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4683,41344",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer8_moe_gate -> layer8_moe_split	[pos="e,4683,41396 4683,41432 4683,41432 4683,41406 4683,41406"];
	layer8_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2235,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer8_moe_split -> layer8_moe_comm_to_expert0	[pos="e,2316.3,41240 4517,41380 3978.8,41380 2316.3,41380 2316.3,41380 2316.3,41380 2316.3,41250 2316.3,41250",
		style=dashed];
	layer8_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2728,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer8_moe_split -> layer8_moe_comm_to_expert1	[pos="e,2745,41255 4502,41365 4020.5,41365 2745,41365 2745,41365 2745,41365 2745,41265 2745,41265",
		style=dashed];
	layer8_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="3074,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer8_moe_split -> layer8_moe_comm_to_expert2	[pos="e,3128,41250 4488,41351 4070.6,41351 3128,41351 3128,41351 3128,41351 3128,41260 3128,41260",
		style=dashed];
	layer8_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3346,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer8_moe_split -> layer8_moe_comm_to_expert3	[pos="e,3316.5,41254 4473.2,41336 4090.2,41336 3316.5,41336 3316.5,41336 3316.5,41336 3316.5,41264 3316.5,41264",
		style=dashed];
	layer8_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3582,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer8_moe_split -> layer8_moe_comm_to_expert4	[pos="e,3600.5,41255 4458,41321 4140.9,41321 3600.5,41321 3600.5,41321 3600.5,41321 3600.5,41265 3600.5,41265",
		style=dashed];
	layer8_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3929,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer8_moe_split -> layer8_moe_comm_to_expert5	[pos="e,3947.5,41255 4443.2,41306 4228.6,41306 3947.5,41306 3947.5,41306 3947.5,41306 3947.5,41265 3947.5,41265",
		style=dashed];
	layer8_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4275,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer8_moe_split -> layer8_moe_comm_to_expert6	[pos="e,4365.7,41226 4442.7,41344 4442.7,41340 4442.7,41226 4442.7,41226 4442.7,41226 4375.7,41226 4375.7,41226",
		style=dashed];
	layer8_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4547,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer8_moe_split -> layer8_moe_comm_to_expert7	[pos="e,4547,41256 4547,41291 4547,41291 4547,41266 4547,41266",
		style=dashed];
	layer8_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4819,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer8_moe_split -> layer8_moe_comm_to_expert8	[pos="e,4819,41256 4819,41291 4819,41291 4819,41266 4819,41266",
		style=dashed];
	layer8_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="5128,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer8_moe_split -> layer8_moe_comm_to_expert9	[pos="e,5037.3,41226 4923.3,41344 4923.3,41340 4923.3,41226 4923.3,41226 4923.3,41226 5027.3,41226 5027.3,41226",
		style=dashed];
	layer8_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5460,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer8_moe_split -> layer8_moe_comm_to_expert10	[pos="e,5384.1,41244 4847.4,41306 5054.6,41306 5384.1,41306 5384.1,41306 5384.1,41306 5384.1,41254 5384.1,41254",
		style=dashed];
	layer8_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5806,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer8_moe_split -> layer8_moe_comm_to_expert11	[pos="e,5730.6,41244 4862.5,41321 5161.9,41321 5730.6,41321 5730.6,41321 5730.6,41321 5730.6,41254 5730.6,41254",
		style=dashed];
	layer8_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="6157,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer8_moe_split -> layer8_moe_comm_to_expert12	[pos="e,6081.6,41244 4877.5,41336 5261.8,41336 6081.6,41336 6081.6,41336 6081.6,41336 6081.6,41254 6081.6,41254",
		style=dashed];
	layer8_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6510,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer8_moe_split -> layer8_moe_comm_to_expert13	[pos="e,6435.1,41244 4892.6,41351 5357.7,41351 6435.1,41351 6435.1,41351 6435.1,41351 6435.1,41254 6435.1,41254",
		style=dashed];
	layer8_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6865,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer8_moe_split -> layer8_moe_comm_to_expert14	[pos="e,6790.1,41245 4906.5,41365 5448.8,41365 6790.1,41365 6790.1,41365 6790.1,41365 6790.1,41255 6790.1,41255",
		style=dashed];
	layer8_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7220,41227",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer8_moe_split -> layer8_moe_comm_to_expert15	[pos="e,7145.1,41244 4921.3,41380 5539.2,41380 7145.1,41380 7145.1,41380 7145.1,41380 7145.1,41254 7145.1,41254",
		style=dashed];
	layer8_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L8\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=S_\
expert0, hidden_dim=7168]",
		pos="2088,41136",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer8_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2235,41045",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer8_moe_expert0 -> layer8_moe_comm_from_expert0	[pos="e,2198.2,41071 2198.2,41109 2198.2,41109 2198.2,41081 2198.2,41081"];
	layer8_moe_comm_to_expert0 -> layer8_moe_expert0	[pos="e,2198.2,41162 2198.2,41200 2198.2,41200 2198.2,41172 2198.2,41172"];
	layer8_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L8\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=S_\
expert1, hidden_dim=7168]",
		pos="2434,41136",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer8_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2728,41045",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer8_moe_expert1 -> layer8_moe_comm_from_expert1	[pos="e,2637.3,41044 2588.5,41110 2588.5,41083 2588.5,41044 2588.5,41044 2588.5,41044 2627.3,41044 2627.3,41044"];
	layer8_moe_comm_to_expert1 -> layer8_moe_expert1	[pos="e,2544.2,41162 2637.5,41226 2591.1,41226 2544.2,41226 2544.2,41226 2544.2,41226 2544.2,41172 2544.2,41172"];
	layer8_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L8\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=S_\
expert2, hidden_dim=7168]",
		pos="2780,41136",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer8_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="3074,41045",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer8_moe_expert2 -> layer8_moe_comm_from_expert2	[pos="e,2983.3,41044 2934.5,41110 2934.5,41083 2934.5,41044 2934.5,41044 2934.5,41044 2973.3,41044 2973.3,41044"];
	layer8_moe_comm_to_expert2 -> layer8_moe_expert2	[pos="e,2927.2,41162 2983.1,41226 2953.1,41226 2927.2,41226 2927.2,41226 2927.2,41226 2927.2,41172 2927.2,41172"];
	layer8_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L8\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=S_\
expert3, hidden_dim=7168]",
		pos="3126,41136",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer8_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3346,41045",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer8_moe_expert3 -> layer8_moe_comm_from_expert3	[pos="e,3272.7,41062 3272.7,41109 3272.7,41109 3272.7,41072 3272.7,41072"];
	layer8_moe_comm_to_expert3 -> layer8_moe_expert3	[pos="e,3272.7,41162 3272.7,41210 3272.7,41210 3272.7,41172 3272.7,41172"];
	layer8_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L8\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=S_\
expert4, hidden_dim=7168]",
		pos="3472,41136",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer8_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3582,41045",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer8_moe_expert4 -> layer8_moe_comm_from_expert4	[pos="e,3563.7,41073 3563.7,41109 3563.7,41109 3563.7,41083 3563.7,41083"];
	layer8_moe_comm_to_expert4 -> layer8_moe_expert4	[pos="e,3563.7,41162 3563.7,41198 3563.7,41198 3563.7,41172 3563.7,41172"];
	layer8_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L8\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=S_\
expert5, hidden_dim=7168]",
		pos="3818,41136",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer8_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3965,41045",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer8_moe_expert5 -> layer8_moe_comm_from_expert5	[pos="e,3928.2,41071 3928.2,41109 3928.2,41109 3928.2,41081 3928.2,41081"];
	layer8_moe_comm_to_expert5 -> layer8_moe_expert5	[pos="e,3910.2,41162 3910.2,41198 3910.2,41198 3910.2,41172 3910.2,41172"];
	layer8_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L8\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=S_\
expert6, hidden_dim=7168]",
		pos="4164,41136",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer8_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4237,41045",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer8_moe_expert6 -> layer8_moe_comm_from_expert6	[pos="e,4237,41074 4237,41109 4237,41109 4237,41084 4237,41084"];
	layer8_moe_comm_to_expert6 -> layer8_moe_expert6	[pos="e,4256.2,41162 4256.2,41198 4256.2,41198 4256.2,41172 4256.2,41172"];
	layer8_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L8\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=S_\
expert7, hidden_dim=7168]",
		pos="4510,41136",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer8_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4547,41045",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer8_moe_expert7 -> layer8_moe_comm_from_expert7	[pos="e,4547,41074 4547,41109 4547,41109 4547,41084 4547,41084"];
	layer8_moe_comm_to_expert7 -> layer8_moe_expert7	[pos="e,4547,41162 4547,41198 4547,41198 4547,41172 4547,41172"];
	layer8_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L8\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=S_\
expert8, hidden_dim=7168]",
		pos="4856,41136",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer8_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4819,41045",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer8_moe_expert8 -> layer8_moe_comm_from_expert8	[pos="e,4819,41074 4819,41109 4819,41109 4819,41084 4819,41084"];
	layer8_moe_comm_to_expert8 -> layer8_moe_expert8	[pos="e,4819,41162 4819,41198 4819,41198 4819,41172 4819,41172"];
	layer8_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L8\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=S_\
expert9, hidden_dim=7168]",
		pos="5202,41136",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer8_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="5128,41045",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer8_moe_expert9 -> layer8_moe_comm_from_expert9	[pos="e,5128.3,41074 5128.3,41109 5128.3,41109 5128.3,41084 5128.3,41084"];
	layer8_moe_comm_to_expert9 -> layer8_moe_expert9	[pos="e,5128.3,41162 5128.3,41198 5128.3,41198 5128.3,41172 5128.3,41172"];
	layer8_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L8\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5553,41136",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer8_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5460,41045",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer8_moe_expert10 -> layer8_moe_comm_from_expert10	[pos="e,5469.4,41074 5469.4,41109 5469.4,41109 5469.4,41084 5469.4,41084"];
	layer8_moe_comm_to_expert10 -> layer8_moe_expert10	[pos="e,5469,41162 5469,41198 5469,41198 5469,41172 5469,41172"];
	layer8_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L8\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5909,41136",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer8_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5807,41045",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer8_moe_expert11 -> layer8_moe_comm_from_expert11	[pos="e,5820.9,41074 5820.9,41109 5820.9,41109 5820.9,41084 5820.9,41084"];
	layer8_moe_comm_to_expert11 -> layer8_moe_expert11	[pos="e,5820,41162 5820,41198 5820,41198 5820,41172 5820,41172"];
	layer8_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L8\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6265,41136",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer8_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="6158,41045",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer8_moe_expert12 -> layer8_moe_comm_from_expert12	[pos="e,6174.4,41074 6174.4,41109 6174.4,41109 6174.4,41084 6174.4,41084"];
	layer8_moe_comm_to_expert12 -> layer8_moe_expert12	[pos="e,6173.5,41162 6173.5,41198 6173.5,41198 6173.5,41172 6173.5,41172"];
	layer8_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L8\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6621,41136",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer8_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6512,41045",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer8_moe_expert13 -> layer8_moe_comm_from_expert13	[pos="e,6529.4,41074 6529.4,41109 6529.4,41109 6529.4,41084 6529.4,41084"];
	layer8_moe_comm_to_expert13 -> layer8_moe_expert13	[pos="e,6528,41162 6528,41198 6528,41198 6528,41172 6528,41172"];
	layer8_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L8\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6977,41136",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer8_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6867,41045",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer8_moe_expert14 -> layer8_moe_comm_from_expert14	[pos="e,6884.9,41073 6884.9,41109 6884.9,41109 6884.9,41083 6884.9,41083"];
	layer8_moe_comm_to_expert14 -> layer8_moe_expert14	[pos="e,6883.5,41162 6883.5,41198 6883.5,41198 6883.5,41172 6883.5,41172"];
	layer8_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L8\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7333,41136",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer8_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7222,41045",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer8_moe_expert15 -> layer8_moe_comm_from_expert15	[pos="e,7240.4,41073 7240.4,41109 7240.4,41109 7240.4,41083 7240.4,41083"];
	layer8_moe_comm_to_expert15 -> layer8_moe_expert15	[pos="e,7239,41162 7239,41198 7239,41198 7239,41172 7239,41172"];
	layer8_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L8\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4646,40928",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer9_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L9\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4646,40814",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer8_moe_aggregate -> layer9_moe_mha	[pos="e,4646,40840 4646,40875 4646,40875 4646,40850 4646,40850"];
	layer8_moe_comm_from_expert0 -> layer8_moe_aggregate	[pos="e,4398.5,40890 2307,41027 2307,40986 2307,40890 2307,40890 2307,40890 4388.5,40890 4388.5,40890"];
	layer8_moe_comm_from_expert1 -> layer8_moe_aggregate	[pos="e,4413.6,40905 2800,41027 2800,40989 2800,40905 2800,40905 2800,40905 4403.6,40905 4403.6,40905"];
	layer8_moe_comm_from_expert2 -> layer8_moe_aggregate	[pos="e,4429.5,40920 3146,41027 3146,40993 3146,40920 3146,40920 3146,40920 4419.5,40920 4419.5,40920"];
	layer8_moe_comm_from_expert3 -> layer8_moe_aggregate	[pos="e,4444.9,40935 3418,41027 3418,40996 3418,40935 3418,40935 3418,40935 4434.9,40935 4434.9,40935"];
	layer8_moe_comm_from_expert4 -> layer8_moe_aggregate	[pos="e,4460.3,40950 3654,41027 3654,40999 3654,40950 3654,40950 3654,40950 4450.3,40950 4450.3,40950"];
	layer8_moe_comm_from_expert5 -> layer8_moe_aggregate	[pos="e,4474.7,40964 4019,41021 4019,40998 4019,40964 4019,40964 4019,40964 4464.7,40964 4464.7,40964"];
	layer8_moe_comm_from_expert6 -> layer8_moe_aggregate	[pos="e,4420.1,40928 4327.7,41044 4373.8,41044 4420.1,41044 4420.1,41044 4420.1,41044 4420.1,40938 4420.1,40938"];
	layer8_moe_comm_from_expert7 -> layer8_moe_aggregate	[pos="e,4547,40980 4547,41016 4547,41016 4547,40990 4547,40990"];
	layer8_moe_comm_from_expert8 -> layer8_moe_aggregate	[pos="e,4818.4,40980 4818.4,41016 4818.4,41016 4818.4,40990 4818.4,40990"];
	layer8_moe_comm_from_expert9 -> layer8_moe_aggregate	[pos="e,4894,40966 5109.5,41016 5109.5,40994 5109.5,40966 5109.5,40966 5109.5,40966 4904,40966 4904,40966"];
	layer8_moe_comm_from_expert10 -> layer8_moe_aggregate	[pos="e,4880.5,40953 5441.1,41016 5441.1,40989 5441.1,40953 5441.1,40953 5441.1,40953 4890.5,40953 4890.5,40953"];
	layer8_moe_comm_from_expert11 -> layer8_moe_aggregate	[pos="e,4867.1,40940 5787.6,41016 5787.6,40985 5787.6,40940 5787.6,40940 5787.6,40940 4877.1,40940 4877.1,40940"];
	layer8_moe_comm_from_expert12 -> layer8_moe_aggregate	[pos="e,4853.9,40927 6138.6,41016 6138.6,40981 6138.6,40927 6138.6,40927 6138.6,40927 4863.9,40927 4863.9,40927"];
	layer8_moe_comm_from_expert13 -> layer8_moe_aggregate	[pos="e,4840.5,40914 6492.1,41016 6492.1,40978 6492.1,40914 6492.1,40914 6492.1,40914 4850.5,40914 4850.5,40914"];
	layer8_moe_comm_from_expert14 -> layer8_moe_aggregate	[pos="e,4827.1,40901 6847.1,41016 6847.1,40974 6847.1,40901 6847.1,40901 6847.1,40901 4837.1,40901 4837.1,40901"];
	layer8_moe_comm_from_expert15 -> layer8_moe_aggregate	[pos="e,4813.7,40888 7202.1,41016 7202.1,40971 7202.1,40888 7202.1,40888 7202.1,40888 4823.7,40888 4823.7,40888"];
	layer9_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L9\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4646,40700",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer9_moe_mha -> layer9_moe_gate	[pos="e,4646,40752 4646,40788 4646,40788 4646,40762 4646,40762"];
	layer9_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L9\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4646,40560",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer9_moe_gate -> layer9_moe_split	[pos="e,4646,40612 4646,40648 4646,40648 4646,40622 4646,40622"];
	layer9_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2198,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer9_moe_split -> layer9_moe_comm_to_expert0	[pos="e,2216.5,40471 4480,40596 3932.1,40596 2216.5,40596 2216.5,40596 2216.5,40596 2216.5,40481 2216.5,40481",
		style=dashed];
	layer9_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2691,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer9_moe_split -> layer9_moe_comm_to_expert1	[pos="e,2709.5,40471 4466,40582 3985.6,40582 2709.5,40582 2709.5,40582 2709.5,40582 2709.5,40481 2709.5,40481",
		style=dashed];
	layer9_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="3037,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer9_moe_split -> layer9_moe_comm_to_expert2	[pos="e,3055.5,40471 4451,40567 4026.3,40567 3055.5,40567 3055.5,40567 3055.5,40567 3055.5,40481 3055.5,40481",
		style=dashed];
	layer9_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3309,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer9_moe_split -> layer9_moe_comm_to_expert3	[pos="e,3327.5,40471 4436,40552 4063.9,40552 3327.5,40552 3327.5,40552 3327.5,40552 3327.5,40481 3327.5,40481",
		style=dashed];
	layer9_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3545,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer9_moe_split -> layer9_moe_comm_to_expert4	[pos="e,3563.5,40471 4421,40537 4103.9,40537 3563.5,40537 3563.5,40537 3563.5,40537 3563.5,40481 3563.5,40481",
		style=dashed];
	layer9_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3892,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer9_moe_split -> layer9_moe_comm_to_expert5	[pos="e,3928.5,40470 4406.1,40522 4197.5,40522 3928.5,40522 3928.5,40522 3928.5,40522 3928.5,40480 3928.5,40480",
		style=dashed];
	layer9_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4238,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer9_moe_split -> layer9_moe_comm_to_expert6	[pos="e,4328.7,40442 4405.7,40560 4405.7,40556 4405.7,40442 4405.7,40442 4405.7,40442 4338.7,40442 4338.7,40442",
		style=dashed];
	layer9_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4510,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer9_moe_split -> layer9_moe_comm_to_expert7	[pos="e,4510,40472 4510,40507 4510,40507 4510,40482 4510,40482",
		style=dashed];
	layer9_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4782,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer9_moe_split -> layer9_moe_comm_to_expert8	[pos="e,4782,40472 4782,40507 4782,40507 4782,40482 4782,40482",
		style=dashed];
	layer9_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="5091,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer9_moe_split -> layer9_moe_comm_to_expert9	[pos="e,5000.3,40442 4886.3,40560 4886.3,40556 4886.3,40442 4886.3,40442 4886.3,40442 4990.3,40442 4990.3,40442",
		style=dashed];
	layer9_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5423,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer9_moe_split -> layer9_moe_comm_to_expert10	[pos="e,5347.1,40460 4810.4,40522 5017.6,40522 5347.1,40522 5347.1,40522 5347.1,40522 5347.1,40470 5347.1,40470",
		style=dashed];
	layer9_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5769,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer9_moe_split -> layer9_moe_comm_to_expert11	[pos="e,5693.6,40460 4825.5,40537 5124.9,40537 5693.6,40537 5693.6,40537 5693.6,40537 5693.6,40470 5693.6,40470",
		style=dashed];
	layer9_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="6120,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer9_moe_split -> layer9_moe_comm_to_expert12	[pos="e,6044.6,40460 4840.5,40552 5224.8,40552 6044.6,40552 6044.6,40552 6044.6,40552 6044.6,40470 6044.6,40470",
		style=dashed];
	layer9_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6473,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer9_moe_split -> layer9_moe_comm_to_expert13	[pos="e,6398.1,40460 4855.6,40567 5320.7,40567 6398.1,40567 6398.1,40567 6398.1,40567 6398.1,40470 6398.1,40470",
		style=dashed];
	layer9_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6828,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer9_moe_split -> layer9_moe_comm_to_expert14	[pos="e,6753.1,40460 4870.5,40582 5413.4,40582 6753.1,40582 6753.1,40582 6753.1,40582 6753.1,40470 6753.1,40470",
		style=dashed];
	layer9_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7183,40443",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer9_moe_split -> layer9_moe_comm_to_expert15	[pos="e,7108.1,40460 4884.3,40596 5502.2,40596 7108.1,40596 7108.1,40596 7108.1,40596 7108.1,40470 7108.1,40470",
		style=dashed];
	layer9_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L9\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=S_\
expert0, hidden_dim=7168]",
		pos="2051,40352",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer9_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2198,40261",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer9_moe_expert0 -> layer9_moe_comm_from_expert0	[pos="e,2161.2,40287 2161.2,40325 2161.2,40325 2161.2,40297 2161.2,40297"];
	layer9_moe_comm_to_expert0 -> layer9_moe_expert0	[pos="e,2161.2,40378 2161.2,40416 2161.2,40416 2161.2,40388 2161.2,40388"];
	layer9_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L9\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=S_\
expert1, hidden_dim=7168]",
		pos="2397,40352",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer9_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2470,40261",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer9_moe_expert1 -> layer9_moe_comm_from_expert1	[pos="e,2470,40290 2470,40325 2470,40325 2470,40300 2470,40300"];
	layer9_moe_comm_to_expert1 -> layer9_moe_expert1	[pos="e,2443.3,40378 2600.5,40442 2529.7,40442 2443.3,40442 2443.3,40442 2443.3,40442 2443.3,40388 2443.3,40388"];
	layer9_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L9\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=S_\
expert2, hidden_dim=7168]",
		pos="2743,40352",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer9_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2835,40261",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer9_moe_expert2 -> layer9_moe_comm_from_expert2	[pos="e,2825.7,40290 2825.7,40325 2825.7,40325 2825.7,40300 2825.7,40300"];
	layer9_moe_comm_to_expert2 -> layer9_moe_expert2	[pos="e,2862.8,40378 2946.3,40442 2904,40442 2862.8,40442 2862.8,40442 2862.8,40442 2862.8,40388 2862.8,40388"];
	layer9_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L9\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=S_\
expert3, hidden_dim=7168]",
		pos="3089,40352",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer9_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3163,40261",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer9_moe_expert3 -> layer9_moe_comm_from_expert3	[pos="e,3162.7,40290 3162.7,40325 3162.7,40325 3162.7,40300 3162.7,40300"];
	layer9_moe_comm_to_expert3 -> layer9_moe_expert3	[pos="e,3235.7,40378 3235.7,40426 3235.7,40426 3235.7,40388 3235.7,40388"];
	layer9_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L9\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=S_\
expert4, hidden_dim=7168]",
		pos="3435,40352",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer9_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3656,40261",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer9_moe_expert4 -> layer9_moe_comm_from_expert4	[pos="e,3582.2,40278 3582.2,40325 3582.2,40325 3582.2,40288 3582.2,40288"];
	layer9_moe_comm_to_expert4 -> layer9_moe_expert4	[pos="e,3526.7,40378 3526.7,40414 3526.7,40414 3526.7,40388 3526.7,40388"];
	layer9_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L9\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=S_\
expert5, hidden_dim=7168]",
		pos="3781,40352",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer9_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="4002,40261",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer9_moe_expert5 -> layer9_moe_comm_from_expert5	[pos="e,3928.2,40278 3928.2,40325 3928.2,40325 3928.2,40288 3928.2,40288"];
	layer9_moe_comm_to_expert5 -> layer9_moe_expert5	[pos="e,3873.2,40378 3873.2,40414 3873.2,40414 3873.2,40388 3873.2,40388"];
	layer9_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L9\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=S_\
expert6, hidden_dim=7168]",
		pos="4127,40352",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer9_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4274,40261",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer9_moe_expert6 -> layer9_moe_comm_from_expert6	[pos="e,4237.2,40287 4237.2,40325 4237.2,40325 4237.2,40297 4237.2,40297"];
	layer9_moe_comm_to_expert6 -> layer9_moe_expert6	[pos="e,4219.2,40378 4219.2,40414 4219.2,40414 4219.2,40388 4219.2,40388"];
	layer9_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L9\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=S_\
expert7, hidden_dim=7168]",
		pos="4473,40352",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer9_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4510,40261",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer9_moe_expert7 -> layer9_moe_comm_from_expert7	[pos="e,4510,40290 4510,40325 4510,40325 4510,40300 4510,40300"];
	layer9_moe_comm_to_expert7 -> layer9_moe_expert7	[pos="e,4510,40378 4510,40414 4510,40414 4510,40388 4510,40388"];
	layer9_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L9\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=S_\
expert8, hidden_dim=7168]",
		pos="4819,40352",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer9_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4782,40261",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer9_moe_expert8 -> layer9_moe_comm_from_expert8	[pos="e,4782,40290 4782,40325 4782,40325 4782,40300 4782,40300"];
	layer9_moe_comm_to_expert8 -> layer9_moe_expert8	[pos="e,4782,40378 4782,40414 4782,40414 4782,40388 4782,40388"];
	layer9_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L9\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=S_\
expert9, hidden_dim=7168]",
		pos="5165,40352",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer9_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="5091,40261",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer9_moe_expert9 -> layer9_moe_comm_from_expert9	[pos="e,5091.3,40290 5091.3,40325 5091.3,40325 5091.3,40300 5091.3,40300"];
	layer9_moe_comm_to_expert9 -> layer9_moe_expert9	[pos="e,5091.3,40378 5091.3,40414 5091.3,40414 5091.3,40388 5091.3,40388"];
	layer9_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L9\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5516,40352",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer9_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5423,40261",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer9_moe_expert10 -> layer9_moe_comm_from_expert10	[pos="e,5432.4,40290 5432.4,40325 5432.4,40325 5432.4,40300 5432.4,40300"];
	layer9_moe_comm_to_expert10 -> layer9_moe_expert10	[pos="e,5432,40378 5432,40414 5432,40414 5432,40388 5432,40388"];
	layer9_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L9\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5872,40352",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer9_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5770,40261",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer9_moe_expert11 -> layer9_moe_comm_from_expert11	[pos="e,5783.9,40290 5783.9,40325 5783.9,40325 5783.9,40300 5783.9,40300"];
	layer9_moe_comm_to_expert11 -> layer9_moe_expert11	[pos="e,5783,40378 5783,40414 5783,40414 5783,40388 5783,40388"];
	layer9_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L9\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6228,40352",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer9_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="6121,40261",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer9_moe_expert12 -> layer9_moe_comm_from_expert12	[pos="e,6137.4,40290 6137.4,40325 6137.4,40325 6137.4,40300 6137.4,40300"];
	layer9_moe_comm_to_expert12 -> layer9_moe_expert12	[pos="e,6136.5,40378 6136.5,40414 6136.5,40414 6136.5,40388 6136.5,40388"];
	layer9_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L9\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6584,40352",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer9_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6475,40261",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer9_moe_expert13 -> layer9_moe_comm_from_expert13	[pos="e,6492.4,40290 6492.4,40325 6492.4,40325 6492.4,40300 6492.4,40300"];
	layer9_moe_comm_to_expert13 -> layer9_moe_expert13	[pos="e,6491,40378 6491,40414 6491,40414 6491,40388 6491,40388"];
	layer9_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L9\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6940,40352",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer9_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6830,40261",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer9_moe_expert14 -> layer9_moe_comm_from_expert14	[pos="e,6847.9,40289 6847.9,40325 6847.9,40325 6847.9,40299 6847.9,40299"];
	layer9_moe_comm_to_expert14 -> layer9_moe_expert14	[pos="e,6846.5,40378 6846.5,40414 6846.5,40414 6846.5,40388 6846.5,40388"];
	layer9_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L9\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7296,40352",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer9_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7185,40261",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer9_moe_expert15 -> layer9_moe_comm_from_expert15	[pos="e,7203.4,40289 7203.4,40325 7203.4,40325 7203.4,40299 7203.4,40299"];
	layer9_moe_comm_to_expert15 -> layer9_moe_expert15	[pos="e,7202,40378 7202,40414 7202,40414 7202,40388 7202,40388"];
	layer9_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L9\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4609,40144",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer10_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L10\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4609,40030",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer9_moe_aggregate -> layer10_moe_mha	[pos="e,4609,40056 4609,40091 4609,40091 4609,40066 4609,40066"];
	layer9_moe_comm_from_expert0 -> layer9_moe_aggregate	[pos="e,4361.4,40106 2279.5,40248 2279.5,40211 2279.5,40106 2279.5,40106 2279.5,40106 4351.4,40106 4351.4,40106"];
	layer9_moe_comm_from_expert1 -> layer9_moe_aggregate	[pos="e,4377,40121 2551.5,40248 2551.5,40213 2551.5,40121 2551.5,40121 2551.5,40121 4367,40121 4367,40121"];
	layer9_moe_comm_from_expert2 -> layer9_moe_aggregate	[pos="e,4392.4,40136 2916,40247 2916,40215 2916,40136 2916,40136 2916,40136 4382.4,40136 4382.4,40136"];
	layer9_moe_comm_from_expert3 -> layer9_moe_aggregate	[pos="e,4407.9,40151 3236,40244 3236,40213 3236,40151 3236,40151 3236,40151 4397.9,40151 4397.9,40151"];
	layer9_moe_comm_from_expert4 -> layer9_moe_aggregate	[pos="e,4423.2,40166 3685.5,40233 3685.5,40205 3685.5,40166 3685.5,40166 3685.5,40166 4413.2,40166 4413.2,40166"];
	layer9_moe_comm_from_expert5 -> layer9_moe_aggregate	[pos="e,4437.7,40180 4082.5,40247 4082.5,40224 4082.5,40180 4082.5,40180 4082.5,40180 4427.7,40180 4427.7,40180"];
	layer9_moe_comm_from_expert6 -> layer9_moe_aggregate	[pos="e,4355.6,40144 4355.6,40248 4355.6,40248 4355.6,40154 4355.6,40154"];
	layer9_moe_comm_from_expert7 -> layer9_moe_aggregate	[pos="e,4510,40196 4510,40232 4510,40232 4510,40206 4510,40206"];
	layer9_moe_comm_from_expert8 -> layer9_moe_aggregate	[pos="e,4781.4,40196 4781.4,40232 4781.4,40232 4781.4,40206 4781.4,40206"];
	layer9_moe_comm_from_expert9 -> layer9_moe_aggregate	[pos="e,4857,40182 5072.5,40232 5072.5,40210 5072.5,40182 5072.5,40182 5072.5,40182 4867,40182 4867,40182"];
	layer9_moe_comm_from_expert10 -> layer9_moe_aggregate	[pos="e,4843.5,40169 5404.1,40232 5404.1,40205 5404.1,40169 5404.1,40169 5404.1,40169 4853.5,40169 4853.5,40169"];
	layer9_moe_comm_from_expert11 -> layer9_moe_aggregate	[pos="e,4830.1,40156 5750.6,40232 5750.6,40201 5750.6,40156 5750.6,40156 5750.6,40156 4840.1,40156 4840.1,40156"];
	layer9_moe_comm_from_expert12 -> layer9_moe_aggregate	[pos="e,4816.9,40143 6101.6,40232 6101.6,40197 6101.6,40143 6101.6,40143 6101.6,40143 4826.9,40143 4826.9,40143"];
	layer9_moe_comm_from_expert13 -> layer9_moe_aggregate	[pos="e,4803.5,40130 6455.1,40232 6455.1,40194 6455.1,40130 6455.1,40130 6455.1,40130 4813.5,40130 4813.5,40130"];
	layer9_moe_comm_from_expert14 -> layer9_moe_aggregate	[pos="e,4790.1,40117 6810.1,40232 6810.1,40190 6810.1,40117 6810.1,40117 6810.1,40117 4800.1,40117 4800.1,40117"];
	layer9_moe_comm_from_expert15 -> layer9_moe_aggregate	[pos="e,4776.7,40104 7165.1,40232 7165.1,40187 7165.1,40104 7165.1,40104 7165.1,40104 4786.7,40104 4786.7,40104"];
	layer10_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L10\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4609,39916",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer10_moe_mha -> layer10_moe_gate	[pos="e,4609,39968 4609,40004 4609,40004 4609,39978 4609,39978"];
	layer10_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L10\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4609,39776",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer10_moe_gate -> layer10_moe_split	[pos="e,4609,39828 4609,39864 4609,39864 4609,39838 4609,39838"];
	layer10_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2180,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer10_moe_split -> layer10_moe_comm_to_expert0	[pos="e,2189,39688 4443.1,39812 3896.9,39812 2189,39812 2189,39812 2189,39812 2189,39698 2189,39698",
		style=dashed];
	layer10_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2452,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer10_moe_split -> layer10_moe_comm_to_expert1	[pos="e,2461,39688 4429.1,39798 3912.4,39798 2461,39798 2461,39798 2461,39798 2461,39698 2461,39698",
		style=dashed];
	layer10_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2816,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer10_moe_split -> layer10_moe_comm_to_expert2	[pos="e,2825.5,39688 4413.9,39783 3951.1,39783 2825.5,39783 2825.5,39783 2825.5,39783 2825.5,39698 2825.5,39698",
		style=dashed];
	layer10_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3309,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer10_moe_split -> layer10_moe_comm_to_expert3	[pos="e,3335.3,39687 4399,39768 4037.3,39768 3335.3,39768 3335.3,39768 3335.3,39768 3335.3,39697 3335.3,39697",
		style=dashed];
	layer10_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3655,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer10_moe_split -> layer10_moe_comm_to_expert4	[pos="e,3625.5,39686 4384,39753 4093.7,39753 3625.5,39753 3625.5,39753 3625.5,39753 3625.5,39696 3625.5,39696",
		style=dashed];
	layer10_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3927,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer10_moe_split -> layer10_moe_comm_to_expert5	[pos="e,3964.5,39686 4369,39738 4185.8,39738 3964.5,39738 3964.5,39738 3964.5,39738 3964.5,39696 3964.5,39696",
		style=dashed];
	layer10_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4163,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer10_moe_split -> layer10_moe_comm_to_expert6	[pos="e,4253.5,39658 4368.7,39776 4368.7,39772 4368.7,39658 4368.7,39658 4368.7,39658 4263.5,39658 4263.5,39658",
		style=dashed];
	layer10_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4473,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer10_moe_split -> layer10_moe_comm_to_expert7	[pos="e,4473,39688 4473,39723 4473,39723 4473,39698 4473,39698",
		style=dashed];
	layer10_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4745,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer10_moe_split -> layer10_moe_comm_to_expert8	[pos="e,4745,39688 4745,39723 4745,39723 4745,39698 4745,39698",
		style=dashed];
	layer10_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="5054,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer10_moe_split -> layer10_moe_comm_to_expert9	[pos="e,4963.3,39658 4849.3,39776 4849.3,39772 4849.3,39658 4849.3,39658 4849.3,39658 4953.3,39658 4953.3,39658",
		style=dashed];
	layer10_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5386,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer10_moe_split -> layer10_moe_comm_to_expert10	[pos="e,5310.1,39676 4773.4,39738 4980.6,39738 5310.1,39738 5310.1,39738 5310.1,39738 5310.1,39686 5310.1,39686",
		style=dashed];
	layer10_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5732,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer10_moe_split -> layer10_moe_comm_to_expert11	[pos="e,5656.6,39677 4788.5,39753 5087.9,39753 5656.6,39753 5656.6,39753 5656.6,39753 5656.6,39687 5656.6,39687",
		style=dashed];
	layer10_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="6083,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer10_moe_split -> layer10_moe_comm_to_expert12	[pos="e,6007.6,39676 4803.5,39768 5187.8,39768 6007.6,39768 6007.6,39768 6007.6,39768 6007.6,39686 6007.6,39686",
		style=dashed];
	layer10_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6436,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer10_moe_split -> layer10_moe_comm_to_expert13	[pos="e,6361.1,39676 4818.6,39783 5283.7,39783 6361.1,39783 6361.1,39783 6361.1,39783 6361.1,39686 6361.1,39686",
		style=dashed];
	layer10_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6791,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer10_moe_split -> layer10_moe_comm_to_expert14	[pos="e,6716.1,39676 4833.5,39798 5376.4,39798 6716.1,39798 6716.1,39798 6716.1,39798 6716.1,39686 6716.1,39686",
		style=dashed];
	layer10_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7146,39659",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer10_moe_split -> layer10_moe_comm_to_expert15	[pos="e,7071.1,39676 4847.3,39812 5465.2,39812 7071.1,39812 7071.1,39812 7071.1,39812 7071.1,39686 7071.1,39686",
		style=dashed];
	layer10_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L10\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="2014,39568",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer10_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2180,39477",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer10_moe_expert0 -> layer10_moe_comm_from_expert0	[pos="e,2133.7,39502 2133.7,39541 2133.7,39541 2133.7,39512 2133.7,39512"];
	layer10_moe_comm_to_expert0 -> layer10_moe_expert0	[pos="e,2133.7,39594 2133.7,39633 2133.7,39633 2133.7,39604 2133.7,39604"];
	layer10_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L10\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="2360,39568",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer10_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2452,39477",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer10_moe_expert1 -> layer10_moe_comm_from_expert1	[pos="e,2442.7,39506 2442.7,39541 2442.7,39541 2442.7,39516 2442.7,39516"];
	layer10_moe_comm_to_expert1 -> layer10_moe_expert1	[pos="e,2442.7,39594 2442.7,39630 2442.7,39630 2442.7,39604 2442.7,39604"];
	layer10_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L10\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2706,39568",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer10_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2816,39477",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer10_moe_expert2 -> layer10_moe_comm_from_expert2	[pos="e,2797.7,39505 2797.7,39541 2797.7,39541 2797.7,39515 2797.7,39515"];
	layer10_moe_comm_to_expert2 -> layer10_moe_expert2	[pos="e,2797.7,39594 2797.7,39630 2797.7,39630 2797.7,39604 2797.7,39604"];
	layer10_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L10\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="3052,39568",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer10_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3309,39477",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer10_moe_expert3 -> layer10_moe_comm_from_expert3	[pos="e,3228.8,39490 3216.1,39559 3224.1,39559 3228.8,39559 3228.8,39559 3228.8,39559 3228.8,39500 3228.8,39500"];
	layer10_moe_comm_to_expert3 -> layer10_moe_expert3	[pos="e,3216.3,39576 3223.7,39649 3223.7,39627 3223.7,39576 3223.7,39576 3223.7,39576 3222.9,39576 3222.9,39576"];
	layer10_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L10\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3398,39568",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer10_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3655,39477",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer10_moe_expert4 -> layer10_moe_comm_from_expert4	[pos="e,3574.8,39490 3562.1,39559 3570.1,39559 3574.8,39559 3574.8,39559 3574.8,39559 3574.8,39500 3574.8,39500"];
	layer10_moe_comm_to_expert4 -> layer10_moe_expert4	[pos="e,3562.3,39576 3569.7,39649 3569.7,39627 3569.7,39576 3569.7,39576 3569.7,39576 3568.9,39576 3568.9,39576"];
	layer10_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L10\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3744,39568",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer10_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3927,39477",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer10_moe_expert5 -> layer10_moe_comm_from_expert5	[pos="e,3872.2,39500 3872.2,39541 3872.2,39541 3872.2,39510 3872.2,39510"];
	layer10_moe_comm_to_expert5 -> layer10_moe_expert5	[pos="e,3872.2,39594 3872.2,39635 3872.2,39635 3872.2,39604 3872.2,39604"];
	layer10_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L10\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="4090,39568",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer10_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4163,39477",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer10_moe_expert6 -> layer10_moe_comm_from_expert6	[pos="e,4163,39506 4163,39541 4163,39541 4163,39516 4163,39516"];
	layer10_moe_comm_to_expert6 -> layer10_moe_expert6	[pos="e,4163,39594 4163,39630 4163,39630 4163,39604 4163,39604"];
	layer10_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L10\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4436,39568",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer10_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4473,39477",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer10_moe_expert7 -> layer10_moe_comm_from_expert7	[pos="e,4473,39506 4473,39541 4473,39541 4473,39516 4473,39516"];
	layer10_moe_comm_to_expert7 -> layer10_moe_expert7	[pos="e,4473,39594 4473,39630 4473,39630 4473,39604 4473,39604"];
	layer10_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L10\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4782,39568",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer10_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4745,39477",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer10_moe_expert8 -> layer10_moe_comm_from_expert8	[pos="e,4745,39506 4745,39541 4745,39541 4745,39516 4745,39516"];
	layer10_moe_comm_to_expert8 -> layer10_moe_expert8	[pos="e,4745,39594 4745,39630 4745,39630 4745,39604 4745,39604"];
	layer10_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L10\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="5128,39568",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer10_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="5054,39477",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer10_moe_expert9 -> layer10_moe_comm_from_expert9	[pos="e,5054.3,39506 5054.3,39541 5054.3,39541 5054.3,39516 5054.3,39516"];
	layer10_moe_comm_to_expert9 -> layer10_moe_expert9	[pos="e,5054.3,39594 5054.3,39630 5054.3,39630 5054.3,39604 5054.3,39604"];
	layer10_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L10\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5479,39568",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer10_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5386,39477",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer10_moe_expert10 -> layer10_moe_comm_from_expert10	[pos="e,5395.4,39506 5395.4,39541 5395.4,39541 5395.4,39516 5395.4,39516"];
	layer10_moe_comm_to_expert10 -> layer10_moe_expert10	[pos="e,5395,39594 5395,39630 5395,39630 5395,39604 5395,39604"];
	layer10_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L10\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5835,39568",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer10_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5733,39477",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer10_moe_expert11 -> layer10_moe_comm_from_expert11	[pos="e,5746.9,39506 5746.9,39541 5746.9,39541 5746.9,39516 5746.9,39516"];
	layer10_moe_comm_to_expert11 -> layer10_moe_expert11	[pos="e,5746,39594 5746,39630 5746,39630 5746,39604 5746,39604"];
	layer10_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L10\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6191,39568",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer10_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="6084,39477",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer10_moe_expert12 -> layer10_moe_comm_from_expert12	[pos="e,6100.4,39506 6100.4,39541 6100.4,39541 6100.4,39516 6100.4,39516"];
	layer10_moe_comm_to_expert12 -> layer10_moe_expert12	[pos="e,6099.5,39594 6099.5,39630 6099.5,39630 6099.5,39604 6099.5,39604"];
	layer10_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L10\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6547,39568",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer10_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6438,39477",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer10_moe_expert13 -> layer10_moe_comm_from_expert13	[pos="e,6455.4,39506 6455.4,39541 6455.4,39541 6455.4,39516 6455.4,39516"];
	layer10_moe_comm_to_expert13 -> layer10_moe_expert13	[pos="e,6454,39594 6454,39630 6454,39630 6454,39604 6454,39604"];
	layer10_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L10\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6903,39568",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer10_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6793,39477",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer10_moe_expert14 -> layer10_moe_comm_from_expert14	[pos="e,6810.9,39505 6810.9,39541 6810.9,39541 6810.9,39515 6810.9,39515"];
	layer10_moe_comm_to_expert14 -> layer10_moe_expert14	[pos="e,6809.5,39594 6809.5,39630 6809.5,39630 6809.5,39604 6809.5,39604"];
	layer10_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L10\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7259,39568",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer10_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7148,39477",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer10_moe_expert15 -> layer10_moe_comm_from_expert15	[pos="e,7166.4,39505 7166.4,39541 7166.4,39541 7166.4,39515 7166.4,39515"];
	layer10_moe_comm_to_expert15 -> layer10_moe_expert15	[pos="e,7165,39594 7165,39630 7165,39630 7165,39604 7165,39604"];
	layer10_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L10\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4572,39360",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer11_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L11\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4572,39246",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer10_moe_aggregate -> layer11_moe_mha	[pos="e,4572,39272 4572,39307 4572,39307 4572,39282 4572,39282"];
	layer10_moe_comm_from_expert0 -> layer10_moe_aggregate	[pos="e,4324.5,39322 2214.8,39450 2214.8,39405 2214.8,39322 2214.8,39322 2214.8,39322 4314.5,39322 4314.5,39322"];
	layer10_moe_comm_from_expert1 -> layer10_moe_aggregate	[pos="e,4339.5,39337 2523.8,39459 2523.8,39421 2523.8,39337 2523.8,39337 2523.8,39337 4329.5,39337 4329.5,39337"];
	layer10_moe_comm_from_expert2 -> layer10_moe_aggregate	[pos="e,4355.4,39352 2878.8,39456 2878.8,39420 2878.8,39352 2878.8,39352 2878.8,39352 4345.4,39352 4345.4,39352"];
	layer10_moe_comm_from_expert3 -> layer10_moe_aggregate	[pos="e,4370.9,39367 3392.5,39465 3392.5,39437 3392.5,39367 3392.5,39367 3392.5,39367 4360.9,39367 4360.9,39367"];
	layer10_moe_comm_from_expert4 -> layer10_moe_aggregate	[pos="e,4386.3,39382 3666.5,39448 3666.5,39420 3666.5,39382 3666.5,39382 3666.5,39382 4376.3,39382 4376.3,39382"];
	layer10_moe_comm_from_expert5 -> layer10_moe_aggregate	[pos="e,4400.7,39396 3948,39449 3948,39425 3948,39396 3948,39396 3948,39396 4390.7,39396 4390.7,39396"];
	layer10_moe_comm_from_expert6 -> layer10_moe_aggregate	[pos="e,4346.1,39360 4253.5,39476 4299.6,39476 4346.1,39476 4346.1,39476 4346.1,39476 4346.1,39370 4346.1,39370"];
	layer10_moe_comm_from_expert7 -> layer10_moe_aggregate	[pos="e,4473,39412 4473,39448 4473,39448 4473,39422 4473,39422"];
	layer10_moe_comm_from_expert8 -> layer10_moe_aggregate	[pos="e,4744.4,39412 4744.4,39448 4744.4,39448 4744.4,39422 4744.4,39422"];
	layer10_moe_comm_from_expert9 -> layer10_moe_aggregate	[pos="e,4820,39398 5035.5,39448 5035.5,39426 5035.5,39398 5035.5,39398 5035.5,39398 4830,39398 4830,39398"];
	layer10_moe_comm_from_expert10 -> layer10_moe_aggregate	[pos="e,4806.5,39385 5367.1,39448 5367.1,39421 5367.1,39385 5367.1,39385 5367.1,39385 4816.5,39385 4816.5,39385"];
	layer10_moe_comm_from_expert11 -> layer10_moe_aggregate	[pos="e,4793.1,39372 5713.6,39448 5713.6,39417 5713.6,39372 5713.6,39372 5713.6,39372 4803.1,39372 4803.1,39372"];
	layer10_moe_comm_from_expert12 -> layer10_moe_aggregate	[pos="e,4779.9,39359 6064.6,39448 6064.6,39413 6064.6,39359 6064.6,39359 6064.6,39359 4789.9,39359 4789.9,39359"];
	layer10_moe_comm_from_expert13 -> layer10_moe_aggregate	[pos="e,4766.5,39346 6418.1,39448 6418.1,39410 6418.1,39346 6418.1,39346 6418.1,39346 4776.5,39346 4776.5,39346"];
	layer10_moe_comm_from_expert14 -> layer10_moe_aggregate	[pos="e,4753.1,39333 6773.1,39448 6773.1,39406 6773.1,39333 6773.1,39333 6773.1,39333 4763.1,39333 4763.1,39333"];
	layer10_moe_comm_from_expert15 -> layer10_moe_aggregate	[pos="e,4739.7,39320 7128.1,39448 7128.1,39403 7128.1,39320 7128.1,39320 7128.1,39320 4749.7,39320 4749.7,39320"];
	layer11_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L11\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4572,39132",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer11_moe_mha -> layer11_moe_gate	[pos="e,4572,39184 4572,39220 4572,39220 4572,39194 4572,39194"];
	layer11_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L11\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4572,38992",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer11_moe_gate -> layer11_moe_split	[pos="e,4572,39044 4572,39080 4572,39080 4572,39054 4572,39054"];
	layer11_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2050,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer11_moe_split -> layer11_moe_comm_to_expert0	[pos="e,2115,38895 4406,39028 3854.1,39028 2115,39028 2115,39028 2115,39028 2115,38905 2115,38905",
		style=dashed];
	layer11_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2408,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer11_moe_split -> layer11_moe_comm_to_expert1	[pos="e,2430,38903 4391.7,39014 3875.7,39014 2430,39014 2430,39014 2430,39014 2430,38913 2430,38913",
		style=dashed];
	layer11_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2729,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer11_moe_split -> layer11_moe_comm_to_expert2	[pos="e,2772.5,38900 4376.9,38999 3911,38999 2772.5,38999 2772.5,38999 2772.5,38999 2772.5,38910 2772.5,38910",
		style=dashed];
	layer11_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3295,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer11_moe_split -> layer11_moe_comm_to_expert3	[pos="e,3302,38904 4361.9,38984 4001.1,38984 3302,38984 3302,38984 3302,38984 3302,38914 3302,38914",
		style=dashed];
	layer11_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3678,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer11_moe_split -> layer11_moe_comm_to_expert4	[pos="e,3757,38889 4347.1,38969 4105.9,38969 3757,38969 3757,38969 3757,38969 3757,38899 3757,38899",
		style=dashed];
	layer11_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3969,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer11_moe_split -> layer11_moe_comm_to_expert5	[pos="e,4038.5,38894 4331.8,38954 4190.2,38954 4038.5,38954 4038.5,38954 4038.5,38954 4038.5,38904 4038.5,38904",
		style=dashed];
	layer11_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4214,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer11_moe_split -> layer11_moe_comm_to_expert6	[pos="e,4304.7,38874 4331.7,38992 4331.7,38988 4331.7,38874 4331.7,38874 4331.7,38874 4314.7,38874 4314.7,38874",
		style=dashed];
	layer11_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4436,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer11_moe_split -> layer11_moe_comm_to_expert7	[pos="e,4436,38904 4436,38939 4436,38939 4436,38914 4436,38914",
		style=dashed];
	layer11_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4708,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer11_moe_split -> layer11_moe_comm_to_expert8	[pos="e,4708,38904 4708,38939 4708,38939 4708,38914 4708,38914",
		style=dashed];
	layer11_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="5017,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer11_moe_split -> layer11_moe_comm_to_expert9	[pos="e,4926.3,38874 4812.3,38992 4812.3,38988 4812.3,38874 4812.3,38874 4812.3,38874 4916.3,38874 4916.3,38874",
		style=dashed];
	layer11_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5349,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer11_moe_split -> layer11_moe_comm_to_expert10	[pos="e,5273.1,38892 4736.4,38954 4943.6,38954 5273.1,38954 5273.1,38954 5273.1,38954 5273.1,38902 5273.1,38902",
		style=dashed];
	layer11_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5695,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer11_moe_split -> layer11_moe_comm_to_expert11	[pos="e,5619.6,38893 4751.5,38969 5050.9,38969 5619.6,38969 5619.6,38969 5619.6,38969 5619.6,38903 5619.6,38903",
		style=dashed];
	layer11_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="6046,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer11_moe_split -> layer11_moe_comm_to_expert12	[pos="e,5970.6,38892 4766.5,38984 5150.8,38984 5970.6,38984 5970.6,38984 5970.6,38984 5970.6,38902 5970.6,38902",
		style=dashed];
	layer11_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6399,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer11_moe_split -> layer11_moe_comm_to_expert13	[pos="e,6324.1,38893 4781.6,38999 5246.7,38999 6324.1,38999 6324.1,38999 6324.1,38999 6324.1,38903 6324.1,38903",
		style=dashed];
	layer11_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6754,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer11_moe_split -> layer11_moe_comm_to_expert14	[pos="e,6679.1,38892 4796.5,39014 5339.4,39014 6679.1,39014 6679.1,39014 6679.1,39014 6679.1,38902 6679.1,38902",
		style=dashed];
	layer11_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7109,38875",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer11_moe_split -> layer11_moe_comm_to_expert15	[pos="e,7034.1,38892 4810.3,39028 5428.2,39028 7034.1,39028 7034.1,39028 7034.1,39028 7034.1,38902 7034.1,38902",
		style=dashed];
	layer11_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L11\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1977,38784",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer11_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2050,38693",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer11_moe_expert0 -> layer11_moe_comm_from_expert0	[pos="e,2050,38722 2050,38758 2050,38758 2050,38732 2050,38732"];
	layer11_moe_comm_to_expert0 -> layer11_moe_expert0	[pos="e,2050,38810 2050,38846 2050,38846 2050,38820 2050,38820"];
	layer11_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L11\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="2323,38784",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer11_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2408,38693",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer11_moe_expert1 -> layer11_moe_comm_from_expert1	[pos="e,2402.2,38722 2402.2,38758 2402.2,38758 2402.2,38732 2402.2,38732"];
	layer11_moe_comm_to_expert1 -> layer11_moe_expert1	[pos="e,2402.2,38810 2402.2,38846 2402.2,38846 2402.2,38820 2402.2,38820"];
	layer11_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L11\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2669,38784",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer11_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2729,38693",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer11_moe_expert2 -> layer11_moe_comm_from_expert2	[pos="e,2729,38722 2729,38758 2729,38758 2729,38732 2729,38732"];
	layer11_moe_comm_to_expert2 -> layer11_moe_expert2	[pos="e,2729,38810 2729,38846 2729,38846 2729,38820 2729,38820"];
	layer11_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L11\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="3015,38784",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer11_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3295,38693",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer11_moe_expert3 -> layer11_moe_comm_from_expert3	[pos="e,3204.2,38692 3125.2,38758 3125.2,38731 3125.2,38692 3125.2,38692 3125.2,38692 3194.2,38692 3194.2,38692"];
	layer11_moe_comm_to_expert3 -> layer11_moe_expert3	[pos="e,3042.8,38810 3204.3,38874 3132,38874 3042.8,38874 3042.8,38874 3042.8,38874 3042.8,38820 3042.8,38820"];
	layer11_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L11\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3361,38784",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer11_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3678,38693",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer11_moe_expert4 -> layer11_moe_comm_from_expert4	[pos="e,3587.4,38692 3478.2,38758 3478.2,38731 3478.2,38692 3478.2,38692 3478.2,38692 3577.4,38692 3577.4,38692"];
	layer11_moe_comm_to_expert4 -> layer11_moe_expert4	[pos="e,3462.3,38810 3587.4,38874 3528.4,38874 3462.3,38874 3462.3,38874 3462.3,38874 3462.3,38820 3462.3,38820"];
	layer11_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L11\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3707,38784",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer11_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3969,38693",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer11_moe_expert5 -> layer11_moe_comm_from_expert5	[pos="e,3885.5,38704 3871.2,38775 3880.1,38775 3885.5,38775 3885.5,38775 3885.5,38775 3885.5,38714 3885.5,38714"];
	layer11_moe_comm_to_expert5 -> layer11_moe_expert5	[pos="e,3871,38792 3882,38867 3882,38846 3882,38792 3882,38792 3882,38792 3880.9,38792 3880.9,38792"];
	layer11_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L11\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="4053,38784",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer11_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4214,38693",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer11_moe_expert6 -> layer11_moe_comm_from_expert6	[pos="e,4170.2,38718 4170.2,38758 4170.2,38758 4170.2,38728 4170.2,38728"];
	layer11_moe_comm_to_expert6 -> layer11_moe_expert6	[pos="e,4170.2,38810 4170.2,38849 4170.2,38849 4170.2,38820 4170.2,38820"];
	layer11_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L11\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4399,38784",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer11_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4436,38693",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer11_moe_expert7 -> layer11_moe_comm_from_expert7	[pos="e,4436,38722 4436,38758 4436,38758 4436,38732 4436,38732"];
	layer11_moe_comm_to_expert7 -> layer11_moe_expert7	[pos="e,4436,38810 4436,38846 4436,38846 4436,38820 4436,38820"];
	layer11_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L11\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4745,38784",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer11_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4708,38693",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer11_moe_expert8 -> layer11_moe_comm_from_expert8	[pos="e,4708,38722 4708,38758 4708,38758 4708,38732 4708,38732"];
	layer11_moe_comm_to_expert8 -> layer11_moe_expert8	[pos="e,4708,38810 4708,38846 4708,38846 4708,38820 4708,38820"];
	layer11_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L11\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="5091,38784",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer11_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="5017,38693",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer11_moe_expert9 -> layer11_moe_comm_from_expert9	[pos="e,5017.3,38722 5017.3,38758 5017.3,38758 5017.3,38732 5017.3,38732"];
	layer11_moe_comm_to_expert9 -> layer11_moe_expert9	[pos="e,5017.3,38810 5017.3,38846 5017.3,38846 5017.3,38820 5017.3,38820"];
	layer11_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L11\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5442,38784",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer11_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5349,38693",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer11_moe_expert10 -> layer11_moe_comm_from_expert10	[pos="e,5358.4,38722 5358.4,38758 5358.4,38758 5358.4,38732 5358.4,38732"];
	layer11_moe_comm_to_expert10 -> layer11_moe_expert10	[pos="e,5358,38810 5358,38846 5358,38846 5358,38820 5358,38820"];
	layer11_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L11\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5798,38784",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer11_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5696,38693",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer11_moe_expert11 -> layer11_moe_comm_from_expert11	[pos="e,5709.9,38722 5709.9,38758 5709.9,38758 5709.9,38732 5709.9,38732"];
	layer11_moe_comm_to_expert11 -> layer11_moe_expert11	[pos="e,5709,38810 5709,38846 5709,38846 5709,38820 5709,38820"];
	layer11_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L11\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6154,38784",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer11_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="6047,38693",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer11_moe_expert12 -> layer11_moe_comm_from_expert12	[pos="e,6063.4,38722 6063.4,38758 6063.4,38758 6063.4,38732 6063.4,38732"];
	layer11_moe_comm_to_expert12 -> layer11_moe_expert12	[pos="e,6062.5,38810 6062.5,38846 6062.5,38846 6062.5,38820 6062.5,38820"];
	layer11_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L11\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6510,38784",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer11_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6401,38693",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer11_moe_expert13 -> layer11_moe_comm_from_expert13	[pos="e,6418.4,38722 6418.4,38758 6418.4,38758 6418.4,38732 6418.4,38732"];
	layer11_moe_comm_to_expert13 -> layer11_moe_expert13	[pos="e,6417,38810 6417,38846 6417,38846 6417,38820 6417,38820"];
	layer11_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L11\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6866,38784",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer11_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6756,38693",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer11_moe_expert14 -> layer11_moe_comm_from_expert14	[pos="e,6773.9,38721 6773.9,38758 6773.9,38758 6773.9,38731 6773.9,38731"];
	layer11_moe_comm_to_expert14 -> layer11_moe_expert14	[pos="e,6772.5,38810 6772.5,38846 6772.5,38846 6772.5,38820 6772.5,38820"];
	layer11_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L11\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7222,38784",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer11_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7111,38693",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer11_moe_expert15 -> layer11_moe_comm_from_expert15	[pos="e,7129.4,38721 7129.4,38758 7129.4,38758 7129.4,38731 7129.4,38731"];
	layer11_moe_comm_to_expert15 -> layer11_moe_expert15	[pos="e,7128,38810 7128,38846 7128,38846 7128,38820 7128,38820"];
	layer11_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L11\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4535,38576",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer12_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L12\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4535,38462",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer11_moe_aggregate -> layer12_moe_mha	[pos="e,4535,38488 4535,38524 4535,38524 4535,38498 4535,38498"];
	layer11_moe_comm_from_expert0 -> layer11_moe_aggregate	[pos="e,4287.4,38538 2087,38666 2087,38622 2087,38538 2087,38538 2087,38538 4277.4,38538 4277.4,38538"];
	layer11_moe_comm_from_expert1 -> layer11_moe_aggregate	[pos="e,4302.9,38553 2439,38666 2439,38625 2439,38553 2439,38553 2439,38553 4292.9,38553 4292.9,38553"];
	layer11_moe_comm_from_expert2 -> layer11_moe_aggregate	[pos="e,4318.4,38568 2735.5,38664 2735.5,38627 2735.5,38568 2735.5,38568 2735.5,38568 4308.4,38568 4308.4,38568"];
	layer11_moe_comm_from_expert3 -> layer11_moe_aggregate	[pos="e,4333.8,38583 3364.5,38674 3364.5,38643 3364.5,38583 3364.5,38583 3364.5,38583 4323.8,38583 4323.8,38583"];
	layer11_moe_comm_from_expert4 -> layer11_moe_aggregate	[pos="e,4349.2,38598 3729.5,38669 3729.5,38641 3729.5,38598 3729.5,38598 3729.5,38598 4339.2,38598 4339.2,38598"];
	layer11_moe_comm_from_expert5 -> layer11_moe_aggregate	[pos="e,4363.6,38612 4048,38678 4048,38655 4048,38612 4048,38612 4048,38612 4353.6,38612 4353.6,38612"];
	layer11_moe_comm_from_expert6 -> layer11_moe_aggregate	[pos="e,4288.6,38576 4288.6,38676 4288.6,38676 4288.6,38586 4288.6,38586"];
	layer11_moe_comm_from_expert7 -> layer11_moe_aggregate	[pos="e,4436,38628 4436,38664 4436,38664 4436,38638 4436,38638"];
	layer11_moe_comm_from_expert8 -> layer11_moe_aggregate	[pos="e,4707.4,38628 4707.4,38664 4707.4,38664 4707.4,38638 4707.4,38638"];
	layer11_moe_comm_from_expert9 -> layer11_moe_aggregate	[pos="e,4783,38614 4998.5,38664 4998.5,38642 4998.5,38614 4998.5,38614 4998.5,38614 4793,38614 4793,38614"];
	layer11_moe_comm_from_expert10 -> layer11_moe_aggregate	[pos="e,4769.5,38601 5330.1,38664 5330.1,38637 5330.1,38601 5330.1,38601 5330.1,38601 4779.5,38601 4779.5,38601"];
	layer11_moe_comm_from_expert11 -> layer11_moe_aggregate	[pos="e,4756.1,38588 5676.6,38664 5676.6,38633 5676.6,38588 5676.6,38588 5676.6,38588 4766.1,38588 4766.1,38588"];
	layer11_moe_comm_from_expert12 -> layer11_moe_aggregate	[pos="e,4742.9,38575 6027.6,38664 6027.6,38629 6027.6,38575 6027.6,38575 6027.6,38575 4752.9,38575 4752.9,38575"];
	layer11_moe_comm_from_expert13 -> layer11_moe_aggregate	[pos="e,4729.5,38562 6381.1,38664 6381.1,38626 6381.1,38562 6381.1,38562 6381.1,38562 4739.5,38562 4739.5,38562"];
	layer11_moe_comm_from_expert14 -> layer11_moe_aggregate	[pos="e,4716.1,38549 6736.1,38664 6736.1,38623 6736.1,38549 6736.1,38549 6736.1,38549 4726.1,38549 4726.1,38549"];
	layer11_moe_comm_from_expert15 -> layer11_moe_aggregate	[pos="e,4702.7,38536 7091.1,38664 7091.1,38619 7091.1,38536 7091.1,38536 7091.1,38536 4712.7,38536 4712.7,38536"];
	layer12_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L12\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4535,38348",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer12_moe_mha -> layer12_moe_gate	[pos="e,4535,38400 4535,38436 4535,38436 4535,38410 4535,38410"];
	layer12_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L12\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4535,38208",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer12_moe_gate -> layer12_moe_split	[pos="e,4535,38260 4535,38296 4535,38296 4535,38270 4535,38270"];
	layer12_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2124,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer12_moe_split -> layer12_moe_comm_to_expert0	[pos="e,2186.8,38112 4368.9,38244 3833.4,38244 2186.8,38244 2186.8,38244 2186.8,38244 2186.8,38122 2186.8,38122",
		style=dashed];
	layer12_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2470,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer12_moe_split -> layer12_moe_comm_to_expert1	[pos="e,2532.8,38112 4354.7,38230 3862.5,38230 2532.8,38230 2532.8,38230 2532.8,38230 2532.8,38122 2532.8,38122",
		style=dashed];
	layer12_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2742,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer12_moe_split -> layer12_moe_comm_to_expert2	[pos="e,2826,38102 4339.8,38215 3891.4,38215 2826,38215 2826,38215 2826,38215 2826,38112 2826,38112",
		style=dashed];
	layer12_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3162,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer12_moe_split -> layer12_moe_comm_to_expert3	[pos="e,3228.5,38111 4325.1,38200 3955.8,38200 3228.5,38200 3228.5,38200 3228.5,38200 3228.5,38121 3228.5,38121",
		style=dashed];
	layer12_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3434,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer12_moe_split -> layer12_moe_comm_to_expert4	[pos="e,3431.8,38120 4310.1,38185 3987.5,38185 3431.8,38185 3431.8,38185 3431.8,38185 3431.8,38130 3431.8,38130",
		style=dashed];
	layer12_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3781,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer12_moe_split -> layer12_moe_comm_to_expert5	[pos="e,3819.8,38117 4294.8,38170 4087.1,38170 3819.8,38170 3819.8,38170 3819.8,38170 3819.8,38127 3819.8,38127",
		style=dashed];
	layer12_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4127,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer12_moe_split -> layer12_moe_comm_to_expert6	[pos="e,4217.7,38090 4294.7,38208 4294.7,38204 4294.7,38090 4294.7,38090 4294.7,38090 4227.7,38090 4227.7,38090",
		style=dashed];
	layer12_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4399,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer12_moe_split -> layer12_moe_comm_to_expert7	[pos="e,4399,38120 4399,38156 4399,38156 4399,38130 4399,38130",
		style=dashed];
	layer12_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4671,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer12_moe_split -> layer12_moe_comm_to_expert8	[pos="e,4671,38120 4671,38156 4671,38156 4671,38130 4671,38130",
		style=dashed];
	layer12_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4980,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer12_moe_split -> layer12_moe_comm_to_expert9	[pos="e,4889.3,38090 4775.3,38208 4775.3,38204 4775.3,38090 4775.3,38090 4775.3,38090 4879.3,38090 4879.3,38090",
		style=dashed];
	layer12_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5312,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer12_moe_split -> layer12_moe_comm_to_expert10	[pos="e,5236.1,38108 4699.4,38170 4906.6,38170 5236.1,38170 5236.1,38170 5236.1,38170 5236.1,38118 5236.1,38118",
		style=dashed];
	layer12_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5658,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer12_moe_split -> layer12_moe_comm_to_expert11	[pos="e,5582.6,38109 4714.5,38185 5013.9,38185 5582.6,38185 5582.6,38185 5582.6,38185 5582.6,38119 5582.6,38119",
		style=dashed];
	layer12_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="6009,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer12_moe_split -> layer12_moe_comm_to_expert12	[pos="e,5933.6,38108 4729.5,38200 5113.8,38200 5933.6,38200 5933.6,38200 5933.6,38200 5933.6,38118 5933.6,38118",
		style=dashed];
	layer12_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6362,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer12_moe_split -> layer12_moe_comm_to_expert13	[pos="e,6287.1,38109 4744.6,38215 5209.7,38215 6287.1,38215 6287.1,38215 6287.1,38215 6287.1,38119 6287.1,38119",
		style=dashed];
	layer12_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6717,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer12_moe_split -> layer12_moe_comm_to_expert14	[pos="e,6642.1,38108 4759.5,38230 5302.4,38230 6642.1,38230 6642.1,38230 6642.1,38230 6642.1,38118 6642.1,38118",
		style=dashed];
	layer12_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7072,38091",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer12_moe_split -> layer12_moe_comm_to_expert15	[pos="e,6997.1,38108 4773.3,38244 5391.2,38244 6997.1,38244 6997.1,38244 6997.1,38244 6997.1,38118 6997.1,38118",
		style=dashed];
	layer12_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L12\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1940,38000",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer12_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1986,37909",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer12_moe_expert0 -> layer12_moe_comm_from_expert0	[pos="e,1986,37938 1986,37974 1986,37974 1986,37948 1986,37948"];
	layer12_moe_comm_to_expert0 -> layer12_moe_expert0	[pos="e,2068.7,38026 2068.7,38067 2068.7,38067 2068.7,38036 2068.7,38036"];
	layer12_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L12\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="2286,38000",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer12_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2699,37909",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer12_moe_expert1 -> layer12_moe_comm_from_expert1	[pos="e,2608.3,37908 2388.2,37974 2388.2,37947 2388.2,37908 2388.2,37908 2388.2,37908 2598.3,37908 2598.3,37908"];
	layer12_moe_comm_to_expert1 -> layer12_moe_expert1	[pos="e,2414.7,38026 2414.7,38067 2414.7,38067 2414.7,38036 2414.7,38036"];
	layer12_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L12\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2632,38000",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer12_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="3155,37909",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer12_moe_expert2 -> layer12_moe_comm_from_expert2	[pos="e,3064.4,37908 2796.2,37999 2801.8,37999 2805,37999 2805,37999 2805,37999 2805,37908 2805,37908 2805,37908 3054.4,37908 3054.4,37908"];
	layer12_moe_comm_to_expert2 -> layer12_moe_expert2	[pos="e,2723.7,38026 2723.7,38062 2723.7,38062 2723.7,38036 2723.7,38036"];
	layer12_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L12\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2978,38000",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer12_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3483,37909",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer12_moe_expert3 -> layer12_moe_comm_from_expert3	[pos="e,3424.3,37931 3103.2,37974 3103.2,37961 3103.2,37949 3103.2,37949 3103.2,37949 3424.3,37949 3424.3,37949 3424.3,37949 3424.3,37941 \
3424.3,37941"];
	layer12_moe_comm_to_expert3 -> layer12_moe_expert3	[pos="e,3106.7,38026 3106.7,38067 3106.7,38067 3106.7,38036 3106.7,38036"];
	layer12_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L12\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3324,38000",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer12_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3746,37909",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer12_moe_expert4 -> layer12_moe_comm_from_expert4	[pos="e,3744.7,37938 3456.2,37974 3456.2,37967 3456.2,37961 3456.2,37961 3456.2,37961 3744.7,37961 3744.7,37961 3744.7,37961 3744.7,37948 \
3744.7,37948"];
	layer12_moe_comm_to_expert4 -> layer12_moe_expert4	[pos="e,3415.7,38026 3415.7,38062 3415.7,38062 3415.7,38036 3415.7,38036"];
	layer12_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L12\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3670,38000",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer12_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3977,37909",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer12_moe_expert5 -> layer12_moe_comm_from_expert5	[pos="e,3886.5,37908 3834.2,37999 3839.8,37999 3843,37999 3843,37999 3843,37999 3843,37908 3843,37908 3843,37908 3876.5,37908 3876.5,37908"];
	layer12_moe_comm_to_expert5 -> layer12_moe_expert5	[pos="e,3762.2,38026 3762.2,38062 3762.2,38062 3762.2,38036 3762.2,38036"];
	layer12_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L12\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="4016,38000",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer12_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4192,37909",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer12_moe_expert6 -> layer12_moe_comm_from_expert6	[pos="e,4140.7,37933 4140.7,37974 4140.7,37974 4140.7,37943 4140.7,37943"];
	layer12_moe_comm_to_expert6 -> layer12_moe_expert6	[pos="e,4108.2,38026 4108.2,38062 4108.2,38062 4108.2,38036 4108.2,38036"];
	layer12_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L12\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4362,38000",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer12_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4399,37909",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer12_moe_expert7 -> layer12_moe_comm_from_expert7	[pos="e,4399,37938 4399,37974 4399,37974 4399,37948 4399,37948"];
	layer12_moe_comm_to_expert7 -> layer12_moe_expert7	[pos="e,4399,38026 4399,38062 4399,38062 4399,38036 4399,38036"];
	layer12_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L12\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4708,38000",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer12_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4671,37909",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer12_moe_expert8 -> layer12_moe_comm_from_expert8	[pos="e,4671,37938 4671,37974 4671,37974 4671,37948 4671,37948"];
	layer12_moe_comm_to_expert8 -> layer12_moe_expert8	[pos="e,4671,38026 4671,38062 4671,38062 4671,38036 4671,38036"];
	layer12_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L12\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="5054,38000",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer12_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4980,37909",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer12_moe_expert9 -> layer12_moe_comm_from_expert9	[pos="e,4980.3,37938 4980.3,37974 4980.3,37974 4980.3,37948 4980.3,37948"];
	layer12_moe_comm_to_expert9 -> layer12_moe_expert9	[pos="e,4980.3,38026 4980.3,38062 4980.3,38062 4980.3,38036 4980.3,38036"];
	layer12_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L12\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5405,38000",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer12_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5312,37909",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer12_moe_expert10 -> layer12_moe_comm_from_expert10	[pos="e,5321.4,37938 5321.4,37974 5321.4,37974 5321.4,37948 5321.4,37948"];
	layer12_moe_comm_to_expert10 -> layer12_moe_expert10	[pos="e,5321,38026 5321,38062 5321,38062 5321,38036 5321,38036"];
	layer12_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L12\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5761,38000",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer12_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5659,37909",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer12_moe_expert11 -> layer12_moe_comm_from_expert11	[pos="e,5672.9,37938 5672.9,37974 5672.9,37974 5672.9,37948 5672.9,37948"];
	layer12_moe_comm_to_expert11 -> layer12_moe_expert11	[pos="e,5672,38026 5672,38062 5672,38062 5672,38036 5672,38036"];
	layer12_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L12\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6117,38000",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer12_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="6010,37909",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer12_moe_expert12 -> layer12_moe_comm_from_expert12	[pos="e,6026.4,37938 6026.4,37974 6026.4,37974 6026.4,37948 6026.4,37948"];
	layer12_moe_comm_to_expert12 -> layer12_moe_expert12	[pos="e,6025.5,38026 6025.5,38062 6025.5,38062 6025.5,38036 6025.5,38036"];
	layer12_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L12\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6473,38000",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer12_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6364,37909",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer12_moe_expert13 -> layer12_moe_comm_from_expert13	[pos="e,6381.4,37938 6381.4,37974 6381.4,37974 6381.4,37948 6381.4,37948"];
	layer12_moe_comm_to_expert13 -> layer12_moe_expert13	[pos="e,6380,38026 6380,38062 6380,38062 6380,38036 6380,38036"];
	layer12_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L12\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6829,38000",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer12_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6719,37909",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer12_moe_expert14 -> layer12_moe_comm_from_expert14	[pos="e,6736.9,37937 6736.9,37974 6736.9,37974 6736.9,37947 6736.9,37947"];
	layer12_moe_comm_to_expert14 -> layer12_moe_expert14	[pos="e,6735.5,38026 6735.5,38062 6735.5,38062 6735.5,38036 6735.5,38036"];
	layer12_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L12\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7185,38000",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer12_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7074,37909",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer12_moe_expert15 -> layer12_moe_comm_from_expert15	[pos="e,7092.4,37937 7092.4,37974 7092.4,37974 7092.4,37947 7092.4,37947"];
	layer12_moe_comm_to_expert15 -> layer12_moe_expert15	[pos="e,7091,38026 7091,38062 7091,38062 7091,38036 7091,38036"];
	layer12_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L12\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4498,37792",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer13_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L13\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4498,37678",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer12_moe_aggregate -> layer13_moe_mha	[pos="e,4498,37704 4498,37740 4498,37740 4498,37714 4498,37714"];
	layer12_moe_comm_from_expert0 -> layer12_moe_aggregate	[pos="e,4250.3,37754 2071.8,37899 2071.8,37865 2071.8,37754 2071.8,37754 2071.8,37754 4240.3,37754 4240.3,37754"];
	layer12_moe_comm_from_expert1 -> layer12_moe_aggregate	[pos="e,4265.9,37769 2783.3,37898 2783.3,37865 2783.3,37769 2783.3,37769 2783.3,37769 4255.9,37769 4255.9,37769"];
	layer12_moe_comm_from_expert2 -> layer12_moe_aggregate	[pos="e,4281.3,37784 3227,37891 3227,37857 3227,37784 3227,37784 3227,37784 4271.3,37784 4271.3,37784"];
	layer12_moe_comm_from_expert3 -> layer12_moe_aggregate	[pos="e,4296.9,37799 3555,37891 3555,37860 3555,37799 3555,37799 3555,37799 4286.9,37799 4286.9,37799"];
	layer12_moe_comm_from_expert4 -> layer12_moe_aggregate	[pos="e,4312.1,37814 3825.8,37895 3825.8,37868 3825.8,37814 3825.8,37814 3825.8,37814 4302.1,37814 4302.1,37814"];
	layer12_moe_comm_from_expert5 -> layer12_moe_aggregate	[pos="e,4327.7,37829 4047.5,37890 4047.5,37867 4047.5,37829 4047.5,37829 4047.5,37829 4317.7,37829 4317.7,37829"];
	layer12_moe_comm_from_expert6 -> layer12_moe_aggregate	[pos="e,4259.1,37792 4259.1,37889 4259.1,37889 4259.1,37802 4259.1,37802"];
	layer12_moe_comm_from_expert7 -> layer12_moe_aggregate	[pos="e,4399,37844 4399,37880 4399,37880 4399,37854 4399,37854"];
	layer12_moe_comm_from_expert8 -> layer12_moe_aggregate	[pos="e,4670.4,37844 4670.4,37880 4670.4,37880 4670.4,37854 4670.4,37854"];
	layer12_moe_comm_from_expert9 -> layer12_moe_aggregate	[pos="e,4746,37830 4961.5,37880 4961.5,37858 4961.5,37830 4961.5,37830 4961.5,37830 4756,37830 4756,37830"];
	layer12_moe_comm_from_expert10 -> layer12_moe_aggregate	[pos="e,4732.5,37817 5293.1,37880 5293.1,37853 5293.1,37817 5293.1,37817 5293.1,37817 4742.5,37817 4742.5,37817"];
	layer12_moe_comm_from_expert11 -> layer12_moe_aggregate	[pos="e,4719.1,37804 5639.6,37880 5639.6,37849 5639.6,37804 5639.6,37804 5639.6,37804 4729.1,37804 4729.1,37804"];
	layer12_moe_comm_from_expert12 -> layer12_moe_aggregate	[pos="e,4705.9,37791 5990.6,37880 5990.6,37845 5990.6,37791 5990.6,37791 5990.6,37791 4715.9,37791 4715.9,37791"];
	layer12_moe_comm_from_expert13 -> layer12_moe_aggregate	[pos="e,4692.5,37778 6344.1,37880 6344.1,37842 6344.1,37778 6344.1,37778 6344.1,37778 4702.5,37778 4702.5,37778"];
	layer12_moe_comm_from_expert14 -> layer12_moe_aggregate	[pos="e,4679.1,37765 6699.1,37880 6699.1,37839 6699.1,37765 6699.1,37765 6699.1,37765 4689.1,37765 4689.1,37765"];
	layer12_moe_comm_from_expert15 -> layer12_moe_aggregate	[pos="e,4665.7,37752 7054.1,37880 7054.1,37835 7054.1,37752 7054.1,37752 7054.1,37752 4675.7,37752 4675.7,37752"];
	layer13_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L13\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4498,37564",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer13_moe_mha -> layer13_moe_gate	[pos="e,4498,37616 4498,37652 4498,37652 4498,37626 4498,37626"];
	layer13_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L13\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4498,37424",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer13_moe_gate -> layer13_moe_split	[pos="e,4498,37476 4498,37512 4498,37512 4498,37486 4498,37486"];
	layer13_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2417,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer13_moe_split -> layer13_moe_comm_to_expert0	[pos="e,2487.8,37325 4332.6,37461 3851.8,37461 2487.8,37461 2487.8,37461 2487.8,37461 2487.8,37335 2487.8,37335",
		style=dashed];
	layer13_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2662,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer13_moe_split -> layer13_moe_comm_to_expert1	[pos="e,2680.5,37335 4317.9,37446 3858.8,37446 2680.5,37446 2680.5,37446 2680.5,37446 2680.5,37345 2680.5,37345",
		style=dashed];
	layer13_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="3118,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer13_moe_split -> layer13_moe_comm_to_expert2	[pos="e,3136.5,37335 4302.9,37431 3926.5,37431 3136.5,37431 3136.5,37431 3136.5,37431 3136.5,37345 3136.5,37345",
		style=dashed];
	layer13_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3446,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer13_moe_split -> layer13_moe_comm_to_expert3	[pos="e,3464.5,37335 4287.9,37416 3985.8,37416 3464.5,37416 3464.5,37416 3464.5,37416 3464.5,37345 3464.5,37345",
		style=dashed];
	layer13_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3709,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer13_moe_split -> layer13_moe_comm_to_expert4	[pos="e,3727.5,37335 4273.1,37401 4045.6,37401 3727.5,37401 3727.5,37401 3727.5,37401 3727.5,37345 3727.5,37345",
		style=dashed];
	layer13_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3940,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer13_moe_split -> layer13_moe_comm_to_expert5	[pos="e,3958.5,37335 4257.8,37386 4113.9,37386 3958.5,37386 3958.5,37386 3958.5,37386 3958.5,37345 3958.5,37345",
		style=dashed];
	layer13_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4155,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer13_moe_split -> layer13_moe_comm_to_expert6	[pos="e,4245.8,37306 4258.5,37424 4258.5,37420 4258.5,37306 4258.5,37306 4258.5,37306 4255.8,37306 4255.8,37306",
		style=dashed];
	layer13_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4362,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer13_moe_split -> layer13_moe_comm_to_expert7	[pos="e,4362,37336 4362,37372 4362,37372 4362,37346 4362,37346",
		style=dashed];
	layer13_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4634,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer13_moe_split -> layer13_moe_comm_to_expert8	[pos="e,4634,37336 4634,37372 4634,37372 4634,37346 4634,37346",
		style=dashed];
	layer13_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4943,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer13_moe_split -> layer13_moe_comm_to_expert9	[pos="e,4852.3,37306 4738.3,37424 4738.3,37420 4738.3,37306 4738.3,37306 4738.3,37306 4842.3,37306 4842.3,37306",
		style=dashed];
	layer13_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5275,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer13_moe_split -> layer13_moe_comm_to_expert10	[pos="e,5199.1,37324 4662.4,37386 4869.6,37386 5199.1,37386 5199.1,37386 5199.1,37386 5199.1,37334 5199.1,37334",
		style=dashed];
	layer13_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5621,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer13_moe_split -> layer13_moe_comm_to_expert11	[pos="e,5545.6,37325 4677.2,37401 4976.5,37401 5545.6,37401 5545.6,37401 5545.6,37401 5545.6,37335 5545.6,37335",
		style=dashed];
	layer13_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5972,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer13_moe_split -> layer13_moe_comm_to_expert12	[pos="e,5896.6,37324 4692.5,37416 5076.8,37416 5896.6,37416 5896.6,37416 5896.6,37416 5896.6,37334 5896.6,37334",
		style=dashed];
	layer13_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6325,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer13_moe_split -> layer13_moe_comm_to_expert13	[pos="e,6250.1,37325 4707.2,37431 5172,37431 6250.1,37431 6250.1,37431 6250.1,37431 6250.1,37335 6250.1,37335",
		style=dashed];
	layer13_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6680,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer13_moe_split -> layer13_moe_comm_to_expert14	[pos="e,6605.1,37325 4722.5,37446 5265.4,37446 6605.1,37446 6605.1,37446 6605.1,37446 6605.1,37335 6605.1,37335",
		style=dashed];
	layer13_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="7035,37307",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer13_moe_split -> layer13_moe_comm_to_expert15	[pos="e,6960.1,37325 4737.2,37461 5355.7,37461 6960.1,37461 6960.1,37461 6960.1,37461 6960.1,37335 6960.1,37335",
		style=dashed];
	layer13_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L13\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1903,37216",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer13_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2069,37125",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer13_moe_expert0 -> layer13_moe_comm_from_expert0	[pos="e,2022.7,37150 2022.7,37190 2022.7,37190 2022.7,37160 2022.7,37160"];
	layer13_moe_comm_to_expert0 -> layer13_moe_expert0	[pos="e,1981.2,37242 2326.4,37306 2198.8,37306 1981.2,37306 1981.2,37306 1981.2,37306 1981.2,37252 1981.2,37252"];
	layer13_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L13\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="2249,37216",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer13_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2415,37125",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer13_moe_expert1 -> layer13_moe_comm_from_expert1	[pos="e,2368.7,37150 2368.7,37190 2368.7,37190 2368.7,37160 2368.7,37160"];
	layer13_moe_comm_to_expert1 -> layer13_moe_expert1	[pos="e,2369.7,37242 2662,37278 2662,37264 2662,37250 2662,37250 2662,37250 2369.7,37250 2369.7,37250 2369.7,37250 2369.7,37249 2369.7,\
37249"];
	layer13_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L13\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2595,37216",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer13_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2687,37125",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer13_moe_expert2 -> layer13_moe_comm_from_expert2	[pos="e,2677.7,37154 2677.7,37190 2677.7,37190 2677.7,37164 2677.7,37164"];
	layer13_moe_comm_to_expert2 -> layer13_moe_expert2	[pos="e,2759.2,37215 3027.4,37306 2923.7,37306 2768,37306 2768,37306 2768,37306 2768,37215 2768,37215 2768,37215 2767.1,37215 2767.1,37215"];
	layer13_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L13\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2941,37216",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer13_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3015,37125",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer13_moe_expert3 -> layer13_moe_comm_from_expert3	[pos="e,3014.7,37154 3014.7,37190 3014.7,37190 3014.7,37164 3014.7,37164"];
	layer13_moe_comm_to_expert3 -> layer13_moe_expert3	[pos="e,3066.2,37242 3387.3,37285 3387.3,37276 3387.3,37268 3387.3,37268 3387.3,37268 3066.2,37268 3066.2,37268 3066.2,37268 3066.2,37252 \
3066.2,37252"];
	layer13_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L13\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3287,37216",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer13_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3508,37125",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer13_moe_expert4 -> layer13_moe_comm_from_expert4	[pos="e,3434.2,37142 3434.2,37190 3434.2,37190 3434.2,37152 3434.2,37152"];
	layer13_moe_comm_to_expert4 -> layer13_moe_expert4	[pos="e,3419.2,37242 3707.7,37278 3707.7,37268 3707.7,37259 3707.7,37259 3707.7,37259 3419.2,37259 3419.2,37259 3419.2,37259 3419.2,37252 \
3419.2,37252"];
	layer13_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L13\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3633,37216",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer13_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3854,37125",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer13_moe_expert5 -> layer13_moe_comm_from_expert5	[pos="e,3780.2,37142 3780.2,37190 3780.2,37190 3780.2,37152 3780.2,37152"];
	layer13_moe_comm_to_expert5 -> layer13_moe_expert5	[pos="e,3797.1,37215 3849.3,37306 3825.9,37306 3807.3,37306 3807.3,37306 3807.3,37306 3807.3,37215 3807.3,37215 3807.3,37215 3806.2,37215 \
3806.2,37215"];
	layer13_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L13\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3979,37216",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer13_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4126,37125",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer13_moe_expert6 -> layer13_moe_comm_from_expert6	[pos="e,4089.2,37151 4089.2,37190 4089.2,37190 4089.2,37161 4089.2,37161"];
	layer13_moe_comm_to_expert6 -> layer13_moe_expert6	[pos="e,4103.7,37242 4103.7,37283 4103.7,37283 4103.7,37252 4103.7,37252"];
	layer13_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L13\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4325,37216",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer13_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4362,37125",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer13_moe_expert7 -> layer13_moe_comm_from_expert7	[pos="e,4362,37154 4362,37190 4362,37190 4362,37164 4362,37164"];
	layer13_moe_comm_to_expert7 -> layer13_moe_expert7	[pos="e,4362,37242 4362,37278 4362,37278 4362,37252 4362,37252"];
	layer13_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L13\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4671,37216",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer13_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4634,37125",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer13_moe_expert8 -> layer13_moe_comm_from_expert8	[pos="e,4634,37154 4634,37190 4634,37190 4634,37164 4634,37164"];
	layer13_moe_comm_to_expert8 -> layer13_moe_expert8	[pos="e,4634,37242 4634,37278 4634,37278 4634,37252 4634,37252"];
	layer13_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L13\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="5017,37216",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer13_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4943,37125",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer13_moe_expert9 -> layer13_moe_comm_from_expert9	[pos="e,4943.3,37154 4943.3,37190 4943.3,37190 4943.3,37164 4943.3,37164"];
	layer13_moe_comm_to_expert9 -> layer13_moe_expert9	[pos="e,4943.3,37242 4943.3,37278 4943.3,37278 4943.3,37252 4943.3,37252"];
	layer13_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L13\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5368,37216",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer13_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5275,37125",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer13_moe_expert10 -> layer13_moe_comm_from_expert10	[pos="e,5284.4,37154 5284.4,37190 5284.4,37190 5284.4,37164 5284.4,37164"];
	layer13_moe_comm_to_expert10 -> layer13_moe_expert10	[pos="e,5284,37242 5284,37278 5284,37278 5284,37252 5284,37252"];
	layer13_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L13\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5724,37216",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer13_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5622,37125",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer13_moe_expert11 -> layer13_moe_comm_from_expert11	[pos="e,5635.9,37154 5635.9,37190 5635.9,37190 5635.9,37164 5635.9,37164"];
	layer13_moe_comm_to_expert11 -> layer13_moe_expert11	[pos="e,5635,37242 5635,37278 5635,37278 5635,37252 5635,37252"];
	layer13_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L13\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6080,37216",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer13_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5973,37125",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer13_moe_expert12 -> layer13_moe_comm_from_expert12	[pos="e,5989.4,37154 5989.4,37190 5989.4,37190 5989.4,37164 5989.4,37164"];
	layer13_moe_comm_to_expert12 -> layer13_moe_expert12	[pos="e,5988.5,37242 5988.5,37278 5988.5,37278 5988.5,37252 5988.5,37252"];
	layer13_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L13\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6436,37216",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer13_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6327,37125",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer13_moe_expert13 -> layer13_moe_comm_from_expert13	[pos="e,6344.4,37154 6344.4,37190 6344.4,37190 6344.4,37164 6344.4,37164"];
	layer13_moe_comm_to_expert13 -> layer13_moe_expert13	[pos="e,6343,37242 6343,37278 6343,37278 6343,37252 6343,37252"];
	layer13_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L13\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6792,37216",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer13_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6682,37125",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer13_moe_expert14 -> layer13_moe_comm_from_expert14	[pos="e,6699.9,37153 6699.9,37190 6699.9,37190 6699.9,37163 6699.9,37163"];
	layer13_moe_comm_to_expert14 -> layer13_moe_expert14	[pos="e,6698.5,37242 6698.5,37278 6698.5,37278 6698.5,37252 6698.5,37252"];
	layer13_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L13\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7148,37216",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer13_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7037,37125",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer13_moe_expert15 -> layer13_moe_comm_from_expert15	[pos="e,7055.4,37153 7055.4,37190 7055.4,37190 7055.4,37163 7055.4,37163"];
	layer13_moe_comm_to_expert15 -> layer13_moe_expert15	[pos="e,7054,37242 7054,37278 7054,37278 7054,37252 7054,37252"];
	layer13_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L13\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4461,37008",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer14_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L14\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4461,36894",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer13_moe_aggregate -> layer14_moe_mha	[pos="e,4461,36920 4461,36956 4461,36956 4461,36930 4461,36930"];
	layer13_moe_comm_from_expert0 -> layer13_moe_aggregate	[pos="e,4213.2,36970 2103.8,37098 2103.8,37054 2103.8,36970 2103.8,36970 2103.8,36970 4203.2,36970 4203.2,36970"];
	layer13_moe_comm_from_expert1 -> layer13_moe_aggregate	[pos="e,4228.8,36985 2449.8,37098 2449.8,37057 2449.8,36985 2449.8,36985 2449.8,36985 4218.8,36985 4218.8,36985"];
	layer13_moe_comm_from_expert2 -> layer13_moe_aggregate	[pos="e,4244.1,37000 2759,37107 2759,37073 2759,37000 2759,37000 2759,37000 4234.1,37000 4234.1,37000"];
	layer13_moe_comm_from_expert3 -> layer13_moe_aggregate	[pos="e,4259.6,37015 3095.8,37111 3095.8,37082 3095.8,37015 3095.8,37015 3095.8,37015 4249.6,37015 4249.6,37015"];
	layer13_moe_comm_from_expert4 -> layer13_moe_aggregate	[pos="e,4275.2,37030 3580,37107 3580,37080 3580,37030 3580,37030 3580,37030 4265.2,37030 4265.2,37030"];
	layer13_moe_comm_from_expert5 -> layer13_moe_aggregate	[pos="e,4290.6,37045 3926,37107 3926,37084 3926,37045 3926,37045 3926,37045 4280.6,37045 4280.6,37045"];
	layer13_moe_comm_from_expert6 -> layer13_moe_aggregate	[pos="e,4207.6,37008 4207.6,37112 4207.6,37112 4207.6,37018 4207.6,37018"];
	layer13_moe_comm_from_expert7 -> layer13_moe_aggregate	[pos="e,4362,37060 4362,37096 4362,37096 4362,37070 4362,37070"];
	layer13_moe_comm_from_expert8 -> layer13_moe_aggregate	[pos="e,4633.4,37060 4633.4,37096 4633.4,37096 4633.4,37070 4633.4,37070"];
	layer13_moe_comm_from_expert9 -> layer13_moe_aggregate	[pos="e,4709,37046 4924.5,37096 4924.5,37074 4924.5,37046 4924.5,37046 4924.5,37046 4719,37046 4719,37046"];
	layer13_moe_comm_from_expert10 -> layer13_moe_aggregate	[pos="e,4695.5,37033 5256.1,37096 5256.1,37069 5256.1,37033 5256.1,37033 5256.1,37033 4705.5,37033 4705.5,37033"];
	layer13_moe_comm_from_expert11 -> layer13_moe_aggregate	[pos="e,4682.1,37020 5602.6,37097 5602.6,37065 5602.6,37020 5602.6,37020 5602.6,37020 4692.1,37020 4692.1,37020"];
	layer13_moe_comm_from_expert12 -> layer13_moe_aggregate	[pos="e,4668.5,37007 5953.6,37096 5953.6,37061 5953.6,37007 5953.6,37007 5953.6,37007 4678.5,37007 4678.5,37007"];
	layer13_moe_comm_from_expert13 -> layer13_moe_aggregate	[pos="e,4655.5,36994 6307.1,37097 6307.1,37058 6307.1,36994 6307.1,36994 6307.1,36994 4665.5,36994 4665.5,36994"];
	layer13_moe_comm_from_expert14 -> layer13_moe_aggregate	[pos="e,4642.1,36981 6662.1,37096 6662.1,37055 6662.1,36981 6662.1,36981 6662.1,36981 4652.1,36981 4652.1,36981"];
	layer13_moe_comm_from_expert15 -> layer13_moe_aggregate	[pos="e,4628.7,36968 7017.1,37096 7017.1,37051 7017.1,36968 7017.1,36968 7017.1,36968 4638.7,36968 4638.7,36968"];
	layer14_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L14\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4461,36780",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer14_moe_mha -> layer14_moe_gate	[pos="e,4461,36832 4461,36868 4461,36868 4461,36842 4461,36842"];
	layer14_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L14\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4461,36640",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer14_moe_gate -> layer14_moe_split	[pos="e,4461,36692 4461,36728 4461,36728 4461,36702 4461,36702"];
	layer14_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1939,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer14_moe_split -> layer14_moe_comm_to_expert0	[pos="e,2004,36543 4296,36677 3745.1,36677 2004,36677 2004,36677 2004,36677 2004,36553 2004,36553",
		style=dashed];
	layer14_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2285,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer14_moe_split -> layer14_moe_comm_to_expert1	[pos="e,2350,36543 4281,36662 3770.5,36662 2350,36662 2350,36662 2350,36662 2350,36553 2350,36553",
		style=dashed];
	layer14_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2650,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer14_moe_split -> layer14_moe_comm_to_expert2	[pos="e,2668.5,36551 4265.8,36647 3801.2,36647 2668.5,36647 2668.5,36647 2668.5,36647 2668.5,36561 2668.5,36561",
		style=dashed];
	layer14_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2978,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer14_moe_split -> layer14_moe_comm_to_expert3	[pos="e,2996.5,36552 4250.8,36632 3845.7,36632 2996.5,36632 2996.5,36632 2996.5,36632 2996.5,36562 2996.5,36562",
		style=dashed];
	layer14_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3471,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer14_moe_split -> layer14_moe_comm_to_expert4	[pos="e,3489.5,36551 4236,36617 3949,36617 3489.5,36617 3489.5,36617 3489.5,36617 3489.5,36561 3489.5,36561",
		style=dashed];
	layer14_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3817,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer14_moe_split -> layer14_moe_comm_to_expert5	[pos="e,3835.5,36551 4221,36602 4044.6,36602 3835.5,36602 3835.5,36602 3835.5,36602 3835.5,36561 3835.5,36561",
		style=dashed];
	layer14_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4089,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer14_moe_split -> layer14_moe_comm_to_expert6	[pos="e,4179.8,36522 4220.7,36640 4220.7,36636 4220.7,36522 4220.7,36522 4220.7,36522 4189.8,36522 4189.8,36522",
		style=dashed];
	layer14_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4325,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer14_moe_split -> layer14_moe_comm_to_expert7	[pos="e,4325,36552 4325,36588 4325,36588 4325,36562 4325,36562",
		style=dashed];
	layer14_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4597,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer14_moe_split -> layer14_moe_comm_to_expert8	[pos="e,4597,36552 4597,36588 4597,36588 4597,36562 4597,36562",
		style=dashed];
	layer14_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4906,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer14_moe_split -> layer14_moe_comm_to_expert9	[pos="e,4815.3,36522 4701.3,36640 4701.3,36636 4701.3,36522 4701.3,36522 4701.3,36522 4805.3,36522 4805.3,36522",
		style=dashed];
	layer14_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5238,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer14_moe_split -> layer14_moe_comm_to_expert10	[pos="e,5162.1,36540 4625.4,36602 4832.6,36602 5162.1,36602 5162.1,36602 5162.1,36602 5162.1,36550 5162.1,36550",
		style=dashed];
	layer14_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5584,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer14_moe_split -> layer14_moe_comm_to_expert11	[pos="e,5508.6,36541 4640.2,36617 4939.5,36617 5508.6,36617 5508.6,36617 5508.6,36617 5508.6,36551 5508.6,36551",
		style=dashed];
	layer14_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5935,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer14_moe_split -> layer14_moe_comm_to_expert12	[pos="e,5859.6,36540 4655.5,36632 5039.8,36632 5859.6,36632 5859.6,36632 5859.6,36632 5859.6,36550 5859.6,36550",
		style=dashed];
	layer14_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6288,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer14_moe_split -> layer14_moe_comm_to_expert13	[pos="e,6213.1,36541 4670.2,36647 5135,36647 6213.1,36647 6213.1,36647 6213.1,36647 6213.1,36551 6213.1,36551",
		style=dashed];
	layer14_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6643,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer14_moe_split -> layer14_moe_comm_to_expert14	[pos="e,6568.1,36541 4685.5,36662 5228.4,36662 6568.1,36662 6568.1,36662 6568.1,36662 6568.1,36551 6568.1,36551",
		style=dashed];
	layer14_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6998,36523",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer14_moe_split -> layer14_moe_comm_to_expert15	[pos="e,6923.1,36541 4700.2,36677 5318.7,36677 6923.1,36677 6923.1,36677 6923.1,36677 6923.1,36551 6923.1,36551",
		style=dashed];
	layer14_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L14\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1866,36432",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer14_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2025,36341",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer14_moe_expert0 -> layer14_moe_comm_from_expert0	[pos="e,1982.2,36367 1982.2,36406 1982.2,36406 1982.2,36377 1982.2,36377"];
	layer14_moe_comm_to_expert0 -> layer14_moe_expert0	[pos="e,1939,36458 1939,36494 1939,36494 1939,36468 1939,36468"];
	layer14_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L14\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="2212,36432",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer14_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2297,36341",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer14_moe_expert1 -> layer14_moe_comm_from_expert1	[pos="e,2291.2,36370 2291.2,36406 2291.2,36406 2291.2,36380 2291.2,36380"];
	layer14_moe_comm_to_expert1 -> layer14_moe_expert1	[pos="e,2285,36458 2285,36494 2285,36494 2285,36468 2285,36468"];
	layer14_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L14\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2558,36432",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer14_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2618,36341",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer14_moe_expert2 -> layer14_moe_comm_from_expert2	[pos="e,2618,36370 2618,36406 2618,36406 2618,36380 2618,36380"];
	layer14_moe_comm_to_expert2 -> layer14_moe_expert2	[pos="e,2640.7,36458 2640.7,36494 2640.7,36494 2640.7,36468 2640.7,36468"];
	layer14_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L14\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2904,36432",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer14_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3184,36341",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer14_moe_expert3 -> layer14_moe_comm_from_expert3	[pos="e,3093.4,36340 3063.3,36406 3063.3,36379 3063.3,36340 3063.3,36340 3063.3,36340 3083.4,36340 3083.4,36340"];
	layer14_moe_comm_to_expert3 -> layer14_moe_expert3	[pos="e,2977.7,36458 2977.7,36494 2977.7,36494 2977.7,36468 2977.7,36468"];
	layer14_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L14\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3250,36432",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer14_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3567,36341",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer14_moe_expert4 -> layer14_moe_comm_from_expert4	[pos="e,3476.2,36340 3405.3,36406 3405.3,36379 3405.3,36340 3405.3,36340 3405.3,36340 3466.2,36340 3466.2,36340"];
	layer14_moe_comm_to_expert4 -> layer14_moe_expert4	[pos="e,3397.2,36458 3397.2,36506 3397.2,36506 3397.2,36468 3397.2,36468"];
	layer14_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L14\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3596,36432",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer14_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3858,36341",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer14_moe_expert5 -> layer14_moe_comm_from_expert5	[pos="e,3772.7,36351 3760,36431 3768,36431 3772.7,36431 3772.7,36431 3772.7,36431 3772.7,36361 3772.7,36361"];
	layer14_moe_comm_to_expert5 -> layer14_moe_expert5	[pos="e,3743.2,36458 3743.2,36506 3743.2,36506 3743.2,36468 3743.2,36468"];
	layer14_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L14\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3942,36432",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer14_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="4103,36341",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer14_moe_expert6 -> layer14_moe_comm_from_expert6	[pos="e,4059.2,36367 4059.2,36406 4059.2,36406 4059.2,36377 4059.2,36377"];
	layer14_moe_comm_to_expert6 -> layer14_moe_expert6	[pos="e,4052.2,36458 4052.2,36496 4052.2,36496 4052.2,36468 4052.2,36468"];
	layer14_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L14\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4288,36432",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer14_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4325,36341",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer14_moe_expert7 -> layer14_moe_comm_from_expert7	[pos="e,4325,36370 4325,36406 4325,36406 4325,36380 4325,36380"];
	layer14_moe_comm_to_expert7 -> layer14_moe_expert7	[pos="e,4325,36458 4325,36494 4325,36494 4325,36468 4325,36468"];
	layer14_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L14\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4634,36432",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer14_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4597,36341",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer14_moe_expert8 -> layer14_moe_comm_from_expert8	[pos="e,4597,36370 4597,36406 4597,36406 4597,36380 4597,36380"];
	layer14_moe_comm_to_expert8 -> layer14_moe_expert8	[pos="e,4597,36458 4597,36494 4597,36494 4597,36468 4597,36468"];
	layer14_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L14\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4980,36432",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer14_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4906,36341",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer14_moe_expert9 -> layer14_moe_comm_from_expert9	[pos="e,4906.3,36370 4906.3,36406 4906.3,36406 4906.3,36380 4906.3,36380"];
	layer14_moe_comm_to_expert9 -> layer14_moe_expert9	[pos="e,4906.3,36458 4906.3,36494 4906.3,36494 4906.3,36468 4906.3,36468"];
	layer14_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L14\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5331,36432",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer14_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5238,36341",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer14_moe_expert10 -> layer14_moe_comm_from_expert10	[pos="e,5247.4,36370 5247.4,36406 5247.4,36406 5247.4,36380 5247.4,36380"];
	layer14_moe_comm_to_expert10 -> layer14_moe_expert10	[pos="e,5247,36458 5247,36494 5247,36494 5247,36468 5247,36468"];
	layer14_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L14\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5687,36432",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer14_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5585,36341",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer14_moe_expert11 -> layer14_moe_comm_from_expert11	[pos="e,5598.9,36370 5598.9,36406 5598.9,36406 5598.9,36380 5598.9,36380"];
	layer14_moe_comm_to_expert11 -> layer14_moe_expert11	[pos="e,5598,36458 5598,36494 5598,36494 5598,36468 5598,36468"];
	layer14_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L14\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6043,36432",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer14_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5936,36341",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer14_moe_expert12 -> layer14_moe_comm_from_expert12	[pos="e,5952.4,36370 5952.4,36406 5952.4,36406 5952.4,36380 5952.4,36380"];
	layer14_moe_comm_to_expert12 -> layer14_moe_expert12	[pos="e,5951.5,36458 5951.5,36494 5951.5,36494 5951.5,36468 5951.5,36468"];
	layer14_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L14\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6399,36432",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer14_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6290,36341",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer14_moe_expert13 -> layer14_moe_comm_from_expert13	[pos="e,6307.4,36370 6307.4,36406 6307.4,36406 6307.4,36380 6307.4,36380"];
	layer14_moe_comm_to_expert13 -> layer14_moe_expert13	[pos="e,6306,36458 6306,36494 6306,36494 6306,36468 6306,36468"];
	layer14_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L14\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6755,36432",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer14_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6645,36341",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer14_moe_expert14 -> layer14_moe_comm_from_expert14	[pos="e,6662.9,36369 6662.9,36406 6662.9,36406 6662.9,36379 6662.9,36379"];
	layer14_moe_comm_to_expert14 -> layer14_moe_expert14	[pos="e,6661.5,36458 6661.5,36494 6661.5,36494 6661.5,36468 6661.5,36468"];
	layer14_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L14\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7111,36432",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer14_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="7000,36341",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer14_moe_expert15 -> layer14_moe_comm_from_expert15	[pos="e,7018.4,36369 7018.4,36406 7018.4,36406 7018.4,36379 7018.4,36379"];
	layer14_moe_comm_to_expert15 -> layer14_moe_expert15	[pos="e,7017,36458 7017,36494 7017,36494 7017,36468 7017,36468"];
	layer14_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L14\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4424,36224",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer15_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L15\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4424,36110",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer14_moe_aggregate -> layer15_moe_mha	[pos="e,4424,36136 4424,36172 4424,36172 4424,36146 4424,36146"];
	layer14_moe_comm_from_expert0 -> layer14_moe_aggregate	[pos="e,4176.2,36186 2096,36323 2096,36282 2096,36186 2096,36186 2096,36186 4166.2,36186 4166.2,36186"];
	layer14_moe_comm_from_expert1 -> layer14_moe_aggregate	[pos="e,4191.7,36201 2351,36318 2351,36278 2351,36201 2351,36201 2351,36201 4181.7,36201 4181.7,36201"];
	layer14_moe_comm_from_expert2 -> layer14_moe_aggregate	[pos="e,4207.1,36216 2666,36316 2666,36280 2666,36216 2666,36216 2666,36216 4197.1,36216 4197.1,36216"];
	layer14_moe_comm_from_expert3 -> layer14_moe_aggregate	[pos="e,4222.7,36231 3245,36319 3245,36287 3245,36231 3245,36231 3245,36231 4212.7,36231 4212.7,36231"];
	layer14_moe_comm_from_expert4 -> layer14_moe_aggregate	[pos="e,4238.1,36246 3646,36327 3646,36300 3646,36246 3646,36246 3646,36246 4228.1,36246 4228.1,36246"];
	layer14_moe_comm_from_expert5 -> layer14_moe_aggregate	[pos="e,4253.6,36261 3879.5,36313 3879.5,36290 3879.5,36261 3879.5,36261 3879.5,36261 4243.6,36261 4243.6,36261"];
	layer14_moe_comm_from_expert6 -> layer14_moe_aggregate	[pos="e,4177.6,36224 4177.6,36324 4177.6,36324 4177.6,36234 4177.6,36234"];
	layer14_moe_comm_from_expert7 -> layer14_moe_aggregate	[pos="e,4325,36276 4325,36312 4325,36312 4325,36286 4325,36286"];
	layer14_moe_comm_from_expert8 -> layer14_moe_aggregate	[pos="e,4596.4,36276 4596.4,36312 4596.4,36312 4596.4,36286 4596.4,36286"];
	layer14_moe_comm_from_expert9 -> layer14_moe_aggregate	[pos="e,4672,36262 4887.5,36312 4887.5,36290 4887.5,36262 4887.5,36262 4887.5,36262 4682,36262 4682,36262"];
	layer14_moe_comm_from_expert10 -> layer14_moe_aggregate	[pos="e,4658.5,36249 5219.1,36312 5219.1,36285 5219.1,36249 5219.1,36249 5219.1,36249 4668.5,36249 4668.5,36249"];
	layer14_moe_comm_from_expert11 -> layer14_moe_aggregate	[pos="e,4645.1,36236 5565.6,36313 5565.6,36281 5565.6,36236 5565.6,36236 5565.6,36236 4655.1,36236 4655.1,36236"];
	layer14_moe_comm_from_expert12 -> layer14_moe_aggregate	[pos="e,4631.5,36223 5916.6,36312 5916.6,36277 5916.6,36223 5916.6,36223 5916.6,36223 4641.5,36223 4641.5,36223"];
	layer14_moe_comm_from_expert13 -> layer14_moe_aggregate	[pos="e,4618.1,36210 6270.1,36313 6270.1,36274 6270.1,36210 6270.1,36210 6270.1,36210 4628.1,36210 4628.1,36210"];
	layer14_moe_comm_from_expert14 -> layer14_moe_aggregate	[pos="e,4605.1,36197 6625.1,36313 6625.1,36271 6625.1,36197 6625.1,36197 6625.1,36197 4615.1,36197 4615.1,36197"];
	layer14_moe_comm_from_expert15 -> layer14_moe_aggregate	[pos="e,4591.7,36184 6980.1,36313 6980.1,36267 6980.1,36184 6980.1,36184 6980.1,36184 4601.7,36184 4601.7,36184"];
	layer15_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L15\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4424,35996",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer15_moe_mha -> layer15_moe_gate	[pos="e,4424,36048 4424,36084 4424,36084 4424,36058 4424,36058"];
	layer15_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L15\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4424,35856",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer15_moe_gate -> layer15_moe_split	[pos="e,4424,35908 4424,35944 4424,35944 4424,35918 4424,35918"];
	layer15_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1986,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer15_moe_split -> layer15_moe_comm_to_expert0	[pos="e,2005.5,35768 4258.7,35893 3713.3,35893 2005.5,35893 2005.5,35893 2005.5,35893 2005.5,35778 2005.5,35778",
		style=dashed];
	layer15_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2405,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer15_moe_split -> layer15_moe_comm_to_expert1	[pos="e,2444.8,35765 4244,35878 3756.1,35878 2444.8,35878 2444.8,35878 2444.8,35878 2444.8,35775 2444.8,35775",
		style=dashed];
	layer15_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2714,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer15_moe_split -> layer15_moe_comm_to_expert2	[pos="e,2772.3,35761 4228.9,35863 3791.8,35863 2772.3,35863 2772.3,35863 2772.3,35863 2772.3,35771 2772.3,35771",
		style=dashed];
	layer15_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2968,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer15_moe_split -> layer15_moe_comm_to_expert3	[pos="e,2968,35768 4213.8,35848 3810.6,35848 2968,35848 2968,35848 2968,35848 2968,35778 2968,35778",
		style=dashed];
	layer15_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3306,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer15_moe_split -> layer15_moe_comm_to_expert4	[pos="e,3335.5,35766 4198.8,35833 3880,35833 3335.5,35833 3335.5,35833 3335.5,35833 3335.5,35776 3335.5,35776",
		style=dashed];
	layer15_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3725,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer15_moe_split -> layer15_moe_comm_to_expert5	[pos="e,3791.5,35759 4184,35818 4005,35818 3791.5,35818 3791.5,35818 3791.5,35818 3791.5,35769 3791.5,35769",
		style=dashed];
	layer15_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4034,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer15_moe_split -> layer15_moe_comm_to_expert6	[pos="e,4124.6,35738 4183.7,35856 4183.7,35852 4183.7,35738 4183.7,35738 4183.7,35738 4134.6,35738 4134.6,35738",
		style=dashed];
	layer15_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4288,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer15_moe_split -> layer15_moe_comm_to_expert7	[pos="e,4288,35768 4288,35804 4288,35804 4288,35778 4288,35778",
		style=dashed];
	layer15_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4560,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer15_moe_split -> layer15_moe_comm_to_expert8	[pos="e,4560,35768 4560,35804 4560,35804 4560,35778 4560,35778",
		style=dashed];
	layer15_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4869,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer15_moe_split -> layer15_moe_comm_to_expert9	[pos="e,4778.3,35738 4664.3,35856 4664.3,35852 4664.3,35738 4664.3,35738 4664.3,35738 4768.3,35738 4768.3,35738",
		style=dashed];
	layer15_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5201,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer15_moe_split -> layer15_moe_comm_to_expert10	[pos="e,5125.1,35756 4588.4,35818 4795.6,35818 5125.1,35818 5125.1,35818 5125.1,35818 5125.1,35766 5125.1,35766",
		style=dashed];
	layer15_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5547,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer15_moe_split -> layer15_moe_comm_to_expert11	[pos="e,5471.6,35757 4603.2,35833 4902.5,35833 5471.6,35833 5471.6,35833 5471.6,35833 5471.6,35767 5471.6,35767",
		style=dashed];
	layer15_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5898,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer15_moe_split -> layer15_moe_comm_to_expert12	[pos="e,5822.6,35756 4618.1,35848 5002.2,35848 5822.6,35848 5822.6,35848 5822.6,35848 5822.6,35766 5822.6,35766",
		style=dashed];
	layer15_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6251,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer15_moe_split -> layer15_moe_comm_to_expert13	[pos="e,6176.1,35757 4633.2,35863 5098,35863 6176.1,35863 6176.1,35863 6176.1,35863 6176.1,35767 6176.1,35767",
		style=dashed];
	layer15_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6606,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer15_moe_split -> layer15_moe_comm_to_expert14	[pos="e,6531.1,35757 4648.5,35878 5191.4,35878 6531.1,35878 6531.1,35878 6531.1,35878 6531.1,35767 6531.1,35767",
		style=dashed];
	layer15_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6961,35739",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer15_moe_split -> layer15_moe_comm_to_expert15	[pos="e,6886.1,35757 4663.2,35893 5281.7,35893 6886.1,35893 6886.1,35893 6886.1,35893 6886.1,35767 6886.1,35767",
		style=dashed];
	layer15_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L15\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1829,35648",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer15_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1995,35557",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer15_moe_expert0 -> layer15_moe_comm_from_expert0	[pos="e,1948.7,35582 1948.7,35622 1948.7,35622 1948.7,35592 1948.7,35592"];
	layer15_moe_comm_to_expert0 -> layer15_moe_expert0	[pos="e,1944.2,35674 1944.2,35713 1944.2,35713 1944.2,35684 1944.2,35684"];
	layer15_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L15\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="2175,35648",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer15_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2414,35557",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer15_moe_expert1 -> layer15_moe_comm_from_expert1	[pos="e,2331.2,35569 2331.2,35622 2331.2,35622 2331.2,35579 2331.2,35579"];
	layer15_moe_comm_to_expert1 -> layer15_moe_expert1	[pos="e,2326.7,35674 2326.7,35724 2326.7,35724 2326.7,35684 2326.7,35684"];
	layer15_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L15\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2521,35648",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer15_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2723,35557",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer15_moe_expert2 -> layer15_moe_comm_from_expert2	[pos="e,2658.7,35577 2658.7,35622 2658.7,35622 2658.7,35587 2658.7,35587"];
	layer15_moe_comm_to_expert2 -> layer15_moe_expert2	[pos="e,2654.2,35674 2654.2,35717 2654.2,35717 2654.2,35684 2654.2,35684"];
	layer15_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L15\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2867,35648",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer15_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2977,35557",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer15_moe_expert3 -> layer15_moe_comm_from_expert3	[pos="e,2958.7,35585 2958.7,35622 2958.7,35622 2958.7,35595 2958.7,35595"];
	layer15_moe_comm_to_expert3 -> layer15_moe_expert3	[pos="e,2954.2,35674 2954.2,35710 2954.2,35710 2954.2,35684 2954.2,35684"];
	layer15_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L15\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3213,35648",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer15_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3360,35557",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer15_moe_expert4 -> layer15_moe_comm_from_expert4	[pos="e,3323.2,35584 3323.2,35622 3323.2,35622 3323.2,35594 3323.2,35594"];
	layer15_moe_comm_to_expert4 -> layer15_moe_expert4	[pos="e,3296.2,35674 3296.2,35710 3296.2,35710 3296.2,35684 3296.2,35684"];
	layer15_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L15\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3559,35648",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer15_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3706,35557",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer15_moe_expert5 -> layer15_moe_comm_from_expert5	[pos="e,3669.2,35584 3669.2,35622 3669.2,35622 3669.2,35594 3669.2,35594"];
	layer15_moe_comm_to_expert5 -> layer15_moe_expert5	[pos="e,3678.7,35674 3678.7,35714 3678.7,35714 3678.7,35684 3678.7,35684"];
	layer15_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L15\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3905,35648",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer15_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3978,35557",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer15_moe_expert6 -> layer15_moe_comm_from_expert6	[pos="e,3978,35586 3978,35622 3978,35622 3978,35596 3978,35596"];
	layer15_moe_comm_to_expert6 -> layer15_moe_expert6	[pos="e,4006.2,35674 4006.2,35711 4006.2,35711 4006.2,35684 4006.2,35684"];
	layer15_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L15\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4251,35648",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer15_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4288,35557",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer15_moe_expert7 -> layer15_moe_comm_from_expert7	[pos="e,4288,35586 4288,35622 4288,35622 4288,35596 4288,35596"];
	layer15_moe_comm_to_expert7 -> layer15_moe_expert7	[pos="e,4288,35674 4288,35710 4288,35710 4288,35684 4288,35684"];
	layer15_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L15\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4597,35648",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer15_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4560,35557",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer15_moe_expert8 -> layer15_moe_comm_from_expert8	[pos="e,4560,35586 4560,35622 4560,35622 4560,35596 4560,35596"];
	layer15_moe_comm_to_expert8 -> layer15_moe_expert8	[pos="e,4560,35674 4560,35710 4560,35710 4560,35684 4560,35684"];
	layer15_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L15\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4943,35648",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer15_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4869,35557",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer15_moe_expert9 -> layer15_moe_comm_from_expert9	[pos="e,4869.3,35586 4869.3,35622 4869.3,35622 4869.3,35596 4869.3,35596"];
	layer15_moe_comm_to_expert9 -> layer15_moe_expert9	[pos="e,4869.3,35674 4869.3,35710 4869.3,35710 4869.3,35684 4869.3,35684"];
	layer15_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L15\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5294,35648",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer15_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5201,35557",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer15_moe_expert10 -> layer15_moe_comm_from_expert10	[pos="e,5210.4,35586 5210.4,35622 5210.4,35622 5210.4,35596 5210.4,35596"];
	layer15_moe_comm_to_expert10 -> layer15_moe_expert10	[pos="e,5210,35674 5210,35710 5210,35710 5210,35684 5210,35684"];
	layer15_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L15\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5650,35648",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer15_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5548,35557",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer15_moe_expert11 -> layer15_moe_comm_from_expert11	[pos="e,5561.9,35586 5561.9,35622 5561.9,35622 5561.9,35596 5561.9,35596"];
	layer15_moe_comm_to_expert11 -> layer15_moe_expert11	[pos="e,5561,35674 5561,35710 5561,35710 5561,35684 5561,35684"];
	layer15_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L15\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="6006,35648",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer15_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5899,35557",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer15_moe_expert12 -> layer15_moe_comm_from_expert12	[pos="e,5915.4,35586 5915.4,35622 5915.4,35622 5915.4,35596 5915.4,35596"];
	layer15_moe_comm_to_expert12 -> layer15_moe_expert12	[pos="e,5914.5,35674 5914.5,35710 5914.5,35710 5914.5,35684 5914.5,35684"];
	layer15_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L15\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6362,35648",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer15_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6253,35557",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer15_moe_expert13 -> layer15_moe_comm_from_expert13	[pos="e,6270.4,35586 6270.4,35622 6270.4,35622 6270.4,35596 6270.4,35596"];
	layer15_moe_comm_to_expert13 -> layer15_moe_expert13	[pos="e,6269,35674 6269,35710 6269,35710 6269,35684 6269,35684"];
	layer15_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L15\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6718,35648",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer15_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6608,35557",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer15_moe_expert14 -> layer15_moe_comm_from_expert14	[pos="e,6625.9,35585 6625.9,35622 6625.9,35622 6625.9,35595 6625.9,35595"];
	layer15_moe_comm_to_expert14 -> layer15_moe_expert14	[pos="e,6624.5,35674 6624.5,35710 6624.5,35710 6624.5,35684 6624.5,35684"];
	layer15_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L15\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7074,35648",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer15_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6963,35557",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer15_moe_expert15 -> layer15_moe_comm_from_expert15	[pos="e,6981.4,35585 6981.4,35622 6981.4,35622 6981.4,35595 6981.4,35595"];
	layer15_moe_comm_to_expert15 -> layer15_moe_expert15	[pos="e,6980,35674 6980,35710 6980,35710 6980,35684 6980,35684"];
	layer15_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L15\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4387,35440",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer16_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L16\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4387,35326",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer15_moe_aggregate -> layer16_moe_mha	[pos="e,4387,35352 4387,35388 4387,35388 4387,35362 4387,35362"];
	layer15_moe_comm_from_expert0 -> layer15_moe_aggregate	[pos="e,4139.2,35402 2029.8,35530 2029.8,35486 2029.8,35402 2029.8,35402 2029.8,35402 4129.2,35402 4129.2,35402"];
	layer15_moe_comm_from_expert1 -> layer15_moe_aggregate	[pos="e,4154.4,35417 2482.5,35538 2482.5,35499 2482.5,35417 2482.5,35417 2482.5,35417 4144.4,35417 4144.4,35417"];
	layer15_moe_comm_from_expert2 -> layer15_moe_aggregate	[pos="e,4170,35432 2739.8,35528 2739.8,35491 2739.8,35432 2739.8,35432 2739.8,35432 4160,35432 4160,35432"];
	layer15_moe_comm_from_expert3 -> layer15_moe_aggregate	[pos="e,4185.6,35447 2992,35528 2992,35496 2992,35447 2992,35447 2992,35447 4175.6,35447 4175.6,35447"];
	layer15_moe_comm_from_expert4 -> layer15_moe_aggregate	[pos="e,4201.2,35462 3438,35542 3438,35515 3438,35462 3438,35462 3438,35462 4191.2,35462 4191.2,35462"];
	layer15_moe_comm_from_expert5 -> layer15_moe_aggregate	[pos="e,4216.5,35477 3767.5,35536 3767.5,35512 3767.5,35477 3767.5,35477 3767.5,35477 4206.5,35477 4206.5,35477"];
	layer15_moe_comm_from_expert6 -> layer15_moe_aggregate	[pos="e,4161.1,35440 4068.5,35556 4114.6,35556 4161.1,35556 4161.1,35556 4161.1,35556 4161.1,35450 4161.1,35450"];
	layer15_moe_comm_from_expert7 -> layer15_moe_aggregate	[pos="e,4288,35492 4288,35528 4288,35528 4288,35502 4288,35502"];
	layer15_moe_comm_from_expert8 -> layer15_moe_aggregate	[pos="e,4559.4,35492 4559.4,35528 4559.4,35528 4559.4,35502 4559.4,35502"];
	layer15_moe_comm_from_expert9 -> layer15_moe_aggregate	[pos="e,4634.7,35478 4850.5,35528 4850.5,35506 4850.5,35478 4850.5,35478 4850.5,35478 4644.7,35478 4644.7,35478"];
	layer15_moe_comm_from_expert10 -> layer15_moe_aggregate	[pos="e,4621.3,35465 5182.1,35528 5182.1,35501 5182.1,35465 5182.1,35465 5182.1,35465 4631.3,35465 4631.3,35465"];
	layer15_moe_comm_from_expert11 -> layer15_moe_aggregate	[pos="e,4608.1,35452 5528.6,35529 5528.6,35497 5528.6,35452 5528.6,35452 5528.6,35452 4618.1,35452 4618.1,35452"];
	layer15_moe_comm_from_expert12 -> layer15_moe_aggregate	[pos="e,4594.5,35439 5879.6,35528 5879.6,35494 5879.6,35439 5879.6,35439 5879.6,35439 4604.5,35439 4604.5,35439"];
	layer15_moe_comm_from_expert13 -> layer15_moe_aggregate	[pos="e,4581.1,35426 6233.1,35529 6233.1,35490 6233.1,35426 6233.1,35426 6233.1,35426 4591.1,35426 4591.1,35426"];
	layer15_moe_comm_from_expert14 -> layer15_moe_aggregate	[pos="e,4568.1,35413 6588.1,35529 6588.1,35487 6588.1,35413 6588.1,35413 6588.1,35413 4578.1,35413 4578.1,35413"];
	layer15_moe_comm_from_expert15 -> layer15_moe_aggregate	[pos="e,4554.7,35400 6943.1,35529 6943.1,35483 6943.1,35400 6943.1,35400 6943.1,35400 4564.7,35400 4564.7,35400"];
	layer16_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L16\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4387,35212",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer16_moe_mha -> layer16_moe_gate	[pos="e,4387,35264 4387,35300 4387,35300 4387,35274 4387,35274"];
	layer16_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L16\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4387,35072",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer16_moe_gate -> layer16_moe_split	[pos="e,4387,35124 4387,35160 4387,35160 4387,35134 4387,35134"];
	layer16_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2306,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer16_moe_split -> layer16_moe_comm_to_expert0	[pos="e,2360,34978 4221.6,35109 3737.8,35109 2360,35109 2360,35109 2360,35109 2360,34988 2360,34988",
		style=dashed];
	layer16_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2551,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer16_moe_split -> layer16_moe_comm_to_expert1	[pos="e,2637,34964 4206.7,35094 3759.9,35094 2637,35094 2637,35094 2637,35094 2637,34974 2637,34974",
		style=dashed];
	layer16_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="3007,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer16_moe_split -> layer16_moe_comm_to_expert2	[pos="e,3082.5,34971 4191.7,35079 3827.8,35079 3082.5,35079 3082.5,35079 3082.5,35079 3082.5,34981 3082.5,34981",
		style=dashed];
	layer16_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3335,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer16_moe_split -> layer16_moe_comm_to_expert3	[pos="e,3347.5,34984 4177,35064 3873.3,35064 3347.5,35064 3347.5,35064 3347.5,35064 3347.5,34994 3347.5,34994",
		style=dashed];
	layer16_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3598,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer16_moe_split -> layer16_moe_comm_to_expert4	[pos="e,3652,34979 4162,35049 3945.9,35049 3652,35049 3652,35049 3652,35049 3652,34989 3652,34989",
		style=dashed];
	layer16_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3829,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer16_moe_split -> layer16_moe_comm_to_expert5	[pos="e,3903.5,34972 4146.7,35034 4025.3,35034 3903.5,35034 3903.5,35034 3903.5,35034 3903.5,34982 3903.5,34982",
		style=dashed];
	layer16_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="4044,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer16_moe_split -> layer16_moe_comm_to_expert6	[pos="e,4134.8,34954 4147.5,35072 4147.5,35068 4147.5,34954 4147.5,34954 4147.5,34954 4144.8,34954 4144.8,34954",
		style=dashed];
	layer16_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4251,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer16_moe_split -> layer16_moe_comm_to_expert7	[pos="e,4251,34984 4251,35020 4251,35020 4251,34994 4251,34994",
		style=dashed];
	layer16_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4523,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer16_moe_split -> layer16_moe_comm_to_expert8	[pos="e,4523,34984 4523,35020 4523,35020 4523,34994 4523,34994",
		style=dashed];
	layer16_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4832,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer16_moe_split -> layer16_moe_comm_to_expert9	[pos="e,4741.3,34954 4627.3,35072 4627.3,35068 4627.3,34954 4627.3,34954 4627.3,34954 4731.3,34954 4731.3,34954",
		style=dashed];
	layer16_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5164,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer16_moe_split -> layer16_moe_comm_to_expert10	[pos="e,5088.1,34972 4551.4,35034 4758.6,35034 5088.1,35034 5088.1,35034 5088.1,35034 5088.1,34982 5088.1,34982",
		style=dashed];
	layer16_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5510,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer16_moe_split -> layer16_moe_comm_to_expert11	[pos="e,5434.6,34973 4566.2,35049 4865.5,35049 5434.6,35049 5434.6,35049 5434.6,35049 5434.6,34983 5434.6,34983",
		style=dashed];
	layer16_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5861,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer16_moe_split -> layer16_moe_comm_to_expert12	[pos="e,5785.6,34973 4581.1,35064 4965.2,35064 5785.6,35064 5785.6,35064 5785.6,35064 5785.6,34983 5785.6,34983",
		style=dashed];
	layer16_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6214,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer16_moe_split -> layer16_moe_comm_to_expert13	[pos="e,6139.1,34973 4596.2,35079 5061,35079 6139.1,35079 6139.1,35079 6139.1,35079 6139.1,34983 6139.1,34983",
		style=dashed];
	layer16_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6569,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer16_moe_split -> layer16_moe_comm_to_expert14	[pos="e,6494.1,34973 4611.5,35094 5154.4,35094 6494.1,35094 6494.1,35094 6494.1,35094 6494.1,34983 6494.1,34983",
		style=dashed];
	layer16_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6924,34955",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer16_moe_split -> layer16_moe_comm_to_expert15	[pos="e,6849.1,34973 4626.2,35109 5244.7,35109 6849.1,35109 6849.1,35109 6849.1,35109 6849.1,34983 6849.1,34983",
		style=dashed];
	layer16_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L16\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1792,34864",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer16_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1939,34773",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer16_moe_expert0 -> layer16_moe_comm_from_expert0	[pos="e,1902.2,34800 1902.2,34838 1902.2,34838 1902.2,34810 1902.2,34810"];
	layer16_moe_comm_to_expert0 -> layer16_moe_expert0	[pos="e,1930.2,34890 2215.5,34954 2104.3,34954 1930.2,34954 1930.2,34954 1930.2,34954 1930.2,34900 1930.2,34900"];
	layer16_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L16\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="2138,34864",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer16_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2211,34773",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer16_moe_expert1 -> layer16_moe_comm_from_expert1	[pos="e,2211,34802 2211,34838 2211,34838 2211,34812 2211,34812"];
	layer16_moe_comm_to_expert1 -> layer16_moe_expert1	[pos="e,2258.7,34890 2551,34926 2551,34912 2551,34899 2551,34899 2551,34899 2258.7,34899 2258.7,34899 2258.7,34899 2258.7,34898 2258.7,\
34898"];
	layer16_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L16\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2484,34864",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer16_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2594,34773",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer16_moe_expert2 -> layer16_moe_comm_from_expert2	[pos="e,2575.7,34801 2575.7,34838 2575.7,34838 2575.7,34811 2575.7,34811"];
	layer16_moe_comm_to_expert2 -> layer16_moe_expert2	[pos="e,2648.2,34864 2916.4,34954 2812.7,34954 2657,34954 2657,34954 2657,34954 2657,34864 2657,34864 2657,34864 2656.1,34864 2656.1,34864"];
	layer16_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L16\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2830,34864",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer16_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3014,34773",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer16_moe_expert3 -> layer16_moe_comm_from_expert3	[pos="e,2958.7,34796 2958.7,34838 2958.7,34838 2958.7,34806 2958.7,34806"];
	layer16_moe_comm_to_expert3 -> layer16_moe_expert3	[pos="e,2955.2,34890 3276.3,34933 3276.3,34925 3276.3,34917 3276.3,34917 3276.3,34917 2955.2,34917 2955.2,34917 2955.2,34917 2955.2,34900 \
2955.2,34900"];
	layer16_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L16\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3176,34864",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer16_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3360,34773",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer16_moe_expert4 -> layer16_moe_comm_from_expert4	[pos="e,3304.7,34796 3304.7,34838 3304.7,34838 3304.7,34806 3304.7,34806"];
	layer16_moe_comm_to_expert4 -> layer16_moe_expert4	[pos="e,3308.2,34890 3596.7,34926 3596.7,34916 3596.7,34908 3596.7,34908 3596.7,34908 3308.2,34908 3308.2,34908 3308.2,34908 3308.2,34900 \
3308.2,34900"];
	layer16_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L16\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3522,34864",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer16_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3632,34773",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer16_moe_expert5 -> layer16_moe_comm_from_expert5	[pos="e,3613.7,34801 3613.7,34838 3613.7,34838 3613.7,34811 3613.7,34811"];
	layer16_moe_comm_to_expert5 -> layer16_moe_expert5	[pos="e,3686.1,34864 3738.3,34954 3714.9,34954 3696.3,34954 3696.3,34954 3696.3,34954 3696.3,34864 3696.3,34864 3696.3,34864 3695.2,34864 \
3695.2,34864"];
	layer16_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L16\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3868,34864",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer16_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3979,34773",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer16_moe_expert6 -> layer16_moe_comm_from_expert6	[pos="e,3960.2,34801 3960.2,34838 3960.2,34838 3960.2,34811 3960.2,34811"];
	layer16_moe_comm_to_expert6 -> layer16_moe_expert6	[pos="e,3992.7,34890 3992.7,34931 3992.7,34931 3992.7,34900 3992.7,34900"];
	layer16_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L16\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4214,34864",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer16_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4251,34773",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer16_moe_expert7 -> layer16_moe_comm_from_expert7	[pos="e,4251,34802 4251,34838 4251,34838 4251,34812 4251,34812"];
	layer16_moe_comm_to_expert7 -> layer16_moe_expert7	[pos="e,4251,34890 4251,34926 4251,34926 4251,34900 4251,34900"];
	layer16_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L16\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4560,34864",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer16_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4523,34773",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer16_moe_expert8 -> layer16_moe_comm_from_expert8	[pos="e,4523,34802 4523,34838 4523,34838 4523,34812 4523,34812"];
	layer16_moe_comm_to_expert8 -> layer16_moe_expert8	[pos="e,4523,34890 4523,34926 4523,34926 4523,34900 4523,34900"];
	layer16_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L16\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4906,34864",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer16_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4832,34773",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer16_moe_expert9 -> layer16_moe_comm_from_expert9	[pos="e,4832.3,34802 4832.3,34838 4832.3,34838 4832.3,34812 4832.3,34812"];
	layer16_moe_comm_to_expert9 -> layer16_moe_expert9	[pos="e,4832.3,34890 4832.3,34926 4832.3,34926 4832.3,34900 4832.3,34900"];
	layer16_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L16\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5257,34864",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer16_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5164,34773",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer16_moe_expert10 -> layer16_moe_comm_from_expert10	[pos="e,5173.4,34802 5173.4,34838 5173.4,34838 5173.4,34812 5173.4,34812"];
	layer16_moe_comm_to_expert10 -> layer16_moe_expert10	[pos="e,5173,34890 5173,34926 5173,34926 5173,34900 5173,34900"];
	layer16_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L16\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5613,34864",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer16_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5511,34773",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer16_moe_expert11 -> layer16_moe_comm_from_expert11	[pos="e,5524.9,34802 5524.9,34838 5524.9,34838 5524.9,34812 5524.9,34812"];
	layer16_moe_comm_to_expert11 -> layer16_moe_expert11	[pos="e,5524,34890 5524,34926 5524,34926 5524,34900 5524,34900"];
	layer16_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L16\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5969,34864",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer16_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5862,34773",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer16_moe_expert12 -> layer16_moe_comm_from_expert12	[pos="e,5878.4,34802 5878.4,34838 5878.4,34838 5878.4,34812 5878.4,34812"];
	layer16_moe_comm_to_expert12 -> layer16_moe_expert12	[pos="e,5877.5,34890 5877.5,34926 5877.5,34926 5877.5,34900 5877.5,34900"];
	layer16_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L16\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6325,34864",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer16_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6216,34773",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer16_moe_expert13 -> layer16_moe_comm_from_expert13	[pos="e,6233.4,34802 6233.4,34838 6233.4,34838 6233.4,34812 6233.4,34812"];
	layer16_moe_comm_to_expert13 -> layer16_moe_expert13	[pos="e,6232,34890 6232,34926 6232,34926 6232,34900 6232,34900"];
	layer16_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L16\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6681,34864",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer16_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6571,34773",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer16_moe_expert14 -> layer16_moe_comm_from_expert14	[pos="e,6588.9,34801 6588.9,34838 6588.9,34838 6588.9,34811 6588.9,34811"];
	layer16_moe_comm_to_expert14 -> layer16_moe_expert14	[pos="e,6587.5,34890 6587.5,34926 6587.5,34926 6587.5,34900 6587.5,34900"];
	layer16_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L16\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7037,34864",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer16_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6926,34773",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer16_moe_expert15 -> layer16_moe_comm_from_expert15	[pos="e,6944.4,34801 6944.4,34838 6944.4,34838 6944.4,34811 6944.4,34811"];
	layer16_moe_comm_to_expert15 -> layer16_moe_expert15	[pos="e,6943,34890 6943,34926 6943,34926 6943,34900 6943,34900"];
	layer16_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L16\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4350,34656",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer17_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L17\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4350,34542",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer16_moe_aggregate -> layer17_moe_mha	[pos="e,4350,34568 4350,34604 4350,34604 4350,34578 4350,34578"];
	layer16_moe_comm_from_expert0 -> layer16_moe_aggregate	[pos="e,4102.3,34618 1983.3,34747 1983.3,34703 1983.3,34618 1983.3,34618 1983.3,34618 4092.3,34618 4092.3,34618"];
	layer16_moe_comm_from_expert1 -> layer16_moe_aggregate	[pos="e,4117.7,34633 2294,34761 2294,34727 2294,34633 2294,34633 2294,34633 4107.7,34633 4107.7,34633"];
	layer16_moe_comm_from_expert2 -> layer16_moe_aggregate	[pos="e,4133,34648 2656.8,34752 2656.8,34717 2656.8,34648 2656.8,34648 2656.8,34648 4123,34648 4123,34648"];
	layer16_moe_comm_from_expert3 -> layer16_moe_aggregate	[pos="e,4148.7,34663 3048,34746 3048,34714 3048,34663 3048,34663 3048,34663 4138.7,34663 4138.7,34663"];
	layer16_moe_comm_from_expert4 -> layer16_moe_aggregate	[pos="e,4164.1,34678 3412,34749 3412,34721 3412,34678 3412,34678 3412,34678 4154.1,34678 4154.1,34678"];
	layer16_moe_comm_from_expert5 -> layer16_moe_aggregate	[pos="e,4179.4,34693 3661.5,34745 3661.5,34722 3661.5,34693 3661.5,34693 3661.5,34693 4169.4,34693 4169.4,34693"];
	layer16_moe_comm_from_expert6 -> layer16_moe_aggregate	[pos="e,4124.1,34656 4069.7,34773 4099,34773 4124.1,34773 4124.1,34773 4124.1,34773 4124.1,34666 4124.1,34666"];
	layer16_moe_comm_from_expert7 -> layer16_moe_aggregate	[pos="e,4251,34708 4251,34744 4251,34744 4251,34718 4251,34718"];
	layer16_moe_comm_from_expert8 -> layer16_moe_aggregate	[pos="e,4522.4,34708 4522.4,34744 4522.4,34744 4522.4,34718 4522.4,34718"];
	layer16_moe_comm_from_expert9 -> layer16_moe_aggregate	[pos="e,4598.7,34695 4813.5,34744 4813.5,34722 4813.5,34695 4813.5,34695 4813.5,34695 4608.7,34695 4608.7,34695"];
	layer16_moe_comm_from_expert10 -> layer16_moe_aggregate	[pos="e,4585.3,34682 5145.1,34744 5145.1,34718 5145.1,34682 5145.1,34682 5145.1,34682 4595.3,34682 4595.3,34682"];
	layer16_moe_comm_from_expert11 -> layer16_moe_aggregate	[pos="e,4572.2,34669 5491.6,34745 5491.6,34714 5491.6,34669 5491.6,34669 5491.6,34669 4582.2,34669 4582.2,34669"];
	layer16_moe_comm_from_expert12 -> layer16_moe_aggregate	[pos="e,4558.7,34656 5842.6,34744 5842.6,34710 5842.6,34656 5842.6,34656 5842.6,34656 4568.7,34656 4568.7,34656"];
	layer16_moe_comm_from_expert13 -> layer16_moe_aggregate	[pos="e,4545.4,34643 6196.1,34744 6196.1,34706 6196.1,34643 6196.1,34643 6196.1,34643 4555.4,34643 4555.4,34643"];
	layer16_moe_comm_from_expert14 -> layer16_moe_aggregate	[pos="e,4532,34630 6551.1,34744 6551.1,34703 6551.1,34630 6551.1,34630 6551.1,34630 4542,34630 4542,34630"];
	layer16_moe_comm_from_expert15 -> layer16_moe_aggregate	[pos="e,4518.7,34617 6906.1,34744 6906.1,34699 6906.1,34617 6906.1,34617 6906.1,34617 4528.7,34617 4528.7,34617"];
	layer17_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L17\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4350,34428",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer17_moe_mha -> layer17_moe_gate	[pos="e,4350,34480 4350,34516 4350,34516 4350,34490 4350,34490"];
	layer17_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L17\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4350,34288",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer17_moe_gate -> layer17_moe_split	[pos="e,4350,34340 4350,34376 4350,34376 4350,34350 4350,34350"];
	layer17_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2196,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer17_moe_split -> layer17_moe_comm_to_expert0	[pos="e,2203.5,34200 4184.7,34325 3681.6,34325 2203.5,34325 2203.5,34325 2203.5,34325 2203.5,34210 2203.5,34210",
		style=dashed];
	layer17_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2482,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer17_moe_split -> layer17_moe_comm_to_expert1	[pos="e,2538,34194 4169.6,34310 3711.3,34310 2538,34310 2538,34310 2538,34310 2538,34204 2538,34204",
		style=dashed];
	layer17_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2901,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer17_moe_split -> layer17_moe_comm_to_expert2	[pos="e,2957.5,34194 4154.9,34295 3771.7,34295 2957.5,34295 2957.5,34295 2957.5,34295 2957.5,34204 2957.5,34204",
		style=dashed];
	layer17_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3210,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer17_moe_split -> layer17_moe_comm_to_expert3	[pos="e,3285,34188 4139.9,34280 3829.6,34280 3285,34280 3285,34280 3285,34280 3285,34198 3285,34198",
		style=dashed];
	layer17_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3464,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer17_moe_split -> layer17_moe_comm_to_expert4	[pos="e,3548,34182 4124.7,34265 3887.5,34265 3548,34265 3548,34265 3548,34265 3548,34192 3548,34192",
		style=dashed];
	layer17_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3691,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer17_moe_split -> layer17_moe_comm_to_expert5	[pos="e,3752,34193 4109.8,34250 3943.5,34250 3752,34250 3752,34250 3752,34250 3752,34203 3752,34203",
		style=dashed];
	layer17_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3904,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer17_moe_split -> layer17_moe_comm_to_expert6	[pos="e,3994.5,34171 4109.7,34288 4109.7,34284 4109.7,34171 4109.7,34171 4109.7,34171 4004.5,34171 4004.5,34171",
		style=dashed];
	layer17_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4214,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer17_moe_split -> layer17_moe_comm_to_expert7	[pos="e,4214,34200 4214,34236 4214,34236 4214,34210 4214,34210",
		style=dashed];
	layer17_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4486,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer17_moe_split -> layer17_moe_comm_to_expert8	[pos="e,4486,34200 4486,34236 4486,34236 4486,34210 4486,34210",
		style=dashed];
	layer17_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4795,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer17_moe_split -> layer17_moe_comm_to_expert9	[pos="e,4704.3,34171 4590.3,34288 4590.3,34284 4590.3,34171 4590.3,34171 4590.3,34171 4694.3,34171 4694.3,34171",
		style=dashed];
	layer17_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5127,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer17_moe_split -> layer17_moe_comm_to_expert10	[pos="e,5051.1,34188 4514.4,34250 4721.6,34250 5051.1,34250 5051.1,34250 5051.1,34250 5051.1,34198 5051.1,34198",
		style=dashed];
	layer17_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5473,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer17_moe_split -> layer17_moe_comm_to_expert11	[pos="e,5397.6,34189 4529.2,34265 4828.5,34265 5397.6,34265 5397.6,34265 5397.6,34265 5397.6,34199 5397.6,34199",
		style=dashed];
	layer17_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5824,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer17_moe_split -> layer17_moe_comm_to_expert12	[pos="e,5748.6,34189 4544.1,34280 4928.2,34280 5748.6,34280 5748.6,34280 5748.6,34280 5748.6,34199 5748.6,34199",
		style=dashed];
	layer17_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6177,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer17_moe_split -> layer17_moe_comm_to_expert13	[pos="e,6102.1,34189 4559.2,34295 5024,34295 6102.1,34295 6102.1,34295 6102.1,34295 6102.1,34199 6102.1,34199",
		style=dashed];
	layer17_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6532,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer17_moe_split -> layer17_moe_comm_to_expert14	[pos="e,6457.1,34189 4574.5,34310 5117.4,34310 6457.1,34310 6457.1,34310 6457.1,34310 6457.1,34199 6457.1,34199",
		style=dashed];
	layer17_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6887,34171",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer17_moe_split -> layer17_moe_comm_to_expert15	[pos="e,6812.1,34189 4589.2,34325 5207.7,34325 6812.1,34325 6812.1,34325 6812.1,34325 6812.1,34199 6812.1,34199",
		style=dashed];
	layer17_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L17\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1755,34080",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer17_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1939,33989",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer17_moe_expert0 -> layer17_moe_comm_from_expert0	[pos="e,1883.7,34012 1883.7,34054 1883.7,34054 1883.7,34022 1883.7,34022"];
	layer17_moe_comm_to_expert0 -> layer17_moe_expert0	[pos="e,1883.7,34106 2105.3,34171 2013.1,34171 1883.7,34171 1883.7,34171 1883.7,34171 1883.7,34116 1883.7,34116"];
	layer17_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L17\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="2101,34080",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer17_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2211,33989",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer17_moe_expert1 -> layer17_moe_comm_from_expert1	[pos="e,2192.7,34018 2192.7,34054 2192.7,34054 2192.7,34028 2192.7,34028"];
	layer17_moe_comm_to_expert1 -> layer17_moe_expert1	[pos="e,2185.2,34106 2482,34142 2482,34130 2482,34118 2482,34118 2482,34118 2185.2,34118 2185.2,34118 2185.2,34118 2185.2,34116 2185.2,\
34116"];
	layer17_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L17\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2447,34080",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer17_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2622,33989",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer17_moe_expert2 -> layer17_moe_comm_from_expert2	[pos="e,2571.2,34013 2571.2,34054 2571.2,34054 2571.2,34023 2571.2,34023"];
	layer17_moe_comm_to_expert2 -> layer17_moe_expert2	[pos="e,2591.8,34106 2810.3,34171 2719.1,34171 2591.8,34171 2591.8,34171 2591.8,34171 2591.8,34116 2591.8,34116"];
	layer17_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L17\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2793,34080",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer17_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2894,33989",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer17_moe_expert3 -> layer17_moe_comm_from_expert3	[pos="e,2880.2,34018 2880.2,34054 2880.2,34054 2880.2,34028 2880.2,34028"];
	layer17_moe_comm_to_expert3 -> layer17_moe_expert3	[pos="e,2883.7,34106 3210,34142 3210,34135 3210,34130 3210,34130 3210,34130 2883.7,34130 2883.7,34130 2883.7,34130 2883.7,34116 2883.7,\
34116"];
	layer17_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L17\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3139,34080",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer17_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3232,33989",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer17_moe_expert4 -> layer17_moe_comm_from_expert4	[pos="e,3222.2,34018 3222.2,34054 3222.2,34054 3222.2,34028 3222.2,34028"];
	layer17_moe_comm_to_expert4 -> layer17_moe_expert4	[pos="e,3303.2,34080 3373.4,34171 3340.8,34171 3312,34171 3312,34171 3312,34171 3312,34080 3312,34080 3312,34080 3311.1,34080 3311.1,34080"];
	layer17_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L17\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3485,34080",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer17_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3651,33989",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer17_moe_expert5 -> layer17_moe_comm_from_expert5	[pos="e,3604.7,34014 3604.7,34054 3604.7,34054 3604.7,34024 3604.7,34024"];
	layer17_moe_comm_to_expert5 -> layer17_moe_expert5	[pos="e,3624.7,34106 3624.7,34151 3624.7,34151 3624.7,34116 3624.7,34116"];
	layer17_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L17\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3831,34080",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer17_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3960,33989",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer17_moe_expert6 -> layer17_moe_comm_from_expert6	[pos="e,3932.2,34017 3932.2,34054 3932.2,34054 3932.2,34027 3932.2,34027"];
	layer17_moe_comm_to_expert6 -> layer17_moe_expert6	[pos="e,3904,34106 3904,34142 3904,34142 3904,34116 3904,34116"];
	layer17_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L17\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4177,34080",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer17_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4214,33989",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer17_moe_expert7 -> layer17_moe_comm_from_expert7	[pos="e,4214,34018 4214,34054 4214,34054 4214,34028 4214,34028"];
	layer17_moe_comm_to_expert7 -> layer17_moe_expert7	[pos="e,4214,34106 4214,34142 4214,34142 4214,34116 4214,34116"];
	layer17_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L17\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4523,34080",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer17_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4486,33989",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer17_moe_expert8 -> layer17_moe_comm_from_expert8	[pos="e,4486,34018 4486,34054 4486,34054 4486,34028 4486,34028"];
	layer17_moe_comm_to_expert8 -> layer17_moe_expert8	[pos="e,4486,34106 4486,34142 4486,34142 4486,34116 4486,34116"];
	layer17_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L17\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4869,34080",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer17_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4795,33989",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer17_moe_expert9 -> layer17_moe_comm_from_expert9	[pos="e,4795.3,34018 4795.3,34054 4795.3,34054 4795.3,34028 4795.3,34028"];
	layer17_moe_comm_to_expert9 -> layer17_moe_expert9	[pos="e,4795.3,34106 4795.3,34142 4795.3,34142 4795.3,34116 4795.3,34116"];
	layer17_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L17\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5220,34080",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer17_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5127,33989",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer17_moe_expert10 -> layer17_moe_comm_from_expert10	[pos="e,5136.4,34018 5136.4,34054 5136.4,34054 5136.4,34028 5136.4,34028"];
	layer17_moe_comm_to_expert10 -> layer17_moe_expert10	[pos="e,5136,34106 5136,34142 5136,34142 5136,34116 5136,34116"];
	layer17_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L17\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5576,34080",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer17_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5474,33989",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer17_moe_expert11 -> layer17_moe_comm_from_expert11	[pos="e,5487.9,34018 5487.9,34054 5487.9,34054 5487.9,34028 5487.9,34028"];
	layer17_moe_comm_to_expert11 -> layer17_moe_expert11	[pos="e,5487,34106 5487,34142 5487,34142 5487,34116 5487,34116"];
	layer17_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L17\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5932,34080",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer17_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5825,33989",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer17_moe_expert12 -> layer17_moe_comm_from_expert12	[pos="e,5841.4,34018 5841.4,34054 5841.4,34054 5841.4,34028 5841.4,34028"];
	layer17_moe_comm_to_expert12 -> layer17_moe_expert12	[pos="e,5840.5,34106 5840.5,34142 5840.5,34142 5840.5,34116 5840.5,34116"];
	layer17_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L17\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6288,34080",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer17_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6179,33989",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer17_moe_expert13 -> layer17_moe_comm_from_expert13	[pos="e,6196.4,34018 6196.4,34054 6196.4,34054 6196.4,34028 6196.4,34028"];
	layer17_moe_comm_to_expert13 -> layer17_moe_expert13	[pos="e,6195,34106 6195,34142 6195,34142 6195,34116 6195,34116"];
	layer17_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L17\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6644,34080",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer17_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6534,33989",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer17_moe_expert14 -> layer17_moe_comm_from_expert14	[pos="e,6551.9,34018 6551.9,34054 6551.9,34054 6551.9,34028 6551.9,34028"];
	layer17_moe_comm_to_expert14 -> layer17_moe_expert14	[pos="e,6550.5,34106 6550.5,34142 6550.5,34142 6550.5,34116 6550.5,34116"];
	layer17_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L17\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="7000,34080",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer17_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6889,33989",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer17_moe_expert15 -> layer17_moe_comm_from_expert15	[pos="e,6907.4,34018 6907.4,34054 6907.4,34054 6907.4,34028 6907.4,34028"];
	layer17_moe_comm_to_expert15 -> layer17_moe_expert15	[pos="e,6906,34106 6906,34142 6906,34142 6906,34116 6906,34116"];
	layer17_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L17\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4313,33872",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer18_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L18\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4313,33758",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer17_moe_aggregate -> layer18_moe_mha	[pos="e,4313,33784 4313,33820 4313,33820 4313,33794 4313,33794"];
	layer17_moe_comm_from_expert0 -> layer17_moe_aggregate	[pos="e,4065,33834 1964.8,33961 1964.8,33916 1964.8,33834 1964.8,33834 1964.8,33834 4055,33834 4055,33834"];
	layer17_moe_comm_from_expert1 -> layer17_moe_aggregate	[pos="e,4080.6,33849 2273.8,33968 2273.8,33929 2273.8,33849 2273.8,33849 2273.8,33849 4070.6,33849 4070.6,33849"];
	layer17_moe_comm_from_expert2 -> layer17_moe_aggregate	[pos="e,4095.9,33864 2652.3,33962 2652.3,33925 2652.3,33864 2652.3,33864 2652.3,33864 4085.9,33864 4085.9,33864"];
	layer17_moe_comm_from_expert3 -> layer17_moe_aggregate	[pos="e,4111.4,33879 2913.5,33961 2913.5,33928 2913.5,33879 2913.5,33879 2913.5,33879 4101.4,33879 4101.4,33879"];
	layer17_moe_comm_from_expert4 -> layer17_moe_aggregate	[pos="e,4126.9,33894 3246.5,33960 3246.5,33932 3246.5,33894 3246.5,33894 3246.5,33894 4116.9,33894 4116.9,33894"];
	layer17_moe_comm_from_expert5 -> layer17_moe_aggregate	[pos="e,4142.3,33909 3703,33965 3703,33941 3703,33909 3703,33909 3703,33909 4132.3,33909 4132.3,33909"];
	layer17_moe_comm_from_expert6 -> layer17_moe_aggregate	[pos="e,4087.1,33872 4050.7,33989 4071.2,33989 4087.1,33989 4087.1,33989 4087.1,33989 4087.1,33882 4087.1,33882"];
	layer17_moe_comm_from_expert7 -> layer17_moe_aggregate	[pos="e,4214,33924 4214,33960 4214,33960 4214,33934 4214,33934"];
	layer17_moe_comm_from_expert8 -> layer17_moe_aggregate	[pos="e,4485.4,33924 4485.4,33960 4485.4,33960 4485.4,33934 4485.4,33934"];
	layer17_moe_comm_from_expert9 -> layer17_moe_aggregate	[pos="e,4561.7,33911 4776.5,33960 4776.5,33938 4776.5,33911 4776.5,33911 4776.5,33911 4571.7,33911 4571.7,33911"];
	layer17_moe_comm_from_expert10 -> layer17_moe_aggregate	[pos="e,4548.3,33898 5108.1,33960 5108.1,33934 5108.1,33898 5108.1,33898 5108.1,33898 4558.3,33898 4558.3,33898"];
	layer17_moe_comm_from_expert11 -> layer17_moe_aggregate	[pos="e,4535.2,33885 5454.6,33961 5454.6,33930 5454.6,33885 5454.6,33885 5454.6,33885 4545.2,33885 4545.2,33885"];
	layer17_moe_comm_from_expert12 -> layer17_moe_aggregate	[pos="e,4521.7,33872 5805.6,33960 5805.6,33926 5805.6,33872 5805.6,33872 5805.6,33872 4531.7,33872 4531.7,33872"];
	layer17_moe_comm_from_expert13 -> layer17_moe_aggregate	[pos="e,4508.4,33859 6159.1,33961 6159.1,33922 6159.1,33859 6159.1,33859 6159.1,33859 4518.4,33859 4518.4,33859"];
	layer17_moe_comm_from_expert14 -> layer17_moe_aggregate	[pos="e,4495,33846 6514.1,33960 6514.1,33919 6514.1,33846 6514.1,33846 6514.1,33846 4505,33846 4505,33846"];
	layer17_moe_comm_from_expert15 -> layer17_moe_aggregate	[pos="e,4481.2,33833 6869.1,33960 6869.1,33915 6869.1,33833 6869.1,33833 6869.1,33833 4491.2,33833 4491.2,33833"];
	layer18_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L18\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4313,33644",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer18_moe_mha -> layer18_moe_gate	[pos="e,4313,33696 4313,33732 4313,33732 4313,33706 4313,33706"];
	layer18_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L18\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4313,33504",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer18_moe_gate -> layer18_moe_split	[pos="e,4313,33556 4313,33592 4313,33592 4313,33566 4313,33566"];
	layer18_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1764,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer18_moe_split -> layer18_moe_comm_to_expert0	[pos="e,1761,33416 4147.5,33541 3582,33541 1761,33541 1761,33541 1761,33541 1761,33426 1761,33426",
		style=dashed];
	layer18_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2477,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer18_moe_split -> layer18_moe_comm_to_expert1	[pos="e,2549.5,33405 4132.6,33526 3683.1,33526 2549.5,33526 2549.5,33526 2549.5,33526 2549.5,33415 2549.5,33415",
		style=dashed];
	layer18_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2933,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer18_moe_split -> layer18_moe_comm_to_expert2	[pos="e,3004,33405 4117.7,33511 3752.8,33511 3004,33511 3004,33511 3004,33511 3004,33415 3004,33415",
		style=dashed];
	layer18_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3261,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer18_moe_split -> layer18_moe_comm_to_expert3	[pos="e,3337,33403 4102.7,33496 3815.8,33496 3337,33496 3337,33496 3337,33496 3337,33413 3337,33413",
		style=dashed];
	layer18_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3524,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer18_moe_split -> layer18_moe_comm_to_expert4	[pos="e,3587.5,33408 4087.4,33481 3874.5,33481 3587.5,33481 3587.5,33481 3587.5,33481 3587.5,33418 3587.5,33418",
		style=dashed];
	layer18_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3755,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer18_moe_split -> layer18_moe_comm_to_expert5	[pos="e,3793.5,33413 4072.6,33466 3936.6,33466 3793.5,33466 3793.5,33466 3793.5,33466 3793.5,33423 3793.5,33423",
		style=dashed];
	layer18_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3970,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer18_moe_split -> layer18_moe_comm_to_expert6	[pos="e,4060.8,33387 4073.5,33504 4073.5,33500 4073.5,33387 4073.5,33387 4073.5,33387 4070.8,33387 4070.8,33387",
		style=dashed];
	layer18_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4177,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer18_moe_split -> layer18_moe_comm_to_expert7	[pos="e,4177,33416 4177,33452 4177,33452 4177,33426 4177,33426",
		style=dashed];
	layer18_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4449,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer18_moe_split -> layer18_moe_comm_to_expert8	[pos="e,4449,33416 4449,33452 4449,33452 4449,33426 4449,33426",
		style=dashed];
	layer18_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4758,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer18_moe_split -> layer18_moe_comm_to_expert9	[pos="e,4667.3,33387 4553.3,33504 4553.3,33500 4553.3,33387 4553.3,33387 4553.3,33387 4657.3,33387 4657.3,33387",
		style=dashed];
	layer18_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5090,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer18_moe_split -> layer18_moe_comm_to_expert10	[pos="e,5014.1,33404 4477.4,33466 4684.6,33466 5014.1,33466 5014.1,33466 5014.1,33466 5014.1,33414 5014.1,33414",
		style=dashed];
	layer18_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5436,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer18_moe_split -> layer18_moe_comm_to_expert11	[pos="e,5360.6,33405 4492.2,33481 4791.5,33481 5360.6,33481 5360.6,33481 5360.6,33481 5360.6,33415 5360.6,33415",
		style=dashed];
	layer18_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5787,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer18_moe_split -> layer18_moe_comm_to_expert12	[pos="e,5711.6,33405 4507.1,33496 4891.2,33496 5711.6,33496 5711.6,33496 5711.6,33496 5711.6,33415 5711.6,33415",
		style=dashed];
	layer18_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6140,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer18_moe_split -> layer18_moe_comm_to_expert13	[pos="e,6065.1,33405 4522.2,33511 4987,33511 6065.1,33511 6065.1,33511 6065.1,33511 6065.1,33415 6065.1,33415",
		style=dashed];
	layer18_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6495,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer18_moe_split -> layer18_moe_comm_to_expert14	[pos="e,6420.1,33405 4537,33526 5079.6,33526 6420.1,33526 6420.1,33526 6420.1,33526 6420.1,33415 6420.1,33415",
		style=dashed];
	layer18_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6850,33387",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer18_moe_split -> layer18_moe_comm_to_expert15	[pos="e,6775.1,33405 4552.2,33541 5170.7,33541 6775.1,33541 6775.1,33541 6775.1,33541 6775.1,33415 6775.1,33415",
		style=dashed];
	layer18_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L18\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1718,33296",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer18_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1764,33205",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer18_moe_expert0 -> layer18_moe_comm_from_expert0	[pos="e,1764,33234 1764,33270 1764,33270 1764,33244 1764,33244"];
	layer18_moe_comm_to_expert0 -> layer18_moe_expert0	[pos="e,1764,33322 1764,33358 1764,33358 1764,33332 1764,33332"];
	layer18_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L18\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="2064,33296",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer18_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2477,33205",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer18_moe_expert1 -> layer18_moe_comm_from_expert1	[pos="e,2386.3,33205 2166.2,33270 2166.2,33243 2166.2,33205 2166.2,33205 2166.2,33205 2376.3,33205 2376.3,33205"];
	layer18_moe_comm_to_expert1 -> layer18_moe_expert1	[pos="e,2174.2,33322 2386.2,33387 2297,33387 2174.2,33387 2174.2,33387 2174.2,33387 2174.2,33332 2174.2,33332"];
	layer18_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L18\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2410,33296",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer18_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2933,33205",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer18_moe_expert2 -> layer18_moe_comm_from_expert2	[pos="e,2842.3,33205 2574.2,33287 2581.6,33287 2586,33287 2586,33287 2586,33287 2586,33205 2586,33205 2586,33205 2832.3,33205 2832.3,33205"];
	layer18_moe_comm_to_expert2 -> layer18_moe_expert2	[pos="e,2574.3,33304 2842.1,33387 2737.5,33387 2580,33387 2580,33387 2580,33387 2580,33304 2580,33304 2580,33304 2579.4,33304 2579.4,33304"];
	layer18_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L18\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2756,33296",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer18_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3261,33205",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer18_moe_expert3 -> layer18_moe_comm_from_expert3	[pos="e,3202.3,33227 2881.2,33270 2881.2,33258 2881.2,33246 2881.2,33246 2881.2,33246 3202.3,33246 3202.3,33246 3202.3,33246 3202.3,33237 \
3202.3,33237"];
	layer18_moe_comm_to_expert3 -> layer18_moe_expert3	[pos="e,2881.2,33322 3202.3,33365 3202.3,33355 3202.3,33346 3202.3,33346 3202.3,33346 2881.2,33346 2881.2,33346 2881.2,33346 2881.2,33332 \
2881.2,33332"];
	layer18_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L18\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3102,33296",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer18_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3524,33205",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer18_moe_expert4 -> layer18_moe_comm_from_expert4	[pos="e,3522.7,33234 3234.2,33270 3234.2,33263 3234.2,33258 3234.2,33258 3234.2,33258 3522.7,33258 3522.7,33258 3522.7,33258 3522.7,33244 \
3522.7,33244"];
	layer18_moe_comm_to_expert4 -> layer18_moe_expert4	[pos="e,3234.2,33322 3522.7,33358 3522.7,33346 3522.7,33334 3522.7,33334 3522.7,33334 3234.2,33334 3234.2,33334 3234.2,33334 3234.2,33332 \
3234.2,33332"];
	layer18_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L18\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3448,33296",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer18_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3755,33205",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer18_moe_expert5 -> layer18_moe_comm_from_expert5	[pos="e,3664.2,33205 3612.2,33287 3619.1,33287 3623.2,33287 3623.2,33287 3623.2,33287 3623.2,33205 3623.2,33205 3623.2,33205 3654.2,33205 \
3654.2,33205"];
	layer18_moe_comm_to_expert5 -> layer18_moe_expert5	[pos="e,3612.3,33304 3664.2,33387 3639.2,33387 3618.8,33387 3618.8,33387 3618.8,33387 3618.8,33304 3618.8,33304 3618.8,33304 3618.2,33304 \
3618.2,33304"];
	layer18_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L18\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3794,33296",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer18_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3970,33205",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer18_moe_expert6 -> layer18_moe_comm_from_expert6	[pos="e,3918.7,33229 3918.7,33270 3918.7,33270 3918.7,33239 3918.7,33239"];
	layer18_moe_comm_to_expert6 -> layer18_moe_expert6	[pos="e,3918.7,33322 3918.7,33363 3918.7,33363 3918.7,33332 3918.7,33332"];
	layer18_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L18\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4140,33296",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer18_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4177,33205",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer18_moe_expert7 -> layer18_moe_comm_from_expert7	[pos="e,4177,33234 4177,33270 4177,33270 4177,33244 4177,33244"];
	layer18_moe_comm_to_expert7 -> layer18_moe_expert7	[pos="e,4177,33322 4177,33358 4177,33358 4177,33332 4177,33332"];
	layer18_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L18\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4486,33296",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer18_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4449,33205",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer18_moe_expert8 -> layer18_moe_comm_from_expert8	[pos="e,4449,33234 4449,33270 4449,33270 4449,33244 4449,33244"];
	layer18_moe_comm_to_expert8 -> layer18_moe_expert8	[pos="e,4449,33322 4449,33358 4449,33358 4449,33332 4449,33332"];
	layer18_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L18\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4832,33296",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer18_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4758,33205",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer18_moe_expert9 -> layer18_moe_comm_from_expert9	[pos="e,4758.3,33234 4758.3,33270 4758.3,33270 4758.3,33244 4758.3,33244"];
	layer18_moe_comm_to_expert9 -> layer18_moe_expert9	[pos="e,4758.3,33322 4758.3,33358 4758.3,33358 4758.3,33332 4758.3,33332"];
	layer18_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L18\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5183,33296",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer18_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5090,33205",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer18_moe_expert10 -> layer18_moe_comm_from_expert10	[pos="e,5099.4,33234 5099.4,33270 5099.4,33270 5099.4,33244 5099.4,33244"];
	layer18_moe_comm_to_expert10 -> layer18_moe_expert10	[pos="e,5099,33322 5099,33358 5099,33358 5099,33332 5099,33332"];
	layer18_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L18\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5539,33296",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer18_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5437,33205",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer18_moe_expert11 -> layer18_moe_comm_from_expert11	[pos="e,5450.9,33234 5450.9,33270 5450.9,33270 5450.9,33244 5450.9,33244"];
	layer18_moe_comm_to_expert11 -> layer18_moe_expert11	[pos="e,5450,33322 5450,33358 5450,33358 5450,33332 5450,33332"];
	layer18_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L18\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5895,33296",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer18_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5788,33205",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer18_moe_expert12 -> layer18_moe_comm_from_expert12	[pos="e,5804.4,33234 5804.4,33270 5804.4,33270 5804.4,33244 5804.4,33244"];
	layer18_moe_comm_to_expert12 -> layer18_moe_expert12	[pos="e,5803.5,33322 5803.5,33358 5803.5,33358 5803.5,33332 5803.5,33332"];
	layer18_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L18\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6251,33296",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer18_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6142,33205",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer18_moe_expert13 -> layer18_moe_comm_from_expert13	[pos="e,6159.4,33234 6159.4,33270 6159.4,33270 6159.4,33244 6159.4,33244"];
	layer18_moe_comm_to_expert13 -> layer18_moe_expert13	[pos="e,6158,33322 6158,33358 6158,33358 6158,33332 6158,33332"];
	layer18_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L18\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6607,33296",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer18_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6497,33205",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer18_moe_expert14 -> layer18_moe_comm_from_expert14	[pos="e,6514.9,33234 6514.9,33270 6514.9,33270 6514.9,33244 6514.9,33244"];
	layer18_moe_comm_to_expert14 -> layer18_moe_expert14	[pos="e,6513.5,33322 6513.5,33358 6513.5,33358 6513.5,33332 6513.5,33332"];
	layer18_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L18\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6963,33296",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer18_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6852,33205",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer18_moe_expert15 -> layer18_moe_comm_from_expert15	[pos="e,6870.4,33234 6870.4,33270 6870.4,33270 6870.4,33244 6870.4,33244"];
	layer18_moe_comm_to_expert15 -> layer18_moe_expert15	[pos="e,6869,33322 6869,33358 6869,33358 6869,33332 6869,33332"];
	layer18_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L18\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4276,33088",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer19_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L19\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4276,32974",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer18_moe_aggregate -> layer19_moe_mha	[pos="e,4276,33000 4276,33036 4276,33036 4276,33010 4276,33010"];
	layer18_moe_comm_from_expert0 -> layer18_moe_aggregate	[pos="e,4028,33050 1849.8,33195 1849.8,33161 1849.8,33050 1849.8,33050 1849.8,33050 4018,33050 4018,33050"];
	layer18_moe_comm_from_expert1 -> layer18_moe_aggregate	[pos="e,4043.4,33065 2561.3,33194 2561.3,33161 2561.3,33065 2561.3,33065 2561.3,33065 4033.4,33065 4033.4,33065"];
	layer18_moe_comm_from_expert2 -> layer18_moe_aggregate	[pos="e,4059,33080 3005,33187 3005,33153 3005,33080 3005,33080 3005,33080 4049,33080 4049,33080"];
	layer18_moe_comm_from_expert3 -> layer18_moe_aggregate	[pos="e,4074.6,33095 3333,33187 3333,33156 3333,33095 3333,33095 3333,33095 4064.6,33095 4064.6,33095"];
	layer18_moe_comm_from_expert4 -> layer18_moe_aggregate	[pos="e,4090.1,33110 3603.8,33191 3603.8,33165 3603.8,33110 3603.8,33110 3603.8,33110 4080.1,33110 4080.1,33110"];
	layer18_moe_comm_from_expert5 -> layer18_moe_aggregate	[pos="e,4105.4,33125 3825.5,33187 3825.5,33163 3825.5,33125 3825.5,33125 3825.5,33125 4095.4,33125 4095.4,33125"];
	layer18_moe_comm_from_expert6 -> layer18_moe_aggregate	[pos="e,4037.1,33088 4037.1,33186 4037.1,33186 4037.1,33098 4037.1,33098"];
	layer18_moe_comm_from_expert7 -> layer18_moe_aggregate	[pos="e,4177,33140 4177,33176 4177,33176 4177,33150 4177,33150"];
	layer18_moe_comm_from_expert8 -> layer18_moe_aggregate	[pos="e,4448.4,33140 4448.4,33176 4448.4,33176 4448.4,33150 4448.4,33150"];
	layer18_moe_comm_from_expert9 -> layer18_moe_aggregate	[pos="e,4524.7,33127 4739.5,33176 4739.5,33154 4739.5,33127 4739.5,33127 4739.5,33127 4534.7,33127 4534.7,33127"];
	layer18_moe_comm_from_expert10 -> layer18_moe_aggregate	[pos="e,4511.3,33114 5071.1,33176 5071.1,33150 5071.1,33114 5071.1,33114 5071.1,33114 4521.3,33114 4521.3,33114"];
	layer18_moe_comm_from_expert11 -> layer18_moe_aggregate	[pos="e,4497.8,33101 5417.6,33177 5417.6,33146 5417.6,33101 5417.6,33101 5417.6,33101 4507.8,33101 4507.8,33101"];
	layer18_moe_comm_from_expert12 -> layer18_moe_aggregate	[pos="e,4484.7,33088 5768.6,33176 5768.6,33142 5768.6,33088 5768.6,33088 5768.6,33088 4494.7,33088 4494.7,33088"];
	layer18_moe_comm_from_expert13 -> layer18_moe_aggregate	[pos="e,4471.4,33075 6122.1,33177 6122.1,33138 6122.1,33075 6122.1,33075 6122.1,33075 4481.4,33075 4481.4,33075"];
	layer18_moe_comm_from_expert14 -> layer18_moe_aggregate	[pos="e,4458,33062 6477.1,33176 6477.1,33135 6477.1,33062 6477.1,33062 6477.1,33062 4468,33062 4468,33062"];
	layer18_moe_comm_from_expert15 -> layer18_moe_aggregate	[pos="e,4444.2,33049 6832.1,33176 6832.1,33131 6832.1,33049 6832.1,33049 6832.1,33049 4454.2,33049 4454.2,33049"];
	layer19_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L19\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4276,32860",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer19_moe_mha -> layer19_moe_gate	[pos="e,4276,32912 4276,32948 4276,32948 4276,32922 4276,32922"];
	layer19_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L19\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4276,32720",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer19_moe_gate -> layer19_moe_split	[pos="e,4276,32772 4276,32808 4276,32808 4276,32782 4276,32782"];
	layer19_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2195,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer19_moe_split -> layer19_moe_comm_to_expert0	[pos="e,2265.8,32621 4110.6,32757 3629.8,32757 2265.8,32757 2265.8,32757 2265.8,32757 2265.8,32631 2265.8,32631",
		style=dashed];
	layer19_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2440,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer19_moe_split -> layer19_moe_comm_to_expert1	[pos="e,2458.5,32632 4095.5,32742 3636.1,32742 2458.5,32742 2458.5,32742 2458.5,32742 2458.5,32642 2458.5,32642",
		style=dashed];
	layer19_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2896,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer19_moe_split -> layer19_moe_comm_to_expert2	[pos="e,2914.5,32632 4080.6,32727 3704,32727 2914.5,32727 2914.5,32727 2914.5,32727 2914.5,32642 2914.5,32642",
		style=dashed];
	layer19_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3224,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer19_moe_split -> layer19_moe_comm_to_expert3	[pos="e,3242.5,32632 4065.6,32712 3763.4,32712 3242.5,32712 3242.5,32712 3242.5,32712 3242.5,32642 3242.5,32642",
		style=dashed];
	layer19_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3487,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer19_moe_split -> layer19_moe_comm_to_expert4	[pos="e,3505.5,32632 4050.8,32697 3823.4,32697 3505.5,32697 3505.5,32697 3505.5,32697 3505.5,32642 3505.5,32642",
		style=dashed];
	layer19_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3718,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer19_moe_split -> layer19_moe_comm_to_expert5	[pos="e,3736.5,32632 4035.8,32682 3891.9,32682 3736.5,32682 3736.5,32682 3736.5,32682 3736.5,32642 3736.5,32642",
		style=dashed];
	layer19_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3933,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer19_moe_split -> layer19_moe_comm_to_expert6	[pos="e,4023.8,32603 4036.5,32720 4036.5,32716 4036.5,32603 4036.5,32603 4036.5,32603 4033.8,32603 4033.8,32603",
		style=dashed];
	layer19_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4140,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer19_moe_split -> layer19_moe_comm_to_expert7	[pos="e,4140,32632 4140,32668 4140,32668 4140,32642 4140,32642",
		style=dashed];
	layer19_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4412,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer19_moe_split -> layer19_moe_comm_to_expert8	[pos="e,4412,32632 4412,32668 4412,32668 4412,32642 4412,32642",
		style=dashed];
	layer19_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4721,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer19_moe_split -> layer19_moe_comm_to_expert9	[pos="e,4630.3,32603 4516.3,32720 4516.3,32716 4516.3,32603 4516.3,32603 4516.3,32603 4620.3,32603 4620.3,32603",
		style=dashed];
	layer19_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5053,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer19_moe_split -> layer19_moe_comm_to_expert10	[pos="e,4977.1,32620 4440.4,32682 4647.6,32682 4977.1,32682 4977.1,32682 4977.1,32682 4977.1,32630 4977.1,32630",
		style=dashed];
	layer19_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5399,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer19_moe_split -> layer19_moe_comm_to_expert11	[pos="e,5323.6,32621 4455.2,32697 4754.5,32697 5323.6,32697 5323.6,32697 5323.6,32697 5323.6,32631 5323.6,32631",
		style=dashed];
	layer19_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5750,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer19_moe_split -> layer19_moe_comm_to_expert12	[pos="e,5674.6,32621 4470.1,32712 4854.2,32712 5674.6,32712 5674.6,32712 5674.6,32712 5674.6,32631 5674.6,32631",
		style=dashed];
	layer19_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6103,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer19_moe_split -> layer19_moe_comm_to_expert13	[pos="e,6028.1,32621 4485.2,32727 4950,32727 6028.1,32727 6028.1,32727 6028.1,32727 6028.1,32631 6028.1,32631",
		style=dashed];
	layer19_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6458,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer19_moe_split -> layer19_moe_comm_to_expert14	[pos="e,6383.1,32621 4500,32742 5042.6,32742 6383.1,32742 6383.1,32742 6383.1,32742 6383.1,32631 6383.1,32631",
		style=dashed];
	layer19_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6813,32603",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer19_moe_split -> layer19_moe_comm_to_expert15	[pos="e,6738.1,32621 4515.2,32757 5133.7,32757 6738.1,32757 6738.1,32757 6738.1,32757 6738.1,32631 6738.1,32631",
		style=dashed];
	layer19_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L19\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1681,32512",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer19_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1727,32421",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer19_moe_expert0 -> layer19_moe_comm_from_expert0	[pos="e,1727,32450 1727,32486 1727,32486 1727,32460 1727,32460"];
	layer19_moe_comm_to_expert0 -> layer19_moe_expert0	[pos="e,1759.2,32538 2104.4,32603 1976.8,32603 1759.2,32603 1759.2,32603 1759.2,32603 1759.2,32548 1759.2,32548"];
	layer19_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L19\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="2027,32512",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer19_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2440,32421",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer19_moe_expert1 -> layer19_moe_comm_from_expert1	[pos="e,2349.2,32421 2181.5,32486 2181.5,32459 2181.5,32421 2181.5,32421 2181.5,32421 2339.2,32421 2339.2,32421"];
	layer19_moe_comm_to_expert1 -> layer19_moe_expert1	[pos="e,2147.7,32538 2440,32574 2440,32560 2440,32547 2440,32547 2440,32547 2147.7,32547 2147.7,32547 2147.7,32547 2147.7,32546 2147.7,\
32546"];
	layer19_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L19\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2373,32512",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer19_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2896,32421",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer19_moe_expert2 -> layer19_moe_comm_from_expert2	[pos="e,2805.3,32421 2537.2,32503 2544.6,32503 2549,32503 2549,32503 2549,32503 2549,32421 2549,32421 2549,32421 2795.3,32421 2795.3,32421"];
	layer19_moe_comm_to_expert2 -> layer19_moe_expert2	[pos="e,2537.3,32520 2805.1,32603 2700.5,32603 2543,32603 2543,32603 2543,32603 2543,32520 2543,32520 2543,32520 2542.4,32520 2542.4,32520"];
	layer19_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L19\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2719,32512",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer19_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3224,32421",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer19_moe_expert3 -> layer19_moe_comm_from_expert3	[pos="e,3165.3,32443 2844.2,32486 2844.2,32474 2844.2,32462 2844.2,32462 2844.2,32462 3165.3,32462 3165.3,32462 3165.3,32462 3165.3,32453 \
3165.3,32453"];
	layer19_moe_comm_to_expert3 -> layer19_moe_expert3	[pos="e,2844.2,32538 3165.3,32581 3165.3,32573 3165.3,32565 3165.3,32565 3165.3,32565 2844.2,32565 2844.2,32565 2844.2,32565 2844.2,32548 \
2844.2,32548"];
	layer19_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L19\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3065,32512",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer19_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3487,32421",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer19_moe_expert4 -> layer19_moe_comm_from_expert4	[pos="e,3485.7,32450 3197.2,32486 3197.2,32479 3197.2,32474 3197.2,32474 3197.2,32474 3485.7,32474 3485.7,32474 3485.7,32474 3485.7,32460 \
3485.7,32460"];
	layer19_moe_comm_to_expert4 -> layer19_moe_expert4	[pos="e,3197.2,32538 3485.7,32574 3485.7,32564 3485.7,32556 3485.7,32556 3485.7,32556 3197.2,32556 3197.2,32556 3197.2,32556 3197.2,32548 \
3197.2,32548"];
	layer19_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L19\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3411,32512",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer19_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3718,32421",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer19_moe_expert5 -> layer19_moe_comm_from_expert5	[pos="e,3627.2,32421 3575.2,32503 3582.1,32503 3586.2,32503 3586.2,32503 3586.2,32503 3586.2,32421 3586.2,32421 3586.2,32421 3617.2,32421 \
3617.2,32421"];
	layer19_moe_comm_to_expert5 -> layer19_moe_expert5	[pos="e,3575.3,32520 3627.2,32603 3602.2,32603 3581.8,32603 3581.8,32603 3581.8,32603 3581.8,32520 3581.8,32520 3581.8,32520 3581.2,32520 \
3581.2,32520"];
	layer19_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L19\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3757,32512",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer19_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3933,32421",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer19_moe_expert6 -> layer19_moe_comm_from_expert6	[pos="e,3881.7,32445 3881.7,32486 3881.7,32486 3881.7,32455 3881.7,32455"];
	layer19_moe_comm_to_expert6 -> layer19_moe_expert6	[pos="e,3881.7,32538 3881.7,32579 3881.7,32579 3881.7,32548 3881.7,32548"];
	layer19_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L19\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4103,32512",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer19_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4140,32421",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer19_moe_expert7 -> layer19_moe_comm_from_expert7	[pos="e,4140,32450 4140,32486 4140,32486 4140,32460 4140,32460"];
	layer19_moe_comm_to_expert7 -> layer19_moe_expert7	[pos="e,4140,32538 4140,32574 4140,32574 4140,32548 4140,32548"];
	layer19_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L19\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4449,32512",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer19_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4412,32421",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer19_moe_expert8 -> layer19_moe_comm_from_expert8	[pos="e,4412,32450 4412,32486 4412,32486 4412,32460 4412,32460"];
	layer19_moe_comm_to_expert8 -> layer19_moe_expert8	[pos="e,4412,32538 4412,32574 4412,32574 4412,32548 4412,32548"];
	layer19_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L19\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4795,32512",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer19_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4721,32421",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer19_moe_expert9 -> layer19_moe_comm_from_expert9	[pos="e,4721.3,32450 4721.3,32486 4721.3,32486 4721.3,32460 4721.3,32460"];
	layer19_moe_comm_to_expert9 -> layer19_moe_expert9	[pos="e,4721.3,32538 4721.3,32574 4721.3,32574 4721.3,32548 4721.3,32548"];
	layer19_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L19\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5146,32512",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer19_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5053,32421",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer19_moe_expert10 -> layer19_moe_comm_from_expert10	[pos="e,5062.4,32450 5062.4,32486 5062.4,32486 5062.4,32460 5062.4,32460"];
	layer19_moe_comm_to_expert10 -> layer19_moe_expert10	[pos="e,5062,32538 5062,32574 5062,32574 5062,32548 5062,32548"];
	layer19_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L19\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5502,32512",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer19_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5400,32421",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer19_moe_expert11 -> layer19_moe_comm_from_expert11	[pos="e,5413.9,32450 5413.9,32486 5413.9,32486 5413.9,32460 5413.9,32460"];
	layer19_moe_comm_to_expert11 -> layer19_moe_expert11	[pos="e,5413,32538 5413,32574 5413,32574 5413,32548 5413,32548"];
	layer19_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L19\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5858,32512",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer19_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5751,32421",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer19_moe_expert12 -> layer19_moe_comm_from_expert12	[pos="e,5767.4,32450 5767.4,32486 5767.4,32486 5767.4,32460 5767.4,32460"];
	layer19_moe_comm_to_expert12 -> layer19_moe_expert12	[pos="e,5766.5,32538 5766.5,32574 5766.5,32574 5766.5,32548 5766.5,32548"];
	layer19_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L19\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6214,32512",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer19_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6105,32421",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer19_moe_expert13 -> layer19_moe_comm_from_expert13	[pos="e,6122.4,32450 6122.4,32486 6122.4,32486 6122.4,32460 6122.4,32460"];
	layer19_moe_comm_to_expert13 -> layer19_moe_expert13	[pos="e,6121,32538 6121,32574 6121,32574 6121,32548 6121,32548"];
	layer19_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L19\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6570,32512",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer19_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6460,32421",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer19_moe_expert14 -> layer19_moe_comm_from_expert14	[pos="e,6477.9,32450 6477.9,32486 6477.9,32486 6477.9,32460 6477.9,32460"];
	layer19_moe_comm_to_expert14 -> layer19_moe_expert14	[pos="e,6476.5,32538 6476.5,32574 6476.5,32574 6476.5,32548 6476.5,32548"];
	layer19_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L19\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6926,32512",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer19_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6815,32421",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer19_moe_expert15 -> layer19_moe_comm_from_expert15	[pos="e,6833.4,32450 6833.4,32486 6833.4,32486 6833.4,32460 6833.4,32460"];
	layer19_moe_comm_to_expert15 -> layer19_moe_expert15	[pos="e,6832,32538 6832,32574 6832,32574 6832,32548 6832,32548"];
	layer19_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L19\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4239,32304",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer20_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L20\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4239,32190",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer19_moe_aggregate -> layer20_moe_mha	[pos="e,4239,32216 4239,32252 4239,32252 4239,32226 4239,32226"];
	layer19_moe_comm_from_expert0 -> layer19_moe_aggregate	[pos="e,3991,32266 1812.8,32411 1812.8,32377 1812.8,32266 1812.8,32266 1812.8,32266 3981,32266 3981,32266"];
	layer19_moe_comm_from_expert1 -> layer19_moe_aggregate	[pos="e,4006.4,32281 2524.3,32410 2524.3,32377 2524.3,32281 2524.3,32281 2524.3,32281 3996.4,32281 3996.4,32281"];
	layer19_moe_comm_from_expert2 -> layer19_moe_aggregate	[pos="e,4022,32296 2968,32403 2968,32369 2968,32296 2968,32296 2968,32296 4012,32296 4012,32296"];
	layer19_moe_comm_from_expert3 -> layer19_moe_aggregate	[pos="e,4037.6,32311 3296,32403 3296,32372 3296,32311 3296,32311 3296,32311 4027.6,32311 4027.6,32311"];
	layer19_moe_comm_from_expert4 -> layer19_moe_aggregate	[pos="e,4053.1,32326 3566.8,32407 3566.8,32381 3566.8,32326 3566.8,32326 3566.8,32326 4043.1,32326 4043.1,32326"];
	layer19_moe_comm_from_expert5 -> layer19_moe_aggregate	[pos="e,4068.4,32341 3788.5,32403 3788.5,32379 3788.5,32341 3788.5,32341 3788.5,32341 4058.4,32341 4058.4,32341"];
	layer19_moe_comm_from_expert6 -> layer19_moe_aggregate	[pos="e,4000.1,32304 4000.1,32402 4000.1,32402 4000.1,32314 4000.1,32314"];
	layer19_moe_comm_from_expert7 -> layer19_moe_aggregate	[pos="e,4140,32356 4140,32392 4140,32392 4140,32366 4140,32366"];
	layer19_moe_comm_from_expert8 -> layer19_moe_aggregate	[pos="e,4411.4,32356 4411.4,32392 4411.4,32392 4411.4,32366 4411.4,32366"];
	layer19_moe_comm_from_expert9 -> layer19_moe_aggregate	[pos="e,4487.7,32343 4702.5,32392 4702.5,32370 4702.5,32343 4702.5,32343 4702.5,32343 4497.7,32343 4497.7,32343"];
	layer19_moe_comm_from_expert10 -> layer19_moe_aggregate	[pos="e,4474.3,32330 5034.1,32392 5034.1,32366 5034.1,32330 5034.1,32330 5034.1,32330 4484.3,32330 4484.3,32330"];
	layer19_moe_comm_from_expert11 -> layer19_moe_aggregate	[pos="e,4460.8,32317 5380.6,32393 5380.6,32362 5380.6,32317 5380.6,32317 5380.6,32317 4470.8,32317 4470.8,32317"];
	layer19_moe_comm_from_expert12 -> layer19_moe_aggregate	[pos="e,4447.7,32304 5731.6,32392 5731.6,32358 5731.6,32304 5731.6,32304 5731.6,32304 4457.7,32304 4457.7,32304"];
	layer19_moe_comm_from_expert13 -> layer19_moe_aggregate	[pos="e,4434,32291 6085.1,32393 6085.1,32354 6085.1,32291 6085.1,32291 6085.1,32291 4444,32291 4444,32291"];
	layer19_moe_comm_from_expert14 -> layer19_moe_aggregate	[pos="e,4420.5,32278 6440.1,32392 6440.1,32351 6440.1,32278 6440.1,32278 6440.1,32278 4430.5,32278 4430.5,32278"];
	layer19_moe_comm_from_expert15 -> layer19_moe_aggregate	[pos="e,4407.2,32265 6795.1,32392 6795.1,32347 6795.1,32265 6795.1,32265 6795.1,32265 4417.2,32265 4417.2,32265"];
	layer20_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L20\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4239,32076",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer20_moe_mha -> layer20_moe_gate	[pos="e,4239,32128 4239,32164 4239,32164 4239,32138 4239,32138"];
	layer20_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L20\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4239,31936",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer20_moe_gate -> layer20_moe_split	[pos="e,4239,31988 4239,32024 4239,32024 4239,31998 4239,31998"];
	layer20_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1690,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer20_moe_split -> layer20_moe_comm_to_expert0	[pos="e,1708.5,31848 4073.5,31973 3511,31973 1708.5,31973 1708.5,31973 1708.5,31973 1708.5,31858 1708.5,31858",
		style=dashed];
	layer20_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2403,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer20_moe_split -> layer20_moe_comm_to_expert1	[pos="e,2421.5,31848 4058.5,31958 3599.1,31958 2421.5,31958 2421.5,31958 2421.5,31958 2421.5,31858 2421.5,31858",
		style=dashed];
	layer20_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2859,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer20_moe_split -> layer20_moe_comm_to_expert2	[pos="e,2877.5,31848 4043.6,31943 3667,31943 2877.5,31943 2877.5,31943 2877.5,31943 2877.5,31858 2877.5,31858",
		style=dashed];
	layer20_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3187,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer20_moe_split -> layer20_moe_comm_to_expert3	[pos="e,3205.5,31848 4028.6,31928 3726.4,31928 3205.5,31928 3205.5,31928 3205.5,31928 3205.5,31858 3205.5,31858",
		style=dashed];
	layer20_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3450,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer20_moe_split -> layer20_moe_comm_to_expert4	[pos="e,3468.5,31848 4013.8,31913 3786.4,31913 3468.5,31913 3468.5,31913 3468.5,31913 3468.5,31858 3468.5,31858",
		style=dashed];
	layer20_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3681,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer20_moe_split -> layer20_moe_comm_to_expert5	[pos="e,3699.5,31848 3998.8,31898 3854.9,31898 3699.5,31898 3699.5,31898 3699.5,31898 3699.5,31858 3699.5,31858",
		style=dashed];
	layer20_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3896,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer20_moe_split -> layer20_moe_comm_to_expert6	[pos="e,3986.8,31819 3999.5,31936 3999.5,31932 3999.5,31819 3999.5,31819 3999.5,31819 3996.8,31819 3996.8,31819",
		style=dashed];
	layer20_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4103,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer20_moe_split -> layer20_moe_comm_to_expert7	[pos="e,4103,31848 4103,31884 4103,31884 4103,31858 4103,31858",
		style=dashed];
	layer20_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4375,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer20_moe_split -> layer20_moe_comm_to_expert8	[pos="e,4375,31848 4375,31884 4375,31884 4375,31858 4375,31858",
		style=dashed];
	layer20_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4684,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer20_moe_split -> layer20_moe_comm_to_expert9	[pos="e,4593.3,31819 4479.3,31936 4479.3,31932 4479.3,31819 4479.3,31819 4479.3,31819 4583.3,31819 4583.3,31819",
		style=dashed];
	layer20_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="5016,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer20_moe_split -> layer20_moe_comm_to_expert10	[pos="e,4940.1,31837 4402.9,31898 4610.1,31898 4940.1,31898 4940.1,31898 4940.1,31898 4940.1,31847 4940.1,31847",
		style=dashed];
	layer20_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5362,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer20_moe_split -> layer20_moe_comm_to_expert11	[pos="e,5286.6,31837 4418.2,31913 4717.5,31913 5286.6,31913 5286.6,31913 5286.6,31913 5286.6,31847 5286.6,31847",
		style=dashed];
	layer20_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5713,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer20_moe_split -> layer20_moe_comm_to_expert12	[pos="e,5637.6,31837 4433.1,31928 4817.2,31928 5637.6,31928 5637.6,31928 5637.6,31928 5637.6,31847 5637.6,31847",
		style=dashed];
	layer20_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6066,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer20_moe_split -> layer20_moe_comm_to_expert13	[pos="e,5991.1,31837 4448.2,31943 4913,31943 5991.1,31943 5991.1,31943 5991.1,31943 5991.1,31847 5991.1,31847",
		style=dashed];
	layer20_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6421,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer20_moe_split -> layer20_moe_comm_to_expert14	[pos="e,6346.1,31837 4463,31958 5005.6,31958 6346.1,31958 6346.1,31958 6346.1,31958 6346.1,31847 6346.1,31847",
		style=dashed];
	layer20_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6776,31819",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer20_moe_split -> layer20_moe_comm_to_expert15	[pos="e,6701.1,31837 4478.2,31973 5096.7,31973 6701.1,31973 6701.1,31973 6701.1,31973 6701.1,31847 6701.1,31847",
		style=dashed];
	layer20_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L20\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1644,31728",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer20_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1810,31637",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer20_moe_expert0 -> layer20_moe_comm_from_expert0	[pos="e,1763.7,31662 1763.7,31702 1763.7,31702 1763.7,31672 1763.7,31672"];
	layer20_moe_comm_to_expert0 -> layer20_moe_expert0	[pos="e,1690,31754 1690,31790 1690,31790 1690,31764 1690,31764"];
	layer20_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L20\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1990,31728",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer20_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2156,31637",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer20_moe_expert1 -> layer20_moe_comm_from_expert1	[pos="e,2109.7,31662 2109.7,31702 2109.7,31702 2109.7,31672 2109.7,31672"];
	layer20_moe_comm_to_expert1 -> layer20_moe_expert1	[pos="e,2008.5,31754 2312,31819 2195.5,31819 2008.5,31819 2008.5,31819 2008.5,31819 2008.5,31764 2008.5,31764"];
	layer20_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L20\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2336,31728",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer20_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2428,31637",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer20_moe_expert2 -> layer20_moe_comm_from_expert2	[pos="e,2418.7,31666 2418.7,31702 2418.7,31702 2418.7,31676 2418.7,31676"];
	layer20_moe_comm_to_expert2 -> layer20_moe_expert2	[pos="e,2500.2,31728 2768.4,31819 2664.7,31819 2509,31819 2509,31819 2509,31819 2509,31728 2509,31728 2509,31728 2508.1,31728 2508.1,31728"];
	layer20_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L20\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2682,31728",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer20_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2756,31637",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer20_moe_expert3 -> layer20_moe_comm_from_expert3	[pos="e,2755.7,31666 2755.7,31702 2755.7,31702 2755.7,31676 2755.7,31676"];
	layer20_moe_comm_to_expert3 -> layer20_moe_expert3	[pos="e,2807.2,31754 3128.3,31797 3128.3,31787 3128.3,31778 3128.3,31778 3128.3,31778 2807.2,31778 2807.2,31778 2807.2,31778 2807.2,31764 \
2807.2,31764"];
	layer20_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L20\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="3028,31728",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer20_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3249,31637",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer20_moe_expert4 -> layer20_moe_comm_from_expert4	[pos="e,3175.2,31654 3175.2,31702 3175.2,31702 3175.2,31664 3175.2,31664"];
	layer20_moe_comm_to_expert4 -> layer20_moe_expert4	[pos="e,3160.2,31754 3448.7,31790 3448.7,31778 3448.7,31766 3448.7,31766 3448.7,31766 3160.2,31766 3160.2,31766 3160.2,31766 3160.2,31764 \
3160.2,31764"];
	layer20_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L20\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3374,31728",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer20_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3595,31637",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer20_moe_expert5 -> layer20_moe_comm_from_expert5	[pos="e,3521.2,31654 3521.2,31702 3521.2,31702 3521.2,31664 3521.2,31664"];
	layer20_moe_comm_to_expert5 -> layer20_moe_expert5	[pos="e,3538.1,31728 3590.3,31819 3566.9,31819 3548.3,31819 3548.3,31819 3548.3,31819 3548.3,31728 3548.3,31728 3548.3,31728 3547.2,31728 \
3547.2,31728"];
	layer20_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L20\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3720,31728",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer20_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3867,31637",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer20_moe_expert6 -> layer20_moe_comm_from_expert6	[pos="e,3830.2,31664 3830.2,31702 3830.2,31702 3830.2,31674 3830.2,31674"];
	layer20_moe_comm_to_expert6 -> layer20_moe_expert6	[pos="e,3844.7,31754 3844.7,31795 3844.7,31795 3844.7,31764 3844.7,31764"];
	layer20_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L20\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4066,31728",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer20_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4103,31637",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer20_moe_expert7 -> layer20_moe_comm_from_expert7	[pos="e,4103,31666 4103,31702 4103,31702 4103,31676 4103,31676"];
	layer20_moe_comm_to_expert7 -> layer20_moe_expert7	[pos="e,4103,31754 4103,31790 4103,31790 4103,31764 4103,31764"];
	layer20_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L20\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4412,31728",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer20_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4375,31637",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer20_moe_expert8 -> layer20_moe_comm_from_expert8	[pos="e,4375,31666 4375,31702 4375,31702 4375,31676 4375,31676"];
	layer20_moe_comm_to_expert8 -> layer20_moe_expert8	[pos="e,4375,31754 4375,31790 4375,31790 4375,31764 4375,31764"];
	layer20_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L20\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4758,31728",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer20_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4684,31637",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer20_moe_expert9 -> layer20_moe_comm_from_expert9	[pos="e,4684.3,31666 4684.3,31702 4684.3,31702 4684.3,31676 4684.3,31676"];
	layer20_moe_comm_to_expert9 -> layer20_moe_expert9	[pos="e,4684.3,31754 4684.3,31790 4684.3,31790 4684.3,31764 4684.3,31764"];
	layer20_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L20\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5109,31728",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer20_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="5016,31637",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer20_moe_expert10 -> layer20_moe_comm_from_expert10	[pos="e,5025.4,31666 5025.4,31702 5025.4,31702 5025.4,31676 5025.4,31676"];
	layer20_moe_comm_to_expert10 -> layer20_moe_expert10	[pos="e,5025,31754 5025,31790 5025,31790 5025,31764 5025,31764"];
	layer20_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L20\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5465,31728",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer20_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5363,31637",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer20_moe_expert11 -> layer20_moe_comm_from_expert11	[pos="e,5376.9,31666 5376.9,31702 5376.9,31702 5376.9,31676 5376.9,31676"];
	layer20_moe_comm_to_expert11 -> layer20_moe_expert11	[pos="e,5376,31754 5376,31790 5376,31790 5376,31764 5376,31764"];
	layer20_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L20\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5821,31728",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer20_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5714,31637",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer20_moe_expert12 -> layer20_moe_comm_from_expert12	[pos="e,5730.4,31666 5730.4,31702 5730.4,31702 5730.4,31676 5730.4,31676"];
	layer20_moe_comm_to_expert12 -> layer20_moe_expert12	[pos="e,5729.5,31754 5729.5,31790 5729.5,31790 5729.5,31764 5729.5,31764"];
	layer20_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L20\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6177,31728",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer20_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6068,31637",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer20_moe_expert13 -> layer20_moe_comm_from_expert13	[pos="e,6085.4,31666 6085.4,31702 6085.4,31702 6085.4,31676 6085.4,31676"];
	layer20_moe_comm_to_expert13 -> layer20_moe_expert13	[pos="e,6084,31754 6084,31790 6084,31790 6084,31764 6084,31764"];
	layer20_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L20\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6533,31728",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer20_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6423,31637",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer20_moe_expert14 -> layer20_moe_comm_from_expert14	[pos="e,6440.9,31666 6440.9,31702 6440.9,31702 6440.9,31676 6440.9,31676"];
	layer20_moe_comm_to_expert14 -> layer20_moe_expert14	[pos="e,6439.5,31754 6439.5,31790 6439.5,31790 6439.5,31764 6439.5,31764"];
	layer20_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L20\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6889,31728",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer20_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6778,31637",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer20_moe_expert15 -> layer20_moe_comm_from_expert15	[pos="e,6796.4,31666 6796.4,31702 6796.4,31702 6796.4,31676 6796.4,31676"];
	layer20_moe_comm_to_expert15 -> layer20_moe_expert15	[pos="e,6795,31754 6795,31790 6795,31790 6795,31764 6795,31764"];
	layer20_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L20\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4202,31520",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer21_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L21\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4202,31406",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer20_moe_aggregate -> layer21_moe_mha	[pos="e,4202,31432 4202,31468 4202,31468 4202,31442 4202,31442"];
	layer20_moe_comm_from_expert0 -> layer20_moe_aggregate	[pos="e,3955,31483 1844.8,31610 1844.8,31566 1844.8,31483 1844.8,31483 1844.8,31483 3945,31483 3945,31483"];
	layer20_moe_comm_from_expert1 -> layer20_moe_aggregate	[pos="e,3969.4,31497 2229,31620 2229,31583 2229,31497 2229,31497 2229,31497 3959.4,31497 3959.4,31497"];
	layer20_moe_comm_from_expert2 -> layer20_moe_aggregate	[pos="e,3985.1,31512 2499.8,31619 2499.8,31585 2499.8,31512 2499.8,31512 2499.8,31512 3975.1,31512 3975.1,31512"];
	layer20_moe_comm_from_expert3 -> layer20_moe_aggregate	[pos="e,4000.3,31527 2789,31610 2789,31577 2789,31527 2789,31527 2789,31527 3990.3,31527 3990.3,31527"];
	layer20_moe_comm_from_expert4 -> layer20_moe_aggregate	[pos="e,4016,31542 3331,31625 3331,31599 3331,31542 3331,31542 3331,31542 4006,31542 4006,31542"];
	layer20_moe_comm_from_expert5 -> layer20_moe_aggregate	[pos="e,4031.2,31557 3619.5,31609 3619.5,31586 3619.5,31557 3619.5,31557 3619.5,31557 4021.2,31557 4021.2,31557"];
	layer20_moe_comm_from_expert6 -> layer20_moe_aggregate	[pos="e,3948.6,31520 3948.6,31624 3948.6,31624 3948.6,31530 3948.6,31530"];
	layer20_moe_comm_from_expert7 -> layer20_moe_aggregate	[pos="e,4103,31572 4103,31608 4103,31608 4103,31582 4103,31582"];
	layer20_moe_comm_from_expert8 -> layer20_moe_aggregate	[pos="e,4374.4,31572 4374.4,31608 4374.4,31608 4374.4,31582 4374.4,31582"];
	layer20_moe_comm_from_expert9 -> layer20_moe_aggregate	[pos="e,4450.7,31559 4665.5,31608 4665.5,31586 4665.5,31559 4665.5,31559 4665.5,31559 4460.7,31559 4460.7,31559"];
	layer20_moe_comm_from_expert10 -> layer20_moe_aggregate	[pos="e,4437.3,31546 4997.1,31608 4997.1,31582 4997.1,31546 4997.1,31546 4997.1,31546 4447.3,31546 4447.3,31546"];
	layer20_moe_comm_from_expert11 -> layer20_moe_aggregate	[pos="e,4423.8,31533 5343.6,31609 5343.6,31578 5343.6,31533 5343.6,31533 5343.6,31533 4433.8,31533 4433.8,31533"];
	layer20_moe_comm_from_expert12 -> layer20_moe_aggregate	[pos="e,4410.3,31520 5694.6,31608 5694.6,31574 5694.6,31520 5694.6,31520 5694.6,31520 4420.3,31520 4420.3,31520"];
	layer20_moe_comm_from_expert13 -> layer20_moe_aggregate	[pos="e,4397,31507 6048.1,31609 6048.1,31570 6048.1,31507 6048.1,31507 6048.1,31507 4407,31507 4407,31507"];
	layer20_moe_comm_from_expert14 -> layer20_moe_aggregate	[pos="e,4383.5,31494 6403.1,31609 6403.1,31567 6403.1,31494 6403.1,31494 6403.1,31494 4393.5,31494 4393.5,31494"];
	layer20_moe_comm_from_expert15 -> layer20_moe_aggregate	[pos="e,4370.2,31481 6758.1,31609 6758.1,31563 6758.1,31481 6758.1,31481 6758.1,31481 4380.2,31481 4380.2,31481"];
	layer21_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L21\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4202,31292",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer21_moe_mha -> layer21_moe_gate	[pos="e,4202,31344 4202,31380 4202,31380 4202,31354 4202,31354"];
	layer21_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L21\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4202,31152",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer21_moe_gate -> layer21_moe_split	[pos="e,4202,31204 4202,31240 4202,31240 4202,31214 4202,31214"];
	layer21_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2121,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer21_moe_split -> layer21_moe_comm_to_expert0	[pos="e,2138.5,31064 4036.6,31189 3547,31189 2138.5,31189 2138.5,31189 2138.5,31189 2138.5,31074 2138.5,31074",
		style=dashed];
	layer21_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2366,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer21_moe_split -> layer21_moe_comm_to_expert1	[pos="e,2397,31063 4021.5,31174 3564.4,31174 2397,31174 2397,31174 2397,31174 2397,31073 2397,31073",
		style=dashed];
	layer21_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2822,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer21_moe_split -> layer21_moe_comm_to_expert2	[pos="e,2888.3,31055 4006.7,31159 3640.8,31159 2888.3,31159 2888.3,31159 2888.3,31159 2888.3,31065 2888.3,31065",
		style=dashed];
	layer21_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3150,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer21_moe_split -> layer21_moe_comm_to_expert3	[pos="e,3199.5,31060 3991.5,31144 3697.5,31144 3199.5,31144 3199.5,31144 3199.5,31144 3199.5,31070 3199.5,31070",
		style=dashed];
	layer21_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3413,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer21_moe_split -> layer21_moe_comm_to_expert4	[pos="e,3421.5,31064 3976.8,31129 3746.2,31129 3421.5,31129 3421.5,31129 3421.5,31129 3421.5,31074 3421.5,31074",
		style=dashed];
	layer21_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3644,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer21_moe_split -> layer21_moe_comm_to_expert5	[pos="e,3710,31055 3962.5,31115 3837.4,31115 3710,31115 3710,31115 3710,31115 3710,31065 3710,31065",
		style=dashed];
	layer21_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3859,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer21_moe_split -> layer21_moe_comm_to_expert6	[pos="e,3949.8,31035 3962.5,31152 3962.5,31149 3962.5,31035 3962.5,31035 3962.5,31035 3959.8,31035 3959.8,31035",
		style=dashed];
	layer21_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4066,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer21_moe_split -> layer21_moe_comm_to_expert7	[pos="e,4066,31064 4066,31100 4066,31100 4066,31074 4066,31074",
		style=dashed];
	layer21_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4338,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer21_moe_split -> layer21_moe_comm_to_expert8	[pos="e,4338,31064 4338,31100 4338,31100 4338,31074 4338,31074",
		style=dashed];
	layer21_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4647,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer21_moe_split -> layer21_moe_comm_to_expert9	[pos="e,4556.3,31035 4442.3,31152 4442.3,31149 4442.3,31035 4442.3,31035 4442.3,31035 4546.3,31035 4546.3,31035",
		style=dashed];
	layer21_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4979,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer21_moe_split -> layer21_moe_comm_to_expert10	[pos="e,4903.1,31052 4367.3,31115 4574.5,31115 4903.1,31115 4903.1,31115 4903.1,31115 4903.1,31062 4903.1,31062",
		style=dashed];
	layer21_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5325,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer21_moe_split -> layer21_moe_comm_to_expert11	[pos="e,5249.6,31053 4380.9,31129 4680.1,31129 5249.6,31129 5249.6,31129 5249.6,31129 5249.6,31063 5249.6,31063",
		style=dashed];
	layer21_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5676,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer21_moe_split -> layer21_moe_comm_to_expert12	[pos="e,5600.6,31053 4396.1,31144 4780.2,31144 5600.6,31144 5600.6,31144 5600.6,31144 5600.6,31063 5600.6,31063",
		style=dashed];
	layer21_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="6029,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer21_moe_split -> layer21_moe_comm_to_expert13	[pos="e,5954.1,31053 4411.2,31159 4876,31159 5954.1,31159 5954.1,31159 5954.1,31159 5954.1,31063 5954.1,31063",
		style=dashed];
	layer21_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6384,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer21_moe_split -> layer21_moe_comm_to_expert14	[pos="e,6309.1,31053 4426,31174 4968.6,31174 6309.1,31174 6309.1,31174 6309.1,31174 6309.1,31063 6309.1,31063",
		style=dashed];
	layer21_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6739,31035",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer21_moe_split -> layer21_moe_comm_to_expert15	[pos="e,6664.1,31053 4440.9,31189 5059.2,31189 6664.1,31189 6664.1,31189 6664.1,31189 6664.1,31063 6664.1,31063",
		style=dashed];
	layer21_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L21\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1607,30944",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer21_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2121,30853",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer21_moe_expert0 -> layer21_moe_comm_from_expert0	[pos="e,2030.3,30853 1761.5,30918 1761.5,30891 1761.5,30853 1761.5,30853 1761.5,30853 2020.3,30853 2020.3,30853"];
	layer21_moe_comm_to_expert0 -> layer21_moe_expert0	[pos="e,1745.2,30970 2030,31035 1918.8,31035 1745.2,31035 1745.2,31035 1745.2,31035 1745.2,30980 1745.2,30980"];
	layer21_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L21\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1953,30944",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer21_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2366,30853",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer21_moe_expert1 -> layer21_moe_comm_from_expert1	[pos="e,2366,30882 2073.7,30918 2073.7,30905 2073.7,30891 2073.7,30891 2073.7,30891 2366,30891 2366,30891 2366,30891 2366,30890 2366,30890"];
	layer21_moe_comm_to_expert1 -> layer21_moe_expert1	[pos="e,2073.7,30970 2366,31006 2366,30992 2366,30979 2366,30979 2366,30979 2073.7,30979 2073.7,30979 2073.7,30979 2073.7,30978 2073.7,\
30978"];
	layer21_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L21\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2299,30944",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer21_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2822,30853",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer21_moe_expert2 -> layer21_moe_comm_from_expert2	[pos="e,2731.3,30853 2463.2,30935 2470.6,30935 2475,30935 2475,30935 2475,30935 2475,30853 2475,30853 2475,30853 2721.3,30853 2721.3,30853"];
	layer21_moe_comm_to_expert2 -> layer21_moe_expert2	[pos="e,2463.3,30952 2731.1,31035 2626.5,31035 2469,31035 2469,31035 2469,31035 2469,30952 2469,30952 2469,30952 2468.4,30952 2468.4,30952"];
	layer21_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L21\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2645,30944",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer21_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3150,30853",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer21_moe_expert3 -> layer21_moe_comm_from_expert3	[pos="e,3091.3,30875 2770.2,30918 2770.2,30908 2770.2,30900 2770.2,30900 2770.2,30900 3091.3,30900 3091.3,30900 3091.3,30900 3091.3,30885 \
3091.3,30885"];
	layer21_moe_comm_to_expert3 -> layer21_moe_expert3	[pos="e,2770.2,30970 3091.3,31013 3091.3,31005 3091.3,30997 3091.3,30997 3091.3,30997 2770.2,30997 2770.2,30997 2770.2,30997 2770.2,30980 \
2770.2,30980"];
	layer21_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L21\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2991,30944",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer21_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3413,30853",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer21_moe_expert4 -> layer21_moe_comm_from_expert4	[pos="e,3411.7,30882 3123.2,30918 3123.2,30913 3123.2,30909 3123.2,30909 3123.2,30909 3411.7,30909 3411.7,30909 3411.7,30909 3411.7,30892 \
3411.7,30892"];
	layer21_moe_comm_to_expert4 -> layer21_moe_expert4	[pos="e,3123.2,30970 3411.7,31006 3411.7,30996 3411.7,30988 3411.7,30988 3411.7,30988 3123.2,30988 3123.2,30988 3123.2,30988 3123.2,30980 \
3123.2,30980"];
	layer21_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L21\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3337,30944",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer21_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3644,30853",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer21_moe_expert5 -> layer21_moe_comm_from_expert5	[pos="e,3553.5,30853 3501.1,30935 3509.3,30935 3514.2,30935 3514.2,30935 3514.2,30935 3514.2,30853 3514.2,30853 3514.2,30853 3543.5,30853 \
3543.5,30853"];
	layer21_moe_comm_to_expert5 -> layer21_moe_expert5	[pos="e,3501,30952 3553.4,31035 3529.1,31035 3509.3,31035 3509.3,31035 3509.3,31035 3509.3,30952 3509.3,30952 3509.3,30952 3508.5,30952 \
3508.5,30952"];
	layer21_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L21\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3683,30944",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer21_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3859,30853",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer21_moe_expert6 -> layer21_moe_comm_from_expert6	[pos="e,3807.7,30877 3807.7,30918 3807.7,30918 3807.7,30887 3807.7,30887"];
	layer21_moe_comm_to_expert6 -> layer21_moe_expert6	[pos="e,3807.7,30970 3807.7,31011 3807.7,31011 3807.7,30980 3807.7,30980"];
	layer21_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L21\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="4029,30944",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer21_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4066,30853",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer21_moe_expert7 -> layer21_moe_comm_from_expert7	[pos="e,4066,30882 4066,30918 4066,30918 4066,30892 4066,30892"];
	layer21_moe_comm_to_expert7 -> layer21_moe_expert7	[pos="e,4066,30970 4066,31006 4066,31006 4066,30980 4066,30980"];
	layer21_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L21\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4375,30944",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer21_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4338,30853",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer21_moe_expert8 -> layer21_moe_comm_from_expert8	[pos="e,4338,30882 4338,30918 4338,30918 4338,30892 4338,30892"];
	layer21_moe_comm_to_expert8 -> layer21_moe_expert8	[pos="e,4338,30970 4338,31006 4338,31006 4338,30980 4338,30980"];
	layer21_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L21\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4721,30944",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer21_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4647,30853",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer21_moe_expert9 -> layer21_moe_comm_from_expert9	[pos="e,4647.3,30882 4647.3,30918 4647.3,30918 4647.3,30892 4647.3,30892"];
	layer21_moe_comm_to_expert9 -> layer21_moe_expert9	[pos="e,4647.3,30970 4647.3,31006 4647.3,31006 4647.3,30980 4647.3,30980"];
	layer21_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L21\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5072,30944",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer21_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4979,30853",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer21_moe_expert10 -> layer21_moe_comm_from_expert10	[pos="e,4988.4,30882 4988.4,30918 4988.4,30918 4988.4,30892 4988.4,30892"];
	layer21_moe_comm_to_expert10 -> layer21_moe_expert10	[pos="e,4988,30970 4988,31006 4988,31006 4988,30980 4988,30980"];
	layer21_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L21\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5428,30944",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer21_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5326,30853",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer21_moe_expert11 -> layer21_moe_comm_from_expert11	[pos="e,5339.9,30882 5339.9,30918 5339.9,30918 5339.9,30892 5339.9,30892"];
	layer21_moe_comm_to_expert11 -> layer21_moe_expert11	[pos="e,5339,30970 5339,31006 5339,31006 5339,30980 5339,30980"];
	layer21_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L21\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5784,30944",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer21_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5677,30853",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer21_moe_expert12 -> layer21_moe_comm_from_expert12	[pos="e,5693.4,30882 5693.4,30918 5693.4,30918 5693.4,30892 5693.4,30892"];
	layer21_moe_comm_to_expert12 -> layer21_moe_expert12	[pos="e,5692.5,30970 5692.5,31006 5692.5,31006 5692.5,30980 5692.5,30980"];
	layer21_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L21\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6140,30944",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer21_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="6031,30853",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer21_moe_expert13 -> layer21_moe_comm_from_expert13	[pos="e,6048.4,30882 6048.4,30918 6048.4,30918 6048.4,30892 6048.4,30892"];
	layer21_moe_comm_to_expert13 -> layer21_moe_expert13	[pos="e,6047,30970 6047,31006 6047,31006 6047,30980 6047,30980"];
	layer21_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L21\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6496,30944",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer21_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6386,30853",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer21_moe_expert14 -> layer21_moe_comm_from_expert14	[pos="e,6403.9,30882 6403.9,30918 6403.9,30918 6403.9,30892 6403.9,30892"];
	layer21_moe_comm_to_expert14 -> layer21_moe_expert14	[pos="e,6402.5,30970 6402.5,31006 6402.5,31006 6402.5,30980 6402.5,30980"];
	layer21_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L21\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6852,30944",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer21_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6741,30853",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer21_moe_expert15 -> layer21_moe_comm_from_expert15	[pos="e,6759.4,30882 6759.4,30918 6759.4,30918 6759.4,30892 6759.4,30892"];
	layer21_moe_comm_to_expert15 -> layer21_moe_expert15	[pos="e,6758,30970 6758,31006 6758,31006 6758,30980 6758,30980"];
	layer21_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L21\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4165,30736",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer22_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L22\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4165,30622",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer21_moe_aggregate -> layer22_moe_mha	[pos="e,4165,30648 4165,30684 4165,30684 4165,30658 4165,30658"];
	layer21_moe_comm_from_expert0 -> layer21_moe_aggregate	[pos="e,3918,30699 2154.8,30826 2154.8,30782 2154.8,30699 2154.8,30699 2154.8,30699 3908,30699 3908,30699"];
	layer21_moe_comm_from_expert1 -> layer21_moe_aggregate	[pos="e,3932.4,30713 2450.3,30842 2450.3,30809 2450.3,30713 2450.3,30713 2450.3,30713 3922.4,30713 3922.4,30713"];
	layer21_moe_comm_from_expert2 -> layer21_moe_aggregate	[pos="e,3947.9,30728 2855,30826 2855,30789 2855,30728 2855,30728 2855,30728 3937.9,30728 3937.9,30728"];
	layer21_moe_comm_from_expert3 -> layer21_moe_aggregate	[pos="e,3963.5,30743 3210.5,30831 3210.5,30799 3210.5,30743 3210.5,30743 3210.5,30743 3953.5,30743 3953.5,30743"];
	layer21_moe_comm_from_expert4 -> layer21_moe_aggregate	[pos="e,3979,30758 3487.5,30837 3487.5,30809 3487.5,30758 3487.5,30758 3487.5,30758 3969,30758 3969,30758"];
	layer21_moe_comm_from_expert5 -> layer21_moe_aggregate	[pos="e,3994.4,30773 3725.5,30840 3725.5,30818 3725.5,30773 3725.5,30773 3725.5,30773 3984.4,30773 3984.4,30773"];
	layer21_moe_comm_from_expert6 -> layer21_moe_aggregate	[pos="e,3926.1,30736 3926.1,30834 3926.1,30834 3926.1,30746 3926.1,30746"];
	layer21_moe_comm_from_expert7 -> layer21_moe_aggregate	[pos="e,4066,30788 4066,30824 4066,30824 4066,30798 4066,30798"];
	layer21_moe_comm_from_expert8 -> layer21_moe_aggregate	[pos="e,4337.4,30788 4337.4,30824 4337.4,30824 4337.4,30798 4337.4,30798"];
	layer21_moe_comm_from_expert9 -> layer21_moe_aggregate	[pos="e,4413.7,30775 4628.5,30825 4628.5,30802 4628.5,30775 4628.5,30775 4628.5,30775 4423.7,30775 4423.7,30775"];
	layer21_moe_comm_from_expert10 -> layer21_moe_aggregate	[pos="e,4400.3,30762 4960.1,30824 4960.1,30798 4960.1,30762 4960.1,30762 4960.1,30762 4410.3,30762 4410.3,30762"];
	layer21_moe_comm_from_expert11 -> layer21_moe_aggregate	[pos="e,4386.8,30749 5306.6,30825 5306.6,30794 5306.6,30749 5306.6,30749 5306.6,30749 4396.8,30749 4396.8,30749"];
	layer21_moe_comm_from_expert12 -> layer21_moe_aggregate	[pos="e,4373.3,30736 5657.6,30825 5657.6,30790 5657.6,30736 5657.6,30736 5657.6,30736 4383.3,30736 4383.3,30736"];
	layer21_moe_comm_from_expert13 -> layer21_moe_aggregate	[pos="e,4360,30723 6011.1,30825 6011.1,30786 6011.1,30723 6011.1,30723 6011.1,30723 4370,30723 4370,30723"];
	layer21_moe_comm_from_expert14 -> layer21_moe_aggregate	[pos="e,4346.5,30710 6366.1,30825 6366.1,30783 6366.1,30710 6366.1,30710 6366.1,30710 4356.5,30710 4356.5,30710"];
	layer21_moe_comm_from_expert15 -> layer21_moe_aggregate	[pos="e,4333.2,30697 6721.1,30825 6721.1,30779 6721.1,30697 6721.1,30697 6721.1,30697 4343.2,30697 4343.2,30697"];
	layer22_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L22\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4165,30508",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer22_moe_mha -> layer22_moe_gate	[pos="e,4165,30560 4165,30596 4165,30596 4165,30570 4165,30570"];
	layer22_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L22\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4165,30368",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer22_moe_gate -> layer22_moe_split	[pos="e,4165,30420 4165,30456 4165,30456 4165,30430 4165,30430"];
	layer22_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1643,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer22_moe_split -> layer22_moe_comm_to_expert0	[pos="e,1643,30280 3999.5,30405 3438.4,30405 1643,30405 1643,30405 1643,30405 1643,30290 1643,30290",
		style=dashed];
	layer22_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2001,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer22_moe_split -> layer22_moe_comm_to_expert1	[pos="e,2061,30273 3984.7,30390 3475.1,30390 2061,30390 2061,30390 2061,30390 2061,30283 2061,30283",
		style=dashed];
	layer22_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2322,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer22_moe_split -> layer22_moe_comm_to_expert2	[pos="e,2344,30280 3969.7,30375 3499.6,30375 2344,30375 2344,30375 2344,30375 2344,30290 2344,30290",
		style=dashed];
	layer22_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2888,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer22_moe_split -> layer22_moe_comm_to_expert3	[pos="e,2945.5,30274 3954.7,30360 3605.8,30360 2945.5,30360 2945.5,30360 2945.5,30360 2945.5,30284 2945.5,30284",
		style=dashed];
	layer22_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3271,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer22_moe_split -> layer22_moe_comm_to_expert4	[pos="e,3342,30269 3939.6,30345 3695.9,30345 3342,30345 3342,30345 3342,30345 3342,30279 3342,30279",
		style=dashed];
	layer22_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3562,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer22_moe_split -> layer22_moe_comm_to_expert5	[pos="e,3603,30277 3925.4,30331 3772.6,30331 3603,30331 3603,30331 3603,30331 3603,30287 3603,30287",
		style=dashed];
	layer22_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3807,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer22_moe_split -> layer22_moe_comm_to_expert6	[pos="e,3897.7,30251 3924.7,30368 3924.7,30365 3924.7,30251 3924.7,30251 3924.7,30251 3907.7,30251 3907.7,30251",
		style=dashed];
	layer22_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="4029,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer22_moe_split -> layer22_moe_comm_to_expert7	[pos="e,4029,30280 4029,30316 4029,30316 4029,30290 4029,30290",
		style=dashed];
	layer22_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4301,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer22_moe_split -> layer22_moe_comm_to_expert8	[pos="e,4301,30280 4301,30316 4301,30316 4301,30290 4301,30290",
		style=dashed];
	layer22_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4610,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer22_moe_split -> layer22_moe_comm_to_expert9	[pos="e,4519.3,30251 4405.3,30368 4405.3,30365 4405.3,30251 4405.3,30251 4405.3,30251 4509.3,30251 4509.3,30251",
		style=dashed];
	layer22_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4942,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer22_moe_split -> layer22_moe_comm_to_expert10	[pos="e,4866.1,30269 4330.3,30331 4537.5,30331 4866.1,30331 4866.1,30331 4866.1,30331 4866.1,30279 4866.1,30279",
		style=dashed];
	layer22_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5288,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer22_moe_split -> layer22_moe_comm_to_expert11	[pos="e,5212.6,30269 4343.9,30345 4643.1,30345 5212.6,30345 5212.6,30345 5212.6,30345 5212.6,30279 5212.6,30279",
		style=dashed];
	layer22_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5639,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer22_moe_split -> layer22_moe_comm_to_expert12	[pos="e,5563.6,30269 4359.1,30360 4743.2,30360 5563.6,30360 5563.6,30360 5563.6,30360 5563.6,30279 5563.6,30279",
		style=dashed];
	layer22_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5992,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer22_moe_split -> layer22_moe_comm_to_expert13	[pos="e,5917.1,30269 4374.2,30375 4839,30375 5917.1,30375 5917.1,30375 5917.1,30375 5917.1,30279 5917.1,30279",
		style=dashed];
	layer22_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6347,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer22_moe_split -> layer22_moe_comm_to_expert14	[pos="e,6272.1,30269 4389,30390 4931.6,30390 6272.1,30390 6272.1,30390 6272.1,30390 6272.1,30279 6272.1,30279",
		style=dashed];
	layer22_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6702,30251",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer22_moe_split -> layer22_moe_comm_to_expert15	[pos="e,6627.1,30269 4403.9,30405 5022.2,30405 6627.1,30405 6627.1,30405 6627.1,30405 6627.1,30279 6627.1,30279",
		style=dashed];
	layer22_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L22\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1570,30160",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer22_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1616,30069",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer22_moe_expert0 -> layer22_moe_comm_from_expert0	[pos="e,1616,30098 1616,30134 1616,30134 1616,30108 1616,30108"];
	layer22_moe_comm_to_expert0 -> layer22_moe_expert0	[pos="e,1643,30187 1643,30222 1643,30222 1643,30197 1643,30197"];
	layer22_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L22\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1916,30160",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer22_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2329,30069",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer22_moe_expert1 -> layer22_moe_comm_from_expert1	[pos="e,2238.3,30069 2018.2,30134 2018.2,30107 2018.2,30069 2018.2,30069 2018.2,30069 2228.3,30069 2228.3,30069"];
	layer22_moe_comm_to_expert1 -> layer22_moe_expert1	[pos="e,1995.2,30187 1995.2,30222 1995.2,30222 1995.2,30197 1995.2,30197"];
	layer22_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L22\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2262,30160",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer22_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2785,30069",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer22_moe_expert2 -> layer22_moe_comm_from_expert2	[pos="e,2694.4,30069 2426.2,30160 2431.8,30160 2435,30160 2435,30160 2435,30160 2435,30069 2435,30069 2435,30069 2684.4,30069 2684.4,30069"];
	layer22_moe_comm_to_expert2 -> layer22_moe_expert2	[pos="e,2322,30187 2322,30222 2322,30222 2322,30197 2322,30197"];
	layer22_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L22\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2608,30160",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer22_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3113,30069",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer22_moe_expert3 -> layer22_moe_comm_from_expert3	[pos="e,3054.3,30092 2733.2,30134 2733.2,30122 2733.2,30110 2733.2,30110 2733.2,30110 3054.3,30110 3054.3,30110 3054.3,30110 3054.3,30102 \
3054.3,30102"];
	layer22_moe_comm_to_expert3 -> layer22_moe_expert3	[pos="e,2751.7,30186 2797.1,30251 2772.1,30251 2751.7,30251 2751.7,30251 2751.7,30251 2751.7,30196 2751.7,30196"];
	layer22_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L22\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2954,30160",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer22_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3376,30069",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer22_moe_expert4 -> layer22_moe_comm_from_expert4	[pos="e,3374.7,30098 3086.2,30134 3086.2,30127 3086.2,30122 3086.2,30122 3086.2,30122 3374.7,30122 3374.7,30122 3374.7,30122 3374.7,30108 \
3374.7,30108"];
	layer22_moe_comm_to_expert4 -> layer22_moe_expert4	[pos="e,3088.7,30186 3180.4,30251 3134.7,30251 3088.7,30251 3088.7,30251 3088.7,30251 3088.7,30196 3088.7,30196"];
	layer22_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L22\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3300,30160",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer22_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3607,30069",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer22_moe_expert5 -> layer22_moe_comm_from_expert5	[pos="e,3516.2,30069 3464,30151 3470.4,30151 3474.2,30151 3474.2,30151 3474.2,30151 3474.2,30069 3474.2,30069 3474.2,30069 3506.2,30069 \
3506.2,30069"];
	layer22_moe_comm_to_expert5 -> layer22_moe_expert5	[pos="e,3464.1,30168 3476.8,30241 3476.8,30219 3476.8,30168 3476.8,30168 3476.8,30168 3474.1,30168 3474.1,30168"];
	layer22_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L22\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3646,30160",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer22_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3822,30069",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer22_moe_expert6 -> layer22_moe_comm_from_expert6	[pos="e,3770.7,30093 3770.7,30134 3770.7,30134 3770.7,30103 3770.7,30103"];
	layer22_moe_comm_to_expert6 -> layer22_moe_expert6	[pos="e,3763.2,30186 3763.2,30225 3763.2,30225 3763.2,30196 3763.2,30196"];
	layer22_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L22\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3992,30160",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer22_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="4029,30069",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer22_moe_expert7 -> layer22_moe_comm_from_expert7	[pos="e,4029,30098 4029,30134 4029,30134 4029,30108 4029,30108"];
	layer22_moe_comm_to_expert7 -> layer22_moe_expert7	[pos="e,4029,30187 4029,30222 4029,30222 4029,30197 4029,30197"];
	layer22_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L22\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4338,30160",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer22_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4301,30069",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer22_moe_expert8 -> layer22_moe_comm_from_expert8	[pos="e,4301,30098 4301,30134 4301,30134 4301,30108 4301,30108"];
	layer22_moe_comm_to_expert8 -> layer22_moe_expert8	[pos="e,4301,30187 4301,30222 4301,30222 4301,30197 4301,30197"];
	layer22_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L22\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4684,30160",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer22_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4610,30069",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer22_moe_expert9 -> layer22_moe_comm_from_expert9	[pos="e,4610.3,30098 4610.3,30134 4610.3,30134 4610.3,30108 4610.3,30108"];
	layer22_moe_comm_to_expert9 -> layer22_moe_expert9	[pos="e,4610.3,30187 4610.3,30222 4610.3,30222 4610.3,30197 4610.3,30197"];
	layer22_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L22\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="5035,30160",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer22_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4942,30069",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer22_moe_expert10 -> layer22_moe_comm_from_expert10	[pos="e,4951.4,30098 4951.4,30134 4951.4,30134 4951.4,30108 4951.4,30108"];
	layer22_moe_comm_to_expert10 -> layer22_moe_expert10	[pos="e,4951,30187 4951,30222 4951,30222 4951,30197 4951,30197"];
	layer22_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L22\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5391,30160",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer22_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5289,30069",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer22_moe_expert11 -> layer22_moe_comm_from_expert11	[pos="e,5302.9,30098 5302.9,30134 5302.9,30134 5302.9,30108 5302.9,30108"];
	layer22_moe_comm_to_expert11 -> layer22_moe_expert11	[pos="e,5302,30186 5302,30222 5302,30222 5302,30196 5302,30196"];
	layer22_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L22\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5747,30160",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer22_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5640,30069",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer22_moe_expert12 -> layer22_moe_comm_from_expert12	[pos="e,5656.4,30098 5656.4,30134 5656.4,30134 5656.4,30108 5656.4,30108"];
	layer22_moe_comm_to_expert12 -> layer22_moe_expert12	[pos="e,5655.5,30186 5655.5,30222 5655.5,30222 5655.5,30196 5655.5,30196"];
	layer22_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L22\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6103,30160",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer22_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5994,30069",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer22_moe_expert13 -> layer22_moe_comm_from_expert13	[pos="e,6011.4,30098 6011.4,30134 6011.4,30134 6011.4,30108 6011.4,30108"];
	layer22_moe_comm_to_expert13 -> layer22_moe_expert13	[pos="e,6010,30186 6010,30222 6010,30222 6010,30196 6010,30196"];
	layer22_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L22\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6459,30160",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer22_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6349,30069",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer22_moe_expert14 -> layer22_moe_comm_from_expert14	[pos="e,6366.9,30098 6366.9,30134 6366.9,30134 6366.9,30108 6366.9,30108"];
	layer22_moe_comm_to_expert14 -> layer22_moe_expert14	[pos="e,6365.5,30186 6365.5,30222 6365.5,30222 6365.5,30196 6365.5,30196"];
	layer22_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L22\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6815,30160",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer22_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6704,30069",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer22_moe_expert15 -> layer22_moe_comm_from_expert15	[pos="e,6722.4,30098 6722.4,30134 6722.4,30134 6722.4,30108 6722.4,30108"];
	layer22_moe_comm_to_expert15 -> layer22_moe_expert15	[pos="e,6721,30186 6721,30222 6721,30222 6721,30196 6721,30196"];
	layer22_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L22\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4128,29952",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer23_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L23\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4128,29838",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer22_moe_aggregate -> layer23_moe_mha	[pos="e,4128,29864 4128,29900 4128,29900 4128,29874 4128,29874"];
	layer22_moe_comm_from_expert0 -> layer22_moe_aggregate	[pos="e,3880.9,29915 1701.8,30060 1701.8,30026 1701.8,29915 1701.8,29915 1701.8,29915 3870.9,29915 3870.9,29915"];
	layer22_moe_comm_from_expert1 -> layer22_moe_aggregate	[pos="e,3895.4,29929 2413.3,30058 2413.3,30025 2413.3,29929 2413.3,29929 2413.3,29929 3885.4,29929 3885.4,29929"];
	layer22_moe_comm_from_expert2 -> layer22_moe_aggregate	[pos="e,3911,29944 2857,30052 2857,30017 2857,29944 2857,29944 2857,29944 3901,29944 3901,29944"];
	layer22_moe_comm_from_expert3 -> layer22_moe_aggregate	[pos="e,3926.3,29959 3185,30052 3185,30020 3185,29959 3185,29959 3185,29959 3916.3,29959 3916.3,29959"];
	layer22_moe_comm_from_expert4 -> layer22_moe_aggregate	[pos="e,3941.6,29974 3455.8,30055 3455.8,30029 3455.8,29974 3455.8,29974 3455.8,29974 3931.6,29974 3931.6,29974"];
	layer22_moe_comm_from_expert5 -> layer22_moe_aggregate	[pos="e,3957.4,29989 3677.5,30051 3677.5,30027 3677.5,29989 3677.5,29989 3677.5,29989 3947.4,29989 3947.4,29989"];
	layer22_moe_comm_from_expert6 -> layer22_moe_aggregate	[pos="e,3889.1,29952 3889.1,30050 3889.1,30050 3889.1,29962 3889.1,29962"];
	layer22_moe_comm_from_expert7 -> layer22_moe_aggregate	[pos="e,4029,30004 4029,30040 4029,30040 4029,30014 4029,30014"];
	layer22_moe_comm_from_expert8 -> layer22_moe_aggregate	[pos="e,4300.4,30004 4300.4,30040 4300.4,30040 4300.4,30014 4300.4,30014"];
	layer22_moe_comm_from_expert9 -> layer22_moe_aggregate	[pos="e,4376.7,29991 4591.5,30041 4591.5,30018 4591.5,29991 4591.5,29991 4591.5,29991 4386.7,29991 4386.7,29991"];
	layer22_moe_comm_from_expert10 -> layer22_moe_aggregate	[pos="e,4363.1,29978 4923.1,30040 4923.1,30014 4923.1,29978 4923.1,29978 4923.1,29978 4373.1,29978 4373.1,29978"];
	layer22_moe_comm_from_expert11 -> layer22_moe_aggregate	[pos="e,4349.8,29965 5269.6,30041 5269.6,30010 5269.6,29965 5269.6,29965 5269.6,29965 4359.8,29965 4359.8,29965"];
	layer22_moe_comm_from_expert12 -> layer22_moe_aggregate	[pos="e,4336.3,29952 5620.6,30041 5620.6,30006 5620.6,29952 5620.6,29952 5620.6,29952 4346.3,29952 4346.3,29952"];
	layer22_moe_comm_from_expert13 -> layer22_moe_aggregate	[pos="e,4323,29939 5974.1,30041 5974.1,30002 5974.1,29939 5974.1,29939 5974.1,29939 4333,29939 4333,29939"];
	layer22_moe_comm_from_expert14 -> layer22_moe_aggregate	[pos="e,4309.5,29926 6329.1,30041 6329.1,29999 6329.1,29926 6329.1,29926 6329.1,29926 4319.5,29926 4319.5,29926"];
	layer22_moe_comm_from_expert15 -> layer22_moe_aggregate	[pos="e,4296.2,29913 6684.1,30041 6684.1,29995 6684.1,29913 6684.1,29913 6684.1,29913 4306.2,29913 4306.2,29913"];
	layer23_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L23\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4128,29724",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer23_moe_mha -> layer23_moe_gate	[pos="e,4128,29776 4128,29812 4128,29812 4128,29786 4128,29786"];
	layer23_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L23\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4128,29584",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer23_moe_gate -> layer23_moe_split	[pos="e,4128,29636 4128,29672 4128,29672 4128,29646 4128,29646"];
	layer23_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2047,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer23_moe_split -> layer23_moe_comm_to_expert0	[pos="e,2117.8,29485 3962.6,29621 3481.8,29621 2117.8,29621 2117.8,29621 2117.8,29621 2117.8,29495 2117.8,29495",
		style=dashed];
	layer23_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2292,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer23_moe_split -> layer23_moe_comm_to_expert1	[pos="e,2310.5,29496 3947.5,29606 3488.1,29606 2310.5,29606 2310.5,29606 2310.5,29606 2310.5,29506 2310.5,29506",
		style=dashed];
	layer23_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2748,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer23_moe_split -> layer23_moe_comm_to_expert2	[pos="e,2766.5,29496 3932.6,29591 3556,29591 2766.5,29591 2766.5,29591 2766.5,29591 2766.5,29506 2766.5,29506",
		style=dashed];
	layer23_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3076,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer23_moe_split -> layer23_moe_comm_to_expert3	[pos="e,3094.5,29496 3917.6,29576 3615.4,29576 3094.5,29576 3094.5,29576 3094.5,29576 3094.5,29506 3094.5,29506",
		style=dashed];
	layer23_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3339,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer23_moe_split -> layer23_moe_comm_to_expert4	[pos="e,3357.5,29496 3902.5,29561 3675.2,29561 3357.5,29561 3357.5,29561 3357.5,29561 3357.5,29506 3357.5,29506",
		style=dashed];
	layer23_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3570,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer23_moe_split -> layer23_moe_comm_to_expert5	[pos="e,3588.5,29496 3888.6,29547 3744.4,29547 3588.5,29547 3588.5,29547 3588.5,29547 3588.5,29506 3588.5,29506",
		style=dashed];
	layer23_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3785,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer23_moe_split -> layer23_moe_comm_to_expert6	[pos="e,3875.8,29467 3888.5,29584 3888.5,29581 3888.5,29467 3888.5,29467 3888.5,29467 3885.8,29467 3885.8,29467",
		style=dashed];
	layer23_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3992,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer23_moe_split -> layer23_moe_comm_to_expert7	[pos="e,3992,29496 3992,29532 3992,29532 3992,29506 3992,29506",
		style=dashed];
	layer23_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4264,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer23_moe_split -> layer23_moe_comm_to_expert8	[pos="e,4264,29496 4264,29532 4264,29532 4264,29506 4264,29506",
		style=dashed];
	layer23_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4573,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer23_moe_split -> layer23_moe_comm_to_expert9	[pos="e,4482.3,29467 4368.3,29584 4368.3,29581 4368.3,29467 4368.3,29467 4368.3,29467 4472.3,29467 4472.3,29467",
		style=dashed];
	layer23_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4905,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer23_moe_split -> layer23_moe_comm_to_expert10	[pos="e,4829.1,29485 4293.3,29547 4500.5,29547 4829.1,29547 4829.1,29547 4829.1,29547 4829.1,29495 4829.1,29495",
		style=dashed];
	layer23_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5251,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer23_moe_split -> layer23_moe_comm_to_expert11	[pos="e,5175.6,29485 4306.9,29561 4606.1,29561 5175.6,29561 5175.6,29561 5175.6,29561 5175.6,29495 5175.6,29495",
		style=dashed];
	layer23_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5602,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer23_moe_split -> layer23_moe_comm_to_expert12	[pos="e,5526.6,29485 4322.1,29576 4706.2,29576 5526.6,29576 5526.6,29576 5526.6,29576 5526.6,29495 5526.6,29495",
		style=dashed];
	layer23_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5955,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer23_moe_split -> layer23_moe_comm_to_expert13	[pos="e,5880.1,29485 4337.2,29591 4802,29591 5880.1,29591 5880.1,29591 5880.1,29591 5880.1,29495 5880.1,29495",
		style=dashed];
	layer23_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6310,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer23_moe_split -> layer23_moe_comm_to_expert14	[pos="e,6235.1,29485 4352,29606 4894.6,29606 6235.1,29606 6235.1,29606 6235.1,29606 6235.1,29495 6235.1,29495",
		style=dashed];
	layer23_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6665,29467",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer23_moe_split -> layer23_moe_comm_to_expert15	[pos="e,6590.1,29485 4366.9,29621 4985.2,29621 6590.1,29621 6590.1,29621 6590.1,29621 6590.1,29495 6590.1,29495",
		style=dashed];
	layer23_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L23\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1533,29376",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer23_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1680,29285",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer23_moe_expert0 -> layer23_moe_comm_from_expert0	[pos="e,1643.2,29312 1643.2,29350 1643.2,29350 1643.2,29322 1643.2,29322"];
	layer23_moe_comm_to_expert0 -> layer23_moe_expert0	[pos="e,1611.2,29402 1956.4,29467 1828.8,29467 1611.2,29467 1611.2,29467 1611.2,29467 1611.2,29412 1611.2,29412"];
	layer23_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L23\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1879,29376",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer23_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2173,29285",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer23_moe_expert1 -> layer23_moe_comm_from_expert1	[pos="e,2082.5,29285 1981.2,29350 1981.2,29323 1981.2,29285 1981.2,29285 1981.2,29285 2072.5,29285 2072.5,29285"];
	layer23_moe_comm_to_expert1 -> layer23_moe_expert1	[pos="e,1999.7,29403 2292,29438 2292,29424 2292,29411 2292,29411 2292,29411 1999.7,29411 1999.7,29411 1999.7,29411 1999.7,29410 1999.7,\
29410"];
	layer23_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L23\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2225,29376",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer23_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2519,29285",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer23_moe_expert2 -> layer23_moe_comm_from_expert2	[pos="e,2428.3,29285 2379.5,29350 2379.5,29323 2379.5,29285 2379.5,29285 2379.5,29285 2418.3,29285 2418.3,29285"];
	layer23_moe_comm_to_expert2 -> layer23_moe_expert2	[pos="e,2389.2,29376 2657.4,29467 2553.7,29467 2398,29467 2398,29467 2398,29467 2398,29376 2398,29376 2398,29376 2397.1,29376 2397.1,29376"];
	layer23_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L23\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2571,29376",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer23_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2791,29285",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer23_moe_expert3 -> layer23_moe_comm_from_expert3	[pos="e,2717.7,29302 2717.7,29350 2717.7,29350 2717.7,29312 2717.7,29312"];
	layer23_moe_comm_to_expert3 -> layer23_moe_expert3	[pos="e,2696.2,29402 3017.3,29445 3017.3,29437 3017.3,29429 3017.3,29429 3017.3,29429 2696.2,29429 2696.2,29429 2696.2,29429 2696.2,29412 \
2696.2,29412"];
	layer23_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L23\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2917,29376",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer23_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3027,29285",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer23_moe_expert4 -> layer23_moe_comm_from_expert4	[pos="e,3008.7,29314 3008.7,29350 3008.7,29350 3008.7,29324 3008.7,29324"];
	layer23_moe_comm_to_expert4 -> layer23_moe_expert4	[pos="e,3049.2,29402 3337.7,29438 3337.7,29428 3337.7,29420 3337.7,29420 3337.7,29420 3049.2,29420 3049.2,29420 3049.2,29420 3049.2,29412 \
3049.2,29412"];
	layer23_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L23\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3263,29376",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer23_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3374,29285",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer23_moe_expert5 -> layer23_moe_comm_from_expert5	[pos="e,3355.2,29314 3355.2,29350 3355.2,29350 3355.2,29324 3355.2,29324"];
	layer23_moe_comm_to_expert5 -> layer23_moe_expert5	[pos="e,3427.1,29376 3479.3,29467 3455.9,29467 3437.3,29467 3437.3,29467 3437.3,29467 3437.3,29376 3437.3,29376 3437.3,29376 3436.2,29376 \
3436.2,29376"];
	layer23_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L23\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3609,29376",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer23_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3720,29285",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer23_moe_expert6 -> layer23_moe_comm_from_expert6	[pos="e,3701.2,29314 3701.2,29350 3701.2,29350 3701.2,29324 3701.2,29324"];
	layer23_moe_comm_to_expert6 -> layer23_moe_expert6	[pos="e,3733.7,29403 3733.7,29443 3733.7,29443 3733.7,29413 3733.7,29413"];
	layer23_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L23\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3955,29376",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer23_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3992,29285",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer23_moe_expert7 -> layer23_moe_comm_from_expert7	[pos="e,3992,29314 3992,29350 3992,29350 3992,29324 3992,29324"];
	layer23_moe_comm_to_expert7 -> layer23_moe_expert7	[pos="e,3992,29403 3992,29438 3992,29438 3992,29413 3992,29413"];
	layer23_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L23\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4301,29376",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer23_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4264,29285",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer23_moe_expert8 -> layer23_moe_comm_from_expert8	[pos="e,4264,29314 4264,29350 4264,29350 4264,29324 4264,29324"];
	layer23_moe_comm_to_expert8 -> layer23_moe_expert8	[pos="e,4264,29403 4264,29438 4264,29438 4264,29413 4264,29413"];
	layer23_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L23\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4647,29376",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer23_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4573,29285",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer23_moe_expert9 -> layer23_moe_comm_from_expert9	[pos="e,4573.3,29314 4573.3,29350 4573.3,29350 4573.3,29324 4573.3,29324"];
	layer23_moe_comm_to_expert9 -> layer23_moe_expert9	[pos="e,4573.3,29403 4573.3,29438 4573.3,29438 4573.3,29413 4573.3,29413"];
	layer23_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L23\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4998,29376",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer23_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4905,29285",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer23_moe_expert10 -> layer23_moe_comm_from_expert10	[pos="e,4914.4,29314 4914.4,29350 4914.4,29350 4914.4,29324 4914.4,29324"];
	layer23_moe_comm_to_expert10 -> layer23_moe_expert10	[pos="e,4914,29403 4914,29438 4914,29438 4914,29413 4914,29413"];
	layer23_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L23\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5354,29376",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer23_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5252,29285",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer23_moe_expert11 -> layer23_moe_comm_from_expert11	[pos="e,5265.9,29314 5265.9,29350 5265.9,29350 5265.9,29324 5265.9,29324"];
	layer23_moe_comm_to_expert11 -> layer23_moe_expert11	[pos="e,5265,29402 5265,29438 5265,29438 5265,29412 5265,29412"];
	layer23_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L23\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5710,29376",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer23_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5603,29285",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer23_moe_expert12 -> layer23_moe_comm_from_expert12	[pos="e,5619.4,29314 5619.4,29350 5619.4,29350 5619.4,29324 5619.4,29324"];
	layer23_moe_comm_to_expert12 -> layer23_moe_expert12	[pos="e,5618.5,29402 5618.5,29438 5618.5,29438 5618.5,29412 5618.5,29412"];
	layer23_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L23\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6066,29376",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer23_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5957,29285",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer23_moe_expert13 -> layer23_moe_comm_from_expert13	[pos="e,5974.4,29314 5974.4,29350 5974.4,29350 5974.4,29324 5974.4,29324"];
	layer23_moe_comm_to_expert13 -> layer23_moe_expert13	[pos="e,5973,29402 5973,29438 5973,29438 5973,29412 5973,29412"];
	layer23_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L23\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6422,29376",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer23_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6312,29285",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer23_moe_expert14 -> layer23_moe_comm_from_expert14	[pos="e,6329.9,29314 6329.9,29350 6329.9,29350 6329.9,29324 6329.9,29324"];
	layer23_moe_comm_to_expert14 -> layer23_moe_expert14	[pos="e,6328.5,29402 6328.5,29438 6328.5,29438 6328.5,29412 6328.5,29412"];
	layer23_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L23\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6778,29376",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer23_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6667,29285",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer23_moe_expert15 -> layer23_moe_comm_from_expert15	[pos="e,6685.4,29314 6685.4,29350 6685.4,29350 6685.4,29324 6685.4,29324"];
	layer23_moe_comm_to_expert15 -> layer23_moe_expert15	[pos="e,6684,29402 6684,29438 6684,29438 6684,29412 6684,29412"];
	layer23_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L23\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4091,29168",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer24_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L24\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4091,29054",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer23_moe_aggregate -> layer24_moe_mha	[pos="e,4091,29080 4091,29116 4091,29116 4091,29090 4091,29090"];
	layer23_moe_comm_from_expert0 -> layer23_moe_aggregate	[pos="e,3843.9,29131 1724.3,29260 1724.3,29216 1724.3,29131 1724.3,29131 1724.3,29131 3833.9,29131 3833.9,29131"];
	layer23_moe_comm_from_expert1 -> layer23_moe_aggregate	[pos="e,3858.5,29145 2214,29259 2214,29219 2214,29145 2214,29145 2214,29145 3848.5,29145 3848.5,29145"];
	layer23_moe_comm_from_expert2 -> layer23_moe_aggregate	[pos="e,3873.7,29160 2519,29256 2519,29219 2519,29160 2519,29160 2519,29160 3863.7,29160 3863.7,29160"];
	layer23_moe_comm_from_expert3 -> layer23_moe_aggregate	[pos="e,3889.2,29175 2841.5,29261 2841.5,29229 2841.5,29175 2841.5,29175 2841.5,29175 3879.2,29175 3879.2,29175"];
	layer23_moe_comm_from_expert4 -> layer23_moe_aggregate	[pos="e,3904.9,29190 3033,29256 3033,29228 3033,29190 3033,29190 3033,29190 3894.9,29190 3894.9,29190"];
	layer23_moe_comm_from_expert5 -> layer23_moe_aggregate	[pos="e,3920.2,29205 3453.5,29271 3453.5,29248 3453.5,29205 3453.5,29205 3453.5,29205 3910.2,29205 3910.2,29205"];
	layer23_moe_comm_from_expert6 -> layer23_moe_aggregate	[pos="e,3865.1,29168 3810.7,29285 3840,29285 3865.1,29285 3865.1,29285 3865.1,29285 3865.1,29178 3865.1,29178"];
	layer23_moe_comm_from_expert7 -> layer23_moe_aggregate	[pos="e,3992,29220 3992,29256 3992,29256 3992,29230 3992,29230"];
	layer23_moe_comm_from_expert8 -> layer23_moe_aggregate	[pos="e,4263.4,29220 4263.4,29256 4263.4,29256 4263.4,29230 4263.4,29230"];
	layer23_moe_comm_from_expert9 -> layer23_moe_aggregate	[pos="e,4339.7,29207 4554.5,29257 4554.5,29234 4554.5,29207 4554.5,29207 4554.5,29207 4349.7,29207 4349.7,29207"];
	layer23_moe_comm_from_expert10 -> layer23_moe_aggregate	[pos="e,4326.1,29194 4886.1,29256 4886.1,29230 4886.1,29194 4886.1,29194 4886.1,29194 4336.1,29194 4336.1,29194"];
	layer23_moe_comm_from_expert11 -> layer23_moe_aggregate	[pos="e,4312.8,29181 5232.6,29257 5232.6,29226 5232.6,29181 5232.6,29181 5232.6,29181 4322.8,29181 4322.8,29181"];
	layer23_moe_comm_from_expert12 -> layer23_moe_aggregate	[pos="e,4299.3,29168 5583.6,29257 5583.6,29222 5583.6,29168 5583.6,29168 5583.6,29168 4309.3,29168 4309.3,29168"];
	layer23_moe_comm_from_expert13 -> layer23_moe_aggregate	[pos="e,4286,29155 5937.1,29257 5937.1,29218 5937.1,29155 5937.1,29155 5937.1,29155 4296,29155 4296,29155"];
	layer23_moe_comm_from_expert14 -> layer23_moe_aggregate	[pos="e,4272.5,29142 6292.1,29257 6292.1,29215 6292.1,29142 6292.1,29142 6292.1,29142 4282.5,29142 4282.5,29142"];
	layer23_moe_comm_from_expert15 -> layer23_moe_aggregate	[pos="e,4259.2,29129 6647.1,29257 6647.1,29211 6647.1,29129 6647.1,29129 6647.1,29129 4269.2,29129 4269.2,29129"];
	layer24_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L24\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4091,28940",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer24_moe_mha -> layer24_moe_gate	[pos="e,4091,28992 4091,29028 4091,29028 4091,29002 4091,29002"];
	layer24_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L24\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4091,28800",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer24_moe_gate -> layer24_moe_split	[pos="e,4091,28852 4091,28888 4091,28888 4091,28862 4091,28862"];
	layer24_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="2010,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer24_moe_split -> layer24_moe_comm_to_expert0	[pos="e,2091.5,28696 3925.7,28837 3446.6,28837 2091.5,28837 2091.5,28837 2091.5,28837 2091.5,28706 2091.5,28706",
		style=dashed];
	layer24_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2255,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer24_moe_split -> layer24_moe_comm_to_expert1	[pos="e,2304.5,28708 3910.3,28822 3456.4,28822 2304.5,28822 2304.5,28822 2304.5,28822 2304.5,28718 2304.5,28718",
		style=dashed];
	layer24_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2711,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer24_moe_split -> layer24_moe_comm_to_expert2	[pos="e,2751,28710 3895.4,28807 3523.5,28807 2751,28807 2751,28807 2751,28807 2751,28720 2751,28720",
		style=dashed];
	layer24_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="3039,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer24_moe_split -> layer24_moe_comm_to_expert3	[pos="e,3123.5,28694 3880.5,28792 3595.9,28792 3123.5,28792 3123.5,28792 3123.5,28792 3123.5,28704 3123.5,28704",
		style=dashed];
	layer24_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3302,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer24_moe_split -> layer24_moe_comm_to_expert4	[pos="e,3338,28710 3865.6,28777 3643.7,28777 3338,28777 3338,28777 3338,28777 3338,28720 3338,28720",
		style=dashed];
	layer24_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3533,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer24_moe_split -> layer24_moe_comm_to_expert5	[pos="e,3544,28712 3851.5,28763 3704.4,28763 3544,28763 3544,28763 3544,28763 3544,28722 3544,28722",
		style=dashed];
	layer24_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3748,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer24_moe_split -> layer24_moe_comm_to_expert6	[pos="e,3838.8,28683 3851.5,28800 3851.5,28797 3851.5,28683 3851.5,28683 3851.5,28683 3848.8,28683 3848.8,28683",
		style=dashed];
	layer24_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3955,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer24_moe_split -> layer24_moe_comm_to_expert7	[pos="e,3955,28712 3955,28748 3955,28748 3955,28722 3955,28722",
		style=dashed];
	layer24_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4227,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer24_moe_split -> layer24_moe_comm_to_expert8	[pos="e,4227,28712 4227,28748 4227,28748 4227,28722 4227,28722",
		style=dashed];
	layer24_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4536,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer24_moe_split -> layer24_moe_comm_to_expert9	[pos="e,4445.3,28683 4331.3,28800 4331.3,28797 4331.3,28683 4331.3,28683 4331.3,28683 4435.3,28683 4435.3,28683",
		style=dashed];
	layer24_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4868,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer24_moe_split -> layer24_moe_comm_to_expert10	[pos="e,4792.1,28701 4255.8,28763 4463.1,28763 4792.1,28763 4792.1,28763 4792.1,28763 4792.1,28711 4792.1,28711",
		style=dashed];
	layer24_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5214,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer24_moe_split -> layer24_moe_comm_to_expert11	[pos="e,5138.6,28701 4269.9,28777 4569.1,28777 5138.6,28777 5138.6,28777 5138.6,28777 5138.6,28711 5138.6,28711",
		style=dashed];
	layer24_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5565,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer24_moe_split -> layer24_moe_comm_to_expert12	[pos="e,5489.6,28701 4285.1,28792 4669.2,28792 5489.6,28792 5489.6,28792 5489.6,28792 5489.6,28711 5489.6,28711",
		style=dashed];
	layer24_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5918,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer24_moe_split -> layer24_moe_comm_to_expert13	[pos="e,5843.1,28701 4300.2,28807 4765,28807 5843.1,28807 5843.1,28807 5843.1,28807 5843.1,28711 5843.1,28711",
		style=dashed];
	layer24_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6273,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer24_moe_split -> layer24_moe_comm_to_expert14	[pos="e,6198.1,28701 4315,28822 4857.6,28822 6198.1,28822 6198.1,28822 6198.1,28822 6198.1,28711 6198.1,28711",
		style=dashed];
	layer24_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6628,28683",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer24_moe_split -> layer24_moe_comm_to_expert15	[pos="e,6553.1,28701 4329.9,28837 4948.2,28837 6553.1,28837 6553.1,28837 6553.1,28837 6553.1,28711 6553.1,28711",
		style=dashed];
	layer24_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L24\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1496,28592",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer24_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="2010,28501",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer24_moe_expert0 -> layer24_moe_comm_from_expert0	[pos="e,1919.4,28501 1593.7,28566 1593.7,28539 1593.7,28501 1593.7,28501 1593.7,28501 1909.4,28501 1909.4,28501"];
	layer24_moe_comm_to_expert0 -> layer24_moe_expert0	[pos="e,1624.7,28619 1919.2,28683 1805.3,28683 1624.7,28683 1624.7,28683 1624.7,28683 1624.7,28629 1624.7,28629"];
	layer24_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L24\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1842,28592",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer24_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2255,28501",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer24_moe_expert1 -> layer24_moe_comm_from_expert1	[pos="e,2255,28531 1962.7,28566 1962.7,28553 1962.7,28539 1962.7,28539 1962.7,28539 2255,28539 2255,28539 2255,28539 2255,28538 2255,28538"];
	layer24_moe_comm_to_expert1 -> layer24_moe_expert1	[pos="e,1962.7,28619 2255,28654 2255,28640 2255,28627 2255,28627 2255,28627 1962.7,28627 1962.7,28627 1962.7,28627 1962.7,28626 1962.7,\
28626"];
	layer24_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L24\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2188,28592",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer24_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2711,28501",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer24_moe_expert2 -> layer24_moe_comm_from_expert2	[pos="e,2620.3,28501 2352.2,28583 2359.6,28583 2364,28583 2364,28583 2364,28583 2364,28501 2364,28501 2364,28501 2610.3,28501 2610.3,28501"];
	layer24_moe_comm_to_expert2 -> layer24_moe_expert2	[pos="e,2352.3,28600 2620.1,28683 2515.5,28683 2358,28683 2358,28683 2358,28683 2358,28600 2358,28600 2358,28600 2357.4,28600 2357.4,28600"];
	layer24_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L24\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2534,28592",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer24_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3039,28501",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer24_moe_expert3 -> layer24_moe_comm_from_expert3	[pos="e,2980.3,28524 2659.2,28566 2659.2,28557 2659.2,28548 2659.2,28548 2659.2,28548 2980.3,28548 2980.3,28548 2980.3,28548 2980.3,28534 \
2980.3,28534"];
	layer24_moe_comm_to_expert3 -> layer24_moe_expert3	[pos="e,2659.2,28618 2980.3,28661 2980.3,28653 2980.3,28645 2980.3,28645 2980.3,28645 2659.2,28645 2659.2,28645 2659.2,28645 2659.2,28628 \
2659.2,28628"];
	layer24_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L24\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2880,28592",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer24_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3302,28501",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer24_moe_expert4 -> layer24_moe_comm_from_expert4	[pos="e,3300.7,28530 3012.2,28566 3012.2,28561 3012.2,28557 3012.2,28557 3012.2,28557 3300.7,28557 3300.7,28557 3300.7,28557 3300.7,28540 \
3300.7,28540"];
	layer24_moe_comm_to_expert4 -> layer24_moe_expert4	[pos="e,3012.2,28618 3300.7,28654 3300.7,28644 3300.7,28636 3300.7,28636 3300.7,28636 3012.2,28636 3012.2,28636 3012.2,28636 3012.2,28628 \
3012.2,28628"];
	layer24_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L24\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3226,28592",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer24_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3533,28501",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer24_moe_expert5 -> layer24_moe_comm_from_expert5	[pos="e,3442.2,28501 3390.1,28583 3398.1,28583 3402.8,28583 3402.8,28583 3402.8,28583 3402.8,28501 3402.8,28501 3402.8,28501 3432.2,28501 \
3432.2,28501"];
	layer24_moe_comm_to_expert5 -> layer24_moe_expert5	[pos="e,3390.3,28600 3442.4,28683 3417.7,28683 3397.7,28683 3397.7,28683 3397.7,28683 3397.7,28600 3397.7,28600 3397.7,28600 3396.9,28600 \
3396.9,28600"];
	layer24_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L24\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3572,28592",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer24_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3748,28501",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer24_moe_expert6 -> layer24_moe_comm_from_expert6	[pos="e,3696.7,28525 3696.7,28566 3696.7,28566 3696.7,28535 3696.7,28535"];
	layer24_moe_comm_to_expert6 -> layer24_moe_expert6	[pos="e,3696.7,28619 3696.7,28659 3696.7,28659 3696.7,28629 3696.7,28629"];
	layer24_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L24\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3918,28592",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer24_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3955,28501",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer24_moe_expert7 -> layer24_moe_comm_from_expert7	[pos="e,3955,28530 3955,28566 3955,28566 3955,28540 3955,28540"];
	layer24_moe_comm_to_expert7 -> layer24_moe_expert7	[pos="e,3955,28619 3955,28654 3955,28654 3955,28629 3955,28629"];
	layer24_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L24\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4264,28592",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer24_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4227,28501",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer24_moe_expert8 -> layer24_moe_comm_from_expert8	[pos="e,4227,28530 4227,28566 4227,28566 4227,28540 4227,28540"];
	layer24_moe_comm_to_expert8 -> layer24_moe_expert8	[pos="e,4227,28619 4227,28654 4227,28654 4227,28629 4227,28629"];
	layer24_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L24\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4610,28592",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer24_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4536,28501",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer24_moe_expert9 -> layer24_moe_comm_from_expert9	[pos="e,4536.3,28530 4536.3,28566 4536.3,28566 4536.3,28540 4536.3,28540"];
	layer24_moe_comm_to_expert9 -> layer24_moe_expert9	[pos="e,4536.3,28619 4536.3,28654 4536.3,28654 4536.3,28629 4536.3,28629"];
	layer24_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L24\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4961,28592",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer24_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4868,28501",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer24_moe_expert10 -> layer24_moe_comm_from_expert10	[pos="e,4877.4,28530 4877.4,28566 4877.4,28566 4877.4,28540 4877.4,28540"];
	layer24_moe_comm_to_expert10 -> layer24_moe_expert10	[pos="e,4877,28619 4877,28654 4877,28654 4877,28629 4877,28629"];
	layer24_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L24\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5317,28592",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer24_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5215,28501",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer24_moe_expert11 -> layer24_moe_comm_from_expert11	[pos="e,5228.9,28530 5228.9,28566 5228.9,28566 5228.9,28540 5228.9,28540"];
	layer24_moe_comm_to_expert11 -> layer24_moe_expert11	[pos="e,5228,28618 5228,28654 5228,28654 5228,28628 5228,28628"];
	layer24_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L24\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5673,28592",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer24_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5566,28501",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer24_moe_expert12 -> layer24_moe_comm_from_expert12	[pos="e,5582.4,28530 5582.4,28566 5582.4,28566 5582.4,28540 5582.4,28540"];
	layer24_moe_comm_to_expert12 -> layer24_moe_expert12	[pos="e,5581.5,28618 5581.5,28654 5581.5,28654 5581.5,28628 5581.5,28628"];
	layer24_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L24\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="6029,28592",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer24_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5920,28501",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer24_moe_expert13 -> layer24_moe_comm_from_expert13	[pos="e,5937.4,28530 5937.4,28566 5937.4,28566 5937.4,28540 5937.4,28540"];
	layer24_moe_comm_to_expert13 -> layer24_moe_expert13	[pos="e,5936,28618 5936,28654 5936,28654 5936,28628 5936,28628"];
	layer24_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L24\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6385,28592",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer24_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6275,28501",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer24_moe_expert14 -> layer24_moe_comm_from_expert14	[pos="e,6292.9,28530 6292.9,28566 6292.9,28566 6292.9,28540 6292.9,28540"];
	layer24_moe_comm_to_expert14 -> layer24_moe_expert14	[pos="e,6291.5,28618 6291.5,28654 6291.5,28654 6291.5,28628 6291.5,28628"];
	layer24_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L24\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6741,28592",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer24_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6630,28501",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer24_moe_expert15 -> layer24_moe_comm_from_expert15	[pos="e,6648.4,28530 6648.4,28566 6648.4,28566 6648.4,28540 6648.4,28540"];
	layer24_moe_comm_to_expert15 -> layer24_moe_expert15	[pos="e,6647,28618 6647,28654 6647,28654 6647,28628 6647,28628"];
	layer24_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L24\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4054,28384",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer25_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L25\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4054,28270",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer24_moe_aggregate -> layer25_moe_mha	[pos="e,4054,28297 4054,28332 4054,28332 4054,28307 4054,28307"];
	layer24_moe_comm_from_expert0 -> layer24_moe_aggregate	[pos="e,3807,28347 2043.8,28474 2043.8,28430 2043.8,28347 2043.8,28347 2043.8,28347 3797,28347 3797,28347"];
	layer24_moe_comm_from_expert1 -> layer24_moe_aggregate	[pos="e,3822.3,28362 2339.3,28490 2339.3,28458 2339.3,28362 2339.3,28362 2339.3,28362 3812.3,28362 3812.3,28362"];
	layer24_moe_comm_from_expert2 -> layer24_moe_aggregate	[pos="e,3836.9,28376 2744,28474 2744,28437 2744,28376 2744,28376 2744,28376 3826.9,28376 3826.9,28376"];
	layer24_moe_comm_from_expert3 -> layer24_moe_aggregate	[pos="e,3852.2,28391 3099.5,28479 3099.5,28447 3099.5,28391 3099.5,28391 3099.5,28391 3842.2,28391 3842.2,28391"];
	layer24_moe_comm_from_expert4 -> layer24_moe_aggregate	[pos="e,3867.5,28406 3376.5,28485 3376.5,28457 3376.5,28406 3376.5,28406 3376.5,28406 3857.5,28406 3857.5,28406"];
	layer24_moe_comm_from_expert5 -> layer24_moe_aggregate	[pos="e,3883.1,28421 3614.5,28488 3614.5,28466 3614.5,28421 3614.5,28421 3614.5,28421 3873.1,28421 3873.1,28421"];
	layer24_moe_comm_from_expert6 -> layer24_moe_aggregate	[pos="e,3815.1,28384 3815.1,28482 3815.1,28482 3815.1,28394 3815.1,28394"];
	layer24_moe_comm_from_expert7 -> layer24_moe_aggregate	[pos="e,3955,28436 3955,28472 3955,28472 3955,28446 3955,28446"];
	layer24_moe_comm_from_expert8 -> layer24_moe_aggregate	[pos="e,4226.4,28436 4226.4,28472 4226.4,28472 4226.4,28446 4226.4,28446"];
	layer24_moe_comm_from_expert9 -> layer24_moe_aggregate	[pos="e,4302.7,28423 4517.5,28473 4517.5,28450 4517.5,28423 4517.5,28423 4517.5,28423 4312.7,28423 4312.7,28423"];
	layer24_moe_comm_from_expert10 -> layer24_moe_aggregate	[pos="e,4289.1,28410 4849.1,28472 4849.1,28446 4849.1,28410 4849.1,28410 4849.1,28410 4299.1,28410 4299.1,28410"];
	layer24_moe_comm_from_expert11 -> layer24_moe_aggregate	[pos="e,4275.8,28397 5195.6,28473 5195.6,28442 5195.6,28397 5195.6,28397 5195.6,28397 4285.8,28397 4285.8,28397"];
	layer24_moe_comm_from_expert12 -> layer24_moe_aggregate	[pos="e,4262.3,28384 5546.6,28473 5546.6,28438 5546.6,28384 5546.6,28384 5546.6,28384 4272.3,28384 4272.3,28384"];
	layer24_moe_comm_from_expert13 -> layer24_moe_aggregate	[pos="e,4249,28371 5900.1,28473 5900.1,28434 5900.1,28371 5900.1,28371 5900.1,28371 4259,28371 4259,28371"];
	layer24_moe_comm_from_expert14 -> layer24_moe_aggregate	[pos="e,4235.5,28358 6255.1,28473 6255.1,28431 6255.1,28358 6255.1,28358 6255.1,28358 4245.5,28358 4245.5,28358"];
	layer24_moe_comm_from_expert15 -> layer24_moe_aggregate	[pos="e,4222.2,28345 6610.1,28473 6610.1,28428 6610.1,28345 6610.1,28345 6610.1,28345 4232.2,28345 4232.2,28345"];
	layer25_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L25\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4054,28156",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer25_moe_mha -> layer25_moe_gate	[pos="e,4054,28208 4054,28244 4054,28244 4054,28218 4054,28218"];
	layer25_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L25\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4054,28016",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer25_moe_gate -> layer25_moe_split	[pos="e,4054,28068 4054,28104 4054,28104 4054,28078 4054,28078"];
	layer25_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1618,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer25_moe_split -> layer25_moe_comm_to_expert0	[pos="e,1693.3,27915 3888.5,28053 3351.6,28053 1693.3,28053 1693.3,28053 1693.3,28053 1693.3,27925 1693.3,27925",
		style=dashed];
	layer25_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1890,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer25_moe_split -> layer25_moe_comm_to_expert1	[pos="e,1950,27921 3873.2,28038 3363.3,28038 1950,28038 1950,28038 1950,28038 1950,27931 1950,27931",
		style=dashed];
	layer25_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2211,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer25_moe_split -> layer25_moe_comm_to_expert2	[pos="e,2233,27928 3858.3,28023 3387.9,28023 2233,28023 2233,28023 2233,28023 2233,27938 2233,27938",
		style=dashed];
	layer25_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2777,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer25_moe_split -> layer25_moe_comm_to_expert3	[pos="e,2834.5,27922 3843.7,28008 3494.8,28008 2834.5,28008 2834.5,28008 2834.5,28008 2834.5,27932 2834.5,27932",
		style=dashed];
	layer25_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3160,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer25_moe_split -> layer25_moe_comm_to_expert4	[pos="e,3231,27918 3829.7,27994 3586,27994 3231,27994 3231,27994 3231,27994 3231,27928 3231,27928",
		style=dashed];
	layer25_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3451,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer25_moe_split -> layer25_moe_comm_to_expert5	[pos="e,3492,27925 3814.4,27979 3661.6,27979 3492,27979 3492,27979 3492,27979 3492,27935 3492,27935",
		style=dashed];
	layer25_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3696,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer25_moe_split -> layer25_moe_comm_to_expert6	[pos="e,3786.7,27899 3813.7,28016 3813.7,28013 3813.7,27899 3813.7,27899 3813.7,27899 3796.7,27899 3796.7,27899",
		style=dashed];
	layer25_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3918,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer25_moe_split -> layer25_moe_comm_to_expert7	[pos="e,3918,27929 3918,27964 3918,27964 3918,27939 3918,27939",
		style=dashed];
	layer25_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4190,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer25_moe_split -> layer25_moe_comm_to_expert8	[pos="e,4190,27929 4190,27964 4190,27964 4190,27939 4190,27939",
		style=dashed];
	layer25_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4499,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer25_moe_split -> layer25_moe_comm_to_expert9	[pos="e,4408.3,27899 4294.3,28016 4294.3,28013 4294.3,27899 4294.3,27899 4294.3,27899 4398.3,27899 4398.3,27899",
		style=dashed];
	layer25_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4831,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer25_moe_split -> layer25_moe_comm_to_expert10	[pos="e,4755.1,27917 4218.8,27979 4426.1,27979 4755.1,27979 4755.1,27979 4755.1,27979 4755.1,27927 4755.1,27927",
		style=dashed];
	layer25_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5177,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer25_moe_split -> layer25_moe_comm_to_expert11	[pos="e,5101.6,27917 4233.8,27994 4533.2,27994 5101.6,27994 5101.6,27994 5101.6,27994 5101.6,27927 5101.6,27927",
		style=dashed];
	layer25_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5528,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer25_moe_split -> layer25_moe_comm_to_expert12	[pos="e,5452.6,27917 4248.1,28008 4632.2,28008 5452.6,28008 5452.6,28008 5452.6,28008 5452.6,27927 5452.6,27927",
		style=dashed];
	layer25_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5881,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer25_moe_split -> layer25_moe_comm_to_expert13	[pos="e,5806.1,27917 4262.7,28023 4727.3,28023 5806.1,28023 5806.1,28023 5806.1,28023 5806.1,27927 5806.1,27927",
		style=dashed];
	layer25_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6236,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer25_moe_split -> layer25_moe_comm_to_expert14	[pos="e,6161.1,27917 4278,28038 4820.6,28038 6161.1,28038 6161.1,28038 6161.1,28038 6161.1,27927 6161.1,27927",
		style=dashed];
	layer25_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6591,27899",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer25_moe_split -> layer25_moe_comm_to_expert15	[pos="e,6516.1,27917 4292.9,28053 4911.2,28053 6516.1,28053 6516.1,28053 6516.1,28053 6516.1,27927 6516.1,27927",
		style=dashed];
	layer25_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L25\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1459,27808",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer25_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1505,27717",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer25_moe_expert0 -> layer25_moe_comm_from_expert0	[pos="e,1505,27746 1505,27782 1505,27782 1505,27756 1505,27756"];
	layer25_moe_comm_to_expert0 -> layer25_moe_expert0	[pos="e,1575.2,27835 1575.2,27873 1575.2,27873 1575.2,27845 1575.2,27845"];
	layer25_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L25\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1805,27808",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer25_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2218,27717",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer25_moe_expert1 -> layer25_moe_comm_from_expert1	[pos="e,2127.2,27717 1959.5,27782 1959.5,27755 1959.5,27717 1959.5,27717 1959.5,27717 2117.2,27717 2117.2,27717"];
	layer25_moe_comm_to_expert1 -> layer25_moe_expert1	[pos="e,1884.2,27835 1884.2,27870 1884.2,27870 1884.2,27845 1884.2,27845"];
	layer25_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L25\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2151,27808",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer25_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2674,27717",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer25_moe_expert2 -> layer25_moe_comm_from_expert2	[pos="e,2583.4,27717 2315.2,27808 2320.8,27808 2324,27808 2324,27808 2324,27808 2324,27717 2324,27717 2324,27717 2573.4,27717 2573.4,27717"];
	layer25_moe_comm_to_expert2 -> layer25_moe_expert2	[pos="e,2211,27835 2211,27870 2211,27870 2211,27845 2211,27845"];
	layer25_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L25\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2497,27808",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer25_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="3002,27717",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer25_moe_expert3 -> layer25_moe_comm_from_expert3	[pos="e,2943.3,27740 2622.2,27782 2622.2,27770 2622.2,27758 2622.2,27758 2622.2,27758 2943.3,27758 2943.3,27758 2943.3,27758 2943.3,27750 \
2943.3,27750"];
	layer25_moe_comm_to_expert3 -> layer25_moe_expert3	[pos="e,2640.7,27835 2686.5,27899 2661.3,27899 2640.7,27899 2640.7,27899 2640.7,27899 2640.7,27845 2640.7,27845"];
	layer25_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L25\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2843,27808",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer25_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3265,27717",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer25_moe_expert4 -> layer25_moe_comm_from_expert4	[pos="e,3263.7,27746 2975.2,27782 2975.2,27775 2975.2,27770 2975.2,27770 2975.2,27770 3263.7,27770 3263.7,27770 3263.7,27770 3263.7,27756 \
3263.7,27756"];
	layer25_moe_comm_to_expert4 -> layer25_moe_expert4	[pos="e,2977.7,27835 3069.4,27899 3023.7,27899 2977.7,27899 2977.7,27899 2977.7,27899 2977.7,27845 2977.7,27845"];
	layer25_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L25\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3189,27808",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer25_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3496,27717",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer25_moe_expert5 -> layer25_moe_comm_from_expert5	[pos="e,3405.2,27717 3353,27799 3359.4,27799 3363.2,27799 3363.2,27799 3363.2,27799 3363.2,27717 3363.2,27717 3363.2,27717 3395.2,27717 \
3395.2,27717"];
	layer25_moe_comm_to_expert5 -> layer25_moe_expert5	[pos="e,3353.1,27816 3365.8,27889 3365.8,27867 3365.8,27816 3365.8,27816 3365.8,27816 3363.1,27816 3363.1,27816"];
	layer25_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L25\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3535,27808",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer25_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3711,27717",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer25_moe_expert6 -> layer25_moe_comm_from_expert6	[pos="e,3659.7,27741 3659.7,27782 3659.7,27782 3659.7,27751 3659.7,27751"];
	layer25_moe_comm_to_expert6 -> layer25_moe_expert6	[pos="e,3652.2,27835 3652.2,27873 3652.2,27873 3652.2,27845 3652.2,27845"];
	layer25_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L25\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3881,27808",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer25_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3918,27717",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer25_moe_expert7 -> layer25_moe_comm_from_expert7	[pos="e,3918,27746 3918,27782 3918,27782 3918,27756 3918,27756"];
	layer25_moe_comm_to_expert7 -> layer25_moe_expert7	[pos="e,3918,27835 3918,27870 3918,27870 3918,27845 3918,27845"];
	layer25_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L25\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4227,27808",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer25_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4190,27717",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer25_moe_expert8 -> layer25_moe_comm_from_expert8	[pos="e,4190,27746 4190,27782 4190,27782 4190,27756 4190,27756"];
	layer25_moe_comm_to_expert8 -> layer25_moe_expert8	[pos="e,4190,27835 4190,27870 4190,27870 4190,27845 4190,27845"];
	layer25_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L25\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4573,27808",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer25_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4499,27717",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer25_moe_expert9 -> layer25_moe_comm_from_expert9	[pos="e,4499.3,27746 4499.3,27782 4499.3,27782 4499.3,27756 4499.3,27756"];
	layer25_moe_comm_to_expert9 -> layer25_moe_expert9	[pos="e,4499.3,27835 4499.3,27870 4499.3,27870 4499.3,27845 4499.3,27845"];
	layer25_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L25\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4924,27808",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer25_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4831,27717",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer25_moe_expert10 -> layer25_moe_comm_from_expert10	[pos="e,4840.4,27746 4840.4,27782 4840.4,27782 4840.4,27756 4840.4,27756"];
	layer25_moe_comm_to_expert10 -> layer25_moe_expert10	[pos="e,4840,27835 4840,27870 4840,27870 4840,27845 4840,27845"];
	layer25_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L25\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5280,27808",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer25_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5178,27717",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer25_moe_expert11 -> layer25_moe_comm_from_expert11	[pos="e,5191.9,27746 5191.9,27782 5191.9,27782 5191.9,27756 5191.9,27756"];
	layer25_moe_comm_to_expert11 -> layer25_moe_expert11	[pos="e,5191,27834 5191,27871 5191,27871 5191,27844 5191,27844"];
	layer25_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L25\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5636,27808",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer25_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5529,27717",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer25_moe_expert12 -> layer25_moe_comm_from_expert12	[pos="e,5545.4,27746 5545.4,27782 5545.4,27782 5545.4,27756 5545.4,27756"];
	layer25_moe_comm_to_expert12 -> layer25_moe_expert12	[pos="e,5544.5,27834 5544.5,27871 5544.5,27871 5544.5,27844 5544.5,27844"];
	layer25_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L25\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5992,27808",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer25_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5883,27717",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer25_moe_expert13 -> layer25_moe_comm_from_expert13	[pos="e,5900.4,27746 5900.4,27782 5900.4,27782 5900.4,27756 5900.4,27756"];
	layer25_moe_comm_to_expert13 -> layer25_moe_expert13	[pos="e,5899,27834 5899,27871 5899,27871 5899,27844 5899,27844"];
	layer25_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L25\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6348,27808",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer25_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6238,27717",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer25_moe_expert14 -> layer25_moe_comm_from_expert14	[pos="e,6255.9,27746 6255.9,27782 6255.9,27782 6255.9,27756 6255.9,27756"];
	layer25_moe_comm_to_expert14 -> layer25_moe_expert14	[pos="e,6254.5,27834 6254.5,27871 6254.5,27871 6254.5,27844 6254.5,27844"];
	layer25_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L25\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6704,27808",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer25_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6593,27717",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer25_moe_expert15 -> layer25_moe_comm_from_expert15	[pos="e,6611.4,27746 6611.4,27782 6611.4,27782 6611.4,27756 6611.4,27756"];
	layer25_moe_comm_to_expert15 -> layer25_moe_expert15	[pos="e,6610,27834 6610,27871 6610,27871 6610,27844 6610,27844"];
	layer25_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L25\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4017,27600",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer26_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L26\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="4017,27486",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer25_moe_aggregate -> layer26_moe_mha	[pos="e,4017,27513 4017,27548 4017,27548 4017,27523 4017,27523"];
	layer25_moe_comm_from_expert0 -> layer25_moe_aggregate	[pos="e,3769.9,27563 1590.8,27708 1590.8,27674 1590.8,27563 1590.8,27563 1590.8,27563 3759.9,27563 3759.9,27563"];
	layer25_moe_comm_from_expert1 -> layer25_moe_aggregate	[pos="e,3785.3,27578 2302.3,27706 2302.3,27674 2302.3,27578 2302.3,27578 2302.3,27578 3775.3,27578 3775.3,27578"];
	layer25_moe_comm_from_expert2 -> layer25_moe_aggregate	[pos="e,3799.6,27592 2746,27700 2746,27665 2746,27592 2746,27592 2746,27592 3789.6,27592 3789.6,27592"];
	layer25_moe_comm_from_expert3 -> layer25_moe_aggregate	[pos="e,3815.3,27607 3074,27700 3074,27668 3074,27607 3074,27607 3074,27607 3805.3,27607 3805.3,27607"];
	layer25_moe_comm_from_expert4 -> layer25_moe_aggregate	[pos="e,3830.6,27622 3344.8,27703 3344.8,27677 3344.8,27622 3344.8,27622 3344.8,27622 3820.6,27622 3820.6,27622"];
	layer25_moe_comm_from_expert5 -> layer25_moe_aggregate	[pos="e,3846,27637 3566.5,27699 3566.5,27675 3566.5,27637 3566.5,27637 3566.5,27637 3836,27637 3836,27637"];
	layer25_moe_comm_from_expert6 -> layer25_moe_aggregate	[pos="e,3778.1,27600 3778.1,27698 3778.1,27698 3778.1,27610 3778.1,27610"];
	layer25_moe_comm_from_expert7 -> layer25_moe_aggregate	[pos="e,3918,27652 3918,27688 3918,27688 3918,27662 3918,27662"];
	layer25_moe_comm_from_expert8 -> layer25_moe_aggregate	[pos="e,4189.4,27652 4189.4,27688 4189.4,27688 4189.4,27662 4189.4,27662"];
	layer25_moe_comm_from_expert9 -> layer25_moe_aggregate	[pos="e,4265.4,27639 4480.5,27689 4480.5,27666 4480.5,27639 4480.5,27639 4480.5,27639 4275.4,27639 4275.4,27639"];
	layer25_moe_comm_from_expert10 -> layer25_moe_aggregate	[pos="e,4252.1,27626 4812.1,27688 4812.1,27662 4812.1,27626 4812.1,27626 4812.1,27626 4262.1,27626 4262.1,27626"];
	layer25_moe_comm_from_expert11 -> layer25_moe_aggregate	[pos="e,4238.8,27613 5158.6,27689 5158.6,27658 5158.6,27613 5158.6,27613 5158.6,27613 4248.8,27613 4248.8,27613"];
	layer25_moe_comm_from_expert12 -> layer25_moe_aggregate	[pos="e,4225.3,27600 5509.6,27689 5509.6,27654 5509.6,27600 5509.6,27600 5509.6,27600 4235.3,27600 4235.3,27600"];
	layer25_moe_comm_from_expert13 -> layer25_moe_aggregate	[pos="e,4212,27587 5863.1,27689 5863.1,27650 5863.1,27587 5863.1,27587 5863.1,27587 4222,27587 4222,27587"];
	layer25_moe_comm_from_expert14 -> layer25_moe_aggregate	[pos="e,4198.5,27574 6218.1,27689 6218.1,27647 6218.1,27574 6218.1,27574 6218.1,27574 4208.5,27574 4208.5,27574"];
	layer25_moe_comm_from_expert15 -> layer25_moe_aggregate	[pos="e,4185.2,27561 6573.1,27689 6573.1,27644 6573.1,27561 6573.1,27561 6573.1,27561 4195.2,27561 4195.2,27561"];
	layer26_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L26\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="4017,27372",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer26_moe_mha -> layer26_moe_gate	[pos="e,4017,27424 4017,27460 4017,27460 4017,27434 4017,27434"];
	layer26_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L26\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="4017,27232",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer26_moe_gate -> layer26_moe_split	[pos="e,4017,27285 4017,27320 4017,27320 4017,27295 4017,27295"];
	layer26_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1468,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer26_moe_split -> layer26_moe_comm_to_expert0	[pos="e,1486.5,27144 3851.5,27269 3289,27269 1486.5,27269 1486.5,27269 1486.5,27269 1486.5,27154 1486.5,27154",
		style=dashed];
	layer26_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2181,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer26_moe_split -> layer26_moe_comm_to_expert1	[pos="e,2199.5,27144 3836.5,27254 3377.1,27254 2199.5,27254 2199.5,27254 2199.5,27254 2199.5,27154 2199.5,27154",
		style=dashed];
	layer26_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2637,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer26_moe_split -> layer26_moe_comm_to_expert2	[pos="e,2655.5,27144 3821.6,27239 3445,27239 2655.5,27239 2655.5,27239 2655.5,27239 2655.5,27154 2655.5,27154",
		style=dashed];
	layer26_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2965,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer26_moe_split -> layer26_moe_comm_to_expert3	[pos="e,2983.5,27144 3806.6,27224 3504.4,27224 2983.5,27224 2983.5,27224 2983.5,27224 2983.5,27154 2983.5,27154",
		style=dashed];
	layer26_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3228,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer26_moe_split -> layer26_moe_comm_to_expert4	[pos="e,3246.5,27144 3792.6,27210 3565.1,27210 3246.5,27210 3246.5,27210 3246.5,27210 3246.5,27154 3246.5,27154",
		style=dashed];
	layer26_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3459,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer26_moe_split -> layer26_moe_comm_to_expert5	[pos="e,3477.5,27144 3777.6,27195 3633.4,27195 3477.5,27195 3477.5,27195 3477.5,27195 3477.5,27154 3477.5,27154",
		style=dashed];
	layer26_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3674,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer26_moe_split -> layer26_moe_comm_to_expert6	[pos="e,3764.8,27115 3777.5,27232 3777.5,27229 3777.5,27115 3777.5,27115 3777.5,27115 3774.8,27115 3774.8,27115",
		style=dashed];
	layer26_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3881,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer26_moe_split -> layer26_moe_comm_to_expert7	[pos="e,3881,27145 3881,27180 3881,27180 3881,27155 3881,27155",
		style=dashed];
	layer26_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4153,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer26_moe_split -> layer26_moe_comm_to_expert8	[pos="e,4153,27145 4153,27180 4153,27180 4153,27155 4153,27155",
		style=dashed];
	layer26_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4462,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer26_moe_split -> layer26_moe_comm_to_expert9	[pos="e,4371.3,27115 4257.3,27232 4257.3,27229 4257.3,27115 4257.3,27115 4257.3,27115 4361.3,27115 4361.3,27115",
		style=dashed];
	layer26_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4794,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer26_moe_split -> layer26_moe_comm_to_expert10	[pos="e,4718.1,27133 4181.8,27195 4389.1,27195 4718.1,27195 4718.1,27195 4718.1,27195 4718.1,27143 4718.1,27143",
		style=dashed];
	layer26_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5140,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer26_moe_split -> layer26_moe_comm_to_expert11	[pos="e,5064.6,27133 4196.8,27210 4496.2,27210 5064.6,27210 5064.6,27210 5064.6,27210 5064.6,27143 5064.6,27143",
		style=dashed];
	layer26_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5491,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer26_moe_split -> layer26_moe_comm_to_expert12	[pos="e,5415.6,27133 4210.7,27224 4594.7,27224 5415.6,27224 5415.6,27224 5415.6,27224 5415.6,27143 5415.6,27143",
		style=dashed];
	layer26_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5844,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer26_moe_split -> layer26_moe_comm_to_expert13	[pos="e,5769.1,27133 4225.7,27239 4690.3,27239 5769.1,27239 5769.1,27239 5769.1,27239 5769.1,27143 5769.1,27143",
		style=dashed];
	layer26_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6199,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer26_moe_split -> layer26_moe_comm_to_expert14	[pos="e,6124.1,27133 4241,27254 4783.6,27254 6124.1,27254 6124.1,27254 6124.1,27254 6124.1,27143 6124.1,27143",
		style=dashed];
	layer26_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6554,27115",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer26_moe_split -> layer26_moe_comm_to_expert15	[pos="e,6479.1,27133 4255.9,27269 4874.2,27269 6479.1,27269 6479.1,27269 6479.1,27269 6479.1,27143 6479.1,27143",
		style=dashed];
	layer26_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L26\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1422,27024",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer26_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1468,26933",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer26_moe_expert0 -> layer26_moe_comm_from_expert0	[pos="e,1468,26962 1468,26998 1468,26998 1468,26972 1468,26972"];
	layer26_moe_comm_to_expert0 -> layer26_moe_expert0	[pos="e,1468,27051 1468,27086 1468,27086 1468,27061 1468,27061"];
	layer26_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L26\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1768,27024",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer26_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2181,26933",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer26_moe_expert1 -> layer26_moe_comm_from_expert1	[pos="e,2090.2,26933 1922.5,26998 1922.5,26971 1922.5,26933 1922.5,26933 1922.5,26933 2080.2,26933 2080.2,26933"];
	layer26_moe_comm_to_expert1 -> layer26_moe_expert1	[pos="e,1786.5,27051 2090.5,27115 1974,27115 1786.5,27115 1786.5,27115 1786.5,27115 1786.5,27061 1786.5,27061"];
	layer26_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L26\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2114,27024",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer26_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2637,26933",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer26_moe_expert2 -> layer26_moe_comm_from_expert2	[pos="e,2546.3,26933 2278.2,27015 2285.6,27015 2290,27015 2290,27015 2290,27015 2290,26933 2290,26933 2290,26933 2536.3,26933 2536.3,26933"];
	layer26_moe_comm_to_expert2 -> layer26_moe_expert2	[pos="e,2278.3,27033 2546.1,27115 2441.5,27115 2284,27115 2284,27115 2284,27115 2284,27033 2284,27033 2284,27033 2283.4,27033 2283.4,27033"];
	layer26_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L26\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2460,27024",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer26_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2965,26933",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer26_moe_expert3 -> layer26_moe_comm_from_expert3	[pos="e,2906.3,26956 2585.2,26998 2585.2,26986 2585.2,26974 2585.2,26974 2585.2,26974 2906.3,26974 2906.3,26974 2906.3,26974 2906.3,26966 \
2906.3,26966"];
	layer26_moe_comm_to_expert3 -> layer26_moe_expert3	[pos="e,2585.2,27051 2906.3,27093 2906.3,27083 2906.3,27074 2906.3,27074 2906.3,27074 2585.2,27074 2585.2,27074 2585.2,27074 2585.2,27061 \
2585.2,27061"];
	layer26_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L26\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2806,27024",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer26_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3228,26933",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer26_moe_expert4 -> layer26_moe_comm_from_expert4	[pos="e,3226.7,26962 2938.2,26998 2938.2,26991 2938.2,26986 2938.2,26986 2938.2,26986 3226.7,26986 3226.7,26986 3226.7,26986 3226.7,26972 \
3226.7,26972"];
	layer26_moe_comm_to_expert4 -> layer26_moe_expert4	[pos="e,2938.2,27050 3226.7,27086 3226.7,27074 3226.7,27062 3226.7,27062 3226.7,27062 2938.2,27062 2938.2,27062 2938.2,27062 2938.2,27060 \
2938.2,27060"];
	layer26_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L26\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3152,27024",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer26_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3459,26933",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer26_moe_expert5 -> layer26_moe_comm_from_expert5	[pos="e,3368.2,26933 3316.1,27015 3324.1,27015 3328.8,27015 3328.8,27015 3328.8,27015 3328.8,26933 3328.8,26933 3328.8,26933 3358.2,26933 \
3358.2,26933"];
	layer26_moe_comm_to_expert5 -> layer26_moe_expert5	[pos="e,3316.3,27033 3368.4,27115 3343.7,27115 3323.7,27115 3323.7,27115 3323.7,27115 3323.7,27033 3323.7,27033 3323.7,27033 3322.9,27033 \
3322.9,27033"];
	layer26_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L26\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3498,27024",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer26_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3674,26933",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer26_moe_expert6 -> layer26_moe_comm_from_expert6	[pos="e,3622.7,26957 3622.7,26998 3622.7,26998 3622.7,26967 3622.7,26967"];
	layer26_moe_comm_to_expert6 -> layer26_moe_expert6	[pos="e,3622.7,27051 3622.7,27091 3622.7,27091 3622.7,27061 3622.7,27061"];
	layer26_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L26\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3844,27024",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer26_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3881,26933",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer26_moe_expert7 -> layer26_moe_comm_from_expert7	[pos="e,3881,26962 3881,26998 3881,26998 3881,26972 3881,26972"];
	layer26_moe_comm_to_expert7 -> layer26_moe_expert7	[pos="e,3881,27051 3881,27086 3881,27086 3881,27061 3881,27061"];
	layer26_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L26\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4190,27024",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer26_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4153,26933",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer26_moe_expert8 -> layer26_moe_comm_from_expert8	[pos="e,4153,26962 4153,26998 4153,26998 4153,26972 4153,26972"];
	layer26_moe_comm_to_expert8 -> layer26_moe_expert8	[pos="e,4153,27051 4153,27086 4153,27086 4153,27061 4153,27061"];
	layer26_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L26\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4536,27024",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer26_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4462,26933",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer26_moe_expert9 -> layer26_moe_comm_from_expert9	[pos="e,4462.3,26962 4462.3,26998 4462.3,26998 4462.3,26972 4462.3,26972"];
	layer26_moe_comm_to_expert9 -> layer26_moe_expert9	[pos="e,4462.3,27051 4462.3,27086 4462.3,27086 4462.3,27061 4462.3,27061"];
	layer26_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L26\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4887,27024",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer26_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4794,26933",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer26_moe_expert10 -> layer26_moe_comm_from_expert10	[pos="e,4803.4,26962 4803.4,26998 4803.4,26998 4803.4,26972 4803.4,26972"];
	layer26_moe_comm_to_expert10 -> layer26_moe_expert10	[pos="e,4803,27051 4803,27086 4803,27086 4803,27061 4803,27061"];
	layer26_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L26\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5243,27024",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer26_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5141,26933",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer26_moe_expert11 -> layer26_moe_comm_from_expert11	[pos="e,5154.9,26962 5154.9,26998 5154.9,26998 5154.9,26972 5154.9,26972"];
	layer26_moe_comm_to_expert11 -> layer26_moe_expert11	[pos="e,5154,27050 5154,27087 5154,27087 5154,27060 5154,27060"];
	layer26_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L26\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5599,27024",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer26_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5492,26933",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer26_moe_expert12 -> layer26_moe_comm_from_expert12	[pos="e,5508.4,26962 5508.4,26998 5508.4,26998 5508.4,26972 5508.4,26972"];
	layer26_moe_comm_to_expert12 -> layer26_moe_expert12	[pos="e,5507.5,27050 5507.5,27087 5507.5,27087 5507.5,27060 5507.5,27060"];
	layer26_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L26\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5955,27024",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer26_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5846,26933",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer26_moe_expert13 -> layer26_moe_comm_from_expert13	[pos="e,5863.4,26962 5863.4,26998 5863.4,26998 5863.4,26972 5863.4,26972"];
	layer26_moe_comm_to_expert13 -> layer26_moe_expert13	[pos="e,5862,27050 5862,27087 5862,27087 5862,27060 5862,27060"];
	layer26_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L26\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6311,27024",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer26_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6201,26933",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer26_moe_expert14 -> layer26_moe_comm_from_expert14	[pos="e,6218.9,26962 6218.9,26998 6218.9,26998 6218.9,26972 6218.9,26972"];
	layer26_moe_comm_to_expert14 -> layer26_moe_expert14	[pos="e,6217.5,27050 6217.5,27087 6217.5,27087 6217.5,27060 6217.5,27060"];
	layer26_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L26\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6667,27024",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer26_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6556,26933",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer26_moe_expert15 -> layer26_moe_comm_from_expert15	[pos="e,6574.4,26962 6574.4,26998 6574.4,26998 6574.4,26972 6574.4,26972"];
	layer26_moe_comm_to_expert15 -> layer26_moe_expert15	[pos="e,6573,27050 6573,27087 6573,27087 6573,27060 6573,27060"];
	layer26_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L26\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3980,26816",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer27_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L27\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3980,26702",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer26_moe_aggregate -> layer27_moe_mha	[pos="e,3980,26729 3980,26764 3980,26764 3980,26739 3980,26739"];
	layer26_moe_comm_from_expert0 -> layer26_moe_aggregate	[pos="e,3732.7,26779 1440.5,26905 1440.5,26861 1440.5,26779 1440.5,26779 1440.5,26779 3722.7,26779 3722.7,26779"];
	layer26_moe_comm_from_expert1 -> layer26_moe_aggregate	[pos="e,3748.3,26794 2265.3,26922 2265.3,26890 2265.3,26794 2265.3,26794 2265.3,26794 3738.3,26794 3738.3,26794"];
	layer26_moe_comm_from_expert2 -> layer26_moe_aggregate	[pos="e,3762.6,26808 2674.5,26907 2674.5,26870 2674.5,26808 2674.5,26808 2674.5,26808 3752.6,26808 3752.6,26808"];
	layer26_moe_comm_from_expert3 -> layer26_moe_aggregate	[pos="e,3778.1,26823 3029.5,26913 3029.5,26881 3029.5,26823 3029.5,26823 3029.5,26823 3768.1,26823 3768.1,26823"];
	layer26_moe_comm_from_expert4 -> layer26_moe_aggregate	[pos="e,3793.7,26838 3274.5,26908 3274.5,26880 3274.5,26838 3274.5,26838 3274.5,26838 3783.7,26838 3783.7,26838"];
	layer26_moe_comm_from_expert5 -> layer26_moe_aggregate	[pos="e,3809.2,26853 3496.5,26907 3496.5,26883 3496.5,26853 3496.5,26853 3496.5,26853 3799.2,26853 3799.2,26853"];
	layer26_moe_comm_from_expert6 -> layer26_moe_aggregate	[pos="e,3741.1,26816 3741.1,26914 3741.1,26914 3741.1,26826 3741.1,26826"];
	layer26_moe_comm_from_expert7 -> layer26_moe_aggregate	[pos="e,3881,26868 3881,26904 3881,26904 3881,26878 3881,26878"];
	layer26_moe_comm_from_expert8 -> layer26_moe_aggregate	[pos="e,4152.4,26868 4152.4,26904 4152.4,26904 4152.4,26878 4152.4,26878"];
	layer26_moe_comm_from_expert9 -> layer26_moe_aggregate	[pos="e,4228.4,26855 4443.5,26905 4443.5,26882 4443.5,26855 4443.5,26855 4443.5,26855 4238.4,26855 4238.4,26855"];
	layer26_moe_comm_from_expert10 -> layer26_moe_aggregate	[pos="e,4215.1,26842 4775.1,26904 4775.1,26878 4775.1,26842 4775.1,26842 4775.1,26842 4225.1,26842 4225.1,26842"];
	layer26_moe_comm_from_expert11 -> layer26_moe_aggregate	[pos="e,4201.8,26829 5121.6,26905 5121.6,26874 5121.6,26829 5121.6,26829 5121.6,26829 4211.8,26829 4211.8,26829"];
	layer26_moe_comm_from_expert12 -> layer26_moe_aggregate	[pos="e,4188.3,26816 5472.6,26905 5472.6,26870 5472.6,26816 5472.6,26816 5472.6,26816 4198.3,26816 4198.3,26816"];
	layer26_moe_comm_from_expert13 -> layer26_moe_aggregate	[pos="e,4175,26803 5826.1,26905 5826.1,26866 5826.1,26803 5826.1,26803 5826.1,26803 4185,26803 4185,26803"];
	layer26_moe_comm_from_expert14 -> layer26_moe_aggregate	[pos="e,4161.5,26790 6181.1,26905 6181.1,26863 6181.1,26790 6181.1,26790 6181.1,26790 4171.5,26790 4171.5,26790"];
	layer26_moe_comm_from_expert15 -> layer26_moe_aggregate	[pos="e,4148.2,26777 6536.1,26905 6536.1,26860 6536.1,26777 6536.1,26777 6536.1,26777 4158.2,26777 4158.2,26777"];
	layer27_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L27\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3980,26588",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer27_moe_mha -> layer27_moe_gate	[pos="e,3980,26640 3980,26676 3980,26676 3980,26650 3980,26650"];
	layer27_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L27\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3980,26448",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer27_moe_gate -> layer27_moe_split	[pos="e,3980,26501 3980,26536 3980,26536 3980,26511 3980,26511"];
	layer27_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1472,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer27_moe_split -> layer27_moe_comm_to_expert0	[pos="e,1499.5,26359 3814.4,26485 3259.3,26485 1499.5,26485 1499.5,26485 1499.5,26485 1499.5,26369 1499.5,26369",
		style=dashed];
	layer27_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2112,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer27_moe_split -> layer27_moe_comm_to_expert1	[pos="e,2146.5,26358 3799.2,26470 3336.6,26470 2146.5,26470 2146.5,26470 2146.5,26470 2146.5,26368 2146.5,26368",
		style=dashed];
	layer27_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2531,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer27_moe_split -> layer27_moe_comm_to_expert2	[pos="e,2584,26355 3784.4,26455 3400.2,26455 2584,26455 2584,26455 2584,26455 2584,26365 2584,26365",
		style=dashed];
	layer27_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2840,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer27_moe_split -> layer27_moe_comm_to_expert3	[pos="e,2902.5,26353 3769.4,26440 3455.7,26440 2902.5,26440 2902.5,26440 2902.5,26440 2902.5,26363 2902.5,26363",
		style=dashed];
	layer27_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3094,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer27_moe_split -> layer27_moe_comm_to_expert4	[pos="e,3161,26351 3755.4,26426 3512.9,26426 3161,26426 3161,26426 3161,26426 3161,26361 3161,26361",
		style=dashed];
	layer27_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3321,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer27_moe_split -> layer27_moe_comm_to_expert5	[pos="e,3390,26350 3740.4,26411 3577,26411 3390,26411 3390,26411 3390,26411 3390,26360 3390,26360",
		style=dashed];
	layer27_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3534,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer27_moe_split -> layer27_moe_comm_to_expert6	[pos="e,3624.5,26331 3739.7,26448 3739.7,26445 3739.7,26331 3739.7,26331 3739.7,26331 3634.5,26331 3634.5,26331",
		style=dashed];
	layer27_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3844,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer27_moe_split -> layer27_moe_comm_to_expert7	[pos="e,3844,26361 3844,26396 3844,26396 3844,26371 3844,26371",
		style=dashed];
	layer27_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4116,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer27_moe_split -> layer27_moe_comm_to_expert8	[pos="e,4116,26361 4116,26396 4116,26396 4116,26371 4116,26371",
		style=dashed];
	layer27_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4425,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer27_moe_split -> layer27_moe_comm_to_expert9	[pos="e,4334.3,26331 4220.3,26448 4220.3,26445 4220.3,26331 4220.3,26331 4220.3,26331 4324.3,26331 4324.3,26331",
		style=dashed];
	layer27_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4757,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer27_moe_split -> layer27_moe_comm_to_expert10	[pos="e,4681.1,26349 4144.8,26411 4352.1,26411 4681.1,26411 4681.1,26411 4681.1,26411 4681.1,26359 4681.1,26359",
		style=dashed];
	layer27_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5103,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer27_moe_split -> layer27_moe_comm_to_expert11	[pos="e,5027.6,26349 4159.8,26426 4459.2,26426 5027.6,26426 5027.6,26426 5027.6,26426 5027.6,26359 5027.6,26359",
		style=dashed];
	layer27_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5454,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer27_moe_split -> layer27_moe_comm_to_expert12	[pos="e,5378.6,26349 4173.7,26440 4557.7,26440 5378.6,26440 5378.6,26440 5378.6,26440 5378.6,26359 5378.6,26359",
		style=dashed];
	layer27_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5807,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer27_moe_split -> layer27_moe_comm_to_expert13	[pos="e,5732.1,26349 4188.7,26455 4653.3,26455 5732.1,26455 5732.1,26455 5732.1,26455 5732.1,26359 5732.1,26359",
		style=dashed];
	layer27_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6162,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer27_moe_split -> layer27_moe_comm_to_expert14	[pos="e,6087.1,26349 4204,26470 4746.6,26470 6087.1,26470 6087.1,26470 6087.1,26470 6087.1,26359 6087.1,26359",
		style=dashed];
	layer27_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6517,26331",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer27_moe_split -> layer27_moe_comm_to_expert15	[pos="e,6442.1,26349 4218.9,26485 4837.2,26485 6442.1,26485 6442.1,26485 6442.1,26485 6442.1,26359 6442.1,26359",
		style=dashed];
	layer27_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L27\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1385,26240",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer27_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1431,26149",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer27_moe_expert0 -> layer27_moe_comm_from_expert0	[pos="e,1431,26179 1431,26214 1431,26214 1431,26189 1431,26189"];
	layer27_moe_comm_to_expert0 -> layer27_moe_expert0	[pos="e,1465.2,26267 1465.2,26302 1465.2,26302 1465.2,26277 1465.2,26277"];
	layer27_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L27\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1731,26240",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer27_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2144,26149",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer27_moe_expert1 -> layer27_moe_comm_from_expert1	[pos="e,2053.2,26149 1885.5,26214 1885.5,26187 1885.5,26149 1885.5,26149 1885.5,26149 2043.2,26149 2043.2,26149"];
	layer27_moe_comm_to_expert1 -> layer27_moe_expert1	[pos="e,1749.5,26267 2021.5,26331 1914.1,26331 1749.5,26331 1749.5,26331 1749.5,26331 1749.5,26277 1749.5,26277"];
	layer27_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L27\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2077,26240",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer27_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2600,26149",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer27_moe_expert2 -> layer27_moe_comm_from_expert2	[pos="e,2509.4,26149 2241.2,26240 2246.8,26240 2250,26240 2250,26240 2250,26240 2250,26149 2250,26149 2250,26149 2499.4,26149 2499.4,26149"];
	layer27_moe_comm_to_expert2 -> layer27_moe_expert2	[pos="e,2221.8,26267 2440.3,26331 2349.1,26331 2221.8,26331 2221.8,26331 2221.8,26331 2221.8,26277 2221.8,26277"];
	layer27_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L27\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2423,26240",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer27_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2928,26149",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer27_moe_expert3 -> layer27_moe_comm_from_expert3	[pos="e,2869.3,26172 2548.2,26214 2548.2,26202 2548.2,26190 2548.2,26190 2548.2,26190 2869.3,26190 2869.3,26190 2869.3,26190 2869.3,26182 \
2869.3,26182"];
	layer27_moe_comm_to_expert3 -> layer27_moe_expert3	[pos="e,2513.7,26267 2840,26302 2840,26292 2840,26284 2840,26284 2840,26284 2513.7,26284 2513.7,26284 2513.7,26284 2513.7,26277 2513.7,\
26277"];
	layer27_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L27\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2769,26240",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer27_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3191,26149",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer27_moe_expert4 -> layer27_moe_comm_from_expert4	[pos="e,3189.7,26178 2901.2,26214 2901.2,26207 2901.2,26202 2901.2,26202 2901.2,26202 3189.7,26202 3189.7,26202 3189.7,26202 3189.7,26188 \
3189.7,26188"];
	layer27_moe_comm_to_expert4 -> layer27_moe_expert4	[pos="e,2933.2,26240 3003.4,26331 2970.8,26331 2942,26331 2942,26331 2942,26331 2942,26240 2942,26240 2942,26240 2941.1,26240 2941.1,26240"];
	layer27_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L27\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3115,26240",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer27_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3422,26149",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer27_moe_expert5 -> layer27_moe_comm_from_expert5	[pos="e,3331.1,26149 3279.2,26240 3284.8,26240 3288,26240 3288,26240 3288,26240 3288,26149 3288,26149 3288,26149 3321.1,26149 3321.1,26149"];
	layer27_moe_comm_to_expert5 -> layer27_moe_expert5	[pos="e,3254.7,26266 3254.7,26311 3254.7,26311 3254.7,26276 3254.7,26276"];
	layer27_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L27\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3461,26240",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer27_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3637,26149",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer27_moe_expert6 -> layer27_moe_comm_from_expert6	[pos="e,3585.7,26173 3585.7,26214 3585.7,26214 3585.7,26183 3585.7,26183"];
	layer27_moe_comm_to_expert6 -> layer27_moe_expert6	[pos="e,3534,26267 3534,26302 3534,26302 3534,26277 3534,26277"];
	layer27_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L27\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3807,26240",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer27_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3844,26149",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer27_moe_expert7 -> layer27_moe_comm_from_expert7	[pos="e,3844,26179 3844,26214 3844,26214 3844,26189 3844,26189"];
	layer27_moe_comm_to_expert7 -> layer27_moe_expert7	[pos="e,3844,26267 3844,26302 3844,26302 3844,26277 3844,26277"];
	layer27_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L27\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4153,26240",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer27_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4116,26149",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer27_moe_expert8 -> layer27_moe_comm_from_expert8	[pos="e,4116,26179 4116,26214 4116,26214 4116,26189 4116,26189"];
	layer27_moe_comm_to_expert8 -> layer27_moe_expert8	[pos="e,4116,26267 4116,26302 4116,26302 4116,26277 4116,26277"];
	layer27_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L27\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4499,26240",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer27_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4425,26149",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer27_moe_expert9 -> layer27_moe_comm_from_expert9	[pos="e,4425.3,26179 4425.3,26214 4425.3,26214 4425.3,26189 4425.3,26189"];
	layer27_moe_comm_to_expert9 -> layer27_moe_expert9	[pos="e,4425.3,26267 4425.3,26302 4425.3,26302 4425.3,26277 4425.3,26277"];
	layer27_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L27\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4850,26240",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer27_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4757,26149",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer27_moe_expert10 -> layer27_moe_comm_from_expert10	[pos="e,4766.4,26179 4766.4,26214 4766.4,26214 4766.4,26189 4766.4,26189"];
	layer27_moe_comm_to_expert10 -> layer27_moe_expert10	[pos="e,4766,26267 4766,26302 4766,26302 4766,26277 4766,26277"];
	layer27_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L27\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5206,26240",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer27_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5104,26149",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer27_moe_expert11 -> layer27_moe_comm_from_expert11	[pos="e,5117.9,26178 5117.9,26214 5117.9,26214 5117.9,26188 5117.9,26188"];
	layer27_moe_comm_to_expert11 -> layer27_moe_expert11	[pos="e,5117,26267 5117,26303 5117,26303 5117,26277 5117,26277"];
	layer27_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L27\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5562,26240",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer27_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5455,26149",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer27_moe_expert12 -> layer27_moe_comm_from_expert12	[pos="e,5471.4,26178 5471.4,26214 5471.4,26214 5471.4,26188 5471.4,26188"];
	layer27_moe_comm_to_expert12 -> layer27_moe_expert12	[pos="e,5470.5,26267 5470.5,26303 5470.5,26303 5470.5,26277 5470.5,26277"];
	layer27_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L27\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5918,26240",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer27_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5809,26149",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer27_moe_expert13 -> layer27_moe_comm_from_expert13	[pos="e,5826.4,26178 5826.4,26214 5826.4,26214 5826.4,26188 5826.4,26188"];
	layer27_moe_comm_to_expert13 -> layer27_moe_expert13	[pos="e,5825,26267 5825,26303 5825,26303 5825,26277 5825,26277"];
	layer27_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L27\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6274,26240",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer27_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6164,26149",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer27_moe_expert14 -> layer27_moe_comm_from_expert14	[pos="e,6181.9,26178 6181.9,26214 6181.9,26214 6181.9,26188 6181.9,26188"];
	layer27_moe_comm_to_expert14 -> layer27_moe_expert14	[pos="e,6180.5,26267 6180.5,26303 6180.5,26303 6180.5,26277 6180.5,26277"];
	layer27_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L27\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6630,26240",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer27_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6519,26149",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer27_moe_expert15 -> layer27_moe_comm_from_expert15	[pos="e,6537.4,26178 6537.4,26214 6537.4,26214 6537.4,26188 6537.4,26188"];
	layer27_moe_comm_to_expert15 -> layer27_moe_expert15	[pos="e,6536,26267 6536,26303 6536,26303 6536,26277 6536,26277"];
	layer27_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L27\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3943,26032",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer28_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L28\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3943,25918",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer27_moe_aggregate -> layer28_moe_mha	[pos="e,3943,25945 3943,25980 3943,25980 3943,25955 3943,25955"];
	layer27_moe_comm_from_expert0 -> layer27_moe_aggregate	[pos="e,3695.9,25995 1516.8,26140 1516.8,26106 1516.8,25995 1516.8,25995 1516.8,25995 3685.9,25995 3685.9,25995"];
	layer27_moe_comm_from_expert1 -> layer27_moe_aggregate	[pos="e,3711.3,26010 2228.3,26138 2228.3,26106 2228.3,26010 2228.3,26010 2228.3,26010 3701.3,26010 3701.3,26010"];
	layer27_moe_comm_from_expert2 -> layer27_moe_aggregate	[pos="e,3725.6,26024 2672,26132 2672,26097 2672,26024 2672,26024 2672,26024 3715.6,26024 3715.6,26024"];
	layer27_moe_comm_from_expert3 -> layer27_moe_aggregate	[pos="e,3741.3,26039 3000,26132 3000,26100 3000,26039 3000,26039 3000,26039 3731.3,26039 3731.3,26039"];
	layer27_moe_comm_from_expert4 -> layer27_moe_aggregate	[pos="e,3756.6,26054 3270.8,26135 3270.8,26109 3270.8,26054 3270.8,26054 3270.8,26054 3746.6,26054 3746.6,26054"];
	layer27_moe_comm_from_expert5 -> layer27_moe_aggregate	[pos="e,3772,26069 3492.5,26131 3492.5,26107 3492.5,26069 3492.5,26069 3492.5,26069 3762,26069 3762,26069"];
	layer27_moe_comm_from_expert6 -> layer27_moe_aggregate	[pos="e,3704.1,26032 3704.1,26130 3704.1,26130 3704.1,26042 3704.1,26042"];
	layer27_moe_comm_from_expert7 -> layer27_moe_aggregate	[pos="e,3844,26084 3844,26120 3844,26120 3844,26094 3844,26094"];
	layer27_moe_comm_from_expert8 -> layer27_moe_aggregate	[pos="e,4115.4,26084 4115.4,26120 4115.4,26120 4115.4,26094 4115.4,26094"];
	layer27_moe_comm_from_expert9 -> layer27_moe_aggregate	[pos="e,4191.4,26071 4406.5,26121 4406.5,26098 4406.5,26071 4406.5,26071 4406.5,26071 4201.4,26071 4201.4,26071"];
	layer27_moe_comm_from_expert10 -> layer27_moe_aggregate	[pos="e,4178.1,26058 4738.1,26121 4738.1,26094 4738.1,26058 4738.1,26058 4738.1,26058 4188.1,26058 4188.1,26058"];
	layer27_moe_comm_from_expert11 -> layer27_moe_aggregate	[pos="e,4164.5,26045 5084.6,26121 5084.6,26090 5084.6,26045 5084.6,26045 5084.6,26045 4174.5,26045 4174.5,26045"];
	layer27_moe_comm_from_expert12 -> layer27_moe_aggregate	[pos="e,4151.3,26032 5435.6,26121 5435.6,26086 5435.6,26032 5435.6,26032 5435.6,26032 4161.3,26032 4161.3,26032"];
	layer27_moe_comm_from_expert13 -> layer27_moe_aggregate	[pos="e,4138,26019 5789.1,26121 5789.1,26082 5789.1,26019 5789.1,26019 5789.1,26019 4148,26019 4148,26019"];
	layer27_moe_comm_from_expert14 -> layer27_moe_aggregate	[pos="e,4124.5,26006 6144.1,26121 6144.1,26079 6144.1,26006 6144.1,26006 6144.1,26006 4134.5,26006 4134.5,26006"];
	layer27_moe_comm_from_expert15 -> layer27_moe_aggregate	[pos="e,4111.2,25993 6499.1,26121 6499.1,26076 6499.1,25993 6499.1,25993 6499.1,25993 4121.2,25993 4121.2,25993"];
	layer28_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L28\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3943,25804",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer28_moe_mha -> layer28_moe_gate	[pos="e,3943,25856 3943,25892 3943,25892 3943,25866 3943,25866"];
	layer28_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L28\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3943,25664",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer28_moe_gate -> layer28_moe_split	[pos="e,3943,25717 3943,25752 3943,25752 3943,25727 3943,25727"];
	layer28_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1394,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer28_moe_split -> layer28_moe_comm_to_expert0	[pos="e,1412.5,25576 3777.5,25701 3215,25701 1412.5,25701 1412.5,25701 1412.5,25701 1412.5,25586 1412.5,25586",
		style=dashed];
	layer28_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2107,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer28_moe_split -> layer28_moe_comm_to_expert1	[pos="e,2125.5,25576 3762.5,25686 3303.1,25686 2125.5,25686 2125.5,25686 2125.5,25686 2125.5,25586 2125.5,25586",
		style=dashed];
	layer28_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2563,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer28_moe_split -> layer28_moe_comm_to_expert2	[pos="e,2581.5,25576 3747.2,25671 3370.5,25671 2581.5,25671 2581.5,25671 2581.5,25671 2581.5,25586 2581.5,25586",
		style=dashed];
	layer28_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2891,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer28_moe_split -> layer28_moe_comm_to_expert3	[pos="e,2909.5,25576 3732.3,25656 3430.1,25656 2909.5,25656 2909.5,25656 2909.5,25656 2909.5,25586 2909.5,25586",
		style=dashed];
	layer28_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3154,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer28_moe_split -> layer28_moe_comm_to_expert4	[pos="e,3172.5,25576 3718.3,25642 3490.9,25642 3172.5,25642 3172.5,25642 3172.5,25642 3172.5,25586 3172.5,25586",
		style=dashed];
	layer28_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3385,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer28_moe_split -> layer28_moe_comm_to_expert5	[pos="e,3403.5,25576 3703.2,25627 3559.1,25627 3403.5,25627 3403.5,25627 3403.5,25627 3403.5,25586 3403.5,25586",
		style=dashed];
	layer28_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3600,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer28_moe_split -> layer28_moe_comm_to_expert6	[pos="e,3690.8,25547 3703.5,25664 3703.5,25661 3703.5,25547 3703.5,25547 3703.5,25547 3700.8,25547 3700.8,25547",
		style=dashed];
	layer28_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3807,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer28_moe_split -> layer28_moe_comm_to_expert7	[pos="e,3807,25577 3807,25612 3807,25612 3807,25587 3807,25587",
		style=dashed];
	layer28_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4079,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer28_moe_split -> layer28_moe_comm_to_expert8	[pos="e,4079,25577 4079,25612 4079,25612 4079,25587 4079,25587",
		style=dashed];
	layer28_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4388,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer28_moe_split -> layer28_moe_comm_to_expert9	[pos="e,4297.3,25547 4183.3,25664 4183.3,25661 4183.3,25547 4183.3,25547 4183.3,25547 4287.3,25547 4287.3,25547",
		style=dashed];
	layer28_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4720,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer28_moe_split -> layer28_moe_comm_to_expert10	[pos="e,4644.1,25565 4107.8,25627 4315.1,25627 4644.1,25627 4644.1,25627 4644.1,25627 4644.1,25575 4644.1,25575",
		style=dashed];
	layer28_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5066,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer28_moe_split -> layer28_moe_comm_to_expert11	[pos="e,4990.6,25565 4122.8,25642 4422.2,25642 4990.6,25642 4990.6,25642 4990.6,25642 4990.6,25575 4990.6,25575",
		style=dashed];
	layer28_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5417,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer28_moe_split -> layer28_moe_comm_to_expert12	[pos="e,5341.6,25565 4136.7,25656 4520.7,25656 5341.6,25656 5341.6,25656 5341.6,25656 5341.6,25575 5341.6,25575",
		style=dashed];
	layer28_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5770,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer28_moe_split -> layer28_moe_comm_to_expert13	[pos="e,5695.1,25565 4151.7,25671 4616.3,25671 5695.1,25671 5695.1,25671 5695.1,25671 5695.1,25575 5695.1,25575",
		style=dashed];
	layer28_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6125,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer28_moe_split -> layer28_moe_comm_to_expert14	[pos="e,6050.1,25565 4167,25686 4709.6,25686 6050.1,25686 6050.1,25686 6050.1,25686 6050.1,25575 6050.1,25575",
		style=dashed];
	layer28_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6480,25547",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer28_moe_split -> layer28_moe_comm_to_expert15	[pos="e,6405.1,25565 4181.9,25701 4800.2,25701 6405.1,25701 6405.1,25701 6405.1,25701 6405.1,25575 6405.1,25575",
		style=dashed];
	layer28_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L28\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1348,25456",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer28_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1394,25365",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer28_moe_expert0 -> layer28_moe_comm_from_expert0	[pos="e,1394,25395 1394,25430 1394,25430 1394,25405 1394,25405"];
	layer28_moe_comm_to_expert0 -> layer28_moe_expert0	[pos="e,1394,25483 1394,25518 1394,25518 1394,25493 1394,25493"];
	layer28_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L28\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1694,25456",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer28_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="2107,25365",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer28_moe_expert1 -> layer28_moe_comm_from_expert1	[pos="e,2016.5,25365 1850.3,25430 1850.3,25403 1850.3,25365 1850.3,25365 1850.3,25365 2006.5,25365 2006.5,25365"];
	layer28_moe_comm_to_expert1 -> layer28_moe_expert1	[pos="e,1712.5,25483 2016.5,25547 1900,25547 1712.5,25547 1712.5,25547 1712.5,25547 1712.5,25493 1712.5,25493"];
	layer28_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L28\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2040,25456",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer28_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2563,25365",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer28_moe_expert2 -> layer28_moe_comm_from_expert2	[pos="e,2472.3,25365 2204.2,25447 2211.6,25447 2216,25447 2216,25447 2216,25447 2216,25365 2216,25365 2216,25365 2462.3,25365 2462.3,25365"];
	layer28_moe_comm_to_expert2 -> layer28_moe_expert2	[pos="e,2204.3,25465 2472.1,25547 2367.5,25547 2210,25547 2210,25547 2210,25547 2210,25465 2210,25465 2210,25465 2209.4,25465 2209.4,25465"];
	layer28_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L28\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2386,25456",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer28_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2891,25365",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer28_moe_expert3 -> layer28_moe_comm_from_expert3	[pos="e,2832.3,25388 2511.2,25430 2511.2,25418 2511.2,25406 2511.2,25406 2511.2,25406 2832.3,25406 2832.3,25406 2832.3,25406 2832.3,25398 \
2832.3,25398"];
	layer28_moe_comm_to_expert3 -> layer28_moe_expert3	[pos="e,2511.2,25483 2832.3,25525 2832.3,25515 2832.3,25506 2832.3,25506 2832.3,25506 2511.2,25506 2511.2,25506 2511.2,25506 2511.2,25493 \
2511.2,25493"];
	layer28_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L28\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2732,25456",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer28_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3154,25365",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer28_moe_expert4 -> layer28_moe_comm_from_expert4	[pos="e,3152.7,25394 2864.2,25430 2864.2,25423 2864.2,25418 2864.2,25418 2864.2,25418 3152.7,25418 3152.7,25418 3152.7,25418 3152.7,25404 \
3152.7,25404"];
	layer28_moe_comm_to_expert4 -> layer28_moe_expert4	[pos="e,2864.2,25483 3152.7,25518 3152.7,25506 3152.7,25494 3152.7,25494 3152.7,25494 2864.2,25494 2864.2,25494 2864.2,25494 2864.2,25493 \
2864.2,25493"];
	layer28_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L28\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3078,25456",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer28_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3385,25365",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer28_moe_expert5 -> layer28_moe_comm_from_expert5	[pos="e,3294.2,25365 3242.1,25447 3250.1,25447 3254.8,25447 3254.8,25447 3254.8,25447 3254.8,25365 3254.8,25365 3254.8,25365 3284.2,25365 \
3284.2,25365"];
	layer28_moe_comm_to_expert5 -> layer28_moe_expert5	[pos="e,3242.3,25465 3294.4,25547 3269.7,25547 3249.7,25547 3249.7,25547 3249.7,25547 3249.7,25465 3249.7,25465 3249.7,25465 3248.9,25465 \
3248.9,25465"];
	layer28_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L28\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3424,25456",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer28_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3600,25365",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer28_moe_expert6 -> layer28_moe_comm_from_expert6	[pos="e,3548.7,25390 3548.7,25430 3548.7,25430 3548.7,25400 3548.7,25400"];
	layer28_moe_comm_to_expert6 -> layer28_moe_expert6	[pos="e,3548.7,25483 3548.7,25524 3548.7,25524 3548.7,25493 3548.7,25493"];
	layer28_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L28\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3770,25456",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer28_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3807,25365",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer28_moe_expert7 -> layer28_moe_comm_from_expert7	[pos="e,3807,25395 3807,25430 3807,25430 3807,25405 3807,25405"];
	layer28_moe_comm_to_expert7 -> layer28_moe_expert7	[pos="e,3807,25483 3807,25518 3807,25518 3807,25493 3807,25493"];
	layer28_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L28\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4116,25456",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer28_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4079,25365",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer28_moe_expert8 -> layer28_moe_comm_from_expert8	[pos="e,4079,25395 4079,25430 4079,25430 4079,25405 4079,25405"];
	layer28_moe_comm_to_expert8 -> layer28_moe_expert8	[pos="e,4079,25483 4079,25518 4079,25518 4079,25493 4079,25493"];
	layer28_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L28\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4462,25456",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer28_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4388,25365",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer28_moe_expert9 -> layer28_moe_comm_from_expert9	[pos="e,4388.3,25395 4388.3,25430 4388.3,25430 4388.3,25405 4388.3,25405"];
	layer28_moe_comm_to_expert9 -> layer28_moe_expert9	[pos="e,4388.3,25483 4388.3,25518 4388.3,25518 4388.3,25493 4388.3,25493"];
	layer28_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L28\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4813,25456",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer28_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4720,25365",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer28_moe_expert10 -> layer28_moe_comm_from_expert10	[pos="e,4729.4,25395 4729.4,25430 4729.4,25430 4729.4,25405 4729.4,25405"];
	layer28_moe_comm_to_expert10 -> layer28_moe_expert10	[pos="e,4729,25483 4729,25518 4729,25518 4729,25493 4729,25493"];
	layer28_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L28\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5169,25456",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer28_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5067,25365",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer28_moe_expert11 -> layer28_moe_comm_from_expert11	[pos="e,5080.9,25394 5080.9,25430 5080.9,25430 5080.9,25404 5080.9,25404"];
	layer28_moe_comm_to_expert11 -> layer28_moe_expert11	[pos="e,5080,25483 5080,25519 5080,25519 5080,25493 5080,25493"];
	layer28_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L28\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5525,25456",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer28_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5418,25365",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer28_moe_expert12 -> layer28_moe_comm_from_expert12	[pos="e,5434.4,25394 5434.4,25430 5434.4,25430 5434.4,25404 5434.4,25404"];
	layer28_moe_comm_to_expert12 -> layer28_moe_expert12	[pos="e,5433.5,25483 5433.5,25519 5433.5,25519 5433.5,25493 5433.5,25493"];
	layer28_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L28\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5881,25456",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer28_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5772,25365",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer28_moe_expert13 -> layer28_moe_comm_from_expert13	[pos="e,5789.4,25394 5789.4,25430 5789.4,25430 5789.4,25404 5789.4,25404"];
	layer28_moe_comm_to_expert13 -> layer28_moe_expert13	[pos="e,5788,25483 5788,25519 5788,25519 5788,25493 5788,25493"];
	layer28_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L28\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6237,25456",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer28_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6127,25365",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer28_moe_expert14 -> layer28_moe_comm_from_expert14	[pos="e,6144.9,25394 6144.9,25430 6144.9,25430 6144.9,25404 6144.9,25404"];
	layer28_moe_comm_to_expert14 -> layer28_moe_expert14	[pos="e,6143.5,25483 6143.5,25519 6143.5,25519 6143.5,25493 6143.5,25493"];
	layer28_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L28\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6593,25456",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer28_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6482,25365",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer28_moe_expert15 -> layer28_moe_comm_from_expert15	[pos="e,6500.4,25394 6500.4,25430 6500.4,25430 6500.4,25404 6500.4,25404"];
	layer28_moe_comm_to_expert15 -> layer28_moe_expert15	[pos="e,6499,25483 6499,25519 6499,25519 6499,25493 6499,25493"];
	layer28_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L28\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3906,25248",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer29_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L29\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3906,25134",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer28_moe_aggregate -> layer29_moe_mha	[pos="e,3906,25161 3906,25196 3906,25196 3906,25171 3906,25171"];
	layer28_moe_comm_from_expert0 -> layer28_moe_aggregate	[pos="e,3658.9,25211 1479.8,25356 1479.8,25322 1479.8,25211 1479.8,25211 1479.8,25211 3648.9,25211 3648.9,25211"];
	layer28_moe_comm_from_expert1 -> layer28_moe_aggregate	[pos="e,3674.3,25226 2191.3,25354 2191.3,25322 2191.3,25226 2191.3,25226 2191.3,25226 3664.3,25226 3664.3,25226"];
	layer28_moe_comm_from_expert2 -> layer28_moe_aggregate	[pos="e,3689.7,25241 2600.5,25339 2600.5,25303 2600.5,25241 2600.5,25241 2600.5,25241 3679.7,25241 3679.7,25241"];
	layer28_moe_comm_from_expert3 -> layer28_moe_aggregate	[pos="e,3704.1,25255 2955.5,25345 2955.5,25313 2955.5,25255 2955.5,25255 2955.5,25255 3694.1,25255 3694.1,25255"];
	layer28_moe_comm_from_expert4 -> layer28_moe_aggregate	[pos="e,3719.7,25270 3200.5,25340 3200.5,25312 3200.5,25270 3200.5,25270 3200.5,25270 3709.7,25270 3709.7,25270"];
	layer28_moe_comm_from_expert5 -> layer28_moe_aggregate	[pos="e,3735.2,25285 3422.5,25339 3422.5,25315 3422.5,25285 3422.5,25285 3422.5,25285 3725.2,25285 3725.2,25285"];
	layer28_moe_comm_from_expert6 -> layer28_moe_aggregate	[pos="e,3667.1,25248 3667.1,25346 3667.1,25346 3667.1,25258 3667.1,25258"];
	layer28_moe_comm_from_expert7 -> layer28_moe_aggregate	[pos="e,3807,25300 3807,25336 3807,25336 3807,25310 3807,25310"];
	layer28_moe_comm_from_expert8 -> layer28_moe_aggregate	[pos="e,4078.4,25300 4078.4,25336 4078.4,25336 4078.4,25310 4078.4,25310"];
	layer28_moe_comm_from_expert9 -> layer28_moe_aggregate	[pos="e,4154.4,25287 4369.5,25337 4369.5,25314 4369.5,25287 4369.5,25287 4369.5,25287 4164.4,25287 4164.4,25287"];
	layer28_moe_comm_from_expert10 -> layer28_moe_aggregate	[pos="e,4141.1,25274 4701.1,25337 4701.1,25310 4701.1,25274 4701.1,25274 4701.1,25274 4151.1,25274 4151.1,25274"];
	layer28_moe_comm_from_expert11 -> layer28_moe_aggregate	[pos="e,4127.5,25261 5047.6,25337 5047.6,25306 5047.6,25261 5047.6,25261 5047.6,25261 4137.5,25261 4137.5,25261"];
	layer28_moe_comm_from_expert12 -> layer28_moe_aggregate	[pos="e,4114.3,25248 5398.6,25337 5398.6,25302 5398.6,25248 5398.6,25248 5398.6,25248 4124.3,25248 4124.3,25248"];
	layer28_moe_comm_from_expert13 -> layer28_moe_aggregate	[pos="e,4101,25235 5752.1,25337 5752.1,25298 5752.1,25235 5752.1,25235 5752.1,25235 4111,25235 4111,25235"];
	layer28_moe_comm_from_expert14 -> layer28_moe_aggregate	[pos="e,4087.5,25222 6107.1,25337 6107.1,25295 6107.1,25222 6107.1,25222 6107.1,25222 4097.5,25222 4097.5,25222"];
	layer28_moe_comm_from_expert15 -> layer28_moe_aggregate	[pos="e,4074.2,25209 6462.1,25337 6462.1,25292 6462.1,25209 6462.1,25209 6462.1,25209 4084.2,25209 4084.2,25209"];
	layer29_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L29\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3906,25020",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer29_moe_mha -> layer29_moe_gate	[pos="e,3906,25073 3906,25108 3906,25108 3906,25083 3906,25083"];
	layer29_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L29\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3906,24880",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer29_moe_gate -> layer29_moe_split	[pos="e,3906,24933 3906,24968 3906,24968 3906,24943 3906,24943"];
	layer29_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1752,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer29_moe_split -> layer29_moe_comm_to_expert0	[pos="e,1752,24793 3740.1,24917 3235.3,24917 1752,24917 1752,24917 1752,24917 1752,24803 1752,24803",
		style=dashed];
	layer29_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2038,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer29_moe_split -> layer29_moe_comm_to_expert1	[pos="e,2072.5,24790 3725.2,24902 3262.6,24902 2072.5,24902 2072.5,24902 2072.5,24902 2072.5,24800 2072.5,24800",
		style=dashed];
	layer29_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2457,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer29_moe_split -> layer29_moe_comm_to_expert2	[pos="e,2510,24787 3710.4,24887 3326.2,24887 2510,24887 2510,24887 2510,24887 2510,24797 2510,24797",
		style=dashed];
	layer29_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2766,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer29_moe_split -> layer29_moe_comm_to_expert3	[pos="e,2828.5,24785 3696.3,24873 3382.9,24873 2828.5,24873 2828.5,24873 2828.5,24873 2828.5,24795 2828.5,24795",
		style=dashed];
	layer29_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3020,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer29_moe_split -> layer29_moe_comm_to_expert4	[pos="e,3087,24783 3681.4,24858 3438.9,24858 3087,24858 3087,24858 3087,24858 3087,24793 3087,24793",
		style=dashed];
	layer29_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3247,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer29_moe_split -> layer29_moe_comm_to_expert5	[pos="e,3316,24782 3666.4,24843 3503,24843 3316,24843 3316,24843 3316,24843 3316,24792 3316,24792",
		style=dashed];
	layer29_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3460,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer29_moe_split -> layer29_moe_comm_to_expert6	[pos="e,3550.5,24763 3665.7,24880 3665.7,24877 3665.7,24763 3665.7,24763 3665.7,24763 3560.5,24763 3560.5,24763",
		style=dashed];
	layer29_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3770,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer29_moe_split -> layer29_moe_comm_to_expert7	[pos="e,3770,24793 3770,24828 3770,24828 3770,24803 3770,24803",
		style=dashed];
	layer29_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4042,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer29_moe_split -> layer29_moe_comm_to_expert8	[pos="e,4042,24793 4042,24828 4042,24828 4042,24803 4042,24803",
		style=dashed];
	layer29_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4351,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer29_moe_split -> layer29_moe_comm_to_expert9	[pos="e,4260.3,24763 4146.3,24880 4146.3,24877 4146.3,24763 4146.3,24763 4146.3,24763 4250.3,24763 4250.3,24763",
		style=dashed];
	layer29_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4683,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer29_moe_split -> layer29_moe_comm_to_expert10	[pos="e,4607.1,24781 4070.8,24843 4278.1,24843 4607.1,24843 4607.1,24843 4607.1,24843 4607.1,24791 4607.1,24791",
		style=dashed];
	layer29_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="5029,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer29_moe_split -> layer29_moe_comm_to_expert11	[pos="e,4953.6,24781 4085.8,24858 4385.2,24858 4953.6,24858 4953.6,24858 4953.6,24858 4953.6,24791 4953.6,24791",
		style=dashed];
	layer29_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5380,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer29_moe_split -> layer29_moe_comm_to_expert12	[pos="e,5304.6,24781 4100.8,24873 4485.3,24873 5304.6,24873 5304.6,24873 5304.6,24873 5304.6,24791 5304.6,24791",
		style=dashed];
	layer29_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5733,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer29_moe_split -> layer29_moe_comm_to_expert13	[pos="e,5658.1,24781 4114.7,24887 4579.3,24887 5658.1,24887 5658.1,24887 5658.1,24887 5658.1,24791 5658.1,24791",
		style=dashed];
	layer29_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6088,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer29_moe_split -> layer29_moe_comm_to_expert14	[pos="e,6013.1,24781 4130,24902 4672.6,24902 6013.1,24902 6013.1,24902 6013.1,24902 6013.1,24791 6013.1,24791",
		style=dashed];
	layer29_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6443,24763",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer29_moe_split -> layer29_moe_comm_to_expert15	[pos="e,6368.1,24781 4144.6,24917 4762.7,24917 6368.1,24917 6368.1,24917 6368.1,24917 6368.1,24791 6368.1,24791",
		style=dashed];
	layer29_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L29\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1311,24672",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer29_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1470,24581",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer29_moe_expert0 -> layer29_moe_comm_from_expert0	[pos="e,1427.2,24607 1427.2,24646 1427.2,24646 1427.2,24617 1427.2,24617"];
	layer29_moe_comm_to_expert0 -> layer29_moe_expert0	[pos="e,1389.2,24699 1661.4,24763 1554,24763 1389.2,24763 1389.2,24763 1389.2,24763 1389.2,24709 1389.2,24709"];
	layer29_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L29\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1657,24672",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer29_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1742,24581",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer29_moe_expert1 -> layer29_moe_comm_from_expert1	[pos="e,1736.2,24611 1736.2,24646 1736.2,24646 1736.2,24621 1736.2,24621"];
	layer29_moe_comm_to_expert1 -> layer29_moe_expert1	[pos="e,1741.2,24699 2038,24734 2038,24722 2038,24710 2038,24710 2038,24710 1741.2,24710 1741.2,24710 1741.2,24710 1741.2,24709 1741.2,\
24709"];
	layer29_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L29\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="2003,24672",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer29_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2063,24581",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer29_moe_expert2 -> layer29_moe_comm_from_expert2	[pos="e,2063,24611 2063,24646 2063,24646 2063,24621 2063,24621"];
	layer29_moe_comm_to_expert2 -> layer29_moe_expert2	[pos="e,2147.8,24699 2366.3,24763 2275.1,24763 2147.8,24763 2147.8,24763 2147.8,24763 2147.8,24709 2147.8,24709"];
	layer29_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L29\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2349,24672",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer29_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2629,24581",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer29_moe_expert3 -> layer29_moe_comm_from_expert3	[pos="e,2538.3,24581 2455.7,24646 2455.7,24619 2455.7,24581 2455.7,24581 2455.7,24581 2528.3,24581 2528.3,24581"];
	layer29_moe_comm_to_expert3 -> layer29_moe_expert3	[pos="e,2439.7,24699 2766,24734 2766,24727 2766,24722 2766,24722 2766,24722 2439.7,24722 2439.7,24722 2439.7,24722 2439.7,24709 2439.7,\
24709"];
	layer29_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L29\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2695,24672",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer29_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3012,24581",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer29_moe_expert4 -> layer29_moe_comm_from_expert4	[pos="e,2921.2,24581 2792.7,24646 2792.7,24619 2792.7,24581 2792.7,24581 2792.7,24581 2911.2,24581 2911.2,24581"];
	layer29_moe_comm_to_expert4 -> layer29_moe_expert4	[pos="e,2859.2,24672 2929.4,24763 2896.8,24763 2868,24763 2868,24763 2868,24763 2868,24672 2868,24672 2868,24672 2867.1,24672 2867.1,24672"];
	layer29_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L29\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3041,24672",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer29_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3303,24581",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer29_moe_expert5 -> layer29_moe_comm_from_expert5	[pos="e,3217.7,24591 3205,24672 3213,24672 3217.7,24672 3217.7,24672 3217.7,24672 3217.7,24601 3217.7,24601"];
	layer29_moe_comm_to_expert5 -> layer29_moe_expert5	[pos="e,3180.7,24698 3180.7,24743 3180.7,24743 3180.7,24708 3180.7,24708"];
	layer29_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L29\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3387,24672",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer29_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3548,24581",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer29_moe_expert6 -> layer29_moe_comm_from_expert6	[pos="e,3504.2,24607 3504.2,24646 3504.2,24646 3504.2,24617 3504.2,24617"];
	layer29_moe_comm_to_expert6 -> layer29_moe_expert6	[pos="e,3460,24699 3460,24734 3460,24734 3460,24709 3460,24709"];
	layer29_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L29\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3733,24672",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer29_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3770,24581",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer29_moe_expert7 -> layer29_moe_comm_from_expert7	[pos="e,3770,24611 3770,24646 3770,24646 3770,24621 3770,24621"];
	layer29_moe_comm_to_expert7 -> layer29_moe_expert7	[pos="e,3770,24699 3770,24734 3770,24734 3770,24709 3770,24709"];
	layer29_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L29\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4079,24672",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer29_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4042,24581",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer29_moe_expert8 -> layer29_moe_comm_from_expert8	[pos="e,4042,24611 4042,24646 4042,24646 4042,24621 4042,24621"];
	layer29_moe_comm_to_expert8 -> layer29_moe_expert8	[pos="e,4042,24699 4042,24734 4042,24734 4042,24709 4042,24709"];
	layer29_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L29\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4425,24672",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer29_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4351,24581",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer29_moe_expert9 -> layer29_moe_comm_from_expert9	[pos="e,4351.3,24611 4351.3,24646 4351.3,24646 4351.3,24621 4351.3,24621"];
	layer29_moe_comm_to_expert9 -> layer29_moe_expert9	[pos="e,4351.3,24699 4351.3,24734 4351.3,24734 4351.3,24709 4351.3,24709"];
	layer29_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L29\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4776,24672",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer29_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4683,24581",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer29_moe_expert10 -> layer29_moe_comm_from_expert10	[pos="e,4692.4,24611 4692.4,24646 4692.4,24646 4692.4,24621 4692.4,24621"];
	layer29_moe_comm_to_expert10 -> layer29_moe_expert10	[pos="e,4692,24699 4692,24734 4692,24734 4692,24709 4692,24709"];
	layer29_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L29\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5132,24672",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer29_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="5030,24581",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer29_moe_expert11 -> layer29_moe_comm_from_expert11	[pos="e,5043.9,24610 5043.9,24646 5043.9,24646 5043.9,24620 5043.9,24620"];
	layer29_moe_comm_to_expert11 -> layer29_moe_expert11	[pos="e,5043,24699 5043,24735 5043,24735 5043,24709 5043,24709"];
	layer29_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L29\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5488,24672",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer29_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5381,24581",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer29_moe_expert12 -> layer29_moe_comm_from_expert12	[pos="e,5397.4,24610 5397.4,24646 5397.4,24646 5397.4,24620 5397.4,24620"];
	layer29_moe_comm_to_expert12 -> layer29_moe_expert12	[pos="e,5396.5,24699 5396.5,24735 5396.5,24735 5396.5,24709 5396.5,24709"];
	layer29_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L29\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5844,24672",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer29_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5735,24581",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer29_moe_expert13 -> layer29_moe_comm_from_expert13	[pos="e,5752.4,24610 5752.4,24646 5752.4,24646 5752.4,24620 5752.4,24620"];
	layer29_moe_comm_to_expert13 -> layer29_moe_expert13	[pos="e,5751,24699 5751,24735 5751,24735 5751,24709 5751,24709"];
	layer29_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L29\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6200,24672",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer29_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6090,24581",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer29_moe_expert14 -> layer29_moe_comm_from_expert14	[pos="e,6107.9,24610 6107.9,24646 6107.9,24646 6107.9,24620 6107.9,24620"];
	layer29_moe_comm_to_expert14 -> layer29_moe_expert14	[pos="e,6106.5,24699 6106.5,24735 6106.5,24735 6106.5,24709 6106.5,24709"];
	layer29_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L29\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6556,24672",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer29_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6445,24581",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer29_moe_expert15 -> layer29_moe_comm_from_expert15	[pos="e,6463.4,24610 6463.4,24646 6463.4,24646 6463.4,24620 6463.4,24620"];
	layer29_moe_comm_to_expert15 -> layer29_moe_expert15	[pos="e,6462,24699 6462,24735 6462,24735 6462,24709 6462,24709"];
	layer29_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L29\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3869,24464",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer30_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L30\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3869,24350",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer29_moe_aggregate -> layer30_moe_mha	[pos="e,3869,24377 3869,24412 3869,24412 3869,24387 3869,24387"];
	layer29_moe_comm_from_expert0 -> layer29_moe_aggregate	[pos="e,3621.7,24427 1508.3,24555 1508.3,24511 1508.3,24427 1508.3,24427 1508.3,24427 3611.7,24427 3611.7,24427"];
	layer29_moe_comm_from_expert1 -> layer29_moe_aggregate	[pos="e,3637.1,24442 1817.3,24565 1817.3,24528 1817.3,24442 1817.3,24442 1817.3,24442 3627.1,24442 3627.1,24442"];
	layer29_moe_comm_from_expert2 -> layer29_moe_aggregate	[pos="e,3652.6,24457 2136,24564 2136,24530 2136,24457 2136,24457 2136,24457 3642.6,24457 3642.6,24457"];
	layer29_moe_comm_from_expert3 -> layer29_moe_aggregate	[pos="e,3666.9,24471 2649.5,24553 2649.5,24520 2649.5,24471 2649.5,24471 2649.5,24471 3656.9,24471 3656.9,24471"];
	layer29_moe_comm_from_expert4 -> layer29_moe_aggregate	[pos="e,3682.5,24486 3046,24554 3046,24526 3046,24486 3046,24486 3046,24486 3672.5,24486 3672.5,24486"];
	layer29_moe_comm_from_expert5 -> layer29_moe_aggregate	[pos="e,3698.1,24501 3307,24552 3307,24529 3307,24501 3307,24501 3307,24501 3688.1,24501 3688.1,24501"];
	layer29_moe_comm_from_expert6 -> layer29_moe_aggregate	[pos="e,3622.6,24465 3622.6,24565 3622.6,24565 3622.6,24475 3622.6,24475"];
	layer29_moe_comm_from_expert7 -> layer29_moe_aggregate	[pos="e,3770,24517 3770,24552 3770,24552 3770,24527 3770,24527"];
	layer29_moe_comm_from_expert8 -> layer29_moe_aggregate	[pos="e,4041.4,24517 4041.4,24552 4041.4,24552 4041.4,24527 4041.4,24527"];
	layer29_moe_comm_from_expert9 -> layer29_moe_aggregate	[pos="e,4117.4,24503 4332.5,24553 4332.5,24530 4332.5,24503 4332.5,24503 4332.5,24503 4127.4,24503 4127.4,24503"];
	layer29_moe_comm_from_expert10 -> layer29_moe_aggregate	[pos="e,4103.8,24490 4664.1,24553 4664.1,24526 4664.1,24490 4664.1,24490 4664.1,24490 4113.8,24490 4113.8,24490"];
	layer29_moe_comm_from_expert11 -> layer29_moe_aggregate	[pos="e,4090.5,24477 5010.6,24553 5010.6,24522 5010.6,24477 5010.6,24477 5010.6,24477 4100.5,24477 4100.5,24477"];
	layer29_moe_comm_from_expert12 -> layer29_moe_aggregate	[pos="e,4077.3,24464 5361.6,24553 5361.6,24518 5361.6,24464 5361.6,24464 5361.6,24464 4087.3,24464 4087.3,24464"];
	layer29_moe_comm_from_expert13 -> layer29_moe_aggregate	[pos="e,4064,24451 5715.1,24553 5715.1,24514 5715.1,24451 5715.1,24451 5715.1,24451 4074,24451 4074,24451"];
	layer29_moe_comm_from_expert14 -> layer29_moe_aggregate	[pos="e,4050.5,24438 6070.1,24553 6070.1,24511 6070.1,24438 6070.1,24438 6070.1,24438 4060.5,24438 4060.5,24438"];
	layer29_moe_comm_from_expert15 -> layer29_moe_aggregate	[pos="e,4037.2,24425 6425.1,24553 6425.1,24508 6425.1,24425 6425.1,24425 6425.1,24425 4047.2,24425 4047.2,24425"];
	layer30_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L30\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3869,24236",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer30_moe_mha -> layer30_moe_gate	[pos="e,3869,24289 3869,24324 3869,24324 3869,24299 3869,24299"];
	layer30_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L30\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3869,24096",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer30_moe_gate -> layer30_moe_split	[pos="e,3869,24149 3869,24184 3869,24184 3869,24159 3869,24159"];
	layer30_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1320,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer30_moe_split -> layer30_moe_comm_to_expert0	[pos="e,1395,23996 3703.3,24133 3149.1,24133 1395,24133 1395,24133 1395,24133 1395,24006 1395,24006",
		style=dashed];
	layer30_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="2033,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer30_moe_split -> layer30_moe_comm_to_expert1	[pos="e,2048,24008 3688.2,24118 3227.9,24118 2048,24118 2048,24118 2048,24118 2048,24018 2048,24018",
		style=dashed];
	layer30_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2489,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer30_moe_split -> layer30_moe_comm_to_expert2	[pos="e,2559,23998 3673.2,24103 3307.9,24103 2559,24103 2559,24103 2559,24103 2559,24008 2559,24008",
		style=dashed];
	layer30_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2817,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer30_moe_split -> layer30_moe_comm_to_expert3	[pos="e,2892.3,23996 3659.5,24089 3372.5,24089 2892.3,24089 2892.3,24089 2892.3,24089 2892.3,24006 2892.3,24006",
		style=dashed];
	layer30_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="3080,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer30_moe_split -> layer30_moe_comm_to_expert4	[pos="e,3136.5,24002 3644.3,24074 3428.9,24074 3136.5,24074 3136.5,24074 3136.5,24074 3136.5,24012 3136.5,24012",
		style=dashed];
	layer30_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3311,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer30_moe_split -> layer30_moe_comm_to_expert5	[pos="e,3397.5,23988 3629.5,24059 3512.9,24059 3397.5,24059 3397.5,24059 3397.5,24059 3397.5,23998 3397.5,23998",
		style=dashed];
	layer30_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3526,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer30_moe_split -> layer30_moe_comm_to_expert6	[pos="e,3616.8,23979 3629.5,24096 3629.5,24093 3629.5,23979 3629.5,23979 3629.5,23979 3626.8,23979 3626.8,23979",
		style=dashed];
	layer30_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3733,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer30_moe_split -> layer30_moe_comm_to_expert7	[pos="e,3733,24009 3733,24044 3733,24044 3733,24019 3733,24019",
		style=dashed];
	layer30_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="4005,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer30_moe_split -> layer30_moe_comm_to_expert8	[pos="e,4005,24009 4005,24044 4005,24044 4005,24019 4005,24019",
		style=dashed];
	layer30_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4314,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer30_moe_split -> layer30_moe_comm_to_expert9	[pos="e,4223.3,23979 4109.3,24096 4109.3,24093 4109.3,23979 4109.3,23979 4109.3,23979 4213.3,23979 4213.3,23979",
		style=dashed];
	layer30_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4646,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer30_moe_split -> layer30_moe_comm_to_expert10	[pos="e,4570.1,23997 4033.8,24059 4241.1,24059 4570.1,24059 4570.1,24059 4570.1,24059 4570.1,24007 4570.1,24007",
		style=dashed];
	layer30_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4992,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer30_moe_split -> layer30_moe_comm_to_expert11	[pos="e,4916.6,23997 4048.8,24074 4348.2,24074 4916.6,24074 4916.6,24074 4916.6,24074 4916.6,24007 4916.6,24007",
		style=dashed];
	layer30_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5343,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer30_moe_split -> layer30_moe_comm_to_expert12	[pos="e,5267.6,23997 4063.8,24089 4448.3,24089 5267.6,24089 5267.6,24089 5267.6,24089 5267.6,24007 5267.6,24007",
		style=dashed];
	layer30_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5696,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer30_moe_split -> layer30_moe_comm_to_expert13	[pos="e,5621.1,23997 4077.7,24103 4542.3,24103 5621.1,24103 5621.1,24103 5621.1,24103 5621.1,24007 5621.1,24007",
		style=dashed];
	layer30_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6051,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer30_moe_split -> layer30_moe_comm_to_expert14	[pos="e,5976.1,23997 4093,24118 4635.6,24118 5976.1,24118 5976.1,24118 5976.1,24118 5976.1,24007 5976.1,24007",
		style=dashed];
	layer30_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6406,23979",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer30_moe_split -> layer30_moe_comm_to_expert15	[pos="e,6331.1,23997 4107.6,24133 4725.7,24133 6331.1,24133 6331.1,24133 6331.1,24133 6331.1,24007 6331.1,24007",
		style=dashed];
	layer30_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L30\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1274,23888",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer30_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1431,23797",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer30_moe_expert0 -> layer30_moe_comm_from_expert0	[pos="e,1389.2,23823 1389.2,23862 1389.2,23862 1389.2,23833 1389.2,23833"];
	layer30_moe_comm_to_expert0 -> layer30_moe_expert0	[pos="e,1320,23915 1320,23950 1320,23950 1320,23925 1320,23925"];
	layer30_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L30\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1620,23888",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer30_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1850,23797",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer30_moe_expert1 -> layer30_moe_comm_from_expert1	[pos="e,1771.7,23812 1771.7,23862 1771.7,23862 1771.7,23822 1771.7,23822"];
	layer30_moe_comm_to_expert1 -> layer30_moe_expert1	[pos="e,1717.7,23915 1942.2,23979 1849.1,23979 1717.7,23979 1717.7,23979 1717.7,23979 1717.7,23925 1717.7,23925"];
	layer30_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L30\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1966,23888",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer30_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2159,23797",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer30_moe_expert2 -> layer30_moe_comm_from_expert2	[pos="e,2099.2,23819 2099.2,23862 2099.2,23862 2099.2,23829 2099.2,23829"];
	layer30_moe_comm_to_expert2 -> layer30_moe_expert2	[pos="e,2130.2,23888 2398.3,23979 2295.5,23979 2142,23979 2142,23979 2142,23979 2142,23888 2142,23888 2142,23888 2140.2,23888 2140.2,23888"];
	layer30_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L30\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2312,23888",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer30_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2413,23797",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer30_moe_expert3 -> layer30_moe_comm_from_expert3	[pos="e,2399.2,23826 2399.2,23862 2399.2,23862 2399.2,23836 2399.2,23836"];
	layer30_moe_comm_to_expert3 -> layer30_moe_expert3	[pos="e,2437.2,23915 2758.3,23957 2758.3,23947 2758.3,23938 2758.3,23938 2758.3,23938 2437.2,23938 2437.2,23938 2437.2,23938 2437.2,23925 \
2437.2,23925"];
	layer30_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L30\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2658,23888",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer30_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2751,23797",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer30_moe_expert4 -> layer30_moe_comm_from_expert4	[pos="e,2741.2,23827 2741.2,23862 2741.2,23862 2741.2,23837 2741.2,23837"];
	layer30_moe_comm_to_expert4 -> layer30_moe_expert4	[pos="e,2790.2,23915 3078.7,23950 3078.7,23938 3078.7,23926 3078.7,23926 3078.7,23926 2790.2,23926 2790.2,23926 2790.2,23926 2790.2,23925 \
2790.2,23925"];
	layer30_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L30\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="3004,23888",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer30_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3170,23797",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer30_moe_expert5 -> layer30_moe_comm_from_expert5	[pos="e,3123.7,23823 3123.7,23862 3123.7,23862 3123.7,23833 3123.7,23833"];
	layer30_moe_comm_to_expert5 -> layer30_moe_expert5	[pos="e,3168.1,23888 3220.3,23979 3196.9,23979 3178.3,23979 3178.3,23979 3178.3,23979 3178.3,23888 3178.3,23888 3178.3,23888 3177.2,23888 \
3177.2,23888"];
	layer30_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L30\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3350,23888",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer30_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3479,23797",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer30_moe_expert6 -> layer30_moe_comm_from_expert6	[pos="e,3451.2,23825 3451.2,23862 3451.2,23862 3451.2,23835 3451.2,23835"];
	layer30_moe_comm_to_expert6 -> layer30_moe_expert6	[pos="e,3474.7,23915 3474.7,23956 3474.7,23956 3474.7,23925 3474.7,23925"];
	layer30_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L30\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3696,23888",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer30_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3733,23797",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer30_moe_expert7 -> layer30_moe_comm_from_expert7	[pos="e,3733,23827 3733,23862 3733,23862 3733,23837 3733,23837"];
	layer30_moe_comm_to_expert7 -> layer30_moe_expert7	[pos="e,3733,23915 3733,23950 3733,23950 3733,23925 3733,23925"];
	layer30_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L30\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4042,23888",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer30_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="4005,23797",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer30_moe_expert8 -> layer30_moe_comm_from_expert8	[pos="e,4005,23827 4005,23862 4005,23862 4005,23837 4005,23837"];
	layer30_moe_comm_to_expert8 -> layer30_moe_expert8	[pos="e,4005,23915 4005,23950 4005,23950 4005,23925 4005,23925"];
	layer30_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L30\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4388,23888",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer30_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4314,23797",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer30_moe_expert9 -> layer30_moe_comm_from_expert9	[pos="e,4314.3,23827 4314.3,23862 4314.3,23862 4314.3,23837 4314.3,23837"];
	layer30_moe_comm_to_expert9 -> layer30_moe_expert9	[pos="e,4314.3,23915 4314.3,23950 4314.3,23950 4314.3,23925 4314.3,23925"];
	layer30_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L30\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4739,23888",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer30_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4646,23797",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer30_moe_expert10 -> layer30_moe_comm_from_expert10	[pos="e,4655.4,23827 4655.4,23862 4655.4,23862 4655.4,23837 4655.4,23837"];
	layer30_moe_comm_to_expert10 -> layer30_moe_expert10	[pos="e,4655,23915 4655,23950 4655,23950 4655,23925 4655,23925"];
	layer30_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L30\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5095,23888",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer30_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4993,23797",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer30_moe_expert11 -> layer30_moe_comm_from_expert11	[pos="e,5006.9,23826 5006.9,23862 5006.9,23862 5006.9,23836 5006.9,23836"];
	layer30_moe_comm_to_expert11 -> layer30_moe_expert11	[pos="e,5006,23915 5006,23951 5006,23951 5006,23925 5006,23925"];
	layer30_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L30\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5451,23888",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer30_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5344,23797",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer30_moe_expert12 -> layer30_moe_comm_from_expert12	[pos="e,5360.4,23826 5360.4,23862 5360.4,23862 5360.4,23836 5360.4,23836"];
	layer30_moe_comm_to_expert12 -> layer30_moe_expert12	[pos="e,5359.5,23915 5359.5,23951 5359.5,23951 5359.5,23925 5359.5,23925"];
	layer30_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L30\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5807,23888",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer30_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5698,23797",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer30_moe_expert13 -> layer30_moe_comm_from_expert13	[pos="e,5715.4,23826 5715.4,23862 5715.4,23862 5715.4,23836 5715.4,23836"];
	layer30_moe_comm_to_expert13 -> layer30_moe_expert13	[pos="e,5714,23915 5714,23951 5714,23951 5714,23925 5714,23925"];
	layer30_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L30\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6163,23888",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer30_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6053,23797",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer30_moe_expert14 -> layer30_moe_comm_from_expert14	[pos="e,6070.9,23826 6070.9,23862 6070.9,23862 6070.9,23836 6070.9,23836"];
	layer30_moe_comm_to_expert14 -> layer30_moe_expert14	[pos="e,6069.5,23915 6069.5,23951 6069.5,23951 6069.5,23925 6069.5,23925"];
	layer30_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L30\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6519,23888",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer30_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6408,23797",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer30_moe_expert15 -> layer30_moe_comm_from_expert15	[pos="e,6426.4,23826 6426.4,23862 6426.4,23862 6426.4,23836 6426.4,23836"];
	layer30_moe_comm_to_expert15 -> layer30_moe_expert15	[pos="e,6425,23915 6425,23951 6425,23951 6425,23925 6425,23925"];
	layer30_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L30\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3832,23681",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer31_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L31\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3832,23567",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer30_moe_aggregate -> layer31_moe_mha	[pos="e,3832,23593 3832,23628 3832,23628 3832,23603 3832,23603"];
	layer30_moe_comm_from_expert0 -> layer30_moe_aggregate	[pos="e,3584.8,23643 1470.3,23771 1470.3,23727 1470.3,23643 1470.3,23643 1470.3,23643 3574.8,23643 3574.8,23643"];
	layer30_moe_comm_from_expert1 -> layer30_moe_aggregate	[pos="e,3600.3,23658 1907,23775 1907,23735 1907,23658 1907,23658 1907,23658 3590.3,23658 3590.3,23658"];
	layer30_moe_comm_from_expert2 -> layer30_moe_aggregate	[pos="e,3615.6,23673 2180.3,23769 2180.3,23733 2180.3,23673 2180.3,23673 2180.3,23673 3605.6,23673 3605.6,23673"];
	layer30_moe_comm_from_expert3 -> layer30_moe_aggregate	[pos="e,3630.1,23687 2488.5,23781 2488.5,23750 2488.5,23687 2488.5,23687 2488.5,23687 3620.1,23687 3620.1,23687"];
	layer30_moe_comm_from_expert4 -> layer30_moe_aggregate	[pos="e,3645.6,23702 2822.3,23780 2822.3,23752 2822.3,23702 2822.3,23702 2822.3,23702 3635.6,23702 3635.6,23702"];
	layer30_moe_comm_from_expert5 -> layer30_moe_aggregate	[pos="e,3661,23717 3141.8,23770 3141.8,23747 3141.8,23717 3141.8,23717 3141.8,23717 3651,23717 3651,23717"];
	layer30_moe_comm_from_expert6 -> layer30_moe_aggregate	[pos="e,3606.1,23681 3569.7,23797 3590.2,23797 3606.1,23797 3606.1,23797 3606.1,23797 3606.1,23691 3606.1,23691"];
	layer30_moe_comm_from_expert7 -> layer30_moe_aggregate	[pos="e,3733,23733 3733,23768 3733,23768 3733,23743 3733,23743"];
	layer30_moe_comm_from_expert8 -> layer30_moe_aggregate	[pos="e,4004.4,23733 4004.4,23768 4004.4,23768 4004.4,23743 4004.4,23743"];
	layer30_moe_comm_from_expert9 -> layer30_moe_aggregate	[pos="e,4080.4,23719 4295.5,23769 4295.5,23746 4295.5,23719 4295.5,23719 4295.5,23719 4090.4,23719 4090.4,23719"];
	layer30_moe_comm_from_expert10 -> layer30_moe_aggregate	[pos="e,4066.8,23706 4627.1,23769 4627.1,23742 4627.1,23706 4627.1,23706 4627.1,23706 4076.8,23706 4076.8,23706"];
	layer30_moe_comm_from_expert11 -> layer30_moe_aggregate	[pos="e,4053.5,23693 4973.6,23769 4973.6,23738 4973.6,23693 4973.6,23693 4973.6,23693 4063.5,23693 4063.5,23693"];
	layer30_moe_comm_from_expert12 -> layer30_moe_aggregate	[pos="e,4040.3,23680 5324.6,23769 5324.6,23734 5324.6,23680 5324.6,23680 5324.6,23680 4050.3,23680 4050.3,23680"];
	layer30_moe_comm_from_expert13 -> layer30_moe_aggregate	[pos="e,4027,23667 5678.1,23769 5678.1,23730 5678.1,23667 5678.1,23667 5678.1,23667 4037,23667 4037,23667"];
	layer30_moe_comm_from_expert14 -> layer30_moe_aggregate	[pos="e,4013.5,23654 6033.1,23769 6033.1,23727 6033.1,23654 6033.1,23654 6033.1,23654 4023.5,23654 4023.5,23654"];
	layer30_moe_comm_from_expert15 -> layer30_moe_aggregate	[pos="e,4000.2,23641 6388.1,23769 6388.1,23724 6388.1,23641 6388.1,23641 6388.1,23641 4010.2,23641 4010.2,23641"];
	layer31_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L31\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3832,23453",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer31_moe_mha -> layer31_moe_gate	[pos="e,3832,23505 3832,23540 3832,23540 3832,23515 3832,23515"];
	layer31_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L31\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3832,23313",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer31_moe_gate -> layer31_moe_split	[pos="e,3832,23365 3832,23400 3832,23400 3832,23375 3832,23375"];
	layer31_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1678,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer31_moe_split -> layer31_moe_comm_to_expert0	[pos="e,1764,23205 3666.3,23349 3175.5,23349 1764,23349 1764,23349 1764,23349 1764,23215 1764,23215",
		style=dashed];
	layer31_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1964,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer31_moe_split -> layer31_moe_comm_to_expert1	[pos="e,1997.5,23223 3651.1,23334 3188.3,23334 1997.5,23334 1997.5,23334 1997.5,23334 1997.5,23233 1997.5,23233",
		style=dashed];
	layer31_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2383,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer31_moe_split -> layer31_moe_comm_to_expert2	[pos="e,2398,23224 3636.4,23319 3244,23319 2398,23319 2398,23319 2398,23319 2398,23234 2398,23234",
		style=dashed];
	layer31_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2692,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer31_moe_split -> layer31_moe_comm_to_expert3	[pos="e,2721.5,23223 3622.1,23305 3300.3,23305 2721.5,23305 2721.5,23305 2721.5,23305 2721.5,23233 2721.5,23233",
		style=dashed];
	layer31_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2946,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer31_moe_split -> layer31_moe_comm_to_expert4	[pos="e,2946,23225 3607.3,23290 3344.8,23290 2946,23290 2946,23290 2946,23290 2946,23235 2946,23235",
		style=dashed];
	layer31_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3173,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer31_moe_split -> layer31_moe_comm_to_expert5	[pos="e,3201.2,23223 3592.2,23275 3413.8,23275 3201.2,23275 3201.2,23275 3201.2,23275 3201.2,23233 3201.2,23233",
		style=dashed];
	layer31_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3386,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer31_moe_split -> layer31_moe_comm_to_expert6	[pos="e,3476.5,23195 3591.7,23312 3591.7,23309 3591.7,23195 3591.7,23195 3591.7,23195 3486.5,23195 3486.5,23195",
		style=dashed];
	layer31_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3696,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer31_moe_split -> layer31_moe_comm_to_expert7	[pos="e,3696,23225 3696,23260 3696,23260 3696,23235 3696,23235",
		style=dashed];
	layer31_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3968,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer31_moe_split -> layer31_moe_comm_to_expert8	[pos="e,3968,23225 3968,23260 3968,23260 3968,23235 3968,23235",
		style=dashed];
	layer31_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4277,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer31_moe_split -> layer31_moe_comm_to_expert9	[pos="e,4186.3,23195 4072.3,23312 4072.3,23309 4072.3,23195 4072.3,23195 4072.3,23195 4176.3,23195 4176.3,23195",
		style=dashed];
	layer31_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4609,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer31_moe_split -> layer31_moe_comm_to_expert10	[pos="e,4533.1,23213 3996.8,23275 4204.1,23275 4533.1,23275 4533.1,23275 4533.1,23275 4533.1,23223 4533.1,23223",
		style=dashed];
	layer31_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4955,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer31_moe_split -> layer31_moe_comm_to_expert11	[pos="e,4879.6,23213 4011.8,23290 4311.2,23290 4879.6,23290 4879.6,23290 4879.6,23290 4879.6,23223 4879.6,23223",
		style=dashed];
	layer31_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5306,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer31_moe_split -> layer31_moe_comm_to_expert12	[pos="e,5230.6,23213 4026.8,23305 4411.3,23305 5230.6,23305 5230.6,23305 5230.6,23305 5230.6,23223 5230.6,23223",
		style=dashed];
	layer31_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5659,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer31_moe_split -> layer31_moe_comm_to_expert13	[pos="e,5584.1,23213 4040.7,23319 4505.3,23319 5584.1,23319 5584.1,23319 5584.1,23319 5584.1,23223 5584.1,23223",
		style=dashed];
	layer31_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="6014,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer31_moe_split -> layer31_moe_comm_to_expert14	[pos="e,5939.1,23213 4056,23334 4598.6,23334 5939.1,23334 5939.1,23334 5939.1,23334 5939.1,23223 5939.1,23223",
		style=dashed];
	layer31_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6369,23196",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer31_moe_split -> layer31_moe_comm_to_expert15	[pos="e,6294.1,23213 4070.6,23349 4688.7,23349 6294.1,23349 6294.1,23349 6294.1,23349 6294.1,23223 6294.1,23223",
		style=dashed];
	layer31_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L31\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1237,23105",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer31_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1324,23014",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer31_moe_expert0 -> layer31_moe_comm_from_expert0	[pos="e,1317.2,23043 1317.2,23078 1317.2,23078 1317.2,23053 1317.2,23053"];
	layer31_moe_comm_to_expert0 -> layer31_moe_expert0	[pos="e,1370.7,23131 1587.5,23195 1496.8,23195 1370.7,23195 1370.7,23195 1370.7,23195 1370.7,23141 1370.7,23141"];
	layer31_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L31\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1583,23105",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer31_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1964,23014",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer31_moe_expert1 -> layer31_moe_comm_from_expert1	[pos="e,1873.5,23013 1716.2,23078 1716.2,23051 1716.2,23013 1716.2,23013 1716.2,23013 1863.5,23013 1863.5,23013"];
	layer31_moe_comm_to_expert1 -> layer31_moe_expert1	[pos="e,1667.2,23131 1964,23166 1964,23154 1964,23142 1964,23142 1964,23142 1667.2,23142 1667.2,23142 1667.2,23142 1667.2,23141 1667.2,\
23141"];
	layer31_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L31\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1929,23105",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer31_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2383,23014",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer31_moe_expert2 -> layer31_moe_comm_from_expert2	[pos="e,2292.3,23013 2073.8,23078 2073.8,23051 2073.8,23013 2073.8,23013 2073.8,23013 2282.3,23013 2282.3,23013"];
	layer31_moe_comm_to_expert2 -> layer31_moe_expert2	[pos="e,2080.7,23131 2292.3,23195 2203.3,23195 2080.7,23195 2080.7,23195 2080.7,23195 2080.7,23141 2080.7,23141"];
	layer31_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L31\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2275,23105",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer31_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2692,23014",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer31_moe_expert3 -> layer31_moe_comm_from_expert3	[pos="e,2692,23043 2365.7,23078 2365.7,23069 2365.7,23060 2365.7,23060 2365.7,23060 2692,23060 2692,23060 2692,23060 2692,23053 2692,23053"];
	layer31_moe_comm_to_expert3 -> layer31_moe_expert3	[pos="e,2365.7,23131 2692,23166 2692,23159 2692,23154 2692,23154 2692,23154 2365.7,23154 2365.7,23154 2365.7,23154 2365.7,23141 2365.7,\
23141"];
	layer31_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L31\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2621,23105",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer31_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2946,23014",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer31_moe_expert4 -> layer31_moe_comm_from_expert4	[pos="e,2855.5,23013 2785.2,23095 2792.6,23095 2797,23095 2797,23095 2797,23095 2797,23013 2797,23013 2797,23013 2845.5,23013 2845.5,23013"];
	layer31_moe_comm_to_expert4 -> layer31_moe_expert4	[pos="e,2785.3,23113 2855.4,23195 2821.5,23195 2791,23195 2791,23195 2791,23195 2791,23113 2791,23113 2791,23113 2790.4,23113 2790.4,23113"];
	layer31_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L31\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2967,23105",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer31_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3173,23014",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer31_moe_expert5 -> layer31_moe_comm_from_expert5	[pos="e,3106.7,23033 3106.7,23078 3106.7,23078 3106.7,23043 3106.7,23043"];
	layer31_moe_comm_to_expert5 -> layer31_moe_expert5	[pos="e,3106.7,23131 3106.7,23175 3106.7,23175 3106.7,23141 3106.7,23141"];
	layer31_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L31\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3313,23105",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer31_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3386,23014",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer31_moe_expert6 -> layer31_moe_comm_from_expert6	[pos="e,3386,23043 3386,23078 3386,23078 3386,23053 3386,23053"];
	layer31_moe_comm_to_expert6 -> layer31_moe_expert6	[pos="e,3386,23131 3386,23166 3386,23166 3386,23141 3386,23141"];
	layer31_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L31\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3659,23105",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer31_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3696,23014",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer31_moe_expert7 -> layer31_moe_comm_from_expert7	[pos="e,3696,23043 3696,23078 3696,23078 3696,23053 3696,23053"];
	layer31_moe_comm_to_expert7 -> layer31_moe_expert7	[pos="e,3696,23131 3696,23166 3696,23166 3696,23141 3696,23141"];
	layer31_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L31\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="4005,23105",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer31_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3968,23014",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer31_moe_expert8 -> layer31_moe_comm_from_expert8	[pos="e,3968,23043 3968,23078 3968,23078 3968,23053 3968,23053"];
	layer31_moe_comm_to_expert8 -> layer31_moe_expert8	[pos="e,3968,23131 3968,23166 3968,23166 3968,23141 3968,23141"];
	layer31_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L31\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4351,23105",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer31_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4277,23014",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer31_moe_expert9 -> layer31_moe_comm_from_expert9	[pos="e,4277.3,23043 4277.3,23078 4277.3,23078 4277.3,23053 4277.3,23053"];
	layer31_moe_comm_to_expert9 -> layer31_moe_expert9	[pos="e,4277.3,23131 4277.3,23166 4277.3,23166 4277.3,23141 4277.3,23141"];
	layer31_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L31\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4702,23105",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer31_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4609,23014",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer31_moe_expert10 -> layer31_moe_comm_from_expert10	[pos="e,4618.4,23043 4618.4,23078 4618.4,23078 4618.4,23053 4618.4,23053"];
	layer31_moe_comm_to_expert10 -> layer31_moe_expert10	[pos="e,4618,23131 4618,23166 4618,23166 4618,23141 4618,23141"];
	layer31_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L31\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5058,23105",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer31_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4956,23014",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer31_moe_expert11 -> layer31_moe_comm_from_expert11	[pos="e,4969.9,23042 4969.9,23078 4969.9,23078 4969.9,23052 4969.9,23052"];
	layer31_moe_comm_to_expert11 -> layer31_moe_expert11	[pos="e,4969,23131 4969,23167 4969,23167 4969,23141 4969,23141"];
	layer31_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L31\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5414,23105",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer31_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5307,23014",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer31_moe_expert12 -> layer31_moe_comm_from_expert12	[pos="e,5323.4,23042 5323.4,23078 5323.4,23078 5323.4,23052 5323.4,23052"];
	layer31_moe_comm_to_expert12 -> layer31_moe_expert12	[pos="e,5322.5,23131 5322.5,23167 5322.5,23167 5322.5,23141 5322.5,23141"];
	layer31_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L31\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5770,23105",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer31_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5661,23014",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer31_moe_expert13 -> layer31_moe_comm_from_expert13	[pos="e,5678.4,23042 5678.4,23078 5678.4,23078 5678.4,23052 5678.4,23052"];
	layer31_moe_comm_to_expert13 -> layer31_moe_expert13	[pos="e,5677,23131 5677,23167 5677,23167 5677,23141 5677,23141"];
	layer31_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L31\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6126,23105",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer31_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="6016,23014",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer31_moe_expert14 -> layer31_moe_comm_from_expert14	[pos="e,6033.9,23042 6033.9,23078 6033.9,23078 6033.9,23052 6033.9,23052"];
	layer31_moe_comm_to_expert14 -> layer31_moe_expert14	[pos="e,6032.5,23131 6032.5,23167 6032.5,23167 6032.5,23141 6032.5,23141"];
	layer31_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L31\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6482,23105",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer31_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6371,23014",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer31_moe_expert15 -> layer31_moe_comm_from_expert15	[pos="e,6389.4,23042 6389.4,23078 6389.4,23078 6389.4,23052 6389.4,23052"];
	layer31_moe_comm_to_expert15 -> layer31_moe_expert15	[pos="e,6388,23131 6388,23167 6388,23167 6388,23141 6388,23141"];
	layer31_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L31\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3795,22897",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer32_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L32\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3795,22783",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer31_moe_aggregate -> layer32_moe_mha	[pos="e,3795,22809 3795,22844 3795,22844 3795,22819 3795,22819"];
	layer31_moe_comm_from_expert0 -> layer31_moe_aggregate	[pos="e,3547.6,22859 1372,22989 1372,22945 1372,22859 1372,22859 1372,22859 3537.6,22859 3537.6,22859"];
	layer31_moe_comm_from_expert1 -> layer31_moe_aggregate	[pos="e,3563.1,22874 2024.5,22992 2024.5,22952 2024.5,22874 2024.5,22874 2024.5,22874 3553.1,22874 3553.1,22874"];
	layer31_moe_comm_from_expert2 -> layer31_moe_aggregate	[pos="e,3578.4,22889 2451.5,22994 2451.5,22959 2451.5,22889 2451.5,22889 2451.5,22889 3568.4,22889 3568.4,22889"];
	layer31_moe_comm_from_expert3 -> layer31_moe_aggregate	[pos="e,3593.2,22903 2775,23002 2775,22973 2775,22903 2775,22903 2775,22903 3583.2,22903 3583.2,22903"];
	layer31_moe_comm_from_expert4 -> layer31_moe_aggregate	[pos="e,3608.6,22918 3021,22997 3021,22970 3021,22918 3021,22918 3021,22918 3598.6,22918 3598.6,22918"];
	layer31_moe_comm_from_expert5 -> layer31_moe_aggregate	[pos="e,3624,22933 3225,22989 3225,22966 3225,22933 3225,22933 3225,22933 3614,22933 3614,22933"];
	layer31_moe_comm_from_expert6 -> layer31_moe_aggregate	[pos="e,3569.1,22897 3476.7,23013 3522.8,23013 3569.1,23013 3569.1,23013 3569.1,23013 3569.1,22907 3569.1,22907"];
	layer31_moe_comm_from_expert7 -> layer31_moe_aggregate	[pos="e,3696,22949 3696,22984 3696,22984 3696,22959 3696,22959"];
	layer31_moe_comm_from_expert8 -> layer31_moe_aggregate	[pos="e,3967.4,22949 3967.4,22984 3967.4,22984 3967.4,22959 3967.4,22959"];
	layer31_moe_comm_from_expert9 -> layer31_moe_aggregate	[pos="e,4043.4,22935 4258.5,22985 4258.5,22962 4258.5,22935 4258.5,22935 4258.5,22935 4053.4,22935 4053.4,22935"];
	layer31_moe_comm_from_expert10 -> layer31_moe_aggregate	[pos="e,4029.8,22922 4590.1,22985 4590.1,22958 4590.1,22922 4590.1,22922 4590.1,22922 4039.8,22922 4039.8,22922"];
	layer31_moe_comm_from_expert11 -> layer31_moe_aggregate	[pos="e,4016.5,22909 4936.6,22985 4936.6,22954 4936.6,22909 4936.6,22909 4936.6,22909 4026.5,22909 4026.5,22909"];
	layer31_moe_comm_from_expert12 -> layer31_moe_aggregate	[pos="e,4002.9,22896 5287.6,22985 5287.6,22950 5287.6,22896 5287.6,22896 5287.6,22896 4012.9,22896 4012.9,22896"];
	layer31_moe_comm_from_expert13 -> layer31_moe_aggregate	[pos="e,3989.5,22883 5641.1,22985 5641.1,22946 5641.1,22883 5641.1,22883 5641.1,22883 3999.5,22883 3999.5,22883"];
	layer31_moe_comm_from_expert14 -> layer31_moe_aggregate	[pos="e,3976.5,22870 5996.1,22985 5996.1,22943 5996.1,22870 5996.1,22870 5996.1,22870 3986.5,22870 3986.5,22870"];
	layer31_moe_comm_from_expert15 -> layer31_moe_aggregate	[pos="e,3962.7,22857 6351.1,22985 6351.1,22940 6351.1,22857 6351.1,22857 6351.1,22857 3972.7,22857 3972.7,22857"];
	layer32_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L32\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3795,22669",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer32_moe_mha -> layer32_moe_gate	[pos="e,3795,22721 3795,22756 3795,22756 3795,22731 3795,22731"];
	layer32_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L32\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3795,22529",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer32_moe_gate -> layer32_moe_split	[pos="e,3795,22581 3795,22616 3795,22616 3795,22591 3795,22591"];
	layer32_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1420,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer32_moe_split -> layer32_moe_comm_to_expert0	[pos="e,1464.8,22437 3629.3,22565 3096.9,22565 1464.8,22565 1464.8,22565 1464.8,22565 1464.8,22447 1464.8,22447",
		style=dashed];
	layer32_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1776,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer32_moe_split -> layer32_moe_comm_to_expert1	[pos="e,1815.8,22438 3614.1,22550 3125.5,22550 1815.8,22550 1815.8,22550 1815.8,22550 1815.8,22448 1815.8,22448",
		style=dashed];
	layer32_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2085,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer32_moe_split -> layer32_moe_comm_to_expert2	[pos="e,2143.3,22434 3599,22535 3161.5,22535 2143.3,22535 2143.3,22535 2143.3,22535 2143.3,22444 2143.3,22444",
		style=dashed];
	layer32_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2339,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer32_moe_split -> layer32_moe_comm_to_expert3	[pos="e,2361,22440 3585.3,22521 3187.2,22521 2361,22521 2361,22521 2361,22521 2361,22450 2361,22450",
		style=dashed];
	layer32_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2677,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer32_moe_split -> layer32_moe_comm_to_expert4	[pos="e,2684.5,22441 3570.3,22506 3245.8,22506 2684.5,22506 2684.5,22506 2684.5,22506 2684.5,22451 2684.5,22451",
		style=dashed];
	layer32_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3096,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer32_moe_split -> layer32_moe_comm_to_expert5	[pos="e,3134.5,22438 3555.1,22491 3366.2,22491 3134.5,22491 3134.5,22491 3134.5,22491 3134.5,22448 3134.5,22448",
		style=dashed];
	layer32_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3405,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer32_moe_split -> layer32_moe_comm_to_expert6	[pos="e,3495.6,22411 3554.7,22528 3554.7,22525 3554.7,22411 3554.7,22411 3554.7,22411 3505.6,22411 3505.6,22411",
		style=dashed];
	layer32_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3659,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer32_moe_split -> layer32_moe_comm_to_expert7	[pos="e,3659,22441 3659,22476 3659,22476 3659,22451 3659,22451",
		style=dashed];
	layer32_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3931,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer32_moe_split -> layer32_moe_comm_to_expert8	[pos="e,3931,22441 3931,22476 3931,22476 3931,22451 3931,22451",
		style=dashed];
	layer32_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4240,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer32_moe_split -> layer32_moe_comm_to_expert9	[pos="e,4149.3,22411 4035.3,22528 4035.3,22525 4035.3,22411 4035.3,22411 4035.3,22411 4139.3,22411 4139.3,22411",
		style=dashed];
	layer32_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4572,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer32_moe_split -> layer32_moe_comm_to_expert10	[pos="e,4496.1,22429 3959.8,22491 4167.1,22491 4496.1,22491 4496.1,22491 4496.1,22491 4496.1,22439 4496.1,22439",
		style=dashed];
	layer32_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4918,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer32_moe_split -> layer32_moe_comm_to_expert11	[pos="e,4842.6,22429 3974.8,22506 4274.2,22506 4842.6,22506 4842.6,22506 4842.6,22506 4842.6,22439 4842.6,22439",
		style=dashed];
	layer32_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5269,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer32_moe_split -> layer32_moe_comm_to_expert12	[pos="e,5193.6,22429 3989.8,22521 4374.3,22521 5193.6,22521 5193.6,22521 5193.6,22521 5193.6,22439 5193.6,22439",
		style=dashed];
	layer32_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5622,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer32_moe_split -> layer32_moe_comm_to_expert13	[pos="e,5547.1,22429 4003.7,22535 4468.3,22535 5547.1,22535 5547.1,22535 5547.1,22535 5547.1,22439 5547.1,22439",
		style=dashed];
	layer32_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5977,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer32_moe_split -> layer32_moe_comm_to_expert14	[pos="e,5902.1,22429 4018.5,22550 4560.8,22550 5902.1,22550 5902.1,22550 5902.1,22550 5902.1,22439 5902.1,22439",
		style=dashed];
	layer32_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6332,22412",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer32_moe_split -> layer32_moe_comm_to_expert15	[pos="e,6257.1,22429 4033.6,22565 4651.7,22565 6257.1,22565 6257.1,22565 6257.1,22565 6257.1,22439 6257.1,22439",
		style=dashed];
	layer32_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L32\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1200,22321",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer32_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1246,22230",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer32_moe_expert0 -> layer32_moe_comm_from_expert0	[pos="e,1246,22259 1246,22294 1246,22294 1246,22269 1246,22269"];
	layer32_moe_comm_to_expert0 -> layer32_moe_expert0	[pos="e,1346.7,22347 1346.7,22394 1346.7,22394 1346.7,22357 1346.7,22357"];
	layer32_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L32\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1546,22321",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer32_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1959,22230",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer32_moe_expert1 -> layer32_moe_comm_from_expert1	[pos="e,1868.3,22229 1648.2,22294 1648.2,22267 1648.2,22229 1648.2,22229 1648.2,22229 1858.3,22229 1858.3,22229"];
	layer32_moe_comm_to_expert1 -> layer32_moe_expert1	[pos="e,1697.7,22347 1697.7,22397 1697.7,22397 1697.7,22357 1697.7,22357"];
	layer32_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L32\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1892,22321",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer32_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2415,22230",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer32_moe_expert2 -> layer32_moe_comm_from_expert2	[pos="e,2324.4,22229 2056.2,22320 2061.8,22320 2065,22320 2065,22320 2065,22320 2065,22229 2065,22229 2065,22229 2314.4,22229 2314.4,22229"];
	layer32_moe_comm_to_expert2 -> layer32_moe_expert2	[pos="e,2025.2,22347 2025.2,22390 2025.2,22390 2025.2,22357 2025.2,22357"];
	layer32_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L32\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2238,22321",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer32_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2743,22230",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer32_moe_expert3 -> layer32_moe_comm_from_expert3	[pos="e,2684.3,22252 2363.2,22294 2363.2,22282 2363.2,22270 2363.2,22270 2363.2,22270 2684.3,22270 2684.3,22270 2684.3,22270 2684.3,22262 \
2684.3,22262"];
	layer32_moe_comm_to_expert3 -> layer32_moe_expert3	[pos="e,2325.2,22347 2325.2,22383 2325.2,22383 2325.2,22357 2325.2,22357"];
	layer32_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L32\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2584,22321",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer32_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="3006,22230",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer32_moe_expert4 -> layer32_moe_comm_from_expert4	[pos="e,3004.7,22259 2716.2,22294 2716.2,22287 2716.2,22282 2716.2,22282 2716.2,22282 3004.7,22282 3004.7,22282 3004.7,22282 3004.7,22269 \
3004.7,22269"];
	layer32_moe_comm_to_expert4 -> layer32_moe_expert4	[pos="e,2667.2,22347 2667.2,22383 2667.2,22383 2667.2,22357 2667.2,22357"];
	layer32_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L32\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2930,22321",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer32_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3237,22230",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer32_moe_expert5 -> layer32_moe_comm_from_expert5	[pos="e,3146.5,22229 3094.2,22320 3099.8,22320 3103,22320 3103,22320 3103,22320 3103,22229 3103,22229 3103,22229 3136.5,22229 3136.5,22229"];
	layer32_moe_comm_to_expert5 -> layer32_moe_expert5	[pos="e,3049.7,22347 3049.7,22386 3049.7,22386 3049.7,22357 3049.7,22357"];
	layer32_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L32\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3276,22321",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer32_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3452,22230",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer32_moe_expert6 -> layer32_moe_comm_from_expert6	[pos="e,3400.7,22254 3400.7,22294 3400.7,22294 3400.7,22264 3400.7,22264"];
	layer32_moe_comm_to_expert6 -> layer32_moe_expert6	[pos="e,3377.2,22347 3377.2,22384 3377.2,22384 3377.2,22357 3377.2,22357"];
	layer32_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L32\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3622,22321",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer32_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3659,22230",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer32_moe_expert7 -> layer32_moe_comm_from_expert7	[pos="e,3659,22259 3659,22294 3659,22294 3659,22269 3659,22269"];
	layer32_moe_comm_to_expert7 -> layer32_moe_expert7	[pos="e,3659,22347 3659,22383 3659,22383 3659,22357 3659,22357"];
	layer32_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L32\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3968,22321",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer32_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3931,22230",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer32_moe_expert8 -> layer32_moe_comm_from_expert8	[pos="e,3931,22259 3931,22294 3931,22294 3931,22269 3931,22269"];
	layer32_moe_comm_to_expert8 -> layer32_moe_expert8	[pos="e,3931,22347 3931,22383 3931,22383 3931,22357 3931,22357"];
	layer32_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L32\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4314,22321",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer32_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4240,22230",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer32_moe_expert9 -> layer32_moe_comm_from_expert9	[pos="e,4240.3,22259 4240.3,22294 4240.3,22294 4240.3,22269 4240.3,22269"];
	layer32_moe_comm_to_expert9 -> layer32_moe_expert9	[pos="e,4240.3,22347 4240.3,22383 4240.3,22383 4240.3,22357 4240.3,22357"];
	layer32_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L32\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4665,22321",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer32_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4572,22230",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer32_moe_expert10 -> layer32_moe_comm_from_expert10	[pos="e,4581.4,22259 4581.4,22294 4581.4,22294 4581.4,22269 4581.4,22269"];
	layer32_moe_comm_to_expert10 -> layer32_moe_expert10	[pos="e,4581,22347 4581,22383 4581,22383 4581,22357 4581,22357"];
	layer32_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L32\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="5021,22321",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer32_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4919,22230",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer32_moe_expert11 -> layer32_moe_comm_from_expert11	[pos="e,4932.9,22258 4932.9,22294 4932.9,22294 4932.9,22268 4932.9,22268"];
	layer32_moe_comm_to_expert11 -> layer32_moe_expert11	[pos="e,4932,22347 4932,22383 4932,22383 4932,22357 4932,22357"];
	layer32_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L32\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5377,22321",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer32_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5270,22230",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer32_moe_expert12 -> layer32_moe_comm_from_expert12	[pos="e,5286.4,22258 5286.4,22294 5286.4,22294 5286.4,22268 5286.4,22268"];
	layer32_moe_comm_to_expert12 -> layer32_moe_expert12	[pos="e,5285.5,22347 5285.5,22383 5285.5,22383 5285.5,22357 5285.5,22357"];
	layer32_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L32\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5733,22321",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer32_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5624,22230",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer32_moe_expert13 -> layer32_moe_comm_from_expert13	[pos="e,5641.4,22258 5641.4,22294 5641.4,22294 5641.4,22268 5641.4,22268"];
	layer32_moe_comm_to_expert13 -> layer32_moe_expert13	[pos="e,5640,22347 5640,22383 5640,22383 5640,22357 5640,22357"];
	layer32_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L32\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6089,22321",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer32_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5979,22230",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer32_moe_expert14 -> layer32_moe_comm_from_expert14	[pos="e,5996.9,22258 5996.9,22294 5996.9,22294 5996.9,22268 5996.9,22268"];
	layer32_moe_comm_to_expert14 -> layer32_moe_expert14	[pos="e,5995.5,22347 5995.5,22383 5995.5,22383 5995.5,22357 5995.5,22357"];
	layer32_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L32\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6445,22321",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer32_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6334,22230",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer32_moe_expert15 -> layer32_moe_comm_from_expert15	[pos="e,6352.4,22258 6352.4,22294 6352.4,22294 6352.4,22268 6352.4,22268"];
	layer32_moe_comm_to_expert15 -> layer32_moe_expert15	[pos="e,6351,22347 6351,22383 6351,22383 6351,22357 6351,22357"];
	layer32_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L32\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3758,22113",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer33_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L33\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3758,21999",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer32_moe_aggregate -> layer33_moe_mha	[pos="e,3758,22025 3758,22060 3758,22060 3758,22035 3758,22035"];
	layer32_moe_comm_from_expert0 -> layer32_moe_aggregate	[pos="e,3510.6,22075 1331.8,22220 1331.8,22186 1331.8,22075 1331.8,22075 1331.8,22075 3500.6,22075 3500.6,22075"];
	layer32_moe_comm_from_expert1 -> layer32_moe_aggregate	[pos="e,3525.9,22090 2043.3,22219 2043.3,22186 2043.3,22090 2043.3,22090 2043.3,22090 3515.9,22090 3515.9,22090"];
	layer32_moe_comm_from_expert2 -> layer32_moe_aggregate	[pos="e,3541.7,22105 2487,22212 2487,22178 2487,22105 2487,22105 2487,22105 3531.7,22105 3531.7,22105"];
	layer32_moe_comm_from_expert3 -> layer32_moe_aggregate	[pos="e,3557.2,22120 2815,22212 2815,22181 2815,22120 2815,22120 2815,22120 3547.2,22120 3547.2,22120"];
	layer32_moe_comm_from_expert4 -> layer32_moe_aggregate	[pos="e,3571.2,22134 3085.8,22215 3085.8,22189 3085.8,22134 3085.8,22134 3085.8,22134 3561.2,22134 3561.2,22134"];
	layer32_moe_comm_from_expert5 -> layer32_moe_aggregate	[pos="e,3587,22149 3307.5,22211 3307.5,22188 3307.5,22149 3307.5,22149 3307.5,22149 3577,22149 3577,22149"];
	layer32_moe_comm_from_expert6 -> layer32_moe_aggregate	[pos="e,3519.1,22113 3519.1,22210 3519.1,22210 3519.1,22123 3519.1,22123"];
	layer32_moe_comm_from_expert7 -> layer32_moe_aggregate	[pos="e,3659,22165 3659,22200 3659,22200 3659,22175 3659,22175"];
	layer32_moe_comm_from_expert8 -> layer32_moe_aggregate	[pos="e,3930.4,22165 3930.4,22200 3930.4,22200 3930.4,22175 3930.4,22175"];
	layer32_moe_comm_from_expert9 -> layer32_moe_aggregate	[pos="e,4006.4,22151 4221.5,22201 4221.5,22178 4221.5,22151 4221.5,22151 4221.5,22151 4016.4,22151 4016.4,22151"];
	layer32_moe_comm_from_expert10 -> layer32_moe_aggregate	[pos="e,3992.8,22138 4553.1,22201 4553.1,22174 4553.1,22138 4553.1,22138 4553.1,22138 4002.8,22138 4002.8,22138"];
	layer32_moe_comm_from_expert11 -> layer32_moe_aggregate	[pos="e,3979.5,22125 4899.6,22201 4899.6,22170 4899.6,22125 4899.6,22125 4899.6,22125 3989.5,22125 3989.5,22125"];
	layer32_moe_comm_from_expert12 -> layer32_moe_aggregate	[pos="e,3965.9,22112 5250.6,22201 5250.6,22166 5250.6,22112 5250.6,22112 5250.6,22112 3975.9,22112 3975.9,22112"];
	layer32_moe_comm_from_expert13 -> layer32_moe_aggregate	[pos="e,3952.5,22099 5604.1,22201 5604.1,22162 5604.1,22099 5604.1,22099 5604.1,22099 3962.5,22099 3962.5,22099"];
	layer32_moe_comm_from_expert14 -> layer32_moe_aggregate	[pos="e,3939.1,22086 5959.1,22201 5959.1,22159 5959.1,22086 5959.1,22086 5959.1,22086 3949.1,22086 3949.1,22086"];
	layer32_moe_comm_from_expert15 -> layer32_moe_aggregate	[pos="e,3925.7,22073 6314.1,22201 6314.1,22156 6314.1,22073 6314.1,22073 6314.1,22073 3935.7,22073 3935.7,22073"];
	layer33_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L33\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3758,21885",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer33_moe_mha -> layer33_moe_gate	[pos="e,3758,21937 3758,21972 3758,21972 3758,21947 3758,21947"];
	layer33_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L33\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3758,21745",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer33_moe_gate -> layer33_moe_split	[pos="e,3758,21797 3758,21832 3758,21832 3758,21807 3758,21807"];
	layer33_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1677,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer33_moe_split -> layer33_moe_comm_to_expert0	[pos="e,1747.8,21646 3592.2,21781 3111,21781 1747.8,21781 1747.8,21781 1747.8,21781 1747.8,21656 1747.8,21656",
		style=dashed];
	layer33_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1922,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer33_moe_split -> layer33_moe_comm_to_expert1	[pos="e,1940.5,21656 3577.1,21766 3117.4,21766 1940.5,21766 1940.5,21766 1940.5,21766 1940.5,21666 1940.5,21666",
		style=dashed];
	layer33_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2378,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer33_moe_split -> layer33_moe_comm_to_expert2	[pos="e,2396.5,21656 3563.3,21752 3187,21752 2396.5,21752 2396.5,21752 2396.5,21752 2396.5,21666 2396.5,21666",
		style=dashed];
	layer33_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2706,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer33_moe_split -> layer33_moe_comm_to_expert3	[pos="e,2724.5,21656 3548.2,21737 3246.1,21737 2724.5,21737 2724.5,21737 2724.5,21737 2724.5,21666 2724.5,21666",
		style=dashed];
	layer33_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2969,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer33_moe_split -> layer33_moe_comm_to_expert4	[pos="e,2987.5,21656 3533.3,21722 3305.9,21722 2987.5,21722 2987.5,21722 2987.5,21722 2987.5,21666 2987.5,21666",
		style=dashed];
	layer33_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3200,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer33_moe_split -> layer33_moe_comm_to_expert5	[pos="e,3218.5,21656 3518.2,21707 3374.1,21707 3218.5,21707 3218.5,21707 3218.5,21707 3218.5,21666 3218.5,21666",
		style=dashed];
	layer33_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3415,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer33_moe_split -> layer33_moe_comm_to_expert6	[pos="e,3505.8,21627 3518.5,21744 3518.5,21741 3518.5,21627 3518.5,21627 3518.5,21627 3515.8,21627 3515.8,21627",
		style=dashed];
	layer33_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3622,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer33_moe_split -> layer33_moe_comm_to_expert7	[pos="e,3622,21657 3622,21692 3622,21692 3622,21667 3622,21667",
		style=dashed];
	layer33_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3894,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer33_moe_split -> layer33_moe_comm_to_expert8	[pos="e,3894,21657 3894,21692 3894,21692 3894,21667 3894,21667",
		style=dashed];
	layer33_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4203,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer33_moe_split -> layer33_moe_comm_to_expert9	[pos="e,4112.3,21627 3998.3,21744 3998.3,21741 3998.3,21627 3998.3,21627 3998.3,21627 4102.3,21627 4102.3,21627",
		style=dashed];
	layer33_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4535,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer33_moe_split -> layer33_moe_comm_to_expert10	[pos="e,4459.1,21645 3922.8,21707 4130.1,21707 4459.1,21707 4459.1,21707 4459.1,21707 4459.1,21655 4459.1,21655",
		style=dashed];
	layer33_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4881,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer33_moe_split -> layer33_moe_comm_to_expert11	[pos="e,4805.6,21645 3937.5,21722 4236.9,21722 4805.6,21722 4805.6,21722 4805.6,21722 4805.6,21655 4805.6,21655",
		style=dashed];
	layer33_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5232,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer33_moe_split -> layer33_moe_comm_to_expert12	[pos="e,5156.6,21645 3952.5,21737 4336.8,21737 5156.6,21737 5156.6,21737 5156.6,21737 5156.6,21655 5156.6,21655",
		style=dashed];
	layer33_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5585,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer33_moe_split -> layer33_moe_comm_to_expert13	[pos="e,5510.1,21645 3967.6,21752 4432.7,21752 5510.1,21752 5510.1,21752 5510.1,21752 5510.1,21655 5510.1,21655",
		style=dashed];
	layer33_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5940,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer33_moe_split -> layer33_moe_comm_to_expert14	[pos="e,5865.1,21645 3981.5,21766 4523.8,21766 5865.1,21766 5865.1,21766 5865.1,21766 5865.1,21655 5865.1,21655",
		style=dashed];
	layer33_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6295,21628",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer33_moe_split -> layer33_moe_comm_to_expert15	[pos="e,6220.1,21645 3996.6,21781 4614.7,21781 6220.1,21781 6220.1,21781 6220.1,21781 6220.1,21655 6220.1,21655",
		style=dashed];
	layer33_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L33\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1163,21537",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer33_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1209,21446",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer33_moe_expert0 -> layer33_moe_comm_from_expert0	[pos="e,1209,21475 1209,21510 1209,21510 1209,21485 1209,21485"];
	layer33_moe_comm_to_expert0 -> layer33_moe_expert0	[pos="e,1241.2,21563 1586.4,21627 1458.8,21627 1241.2,21627 1241.2,21627 1241.2,21627 1241.2,21573 1241.2,21573"];
	layer33_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L33\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1509,21537",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer33_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1922,21446",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer33_moe_expert1 -> layer33_moe_comm_from_expert1	[pos="e,1831.2,21445 1663.5,21511 1663.5,21484 1663.5,21445 1663.5,21445 1663.5,21445 1821.2,21445 1821.2,21445"];
	layer33_moe_comm_to_expert1 -> layer33_moe_expert1	[pos="e,1629.7,21563 1922,21598 1922,21584 1922,21571 1922,21571 1922,21571 1629.7,21571 1629.7,21571 1629.7,21571 1629.7,21570 1629.7,\
21570"];
	layer33_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L33\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1855,21537",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer33_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2378,21446",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer33_moe_expert2 -> layer33_moe_comm_from_expert2	[pos="e,2287.3,21445 2019.2,21527 2026.6,21527 2031,21527 2031,21527 2031,21527 2031,21445 2031,21445 2031,21445 2277.3,21445 2277.3,21445"];
	layer33_moe_comm_to_expert2 -> layer33_moe_expert2	[pos="e,2019.3,21545 2287.1,21627 2182.5,21627 2025,21627 2025,21627 2025,21627 2025,21545 2025,21545 2025,21545 2024.4,21545 2024.4,21545"];
	layer33_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L33\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2201,21537",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer33_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2706,21446",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer33_moe_expert3 -> layer33_moe_comm_from_expert3	[pos="e,2647.3,21468 2326.2,21510 2326.2,21498 2326.2,21486 2326.2,21486 2326.2,21486 2647.3,21486 2647.3,21486 2647.3,21486 2647.3,21478 \
2647.3,21478"];
	layer33_moe_comm_to_expert3 -> layer33_moe_expert3	[pos="e,2326.2,21563 2647.3,21605 2647.3,21597 2647.3,21589 2647.3,21589 2647.3,21589 2326.2,21589 2326.2,21589 2326.2,21589 2326.2,21573 \
2326.2,21573"];
	layer33_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L33\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2547,21537",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer33_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2969,21446",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer33_moe_expert4 -> layer33_moe_comm_from_expert4	[pos="e,2967.7,21475 2679.2,21510 2679.2,21503 2679.2,21498 2679.2,21498 2679.2,21498 2967.7,21498 2967.7,21498 2967.7,21498 2967.7,21485 \
2967.7,21485"];
	layer33_moe_comm_to_expert4 -> layer33_moe_expert4	[pos="e,2679.2,21563 2967.7,21599 2967.7,21589 2967.7,21580 2967.7,21580 2967.7,21580 2679.2,21580 2679.2,21580 2679.2,21580 2679.2,21573 \
2679.2,21573"];
	layer33_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L33\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2893,21537",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer33_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3200,21446",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer33_moe_expert5 -> layer33_moe_comm_from_expert5	[pos="e,3109.2,21445 3057.2,21527 3064.1,21527 3068.2,21527 3068.2,21527 3068.2,21527 3068.2,21445 3068.2,21445 3068.2,21445 3099.2,21445 \
3099.2,21445"];
	layer33_moe_comm_to_expert5 -> layer33_moe_expert5	[pos="e,3057.3,21545 3109.2,21627 3084.2,21627 3063.8,21627 3063.8,21627 3063.8,21627 3063.8,21545 3063.8,21545 3063.8,21545 3063.2,21545 \
3063.2,21545"];
	layer33_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L33\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3239,21537",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer33_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3415,21446",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer33_moe_expert6 -> layer33_moe_comm_from_expert6	[pos="e,3363.7,21470 3363.7,21510 3363.7,21510 3363.7,21480 3363.7,21480"];
	layer33_moe_comm_to_expert6 -> layer33_moe_expert6	[pos="e,3363.7,21563 3363.7,21604 3363.7,21604 3363.7,21573 3363.7,21573"];
	layer33_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L33\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3585,21537",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer33_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3622,21446",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer33_moe_expert7 -> layer33_moe_comm_from_expert7	[pos="e,3622,21475 3622,21510 3622,21510 3622,21485 3622,21485"];
	layer33_moe_comm_to_expert7 -> layer33_moe_expert7	[pos="e,3622,21563 3622,21599 3622,21599 3622,21573 3622,21573"];
	layer33_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L33\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3931,21537",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer33_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3894,21446",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer33_moe_expert8 -> layer33_moe_comm_from_expert8	[pos="e,3894,21475 3894,21510 3894,21510 3894,21485 3894,21485"];
	layer33_moe_comm_to_expert8 -> layer33_moe_expert8	[pos="e,3894,21563 3894,21599 3894,21599 3894,21573 3894,21573"];
	layer33_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L33\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4277,21537",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer33_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4203,21446",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer33_moe_expert9 -> layer33_moe_comm_from_expert9	[pos="e,4203.3,21475 4203.3,21510 4203.3,21510 4203.3,21485 4203.3,21485"];
	layer33_moe_comm_to_expert9 -> layer33_moe_expert9	[pos="e,4203.3,21563 4203.3,21599 4203.3,21599 4203.3,21573 4203.3,21573"];
	layer33_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L33\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4628,21537",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer33_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4535,21446",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer33_moe_expert10 -> layer33_moe_comm_from_expert10	[pos="e,4544.4,21475 4544.4,21510 4544.4,21510 4544.4,21485 4544.4,21485"];
	layer33_moe_comm_to_expert10 -> layer33_moe_expert10	[pos="e,4544,21563 4544,21599 4544,21599 4544,21573 4544,21573"];
	layer33_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L33\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4984,21537",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer33_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4882,21446",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer33_moe_expert11 -> layer33_moe_comm_from_expert11	[pos="e,4895.9,21474 4895.9,21510 4895.9,21510 4895.9,21484 4895.9,21484"];
	layer33_moe_comm_to_expert11 -> layer33_moe_expert11	[pos="e,4895,21563 4895,21599 4895,21599 4895,21573 4895,21573"];
	layer33_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L33\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5340,21537",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer33_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5233,21446",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer33_moe_expert12 -> layer33_moe_comm_from_expert12	[pos="e,5249.4,21474 5249.4,21510 5249.4,21510 5249.4,21484 5249.4,21484"];
	layer33_moe_comm_to_expert12 -> layer33_moe_expert12	[pos="e,5248.5,21563 5248.5,21599 5248.5,21599 5248.5,21573 5248.5,21573"];
	layer33_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L33\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5696,21537",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer33_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5587,21446",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer33_moe_expert13 -> layer33_moe_comm_from_expert13	[pos="e,5604.4,21474 5604.4,21510 5604.4,21510 5604.4,21484 5604.4,21484"];
	layer33_moe_comm_to_expert13 -> layer33_moe_expert13	[pos="e,5603,21563 5603,21599 5603,21599 5603,21573 5603,21573"];
	layer33_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L33\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6052,21537",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer33_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5942,21446",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer33_moe_expert14 -> layer33_moe_comm_from_expert14	[pos="e,5959.9,21474 5959.9,21510 5959.9,21510 5959.9,21484 5959.9,21484"];
	layer33_moe_comm_to_expert14 -> layer33_moe_expert14	[pos="e,5958.5,21563 5958.5,21599 5958.5,21599 5958.5,21573 5958.5,21573"];
	layer33_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L33\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6408,21537",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer33_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6297,21446",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer33_moe_expert15 -> layer33_moe_comm_from_expert15	[pos="e,6315.4,21474 6315.4,21510 6315.4,21510 6315.4,21484 6315.4,21484"];
	layer33_moe_comm_to_expert15 -> layer33_moe_expert15	[pos="e,6314,21563 6314,21599 6314,21599 6314,21573 6314,21573"];
	layer33_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L33\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3721,21329",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer34_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L34\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3721,21215",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer33_moe_aggregate -> layer34_moe_mha	[pos="e,3721,21241 3721,21276 3721,21276 3721,21251 3721,21251"];
	layer33_moe_comm_from_expert0 -> layer33_moe_aggregate	[pos="e,3473.6,21291 1294.8,21436 1294.8,21402 1294.8,21291 1294.8,21291 1294.8,21291 3463.6,21291 3463.6,21291"];
	layer33_moe_comm_from_expert1 -> layer33_moe_aggregate	[pos="e,3488.9,21306 2006.3,21435 2006.3,21402 2006.3,21306 2006.3,21306 2006.3,21306 3478.9,21306 3478.9,21306"];
	layer33_moe_comm_from_expert2 -> layer33_moe_aggregate	[pos="e,3504.7,21321 2450,21428 2450,21394 2450,21321 2450,21321 2450,21321 3494.7,21321 3494.7,21321"];
	layer33_moe_comm_from_expert3 -> layer33_moe_aggregate	[pos="e,3520.2,21336 2778,21428 2778,21397 2778,21336 2778,21336 2778,21336 3510.2,21336 3510.2,21336"];
	layer33_moe_comm_from_expert4 -> layer33_moe_aggregate	[pos="e,3534.2,21350 3048.8,21431 3048.8,21405 3048.8,21350 3048.8,21350 3048.8,21350 3524.2,21350 3524.2,21350"];
	layer33_moe_comm_from_expert5 -> layer33_moe_aggregate	[pos="e,3550,21365 3270.5,21427 3270.5,21404 3270.5,21365 3270.5,21365 3270.5,21365 3540,21365 3540,21365"];
	layer33_moe_comm_from_expert6 -> layer33_moe_aggregate	[pos="e,3482.1,21329 3482.1,21426 3482.1,21426 3482.1,21339 3482.1,21339"];
	layer33_moe_comm_from_expert7 -> layer33_moe_aggregate	[pos="e,3622,21381 3622,21416 3622,21416 3622,21391 3622,21391"];
	layer33_moe_comm_from_expert8 -> layer33_moe_aggregate	[pos="e,3893.4,21381 3893.4,21416 3893.4,21416 3893.4,21391 3893.4,21391"];
	layer33_moe_comm_from_expert9 -> layer33_moe_aggregate	[pos="e,3969.4,21367 4184.5,21417 4184.5,21394 4184.5,21367 4184.5,21367 4184.5,21367 3979.4,21367 3979.4,21367"];
	layer33_moe_comm_from_expert10 -> layer33_moe_aggregate	[pos="e,3955.8,21354 4516.1,21417 4516.1,21390 4516.1,21354 4516.1,21354 4516.1,21354 3965.8,21354 3965.8,21354"];
	layer33_moe_comm_from_expert11 -> layer33_moe_aggregate	[pos="e,3942.5,21341 4862.6,21417 4862.6,21386 4862.6,21341 4862.6,21341 4862.6,21341 3952.5,21341 3952.5,21341"];
	layer33_moe_comm_from_expert12 -> layer33_moe_aggregate	[pos="e,3928.9,21328 5213.6,21417 5213.6,21382 5213.6,21328 5213.6,21328 5213.6,21328 3938.9,21328 3938.9,21328"];
	layer33_moe_comm_from_expert13 -> layer33_moe_aggregate	[pos="e,3915.5,21315 5567.1,21417 5567.1,21378 5567.1,21315 5567.1,21315 5567.1,21315 3925.5,21315 3925.5,21315"];
	layer33_moe_comm_from_expert14 -> layer33_moe_aggregate	[pos="e,3902.1,21302 5922.1,21417 5922.1,21375 5922.1,21302 5922.1,21302 5922.1,21302 3912.1,21302 3912.1,21302"];
	layer33_moe_comm_from_expert15 -> layer33_moe_aggregate	[pos="e,3888.7,21289 6277.1,21417 6277.1,21372 6277.1,21289 6277.1,21289 6277.1,21289 3898.7,21289 3898.7,21289"];
	layer34_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L34\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3721,21101",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer34_moe_mha -> layer34_moe_gate	[pos="e,3721,21153 3721,21188 3721,21188 3721,21163 3721,21163"];
	layer34_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L34\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3721,20961",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer34_moe_gate -> layer34_moe_split	[pos="e,3721,21013 3721,21048 3721,21048 3721,21023 3721,21023"];
	layer34_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1172,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer34_moe_split -> layer34_moe_comm_to_expert0	[pos="e,1190.5,20872 3555,20997 2992,20997 1190.5,20997 1190.5,20997 1190.5,20997 1190.5,20882 1190.5,20882",
		style=dashed];
	layer34_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1885,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer34_moe_split -> layer34_moe_comm_to_expert1	[pos="e,1903.5,20872 3540.1,20982 3080.4,20982 1903.5,20982 1903.5,20982 1903.5,20982 1903.5,20882 1903.5,20882",
		style=dashed];
	layer34_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2341,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer34_moe_split -> layer34_moe_comm_to_expert2	[pos="e,2359.5,20872 3526.3,20968 3150,20968 2359.5,20968 2359.5,20968 2359.5,20968 2359.5,20882 2359.5,20882",
		style=dashed];
	layer34_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2669,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer34_moe_split -> layer34_moe_comm_to_expert3	[pos="e,2687.5,20872 3511.2,20953 3209.1,20953 2687.5,20953 2687.5,20953 2687.5,20953 2687.5,20882 2687.5,20882",
		style=dashed];
	layer34_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2932,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer34_moe_split -> layer34_moe_comm_to_expert4	[pos="e,2950.5,20872 3496.3,20938 3268.9,20938 2950.5,20938 2950.5,20938 2950.5,20938 2950.5,20882 2950.5,20882",
		style=dashed];
	layer34_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3163,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer34_moe_split -> layer34_moe_comm_to_expert5	[pos="e,3181.5,20872 3481.2,20923 3337.1,20923 3181.5,20923 3181.5,20923 3181.5,20923 3181.5,20882 3181.5,20882",
		style=dashed];
	layer34_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3378,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer34_moe_split -> layer34_moe_comm_to_expert6	[pos="e,3468.8,20843 3481.5,20961 3481.5,20957 3481.5,20843 3481.5,20843 3481.5,20843 3478.8,20843 3478.8,20843",
		style=dashed];
	layer34_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3585,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer34_moe_split -> layer34_moe_comm_to_expert7	[pos="e,3585,20873 3585,20908 3585,20908 3585,20883 3585,20883",
		style=dashed];
	layer34_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3857,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer34_moe_split -> layer34_moe_comm_to_expert8	[pos="e,3857,20873 3857,20908 3857,20908 3857,20883 3857,20883",
		style=dashed];
	layer34_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4166,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer34_moe_split -> layer34_moe_comm_to_expert9	[pos="e,4075.3,20843 3961.3,20961 3961.3,20957 3961.3,20843 3961.3,20843 3961.3,20843 4065.3,20843 4065.3,20843",
		style=dashed];
	layer34_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4498,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer34_moe_split -> layer34_moe_comm_to_expert10	[pos="e,4422.1,20861 3885.8,20923 4093.1,20923 4422.1,20923 4422.1,20923 4422.1,20923 4422.1,20871 4422.1,20871",
		style=dashed];
	layer34_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4844,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer34_moe_split -> layer34_moe_comm_to_expert11	[pos="e,4768.6,20861 3900.5,20938 4199.9,20938 4768.6,20938 4768.6,20938 4768.6,20938 4768.6,20871 4768.6,20871",
		style=dashed];
	layer34_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5195,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer34_moe_split -> layer34_moe_comm_to_expert12	[pos="e,5119.6,20861 3915.5,20953 4299.8,20953 5119.6,20953 5119.6,20953 5119.6,20953 5119.6,20871 5119.6,20871",
		style=dashed];
	layer34_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5548,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer34_moe_split -> layer34_moe_comm_to_expert13	[pos="e,5473.1,20861 3930.6,20968 4395.7,20968 5473.1,20968 5473.1,20968 5473.1,20968 5473.1,20871 5473.1,20871",
		style=dashed];
	layer34_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5903,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer34_moe_split -> layer34_moe_comm_to_expert14	[pos="e,5828.1,20861 3944.5,20982 4486.8,20982 5828.1,20982 5828.1,20982 5828.1,20982 5828.1,20871 5828.1,20871",
		style=dashed];
	layer34_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6258,20844",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer34_moe_split -> layer34_moe_comm_to_expert15	[pos="e,6183.1,20861 3959.6,20997 4577.7,20997 6183.1,20997 6183.1,20997 6183.1,20997 6183.1,20871 6183.1,20871",
		style=dashed];
	layer34_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L34\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1126,20753",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer34_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1172,20662",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer34_moe_expert0 -> layer34_moe_comm_from_expert0	[pos="e,1172,20691 1172,20726 1172,20726 1172,20701 1172,20701"];
	layer34_moe_comm_to_expert0 -> layer34_moe_expert0	[pos="e,1172,20779 1172,20815 1172,20815 1172,20789 1172,20789"];
	layer34_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L34\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1472,20753",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer34_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1885,20662",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer34_moe_expert1 -> layer34_moe_comm_from_expert1	[pos="e,1794.4,20661 1573.2,20727 1573.2,20700 1573.2,20661 1573.2,20661 1573.2,20661 1784.4,20661 1784.4,20661"];
	layer34_moe_comm_to_expert1 -> layer34_moe_expert1	[pos="e,1490.5,20779 1794.5,20843 1678,20843 1490.5,20843 1490.5,20843 1490.5,20843 1490.5,20789 1490.5,20789"];
	layer34_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L34\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1818,20753",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer34_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2341,20662",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer34_moe_expert2 -> layer34_moe_comm_from_expert2	[pos="e,2250.3,20661 1982.2,20743 1989.6,20743 1994,20743 1994,20743 1994,20743 1994,20661 1994,20661 1994,20661 2240.3,20661 2240.3,20661"];
	layer34_moe_comm_to_expert2 -> layer34_moe_expert2	[pos="e,1982.3,20761 2250.1,20843 2145.5,20843 1988,20843 1988,20843 1988,20843 1988,20761 1988,20761 1988,20761 1987.4,20761 1987.4,20761"];
	layer34_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L34\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2164,20753",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer34_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2669,20662",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer34_moe_expert3 -> layer34_moe_comm_from_expert3	[pos="e,2610.3,20684 2289.2,20726 2289.2,20714 2289.2,20702 2289.2,20702 2289.2,20702 2610.3,20702 2610.3,20702 2610.3,20702 2610.3,20694 \
2610.3,20694"];
	layer34_moe_comm_to_expert3 -> layer34_moe_expert3	[pos="e,2289.2,20779 2610.3,20821 2610.3,20811 2610.3,20802 2610.3,20802 2610.3,20802 2289.2,20802 2289.2,20802 2289.2,20802 2289.2,20789 \
2289.2,20789"];
	layer34_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L34\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2510,20753",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer34_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2932,20662",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer34_moe_expert4 -> layer34_moe_comm_from_expert4	[pos="e,2930.7,20691 2642.2,20726 2642.2,20719 2642.2,20714 2642.2,20714 2642.2,20714 2930.7,20714 2930.7,20714 2930.7,20714 2930.7,20701 \
2930.7,20701"];
	layer34_moe_comm_to_expert4 -> layer34_moe_expert4	[pos="e,2642.2,20779 2930.7,20815 2930.7,20802 2930.7,20790 2930.7,20790 2930.7,20790 2642.2,20790 2642.2,20790 2642.2,20790 2642.2,20789 \
2642.2,20789"];
	layer34_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L34\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2856,20753",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer34_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3163,20662",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer34_moe_expert5 -> layer34_moe_comm_from_expert5	[pos="e,3072.2,20661 3020.1,20743 3028.1,20743 3032.8,20743 3032.8,20743 3032.8,20743 3032.8,20661 3032.8,20661 3032.8,20661 3062.2,20661 \
3062.2,20661"];
	layer34_moe_comm_to_expert5 -> layer34_moe_expert5	[pos="e,3020.3,20761 3072.4,20843 3047.7,20843 3027.7,20843 3027.7,20843 3027.7,20843 3027.7,20761 3027.7,20761 3027.7,20761 3026.9,20761 \
3026.9,20761"];
	layer34_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L34\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3202,20753",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer34_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3378,20662",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer34_moe_expert6 -> layer34_moe_comm_from_expert6	[pos="e,3326.7,20686 3326.7,20726 3326.7,20726 3326.7,20696 3326.7,20696"];
	layer34_moe_comm_to_expert6 -> layer34_moe_expert6	[pos="e,3326.7,20779 3326.7,20820 3326.7,20820 3326.7,20789 3326.7,20789"];
	layer34_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L34\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3548,20753",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer34_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3585,20662",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer34_moe_expert7 -> layer34_moe_comm_from_expert7	[pos="e,3585,20691 3585,20726 3585,20726 3585,20701 3585,20701"];
	layer34_moe_comm_to_expert7 -> layer34_moe_expert7	[pos="e,3585,20779 3585,20815 3585,20815 3585,20789 3585,20789"];
	layer34_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L34\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3894,20753",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer34_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3857,20662",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer34_moe_expert8 -> layer34_moe_comm_from_expert8	[pos="e,3857,20691 3857,20726 3857,20726 3857,20701 3857,20701"];
	layer34_moe_comm_to_expert8 -> layer34_moe_expert8	[pos="e,3857,20779 3857,20815 3857,20815 3857,20789 3857,20789"];
	layer34_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L34\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4240,20753",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer34_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4166,20662",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer34_moe_expert9 -> layer34_moe_comm_from_expert9	[pos="e,4166.3,20691 4166.3,20726 4166.3,20726 4166.3,20701 4166.3,20701"];
	layer34_moe_comm_to_expert9 -> layer34_moe_expert9	[pos="e,4166.3,20779 4166.3,20815 4166.3,20815 4166.3,20789 4166.3,20789"];
	layer34_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L34\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4591,20753",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer34_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4498,20662",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer34_moe_expert10 -> layer34_moe_comm_from_expert10	[pos="e,4507.4,20691 4507.4,20726 4507.4,20726 4507.4,20701 4507.4,20701"];
	layer34_moe_comm_to_expert10 -> layer34_moe_expert10	[pos="e,4507,20779 4507,20815 4507,20815 4507,20789 4507,20789"];
	layer34_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L34\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4947,20753",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer34_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4845,20662",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer34_moe_expert11 -> layer34_moe_comm_from_expert11	[pos="e,4858.9,20690 4858.9,20726 4858.9,20726 4858.9,20700 4858.9,20700"];
	layer34_moe_comm_to_expert11 -> layer34_moe_expert11	[pos="e,4858,20779 4858,20815 4858,20815 4858,20789 4858,20789"];
	layer34_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L34\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5303,20753",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer34_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5196,20662",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer34_moe_expert12 -> layer34_moe_comm_from_expert12	[pos="e,5212.4,20690 5212.4,20726 5212.4,20726 5212.4,20700 5212.4,20700"];
	layer34_moe_comm_to_expert12 -> layer34_moe_expert12	[pos="e,5211.5,20779 5211.5,20815 5211.5,20815 5211.5,20789 5211.5,20789"];
	layer34_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L34\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5659,20753",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer34_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5550,20662",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer34_moe_expert13 -> layer34_moe_comm_from_expert13	[pos="e,5567.4,20690 5567.4,20726 5567.4,20726 5567.4,20700 5567.4,20700"];
	layer34_moe_comm_to_expert13 -> layer34_moe_expert13	[pos="e,5566,20779 5566,20815 5566,20815 5566,20789 5566,20789"];
	layer34_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L34\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="6015,20753",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer34_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5905,20662",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer34_moe_expert14 -> layer34_moe_comm_from_expert14	[pos="e,5922.9,20690 5922.9,20726 5922.9,20726 5922.9,20700 5922.9,20700"];
	layer34_moe_comm_to_expert14 -> layer34_moe_expert14	[pos="e,5921.5,20779 5921.5,20815 5921.5,20815 5921.5,20789 5921.5,20789"];
	layer34_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L34\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6371,20753",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer34_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6260,20662",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer34_moe_expert15 -> layer34_moe_comm_from_expert15	[pos="e,6278.4,20690 6278.4,20726 6278.4,20726 6278.4,20700 6278.4,20700"];
	layer34_moe_comm_to_expert15 -> layer34_moe_expert15	[pos="e,6277,20779 6277,20815 6277,20815 6277,20789 6277,20789"];
	layer34_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L34\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3684,20545",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer35_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L35\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3684,20431",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer34_moe_aggregate -> layer35_moe_mha	[pos="e,3684,20457 3684,20492 3684,20492 3684,20467 3684,20467"];
	layer34_moe_comm_from_expert0 -> layer34_moe_aggregate	[pos="e,3436.7,20507 1213.5,20636 1213.5,20592 1213.5,20507 1213.5,20507 1213.5,20507 3426.7,20507 3426.7,20507"];
	layer34_moe_comm_from_expert1 -> layer34_moe_aggregate	[pos="e,3451.9,20522 1969.5,20651 1969.5,20619 1969.5,20522 1969.5,20522 1969.5,20522 3441.9,20522 3441.9,20522"];
	layer34_moe_comm_from_expert2 -> layer34_moe_aggregate	[pos="e,3467.4,20537 2370.3,20634 2370.3,20597 2370.3,20537 2370.3,20537 2370.3,20537 3457.4,20537 3457.4,20537"];
	layer34_moe_comm_from_expert3 -> layer34_moe_aggregate	[pos="e,3482.9,20552 2681.5,20633 2681.5,20600 2681.5,20552 2681.5,20552 2681.5,20552 3472.9,20552 3472.9,20552"];
	layer34_moe_comm_from_expert4 -> layer34_moe_aggregate	[pos="e,3497.4,20566 2986,20638 2986,20610 2986,20566 2986,20566 2986,20566 3487.4,20566 3487.4,20566"];
	layer34_moe_comm_from_expert5 -> layer34_moe_aggregate	[pos="e,3513,20581 3237.5,20645 3237.5,20621 3237.5,20581 3237.5,20581 3237.5,20581 3503,20581 3503,20581"];
	layer34_moe_comm_from_expert6 -> layer34_moe_aggregate	[pos="e,3445.1,20545 3445.1,20642 3445.1,20642 3445.1,20555 3445.1,20555"];
	layer34_moe_comm_from_expert7 -> layer34_moe_aggregate	[pos="e,3585,20597 3585,20632 3585,20632 3585,20607 3585,20607"];
	layer34_moe_comm_from_expert8 -> layer34_moe_aggregate	[pos="e,3856.4,20597 3856.4,20632 3856.4,20632 3856.4,20607 3856.4,20607"];
	layer34_moe_comm_from_expert9 -> layer34_moe_aggregate	[pos="e,3932,20583 4147.5,20633 4147.5,20611 4147.5,20583 4147.5,20583 4147.5,20583 3942,20583 3942,20583"];
	layer34_moe_comm_from_expert10 -> layer34_moe_aggregate	[pos="e,3918.8,20570 4479.1,20633 4479.1,20606 4479.1,20570 4479.1,20570 4479.1,20570 3928.8,20570 3928.8,20570"];
	layer34_moe_comm_from_expert11 -> layer34_moe_aggregate	[pos="e,3905.5,20557 4825.6,20633 4825.6,20602 4825.6,20557 4825.6,20557 4825.6,20557 3915.5,20557 3915.5,20557"];
	layer34_moe_comm_from_expert12 -> layer34_moe_aggregate	[pos="e,3891.9,20544 5176.6,20633 5176.6,20598 5176.6,20544 5176.6,20544 5176.6,20544 3901.9,20544 3901.9,20544"];
	layer34_moe_comm_from_expert13 -> layer34_moe_aggregate	[pos="e,3878.5,20531 5530.1,20633 5530.1,20595 5530.1,20531 5530.1,20531 5530.1,20531 3888.5,20531 3888.5,20531"];
	layer34_moe_comm_from_expert14 -> layer34_moe_aggregate	[pos="e,3865.1,20518 5885.1,20633 5885.1,20591 5885.1,20518 5885.1,20518 5885.1,20518 3875.1,20518 3875.1,20518"];
	layer34_moe_comm_from_expert15 -> layer34_moe_aggregate	[pos="e,3851.7,20505 6240.1,20633 6240.1,20588 6240.1,20505 6240.1,20505 6240.1,20505 3861.7,20505 3861.7,20505"];
	layer35_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L35\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3684,20317",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer35_moe_mha -> layer35_moe_gate	[pos="e,3684,20369 3684,20404 3684,20404 3684,20379 3684,20379"];
	layer35_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L35\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3684,20177",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer35_moe_gate -> layer35_moe_split	[pos="e,3684,20229 3684,20265 3684,20265 3684,20239 3684,20239"];
	layer35_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1255,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer35_moe_split -> layer35_moe_comm_to_expert0	[pos="e,1326.8,20078 3518.2,20213 2981.7,20213 1326.8,20213 1326.8,20213 1326.8,20213 1326.8,20088 1326.8,20088",
		style=dashed];
	layer35_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1601,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer35_moe_split -> layer35_moe_comm_to_expert1	[pos="e,1672.8,20077 3503.3,20198 3009.3,20198 1672.8,20198 1672.8,20198 1672.8,20198 1672.8,20087 1672.8,20087",
		style=dashed];
	layer35_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1873,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer35_moe_split -> layer35_moe_comm_to_expert2	[pos="e,1879,20089 3489.1,20184 3022.4,20184 1879,20184 1879,20184 1879,20184 1879,20099 1879,20099",
		style=dashed];
	layer35_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2201,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer35_moe_split -> layer35_moe_comm_to_expert3	[pos="e,2271,20078 3474,20169 3080.4,20169 2271,20169 2271,20169 2271,20169 2271,20088 2271,20088",
		style=dashed];
	layer35_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2694,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer35_moe_split -> layer35_moe_comm_to_expert4	[pos="e,2772,20074 3459.1,20154 3189.1,20154 2772,20154 2772,20154 2772,20154 2772,20084 2772,20084",
		style=dashed];
	layer35_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3040,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer35_moe_split -> layer35_moe_comm_to_expert5	[pos="e,3101.5,20081 3444.1,20139 3283.6,20139 3101.5,20139 3101.5,20139 3101.5,20139 3101.5,20091 3101.5,20091",
		style=dashed];
	layer35_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3312,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer35_moe_split -> layer35_moe_comm_to_expert6	[pos="e,3402.8,20059 3443.7,20177 3443.7,20173 3443.7,20059 3443.7,20059 3443.7,20059 3412.8,20059 3412.8,20059",
		style=dashed];
	layer35_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3548,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer35_moe_split -> layer35_moe_comm_to_expert7	[pos="e,3548,20089 3548,20124 3548,20124 3548,20099 3548,20099",
		style=dashed];
	layer35_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3820,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer35_moe_split -> layer35_moe_comm_to_expert8	[pos="e,3820,20089 3820,20124 3820,20124 3820,20099 3820,20099",
		style=dashed];
	layer35_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4129,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer35_moe_split -> layer35_moe_comm_to_expert9	[pos="e,4038.3,20059 3924.3,20177 3924.3,20173 3924.3,20059 3924.3,20059 3924.3,20059 4028.3,20059 4028.3,20059",
		style=dashed];
	layer35_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4461,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer35_moe_split -> layer35_moe_comm_to_expert10	[pos="e,4385.1,20077 3848.8,20139 4056.1,20139 4385.1,20139 4385.1,20139 4385.1,20139 4385.1,20087 4385.1,20087",
		style=dashed];
	layer35_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4807,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer35_moe_split -> layer35_moe_comm_to_expert11	[pos="e,4731.6,20077 3863.5,20154 4162.9,20154 4731.6,20154 4731.6,20154 4731.6,20154 4731.6,20087 4731.6,20087",
		style=dashed];
	layer35_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5158,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer35_moe_split -> layer35_moe_comm_to_expert12	[pos="e,5082.6,20077 3878.5,20169 4262.8,20169 5082.6,20169 5082.6,20169 5082.6,20169 5082.6,20087 5082.6,20087",
		style=dashed];
	layer35_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5511,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer35_moe_split -> layer35_moe_comm_to_expert13	[pos="e,5436.1,20077 3893.6,20184 4358.7,20184 5436.1,20184 5436.1,20184 5436.1,20184 5436.1,20087 5436.1,20087",
		style=dashed];
	layer35_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5866,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer35_moe_split -> layer35_moe_comm_to_expert14	[pos="e,5791.1,20077 3907.5,20198 4449.8,20198 5791.1,20198 5791.1,20198 5791.1,20198 5791.1,20087 5791.1,20087",
		style=dashed];
	layer35_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6221,20060",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer35_moe_split -> layer35_moe_comm_to_expert15	[pos="e,6146.1,20077 3922.6,20213 4540.7,20213 6146.1,20213 6146.1,20213 6146.1,20213 6146.1,20087 6146.1,20087",
		style=dashed];
	layer35_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L35\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1089,19969",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer35_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1603,19878",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer35_moe_expert0 -> layer35_moe_comm_from_expert0	[pos="e,1512.3,19877 1243.5,19943 1243.5,19916 1243.5,19877 1243.5,19877 1243.5,19877 1502.3,19877 1502.3,19877"];
	layer35_moe_comm_to_expert0 -> layer35_moe_expert0	[pos="e,1208.7,19995 1208.7,20034 1208.7,20034 1208.7,20005 1208.7,20005"];
	layer35_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L35\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1435,19969",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer35_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1848,19878",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer35_moe_expert1 -> layer35_moe_comm_from_expert1	[pos="e,1848,19907 1555.7,19942 1555.7,19929 1555.7,19915 1555.7,19915 1555.7,19915 1848,19915 1848,19915 1848,19915 1848,19914 1848,19914"];
	layer35_moe_comm_to_expert1 -> layer35_moe_expert1	[pos="e,1554.7,19995 1554.7,20034 1554.7,20034 1554.7,20005 1554.7,20005"];
	layer35_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L35\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1781,19969",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer35_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2304,19878",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer35_moe_expert2 -> layer35_moe_comm_from_expert2	[pos="e,2213.4,19877 1945.2,19968 1950.8,19968 1954,19968 1954,19968 1954,19968 1954,19877 1954,19877 1954,19877 2203.4,19877 2203.4,19877"];
	layer35_moe_comm_to_expert2 -> layer35_moe_expert2	[pos="e,1863.7,19995 1863.7,20031 1863.7,20031 1863.7,20005 1863.7,20005"];
	layer35_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L35\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2127,19969",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer35_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2632,19878",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer35_moe_expert3 -> layer35_moe_comm_from_expert3	[pos="e,2573.3,19900 2252.2,19942 2252.2,19933 2252.2,19924 2252.2,19924 2252.2,19924 2573.3,19924 2573.3,19924 2573.3,19924 2573.3,19910 \
2573.3,19910"];
	layer35_moe_comm_to_expert3 -> layer35_moe_expert3	[pos="e,2200.7,19995 2200.7,20031 2200.7,20031 2200.7,20005 2200.7,20005"];
	layer35_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L35\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2473,19969",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer35_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2895,19878",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer35_moe_expert4 -> layer35_moe_comm_from_expert4	[pos="e,2893.7,19907 2605.2,19942 2605.2,19937 2605.2,19933 2605.2,19933 2605.2,19933 2893.7,19933 2893.7,19933 2893.7,19933 2893.7,19917 \
2893.7,19917"];
	layer35_moe_comm_to_expert4 -> layer35_moe_expert4	[pos="e,2620.2,19995 2620.2,20043 2620.2,20043 2620.2,20005 2620.2,20005"];
	layer35_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L35\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2819,19969",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer35_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3126,19878",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer35_moe_expert5 -> layer35_moe_comm_from_expert5	[pos="e,3035.5,19877 2983.2,19968 2988.8,19968 2992,19968 2992,19968 2992,19968 2992,19877 2992,19877 2992,19877 3025.5,19877 3025.5,19877"];
	layer35_moe_comm_to_expert5 -> layer35_moe_expert5	[pos="e,2966.2,19995 2966.2,20043 2966.2,20043 2966.2,20005 2966.2,20005"];
	layer35_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L35\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3165,19969",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer35_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3341,19878",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer35_moe_expert6 -> layer35_moe_comm_from_expert6	[pos="e,3289.7,19902 3289.7,19942 3289.7,19942 3289.7,19912 3289.7,19912"];
	layer35_moe_comm_to_expert6 -> layer35_moe_expert6	[pos="e,3275.2,19995 3275.2,20033 3275.2,20033 3275.2,20005 3275.2,20005"];
	layer35_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L35\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3511,19969",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer35_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3548,19878",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer35_moe_expert7 -> layer35_moe_comm_from_expert7	[pos="e,3548,19907 3548,19942 3548,19942 3548,19917 3548,19917"];
	layer35_moe_comm_to_expert7 -> layer35_moe_expert7	[pos="e,3548,19995 3548,20031 3548,20031 3548,20005 3548,20005"];
	layer35_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L35\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3857,19969",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer35_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3820,19878",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer35_moe_expert8 -> layer35_moe_comm_from_expert8	[pos="e,3820,19907 3820,19942 3820,19942 3820,19917 3820,19917"];
	layer35_moe_comm_to_expert8 -> layer35_moe_expert8	[pos="e,3820,19995 3820,20031 3820,20031 3820,20005 3820,20005"];
	layer35_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L35\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4203,19969",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer35_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4129,19878",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer35_moe_expert9 -> layer35_moe_comm_from_expert9	[pos="e,4129.3,19907 4129.3,19942 4129.3,19942 4129.3,19917 4129.3,19917"];
	layer35_moe_comm_to_expert9 -> layer35_moe_expert9	[pos="e,4129.3,19995 4129.3,20031 4129.3,20031 4129.3,20005 4129.3,20005"];
	layer35_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L35\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4554,19969",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer35_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4461,19878",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer35_moe_expert10 -> layer35_moe_comm_from_expert10	[pos="e,4470.4,19907 4470.4,19942 4470.4,19942 4470.4,19917 4470.4,19917"];
	layer35_moe_comm_to_expert10 -> layer35_moe_expert10	[pos="e,4470,19995 4470,20031 4470,20031 4470,20005 4470,20005"];
	layer35_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L35\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4910,19969",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer35_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4808,19878",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer35_moe_expert11 -> layer35_moe_comm_from_expert11	[pos="e,4821.9,19906 4821.9,19942 4821.9,19942 4821.9,19916 4821.9,19916"];
	layer35_moe_comm_to_expert11 -> layer35_moe_expert11	[pos="e,4821,19995 4821,20031 4821,20031 4821,20005 4821,20005"];
	layer35_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L35\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5266,19969",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer35_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5159,19878",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer35_moe_expert12 -> layer35_moe_comm_from_expert12	[pos="e,5175.4,19906 5175.4,19942 5175.4,19942 5175.4,19916 5175.4,19916"];
	layer35_moe_comm_to_expert12 -> layer35_moe_expert12	[pos="e,5174.5,19995 5174.5,20031 5174.5,20031 5174.5,20005 5174.5,20005"];
	layer35_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L35\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5622,19969",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer35_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5513,19878",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer35_moe_expert13 -> layer35_moe_comm_from_expert13	[pos="e,5530.4,19906 5530.4,19942 5530.4,19942 5530.4,19916 5530.4,19916"];
	layer35_moe_comm_to_expert13 -> layer35_moe_expert13	[pos="e,5529,19995 5529,20031 5529,20031 5529,20005 5529,20005"];
	layer35_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L35\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5978,19969",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer35_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5868,19878",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer35_moe_expert14 -> layer35_moe_comm_from_expert14	[pos="e,5885.9,19906 5885.9,19942 5885.9,19942 5885.9,19916 5885.9,19916"];
	layer35_moe_comm_to_expert14 -> layer35_moe_expert14	[pos="e,5884.5,19995 5884.5,20031 5884.5,20031 5884.5,20005 5884.5,20005"];
	layer35_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L35\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6334,19969",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer35_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6223,19878",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer35_moe_expert15 -> layer35_moe_comm_from_expert15	[pos="e,6241.4,19906 6241.4,19942 6241.4,19942 6241.4,19916 6241.4,19916"];
	layer35_moe_comm_to_expert15 -> layer35_moe_expert15	[pos="e,6240,19995 6240,20031 6240,20031 6240,20005 6240,20005"];
	layer35_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L35\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3647,19761",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer36_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L36\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3647,19647",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer35_moe_aggregate -> layer36_moe_mha	[pos="e,3647,19673 3647,19708 3647,19708 3647,19683 3647,19683"];
	layer35_moe_comm_from_expert0 -> layer35_moe_aggregate	[pos="e,3399.5,19723 1636.8,19851 1636.8,19806 1636.8,19723 1636.8,19723 1636.8,19723 3389.5,19723 3389.5,19723"];
	layer35_moe_comm_from_expert1 -> layer35_moe_aggregate	[pos="e,3414.9,19738 1932.3,19867 1932.3,19834 1932.3,19738 1932.3,19738 1932.3,19738 3404.9,19738 3404.9,19738"];
	layer35_moe_comm_from_expert2 -> layer35_moe_aggregate	[pos="e,3430.3,19753 2376,19860 2376,19826 2376,19753 2376,19753 2376,19753 3420.3,19753 3420.3,19753"];
	layer35_moe_comm_from_expert3 -> layer35_moe_aggregate	[pos="e,3445.9,19768 2704,19860 2704,19829 2704,19768 2704,19768 2704,19768 3435.9,19768 3435.9,19768"];
	layer35_moe_comm_from_expert4 -> layer35_moe_aggregate	[pos="e,3460.2,19782 2974.8,19864 2974.8,19838 2974.8,19782 2974.8,19782 2974.8,19782 3450.2,19782 3450.2,19782"];
	layer35_moe_comm_from_expert5 -> layer35_moe_aggregate	[pos="e,3475.7,19797 3196.5,19859 3196.5,19836 3196.5,19797 3196.5,19797 3196.5,19797 3465.7,19797 3465.7,19797"];
	layer35_moe_comm_from_expert6 -> layer35_moe_aggregate	[pos="e,3408.1,19761 3408.1,19858 3408.1,19858 3408.1,19771 3408.1,19771"];
	layer35_moe_comm_from_expert7 -> layer35_moe_aggregate	[pos="e,3548,19813 3548,19848 3548,19848 3548,19823 3548,19823"];
	layer35_moe_comm_from_expert8 -> layer35_moe_aggregate	[pos="e,3819.4,19813 3819.4,19848 3819.4,19848 3819.4,19823 3819.4,19823"];
	layer35_moe_comm_from_expert9 -> layer35_moe_aggregate	[pos="e,3895,19799 4110.5,19849 4110.5,19827 4110.5,19799 4110.5,19799 4110.5,19799 3905,19799 3905,19799"];
	layer35_moe_comm_from_expert10 -> layer35_moe_aggregate	[pos="e,3881.8,19786 4442.1,19849 4442.1,19822 4442.1,19786 4442.1,19786 4442.1,19786 3891.8,19786 3891.8,19786"];
	layer35_moe_comm_from_expert11 -> layer35_moe_aggregate	[pos="e,3868.5,19773 4788.6,19849 4788.6,19818 4788.6,19773 4788.6,19773 4788.6,19773 3878.5,19773 3878.5,19773"];
	layer35_moe_comm_from_expert12 -> layer35_moe_aggregate	[pos="e,3854.9,19760 5139.6,19849 5139.6,19814 5139.6,19760 5139.6,19760 5139.6,19760 3864.9,19760 3864.9,19760"];
	layer35_moe_comm_from_expert13 -> layer35_moe_aggregate	[pos="e,3841.5,19747 5493.1,19849 5493.1,19811 5493.1,19747 5493.1,19747 5493.1,19747 3851.5,19747 3851.5,19747"];
	layer35_moe_comm_from_expert14 -> layer35_moe_aggregate	[pos="e,3828.1,19734 5848.1,19849 5848.1,19807 5848.1,19734 5848.1,19734 5848.1,19734 3838.1,19734 3838.1,19734"];
	layer35_moe_comm_from_expert15 -> layer35_moe_aggregate	[pos="e,3814.7,19721 6203.1,19849 6203.1,19804 6203.1,19721 6203.1,19721 6203.1,19721 3824.7,19721 3824.7,19721"];
	layer36_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L36\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3647,19533",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer36_moe_mha -> layer36_moe_gate	[pos="e,3647,19585 3647,19621 3647,19621 3647,19595 3647,19595"];
	layer36_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L36\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3647,19393",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer36_moe_gate -> layer36_moe_split	[pos="e,3647,19445 3647,19481 3647,19481 3647,19455 3647,19455"];
	layer36_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1098,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer36_moe_split -> layer36_moe_comm_to_expert0	[pos="e,1098,19305 3481.2,19429 2915.8,19429 1098,19429 1098,19429 1098,19429 1098,19315 1098,19315",
		style=dashed];
	layer36_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1811,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer36_moe_split -> layer36_moe_comm_to_expert1	[pos="e,1829.5,19304 3466.1,19414 3006.4,19414 1829.5,19414 1829.5,19414 1829.5,19414 1829.5,19314 1829.5,19314",
		style=dashed];
	layer36_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2267,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer36_moe_split -> layer36_moe_comm_to_expert2	[pos="e,2285.5,19304 3451.9,19400 3075.5,19400 2285.5,19400 2285.5,19400 2285.5,19400 2285.5,19314 2285.5,19314",
		style=dashed];
	layer36_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2595,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer36_moe_split -> layer36_moe_comm_to_expert3	[pos="e,2613.5,19304 3437.2,19385 3135.1,19385 2613.5,19385 2613.5,19385 2613.5,19385 2613.5,19314 2613.5,19314",
		style=dashed];
	layer36_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2858,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer36_moe_split -> layer36_moe_comm_to_expert4	[pos="e,2876.5,19304 3422.1,19370 3194.6,19370 2876.5,19370 2876.5,19370 2876.5,19370 2876.5,19314 2876.5,19314",
		style=dashed];
	layer36_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3089,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer36_moe_split -> layer36_moe_comm_to_expert5	[pos="e,3107.5,19304 3407.2,19355 3263.1,19355 3107.5,19355 3107.5,19355 3107.5,19355 3107.5,19314 3107.5,19314",
		style=dashed];
	layer36_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3304,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer36_moe_split -> layer36_moe_comm_to_expert6	[pos="e,3394.8,19275 3407.5,19393 3407.5,19389 3407.5,19275 3407.5,19275 3407.5,19275 3404.8,19275 3404.8,19275",
		style=dashed];
	layer36_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3511,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer36_moe_split -> layer36_moe_comm_to_expert7	[pos="e,3511,19305 3511,19340 3511,19340 3511,19315 3511,19315",
		style=dashed];
	layer36_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3783,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer36_moe_split -> layer36_moe_comm_to_expert8	[pos="e,3783,19305 3783,19340 3783,19340 3783,19315 3783,19315",
		style=dashed];
	layer36_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4092,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer36_moe_split -> layer36_moe_comm_to_expert9	[pos="e,4001.3,19275 3887.3,19393 3887.3,19389 3887.3,19275 3887.3,19275 3887.3,19275 3991.3,19275 3991.3,19275",
		style=dashed];
	layer36_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4424,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer36_moe_split -> layer36_moe_comm_to_expert10	[pos="e,4348.1,19293 3811.8,19355 4019.1,19355 4348.1,19355 4348.1,19355 4348.1,19355 4348.1,19303 4348.1,19303",
		style=dashed];
	layer36_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4770,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer36_moe_split -> layer36_moe_comm_to_expert11	[pos="e,4694.6,19293 3826.5,19370 4125.9,19370 4694.6,19370 4694.6,19370 4694.6,19370 4694.6,19303 4694.6,19303",
		style=dashed];
	layer36_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5121,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer36_moe_split -> layer36_moe_comm_to_expert12	[pos="e,5045.6,19293 3841.5,19385 4225.8,19385 5045.6,19385 5045.6,19385 5045.6,19385 5045.6,19303 5045.6,19303",
		style=dashed];
	layer36_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5474,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer36_moe_split -> layer36_moe_comm_to_expert13	[pos="e,5399.1,19293 3856.6,19400 4321.7,19400 5399.1,19400 5399.1,19400 5399.1,19400 5399.1,19303 5399.1,19303",
		style=dashed];
	layer36_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5829,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer36_moe_split -> layer36_moe_comm_to_expert14	[pos="e,5754.1,19293 3870.5,19414 4412.8,19414 5754.1,19414 5754.1,19414 5754.1,19414 5754.1,19303 5754.1,19303",
		style=dashed];
	layer36_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6184,19276",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer36_moe_split -> layer36_moe_comm_to_expert15	[pos="e,6109.1,19293 3885.6,19429 4503.7,19429 6109.1,19429 6109.1,19429 6109.1,19429 6109.1,19303 6109.1,19303",
		style=dashed];
	layer36_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L36\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1052,19185",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer36_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1566,19094",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer36_moe_expert0 -> layer36_moe_comm_from_expert0	[pos="e,1475.3,19093 1206.5,19159 1206.5,19132 1206.5,19093 1206.5,19093 1206.5,19093 1465.3,19093 1465.3,19093"];
	layer36_moe_comm_to_expert0 -> layer36_moe_expert0	[pos="e,1098,19211 1098,19247 1098,19247 1098,19221 1098,19221"];
	layer36_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L36\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1398,19185",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer36_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1811,19094",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer36_moe_expert1 -> layer36_moe_comm_from_expert1	[pos="e,1811,19123 1518.7,19158 1518.7,19145 1518.7,19131 1518.7,19131 1518.7,19131 1811,19131 1811,19131 1811,19131 1811,19130 1811,19130"];
	layer36_moe_comm_to_expert1 -> layer36_moe_expert1	[pos="e,1537.2,19211 1720.2,19275 1640.5,19275 1537.2,19275 1537.2,19275 1537.2,19275 1537.2,19221 1537.2,19221"];
	layer36_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L36\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1744,19185",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer36_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2267,19094",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer36_moe_expert2 -> layer36_moe_comm_from_expert2	[pos="e,2176.3,19093 1908.2,19176 1915.6,19176 1920,19176 1920,19176 1920,19176 1920,19093 1920,19093 1920,19093 2166.3,19093 2166.3,19093"];
	layer36_moe_comm_to_expert2 -> layer36_moe_expert2	[pos="e,1908.3,19193 2176.1,19275 2071.5,19275 1914,19275 1914,19275 1914,19275 1914,19193 1914,19193 1914,19193 1913.4,19193 1913.4,19193"];
	layer36_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L36\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2090,19185",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer36_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2595,19094",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer36_moe_expert3 -> layer36_moe_comm_from_expert3	[pos="e,2536.3,19116 2215.2,19158 2215.2,19149 2215.2,19140 2215.2,19140 2215.2,19140 2536.3,19140 2536.3,19140 2536.3,19140 2536.3,19126 \
2536.3,19126"];
	layer36_moe_comm_to_expert3 -> layer36_moe_expert3	[pos="e,2215.2,19211 2536.3,19253 2536.3,19243 2536.3,19234 2536.3,19234 2536.3,19234 2215.2,19234 2215.2,19234 2215.2,19234 2215.2,19221 \
2215.2,19221"];
	layer36_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L36\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2436,19185",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer36_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2858,19094",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer36_moe_expert4 -> layer36_moe_comm_from_expert4	[pos="e,2856.7,19123 2568.2,19158 2568.2,19153 2568.2,19149 2568.2,19149 2568.2,19149 2856.7,19149 2856.7,19149 2856.7,19149 2856.7,19133 \
2856.7,19133"];
	layer36_moe_comm_to_expert4 -> layer36_moe_expert4	[pos="e,2568.2,19211 2856.7,19247 2856.7,19234 2856.7,19222 2856.7,19222 2856.7,19222 2568.2,19222 2568.2,19222 2568.2,19222 2568.2,19221 \
2568.2,19221"];
	layer36_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L36\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2782,19185",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer36_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3089,19094",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer36_moe_expert5 -> layer36_moe_comm_from_expert5	[pos="e,2998.5,19093 2946.2,19176 2953.1,19176 2957.2,19176 2957.2,19176 2957.2,19176 2957.2,19093 2957.2,19093 2957.2,19093 2988.5,19093 \
2988.5,19093"];
	layer36_moe_comm_to_expert5 -> layer36_moe_expert5	[pos="e,2946.3,19193 2998.2,19275 2973.2,19275 2952.8,19275 2952.8,19275 2952.8,19275 2952.8,19193 2952.8,19193 2952.8,19193 2952.2,19193 \
2952.2,19193"];
	layer36_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L36\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3128,19185",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer36_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3304,19094",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer36_moe_expert6 -> layer36_moe_comm_from_expert6	[pos="e,3252.7,19118 3252.7,19158 3252.7,19158 3252.7,19128 3252.7,19128"];
	layer36_moe_comm_to_expert6 -> layer36_moe_expert6	[pos="e,3252.7,19211 3252.7,19252 3252.7,19252 3252.7,19221 3252.7,19221"];
	layer36_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L36\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3474,19185",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer36_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3511,19094",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer36_moe_expert7 -> layer36_moe_comm_from_expert7	[pos="e,3511,19123 3511,19158 3511,19158 3511,19133 3511,19133"];
	layer36_moe_comm_to_expert7 -> layer36_moe_expert7	[pos="e,3511,19211 3511,19247 3511,19247 3511,19221 3511,19221"];
	layer36_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L36\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3820,19185",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer36_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3783,19094",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer36_moe_expert8 -> layer36_moe_comm_from_expert8	[pos="e,3783,19123 3783,19158 3783,19158 3783,19133 3783,19133"];
	layer36_moe_comm_to_expert8 -> layer36_moe_expert8	[pos="e,3783,19211 3783,19247 3783,19247 3783,19221 3783,19221"];
	layer36_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L36\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4166,19185",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer36_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4092,19094",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer36_moe_expert9 -> layer36_moe_comm_from_expert9	[pos="e,4092.3,19123 4092.3,19158 4092.3,19158 4092.3,19133 4092.3,19133"];
	layer36_moe_comm_to_expert9 -> layer36_moe_expert9	[pos="e,4092.3,19211 4092.3,19247 4092.3,19247 4092.3,19221 4092.3,19221"];
	layer36_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L36\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4517,19185",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer36_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4424,19094",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer36_moe_expert10 -> layer36_moe_comm_from_expert10	[pos="e,4433.4,19123 4433.4,19158 4433.4,19158 4433.4,19133 4433.4,19133"];
	layer36_moe_comm_to_expert10 -> layer36_moe_expert10	[pos="e,4433,19211 4433,19247 4433,19247 4433,19221 4433,19221"];
	layer36_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L36\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4873,19185",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer36_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4771,19094",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer36_moe_expert11 -> layer36_moe_comm_from_expert11	[pos="e,4784.9,19123 4784.9,19158 4784.9,19158 4784.9,19133 4784.9,19133"];
	layer36_moe_comm_to_expert11 -> layer36_moe_expert11	[pos="e,4784,19211 4784,19247 4784,19247 4784,19221 4784,19221"];
	layer36_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L36\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5229,19185",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer36_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5122,19094",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer36_moe_expert12 -> layer36_moe_comm_from_expert12	[pos="e,5138.4,19123 5138.4,19158 5138.4,19158 5138.4,19133 5138.4,19133"];
	layer36_moe_comm_to_expert12 -> layer36_moe_expert12	[pos="e,5137.5,19211 5137.5,19247 5137.5,19247 5137.5,19221 5137.5,19221"];
	layer36_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L36\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5585,19185",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer36_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5476,19094",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer36_moe_expert13 -> layer36_moe_comm_from_expert13	[pos="e,5493.4,19123 5493.4,19158 5493.4,19158 5493.4,19133 5493.4,19133"];
	layer36_moe_comm_to_expert13 -> layer36_moe_expert13	[pos="e,5492,19211 5492,19247 5492,19247 5492,19221 5492,19221"];
	layer36_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L36\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5941,19185",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer36_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5831,19094",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer36_moe_expert14 -> layer36_moe_comm_from_expert14	[pos="e,5848.9,19122 5848.9,19158 5848.9,19158 5848.9,19132 5848.9,19132"];
	layer36_moe_comm_to_expert14 -> layer36_moe_expert14	[pos="e,5847.5,19211 5847.5,19247 5847.5,19247 5847.5,19221 5847.5,19221"];
	layer36_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L36\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6297,19185",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer36_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6186,19094",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer36_moe_expert15 -> layer36_moe_comm_from_expert15	[pos="e,6204.4,19122 6204.4,19158 6204.4,19158 6204.4,19132 6204.4,19132"];
	layer36_moe_comm_to_expert15 -> layer36_moe_expert15	[pos="e,6203,19211 6203,19247 6203,19247 6203,19221 6203,19221"];
	layer36_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L36\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3610,18977",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer37_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L37\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3610,18863",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer36_moe_aggregate -> layer37_moe_mha	[pos="e,3610,18889 3610,18924 3610,18924 3610,18899 3610,18899"];
	layer36_moe_comm_from_expert0 -> layer36_moe_aggregate	[pos="e,3362.2,18939 1638,19076 1638,19035 1638,18939 1638,18939 1638,18939 3352.2,18939 3352.2,18939"];
	layer36_moe_comm_from_expert1 -> layer36_moe_aggregate	[pos="e,3377.9,18954 1895.3,19083 1895.3,19050 1895.3,18954 1895.3,18954 1895.3,18954 3367.9,18954 3367.9,18954"];
	layer36_moe_comm_from_expert2 -> layer36_moe_aggregate	[pos="e,3393.3,18969 2339,19076 2339,19042 2339,18969 2339,18969 2339,18969 3383.3,18969 3383.3,18969"];
	layer36_moe_comm_from_expert3 -> layer36_moe_aggregate	[pos="e,3408.9,18984 2667,19076 2667,19045 2667,18984 2667,18984 2667,18984 3398.9,18984 3398.9,18984"];
	layer36_moe_comm_from_expert4 -> layer36_moe_aggregate	[pos="e,3423.2,18998 2937.8,19080 2937.8,19054 2937.8,18998 2937.8,18998 2937.8,18998 3413.2,18998 3413.2,18998"];
	layer36_moe_comm_from_expert5 -> layer36_moe_aggregate	[pos="e,3438.7,19013 3159.5,19075 3159.5,19052 3159.5,19013 3159.5,19013 3159.5,19013 3428.7,19013 3428.7,19013"];
	layer36_moe_comm_from_expert6 -> layer36_moe_aggregate	[pos="e,3371.1,18977 3371.1,19074 3371.1,19074 3371.1,18987 3371.1,18987"];
	layer36_moe_comm_from_expert7 -> layer36_moe_aggregate	[pos="e,3511,19029 3511,19064 3511,19064 3511,19039 3511,19039"];
	layer36_moe_comm_from_expert8 -> layer36_moe_aggregate	[pos="e,3782.4,19029 3782.4,19064 3782.4,19064 3782.4,19039 3782.4,19039"];
	layer36_moe_comm_from_expert9 -> layer36_moe_aggregate	[pos="e,3858,19015 4073.5,19065 4073.5,19043 4073.5,19015 4073.5,19015 4073.5,19015 3868,19015 3868,19015"];
	layer36_moe_comm_from_expert10 -> layer36_moe_aggregate	[pos="e,3844.8,19002 4405.1,19065 4405.1,19038 4405.1,19002 4405.1,19002 4405.1,19002 3854.8,19002 3854.8,19002"];
	layer36_moe_comm_from_expert11 -> layer36_moe_aggregate	[pos="e,3831.5,18989 4751.6,19065 4751.6,19034 4751.6,18989 4751.6,18989 4751.6,18989 3841.5,18989 3841.5,18989"];
	layer36_moe_comm_from_expert12 -> layer36_moe_aggregate	[pos="e,3817.9,18976 5102.6,19065 5102.6,19030 5102.6,18976 5102.6,18976 5102.6,18976 3827.9,18976 3827.9,18976"];
	layer36_moe_comm_from_expert13 -> layer36_moe_aggregate	[pos="e,3804.5,18963 5456.1,19065 5456.1,19027 5456.1,18963 5456.1,18963 5456.1,18963 3814.5,18963 3814.5,18963"];
	layer36_moe_comm_from_expert14 -> layer36_moe_aggregate	[pos="e,3791.1,18950 5811.1,19065 5811.1,19023 5811.1,18950 5811.1,18950 5811.1,18950 3801.1,18950 3801.1,18950"];
	layer36_moe_comm_from_expert15 -> layer36_moe_aggregate	[pos="e,3777.7,18937 6166.1,19065 6166.1,19020 6166.1,18937 6166.1,18937 6166.1,18937 3787.7,18937 3787.7,18937"];
	layer37_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L37\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3610,18749",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer37_moe_mha -> layer37_moe_gate	[pos="e,3610,18801 3610,18837 3610,18837 3610,18811 3610,18811"];
	layer37_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L37\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3610,18609",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer37_moe_gate -> layer37_moe_split	[pos="e,3610,18661 3610,18697 3610,18697 3610,18671 3610,18671"];
	layer37_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1529,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer37_moe_split -> layer37_moe_comm_to_expert0	[pos="e,1547.5,18520 3443.8,18645 2953.6,18645 1547.5,18645 1547.5,18645 1547.5,18645 1547.5,18530 1547.5,18530",
		style=dashed];
	layer37_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1774,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer37_moe_split -> layer37_moe_comm_to_expert1	[pos="e,1792.5,18520 3429.1,18630 2969.4,18630 1792.5,18630 1792.5,18630 1792.5,18630 1792.5,18530 1792.5,18530",
		style=dashed];
	layer37_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2230,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer37_moe_split -> layer37_moe_comm_to_expert2	[pos="e,2248.5,18520 3414.9,18616 3038.5,18616 2248.5,18616 2248.5,18616 2248.5,18616 2248.5,18530 2248.5,18530",
		style=dashed];
	layer37_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2558,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer37_moe_split -> layer37_moe_comm_to_expert3	[pos="e,2576.5,18520 3400.2,18601 3098.1,18601 2576.5,18601 2576.5,18601 2576.5,18601 2576.5,18530 2576.5,18530",
		style=dashed];
	layer37_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2821,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer37_moe_split -> layer37_moe_comm_to_expert4	[pos="e,2839.5,18520 3385.1,18586 3157.6,18586 2839.5,18586 2839.5,18586 2839.5,18586 2839.5,18530 2839.5,18530",
		style=dashed];
	layer37_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3052,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer37_moe_split -> layer37_moe_comm_to_expert5	[pos="e,3070.5,18520 3370.2,18571 3226.1,18571 3070.5,18571 3070.5,18571 3070.5,18571 3070.5,18530 3070.5,18530",
		style=dashed];
	layer37_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3267,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer37_moe_split -> layer37_moe_comm_to_expert6	[pos="e,3357.8,18491 3370.5,18609 3370.5,18605 3370.5,18491 3370.5,18491 3370.5,18491 3367.8,18491 3367.8,18491",
		style=dashed];
	layer37_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3474,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer37_moe_split -> layer37_moe_comm_to_expert7	[pos="e,3474,18521 3474,18556 3474,18556 3474,18531 3474,18531",
		style=dashed];
	layer37_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3746,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer37_moe_split -> layer37_moe_comm_to_expert8	[pos="e,3746,18521 3746,18556 3746,18556 3746,18531 3746,18531",
		style=dashed];
	layer37_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4055,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer37_moe_split -> layer37_moe_comm_to_expert9	[pos="e,3964.3,18491 3850.3,18609 3850.3,18605 3850.3,18491 3850.3,18491 3850.3,18491 3954.3,18491 3954.3,18491",
		style=dashed];
	layer37_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4387,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer37_moe_split -> layer37_moe_comm_to_expert10	[pos="e,4311.1,18509 3774.4,18571 3981.6,18571 4311.1,18571 4311.1,18571 4311.1,18571 4311.1,18519 4311.1,18519",
		style=dashed];
	layer37_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4733,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer37_moe_split -> layer37_moe_comm_to_expert11	[pos="e,4657.6,18509 3789.5,18586 4088.9,18586 4657.6,18586 4657.6,18586 4657.6,18586 4657.6,18519 4657.6,18519",
		style=dashed];
	layer37_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5084,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer37_moe_split -> layer37_moe_comm_to_expert12	[pos="e,5008.6,18509 3804.5,18601 4188.8,18601 5008.6,18601 5008.6,18601 5008.6,18601 5008.6,18519 5008.6,18519",
		style=dashed];
	layer37_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5437,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer37_moe_split -> layer37_moe_comm_to_expert13	[pos="e,5362.1,18509 3819.6,18616 4284.7,18616 5362.1,18616 5362.1,18616 5362.1,18616 5362.1,18519 5362.1,18519",
		style=dashed];
	layer37_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5792,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer37_moe_split -> layer37_moe_comm_to_expert14	[pos="e,5717.1,18510 3833.5,18630 4375.8,18630 5717.1,18630 5717.1,18630 5717.1,18630 5717.1,18520 5717.1,18520",
		style=dashed];
	layer37_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6147,18492",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer37_moe_split -> layer37_moe_comm_to_expert15	[pos="e,6072.1,18509 3848.3,18645 4466.2,18645 6072.1,18645 6072.1,18645 6072.1,18645 6072.1,18519 6072.1,18519",
		style=dashed];
	layer37_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L37\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="1015,18401",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer37_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1061,18310",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer37_moe_expert0 -> layer37_moe_comm_from_expert0	[pos="e,1061,18339 1061,18374 1061,18374 1061,18349 1061,18349"];
	layer37_moe_comm_to_expert0 -> layer37_moe_expert0	[pos="e,1033.5,18427 1438.4,18491 1295.4,18491 1033.5,18491 1033.5,18491 1033.5,18491 1033.5,18437 1033.5,18437"];
	layer37_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L37\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1361,18401",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer37_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1774,18310",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer37_moe_expert1 -> layer37_moe_comm_from_expert1	[pos="e,1683.2,18309 1515.5,18375 1515.5,18348 1515.5,18309 1515.5,18309 1515.5,18309 1673.2,18309 1673.2,18309"];
	layer37_moe_comm_to_expert1 -> layer37_moe_expert1	[pos="e,1481.7,18427 1774,18463 1774,18449 1774,18435 1774,18435 1774,18435 1481.7,18435 1481.7,18435 1481.7,18435 1481.7,18434 1481.7,\
18434"];
	layer37_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L37\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1707,18401",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer37_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2230,18310",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer37_moe_expert2 -> layer37_moe_comm_from_expert2	[pos="e,2139.3,18309 1871.2,18392 1878.6,18392 1883,18392 1883,18392 1883,18392 1883,18309 1883,18309 1883,18309 2129.3,18309 2129.3,18309"];
	layer37_moe_comm_to_expert2 -> layer37_moe_expert2	[pos="e,1871.3,18409 2139.1,18491 2034.5,18491 1877,18491 1877,18491 1877,18491 1877,18409 1877,18409 1877,18409 1876.4,18409 1876.4,18409"];
	layer37_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L37\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2053,18401",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer37_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2558,18310",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer37_moe_expert3 -> layer37_moe_comm_from_expert3	[pos="e,2499.3,18332 2178.2,18374 2178.2,18362 2178.2,18350 2178.2,18350 2178.2,18350 2499.3,18350 2499.3,18350 2499.3,18350 2499.3,18342 \
2499.3,18342"];
	layer37_moe_comm_to_expert3 -> layer37_moe_expert3	[pos="e,2178.2,18427 2499.3,18469 2499.3,18461 2499.3,18453 2499.3,18453 2499.3,18453 2178.2,18453 2178.2,18453 2178.2,18453 2178.2,18437 \
2178.2,18437"];
	layer37_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L37\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2399,18401",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer37_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2821,18310",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer37_moe_expert4 -> layer37_moe_comm_from_expert4	[pos="e,2819.7,18339 2531.2,18375 2531.2,18368 2531.2,18362 2531.2,18362 2531.2,18362 2819.7,18362 2819.7,18362 2819.7,18362 2819.7,18349 \
2819.7,18349"];
	layer37_moe_comm_to_expert4 -> layer37_moe_expert4	[pos="e,2531.2,18427 2819.7,18463 2819.7,18453 2819.7,18444 2819.7,18444 2819.7,18444 2531.2,18444 2531.2,18444 2531.2,18444 2531.2,18437 \
2531.2,18437"];
	layer37_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L37\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2745,18401",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer37_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3052,18310",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer37_moe_expert5 -> layer37_moe_comm_from_expert5	[pos="e,2961.5,18309 2909.2,18392 2916.1,18392 2920.2,18392 2920.2,18392 2920.2,18392 2920.2,18309 2920.2,18309 2920.2,18309 2951.5,18309 \
2951.5,18309"];
	layer37_moe_comm_to_expert5 -> layer37_moe_expert5	[pos="e,2909.3,18409 2961.2,18491 2936.2,18491 2915.8,18491 2915.8,18491 2915.8,18491 2915.8,18409 2915.8,18409 2915.8,18409 2915.2,18409 \
2915.2,18409"];
	layer37_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L37\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3091,18401",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer37_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3267,18310",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer37_moe_expert6 -> layer37_moe_comm_from_expert6	[pos="e,3215.7,18334 3215.7,18374 3215.7,18374 3215.7,18344 3215.7,18344"];
	layer37_moe_comm_to_expert6 -> layer37_moe_expert6	[pos="e,3215.7,18427 3215.7,18468 3215.7,18468 3215.7,18437 3215.7,18437"];
	layer37_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L37\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3437,18401",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer37_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3474,18310",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer37_moe_expert7 -> layer37_moe_comm_from_expert7	[pos="e,3474,18339 3474,18374 3474,18374 3474,18349 3474,18349"];
	layer37_moe_comm_to_expert7 -> layer37_moe_expert7	[pos="e,3474,18427 3474,18463 3474,18463 3474,18437 3474,18437"];
	layer37_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L37\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3783,18401",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer37_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3746,18310",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer37_moe_expert8 -> layer37_moe_comm_from_expert8	[pos="e,3746,18339 3746,18374 3746,18374 3746,18349 3746,18349"];
	layer37_moe_comm_to_expert8 -> layer37_moe_expert8	[pos="e,3746,18427 3746,18463 3746,18463 3746,18437 3746,18437"];
	layer37_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L37\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4129,18401",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer37_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4055,18310",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer37_moe_expert9 -> layer37_moe_comm_from_expert9	[pos="e,4055.3,18339 4055.3,18374 4055.3,18374 4055.3,18349 4055.3,18349"];
	layer37_moe_comm_to_expert9 -> layer37_moe_expert9	[pos="e,4055.3,18427 4055.3,18463 4055.3,18463 4055.3,18437 4055.3,18437"];
	layer37_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L37\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4480,18401",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer37_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4387,18310",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer37_moe_expert10 -> layer37_moe_comm_from_expert10	[pos="e,4396.4,18339 4396.4,18374 4396.4,18374 4396.4,18349 4396.4,18349"];
	layer37_moe_comm_to_expert10 -> layer37_moe_expert10	[pos="e,4396,18427 4396,18463 4396,18463 4396,18437 4396,18437"];
	layer37_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L37\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4836,18401",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer37_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4734,18310",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer37_moe_expert11 -> layer37_moe_comm_from_expert11	[pos="e,4747.9,18339 4747.9,18374 4747.9,18374 4747.9,18349 4747.9,18349"];
	layer37_moe_comm_to_expert11 -> layer37_moe_expert11	[pos="e,4747,18427 4747,18463 4747,18463 4747,18437 4747,18437"];
	layer37_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L37\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5192,18401",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer37_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5085,18310",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer37_moe_expert12 -> layer37_moe_comm_from_expert12	[pos="e,5101.4,18339 5101.4,18374 5101.4,18374 5101.4,18349 5101.4,18349"];
	layer37_moe_comm_to_expert12 -> layer37_moe_expert12	[pos="e,5100.5,18427 5100.5,18463 5100.5,18463 5100.5,18437 5100.5,18437"];
	layer37_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L37\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5548,18401",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer37_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5439,18310",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer37_moe_expert13 -> layer37_moe_comm_from_expert13	[pos="e,5456.4,18339 5456.4,18374 5456.4,18374 5456.4,18349 5456.4,18349"];
	layer37_moe_comm_to_expert13 -> layer37_moe_expert13	[pos="e,5455,18427 5455,18463 5455,18463 5455,18437 5455,18437"];
	layer37_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L37\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5904,18401",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer37_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5794,18310",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer37_moe_expert14 -> layer37_moe_comm_from_expert14	[pos="e,5811.9,18338 5811.9,18374 5811.9,18374 5811.9,18348 5811.9,18348"];
	layer37_moe_comm_to_expert14 -> layer37_moe_expert14	[pos="e,5810.5,18427 5810.5,18463 5810.5,18463 5810.5,18437 5810.5,18437"];
	layer37_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L37\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6260,18401",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer37_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6149,18310",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer37_moe_expert15 -> layer37_moe_comm_from_expert15	[pos="e,6167.4,18338 6167.4,18374 6167.4,18374 6167.4,18348 6167.4,18348"];
	layer37_moe_comm_to_expert15 -> layer37_moe_expert15	[pos="e,6166,18427 6166,18463 6166,18463 6166,18437 6166,18437"];
	layer37_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L37\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3573,18193",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer38_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L38\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3573,18079",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer37_moe_aggregate -> layer38_moe_mha	[pos="e,3573,18105 3573,18140 3573,18140 3573,18115 3573,18115"];
	layer37_moe_comm_from_expert0 -> layer37_moe_aggregate	[pos="e,3325.6,18155 1146.8,18300 1146.8,18266 1146.8,18155 1146.8,18155 1146.8,18155 3315.6,18155 3315.6,18155"];
	layer37_moe_comm_from_expert1 -> layer37_moe_aggregate	[pos="e,3340.9,18170 1858.3,18299 1858.3,18266 1858.3,18170 1858.3,18170 1858.3,18170 3330.9,18170 3330.9,18170"];
	layer37_moe_comm_from_expert2 -> layer37_moe_aggregate	[pos="e,3356.3,18185 2302,18292 2302,18258 2302,18185 2302,18185 2302,18185 3346.3,18185 3346.3,18185"];
	layer37_moe_comm_from_expert3 -> layer37_moe_aggregate	[pos="e,3371.9,18200 2630,18292 2630,18261 2630,18200 2630,18200 2630,18200 3361.9,18200 3361.9,18200"];
	layer37_moe_comm_from_expert4 -> layer37_moe_aggregate	[pos="e,3387.1,18215 2900.8,18296 2900.8,18269 2900.8,18215 2900.8,18215 2900.8,18215 3377.1,18215 3377.1,18215"];
	layer37_moe_comm_from_expert5 -> layer37_moe_aggregate	[pos="e,3401.7,18229 3122.5,18291 3122.5,18268 3122.5,18229 3122.5,18229 3122.5,18229 3391.7,18229 3391.7,18229"];
	layer37_moe_comm_from_expert6 -> layer37_moe_aggregate	[pos="e,3334.1,18193 3334.1,18290 3334.1,18290 3334.1,18203 3334.1,18203"];
	layer37_moe_comm_from_expert7 -> layer37_moe_aggregate	[pos="e,3474,18245 3474,18281 3474,18281 3474,18255 3474,18255"];
	layer37_moe_comm_from_expert8 -> layer37_moe_aggregate	[pos="e,3745.4,18245 3745.4,18281 3745.4,18281 3745.4,18255 3745.4,18255"];
	layer37_moe_comm_from_expert9 -> layer37_moe_aggregate	[pos="e,3821,18231 4036.5,18281 4036.5,18259 4036.5,18231 4036.5,18231 4036.5,18231 3831,18231 3831,18231"];
	layer37_moe_comm_from_expert10 -> layer37_moe_aggregate	[pos="e,3807.5,18218 4368.1,18281 4368.1,18254 4368.1,18218 4368.1,18218 4368.1,18218 3817.5,18218 3817.5,18218"];
	layer37_moe_comm_from_expert11 -> layer37_moe_aggregate	[pos="e,3794.1,18205 4714.6,18281 4714.6,18250 4714.6,18205 4714.6,18205 4714.6,18205 3804.1,18205 3804.1,18205"];
	layer37_moe_comm_from_expert12 -> layer37_moe_aggregate	[pos="e,3780.9,18192 5065.6,18281 5065.6,18246 5065.6,18192 5065.6,18192 5065.6,18192 3790.9,18192 3790.9,18192"];
	layer37_moe_comm_from_expert13 -> layer37_moe_aggregate	[pos="e,3767.5,18179 5419.1,18281 5419.1,18243 5419.1,18179 5419.1,18179 5419.1,18179 3777.5,18179 3777.5,18179"];
	layer37_moe_comm_from_expert14 -> layer37_moe_aggregate	[pos="e,3754.1,18166 5774.1,18281 5774.1,18239 5774.1,18166 5774.1,18166 5774.1,18166 3764.1,18166 3764.1,18166"];
	layer37_moe_comm_from_expert15 -> layer37_moe_aggregate	[pos="e,3740.7,18153 6129.1,18281 6129.1,18236 6129.1,18153 6129.1,18153 6129.1,18153 3750.7,18153 3750.7,18153"];
	layer38_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L38\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3573,17965",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer38_moe_mha -> layer38_moe_gate	[pos="e,3573,18017 3573,18053 3573,18053 3573,18027 3573,18027"];
	layer38_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L38\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3573,17825",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer38_moe_gate -> layer38_moe_split	[pos="e,3573,17877 3573,17913 3573,17913 3573,17887 3573,17887"];
	layer38_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1024,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer38_moe_split -> layer38_moe_comm_to_expert0	[pos="e,1042.5,17736 3407,17861 2844,17861 1042.5,17861 1042.5,17861 1042.5,17861 1042.5,17746 1042.5,17746",
		style=dashed];
	layer38_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1737,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer38_moe_split -> layer38_moe_comm_to_expert1	[pos="e,1755.5,17736 3392.9,17847 2933.8,17847 1755.5,17847 1755.5,17847 1755.5,17847 1755.5,17746 1755.5,17746",
		style=dashed];
	layer38_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2193,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer38_moe_split -> layer38_moe_comm_to_expert2	[pos="e,2211.5,17736 3377.9,17832 3001.5,17832 2211.5,17832 2211.5,17832 2211.5,17832 2211.5,17746 2211.5,17746",
		style=dashed];
	layer38_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2521,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer38_moe_split -> layer38_moe_comm_to_expert3	[pos="e,2539.5,17736 3362.9,17817 3060.8,17817 2539.5,17817 2539.5,17817 2539.5,17817 2539.5,17746 2539.5,17746",
		style=dashed];
	layer38_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2784,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer38_moe_split -> layer38_moe_comm_to_expert4	[pos="e,2802.5,17736 3348.1,17802 3120.6,17802 2802.5,17802 2802.5,17802 2802.5,17802 2802.5,17746 2802.5,17746",
		style=dashed];
	layer38_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="3015,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer38_moe_split -> layer38_moe_comm_to_expert5	[pos="e,3033.5,17736 3333.2,17787 3189.1,17787 3033.5,17787 3033.5,17787 3033.5,17787 3033.5,17746 3033.5,17746",
		style=dashed];
	layer38_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3230,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer38_moe_split -> layer38_moe_comm_to_expert6	[pos="e,3320.8,17707 3333.5,17825 3333.5,17821 3333.5,17707 3333.5,17707 3333.5,17707 3330.8,17707 3330.8,17707",
		style=dashed];
	layer38_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3437,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer38_moe_split -> layer38_moe_comm_to_expert7	[pos="e,3437,17737 3437,17772 3437,17772 3437,17747 3437,17747",
		style=dashed];
	layer38_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3709,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer38_moe_split -> layer38_moe_comm_to_expert8	[pos="e,3709,17737 3709,17772 3709,17772 3709,17747 3709,17747",
		style=dashed];
	layer38_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="4018,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer38_moe_split -> layer38_moe_comm_to_expert9	[pos="e,3927.3,17707 3813.3,17825 3813.3,17821 3813.3,17707 3813.3,17707 3813.3,17707 3917.3,17707 3917.3,17707",
		style=dashed];
	layer38_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4350,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer38_moe_split -> layer38_moe_comm_to_expert10	[pos="e,4274.1,17725 3737.4,17787 3944.6,17787 4274.1,17787 4274.1,17787 4274.1,17787 4274.1,17735 4274.1,17735",
		style=dashed];
	layer38_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4696,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer38_moe_split -> layer38_moe_comm_to_expert11	[pos="e,4620.6,17725 3752.5,17802 4051.9,17802 4620.6,17802 4620.6,17802 4620.6,17802 4620.6,17735 4620.6,17735",
		style=dashed];
	layer38_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5047,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer38_moe_split -> layer38_moe_comm_to_expert12	[pos="e,4971.6,17725 3767.5,17817 4151.8,17817 4971.6,17817 4971.6,17817 4971.6,17817 4971.6,17735 4971.6,17735",
		style=dashed];
	layer38_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5400,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer38_moe_split -> layer38_moe_comm_to_expert13	[pos="e,5325.1,17725 3782.6,17832 4247.7,17832 5325.1,17832 5325.1,17832 5325.1,17832 5325.1,17735 5325.1,17735",
		style=dashed];
	layer38_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5755,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer38_moe_split -> layer38_moe_comm_to_expert14	[pos="e,5680.1,17725 3797.5,17847 4340.4,17847 5680.1,17847 5680.1,17847 5680.1,17847 5680.1,17735 5680.1,17735",
		style=dashed];
	layer38_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6110,17708",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer38_moe_split -> layer38_moe_comm_to_expert15	[pos="e,6035.1,17725 3811.3,17861 4429.2,17861 6035.1,17861 6035.1,17861 6035.1,17861 6035.1,17735 6035.1,17735",
		style=dashed];
	layer38_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L38\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="978,17617",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer38_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1024,17526",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer38_moe_expert0 -> layer38_moe_comm_from_expert0	[pos="e,1024,17555 1024,17590 1024,17590 1024,17565 1024,17565"];
	layer38_moe_comm_to_expert0 -> layer38_moe_expert0	[pos="e,1024,17643 1024,17679 1024,17679 1024,17653 1024,17653"];
	layer38_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L38\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1324,17617",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer38_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1737,17526",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer38_moe_expert1 -> layer38_moe_comm_from_expert1	[pos="e,1646.2,17525 1478.5,17591 1478.5,17564 1478.5,17525 1478.5,17525 1478.5,17525 1636.2,17525 1636.2,17525"];
	layer38_moe_comm_to_expert1 -> layer38_moe_expert1	[pos="e,1342.5,17643 1646.5,17707 1530,17707 1342.5,17707 1342.5,17707 1342.5,17707 1342.5,17653 1342.5,17653"];
	layer38_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L38\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1670,17617",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer38_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2193,17526",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer38_moe_expert2 -> layer38_moe_comm_from_expert2	[pos="e,2102.3,17525 1834.2,17608 1841.6,17608 1846,17608 1846,17608 1846,17608 1846,17525 1846,17525 1846,17525 2092.3,17525 2092.3,17525"];
	layer38_moe_comm_to_expert2 -> layer38_moe_expert2	[pos="e,1834.3,17625 2102.1,17707 1997.5,17707 1840,17707 1840,17707 1840,17707 1840,17625 1840,17625 1840,17625 1839.4,17625 1839.4,17625"];
	layer38_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L38\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="2016,17617",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer38_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2521,17526",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer38_moe_expert3 -> layer38_moe_comm_from_expert3	[pos="e,2462.3,17548 2141.2,17590 2141.2,17578 2141.2,17566 2141.2,17566 2141.2,17566 2462.3,17566 2462.3,17566 2462.3,17566 2462.3,17558 \
2462.3,17558"];
	layer38_moe_comm_to_expert3 -> layer38_moe_expert3	[pos="e,2141.2,17643 2462.3,17685 2462.3,17675 2462.3,17666 2462.3,17666 2462.3,17666 2141.2,17666 2141.2,17666 2141.2,17666 2141.2,17653 \
2141.2,17653"];
	layer38_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L38\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2362,17617",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer38_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2784,17526",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer38_moe_expert4 -> layer38_moe_comm_from_expert4	[pos="e,2782.7,17555 2494.2,17591 2494.2,17584 2494.2,17578 2494.2,17578 2494.2,17578 2782.7,17578 2782.7,17578 2782.7,17578 2782.7,17565 \
2782.7,17565"];
	layer38_moe_comm_to_expert4 -> layer38_moe_expert4	[pos="e,2494.2,17643 2782.7,17679 2782.7,17666 2782.7,17654 2782.7,17654 2782.7,17654 2494.2,17654 2494.2,17654 2494.2,17654 2494.2,17653 \
2494.2,17653"];
	layer38_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L38\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2708,17617",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer38_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="3015,17526",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer38_moe_expert5 -> layer38_moe_comm_from_expert5	[pos="e,2924.5,17525 2872.2,17608 2879.1,17608 2883.2,17608 2883.2,17608 2883.2,17608 2883.2,17525 2883.2,17525 2883.2,17525 2914.5,17525 \
2914.5,17525"];
	layer38_moe_comm_to_expert5 -> layer38_moe_expert5	[pos="e,2872.3,17625 2924.2,17707 2899.2,17707 2878.8,17707 2878.8,17707 2878.8,17707 2878.8,17625 2878.8,17625 2878.8,17625 2878.2,17625 \
2878.2,17625"];
	layer38_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L38\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3054,17617",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer38_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3230,17526",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer38_moe_expert6 -> layer38_moe_comm_from_expert6	[pos="e,3178.7,17550 3178.7,17590 3178.7,17590 3178.7,17560 3178.7,17560"];
	layer38_moe_comm_to_expert6 -> layer38_moe_expert6	[pos="e,3178.7,17643 3178.7,17684 3178.7,17684 3178.7,17653 3178.7,17653"];
	layer38_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L38\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3400,17617",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer38_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3437,17526",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer38_moe_expert7 -> layer38_moe_comm_from_expert7	[pos="e,3437,17555 3437,17590 3437,17590 3437,17565 3437,17565"];
	layer38_moe_comm_to_expert7 -> layer38_moe_expert7	[pos="e,3437,17643 3437,17679 3437,17679 3437,17653 3437,17653"];
	layer38_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L38\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3746,17617",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer38_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3709,17526",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer38_moe_expert8 -> layer38_moe_comm_from_expert8	[pos="e,3709,17555 3709,17590 3709,17590 3709,17565 3709,17565"];
	layer38_moe_comm_to_expert8 -> layer38_moe_expert8	[pos="e,3709,17643 3709,17679 3709,17679 3709,17653 3709,17653"];
	layer38_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L38\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4092,17617",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer38_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="4018,17526",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer38_moe_expert9 -> layer38_moe_comm_from_expert9	[pos="e,4018.3,17555 4018.3,17590 4018.3,17590 4018.3,17565 4018.3,17565"];
	layer38_moe_comm_to_expert9 -> layer38_moe_expert9	[pos="e,4018.3,17643 4018.3,17679 4018.3,17679 4018.3,17653 4018.3,17653"];
	layer38_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L38\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4443,17617",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer38_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4350,17526",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer38_moe_expert10 -> layer38_moe_comm_from_expert10	[pos="e,4359.4,17555 4359.4,17590 4359.4,17590 4359.4,17565 4359.4,17565"];
	layer38_moe_comm_to_expert10 -> layer38_moe_expert10	[pos="e,4359,17643 4359,17679 4359,17679 4359,17653 4359,17653"];
	layer38_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L38\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4799,17617",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer38_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4697,17526",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer38_moe_expert11 -> layer38_moe_comm_from_expert11	[pos="e,4710.9,17555 4710.9,17590 4710.9,17590 4710.9,17565 4710.9,17565"];
	layer38_moe_comm_to_expert11 -> layer38_moe_expert11	[pos="e,4710,17643 4710,17679 4710,17679 4710,17653 4710,17653"];
	layer38_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L38\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5155,17617",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer38_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5048,17526",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer38_moe_expert12 -> layer38_moe_comm_from_expert12	[pos="e,5064.4,17555 5064.4,17590 5064.4,17590 5064.4,17565 5064.4,17565"];
	layer38_moe_comm_to_expert12 -> layer38_moe_expert12	[pos="e,5063.5,17643 5063.5,17679 5063.5,17679 5063.5,17653 5063.5,17653"];
	layer38_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L38\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5511,17617",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer38_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5402,17526",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer38_moe_expert13 -> layer38_moe_comm_from_expert13	[pos="e,5419.4,17555 5419.4,17590 5419.4,17590 5419.4,17565 5419.4,17565"];
	layer38_moe_comm_to_expert13 -> layer38_moe_expert13	[pos="e,5418,17643 5418,17679 5418,17679 5418,17653 5418,17653"];
	layer38_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L38\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5867,17617",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer38_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5757,17526",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer38_moe_expert14 -> layer38_moe_comm_from_expert14	[pos="e,5774.9,17554 5774.9,17590 5774.9,17590 5774.9,17564 5774.9,17564"];
	layer38_moe_comm_to_expert14 -> layer38_moe_expert14	[pos="e,5773.5,17643 5773.5,17679 5773.5,17679 5773.5,17653 5773.5,17653"];
	layer38_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L38\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6223,17617",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer38_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6112,17526",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer38_moe_expert15 -> layer38_moe_comm_from_expert15	[pos="e,6130.4,17554 6130.4,17590 6130.4,17590 6130.4,17564 6130.4,17564"];
	layer38_moe_comm_to_expert15 -> layer38_moe_expert15	[pos="e,6129,17643 6129,17679 6129,17679 6129,17653 6129,17653"];
	layer38_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L38\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3536,17409",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer39_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L39\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3536,17295",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer38_moe_aggregate -> layer39_moe_mha	[pos="e,3536,17321 3536,17356 3536,17356 3536,17331 3536,17331"];
	layer38_moe_comm_from_expert0 -> layer38_moe_aggregate	[pos="e,3288.3,17371 1109.8,17516 1109.8,17482 1109.8,17371 1109.8,17371 1109.8,17371 3278.3,17371 3278.3,17371"];
	layer38_moe_comm_from_expert1 -> layer38_moe_aggregate	[pos="e,3303.9,17386 1821.3,17515 1821.3,17482 1821.3,17386 1821.3,17386 1821.3,17386 3293.9,17386 3293.9,17386"];
	layer38_moe_comm_from_expert2 -> layer38_moe_aggregate	[pos="e,3319.3,17401 2265,17508 2265,17474 2265,17401 2265,17401 2265,17401 3309.3,17401 3309.3,17401"];
	layer38_moe_comm_from_expert3 -> layer38_moe_aggregate	[pos="e,3334.9,17416 2593,17508 2593,17477 2593,17416 2593,17416 2593,17416 3324.9,17416 3324.9,17416"];
	layer38_moe_comm_from_expert4 -> layer38_moe_aggregate	[pos="e,3350.1,17431 2863.8,17512 2863.8,17485 2863.8,17431 2863.8,17431 2863.8,17431 3340.1,17431 3340.1,17431"];
	layer38_moe_comm_from_expert5 -> layer38_moe_aggregate	[pos="e,3364.7,17445 3085.5,17507 3085.5,17484 3085.5,17445 3085.5,17445 3085.5,17445 3354.7,17445 3354.7,17445"];
	layer38_moe_comm_from_expert6 -> layer38_moe_aggregate	[pos="e,3297.1,17409 3297.1,17506 3297.1,17506 3297.1,17419 3297.1,17419"];
	layer38_moe_comm_from_expert7 -> layer38_moe_aggregate	[pos="e,3437,17461 3437,17497 3437,17497 3437,17471 3437,17471"];
	layer38_moe_comm_from_expert8 -> layer38_moe_aggregate	[pos="e,3708.4,17461 3708.4,17497 3708.4,17497 3708.4,17471 3708.4,17471"];
	layer38_moe_comm_from_expert9 -> layer38_moe_aggregate	[pos="e,3784,17447 3999.5,17497 3999.5,17475 3999.5,17447 3999.5,17447 3999.5,17447 3794,17447 3794,17447"];
	layer38_moe_comm_from_expert10 -> layer38_moe_aggregate	[pos="e,3770.5,17434 4331.1,17497 4331.1,17470 4331.1,17434 4331.1,17434 4331.1,17434 3780.5,17434 3780.5,17434"];
	layer38_moe_comm_from_expert11 -> layer38_moe_aggregate	[pos="e,3757.1,17421 4677.6,17497 4677.6,17466 4677.6,17421 4677.6,17421 4677.6,17421 3767.1,17421 3767.1,17421"];
	layer38_moe_comm_from_expert12 -> layer38_moe_aggregate	[pos="e,3743.9,17408 5028.6,17497 5028.6,17462 5028.6,17408 5028.6,17408 5028.6,17408 3753.9,17408 3753.9,17408"];
	layer38_moe_comm_from_expert13 -> layer38_moe_aggregate	[pos="e,3730.5,17395 5382.1,17497 5382.1,17459 5382.1,17395 5382.1,17395 5382.1,17395 3740.5,17395 3740.5,17395"];
	layer38_moe_comm_from_expert14 -> layer38_moe_aggregate	[pos="e,3717.1,17382 5737.1,17497 5737.1,17455 5737.1,17382 5737.1,17382 5737.1,17382 3727.1,17382 3727.1,17382"];
	layer38_moe_comm_from_expert15 -> layer38_moe_aggregate	[pos="e,3703.7,17369 6092.1,17497 6092.1,17452 6092.1,17369 6092.1,17369 6092.1,17369 3713.7,17369 3713.7,17369"];
	layer39_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L39\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3536,17181",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer39_moe_mha -> layer39_moe_gate	[pos="e,3536,17233 3536,17269 3536,17269 3536,17243 3536,17243"];
	layer39_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L39\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3536,17041",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer39_moe_gate -> layer39_moe_split	[pos="e,3536,17093 3536,17129 3536,17129 3536,17103 3536,17103"];
	layer39_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="987,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer39_moe_split -> layer39_moe_comm_to_expert0	[pos="e,1005.5,16952 3370,17077 2807,17077 1005.5,17077 1005.5,17077 1005.5,17077 1005.5,16962 1005.5,16962",
		style=dashed];
	layer39_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1700,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer39_moe_split -> layer39_moe_comm_to_expert1	[pos="e,1718.5,16952 3355.9,17063 2896.8,17063 1718.5,17063 1718.5,17063 1718.5,17063 1718.5,16962 1718.5,16962",
		style=dashed];
	layer39_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2156,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer39_moe_split -> layer39_moe_comm_to_expert2	[pos="e,2174.5,16952 3340.9,17048 2964.5,17048 2174.5,17048 2174.5,17048 2174.5,17048 2174.5,16962 2174.5,16962",
		style=dashed];
	layer39_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2484,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer39_moe_split -> layer39_moe_comm_to_expert3	[pos="e,2502.5,16952 3325.9,17033 3023.8,17033 2502.5,17033 2502.5,17033 2502.5,17033 2502.5,16962 2502.5,16962",
		style=dashed];
	layer39_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2747,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer39_moe_split -> layer39_moe_comm_to_expert4	[pos="e,2765.5,16952 3311.1,17018 3083.6,17018 2765.5,17018 2765.5,17018 2765.5,17018 2765.5,16962 2765.5,16962",
		style=dashed];
	layer39_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2978,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer39_moe_split -> layer39_moe_comm_to_expert5	[pos="e,2996.5,16952 3295.8,17003 3151.9,17003 2996.5,17003 2996.5,17003 2996.5,17003 2996.5,16962 2996.5,16962",
		style=dashed];
	layer39_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3193,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer39_moe_split -> layer39_moe_comm_to_expert6	[pos="e,3283.8,16923 3296.5,17041 3296.5,17037 3296.5,16923 3296.5,16923 3296.5,16923 3293.8,16923 3293.8,16923",
		style=dashed];
	layer39_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3400,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer39_moe_split -> layer39_moe_comm_to_expert7	[pos="e,3400,16953 3400,16988 3400,16988 3400,16963 3400,16963",
		style=dashed];
	layer39_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3672,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer39_moe_split -> layer39_moe_comm_to_expert8	[pos="e,3672,16953 3672,16988 3672,16988 3672,16963 3672,16963",
		style=dashed];
	layer39_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3981,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer39_moe_split -> layer39_moe_comm_to_expert9	[pos="e,3890.3,16923 3776.3,17041 3776.3,17037 3776.3,16923 3776.3,16923 3776.3,16923 3880.3,16923 3880.3,16923",
		style=dashed];
	layer39_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4313,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer39_moe_split -> layer39_moe_comm_to_expert10	[pos="e,4237.1,16941 3700.4,17003 3907.6,17003 4237.1,17003 4237.1,17003 4237.1,17003 4237.1,16951 4237.1,16951",
		style=dashed];
	layer39_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4659,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer39_moe_split -> layer39_moe_comm_to_expert11	[pos="e,4583.6,16942 3715.5,17018 4014.9,17018 4583.6,17018 4583.6,17018 4583.6,17018 4583.6,16952 4583.6,16952",
		style=dashed];
	layer39_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="5010,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer39_moe_split -> layer39_moe_comm_to_expert12	[pos="e,4934.6,16941 3730.5,17033 4114.8,17033 4934.6,17033 4934.6,17033 4934.6,17033 4934.6,16951 4934.6,16951",
		style=dashed];
	layer39_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5363,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer39_moe_split -> layer39_moe_comm_to_expert13	[pos="e,5288.1,16941 3745.6,17048 4210.7,17048 5288.1,17048 5288.1,17048 5288.1,17048 5288.1,16951 5288.1,16951",
		style=dashed];
	layer39_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5718,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer39_moe_split -> layer39_moe_comm_to_expert14	[pos="e,5643.1,16941 3760.5,17063 4303.4,17063 5643.1,17063 5643.1,17063 5643.1,17063 5643.1,16951 5643.1,16951",
		style=dashed];
	layer39_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6073,16924",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer39_moe_split -> layer39_moe_comm_to_expert15	[pos="e,5998.1,16941 3774.3,17077 4392.2,17077 5998.1,17077 5998.1,17077 5998.1,17077 5998.1,16951 5998.1,16951",
		style=dashed];
	layer39_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L39\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="941,16833",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer39_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="987,16742",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer39_moe_expert0 -> layer39_moe_comm_from_expert0	[pos="e,987,16771 987,16806 987,16806 987,16781 987,16781"];
	layer39_moe_comm_to_expert0 -> layer39_moe_expert0	[pos="e,987,16859 987,16895 987,16895 987,16869 987,16869"];
	layer39_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L39\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1287,16833",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer39_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1700,16742",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer39_moe_expert1 -> layer39_moe_comm_from_expert1	[pos="e,1609.3,16741 1389.2,16807 1389.2,16780 1389.2,16741 1389.2,16741 1389.2,16741 1599.3,16741 1599.3,16741"];
	layer39_moe_comm_to_expert1 -> layer39_moe_expert1	[pos="e,1305.5,16859 1609.5,16923 1493,16923 1305.5,16923 1305.5,16923 1305.5,16923 1305.5,16869 1305.5,16869"];
	layer39_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L39\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1633,16833",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer39_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2156,16742",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer39_moe_expert2 -> layer39_moe_comm_from_expert2	[pos="e,2065.3,16741 1797.2,16824 1804.6,16824 1809,16824 1809,16824 1809,16824 1809,16741 1809,16741 1809,16741 2055.3,16741 2055.3,16741"];
	layer39_moe_comm_to_expert2 -> layer39_moe_expert2	[pos="e,1797.3,16841 2065.1,16923 1960.5,16923 1803,16923 1803,16923 1803,16923 1803,16841 1803,16841 1803,16841 1802.4,16841 1802.4,16841"];
	layer39_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L39\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1979,16833",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer39_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2484,16742",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer39_moe_expert3 -> layer39_moe_comm_from_expert3	[pos="e,2425.3,16764 2104.2,16807 2104.2,16794 2104.2,16782 2104.2,16782 2104.2,16782 2425.3,16782 2425.3,16782 2425.3,16782 2425.3,16774 \
2425.3,16774"];
	layer39_moe_comm_to_expert3 -> layer39_moe_expert3	[pos="e,2104.2,16859 2425.3,16901 2425.3,16891 2425.3,16882 2425.3,16882 2425.3,16882 2104.2,16882 2104.2,16882 2104.2,16882 2104.2,16869 \
2104.2,16869"];
	layer39_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L39\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2325,16833",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer39_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2747,16742",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer39_moe_expert4 -> layer39_moe_comm_from_expert4	[pos="e,2745.7,16771 2457.2,16807 2457.2,16800 2457.2,16794 2457.2,16794 2457.2,16794 2745.7,16794 2745.7,16794 2745.7,16794 2745.7,16781 \
2745.7,16781"];
	layer39_moe_comm_to_expert4 -> layer39_moe_expert4	[pos="e,2457.2,16859 2745.7,16895 2745.7,16882 2745.7,16870 2745.7,16870 2745.7,16870 2457.2,16870 2457.2,16870 2457.2,16870 2457.2,16869 \
2457.2,16869"];
	layer39_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L39\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2671,16833",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer39_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2978,16742",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer39_moe_expert5 -> layer39_moe_comm_from_expert5	[pos="e,2887.5,16741 2835.2,16824 2842.1,16824 2846.2,16824 2846.2,16824 2846.2,16824 2846.2,16741 2846.2,16741 2846.2,16741 2877.5,16741 \
2877.5,16741"];
	layer39_moe_comm_to_expert5 -> layer39_moe_expert5	[pos="e,2835.3,16841 2887.2,16923 2862.2,16923 2841.8,16923 2841.8,16923 2841.8,16923 2841.8,16841 2841.8,16841 2841.8,16841 2841.2,16841 \
2841.2,16841"];
	layer39_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L39\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="3017,16833",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer39_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3193,16742",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer39_moe_expert6 -> layer39_moe_comm_from_expert6	[pos="e,3141.7,16766 3141.7,16806 3141.7,16806 3141.7,16776 3141.7,16776"];
	layer39_moe_comm_to_expert6 -> layer39_moe_expert6	[pos="e,3141.7,16859 3141.7,16900 3141.7,16900 3141.7,16869 3141.7,16869"];
	layer39_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L39\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3363,16833",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer39_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3400,16742",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer39_moe_expert7 -> layer39_moe_comm_from_expert7	[pos="e,3400,16771 3400,16806 3400,16806 3400,16781 3400,16781"];
	layer39_moe_comm_to_expert7 -> layer39_moe_expert7	[pos="e,3400,16859 3400,16895 3400,16895 3400,16869 3400,16869"];
	layer39_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L39\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3709,16833",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer39_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3672,16742",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer39_moe_expert8 -> layer39_moe_comm_from_expert8	[pos="e,3672,16771 3672,16806 3672,16806 3672,16781 3672,16781"];
	layer39_moe_comm_to_expert8 -> layer39_moe_expert8	[pos="e,3672,16859 3672,16895 3672,16895 3672,16869 3672,16869"];
	layer39_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L39\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4055,16833",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer39_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3981,16742",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer39_moe_expert9 -> layer39_moe_comm_from_expert9	[pos="e,3981.3,16771 3981.3,16806 3981.3,16806 3981.3,16781 3981.3,16781"];
	layer39_moe_comm_to_expert9 -> layer39_moe_expert9	[pos="e,3981.3,16859 3981.3,16895 3981.3,16895 3981.3,16869 3981.3,16869"];
	layer39_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L39\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4406,16833",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer39_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4313,16742",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer39_moe_expert10 -> layer39_moe_comm_from_expert10	[pos="e,4322.4,16771 4322.4,16806 4322.4,16806 4322.4,16781 4322.4,16781"];
	layer39_moe_comm_to_expert10 -> layer39_moe_expert10	[pos="e,4322,16859 4322,16895 4322,16895 4322,16869 4322,16869"];
	layer39_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L39\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4762,16833",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer39_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4660,16742",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer39_moe_expert11 -> layer39_moe_comm_from_expert11	[pos="e,4673.9,16771 4673.9,16806 4673.9,16806 4673.9,16781 4673.9,16781"];
	layer39_moe_comm_to_expert11 -> layer39_moe_expert11	[pos="e,4673,16859 4673,16895 4673,16895 4673,16869 4673,16869"];
	layer39_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L39\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5118,16833",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer39_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="5011,16742",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer39_moe_expert12 -> layer39_moe_comm_from_expert12	[pos="e,5027.4,16771 5027.4,16806 5027.4,16806 5027.4,16781 5027.4,16781"];
	layer39_moe_comm_to_expert12 -> layer39_moe_expert12	[pos="e,5026.5,16859 5026.5,16895 5026.5,16895 5026.5,16869 5026.5,16869"];
	layer39_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L39\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5474,16833",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer39_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5365,16742",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer39_moe_expert13 -> layer39_moe_comm_from_expert13	[pos="e,5382.4,16771 5382.4,16806 5382.4,16806 5382.4,16781 5382.4,16781"];
	layer39_moe_comm_to_expert13 -> layer39_moe_expert13	[pos="e,5381,16859 5381,16895 5381,16895 5381,16869 5381,16869"];
	layer39_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L39\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5830,16833",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer39_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5720,16742",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer39_moe_expert14 -> layer39_moe_comm_from_expert14	[pos="e,5737.9,16770 5737.9,16806 5737.9,16806 5737.9,16780 5737.9,16780"];
	layer39_moe_comm_to_expert14 -> layer39_moe_expert14	[pos="e,5736.5,16859 5736.5,16895 5736.5,16895 5736.5,16869 5736.5,16869"];
	layer39_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L39\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6186,16833",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer39_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6075,16742",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer39_moe_expert15 -> layer39_moe_comm_from_expert15	[pos="e,6093.4,16770 6093.4,16806 6093.4,16806 6093.4,16780 6093.4,16780"];
	layer39_moe_comm_to_expert15 -> layer39_moe_expert15	[pos="e,6092,16859 6092,16895 6092,16895 6092,16869 6092,16869"];
	layer39_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L39\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3499,16625",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer40_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L40\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3499,16511",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer39_moe_aggregate -> layer40_moe_mha	[pos="e,3499,16537 3499,16572 3499,16572 3499,16547 3499,16547"];
	layer39_moe_comm_from_expert0 -> layer39_moe_aggregate	[pos="e,3251.3,16587 1072.8,16732 1072.8,16698 1072.8,16587 1072.8,16587 1072.8,16587 3241.3,16587 3241.3,16587"];
	layer39_moe_comm_from_expert1 -> layer39_moe_aggregate	[pos="e,3266.9,16602 1784.3,16731 1784.3,16698 1784.3,16602 1784.3,16602 1784.3,16602 3256.9,16602 3256.9,16602"];
	layer39_moe_comm_from_expert2 -> layer39_moe_aggregate	[pos="e,3282.3,16617 2228,16724 2228,16690 2228,16617 2228,16617 2228,16617 3272.3,16617 3272.3,16617"];
	layer39_moe_comm_from_expert3 -> layer39_moe_aggregate	[pos="e,3297.9,16632 2556,16724 2556,16693 2556,16632 2556,16632 2556,16632 3287.9,16632 3287.9,16632"];
	layer39_moe_comm_from_expert4 -> layer39_moe_aggregate	[pos="e,3313.1,16647 2826.8,16728 2826.8,16701 2826.8,16647 2826.8,16647 2826.8,16647 3303.1,16647 3303.1,16647"];
	layer39_moe_comm_from_expert5 -> layer39_moe_aggregate	[pos="e,3327.7,16661 3048.5,16723 3048.5,16700 3048.5,16661 3048.5,16661 3048.5,16661 3317.7,16661 3317.7,16661"];
	layer39_moe_comm_from_expert6 -> layer39_moe_aggregate	[pos="e,3260.1,16625 3260.1,16722 3260.1,16722 3260.1,16635 3260.1,16635"];
	layer39_moe_comm_from_expert7 -> layer39_moe_aggregate	[pos="e,3400,16677 3400,16713 3400,16713 3400,16687 3400,16687"];
	layer39_moe_comm_from_expert8 -> layer39_moe_aggregate	[pos="e,3671.4,16677 3671.4,16713 3671.4,16713 3671.4,16687 3671.4,16687"];
	layer39_moe_comm_from_expert9 -> layer39_moe_aggregate	[pos="e,3747,16663 3962.5,16713 3962.5,16691 3962.5,16663 3962.5,16663 3962.5,16663 3757,16663 3757,16663"];
	layer39_moe_comm_from_expert10 -> layer39_moe_aggregate	[pos="e,3733.5,16650 4294.1,16713 4294.1,16686 4294.1,16650 4294.1,16650 4294.1,16650 3743.5,16650 3743.5,16650"];
	layer39_moe_comm_from_expert11 -> layer39_moe_aggregate	[pos="e,3720.1,16637 4640.6,16713 4640.6,16682 4640.6,16637 4640.6,16637 4640.6,16637 3730.1,16637 3730.1,16637"];
	layer39_moe_comm_from_expert12 -> layer39_moe_aggregate	[pos="e,3706.9,16624 4991.6,16713 4991.6,16678 4991.6,16624 4991.6,16624 4991.6,16624 3716.9,16624 3716.9,16624"];
	layer39_moe_comm_from_expert13 -> layer39_moe_aggregate	[pos="e,3693.5,16611 5345.1,16713 5345.1,16675 5345.1,16611 5345.1,16611 5345.1,16611 3703.5,16611 3703.5,16611"];
	layer39_moe_comm_from_expert14 -> layer39_moe_aggregate	[pos="e,3680.1,16598 5700.1,16713 5700.1,16671 5700.1,16598 5700.1,16598 5700.1,16598 3690.1,16598 3690.1,16598"];
	layer39_moe_comm_from_expert15 -> layer39_moe_aggregate	[pos="e,3666.7,16585 6055.1,16713 6055.1,16668 6055.1,16585 6055.1,16585 6055.1,16585 3676.7,16585 3676.7,16585"];
	layer40_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L40\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3499,16397",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer40_moe_mha -> layer40_moe_gate	[pos="e,3499,16449 3499,16485 3499,16485 3499,16459 3499,16459"];
	layer40_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L40\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3499,16257",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer40_moe_gate -> layer40_moe_split	[pos="e,3499,16309 3499,16345 3499,16345 3499,16319 3499,16319"];
	layer40_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1418,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer40_moe_split -> layer40_moe_comm_to_expert0	[pos="e,1488.8,16158 3332.8,16293 2851.2,16293 1488.8,16293 1488.8,16293 1488.8,16293 1488.8,16168 1488.8,16168",
		style=dashed];
	layer40_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1663,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer40_moe_split -> layer40_moe_comm_to_expert1	[pos="e,1681.5,16168 3318.9,16279 2859.8,16279 1681.5,16279 1681.5,16279 1681.5,16279 1681.5,16178 1681.5,16178",
		style=dashed];
	layer40_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2119,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer40_moe_split -> layer40_moe_comm_to_expert2	[pos="e,2137.5,16168 3303.9,16264 2927.5,16264 2137.5,16264 2137.5,16264 2137.5,16264 2137.5,16178 2137.5,16178",
		style=dashed];
	layer40_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2447,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer40_moe_split -> layer40_moe_comm_to_expert3	[pos="e,2465.5,16168 3288.9,16249 2986.8,16249 2465.5,16249 2465.5,16249 2465.5,16249 2465.5,16178 2465.5,16178",
		style=dashed];
	layer40_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2710,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer40_moe_split -> layer40_moe_comm_to_expert4	[pos="e,2728.5,16168 3274.1,16234 3046.6,16234 2728.5,16234 2728.5,16234 2728.5,16234 2728.5,16178 2728.5,16178",
		style=dashed];
	layer40_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2941,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer40_moe_split -> layer40_moe_comm_to_expert5	[pos="e,2959.5,16168 3258.8,16219 3114.9,16219 2959.5,16219 2959.5,16219 2959.5,16219 2959.5,16178 2959.5,16178",
		style=dashed];
	layer40_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3156,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer40_moe_split -> layer40_moe_comm_to_expert6	[pos="e,3246.8,16139 3259.5,16257 3259.5,16253 3259.5,16139 3259.5,16139 3259.5,16139 3256.8,16139 3256.8,16139",
		style=dashed];
	layer40_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3363,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer40_moe_split -> layer40_moe_comm_to_expert7	[pos="e,3363,16169 3363,16204 3363,16204 3363,16179 3363,16179",
		style=dashed];
	layer40_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3635,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer40_moe_split -> layer40_moe_comm_to_expert8	[pos="e,3635,16169 3635,16204 3635,16204 3635,16179 3635,16179",
		style=dashed];
	layer40_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3944,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer40_moe_split -> layer40_moe_comm_to_expert9	[pos="e,3853.3,16139 3739.3,16257 3739.3,16253 3739.3,16139 3739.3,16139 3739.3,16139 3843.3,16139 3843.3,16139",
		style=dashed];
	layer40_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4276,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer40_moe_split -> layer40_moe_comm_to_expert10	[pos="e,4200.1,16157 3663.4,16219 3870.6,16219 4200.1,16219 4200.1,16219 4200.1,16219 4200.1,16167 4200.1,16167",
		style=dashed];
	layer40_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4622,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer40_moe_split -> layer40_moe_comm_to_expert11	[pos="e,4546.6,16158 3678.5,16234 3977.9,16234 4546.6,16234 4546.6,16234 4546.6,16234 4546.6,16168 4546.6,16168",
		style=dashed];
	layer40_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4973,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer40_moe_split -> layer40_moe_comm_to_expert12	[pos="e,4897.6,16157 3693.5,16249 4077.8,16249 4897.6,16249 4897.6,16249 4897.6,16249 4897.6,16167 4897.6,16167",
		style=dashed];
	layer40_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5326,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer40_moe_split -> layer40_moe_comm_to_expert13	[pos="e,5251.1,16158 3708.6,16264 4173.7,16264 5251.1,16264 5251.1,16264 5251.1,16264 5251.1,16168 5251.1,16168",
		style=dashed];
	layer40_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5681,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer40_moe_split -> layer40_moe_comm_to_expert14	[pos="e,5606.1,16157 3723.5,16279 4266.4,16279 5606.1,16279 5606.1,16279 5606.1,16279 5606.1,16167 5606.1,16167",
		style=dashed];
	layer40_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="6036,16140",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer40_moe_split -> layer40_moe_comm_to_expert15	[pos="e,5961.1,16157 3737.3,16293 4355.2,16293 5961.1,16293 5961.1,16293 5961.1,16293 5961.1,16167 5961.1,16167",
		style=dashed];
	layer40_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L40\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="904,16049",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer40_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="950,15958",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer40_moe_expert0 -> layer40_moe_comm_from_expert0	[pos="e,950,15987 950,16023 950,16023 950,15997 950,15997"];
	layer40_moe_comm_to_expert0 -> layer40_moe_expert0	[pos="e,982.25,16075 1327.4,16139 1199.8,16139 982.25,16139 982.25,16139 982.25,16139 982.25,16085 982.25,16085"];
	layer40_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L40\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1250,16049",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer40_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1663,15958",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer40_moe_expert1 -> layer40_moe_comm_from_expert1	[pos="e,1572.3,15957 1352.2,16023 1352.2,15996 1352.2,15957 1352.2,15957 1352.2,15957 1562.3,15957 1562.3,15957"];
	layer40_moe_comm_to_expert1 -> layer40_moe_expert1	[pos="e,1370.7,16075 1663,16111 1663,16097 1663,16083 1663,16083 1663,16083 1370.7,16083 1370.7,16083 1370.7,16083 1370.7,16082 1370.7,\
16082"];
	layer40_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L40\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1596,16049",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer40_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2119,15958",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer40_moe_expert2 -> layer40_moe_comm_from_expert2	[pos="e,2028.3,15957 1760.2,16040 1767.6,16040 1772,16040 1772,16040 1772,16040 1772,15957 1772,15957 1772,15957 2018.3,15957 2018.3,15957"];
	layer40_moe_comm_to_expert2 -> layer40_moe_expert2	[pos="e,1760.3,16057 2028.1,16139 1923.5,16139 1766,16139 1766,16139 1766,16139 1766,16057 1766,16057 1766,16057 1765.4,16057 1765.4,16057"];
	layer40_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L40\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1942,16049",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer40_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2447,15958",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer40_moe_expert3 -> layer40_moe_comm_from_expert3	[pos="e,2388.3,15980 2067.2,16023 2067.2,16010 2067.2,15998 2067.2,15998 2067.2,15998 2388.3,15998 2388.3,15998 2388.3,15998 2388.3,15990 \
2388.3,15990"];
	layer40_moe_comm_to_expert3 -> layer40_moe_expert3	[pos="e,2067.2,16075 2388.3,16118 2388.3,16109 2388.3,16101 2388.3,16101 2388.3,16101 2067.2,16101 2067.2,16101 2067.2,16101 2067.2,16085 \
2067.2,16085"];
	layer40_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L40\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2288,16049",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer40_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2710,15958",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer40_moe_expert4 -> layer40_moe_comm_from_expert4	[pos="e,2708.7,15987 2420.2,16023 2420.2,16016 2420.2,16010 2420.2,16010 2420.2,16010 2708.7,16010 2708.7,16010 2708.7,16010 2708.7,15997 \
2708.7,15997"];
	layer40_moe_comm_to_expert4 -> layer40_moe_expert4	[pos="e,2420.2,16075 2708.7,16111 2708.7,16101 2708.7,16092 2708.7,16092 2708.7,16092 2420.2,16092 2420.2,16092 2420.2,16092 2420.2,16085 \
2420.2,16085"];
	layer40_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L40\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2634,16049",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer40_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2941,15958",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer40_moe_expert5 -> layer40_moe_comm_from_expert5	[pos="e,2850.5,15957 2798.2,16040 2805.1,16040 2809.2,16040 2809.2,16040 2809.2,16040 2809.2,15957 2809.2,15957 2809.2,15957 2840.5,15957 \
2840.5,15957"];
	layer40_moe_comm_to_expert5 -> layer40_moe_expert5	[pos="e,2798.3,16057 2850.2,16139 2825.2,16139 2804.8,16139 2804.8,16139 2804.8,16139 2804.8,16057 2804.8,16057 2804.8,16057 2804.2,16057 \
2804.2,16057"];
	layer40_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L40\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2980,16049",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer40_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3156,15958",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer40_moe_expert6 -> layer40_moe_comm_from_expert6	[pos="e,3104.7,15982 3104.7,16023 3104.7,16023 3104.7,15992 3104.7,15992"];
	layer40_moe_comm_to_expert6 -> layer40_moe_expert6	[pos="e,3104.7,16075 3104.7,16116 3104.7,16116 3104.7,16085 3104.7,16085"];
	layer40_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L40\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3326,16049",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer40_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3363,15958",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer40_moe_expert7 -> layer40_moe_comm_from_expert7	[pos="e,3363,15987 3363,16023 3363,16023 3363,15997 3363,15997"];
	layer40_moe_comm_to_expert7 -> layer40_moe_expert7	[pos="e,3363,16075 3363,16111 3363,16111 3363,16085 3363,16085"];
	layer40_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L40\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3672,16049",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer40_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3635,15958",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer40_moe_expert8 -> layer40_moe_comm_from_expert8	[pos="e,3635,15987 3635,16023 3635,16023 3635,15997 3635,15997"];
	layer40_moe_comm_to_expert8 -> layer40_moe_expert8	[pos="e,3635,16075 3635,16111 3635,16111 3635,16085 3635,16085"];
	layer40_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L40\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="4018,16049",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer40_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3944,15958",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer40_moe_expert9 -> layer40_moe_comm_from_expert9	[pos="e,3944.3,15987 3944.3,16023 3944.3,16023 3944.3,15997 3944.3,15997"];
	layer40_moe_comm_to_expert9 -> layer40_moe_expert9	[pos="e,3944.3,16075 3944.3,16111 3944.3,16111 3944.3,16085 3944.3,16085"];
	layer40_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L40\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4369,16049",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer40_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4276,15958",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer40_moe_expert10 -> layer40_moe_comm_from_expert10	[pos="e,4285.4,15987 4285.4,16023 4285.4,16023 4285.4,15997 4285.4,15997"];
	layer40_moe_comm_to_expert10 -> layer40_moe_expert10	[pos="e,4285,16075 4285,16111 4285,16111 4285,16085 4285,16085"];
	layer40_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L40\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4725,16049",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer40_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4623,15958",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer40_moe_expert11 -> layer40_moe_comm_from_expert11	[pos="e,4636.9,15987 4636.9,16023 4636.9,16023 4636.9,15997 4636.9,15997"];
	layer40_moe_comm_to_expert11 -> layer40_moe_expert11	[pos="e,4636,16075 4636,16111 4636,16111 4636,16085 4636,16085"];
	layer40_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L40\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5081,16049",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer40_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4974,15958",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer40_moe_expert12 -> layer40_moe_comm_from_expert12	[pos="e,4990.4,15987 4990.4,16023 4990.4,16023 4990.4,15997 4990.4,15997"];
	layer40_moe_comm_to_expert12 -> layer40_moe_expert12	[pos="e,4989.5,16075 4989.5,16111 4989.5,16111 4989.5,16085 4989.5,16085"];
	layer40_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L40\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5437,16049",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer40_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5328,15958",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer40_moe_expert13 -> layer40_moe_comm_from_expert13	[pos="e,5345.4,15987 5345.4,16023 5345.4,16023 5345.4,15997 5345.4,15997"];
	layer40_moe_comm_to_expert13 -> layer40_moe_expert13	[pos="e,5344,16075 5344,16111 5344,16111 5344,16085 5344,16085"];
	layer40_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L40\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5793,16049",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer40_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5683,15958",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer40_moe_expert14 -> layer40_moe_comm_from_expert14	[pos="e,5700.9,15986 5700.9,16023 5700.9,16023 5700.9,15996 5700.9,15996"];
	layer40_moe_comm_to_expert14 -> layer40_moe_expert14	[pos="e,5699.5,16075 5699.5,16111 5699.5,16111 5699.5,16085 5699.5,16085"];
	layer40_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L40\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6149,16049",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer40_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6038,15958",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer40_moe_expert15 -> layer40_moe_comm_from_expert15	[pos="e,6056.4,15986 6056.4,16023 6056.4,16023 6056.4,15996 6056.4,15996"];
	layer40_moe_comm_to_expert15 -> layer40_moe_expert15	[pos="e,6055,16075 6055,16111 6055,16111 6055,16085 6055,16085"];
	layer40_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L40\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3462,15841",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer41_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L41\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3462,15727",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer40_moe_aggregate -> layer41_moe_mha	[pos="e,3462,15753 3462,15789 3462,15789 3462,15763 3462,15763"];
	layer40_moe_comm_from_expert0 -> layer40_moe_aggregate	[pos="e,3214.3,15803 1035.8,15948 1035.8,15914 1035.8,15803 1035.8,15803 1035.8,15803 3204.3,15803 3204.3,15803"];
	layer40_moe_comm_from_expert1 -> layer40_moe_aggregate	[pos="e,3229.9,15818 1747.3,15947 1747.3,15914 1747.3,15818 1747.3,15818 1747.3,15818 3219.9,15818 3219.9,15818"];
	layer40_moe_comm_from_expert2 -> layer40_moe_aggregate	[pos="e,3245.3,15833 2191,15940 2191,15906 2191,15833 2191,15833 2191,15833 3235.3,15833 3235.3,15833"];
	layer40_moe_comm_from_expert3 -> layer40_moe_aggregate	[pos="e,3260.9,15848 2519,15940 2519,15909 2519,15848 2519,15848 2519,15848 3250.9,15848 3250.9,15848"];
	layer40_moe_comm_from_expert4 -> layer40_moe_aggregate	[pos="e,3276.1,15863 2789.8,15944 2789.8,15917 2789.8,15863 2789.8,15863 2789.8,15863 3266.1,15863 3266.1,15863"];
	layer40_moe_comm_from_expert5 -> layer40_moe_aggregate	[pos="e,3290.7,15877 3011.5,15939 3011.5,15916 3011.5,15877 3011.5,15877 3011.5,15877 3280.7,15877 3280.7,15877"];
	layer40_moe_comm_from_expert6 -> layer40_moe_aggregate	[pos="e,3223.1,15841 3223.1,15938 3223.1,15938 3223.1,15851 3223.1,15851"];
	layer40_moe_comm_from_expert7 -> layer40_moe_aggregate	[pos="e,3363,15893 3363,15929 3363,15929 3363,15903 3363,15903"];
	layer40_moe_comm_from_expert8 -> layer40_moe_aggregate	[pos="e,3634.4,15893 3634.4,15929 3634.4,15929 3634.4,15903 3634.4,15903"];
	layer40_moe_comm_from_expert9 -> layer40_moe_aggregate	[pos="e,3710,15879 3925.5,15929 3925.5,15907 3925.5,15879 3925.5,15879 3925.5,15879 3720,15879 3720,15879"];
	layer40_moe_comm_from_expert10 -> layer40_moe_aggregate	[pos="e,3696.5,15866 4257.1,15929 4257.1,15902 4257.1,15866 4257.1,15866 4257.1,15866 3706.5,15866 3706.5,15866"];
	layer40_moe_comm_from_expert11 -> layer40_moe_aggregate	[pos="e,3683.1,15853 4603.6,15929 4603.6,15898 4603.6,15853 4603.6,15853 4603.6,15853 3693.1,15853 3693.1,15853"];
	layer40_moe_comm_from_expert12 -> layer40_moe_aggregate	[pos="e,3669.9,15840 4954.6,15929 4954.6,15894 4954.6,15840 4954.6,15840 4954.6,15840 3679.9,15840 3679.9,15840"];
	layer40_moe_comm_from_expert13 -> layer40_moe_aggregate	[pos="e,3656.5,15827 5308.1,15929 5308.1,15891 5308.1,15827 5308.1,15827 5308.1,15827 3666.5,15827 3666.5,15827"];
	layer40_moe_comm_from_expert14 -> layer40_moe_aggregate	[pos="e,3643.1,15814 5663.1,15929 5663.1,15888 5663.1,15814 5663.1,15814 5663.1,15814 3653.1,15814 3653.1,15814"];
	layer40_moe_comm_from_expert15 -> layer40_moe_aggregate	[pos="e,3629.7,15801 6018.1,15929 6018.1,15884 6018.1,15801 6018.1,15801 6018.1,15801 3639.7,15801 3639.7,15801"];
	layer41_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L41\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3462,15613",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer41_moe_mha -> layer41_moe_gate	[pos="e,3462,15665 3462,15701 3462,15701 3462,15675 3462,15675"];
	layer41_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L41\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3462,15473",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer41_moe_gate -> layer41_moe_split	[pos="e,3462,15525 3462,15561 3462,15561 3462,15535 3462,15535"];
	layer41_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1381,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer41_moe_split -> layer41_moe_comm_to_expert0	[pos="e,1451.8,15374 3295.8,15509 2814.2,15509 1451.8,15509 1451.8,15509 1451.8,15509 1451.8,15384 1451.8,15384",
		style=dashed];
	layer41_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1626,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer41_moe_split -> layer41_moe_comm_to_expert1	[pos="e,1644.5,15384 3281.9,15495 2822.8,15495 1644.5,15495 1644.5,15495 1644.5,15495 1644.5,15394 1644.5,15394",
		style=dashed];
	layer41_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2082,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer41_moe_split -> layer41_moe_comm_to_expert2	[pos="e,2100.5,15384 3266.9,15480 2890.5,15480 2100.5,15480 2100.5,15480 2100.5,15480 2100.5,15394 2100.5,15394",
		style=dashed];
	layer41_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2410,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer41_moe_split -> layer41_moe_comm_to_expert3	[pos="e,2428.5,15384 3251.9,15465 2949.8,15465 2428.5,15465 2428.5,15465 2428.5,15465 2428.5,15394 2428.5,15394",
		style=dashed];
	layer41_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2673,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer41_moe_split -> layer41_moe_comm_to_expert4	[pos="e,2691.5,15384 3237.1,15450 3009.6,15450 2691.5,15450 2691.5,15450 2691.5,15450 2691.5,15394 2691.5,15394",
		style=dashed];
	layer41_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2904,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer41_moe_split -> layer41_moe_comm_to_expert5	[pos="e,2922.5,15384 3221.8,15435 3077.9,15435 2922.5,15435 2922.5,15435 2922.5,15435 2922.5,15394 2922.5,15394",
		style=dashed];
	layer41_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3119,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer41_moe_split -> layer41_moe_comm_to_expert6	[pos="e,3209.8,15355 3222.5,15473 3222.5,15469 3222.5,15355 3222.5,15355 3222.5,15355 3219.8,15355 3219.8,15355",
		style=dashed];
	layer41_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3326,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer41_moe_split -> layer41_moe_comm_to_expert7	[pos="e,3326,15385 3326,15421 3326,15421 3326,15395 3326,15395",
		style=dashed];
	layer41_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3598,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer41_moe_split -> layer41_moe_comm_to_expert8	[pos="e,3598,15385 3598,15421 3598,15421 3598,15395 3598,15395",
		style=dashed];
	layer41_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3907,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer41_moe_split -> layer41_moe_comm_to_expert9	[pos="e,3816.3,15355 3702.3,15473 3702.3,15469 3702.3,15355 3702.3,15355 3702.3,15355 3806.3,15355 3806.3,15355",
		style=dashed];
	layer41_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4239,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer41_moe_split -> layer41_moe_comm_to_expert10	[pos="e,4163.1,15373 3626.4,15435 3833.6,15435 4163.1,15435 4163.1,15435 4163.1,15435 4163.1,15383 4163.1,15383",
		style=dashed];
	layer41_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4585,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer41_moe_split -> layer41_moe_comm_to_expert11	[pos="e,4509.6,15374 3641.5,15450 3940.9,15450 4509.6,15450 4509.6,15450 4509.6,15450 4509.6,15384 4509.6,15384",
		style=dashed];
	layer41_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4936,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer41_moe_split -> layer41_moe_comm_to_expert12	[pos="e,4860.6,15373 3656.5,15465 4040.8,15465 4860.6,15465 4860.6,15465 4860.6,15465 4860.6,15383 4860.6,15383",
		style=dashed];
	layer41_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5289,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer41_moe_split -> layer41_moe_comm_to_expert13	[pos="e,5214.1,15374 3671.6,15480 4136.7,15480 5214.1,15480 5214.1,15480 5214.1,15480 5214.1,15384 5214.1,15384",
		style=dashed];
	layer41_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5644,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer41_moe_split -> layer41_moe_comm_to_expert14	[pos="e,5569.1,15373 3686.5,15495 4229.4,15495 5569.1,15495 5569.1,15495 5569.1,15495 5569.1,15383 5569.1,15383",
		style=dashed];
	layer41_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5999,15356",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer41_moe_split -> layer41_moe_comm_to_expert15	[pos="e,5924.1,15373 3700.3,15509 4318.2,15509 5924.1,15509 5924.1,15509 5924.1,15509 5924.1,15383 5924.1,15383",
		style=dashed];
	layer41_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L41\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="867,15265",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer41_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="954,15174",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer41_moe_expert0 -> layer41_moe_comm_from_expert0	[pos="e,947.25,15203 947.25,15239 947.25,15239 947.25,15213 947.25,15213"];
	layer41_moe_comm_to_expert0 -> layer41_moe_expert0	[pos="e,945.25,15291 1290.4,15355 1162.8,15355 945.25,15355 945.25,15355 945.25,15355 945.25,15301 945.25,15301"];
	layer41_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L41\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1213,15265",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer41_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1594,15174",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer41_moe_expert1 -> layer41_moe_comm_from_expert1	[pos="e,1503.5,15173 1315.2,15239 1315.2,15212 1315.2,15173 1315.2,15173 1315.2,15173 1493.5,15173 1493.5,15173"];
	layer41_moe_comm_to_expert1 -> layer41_moe_expert1	[pos="e,1333.7,15291 1626,15327 1626,15313 1626,15299 1626,15299 1626,15299 1333.7,15299 1333.7,15299 1333.7,15299 1333.7,15298 1333.7,\
15298"];
	layer41_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L41\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1559,15265",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer41_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2013,15174",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer41_moe_expert2 -> layer41_moe_comm_from_expert2	[pos="e,1922.3,15173 1713.5,15239 1713.5,15212 1713.5,15173 1713.5,15173 1713.5,15173 1912.3,15173 1912.3,15173"];
	layer41_moe_comm_to_expert2 -> layer41_moe_expert2	[pos="e,1723.2,15264 1991.4,15355 1887.7,15355 1732,15355 1732,15355 1732,15355 1732,15264 1732,15264 1732,15264 1731.1,15264 1731.1,15264"];
	layer41_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L41\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1905,15265",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer41_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2322,15174",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer41_moe_expert3 -> layer41_moe_comm_from_expert3	[pos="e,2322,15203 1995.7,15239 1995.7,15229 1995.7,15220 1995.7,15220 1995.7,15220 2322,15220 2322,15220 2322,15220 2322,15213 2322,15213"];
	layer41_moe_comm_to_expert3 -> layer41_moe_expert3	[pos="e,2030.2,15291 2351.3,15334 2351.3,15325 2351.3,15317 2351.3,15317 2351.3,15317 2030.2,15317 2030.2,15317 2030.2,15317 2030.2,15301 \
2030.2,15301"];
	layer41_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L41\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2251,15265",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer41_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2576,15174",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer41_moe_expert4 -> layer41_moe_comm_from_expert4	[pos="e,2485.4,15173 2415.2,15264 2420.8,15264 2424,15264 2424,15264 2424,15264 2424,15173 2424,15173 2424,15173 2475.4,15173 2475.4,15173"];
	layer41_moe_comm_to_expert4 -> layer41_moe_expert4	[pos="e,2383.2,15291 2671.7,15327 2671.7,15317 2671.7,15308 2671.7,15308 2671.7,15308 2383.2,15308 2383.2,15308 2383.2,15308 2383.2,15301 \
2383.2,15301"];
	layer41_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L41\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2597,15265",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer41_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2803,15174",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer41_moe_expert5 -> layer41_moe_comm_from_expert5	[pos="e,2736.7,15194 2736.7,15239 2736.7,15239 2736.7,15204 2736.7,15204"];
	layer41_moe_comm_to_expert5 -> layer41_moe_expert5	[pos="e,2761.1,15264 2813.3,15355 2789.9,15355 2771.3,15355 2771.3,15355 2771.3,15355 2771.3,15264 2771.3,15264 2771.3,15264 2770.2,15264 \
2770.2,15264"];
	layer41_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L41\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2943,15265",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer41_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3016,15174",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer41_moe_expert6 -> layer41_moe_comm_from_expert6	[pos="e,3016,15203 3016,15239 3016,15239 3016,15213 3016,15213"];
	layer41_moe_comm_to_expert6 -> layer41_moe_expert6	[pos="e,3067.7,15291 3067.7,15332 3067.7,15332 3067.7,15301 3067.7,15301"];
	layer41_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L41\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3289,15265",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer41_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3326,15174",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer41_moe_expert7 -> layer41_moe_comm_from_expert7	[pos="e,3326,15203 3326,15239 3326,15239 3326,15213 3326,15213"];
	layer41_moe_comm_to_expert7 -> layer41_moe_expert7	[pos="e,3326,15291 3326,15327 3326,15327 3326,15301 3326,15301"];
	layer41_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L41\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3635,15265",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer41_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3598,15174",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer41_moe_expert8 -> layer41_moe_comm_from_expert8	[pos="e,3598,15203 3598,15239 3598,15239 3598,15213 3598,15213"];
	layer41_moe_comm_to_expert8 -> layer41_moe_expert8	[pos="e,3598,15291 3598,15327 3598,15327 3598,15301 3598,15301"];
	layer41_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L41\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3981,15265",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer41_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3907,15174",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer41_moe_expert9 -> layer41_moe_comm_from_expert9	[pos="e,3907.3,15203 3907.3,15239 3907.3,15239 3907.3,15213 3907.3,15213"];
	layer41_moe_comm_to_expert9 -> layer41_moe_expert9	[pos="e,3907.3,15291 3907.3,15327 3907.3,15327 3907.3,15301 3907.3,15301"];
	layer41_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L41\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4332,15265",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer41_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4239,15174",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer41_moe_expert10 -> layer41_moe_comm_from_expert10	[pos="e,4248.4,15203 4248.4,15239 4248.4,15239 4248.4,15213 4248.4,15213"];
	layer41_moe_comm_to_expert10 -> layer41_moe_expert10	[pos="e,4248,15291 4248,15327 4248,15327 4248,15301 4248,15301"];
	layer41_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L41\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4688,15265",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer41_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4586,15174",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer41_moe_expert11 -> layer41_moe_comm_from_expert11	[pos="e,4599.9,15203 4599.9,15239 4599.9,15239 4599.9,15213 4599.9,15213"];
	layer41_moe_comm_to_expert11 -> layer41_moe_expert11	[pos="e,4599,15291 4599,15327 4599,15327 4599,15301 4599,15301"];
	layer41_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L41\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5044,15265",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer41_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4937,15174",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer41_moe_expert12 -> layer41_moe_comm_from_expert12	[pos="e,4953.4,15203 4953.4,15239 4953.4,15239 4953.4,15213 4953.4,15213"];
	layer41_moe_comm_to_expert12 -> layer41_moe_expert12	[pos="e,4952.5,15291 4952.5,15327 4952.5,15327 4952.5,15301 4952.5,15301"];
	layer41_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L41\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5400,15265",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer41_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5291,15174",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer41_moe_expert13 -> layer41_moe_comm_from_expert13	[pos="e,5308.4,15203 5308.4,15239 5308.4,15239 5308.4,15213 5308.4,15213"];
	layer41_moe_comm_to_expert13 -> layer41_moe_expert13	[pos="e,5307,15291 5307,15327 5307,15327 5307,15301 5307,15301"];
	layer41_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L41\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5756,15265",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer41_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5646,15174",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer41_moe_expert14 -> layer41_moe_comm_from_expert14	[pos="e,5663.9,15202 5663.9,15239 5663.9,15239 5663.9,15212 5663.9,15212"];
	layer41_moe_comm_to_expert14 -> layer41_moe_expert14	[pos="e,5662.5,15291 5662.5,15327 5662.5,15327 5662.5,15301 5662.5,15301"];
	layer41_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L41\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6112,15265",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer41_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="6001,15174",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer41_moe_expert15 -> layer41_moe_comm_from_expert15	[pos="e,6019.4,15202 6019.4,15239 6019.4,15239 6019.4,15212 6019.4,15212"];
	layer41_moe_comm_to_expert15 -> layer41_moe_expert15	[pos="e,6018,15291 6018,15327 6018,15327 6018,15301 6018,15301"];
	layer41_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L41\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3425,15057",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer42_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L42\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3425,14943",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer41_moe_aggregate -> layer42_moe_mha	[pos="e,3425,14969 3425,15005 3425,15005 3425,14979 3425,14979"];
	layer41_moe_comm_from_expert0 -> layer41_moe_aggregate	[pos="e,3177.3,15019 1028.3,15157 1028.3,15117 1028.3,15019 1028.3,15019 1028.3,15019 3167.3,15019 3167.3,15019"];
	layer41_moe_comm_from_expert1 -> layer41_moe_aggregate	[pos="e,3192.8,15034 1620.8,15146 1620.8,15105 1620.8,15034 1620.8,15034 1620.8,15034 3182.8,15034 3182.8,15034"];
	layer41_moe_comm_from_expert2 -> layer41_moe_aggregate	[pos="e,3208,15049 2029,15145 2029,15108 2029,15049 2029,15049 2029,15049 3198,15049 3198,15049"];
	layer41_moe_comm_from_expert3 -> layer41_moe_aggregate	[pos="e,3223.6,15064 2347.5,15146 2347.5,15113 2347.5,15064 2347.5,15064 2347.5,15064 3213.6,15064 3213.6,15064"];
	layer41_moe_comm_from_expert4 -> layer41_moe_aggregate	[pos="e,3239.2,15079 2606,15146 2606,15118 2606,15079 2606,15079 2606,15079 3229.2,15079 3229.2,15079"];
	layer41_moe_comm_from_expert5 -> layer41_moe_aggregate	[pos="e,3254.7,15094 2835,15146 2835,15123 2835,15094 2835,15094 2835,15094 3244.7,15094 3244.7,15094"];
	layer41_moe_comm_from_expert6 -> layer41_moe_aggregate	[pos="e,3199.1,15057 3106.5,15173 3152.6,15173 3199.1,15173 3199.1,15173 3199.1,15173 3199.1,15067 3199.1,15067"];
	layer41_moe_comm_from_expert7 -> layer41_moe_aggregate	[pos="e,3326,15109 3326,15145 3326,15145 3326,15119 3326,15119"];
	layer41_moe_comm_from_expert8 -> layer41_moe_aggregate	[pos="e,3597.4,15109 3597.4,15145 3597.4,15145 3597.4,15119 3597.4,15119"];
	layer41_moe_comm_from_expert9 -> layer41_moe_aggregate	[pos="e,3673,15095 3888.5,15145 3888.5,15123 3888.5,15095 3888.5,15095 3888.5,15095 3683,15095 3683,15095"];
	layer41_moe_comm_from_expert10 -> layer41_moe_aggregate	[pos="e,3659.5,15082 4220.1,15145 4220.1,15118 4220.1,15082 4220.1,15082 4220.1,15082 3669.5,15082 3669.5,15082"];
	layer41_moe_comm_from_expert11 -> layer41_moe_aggregate	[pos="e,3646.1,15069 4566.6,15145 4566.6,15114 4566.6,15069 4566.6,15069 4566.6,15069 3656.1,15069 3656.1,15069"];
	layer41_moe_comm_from_expert12 -> layer41_moe_aggregate	[pos="e,3632.9,15056 4917.6,15145 4917.6,15110 4917.6,15056 4917.6,15056 4917.6,15056 3642.9,15056 3642.9,15056"];
	layer41_moe_comm_from_expert13 -> layer41_moe_aggregate	[pos="e,3619.5,15043 5271.1,15145 5271.1,15107 5271.1,15043 5271.1,15043 5271.1,15043 3629.5,15043 3629.5,15043"];
	layer41_moe_comm_from_expert14 -> layer41_moe_aggregate	[pos="e,3606.1,15030 5626.1,15145 5626.1,15104 5626.1,15030 5626.1,15030 5626.1,15030 3616.1,15030 3616.1,15030"];
	layer41_moe_comm_from_expert15 -> layer41_moe_aggregate	[pos="e,3592.7,15017 5981.1,15145 5981.1,15100 5981.1,15017 5981.1,15017 5981.1,15017 3602.7,15017 3602.7,15017"];
	layer42_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L42\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3425,14829",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer42_moe_mha -> layer42_moe_gate	[pos="e,3425,14881 3425,14917 3425,14917 3425,14891 3425,14891"];
	layer42_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L42\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3425,14689",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer42_moe_gate -> layer42_moe_split	[pos="e,3425,14741 3425,14777 3425,14777 3425,14751 3425,14751"];
	layer42_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1344,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer42_moe_split -> layer42_moe_comm_to_expert0	[pos="e,1414.8,14590 3259.6,14726 2778.8,14726 1414.8,14726 1414.8,14726 1414.8,14726 1414.8,14600 1414.8,14600",
		style=dashed];
	layer42_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1589,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer42_moe_split -> layer42_moe_comm_to_expert1	[pos="e,1562.2,14600 3244.7,14711 2777.2,14711 1562.2,14711 1562.2,14711 1562.2,14711 1562.2,14610 1562.2,14610",
		style=dashed];
	layer42_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="2045,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer42_moe_split -> layer42_moe_comm_to_expert2	[pos="e,2119.5,14588 3229.9,14696 2865.8,14696 2119.5,14696 2119.5,14696 2119.5,14696 2119.5,14598 2119.5,14598",
		style=dashed];
	layer42_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2373,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer42_moe_split -> layer42_moe_comm_to_expert3	[pos="e,2448.3,14588 3214.9,14681 2927.8,14681 2448.3,14681 2448.3,14681 2448.3,14681 2448.3,14598 2448.3,14598",
		style=dashed];
	layer42_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2636,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer42_moe_split -> layer42_moe_comm_to_expert4	[pos="e,2719.5,14583 3199.8,14666 2993.4,14666 2719.5,14666 2719.5,14666 2719.5,14666 2719.5,14593 2719.5,14593",
		style=dashed];
	layer42_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2867,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer42_moe_split -> layer42_moe_comm_to_expert5	[pos="e,2941.5,14589 3185,14651 3063.6,14651 2941.5,14651 2941.5,14651 2941.5,14651 2941.5,14599 2941.5,14599",
		style=dashed];
	layer42_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3082,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer42_moe_split -> layer42_moe_comm_to_expert6	[pos="e,3172.8,14571 3185.5,14689 3185.5,14685 3185.5,14571 3185.5,14571 3185.5,14571 3182.8,14571 3182.8,14571",
		style=dashed];
	layer42_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3289,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer42_moe_split -> layer42_moe_comm_to_expert7	[pos="e,3289,14601 3289,14637 3289,14637 3289,14611 3289,14611",
		style=dashed];
	layer42_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3561,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer42_moe_split -> layer42_moe_comm_to_expert8	[pos="e,3561,14601 3561,14637 3561,14637 3561,14611 3561,14611",
		style=dashed];
	layer42_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3870,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer42_moe_split -> layer42_moe_comm_to_expert9	[pos="e,3779.3,14571 3665.3,14689 3665.3,14685 3665.3,14571 3665.3,14571 3665.3,14571 3769.3,14571 3769.3,14571",
		style=dashed];
	layer42_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4202,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer42_moe_split -> layer42_moe_comm_to_expert10	[pos="e,4126.1,14589 3589.4,14651 3796.6,14651 4126.1,14651 4126.1,14651 4126.1,14651 4126.1,14599 4126.1,14599",
		style=dashed];
	layer42_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4548,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer42_moe_split -> layer42_moe_comm_to_expert11	[pos="e,4472.6,14590 3604.2,14666 3903.5,14666 4472.6,14666 4472.6,14666 4472.6,14666 4472.6,14600 4472.6,14600",
		style=dashed];
	layer42_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4899,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer42_moe_split -> layer42_moe_comm_to_expert12	[pos="e,4823.6,14589 3619.5,14681 4003.8,14681 4823.6,14681 4823.6,14681 4823.6,14681 4823.6,14599 4823.6,14599",
		style=dashed];
	layer42_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5252,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer42_moe_split -> layer42_moe_comm_to_expert13	[pos="e,5177.1,14590 3634.2,14696 4099,14696 5177.1,14696 5177.1,14696 5177.1,14696 5177.1,14600 5177.1,14600",
		style=dashed];
	layer42_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5607,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer42_moe_split -> layer42_moe_comm_to_expert14	[pos="e,5532.1,14590 3649.5,14711 4192.4,14711 5532.1,14711 5532.1,14711 5532.1,14711 5532.1,14600 5532.1,14600",
		style=dashed];
	layer42_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5962,14572",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer42_moe_split -> layer42_moe_comm_to_expert15	[pos="e,5887.1,14590 3664.2,14726 4282.7,14726 5887.1,14726 5887.1,14726 5887.1,14726 5887.1,14600 5887.1,14600",
		style=dashed];
	layer42_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L42\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="830,14481",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer42_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="917,14390",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer42_moe_expert0 -> layer42_moe_comm_from_expert0	[pos="e,910.25,14419 910.25,14455 910.25,14455 910.25,14429 910.25,14429"];
	layer42_moe_comm_to_expert0 -> layer42_moe_expert0	[pos="e,928.75,14507 1253.4,14571 1131.2,14571 928.75,14571 928.75,14571 928.75,14571 928.75,14517 928.75,14517"];
	layer42_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L42\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1176,14481",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer42_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1557,14390",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer42_moe_expert1 -> layer42_moe_comm_from_expert1	[pos="e,1466.5,14389 1330.5,14455 1330.5,14428 1330.5,14389 1330.5,14389 1330.5,14389 1456.5,14389 1456.5,14389"];
	layer42_moe_comm_to_expert1 -> layer42_moe_expert1	[pos="e,1296.7,14507 1589,14543 1589,14529 1589,14515 1589,14515 1589,14515 1296.7,14515 1296.7,14515 1296.7,14515 1296.7,14514 1296.7,\
14514"];
	layer42_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L42\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1522,14481",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer42_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1976,14390",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer42_moe_expert2 -> layer42_moe_comm_from_expert2	[pos="e,1885.3,14389 1676.5,14455 1676.5,14428 1676.5,14389 1676.5,14389 1676.5,14389 1875.3,14389 1875.3,14389"];
	layer42_moe_comm_to_expert2 -> layer42_moe_expert2	[pos="e,1686.2,14480 1954.4,14571 1850.7,14571 1695,14571 1695,14571 1695,14571 1695,14480 1695,14480 1695,14480 1694.1,14480 1694.1,14480"];
	layer42_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L42\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1868,14481",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer42_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2285,14390",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer42_moe_expert3 -> layer42_moe_comm_from_expert3	[pos="e,2285,14419 1958.7,14455 1958.7,14445 1958.7,14436 1958.7,14436 1958.7,14436 2285,14436 2285,14436 2285,14436 2285,14429 2285,14429"];
	layer42_moe_comm_to_expert3 -> layer42_moe_expert3	[pos="e,1993.2,14507 2314.3,14550 2314.3,14541 2314.3,14533 2314.3,14533 2314.3,14533 1993.2,14533 1993.2,14533 1993.2,14533 1993.2,14517 \
1993.2,14517"];
	layer42_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L42\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2214,14481",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer42_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2539,14390",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer42_moe_expert4 -> layer42_moe_comm_from_expert4	[pos="e,2448.4,14389 2378.2,14480 2383.8,14480 2387,14480 2387,14480 2387,14480 2387,14389 2387,14389 2387,14389 2438.4,14389 2438.4,14389"];
	layer42_moe_comm_to_expert4 -> layer42_moe_expert4	[pos="e,2346.2,14507 2634.7,14543 2634.7,14533 2634.7,14524 2634.7,14524 2634.7,14524 2346.2,14524 2346.2,14524 2346.2,14524 2346.2,14517 \
2346.2,14517"];
	layer42_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L42\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2560,14481",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer42_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2766,14390",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer42_moe_expert5 -> layer42_moe_comm_from_expert5	[pos="e,2699.7,14410 2699.7,14455 2699.7,14455 2699.7,14420 2699.7,14420"];
	layer42_moe_comm_to_expert5 -> layer42_moe_expert5	[pos="e,2724.1,14480 2776.3,14571 2752.9,14571 2734.3,14571 2734.3,14571 2734.3,14571 2734.3,14480 2734.3,14480 2734.3,14480 2733.2,14480 \
2733.2,14480"];
	layer42_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L42\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2906,14481",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer42_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2979,14390",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer42_moe_expert6 -> layer42_moe_comm_from_expert6	[pos="e,2979,14419 2979,14455 2979,14455 2979,14429 2979,14429"];
	layer42_moe_comm_to_expert6 -> layer42_moe_expert6	[pos="e,3030.7,14507 3030.7,14548 3030.7,14548 3030.7,14517 3030.7,14517"];
	layer42_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L42\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3252,14481",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer42_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3289,14390",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer42_moe_expert7 -> layer42_moe_comm_from_expert7	[pos="e,3289,14419 3289,14455 3289,14455 3289,14429 3289,14429"];
	layer42_moe_comm_to_expert7 -> layer42_moe_expert7	[pos="e,3289,14507 3289,14543 3289,14543 3289,14517 3289,14517"];
	layer42_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L42\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3598,14481",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer42_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3561,14390",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer42_moe_expert8 -> layer42_moe_comm_from_expert8	[pos="e,3561,14419 3561,14455 3561,14455 3561,14429 3561,14429"];
	layer42_moe_comm_to_expert8 -> layer42_moe_expert8	[pos="e,3561,14507 3561,14543 3561,14543 3561,14517 3561,14517"];
	layer42_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L42\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3944,14481",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer42_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3870,14390",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer42_moe_expert9 -> layer42_moe_comm_from_expert9	[pos="e,3870.3,14419 3870.3,14455 3870.3,14455 3870.3,14429 3870.3,14429"];
	layer42_moe_comm_to_expert9 -> layer42_moe_expert9	[pos="e,3870.3,14507 3870.3,14543 3870.3,14543 3870.3,14517 3870.3,14517"];
	layer42_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L42\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4295,14481",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer42_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4202,14390",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer42_moe_expert10 -> layer42_moe_comm_from_expert10	[pos="e,4211.4,14419 4211.4,14455 4211.4,14455 4211.4,14429 4211.4,14429"];
	layer42_moe_comm_to_expert10 -> layer42_moe_expert10	[pos="e,4211,14507 4211,14543 4211,14543 4211,14517 4211,14517"];
	layer42_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L42\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4651,14481",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer42_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4549,14390",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer42_moe_expert11 -> layer42_moe_comm_from_expert11	[pos="e,4562.9,14419 4562.9,14455 4562.9,14455 4562.9,14429 4562.9,14429"];
	layer42_moe_comm_to_expert11 -> layer42_moe_expert11	[pos="e,4562,14507 4562,14543 4562,14543 4562,14517 4562,14517"];
	layer42_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L42\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="5007,14481",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer42_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4900,14390",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer42_moe_expert12 -> layer42_moe_comm_from_expert12	[pos="e,4916.4,14419 4916.4,14455 4916.4,14455 4916.4,14429 4916.4,14429"];
	layer42_moe_comm_to_expert12 -> layer42_moe_expert12	[pos="e,4915.5,14507 4915.5,14543 4915.5,14543 4915.5,14517 4915.5,14517"];
	layer42_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L42\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5363,14481",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer42_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5254,14390",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer42_moe_expert13 -> layer42_moe_comm_from_expert13	[pos="e,5271.4,14419 5271.4,14455 5271.4,14455 5271.4,14429 5271.4,14429"];
	layer42_moe_comm_to_expert13 -> layer42_moe_expert13	[pos="e,5270,14507 5270,14543 5270,14543 5270,14517 5270,14517"];
	layer42_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L42\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5719,14481",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer42_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5609,14390",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer42_moe_expert14 -> layer42_moe_comm_from_expert14	[pos="e,5626.9,14418 5626.9,14455 5626.9,14455 5626.9,14428 5626.9,14428"];
	layer42_moe_comm_to_expert14 -> layer42_moe_expert14	[pos="e,5625.5,14507 5625.5,14543 5625.5,14543 5625.5,14517 5625.5,14517"];
	layer42_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L42\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6075,14481",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer42_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5964,14390",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer42_moe_expert15 -> layer42_moe_comm_from_expert15	[pos="e,5982.4,14418 5982.4,14455 5982.4,14455 5982.4,14428 5982.4,14428"];
	layer42_moe_comm_to_expert15 -> layer42_moe_expert15	[pos="e,5981,14507 5981,14543 5981,14543 5981,14517 5981,14517"];
	layer42_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L42\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3388,14273",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer43_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L43\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3388,14159",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer42_moe_aggregate -> layer43_moe_mha	[pos="e,3388,14185 3388,14221 3388,14221 3388,14195 3388,14195"];
	layer42_moe_comm_from_expert0 -> layer42_moe_aggregate	[pos="e,3138.3,14233 991.25,14373 991.25,14333 991.25,14233 991.25,14233 991.25,14233 3128.3,14233 3128.3,14233"];
	layer42_moe_comm_from_expert1 -> layer42_moe_aggregate	[pos="e,3151.3,14246 1622.8,14370 1622.8,14330 1622.8,14246 1622.8,14246 1622.8,14246 3141.3,14246 3141.3,14246"];
	layer42_moe_comm_from_expert2 -> layer42_moe_aggregate	[pos="e,3164.8,14259 2048,14372 2048,14337 2048,14259 2048,14259 2048,14259 3154.8,14259 3154.8,14259"];
	layer42_moe_comm_from_expert3 -> layer42_moe_aggregate	[pos="e,3178.4,14272 2367.3,14378 2367.3,14348 2367.3,14272 2367.3,14272 2367.3,14272 3168.4,14272 3168.4,14272"];
	layer42_moe_comm_from_expert4 -> layer42_moe_aggregate	[pos="e,3191.9,14285 2611,14372 2611,14342 2611,14285 2611,14285 2611,14285 3181.9,14285 3181.9,14285"];
	layer42_moe_comm_from_expert5 -> layer42_moe_aggregate	[pos="e,3205.2,14298 2835.5,14371 2835.5,14344 2835.5,14298 2835.5,14298 2835.5,14298 3195.2,14298 3195.2,14298"];
	layer42_moe_comm_from_expert6 -> layer42_moe_aggregate	[pos="e,3218.4,14311 3060.3,14377 3060.3,14354 3060.3,14311 3060.3,14311 3060.3,14311 3208.4,14311 3208.4,14311"];
	layer42_moe_comm_from_expert7 -> layer42_moe_aggregate	[pos="e,3289,14325 3289,14361 3289,14361 3289,14335 3289,14335"];
	layer42_moe_comm_from_expert8 -> layer42_moe_aggregate	[pos="e,3560.4,14325 3560.4,14361 3560.4,14361 3560.4,14335 3560.4,14335"];
	layer42_moe_comm_from_expert9 -> layer42_moe_aggregate	[pos="e,3636,14311 3851.5,14361 3851.5,14339 3851.5,14311 3851.5,14311 3851.5,14311 3646,14311 3646,14311"];
	layer42_moe_comm_from_expert10 -> layer42_moe_aggregate	[pos="e,3622.5,14298 4183.1,14361 4183.1,14334 4183.1,14298 4183.1,14298 4183.1,14298 3632.5,14298 3632.5,14298"];
	layer42_moe_comm_from_expert11 -> layer42_moe_aggregate	[pos="e,3609.1,14285 4529.6,14362 4529.6,14330 4529.6,14285 4529.6,14285 4529.6,14285 3619.1,14285 3619.1,14285"];
	layer42_moe_comm_from_expert12 -> layer42_moe_aggregate	[pos="e,3595.5,14272 4880.6,14361 4880.6,14326 4880.6,14272 4880.6,14272 4880.6,14272 3605.5,14272 3605.5,14272"];
	layer42_moe_comm_from_expert13 -> layer42_moe_aggregate	[pos="e,3582.5,14259 5234.1,14362 5234.1,14323 5234.1,14259 5234.1,14259 5234.1,14259 3592.5,14259 3592.5,14259"];
	layer42_moe_comm_from_expert14 -> layer42_moe_aggregate	[pos="e,3569.1,14246 5589.1,14361 5589.1,14320 5589.1,14246 5589.1,14246 5589.1,14246 3579.1,14246 3579.1,14246"];
	layer42_moe_comm_from_expert15 -> layer42_moe_aggregate	[pos="e,3555.7,14233 5944.1,14361 5944.1,14316 5944.1,14233 5944.1,14233 5944.1,14233 3565.7,14233 3565.7,14233"];
	layer43_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L43\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3388,14045",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer43_moe_mha -> layer43_moe_gate	[pos="e,3388,14097 3388,14133 3388,14133 3388,14107 3388,14107"];
	layer43_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L43\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3388,13905",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer43_moe_gate -> layer43_moe_split	[pos="e,3388,13957 3388,13993 3388,13993 3388,13967 3388,13967"];
	layer43_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="880,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer43_moe_split -> layer43_moe_comm_to_expert0	[pos="e,898.5,13817 3222.7,13942 2666.7,13942 898.5,13942 898.5,13942 898.5,13942 898.5,13827 898.5,13827",
		style=dashed];
	layer43_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1520,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer43_moe_split -> layer43_moe_comm_to_expert1	[pos="e,1538.5,13816 3207.7,13927 2742.6,13927 1538.5,13927 1538.5,13927 1538.5,13927 1538.5,13826 1538.5,13826",
		style=dashed];
	layer43_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1939,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer43_moe_split -> layer43_moe_comm_to_expert2	[pos="e,1957.5,13816 3192.8,13912 2801.4,13912 1957.5,13912 1957.5,13912 1957.5,13912 1957.5,13826 1957.5,13826",
		style=dashed];
	layer43_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2248,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer43_moe_split -> layer43_moe_comm_to_expert3	[pos="e,2266.5,13817 3178,13897 2853.4,13897 2266.5,13897 2266.5,13897 2266.5,13897 2266.5,13827 2266.5,13827",
		style=dashed];
	layer43_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2502,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer43_moe_split -> layer43_moe_comm_to_expert4	[pos="e,2520.5,13816 3162.9,13882 2905.9,13882 2520.5,13882 2520.5,13882 2520.5,13882 2520.5,13826 2520.5,13826",
		style=dashed];
	layer43_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2729,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer43_moe_split -> layer43_moe_comm_to_expert5	[pos="e,2747.5,13816 3147.7,13867 2965.9,13867 2747.5,13867 2747.5,13867 2747.5,13867 2747.5,13826 2747.5,13826",
		style=dashed];
	layer43_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2942,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer43_moe_split -> layer43_moe_comm_to_expert6	[pos="e,3032.5,13787 3147.7,13905 3147.7,13901 3147.7,13787 3147.7,13787 3147.7,13787 3042.5,13787 3042.5,13787",
		style=dashed];
	layer43_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3252,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer43_moe_split -> layer43_moe_comm_to_expert7	[pos="e,3252,13817 3252,13853 3252,13853 3252,13827 3252,13827",
		style=dashed];
	layer43_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3524,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer43_moe_split -> layer43_moe_comm_to_expert8	[pos="e,3524,13817 3524,13853 3524,13853 3524,13827 3524,13827",
		style=dashed];
	layer43_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3833,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer43_moe_split -> layer43_moe_comm_to_expert9	[pos="e,3742.3,13787 3628.3,13905 3628.3,13901 3628.3,13787 3628.3,13787 3628.3,13787 3732.3,13787 3732.3,13787",
		style=dashed];
	layer43_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4165,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer43_moe_split -> layer43_moe_comm_to_expert10	[pos="e,4089.1,13805 3552.4,13867 3759.6,13867 4089.1,13867 4089.1,13867 4089.1,13867 4089.1,13815 4089.1,13815",
		style=dashed];
	layer43_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4511,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer43_moe_split -> layer43_moe_comm_to_expert11	[pos="e,4435.6,13806 3567.2,13882 3866.5,13882 4435.6,13882 4435.6,13882 4435.6,13882 4435.6,13816 4435.6,13816",
		style=dashed];
	layer43_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4862,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer43_moe_split -> layer43_moe_comm_to_expert12	[pos="e,4786.6,13805 3582.5,13897 3966.8,13897 4786.6,13897 4786.6,13897 4786.6,13897 4786.6,13815 4786.6,13815",
		style=dashed];
	layer43_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5215,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer43_moe_split -> layer43_moe_comm_to_expert13	[pos="e,5140.1,13806 3597.2,13912 4062,13912 5140.1,13912 5140.1,13912 5140.1,13912 5140.1,13816 5140.1,13816",
		style=dashed];
	layer43_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5570,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer43_moe_split -> layer43_moe_comm_to_expert14	[pos="e,5495.1,13806 3612.5,13927 4155.4,13927 5495.1,13927 5495.1,13927 5495.1,13927 5495.1,13816 5495.1,13816",
		style=dashed];
	layer43_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5925,13788",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer43_moe_split -> layer43_moe_comm_to_expert15	[pos="e,5850.1,13806 3627.2,13942 4245.7,13942 5850.1,13942 5850.1,13942 5850.1,13942 5850.1,13816 5850.1,13816",
		style=dashed];
	layer43_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L43\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="793,13697",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer43_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1307,13606",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer43_moe_expert0 -> layer43_moe_comm_from_expert0	[pos="e,1216.3,13605 947.5,13671 947.5,13644 947.5,13605 947.5,13605 947.5,13605 1206.3,13605 1206.3,13605"];
	layer43_moe_comm_to_expert0 -> layer43_moe_expert0	[pos="e,873.25,13723 873.25,13759 873.25,13759 873.25,13733 873.25,13733"];
	layer43_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L43\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1139,13697",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer43_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1552,13606",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer43_moe_expert1 -> layer43_moe_comm_from_expert1	[pos="e,1552,13635 1259.7,13671 1259.7,13657 1259.7,13643 1259.7,13643 1259.7,13643 1552,13643 1552,13643 1552,13643 1552,13642 1552,13642"];
	layer43_moe_comm_to_expert1 -> layer43_moe_expert1	[pos="e,1157.5,13723 1429.5,13787 1322.1,13787 1157.5,13787 1157.5,13787 1157.5,13787 1157.5,13733 1157.5,13733"];
	layer43_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L43\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1485,13697",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer43_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="2008,13606",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer43_moe_expert2 -> layer43_moe_comm_from_expert2	[pos="e,1917.4,13605 1649.2,13696 1654.8,13696 1658,13696 1658,13696 1658,13696 1658,13605 1658,13605 1658,13605 1907.4,13605 1907.4,13605"];
	layer43_moe_comm_to_expert2 -> layer43_moe_expert2	[pos="e,1635.2,13723 1848.3,13787 1758.7,13787 1635.2,13787 1635.2,13787 1635.2,13787 1635.2,13733 1635.2,13733"];
	layer43_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L43\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1831,13697",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer43_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2336,13606",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer43_moe_expert3 -> layer43_moe_comm_from_expert3	[pos="e,2277.3,13628 1956.2,13671 1956.2,13661 1956.2,13652 1956.2,13652 1956.2,13652 2277.3,13652 2277.3,13652 2277.3,13652 2277.3,13638 \
2277.3,13638"];
	layer43_moe_comm_to_expert3 -> layer43_moe_expert3	[pos="e,1921.7,13723 2248,13759 2248,13749 2248,13740 2248,13740 2248,13740 1921.7,13740 1921.7,13740 1921.7,13740 1921.7,13733 1921.7,\
13733"];
	layer43_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L43\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2177,13697",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer43_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2599,13606",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer43_moe_expert4 -> layer43_moe_comm_from_expert4	[pos="e,2597.7,13635 2309.2,13671 2309.2,13665 2309.2,13661 2309.2,13661 2309.2,13661 2597.7,13661 2597.7,13661 2597.7,13661 2597.7,13645 \
2597.7,13645"];
	layer43_moe_comm_to_expert4 -> layer43_moe_expert4	[pos="e,2341.2,13696 2411.4,13787 2378.8,13787 2350,13787 2350,13787 2350,13787 2350,13696 2350,13696 2350,13696 2349.1,13696 2349.1,13696"];
	layer43_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L43\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2523,13697",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer43_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2830,13606",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer43_moe_expert5 -> layer43_moe_comm_from_expert5	[pos="e,2739.5,13605 2687.2,13696 2692.8,13696 2696,13696 2696,13696 2696,13696 2696,13605 2696,13605 2696,13605 2729.5,13605 2729.5,13605"];
	layer43_moe_comm_to_expert5 -> layer43_moe_expert5	[pos="e,2662.7,13723 2662.7,13768 2662.7,13768 2662.7,13733 2662.7,13733"];
	layer43_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L43\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2869,13697",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer43_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3045,13606",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer43_moe_expert6 -> layer43_moe_comm_from_expert6	[pos="e,2993.7,13630 2993.7,13671 2993.7,13671 2993.7,13640 2993.7,13640"];
	layer43_moe_comm_to_expert6 -> layer43_moe_expert6	[pos="e,2942,13723 2942,13759 2942,13759 2942,13733 2942,13733"];
	layer43_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L43\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3215,13697",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer43_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3252,13606",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer43_moe_expert7 -> layer43_moe_comm_from_expert7	[pos="e,3252,13635 3252,13671 3252,13671 3252,13645 3252,13645"];
	layer43_moe_comm_to_expert7 -> layer43_moe_expert7	[pos="e,3252,13723 3252,13759 3252,13759 3252,13733 3252,13733"];
	layer43_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L43\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3561,13697",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer43_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3524,13606",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer43_moe_expert8 -> layer43_moe_comm_from_expert8	[pos="e,3524,13635 3524,13671 3524,13671 3524,13645 3524,13645"];
	layer43_moe_comm_to_expert8 -> layer43_moe_expert8	[pos="e,3524,13723 3524,13759 3524,13759 3524,13733 3524,13733"];
	layer43_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L43\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3907,13697",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer43_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3833,13606",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer43_moe_expert9 -> layer43_moe_comm_from_expert9	[pos="e,3833.3,13635 3833.3,13671 3833.3,13671 3833.3,13645 3833.3,13645"];
	layer43_moe_comm_to_expert9 -> layer43_moe_expert9	[pos="e,3833.3,13723 3833.3,13759 3833.3,13759 3833.3,13733 3833.3,13733"];
	layer43_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L43\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4258,13697",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer43_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4165,13606",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer43_moe_expert10 -> layer43_moe_comm_from_expert10	[pos="e,4174.4,13635 4174.4,13671 4174.4,13671 4174.4,13645 4174.4,13645"];
	layer43_moe_comm_to_expert10 -> layer43_moe_expert10	[pos="e,4174,13723 4174,13759 4174,13759 4174,13733 4174,13733"];
	layer43_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L43\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4614,13697",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer43_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4512,13606",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer43_moe_expert11 -> layer43_moe_comm_from_expert11	[pos="e,4525.9,13635 4525.9,13671 4525.9,13671 4525.9,13645 4525.9,13645"];
	layer43_moe_comm_to_expert11 -> layer43_moe_expert11	[pos="e,4525,13723 4525,13759 4525,13759 4525,13733 4525,13733"];
	layer43_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L43\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4970,13697",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer43_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4863,13606",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer43_moe_expert12 -> layer43_moe_comm_from_expert12	[pos="e,4879.4,13635 4879.4,13671 4879.4,13671 4879.4,13645 4879.4,13645"];
	layer43_moe_comm_to_expert12 -> layer43_moe_expert12	[pos="e,4878.5,13723 4878.5,13759 4878.5,13759 4878.5,13733 4878.5,13733"];
	layer43_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L43\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5326,13697",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer43_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5217,13606",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer43_moe_expert13 -> layer43_moe_comm_from_expert13	[pos="e,5234.4,13635 5234.4,13671 5234.4,13671 5234.4,13645 5234.4,13645"];
	layer43_moe_comm_to_expert13 -> layer43_moe_expert13	[pos="e,5233,13723 5233,13759 5233,13759 5233,13733 5233,13733"];
	layer43_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L43\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5682,13697",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer43_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5572,13606",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer43_moe_expert14 -> layer43_moe_comm_from_expert14	[pos="e,5589.9,13634 5589.9,13671 5589.9,13671 5589.9,13644 5589.9,13644"];
	layer43_moe_comm_to_expert14 -> layer43_moe_expert14	[pos="e,5588.5,13723 5588.5,13759 5588.5,13759 5588.5,13733 5588.5,13733"];
	layer43_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L43\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6038,13697",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer43_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5927,13606",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer43_moe_expert15 -> layer43_moe_comm_from_expert15	[pos="e,5945.4,13634 5945.4,13671 5945.4,13671 5945.4,13644 5945.4,13644"];
	layer43_moe_comm_to_expert15 -> layer43_moe_expert15	[pos="e,5944,13723 5944,13759 5944,13759 5944,13733 5944,13733"];
	layer43_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L43\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3351,13489",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer44_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L44\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3351,13375",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer43_moe_aggregate -> layer44_moe_mha	[pos="e,3351,13401 3351,13437 3351,13437 3351,13411 3351,13411"];
	layer43_moe_comm_from_expert0 -> layer43_moe_aggregate	[pos="e,3103.2,13451 1379,13588 1379,13547 1379,13451 1379,13451 1379,13451 3093.2,13451 3093.2,13451"];
	layer43_moe_comm_from_expert1 -> layer43_moe_aggregate	[pos="e,3118.9,13466 1636.3,13595 1636.3,13562 1636.3,13466 1636.3,13466 1636.3,13466 3108.9,13466 3108.9,13466"];
	layer43_moe_comm_from_expert2 -> layer43_moe_aggregate	[pos="e,3134.3,13481 2080,13588 2080,13554 2080,13481 2080,13481 2080,13481 3124.3,13481 3124.3,13481"];
	layer43_moe_comm_from_expert3 -> layer43_moe_aggregate	[pos="e,3149.6,13496 2408,13588 2408,13557 2408,13496 2408,13496 2408,13496 3139.6,13496 3139.6,13496"];
	layer43_moe_comm_from_expert4 -> layer43_moe_aggregate	[pos="e,3165.1,13511 2678.8,13592 2678.8,13566 2678.8,13511 2678.8,13511 2678.8,13511 3155.1,13511 3155.1,13511"];
	layer43_moe_comm_from_expert5 -> layer43_moe_aggregate	[pos="e,3180.7,13526 2900.5,13587 2900.5,13564 2900.5,13526 2900.5,13526 2900.5,13526 3170.7,13526 3170.7,13526"];
	layer43_moe_comm_from_expert6 -> layer43_moe_aggregate	[pos="e,3112.1,13489 3112.1,13586 3112.1,13586 3112.1,13499 3112.1,13499"];
	layer43_moe_comm_from_expert7 -> layer43_moe_aggregate	[pos="e,3252,13541 3252,13577 3252,13577 3252,13551 3252,13551"];
	layer43_moe_comm_from_expert8 -> layer43_moe_aggregate	[pos="e,3523.4,13541 3523.4,13577 3523.4,13577 3523.4,13551 3523.4,13551"];
	layer43_moe_comm_from_expert9 -> layer43_moe_aggregate	[pos="e,3599,13527 3814.5,13577 3814.5,13555 3814.5,13527 3814.5,13527 3814.5,13527 3609,13527 3609,13527"];
	layer43_moe_comm_from_expert10 -> layer43_moe_aggregate	[pos="e,3585.5,13514 4146.1,13577 4146.1,13550 4146.1,13514 4146.1,13514 4146.1,13514 3595.5,13514 3595.5,13514"];
	layer43_moe_comm_from_expert11 -> layer43_moe_aggregate	[pos="e,3572.1,13501 4492.6,13578 4492.6,13546 4492.6,13501 4492.6,13501 4492.6,13501 3582.1,13501 3582.1,13501"];
	layer43_moe_comm_from_expert12 -> layer43_moe_aggregate	[pos="e,3558.5,13488 4843.6,13577 4843.6,13542 4843.6,13488 4843.6,13488 4843.6,13488 3568.5,13488 3568.5,13488"];
	layer43_moe_comm_from_expert13 -> layer43_moe_aggregate	[pos="e,3545.1,13475 5197.1,13578 5197.1,13539 5197.1,13475 5197.1,13475 5197.1,13475 3555.1,13475 3555.1,13475"];
	layer43_moe_comm_from_expert14 -> layer43_moe_aggregate	[pos="e,3532.1,13462 5552.1,13578 5552.1,13536 5552.1,13462 5552.1,13462 5552.1,13462 3542.1,13462 3542.1,13462"];
	layer43_moe_comm_from_expert15 -> layer43_moe_aggregate	[pos="e,3518.7,13449 5907.1,13578 5907.1,13532 5907.1,13449 5907.1,13449 5907.1,13449 3528.7,13449 3528.7,13449"];
	layer44_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L44\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3351,13261",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer44_moe_mha -> layer44_moe_gate	[pos="e,3351,13313 3351,13349 3351,13349 3351,13323 3351,13323"];
	layer44_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L44\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3351,13121",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer44_moe_gate -> layer44_moe_split	[pos="e,3351,13173 3351,13209 3351,13209 3351,13183 3351,13183"];
	layer44_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1270,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer44_moe_split -> layer44_moe_comm_to_expert0	[pos="e,1288.5,13033 3185.7,13158 2696.3,13158 1288.5,13158 1288.5,13158 1288.5,13158 1288.5,13043 1288.5,13043",
		style=dashed];
	layer44_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1515,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer44_moe_split -> layer44_moe_comm_to_expert1	[pos="e,1533.5,13032 3170.9,13143 2711.8,13143 1533.5,13143 1533.5,13143 1533.5,13143 1533.5,13042 1533.5,13042",
		style=dashed];
	layer44_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1971,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer44_moe_split -> layer44_moe_comm_to_expert2	[pos="e,1989.5,13032 3155.9,13128 2779.5,13128 1989.5,13128 1989.5,13128 1989.5,13128 1989.5,13042 1989.5,13042",
		style=dashed];
	layer44_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2299,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer44_moe_split -> layer44_moe_comm_to_expert3	[pos="e,2317.5,13033 3140.9,13113 2838.8,13113 2317.5,13113 2317.5,13113 2317.5,13113 2317.5,13043 2317.5,13043",
		style=dashed];
	layer44_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2562,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer44_moe_split -> layer44_moe_comm_to_expert4	[pos="e,2580.5,13032 3125.8,13098 2898.4,13098 2580.5,13098 2580.5,13098 2580.5,13098 2580.5,13042 2580.5,13042",
		style=dashed];
	layer44_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2793,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer44_moe_split -> layer44_moe_comm_to_expert5	[pos="e,2811.5,13032 3110.8,13083 2966.9,13083 2811.5,13083 2811.5,13083 2811.5,13083 2811.5,13042 2811.5,13042",
		style=dashed];
	layer44_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="3008,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer44_moe_split -> layer44_moe_comm_to_expert6	[pos="e,3098.8,13003 3111.5,13121 3111.5,13117 3111.5,13003 3111.5,13003 3111.5,13003 3108.8,13003 3108.8,13003",
		style=dashed];
	layer44_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3215,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer44_moe_split -> layer44_moe_comm_to_expert7	[pos="e,3215,13033 3215,13069 3215,13069 3215,13043 3215,13043",
		style=dashed];
	layer44_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3487,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer44_moe_split -> layer44_moe_comm_to_expert8	[pos="e,3487,13033 3487,13069 3487,13069 3487,13043 3487,13043",
		style=dashed];
	layer44_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3796,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer44_moe_split -> layer44_moe_comm_to_expert9	[pos="e,3705.3,13003 3591.3,13121 3591.3,13117 3591.3,13003 3591.3,13003 3591.3,13003 3695.3,13003 3695.3,13003",
		style=dashed];
	layer44_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4128,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer44_moe_split -> layer44_moe_comm_to_expert10	[pos="e,4052.1,13021 3515.4,13083 3722.6,13083 4052.1,13083 4052.1,13083 4052.1,13083 4052.1,13031 4052.1,13031",
		style=dashed];
	layer44_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4474,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer44_moe_split -> layer44_moe_comm_to_expert11	[pos="e,4398.6,13022 3530.2,13098 3829.5,13098 4398.6,13098 4398.6,13098 4398.6,13098 4398.6,13032 4398.6,13032",
		style=dashed];
	layer44_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4825,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer44_moe_split -> layer44_moe_comm_to_expert12	[pos="e,4749.6,13021 3545.1,13113 3929.2,13113 4749.6,13113 4749.6,13113 4749.6,13113 4749.6,13031 4749.6,13031",
		style=dashed];
	layer44_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5178,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer44_moe_split -> layer44_moe_comm_to_expert13	[pos="e,5103.1,13022 3560.2,13128 4025,13128 5103.1,13128 5103.1,13128 5103.1,13128 5103.1,13032 5103.1,13032",
		style=dashed];
	layer44_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5533,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer44_moe_split -> layer44_moe_comm_to_expert14	[pos="e,5458.1,13022 3575.5,13143 4118.4,13143 5458.1,13143 5458.1,13143 5458.1,13143 5458.1,13032 5458.1,13032",
		style=dashed];
	layer44_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5888,13004",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer44_moe_split -> layer44_moe_comm_to_expert15	[pos="e,5813.1,13022 3590.2,13158 4208.7,13158 5813.1,13158 5813.1,13158 5813.1,13158 5813.1,13032 5813.1,13032",
		style=dashed];
	layer44_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L44\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="756,12913",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer44_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="802,12822",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer44_moe_expert0 -> layer44_moe_comm_from_expert0	[pos="e,802,12851 802,12887 802,12887 802,12861 802,12861"];
	layer44_moe_comm_to_expert0 -> layer44_moe_expert0	[pos="e,774.5,12939 1179.4,13003 1036.4,13003 774.5,13003 774.5,13003 774.5,13003 774.5,12949 774.5,12949"];
	layer44_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L44\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1102,12913",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer44_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1515,12822",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer44_moe_expert1 -> layer44_moe_comm_from_expert1	[pos="e,1424.2,12821 1256.5,12887 1256.5,12860 1256.5,12821 1256.5,12821 1256.5,12821 1414.2,12821 1414.2,12821"];
	layer44_moe_comm_to_expert1 -> layer44_moe_expert1	[pos="e,1222.7,12939 1515,12975 1515,12961 1515,12947 1515,12947 1515,12947 1222.7,12947 1222.7,12947 1222.7,12947 1222.7,12946 1222.7,\
12946"];
	layer44_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L44\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1448,12913",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer44_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1971,12822",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer44_moe_expert2 -> layer44_moe_comm_from_expert2	[pos="e,1880.3,12821 1612.2,12904 1619.6,12904 1624,12904 1624,12904 1624,12904 1624,12821 1624,12821 1624,12821 1870.3,12821 1870.3,12821"];
	layer44_moe_comm_to_expert2 -> layer44_moe_expert2	[pos="e,1612.3,12921 1880.1,13003 1775.5,13003 1618,13003 1618,13003 1618,13003 1618,12921 1618,12921 1618,12921 1617.4,12921 1617.4,12921"];
	layer44_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L44\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1794,12913",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer44_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2299,12822",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer44_moe_expert3 -> layer44_moe_comm_from_expert3	[pos="e,2240.3,12844 1919.2,12887 1919.2,12874 1919.2,12862 1919.2,12862 1919.2,12862 2240.3,12862 2240.3,12862 2240.3,12862 2240.3,12854 \
2240.3,12854"];
	layer44_moe_comm_to_expert3 -> layer44_moe_expert3	[pos="e,1919.2,12939 2240.3,12982 2240.3,12973 2240.3,12965 2240.3,12965 2240.3,12965 1919.2,12965 1919.2,12965 1919.2,12965 1919.2,12949 \
1919.2,12949"];
	layer44_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L44\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2140,12913",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer44_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2562,12822",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer44_moe_expert4 -> layer44_moe_comm_from_expert4	[pos="e,2560.7,12851 2272.2,12887 2272.2,12880 2272.2,12874 2272.2,12874 2272.2,12874 2560.7,12874 2560.7,12874 2560.7,12874 2560.7,12861 \
2560.7,12861"];
	layer44_moe_comm_to_expert4 -> layer44_moe_expert4	[pos="e,2272.2,12939 2560.7,12975 2560.7,12965 2560.7,12956 2560.7,12956 2560.7,12956 2272.2,12956 2272.2,12956 2272.2,12956 2272.2,12949 \
2272.2,12949"];
	layer44_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L44\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2486,12913",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer44_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2793,12822",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer44_moe_expert5 -> layer44_moe_comm_from_expert5	[pos="e,2702.5,12821 2650.2,12904 2657.1,12904 2661.2,12904 2661.2,12904 2661.2,12904 2661.2,12821 2661.2,12821 2661.2,12821 2692.5,12821 \
2692.5,12821"];
	layer44_moe_comm_to_expert5 -> layer44_moe_expert5	[pos="e,2650.3,12921 2702.2,13003 2677.2,13003 2656.8,13003 2656.8,13003 2656.8,13003 2656.8,12921 2656.8,12921 2656.8,12921 2656.2,12921 \
2656.2,12921"];
	layer44_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L44\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2832,12913",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer44_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="3008,12822",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer44_moe_expert6 -> layer44_moe_comm_from_expert6	[pos="e,2956.7,12846 2956.7,12887 2956.7,12887 2956.7,12856 2956.7,12856"];
	layer44_moe_comm_to_expert6 -> layer44_moe_expert6	[pos="e,2956.7,12939 2956.7,12980 2956.7,12980 2956.7,12949 2956.7,12949"];
	layer44_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L44\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3178,12913",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer44_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3215,12822",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer44_moe_expert7 -> layer44_moe_comm_from_expert7	[pos="e,3215,12851 3215,12887 3215,12887 3215,12861 3215,12861"];
	layer44_moe_comm_to_expert7 -> layer44_moe_expert7	[pos="e,3215,12939 3215,12975 3215,12975 3215,12949 3215,12949"];
	layer44_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L44\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3524,12913",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer44_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3487,12822",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer44_moe_expert8 -> layer44_moe_comm_from_expert8	[pos="e,3487,12851 3487,12887 3487,12887 3487,12861 3487,12861"];
	layer44_moe_comm_to_expert8 -> layer44_moe_expert8	[pos="e,3487,12939 3487,12975 3487,12975 3487,12949 3487,12949"];
	layer44_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L44\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3870,12913",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer44_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3796,12822",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer44_moe_expert9 -> layer44_moe_comm_from_expert9	[pos="e,3796.3,12851 3796.3,12887 3796.3,12887 3796.3,12861 3796.3,12861"];
	layer44_moe_comm_to_expert9 -> layer44_moe_expert9	[pos="e,3796.3,12939 3796.3,12975 3796.3,12975 3796.3,12949 3796.3,12949"];
	layer44_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L44\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4221,12913",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer44_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4128,12822",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer44_moe_expert10 -> layer44_moe_comm_from_expert10	[pos="e,4137.4,12851 4137.4,12887 4137.4,12887 4137.4,12861 4137.4,12861"];
	layer44_moe_comm_to_expert10 -> layer44_moe_expert10	[pos="e,4137,12939 4137,12975 4137,12975 4137,12949 4137,12949"];
	layer44_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L44\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4577,12913",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer44_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4475,12822",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer44_moe_expert11 -> layer44_moe_comm_from_expert11	[pos="e,4488.9,12851 4488.9,12887 4488.9,12887 4488.9,12861 4488.9,12861"];
	layer44_moe_comm_to_expert11 -> layer44_moe_expert11	[pos="e,4488,12939 4488,12975 4488,12975 4488,12949 4488,12949"];
	layer44_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L44\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4933,12913",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer44_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4826,12822",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer44_moe_expert12 -> layer44_moe_comm_from_expert12	[pos="e,4842.4,12851 4842.4,12887 4842.4,12887 4842.4,12861 4842.4,12861"];
	layer44_moe_comm_to_expert12 -> layer44_moe_expert12	[pos="e,4841.5,12939 4841.5,12975 4841.5,12975 4841.5,12949 4841.5,12949"];
	layer44_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L44\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5289,12913",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer44_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5180,12822",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer44_moe_expert13 -> layer44_moe_comm_from_expert13	[pos="e,5197.4,12851 5197.4,12887 5197.4,12887 5197.4,12861 5197.4,12861"];
	layer44_moe_comm_to_expert13 -> layer44_moe_expert13	[pos="e,5196,12939 5196,12975 5196,12975 5196,12949 5196,12949"];
	layer44_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L44\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5645,12913",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer44_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5535,12822",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer44_moe_expert14 -> layer44_moe_comm_from_expert14	[pos="e,5552.9,12850 5552.9,12887 5552.9,12887 5552.9,12860 5552.9,12860"];
	layer44_moe_comm_to_expert14 -> layer44_moe_expert14	[pos="e,5551.5,12939 5551.5,12975 5551.5,12975 5551.5,12949 5551.5,12949"];
	layer44_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L44\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="6001,12913",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer44_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5890,12822",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer44_moe_expert15 -> layer44_moe_comm_from_expert15	[pos="e,5908.4,12850 5908.4,12887 5908.4,12887 5908.4,12860 5908.4,12860"];
	layer44_moe_comm_to_expert15 -> layer44_moe_expert15	[pos="e,5907,12939 5907,12975 5907,12975 5907,12949 5907,12949"];
	layer44_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L44\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3314,12705",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer45_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L45\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3314,12591",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer44_moe_aggregate -> layer45_moe_mha	[pos="e,3314,12617 3314,12653 3314,12653 3314,12627 3314,12627"];
	layer44_moe_comm_from_expert0 -> layer44_moe_aggregate	[pos="e,3066.3,12667 887.75,12812 887.75,12778 887.75,12667 887.75,12667 887.75,12667 3056.3,12667 3056.3,12667"];
	layer44_moe_comm_from_expert1 -> layer44_moe_aggregate	[pos="e,3081.4,12682 1599.3,12811 1599.3,12778 1599.3,12682 1599.3,12682 1599.3,12682 3071.4,12682 3071.4,12682"];
	layer44_moe_comm_from_expert2 -> layer44_moe_aggregate	[pos="e,3097,12697 2043,12804 2043,12770 2043,12697 2043,12697 2043,12697 3087,12697 3087,12697"];
	layer44_moe_comm_from_expert3 -> layer44_moe_aggregate	[pos="e,3112.6,12712 2371,12804 2371,12773 2371,12712 2371,12712 2371,12712 3102.6,12712 3102.6,12712"];
	layer44_moe_comm_from_expert4 -> layer44_moe_aggregate	[pos="e,3128.1,12727 2641.8,12808 2641.8,12782 2641.8,12727 2641.8,12727 2641.8,12727 3118.1,12727 3118.1,12727"];
	layer44_moe_comm_from_expert5 -> layer44_moe_aggregate	[pos="e,3143.7,12742 2863.5,12803 2863.5,12780 2863.5,12742 2863.5,12742 2863.5,12742 3133.7,12742 3133.7,12742"];
	layer44_moe_comm_from_expert6 -> layer44_moe_aggregate	[pos="e,3075.1,12705 3075.1,12802 3075.1,12802 3075.1,12715 3075.1,12715"];
	layer44_moe_comm_from_expert7 -> layer44_moe_aggregate	[pos="e,3215,12757 3215,12793 3215,12793 3215,12767 3215,12767"];
	layer44_moe_comm_from_expert8 -> layer44_moe_aggregate	[pos="e,3486.4,12757 3486.4,12793 3486.4,12793 3486.4,12767 3486.4,12767"];
	layer44_moe_comm_from_expert9 -> layer44_moe_aggregate	[pos="e,3561.7,12743 3777.5,12793 3777.5,12771 3777.5,12743 3777.5,12743 3777.5,12743 3571.7,12743 3571.7,12743"];
	layer44_moe_comm_from_expert10 -> layer44_moe_aggregate	[pos="e,3548.3,12730 4109.1,12793 4109.1,12766 4109.1,12730 4109.1,12730 4109.1,12730 3558.3,12730 3558.3,12730"];
	layer44_moe_comm_from_expert11 -> layer44_moe_aggregate	[pos="e,3535.1,12717 4455.6,12794 4455.6,12762 4455.6,12717 4455.6,12717 4455.6,12717 3545.1,12717 3545.1,12717"];
	layer44_moe_comm_from_expert12 -> layer44_moe_aggregate	[pos="e,3521.5,12704 4806.6,12793 4806.6,12759 4806.6,12704 4806.6,12704 4806.6,12704 3531.5,12704 3531.5,12704"];
	layer44_moe_comm_from_expert13 -> layer44_moe_aggregate	[pos="e,3508.1,12691 5160.1,12794 5160.1,12755 5160.1,12691 5160.1,12691 5160.1,12691 3518.1,12691 3518.1,12691"];
	layer44_moe_comm_from_expert14 -> layer44_moe_aggregate	[pos="e,3495.1,12678 5515.1,12794 5515.1,12752 5515.1,12678 5515.1,12678 5515.1,12678 3505.1,12678 3505.1,12678"];
	layer44_moe_comm_from_expert15 -> layer44_moe_aggregate	[pos="e,3481.7,12665 5870.1,12794 5870.1,12748 5870.1,12665 5870.1,12665 5870.1,12665 3491.7,12665 3491.7,12665"];
	layer45_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L45\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3314,12477",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer45_moe_mha -> layer45_moe_gate	[pos="e,3314,12529 3314,12565 3314,12565 3314,12539 3314,12539"];
	layer45_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L45\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3314,12337",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer45_moe_gate -> layer45_moe_split	[pos="e,3314,12389 3314,12425 3314,12425 3314,12399 3314,12399"];
	layer45_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="765,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer45_moe_split -> layer45_moe_comm_to_expert0	[pos="e,783.5,12249 3148.9,12374 2587.1,12374 783.5,12374 783.5,12374 783.5,12374 783.5,12259 783.5,12259",
		style=dashed];
	layer45_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1478,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer45_moe_split -> layer45_moe_comm_to_expert1	[pos="e,1496.5,12248 3133.9,12359 2674.8,12359 1496.5,12359 1496.5,12359 1496.5,12359 1496.5,12258 1496.5,12258",
		style=dashed];
	layer45_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1934,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer45_moe_split -> layer45_moe_comm_to_expert2	[pos="e,1952.5,12248 3118.9,12344 2742.5,12344 1952.5,12344 1952.5,12344 1952.5,12344 1952.5,12258 1952.5,12258",
		style=dashed];
	layer45_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2262,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer45_moe_split -> layer45_moe_comm_to_expert3	[pos="e,2280.5,12249 3103.9,12329 2801.8,12329 2280.5,12329 2280.5,12329 2280.5,12329 2280.5,12259 2280.5,12259",
		style=dashed];
	layer45_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2525,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer45_moe_split -> layer45_moe_comm_to_expert4	[pos="e,2543.5,12248 3088.8,12314 2861.4,12314 2543.5,12314 2543.5,12314 2543.5,12314 2543.5,12258 2543.5,12258",
		style=dashed];
	layer45_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2756,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer45_moe_split -> layer45_moe_comm_to_expert5	[pos="e,2774.5,12249 3073.8,12299 2929.9,12299 2774.5,12299 2774.5,12299 2774.5,12299 2774.5,12259 2774.5,12259",
		style=dashed];
	layer45_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2971,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer45_moe_split -> layer45_moe_comm_to_expert6	[pos="e,3061.8,12219 3074.5,12337 3074.5,12333 3074.5,12219 3074.5,12219 3074.5,12219 3071.8,12219 3071.8,12219",
		style=dashed];
	layer45_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3178,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer45_moe_split -> layer45_moe_comm_to_expert7	[pos="e,3178,12249 3178,12285 3178,12285 3178,12259 3178,12259",
		style=dashed];
	layer45_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3450,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer45_moe_split -> layer45_moe_comm_to_expert8	[pos="e,3450,12249 3450,12285 3450,12285 3450,12259 3450,12259",
		style=dashed];
	layer45_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3759,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer45_moe_split -> layer45_moe_comm_to_expert9	[pos="e,3668.3,12219 3554.3,12337 3554.3,12333 3554.3,12219 3554.3,12219 3554.3,12219 3658.3,12219 3658.3,12219",
		style=dashed];
	layer45_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4091,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer45_moe_split -> layer45_moe_comm_to_expert10	[pos="e,4015.1,12237 3478.4,12299 3685.6,12299 4015.1,12299 4015.1,12299 4015.1,12299 4015.1,12247 4015.1,12247",
		style=dashed];
	layer45_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4437,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer45_moe_split -> layer45_moe_comm_to_expert11	[pos="e,4361.6,12238 3493.2,12314 3792.5,12314 4361.6,12314 4361.6,12314 4361.6,12314 4361.6,12248 4361.6,12248",
		style=dashed];
	layer45_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4788,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer45_moe_split -> layer45_moe_comm_to_expert12	[pos="e,4712.6,12238 3508.1,12329 3892.2,12329 4712.6,12329 4712.6,12329 4712.6,12329 4712.6,12248 4712.6,12248",
		style=dashed];
	layer45_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5141,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer45_moe_split -> layer45_moe_comm_to_expert13	[pos="e,5066.1,12238 3523.2,12344 3988,12344 5066.1,12344 5066.1,12344 5066.1,12344 5066.1,12248 5066.1,12248",
		style=dashed];
	layer45_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5496,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer45_moe_split -> layer45_moe_comm_to_expert14	[pos="e,5421.1,12238 3538.5,12359 4081.4,12359 5421.1,12359 5421.1,12359 5421.1,12359 5421.1,12248 5421.1,12248",
		style=dashed];
	layer45_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5851,12220",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer45_moe_split -> layer45_moe_comm_to_expert15	[pos="e,5776.1,12238 3553.2,12374 4171.7,12374 5776.1,12374 5776.1,12374 5776.1,12374 5776.1,12248 5776.1,12248",
		style=dashed];
	layer45_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L45\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="719,12129",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer45_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="1086,12038",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer45_moe_expert0 -> layer45_moe_comm_from_expert0	[pos="e,995.26,12038 815.75,12103 815.75,12076 815.75,12038 815.75,12038 815.75,12038 985.26,12038 985.26,12038"];
	layer45_moe_comm_to_expert0 -> layer45_moe_expert0	[pos="e,765,12155 765,12191 765,12191 765,12165 765,12165"];
	layer45_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L45\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1065,12129",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer45_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1418,12038",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer45_moe_expert1 -> layer45_moe_comm_from_expert1	[pos="e,1327.3,12038 1202.8,12103 1202.8,12076 1202.8,12038 1202.8,12038 1202.8,12038 1317.3,12038 1317.3,12038"];
	layer45_moe_comm_to_expert1 -> layer45_moe_expert1	[pos="e,1083.5,12155 1387.5,12219 1271,12219 1083.5,12219 1083.5,12219 1083.5,12219 1083.5,12165 1083.5,12165"];
	layer45_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L45\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1411,12129",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer45_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1801,12038",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer45_moe_expert2 -> layer45_moe_comm_from_expert2	[pos="e,1710.3,12038 1541.8,12103 1541.8,12076 1541.8,12038 1541.8,12038 1541.8,12038 1700.3,12038 1700.3,12038"];
	layer45_moe_comm_to_expert2 -> layer45_moe_expert2	[pos="e,1575.2,12129 1843.4,12219 1739.7,12219 1584,12219 1584,12219 1584,12219 1584,12129 1584,12129 1584,12129 1583.1,12129 1583.1,12129"];
	layer45_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L45\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1757,12129",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer45_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2092,12038",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer45_moe_expert3 -> layer45_moe_comm_from_expert3	[pos="e,2001.3,12038 1916.3,12103 1916.3,12076 1916.3,12038 1916.3,12038 1916.3,12038 1991.3,12038 1991.3,12038"];
	layer45_moe_comm_to_expert3 -> layer45_moe_expert3	[pos="e,1882.2,12155 2203.3,12198 2203.3,12188 2203.3,12179 2203.3,12179 2203.3,12179 1882.2,12179 1882.2,12179 1882.2,12179 1882.2,12165 \
1882.2,12165"];
	layer45_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L45\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2103,12129",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer45_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2337,12038",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer45_moe_expert4 -> layer45_moe_comm_from_expert4	[pos="e,2256.7,12052 2256.7,12103 2256.7,12103 2256.7,12062 2256.7,12062"];
	layer45_moe_comm_to_expert4 -> layer45_moe_expert4	[pos="e,2235.2,12155 2523.7,12191 2523.7,12178 2523.7,12167 2523.7,12167 2523.7,12167 2235.2,12167 2235.2,12167 2235.2,12167 2235.2,12165 \
2235.2,12165"];
	layer45_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L45\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2449,12129",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer45_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2559,12038",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer45_moe_expert5 -> layer45_moe_comm_from_expert5	[pos="e,2540.7,12066 2540.7,12103 2540.7,12103 2540.7,12076 2540.7,12076"];
	layer45_moe_comm_to_expert5 -> layer45_moe_expert5	[pos="e,2613.1,12129 2665.3,12219 2641.9,12219 2623.3,12219 2623.3,12219 2623.3,12219 2623.3,12129 2623.3,12129 2623.3,12129 2622.2,12129 \
2622.2,12129"];
	layer45_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L45\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2795,12129",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer45_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2906,12038",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer45_moe_expert6 -> layer45_moe_comm_from_expert6	[pos="e,2887.2,12066 2887.2,12103 2887.2,12103 2887.2,12076 2887.2,12076"];
	layer45_moe_comm_to_expert6 -> layer45_moe_expert6	[pos="e,2919.7,12155 2919.7,12196 2919.7,12196 2919.7,12165 2919.7,12165"];
	layer45_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L45\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3141,12129",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer45_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3178,12038",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer45_moe_expert7 -> layer45_moe_comm_from_expert7	[pos="e,3178,12067 3178,12103 3178,12103 3178,12077 3178,12077"];
	layer45_moe_comm_to_expert7 -> layer45_moe_expert7	[pos="e,3178,12155 3178,12191 3178,12191 3178,12165 3178,12165"];
	layer45_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L45\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3487,12129",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer45_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3450,12038",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer45_moe_expert8 -> layer45_moe_comm_from_expert8	[pos="e,3450,12067 3450,12103 3450,12103 3450,12077 3450,12077"];
	layer45_moe_comm_to_expert8 -> layer45_moe_expert8	[pos="e,3450,12155 3450,12191 3450,12191 3450,12165 3450,12165"];
	layer45_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L45\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3833,12129",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer45_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3759,12038",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer45_moe_expert9 -> layer45_moe_comm_from_expert9	[pos="e,3759.3,12067 3759.3,12103 3759.3,12103 3759.3,12077 3759.3,12077"];
	layer45_moe_comm_to_expert9 -> layer45_moe_expert9	[pos="e,3759.3,12155 3759.3,12191 3759.3,12191 3759.3,12165 3759.3,12165"];
	layer45_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L45\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4184,12129",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer45_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4091,12038",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer45_moe_expert10 -> layer45_moe_comm_from_expert10	[pos="e,4100.4,12067 4100.4,12103 4100.4,12103 4100.4,12077 4100.4,12077"];
	layer45_moe_comm_to_expert10 -> layer45_moe_expert10	[pos="e,4100,12155 4100,12191 4100,12191 4100,12165 4100,12165"];
	layer45_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L45\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4540,12129",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer45_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4438,12038",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer45_moe_expert11 -> layer45_moe_comm_from_expert11	[pos="e,4451.9,12067 4451.9,12103 4451.9,12103 4451.9,12077 4451.9,12077"];
	layer45_moe_comm_to_expert11 -> layer45_moe_expert11	[pos="e,4451,12155 4451,12191 4451,12191 4451,12165 4451,12165"];
	layer45_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L45\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4896,12129",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer45_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4789,12038",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer45_moe_expert12 -> layer45_moe_comm_from_expert12	[pos="e,4805.4,12067 4805.4,12103 4805.4,12103 4805.4,12077 4805.4,12077"];
	layer45_moe_comm_to_expert12 -> layer45_moe_expert12	[pos="e,4804.5,12155 4804.5,12191 4804.5,12191 4804.5,12165 4804.5,12165"];
	layer45_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L45\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5252,12129",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer45_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5143,12038",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer45_moe_expert13 -> layer45_moe_comm_from_expert13	[pos="e,5160.4,12067 5160.4,12103 5160.4,12103 5160.4,12077 5160.4,12077"];
	layer45_moe_comm_to_expert13 -> layer45_moe_expert13	[pos="e,5159,12155 5159,12191 5159,12191 5159,12165 5159,12165"];
	layer45_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L45\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5608,12129",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer45_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5498,12038",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer45_moe_expert14 -> layer45_moe_comm_from_expert14	[pos="e,5515.9,12066 5515.9,12103 5515.9,12103 5515.9,12076 5515.9,12076"];
	layer45_moe_comm_to_expert14 -> layer45_moe_expert14	[pos="e,5514.5,12155 5514.5,12191 5514.5,12191 5514.5,12165 5514.5,12165"];
	layer45_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L45\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5964,12129",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer45_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5853,12038",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer45_moe_expert15 -> layer45_moe_comm_from_expert15	[pos="e,5871.4,12066 5871.4,12103 5871.4,12103 5871.4,12076 5871.4,12076"];
	layer45_moe_comm_to_expert15 -> layer45_moe_expert15	[pos="e,5870,12155 5870,12191 5870,12191 5870,12165 5870,12165"];
	layer45_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L45\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3277,11921",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer46_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L46\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3277,11807",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer45_moe_aggregate -> layer46_moe_mha	[pos="e,3277,11833 3277,11869 3277,11869 3277,11843 3277,11843"];
	layer45_moe_comm_from_expert0 -> layer45_moe_aggregate	[pos="e,3028,11882 1172,12029 1172,11995 1172,11882 1172,11882 1172,11882 3018,11882 3018,11882"];
	layer45_moe_comm_from_expert1 -> layer45_moe_aggregate	[pos="e,3041.4,11895 1492.5,12021 1492.5,11984 1492.5,11895 1492.5,11895 1492.5,11895 3031.4,11895 3031.4,11895"];
	layer45_moe_comm_from_expert2 -> layer45_moe_aggregate	[pos="e,3054.7,11908 1811,12009 1811,11971 1811,11908 1811,11908 1811,11908 3044.7,11908 3044.7,11908"];
	layer45_moe_comm_from_expert3 -> layer45_moe_aggregate	[pos="e,3068.5,11921 2125.5,12011 2125.5,11976 2125.5,11921 2125.5,11921 2125.5,11921 3058.5,11921 3058.5,11921"];
	layer45_moe_comm_from_expert4 -> layer45_moe_aggregate	[pos="e,3081.7,11934 2338.5,12009 2338.5,11978 2338.5,11934 2338.5,11934 2338.5,11934 3071.7,11934 3071.7,11934"];
	layer45_moe_comm_from_expert5 -> layer45_moe_aggregate	[pos="e,3095,11947 2568.5,12009 2568.5,11982 2568.5,11947 2568.5,11947 2568.5,11947 3085,11947 3085,11947"];
	layer45_moe_comm_from_expert6 -> layer45_moe_aggregate	[pos="e,3108.3,11960 2987,12025 2987,12003 2987,11960 2987,11960 2987,11960 3098.3,11960 3098.3,11960"];
	layer45_moe_comm_from_expert7 -> layer45_moe_aggregate	[pos="e,3178,11973 3178,12009 3178,12009 3178,11983 3178,11983"];
	layer45_moe_comm_from_expert8 -> layer45_moe_aggregate	[pos="e,3449.4,11973 3449.4,12009 3449.4,12009 3449.4,11983 3449.4,11983"];
	layer45_moe_comm_from_expert9 -> layer45_moe_aggregate	[pos="e,3525.7,11960 3740.5,12009 3740.5,11987 3740.5,11960 3740.5,11960 3740.5,11960 3535.7,11960 3535.7,11960"];
	layer45_moe_comm_from_expert10 -> layer45_moe_aggregate	[pos="e,3512.3,11947 4072.1,12009 4072.1,11983 4072.1,11947 4072.1,11947 4072.1,11947 3522.3,11947 3522.3,11947"];
	layer45_moe_comm_from_expert11 -> layer45_moe_aggregate	[pos="e,3499.2,11934 4418.6,12010 4418.6,11979 4418.6,11934 4418.6,11934 4418.6,11934 3509.2,11934 3509.2,11934"];
	layer45_moe_comm_from_expert12 -> layer45_moe_aggregate	[pos="e,3485.7,11921 4769.6,12009 4769.6,11975 4769.6,11921 4769.6,11921 4769.6,11921 3495.7,11921 3495.7,11921"];
	layer45_moe_comm_from_expert13 -> layer45_moe_aggregate	[pos="e,3472.4,11908 5123.1,12009 5123.1,11971 5123.1,11908 5123.1,11908 5123.1,11908 3482.4,11908 3482.4,11908"];
	layer45_moe_comm_from_expert14 -> layer45_moe_aggregate	[pos="e,3459,11895 5478.1,12009 5478.1,11968 5478.1,11895 5478.1,11895 5478.1,11895 3469,11895 3469,11895"];
	layer45_moe_comm_from_expert15 -> layer45_moe_aggregate	[pos="e,3445.7,11882 5833.1,12009 5833.1,11964 5833.1,11882 5833.1,11882 5833.1,11882 3455.7,11882 3455.7,11882"];
	layer46_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L46\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3277,11693",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer46_moe_mha -> layer46_moe_gate	[pos="e,3277,11745 3277,11781 3277,11781 3277,11755 3277,11755"];
	layer46_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L46\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3277,11553",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer46_moe_gate -> layer46_moe_split	[pos="e,3277,11605 3277,11641 3277,11641 3277,11615 3277,11615"];
	layer46_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="839,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer46_moe_split -> layer46_moe_comm_to_expert0	[pos="e,915.25,11452 3111.9,11590 2575.3,11590 915.25,11590 915.25,11590 915.25,11590 915.25,11462 915.25,11462",
		style=dashed];
	layer46_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1258,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer46_moe_split -> layer46_moe_comm_to_expert1	[pos="e,1338,11450 3096.8,11575 2615.7,11575 1338,11575 1338,11575 1338,11575 1338,11460 1338,11460",
		style=dashed];
	layer46_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1567,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer46_moe_split -> layer46_moe_comm_to_expert2	[pos="e,1625.3,11458 3081.9,11560 2644.8,11560 1625.3,11560 1625.3,11560 1625.3,11560 1625.3,11468 1625.3,11468",
		style=dashed];
	layer46_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="1821,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer46_moe_split -> layer46_moe_comm_to_expert3	[pos="e,1901.5,11449 3066.6,11545 2681.3,11545 1901.5,11545 1901.5,11545 1901.5,11545 1901.5,11459 1901.5,11459",
		style=dashed];
	layer46_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2159,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer46_moe_split -> layer46_moe_comm_to_expert4	[pos="e,2214.5,11459 3051.7,11530 2739.8,11530 2214.5,11530 2214.5,11530 2214.5,11530 2214.5,11469 2214.5,11469",
		style=dashed];
	layer46_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2578,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer46_moe_split -> layer46_moe_comm_to_expert5	[pos="e,2659,11449 3036.7,11515 2863.1,11515 2659,11515 2659,11515 2659,11515 2659,11459 2659,11459",
		style=dashed];
	layer46_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2887,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer46_moe_split -> layer46_moe_comm_to_expert6	[pos="e,2977.6,11436 3036.7,11553 3036.7,11549 3036.7,11436 3036.7,11436 3036.7,11436 2987.6,11436 2987.6,11436",
		style=dashed];
	layer46_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3141,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer46_moe_split -> layer46_moe_comm_to_expert7	[pos="e,3141,11465 3141,11501 3141,11501 3141,11475 3141,11475",
		style=dashed];
	layer46_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3413,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer46_moe_split -> layer46_moe_comm_to_expert8	[pos="e,3413,11465 3413,11501 3413,11501 3413,11475 3413,11475",
		style=dashed];
	layer46_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3722,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer46_moe_split -> layer46_moe_comm_to_expert9	[pos="e,3631.3,11436 3517.3,11553 3517.3,11549 3517.3,11436 3517.3,11436 3517.3,11436 3621.3,11436 3621.3,11436",
		style=dashed];
	layer46_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4054,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer46_moe_split -> layer46_moe_comm_to_expert10	[pos="e,3978.1,11453 3441.4,11515 3648.6,11515 3978.1,11515 3978.1,11515 3978.1,11515 3978.1,11463 3978.1,11463",
		style=dashed];
	layer46_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4400,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer46_moe_split -> layer46_moe_comm_to_expert11	[pos="e,4324.6,11454 3456.2,11530 3755.5,11530 4324.6,11530 4324.6,11530 4324.6,11530 4324.6,11464 4324.6,11464",
		style=dashed];
	layer46_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4751,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer46_moe_split -> layer46_moe_comm_to_expert12	[pos="e,4675.6,11454 3471.1,11545 3855.2,11545 4675.6,11545 4675.6,11545 4675.6,11545 4675.6,11464 4675.6,11464",
		style=dashed];
	layer46_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5104,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer46_moe_split -> layer46_moe_comm_to_expert13	[pos="e,5029.1,11454 3486.2,11560 3951,11560 5029.1,11560 5029.1,11560 5029.1,11560 5029.1,11464 5029.1,11464",
		style=dashed];
	layer46_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5459,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer46_moe_split -> layer46_moe_comm_to_expert14	[pos="e,5384.1,11454 3501.5,11575 4044.4,11575 5384.1,11575 5384.1,11575 5384.1,11575 5384.1,11464 5384.1,11464",
		style=dashed];
	layer46_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5814,11436",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer46_moe_split -> layer46_moe_comm_to_expert15	[pos="e,5739.1,11454 3516.2,11590 4134.7,11590 5739.1,11590 5739.1,11590 5739.1,11590 5739.1,11464 5739.1,11464",
		style=dashed];
	layer46_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L46\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="682,11345",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer46_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="841,11254",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer46_moe_expert0 -> layer46_moe_comm_from_expert0	[pos="e,798.25,11280 798.25,11319 798.25,11319 798.25,11290 798.25,11290"];
	layer46_moe_comm_to_expert0 -> layer46_moe_expert0	[pos="e,797.25,11371 797.25,11410 797.25,11410 797.25,11381 797.25,11381"];
	layer46_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L46\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="1028,11345",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer46_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1113,11254",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer46_moe_expert1 -> layer46_moe_comm_from_expert1	[pos="e,1107.2,11283 1107.2,11319 1107.2,11319 1107.2,11293 1107.2,11293"];
	layer46_moe_comm_to_expert1 -> layer46_moe_expert1	[pos="e,1179.7,11371 1179.7,11421 1179.7,11421 1179.7,11381 1179.7,11381"];
	layer46_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L46\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1374,11345",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer46_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1434,11254",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer46_moe_expert2 -> layer46_moe_comm_from_expert2	[pos="e,1434,11283 1434,11319 1434,11319 1434,11293 1434,11293"];
	layer46_moe_comm_to_expert2 -> layer46_moe_expert2	[pos="e,1507.2,11371 1507.2,11414 1507.2,11414 1507.2,11381 1507.2,11381"];
	layer46_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L46\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1720,11345",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer46_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2000,11254",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer46_moe_expert3 -> layer46_moe_comm_from_expert3	[pos="e,1909.3,11254 1826.7,11319 1826.7,11292 1826.7,11254 1826.7,11254 1826.7,11254 1899.3,11254 1899.3,11254"];
	layer46_moe_comm_to_expert3 -> layer46_moe_expert3	[pos="e,1807.2,11371 1807.2,11407 1807.2,11407 1807.2,11381 1807.2,11381"];
	layer46_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L46\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2066,11345",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer46_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2383,11254",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer46_moe_expert4 -> layer46_moe_comm_from_expert4	[pos="e,2292.2,11254 2163.7,11319 2163.7,11292 2163.7,11254 2163.7,11254 2163.7,11254 2282.2,11254 2282.2,11254"];
	layer46_moe_comm_to_expert4 -> layer46_moe_expert4	[pos="e,2149.2,11371 2149.2,11407 2149.2,11407 2149.2,11381 2149.2,11381"];
	layer46_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L46\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2412,11345",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer46_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2674,11254",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer46_moe_expert5 -> layer46_moe_comm_from_expert5	[pos="e,2588.7,11264 2576,11345 2584,11345 2588.7,11345 2588.7,11345 2588.7,11345 2588.7,11274 2588.7,11274"];
	layer46_moe_comm_to_expert5 -> layer46_moe_expert5	[pos="e,2531.7,11371 2531.7,11411 2531.7,11411 2531.7,11381 2531.7,11381"];
	layer46_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L46\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2758,11345",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer46_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2919,11254",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer46_moe_expert6 -> layer46_moe_comm_from_expert6	[pos="e,2875.2,11280 2875.2,11319 2875.2,11319 2875.2,11290 2875.2,11290"];
	layer46_moe_comm_to_expert6 -> layer46_moe_expert6	[pos="e,2859.2,11371 2859.2,11408 2859.2,11408 2859.2,11381 2859.2,11381"];
	layer46_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L46\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3104,11345",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer46_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3141,11254",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer46_moe_expert7 -> layer46_moe_comm_from_expert7	[pos="e,3141,11283 3141,11319 3141,11319 3141,11293 3141,11293"];
	layer46_moe_comm_to_expert7 -> layer46_moe_expert7	[pos="e,3141,11371 3141,11407 3141,11407 3141,11381 3141,11381"];
	layer46_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L46\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3450,11345",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer46_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3413,11254",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer46_moe_expert8 -> layer46_moe_comm_from_expert8	[pos="e,3413,11283 3413,11319 3413,11319 3413,11293 3413,11293"];
	layer46_moe_comm_to_expert8 -> layer46_moe_expert8	[pos="e,3413,11371 3413,11407 3413,11407 3413,11381 3413,11381"];
	layer46_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L46\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3796,11345",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer46_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3722,11254",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer46_moe_expert9 -> layer46_moe_comm_from_expert9	[pos="e,3722.3,11283 3722.3,11319 3722.3,11319 3722.3,11293 3722.3,11293"];
	layer46_moe_comm_to_expert9 -> layer46_moe_expert9	[pos="e,3722.3,11371 3722.3,11407 3722.3,11407 3722.3,11381 3722.3,11381"];
	layer46_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L46\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4147,11345",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer46_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4054,11254",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer46_moe_expert10 -> layer46_moe_comm_from_expert10	[pos="e,4063.4,11283 4063.4,11319 4063.4,11319 4063.4,11293 4063.4,11293"];
	layer46_moe_comm_to_expert10 -> layer46_moe_expert10	[pos="e,4063,11371 4063,11407 4063,11407 4063,11381 4063,11381"];
	layer46_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L46\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4503,11345",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer46_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4401,11254",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer46_moe_expert11 -> layer46_moe_comm_from_expert11	[pos="e,4414.9,11283 4414.9,11319 4414.9,11319 4414.9,11293 4414.9,11293"];
	layer46_moe_comm_to_expert11 -> layer46_moe_expert11	[pos="e,4414,11371 4414,11407 4414,11407 4414,11381 4414,11381"];
	layer46_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L46\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4859,11345",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer46_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4752,11254",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer46_moe_expert12 -> layer46_moe_comm_from_expert12	[pos="e,4768.4,11283 4768.4,11319 4768.4,11319 4768.4,11293 4768.4,11293"];
	layer46_moe_comm_to_expert12 -> layer46_moe_expert12	[pos="e,4767.5,11371 4767.5,11407 4767.5,11407 4767.5,11381 4767.5,11381"];
	layer46_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L46\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5215,11345",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer46_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5106,11254",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer46_moe_expert13 -> layer46_moe_comm_from_expert13	[pos="e,5123.4,11283 5123.4,11319 5123.4,11319 5123.4,11293 5123.4,11293"];
	layer46_moe_comm_to_expert13 -> layer46_moe_expert13	[pos="e,5122,11371 5122,11407 5122,11407 5122,11381 5122,11381"];
	layer46_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L46\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5571,11345",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer46_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5461,11254",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer46_moe_expert14 -> layer46_moe_comm_from_expert14	[pos="e,5478.9,11283 5478.9,11319 5478.9,11319 5478.9,11293 5478.9,11293"];
	layer46_moe_comm_to_expert14 -> layer46_moe_expert14	[pos="e,5477.5,11371 5477.5,11407 5477.5,11407 5477.5,11381 5477.5,11381"];
	layer46_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L46\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5927,11345",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer46_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5816,11254",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer46_moe_expert15 -> layer46_moe_comm_from_expert15	[pos="e,5834.4,11283 5834.4,11319 5834.4,11319 5834.4,11293 5834.4,11293"];
	layer46_moe_comm_to_expert15 -> layer46_moe_expert15	[pos="e,5833,11371 5833,11407 5833,11407 5833,11381 5833,11381"];
	layer46_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L46\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3240,11137",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer47_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L47\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3240,11023",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer46_moe_aggregate -> layer47_moe_mha	[pos="e,3240,11049 3240,11085 3240,11085 3240,11059 3240,11059"];
	layer46_moe_comm_from_expert0 -> layer46_moe_aggregate	[pos="e,2992.1,11099 879.25,11228 879.25,11184 879.25,11099 879.25,11099 879.25,11099 2982.1,11099 2982.1,11099"];
	layer46_moe_comm_from_expert1 -> layer46_moe_aggregate	[pos="e,3007.6,11114 1136,11226 1136,11185 1136,11114 1136,11114 1136,11114 2997.6,11114 2997.6,11114"];
	layer46_moe_comm_from_expert2 -> layer46_moe_aggregate	[pos="e,3023.1,11129 1507,11237 1507,11202 1507,11129 1507,11129 1507,11129 3013.1,11129 3013.1,11129"];
	layer46_moe_comm_from_expert3 -> layer46_moe_aggregate	[pos="e,3038.6,11144 2020.5,11226 2020.5,11193 2020.5,11144 2020.5,11144 2020.5,11144 3028.6,11144 3028.6,11144"];
	layer46_moe_comm_from_expert4 -> layer46_moe_aggregate	[pos="e,3054,11159 2417,11227 2417,11199 2417,11159 2417,11159 2417,11159 3044,11159 3044,11159"];
	layer46_moe_comm_from_expert5 -> layer46_moe_aggregate	[pos="e,3069.5,11174 2678,11225 2678,11202 2678,11174 2678,11174 2678,11174 3059.5,11174 3059.5,11174"];
	layer46_moe_comm_from_expert6 -> layer46_moe_aggregate	[pos="e,2993.6,11137 2993.6,11238 2993.6,11238 2993.6,11147 2993.6,11147"];
	layer46_moe_comm_from_expert7 -> layer46_moe_aggregate	[pos="e,3141,11189 3141,11225 3141,11225 3141,11199 3141,11199"];
	layer46_moe_comm_from_expert8 -> layer46_moe_aggregate	[pos="e,3412.4,11189 3412.4,11225 3412.4,11225 3412.4,11199 3412.4,11199"];
	layer46_moe_comm_from_expert9 -> layer46_moe_aggregate	[pos="e,3488.7,11176 3703.5,11225 3703.5,11203 3703.5,11176 3703.5,11176 3703.5,11176 3498.7,11176 3498.7,11176"];
	layer46_moe_comm_from_expert10 -> layer46_moe_aggregate	[pos="e,3475.3,11163 4035.1,11225 4035.1,11199 4035.1,11163 4035.1,11163 4035.1,11163 3485.3,11163 3485.3,11163"];
	layer46_moe_comm_from_expert11 -> layer46_moe_aggregate	[pos="e,3462.2,11150 4381.6,11226 4381.6,11195 4381.6,11150 4381.6,11150 4381.6,11150 3472.2,11150 3472.2,11150"];
	layer46_moe_comm_from_expert12 -> layer46_moe_aggregate	[pos="e,3448.7,11137 4732.6,11225 4732.6,11191 4732.6,11137 4732.6,11137 4732.6,11137 3458.7,11137 3458.7,11137"];
	layer46_moe_comm_from_expert13 -> layer46_moe_aggregate	[pos="e,3435.4,11124 5086.1,11226 5086.1,11187 5086.1,11124 5086.1,11124 5086.1,11124 3445.4,11124 3445.4,11124"];
	layer46_moe_comm_from_expert14 -> layer46_moe_aggregate	[pos="e,3422,11111 5441.1,11225 5441.1,11184 5441.1,11111 5441.1,11111 5441.1,11111 3432,11111 3432,11111"];
	layer46_moe_comm_from_expert15 -> layer46_moe_aggregate	[pos="e,3408.2,11098 5796.1,11225 5796.1,11180 5796.1,11098 5796.1,11098 5796.1,11098 3418.2,11098 3418.2,11098"];
	layer47_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L47\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3240,10909",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer47_moe_mha -> layer47_moe_gate	[pos="e,3240,10961 3240,10997 3240,10997 3240,10971 3240,10971"];
	layer47_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L47\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3240,10769",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer47_moe_gate -> layer47_moe_split	[pos="e,3240,10821 3240,10857 3240,10857 3240,10831 3240,10831"];
	layer47_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1159,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer47_moe_split -> layer47_moe_comm_to_expert0	[pos="e,1229.8,10670 3074.6,10806 2593.8,10806 1229.8,10806 1229.8,10806 1229.8,10806 1229.8,10680 1229.8,10680",
		style=dashed];
	layer47_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1404,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer47_moe_split -> layer47_moe_comm_to_expert1	[pos="e,1419,10681 3059.6,10791 2599.6,10791 1419,10791 1419,10791 1419,10791 1419,10691 1419,10691",
		style=dashed];
	layer47_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1860,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer47_moe_split -> layer47_moe_comm_to_expert2	[pos="e,1930,10671 3044.6,10776 2679.4,10776 1930,10776 1930,10776 1930,10776 1930,10681 1930,10681",
		style=dashed];
	layer47_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2188,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer47_moe_split -> layer47_moe_comm_to_expert3	[pos="e,2263.3,10669 3029.9,10761 2742.8,10761 2263.3,10761 2263.3,10761 2263.3,10761 2263.3,10679 2263.3,10679",
		style=dashed];
	layer47_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2451,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer47_moe_split -> layer47_moe_comm_to_expert4	[pos="e,2507.5,10675 3014.8,10746 2799.5,10746 2507.5,10746 2507.5,10746 2507.5,10746 2507.5,10685 2507.5,10685",
		style=dashed];
	layer47_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2682,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer47_moe_split -> layer47_moe_comm_to_expert5	[pos="e,2768.5,10661 2999.8,10731 2883.4,10731 2768.5,10731 2768.5,10731 2768.5,10731 2768.5,10671 2768.5,10671",
		style=dashed];
	layer47_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2897,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer47_moe_split -> layer47_moe_comm_to_expert6	[pos="e,2987.8,10652 3000.5,10769 3000.5,10765 3000.5,10652 3000.5,10652 3000.5,10652 2997.8,10652 2997.8,10652",
		style=dashed];
	layer47_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3104,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer47_moe_split -> layer47_moe_comm_to_expert7	[pos="e,3104,10681 3104,10717 3104,10717 3104,10691 3104,10691",
		style=dashed];
	layer47_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3376,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer47_moe_split -> layer47_moe_comm_to_expert8	[pos="e,3376,10681 3376,10717 3376,10717 3376,10691 3376,10691",
		style=dashed];
	layer47_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3685,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer47_moe_split -> layer47_moe_comm_to_expert9	[pos="e,3594.3,10652 3480.3,10769 3480.3,10765 3480.3,10652 3480.3,10652 3480.3,10652 3584.3,10652 3584.3,10652",
		style=dashed];
	layer47_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="4017,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer47_moe_split -> layer47_moe_comm_to_expert10	[pos="e,3941.1,10669 3404.4,10731 3611.6,10731 3941.1,10731 3941.1,10731 3941.1,10731 3941.1,10679 3941.1,10679",
		style=dashed];
	layer47_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4363,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer47_moe_split -> layer47_moe_comm_to_expert11	[pos="e,4287.6,10670 3419.2,10746 3718.5,10746 4287.6,10746 4287.6,10746 4287.6,10746 4287.6,10680 4287.6,10680",
		style=dashed];
	layer47_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4714,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer47_moe_split -> layer47_moe_comm_to_expert12	[pos="e,4638.6,10670 3434.1,10761 3818.2,10761 4638.6,10761 4638.6,10761 4638.6,10761 4638.6,10680 4638.6,10680",
		style=dashed];
	layer47_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5067,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer47_moe_split -> layer47_moe_comm_to_expert13	[pos="e,4992.1,10670 3449.2,10776 3914,10776 4992.1,10776 4992.1,10776 4992.1,10776 4992.1,10680 4992.1,10680",
		style=dashed];
	layer47_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5422,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer47_moe_split -> layer47_moe_comm_to_expert14	[pos="e,5347.1,10670 3464,10791 4006.6,10791 5347.1,10791 5347.1,10791 5347.1,10791 5347.1,10680 5347.1,10680",
		style=dashed];
	layer47_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5777,10652",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer47_moe_split -> layer47_moe_comm_to_expert15	[pos="e,5702.1,10670 3479.2,10806 4097.7,10806 5702.1,10806 5702.1,10806 5702.1,10806 5702.1,10680 5702.1,10680",
		style=dashed];
	layer47_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L47\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="645,10561",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer47_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="778,10470",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer47_moe_expert0 -> layer47_moe_comm_from_expert0	[pos="e,748.25,10498 748.25,10535 748.25,10535 748.25,10508 748.25,10508"];
	layer47_moe_comm_to_expert0 -> layer47_moe_expert0	[pos="e,779.75,10587 1068.2,10652 955.96,10652 779.75,10652 779.75,10652 779.75,10652 779.75,10597 779.75,10597"];
	layer47_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L47\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="991,10561",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer47_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1344,10470",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer47_moe_expert1 -> layer47_moe_comm_from_expert1	[pos="e,1253.5,10470 1145.5,10535 1145.5,10508 1145.5,10470 1145.5,10470 1145.5,10470 1243.5,10470 1243.5,10470"];
	layer47_moe_comm_to_expert1 -> layer47_moe_expert1	[pos="e,1111.7,10587 1404,10623 1404,10609 1404,10596 1404,10596 1404,10596 1111.7,10596 1111.7,10596 1111.7,10596 1111.7,10595 1111.7,\
10595"];
	layer47_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L47\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1337,10561",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer47_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1727,10470",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer47_moe_expert2 -> layer47_moe_comm_from_expert2	[pos="e,1636.3,10470 1491.5,10535 1491.5,10508 1491.5,10470 1491.5,10470 1491.5,10470 1626.3,10470 1626.3,10470"];
	layer47_moe_comm_to_expert2 -> layer47_moe_expert2	[pos="e,1501.2,10561 1769.3,10652 1666.5,10652 1513,10652 1513,10652 1513,10652 1513,10561 1513,10561 1513,10561 1511.2,10561 1511.2,10561"];
	layer47_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L47\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1683,10561",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer47_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2018,10470",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer47_moe_expert3 -> layer47_moe_comm_from_expert3	[pos="e,1927.3,10470 1835.5,10535 1835.5,10508 1835.5,10470 1835.5,10470 1835.5,10470 1917.3,10470 1917.3,10470"];
	layer47_moe_comm_to_expert3 -> layer47_moe_expert3	[pos="e,1808.2,10587 2129.3,10630 2129.3,10622 2129.3,10614 2129.3,10614 2129.3,10614 1808.2,10614 1808.2,10614 1808.2,10614 1808.2,10597 \
1808.2,10597"];
	layer47_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L47\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="2029,10561",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer47_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2263,10470",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer47_moe_expert4 -> layer47_moe_comm_from_expert4	[pos="e,2182.7,10484 2182.7,10535 2182.7,10535 2182.7,10494 2182.7,10494"];
	layer47_moe_comm_to_expert4 -> layer47_moe_expert4	[pos="e,2161.2,10587 2449.7,10623 2449.7,10613 2449.7,10605 2449.7,10605 2449.7,10605 2161.2,10605 2161.2,10605 2161.2,10605 2161.2,10597 \
2161.2,10597"];
	layer47_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L47\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2375,10561",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer47_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2485,10470",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer47_moe_expert5 -> layer47_moe_comm_from_expert5	[pos="e,2466.7,10499 2466.7,10535 2466.7,10535 2466.7,10509 2466.7,10509"];
	layer47_moe_comm_to_expert5 -> layer47_moe_expert5	[pos="e,2539.1,10561 2591.3,10652 2567.9,10652 2549.3,10652 2549.3,10652 2549.3,10652 2549.3,10561 2549.3,10561 2549.3,10561 2548.2,10561 \
2548.2,10561"];
	layer47_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L47\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2721,10561",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer47_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2832,10470",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer47_moe_expert6 -> layer47_moe_comm_from_expert6	[pos="e,2813.2,10499 2813.2,10535 2813.2,10535 2813.2,10509 2813.2,10509"];
	layer47_moe_comm_to_expert6 -> layer47_moe_expert6	[pos="e,2845.7,10587 2845.7,10628 2845.7,10628 2845.7,10597 2845.7,10597"];
	layer47_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L47\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3067,10561",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer47_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3104,10470",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer47_moe_expert7 -> layer47_moe_comm_from_expert7	[pos="e,3104,10499 3104,10535 3104,10535 3104,10509 3104,10509"];
	layer47_moe_comm_to_expert7 -> layer47_moe_expert7	[pos="e,3104,10587 3104,10623 3104,10623 3104,10597 3104,10597"];
	layer47_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L47\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3413,10561",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer47_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3376,10470",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer47_moe_expert8 -> layer47_moe_comm_from_expert8	[pos="e,3376,10499 3376,10535 3376,10535 3376,10509 3376,10509"];
	layer47_moe_comm_to_expert8 -> layer47_moe_expert8	[pos="e,3376,10587 3376,10623 3376,10623 3376,10597 3376,10597"];
	layer47_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L47\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3759,10561",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer47_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3685,10470",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer47_moe_expert9 -> layer47_moe_comm_from_expert9	[pos="e,3685.3,10499 3685.3,10535 3685.3,10535 3685.3,10509 3685.3,10509"];
	layer47_moe_comm_to_expert9 -> layer47_moe_expert9	[pos="e,3685.3,10587 3685.3,10623 3685.3,10623 3685.3,10597 3685.3,10597"];
	layer47_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L47\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4110,10561",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer47_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="4017,10470",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer47_moe_expert10 -> layer47_moe_comm_from_expert10	[pos="e,4026.4,10499 4026.4,10535 4026.4,10535 4026.4,10509 4026.4,10509"];
	layer47_moe_comm_to_expert10 -> layer47_moe_expert10	[pos="e,4026,10587 4026,10623 4026,10623 4026,10597 4026,10597"];
	layer47_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L47\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4466,10561",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer47_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4364,10470",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer47_moe_expert11 -> layer47_moe_comm_from_expert11	[pos="e,4377.9,10499 4377.9,10535 4377.9,10535 4377.9,10509 4377.9,10509"];
	layer47_moe_comm_to_expert11 -> layer47_moe_expert11	[pos="e,4377,10587 4377,10623 4377,10623 4377,10597 4377,10597"];
	layer47_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L47\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4822,10561",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer47_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4715,10470",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer47_moe_expert12 -> layer47_moe_comm_from_expert12	[pos="e,4731.4,10499 4731.4,10535 4731.4,10535 4731.4,10509 4731.4,10509"];
	layer47_moe_comm_to_expert12 -> layer47_moe_expert12	[pos="e,4730.5,10587 4730.5,10623 4730.5,10623 4730.5,10597 4730.5,10597"];
	layer47_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L47\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5178,10561",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer47_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5069,10470",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer47_moe_expert13 -> layer47_moe_comm_from_expert13	[pos="e,5086.4,10499 5086.4,10535 5086.4,10535 5086.4,10509 5086.4,10509"];
	layer47_moe_comm_to_expert13 -> layer47_moe_expert13	[pos="e,5085,10587 5085,10623 5085,10623 5085,10597 5085,10597"];
	layer47_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L47\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5534,10561",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer47_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5424,10470",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer47_moe_expert14 -> layer47_moe_comm_from_expert14	[pos="e,5441.9,10499 5441.9,10535 5441.9,10535 5441.9,10509 5441.9,10509"];
	layer47_moe_comm_to_expert14 -> layer47_moe_expert14	[pos="e,5440.5,10587 5440.5,10623 5440.5,10623 5440.5,10597 5440.5,10597"];
	layer47_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L47\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5890,10561",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer47_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5779,10470",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer47_moe_expert15 -> layer47_moe_comm_from_expert15	[pos="e,5797.4,10499 5797.4,10535 5797.4,10535 5797.4,10509 5797.4,10509"];
	layer47_moe_comm_to_expert15 -> layer47_moe_expert15	[pos="e,5796,10587 5796,10623 5796,10623 5796,10597 5796,10597"];
	layer47_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L47\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3203,10353",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer48_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L48\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3203,10239",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer47_moe_aggregate -> layer48_moe_mha	[pos="e,3203,10265 3203,10301 3203,10301 3203,10275 3203,10275"];
	layer47_moe_comm_from_expert0 -> layer47_moe_aggregate	[pos="e,2955.1,10315 829.25,10446 829.25,10402 829.25,10315 829.25,10315 829.25,10315 2945.1,10315 2945.1,10315"];
	layer47_moe_comm_from_expert1 -> layer47_moe_aggregate	[pos="e,2970.3,10330 1430,10461 1430,10430 1430,10330 1430,10330 1430,10330 2960.3,10330 2960.3,10330"];
	layer47_moe_comm_from_expert2 -> layer47_moe_aggregate	[pos="e,2986,10345 1740.5,10441 1740.5,10404 1740.5,10345 1740.5,10345 1740.5,10345 2976,10345 2976,10345"];
	layer47_moe_comm_from_expert3 -> layer47_moe_aggregate	[pos="e,3001.5,10360 2040.5,10442 2040.5,10409 2040.5,10360 2040.5,10360 2040.5,10360 2991.5,10360 2991.5,10360"];
	layer47_moe_comm_from_expert4 -> layer47_moe_aggregate	[pos="e,3016.9,10375 2290,10442 2290,10414 2290,10375 2290,10375 2290,10375 3006.9,10375 3006.9,10375"];
	layer47_moe_comm_from_expert5 -> layer47_moe_aggregate	[pos="e,3032.4,10390 2514.5,10443 2514.5,10419 2514.5,10390 2514.5,10390 2514.5,10390 3022.4,10390 3022.4,10390"];
	layer47_moe_comm_from_expert6 -> layer47_moe_aggregate	[pos="e,2977.1,10353 2922.7,10470 2952,10470 2977.1,10470 2977.1,10470 2977.1,10470 2977.1,10363 2977.1,10363"];
	layer47_moe_comm_from_expert7 -> layer47_moe_aggregate	[pos="e,3104,10405 3104,10441 3104,10441 3104,10415 3104,10415"];
	layer47_moe_comm_from_expert8 -> layer47_moe_aggregate	[pos="e,3375.4,10405 3375.4,10441 3375.4,10441 3375.4,10415 3375.4,10415"];
	layer47_moe_comm_from_expert9 -> layer47_moe_aggregate	[pos="e,3451.7,10392 3666.5,10441 3666.5,10419 3666.5,10392 3666.5,10392 3666.5,10392 3461.7,10392 3461.7,10392"];
	layer47_moe_comm_from_expert10 -> layer47_moe_aggregate	[pos="e,3438.3,10379 3998.1,10441 3998.1,10415 3998.1,10379 3998.1,10379 3998.1,10379 3448.3,10379 3448.3,10379"];
	layer47_moe_comm_from_expert11 -> layer47_moe_aggregate	[pos="e,3424.8,10366 4344.6,10442 4344.6,10411 4344.6,10366 4344.6,10366 4344.6,10366 3434.8,10366 3434.8,10366"];
	layer47_moe_comm_from_expert12 -> layer47_moe_aggregate	[pos="e,3411.7,10353 4695.6,10441 4695.6,10407 4695.6,10353 4695.6,10353 4695.6,10353 3421.7,10353 3421.7,10353"];
	layer47_moe_comm_from_expert13 -> layer47_moe_aggregate	[pos="e,3398.4,10340 5049.1,10442 5049.1,10403 5049.1,10340 5049.1,10340 5049.1,10340 3408.4,10340 3408.4,10340"];
	layer47_moe_comm_from_expert14 -> layer47_moe_aggregate	[pos="e,3385,10327 5404.1,10441 5404.1,10400 5404.1,10327 5404.1,10327 5404.1,10327 3395,10327 3395,10327"];
	layer47_moe_comm_from_expert15 -> layer47_moe_aggregate	[pos="e,3371.2,10314 5759.1,10441 5759.1,10396 5759.1,10314 5759.1,10314 5759.1,10314 3381.2,10314 3381.2,10314"];
	layer48_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L48\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3203,10125",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer48_moe_mha -> layer48_moe_gate	[pos="e,3203,10177 3203,10213 3203,10213 3203,10187 3203,10187"];
	layer48_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L48\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3203,9985.1",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer48_moe_gate -> layer48_moe_split	[pos="e,3203,10037 3203,10073 3203,10073 3203,10047 3203,10047"];
	layer48_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="695,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer48_moe_split -> layer48_moe_comm_to_expert0	[pos="e,736.5,9894.2 3037.8,10022 2485.3,10022 736.5,10022 736.5,10022 736.5,10022 736.5,9904.2 736.5,9904.2",
		style=dashed];
	layer48_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1335,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer48_moe_split -> layer48_moe_comm_to_expert1	[pos="e,1339.5,9897.2 3022.6,10007 2555,10007 1339.5,10007 1339.5,10007 1339.5,10007 1339.5,9907.2 1339.5,9907.2",
		style=dashed];
	layer48_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1754,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer48_moe_split -> layer48_moe_comm_to_expert2	[pos="e,1826.5,9885.6 3007.6,9992 2627.7,9992 1826.5,9992 1826.5,9992 1826.5,9992 1826.5,9895.6 1826.5,9895.6",
		style=dashed];
	layer48_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2063,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer48_moe_split -> layer48_moe_comm_to_expert3	[pos="e,2131,9887.3 2992.8,9977 2680.7,9977 2131,9977 2131,9977 2131,9977 2131,9897.3 2131,9897.3",
		style=dashed];
	layer48_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2317,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer48_moe_split -> layer48_moe_comm_to_expert4	[pos="e,2401,9879.2 2977.7,9962 2740.5,9962 2401,9962 2401,9962 2401,9962 2401,9889.2 2401,9889.2",
		style=dashed];
	layer48_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2544,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer48_moe_split -> layer48_moe_comm_to_expert5	[pos="e,2605,9889.7 2962.8,9947 2796.5,9947 2605,9947 2605,9947 2605,9947 2605,9899.7 2605,9899.7",
		style=dashed];
	layer48_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2757,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer48_moe_split -> layer48_moe_comm_to_expert6	[pos="e,2847.5,9868 2962.7,9985 2962.7,9981.5 2962.7,9868 2962.7,9868 2962.7,9868 2857.5,9868 2857.5,9868",
		style=dashed];
	layer48_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3067,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer48_moe_split -> layer48_moe_comm_to_expert7	[pos="e,3067,9897.3 3067,9932.8 3067,9932.8 3067,9907.3 3067,9907.3",
		style=dashed];
	layer48_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3339,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer48_moe_split -> layer48_moe_comm_to_expert8	[pos="e,3339,9897.3 3339,9932.8 3339,9932.8 3339,9907.3 3339,9907.3",
		style=dashed];
	layer48_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3648,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer48_moe_split -> layer48_moe_comm_to_expert9	[pos="e,3557.3,9868 3443.3,9985 3443.3,9981.5 3443.3,9868 3443.3,9868 3443.3,9868 3547.3,9868 3547.3,9868",
		style=dashed];
	layer48_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3980,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer48_moe_split -> layer48_moe_comm_to_expert10	[pos="e,3904.1,9885.2 3367.4,9947 3574.6,9947 3904.1,9947 3904.1,9947 3904.1,9947 3904.1,9895.2 3904.1,9895.2",
		style=dashed];
	layer48_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4326,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer48_moe_split -> layer48_moe_comm_to_expert11	[pos="e,4250.6,9885.8 3382.2,9962 3681.5,9962 4250.6,9962 4250.6,9962 4250.6,9962 4250.6,9895.8 4250.6,9895.8",
		style=dashed];
	layer48_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4677,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer48_moe_split -> layer48_moe_comm_to_expert12	[pos="e,4601.6,9885.6 3397.1,9977 3781.2,9977 4601.6,9977 4601.6,9977 4601.6,9977 4601.6,9895.6 4601.6,9895.6",
		style=dashed];
	layer48_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="5030,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer48_moe_split -> layer48_moe_comm_to_expert13	[pos="e,4955.1,9885.9 3412.2,9992 3877,9992 4955.1,9992 4955.1,9992 4955.1,9992 4955.1,9895.9 4955.1,9895.9",
		style=dashed];
	layer48_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5385,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer48_moe_split -> layer48_moe_comm_to_expert14	[pos="e,5310.1,9885.7 3427,10007 3969.6,10007 5310.1,10007 5310.1,10007 5310.1,10007 5310.1,9895.7 5310.1,9895.7",
		style=dashed];
	layer48_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5740,9868.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer48_moe_split -> layer48_moe_comm_to_expert15	[pos="e,5665.1,9885.8 3442.2,10022 4060.7,10022 5665.1,10022 5665.1,10022 5665.1,10022 5665.1,9895.8 5665.1,9895.8",
		style=dashed];
	layer48_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L48\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="608,9777.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer48_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="654,9686.1",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer48_moe_expert0 -> layer48_moe_comm_from_expert0	[pos="e,654,9715.2 654,9750.8 654,9750.8 654,9725.2 654,9725.2"];
	layer48_moe_comm_to_expert0 -> layer48_moe_expert0	[pos="e,688.25,9803.4 688.25,9839.1 688.25,9839.1 688.25,9813.4 688.25,9813.4"];
	layer48_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L48\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="954,9777.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer48_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1367,9686.1",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer48_moe_expert1 -> layer48_moe_comm_from_expert1	[pos="e,1276.3,9686 1056.2,9750.8 1056.2,9723.8 1056.2,9686 1056.2,9686 1056.2,9686 1266.3,9686 1266.3,9686"];
	layer48_moe_comm_to_expert1 -> layer48_moe_expert1	[pos="e,993.25,9803.4 1244.3,9868 1143.1,9868 993.25,9868 993.25,9868 993.25,9868 993.25,9813.4 993.25,9813.4"];
	layer48_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L48\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1300,9777.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer48_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1823,9686.1",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer48_moe_expert2 -> layer48_moe_comm_from_expert2	[pos="e,1732.4,9686 1464.2,9777 1469.8,9777 1473,9777 1473,9777 1473,9777 1473,9686 1473,9686 1473,9686 1722.4,9686 1722.4,9686"];
	layer48_moe_comm_to_expert2 -> layer48_moe_expert2	[pos="e,1449.3,9803.4 1663.4,9868 1573.6,9868 1449.3,9868 1449.3,9868 1449.3,9868 1449.3,9813.4 1449.3,9813.4"];
	layer48_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L48\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1646,9777.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer48_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2151,9686.1",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer48_moe_expert3 -> layer48_moe_comm_from_expert3	[pos="e,2092.3,9708.5 1771.2,9750.9 1771.2,9738.8 1771.2,9727 1771.2,9727 1771.2,9727 2092.3,9727 2092.3,9727 2092.3,9727 2092.3,9718.5 \
2092.3,9718.5"];
	layer48_moe_comm_to_expert3 -> layer48_moe_expert3	[pos="e,1736.7,9803.1 2063,9839.1 2063,9829.4 2063,9821 2063,9821 2063,9821 1736.7,9821 1736.7,9821 1736.7,9821 1736.7,9813.1 1736.7,9813.1"];
	layer48_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L48\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1992,9777.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer48_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2414,9686.1",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer48_moe_expert4 -> layer48_moe_comm_from_expert4	[pos="e,2412.7,9715.3 2124.2,9751.1 2124.2,9744.4 2124.2,9739 2124.2,9739 2124.2,9739 2412.7,9739 2412.7,9739 2412.7,9739 2412.7,9725.3 \
2412.7,9725.3"];
	layer48_moe_comm_to_expert4 -> layer48_moe_expert4	[pos="e,2156.4,9777 2226.4,9868 2193.5,9868 2164.2,9868 2164.2,9868 2164.2,9868 2164.2,9777 2164.2,9777 2164.2,9777 2163.5,9777 2163.5,\
9777"];
	layer48_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L48\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2338,9777.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer48_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2645,9686.1",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer48_moe_expert5 -> layer48_moe_comm_from_expert5	[pos="e,2554.1,9686 2502.2,9777 2507.8,9777 2511,9777 2511,9777 2511,9777 2511,9686 2511,9686 2511,9686 2544.1,9686 2544.1,9686"];
	layer48_moe_comm_to_expert5 -> layer48_moe_expert5	[pos="e,2477.7,9803.1 2477.7,9847.9 2477.7,9847.9 2477.7,9813.1 2477.7,9813.1"];
	layer48_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L48\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2684,9777.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer48_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2860,9686.1",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer48_moe_expert6 -> layer48_moe_comm_from_expert6	[pos="e,2808.7,9710.2 2808.7,9750.8 2808.7,9750.8 2808.7,9720.2 2808.7,9720.2"];
	layer48_moe_comm_to_expert6 -> layer48_moe_expert6	[pos="e,2757,9803.4 2757,9839.1 2757,9839.1 2757,9813.4 2757,9813.4"];
	layer48_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L48\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="3030,9777.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer48_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3067,9686.1",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer48_moe_expert7 -> layer48_moe_comm_from_expert7	[pos="e,3067,9715.2 3067,9750.8 3067,9750.8 3067,9725.2 3067,9725.2"];
	layer48_moe_comm_to_expert7 -> layer48_moe_expert7	[pos="e,3067,9803.4 3067,9839.1 3067,9839.1 3067,9813.4 3067,9813.4"];
	layer48_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L48\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3376,9777.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer48_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3339,9686.1",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer48_moe_expert8 -> layer48_moe_comm_from_expert8	[pos="e,3339,9715.2 3339,9750.8 3339,9750.8 3339,9725.2 3339,9725.2"];
	layer48_moe_comm_to_expert8 -> layer48_moe_expert8	[pos="e,3339,9803.4 3339,9839.1 3339,9839.1 3339,9813.4 3339,9813.4"];
	layer48_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L48\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3722,9777.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer48_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3648,9686.1",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer48_moe_expert9 -> layer48_moe_comm_from_expert9	[pos="e,3648.3,9715.2 3648.3,9750.8 3648.3,9750.8 3648.3,9725.2 3648.3,9725.2"];
	layer48_moe_comm_to_expert9 -> layer48_moe_expert9	[pos="e,3648.3,9803.4 3648.3,9839.1 3648.3,9839.1 3648.3,9813.4 3648.3,9813.4"];
	layer48_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L48\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4073,9777.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer48_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3980,9686.1",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer48_moe_expert10 -> layer48_moe_comm_from_expert10	[pos="e,3989.4,9715.2 3989.4,9750.8 3989.4,9750.8 3989.4,9725.2 3989.4,9725.2"];
	layer48_moe_comm_to_expert10 -> layer48_moe_expert10	[pos="e,3989,9803.4 3989,9839.1 3989,9839.1 3989,9813.4 3989,9813.4"];
	layer48_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L48\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4429,9777.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer48_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4327,9686.1",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer48_moe_expert11 -> layer48_moe_comm_from_expert11	[pos="e,4340.9,9714.9 4340.9,9750.8 4340.9,9750.8 4340.9,9724.9 4340.9,9724.9"];
	layer48_moe_comm_to_expert11 -> layer48_moe_expert11	[pos="e,4340,9803.2 4340,9839.3 4340,9839.3 4340,9813.2 4340,9813.2"];
	layer48_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L48\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4785,9777.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer48_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4678,9686.1",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer48_moe_expert12 -> layer48_moe_comm_from_expert12	[pos="e,4694.4,9714.9 4694.4,9750.8 4694.4,9750.8 4694.4,9724.9 4694.4,9724.9"];
	layer48_moe_comm_to_expert12 -> layer48_moe_expert12	[pos="e,4693.5,9803.2 4693.5,9839.3 4693.5,9839.3 4693.5,9813.2 4693.5,9813.2"];
	layer48_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L48\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5141,9777.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer48_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="5032,9686.1",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer48_moe_expert13 -> layer48_moe_comm_from_expert13	[pos="e,5049.4,9714.9 5049.4,9750.8 5049.4,9750.8 5049.4,9724.9 5049.4,9724.9"];
	layer48_moe_comm_to_expert13 -> layer48_moe_expert13	[pos="e,5048,9803.2 5048,9839.3 5048,9839.3 5048,9813.2 5048,9813.2"];
	layer48_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L48\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5497,9777.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer48_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5387,9686.1",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer48_moe_expert14 -> layer48_moe_comm_from_expert14	[pos="e,5404.9,9714.6 5404.9,9750.8 5404.9,9750.8 5404.9,9724.6 5404.9,9724.6"];
	layer48_moe_comm_to_expert14 -> layer48_moe_expert14	[pos="e,5403.5,9803.2 5403.5,9839.3 5403.5,9839.3 5403.5,9813.2 5403.5,9813.2"];
	layer48_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L48\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5853,9777.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer48_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5742,9686.1",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer48_moe_expert15 -> layer48_moe_comm_from_expert15	[pos="e,5760.4,9714.6 5760.4,9750.8 5760.4,9750.8 5760.4,9724.6 5760.4,9724.6"];
	layer48_moe_comm_to_expert15 -> layer48_moe_expert15	[pos="e,5759,9803.2 5759,9839.3 5759,9839.3 5759,9813.2 5759,9813.2"];
	layer48_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L48\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3166,9569.1",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer49_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L49\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3166,9455.1",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer48_moe_aggregate -> layer49_moe_mha	[pos="e,3166,9481.4 3166,9516.8 3166,9516.8 3166,9491.4 3166,9491.4"];
	layer48_moe_comm_from_expert0 -> layer48_moe_aggregate	[pos="e,2918,9531 739.75,9676.4 739.75,9642.5 739.75,9531 739.75,9531 739.75,9531 2908,9531 2908,9531"];
	layer48_moe_comm_from_expert1 -> layer48_moe_aggregate	[pos="e,2933.4,9546 1451.3,9675.1 1451.3,9642.1 1451.3,9546 1451.3,9546 1451.3,9546 2923.4,9546 2923.4,9546"];
	layer48_moe_comm_from_expert2 -> layer48_moe_aggregate	[pos="e,2949,9561 1895,9668.5 1895,9634 1895,9561 1895,9561 1895,9561 2939,9561 2939,9561"];
	layer48_moe_comm_from_expert3 -> layer48_moe_aggregate	[pos="e,2964.6,9576 2223,9668.4 2223,9637.3 2223,9576 2223,9576 2223,9576 2954.6,9576 2954.6,9576"];
	layer48_moe_comm_from_expert4 -> layer48_moe_aggregate	[pos="e,2980.1,9591 2493.8,9672.1 2493.8,9645.6 2493.8,9591 2493.8,9591 2493.8,9591 2970.1,9591 2970.1,9591"];
	layer48_moe_comm_from_expert5 -> layer48_moe_aggregate	[pos="e,2995.4,9606 2715.5,9667.5 2715.5,9643.9 2715.5,9606 2715.5,9606 2715.5,9606 2985.4,9606 2985.4,9606"];
	layer48_moe_comm_from_expert6 -> layer48_moe_aggregate	[pos="e,2927.1,9569.2 2927.1,9666.5 2927.1,9666.5 2927.1,9579.2 2927.1,9579.2"];
	layer48_moe_comm_from_expert7 -> layer48_moe_aggregate	[pos="e,3067,9621.2 3067,9656.9 3067,9656.9 3067,9631.2 3067,9631.2"];
	layer48_moe_comm_from_expert8 -> layer48_moe_aggregate	[pos="e,3338.4,9621.2 3338.4,9656.9 3338.4,9656.9 3338.4,9631.2 3338.4,9631.2"];
	layer48_moe_comm_from_expert9 -> layer48_moe_aggregate	[pos="e,3414.7,9608 3629.5,9657.5 3629.5,9635.2 3629.5,9608 3629.5,9608 3629.5,9608 3424.7,9608 3424.7,9608"];
	layer48_moe_comm_from_expert10 -> layer48_moe_aggregate	[pos="e,3401.3,9595 3961.1,9657.3 3961.1,9630.6 3961.1,9595 3961.1,9595 3961.1,9595 3411.3,9595 3411.3,9595"];
	layer48_moe_comm_from_expert11 -> layer48_moe_aggregate	[pos="e,3387.8,9582 4307.6,9657.7 4307.6,9626.8 4307.6,9582 4307.6,9582 4307.6,9582 3397.8,9582 3397.8,9582"];
	layer48_moe_comm_from_expert12 -> layer48_moe_aggregate	[pos="e,3374.7,9569 4658.6,9657.5 4658.6,9622.8 4658.6,9569 4658.6,9569 4658.6,9569 3384.7,9569 3384.7,9569"];
	layer48_moe_comm_from_expert13 -> layer48_moe_aggregate	[pos="e,3361,9556 5012.1,9657.6 5012.1,9619.3 5012.1,9556 5012.1,9556 5012.1,9556 3371,9556 3371,9556"];
	layer48_moe_comm_from_expert14 -> layer48_moe_aggregate	[pos="e,3347.5,9543 5367.1,9657.5 5367.1,9615.7 5367.1,9543 5367.1,9543 5367.1,9543 3357.5,9543 3357.5,9543"];
	layer48_moe_comm_from_expert15 -> layer48_moe_aggregate	[pos="e,3334.2,9530 5722.1,9657.5 5722.1,9612.4 5722.1,9530 5722.1,9530 5722.1,9530 3344.2,9530 3344.2,9530"];
	layer49_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L49\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3166,9341.1",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer49_moe_mha -> layer49_moe_gate	[pos="e,3166,9393.2 3166,9429 3166,9429 3166,9403.2 3166,9403.2"];
	layer49_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L49\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3166,9201.1",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer49_moe_gate -> layer49_moe_split	[pos="e,3166,9253.3 3166,9289 3166,9289 3166,9263.3 3166,9263.3"];
	layer49_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1085,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer49_moe_split -> layer49_moe_comm_to_expert0	[pos="e,1155.8,9102.4 3000.6,9238 2519.8,9238 1155.8,9238 1155.8,9238 1155.8,9238 1155.8,9112.4 1155.8,9112.4",
		style=dashed];
	layer49_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1330,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer49_moe_split -> layer49_moe_comm_to_expert1	[pos="e,1348.5,9112.6 2985.5,9223 2526.1,9223 1348.5,9223 1348.5,9223 1348.5,9223 1348.5,9122.6 1348.5,9122.6",
		style=dashed];
	layer49_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1786,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer49_moe_split -> layer49_moe_comm_to_expert2	[pos="e,1804.5,9112.6 2970.6,9208 2594,9208 1804.5,9208 1804.5,9208 1804.5,9208 1804.5,9122.6 1804.5,9122.6",
		style=dashed];
	layer49_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2114,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer49_moe_split -> layer49_moe_comm_to_expert3	[pos="e,2132.5,9112.7 2955.6,9193 2653.4,9193 2132.5,9193 2132.5,9193 2132.5,9193 2132.5,9122.7 2132.5,9122.7",
		style=dashed];
	layer49_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2377,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer49_moe_split -> layer49_moe_comm_to_expert4	[pos="e,2395.5,9112.6 2940.8,9178 2713.4,9178 2395.5,9178 2395.5,9178 2395.5,9178 2395.5,9122.6 2395.5,9122.6",
		style=dashed];
	layer49_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2608,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer49_moe_split -> layer49_moe_comm_to_expert5	[pos="e,2626.5,9112.6 2925.8,9163 2781.9,9163 2626.5,9163 2626.5,9163 2626.5,9163 2626.5,9122.6 2626.5,9122.6",
		style=dashed];
	layer49_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2823,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer49_moe_split -> layer49_moe_comm_to_expert6	[pos="e,2913.8,9084 2926.5,9201 2926.5,9197.5 2926.5,9084 2926.5,9084 2926.5,9084 2923.8,9084 2923.8,9084",
		style=dashed];
	layer49_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="3030,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer49_moe_split -> layer49_moe_comm_to_expert7	[pos="e,3030,9113.3 3030,9148.8 3030,9148.8 3030,9123.3 3030,9123.3",
		style=dashed];
	layer49_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3302,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer49_moe_split -> layer49_moe_comm_to_expert8	[pos="e,3302,9113.3 3302,9148.8 3302,9148.8 3302,9123.3 3302,9123.3",
		style=dashed];
	layer49_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3611,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer49_moe_split -> layer49_moe_comm_to_expert9	[pos="e,3520.3,9084 3406.3,9201 3406.3,9197.5 3406.3,9084 3406.3,9084 3406.3,9084 3510.3,9084 3510.3,9084",
		style=dashed];
	layer49_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3943,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer49_moe_split -> layer49_moe_comm_to_expert10	[pos="e,3867.1,9101.6 3329.9,9163 3537.1,9163 3867.1,9163 3867.1,9163 3867.1,9163 3867.1,9111.6 3867.1,9111.6",
		style=dashed];
	layer49_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4289,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer49_moe_split -> layer49_moe_comm_to_expert11	[pos="e,4213.6,9101.8 3345.2,9178 3644.5,9178 4213.6,9178 4213.6,9178 4213.6,9178 4213.6,9111.8 4213.6,9111.8",
		style=dashed];
	layer49_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4640,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer49_moe_split -> layer49_moe_comm_to_expert12	[pos="e,4564.6,9101.6 3360.1,9193 3744.2,9193 4564.6,9193 4564.6,9193 4564.6,9193 4564.6,9111.6 4564.6,9111.6",
		style=dashed];
	layer49_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4993,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer49_moe_split -> layer49_moe_comm_to_expert13	[pos="e,4918.1,9101.9 3375.2,9208 3840,9208 4918.1,9208 4918.1,9208 4918.1,9208 4918.1,9111.9 4918.1,9111.9",
		style=dashed];
	layer49_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5348,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer49_moe_split -> layer49_moe_comm_to_expert14	[pos="e,5273.1,9101.7 3390,9223 3932.6,9223 5273.1,9223 5273.1,9223 5273.1,9223 5273.1,9111.7 5273.1,9111.7",
		style=dashed];
	layer49_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5703,9084.1",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer49_moe_split -> layer49_moe_comm_to_expert15	[pos="e,5628.1,9101.8 3405.2,9238 4023.7,9238 5628.1,9238 5628.1,9238 5628.1,9238 5628.1,9111.8 5628.1,9111.8",
		style=dashed];
	layer49_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L49\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="571,8993.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer49_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="617,8902.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer49_moe_expert0 -> layer49_moe_comm_from_expert0	[pos="e,617,8931.3 617,8966.8 617,8966.8 617,8941.3 617,8941.3"];
	layer49_moe_comm_to_expert0 -> layer49_moe_expert0	[pos="e,649.25,9019.4 994.45,9084 866.78,9084 649.25,9084 649.25,9084 649.25,9084 649.25,9029.4 649.25,9029.4"];
	layer49_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L49\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="917,8993.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer49_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1330,8902.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer49_moe_expert1 -> layer49_moe_comm_from_expert1	[pos="e,1239.2,8902 1071.5,8966.8 1071.5,8939.9 1071.5,8902 1071.5,8902 1071.5,8902 1229.2,8902 1229.2,8902"];
	layer49_moe_comm_to_expert1 -> layer49_moe_expert1	[pos="e,1037.7,9019.2 1330,9055.1 1330,9041.4 1330,9028 1330,9028 1330,9028 1037.7,9028 1037.7,9028 1037.7,9028 1037.7,9027.1 1037.7,9027.1"];
	layer49_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L49\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1263,8993.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer49_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1786,8902.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer49_moe_expert2 -> layer49_moe_comm_from_expert2	[pos="e,1695.3,8902 1427.2,8984 1434.6,8984 1439,8984 1439,8984 1439,8984 1439,8902 1439,8902 1439,8902 1685.3,8902 1685.3,8902"];
	layer49_moe_comm_to_expert2 -> layer49_moe_expert2	[pos="e,1427.3,9001 1695.1,9084 1590.5,9084 1433,9084 1433,9084 1433,9084 1433,9001 1433,9001 1433,9001 1432.4,9001 1432.4,9001"];
	layer49_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L49\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1609,8993.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer49_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2114,8902.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer49_moe_expert3 -> layer49_moe_comm_from_expert3	[pos="e,2055.3,8924.5 1734.2,8966.9 1734.2,8954.8 1734.2,8943 1734.2,8943 1734.2,8943 2055.3,8943 2055.3,8943 2055.3,8943 2055.3,8934.5 \
2055.3,8934.5"];
	layer49_moe_comm_to_expert3 -> layer49_moe_expert3	[pos="e,1734.2,9019.3 2055.3,9062 2055.3,9053.6 2055.3,9046 2055.3,9046 2055.3,9046 1734.2,9046 1734.2,9046 1734.2,9046 1734.2,9029.3 \
1734.2,9029.3"];
	layer49_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L49\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1955,8993.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer49_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2377,8902.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer49_moe_expert4 -> layer49_moe_comm_from_expert4	[pos="e,2375.7,8931.4 2087.2,8967.1 2087.2,8960.4 2087.2,8955 2087.2,8955 2087.2,8955 2375.7,8955 2375.7,8955 2375.7,8955 2375.7,8941.4 \
2375.7,8941.4"];
	layer49_moe_comm_to_expert4 -> layer49_moe_expert4	[pos="e,2087.2,9019.2 2375.7,9055.1 2375.7,9045.4 2375.7,9037 2375.7,9037 2375.7,9037 2087.2,9037 2087.2,9037 2087.2,9037 2087.2,9029.2 \
2087.2,9029.2"];
	layer49_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L49\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2301,8993.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer49_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2608,8902.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer49_moe_expert5 -> layer49_moe_comm_from_expert5	[pos="e,2517.2,8902 2465.1,8984 2473.1,8984 2477.8,8984 2477.8,8984 2477.8,8984 2477.8,8902 2477.8,8902 2477.8,8902 2507.2,8902 2507.2,\
8902"];
	layer49_moe_comm_to_expert5 -> layer49_moe_expert5	[pos="e,2465.3,9001 2517.4,9084 2492.7,9084 2472.7,9084 2472.7,9084 2472.7,9084 2472.7,9001 2472.7,9001 2472.7,9001 2471.9,9001 2471.9,\
9001"];
	layer49_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L49\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2647,8993.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer49_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2823,8902.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer49_moe_expert6 -> layer49_moe_comm_from_expert6	[pos="e,2771.7,8926.2 2771.7,8966.8 2771.7,8966.8 2771.7,8936.2 2771.7,8936.2"];
	layer49_moe_comm_to_expert6 -> layer49_moe_expert6	[pos="e,2771.7,9019.4 2771.7,9060.2 2771.7,9060.2 2771.7,9029.4 2771.7,9029.4"];
	layer49_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L49\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2993,8993.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer49_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="3030,8902.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer49_moe_expert7 -> layer49_moe_comm_from_expert7	[pos="e,3030,8931.3 3030,8966.8 3030,8966.8 3030,8941.3 3030,8941.3"];
	layer49_moe_comm_to_expert7 -> layer49_moe_expert7	[pos="e,3030,9019.4 3030,9055.1 3030,9055.1 3030,9029.4 3030,9029.4"];
	layer49_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L49\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3339,8993.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer49_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3302,8902.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer49_moe_expert8 -> layer49_moe_comm_from_expert8	[pos="e,3302,8931.3 3302,8966.8 3302,8966.8 3302,8941.3 3302,8941.3"];
	layer49_moe_comm_to_expert8 -> layer49_moe_expert8	[pos="e,3302,9019.4 3302,9055.1 3302,9055.1 3302,9029.4 3302,9029.4"];
	layer49_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L49\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3685,8993.1",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer49_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3611,8902.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer49_moe_expert9 -> layer49_moe_comm_from_expert9	[pos="e,3611.3,8931.3 3611.3,8966.8 3611.3,8966.8 3611.3,8941.3 3611.3,8941.3"];
	layer49_moe_comm_to_expert9 -> layer49_moe_expert9	[pos="e,3611.3,9019.4 3611.3,9055.1 3611.3,9055.1 3611.3,9029.4 3611.3,9029.4"];
	layer49_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L49\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="4036,8993.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer49_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3943,8902.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer49_moe_expert10 -> layer49_moe_comm_from_expert10	[pos="e,3952.4,8931.3 3952.4,8966.8 3952.4,8966.8 3952.4,8941.3 3952.4,8941.3"];
	layer49_moe_comm_to_expert10 -> layer49_moe_expert10	[pos="e,3952,9019.4 3952,9055.1 3952,9055.1 3952,9029.4 3952,9029.4"];
	layer49_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L49\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4392,8993.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer49_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4290,8902.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer49_moe_expert11 -> layer49_moe_comm_from_expert11	[pos="e,4303.9,8931 4303.9,8966.8 4303.9,8966.8 4303.9,8941 4303.9,8941"];
	layer49_moe_comm_to_expert11 -> layer49_moe_expert11	[pos="e,4303,9019.3 4303,9055.3 4303,9055.3 4303,9029.3 4303,9029.3"];
	layer49_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L49\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4748,8993.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer49_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4641,8902.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer49_moe_expert12 -> layer49_moe_comm_from_expert12	[pos="e,4657.4,8931 4657.4,8966.8 4657.4,8966.8 4657.4,8941 4657.4,8941"];
	layer49_moe_comm_to_expert12 -> layer49_moe_expert12	[pos="e,4656.5,9019.3 4656.5,9055.3 4656.5,9055.3 4656.5,9029.3 4656.5,9029.3"];
	layer49_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L49\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5104,8993.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer49_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4995,8902.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer49_moe_expert13 -> layer49_moe_comm_from_expert13	[pos="e,5012.4,8931 5012.4,8966.8 5012.4,8966.8 5012.4,8941 5012.4,8941"];
	layer49_moe_comm_to_expert13 -> layer49_moe_expert13	[pos="e,5011,9019.3 5011,9055.3 5011,9055.3 5011,9029.3 5011,9029.3"];
	layer49_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L49\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5460,8993.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer49_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5350,8902.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer49_moe_expert14 -> layer49_moe_comm_from_expert14	[pos="e,5367.9,8930.6 5367.9,8966.8 5367.9,8966.8 5367.9,8940.6 5367.9,8940.6"];
	layer49_moe_comm_to_expert14 -> layer49_moe_expert14	[pos="e,5366.5,9019.3 5366.5,9055.3 5366.5,9055.3 5366.5,9029.3 5366.5,9029.3"];
	layer49_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L49\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5816,8993.1",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer49_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5705,8902.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer49_moe_expert15 -> layer49_moe_comm_from_expert15	[pos="e,5723.4,8930.6 5723.4,8966.8 5723.4,8966.8 5723.4,8940.6 5723.4,8940.6"];
	layer49_moe_comm_to_expert15 -> layer49_moe_expert15	[pos="e,5722,9019.3 5722,9055.3 5722,9055.3 5722,9029.3 5722,9029.3"];
	layer49_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L49\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3129,8785.2",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer50_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L50\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3129,8671.2",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer49_moe_aggregate -> layer50_moe_mha	[pos="e,3129,8697.4 3129,8732.8 3129,8732.8 3129,8707.4 3129,8707.4"];
	layer49_moe_comm_from_expert0 -> layer49_moe_aggregate	[pos="e,2882,8748 589.5,8874.2 589.5,8829.8 589.5,8748 589.5,8748 589.5,8748 2872,8748 2872,8748"];
	layer49_moe_comm_from_expert1 -> layer49_moe_aggregate	[pos="e,2896.4,8762 1414.3,8891.2 1414.3,8858.1 1414.3,8762 1414.3,8762 1414.3,8762 2886.4,8762 2886.4,8762"];
	layer49_moe_comm_from_expert2 -> layer49_moe_aggregate	[pos="e,2912,8777 1823.5,8875.6 1823.5,8838.9 1823.5,8777 1823.5,8777 1823.5,8777 2902,8777 2902,8777"];
	layer49_moe_comm_from_expert3 -> layer49_moe_aggregate	[pos="e,2927.4,8792 2178.5,8881.7 2178.5,8849.8 2178.5,8792 2178.5,8792 2178.5,8792 2917.4,8792 2917.4,8792"];
	layer49_moe_comm_from_expert4 -> layer49_moe_aggregate	[pos="e,2942.7,8807 2423.5,8877.2 2423.5,8849 2423.5,8807 2423.5,8807 2423.5,8807 2932.7,8807 2932.7,8807"];
	layer49_moe_comm_from_expert5 -> layer49_moe_aggregate	[pos="e,2958.2,8822 2645.5,8875.5 2645.5,8852.1 2645.5,8822 2645.5,8822 2645.5,8822 2948.2,8822 2948.2,8822"];
	layer49_moe_comm_from_expert6 -> layer49_moe_aggregate	[pos="e,2890.1,8785.2 2890.1,8882.6 2890.1,8882.6 2890.1,8795.2 2890.1,8795.2"];
	layer49_moe_comm_from_expert7 -> layer49_moe_aggregate	[pos="e,3030,8837.2 3030,8872.9 3030,8872.9 3030,8847.2 3030,8847.2"];
	layer49_moe_comm_from_expert8 -> layer49_moe_aggregate	[pos="e,3301.4,8837.2 3301.4,8872.9 3301.4,8872.9 3301.4,8847.2 3301.4,8847.2"];
	layer49_moe_comm_from_expert9 -> layer49_moe_aggregate	[pos="e,3377.7,8824 3592.5,8873.5 3592.5,8851.2 3592.5,8824 3592.5,8824 3592.5,8824 3387.7,8824 3387.7,8824"];
	layer49_moe_comm_from_expert10 -> layer49_moe_aggregate	[pos="e,3364.3,8811 3924.1,8873.3 3924.1,8846.6 3924.1,8811 3924.1,8811 3924.1,8811 3374.3,8811 3374.3,8811"];
	layer49_moe_comm_from_expert11 -> layer49_moe_aggregate	[pos="e,3350.8,8798 4270.6,8873.7 4270.6,8842.9 4270.6,8798 4270.6,8798 4270.6,8798 3360.8,8798 3360.8,8798"];
	layer49_moe_comm_from_expert12 -> layer49_moe_aggregate	[pos="e,3337.3,8785 4621.6,8873.5 4621.6,8838.8 4621.6,8785 4621.6,8785 4621.6,8785 3347.3,8785 3347.3,8785"];
	layer49_moe_comm_from_expert13 -> layer49_moe_aggregate	[pos="e,3324,8772 4975.1,8873.6 4975.1,8835.3 4975.1,8772 4975.1,8772 4975.1,8772 3334,8772 3334,8772"];
	layer49_moe_comm_from_expert14 -> layer49_moe_aggregate	[pos="e,3310.5,8759 5330.1,8873.5 5330.1,8831.8 5330.1,8759 5330.1,8759 5330.1,8759 3320.5,8759 3320.5,8759"];
	layer49_moe_comm_from_expert15 -> layer49_moe_aggregate	[pos="e,3297.2,8746 5685.1,8873.5 5685.1,8828.4 5685.1,8746 5685.1,8746 5685.1,8746 3307.2,8746 3307.2,8746"];
	layer50_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L50\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3129,8557.2",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer50_moe_mha -> layer50_moe_gate	[pos="e,3129,8609.3 3129,8645 3129,8645 3129,8619.3 3129,8619.3"];
	layer50_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L50\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3129,8417.2",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer50_moe_gate -> layer50_moe_split	[pos="e,3129,8469.3 3129,8505 3129,8505 3129,8479.3 3129,8479.3"];
	layer50_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="621,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer50_moe_split -> layer50_moe_comm_to_expert0	[pos="e,648.5,8328 2963.4,8454 2408.3,8454 648.5,8454 648.5,8454 648.5,8454 648.5,8338 648.5,8338",
		style=dashed];
	layer50_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1261,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer50_moe_split -> layer50_moe_comm_to_expert1	[pos="e,1295.5,8327.3 2948.6,8439 2486.3,8439 1295.5,8439 1295.5,8439 1295.5,8439 1295.5,8337.3 1295.5,8337.3",
		style=dashed];
	layer50_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1680,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer50_moe_split -> layer50_moe_comm_to_expert2	[pos="e,1733,8323.8 2933.8,8424 2549.7,8424 1733,8424 1733,8424 1733,8424 1733,8333.8 1733,8333.8",
		style=dashed];
	layer50_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="1989,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer50_moe_split -> layer50_moe_comm_to_expert3	[pos="e,2051.5,8321.2 2918.7,8409 2605.1,8409 2051.5,8409 2051.5,8409 2051.5,8409 2051.5,8331.2 2051.5,8331.2",
		style=dashed];
	layer50_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2243,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer50_moe_split -> layer50_moe_comm_to_expert4	[pos="e,2310,8320.1 2903.6,8394 2661.1,8394 2310,8394 2310,8394 2310,8394 2310,8330.1 2310,8330.1",
		style=dashed];
	layer50_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2470,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer50_moe_split -> layer50_moe_comm_to_expert5	[pos="e,2539,8319.1 2889.4,8380 2726,8380 2539,8380 2539,8380 2539,8380 2539,8329.1 2539,8329.1",
		style=dashed];
	layer50_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2683,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer50_moe_split -> layer50_moe_comm_to_expert6	[pos="e,2773.5,8300 2888.7,8417.1 2888.7,8413.5 2888.7,8300 2888.7,8300 2888.7,8300 2783.5,8300 2783.5,8300",
		style=dashed];
	layer50_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2993,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer50_moe_split -> layer50_moe_comm_to_expert7	[pos="e,2993,8329.4 2993,8364.8 2993,8364.8 2993,8339.4 2993,8339.4",
		style=dashed];
	layer50_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3265,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer50_moe_split -> layer50_moe_comm_to_expert8	[pos="e,3265,8329.4 3265,8364.8 3265,8364.8 3265,8339.4 3265,8339.4",
		style=dashed];
	layer50_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3574,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer50_moe_split -> layer50_moe_comm_to_expert9	[pos="e,3483.3,8300 3369.3,8417.1 3369.3,8413.5 3369.3,8300 3369.3,8300 3369.3,8300 3473.3,8300 3473.3,8300",
		style=dashed];
	layer50_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3906,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer50_moe_split -> layer50_moe_comm_to_expert10	[pos="e,3830.1,8317.5 3294.3,8380 3501.5,8380 3830.1,8380 3830.1,8380 3830.1,8380 3830.1,8327.5 3830.1,8327.5",
		style=dashed];
	layer50_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4252,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer50_moe_split -> layer50_moe_comm_to_expert11	[pos="e,4176.6,8317.8 3307.9,8394 3607.1,8394 4176.6,8394 4176.6,8394 4176.6,8394 4176.6,8327.8 4176.6,8327.8",
		style=dashed];
	layer50_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4603,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer50_moe_split -> layer50_moe_comm_to_expert12	[pos="e,4527.6,8317.7 3323.1,8409 3707.2,8409 4527.6,8409 4527.6,8409 4527.6,8409 4527.6,8327.7 4527.6,8327.7",
		style=dashed];
	layer50_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4956,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer50_moe_split -> layer50_moe_comm_to_expert13	[pos="e,4881.1,8317.9 3338.2,8424 3803,8424 4881.1,8424 4881.1,8424 4881.1,8424 4881.1,8327.9 4881.1,8327.9",
		style=dashed];
	layer50_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5311,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer50_moe_split -> layer50_moe_comm_to_expert14	[pos="e,5236.1,8317.8 3353,8439 3895.6,8439 5236.1,8439 5236.1,8439 5236.1,8439 5236.1,8327.8 5236.1,8327.8",
		style=dashed];
	layer50_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5666,8300.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer50_moe_split -> layer50_moe_comm_to_expert15	[pos="e,5591.1,8317.8 3367.9,8454 3986.2,8454 5591.1,8454 5591.1,8454 5591.1,8454 5591.1,8327.8 5591.1,8327.8",
		style=dashed];
	layer50_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L50\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="534,8209.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer50_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="667,8118.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer50_moe_expert0 -> layer50_moe_comm_from_expert0	[pos="e,637.25,8145.7 637.25,8182.9 637.25,8182.9 637.25,8155.7 637.25,8155.7"];
	layer50_moe_comm_to_expert0 -> layer50_moe_expert0	[pos="e,614.25,8235.5 614.25,8271.1 614.25,8271.1 614.25,8245.5 614.25,8245.5"];
	layer50_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L50\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="880,8209.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer50_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1233,8118.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer50_moe_expert1 -> layer50_moe_comm_from_expert1	[pos="e,1142.5,8118 982.25,8182.8 982.25,8155.9 982.25,8118 982.25,8118 982.25,8118 1132.5,8118 1132.5,8118"];
	layer50_moe_comm_to_expert1 -> layer50_moe_expert1	[pos="e,898.5,8235.4 1170.5,8300 1063.1,8300 898.5,8300 898.5,8300 898.5,8300 898.5,8245.4 898.5,8245.4"];
	layer50_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L50\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1226,8209.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer50_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1616,8118.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer50_moe_expert2 -> layer50_moe_comm_from_expert2	[pos="e,1525.3,8118 1380.5,8182.8 1380.5,8155.9 1380.5,8118 1380.5,8118 1380.5,8118 1515.3,8118 1515.3,8118"];
	layer50_moe_comm_to_expert2 -> layer50_moe_expert2	[pos="e,1370.8,8235.4 1589.3,8300 1498.1,8300 1370.8,8300 1370.8,8300 1370.8,8300 1370.8,8245.4 1370.8,8245.4"];
	layer50_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L50\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1572,8209.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer50_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="1907,8118.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer50_moe_expert3 -> layer50_moe_comm_from_expert3	[pos="e,1816.3,8118 1721.3,8182.8 1721.3,8155.9 1721.3,8118 1721.3,8118 1721.3,8118 1806.3,8118 1806.3,8118"];
	layer50_moe_comm_to_expert3 -> layer50_moe_expert3	[pos="e,1662.7,8235.4 1989,8271.1 1989,8261.4 1989,8253 1989,8253 1989,8253 1662.7,8253 1662.7,8253 1662.7,8253 1662.7,8245.4 1662.7,8245.4"];
	layer50_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L50\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1918,8209.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer50_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2152,8118.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer50_moe_expert4 -> layer50_moe_comm_from_expert4	[pos="e,2071.7,8131.8 2071.7,8182.9 2071.7,8182.9 2071.7,8141.8 2071.7,8141.8"];
	layer50_moe_comm_to_expert4 -> layer50_moe_expert4	[pos="e,2082.2,8209 2152.4,8300 2119.8,8300 2091,8300 2091,8300 2091,8300 2091,8209 2091,8209 2091,8209 2090.1,8209 2090.1,8209"];
	layer50_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L50\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2264,8209.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer50_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2374,8118.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer50_moe_expert5 -> layer50_moe_comm_from_expert5	[pos="e,2355.7,8146.7 2355.7,8182.9 2355.7,8182.9 2355.7,8156.7 2355.7,8156.7"];
	layer50_moe_comm_to_expert5 -> layer50_moe_expert5	[pos="e,2403.7,8235.2 2403.7,8280 2403.7,8280 2403.7,8245.2 2403.7,8245.2"];
	layer50_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L50\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2610,8209.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer50_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2721,8118.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer50_moe_expert6 -> layer50_moe_comm_from_expert6	[pos="e,2702.2,8146.7 2702.2,8182.9 2702.2,8182.9 2702.2,8156.7 2702.2,8156.7"];
	layer50_moe_comm_to_expert6 -> layer50_moe_expert6	[pos="e,2683,8235.5 2683,8271.1 2683,8271.1 2683,8245.5 2683,8245.5"];
	layer50_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L50\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2956,8209.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer50_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2993,8118.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer50_moe_expert7 -> layer50_moe_comm_from_expert7	[pos="e,2993,8147.3 2993,8182.9 2993,8182.9 2993,8157.3 2993,8157.3"];
	layer50_moe_comm_to_expert7 -> layer50_moe_expert7	[pos="e,2993,8235.5 2993,8271.1 2993,8271.1 2993,8245.5 2993,8245.5"];
	layer50_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L50\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3302,8209.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer50_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3265,8118.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer50_moe_expert8 -> layer50_moe_comm_from_expert8	[pos="e,3265,8147.3 3265,8182.9 3265,8182.9 3265,8157.3 3265,8157.3"];
	layer50_moe_comm_to_expert8 -> layer50_moe_expert8	[pos="e,3265,8235.5 3265,8271.1 3265,8271.1 3265,8245.5 3265,8245.5"];
	layer50_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L50\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3648,8209.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer50_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3574,8118.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer50_moe_expert9 -> layer50_moe_comm_from_expert9	[pos="e,3574.3,8147.3 3574.3,8182.9 3574.3,8182.9 3574.3,8157.3 3574.3,8157.3"];
	layer50_moe_comm_to_expert9 -> layer50_moe_expert9	[pos="e,3574.3,8235.5 3574.3,8271.1 3574.3,8271.1 3574.3,8245.5 3574.3,8245.5"];
	layer50_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L50\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3999,8209.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer50_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3906,8118.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer50_moe_expert10 -> layer50_moe_comm_from_expert10	[pos="e,3915.4,8147.3 3915.4,8182.9 3915.4,8182.9 3915.4,8157.3 3915.4,8157.3"];
	layer50_moe_comm_to_expert10 -> layer50_moe_expert10	[pos="e,3915,8235.5 3915,8271.1 3915,8271.1 3915,8245.5 3915,8245.5"];
	layer50_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L50\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4355,8209.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer50_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4253,8118.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer50_moe_expert11 -> layer50_moe_comm_from_expert11	[pos="e,4266.9,8147 4266.9,8182.9 4266.9,8182.9 4266.9,8157 4266.9,8157"];
	layer50_moe_comm_to_expert11 -> layer50_moe_expert11	[pos="e,4266,8235.3 4266,8271.4 4266,8271.4 4266,8245.3 4266,8245.3"];
	layer50_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L50\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4711,8209.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer50_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4604,8118.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer50_moe_expert12 -> layer50_moe_comm_from_expert12	[pos="e,4620.4,8147 4620.4,8182.9 4620.4,8182.9 4620.4,8157 4620.4,8157"];
	layer50_moe_comm_to_expert12 -> layer50_moe_expert12	[pos="e,4619.5,8235.3 4619.5,8271.4 4619.5,8271.4 4619.5,8245.3 4619.5,8245.3"];
	layer50_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L50\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5067,8209.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer50_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4958,8118.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer50_moe_expert13 -> layer50_moe_comm_from_expert13	[pos="e,4975.4,8147 4975.4,8182.9 4975.4,8182.9 4975.4,8157 4975.4,8157"];
	layer50_moe_comm_to_expert13 -> layer50_moe_expert13	[pos="e,4974,8235.3 4974,8271.4 4974,8271.4 4974,8245.3 4974,8245.3"];
	layer50_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L50\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5423,8209.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer50_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5313,8118.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer50_moe_expert14 -> layer50_moe_comm_from_expert14	[pos="e,5330.9,8146.7 5330.9,8182.9 5330.9,8182.9 5330.9,8156.7 5330.9,8156.7"];
	layer50_moe_comm_to_expert14 -> layer50_moe_expert14	[pos="e,5329.5,8235.3 5329.5,8271.4 5329.5,8271.4 5329.5,8245.3 5329.5,8245.3"];
	layer50_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L50\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5779,8209.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer50_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5668,8118.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer50_moe_expert15 -> layer50_moe_comm_from_expert15	[pos="e,5686.4,8146.7 5686.4,8182.9 5686.4,8182.9 5686.4,8156.7 5686.4,8156.7"];
	layer50_moe_comm_to_expert15 -> layer50_moe_expert15	[pos="e,5685,8235.3 5685,8271.4 5685,8271.4 5685,8245.3 5685,8245.3"];
	layer50_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L50\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3092,8001.2",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer51_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L51\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3092,7887.2",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer50_moe_aggregate -> layer51_moe_mha	[pos="e,3092,7913.4 3092,7948.9 3092,7948.9 3092,7923.4 3092,7923.4"];
	layer50_moe_comm_from_expert0 -> layer50_moe_aggregate	[pos="e,2845,7964 718.25,8094.1 718.25,8050.7 718.25,7964 718.25,7964 718.25,7964 2835,7964 2835,7964"];
	layer50_moe_comm_from_expert1 -> layer50_moe_aggregate	[pos="e,2859.4,7978 1244.5,8089.1 1244.5,8048.1 1244.5,7978 1244.5,7978 1244.5,7978 2849.4,7978 2849.4,7978"];
	layer50_moe_comm_from_expert2 -> layer50_moe_aggregate	[pos="e,2874.7,7993 1664,8093.5 1664,8057 1664,7993 1664,7993 1664,7993 2864.7,7993 2864.7,7993"];
	layer50_moe_comm_from_expert3 -> layer50_moe_aggregate	[pos="e,2890.4,8008 1973.5,8098.5 1973.5,8066.8 1973.5,8008 1973.5,8008 1973.5,8008 2880.4,8008 2880.4,8008"];
	layer50_moe_comm_from_expert4 -> layer50_moe_aggregate	[pos="e,2906,8023 2227.5,8102 2227.5,8074.9 2227.5,8023 2227.5,8023 2227.5,8023 2896,8023 2896,8023"];
	layer50_moe_comm_from_expert5 -> layer50_moe_aggregate	[pos="e,2921.4,8038 2454,8104.6 2454,8081.7 2454,8038 2454,8038 2454,8038 2911.4,8038 2911.4,8038"];
	layer50_moe_comm_from_expert6 -> layer50_moe_aggregate	[pos="e,2866.1,8001.3 2811.7,8118 2841,8118 2866.1,8118 2866.1,8118 2866.1,8118 2866.1,8011.3 2866.1,8011.3"];
	layer50_moe_comm_from_expert7 -> layer50_moe_aggregate	[pos="e,2993,8053.3 2993,8089 2993,8089 2993,8063.3 2993,8063.3"];
	layer50_moe_comm_from_expert8 -> layer50_moe_aggregate	[pos="e,3264.4,8053.3 3264.4,8089 3264.4,8089 3264.4,8063.3 3264.4,8063.3"];
	layer50_moe_comm_from_expert9 -> layer50_moe_aggregate	[pos="e,3340.7,8040 3555.5,8089.5 3555.5,8067.2 3555.5,8040 3555.5,8040 3555.5,8040 3350.7,8040 3350.7,8040"];
	layer50_moe_comm_from_expert10 -> layer50_moe_aggregate	[pos="e,3327.3,8027 3887.1,8089.3 3887.1,8062.6 3887.1,8027 3887.1,8027 3887.1,8027 3337.3,8027 3337.3,8027"];
	layer50_moe_comm_from_expert11 -> layer50_moe_aggregate	[pos="e,3313.8,8014 4233.6,8089.7 4233.6,8058.9 4233.6,8014 4233.6,8014 4233.6,8014 3323.8,8014 3323.8,8014"];
	layer50_moe_comm_from_expert12 -> layer50_moe_aggregate	[pos="e,3300.3,8001 4584.6,8089.5 4584.6,8054.8 4584.6,8001 4584.6,8001 4584.6,8001 3310.3,8001 3310.3,8001"];
	layer50_moe_comm_from_expert13 -> layer50_moe_aggregate	[pos="e,3287,7988 4938.1,8089.6 4938.1,8051.3 4938.1,7988 4938.1,7988 4938.1,7988 3297,7988 3297,7988"];
	layer50_moe_comm_from_expert14 -> layer50_moe_aggregate	[pos="e,3273.5,7975 5293.1,8089.6 5293.1,8047.8 5293.1,7975 5293.1,7975 5293.1,7975 3283.5,7975 3283.5,7975"];
	layer50_moe_comm_from_expert15 -> layer50_moe_aggregate	[pos="e,3260.2,7962 5648.1,8089.5 5648.1,8044.4 5648.1,7962 5648.1,7962 5648.1,7962 3270.2,7962 3270.2,7962"];
	layer51_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L51\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3092,7773.2",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer51_moe_mha -> layer51_moe_gate	[pos="e,3092,7825.3 3092,7861 3092,7861 3092,7835.3 3092,7835.3"];
	layer51_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L51\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3092,7633.2",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer51_moe_gate -> layer51_moe_split	[pos="e,3092,7685.4 3092,7721.1 3092,7721.1 3092,7695.4 3092,7695.4"];
	layer51_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="1011,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer51_moe_split -> layer51_moe_comm_to_expert0	[pos="e,1081.8,7534.4 2926.6,7670 2445.8,7670 1081.8,7670 1081.8,7670 1081.8,7670 1081.8,7544.4 1081.8,7544.4",
		style=dashed];
	layer51_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1256,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer51_moe_split -> layer51_moe_comm_to_expert1	[pos="e,1335,7530.5 2911.4,7655 2463.1,7655 1335,7655 1335,7655 1335,7655 1335,7540.5 1335,7540.5",
		style=dashed];
	layer51_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1712,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer51_moe_split -> layer51_moe_comm_to_expert2	[pos="e,1778.3,7536.1 2896.7,7640 2530.8,7640 1778.3,7640 1778.3,7640 1778.3,7640 1778.3,7546.1 1778.3,7546.1",
		style=dashed];
	layer51_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2040,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer51_moe_split -> layer51_moe_comm_to_expert3	[pos="e,2096,7539 2881.7,7625 2589.4,7625 2096,7625 2096,7625 2096,7625 2096,7549 2096,7549",
		style=dashed];
	layer51_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2303,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer51_moe_split -> layer51_moe_comm_to_expert4	[pos="e,2338.5,7543.1 2866.7,7610 2644.7,7610 2338.5,7610 2338.5,7610 2338.5,7610 2338.5,7553.1 2338.5,7553.1",
		style=dashed];
	layer51_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2534,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer51_moe_split -> layer51_moe_comm_to_expert5	[pos="e,2544.5,7545 2852.7,7596 2705.3,7596 2544.5,7596 2544.5,7596 2544.5,7596 2544.5,7555 2544.5,7555",
		style=dashed];
	layer51_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2749,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer51_moe_split -> layer51_moe_comm_to_expert6	[pos="e,2839.8,7516 2852.5,7633.1 2852.5,7629.6 2852.5,7516 2852.5,7516 2852.5,7516 2849.8,7516 2849.8,7516",
		style=dashed];
	layer51_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2956,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer51_moe_split -> layer51_moe_comm_to_expert7	[pos="e,2956,7545.4 2956,7580.9 2956,7580.9 2956,7555.4 2956,7555.4",
		style=dashed];
	layer51_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3228,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer51_moe_split -> layer51_moe_comm_to_expert8	[pos="e,3228,7545.4 3228,7580.9 3228,7580.9 3228,7555.4 3228,7555.4",
		style=dashed];
	layer51_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3537,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer51_moe_split -> layer51_moe_comm_to_expert9	[pos="e,3446.3,7516 3332.3,7633.1 3332.3,7629.6 3332.3,7516 3332.3,7516 3332.3,7516 3436.3,7516 3436.3,7516",
		style=dashed];
	layer51_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3869,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer51_moe_split -> layer51_moe_comm_to_expert10	[pos="e,3793.1,7533.5 3257.3,7596 3464.5,7596 3793.1,7596 3793.1,7596 3793.1,7596 3793.1,7543.5 3793.1,7543.5",
		style=dashed];
	layer51_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4215,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer51_moe_split -> layer51_moe_comm_to_expert11	[pos="e,4139.6,7533.8 3270.9,7610 3570.1,7610 4139.6,7610 4139.6,7610 4139.6,7610 4139.6,7543.8 4139.6,7543.8",
		style=dashed];
	layer51_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4566,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer51_moe_split -> layer51_moe_comm_to_expert12	[pos="e,4490.6,7533.7 3286.1,7625 3670.2,7625 4490.6,7625 4490.6,7625 4490.6,7625 4490.6,7543.7 4490.6,7543.7",
		style=dashed];
	layer51_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4919,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer51_moe_split -> layer51_moe_comm_to_expert13	[pos="e,4844.1,7533.9 3301.2,7640 3766,7640 4844.1,7640 4844.1,7640 4844.1,7640 4844.1,7543.9 4844.1,7543.9",
		style=dashed];
	layer51_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5274,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer51_moe_split -> layer51_moe_comm_to_expert14	[pos="e,5199.1,7533.8 3316,7655 3858.6,7655 5199.1,7655 5199.1,7655 5199.1,7655 5199.1,7543.8 5199.1,7543.8",
		style=dashed];
	layer51_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5629,7516.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer51_moe_split -> layer51_moe_comm_to_expert15	[pos="e,5554.1,7533.8 3330.9,7670 3949.2,7670 5554.1,7670 5554.1,7670 5554.1,7670 5554.1,7543.8 5554.1,7543.8",
		style=dashed];
	layer51_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L51\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="497,7425.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer51_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="543,7334.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer51_moe_expert0 -> layer51_moe_comm_from_expert0	[pos="e,543,7363.4 543,7398.9 543,7398.9 543,7373.4 543,7373.4"];
	layer51_moe_comm_to_expert0 -> layer51_moe_expert0	[pos="e,618.75,7451.5 920.02,7516 804.15,7516 618.75,7516 618.75,7516 618.75,7516 618.75,7461.5 618.75,7461.5"];
	layer51_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L51\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="843,7425.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer51_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1256,7334.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer51_moe_expert1 -> layer51_moe_comm_from_expert1	[pos="e,1165.3,7334 945.25,7398.8 945.25,7371.9 945.25,7334 945.25,7334 945.25,7334 1155.3,7334 1155.3,7334"];
	layer51_moe_comm_to_expert1 -> layer51_moe_expert1	[pos="e,963.75,7451.2 1256,7487.1 1256,7473.4 1256,7460 1256,7460 1256,7460 963.75,7460 963.75,7460 963.75,7460 963.75,7459.1 963.75,7459.1"];
	layer51_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L51\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1189,7425.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer51_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1712,7334.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer51_moe_expert2 -> layer51_moe_comm_from_expert2	[pos="e,1621.3,7334 1353.2,7416 1360.6,7416 1365,7416 1365,7416 1365,7416 1365,7334 1365,7334 1365,7334 1611.3,7334 1611.3,7334"];
	layer51_moe_comm_to_expert2 -> layer51_moe_expert2	[pos="e,1353.3,7433 1621.1,7516 1516.5,7516 1359,7516 1359,7516 1359,7516 1359,7433 1359,7433 1359,7433 1358.4,7433 1358.4,7433"];
	layer51_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L51\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1535,7425.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer51_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="2040,7334.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer51_moe_expert3 -> layer51_moe_comm_from_expert3	[pos="e,1981.3,7356.5 1660.2,7398.9 1660.2,7386.8 1660.2,7375 1660.2,7375 1660.2,7375 1981.3,7375 1981.3,7375 1981.3,7375 1981.3,7366.5 \
1981.3,7366.5"];
	layer51_moe_comm_to_expert3 -> layer51_moe_expert3	[pos="e,1660.2,7451.3 1981.3,7494 1981.3,7485.6 1981.3,7478 1981.3,7478 1981.3,7478 1660.2,7478 1660.2,7478 1660.2,7478 1660.2,7461.3 \
1660.2,7461.3"];
	layer51_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L51\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1881,7425.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer51_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2303,7334.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer51_moe_expert4 -> layer51_moe_comm_from_expert4	[pos="e,2301.7,7363.4 2013.2,7399.1 2013.2,7392.4 2013.2,7387 2013.2,7387 2013.2,7387 2301.7,7387 2301.7,7387 2301.7,7387 2301.7,7373.4 \
2301.7,7373.4"];
	layer51_moe_comm_to_expert4 -> layer51_moe_expert4	[pos="e,2013.2,7451.4 2301.7,7487.1 2301.7,7477.4 2301.7,7469 2301.7,7469 2301.7,7469 2013.2,7469 2013.2,7469 2013.2,7469 2013.2,7461.4 \
2013.2,7461.4"];
	layer51_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L51\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2227,7425.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer51_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2534,7334.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer51_moe_expert5 -> layer51_moe_comm_from_expert5	[pos="e,2443.2,7334 2391.2,7416 2398.1,7416 2402.2,7416 2402.2,7416 2402.2,7416 2402.2,7334 2402.2,7334 2402.2,7334 2433.2,7334 2433.2,\
7334"];
	layer51_moe_comm_to_expert5 -> layer51_moe_expert5	[pos="e,2391.3,7433 2443.2,7516 2418.2,7516 2397.8,7516 2397.8,7516 2397.8,7516 2397.8,7433 2397.8,7433 2397.8,7433 2397.2,7433 2397.2,\
7433"];
	layer51_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L51\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2573,7425.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer51_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2749,7334.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer51_moe_expert6 -> layer51_moe_comm_from_expert6	[pos="e,2697.7,7358.3 2697.7,7398.9 2697.7,7398.9 2697.7,7368.3 2697.7,7368.3"];
	layer51_moe_comm_to_expert6 -> layer51_moe_expert6	[pos="e,2697.7,7451.5 2697.7,7492.3 2697.7,7492.3 2697.7,7461.5 2697.7,7461.5"];
	layer51_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L51\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2919,7425.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer51_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2956,7334.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer51_moe_expert7 -> layer51_moe_comm_from_expert7	[pos="e,2956,7363.4 2956,7398.9 2956,7398.9 2956,7373.4 2956,7373.4"];
	layer51_moe_comm_to_expert7 -> layer51_moe_expert7	[pos="e,2956,7451.5 2956,7487.2 2956,7487.2 2956,7461.5 2956,7461.5"];
	layer51_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L51\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3265,7425.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer51_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3228,7334.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer51_moe_expert8 -> layer51_moe_comm_from_expert8	[pos="e,3228,7363.4 3228,7398.9 3228,7398.9 3228,7373.4 3228,7373.4"];
	layer51_moe_comm_to_expert8 -> layer51_moe_expert8	[pos="e,3228,7451.5 3228,7487.2 3228,7487.2 3228,7461.5 3228,7461.5"];
	layer51_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L51\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3611,7425.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer51_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3537,7334.2",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer51_moe_expert9 -> layer51_moe_comm_from_expert9	[pos="e,3537.3,7363.4 3537.3,7398.9 3537.3,7398.9 3537.3,7373.4 3537.3,7373.4"];
	layer51_moe_comm_to_expert9 -> layer51_moe_expert9	[pos="e,3537.3,7451.5 3537.3,7487.2 3537.3,7487.2 3537.3,7461.5 3537.3,7461.5"];
	layer51_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L51\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3962,7425.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer51_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3869,7334.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer51_moe_expert10 -> layer51_moe_comm_from_expert10	[pos="e,3878.4,7363.4 3878.4,7398.9 3878.4,7398.9 3878.4,7373.4 3878.4,7373.4"];
	layer51_moe_comm_to_expert10 -> layer51_moe_expert10	[pos="e,3878,7451.5 3878,7487.2 3878,7487.2 3878,7461.5 3878,7461.5"];
	layer51_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L51\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4318,7425.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer51_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4216,7334.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer51_moe_expert11 -> layer51_moe_comm_from_expert11	[pos="e,4229.9,7363 4229.9,7398.9 4229.9,7398.9 4229.9,7373 4229.9,7373"];
	layer51_moe_comm_to_expert11 -> layer51_moe_expert11	[pos="e,4229,7451.3 4229,7487.4 4229,7487.4 4229,7461.3 4229,7461.3"];
	layer51_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L51\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4674,7425.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer51_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4567,7334.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer51_moe_expert12 -> layer51_moe_comm_from_expert12	[pos="e,4583.4,7363 4583.4,7398.9 4583.4,7398.9 4583.4,7373 4583.4,7373"];
	layer51_moe_comm_to_expert12 -> layer51_moe_expert12	[pos="e,4582.5,7451.3 4582.5,7487.4 4582.5,7487.4 4582.5,7461.3 4582.5,7461.3"];
	layer51_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L51\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="5030,7425.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer51_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4921,7334.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer51_moe_expert13 -> layer51_moe_comm_from_expert13	[pos="e,4938.4,7363 4938.4,7398.9 4938.4,7398.9 4938.4,7373 4938.4,7373"];
	layer51_moe_comm_to_expert13 -> layer51_moe_expert13	[pos="e,4937,7451.3 4937,7487.4 4937,7487.4 4937,7461.3 4937,7461.3"];
	layer51_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L51\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5386,7425.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer51_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5276,7334.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer51_moe_expert14 -> layer51_moe_comm_from_expert14	[pos="e,5293.9,7362.7 5293.9,7398.9 5293.9,7398.9 5293.9,7372.7 5293.9,7372.7"];
	layer51_moe_comm_to_expert14 -> layer51_moe_expert14	[pos="e,5292.5,7451.3 5292.5,7487.4 5292.5,7487.4 5292.5,7461.3 5292.5,7461.3"];
	layer51_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L51\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5742,7425.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer51_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5631,7334.2",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer51_moe_expert15 -> layer51_moe_comm_from_expert15	[pos="e,5649.4,7362.7 5649.4,7398.9 5649.4,7398.9 5649.4,7372.7 5649.4,7372.7"];
	layer51_moe_comm_to_expert15 -> layer51_moe_expert15	[pos="e,5648,7451.3 5648,7487.4 5648,7487.4 5648,7461.3 5648,7461.3"];
	layer51_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L51\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3055,7217.2",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer52_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L52\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3055,7103.2",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer51_moe_aggregate -> layer52_moe_mha	[pos="e,3055,7129.5 3055,7164.9 3055,7164.9 3055,7139.5 3055,7139.5"];
	layer51_moe_comm_from_expert0 -> layer51_moe_aggregate	[pos="e,2807.9,7180 628.75,7324.6 628.75,7290.8 628.75,7180 628.75,7180 628.75,7180 2797.9,7180 2797.9,7180"];
	layer51_moe_comm_from_expert1 -> layer51_moe_aggregate	[pos="e,2822.4,7194 1340.3,7323.2 1340.3,7290.2 1340.3,7194 1340.3,7194 1340.3,7194 2812.4,7194 2812.4,7194"];
	layer51_moe_comm_from_expert2 -> layer51_moe_aggregate	[pos="e,2838,7209 1784,7316.5 1784,7282 1784,7209 1784,7209 1784,7209 2828,7209 2828,7209"];
	layer51_moe_comm_from_expert3 -> layer51_moe_aggregate	[pos="e,2853.3,7224 2112,7316.5 2112,7285.4 2112,7224 2112,7224 2112,7224 2843.3,7224 2843.3,7224"];
	layer51_moe_comm_from_expert4 -> layer51_moe_aggregate	[pos="e,2868.6,7239 2382.8,7320.2 2382.8,7293.7 2382.8,7239 2382.8,7239 2382.8,7239 2858.6,7239 2858.6,7239"];
	layer51_moe_comm_from_expert5 -> layer51_moe_aggregate	[pos="e,2884.4,7254 2604.5,7316 2604.5,7292.3 2604.5,7254 2604.5,7254 2604.5,7254 2874.4,7254 2874.4,7254"];
	layer51_moe_comm_from_expert6 -> layer51_moe_aggregate	[pos="e,2816.1,7217.3 2816.1,7314.6 2816.1,7314.6 2816.1,7227.3 2816.1,7227.3"];
	layer51_moe_comm_from_expert7 -> layer51_moe_aggregate	[pos="e,2956,7269.3 2956,7305 2956,7305 2956,7279.3 2956,7279.3"];
	layer51_moe_comm_from_expert8 -> layer51_moe_aggregate	[pos="e,3227.4,7269.3 3227.4,7305 3227.4,7305 3227.4,7279.3 3227.4,7279.3"];
	layer51_moe_comm_from_expert9 -> layer51_moe_aggregate	[pos="e,3303.7,7256 3518.5,7305.5 3518.5,7283.2 3518.5,7256 3518.5,7256 3518.5,7256 3313.7,7256 3313.7,7256"];
	layer51_moe_comm_from_expert10 -> layer51_moe_aggregate	[pos="e,3290.1,7243 3850.1,7305.4 3850.1,7278.6 3850.1,7243 3850.1,7243 3850.1,7243 3300.1,7243 3300.1,7243"];
	layer51_moe_comm_from_expert11 -> layer51_moe_aggregate	[pos="e,3276.8,7230 4196.6,7305.7 4196.6,7274.9 4196.6,7230 4196.6,7230 4196.6,7230 3286.8,7230 3286.8,7230"];
	layer51_moe_comm_from_expert12 -> layer51_moe_aggregate	[pos="e,3263.3,7217 4547.6,7305.5 4547.6,7270.8 4547.6,7217 4547.6,7217 4547.6,7217 3273.3,7217 3273.3,7217"];
	layer51_moe_comm_from_expert13 -> layer51_moe_aggregate	[pos="e,3250,7204 4901.1,7305.6 4901.1,7267.3 4901.1,7204 4901.1,7204 4901.1,7204 3260,7204 3260,7204"];
	layer51_moe_comm_from_expert14 -> layer51_moe_aggregate	[pos="e,3236.5,7191 5256.1,7305.6 5256.1,7263.8 5256.1,7191 5256.1,7191 5256.1,7191 3246.5,7191 3246.5,7191"];
	layer51_moe_comm_from_expert15 -> layer51_moe_aggregate	[pos="e,3223.2,7178 5611.1,7305.6 5611.1,7260.5 5611.1,7178 5611.1,7178 5611.1,7178 3233.2,7178 3233.2,7178"];
	layer52_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L52\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3055,6989.2",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer52_moe_mha -> layer52_moe_gate	[pos="e,3055,7041.3 3055,7077.1 3055,7077.1 3055,7051.3 3055,7051.3"];
	layer52_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L52\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3055,6849.2",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer52_moe_gate -> layer52_moe_split	[pos="e,3055,6901.4 3055,6937.1 3055,6937.1 3055,6911.4 3055,6911.4"];
	layer52_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="974,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer52_moe_split -> layer52_moe_comm_to_expert0	[pos="e,1044.8,6750.5 2889.6,6886 2408.8,6886 1044.8,6886 1044.8,6886 1044.8,6886 1044.8,6760.5 1044.8,6760.5",
		style=dashed];
	layer52_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1219,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer52_moe_split -> layer52_moe_comm_to_expert1	[pos="e,1237.5,6760.7 2874.5,6871 2415.1,6871 1237.5,6871 1237.5,6871 1237.5,6871 1237.5,6770.7 1237.5,6770.7",
		style=dashed];
	layer52_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1675,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer52_moe_split -> layer52_moe_comm_to_expert2	[pos="e,1693.5,6760.6 2859.6,6856 2483,6856 1693.5,6856 1693.5,6856 1693.5,6856 1693.5,6770.6 1693.5,6770.6",
		style=dashed];
	layer52_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="2003,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer52_moe_split -> layer52_moe_comm_to_expert3	[pos="e,2021.5,6760.8 2844.6,6841 2542.4,6841 2021.5,6841 2021.5,6841 2021.5,6841 2021.5,6770.8 2021.5,6770.8",
		style=dashed];
	layer52_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2266,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer52_moe_split -> layer52_moe_comm_to_expert4	[pos="e,2284.5,6760.6 2829.5,6826 2602.2,6826 2284.5,6826 2284.5,6826 2284.5,6826 2284.5,6770.6 2284.5,6770.6",
		style=dashed];
	layer52_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2497,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer52_moe_split -> layer52_moe_comm_to_expert5	[pos="e,2515.5,6761 2815.6,6812 2671.4,6812 2515.5,6812 2515.5,6812 2515.5,6812 2515.5,6771 2515.5,6771",
		style=dashed];
	layer52_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2712,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer52_moe_split -> layer52_moe_comm_to_expert6	[pos="e,2802.8,6732 2815.5,6849.1 2815.5,6845.6 2815.5,6732 2815.5,6732 2815.5,6732 2812.8,6732 2812.8,6732",
		style=dashed];
	layer52_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2919,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer52_moe_split -> layer52_moe_comm_to_expert7	[pos="e,2919,6761.4 2919,6796.9 2919,6796.9 2919,6771.4 2919,6771.4",
		style=dashed];
	layer52_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3191,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer52_moe_split -> layer52_moe_comm_to_expert8	[pos="e,3191,6761.4 3191,6796.9 3191,6796.9 3191,6771.4 3191,6771.4",
		style=dashed];
	layer52_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3500,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer52_moe_split -> layer52_moe_comm_to_expert9	[pos="e,3409.3,6732 3295.3,6849.1 3295.3,6845.6 3295.3,6732 3295.3,6732 3295.3,6732 3399.3,6732 3399.3,6732",
		style=dashed];
	layer52_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3832,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer52_moe_split -> layer52_moe_comm_to_expert10	[pos="e,3756.1,6749.5 3220.3,6812 3427.5,6812 3756.1,6812 3756.1,6812 3756.1,6812 3756.1,6759.5 3756.1,6759.5",
		style=dashed];
	layer52_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4178,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer52_moe_split -> layer52_moe_comm_to_expert11	[pos="e,4102.6,6749.9 3233.9,6826 3533.1,6826 4102.6,6826 4102.6,6826 4102.6,6826 4102.6,6759.9 4102.6,6759.9",
		style=dashed];
	layer52_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4529,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer52_moe_split -> layer52_moe_comm_to_expert12	[pos="e,4453.6,6749.7 3249.1,6841 3633.2,6841 4453.6,6841 4453.6,6841 4453.6,6841 4453.6,6759.7 4453.6,6759.7",
		style=dashed];
	layer52_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4882,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer52_moe_split -> layer52_moe_comm_to_expert13	[pos="e,4807.1,6750 3264.2,6856 3729,6856 4807.1,6856 4807.1,6856 4807.1,6856 4807.1,6760 4807.1,6760",
		style=dashed];
	layer52_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5237,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer52_moe_split -> layer52_moe_comm_to_expert14	[pos="e,5162.1,6749.8 3279,6871 3821.6,6871 5162.1,6871 5162.1,6871 5162.1,6871 5162.1,6759.8 5162.1,6759.8",
		style=dashed];
	layer52_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5592,6732.2",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer52_moe_split -> layer52_moe_comm_to_expert15	[pos="e,5517.1,6749.9 3293.9,6886 3912.2,6886 5517.1,6886 5517.1,6886 5517.1,6886 5517.1,6759.9 5517.1,6759.9",
		style=dashed];
	layer52_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L52\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="460,6641.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer52_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="754,6550.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer52_moe_expert0 -> layer52_moe_comm_from_expert0	[pos="e,663.29,6550 614.5,6614.9 614.5,6587.9 614.5,6550 614.5,6550 614.5,6550 653.29,6550 653.29,6550"];
	layer52_moe_comm_to_expert0 -> layer52_moe_expert0	[pos="e,538.25,6667.5 883.45,6732 755.78,6732 538.25,6732 538.25,6732 538.25,6732 538.25,6677.5 538.25,6677.5"];
	layer52_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L52\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="806,6641.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer52_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1100,6550.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer52_moe_expert1 -> layer52_moe_comm_from_expert1	[pos="e,1009.3,6550 960.5,6614.9 960.5,6587.9 960.5,6550 960.5,6550 960.5,6550 999.29,6550 999.29,6550"];
	layer52_moe_comm_to_expert1 -> layer52_moe_expert1	[pos="e,926.75,6667.6 1219,6703.1 1219,6689.4 1219,6676 1219,6676 1219,6676 926.75,6676 926.75,6676 926.75,6676 926.75,6675.2 926.75,6675.2"];
	layer52_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L52\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1152,6641.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer52_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1446,6550.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer52_moe_expert2 -> layer52_moe_comm_from_expert2	[pos="e,1355.3,6550 1306.5,6614.9 1306.5,6587.9 1306.5,6550 1306.5,6550 1306.5,6550 1345.3,6550 1345.3,6550"];
	layer52_moe_comm_to_expert2 -> layer52_moe_expert2	[pos="e,1316.2,6641 1584.4,6732 1480.7,6732 1325,6732 1325,6732 1325,6732 1325,6641 1325,6641 1325,6641 1324.1,6641 1324.1,6641"];
	layer52_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L52\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1498,6641.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer52_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="1718,6550.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer52_moe_expert3 -> layer52_moe_comm_from_expert3	[pos="e,1644.7,6567.3 1644.7,6614.9 1644.7,6614.9 1644.7,6577.3 1644.7,6577.3"];
	layer52_moe_comm_to_expert3 -> layer52_moe_expert3	[pos="e,1623.2,6667.3 1944.3,6710 1944.3,6701.6 1944.3,6694 1944.3,6694 1944.3,6694 1623.2,6694 1623.2,6694 1623.2,6694 1623.2,6677.3 \
1623.2,6677.3"];
	layer52_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L52\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1844,6641.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer52_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="1954,6550.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer52_moe_expert4 -> layer52_moe_comm_from_expert4	[pos="e,1935.7,6578.7 1935.7,6614.9 1935.7,6614.9 1935.7,6588.7 1935.7,6588.7"];
	layer52_moe_comm_to_expert4 -> layer52_moe_expert4	[pos="e,1976.2,6667.5 2264.7,6703.1 2264.7,6693.4 2264.7,6685 2264.7,6685 2264.7,6685 1976.2,6685 1976.2,6685 1976.2,6685 1976.2,6677.5 \
1976.2,6677.5"];
	layer52_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L52\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2190,6641.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer52_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2301,6550.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer52_moe_expert5 -> layer52_moe_comm_from_expert5	[pos="e,2282.2,6578.7 2282.2,6614.9 2282.2,6614.9 2282.2,6588.7 2282.2,6588.7"];
	layer52_moe_comm_to_expert5 -> layer52_moe_expert5	[pos="e,2354.1,6641 2406.3,6732 2382.9,6732 2364.3,6732 2364.3,6732 2364.3,6732 2364.3,6641 2364.3,6641 2364.3,6641 2363.2,6641 2363.2,\
6641"];
	layer52_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L52\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2536,6641.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer52_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2647,6550.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer52_moe_expert6 -> layer52_moe_comm_from_expert6	[pos="e,2628.2,6578.7 2628.2,6614.9 2628.2,6614.9 2628.2,6588.7 2628.2,6588.7"];
	layer52_moe_comm_to_expert6 -> layer52_moe_expert6	[pos="e,2660.7,6667.6 2660.7,6708.3 2660.7,6708.3 2660.7,6677.6 2660.7,6677.6"];
	layer52_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L52\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2882,6641.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer52_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2919,6550.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer52_moe_expert7 -> layer52_moe_comm_from_expert7	[pos="e,2919,6579.4 2919,6614.9 2919,6614.9 2919,6589.4 2919,6589.4"];
	layer52_moe_comm_to_expert7 -> layer52_moe_expert7	[pos="e,2919,6667.5 2919,6703.2 2919,6703.2 2919,6677.5 2919,6677.5"];
	layer52_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L52\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3228,6641.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer52_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3191,6550.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer52_moe_expert8 -> layer52_moe_comm_from_expert8	[pos="e,3191,6579.4 3191,6614.9 3191,6614.9 3191,6589.4 3191,6589.4"];
	layer52_moe_comm_to_expert8 -> layer52_moe_expert8	[pos="e,3191,6667.5 3191,6703.2 3191,6703.2 3191,6677.5 3191,6677.5"];
	layer52_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L52\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3574,6641.2",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer52_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3500,6550.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer52_moe_expert9 -> layer52_moe_comm_from_expert9	[pos="e,3500.3,6579.4 3500.3,6614.9 3500.3,6614.9 3500.3,6589.4 3500.3,6589.4"];
	layer52_moe_comm_to_expert9 -> layer52_moe_expert9	[pos="e,3500.3,6667.5 3500.3,6703.2 3500.3,6703.2 3500.3,6677.5 3500.3,6677.5"];
	layer52_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L52\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3925,6641.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer52_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3832,6550.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer52_moe_expert10 -> layer52_moe_comm_from_expert10	[pos="e,3841.4,6579.4 3841.4,6614.9 3841.4,6614.9 3841.4,6589.4 3841.4,6589.4"];
	layer52_moe_comm_to_expert10 -> layer52_moe_expert10	[pos="e,3841,6667.5 3841,6703.2 3841,6703.2 3841,6677.5 3841,6677.5"];
	layer52_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L52\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4281,6641.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer52_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4179,6550.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer52_moe_expert11 -> layer52_moe_comm_from_expert11	[pos="e,4192.9,6579.1 4192.9,6614.9 4192.9,6614.9 4192.9,6589.1 4192.9,6589.1"];
	layer52_moe_comm_to_expert11 -> layer52_moe_expert11	[pos="e,4192,6667.4 4192,6703.4 4192,6703.4 4192,6677.4 4192,6677.4"];
	layer52_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L52\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4637,6641.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer52_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4530,6550.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer52_moe_expert12 -> layer52_moe_comm_from_expert12	[pos="e,4546.4,6579.1 4546.4,6614.9 4546.4,6614.9 4546.4,6589.1 4546.4,6589.1"];
	layer52_moe_comm_to_expert12 -> layer52_moe_expert12	[pos="e,4545.5,6667.4 4545.5,6703.4 4545.5,6703.4 4545.5,6677.4 4545.5,6677.4"];
	layer52_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L52\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="4993,6641.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer52_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4884,6550.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer52_moe_expert13 -> layer52_moe_comm_from_expert13	[pos="e,4901.4,6579.1 4901.4,6614.9 4901.4,6614.9 4901.4,6589.1 4901.4,6589.1"];
	layer52_moe_comm_to_expert13 -> layer52_moe_expert13	[pos="e,4900,6667.4 4900,6703.4 4900,6703.4 4900,6677.4 4900,6677.4"];
	layer52_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L52\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5349,6641.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer52_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5239,6550.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer52_moe_expert14 -> layer52_moe_comm_from_expert14	[pos="e,5256.9,6578.7 5256.9,6614.9 5256.9,6614.9 5256.9,6588.7 5256.9,6588.7"];
	layer52_moe_comm_to_expert14 -> layer52_moe_expert14	[pos="e,5255.5,6667.4 5255.5,6703.4 5255.5,6703.4 5255.5,6677.4 5255.5,6677.4"];
	layer52_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L52\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5705,6641.2",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer52_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5594,6550.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer52_moe_expert15 -> layer52_moe_comm_from_expert15	[pos="e,5612.4,6578.7 5612.4,6614.9 5612.4,6614.9 5612.4,6588.7 5612.4,6588.7"];
	layer52_moe_comm_to_expert15 -> layer52_moe_expert15	[pos="e,5611,6667.4 5611,6703.4 5611,6703.4 5611,6677.4 5611,6677.4"];
	layer52_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L52\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3018,6433.3",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer53_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L53\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="3018,6319.3",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer52_moe_aggregate -> layer53_moe_mha	[pos="e,3018,6345.5 3018,6380.9 3018,6380.9 3018,6355.5 3018,6355.5"];
	layer52_moe_comm_from_expert0 -> layer52_moe_aggregate	[pos="e,2770.9,6396 754,6521.2 754,6476.6 754,6396 754,6396 754,6396 2760.9,6396 2760.9,6396"];
	layer52_moe_comm_from_expert1 -> layer52_moe_aggregate	[pos="e,2785.5,6410 1141,6524.2 1141,6483.6 1141,6410 1141,6410 1141,6410 2775.5,6410 2775.5,6410"];
	layer52_moe_comm_from_expert2 -> layer52_moe_aggregate	[pos="e,2800.7,6425 1446,6521.2 1446,6484.2 1446,6425 1446,6425 1446,6425 2790.7,6425 2790.7,6425"];
	layer52_moe_comm_from_expert3 -> layer52_moe_aggregate	[pos="e,2816.2,6440 1768.5,6526.1 1768.5,6493.6 1768.5,6440 1768.5,6440 1768.5,6440 2806.2,6440 2806.2,6440"];
	layer52_moe_comm_from_expert4 -> layer52_moe_aggregate	[pos="e,2831.9,6455 1960,6521.2 1960,6493.1 1960,6455 1960,6455 1960,6455 2821.9,6455 2821.9,6455"];
	layer52_moe_comm_from_expert5 -> layer52_moe_aggregate	[pos="e,2847.2,6470 2380.5,6536.3 2380.5,6513.3 2380.5,6470 2380.5,6470 2380.5,6470 2837.2,6470 2837.2,6470"];
	layer52_moe_comm_from_expert6 -> layer52_moe_aggregate	[pos="e,2792.1,6433.3 2737.7,6550 2767,6550 2792.1,6550 2792.1,6550 2792.1,6550 2792.1,6443.3 2792.1,6443.3"];
	layer52_moe_comm_from_expert7 -> layer52_moe_aggregate	[pos="e,2919,6485.3 2919,6521 2919,6521 2919,6495.3 2919,6495.3"];
	layer52_moe_comm_from_expert8 -> layer52_moe_aggregate	[pos="e,3190.4,6485.3 3190.4,6521 3190.4,6521 3190.4,6495.3 3190.4,6495.3"];
	layer52_moe_comm_from_expert9 -> layer52_moe_aggregate	[pos="e,3266.7,6472 3481.5,6521.6 3481.5,6499.2 3481.5,6472 3481.5,6472 3481.5,6472 3276.7,6472 3276.7,6472"];
	layer52_moe_comm_from_expert10 -> layer52_moe_aggregate	[pos="e,3253.1,6459 3813.1,6521.4 3813.1,6494.6 3813.1,6459 3813.1,6459 3813.1,6459 3263.1,6459 3263.1,6459"];
	layer52_moe_comm_from_expert11 -> layer52_moe_aggregate	[pos="e,3239.8,6446 4159.6,6521.8 4159.6,6490.9 4159.6,6446 4159.6,6446 4159.6,6446 3249.8,6446 3249.8,6446"];
	layer52_moe_comm_from_expert12 -> layer52_moe_aggregate	[pos="e,3226.3,6433 4510.6,6521.9 4510.6,6487.2 4510.6,6433 4510.6,6433 4510.6,6433 3236.3,6433 3236.3,6433"];
	layer52_moe_comm_from_expert13 -> layer52_moe_aggregate	[pos="e,3213,6420 4864.1,6521.7 4864.1,6483.3 4864.1,6420 4864.1,6420 4864.1,6420 3223,6420 3223,6420"];
	layer52_moe_comm_from_expert14 -> layer52_moe_aggregate	[pos="e,3199.5,6407 5219.1,6521.6 5219.1,6479.8 5219.1,6407 5219.1,6407 5219.1,6407 3209.5,6407 3209.5,6407"];
	layer52_moe_comm_from_expert15 -> layer52_moe_aggregate	[pos="e,3186.2,6394 5574.1,6521.6 5574.1,6476.5 5574.1,6394 5574.1,6394 5574.1,6394 3196.2,6394 3196.2,6394"];
	layer53_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L53\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="3018,6205.3",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer53_moe_mha -> layer53_moe_gate	[pos="e,3018,6257.4 3018,6293.1 3018,6293.1 3018,6267.4 3018,6267.4"];
	layer53_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L53\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="3018,6065.3",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer53_moe_gate -> layer53_moe_split	[pos="e,3018,6117.4 3018,6153.1 3018,6153.1 3018,6127.4 3018,6127.4"];
	layer53_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="469,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer53_moe_split -> layer53_moe_comm_to_expert0	[pos="e,469,5977.5 2852.2,6102 2286.8,6102 469,6102 469,6102 469,6102 469,5987.5 469,5987.5",
		style=dashed];
	layer53_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1182,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer53_moe_split -> layer53_moe_comm_to_expert1	[pos="e,1231.5,5972.8 2837.3,6087 2383.4,6087 1231.5,6087 1231.5,6087 1231.5,6087 1231.5,5982.8 1231.5,5982.8",
		style=dashed];
	layer53_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1638,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer53_moe_split -> layer53_moe_comm_to_expert2	[pos="e,1678,5974.5 2822.4,6072 2450.5,6072 1678,6072 1678,6072 1678,6072 1678,5984.5 1678,5984.5",
		style=dashed];
	layer53_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="1966,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer53_moe_split -> layer53_moe_comm_to_expert3	[pos="e,2050.5,5958.7 2807.5,6057 2522.9,6057 2050.5,6057 2050.5,6057 2050.5,6057 2050.5,5968.7 2050.5,5968.7",
		style=dashed];
	layer53_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2229,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer53_moe_split -> layer53_moe_comm_to_expert4	[pos="e,2265,5974.9 2792.6,6042 2570.7,6042 2265,6042 2265,6042 2265,6042 2265,5984.9 2265,5984.9",
		style=dashed];
	layer53_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2460,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer53_moe_split -> layer53_moe_comm_to_expert5	[pos="e,2471,5977.1 2778.5,6028 2631.4,6028 2471,6028 2471,6028 2471,6028 2471,5987.1 2471,5987.1",
		style=dashed];
	layer53_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2675,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer53_moe_split -> layer53_moe_comm_to_expert6	[pos="e,2765.8,5948 2778.5,6065.2 2778.5,6061.6 2778.5,5948 2778.5,5948 2778.5,5948 2775.8,5948 2775.8,5948",
		style=dashed];
	layer53_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2882,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer53_moe_split -> layer53_moe_comm_to_expert7	[pos="e,2882,5977.5 2882,6012.9 2882,6012.9 2882,5987.5 2882,5987.5",
		style=dashed];
	layer53_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3154,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer53_moe_split -> layer53_moe_comm_to_expert8	[pos="e,3154,5977.5 3154,6012.9 3154,6012.9 3154,5987.5 3154,5987.5",
		style=dashed];
	layer53_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3463,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer53_moe_split -> layer53_moe_comm_to_expert9	[pos="e,3372.3,5948 3258.3,6065.2 3258.3,6061.6 3258.3,5948 3258.3,5948 3258.3,5948 3362.3,5948 3362.3,5948",
		style=dashed];
	layer53_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3795,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer53_moe_split -> layer53_moe_comm_to_expert10	[pos="e,3719.1,5965.6 3182.8,6028 3390.1,6028 3719.1,6028 3719.1,6028 3719.1,6028 3719.1,5975.6 3719.1,5975.6",
		style=dashed];
	layer53_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4141,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer53_moe_split -> layer53_moe_comm_to_expert11	[pos="e,4065.6,5965.9 3196.9,6042 3496.1,6042 4065.6,6042 4065.6,6042 4065.6,6042 4065.6,5975.9 4065.6,5975.9",
		style=dashed];
	layer53_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4492,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer53_moe_split -> layer53_moe_comm_to_expert12	[pos="e,4416.6,5965.7 3212.1,6057 3596.2,6057 4416.6,6057 4416.6,6057 4416.6,6057 4416.6,5975.7 4416.6,5975.7",
		style=dashed];
	layer53_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4845,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer53_moe_split -> layer53_moe_comm_to_expert13	[pos="e,4770.1,5966 3227.2,6072 3692,6072 4770.1,6072 4770.1,6072 4770.1,6072 4770.1,5976 4770.1,5976",
		style=dashed];
	layer53_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5200,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer53_moe_split -> layer53_moe_comm_to_expert14	[pos="e,5125.1,5965.8 3242,6087 3784.6,6087 5125.1,6087 5125.1,6087 5125.1,6087 5125.1,5975.8 5125.1,5975.8",
		style=dashed];
	layer53_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5555,5948.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer53_moe_split -> layer53_moe_comm_to_expert15	[pos="e,5480.1,5965.9 3256.9,6102 3875.2,6102 5480.1,6102 5480.1,6102 5480.1,6102 5480.1,5975.9 5480.1,5975.9",
		style=dashed];
	layer53_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L53\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="423,5857.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer53_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="496,5766.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer53_moe_expert0 -> layer53_moe_comm_from_expert0	[pos="e,496,5795.4 496,5831 496,5831 496,5805.4 496,5805.4"];
	layer53_moe_comm_to_expert0 -> layer53_moe_expert0	[pos="e,469,5883.6 469,5919.2 469,5919.2 469,5893.6 469,5893.6"];
	layer53_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L53\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="769,5857.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer53_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="854,5766.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer53_moe_expert1 -> layer53_moe_comm_from_expert1	[pos="e,848.25,5795.4 848.25,5831 848.25,5831 848.25,5805.4 848.25,5805.4"];
	layer53_moe_comm_to_expert1 -> layer53_moe_expert1	[pos="e,888.75,5883.5 1091.2,5948 1005.1,5948 888.75,5948 888.75,5948 888.75,5948 888.75,5893.5 888.75,5893.5"];
	layer53_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L53\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1115,5857.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer53_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1175,5766.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer53_moe_expert2 -> layer53_moe_comm_from_expert2	[pos="e,1175,5795.4 1175,5831 1175,5831 1175,5805.4 1175,5805.4"];
	layer53_moe_comm_to_expert2 -> layer53_moe_expert2	[pos="e,1279.2,5857 1547.4,5948 1443.7,5948 1288,5948 1288,5948 1288,5948 1288,5857 1288,5857 1288,5857 1287.1,5857 1287.1,5857"];
	layer53_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L53\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1461,5857.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer53_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="1741,5766.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer53_moe_expert3 -> layer53_moe_comm_from_expert3	[pos="e,1650.3,5766 1567.7,5830.9 1567.7,5803.9 1567.7,5766 1567.7,5766 1567.7,5766 1640.3,5766 1640.3,5766"];
	layer53_moe_comm_to_expert3 -> layer53_moe_expert3	[pos="e,1586.2,5883.3 1907.3,5926.2 1907.3,5916.4 1907.3,5907 1907.3,5907 1907.3,5907 1586.2,5907 1586.2,5907 1586.2,5907 1586.2,5893.3 \
1586.2,5893.3"];
	layer53_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L53\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1807,5857.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer53_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2124,5766.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer53_moe_expert4 -> layer53_moe_comm_from_expert4	[pos="e,2033.2,5766 1904.7,5830.9 1904.7,5803.9 1904.7,5766 1904.7,5766 1904.7,5766 2023.2,5766 2023.2,5766"];
	layer53_moe_comm_to_expert4 -> layer53_moe_expert4	[pos="e,1939.2,5883.5 2227.7,5919.1 2227.7,5906.7 2227.7,5895 2227.7,5895 2227.7,5895 1939.2,5895 1939.2,5895 1939.2,5895 1939.2,5893.5 \
1939.2,5893.5"];
	layer53_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L53\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2153,5857.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer53_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2415,5766.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer53_moe_expert5 -> layer53_moe_comm_from_expert5	[pos="e,2331.5,5777.7 2317.2,5848 2326.1,5848 2331.5,5848 2331.5,5848 2331.5,5848 2331.5,5787.7 2331.5,5787.7"];
	layer53_moe_comm_to_expert5 -> layer53_moe_expert5	[pos="e,2317,5865 2369.4,5948 2346.4,5948 2328,5948 2328,5948 2328,5948 2328,5865 2328,5865 2328,5865 2326.9,5865 2326.9,5865"];
	layer53_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L53\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2499,5857.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer53_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2660,5766.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer53_moe_expert6 -> layer53_moe_comm_from_expert6	[pos="e,2616.2,5791.9 2616.2,5831 2616.2,5831 2616.2,5801.9 2616.2,5801.9"];
	layer53_moe_comm_to_expert6 -> layer53_moe_expert6	[pos="e,2623.7,5883.6 2623.7,5924.4 2623.7,5924.4 2623.7,5893.6 2623.7,5893.6"];
	layer53_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L53\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2845,5857.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer53_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2882,5766.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer53_moe_expert7 -> layer53_moe_comm_from_expert7	[pos="e,2882,5795.4 2882,5831 2882,5831 2882,5805.4 2882,5805.4"];
	layer53_moe_comm_to_expert7 -> layer53_moe_expert7	[pos="e,2882,5883.6 2882,5919.2 2882,5919.2 2882,5893.6 2882,5893.6"];
	layer53_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L53\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3191,5857.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer53_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3154,5766.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer53_moe_expert8 -> layer53_moe_comm_from_expert8	[pos="e,3154,5795.4 3154,5831 3154,5831 3154,5805.4 3154,5805.4"];
	layer53_moe_comm_to_expert8 -> layer53_moe_expert8	[pos="e,3154,5883.6 3154,5919.2 3154,5919.2 3154,5893.6 3154,5893.6"];
	layer53_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L53\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3537,5857.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer53_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3463,5766.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer53_moe_expert9 -> layer53_moe_comm_from_expert9	[pos="e,3463.3,5795.4 3463.3,5831 3463.3,5831 3463.3,5805.4 3463.3,5805.4"];
	layer53_moe_comm_to_expert9 -> layer53_moe_expert9	[pos="e,3463.3,5883.6 3463.3,5919.2 3463.3,5919.2 3463.3,5893.6 3463.3,5893.6"];
	layer53_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L53\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3888,5857.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer53_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3795,5766.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer53_moe_expert10 -> layer53_moe_comm_from_expert10	[pos="e,3804.4,5795.4 3804.4,5831 3804.4,5831 3804.4,5805.4 3804.4,5805.4"];
	layer53_moe_comm_to_expert10 -> layer53_moe_expert10	[pos="e,3804,5883.6 3804,5919.2 3804,5919.2 3804,5893.6 3804,5893.6"];
	layer53_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L53\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4244,5857.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer53_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4142,5766.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer53_moe_expert11 -> layer53_moe_comm_from_expert11	[pos="e,4155.9,5795.1 4155.9,5831 4155.9,5831 4155.9,5805.1 4155.9,5805.1"];
	layer53_moe_comm_to_expert11 -> layer53_moe_expert11	[pos="e,4155,5883.4 4155,5919.5 4155,5919.5 4155,5893.4 4155,5893.4"];
	layer53_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L53\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4600,5857.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer53_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4493,5766.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer53_moe_expert12 -> layer53_moe_comm_from_expert12	[pos="e,4509.4,5795.1 4509.4,5831 4509.4,5831 4509.4,5805.1 4509.4,5805.1"];
	layer53_moe_comm_to_expert12 -> layer53_moe_expert12	[pos="e,4508.5,5883.4 4508.5,5919.5 4508.5,5919.5 4508.5,5893.4 4508.5,5893.4"];
	layer53_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L53\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="4956,5857.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer53_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4847,5766.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer53_moe_expert13 -> layer53_moe_comm_from_expert13	[pos="e,4864.4,5795.1 4864.4,5831 4864.4,5831 4864.4,5805.1 4864.4,5805.1"];
	layer53_moe_comm_to_expert13 -> layer53_moe_expert13	[pos="e,4863,5883.4 4863,5919.5 4863,5919.5 4863,5893.4 4863,5893.4"];
	layer53_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L53\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5312,5857.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer53_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5202,5766.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer53_moe_expert14 -> layer53_moe_comm_from_expert14	[pos="e,5219.9,5794.8 5219.9,5831 5219.9,5831 5219.9,5804.8 5219.9,5804.8"];
	layer53_moe_comm_to_expert14 -> layer53_moe_expert14	[pos="e,5218.5,5883.4 5218.5,5919.5 5218.5,5919.5 5218.5,5893.4 5218.5,5893.4"];
	layer53_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L53\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5668,5857.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer53_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5557,5766.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer53_moe_expert15 -> layer53_moe_comm_from_expert15	[pos="e,5575.4,5794.8 5575.4,5831 5575.4,5831 5575.4,5804.8 5575.4,5804.8"];
	layer53_moe_comm_to_expert15 -> layer53_moe_expert15	[pos="e,5574,5883.4 5574,5919.5 5574,5919.5 5574,5893.4 5574,5893.4"];
	layer53_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L53\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2981,5649.3",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer54_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L54\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2981,5535.3",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer53_moe_aggregate -> layer54_moe_mha	[pos="e,2981,5561.5 2981,5597 2981,5597 2981,5571.5 2981,5571.5"];
	layer53_moe_comm_from_expert0 -> layer53_moe_aggregate	[pos="e,2733.9,5612 577.25,5753.4 577.25,5716.3 577.25,5612 577.25,5612 577.25,5612 2723.9,5612 2723.9,5612"];
	layer53_moe_comm_from_expert1 -> layer53_moe_aggregate	[pos="e,2749.1,5627 929.25,5750 929.25,5713.3 929.25,5627 929.25,5627 929.25,5627 2739.1,5627 2739.1,5627"];
	layer53_moe_comm_from_expert2 -> layer53_moe_aggregate	[pos="e,2763.7,5641 1248,5749.1 1248,5714.8 1248,5641 1248,5641 1248,5641 2753.7,5641 2753.7,5641"];
	layer53_moe_comm_from_expert3 -> layer53_moe_aggregate	[pos="e,2779.3,5656 1761.5,5737.9 1761.5,5705.2 1761.5,5656 1761.5,5656 1761.5,5656 2769.3,5656 2769.3,5656"];
	layer53_moe_comm_from_expert4 -> layer53_moe_aggregate	[pos="e,2794.8,5671 2158,5739.2 2158,5711.1 2158,5671 2158,5671 2158,5671 2784.8,5671 2784.8,5671"];
	layer53_moe_comm_from_expert5 -> layer53_moe_aggregate	[pos="e,2810.1,5686 2419,5737.3 2419,5714.3 2419,5686 2419,5686 2419,5686 2800.1,5686 2800.1,5686"];
	layer53_moe_comm_from_expert6 -> layer53_moe_aggregate	[pos="e,2734.6,5649.3 2734.6,5749.8 2734.6,5749.8 2734.6,5659.3 2734.6,5659.3"];
	layer53_moe_comm_from_expert7 -> layer53_moe_aggregate	[pos="e,2882,5701.4 2882,5737.1 2882,5737.1 2882,5711.4 2882,5711.4"];
	layer53_moe_comm_from_expert8 -> layer53_moe_aggregate	[pos="e,3153.4,5701.4 3153.4,5737.1 3153.4,5737.1 3153.4,5711.4 3153.4,5711.4"];
	layer53_moe_comm_from_expert9 -> layer53_moe_aggregate	[pos="e,3229.7,5688 3444.5,5737.6 3444.5,5715.2 3444.5,5688 3444.5,5688 3444.5,5688 3239.7,5688 3239.7,5688"];
	layer53_moe_comm_from_expert10 -> layer53_moe_aggregate	[pos="e,3216.1,5675 3776.1,5737.4 3776.1,5710.7 3776.1,5675 3776.1,5675 3776.1,5675 3226.1,5675 3226.1,5675"];
	layer53_moe_comm_from_expert11 -> layer53_moe_aggregate	[pos="e,3202.8,5662 4122.6,5737.8 4122.6,5706.9 4122.6,5662 4122.6,5662 4122.6,5662 3212.8,5662 3212.8,5662"];
	layer53_moe_comm_from_expert12 -> layer53_moe_aggregate	[pos="e,3189.3,5649 4473.6,5737.9 4473.6,5703.2 4473.6,5649 4473.6,5649 4473.6,5649 3199.3,5649 3199.3,5649"];
	layer53_moe_comm_from_expert13 -> layer53_moe_aggregate	[pos="e,3176,5636 4827.1,5737.7 4827.1,5699.3 4827.1,5636 4827.1,5636 4827.1,5636 3186,5636 3186,5636"];
	layer53_moe_comm_from_expert14 -> layer53_moe_aggregate	[pos="e,3162.5,5623 5182.1,5737.6 5182.1,5695.8 5182.1,5623 5182.1,5623 5182.1,5623 3172.5,5623 3172.5,5623"];
	layer53_moe_comm_from_expert15 -> layer53_moe_aggregate	[pos="e,3149.2,5610 5537.1,5737.6 5537.1,5692.5 5537.1,5610 5537.1,5610 5537.1,5610 3159.2,5610 3159.2,5610"];
	layer54_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L54\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="2981,5421.3",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer54_moe_mha -> layer54_moe_gate	[pos="e,2981,5473.4 2981,5509.1 2981,5509.1 2981,5483.4 2981,5483.4"];
	layer54_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L54\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="2981,5281.3",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer54_moe_gate -> layer54_moe_split	[pos="e,2981,5333.5 2981,5369.2 2981,5369.2 2981,5343.5 2981,5343.5"];
	layer54_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="432,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer54_moe_split -> layer54_moe_comm_to_expert0	[pos="e,464,5191.4 2815.4,5318 2254.9,5318 464,5318 464,5318 464,5318 464,5201.4 464,5201.4",
		style=dashed];
	layer54_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1145,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer54_moe_split -> layer54_moe_comm_to_expert1	[pos="e,1160,5193 2800.6,5303 2340.6,5303 1160,5303 1160,5303 1160,5303 1160,5203 1160,5203",
		style=dashed];
	layer54_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1601,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer54_moe_split -> layer54_moe_comm_to_expert2	[pos="e,1671,5182.8 2785.6,5288 2420.4,5288 1671,5288 1671,5288 1671,5288 1671,5192.8 1671,5192.8",
		style=dashed];
	layer54_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="1929,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer54_moe_split -> layer54_moe_comm_to_expert3	[pos="e,2004.3,5180.8 2770.6,5273 2483.5,5273 2004.3,5273 2004.3,5273 2004.3,5273 2004.3,5190.8 2004.3,5190.8",
		style=dashed];
	layer54_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2192,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer54_moe_split -> layer54_moe_comm_to_expert4	[pos="e,2248.5,5187.2 2756.3,5259 2540.9,5259 2248.5,5259 2248.5,5259 2248.5,5259 2248.5,5197.2 2248.5,5197.2",
		style=dashed];
	layer54_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2423,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer54_moe_split -> layer54_moe_comm_to_expert5	[pos="e,2509.5,5172.8 2741.5,5244 2624.9,5244 2509.5,5244 2509.5,5244 2509.5,5244 2509.5,5182.8 2509.5,5182.8",
		style=dashed];
	layer54_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2638,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer54_moe_split -> layer54_moe_comm_to_expert6	[pos="e,2728.8,5164 2741.5,5281.2 2741.5,5277.7 2741.5,5164 2741.5,5164 2741.5,5164 2738.8,5164 2738.8,5164",
		style=dashed];
	layer54_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2845,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer54_moe_split -> layer54_moe_comm_to_expert7	[pos="e,2845,5193.5 2845,5229 2845,5229 2845,5203.5 2845,5203.5",
		style=dashed];
	layer54_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3117,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer54_moe_split -> layer54_moe_comm_to_expert8	[pos="e,3117,5193.5 3117,5229 3117,5229 3117,5203.5 3117,5203.5",
		style=dashed];
	layer54_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3426,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer54_moe_split -> layer54_moe_comm_to_expert9	[pos="e,3335.3,5164 3221.3,5281.2 3221.3,5277.7 3221.3,5164 3221.3,5164 3221.3,5164 3325.3,5164 3325.3,5164",
		style=dashed];
	layer54_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3758,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer54_moe_split -> layer54_moe_comm_to_expert10	[pos="e,3682.1,5181.6 3145.8,5244 3353.1,5244 3682.1,5244 3682.1,5244 3682.1,5244 3682.1,5191.6 3682.1,5191.6",
		style=dashed];
	layer54_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4104,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer54_moe_split -> layer54_moe_comm_to_expert11	[pos="e,4028.6,5181.7 3160.8,5259 3460.2,5259 4028.6,5259 4028.6,5259 4028.6,5259 4028.6,5191.7 4028.6,5191.7",
		style=dashed];
	layer54_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4455,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer54_moe_split -> layer54_moe_comm_to_expert12	[pos="e,4379.6,5181.8 3175.1,5273 3559.2,5273 4379.6,5273 4379.6,5273 4379.6,5273 4379.6,5191.8 4379.6,5191.8",
		style=dashed];
	layer54_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4808,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer54_moe_split -> layer54_moe_comm_to_expert13	[pos="e,4733.1,5182 3189.7,5288 3654.3,5288 4733.1,5288 4733.1,5288 4733.1,5288 4733.1,5192 4733.1,5192",
		style=dashed];
	layer54_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5163,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer54_moe_split -> layer54_moe_comm_to_expert14	[pos="e,5088.1,5181.9 3205,5303 3747.6,5303 5088.1,5303 5088.1,5303 5088.1,5303 5088.1,5191.9 5088.1,5191.9",
		style=dashed];
	layer54_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5518,5164.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer54_moe_split -> layer54_moe_comm_to_expert15	[pos="e,5443.1,5181.9 3219.9,5318 3838.2,5318 5443.1,5318 5443.1,5318 5443.1,5318 5443.1,5191.9 5443.1,5191.9",
		style=dashed];
	layer54_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L54\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="386,5073.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer54_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="533,4982.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer54_moe_expert0 -> layer54_moe_comm_from_expert0	[pos="e,496.25,5008.9 496.25,5047 496.25,5047 496.25,5018.9 496.25,5018.9"];
	layer54_moe_comm_to_expert0 -> layer54_moe_expert0	[pos="e,432,5099.6 432,5135.3 432,5135.3 432,5109.6 432,5109.6"];
	layer54_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L54\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="732,5073.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer54_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1026,4982.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer54_moe_expert1 -> layer54_moe_comm_from_expert1	[pos="e,935.46,4982 834.25,5046.9 834.25,5019.9 834.25,4982 834.25,4982 834.25,4982 925.46,4982 925.46,4982"];
	layer54_moe_comm_to_expert1 -> layer54_moe_expert1	[pos="e,829.75,5099.5 1054.2,5164 961.11,5164 829.75,5164 829.75,5164 829.75,5164 829.75,5109.5 829.75,5109.5"];
	layer54_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L54\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1078,5073.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer54_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1372,4982.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer54_moe_expert2 -> layer54_moe_comm_from_expert2	[pos="e,1281.3,4982 1232.5,5046.9 1232.5,5019.9 1232.5,4982 1232.5,4982 1232.5,4982 1271.3,4982 1271.3,4982"];
	layer54_moe_comm_to_expert2 -> layer54_moe_expert2	[pos="e,1242.2,5073 1510.3,5164 1407.5,5164 1254,5164 1254,5164 1254,5164 1254,5073 1254,5073 1254,5073 1252.2,5073 1252.2,5073"];
	layer54_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L54\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1424,5073.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer54_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="1644,4982.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer54_moe_expert3 -> layer54_moe_comm_from_expert3	[pos="e,1570.7,4999.4 1570.7,5047 1570.7,5047 1570.7,5009.4 1570.7,5009.4"];
	layer54_moe_comm_to_expert3 -> layer54_moe_expert3	[pos="e,1549.2,5099.3 1870.3,5142.2 1870.3,5132.4 1870.3,5123 1870.3,5123 1870.3,5123 1549.2,5123 1549.2,5123 1549.2,5123 1549.2,5109.3 \
1549.2,5109.3"];
	layer54_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L54\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1770,5073.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer54_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="1880,4982.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer54_moe_expert4 -> layer54_moe_comm_from_expert4	[pos="e,1861.7,5010.8 1861.7,5047 1861.7,5047 1861.7,5020.8 1861.7,5020.8"];
	layer54_moe_comm_to_expert4 -> layer54_moe_expert4	[pos="e,1902.2,5099.5 2190.7,5135.2 2190.7,5122.7 2190.7,5111 2190.7,5111 2190.7,5111 1902.2,5111 1902.2,5111 1902.2,5111 1902.2,5109.5 \
1902.2,5109.5"];
	layer54_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L54\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2116,5073.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer54_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2227,4982.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer54_moe_expert5 -> layer54_moe_comm_from_expert5	[pos="e,2208.2,5010.8 2208.2,5047 2208.2,5047 2208.2,5020.8 2208.2,5020.8"];
	layer54_moe_comm_to_expert5 -> layer54_moe_expert5	[pos="e,2280.1,5073 2332.3,5164 2308.9,5164 2290.3,5164 2290.3,5164 2290.3,5164 2290.3,5073 2290.3,5073 2290.3,5073 2289.2,5073 2289.2,\
5073"];
	layer54_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L54\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2462,5073.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer54_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2573,4982.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer54_moe_expert6 -> layer54_moe_comm_from_expert6	[pos="e,2554.2,5010.8 2554.2,5047 2554.2,5047 2554.2,5020.8 2554.2,5020.8"];
	layer54_moe_comm_to_expert6 -> layer54_moe_expert6	[pos="e,2586.7,5099.6 2586.7,5140.4 2586.7,5140.4 2586.7,5109.6 2586.7,5109.6"];
	layer54_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L54\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2808,5073.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer54_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2845,4982.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer54_moe_expert7 -> layer54_moe_comm_from_expert7	[pos="e,2845,5011.5 2845,5047 2845,5047 2845,5021.5 2845,5021.5"];
	layer54_moe_comm_to_expert7 -> layer54_moe_expert7	[pos="e,2845,5099.6 2845,5135.3 2845,5135.3 2845,5109.6 2845,5109.6"];
	layer54_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L54\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3154,5073.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer54_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3117,4982.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer54_moe_expert8 -> layer54_moe_comm_from_expert8	[pos="e,3117,5011.5 3117,5047 3117,5047 3117,5021.5 3117,5021.5"];
	layer54_moe_comm_to_expert8 -> layer54_moe_expert8	[pos="e,3117,5099.6 3117,5135.3 3117,5135.3 3117,5109.6 3117,5109.6"];
	layer54_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L54\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3500,5073.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer54_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3426,4982.3",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer54_moe_expert9 -> layer54_moe_comm_from_expert9	[pos="e,3426.3,5011.5 3426.3,5047 3426.3,5047 3426.3,5021.5 3426.3,5021.5"];
	layer54_moe_comm_to_expert9 -> layer54_moe_expert9	[pos="e,3426.3,5099.6 3426.3,5135.3 3426.3,5135.3 3426.3,5109.6 3426.3,5109.6"];
	layer54_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L54\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3851,5073.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer54_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3758,4982.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer54_moe_expert10 -> layer54_moe_comm_from_expert10	[pos="e,3767.4,5011.5 3767.4,5047 3767.4,5047 3767.4,5021.5 3767.4,5021.5"];
	layer54_moe_comm_to_expert10 -> layer54_moe_expert10	[pos="e,3767,5099.6 3767,5135.3 3767,5135.3 3767,5109.6 3767,5109.6"];
	layer54_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L54\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4207,5073.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer54_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4105,4982.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer54_moe_expert11 -> layer54_moe_comm_from_expert11	[pos="e,4118.9,5011.1 4118.9,5047 4118.9,5047 4118.9,5021.1 4118.9,5021.1"];
	layer54_moe_comm_to_expert11 -> layer54_moe_expert11	[pos="e,4118,5099.5 4118,5135.5 4118,5135.5 4118,5109.5 4118,5109.5"];
	layer54_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L54\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4563,5073.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer54_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4456,4982.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer54_moe_expert12 -> layer54_moe_comm_from_expert12	[pos="e,4472.4,5011.1 4472.4,5047 4472.4,5047 4472.4,5021.1 4472.4,5021.1"];
	layer54_moe_comm_to_expert12 -> layer54_moe_expert12	[pos="e,4471.5,5099.5 4471.5,5135.5 4471.5,5135.5 4471.5,5109.5 4471.5,5109.5"];
	layer54_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L54\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="4919,5073.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer54_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4810,4982.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer54_moe_expert13 -> layer54_moe_comm_from_expert13	[pos="e,4827.4,5011.1 4827.4,5047 4827.4,5047 4827.4,5021.1 4827.4,5021.1"];
	layer54_moe_comm_to_expert13 -> layer54_moe_expert13	[pos="e,4826,5099.5 4826,5135.5 4826,5135.5 4826,5109.5 4826,5109.5"];
	layer54_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L54\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5275,5073.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer54_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5165,4982.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer54_moe_expert14 -> layer54_moe_comm_from_expert14	[pos="e,5182.9,5010.8 5182.9,5047 5182.9,5047 5182.9,5020.8 5182.9,5020.8"];
	layer54_moe_comm_to_expert14 -> layer54_moe_expert14	[pos="e,5181.5,5099.5 5181.5,5135.5 5181.5,5135.5 5181.5,5109.5 5181.5,5109.5"];
	layer54_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L54\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5631,5073.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer54_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5520,4982.3",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer54_moe_expert15 -> layer54_moe_comm_from_expert15	[pos="e,5538.4,5010.8 5538.4,5047 5538.4,5047 5538.4,5020.8 5538.4,5020.8"];
	layer54_moe_comm_to_expert15 -> layer54_moe_expert15	[pos="e,5537,5099.5 5537,5135.5 5537,5135.5 5537,5109.5 5537,5109.5"];
	layer54_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L54\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2944,4865.3",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer55_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L55\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2944,4751.3",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer54_moe_aggregate -> layer55_moe_mha	[pos="e,2944,4777.6 2944,4813 2944,4813 2944,4787.6 2944,4787.6"];
	layer54_moe_comm_from_expert0 -> layer54_moe_aggregate	[pos="e,2696.9,4828 577.25,4956.8 577.25,4913 577.25,4828 577.25,4828 577.25,4828 2686.9,4828 2686.9,4828"];
	layer54_moe_comm_from_expert1 -> layer54_moe_aggregate	[pos="e,2712.4,4843 1067,4956.4 1067,4916.2 1067,4843 1067,4843 1067,4843 2702.4,4843 2702.4,4843"];
	layer54_moe_comm_from_expert2 -> layer54_moe_aggregate	[pos="e,2726.7,4857 1372,4953.3 1372,4916.2 1372,4857 1372,4857 1372,4857 2716.7,4857 2716.7,4857"];
	layer54_moe_comm_from_expert3 -> layer54_moe_aggregate	[pos="e,2742.2,4872 1694.5,4958.1 1694.5,4925.6 1694.5,4872 1694.5,4872 1694.5,4872 2732.2,4872 2732.2,4872"];
	layer54_moe_comm_from_expert4 -> layer54_moe_aggregate	[pos="e,2757.6,4887 1886,4953.2 1886,4925.2 1886,4887 1886,4887 1886,4887 2747.6,4887 2747.6,4887"];
	layer54_moe_comm_from_expert5 -> layer54_moe_aggregate	[pos="e,2773.2,4902 2306.5,4968.3 2306.5,4945.3 2306.5,4902 2306.5,4902 2306.5,4902 2763.2,4902 2763.2,4902"];
	layer54_moe_comm_from_expert6 -> layer54_moe_aggregate	[pos="e,2718.1,4865.4 2663.7,4982 2693,4982 2718.1,4982 2718.1,4982 2718.1,4982 2718.1,4875.4 2718.1,4875.4"];
	layer54_moe_comm_from_expert7 -> layer54_moe_aggregate	[pos="e,2845,4917.4 2845,4953.1 2845,4953.1 2845,4927.4 2845,4927.4"];
	layer54_moe_comm_from_expert8 -> layer54_moe_aggregate	[pos="e,3116.4,4917.4 3116.4,4953.1 3116.4,4953.1 3116.4,4927.4 3116.4,4927.4"];
	layer54_moe_comm_from_expert9 -> layer54_moe_aggregate	[pos="e,3192.4,4904 3407.5,4953.6 3407.5,4931.2 3407.5,4904 3407.5,4904 3407.5,4904 3202.4,4904 3202.4,4904"];
	layer54_moe_comm_from_expert10 -> layer54_moe_aggregate	[pos="e,3179.1,4891 3739.1,4953.4 3739.1,4926.7 3739.1,4891 3739.1,4891 3739.1,4891 3189.1,4891 3189.1,4891"];
	layer54_moe_comm_from_expert11 -> layer54_moe_aggregate	[pos="e,3165.8,4878 4085.6,4953.8 4085.6,4922.9 4085.6,4878 4085.6,4878 4085.6,4878 3175.8,4878 3175.8,4878"];
	layer54_moe_comm_from_expert12 -> layer54_moe_aggregate	[pos="e,3152.3,4865 4436.6,4953.9 4436.6,4919.2 4436.6,4865 4436.6,4865 4436.6,4865 3162.3,4865 3162.3,4865"];
	layer54_moe_comm_from_expert13 -> layer54_moe_aggregate	[pos="e,3139,4852 4790.1,4953.7 4790.1,4915.4 4790.1,4852 4790.1,4852 4790.1,4852 3149,4852 3149,4852"];
	layer54_moe_comm_from_expert14 -> layer54_moe_aggregate	[pos="e,3125.5,4839 5145.1,4953.7 5145.1,4911.8 5145.1,4839 5145.1,4839 5145.1,4839 3135.5,4839 3135.5,4839"];
	layer54_moe_comm_from_expert15 -> layer54_moe_aggregate	[pos="e,3112.2,4826 5500.1,4953.7 5500.1,4908.5 5500.1,4826 5500.1,4826 5500.1,4826 3122.2,4826 3122.2,4826"];
	layer55_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L55\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="2944,4637.3",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer55_moe_mha -> layer55_moe_gate	[pos="e,2944,4689.4 2944,4725.2 2944,4725.2 2944,4699.4 2944,4699.4"];
	layer55_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L55\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="2944,4497.3",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer55_moe_gate -> layer55_moe_split	[pos="e,2944,4549.5 2944,4585.2 2944,4585.2 2944,4559.5 2944,4559.5"];
	layer55_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="863,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer55_moe_split -> layer55_moe_comm_to_expert0	[pos="e,944.5,4393.2 2778.2,4534 2298.8,4534 944.5,4534 944.5,4534 944.5,4534 944.5,4403.2 944.5,4403.2",
		style=dashed];
	layer55_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1108,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer55_moe_split -> layer55_moe_comm_to_expert1	[pos="e,1157.5,4404.8 2763.3,4519 2309.4,4519 1157.5,4519 1157.5,4519 1157.5,4519 1157.5,4414.8 1157.5,4414.8",
		style=dashed];
	layer55_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1564,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer55_moe_split -> layer55_moe_comm_to_expert2	[pos="e,1604,4406.6 2748.4,4504 2376.5,4504 1604,4504 1604,4504 1604,4504 1604,4416.6 1604,4416.6",
		style=dashed];
	layer55_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="1892,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer55_moe_split -> layer55_moe_comm_to_expert3	[pos="e,1976.5,4390.8 2733.5,4489 2448.9,4489 1976.5,4489 1976.5,4489 1976.5,4489 1976.5,4400.8 1976.5,4400.8",
		style=dashed];
	layer55_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2155,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer55_moe_split -> layer55_moe_comm_to_expert4	[pos="e,2191,4407 2719.6,4475 2497.7,4475 2191,4475 2191,4475 2191,4475 2191,4417 2191,4417",
		style=dashed];
	layer55_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2386,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer55_moe_split -> layer55_moe_comm_to_expert5	[pos="e,2397,4409.6 2704.5,4460 2557.4,4460 2397,4460 2397,4460 2397,4460 2397,4419.6 2397,4419.6",
		style=dashed];
	layer55_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2601,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer55_moe_split -> layer55_moe_comm_to_expert6	[pos="e,2691.8,4380 2704.5,4497.2 2704.5,4493.7 2704.5,4380 2704.5,4380 2704.5,4380 2701.8,4380 2701.8,4380",
		style=dashed];
	layer55_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2808,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer55_moe_split -> layer55_moe_comm_to_expert7	[pos="e,2808,4409.6 2808,4445 2808,4445 2808,4419.6 2808,4419.6",
		style=dashed];
	layer55_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3080,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer55_moe_split -> layer55_moe_comm_to_expert8	[pos="e,3080,4409.6 3080,4445 3080,4445 3080,4419.6 3080,4419.6",
		style=dashed];
	layer55_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3389,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer55_moe_split -> layer55_moe_comm_to_expert9	[pos="e,3298.3,4380 3184.3,4497.2 3184.3,4493.7 3184.3,4380 3184.3,4380 3184.3,4380 3288.3,4380 3288.3,4380",
		style=dashed];
	layer55_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3721,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer55_moe_split -> layer55_moe_comm_to_expert10	[pos="e,3645.1,4397.6 3108.8,4460 3316.1,4460 3645.1,4460 3645.1,4460 3645.1,4460 3645.1,4407.6 3645.1,4407.6",
		style=dashed];
	layer55_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4067,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer55_moe_split -> layer55_moe_comm_to_expert11	[pos="e,3991.6,4397.7 3123.8,4475 3423.2,4475 3991.6,4475 3991.6,4475 3991.6,4475 3991.6,4407.7 3991.6,4407.7",
		style=dashed];
	layer55_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4418,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer55_moe_split -> layer55_moe_comm_to_expert12	[pos="e,4342.6,4397.8 3137.7,4489 3521.7,4489 4342.6,4489 4342.6,4489 4342.6,4489 4342.6,4407.8 4342.6,4407.8",
		style=dashed];
	layer55_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4771,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer55_moe_split -> layer55_moe_comm_to_expert13	[pos="e,4696.1,4398.1 3152.7,4504 3617.3,4504 4696.1,4504 4696.1,4504 4696.1,4504 4696.1,4408.1 4696.1,4408.1",
		style=dashed];
	layer55_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5126,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer55_moe_split -> layer55_moe_comm_to_expert14	[pos="e,5051.1,4397.9 3168,4519 3710.6,4519 5051.1,4519 5051.1,4519 5051.1,4519 5051.1,4407.9 5051.1,4407.9",
		style=dashed];
	layer55_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5481,4380.3",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer55_moe_split -> layer55_moe_comm_to_expert15	[pos="e,5406.1,4398 3182.9,4534 3801.2,4534 5406.1,4534 5406.1,4534 5406.1,4534 5406.1,4408 5406.1,4408",
		style=dashed];
	layer55_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L55\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="349,4289.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer55_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="863,4198.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer55_moe_expert0 -> layer55_moe_comm_from_expert0	[pos="e,772.28,4198 503.5,4262.9 503.5,4235.9 503.5,4198 503.5,4198 503.5,4198 762.28,4198 762.28,4198"];
	layer55_moe_comm_to_expert0 -> layer55_moe_expert0	[pos="e,477.75,4315.6 772.19,4380 658.29,4380 477.75,4380 477.75,4380 477.75,4380 477.75,4325.6 477.75,4325.6"];
	layer55_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L55\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="695,4289.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer55_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1108,4198.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer55_moe_expert1 -> layer55_moe_comm_from_expert1	[pos="e,1108,4227.6 815.75,4263.3 815.75,4249.8 815.75,4236 815.75,4236 815.75,4236 1108,4236 1108,4236 1108,4236 1108,4235.2 1108,4235.2"];
	layer55_moe_comm_to_expert1 -> layer55_moe_expert1	[pos="e,815.75,4315.6 1108,4351.2 1108,4337.4 1108,4324 1108,4324 1108,4324 815.75,4324 815.75,4324 815.75,4324 815.75,4323.2 815.75,4323.2"];
	layer55_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L55\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1041,4289.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer55_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1564,4198.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer55_moe_expert2 -> layer55_moe_comm_from_expert2	[pos="e,1473.3,4198 1205.2,4280 1212.6,4280 1217,4280 1217,4280 1217,4280 1217,4198 1217,4198 1217,4198 1463.3,4198 1463.3,4198"];
	layer55_moe_comm_to_expert2 -> layer55_moe_expert2	[pos="e,1205.3,4298 1473.1,4380 1368.5,4380 1211,4380 1211,4380 1211,4380 1211,4298 1211,4298 1211,4298 1210.4,4298 1210.4,4298"];
	layer55_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L55\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1387,4289.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer55_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="1892,4198.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer55_moe_expert3 -> layer55_moe_comm_from_expert3	[pos="e,1833.3,4220.6 1512.2,4263.3 1512.2,4253.6 1512.2,4245 1512.2,4245 1512.2,4245 1833.3,4245 1833.3,4245 1833.3,4245 1833.3,4230.6 \
1833.3,4230.6"];
	layer55_moe_comm_to_expert3 -> layer55_moe_expert3	[pos="e,1512.2,4315.4 1833.3,4358 1833.3,4349.6 1833.3,4342 1833.3,4342 1833.3,4342 1512.2,4342 1512.2,4342 1512.2,4342 1512.2,4325.4 \
1512.2,4325.4"];
	layer55_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L55\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1733,4289.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer55_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2155,4198.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer55_moe_expert4 -> layer55_moe_comm_from_expert4	[pos="e,2153.7,4227.5 1865.2,4263.3 1865.2,4258 1865.2,4254 1865.2,4254 1865.2,4254 2153.7,4254 2153.7,4254 2153.7,4254 2153.7,4237.5 \
2153.7,4237.5"];
	layer55_moe_comm_to_expert4 -> layer55_moe_expert4	[pos="e,1865.2,4315.5 2153.7,4351.2 2153.7,4341.4 2153.7,4333 2153.7,4333 2153.7,4333 1865.2,4333 1865.2,4333 1865.2,4333 1865.2,4325.5 \
1865.2,4325.5"];
	layer55_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L55\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2079,4289.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer55_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2386,4198.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer55_moe_expert5 -> layer55_moe_comm_from_expert5	[pos="e,2295.2,4198 2243.2,4280 2250.1,4280 2254.2,4280 2254.2,4280 2254.2,4280 2254.2,4198 2254.2,4198 2254.2,4198 2285.2,4198 2285.2,\
4198"];
	layer55_moe_comm_to_expert5 -> layer55_moe_expert5	[pos="e,2243.3,4298 2295.2,4380 2270.2,4380 2249.8,4380 2249.8,4380 2249.8,4380 2249.8,4298 2249.8,4298 2249.8,4298 2249.2,4298 2249.2,\
4298"];
	layer55_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L55\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2425,4289.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer55_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2601,4198.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer55_moe_expert6 -> layer55_moe_comm_from_expert6	[pos="e,2549.7,4222.4 2549.7,4263 2549.7,4263 2549.7,4232.4 2549.7,4232.4"];
	layer55_moe_comm_to_expert6 -> layer55_moe_expert6	[pos="e,2549.7,4315.7 2549.7,4356.4 2549.7,4356.4 2549.7,4325.7 2549.7,4325.7"];
	layer55_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L55\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2771,4289.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer55_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2808,4198.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer55_moe_expert7 -> layer55_moe_comm_from_expert7	[pos="e,2808,4227.5 2808,4263 2808,4263 2808,4237.5 2808,4237.5"];
	layer55_moe_comm_to_expert7 -> layer55_moe_expert7	[pos="e,2808,4315.7 2808,4351.3 2808,4351.3 2808,4325.7 2808,4325.7"];
	layer55_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L55\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3117,4289.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer55_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3080,4198.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer55_moe_expert8 -> layer55_moe_comm_from_expert8	[pos="e,3080,4227.5 3080,4263 3080,4263 3080,4237.5 3080,4237.5"];
	layer55_moe_comm_to_expert8 -> layer55_moe_expert8	[pos="e,3080,4315.7 3080,4351.3 3080,4351.3 3080,4325.7 3080,4325.7"];
	layer55_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L55\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3463,4289.3",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer55_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3389,4198.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer55_moe_expert9 -> layer55_moe_comm_from_expert9	[pos="e,3389.3,4227.5 3389.3,4263 3389.3,4263 3389.3,4237.5 3389.3,4237.5"];
	layer55_moe_comm_to_expert9 -> layer55_moe_expert9	[pos="e,3389.3,4315.7 3389.3,4351.3 3389.3,4351.3 3389.3,4325.7 3389.3,4325.7"];
	layer55_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L55\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3814,4289.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer55_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3721,4198.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer55_moe_expert10 -> layer55_moe_comm_from_expert10	[pos="e,3730.4,4227.5 3730.4,4263 3730.4,4263 3730.4,4237.5 3730.4,4237.5"];
	layer55_moe_comm_to_expert10 -> layer55_moe_expert10	[pos="e,3730,4315.7 3730,4351.3 3730,4351.3 3730,4325.7 3730,4325.7"];
	layer55_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L55\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4170,4289.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer55_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4068,4198.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer55_moe_expert11 -> layer55_moe_comm_from_expert11	[pos="e,4081.9,4227.2 4081.9,4263 4081.9,4263 4081.9,4237.2 4081.9,4237.2"];
	layer55_moe_comm_to_expert11 -> layer55_moe_expert11	[pos="e,4081,4315.5 4081,4351.6 4081,4351.6 4081,4325.5 4081,4325.5"];
	layer55_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L55\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4526,4289.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer55_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4419,4198.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer55_moe_expert12 -> layer55_moe_comm_from_expert12	[pos="e,4435.4,4227.2 4435.4,4263 4435.4,4263 4435.4,4237.2 4435.4,4237.2"];
	layer55_moe_comm_to_expert12 -> layer55_moe_expert12	[pos="e,4434.5,4315.5 4434.5,4351.6 4434.5,4351.6 4434.5,4325.5 4434.5,4325.5"];
	layer55_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L55\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="4882,4289.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer55_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4773,4198.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer55_moe_expert13 -> layer55_moe_comm_from_expert13	[pos="e,4790.4,4227.2 4790.4,4263 4790.4,4263 4790.4,4237.2 4790.4,4237.2"];
	layer55_moe_comm_to_expert13 -> layer55_moe_expert13	[pos="e,4789,4315.5 4789,4351.6 4789,4351.6 4789,4325.5 4789,4325.5"];
	layer55_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L55\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5238,4289.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer55_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5128,4198.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer55_moe_expert14 -> layer55_moe_comm_from_expert14	[pos="e,5145.9,4226.8 5145.9,4263 5145.9,4263 5145.9,4236.8 5145.9,4236.8"];
	layer55_moe_comm_to_expert14 -> layer55_moe_expert14	[pos="e,5144.5,4315.5 5144.5,4351.6 5144.5,4351.6 5144.5,4325.5 5144.5,4325.5"];
	layer55_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L55\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5594,4289.3",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer55_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5483,4198.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer55_moe_expert15 -> layer55_moe_comm_from_expert15	[pos="e,5501.4,4226.8 5501.4,4263 5501.4,4263 5501.4,4236.8 5501.4,4236.8"];
	layer55_moe_comm_to_expert15 -> layer55_moe_expert15	[pos="e,5500,4315.5 5500,4351.6 5500,4351.6 5500,4325.5 5500,4325.5"];
	layer55_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L55\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2907,4081.4",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer56_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L56\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2907,3967.4",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer55_moe_aggregate -> layer56_moe_mha	[pos="e,2907,3993.6 2907,4029 2907,4029 2907,4003.6 2907,4003.6"];
	layer55_moe_comm_from_expert0 -> layer55_moe_aggregate	[pos="e,2659.7,4044 935.01,4180.7 935.01,4140.1 935.01,4044 935.01,4044 935.01,4044 2649.7,4044 2649.7,4044"];
	layer55_moe_comm_from_expert1 -> layer55_moe_aggregate	[pos="e,2675.3,4059 1192.3,4187.4 1192.3,4154.6 1192.3,4059 1192.3,4059 1192.3,4059 2665.3,4059 2665.3,4059"];
	layer55_moe_comm_from_expert2 -> layer55_moe_aggregate	[pos="e,2689.6,4073 1636,4180.7 1636,4146.1 1636,4073 1636,4073 1636,4073 2679.6,4073 2679.6,4073"];
	layer55_moe_comm_from_expert3 -> layer55_moe_aggregate	[pos="e,2705.3,4088 1964,4180.6 1964,4149.4 1964,4088 1964,4088 1964,4088 2695.3,4088 2695.3,4088"];
	layer55_moe_comm_from_expert4 -> layer55_moe_aggregate	[pos="e,2720.6,4103 2234.8,4184.3 2234.8,4157.8 2234.8,4103 2234.8,4103 2234.8,4103 2710.6,4103 2710.6,4103"];
	layer55_moe_comm_from_expert5 -> layer55_moe_aggregate	[pos="e,2736,4118 2456.5,4180.1 2456.5,4156.4 2456.5,4118 2456.5,4118 2456.5,4118 2726,4118 2726,4118"];
	layer55_moe_comm_from_expert6 -> layer55_moe_aggregate	[pos="e,2668.1,4081.4 2668.1,4178.8 2668.1,4178.8 2668.1,4091.4 2668.1,4091.4"];
	layer55_moe_comm_from_expert7 -> layer55_moe_aggregate	[pos="e,2808,4133.4 2808,4169.1 2808,4169.1 2808,4143.4 2808,4143.4"];
	layer55_moe_comm_from_expert8 -> layer55_moe_aggregate	[pos="e,3079.4,4133.4 3079.4,4169.1 3079.4,4169.1 3079.4,4143.4 3079.4,4143.4"];
	layer55_moe_comm_from_expert9 -> layer55_moe_aggregate	[pos="e,3155.4,4120 3370.5,4169.6 3370.5,4147.3 3370.5,4120 3370.5,4120 3370.5,4120 3165.4,4120 3165.4,4120"];
	layer55_moe_comm_from_expert10 -> layer55_moe_aggregate	[pos="e,3142.1,4107 3702.1,4169.5 3702.1,4142.7 3702.1,4107 3702.1,4107 3702.1,4107 3152.1,4107 3152.1,4107"];
	layer55_moe_comm_from_expert11 -> layer55_moe_aggregate	[pos="e,3128.8,4094 4048.6,4169.8 4048.6,4138.9 4048.6,4094 4048.6,4094 4048.6,4094 3138.8,4094 3138.8,4094"];
	layer55_moe_comm_from_expert12 -> layer55_moe_aggregate	[pos="e,3115.3,4081 4399.6,4169.9 4399.6,4135.2 4399.6,4081 4399.6,4081 4399.6,4081 3125.3,4081 3125.3,4081"];
	layer55_moe_comm_from_expert13 -> layer55_moe_aggregate	[pos="e,3102,4068 4753.1,4169.8 4753.1,4131.4 4753.1,4068 4753.1,4068 4753.1,4068 3112,4068 3112,4068"];
	layer55_moe_comm_from_expert14 -> layer55_moe_aggregate	[pos="e,3088.5,4055 5108.1,4169.7 5108.1,4127.9 5108.1,4055 5108.1,4055 5108.1,4055 3098.5,4055 3098.5,4055"];
	layer55_moe_comm_from_expert15 -> layer55_moe_aggregate	[pos="e,3075.2,4042 5463.1,4169.7 5463.1,4124.5 5463.1,4042 5463.1,4042 5463.1,4042 3085.2,4042 3085.2,4042"];
	layer56_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L56\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="2907,3853.4",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer56_moe_mha -> layer56_moe_gate	[pos="e,2907,3905.5 2907,3941.2 2907,3941.2 2907,3915.5 2907,3915.5"];
	layer56_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L56\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="2907,3713.4",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer56_moe_gate -> layer56_moe_split	[pos="e,2907,3765.5 2907,3801.2 2907,3801.2 2907,3775.5 2907,3775.5"];
	layer56_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="826,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer56_moe_split -> layer56_moe_comm_to_expert0	[pos="e,844.5,3624.9 2741.3,3750 2251.4,3750 844.5,3750 844.5,3750 844.5,3750 844.5,3634.9 844.5,3634.9",
		style=dashed];
	layer56_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="1071,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer56_moe_split -> layer56_moe_comm_to_expert1	[pos="e,1089.5,3624.8 2726.5,3735 2267.1,3735 1089.5,3735 1089.5,3735 1089.5,3735 1089.5,3634.8 1089.5,3634.8",
		style=dashed];
	layer56_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1527,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer56_moe_split -> layer56_moe_comm_to_expert2	[pos="e,1545.5,3625 2711.6,3720 2335,3720 1545.5,3720 1545.5,3720 1545.5,3720 1545.5,3635 1545.5,3635",
		style=dashed];
	layer56_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="1855,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer56_moe_split -> layer56_moe_comm_to_expert3	[pos="e,1873.5,3624.9 2696.3,3705 2394.1,3705 1873.5,3705 1873.5,3705 1873.5,3705 1873.5,3634.9 1873.5,3634.9",
		style=dashed];
	layer56_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2118,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer56_moe_split -> layer56_moe_comm_to_expert4	[pos="e,2136.5,3624.8 2682.6,3691 2455.1,3691 2136.5,3691 2136.5,3691 2136.5,3691 2136.5,3634.8 2136.5,3634.8",
		style=dashed];
	layer56_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2349,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer56_moe_split -> layer56_moe_comm_to_expert5	[pos="e,2367.5,3625.1 2667.2,3676 2523.1,3676 2367.5,3676 2367.5,3676 2367.5,3676 2367.5,3635.1 2367.5,3635.1",
		style=dashed];
	layer56_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2564,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer56_moe_split -> layer56_moe_comm_to_expert6	[pos="e,2654.8,3596 2667.5,3713.3 2667.5,3709.7 2667.5,3596 2667.5,3596 2667.5,3596 2664.8,3596 2664.8,3596",
		style=dashed];
	layer56_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2771,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer56_moe_split -> layer56_moe_comm_to_expert7	[pos="e,2771,3625.6 2771,3661 2771,3661 2771,3635.6 2771,3635.6",
		style=dashed];
	layer56_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3043,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer56_moe_split -> layer56_moe_comm_to_expert8	[pos="e,3043,3625.6 3043,3661 3043,3661 3043,3635.6 3043,3635.6",
		style=dashed];
	layer56_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3352,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer56_moe_split -> layer56_moe_comm_to_expert9	[pos="e,3261.3,3596 3147.3,3713.3 3147.3,3709.7 3147.3,3596 3147.3,3596 3147.3,3596 3251.3,3596 3251.3,3596",
		style=dashed];
	layer56_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3684,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer56_moe_split -> layer56_moe_comm_to_expert10	[pos="e,3608.1,3613.7 3071.8,3676 3279.1,3676 3608.1,3676 3608.1,3676 3608.1,3676 3608.1,3623.7 3608.1,3623.7",
		style=dashed];
	layer56_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="4030,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer56_moe_split -> layer56_moe_comm_to_expert11	[pos="e,3954.6,3613.7 3086.8,3691 3386.2,3691 3954.6,3691 3954.6,3691 3954.6,3691 3954.6,3623.7 3954.6,3623.7",
		style=dashed];
	layer56_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4381,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer56_moe_split -> layer56_moe_comm_to_expert12	[pos="e,4305.6,3613.8 3100.7,3705 3484.7,3705 4305.6,3705 4305.6,3705 4305.6,3705 4305.6,3623.8 4305.6,3623.8",
		style=dashed];
	layer56_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4734,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer56_moe_split -> layer56_moe_comm_to_expert13	[pos="e,4659.1,3614.1 3115.7,3720 3580.3,3720 4659.1,3720 4659.1,3720 4659.1,3720 4659.1,3624.1 4659.1,3624.1",
		style=dashed];
	layer56_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5089,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer56_moe_split -> layer56_moe_comm_to_expert14	[pos="e,5014.1,3613.9 3131,3735 3673.6,3735 5014.1,3735 5014.1,3735 5014.1,3735 5014.1,3623.9 5014.1,3623.9",
		style=dashed];
	layer56_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5444,3596.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer56_moe_split -> layer56_moe_comm_to_expert15	[pos="e,5369.1,3614 3145.9,3750 3764.2,3750 5369.1,3750 5369.1,3750 5369.1,3750 5369.1,3624 5369.1,3624",
		style=dashed];
	layer56_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L56\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="312,3505.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer56_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="358,3414.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer56_moe_expert0 -> layer56_moe_comm_from_expert0	[pos="e,358,3443.5 358,3479.1 358,3479.1 358,3453.5 358,3453.5"];
	layer56_moe_comm_to_expert0 -> layer56_moe_expert0	[pos="e,330.5,3531.6 735.41,3596 592.42,3596 330.5,3596 330.5,3596 330.5,3596 330.5,3541.6 330.5,3541.6"];
	layer56_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L56\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="658,3505.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer56_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1071,3414.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer56_moe_expert1 -> layer56_moe_comm_from_expert1	[pos="e,980.23,3414 812.5,3479 812.5,3452 812.5,3414 812.5,3414 812.5,3414 970.23,3414 970.23,3414"];
	layer56_moe_comm_to_expert1 -> layer56_moe_expert1	[pos="e,778.75,3531.6 1071,3567.2 1071,3553.4 1071,3540 1071,3540 1071,3540 778.75,3540 778.75,3540 778.75,3540 778.75,3539.2 778.75,3539.2"];
	layer56_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L56\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="1004,3505.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer56_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1527,3414.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer56_moe_expert2 -> layer56_moe_comm_from_expert2	[pos="e,1436,3414 1168.1,3496 1176.1,3496 1180.8,3496 1180.8,3496 1180.8,3496 1180.8,3414 1180.8,3414 1180.8,3414 1426,3414 1426,3414"];
	layer56_moe_comm_to_expert2 -> layer56_moe_expert2	[pos="e,1168.3,3514 1436.1,3596 1332,3596 1175.7,3596 1175.7,3596 1175.7,3596 1175.7,3514 1175.7,3514 1175.7,3514 1174.9,3514 1174.9,3514"];
	layer56_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L56\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1350,3505.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer56_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="1855,3414.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer56_moe_expert3 -> layer56_moe_comm_from_expert3	[pos="e,1796.3,3436.6 1475.2,3479.3 1475.2,3467 1475.2,3455 1475.2,3455 1475.2,3455 1796.3,3455 1796.3,3455 1796.3,3455 1796.3,3446.6 \
1796.3,3446.6"];
	layer56_moe_comm_to_expert3 -> layer56_moe_expert3	[pos="e,1475.2,3531.7 1796.3,3574.1 1796.3,3565.6 1796.3,3558 1796.3,3558 1796.3,3558 1475.2,3558 1475.2,3558 1475.2,3558 1475.2,3541.7 \
1475.2,3541.7"];
	layer56_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L56\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1696,3505.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer56_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2118,3414.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer56_moe_expert4 -> layer56_moe_comm_from_expert4	[pos="e,2116.7,3443.5 1828.2,3479.1 1828.2,3472.4 1828.2,3467 1828.2,3467 1828.2,3467 2116.7,3467 2116.7,3467 2116.7,3467 2116.7,3453.5 \
2116.7,3453.5"];
	layer56_moe_comm_to_expert4 -> layer56_moe_expert4	[pos="e,1828.2,3531.8 2116.7,3567.2 2116.7,3557.4 2116.7,3549 2116.7,3549 2116.7,3549 1828.2,3549 1828.2,3549 1828.2,3549 1828.2,3541.8 \
1828.2,3541.8"];
	layer56_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L56\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2042,3505.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer56_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2349,3414.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer56_moe_expert5 -> layer56_moe_comm_from_expert5	[pos="e,2258.2,3414 2206.1,3496 2214.1,3496 2218.8,3496 2218.8,3496 2218.8,3496 2218.8,3414 2218.8,3414 2218.8,3414 2248.2,3414 2248.2,\
3414"];
	layer56_moe_comm_to_expert5 -> layer56_moe_expert5	[pos="e,2206.3,3514 2258.4,3596 2233.7,3596 2213.7,3596 2213.7,3596 2213.7,3596 2213.7,3514 2213.7,3514 2213.7,3514 2212.9,3514 2212.9,\
3514"];
	layer56_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L56\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2388,3505.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer56_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2564,3414.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer56_moe_expert6 -> layer56_moe_comm_from_expert6	[pos="e,2512.7,3438.5 2512.7,3479.1 2512.7,3479.1 2512.7,3448.5 2512.7,3448.5"];
	layer56_moe_comm_to_expert6 -> layer56_moe_expert6	[pos="e,2512.7,3531.7 2512.7,3572.5 2512.7,3572.5 2512.7,3541.7 2512.7,3541.7"];
	layer56_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L56\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2734,3505.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer56_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2771,3414.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer56_moe_expert7 -> layer56_moe_comm_from_expert7	[pos="e,2771,3443.5 2771,3479.1 2771,3479.1 2771,3453.5 2771,3453.5"];
	layer56_moe_comm_to_expert7 -> layer56_moe_expert7	[pos="e,2771,3531.7 2771,3567.3 2771,3567.3 2771,3541.7 2771,3541.7"];
	layer56_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L56\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3080,3505.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer56_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3043,3414.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer56_moe_expert8 -> layer56_moe_comm_from_expert8	[pos="e,3043,3443.5 3043,3479.1 3043,3479.1 3043,3453.5 3043,3453.5"];
	layer56_moe_comm_to_expert8 -> layer56_moe_expert8	[pos="e,3043,3531.7 3043,3567.3 3043,3567.3 3043,3541.7 3043,3541.7"];
	layer56_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L56\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3426,3505.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer56_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3352,3414.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer56_moe_expert9 -> layer56_moe_comm_from_expert9	[pos="e,3352.3,3443.5 3352.3,3479.1 3352.3,3479.1 3352.3,3453.5 3352.3,3453.5"];
	layer56_moe_comm_to_expert9 -> layer56_moe_expert9	[pos="e,3352.3,3531.7 3352.3,3567.3 3352.3,3567.3 3352.3,3541.7 3352.3,3541.7"];
	layer56_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L56\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3777,3505.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer56_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3684,3414.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer56_moe_expert10 -> layer56_moe_comm_from_expert10	[pos="e,3693.4,3443.5 3693.4,3479.1 3693.4,3479.1 3693.4,3453.5 3693.4,3453.5"];
	layer56_moe_comm_to_expert10 -> layer56_moe_expert10	[pos="e,3693,3531.7 3693,3567.3 3693,3567.3 3693,3541.7 3693,3541.7"];
	layer56_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L56\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4133,3505.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer56_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="4031,3414.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer56_moe_expert11 -> layer56_moe_comm_from_expert11	[pos="e,4044.9,3443.2 4044.9,3479.1 4044.9,3479.1 4044.9,3453.2 4044.9,3453.2"];
	layer56_moe_comm_to_expert11 -> layer56_moe_expert11	[pos="e,4044,3531.5 4044,3567.6 4044,3567.6 4044,3541.5 4044,3541.5"];
	layer56_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L56\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4489,3505.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer56_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4382,3414.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer56_moe_expert12 -> layer56_moe_comm_from_expert12	[pos="e,4398.4,3443.2 4398.4,3479.1 4398.4,3479.1 4398.4,3453.2 4398.4,3453.2"];
	layer56_moe_comm_to_expert12 -> layer56_moe_expert12	[pos="e,4397.5,3531.5 4397.5,3567.6 4397.5,3567.6 4397.5,3541.5 4397.5,3541.5"];
	layer56_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L56\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="4845,3505.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer56_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4736,3414.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer56_moe_expert13 -> layer56_moe_comm_from_expert13	[pos="e,4753.4,3443.2 4753.4,3479.1 4753.4,3479.1 4753.4,3453.2 4753.4,3453.2"];
	layer56_moe_comm_to_expert13 -> layer56_moe_expert13	[pos="e,4752,3531.5 4752,3567.6 4752,3567.6 4752,3541.5 4752,3541.5"];
	layer56_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L56\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5201,3505.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer56_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5091,3414.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer56_moe_expert14 -> layer56_moe_comm_from_expert14	[pos="e,5108.9,3442.9 5108.9,3479.1 5108.9,3479.1 5108.9,3452.9 5108.9,3452.9"];
	layer56_moe_comm_to_expert14 -> layer56_moe_expert14	[pos="e,5107.5,3531.5 5107.5,3567.6 5107.5,3567.6 5107.5,3541.5 5107.5,3541.5"];
	layer56_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L56\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5557,3505.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer56_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5446,3414.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer56_moe_expert15 -> layer56_moe_comm_from_expert15	[pos="e,5464.4,3442.9 5464.4,3479.1 5464.4,3479.1 5464.4,3452.9 5464.4,3452.9"];
	layer56_moe_comm_to_expert15 -> layer56_moe_expert15	[pos="e,5463,3531.5 5463,3567.6 5463,3567.6 5463,3541.5 5463,3541.5"];
	layer56_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L56\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2870,3297.4",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer57_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L57\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2870,3183.4",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer56_moe_aggregate -> layer57_moe_mha	[pos="e,2870,3209.6 2870,3245.1 2870,3245.1 2870,3219.6 2870,3219.6"];
	layer56_moe_comm_from_expert0 -> layer56_moe_aggregate	[pos="e,2622.9,3260 390,3387.1 390,3342.8 390,3260 390,3260 390,3260 2612.9,3260 2612.9,3260"];
	layer56_moe_comm_from_expert1 -> layer56_moe_aggregate	[pos="e,2638.3,3275 1155.3,3403.5 1155.3,3370.6 1155.3,3275 1155.3,3275 1155.3,3275 2628.3,3275 2628.3,3275"];
	layer56_moe_comm_from_expert2 -> layer56_moe_aggregate	[pos="e,2652.7,3289 1500.8,3386.6 1500.8,3349.6 1500.8,3289 1500.8,3289 1500.8,3289 2642.7,3289 2642.7,3289"];
	layer56_moe_comm_from_expert3 -> layer56_moe_aggregate	[pos="e,2668.1,3304 1902.5,3389.6 1902.5,3357.1 1902.5,3304 1902.5,3304 1902.5,3304 2658.1,3304 2658.1,3304"];
	layer56_moe_comm_from_expert4 -> layer56_moe_aggregate	[pos="e,2683.8,3319 2146.8,3386.8 2146.8,3358.6 2146.8,3319 2146.8,3319 2146.8,3319 2673.8,3319 2673.8,3319"];
	layer56_moe_comm_from_expert5 -> layer56_moe_aggregate	[pos="e,2699,3334 2405.5,3391.6 2405.5,3367.8 2405.5,3334 2405.5,3334 2405.5,3334 2689,3334 2689,3334"];
	layer56_moe_comm_from_expert6 -> layer56_moe_aggregate	[pos="e,2631.1,3297.4 2631.1,3394.8 2631.1,3394.8 2631.1,3307.4 2631.1,3307.4"];
	layer56_moe_comm_from_expert7 -> layer56_moe_aggregate	[pos="e,2771,3349.5 2771,3385.2 2771,3385.2 2771,3359.5 2771,3359.5"];
	layer56_moe_comm_from_expert8 -> layer56_moe_aggregate	[pos="e,3042.4,3349.5 3042.4,3385.2 3042.4,3385.2 3042.4,3359.5 3042.4,3359.5"];
	layer56_moe_comm_from_expert9 -> layer56_moe_aggregate	[pos="e,3118.4,3336 3333.5,3385.6 3333.5,3363.3 3333.5,3336 3333.5,3336 3333.5,3336 3128.4,3336 3128.4,3336"];
	layer56_moe_comm_from_expert10 -> layer56_moe_aggregate	[pos="e,3105.1,3323 3665.1,3386 3665.1,3359.1 3665.1,3323 3665.1,3323 3665.1,3323 3115.1,3323 3115.1,3323"];
	layer56_moe_comm_from_expert11 -> layer56_moe_aggregate	[pos="e,3091.5,3310 4011.6,3385.9 4011.6,3355 4011.6,3310 4011.6,3310 4011.6,3310 3101.5,3310 3101.5,3310"];
	layer56_moe_comm_from_expert12 -> layer56_moe_aggregate	[pos="e,3078.3,3297 4362.6,3386 4362.6,3351.2 4362.6,3297 4362.6,3297 4362.6,3297 3088.3,3297 3088.3,3297"];
	layer56_moe_comm_from_expert13 -> layer56_moe_aggregate	[pos="e,3065,3284 4716.1,3385.8 4716.1,3347.4 4716.1,3284 4716.1,3284 4716.1,3284 3075,3284 3075,3284"];
	layer56_moe_comm_from_expert14 -> layer56_moe_aggregate	[pos="e,3051.5,3271 5071.1,3385.7 5071.1,3343.9 5071.1,3271 5071.1,3271 5071.1,3271 3061.5,3271 3061.5,3271"];
	layer56_moe_comm_from_expert15 -> layer56_moe_aggregate	[pos="e,3038.2,3258 5426.1,3385.7 5426.1,3340.6 5426.1,3258 5426.1,3258 5426.1,3258 3048.2,3258 3048.2,3258"];
	layer57_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L57\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="2870,3069.4",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer57_moe_mha -> layer57_moe_gate	[pos="e,2870,3121.5 2870,3157.2 2870,3157.2 2870,3131.5 2870,3131.5"];
	layer57_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L57\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="2870,2929.4",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer57_moe_gate -> layer57_moe_split	[pos="e,2870,2981.6 2870,3017.3 2870,3017.3 2870,2991.6 2870,2991.6"];
	layer57_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="422,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer57_moe_split -> layer57_moe_comm_to_expert0	[pos="e,503.25,2825.2 2704.5,2966 2166.8,2966 503.25,2966 503.25,2966 503.25,2966 503.25,2835.2 503.25,2835.2",
		style=dashed];
	layer57_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="915,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer57_moe_split -> layer57_moe_comm_to_expert1	[pos="e,993,2827.2 2689.2,2951 2218.7,2951 993,2951 993,2951 993,2951 993,2837.2 993,2837.2",
		style=dashed];
	layer57_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1261,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer57_moe_split -> layer57_moe_comm_to_expert2	[pos="e,1268.8,2841.4 2674.5,2936 2247.3,2936 1268.8,2936 1268.8,2936 1268.8,2936 1268.8,2851.4 1268.8,2851.4",
		style=dashed];
	layer57_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="1533,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer57_moe_split -> layer57_moe_comm_to_expert3	[pos="e,1559.2,2840.4 2659.4,2921 2288.9,2921 1559.2,2921 1559.2,2921 1559.2,2921 1559.2,2850.4 1559.2,2850.4",
		style=dashed];
	layer57_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="1769,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer57_moe_split -> layer57_moe_comm_to_expert4	[pos="e,1812,2838.3 2645.3,2907 2334.7,2907 1812,2907 1812,2907 1812,2907 1812,2848.3 1812,2848.3",
		style=dashed];
	layer57_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2116,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer57_moe_split -> layer57_moe_comm_to_expert5	[pos="e,2087.2,2840.2 2630.3,2892 2400.2,2892 2087.2,2892 2087.2,2892 2087.2,2892 2087.2,2850.2 2087.2,2850.2",
		style=dashed];
	layer57_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2462,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer57_moe_split -> layer57_moe_comm_to_expert6	[pos="e,2552.7,2812 2629.7,2929.3 2629.7,2925.8 2629.7,2812 2629.7,2812 2629.7,2812 2562.7,2812 2562.7,2812",
		style=dashed];
	layer57_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2734,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer57_moe_split -> layer57_moe_comm_to_expert7	[pos="e,2734,2841.6 2734,2877.1 2734,2877.1 2734,2851.6 2734,2851.6",
		style=dashed];
	layer57_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="3006,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer57_moe_split -> layer57_moe_comm_to_expert8	[pos="e,3006,2841.6 3006,2877.1 3006,2877.1 3006,2851.6 3006,2851.6",
		style=dashed];
	layer57_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3315,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer57_moe_split -> layer57_moe_comm_to_expert9	[pos="e,3224.3,2812 3110.3,2929.3 3110.3,2925.8 3110.3,2812 3110.3,2812 3110.3,2812 3214.3,2812 3214.3,2812",
		style=dashed];
	layer57_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3647,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer57_moe_split -> layer57_moe_comm_to_expert10	[pos="e,3571.1,2829.7 3034.8,2892 3242.1,2892 3571.1,2892 3571.1,2892 3571.1,2892 3571.1,2839.7 3571.1,2839.7",
		style=dashed];
	layer57_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="3993,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer57_moe_split -> layer57_moe_comm_to_expert11	[pos="e,3917.6,2829.8 3049.8,2907 3349.2,2907 3917.6,2907 3917.6,2907 3917.6,2907 3917.6,2839.8 3917.6,2839.8",
		style=dashed];
	layer57_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4344,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer57_moe_split -> layer57_moe_comm_to_expert12	[pos="e,4268.6,2829.9 3063.7,2921 3447.7,2921 4268.6,2921 4268.6,2921 4268.6,2921 4268.6,2839.9 4268.6,2839.9",
		style=dashed];
	layer57_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4697,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer57_moe_split -> layer57_moe_comm_to_expert13	[pos="e,4622.1,2830.1 3078.7,2936 3543.3,2936 4622.1,2936 4622.1,2936 4622.1,2936 4622.1,2840.1 4622.1,2840.1",
		style=dashed];
	layer57_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5052,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer57_moe_split -> layer57_moe_comm_to_expert14	[pos="e,4977.1,2830 3094,2951 3636.6,2951 4977.1,2951 4977.1,2951 4977.1,2951 4977.1,2840 4977.1,2840",
		style=dashed];
	layer57_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5407,2812.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer57_moe_split -> layer57_moe_comm_to_expert15	[pos="e,5332.1,2830 3108.9,2966 3727.2,2966 5332.1,2966 5332.1,2966 5332.1,2966 5332.1,2840 5332.1,2840",
		style=dashed];
	layer57_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L57\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="275,2721.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer57_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="321,2630.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer57_moe_expert0 -> layer57_moe_comm_from_expert0	[pos="e,321,2659.6 321,2695.1 321,2695.1 321,2669.6 321,2669.6"];
	layer57_moe_comm_to_expert0 -> layer57_moe_expert0	[pos="e,385.25,2747.7 385.25,2785.6 385.25,2785.6 385.25,2757.7 385.25,2757.7"];
	layer57_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L57\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="621,2721.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer57_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="1034,2630.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer57_moe_expert1 -> layer57_moe_comm_from_expert1	[pos="e,943.28,2630 723.25,2695 723.25,2668 723.25,2630 723.25,2630 723.25,2630 933.28,2630 933.28,2630"];
	layer57_moe_comm_to_expert1 -> layer57_moe_expert1	[pos="e,648.75,2747.6 824.49,2812 747.31,2812 648.75,2812 648.75,2812 648.75,2812 648.75,2757.6 648.75,2757.6"];
	layer57_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L57\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="967,2721.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer57_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1490,2630.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer57_moe_expert2 -> layer57_moe_comm_from_expert2	[pos="e,1399.4,2630 1131.2,2721 1136.8,2721 1140,2721 1140,2721 1140,2721 1140,2630 1140,2630 1140,2630 1389.4,2630 1389.4,2630"];
	layer57_moe_comm_to_expert2 -> layer57_moe_expert2	[pos="e,1068.3,2747.6 1170.3,2812 1120.3,2812 1068.3,2812 1068.3,2812 1068.3,2812 1068.3,2757.6 1068.3,2757.6"];
	layer57_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L57\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1313,2721.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer57_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="1818,2630.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer57_moe_expert3 -> layer57_moe_comm_from_expert3	[pos="e,1759.3,2652.6 1438.2,2695.3 1438.2,2683 1438.2,2671 1438.2,2671 1438.2,2671 1759.3,2671 1759.3,2671 1759.3,2671 1759.3,2662.6 \
1759.3,2662.6"];
	layer57_moe_comm_to_expert3 -> layer57_moe_expert3	[pos="e,1459.7,2747.8 1459.7,2795.3 1459.7,2795.3 1459.7,2757.8 1459.7,2757.8"];
	layer57_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L57\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1659,2721.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer57_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2081,2630.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer57_moe_expert4 -> layer57_moe_comm_from_expert4	[pos="e,2079.7,2659.5 1791.2,2695.2 1791.2,2688.4 1791.2,2683 1791.2,2683 1791.2,2683 2079.7,2683 2079.7,2683 2079.7,2683 2079.7,2669.5 \
2079.7,2669.5"];
	layer57_moe_comm_to_expert4 -> layer57_moe_expert4	[pos="e,1750.7,2747.6 1750.7,2783.6 1750.7,2783.6 1750.7,2757.6 1750.7,2757.6"];
	layer57_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L57\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="2005,2721.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer57_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2312,2630.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer57_moe_expert5 -> layer57_moe_comm_from_expert5	[pos="e,2221.1,2630 2169.2,2721 2174.8,2721 2178,2721 2178,2721 2178,2721 2178,2630 2178,2630 2178,2630 2211.1,2630 2211.1,2630"];
	layer57_moe_comm_to_expert5 -> layer57_moe_expert5	[pos="e,2097.2,2747.6 2097.2,2783.6 2097.2,2783.6 2097.2,2757.6 2097.2,2757.6"];
	layer57_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L57\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2351,2721.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer57_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2527,2630.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer57_moe_expert6 -> layer57_moe_comm_from_expert6	[pos="e,2475.7,2654.5 2475.7,2695.1 2475.7,2695.1 2475.7,2664.5 2475.7,2664.5"];
	layer57_moe_comm_to_expert6 -> layer57_moe_expert6	[pos="e,2443.2,2747.6 2443.2,2783.6 2443.2,2783.6 2443.2,2757.6 2443.2,2757.6"];
	layer57_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L57\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2697,2721.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer57_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2734,2630.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer57_moe_expert7 -> layer57_moe_comm_from_expert7	[pos="e,2734,2659.6 2734,2695.1 2734,2695.1 2734,2669.6 2734,2669.6"];
	layer57_moe_comm_to_expert7 -> layer57_moe_expert7	[pos="e,2734,2747.7 2734,2783.4 2734,2783.4 2734,2757.7 2734,2757.7"];
	layer57_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L57\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3043,2721.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer57_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="3006,2630.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer57_moe_expert8 -> layer57_moe_comm_from_expert8	[pos="e,3006,2659.6 3006,2695.1 3006,2695.1 3006,2669.6 3006,2669.6"];
	layer57_moe_comm_to_expert8 -> layer57_moe_expert8	[pos="e,3006,2747.7 3006,2783.4 3006,2783.4 3006,2757.7 3006,2757.7"];
	layer57_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L57\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3389,2721.4",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer57_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3315,2630.4",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer57_moe_expert9 -> layer57_moe_comm_from_expert9	[pos="e,3315.3,2659.6 3315.3,2695.1 3315.3,2695.1 3315.3,2669.6 3315.3,2669.6"];
	layer57_moe_comm_to_expert9 -> layer57_moe_expert9	[pos="e,3315.3,2747.7 3315.3,2783.4 3315.3,2783.4 3315.3,2757.7 3315.3,2757.7"];
	layer57_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L57\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3740,2721.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer57_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3647,2630.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer57_moe_expert10 -> layer57_moe_comm_from_expert10	[pos="e,3656.4,2659.6 3656.4,2695.1 3656.4,2695.1 3656.4,2669.6 3656.4,2669.6"];
	layer57_moe_comm_to_expert10 -> layer57_moe_expert10	[pos="e,3656,2747.7 3656,2783.4 3656,2783.4 3656,2757.7 3656,2757.7"];
	layer57_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L57\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4096,2721.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer57_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="3994,2630.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer57_moe_expert11 -> layer57_moe_comm_from_expert11	[pos="e,4007.9,2659.2 4007.9,2695.1 4007.9,2695.1 4007.9,2669.2 4007.9,2669.2"];
	layer57_moe_comm_to_expert11 -> layer57_moe_expert11	[pos="e,4007,2747.6 4007,2783.6 4007,2783.6 4007,2757.6 4007,2757.6"];
	layer57_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L57\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4452,2721.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer57_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4345,2630.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer57_moe_expert12 -> layer57_moe_comm_from_expert12	[pos="e,4361.4,2659.2 4361.4,2695.1 4361.4,2695.1 4361.4,2669.2 4361.4,2669.2"];
	layer57_moe_comm_to_expert12 -> layer57_moe_expert12	[pos="e,4360.5,2747.6 4360.5,2783.6 4360.5,2783.6 4360.5,2757.6 4360.5,2757.6"];
	layer57_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L57\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="4808,2721.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer57_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4699,2630.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer57_moe_expert13 -> layer57_moe_comm_from_expert13	[pos="e,4716.4,2659.2 4716.4,2695.1 4716.4,2695.1 4716.4,2669.2 4716.4,2669.2"];
	layer57_moe_comm_to_expert13 -> layer57_moe_expert13	[pos="e,4715,2747.6 4715,2783.6 4715,2783.6 4715,2757.6 4715,2757.6"];
	layer57_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L57\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5164,2721.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer57_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5054,2630.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer57_moe_expert14 -> layer57_moe_comm_from_expert14	[pos="e,5071.9,2658.9 5071.9,2695.1 5071.9,2695.1 5071.9,2668.9 5071.9,2668.9"];
	layer57_moe_comm_to_expert14 -> layer57_moe_expert14	[pos="e,5070.5,2747.6 5070.5,2783.6 5070.5,2783.6 5070.5,2757.6 5070.5,2757.6"];
	layer57_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L57\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5520,2721.4",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer57_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5409,2630.4",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer57_moe_expert15 -> layer57_moe_comm_from_expert15	[pos="e,5427.4,2658.9 5427.4,2695.1 5427.4,2695.1 5427.4,2668.9 5427.4,2668.9"];
	layer57_moe_comm_to_expert15 -> layer57_moe_expert15	[pos="e,5426,2747.6 5426,2783.6 5426,2783.6 5426,2757.6 5426,2757.6"];
	layer57_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L57\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2833,2513.4",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer58_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L58\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2833,2399.4",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer57_moe_aggregate -> layer58_moe_mha	[pos="e,2833,2425.7 2833,2461.1 2833,2461.1 2833,2435.7 2833,2435.7"];
	layer57_moe_comm_from_expert0 -> layer57_moe_aggregate	[pos="e,2585.9,2476 406.75,2620.8 406.75,2587 406.75,2476 406.75,2476 406.75,2476 2575.9,2476 2575.9,2476"];
	layer57_moe_comm_from_expert1 -> layer57_moe_aggregate	[pos="e,2601.3,2491 1118.3,2619.5 1118.3,2586.6 1118.3,2491 1118.3,2491 1118.3,2491 2591.3,2491 2591.3,2491"];
	layer57_moe_comm_from_expert2 -> layer57_moe_aggregate	[pos="e,2616.7,2506 1562,2612.6 1562,2578.2 1562,2506 1562,2506 1562,2506 2606.7,2506 2606.7,2506"];
	layer57_moe_comm_from_expert3 -> layer57_moe_aggregate	[pos="e,2631.3,2520 1890,2612.7 1890,2581.5 1890,2520 1890,2520 1890,2520 2621.3,2520 2621.3,2520"];
	layer57_moe_comm_from_expert4 -> layer57_moe_aggregate	[pos="e,2646.6,2535 2160.8,2616.3 2160.8,2589.8 2160.8,2535 2160.8,2535 2160.8,2535 2636.6,2535 2636.6,2535"];
	layer57_moe_comm_from_expert5 -> layer57_moe_aggregate	[pos="e,2662,2550 2382.5,2612.2 2382.5,2588.4 2382.5,2550 2382.5,2550 2382.5,2550 2652,2550 2652,2550"];
	layer57_moe_comm_from_expert6 -> layer57_moe_aggregate	[pos="e,2594.1,2513.5 2594.1,2610.8 2594.1,2610.8 2594.1,2523.5 2594.1,2523.5"];
	layer57_moe_comm_from_expert7 -> layer57_moe_aggregate	[pos="e,2734,2565.5 2734,2601.2 2734,2601.2 2734,2575.5 2734,2575.5"];
	layer57_moe_comm_from_expert8 -> layer57_moe_aggregate	[pos="e,3005.4,2565.5 3005.4,2601.2 3005.4,2601.2 3005.4,2575.5 3005.4,2575.5"];
	layer57_moe_comm_from_expert9 -> layer57_moe_aggregate	[pos="e,3081.4,2552 3296.5,2601.7 3296.5,2579.3 3296.5,2552 3296.5,2552 3296.5,2552 3091.4,2552 3091.4,2552"];
	layer57_moe_comm_from_expert10 -> layer57_moe_aggregate	[pos="e,3068.1,2539 3628.1,2602 3628.1,2575.2 3628.1,2539 3628.1,2539 3628.1,2539 3078.1,2539 3078.1,2539"];
	layer57_moe_comm_from_expert11 -> layer57_moe_aggregate	[pos="e,3054.5,2526 3974.6,2601.9 3974.6,2571 3974.6,2526 3974.6,2526 3974.6,2526 3064.5,2526 3064.5,2526"];
	layer57_moe_comm_from_expert12 -> layer57_moe_aggregate	[pos="e,3041.3,2513 4325.6,2602 4325.6,2567.2 4325.6,2513 4325.6,2513 4325.6,2513 3051.3,2513 3051.3,2513"];
	layer57_moe_comm_from_expert13 -> layer57_moe_aggregate	[pos="e,3028,2500 4679.1,2601.8 4679.1,2563.4 4679.1,2500 4679.1,2500 4679.1,2500 3038,2500 3038,2500"];
	layer57_moe_comm_from_expert14 -> layer57_moe_aggregate	[pos="e,3014.5,2487 5034.1,2601.7 5034.1,2559.9 5034.1,2487 5034.1,2487 5034.1,2487 3024.5,2487 3024.5,2487"];
	layer57_moe_comm_from_expert15 -> layer57_moe_aggregate	[pos="e,3001.2,2474 5389.1,2601.7 5389.1,2556.6 5389.1,2474 5389.1,2474 5389.1,2474 3011.2,2474 3011.2,2474"];
	layer58_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L58\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="2833,2285.4",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer58_moe_mha -> layer58_moe_gate	[pos="e,2833,2337.5 2833,2373.3 2833,2373.3 2833,2347.5 2833,2347.5"];
	layer58_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L58\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="2833,2145.4",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer58_moe_gate -> layer58_moe_split	[pos="e,2833,2197.6 2833,2233.3 2833,2233.3 2833,2207.6 2833,2207.6"];
	layer58_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="752,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer58_moe_split -> layer58_moe_comm_to_expert0	[pos="e,822.75,2046.7 2667.2,2182 2186,2182 822.75,2182 822.75,2182 822.75,2182 822.75,2056.7 822.75,2056.7",
		style=dashed];
	layer58_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="997,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer58_moe_split -> layer58_moe_comm_to_expert1	[pos="e,1015.5,2057.2 2652.5,2167 2193.1,2167 1015.5,2167 1015.5,2167 1015.5,2167 1015.5,2067.2 1015.5,2067.2",
		style=dashed];
	layer58_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1453,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer58_moe_split -> layer58_moe_comm_to_expert2	[pos="e,1471.5,2057.1 2637.2,2152 2260.5,2152 1471.5,2152 1471.5,2152 1471.5,2152 1471.5,2067.1 1471.5,2067.1",
		style=dashed];
	layer58_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="1781,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer58_moe_split -> layer58_moe_comm_to_expert3	[pos="e,1799.5,2056.9 2623.2,2138 2321.1,2138 1799.5,2138 1799.5,2138 1799.5,2138 1799.5,2066.9 1799.5,2066.9",
		style=dashed];
	layer58_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="2044,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer58_moe_split -> layer58_moe_comm_to_expert4	[pos="e,2062.5,2057.1 2608.3,2123 2380.9,2123 2062.5,2123 2062.5,2123 2062.5,2123 2062.5,2067.1 2062.5,2067.1",
		style=dashed];
	layer58_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2275,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer58_moe_split -> layer58_moe_comm_to_expert5	[pos="e,2293.5,2057.2 2593.2,2108 2449.1,2108 2293.5,2108 2293.5,2108 2293.5,2108 2293.5,2067.2 2293.5,2067.2",
		style=dashed];
	layer58_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2490,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer58_moe_split -> layer58_moe_comm_to_expert6	[pos="e,2580.8,2028 2593.5,2145.4 2593.5,2141.8 2593.5,2028 2593.5,2028 2593.5,2028 2590.8,2028 2590.8,2028",
		style=dashed];
	layer58_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2697,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer58_moe_split -> layer58_moe_comm_to_expert7	[pos="e,2697,2057.7 2697,2093.1 2697,2093.1 2697,2067.7 2697,2067.7",
		style=dashed];
	layer58_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="2969,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer58_moe_split -> layer58_moe_comm_to_expert8	[pos="e,2969,2057.7 2969,2093.1 2969,2093.1 2969,2067.7 2969,2067.7",
		style=dashed];
	layer58_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3278,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer58_moe_split -> layer58_moe_comm_to_expert9	[pos="e,3187.3,2028 3073.3,2145.4 3073.3,2141.8 3073.3,2028 3073.3,2028 3073.3,2028 3177.3,2028 3177.3,2028",
		style=dashed];
	layer58_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3610,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer58_moe_split -> layer58_moe_comm_to_expert10	[pos="e,3534.1,2045.7 2997.8,2108 3205.1,2108 3534.1,2108 3534.1,2108 3534.1,2108 3534.1,2055.7 3534.1,2055.7",
		style=dashed];
	layer58_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="3956,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer58_moe_split -> layer58_moe_comm_to_expert11	[pos="e,3880.6,2045.8 3012.8,2123 3312.2,2123 3880.6,2123 3880.6,2123 3880.6,2123 3880.6,2055.8 3880.6,2055.8",
		style=dashed];
	layer58_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4307,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer58_moe_split -> layer58_moe_comm_to_expert12	[pos="e,4231.6,2046 3027.8,2138 3412.3,2138 4231.6,2138 4231.6,2138 4231.6,2138 4231.6,2056 4231.6,2056",
		style=dashed];
	layer58_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4660,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer58_moe_split -> layer58_moe_comm_to_expert13	[pos="e,4585.1,2046.1 3041.7,2152 3506.3,2152 4585.1,2152 4585.1,2152 4585.1,2152 4585.1,2056.1 4585.1,2056.1",
		style=dashed];
	layer58_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="5015,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer58_moe_split -> layer58_moe_comm_to_expert14	[pos="e,4940.1,2046 3057,2167 3599.6,2167 4940.1,2167 4940.1,2167 4940.1,2167 4940.1,2056 4940.1,2056",
		style=dashed];
	layer58_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5370,2028.4",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer58_moe_split -> layer58_moe_comm_to_expert15	[pos="e,5295.1,2046.1 3071.6,2182 3689.7,2182 5295.1,2182 5295.1,2182 5295.1,2182 5295.1,2056.1 5295.1,2056.1",
		style=dashed];
	layer58_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L58\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="238,1937.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer58_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="284,1846.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer58_moe_expert0 -> layer58_moe_comm_from_expert0	[pos="e,284,1875.6 284,1911.1 284,1911.1 284,1885.6 284,1885.6"];
	layer58_moe_comm_to_expert0 -> layer58_moe_expert0	[pos="e,316.25,1963.6 661.45,2028 533.78,2028 316.25,2028 316.25,2028 316.25,2028 316.25,1973.6 316.25,1973.6"];
	layer58_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L58\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="584,1937.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer58_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="997,1846.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer58_moe_expert1 -> layer58_moe_comm_from_expert1	[pos="e,906.16,1846 694.25,1911 694.25,1884 694.25,1846 694.25,1846 694.25,1846 896.16,1846 896.16,1846"];
	layer58_moe_comm_to_expert1 -> layer58_moe_expert1	[pos="e,704.75,1963.6 997,1999.2 997,1985.5 997,1972 997,1972 997,1972 704.75,1972 704.75,1972 704.75,1972 704.75,1971.2 704.75,1971.2"];
	layer58_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L58\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="930,1937.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer58_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1453,1846.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer58_moe_expert2 -> layer58_moe_comm_from_expert2	[pos="e,1362.3,1846 1094.2,1928 1101.6,1928 1106,1928 1106,1928 1106,1928 1106,1846 1106,1846 1106,1846 1352.3,1846 1352.3,1846"];
	layer58_moe_comm_to_expert2 -> layer58_moe_expert2	[pos="e,1094.3,1946 1362.1,2028 1257.5,2028 1100,2028 1100,2028 1100,2028 1100,1946 1100,1946 1100,1946 1099.4,1946 1099.4,1946"];
	layer58_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L58\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1276,1937.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer58_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="1781,1846.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer58_moe_expert3 -> layer58_moe_comm_from_expert3	[pos="e,1722.3,1868.6 1401.2,1911.3 1401.2,1899 1401.2,1887 1401.2,1887 1401.2,1887 1722.3,1887 1722.3,1887 1722.3,1887 1722.3,1878.6 \
1722.3,1878.6"];
	layer58_moe_comm_to_expert3 -> layer58_moe_expert3	[pos="e,1401.2,1963.7 1722.3,2006.1 1722.3,1997.6 1722.3,1990 1722.3,1990 1722.3,1990 1401.2,1990 1401.2,1990 1401.2,1990 1401.2,1973.7 \
1401.2,1973.7"];
	layer58_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L58\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1622,1937.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer58_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="2044,1846.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer58_moe_expert4 -> layer58_moe_comm_from_expert4	[pos="e,2042.7,1875.5 1754.2,1911.2 1754.2,1904.4 1754.2,1899 1754.2,1899 1754.2,1899 2042.7,1899 2042.7,1899 2042.7,1899 2042.7,1885.5 \
2042.7,1885.5"];
	layer58_moe_comm_to_expert4 -> layer58_moe_expert4	[pos="e,1754.2,1963.8 2042.7,1999.2 2042.7,1989.4 2042.7,1981 2042.7,1981 2042.7,1981 1754.2,1981 1754.2,1981 1754.2,1981 1754.2,1973.8 \
1754.2,1973.8"];
	layer58_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L58\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="1968,1937.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer58_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2275,1846.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer58_moe_expert5 -> layer58_moe_comm_from_expert5	[pos="e,2184.2,1846 2132.1,1928 2140.1,1928 2144.8,1928 2144.8,1928 2144.8,1928 2144.8,1846 2144.8,1846 2144.8,1846 2174.2,1846 2174.2,\
1846"];
	layer58_moe_comm_to_expert5 -> layer58_moe_expert5	[pos="e,2132.3,1946 2184.4,2028 2159.7,2028 2139.7,2028 2139.7,2028 2139.7,2028 2139.7,1946 2139.7,1946 2139.7,1946 2138.9,1946 2138.9,\
1946"];
	layer58_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L58\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2314,1937.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer58_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2490,1846.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer58_moe_expert6 -> layer58_moe_comm_from_expert6	[pos="e,2438.7,1870.5 2438.7,1911.1 2438.7,1911.1 2438.7,1880.5 2438.7,1880.5"];
	layer58_moe_comm_to_expert6 -> layer58_moe_expert6	[pos="e,2438.7,1963.8 2438.7,2004.5 2438.7,2004.5 2438.7,1973.8 2438.7,1973.8"];
	layer58_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L58\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2660,1937.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer58_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2697,1846.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer58_moe_expert7 -> layer58_moe_comm_from_expert7	[pos="e,2697,1875.6 2697,1911.1 2697,1911.1 2697,1885.6 2697,1885.6"];
	layer58_moe_comm_to_expert7 -> layer58_moe_expert7	[pos="e,2697,1963.8 2697,1999.4 2697,1999.4 2697,1973.8 2697,1973.8"];
	layer58_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L58\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="3006,1937.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer58_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="2969,1846.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer58_moe_expert8 -> layer58_moe_comm_from_expert8	[pos="e,2969,1875.6 2969,1911.1 2969,1911.1 2969,1885.6 2969,1885.6"];
	layer58_moe_comm_to_expert8 -> layer58_moe_expert8	[pos="e,2969,1963.8 2969,1999.4 2969,1999.4 2969,1973.8 2969,1973.8"];
	layer58_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L58\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3352,1937.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer58_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3278,1846.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer58_moe_expert9 -> layer58_moe_comm_from_expert9	[pos="e,3278.3,1875.6 3278.3,1911.1 3278.3,1911.1 3278.3,1885.6 3278.3,1885.6"];
	layer58_moe_comm_to_expert9 -> layer58_moe_expert9	[pos="e,3278.3,1963.8 3278.3,1999.4 3278.3,1999.4 3278.3,1973.8 3278.3,1973.8"];
	layer58_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L58\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3703,1937.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer58_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3610,1846.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer58_moe_expert10 -> layer58_moe_comm_from_expert10	[pos="e,3619.4,1875.6 3619.4,1911.1 3619.4,1911.1 3619.4,1885.6 3619.4,1885.6"];
	layer58_moe_comm_to_expert10 -> layer58_moe_expert10	[pos="e,3619,1963.8 3619,1999.4 3619,1999.4 3619,1973.8 3619,1973.8"];
	layer58_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L58\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4059,1937.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer58_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="3957,1846.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer58_moe_expert11 -> layer58_moe_comm_from_expert11	[pos="e,3970.9,1875.3 3970.9,1911.1 3970.9,1911.1 3970.9,1885.3 3970.9,1885.3"];
	layer58_moe_comm_to_expert11 -> layer58_moe_expert11	[pos="e,3970,1963.6 3970,1999.7 3970,1999.7 3970,1973.6 3970,1973.6"];
	layer58_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L58\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4415,1937.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer58_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4308,1846.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer58_moe_expert12 -> layer58_moe_comm_from_expert12	[pos="e,4324.4,1875.3 4324.4,1911.1 4324.4,1911.1 4324.4,1885.3 4324.4,1885.3"];
	layer58_moe_comm_to_expert12 -> layer58_moe_expert12	[pos="e,4323.5,1963.6 4323.5,1999.7 4323.5,1999.7 4323.5,1973.6 4323.5,1973.6"];
	layer58_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L58\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="4771,1937.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer58_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4662,1846.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer58_moe_expert13 -> layer58_moe_comm_from_expert13	[pos="e,4679.4,1875.3 4679.4,1911.1 4679.4,1911.1 4679.4,1885.3 4679.4,1885.3"];
	layer58_moe_comm_to_expert13 -> layer58_moe_expert13	[pos="e,4678,1963.6 4678,1999.7 4678,1999.7 4678,1973.6 4678,1973.6"];
	layer58_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L58\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5127,1937.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer58_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="5017,1846.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer58_moe_expert14 -> layer58_moe_comm_from_expert14	[pos="e,5034.9,1874.9 5034.9,1911.1 5034.9,1911.1 5034.9,1884.9 5034.9,1884.9"];
	layer58_moe_comm_to_expert14 -> layer58_moe_expert14	[pos="e,5033.5,1963.6 5033.5,1999.7 5033.5,1999.7 5033.5,1973.6 5033.5,1973.6"];
	layer58_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L58\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5483,1937.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer58_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5372,1846.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer58_moe_expert15 -> layer58_moe_comm_from_expert15	[pos="e,5390.4,1874.9 5390.4,1911.1 5390.4,1911.1 5390.4,1884.9 5390.4,1884.9"];
	layer58_moe_comm_to_expert15 -> layer58_moe_expert15	[pos="e,5389,1963.6 5389,1999.7 5389,1999.7 5389,1973.6 5389,1973.6"];
	layer58_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L58\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2796,1729.5",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer59_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L59\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2796,1615.5",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer58_moe_aggregate -> layer59_moe_mha	[pos="e,2796,1641.7 2796,1677.1 2796,1677.1 2796,1651.7 2796,1651.7"];
	layer58_moe_comm_from_expert0 -> layer58_moe_aggregate	[pos="e,2548.7,1692 334.5,1822.3 334.5,1778.9 334.5,1692 334.5,1692 334.5,1692 2538.7,1692 2538.7,1692"];
	layer58_moe_comm_from_expert1 -> layer58_moe_aggregate	[pos="e,2563.9,1707 970.83,1818.6 970.83,1777.9 970.83,1707 970.83,1707 970.83,1707 2553.9,1707 2553.9,1707"];
	layer58_moe_comm_from_expert2 -> layer58_moe_aggregate	[pos="e,2579.6,1722 1528.5,1830.4 1528.5,1796.8 1528.5,1722 1528.5,1722 1528.5,1722 2569.6,1722 2569.6,1722"];
	layer58_moe_comm_from_expert3 -> layer58_moe_aggregate	[pos="e,2594.1,1736 1828.5,1821.7 1828.5,1789.1 1828.5,1736 1828.5,1736 1828.5,1736 2584.1,1736 2584.1,1736"];
	layer58_moe_comm_from_expert4 -> layer58_moe_aggregate	[pos="e,2609.3,1751 2072.8,1818.9 2072.8,1790.7 2072.8,1751 2072.8,1751 2072.8,1751 2599.3,1751 2599.3,1751"];
	layer58_moe_comm_from_expert5 -> layer58_moe_aggregate	[pos="e,2625,1766 2331.5,1823.6 2331.5,1799.8 2331.5,1766 2331.5,1766 2331.5,1766 2615,1766 2615,1766"];
	layer58_moe_comm_from_expert6 -> layer58_moe_aggregate	[pos="e,2557.1,1729.5 2557.1,1826.9 2557.1,1826.9 2557.1,1739.5 2557.1,1739.5"];
	layer58_moe_comm_from_expert7 -> layer58_moe_aggregate	[pos="e,2697,1781.5 2697,1817.2 2697,1817.2 2697,1791.5 2697,1791.5"];
	layer58_moe_comm_from_expert8 -> layer58_moe_aggregate	[pos="e,2968.4,1781.5 2968.4,1817.2 2968.4,1817.2 2968.4,1791.5 2968.4,1791.5"];
	layer58_moe_comm_from_expert9 -> layer58_moe_aggregate	[pos="e,3044.4,1768 3259.5,1817.7 3259.5,1795.3 3259.5,1768 3259.5,1768 3259.5,1768 3054.4,1768 3054.4,1768"];
	layer58_moe_comm_from_expert10 -> layer58_moe_aggregate	[pos="e,3030.8,1755 3591.1,1818 3591.1,1791.2 3591.1,1755 3591.1,1755 3591.1,1755 3040.8,1755 3040.8,1755"];
	layer58_moe_comm_from_expert11 -> layer58_moe_aggregate	[pos="e,3017.5,1742 3937.6,1817.9 3937.6,1787 3937.6,1742 3937.6,1742 3937.6,1742 3027.5,1742 3027.5,1742"];
	layer58_moe_comm_from_expert12 -> layer58_moe_aggregate	[pos="e,3004.3,1729 4288.6,1818 4288.6,1783.3 4288.6,1729 4288.6,1729 4288.6,1729 3014.3,1729 3014.3,1729"];
	layer58_moe_comm_from_expert13 -> layer58_moe_aggregate	[pos="e,2991,1716 4642.1,1817.8 4642.1,1779.4 4642.1,1716 4642.1,1716 4642.1,1716 3001,1716 3001,1716"];
	layer58_moe_comm_from_expert14 -> layer58_moe_aggregate	[pos="e,2977.5,1703 4997.1,1817.8 4997.1,1775.9 4997.1,1703 4997.1,1703 4997.1,1703 2987.5,1703 2987.5,1703"];
	layer58_moe_comm_from_expert15 -> layer58_moe_aggregate	[pos="e,2964.2,1690 5352.1,1817.8 5352.1,1772.6 5352.1,1690 5352.1,1690 5352.1,1690 2974.2,1690 2974.2,1690"];
	layer59_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L59\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="2796,1501.5",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer59_moe_mha -> layer59_moe_gate	[pos="e,2796,1553.6 2796,1589.3 2796,1589.3 2796,1563.6 2796,1563.6"];
	layer59_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L59\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="2796,1361.5",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer59_moe_gate -> layer59_moe_split	[pos="e,2796,1413.6 2796,1449.3 2796,1449.3 2796,1423.6 2796,1423.6"];
	layer59_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="385,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer59_moe_split -> layer59_moe_comm_to_expert0	[pos="e,447.75,1265.5 2630.4,1398 2095.4,1398 447.75,1398 447.75,1398 447.75,1398 447.75,1275.5 447.75,1275.5",
		style=dashed];
	layer59_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="731,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer59_moe_split -> layer59_moe_comm_to_expert1	[pos="e,793.75,1265.5 2615.2,1383 2122.7,1383 793.75,1383 793.75,1383 793.75,1383 793.75,1275.5 793.75,1275.5",
		style=dashed];
	layer59_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1003,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer59_moe_split -> layer59_moe_comm_to_expert2	[pos="e,1029.2,1272.5 2600.2,1368 2140.2,1368 1029.2,1368 1029.2,1368 1029.2,1368 1029.2,1282.5 1029.2,1282.5",
		style=dashed];
	layer59_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="1423,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer59_moe_split -> layer59_moe_comm_to_expert3	[pos="e,1438,1273.3 2586.4,1354 2205.4,1354 1438,1354 1438,1354 1438,1354 1438,1283.3 1438,1283.3",
		style=dashed];
	layer59_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="1695,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer59_moe_split -> layer59_moe_comm_to_expert4	[pos="e,1738,1270.3 2571.3,1339 2260.7,1339 1738,1339 1738,1339 1738,1339 1738,1280.3 1738,1280.3",
		style=dashed];
	layer59_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2042,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer59_moe_split -> layer59_moe_comm_to_expert5	[pos="e,2013.2,1272.3 2556.3,1324 2326.2,1324 2013.2,1324 2013.2,1324 2013.2,1324 2013.2,1282.3 2013.2,1282.3",
		style=dashed];
	layer59_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2388,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer59_moe_split -> layer59_moe_comm_to_expert6	[pos="e,2478.7,1244 2555.7,1361.4 2555.7,1357.8 2555.7,1244 2555.7,1244 2555.7,1244 2488.7,1244 2488.7,1244",
		style=dashed];
	layer59_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2660,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer59_moe_split -> layer59_moe_comm_to_expert7	[pos="e,2660,1273.7 2660,1309.1 2660,1309.1 2660,1283.7 2660,1283.7",
		style=dashed];
	layer59_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="2932,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer59_moe_split -> layer59_moe_comm_to_expert8	[pos="e,2932,1273.7 2932,1309.1 2932,1309.1 2932,1283.7 2932,1283.7",
		style=dashed];
	layer59_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3241,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer59_moe_split -> layer59_moe_comm_to_expert9	[pos="e,3150.3,1244 3036.3,1361.4 3036.3,1357.8 3036.3,1244 3036.3,1244 3036.3,1244 3140.3,1244 3140.3,1244",
		style=dashed];
	layer59_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3573,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer59_moe_split -> layer59_moe_comm_to_expert10	[pos="e,3497.1,1261.7 2960.8,1324 3168.1,1324 3497.1,1324 3497.1,1324 3497.1,1324 3497.1,1271.7 3497.1,1271.7",
		style=dashed];
	layer59_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="3919,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer59_moe_split -> layer59_moe_comm_to_expert11	[pos="e,3843.6,1261.8 2975.8,1339 3275.2,1339 3843.6,1339 3843.6,1339 3843.6,1339 3843.6,1271.8 3843.6,1271.8",
		style=dashed];
	layer59_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4270,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer59_moe_split -> layer59_moe_comm_to_expert12	[pos="e,4194.6,1262.1 2990.8,1354 3375.3,1354 4194.6,1354 4194.6,1354 4194.6,1354 4194.6,1272.1 4194.6,1272.1",
		style=dashed];
	layer59_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4623,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer59_moe_split -> layer59_moe_comm_to_expert13	[pos="e,4548.1,1262.2 3004.7,1368 3469.3,1368 4548.1,1368 4548.1,1368 4548.1,1368 4548.1,1272.2 4548.1,1272.2",
		style=dashed];
	layer59_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="4978,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer59_moe_split -> layer59_moe_comm_to_expert14	[pos="e,4903.1,1262 3020,1383 3562.6,1383 4903.1,1383 4903.1,1383 4903.1,1383 4903.1,1272 4903.1,1272",
		style=dashed];
	layer59_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5333,1244.5",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer59_moe_split -> layer59_moe_comm_to_expert15	[pos="e,5258.1,1262.1 3034.6,1398 3652.7,1398 5258.1,1398 5258.1,1398 5258.1,1398 5258.1,1272.1 5258.1,1272.1",
		style=dashed];
	layer59_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L59\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="201,1153.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer59_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="358,1062.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer59_moe_expert0 -> layer59_moe_comm_from_expert0	[pos="e,316.25,1088.4 316.25,1127.2 316.25,1127.2 316.25,1098.4 316.25,1098.4"];
	layer59_moe_comm_to_expert0 -> layer59_moe_expert0	[pos="e,329.75,1179.7 329.75,1221 329.75,1221 329.75,1189.7 329.75,1189.7"];
	layer59_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L59\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="547,1153.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer59_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="777,1062.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer59_moe_expert1 -> layer59_moe_comm_from_expert1	[pos="e,698.75,1077.2 698.75,1127.2 698.75,1127.2 698.75,1087.2 698.75,1087.2"];
	layer59_moe_comm_to_expert1 -> layer59_moe_expert1	[pos="e,675.75,1179.7 675.75,1221 675.75,1221 675.75,1189.7 675.75,1189.7"];
	layer59_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L59\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="893,1153.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer59_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1086,1062.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer59_moe_expert2 -> layer59_moe_comm_from_expert2	[pos="e,1026.2,1084.5 1026.2,1127.2 1026.2,1127.2 1026.2,1094.5 1026.2,1094.5"];
	layer59_moe_comm_to_expert2 -> layer59_moe_expert2	[pos="e,984.75,1179.6 984.75,1215.7 984.75,1215.7 984.75,1189.6 984.75,1189.6"];
	layer59_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L59\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1239,1153.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer59_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="1340,1062.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer59_moe_expert3 -> layer59_moe_comm_from_expert3	[pos="e,1326.2,1091.3 1326.2,1127.2 1326.2,1127.2 1326.2,1101.3 1326.2,1101.3"];
	layer59_moe_comm_to_expert3 -> layer59_moe_expert3	[pos="e,1367.7,1179.7 1367.7,1221 1367.7,1221 1367.7,1189.7 1367.7,1189.7"];
	layer59_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L59\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1585,1153.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer59_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="1678,1062.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer59_moe_expert4 -> layer59_moe_comm_from_expert4	[pos="e,1668.2,1091.6 1668.2,1127.2 1668.2,1127.2 1668.2,1101.6 1668.2,1101.6"];
	layer59_moe_comm_to_expert4 -> layer59_moe_expert4	[pos="e,1676.7,1179.6 1676.7,1215.7 1676.7,1215.7 1676.7,1189.6 1676.7,1189.6"];
	layer59_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L59\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="1931,1153.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer59_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2097,1062.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer59_moe_expert5 -> layer59_moe_comm_from_expert5	[pos="e,2050.7,1087.5 2050.7,1127.2 2050.7,1127.2 2050.7,1097.5 2050.7,1097.5"];
	layer59_moe_comm_to_expert5 -> layer59_moe_expert5	[pos="e,2023.2,1179.6 2023.2,1215.7 2023.2,1215.7 2023.2,1189.6 2023.2,1189.6"];
	layer59_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L59\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2277,1153.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer59_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2406,1062.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer59_moe_expert6 -> layer59_moe_comm_from_expert6	[pos="e,2378.2,1090.3 2378.2,1127.2 2378.2,1127.2 2378.2,1100.3 2378.2,1100.3"];
	layer59_moe_comm_to_expert6 -> layer59_moe_expert6	[pos="e,2369.2,1179.6 2369.2,1215.7 2369.2,1215.7 2369.2,1189.6 2369.2,1189.6"];
	layer59_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L59\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2623,1153.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer59_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2660,1062.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer59_moe_expert7 -> layer59_moe_comm_from_expert7	[pos="e,2660,1091.6 2660,1127.2 2660,1127.2 2660,1101.6 2660,1101.6"];
	layer59_moe_comm_to_expert7 -> layer59_moe_expert7	[pos="e,2660,1179.8 2660,1215.4 2660,1215.4 2660,1189.8 2660,1189.8"];
	layer59_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L59\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="2969,1153.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer59_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="2932,1062.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer59_moe_expert8 -> layer59_moe_comm_from_expert8	[pos="e,2932,1091.6 2932,1127.2 2932,1127.2 2932,1101.6 2932,1101.6"];
	layer59_moe_comm_to_expert8 -> layer59_moe_expert8	[pos="e,2932,1179.8 2932,1215.4 2932,1215.4 2932,1189.8 2932,1189.8"];
	layer59_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L59\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3315,1153.5",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer59_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3241,1062.5",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer59_moe_expert9 -> layer59_moe_comm_from_expert9	[pos="e,3241.3,1091.6 3241.3,1127.2 3241.3,1127.2 3241.3,1101.6 3241.3,1101.6"];
	layer59_moe_comm_to_expert9 -> layer59_moe_expert9	[pos="e,3241.3,1179.8 3241.3,1215.4 3241.3,1215.4 3241.3,1189.8 3241.3,1189.8"];
	layer59_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L59\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3666,1153.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer59_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3573,1062.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer59_moe_expert10 -> layer59_moe_comm_from_expert10	[pos="e,3582.4,1091.6 3582.4,1127.2 3582.4,1127.2 3582.4,1101.6 3582.4,1101.6"];
	layer59_moe_comm_to_expert10 -> layer59_moe_expert10	[pos="e,3582,1179.8 3582,1215.4 3582,1215.4 3582,1189.8 3582,1189.8"];
	layer59_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L59\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="4022,1153.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer59_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="3920,1062.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer59_moe_expert11 -> layer59_moe_comm_from_expert11	[pos="e,3933.9,1091.3 3933.9,1127.2 3933.9,1127.2 3933.9,1101.3 3933.9,1101.3"];
	layer59_moe_comm_to_expert11 -> layer59_moe_expert11	[pos="e,3933,1179.6 3933,1215.7 3933,1215.7 3933,1189.6 3933,1189.6"];
	layer59_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L59\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4378,1153.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer59_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4271,1062.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer59_moe_expert12 -> layer59_moe_comm_from_expert12	[pos="e,4287.4,1091.3 4287.4,1127.2 4287.4,1127.2 4287.4,1101.3 4287.4,1101.3"];
	layer59_moe_comm_to_expert12 -> layer59_moe_expert12	[pos="e,4286.5,1179.6 4286.5,1215.7 4286.5,1215.7 4286.5,1189.6 4286.5,1189.6"];
	layer59_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L59\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="4734,1153.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer59_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4625,1062.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer59_moe_expert13 -> layer59_moe_comm_from_expert13	[pos="e,4642.4,1091.3 4642.4,1127.2 4642.4,1127.2 4642.4,1101.3 4642.4,1101.3"];
	layer59_moe_comm_to_expert13 -> layer59_moe_expert13	[pos="e,4641,1179.6 4641,1215.7 4641,1215.7 4641,1189.6 4641,1189.6"];
	layer59_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L59\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5090,1153.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer59_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="4980,1062.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer59_moe_expert14 -> layer59_moe_comm_from_expert14	[pos="e,4997.9,1091 4997.9,1127.2 4997.9,1127.2 4997.9,1101 4997.9,1101"];
	layer59_moe_comm_to_expert14 -> layer59_moe_expert14	[pos="e,4996.5,1179.6 4996.5,1215.7 4996.5,1215.7 4996.5,1189.6 4996.5,1189.6"];
	layer59_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L59\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5446,1153.5",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer59_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5335,1062.5",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer59_moe_expert15 -> layer59_moe_comm_from_expert15	[pos="e,5353.4,1091 5353.4,1127.2 5353.4,1127.2 5353.4,1101 5353.4,1101"];
	layer59_moe_comm_to_expert15 -> layer59_moe_expert15	[pos="e,5352,1179.6 5352,1215.7 5352,1215.7 5352,1189.6 5352,1189.6"];
	layer59_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L59\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2759,945.5",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	layer60_moe_mha	[fillcolor=lightblue,
		height=0.72222,
		label="MHA L60\nGPU: 0\nInput: [batch_size=B, seq_len=S, heads=128, d_k=128]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2759,831.5",
		shape=rectangle,
		style=filled,
		width=3.6111];
	layer59_moe_aggregate -> layer60_moe_mha	[pos="e,2759,857.73 2759,893.18 2759,893.18 2759,867.73 2759,867.73"];
	layer59_moe_comm_from_expert0 -> layer59_moe_aggregate	[pos="e,2511.7,908 425.01,1042.9 425.01,1001.4 425.01,908 425.01,908 425.01,908 2501.7,908 2501.7,908"];
	layer59_moe_comm_from_expert1 -> layer59_moe_aggregate	[pos="e,2526.9,923 790.5,1033.6 790.5,992.73 790.5,923 790.5,923 790.5,923 2516.9,923 2516.9,923"];
	layer59_moe_comm_from_expert2 -> layer59_moe_aggregate	[pos="e,2542.8,938 1118,1035.2 1118,998.53 1118,938 1118,938 1118,938 2532.8,938 2532.8,938"];
	layer59_moe_comm_from_expert3 -> layer59_moe_aggregate	[pos="e,2557.2,952 1381,1036.6 1381,1003.9 1381,952 1381,952 1381,952 2547.2,952 2547.2,952"];
	layer59_moe_comm_from_expert4 -> layer59_moe_aggregate	[pos="e,2572.6,967 1758.5,1049.2 1758.5,1023 1758.5,967 1758.5,967 1758.5,967 2562.6,967 2562.6,967"];
	layer59_moe_comm_from_expert5 -> layer59_moe_aggregate	[pos="e,2587.8,982 2141.5,1037 2141.5,1013.4 2141.5,982 2141.5,982 2141.5,982 2577.8,982 2577.8,982"];
	layer59_moe_comm_from_expert6 -> layer59_moe_aggregate	[pos="e,2533.1,945.59 2496.7,1062 2517.2,1062 2533.1,1062 2533.1,1062 2533.1,1062 2533.1,955.59 2533.1,955.59"];
	layer59_moe_comm_from_expert7 -> layer59_moe_aggregate	[pos="e,2660,997.56 2660,1033.3 2660,1033.3 2660,1007.6 2660,1007.6"];
	layer59_moe_comm_from_expert8 -> layer59_moe_aggregate	[pos="e,2931.4,997.56 2931.4,1033.3 2931.4,1033.3 2931.4,1007.6 2931.4,1007.6"];
	layer59_moe_comm_from_expert9 -> layer59_moe_aggregate	[pos="e,3007.4,984 3222.5,1033.7 3222.5,1011.3 3222.5,984 3222.5,984 3222.5,984 3017.4,984 3017.4,984"];
	layer59_moe_comm_from_expert10 -> layer59_moe_aggregate	[pos="e,2993.8,971 3554.1,1034 3554.1,1007.2 3554.1,971 3554.1,971 3554.1,971 3003.8,971 3003.8,971"];
	layer59_moe_comm_from_expert11 -> layer59_moe_aggregate	[pos="e,2980.5,958 3900.6,1033.9 3900.6,1003 3900.6,958 3900.6,958 3900.6,958 2990.5,958 2990.5,958"];
	layer59_moe_comm_from_expert12 -> layer59_moe_aggregate	[pos="e,2967.3,945 4251.6,1034.1 4251.6,999.28 4251.6,945 4251.6,945 4251.6,945 2977.3,945 2977.3,945"];
	layer59_moe_comm_from_expert13 -> layer59_moe_aggregate	[pos="e,2954,932 4605.1,1033.9 4605.1,995.44 4605.1,932 4605.1,932 4605.1,932 2964,932 2964,932"];
	layer59_moe_comm_from_expert14 -> layer59_moe_aggregate	[pos="e,2940.5,919 4960.1,1034.1 4960.1,992.33 4960.1,919 4960.1,919 4960.1,919 2950.5,919 2950.5,919"];
	layer59_moe_comm_from_expert15 -> layer59_moe_aggregate	[pos="e,2927.2,906 5315.1,1033.8 5315.1,988.61 5315.1,906 5315.1,906 5315.1,906 2937.2,906 2937.2,906"];
	layer60_moe_gate	[fillcolor=lightyellow,
		height=1.4444,
		label="GATE L60\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, num_experts=16]",
		pos="2759,717.5",
		shape=parallelogram,
		style=filled,
		width=7.1709];
	layer60_moe_mha -> layer60_moe_gate	[pos="e,2759,769.6 2759,805.35 2759,805.35 2759,779.6 2759,779.6"];
	layer60_moe_split	[fillcolor=lightcoral,
		height=1.4444,
		label="SPLIT TOKENS L60\nGPU: 0\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: Multiple expert-specific batches",
		pos="2759,577.5",
		shape=parallelogram,
		style=filled,
		width=7.0557];
	layer60_moe_gate -> layer60_moe_split	[pos="e,2759,629.68 2759,665.37 2759,665.37 2759,639.68 2759,639.68"];
	layer60_moe_comm_to_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 0\nGPU: 0\nTokens routed to expert 0",
		pos="311,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer60_moe_split -> layer60_moe_comm_to_expert0	[pos="e,334.5,488.67 2593.3,614 2046.6,614 334.5,614 334.5,614 334.5,614 334.5,498.67 334.5,498.67",
		style=dashed];
	layer60_moe_comm_to_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 1\nGPU: 1\nTokens routed to expert 1",
		pos="804,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer60_moe_split -> layer60_moe_comm_to_expert1	[pos="e,881.01,475.86 2578.1,599 2107.4,599 881.01,599 881.01,599 881.01,599 881.01,485.86 881.01,485.86",
		style=dashed];
	layer60_moe_comm_to_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 2\nGPU: 2\nTokens routed to expert 2",
		pos="1150,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer60_moe_split -> layer60_moe_comm_to_expert2	[pos="e,1208.5,482.88 2563.4,584 2146.6,584 1208.5,584 1208.5,584 1208.5,584 1208.5,492.88 1208.5,492.88",
		style=dashed];
	layer60_moe_comm_to_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 3\nGPU: 3\nTokens routed to expert 3",
		pos="1422,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer60_moe_split -> layer60_moe_comm_to_expert3	[pos="e,1471.5,484.81 2549.3,570 2184.5,570 1471.5,570 1471.5,570 1471.5,570 1471.5,494.81 1471.5,494.81",
		style=dashed];
	layer60_moe_comm_to_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 4\nGPU: 4\nTokens routed to expert 4",
		pos="1658,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer60_moe_split -> layer60_moe_comm_to_expert4	[pos="e,1668,489.38 2534.3,555 2214.9,555 1668,555 1668,555 1668,555 1668,499.38 1668,499.38",
		style=dashed];
	layer60_moe_comm_to_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 5\nGPU: 5\nTokens routed to expert 5",
		pos="2005,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer60_moe_split -> layer60_moe_comm_to_expert5	[pos="e,2051,485.66 2519.3,540 2313.9,540 2051,540 2051,540 2051,540 2051,495.66 2051,495.66",
		style=dashed];
	layer60_moe_comm_to_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 6\nGPU: 6\nTokens routed to expert 6",
		pos="2351,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer60_moe_split -> layer60_moe_comm_to_expert6	[pos="e,2441.7,460 2518.7,577.42 2518.7,573.86 2518.7,460 2518.7,460 2518.7,460 2451.7,460 2451.7,460",
		style=dashed];
	layer60_moe_comm_to_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 7\nGPU: 7\nTokens routed to expert 7",
		pos="2623,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer60_moe_split -> layer60_moe_comm_to_expert7	[pos="e,2623,489.72 2623,525.17 2623,525.17 2623,499.72 2623,499.72",
		style=dashed];
	layer60_moe_comm_to_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 8\nGPU: 8\nTokens routed to expert 8",
		pos="2895,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer60_moe_split -> layer60_moe_comm_to_expert8	[pos="e,2895,489.72 2895,525.17 2895,525.17 2895,499.72 2895,499.72",
		style=dashed];
	layer60_moe_comm_to_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 9\nGPU: 9\nTokens routed to expert 9",
		pos="3204,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.5142];
	layer60_moe_split -> layer60_moe_comm_to_expert9	[pos="e,3113.3,460 2999.3,577.42 2999.3,573.86 2999.3,460 2999.3,460 2999.3,460 3103.3,460 3103.3,460",
		style=dashed];
	layer60_moe_comm_to_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 10\nGPU: 10\nTokens routed to expert 10",
		pos="3536,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer60_moe_split -> layer60_moe_comm_to_expert10	[pos="e,3460.1,477.76 2923.8,540 3131.1,540 3460.1,540 3460.1,540 3460.1,540 3460.1,487.76 3460.1,487.76",
		style=dashed];
	layer60_moe_comm_to_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 11\nGPU: 11\nTokens routed to expert 11",
		pos="3882,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer60_moe_split -> layer60_moe_comm_to_expert11	[pos="e,3806.6,477.84 2938.8,555 3238.2,555 3806.6,555 3806.6,555 3806.6,555 3806.6,487.84 3806.6,487.84",
		style=dashed];
	layer60_moe_comm_to_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 12\nGPU: 12\nTokens routed to expert 12",
		pos="4233,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer60_moe_split -> layer60_moe_comm_to_expert12	[pos="e,4157.6,478.1 2953.8,570 3338.3,570 4157.6,570 4157.6,570 4157.6,570 4157.6,488.1 4157.6,488.1",
		style=dashed];
	layer60_moe_comm_to_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 13\nGPU: 13\nTokens routed to expert 13",
		pos="4586,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer60_moe_split -> layer60_moe_comm_to_expert13	[pos="e,4511.1,478.21 2967.7,584 3432.3,584 4511.1,584 4511.1,584 4511.1,584 4511.1,488.21 4511.1,488.21",
		style=dashed];
	layer60_moe_comm_to_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 14\nGPU: 14\nTokens routed to expert 14",
		pos="4941,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer60_moe_split -> layer60_moe_comm_to_expert14	[pos="e,4866.1,478.05 2983,599 3525.6,599 4866.1,599 4866.1,599 4866.1,599 4866.1,488.05 4866.1,488.05",
		style=dashed];
	layer60_moe_comm_to_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="SEND TO EXPERT 15\nGPU: 15\nTokens routed to expert 15",
		pos="5296,460.51",
		shape=ellipse,
		style="filled,dashed",
		width=2.6124];
	layer60_moe_split -> layer60_moe_comm_to_expert15	[pos="e,5221.1,478.12 2997.6,614 3615.7,614 5221.1,614 5221.1,614 5221.1,614 5221.1,488.12 5221.1,488.12",
		style=dashed];
	layer60_moe_expert0	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 0 L60\nGPU: 0\nInput: [batch_size=B_expert0, seq_len=S_expert0, hidden_dim=7168]\nOutput: [batch_size=B_expert0, seq_len=\
S_expert0, hidden_dim=7168]",
		pos="164,369.52",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer60_moe_comm_from_expert0	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 0\nGPU: 0\nOutput from expert 0",
		pos="384,278.53",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer60_moe_expert0 -> layer60_moe_comm_from_expert0	[pos="e,310.75,295.6 310.75,343.2 310.75,343.2 310.75,305.6 310.75,305.6"];
	layer60_moe_comm_to_expert0 -> layer60_moe_expert0	[pos="e,274.25,395.83 274.25,433.7 274.25,433.7 274.25,405.83 274.25,405.83"];
	layer60_moe_expert1	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 1 L60\nGPU: 1\nInput: [batch_size=B_expert1, seq_len=S_expert1, hidden_dim=7168]\nOutput: [batch_size=B_expert1, seq_len=\
S_expert1, hidden_dim=7168]",
		pos="510,369.52",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer60_moe_comm_from_expert1	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 1\nGPU: 0\nOutput from expert 1",
		pos="749,278.53",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer60_moe_expert1 -> layer60_moe_comm_from_expert1	[pos="e,666.25,290.43 666.25,343.2 666.25,343.2 666.25,300.43 666.25,300.43"];
	layer60_moe_comm_to_expert1 -> layer60_moe_expert1	[pos="e,561.25,395.69 713.27,460 644.32,460 561.25,460 561.25,460 561.25,460 561.25,405.69 561.25,405.69"];
	layer60_moe_expert2	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 2 L60\nGPU: 2\nInput: [batch_size=B_expert2, seq_len=S_expert2, hidden_dim=7168]\nOutput: [batch_size=B_expert2, seq_len=\
S_expert2, hidden_dim=7168]",
		pos="856,369.52",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer60_moe_comm_from_expert2	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 2\nGPU: 0\nOutput from expert 2",
		pos="1058,278.53",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer60_moe_expert2 -> layer60_moe_comm_from_expert2	[pos="e,993.75,299.01 993.75,343.2 993.75,343.2 993.75,309.01 993.75,309.01"];
	layer60_moe_comm_to_expert2 -> layer60_moe_expert2	[pos="e,1007.7,395.69 1059.1,460 1031.2,460 1007.7,460 1007.7,460 1007.7,460 1007.7,405.69 1007.7,405.69"];
	layer60_moe_expert3	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 3 L60\nGPU: 3\nInput: [batch_size=B_expert3, seq_len=S_expert3, hidden_dim=7168]\nOutput: [batch_size=B_expert3, seq_len=\
S_expert3, hidden_dim=7168]",
		pos="1202,369.52",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer60_moe_comm_from_expert3	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 3\nGPU: 0\nOutput from expert 3",
		pos="1312,278.53",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer60_moe_expert3 -> layer60_moe_comm_from_expert3	[pos="e,1293.7,307.02 1293.7,343.2 1293.7,343.2 1293.7,317.02 1293.7,317.02"];
	layer60_moe_comm_to_expert3 -> layer60_moe_expert3	[pos="e,1348.7,395.87 1348.7,443.4 1348.7,443.4 1348.7,405.87 1348.7,405.87"];
	layer60_moe_expert4	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 4 L60\nGPU: 4\nInput: [batch_size=B_expert4, seq_len=S_expert4, hidden_dim=7168]\nOutput: [batch_size=B_expert4, seq_len=\
S_expert4, hidden_dim=7168]",
		pos="1548,369.52",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer60_moe_comm_from_expert4	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 4\nGPU: 0\nOutput from expert 4",
		pos="1732,278.53",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer60_moe_expert4 -> layer60_moe_comm_from_expert4	[pos="e,1676.7,301.7 1676.7,343.2 1676.7,343.2 1676.7,311.7 1676.7,311.7"];
	layer60_moe_comm_to_expert4 -> layer60_moe_expert4	[pos="e,1639.7,395.66 1639.7,431.72 1639.7,431.72 1639.7,405.66 1639.7,405.66"];
	layer60_moe_expert5	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 5 L60\nGPU: 5\nInput: [batch_size=B_expert5, seq_len=S_expert5, hidden_dim=7168]\nOutput: [batch_size=B_expert5, seq_len=\
S_expert5, hidden_dim=7168]",
		pos="1894,369.52",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer60_moe_comm_from_expert5	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 5\nGPU: 0\nOutput from expert 5",
		pos="2004,278.53",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer60_moe_expert5 -> layer60_moe_comm_from_expert5	[pos="e,1985.7,307.02 1985.7,343.2 1985.7,343.2 1985.7,317.02 1985.7,317.02"];
	layer60_moe_comm_to_expert5 -> layer60_moe_expert5	[pos="e,1986.2,395.66 1986.2,431.72 1986.2,431.72 1986.2,405.66 1986.2,405.66"];
	layer60_moe_expert6	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 6 L60\nGPU: 6\nInput: [batch_size=B_expert6, seq_len=S_expert6, hidden_dim=7168]\nOutput: [batch_size=B_expert6, seq_len=\
S_expert6, hidden_dim=7168]",
		pos="2240,369.52",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer60_moe_comm_from_expert6	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 6\nGPU: 0\nOutput from expert 6",
		pos="2351,278.53",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer60_moe_expert6 -> layer60_moe_comm_from_expert6	[pos="e,2332.2,307.02 2332.2,343.2 2332.2,343.2 2332.2,317.02 2332.2,317.02"];
	layer60_moe_comm_to_expert6 -> layer60_moe_expert6	[pos="e,2332.2,395.66 2332.2,431.72 2332.2,431.72 2332.2,405.66 2332.2,405.66"];
	layer60_moe_expert7	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 7 L60\nGPU: 7\nInput: [batch_size=B_expert7, seq_len=S_expert7, hidden_dim=7168]\nOutput: [batch_size=B_expert7, seq_len=\
S_expert7, hidden_dim=7168]",
		pos="2586,369.52",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer60_moe_comm_from_expert7	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 7\nGPU: 0\nOutput from expert 7",
		pos="2623,278.53",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer60_moe_expert7 -> layer60_moe_comm_from_expert7	[pos="e,2623,307.66 2623,343.2 2623,343.2 2623,317.66 2623,317.66"];
	layer60_moe_comm_to_expert7 -> layer60_moe_expert7	[pos="e,2623,395.82 2623,431.47 2623,431.47 2623,405.82 2623,405.82"];
	layer60_moe_expert8	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 8 L60\nGPU: 8\nInput: [batch_size=B_expert8, seq_len=S_expert8, hidden_dim=7168]\nOutput: [batch_size=B_expert8, seq_len=\
S_expert8, hidden_dim=7168]",
		pos="2932,369.52",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer60_moe_comm_from_expert8	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 8\nGPU: 0\nOutput from expert 8",
		pos="2895,278.53",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer60_moe_expert8 -> layer60_moe_comm_from_expert8	[pos="e,2895,307.66 2895,343.2 2895,343.2 2895,317.66 2895,317.66"];
	layer60_moe_comm_to_expert8 -> layer60_moe_expert8	[pos="e,2895,395.82 2895,431.47 2895,431.47 2895,405.82 2895,405.82"];
	layer60_moe_expert9	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 9 L60\nGPU: 9\nInput: [batch_size=B_expert9, seq_len=S_expert9, hidden_dim=7168]\nOutput: [batch_size=B_expert9, seq_len=\
S_expert9, hidden_dim=7168]",
		pos="3278,369.52",
		shape=rectangle,
		style=filled,
		width=4.5556];
	layer60_moe_comm_from_expert9	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 9\nGPU: 0\nOutput from expert 9",
		pos="3204,278.53",
		shape=ellipse,
		style=filled,
		width=2.5142];
	layer60_moe_expert9 -> layer60_moe_comm_from_expert9	[pos="e,3204.3,307.66 3204.3,343.2 3204.3,343.2 3204.3,317.66 3204.3,317.66"];
	layer60_moe_comm_to_expert9 -> layer60_moe_expert9	[pos="e,3204.3,395.82 3204.3,431.47 3204.3,431.47 3204.3,405.82 3204.3,405.82"];
	layer60_moe_expert10	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 10 L60\nGPU: 10\nInput: [batch_size=B_expert10, seq_len=S_expert10, hidden_dim=7168]\nOutput: [batch_size=B_expert10, seq_\
len=S_expert10, hidden_dim=7168]",
		pos="3629,369.52",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer60_moe_comm_from_expert10	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 10\nGPU: 0\nOutput from expert 10",
		pos="3536,278.53",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer60_moe_expert10 -> layer60_moe_comm_from_expert10	[pos="e,3545.4,307.66 3545.4,343.2 3545.4,343.2 3545.4,317.66 3545.4,317.66"];
	layer60_moe_comm_to_expert10 -> layer60_moe_expert10	[pos="e,3545,395.82 3545,431.47 3545,431.47 3545,405.82 3545,405.82"];
	layer60_moe_expert11	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 11 L60\nGPU: 11\nInput: [batch_size=B_expert11, seq_len=S_expert11, hidden_dim=7168]\nOutput: [batch_size=B_expert11, seq_\
len=S_expert11, hidden_dim=7168]",
		pos="3985,369.52",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer60_moe_comm_from_expert11	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 11\nGPU: 0\nOutput from expert 11",
		pos="3883,278.53",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer60_moe_expert11 -> layer60_moe_comm_from_expert11	[pos="e,3896.9,307.34 3896.9,343.2 3896.9,343.2 3896.9,317.34 3896.9,317.34"];
	layer60_moe_comm_to_expert11 -> layer60_moe_expert11	[pos="e,3896,395.66 3896,431.72 3896,431.72 3896,405.66 3896,405.66"];
	layer60_moe_expert12	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 12 L60\nGPU: 12\nInput: [batch_size=B_expert12, seq_len=S_expert12, hidden_dim=7168]\nOutput: [batch_size=B_expert12, seq_\
len=S_expert12, hidden_dim=7168]",
		pos="4341,369.52",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer60_moe_comm_from_expert12	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 12\nGPU: 0\nOutput from expert 12",
		pos="4234,278.53",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer60_moe_expert12 -> layer60_moe_comm_from_expert12	[pos="e,4250.4,307.34 4250.4,343.2 4250.4,343.2 4250.4,317.34 4250.4,317.34"];
	layer60_moe_comm_to_expert12 -> layer60_moe_expert12	[pos="e,4249.5,395.66 4249.5,431.72 4249.5,431.72 4249.5,405.66 4249.5,405.66"];
	layer60_moe_expert13	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 13 L60\nGPU: 13\nInput: [batch_size=B_expert13, seq_len=S_expert13, hidden_dim=7168]\nOutput: [batch_size=B_expert13, seq_\
len=S_expert13, hidden_dim=7168]",
		pos="4697,369.52",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer60_moe_comm_from_expert13	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 13\nGPU: 0\nOutput from expert 13",
		pos="4588,278.53",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer60_moe_expert13 -> layer60_moe_comm_from_expert13	[pos="e,4605.4,307.34 4605.4,343.2 4605.4,343.2 4605.4,317.34 4605.4,317.34"];
	layer60_moe_comm_to_expert13 -> layer60_moe_expert13	[pos="e,4604,395.66 4604,431.72 4604,431.72 4604,405.66 4604,405.66"];
	layer60_moe_expert14	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 14 L60\nGPU: 14\nInput: [batch_size=B_expert14, seq_len=S_expert14, hidden_dim=7168]\nOutput: [batch_size=B_expert14, seq_\
len=S_expert14, hidden_dim=7168]",
		pos="5053,369.52",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer60_moe_comm_from_expert14	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 14\nGPU: 0\nOutput from expert 14",
		pos="4943,278.53",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer60_moe_expert14 -> layer60_moe_comm_from_expert14	[pos="e,4960.9,307.02 4960.9,343.2 4960.9,343.2 4960.9,317.02 4960.9,317.02"];
	layer60_moe_comm_to_expert14 -> layer60_moe_expert14	[pos="e,4959.5,395.66 4959.5,431.72 4959.5,431.72 4959.5,405.66 4959.5,405.66"];
	layer60_moe_expert15	[fillcolor=lightblue,
		height=0.72222,
		label="EXPERT 15 L60\nGPU: 15\nInput: [batch_size=B_expert15, seq_len=S_expert15, hidden_dim=7168]\nOutput: [batch_size=B_expert15, seq_\
len=S_expert15, hidden_dim=7168]",
		pos="5409,369.52",
		shape=rectangle,
		style=filled,
		width=4.6944];
	layer60_moe_comm_from_expert15	[fillcolor=lightgreen,
		height=0.80532,
		label="RECV FROM EXPERT 15\nGPU: 0\nOutput from expert 15",
		pos="5298,278.53",
		shape=ellipse,
		style=filled,
		width=2.632];
	layer60_moe_expert15 -> layer60_moe_comm_from_expert15	[pos="e,5316.4,307.02 5316.4,343.2 5316.4,343.2 5316.4,317.02 5316.4,317.02"];
	layer60_moe_comm_to_expert15 -> layer60_moe_expert15	[pos="e,5315,395.66 5315,431.72 5315,431.72 5315,405.66 5315,405.66"];
	layer60_moe_aggregate	[fillcolor=lightcoral,
		height=1.4444,
		label="AGGREGATE EXPERTS L60\nGPU: 0\nInput: Multiple expert outputs\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2722,161.54",
		shape=parallelogram,
		style=filled,
		width=7.2861];
	output	[fillcolor=lightgreen,
		height=1.0214,
		label="OUTPUT\nGPU: Host\nInput: [batch_size=B, seq_len=S, hidden_dim=7168]\nOutput: [batch_size=B, seq_len=S, hidden_dim=7168]",
		pos="2722,36.77",
		shape=ellipse,
		style=filled,
		width=4.9694];
	layer60_moe_aggregate -> output	[pos="e,2722,73.582 2722,109.35 2722,109.35 2722,83.582 2722,83.582"];
	layer60_moe_comm_from_expert0 -> layer60_moe_aggregate	[pos="e,2474.6,124 384,249.46 384,204.7 384,124 384,124 384,124 2464.6,124 2464.6,124"];
	layer60_moe_comm_from_expert1 -> layer60_moe_aggregate	[pos="e,2489.9,139 749,249.28 749,208.37 749,139 749,139 749,139 2479.9,139 2479.9,139"];
	layer60_moe_comm_from_expert2 -> layer60_moe_aggregate	[pos="e,2505.7,154 1058,249.33 1058,212.53 1058,154 1058,154 1058,154 2495.7,154 2495.7,154"];
	layer60_moe_comm_from_expert3 -> layer60_moe_aggregate	[pos="e,2520,168 1312,249.49 1312,216.74 1312,168 1312,168 1312,168 2510,168 2510,168"];
	layer60_moe_comm_from_expert4 -> layer60_moe_aggregate	[pos="e,2535.5,183 1732,249.35 1732,221.26 1732,183 1732,183 1732,183 2525.5,183 2525.5,183"];
	layer60_moe_comm_from_expert5 -> layer60_moe_aggregate	[pos="e,2550.9,198 2004,249.46 2004,226.39 2004,198 2004,198 2004,198 2540.9,198 2540.9,198"];
	layer60_moe_comm_from_expert6 -> layer60_moe_aggregate	[pos="e,2496.1,161.62 2441.7,278 2471,278 2496.1,278 2496.1,278 2496.1,278 2496.1,171.62 2496.1,171.62"];
	layer60_moe_comm_from_expert7 -> layer60_moe_aggregate	[pos="e,2623,213.6 2623,249.31 2623,249.31 2623,223.6 2623,223.6"];
	layer60_moe_comm_from_expert8 -> layer60_moe_aggregate	[pos="e,2894.4,213.6 2894.4,249.31 2894.4,249.31 2894.4,223.6 2894.4,223.6"];
	layer60_moe_comm_from_expert9 -> layer60_moe_aggregate	[pos="e,2970.4,200 3204,249.29 3204,226.96 3204,200 3204,200 3204,200 2980.4,200 2980.4,200"];
	layer60_moe_comm_from_expert10 -> layer60_moe_aggregate	[pos="e,2956.9,187 3536,249.32 3536,222.53 3536,187 3536,187 3536,187 2966.9,187 2966.9,187"];
	layer60_moe_comm_from_expert11 -> layer60_moe_aggregate	[pos="e,2943.5,174 3883,249.41 3883,218.48 3883,174 3883,174 3883,174 2953.5,174 2953.5,174"];
	layer60_moe_comm_from_expert12 -> layer60_moe_aggregate	[pos="e,2930.3,161 4234,249.48 4234,214.67 4234,161 4234,161 4234,161 2940.3,161 2940.3,161"];
	layer60_moe_comm_from_expert13 -> layer60_moe_aggregate	[pos="e,2916.9,148 4588,249.24 4588,210.75 4588,148 4588,148 4588,148 2926.9,148 2926.9,148"];
	layer60_moe_comm_from_expert14 -> layer60_moe_aggregate	[pos="e,2903.3,135 4943,249.48 4943,207.54 4943,135 4943,135 4943,135 2913.3,135 2913.3,135"];
	layer60_moe_comm_from_expert15 -> layer60_moe_aggregate	[pos="e,2890,122 5298,249.46 5298,204.19 5298,122 5298,122 5298,122 2900,122 2900,122"];
}
