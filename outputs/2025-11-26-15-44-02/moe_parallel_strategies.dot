digraph {
	graph [bb="0,0,179,3946.2",
		bgcolor=white,
		rankdir=LR,
		splines=ortho
	];
	node [fontname=Arial,
		fontsize=10,
		label="\N"
	];
	subgraph cluster_dp0 {
		graph [bb="0,8,179,1918",
			fillcolor=lightblue,
			label="Data Parallel Replica 0",
			lheight=0.21,
			lp="89.5,1906.5",
			lwidth=2.26,
			style=rounded
		];
		dp0_ep0_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 0 TP0\nGPU: 0\nTP Dimension: 3584",
			pos="89,1866",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep0_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 0 TP1\nGPU: 0\nTP Dimension: 3584",
			pos="89,1807",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep1_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 1 TP0\nGPU: 1\nTP Dimension: 3584",
			pos="89,1748",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep1_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 1 TP1\nGPU: 1\nTP Dimension: 3584",
			pos="89,1689",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep2_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 2 TP0\nGPU: 2\nTP Dimension: 3584",
			pos="89,1630",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep2_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 2 TP1\nGPU: 2\nTP Dimension: 3584",
			pos="89,1571",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep3_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 3 TP0\nGPU: 3\nTP Dimension: 3584",
			pos="89,1512",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep3_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 3 TP1\nGPU: 3\nTP Dimension: 3584",
			pos="89,1453",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep4_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 4 TP0\nGPU: 4\nTP Dimension: 3584",
			pos="89,1394",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep4_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 4 TP1\nGPU: 4\nTP Dimension: 3584",
			pos="89,1335",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep5_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 5 TP0\nGPU: 5\nTP Dimension: 3584",
			pos="89,1276",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep5_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 5 TP1\nGPU: 5\nTP Dimension: 3584",
			pos="89,1217",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep6_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 6 TP0\nGPU: 6\nTP Dimension: 3584",
			pos="89,1158",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep6_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 6 TP1\nGPU: 6\nTP Dimension: 3584",
			pos="89,1099",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep7_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 7 TP0\nGPU: 7\nTP Dimension: 3584",
			pos="89,1040",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep7_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 7 TP1\nGPU: 7\nTP Dimension: 3584",
			pos="89,981",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep8_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 8 TP0\nGPU: 8\nTP Dimension: 3584",
			pos="89,922",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep8_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 8 TP1\nGPU: 8\nTP Dimension: 3584",
			pos="89,863",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep9_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 9 TP0\nGPU: 9\nTP Dimension: 3584",
			pos="89,804",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep9_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 9 TP1\nGPU: 9\nTP Dimension: 3584",
			pos="89,745",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep10_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 10 TP0\nGPU: 10\nTP Dimension: 3584",
			pos="89,686",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep10_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 10 TP1\nGPU: 10\nTP Dimension: 3584",
			pos="89,627",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep11_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 11 TP0\nGPU: 11\nTP Dimension: 3584",
			pos="89,568",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep11_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 11 TP1\nGPU: 11\nTP Dimension: 3584",
			pos="89,509",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep12_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 12 TP0\nGPU: 12\nTP Dimension: 3584",
			pos="89,450",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep12_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 12 TP1\nGPU: 12\nTP Dimension: 3584",
			pos="89,391",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep13_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 13 TP0\nGPU: 13\nTP Dimension: 3584",
			pos="89,332",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep13_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 13 TP1\nGPU: 13\nTP Dimension: 3584",
			pos="89,273",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep14_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 14 TP0\nGPU: 14\nTP Dimension: 3584",
			pos="89,214",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep14_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 14 TP1\nGPU: 14\nTP Dimension: 3584",
			pos="89,155",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep15_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 15 TP0\nGPU: 15\nTP Dimension: 3584",
			pos="89,96",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp0_ep15_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 15 TP1\nGPU: 15\nTP Dimension: 3584",
			pos="89,37",
			shape=rectangle,
			style=filled,
			width=1.4722];
	}
	subgraph cluster_dp1 {
		graph [bb="0,1926,179,3836",
			fillcolor=lightblue,
			label="Data Parallel Replica 1",
			lheight=0.21,
			lp="89.5,3824.5",
			lwidth=2.26,
			style=rounded
		];
		dp1_ep0_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 0 TP0\nGPU: 16\nTP Dimension: 3584",
			pos="89,3784",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep0_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 0 TP1\nGPU: 16\nTP Dimension: 3584",
			pos="89,3725",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep1_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 1 TP0\nGPU: 17\nTP Dimension: 3584",
			pos="89,3666",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep1_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 1 TP1\nGPU: 17\nTP Dimension: 3584",
			pos="89,3607",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep2_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 2 TP0\nGPU: 18\nTP Dimension: 3584",
			pos="89,3548",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep2_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 2 TP1\nGPU: 18\nTP Dimension: 3584",
			pos="89,3489",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep3_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 3 TP0\nGPU: 19\nTP Dimension: 3584",
			pos="89,3430",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep3_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 3 TP1\nGPU: 19\nTP Dimension: 3584",
			pos="89,3371",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep4_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 4 TP0\nGPU: 20\nTP Dimension: 3584",
			pos="89,3312",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep4_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 4 TP1\nGPU: 20\nTP Dimension: 3584",
			pos="89,3253",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep5_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 5 TP0\nGPU: 21\nTP Dimension: 3584",
			pos="89,3194",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep5_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 5 TP1\nGPU: 21\nTP Dimension: 3584",
			pos="89,3135",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep6_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 6 TP0\nGPU: 22\nTP Dimension: 3584",
			pos="89,3076",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep6_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 6 TP1\nGPU: 22\nTP Dimension: 3584",
			pos="89,3017",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep7_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 7 TP0\nGPU: 23\nTP Dimension: 3584",
			pos="89,2958",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep7_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 7 TP1\nGPU: 23\nTP Dimension: 3584",
			pos="89,2899",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep8_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 8 TP0\nGPU: 24\nTP Dimension: 3584",
			pos="89,2840",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep8_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 8 TP1\nGPU: 24\nTP Dimension: 3584",
			pos="89,2781",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep9_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 9 TP0\nGPU: 25\nTP Dimension: 3584",
			pos="89,2722",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep9_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 9 TP1\nGPU: 25\nTP Dimension: 3584",
			pos="89,2663",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep10_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 10 TP0\nGPU: 26\nTP Dimension: 3584",
			pos="89,2604",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep10_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 10 TP1\nGPU: 26\nTP Dimension: 3584",
			pos="89,2545",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep11_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 11 TP0\nGPU: 27\nTP Dimension: 3584",
			pos="89,2486",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep11_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 11 TP1\nGPU: 27\nTP Dimension: 3584",
			pos="89,2427",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep12_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 12 TP0\nGPU: 28\nTP Dimension: 3584",
			pos="89,2368",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep12_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 12 TP1\nGPU: 28\nTP Dimension: 3584",
			pos="89,2309",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep13_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 13 TP0\nGPU: 29\nTP Dimension: 3584",
			pos="89,2250",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep13_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 13 TP1\nGPU: 29\nTP Dimension: 3584",
			pos="89,2191",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep14_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 14 TP0\nGPU: 30\nTP Dimension: 3584",
			pos="89,2132",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep14_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 14 TP1\nGPU: 30\nTP Dimension: 3584",
			pos="89,2073",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep15_tp0	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 15 TP0\nGPU: 31\nTP Dimension: 3584",
			pos="89,2014",
			shape=rectangle,
			style=filled,
			width=1.4722];
		dp1_ep15_tp1	[fillcolor=lightyellow,
			height=0.56944,
			label="Expert 15 TP1\nGPU: 31\nTP Dimension: 3584",
			pos="89,1955",
			shape=rectangle,
			style=filled,
			width=1.4722];
	}
	dp_comm_0_to_1	[fillcolor=lightcoral,
		height=0.58926,
		label="DP Sync\nReplica 0 ↔ 1",
		pos="89,3865",
		shape=ellipse,
		style=filled,
		width=1.5517];
	dp_comm_1_to_0	[fillcolor=lightcoral,
		height=0.58926,
		label="DP Sync\nReplica 1 ↔ 0",
		pos="89,3925",
		shape=ellipse,
		style=filled,
		width=1.5517];
}
